(()=>{var Doe=Object.create;var KI=Object.defineProperty;var $U=Object.getOwnPropertyDescriptor;var _oe=Object.getOwnPropertyNames;var Poe=Object.getPrototypeOf,Loe=Object.prototype.hasOwnProperty;var jh=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var p0=(t,e)=>()=>(t&&(e=t(t=0)),e);var yt=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Ooe=(t,e)=>{for(var r in e)KI(t,r,{get:e[r],enumerable:!0})},Noe=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of _oe(e))!Loe.call(t,n)&&n!==r&&KI(t,n,{get:()=>e[n],enumerable:!(i=$U(e,n))||i.enumerable});return t};var pa=(t,e,r)=>(r=t!=null?Doe(Poe(t)):{},Noe(e||!t||!t.__esModule?KI(r,"default",{value:t,enumerable:!0}):r,t));var Uu=(t,e,r,i)=>{for(var n=i>1?void 0:i?$U(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(n=(i?a(e,r,n):a(n))||n);return i&&n&&KI(e,r,n),n};var Um=yt((ZU,JI)=>{(function(t,e){"use strict";typeof JI=="object"&&typeof JI.exports=="object"?JI.exports=t.document?e(t,!0):function(r){if(!r.document)throw new Error("jQuery requires a window with a document");return e(r)}:e(t)})(typeof window<"u"?window:ZU,function(t,e){"use strict";var r=[],i=Object.getPrototypeOf,n=r.slice,s=r.flat?function(S){return r.flat.call(S)}:function(S){return r.concat.apply([],S)},a=r.push,o=r.indexOf,l={},c=l.toString,u=l.hasOwnProperty,d=u.toString,A=d.call(Object),h={},f=function(V){return typeof V=="function"&&typeof V.nodeType!="number"&&typeof V.item!="function"},p=function(V){return V!=null&&V===V.window},m=t.document,y={type:!0,src:!0,nonce:!0,noModule:!0};function g(S,V,ee){ee=ee||m;var ie,he,de=ee.createElement("script");if(de.text=S,V)for(ie in y)he=V[ie]||V.getAttribute&&V.getAttribute(ie),he&&de.setAttribute(ie,he);ee.head.appendChild(de).parentNode.removeChild(de)}function b(S){return S==null?S+"":typeof S=="object"||typeof S=="function"?l[c.call(S)]||"object":typeof S}var E="3.7.1",w=/HTML$/i,x=function(S,V){return new x.fn.init(S,V)};x.fn=x.prototype={jquery:E,constructor:x,length:0,toArray:function(){return n.call(this)},get:function(S){return S==null?n.call(this):S<0?this[S+this.length]:this[S]},pushStack:function(S){var V=x.merge(this.constructor(),S);return V.prevObject=this,V},each:function(S){return x.each(this,S)},map:function(S){return this.pushStack(x.map(this,function(V,ee){return S.call(V,ee,V)}))},slice:function(){return this.pushStack(n.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(x.grep(this,function(S,V){return(V+1)%2}))},odd:function(){return this.pushStack(x.grep(this,function(S,V){return V%2}))},eq:function(S){var V=this.length,ee=+S+(S<0?V:0);return this.pushStack(ee>=0&&ee<V?[this[ee]]:[])},end:function(){return this.prevObject||this.constructor()},push:a,sort:r.sort,splice:r.splice},x.extend=x.fn.extend=function(){var S,V,ee,ie,he,de,ye=arguments[0]||{},Qe=1,Ve=arguments.length,at=!1;for(typeof ye=="boolean"&&(at=ye,ye=arguments[Qe]||{},Qe++),typeof ye!="object"&&!f(ye)&&(ye={}),Qe===Ve&&(ye=this,Qe--);Qe<Ve;Qe++)if((S=arguments[Qe])!=null)for(V in S)ie=S[V],!(V==="__proto__"||ye===ie)&&(at&&ie&&(x.isPlainObject(ie)||(he=Array.isArray(ie)))?(ee=ye[V],he&&!Array.isArray(ee)?de=[]:!he&&!x.isPlainObject(ee)?de={}:de=ee,he=!1,ye[V]=x.extend(at,de,ie)):ie!==void 0&&(ye[V]=ie));return ye},x.extend({expando:"jQuery"+(E+Math.random()).replace(/\D/g,""),isReady:!0,error:function(S){throw new Error(S)},noop:function(){},isPlainObject:function(S){var V,ee;return!S||c.call(S)!=="[object Object]"?!1:(V=i(S),V?(ee=u.call(V,"constructor")&&V.constructor,typeof ee=="function"&&d.call(ee)===A):!0)},isEmptyObject:function(S){var V;for(V in S)return!1;return!0},globalEval:function(S,V,ee){g(S,{nonce:V&&V.nonce},ee)},each:function(S,V){var ee,ie=0;if(I(S))for(ee=S.length;ie<ee&&V.call(S[ie],ie,S[ie])!==!1;ie++);else for(ie in S)if(V.call(S[ie],ie,S[ie])===!1)break;return S},text:function(S){var V,ee="",ie=0,he=S.nodeType;if(!he)for(;V=S[ie++];)ee+=x.text(V);return he===1||he===11?S.textContent:he===9?S.documentElement.textContent:he===3||he===4?S.nodeValue:ee},makeArray:function(S,V){var ee=V||[];return S!=null&&(I(Object(S))?x.merge(ee,typeof S=="string"?[S]:S):a.call(ee,S)),ee},inArray:function(S,V,ee){return V==null?-1:o.call(V,S,ee)},isXMLDoc:function(S){var V=S&&S.namespaceURI,ee=S&&(S.ownerDocument||S).documentElement;return!w.test(V||ee&&ee.nodeName||"HTML")},merge:function(S,V){for(var ee=+V.length,ie=0,he=S.length;ie<ee;ie++)S[he++]=V[ie];return S.length=he,S},grep:function(S,V,ee){for(var ie,he=[],de=0,ye=S.length,Qe=!ee;de<ye;de++)ie=!V(S[de],de),ie!==Qe&&he.push(S[de]);return he},map:function(S,V,ee){var ie,he,de=0,ye=[];if(I(S))for(ie=S.length;de<ie;de++)he=V(S[de],de,ee),he!=null&&ye.push(he);else for(de in S)he=V(S[de],de,ee),he!=null&&ye.push(he);return s(ye)},guid:1,support:h}),typeof Symbol=="function"&&(x.fn[Symbol.iterator]=r[Symbol.iterator]),x.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(S,V){l["[object "+V+"]"]=V.toLowerCase()});function I(S){var V=!!S&&"length"in S&&S.length,ee=b(S);return f(S)||p(S)?!1:ee==="array"||V===0||typeof V=="number"&&V>0&&V-1 in S}function C(S,V){return S.nodeName&&S.nodeName.toLowerCase()===V.toLowerCase()}var G=r.pop,U=r.sort,_=r.splice,H="[\\x20\\t\\r\\n\\f]",Q=new RegExp("^"+H+"+|((?:^|[^\\\\])(?:\\\\.)*)"+H+"+$","g");x.contains=function(S,V){var ee=V&&V.parentNode;return S===ee||!!(ee&&ee.nodeType===1&&(S.contains?S.contains(ee):S.compareDocumentPosition&&S.compareDocumentPosition(ee)&16))};var j=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function $(S,V){return V?S==="\0"?"\uFFFD":S.slice(0,-1)+"\\"+S.charCodeAt(S.length-1).toString(16)+" ":"\\"+S}x.escapeSelector=function(S){return(S+"").replace(j,$)};var B=m,M=a;(function(){var S,V,ee,ie,he,de=M,ye,Qe,Ve,at,Ot,Vt=x.expando,Bt=0,hr=0,Oi=Bd(),gn=Bd(),Ji=Bd(),Vs=Bd(),Ha=function(Me,Ke){return Me===Ke&&(he=!0),0},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",fe="(?:\\\\[\\da-fA-F]{1,6}"+H+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Oe="\\["+H+"*("+fe+")(?:"+H+"*([*^$|!~]?=)"+H+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+fe+"))|)"+H+"*\\]",Xe=":("+fe+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Oe+")*)|.*)\\)|)",Je=new RegExp(H+"+","g"),_t=new RegExp("^"+H+"*,"+H+"*"),or=new RegExp("^"+H+"*([>+~]|"+H+")"+H+"*"),Nr=new RegExp(H+"|>"),ei=new RegExp(Xe),Ui=new RegExp("^"+fe+"$"),Si={ID:new RegExp("^#("+fe+")"),CLASS:new RegExp("^\\.("+fe+")"),TAG:new RegExp("^("+fe+"|[*])"),ATTR:new RegExp("^"+Oe),PSEUDO:new RegExp("^"+Xe),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+H+"*(even|odd|(([+-]|)(\\d*)n|)"+H+"*(?:([+-]|)"+H+"*(\\d+)|))"+H+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+H+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+H+"*((?:-\\d)?\\d*)"+H+"*\\)|)(?=[^-]|$)","i")},Vi=/^(?:input|select|textarea|button)$/i,gi=/^h\d$/i,$n=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,La=/[+~]/,Ea=new RegExp("\\\\[\\da-fA-F]{1,6}"+H+"?|\\\\([^\\r\\n\\f])","g"),cs=function(Me,Ke){var mt="0x"+Me.slice(1)-65536;return Ke||(mt<0?String.fromCharCode(mt+65536):String.fromCharCode(mt>>10|55296,mt&1023|56320))},po=function(){xc()},qc=yf(function(Me){return Me.disabled===!0&&C(Me,"fieldset")},{dir:"parentNode",next:"legend"});function Ll(){try{return ye.activeElement}catch{}}try{de.apply(r=n.call(B.childNodes),B.childNodes),r[B.childNodes.length].nodeType}catch{de={apply:function(Ke,mt){M.apply(Ke,n.call(mt))},call:function(Ke){M.apply(Ke,n.call(arguments,1))}}}function Ni(Me,Ke,mt,Tt){var Ut,fr,Br,Zr,Pr,Gi,qr,Di=Ke&&Ke.ownerDocument,an=Ke?Ke.nodeType:9;if(mt=mt||[],typeof Me!="string"||!Me||an!==1&&an!==9&&an!==11)return mt;if(!Tt&&(xc(Ke),Ke=Ke||ye,Ve)){if(an!==11&&(Pr=$n.exec(Me)))if(Ut=Pr[1]){if(an===9)if(Br=Ke.getElementById(Ut)){if(Br.id===Ut)return de.call(mt,Br),mt}else return mt;else if(Di&&(Br=Di.getElementById(Ut))&&Ni.contains(Ke,Br)&&Br.id===Ut)return de.call(mt,Br),mt}else{if(Pr[2])return de.apply(mt,Ke.getElementsByTagName(Me)),mt;if((Ut=Pr[3])&&Ke.getElementsByClassName)return de.apply(mt,Ke.getElementsByClassName(Ut)),mt}if(!Vs[Me+" "]&&(!at||!at.test(Me))){if(qr=Me,Di=Ke,an===1&&(Nr.test(Me)||or.test(Me))){for(Di=La.test(Me)&&_d(Ke.parentNode)||Ke,(Di!=Ke||!h.scope)&&((Zr=Ke.getAttribute("id"))?Zr=x.escapeSelector(Zr):Ke.setAttribute("id",Zr=Vt)),Gi=Ru(Me),fr=Gi.length;fr--;)Gi[fr]=(Zr?"#"+Zr:":scope")+" "+Yo(Gi[fr]);qr=Gi.join(",")}try{return de.apply(mt,Di.querySelectorAll(qr)),mt}catch{Vs(Me,!0)}finally{Zr===Vt&&Ke.removeAttribute("id")}}}return rc(Me.replace(Q,"$1"),Ke,mt,Tt)}function Bd(){var Me=[];function Ke(mt,Tt){return Me.push(mt+" ")>V.cacheLength&&delete Ke[Me.shift()],Ke[mt+" "]=Tt}return Ke}function us(Me){return Me[Vt]=!0,Me}function Wc(Me){var Ke=ye.createElement("fieldset");try{return!!Me(Ke)}catch{return!1}finally{Ke.parentNode&&Ke.parentNode.removeChild(Ke),Ke=null}}function Nu(Me){return function(Ke){return C(Ke,"input")&&Ke.type===Me}}function Dd(Me){return function(Ke){return(C(Ke,"input")||C(Ke,"button"))&&Ke.type===Me}}function ns(Me){return function(Ke){return"form"in Ke?Ke.parentNode&&Ke.disabled===!1?"label"in Ke?"label"in Ke.parentNode?Ke.parentNode.disabled===Me:Ke.disabled===Me:Ke.isDisabled===Me||Ke.isDisabled!==!Me&&qc(Ke)===Me:Ke.disabled===Me:"label"in Ke?Ke.disabled===Me:!1}}function to(Me){return us(function(Ke){return Ke=+Ke,us(function(mt,Tt){for(var Ut,fr=Me([],mt.length,Ke),Br=fr.length;Br--;)mt[Ut=fr[Br]]&&(mt[Ut]=!(Tt[Ut]=mt[Ut]))})})}function _d(Me){return Me&&typeof Me.getElementsByTagName<"u"&&Me}function xc(Me){var Ke,mt=Me?Me.ownerDocument||Me:B;return mt==ye||mt.nodeType!==9||!mt.documentElement||(ye=mt,Qe=ye.documentElement,Ve=!x.isXMLDoc(ye),Ot=Qe.matches||Qe.webkitMatchesSelector||Qe.msMatchesSelector,Qe.msMatchesSelector&&B!=ye&&(Ke=ye.defaultView)&&Ke.top!==Ke&&Ke.addEventListener("unload",po),h.getById=Wc(function(Tt){return Qe.appendChild(Tt).id=x.expando,!ye.getElementsByName||!ye.getElementsByName(x.expando).length}),h.disconnectedMatch=Wc(function(Tt){return Ot.call(Tt,"*")}),h.scope=Wc(function(){return ye.querySelectorAll(":scope")}),h.cssHas=Wc(function(){try{return ye.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),h.getById?(V.filter.ID=function(Tt){var Ut=Tt.replace(Ea,cs);return function(fr){return fr.getAttribute("id")===Ut}},V.find.ID=function(Tt,Ut){if(typeof Ut.getElementById<"u"&&Ve){var fr=Ut.getElementById(Tt);return fr?[fr]:[]}}):(V.filter.ID=function(Tt){var Ut=Tt.replace(Ea,cs);return function(fr){var Br=typeof fr.getAttributeNode<"u"&&fr.getAttributeNode("id");return Br&&Br.value===Ut}},V.find.ID=function(Tt,Ut){if(typeof Ut.getElementById<"u"&&Ve){var fr,Br,Zr,Pr=Ut.getElementById(Tt);if(Pr){if(fr=Pr.getAttributeNode("id"),fr&&fr.value===Tt)return[Pr];for(Zr=Ut.getElementsByName(Tt),Br=0;Pr=Zr[Br++];)if(fr=Pr.getAttributeNode("id"),fr&&fr.value===Tt)return[Pr]}return[]}}),V.find.TAG=function(Tt,Ut){return typeof Ut.getElementsByTagName<"u"?Ut.getElementsByTagName(Tt):Ut.querySelectorAll(Tt)},V.find.CLASS=function(Tt,Ut){if(typeof Ut.getElementsByClassName<"u"&&Ve)return Ut.getElementsByClassName(Tt)},at=[],Wc(function(Tt){var Ut;Qe.appendChild(Tt).innerHTML="<a id='"+Vt+"' href='' disabled='disabled'></a><select id='"+Vt+"-\r\\' disabled='disabled'><option selected=''></option></select>",Tt.querySelectorAll("[selected]").length||at.push("\\["+H+"*(?:value|"+J+")"),Tt.querySelectorAll("[id~="+Vt+"-]").length||at.push("~="),Tt.querySelectorAll("a#"+Vt+"+*").length||at.push(".#.+[+~]"),Tt.querySelectorAll(":checked").length||at.push(":checked"),Ut=ye.createElement("input"),Ut.setAttribute("type","hidden"),Tt.appendChild(Ut).setAttribute("name","D"),Qe.appendChild(Tt).disabled=!0,Tt.querySelectorAll(":disabled").length!==2&&at.push(":enabled",":disabled"),Ut=ye.createElement("input"),Ut.setAttribute("name",""),Tt.appendChild(Ut),Tt.querySelectorAll("[name='']").length||at.push("\\["+H+"*name"+H+"*="+H+`*(?:''|"")`)}),h.cssHas||at.push(":has"),at=at.length&&new RegExp(at.join("|")),Ha=function(Tt,Ut){if(Tt===Ut)return he=!0,0;var fr=!Tt.compareDocumentPosition-!Ut.compareDocumentPosition;return fr||(fr=(Tt.ownerDocument||Tt)==(Ut.ownerDocument||Ut)?Tt.compareDocumentPosition(Ut):1,fr&1||!h.sortDetached&&Ut.compareDocumentPosition(Tt)===fr?Tt===ye||Tt.ownerDocument==B&&Ni.contains(B,Tt)?-1:Ut===ye||Ut.ownerDocument==B&&Ni.contains(B,Ut)?1:ie?o.call(ie,Tt)-o.call(ie,Ut):0:fr&4?-1:1)}),ye}Ni.matches=function(Me,Ke){return Ni(Me,null,null,Ke)},Ni.matchesSelector=function(Me,Ke){if(xc(Me),Ve&&!Vs[Ke+" "]&&(!at||!at.test(Ke)))try{var mt=Ot.call(Me,Ke);if(mt||h.disconnectedMatch||Me.document&&Me.document.nodeType!==11)return mt}catch{Vs(Ke,!0)}return Ni(Ke,ye,null,[Me]).length>0},Ni.contains=function(Me,Ke){return(Me.ownerDocument||Me)!=ye&&xc(Me),x.contains(Me,Ke)},Ni.attr=function(Me,Ke){(Me.ownerDocument||Me)!=ye&&xc(Me);var mt=V.attrHandle[Ke.toLowerCase()],Tt=mt&&u.call(V.attrHandle,Ke.toLowerCase())?mt(Me,Ke,!Ve):void 0;return Tt!==void 0?Tt:Me.getAttribute(Ke)},Ni.error=function(Me){throw new Error("Syntax error, unrecognized expression: "+Me)},x.uniqueSort=function(Me){var Ke,mt=[],Tt=0,Ut=0;if(he=!h.sortStable,ie=!h.sortStable&&n.call(Me,0),U.call(Me,Ha),he){for(;Ke=Me[Ut++];)Ke===Me[Ut]&&(Tt=mt.push(Ut));for(;Tt--;)_.call(Me,mt[Tt],1)}return ie=null,Me},x.fn.uniqueSort=function(){return this.pushStack(x.uniqueSort(n.apply(this)))},V=x.expr={cacheLength:50,createPseudo:us,match:Si,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(Me){return Me[1]=Me[1].replace(Ea,cs),Me[3]=(Me[3]||Me[4]||Me[5]||"").replace(Ea,cs),Me[2]==="~="&&(Me[3]=" "+Me[3]+" "),Me.slice(0,4)},CHILD:function(Me){return Me[1]=Me[1].toLowerCase(),Me[1].slice(0,3)==="nth"?(Me[3]||Ni.error(Me[0]),Me[4]=+(Me[4]?Me[5]+(Me[6]||1):2*(Me[3]==="even"||Me[3]==="odd")),Me[5]=+(Me[7]+Me[8]||Me[3]==="odd")):Me[3]&&Ni.error(Me[0]),Me},PSEUDO:function(Me){var Ke,mt=!Me[6]&&Me[2];return Si.CHILD.test(Me[0])?null:(Me[3]?Me[2]=Me[4]||Me[5]||"":mt&&ei.test(mt)&&(Ke=Ru(mt,!0))&&(Ke=mt.indexOf(")",mt.length-Ke)-mt.length)&&(Me[0]=Me[0].slice(0,Ke),Me[2]=mt.slice(0,Ke)),Me.slice(0,3))}},filter:{TAG:function(Me){var Ke=Me.replace(Ea,cs).toLowerCase();return Me==="*"?function(){return!0}:function(mt){return C(mt,Ke)}},CLASS:function(Me){var Ke=Oi[Me+" "];return Ke||(Ke=new RegExp("(^|"+H+")"+Me+"("+H+"|$)"))&&Oi(Me,function(mt){return Ke.test(typeof mt.className=="string"&&mt.className||typeof mt.getAttribute<"u"&&mt.getAttribute("class")||"")})},ATTR:function(Me,Ke,mt){return function(Tt){var Ut=Ni.attr(Tt,Me);return Ut==null?Ke==="!=":Ke?(Ut+="",Ke==="="?Ut===mt:Ke==="!="?Ut!==mt:Ke==="^="?mt&&Ut.indexOf(mt)===0:Ke==="*="?mt&&Ut.indexOf(mt)>-1:Ke==="$="?mt&&Ut.slice(-mt.length)===mt:Ke==="~="?(" "+Ut.replace(Je," ")+" ").indexOf(mt)>-1:Ke==="|="?Ut===mt||Ut.slice(0,mt.length+1)===mt+"-":!1):!0}},CHILD:function(Me,Ke,mt,Tt,Ut){var fr=Me.slice(0,3)!=="nth",Br=Me.slice(-4)!=="last",Zr=Ke==="of-type";return Tt===1&&Ut===0?function(Pr){return!!Pr.parentNode}:function(Pr,Gi,qr){var Di,an,mi,Pn,jo,ks=fr!==Br?"nextSibling":"previousSibling",io=Pr.parentNode,Ln=Zr&&Pr.nodeName.toLowerCase(),ss=!qr&&!Zr,On=!1;if(io){if(fr){for(;ks;){for(mi=Pr;mi=mi[ks];)if(Zr?C(mi,Ln):mi.nodeType===1)return!1;jo=ks=Me==="only"&&!jo&&"nextSibling"}return!0}if(jo=[Br?io.firstChild:io.lastChild],Br&&ss){for(an=io[Vt]||(io[Vt]={}),Di=an[Me]||[],Pn=Di[0]===Bt&&Di[1],On=Pn&&Di[2],mi=Pn&&io.childNodes[Pn];mi=++Pn&&mi&&mi[ks]||(On=Pn=0)||jo.pop();)if(mi.nodeType===1&&++On&&mi===Pr){an[Me]=[Bt,Pn,On];break}}else if(ss&&(an=Pr[Vt]||(Pr[Vt]={}),Di=an[Me]||[],Pn=Di[0]===Bt&&Di[1],On=Pn),On===!1)for(;(mi=++Pn&&mi&&mi[ks]||(On=Pn=0)||jo.pop())&&!((Zr?C(mi,Ln):mi.nodeType===1)&&++On&&(ss&&(an=mi[Vt]||(mi[Vt]={}),an[Me]=[Bt,On]),mi===Pr)););return On-=Ut,On===Tt||On%Tt===0&&On/Tt>=0}}},PSEUDO:function(Me,Ke){var mt,Tt=V.pseudos[Me]||V.setFilters[Me.toLowerCase()]||Ni.error("unsupported pseudo: "+Me);return Tt[Vt]?Tt(Ke):Tt.length>1?(mt=[Me,Me,"",Ke],V.setFilters.hasOwnProperty(Me.toLowerCase())?us(function(Ut,fr){for(var Br,Zr=Tt(Ut,Ke),Pr=Zr.length;Pr--;)Br=o.call(Ut,Zr[Pr]),Ut[Br]=!(fr[Br]=Zr[Pr])}):function(Ut){return Tt(Ut,0,mt)}):Tt}},pseudos:{not:us(function(Me){var Ke=[],mt=[],Tt=gh(Me.replace(Q,"$1"));return Tt[Vt]?us(function(Ut,fr,Br,Zr){for(var Pr,Gi=Tt(Ut,null,Zr,[]),qr=Ut.length;qr--;)(Pr=Gi[qr])&&(Ut[qr]=!(fr[qr]=Pr))}):function(Ut,fr,Br){return Ke[0]=Ut,Tt(Ke,null,Br,mt),Ke[0]=null,!mt.pop()}}),has:us(function(Me){return function(Ke){return Ni(Me,Ke).length>0}}),contains:us(function(Me){return Me=Me.replace(Ea,cs),function(Ke){return(Ke.textContent||x.text(Ke)).indexOf(Me)>-1}}),lang:us(function(Me){return Ui.test(Me||"")||Ni.error("unsupported lang: "+Me),Me=Me.replace(Ea,cs).toLowerCase(),function(Ke){var mt;do if(mt=Ve?Ke.lang:Ke.getAttribute("xml:lang")||Ke.getAttribute("lang"))return mt=mt.toLowerCase(),mt===Me||mt.indexOf(Me+"-")===0;while((Ke=Ke.parentNode)&&Ke.nodeType===1);return!1}}),target:function(Me){var Ke=t.location&&t.location.hash;return Ke&&Ke.slice(1)===Me.id},root:function(Me){return Me===Qe},focus:function(Me){return Me===Ll()&&ye.hasFocus()&&!!(Me.type||Me.href||~Me.tabIndex)},enabled:ns(!1),disabled:ns(!0),checked:function(Me){return C(Me,"input")&&!!Me.checked||C(Me,"option")&&!!Me.selected},selected:function(Me){return Me.parentNode&&Me.parentNode.selectedIndex,Me.selected===!0},empty:function(Me){for(Me=Me.firstChild;Me;Me=Me.nextSibling)if(Me.nodeType<6)return!1;return!0},parent:function(Me){return!V.pseudos.empty(Me)},header:function(Me){return gi.test(Me.nodeName)},input:function(Me){return Vi.test(Me.nodeName)},button:function(Me){return C(Me,"input")&&Me.type==="button"||C(Me,"button")},text:function(Me){var Ke;return C(Me,"input")&&Me.type==="text"&&((Ke=Me.getAttribute("type"))==null||Ke.toLowerCase()==="text")},first:to(function(){return[0]}),last:to(function(Me,Ke){return[Ke-1]}),eq:to(function(Me,Ke,mt){return[mt<0?mt+Ke:mt]}),even:to(function(Me,Ke){for(var mt=0;mt<Ke;mt+=2)Me.push(mt);return Me}),odd:to(function(Me,Ke){for(var mt=1;mt<Ke;mt+=2)Me.push(mt);return Me}),lt:to(function(Me,Ke,mt){var Tt;for(mt<0?Tt=mt+Ke:mt>Ke?Tt=Ke:Tt=mt;--Tt>=0;)Me.push(Tt);return Me}),gt:to(function(Me,Ke,mt){for(var Tt=mt<0?mt+Ke:mt;++Tt<Ke;)Me.push(Tt);return Me})}},V.pseudos.nth=V.pseudos.eq;for(S in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})V.pseudos[S]=Nu(S);for(S in{submit:!0,reset:!0})V.pseudos[S]=Dd(S);function pA(){}pA.prototype=V.filters=V.pseudos,V.setFilters=new pA;function Ru(Me,Ke){var mt,Tt,Ut,fr,Br,Zr,Pr,Gi=gn[Me+" "];if(Gi)return Ke?0:Gi.slice(0);for(Br=Me,Zr=[],Pr=V.preFilter;Br;){(!mt||(Tt=_t.exec(Br)))&&(Tt&&(Br=Br.slice(Tt[0].length)||Br),Zr.push(Ut=[])),mt=!1,(Tt=or.exec(Br))&&(mt=Tt.shift(),Ut.push({value:mt,type:Tt[0].replace(Q," ")}),Br=Br.slice(mt.length));for(fr in V.filter)(Tt=Si[fr].exec(Br))&&(!Pr[fr]||(Tt=Pr[fr](Tt)))&&(mt=Tt.shift(),Ut.push({value:mt,type:fr,matches:Tt}),Br=Br.slice(mt.length));if(!mt)break}return Ke?Br.length:Br?Ni.error(Me):gn(Me,Zr).slice(0)}function Yo(Me){for(var Ke=0,mt=Me.length,Tt="";Ke<mt;Ke++)Tt+=Me[Ke].value;return Tt}function yf(Me,Ke,mt){var Tt=Ke.dir,Ut=Ke.next,fr=Ut||Tt,Br=mt&&fr==="parentNode",Zr=hr++;return Ke.first?function(Pr,Gi,qr){for(;Pr=Pr[Tt];)if(Pr.nodeType===1||Br)return Me(Pr,Gi,qr);return!1}:function(Pr,Gi,qr){var Di,an,mi=[Bt,Zr];if(qr){for(;Pr=Pr[Tt];)if((Pr.nodeType===1||Br)&&Me(Pr,Gi,qr))return!0}else for(;Pr=Pr[Tt];)if(Pr.nodeType===1||Br)if(an=Pr[Vt]||(Pr[Vt]={}),Ut&&C(Pr,Ut))Pr=Pr[Tt]||Pr;else{if((Di=an[fr])&&Di[0]===Bt&&Di[1]===Zr)return mi[2]=Di[2];if(an[fr]=mi,mi[2]=Me(Pr,Gi,qr))return!0}return!1}}function Vo(Me){return Me.length>1?function(Ke,mt,Tt){for(var Ut=Me.length;Ut--;)if(!Me[Ut](Ke,mt,Tt))return!1;return!0}:Me[0]}function mh(Me,Ke,mt){for(var Tt=0,Ut=Ke.length;Tt<Ut;Tt++)Ni(Me,Ke[Tt],mt);return mt}function ro(Me,Ke,mt,Tt,Ut){for(var fr,Br=[],Zr=0,Pr=Me.length,Gi=Ke!=null;Zr<Pr;Zr++)(fr=Me[Zr])&&(!mt||mt(fr,Tt,Ut))&&(Br.push(fr),Gi&&Ke.push(Zr));return Br}function Oa(Me,Ke,mt,Tt,Ut,fr){return Tt&&!Tt[Vt]&&(Tt=Oa(Tt)),Ut&&!Ut[Vt]&&(Ut=Oa(Ut,fr)),us(function(Br,Zr,Pr,Gi){var qr,Di,an,mi,Pn=[],jo=[],ks=Zr.length,io=Br||mh(Ke||"*",Pr.nodeType?[Pr]:Pr,[]),Ln=Me&&(Br||!Ke)?ro(io,Pn,Me,Pr,Gi):io;if(mt?(mi=Ut||(Br?Me:ks||Tt)?[]:Zr,mt(Ln,mi,Pr,Gi)):mi=Ln,Tt)for(qr=ro(mi,jo),Tt(qr,[],Pr,Gi),Di=qr.length;Di--;)(an=qr[Di])&&(mi[jo[Di]]=!(Ln[jo[Di]]=an));if(Br){if(Ut||Me){if(Ut){for(qr=[],Di=mi.length;Di--;)(an=mi[Di])&&qr.push(Ln[Di]=an);Ut(null,mi=[],qr,Gi)}for(Di=mi.length;Di--;)(an=mi[Di])&&(qr=Ut?o.call(Br,an):Pn[Di])>-1&&(Br[qr]=!(Zr[qr]=an))}}else mi=ro(mi===Zr?mi.splice(ks,mi.length):mi),Ut?Ut(null,Zr,mi,Gi):de.apply(Zr,mi)})}function Mu(Me){for(var Ke,mt,Tt,Ut=Me.length,fr=V.relative[Me[0].type],Br=fr||V.relative[" "],Zr=fr?1:0,Pr=yf(function(Di){return Di===Ke},Br,!0),Gi=yf(function(Di){return o.call(Ke,Di)>-1},Br,!0),qr=[function(Di,an,mi){var Pn=!fr&&(mi||an!=ee)||((Ke=an).nodeType?Pr(Di,an,mi):Gi(Di,an,mi));return Ke=null,Pn}];Zr<Ut;Zr++)if(mt=V.relative[Me[Zr].type])qr=[yf(Vo(qr),mt)];else{if(mt=V.filter[Me[Zr].type].apply(null,Me[Zr].matches),mt[Vt]){for(Tt=++Zr;Tt<Ut&&!V.relative[Me[Tt].type];Tt++);return Oa(Zr>1&&Vo(qr),Zr>1&&Yo(Me.slice(0,Zr-1).concat({value:Me[Zr-2].type===" "?"*":""})).replace(Q,"$1"),mt,Zr<Tt&&Mu(Me.slice(Zr,Tt)),Tt<Ut&&Mu(Me=Me.slice(Tt)),Tt<Ut&&Yo(Me))}qr.push(mt)}return Vo(qr)}function t0(Me,Ke){var mt=Ke.length>0,Tt=Me.length>0,Ut=function(fr,Br,Zr,Pr,Gi){var qr,Di,an,mi=0,Pn="0",jo=fr&&[],ks=[],io=ee,Ln=fr||Tt&&V.find.TAG("*",Gi),ss=Bt+=io==null?1:Math.random()||.1,On=Ln.length;for(Gi&&(ee=Br==ye||Br||Gi);Pn!==On&&(qr=Ln[Pn])!=null;Pn++){if(Tt&&qr){for(Di=0,!Br&&qr.ownerDocument!=ye&&(xc(qr),Zr=!Ve);an=Me[Di++];)if(an(qr,Br||ye,Zr)){de.call(Pr,qr);break}Gi&&(Bt=ss)}mt&&((qr=!an&&qr)&&mi--,fr&&jo.push(qr))}if(mi+=Pn,mt&&Pn!==mi){for(Di=0;an=Ke[Di++];)an(jo,ks,Br,Zr);if(fr){if(mi>0)for(;Pn--;)jo[Pn]||ks[Pn]||(ks[Pn]=G.call(Pr));ks=ro(ks)}de.apply(Pr,ks),Gi&&!fr&&ks.length>0&&mi+Ke.length>1&&x.uniqueSort(Pr)}return Gi&&(Bt=ss,ee=io),jo};return mt?us(Ut):Ut}function gh(Me,Ke){var mt,Tt=[],Ut=[],fr=Ji[Me+" "];if(!fr){for(Ke||(Ke=Ru(Me)),mt=Ke.length;mt--;)fr=Mu(Ke[mt]),fr[Vt]?Tt.push(fr):Ut.push(fr);fr=Ji(Me,t0(Ut,Tt)),fr.selector=Me}return fr}function rc(Me,Ke,mt,Tt){var Ut,fr,Br,Zr,Pr,Gi=typeof Me=="function"&&Me,qr=!Tt&&Ru(Me=Gi.selector||Me);if(mt=mt||[],qr.length===1){if(fr=qr[0]=qr[0].slice(0),fr.length>2&&(Br=fr[0]).type==="ID"&&Ke.nodeType===9&&Ve&&V.relative[fr[1].type]){if(Ke=(V.find.ID(Br.matches[0].replace(Ea,cs),Ke)||[])[0],Ke)Gi&&(Ke=Ke.parentNode);else return mt;Me=Me.slice(fr.shift().value.length)}for(Ut=Si.needsContext.test(Me)?0:fr.length;Ut--&&(Br=fr[Ut],!V.relative[Zr=Br.type]);)if((Pr=V.find[Zr])&&(Tt=Pr(Br.matches[0].replace(Ea,cs),La.test(fr[0].type)&&_d(Ke.parentNode)||Ke))){if(fr.splice(Ut,1),Me=Tt.length&&Yo(fr),!Me)return de.apply(mt,Tt),mt;break}}return(Gi||gh(Me,qr))(Tt,Ke,!Ve,mt,!Ke||La.test(Me)&&_d(Ke.parentNode)||Ke),mt}h.sortStable=Vt.split("").sort(Ha).join("")===Vt,xc(),h.sortDetached=Wc(function(Me){return Me.compareDocumentPosition(ye.createElement("fieldset"))&1}),x.find=Ni,x.expr[":"]=x.expr.pseudos,x.unique=x.uniqueSort,Ni.compile=gh,Ni.select=rc,Ni.setDocument=xc,Ni.tokenize=Ru,Ni.escape=x.escapeSelector,Ni.getText=x.text,Ni.isXML=x.isXMLDoc,Ni.selectors=x.expr,Ni.support=x.support,Ni.uniqueSort=x.uniqueSort})();var v=function(S,V,ee){for(var ie=[],he=ee!==void 0;(S=S[V])&&S.nodeType!==9;)if(S.nodeType===1){if(he&&x(S).is(ee))break;ie.push(S)}return ie},N=function(S,V){for(var ee=[];S;S=S.nextSibling)S.nodeType===1&&S!==V&&ee.push(S);return ee},R=x.expr.match.needsContext,q=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function P(S,V,ee){return f(V)?x.grep(S,function(ie,he){return!!V.call(ie,he,ie)!==ee}):V.nodeType?x.grep(S,function(ie){return ie===V!==ee}):typeof V!="string"?x.grep(S,function(ie){return o.call(V,ie)>-1!==ee}):x.filter(V,S,ee)}x.filter=function(S,V,ee){var ie=V[0];return ee&&(S=":not("+S+")"),V.length===1&&ie.nodeType===1?x.find.matchesSelector(ie,S)?[ie]:[]:x.find.matches(S,x.grep(V,function(he){return he.nodeType===1}))},x.fn.extend({find:function(S){var V,ee,ie=this.length,he=this;if(typeof S!="string")return this.pushStack(x(S).filter(function(){for(V=0;V<ie;V++)if(x.contains(he[V],this))return!0}));for(ee=this.pushStack([]),V=0;V<ie;V++)x.find(S,he[V],ee);return ie>1?x.uniqueSort(ee):ee},filter:function(S){return this.pushStack(P(this,S||[],!1))},not:function(S){return this.pushStack(P(this,S||[],!0))},is:function(S){return!!P(this,typeof S=="string"&&R.test(S)?x(S):S||[],!1).length}});var z,W=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,oe=x.fn.init=function(S,V,ee){var ie,he;if(!S)return this;if(ee=ee||z,typeof S=="string")if(S[0]==="<"&&S[S.length-1]===">"&&S.length>=3?ie=[null,S,null]:ie=W.exec(S),ie&&(ie[1]||!V))if(ie[1]){if(V=V instanceof x?V[0]:V,x.merge(this,x.parseHTML(ie[1],V&&V.nodeType?V.ownerDocument||V:m,!0)),q.test(ie[1])&&x.isPlainObject(V))for(ie in V)f(this[ie])?this[ie](V[ie]):this.attr(ie,V[ie]);return this}else return he=m.getElementById(ie[2]),he&&(this[0]=he,this.length=1),this;else return!V||V.jquery?(V||ee).find(S):this.constructor(V).find(S);else{if(S.nodeType)return this[0]=S,this.length=1,this;if(f(S))return ee.ready!==void 0?ee.ready(S):S(x)}return x.makeArray(S,this)};oe.prototype=x.fn,z=x(m);var Ae=/^(?:parents|prev(?:Until|All))/,me={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({has:function(S){var V=x(S,this),ee=V.length;return this.filter(function(){for(var ie=0;ie<ee;ie++)if(x.contains(this,V[ie]))return!0})},closest:function(S,V){var ee,ie=0,he=this.length,de=[],ye=typeof S!="string"&&x(S);if(!R.test(S)){for(;ie<he;ie++)for(ee=this[ie];ee&&ee!==V;ee=ee.parentNode)if(ee.nodeType<11&&(ye?ye.index(ee)>-1:ee.nodeType===1&&x.find.matchesSelector(ee,S))){de.push(ee);break}}return this.pushStack(de.length>1?x.uniqueSort(de):de)},index:function(S){return S?typeof S=="string"?o.call(x(S),this[0]):o.call(this,S.jquery?S[0]:S):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(S,V){return this.pushStack(x.uniqueSort(x.merge(this.get(),x(S,V))))},addBack:function(S){return this.add(S==null?this.prevObject:this.prevObject.filter(S))}});function ve(S,V){for(;(S=S[V])&&S.nodeType!==1;);return S}x.each({parent:function(S){var V=S.parentNode;return V&&V.nodeType!==11?V:null},parents:function(S){return v(S,"parentNode")},parentsUntil:function(S,V,ee){return v(S,"parentNode",ee)},next:function(S){return ve(S,"nextSibling")},prev:function(S){return ve(S,"previousSibling")},nextAll:function(S){return v(S,"nextSibling")},prevAll:function(S){return v(S,"previousSibling")},nextUntil:function(S,V,ee){return v(S,"nextSibling",ee)},prevUntil:function(S,V,ee){return v(S,"previousSibling",ee)},siblings:function(S){return N((S.parentNode||{}).firstChild,S)},children:function(S){return N(S.firstChild)},contents:function(S){return S.contentDocument!=null&&i(S.contentDocument)?S.contentDocument:(C(S,"template")&&(S=S.content||S),x.merge([],S.childNodes))}},function(S,V){x.fn[S]=function(ee,ie){var he=x.map(this,V,ee);return S.slice(-5)!=="Until"&&(ie=ee),ie&&typeof ie=="string"&&(he=x.filter(ie,he)),this.length>1&&(me[S]||x.uniqueSort(he),Ae.test(S)&&he.reverse()),this.pushStack(he)}});var Le=/[^\x20\t\r\n\f]+/g;function He(S){var V={};return x.each(S.match(Le)||[],function(ee,ie){V[ie]=!0}),V}x.Callbacks=function(S){S=typeof S=="string"?He(S):x.extend({},S);var V,ee,ie,he,de=[],ye=[],Qe=-1,Ve=function(){for(he=he||S.once,ie=V=!0;ye.length;Qe=-1)for(ee=ye.shift();++Qe<de.length;)de[Qe].apply(ee[0],ee[1])===!1&&S.stopOnFalse&&(Qe=de.length,ee=!1);S.memory||(ee=!1),V=!1,he&&(ee?de=[]:de="")},at={add:function(){return de&&(ee&&!V&&(Qe=de.length-1,ye.push(ee)),(function Ot(Vt){x.each(Vt,function(Bt,hr){f(hr)?(!S.unique||!at.has(hr))&&de.push(hr):hr&&hr.length&&b(hr)!=="string"&&Ot(hr)})})(arguments),ee&&!V&&Ve()),this},remove:function(){return x.each(arguments,function(Ot,Vt){for(var Bt;(Bt=x.inArray(Vt,de,Bt))>-1;)de.splice(Bt,1),Bt<=Qe&&Qe--}),this},has:function(Ot){return Ot?x.inArray(Ot,de)>-1:de.length>0},empty:function(){return de&&(de=[]),this},disable:function(){return he=ye=[],de=ee="",this},disabled:function(){return!de},lock:function(){return he=ye=[],!ee&&!V&&(de=ee=""),this},locked:function(){return!!he},fireWith:function(Ot,Vt){return he||(Vt=Vt||[],Vt=[Ot,Vt.slice?Vt.slice():Vt],ye.push(Vt),V||Ve()),this},fire:function(){return at.fireWith(this,arguments),this},fired:function(){return!!ie}};return at};function rt(S){return S}function qe(S){throw S}function xt(S,V,ee,ie){var he;try{S&&f(he=S.promise)?he.call(S).done(V).fail(ee):S&&f(he=S.then)?he.call(S,V,ee):V.apply(void 0,[S].slice(ie))}catch(de){ee.apply(void 0,[de])}}x.extend({Deferred:function(S){var V=[["notify","progress",x.Callbacks("memory"),x.Callbacks("memory"),2],["resolve","done",x.Callbacks("once memory"),x.Callbacks("once memory"),0,"resolved"],["reject","fail",x.Callbacks("once memory"),x.Callbacks("once memory"),1,"rejected"]],ee="pending",ie={state:function(){return ee},always:function(){return he.done(arguments).fail(arguments),this},catch:function(de){return ie.then(null,de)},pipe:function(){var de=arguments;return x.Deferred(function(ye){x.each(V,function(Qe,Ve){var at=f(de[Ve[4]])&&de[Ve[4]];he[Ve[1]](function(){var Ot=at&&at.apply(this,arguments);Ot&&f(Ot.promise)?Ot.promise().progress(ye.notify).done(ye.resolve).fail(ye.reject):ye[Ve[0]+"With"](this,at?[Ot]:arguments)})}),de=null}).promise()},then:function(de,ye,Qe){var Ve=0;function at(Ot,Vt,Bt,hr){return function(){var Oi=this,gn=arguments,Ji=function(){var Ha,J;if(!(Ot<Ve)){if(Ha=Bt.apply(Oi,gn),Ha===Vt.promise())throw new TypeError("Thenable self-resolution");J=Ha&&(typeof Ha=="object"||typeof Ha=="function")&&Ha.then,f(J)?hr?J.call(Ha,at(Ve,Vt,rt,hr),at(Ve,Vt,qe,hr)):(Ve++,J.call(Ha,at(Ve,Vt,rt,hr),at(Ve,Vt,qe,hr),at(Ve,Vt,rt,Vt.notifyWith))):(Bt!==rt&&(Oi=void 0,gn=[Ha]),(hr||Vt.resolveWith)(Oi,gn))}},Vs=hr?Ji:function(){try{Ji()}catch(Ha){x.Deferred.exceptionHook&&x.Deferred.exceptionHook(Ha,Vs.error),Ot+1>=Ve&&(Bt!==qe&&(Oi=void 0,gn=[Ha]),Vt.rejectWith(Oi,gn))}};Ot?Vs():(x.Deferred.getErrorHook?Vs.error=x.Deferred.getErrorHook():x.Deferred.getStackHook&&(Vs.error=x.Deferred.getStackHook()),t.setTimeout(Vs))}}return x.Deferred(function(Ot){V[0][3].add(at(0,Ot,f(Qe)?Qe:rt,Ot.notifyWith)),V[1][3].add(at(0,Ot,f(de)?de:rt)),V[2][3].add(at(0,Ot,f(ye)?ye:qe))}).promise()},promise:function(de){return de!=null?x.extend(de,ie):ie}},he={};return x.each(V,function(de,ye){var Qe=ye[2],Ve=ye[5];ie[ye[1]]=Qe.add,Ve&&Qe.add(function(){ee=Ve},V[3-de][2].disable,V[3-de][3].disable,V[0][2].lock,V[0][3].lock),Qe.add(ye[3].fire),he[ye[0]]=function(){return he[ye[0]+"With"](this===he?void 0:this,arguments),this},he[ye[0]+"With"]=Qe.fireWith}),ie.promise(he),S&&S.call(he,he),he},when:function(S){var V=arguments.length,ee=V,ie=Array(ee),he=n.call(arguments),de=x.Deferred(),ye=function(Qe){return function(Ve){ie[Qe]=this,he[Qe]=arguments.length>1?n.call(arguments):Ve,--V||de.resolveWith(ie,he)}};if(V<=1&&(xt(S,de.done(ye(ee)).resolve,de.reject,!V),de.state()==="pending"||f(he[ee]&&he[ee].then)))return de.then();for(;ee--;)xt(he[ee],ye(ee),de.reject);return de.promise()}});var Gt=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;x.Deferred.exceptionHook=function(S,V){t.console&&t.console.warn&&S&&Gt.test(S.name)&&t.console.warn("jQuery.Deferred exception: "+S.message,S.stack,V)},x.readyException=function(S){t.setTimeout(function(){throw S})};var ut=x.Deferred();x.fn.ready=function(S){return ut.then(S).catch(function(V){x.readyException(V)}),this},x.extend({isReady:!1,readyWait:1,ready:function(S){(S===!0?--x.readyWait:x.isReady)||(x.isReady=!0,!(S!==!0&&--x.readyWait>0)&&ut.resolveWith(m,[x]))}}),x.ready.then=ut.then;function Pe(){m.removeEventListener("DOMContentLoaded",Pe),t.removeEventListener("load",Pe),x.ready()}m.readyState==="complete"||m.readyState!=="loading"&&!m.documentElement.doScroll?t.setTimeout(x.ready):(m.addEventListener("DOMContentLoaded",Pe),t.addEventListener("load",Pe));var ft=function(S,V,ee,ie,he,de,ye){var Qe=0,Ve=S.length,at=ee==null;if(b(ee)==="object"){he=!0;for(Qe in ee)ft(S,V,Qe,ee[Qe],!0,de,ye)}else if(ie!==void 0&&(he=!0,f(ie)||(ye=!0),at&&(ye?(V.call(S,ie),V=null):(at=V,V=function(Ot,Vt,Bt){return at.call(x(Ot),Bt)})),V))for(;Qe<Ve;Qe++)V(S[Qe],ee,ye?ie:ie.call(S[Qe],Qe,V(S[Qe],ee)));return he?S:at?V.call(S):Ve?V(S[0],ee):de},ht=/^-ms-/,Qt=/-([a-z])/g;function Yt(S,V){return V.toUpperCase()}function Ft(S){return S.replace(ht,"ms-").replace(Qt,Yt)}var kt=function(S){return S.nodeType===1||S.nodeType===9||!+S.nodeType};function sr(){this.expando=x.expando+sr.uid++}sr.uid=1,sr.prototype={cache:function(S){var V=S[this.expando];return V||(V={},kt(S)&&(S.nodeType?S[this.expando]=V:Object.defineProperty(S,this.expando,{value:V,configurable:!0}))),V},set:function(S,V,ee){var ie,he=this.cache(S);if(typeof V=="string")he[Ft(V)]=ee;else for(ie in V)he[Ft(ie)]=V[ie];return he},get:function(S,V){return V===void 0?this.cache(S):S[this.expando]&&S[this.expando][Ft(V)]},access:function(S,V,ee){return V===void 0||V&&typeof V=="string"&&ee===void 0?this.get(S,V):(this.set(S,V,ee),ee!==void 0?ee:V)},remove:function(S,V){var ee,ie=S[this.expando];if(ie!==void 0){if(V!==void 0)for(Array.isArray(V)?V=V.map(Ft):(V=Ft(V),V=V in ie?[V]:V.match(Le)||[]),ee=V.length;ee--;)delete ie[V[ee]];(V===void 0||x.isEmptyObject(ie))&&(S.nodeType?S[this.expando]=void 0:delete S[this.expando])}},hasData:function(S){var V=S[this.expando];return V!==void 0&&!x.isEmptyObject(V)}};var Pt=new sr,_r=new sr,Lt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ct=/[A-Z]/g;function Zt(S){return S==="true"?!0:S==="false"?!1:S==="null"?null:S===+S+""?+S:Lt.test(S)?JSON.parse(S):S}function Jt(S,V,ee){var ie;if(ee===void 0&&S.nodeType===1)if(ie="data-"+V.replace(ct,"-$&").toLowerCase(),ee=S.getAttribute(ie),typeof ee=="string"){try{ee=Zt(ee)}catch{}_r.set(S,V,ee)}else ee=void 0;return ee}x.extend({hasData:function(S){return _r.hasData(S)||Pt.hasData(S)},data:function(S,V,ee){return _r.access(S,V,ee)},removeData:function(S,V){_r.remove(S,V)},_data:function(S,V,ee){return Pt.access(S,V,ee)},_removeData:function(S,V){Pt.remove(S,V)}}),x.fn.extend({data:function(S,V){var ee,ie,he,de=this[0],ye=de&&de.attributes;if(S===void 0){if(this.length&&(he=_r.get(de),de.nodeType===1&&!Pt.get(de,"hasDataAttrs"))){for(ee=ye.length;ee--;)ye[ee]&&(ie=ye[ee].name,ie.indexOf("data-")===0&&(ie=Ft(ie.slice(5)),Jt(de,ie,he[ie])));Pt.set(de,"hasDataAttrs",!0)}return he}return typeof S=="object"?this.each(function(){_r.set(this,S)}):ft(this,function(Qe){var Ve;if(de&&Qe===void 0)return Ve=_r.get(de,S),Ve!==void 0||(Ve=Jt(de,S),Ve!==void 0)?Ve:void 0;this.each(function(){_r.set(this,S,Qe)})},null,V,arguments.length>1,null,!0)},removeData:function(S){return this.each(function(){_r.remove(this,S)})}}),x.extend({queue:function(S,V,ee){var ie;if(S)return V=(V||"fx")+"queue",ie=Pt.get(S,V),ee&&(!ie||Array.isArray(ee)?ie=Pt.access(S,V,x.makeArray(ee)):ie.push(ee)),ie||[]},dequeue:function(S,V){V=V||"fx";var ee=x.queue(S,V),ie=ee.length,he=ee.shift(),de=x._queueHooks(S,V),ye=function(){x.dequeue(S,V)};he==="inprogress"&&(he=ee.shift(),ie--),he&&(V==="fx"&&ee.unshift("inprogress"),delete de.stop,he.call(S,ye,de)),!ie&&de&&de.empty.fire()},_queueHooks:function(S,V){var ee=V+"queueHooks";return Pt.get(S,ee)||Pt.access(S,ee,{empty:x.Callbacks("once memory").add(function(){Pt.remove(S,[V+"queue",ee])})})}}),x.fn.extend({queue:function(S,V){var ee=2;return typeof S!="string"&&(V=S,S="fx",ee--),arguments.length<ee?x.queue(this[0],S):V===void 0?this:this.each(function(){var ie=x.queue(this,S,V);x._queueHooks(this,S),S==="fx"&&ie[0]!=="inprogress"&&x.dequeue(this,S)})},dequeue:function(S){return this.each(function(){x.dequeue(this,S)})},clearQueue:function(S){return this.queue(S||"fx",[])},promise:function(S,V){var ee,ie=1,he=x.Deferred(),de=this,ye=this.length,Qe=function(){--ie||he.resolveWith(de,[de])};for(typeof S!="string"&&(V=S,S=void 0),S=S||"fx";ye--;)ee=Pt.get(de[ye],S+"queueHooks"),ee&&ee.empty&&(ie++,ee.empty.add(Qe));return Qe(),he.promise(V)}});var O=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,K=new RegExp("^(?:([+-])=|)("+O+")([a-z%]*)$","i"),se=["Top","Right","Bottom","Left"],ae=m.documentElement,ue=function(S){return x.contains(S.ownerDocument,S)},Ie={composed:!0};ae.getRootNode&&(ue=function(S){return x.contains(S.ownerDocument,S)||S.getRootNode(Ie)===S.ownerDocument});var Ce=function(S,V){return S=V||S,S.style.display==="none"||S.style.display===""&&ue(S)&&x.css(S,"display")==="none"};function st(S,V,ee,ie){var he,de,ye=20,Qe=ie?function(){return ie.cur()}:function(){return x.css(S,V,"")},Ve=Qe(),at=ee&&ee[3]||(x.cssNumber[V]?"":"px"),Ot=S.nodeType&&(x.cssNumber[V]||at!=="px"&&+Ve)&&K.exec(x.css(S,V));if(Ot&&Ot[3]!==at){for(Ve=Ve/2,at=at||Ot[3],Ot=+Ve||1;ye--;)x.style(S,V,Ot+at),(1-de)*(1-(de=Qe()/Ve||.5))<=0&&(ye=0),Ot=Ot/de;Ot=Ot*2,x.style(S,V,Ot+at),ee=ee||[]}return ee&&(Ot=+Ot||+Ve||0,he=ee[1]?Ot+(ee[1]+1)*ee[2]:+ee[2],ie&&(ie.unit=at,ie.start=Ot,ie.end=he)),he}var it={};function Kt(S){var V,ee=S.ownerDocument,ie=S.nodeName,he=it[ie];return he||(V=ee.body.appendChild(ee.createElement(ie)),he=x.css(V,"display"),V.parentNode.removeChild(V),he==="none"&&(he="block"),it[ie]=he,he)}function ar(S,V){for(var ee,ie,he=[],de=0,ye=S.length;de<ye;de++)ie=S[de],ie.style&&(ee=ie.style.display,V?(ee==="none"&&(he[de]=Pt.get(ie,"display")||null,he[de]||(ie.style.display="")),ie.style.display===""&&Ce(ie)&&(he[de]=Kt(ie))):ee!=="none"&&(he[de]="none",Pt.set(ie,"display",ee)));for(de=0;de<ye;de++)he[de]!=null&&(S[de].style.display=he[de]);return S}x.fn.extend({show:function(){return ar(this,!0)},hide:function(){return ar(this)},toggle:function(S){return typeof S=="boolean"?S?this.show():this.hide():this.each(function(){Ce(this)?x(this).show():x(this).hide()})}});var lr=/^(?:checkbox|radio)$/i,yr=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,xi=/^$|^module$|\/(?:java|ecma)script/i;(function(){var S=m.createDocumentFragment(),V=S.appendChild(m.createElement("div")),ee=m.createElement("input");ee.setAttribute("type","radio"),ee.setAttribute("checked","checked"),ee.setAttribute("name","t"),V.appendChild(ee),h.checkClone=V.cloneNode(!0).cloneNode(!0).lastChild.checked,V.innerHTML="<textarea>x</textarea>",h.noCloneChecked=!!V.cloneNode(!0).lastChild.defaultValue,V.innerHTML="<option></option>",h.option=!!V.lastChild})();var Tr={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Tr.tbody=Tr.tfoot=Tr.colgroup=Tr.caption=Tr.thead,Tr.th=Tr.td,h.option||(Tr.optgroup=Tr.option=[1,"<select multiple='multiple'>","</select>"]);function ii(S,V){var ee;return typeof S.getElementsByTagName<"u"?ee=S.getElementsByTagName(V||"*"):typeof S.querySelectorAll<"u"?ee=S.querySelectorAll(V||"*"):ee=[],V===void 0||V&&C(S,V)?x.merge([S],ee):ee}function nn(S,V){for(var ee=0,ie=S.length;ee<ie;ee++)Pt.set(S[ee],"globalEval",!V||Pt.get(V[ee],"globalEval"))}var sn=/<|&#?\w+;/;function Dn(S,V,ee,ie,he){for(var de,ye,Qe,Ve,at,Ot,Vt=V.createDocumentFragment(),Bt=[],hr=0,Oi=S.length;hr<Oi;hr++)if(de=S[hr],de||de===0)if(b(de)==="object")x.merge(Bt,de.nodeType?[de]:de);else if(!sn.test(de))Bt.push(V.createTextNode(de));else{for(ye=ye||Vt.appendChild(V.createElement("div")),Qe=(yr.exec(de)||["",""])[1].toLowerCase(),Ve=Tr[Qe]||Tr._default,ye.innerHTML=Ve[1]+x.htmlPrefilter(de)+Ve[2],Ot=Ve[0];Ot--;)ye=ye.lastChild;x.merge(Bt,ye.childNodes),ye=Vt.firstChild,ye.textContent=""}for(Vt.textContent="",hr=0;de=Bt[hr++];){if(ie&&x.inArray(de,ie)>-1){he&&he.push(de);continue}if(at=ue(de),ye=ii(Vt.appendChild(de),"script"),at&&nn(ye),ee)for(Ot=0;de=ye[Ot++];)xi.test(de.type||"")&&ee.push(de)}return Vt}var Za=/^([^.]*)(?:\.(.+)|)/;function ai(){return!0}function xa(){return!1}function Lr(S,V,ee,ie,he,de){var ye,Qe;if(typeof V=="object"){typeof ee!="string"&&(ie=ie||ee,ee=void 0);for(Qe in V)Lr(S,Qe,ee,ie,V[Qe],de);return S}if(ie==null&&he==null?(he=ee,ie=ee=void 0):he==null&&(typeof ee=="string"?(he=ie,ie=void 0):(he=ie,ie=ee,ee=void 0)),he===!1)he=xa;else if(!he)return S;return de===1&&(ye=he,he=function(Ve){return x().off(Ve),ye.apply(this,arguments)},he.guid=ye.guid||(ye.guid=x.guid++)),S.each(function(){x.event.add(this,V,he,ie,ee)})}x.event={global:{},add:function(S,V,ee,ie,he){var de,ye,Qe,Ve,at,Ot,Vt,Bt,hr,Oi,gn,Ji=Pt.get(S);if(kt(S))for(ee.handler&&(de=ee,ee=de.handler,he=de.selector),he&&x.find.matchesSelector(ae,he),ee.guid||(ee.guid=x.guid++),(Ve=Ji.events)||(Ve=Ji.events=Object.create(null)),(ye=Ji.handle)||(ye=Ji.handle=function(Vs){return typeof x<"u"&&x.event.triggered!==Vs.type?x.event.dispatch.apply(S,arguments):void 0}),V=(V||"").match(Le)||[""],at=V.length;at--;)Qe=Za.exec(V[at])||[],hr=gn=Qe[1],Oi=(Qe[2]||"").split(".").sort(),hr&&(Vt=x.event.special[hr]||{},hr=(he?Vt.delegateType:Vt.bindType)||hr,Vt=x.event.special[hr]||{},Ot=x.extend({type:hr,origType:gn,data:ie,handler:ee,guid:ee.guid,selector:he,needsContext:he&&x.expr.match.needsContext.test(he),namespace:Oi.join(".")},de),(Bt=Ve[hr])||(Bt=Ve[hr]=[],Bt.delegateCount=0,(!Vt.setup||Vt.setup.call(S,ie,Oi,ye)===!1)&&S.addEventListener&&S.addEventListener(hr,ye)),Vt.add&&(Vt.add.call(S,Ot),Ot.handler.guid||(Ot.handler.guid=ee.guid)),he?Bt.splice(Bt.delegateCount++,0,Ot):Bt.push(Ot),x.event.global[hr]=!0)},remove:function(S,V,ee,ie,he){var de,ye,Qe,Ve,at,Ot,Vt,Bt,hr,Oi,gn,Ji=Pt.hasData(S)&&Pt.get(S);if(!(!Ji||!(Ve=Ji.events))){for(V=(V||"").match(Le)||[""],at=V.length;at--;){if(Qe=Za.exec(V[at])||[],hr=gn=Qe[1],Oi=(Qe[2]||"").split(".").sort(),!hr){for(hr in Ve)x.event.remove(S,hr+V[at],ee,ie,!0);continue}for(Vt=x.event.special[hr]||{},hr=(ie?Vt.delegateType:Vt.bindType)||hr,Bt=Ve[hr]||[],Qe=Qe[2]&&new RegExp("(^|\\.)"+Oi.join("\\.(?:.*\\.|)")+"(\\.|$)"),ye=de=Bt.length;de--;)Ot=Bt[de],(he||gn===Ot.origType)&&(!ee||ee.guid===Ot.guid)&&(!Qe||Qe.test(Ot.namespace))&&(!ie||ie===Ot.selector||ie==="**"&&Ot.selector)&&(Bt.splice(de,1),Ot.selector&&Bt.delegateCount--,Vt.remove&&Vt.remove.call(S,Ot));ye&&!Bt.length&&((!Vt.teardown||Vt.teardown.call(S,Oi,Ji.handle)===!1)&&x.removeEvent(S,hr,Ji.handle),delete Ve[hr])}x.isEmptyObject(Ve)&&Pt.remove(S,"handle events")}},dispatch:function(S){var V,ee,ie,he,de,ye,Qe=new Array(arguments.length),Ve=x.event.fix(S),at=(Pt.get(this,"events")||Object.create(null))[Ve.type]||[],Ot=x.event.special[Ve.type]||{};for(Qe[0]=Ve,V=1;V<arguments.length;V++)Qe[V]=arguments[V];if(Ve.delegateTarget=this,!(Ot.preDispatch&&Ot.preDispatch.call(this,Ve)===!1)){for(ye=x.event.handlers.call(this,Ve,at),V=0;(he=ye[V++])&&!Ve.isPropagationStopped();)for(Ve.currentTarget=he.elem,ee=0;(de=he.handlers[ee++])&&!Ve.isImmediatePropagationStopped();)(!Ve.rnamespace||de.namespace===!1||Ve.rnamespace.test(de.namespace))&&(Ve.handleObj=de,Ve.data=de.data,ie=((x.event.special[de.origType]||{}).handle||de.handler).apply(he.elem,Qe),ie!==void 0&&(Ve.result=ie)===!1&&(Ve.preventDefault(),Ve.stopPropagation()));return Ot.postDispatch&&Ot.postDispatch.call(this,Ve),Ve.result}},handlers:function(S,V){var ee,ie,he,de,ye,Qe=[],Ve=V.delegateCount,at=S.target;if(Ve&&at.nodeType&&!(S.type==="click"&&S.button>=1)){for(;at!==this;at=at.parentNode||this)if(at.nodeType===1&&!(S.type==="click"&&at.disabled===!0)){for(de=[],ye={},ee=0;ee<Ve;ee++)ie=V[ee],he=ie.selector+" ",ye[he]===void 0&&(ye[he]=ie.needsContext?x(he,this).index(at)>-1:x.find(he,this,null,[at]).length),ye[he]&&de.push(ie);de.length&&Qe.push({elem:at,handlers:de})}}return at=this,Ve<V.length&&Qe.push({elem:at,handlers:V.slice(Ve)}),Qe},addProp:function(S,V){Object.defineProperty(x.Event.prototype,S,{enumerable:!0,configurable:!0,get:f(V)?function(){if(this.originalEvent)return V(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[S]},set:function(ee){Object.defineProperty(this,S,{enumerable:!0,configurable:!0,writable:!0,value:ee})}})},fix:function(S){return S[x.expando]?S:new x.Event(S)},special:{load:{noBubble:!0},click:{setup:function(S){var V=this||S;return lr.test(V.type)&&V.click&&C(V,"input")&&mn(V,"click",!0),!1},trigger:function(S){var V=this||S;return lr.test(V.type)&&V.click&&C(V,"input")&&mn(V,"click"),!0},_default:function(S){var V=S.target;return lr.test(V.type)&&V.click&&C(V,"input")&&Pt.get(V,"click")||C(V,"a")}},beforeunload:{postDispatch:function(S){S.result!==void 0&&S.originalEvent&&(S.originalEvent.returnValue=S.result)}}}};function mn(S,V,ee){if(!ee){Pt.get(S,V)===void 0&&x.event.add(S,V,ai);return}Pt.set(S,V,!1),x.event.add(S,V,{namespace:!1,handler:function(ie){var he,de=Pt.get(this,V);if(ie.isTrigger&1&&this[V]){if(de)(x.event.special[V]||{}).delegateType&&ie.stopPropagation();else if(de=n.call(arguments),Pt.set(this,V,de),this[V](),he=Pt.get(this,V),Pt.set(this,V,!1),de!==he)return ie.stopImmediatePropagation(),ie.preventDefault(),he}else de&&(Pt.set(this,V,x.event.trigger(de[0],de.slice(1),this)),ie.stopPropagation(),ie.isImmediatePropagationStopped=ai)}})}x.removeEvent=function(S,V,ee){S.removeEventListener&&S.removeEventListener(V,ee)},x.Event=function(S,V){if(!(this instanceof x.Event))return new x.Event(S,V);S&&S.type?(this.originalEvent=S,this.type=S.type,this.isDefaultPrevented=S.defaultPrevented||S.defaultPrevented===void 0&&S.returnValue===!1?ai:xa,this.target=S.target&&S.target.nodeType===3?S.target.parentNode:S.target,this.currentTarget=S.currentTarget,this.relatedTarget=S.relatedTarget):this.type=S,V&&x.extend(this,V),this.timeStamp=S&&S.timeStamp||Date.now(),this[x.expando]=!0},x.Event.prototype={constructor:x.Event,isDefaultPrevented:xa,isPropagationStopped:xa,isImmediatePropagationStopped:xa,isSimulated:!1,preventDefault:function(){var S=this.originalEvent;this.isDefaultPrevented=ai,S&&!this.isSimulated&&S.preventDefault()},stopPropagation:function(){var S=this.originalEvent;this.isPropagationStopped=ai,S&&!this.isSimulated&&S.stopPropagation()},stopImmediatePropagation:function(){var S=this.originalEvent;this.isImmediatePropagationStopped=ai,S&&!this.isSimulated&&S.stopImmediatePropagation(),this.stopPropagation()}},x.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},x.event.addProp),x.each({focus:"focusin",blur:"focusout"},function(S,V){function ee(ie){if(m.documentMode){var he=Pt.get(this,"handle"),de=x.event.fix(ie);de.type=ie.type==="focusin"?"focus":"blur",de.isSimulated=!0,he(ie),de.target===de.currentTarget&&he(de)}else x.event.simulate(V,ie.target,x.event.fix(ie))}x.event.special[S]={setup:function(){var ie;if(mn(this,S,!0),m.documentMode)ie=Pt.get(this,V),ie||this.addEventListener(V,ee),Pt.set(this,V,(ie||0)+1);else return!1},trigger:function(){return mn(this,S),!0},teardown:function(){var ie;if(m.documentMode)ie=Pt.get(this,V)-1,ie?Pt.set(this,V,ie):(this.removeEventListener(V,ee),Pt.remove(this,V));else return!1},_default:function(ie){return Pt.get(ie.target,S)},delegateType:V},x.event.special[V]={setup:function(){var ie=this.ownerDocument||this.document||this,he=m.documentMode?this:ie,de=Pt.get(he,V);de||(m.documentMode?this.addEventListener(V,ee):ie.addEventListener(S,ee,!0)),Pt.set(he,V,(de||0)+1)},teardown:function(){var ie=this.ownerDocument||this.document||this,he=m.documentMode?this:ie,de=Pt.get(he,V)-1;de?Pt.set(he,V,de):(m.documentMode?this.removeEventListener(V,ee):ie.removeEventListener(S,ee,!0),Pt.remove(he,V))}}}),x.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(S,V){x.event.special[S]={delegateType:V,bindType:V,handle:function(ee){var ie,he=this,de=ee.relatedTarget,ye=ee.handleObj;return(!de||de!==he&&!x.contains(he,de))&&(ee.type=ye.origType,ie=ye.handler.apply(this,arguments),ee.type=V),ie}}}),x.fn.extend({on:function(S,V,ee,ie){return Lr(this,S,V,ee,ie)},one:function(S,V,ee,ie){return Lr(this,S,V,ee,ie,1)},off:function(S,V,ee){var ie,he;if(S&&S.preventDefault&&S.handleObj)return ie=S.handleObj,x(S.delegateTarget).off(ie.namespace?ie.origType+"."+ie.namespace:ie.origType,ie.selector,ie.handler),this;if(typeof S=="object"){for(he in S)this.off(he,V,S[he]);return this}return(V===!1||typeof V=="function")&&(ee=V,V=void 0),ee===!1&&(ee=xa),this.each(function(){x.event.remove(this,S,ee,V)})}});var bs=/<script|<style|<link/i,Zi=/checked\s*(?:[^=]|=\s*.checked.)/i,Do=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Su(S,V){return C(S,"table")&&C(V.nodeType!==11?V:V.firstChild,"tr")&&x(S).children("tbody")[0]||S}function gc(S){return S.type=(S.getAttribute("type")!==null)+"/"+S.type,S}function jc(S){return(S.type||"").slice(0,5)==="true/"?S.type=S.type.slice(5):S.removeAttribute("type"),S}function ec(S,V){var ee,ie,he,de,ye,Qe,Ve;if(V.nodeType===1){if(Pt.hasData(S)&&(de=Pt.get(S),Ve=de.events,Ve)){Pt.remove(V,"handle events");for(he in Ve)for(ee=0,ie=Ve[he].length;ee<ie;ee++)x.event.add(V,he,Ve[he][ee])}_r.hasData(S)&&(ye=_r.access(S),Qe=x.extend({},ye),_r.set(V,Qe))}}function Qc(S,V){var ee=V.nodeName.toLowerCase();ee==="input"&&lr.test(S.type)?V.checked=S.checked:(ee==="input"||ee==="textarea")&&(V.defaultValue=S.defaultValue)}function Uo(S,V,ee,ie){V=s(V);var he,de,ye,Qe,Ve,at,Ot=0,Vt=S.length,Bt=Vt-1,hr=V[0],Oi=f(hr);if(Oi||Vt>1&&typeof hr=="string"&&!h.checkClone&&Zi.test(hr))return S.each(function(gn){var Ji=S.eq(gn);Oi&&(V[0]=hr.call(this,gn,Ji.html())),Uo(Ji,V,ee,ie)});if(Vt&&(he=Dn(V,S[0].ownerDocument,!1,S,ie),de=he.firstChild,he.childNodes.length===1&&(he=de),de||ie)){for(ye=x.map(ii(he,"script"),gc),Qe=ye.length;Ot<Vt;Ot++)Ve=he,Ot!==Bt&&(Ve=x.clone(Ve,!0,!0),Qe&&x.merge(ye,ii(Ve,"script"))),ee.call(S[Ot],Ve,Ot);if(Qe)for(at=ye[ye.length-1].ownerDocument,x.map(ye,jc),Ot=0;Ot<Qe;Ot++)Ve=ye[Ot],xi.test(Ve.type||"")&&!Pt.access(Ve,"globalEval")&&x.contains(at,Ve)&&(Ve.src&&(Ve.type||"").toLowerCase()!=="module"?x._evalUrl&&!Ve.noModule&&x._evalUrl(Ve.src,{nonce:Ve.nonce||Ve.getAttribute("nonce")},at):g(Ve.textContent.replace(Do,""),Ve,at))}return S}function ul(S,V,ee){for(var ie,he=V?x.filter(V,S):S,de=0;(ie=he[de])!=null;de++)!ee&&ie.nodeType===1&&x.cleanData(ii(ie)),ie.parentNode&&(ee&&ue(ie)&&nn(ii(ie,"script")),ie.parentNode.removeChild(ie));return S}x.extend({htmlPrefilter:function(S){return S},clone:function(S,V,ee){var ie,he,de,ye,Qe=S.cloneNode(!0),Ve=ue(S);if(!h.noCloneChecked&&(S.nodeType===1||S.nodeType===11)&&!x.isXMLDoc(S))for(ye=ii(Qe),de=ii(S),ie=0,he=de.length;ie<he;ie++)Qc(de[ie],ye[ie]);if(V)if(ee)for(de=de||ii(S),ye=ye||ii(Qe),ie=0,he=de.length;ie<he;ie++)ec(de[ie],ye[ie]);else ec(S,Qe);return ye=ii(Qe,"script"),ye.length>0&&nn(ye,!Ve&&ii(S,"script")),Qe},cleanData:function(S){for(var V,ee,ie,he=x.event.special,de=0;(ee=S[de])!==void 0;de++)if(kt(ee)){if(V=ee[Pt.expando]){if(V.events)for(ie in V.events)he[ie]?x.event.remove(ee,ie):x.removeEvent(ee,ie,V.handle);ee[Pt.expando]=void 0}ee[_r.expando]&&(ee[_r.expando]=void 0)}}}),x.fn.extend({detach:function(S){return ul(this,S,!0)},remove:function(S){return ul(this,S)},text:function(S){return ft(this,function(V){return V===void 0?x.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=V)})},null,S,arguments.length)},append:function(){return Uo(this,arguments,function(S){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var V=Su(this,S);V.appendChild(S)}})},prepend:function(){return Uo(this,arguments,function(S){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var V=Su(this,S);V.insertBefore(S,V.firstChild)}})},before:function(){return Uo(this,arguments,function(S){this.parentNode&&this.parentNode.insertBefore(S,this)})},after:function(){return Uo(this,arguments,function(S){this.parentNode&&this.parentNode.insertBefore(S,this.nextSibling)})},empty:function(){for(var S,V=0;(S=this[V])!=null;V++)S.nodeType===1&&(x.cleanData(ii(S,!1)),S.textContent="");return this},clone:function(S,V){return S=S==null?!1:S,V=V==null?S:V,this.map(function(){return x.clone(this,S,V)})},html:function(S){return ft(this,function(V){var ee=this[0]||{},ie=0,he=this.length;if(V===void 0&&ee.nodeType===1)return ee.innerHTML;if(typeof V=="string"&&!bs.test(V)&&!Tr[(yr.exec(V)||["",""])[1].toLowerCase()]){V=x.htmlPrefilter(V);try{for(;ie<he;ie++)ee=this[ie]||{},ee.nodeType===1&&(x.cleanData(ii(ee,!1)),ee.innerHTML=V);ee=0}catch{}}ee&&this.empty().append(V)},null,S,arguments.length)},replaceWith:function(){var S=[];return Uo(this,arguments,function(V){var ee=this.parentNode;x.inArray(this,S)<0&&(x.cleanData(ii(this)),ee&&ee.replaceChild(V,this))},S)}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(S,V){x.fn[S]=function(ee){for(var ie,he=[],de=x(ee),ye=de.length-1,Qe=0;Qe<=ye;Qe++)ie=Qe===ye?this:this.clone(!0),x(de[Qe])[V](ie),a.apply(he,ie.get());return this.pushStack(he)}});var hl=new RegExp("^("+O+")(?!px)[a-z%]+$","i"),Ms=/^--/,Tu=function(S){var V=S.ownerDocument.defaultView;return(!V||!V.opener)&&(V=t),V.getComputedStyle(S)},ha=function(S,V,ee){var ie,he,de={};for(he in V)de[he]=S.style[he],S.style[he]=V[he];ie=ee.call(S);for(he in V)S.style[he]=de[he];return ie},Sd=new RegExp(se.join("|"),"i");(function(){function S(){if(at){Ve.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",at.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ae.appendChild(Ve).appendChild(at);var Ot=t.getComputedStyle(at);ee=Ot.top!=="1%",Qe=V(Ot.marginLeft)===12,at.style.right="60%",de=V(Ot.right)===36,ie=V(Ot.width)===36,at.style.position="absolute",he=V(at.offsetWidth/3)===12,ae.removeChild(Ve),at=null}}function V(Ot){return Math.round(parseFloat(Ot))}var ee,ie,he,de,ye,Qe,Ve=m.createElement("div"),at=m.createElement("div");at.style&&(at.style.backgroundClip="content-box",at.cloneNode(!0).style.backgroundClip="",h.clearCloneStyle=at.style.backgroundClip==="content-box",x.extend(h,{boxSizingReliable:function(){return S(),ie},pixelBoxStyles:function(){return S(),de},pixelPosition:function(){return S(),ee},reliableMarginLeft:function(){return S(),Qe},scrollboxSize:function(){return S(),he},reliableTrDimensions:function(){var Ot,Vt,Bt,hr;return ye==null&&(Ot=m.createElement("table"),Vt=m.createElement("tr"),Bt=m.createElement("div"),Ot.style.cssText="position:absolute;left:-11111px;border-collapse:separate",Vt.style.cssText="box-sizing:content-box;border:1px solid",Vt.style.height="1px",Bt.style.height="9px",Bt.style.display="block",ae.appendChild(Ot).appendChild(Vt).appendChild(Bt),hr=t.getComputedStyle(Vt),ye=parseInt(hr.height,10)+parseInt(hr.borderTopWidth,10)+parseInt(hr.borderBottomWidth,10)===Vt.offsetHeight,ae.removeChild(Ot)),ye}}))})();function is(S,V,ee){var ie,he,de,ye,Qe=Ms.test(V),Ve=S.style;return ee=ee||Tu(S),ee&&(ye=ee.getPropertyValue(V)||ee[V],Qe&&ye&&(ye=ye.replace(Q,"$1")||void 0),ye===""&&!ue(S)&&(ye=x.style(S,V)),!h.pixelBoxStyles()&&hl.test(ye)&&Sd.test(V)&&(ie=Ve.width,he=Ve.minWidth,de=Ve.maxWidth,Ve.minWidth=Ve.maxWidth=Ve.width=ye,ye=ee.width,Ve.width=ie,Ve.minWidth=he,Ve.maxWidth=de)),ye!==void 0?ye+"":ye}function uh(S,V){return{get:function(){if(S()){delete this.get;return}return(this.get=V).apply(this,arguments)}}}var Iu=["Webkit","Moz","ms"],oA=m.createElement("div").style,yc={};function lA(S){for(var V=S[0].toUpperCase()+S.slice(1),ee=Iu.length;ee--;)if(S=Iu[ee]+V,S in oA)return S}function Bu(S){var V=x.cssProps[S]||yc[S];return V||(S in oA?S:yc[S]=lA(S)||S)}var Du=/^(none|table(?!-c[ea]).+)/,uf={position:"absolute",visibility:"hidden",display:"block"},Bl={letterSpacing:"0",fontWeight:"400"};function _u(S,V,ee){var ie=K.exec(V);return ie?Math.max(0,ie[2]-(ee||0))+(ie[3]||"px"):V}function Pu(S,V,ee,ie,he,de){var ye=V==="width"?1:0,Qe=0,Ve=0,at=0;if(ee===(ie?"border":"content"))return 0;for(;ye<4;ye+=2)ee==="margin"&&(at+=x.css(S,ee+se[ye],!0,he)),ie?(ee==="content"&&(Ve-=x.css(S,"padding"+se[ye],!0,he)),ee!=="margin"&&(Ve-=x.css(S,"border"+se[ye]+"Width",!0,he))):(Ve+=x.css(S,"padding"+se[ye],!0,he),ee!=="padding"?Ve+=x.css(S,"border"+se[ye]+"Width",!0,he):Qe+=x.css(S,"border"+se[ye]+"Width",!0,he));return!ie&&de>=0&&(Ve+=Math.max(0,Math.ceil(S["offset"+V[0].toUpperCase()+V.slice(1)]-de-Ve-Qe-.5))||0),Ve+at}function hh(S,V,ee){var ie=Tu(S),he=!h.boxSizingReliable()||ee,de=he&&x.css(S,"boxSizing",!1,ie)==="border-box",ye=de,Qe=is(S,V,ie),Ve="offset"+V[0].toUpperCase()+V.slice(1);if(hl.test(Qe)){if(!ee)return Qe;Qe="auto"}return(!h.boxSizingReliable()&&de||!h.reliableTrDimensions()&&C(S,"tr")||Qe==="auto"||!parseFloat(Qe)&&x.css(S,"display",!1,ie)==="inline")&&S.getClientRects().length&&(de=x.css(S,"boxSizing",!1,ie)==="border-box",ye=Ve in S,ye&&(Qe=S[Ve])),Qe=parseFloat(Qe)||0,Qe+Pu(S,V,ee||(de?"border":"content"),ye,ie,Qe)+"px"}x.extend({cssHooks:{opacity:{get:function(S,V){if(V){var ee=is(S,"opacity");return ee===""?"1":ee}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(S,V,ee,ie){if(!(!S||S.nodeType===3||S.nodeType===8||!S.style)){var he,de,ye,Qe=Ft(V),Ve=Ms.test(V),at=S.style;if(Ve||(V=Bu(Qe)),ye=x.cssHooks[V]||x.cssHooks[Qe],ee!==void 0){if(de=typeof ee,de==="string"&&(he=K.exec(ee))&&he[1]&&(ee=st(S,V,he),de="number"),ee==null||ee!==ee)return;de==="number"&&!Ve&&(ee+=he&&he[3]||(x.cssNumber[Qe]?"":"px")),!h.clearCloneStyle&&ee===""&&V.indexOf("background")===0&&(at[V]="inherit"),(!ye||!("set"in ye)||(ee=ye.set(S,ee,ie))!==void 0)&&(Ve?at.setProperty(V,ee):at[V]=ee)}else return ye&&"get"in ye&&(he=ye.get(S,!1,ie))!==void 0?he:at[V]}},css:function(S,V,ee,ie){var he,de,ye,Qe=Ft(V),Ve=Ms.test(V);return Ve||(V=Bu(Qe)),ye=x.cssHooks[V]||x.cssHooks[Qe],ye&&"get"in ye&&(he=ye.get(S,!0,ee)),he===void 0&&(he=is(S,V,ie)),he==="normal"&&V in Bl&&(he=Bl[V]),ee===""||ee?(de=parseFloat(he),ee===!0||isFinite(de)?de||0:he):he}}),x.each(["height","width"],function(S,V){x.cssHooks[V]={get:function(ee,ie,he){if(ie)return Du.test(x.css(ee,"display"))&&(!ee.getClientRects().length||!ee.getBoundingClientRect().width)?ha(ee,uf,function(){return hh(ee,V,he)}):hh(ee,V,he)},set:function(ee,ie,he){var de,ye=Tu(ee),Qe=!h.scrollboxSize()&&ye.position==="absolute",Ve=Qe||he,at=Ve&&x.css(ee,"boxSizing",!1,ye)==="border-box",Ot=he?Pu(ee,V,he,at,ye):0;return at&&Qe&&(Ot-=Math.ceil(ee["offset"+V[0].toUpperCase()+V.slice(1)]-parseFloat(ye[V])-Pu(ee,V,"border",!1,ye)-.5)),Ot&&(de=K.exec(ie))&&(de[3]||"px")!=="px"&&(ee.style[V]=ie,ie=x.css(ee,V)),_u(ee,ie,Ot)}}}),x.cssHooks.marginLeft=uh(h.reliableMarginLeft,function(S,V){if(V)return(parseFloat(is(S,"marginLeft"))||S.getBoundingClientRect().left-ha(S,{marginLeft:0},function(){return S.getBoundingClientRect().left}))+"px"}),x.each({margin:"",padding:"",border:"Width"},function(S,V){x.cssHooks[S+V]={expand:function(ee){for(var ie=0,he={},de=typeof ee=="string"?ee.split(" "):[ee];ie<4;ie++)he[S+se[ie]+V]=de[ie]||de[ie-2]||de[0];return he}},S!=="margin"&&(x.cssHooks[S+V].set=_u)}),x.fn.extend({css:function(S,V){return ft(this,function(ee,ie,he){var de,ye,Qe={},Ve=0;if(Array.isArray(ie)){for(de=Tu(ee),ye=ie.length;Ve<ye;Ve++)Qe[ie[Ve]]=x.css(ee,ie[Ve],!1,de);return Qe}return he!==void 0?x.style(ee,ie,he):x.css(ee,ie)},S,V,arguments.length>1)}});function xn(S,V,ee,ie,he){return new xn.prototype.init(S,V,ee,ie,he)}x.Tween=xn,xn.prototype={constructor:xn,init:function(S,V,ee,ie,he,de){this.elem=S,this.prop=ee,this.easing=he||x.easing._default,this.options=V,this.start=this.now=this.cur(),this.end=ie,this.unit=de||(x.cssNumber[ee]?"":"px")},cur:function(){var S=xn.propHooks[this.prop];return S&&S.get?S.get(this):xn.propHooks._default.get(this)},run:function(S){var V,ee=xn.propHooks[this.prop];return this.options.duration?this.pos=V=x.easing[this.easing](S,this.options.duration*S,0,1,this.options.duration):this.pos=V=S,this.now=(this.end-this.start)*V+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),ee&&ee.set?ee.set(this):xn.propHooks._default.set(this),this}},xn.prototype.init.prototype=xn.prototype,xn.propHooks={_default:{get:function(S){var V;return S.elem.nodeType!==1||S.elem[S.prop]!=null&&S.elem.style[S.prop]==null?S.elem[S.prop]:(V=x.css(S.elem,S.prop,""),!V||V==="auto"?0:V)},set:function(S){x.fx.step[S.prop]?x.fx.step[S.prop](S):S.elem.nodeType===1&&(x.cssHooks[S.prop]||S.elem.style[Bu(S.prop)]!=null)?x.style(S.elem,S.prop,S.now+S.unit):S.elem[S.prop]=S.now}}},xn.propHooks.scrollTop=xn.propHooks.scrollLeft={set:function(S){S.elem.nodeType&&S.elem.parentNode&&(S.elem[S.prop]=S.now)}},x.easing={linear:function(S){return S},swing:function(S){return .5-Math.cos(S*Math.PI)/2},_default:"swing"},x.fx=xn.prototype.init,x.fx.step={};var dl,zc,dh=/^(?:toggle|show|hide)$/,hf=/queueHooks$/;function za(){zc&&(m.hidden===!1&&t.requestAnimationFrame?t.requestAnimationFrame(za):t.setTimeout(za,x.fx.interval),x.fx.tick())}function Ho(){return t.setTimeout(function(){dl=void 0}),dl=Date.now()}function Dl(S,V){var ee,ie=0,he={height:S};for(V=V?1:0;ie<4;ie+=2-V)ee=se[ie],he["margin"+ee]=he["padding"+ee]=S;return V&&(he.opacity=he.width=S),he}function Xa(S,V,ee){for(var ie,he=(_l.tweeners[V]||[]).concat(_l.tweeners["*"]),de=0,ye=he.length;de<ye;de++)if(ie=he[de].call(ee,V,S))return ie}function cA(S,V,ee){var ie,he,de,ye,Qe,Ve,at,Ot,Vt="width"in V||"height"in V,Bt=this,hr={},Oi=S.style,gn=S.nodeType&&Ce(S),Ji=Pt.get(S,"fxshow");ee.queue||(ye=x._queueHooks(S,"fx"),ye.unqueued==null&&(ye.unqueued=0,Qe=ye.empty.fire,ye.empty.fire=function(){ye.unqueued||Qe()}),ye.unqueued++,Bt.always(function(){Bt.always(function(){ye.unqueued--,x.queue(S,"fx").length||ye.empty.fire()})}));for(ie in V)if(he=V[ie],dh.test(he)){if(delete V[ie],de=de||he==="toggle",he===(gn?"hide":"show"))if(he==="show"&&Ji&&Ji[ie]!==void 0)gn=!0;else continue;hr[ie]=Ji&&Ji[ie]||x.style(S,ie)}if(Ve=!x.isEmptyObject(V),!(!Ve&&x.isEmptyObject(hr))){Vt&&S.nodeType===1&&(ee.overflow=[Oi.overflow,Oi.overflowX,Oi.overflowY],at=Ji&&Ji.display,at==null&&(at=Pt.get(S,"display")),Ot=x.css(S,"display"),Ot==="none"&&(at?Ot=at:(ar([S],!0),at=S.style.display||at,Ot=x.css(S,"display"),ar([S]))),(Ot==="inline"||Ot==="inline-block"&&at!=null)&&x.css(S,"float")==="none"&&(Ve||(Bt.done(function(){Oi.display=at}),at==null&&(Ot=Oi.display,at=Ot==="none"?"":Ot)),Oi.display="inline-block")),ee.overflow&&(Oi.overflow="hidden",Bt.always(function(){Oi.overflow=ee.overflow[0],Oi.overflowX=ee.overflow[1],Oi.overflowY=ee.overflow[2]})),Ve=!1;for(ie in hr)Ve||(Ji?"hidden"in Ji&&(gn=Ji.hidden):Ji=Pt.access(S,"fxshow",{display:at}),de&&(Ji.hidden=!gn),gn&&ar([S],!0),Bt.done(function(){gn||ar([S]),Pt.remove(S,"fxshow");for(ie in hr)x.style(S,ie,hr[ie])})),Ve=Xa(gn?Ji[ie]:0,ie,Bt),ie in Ji||(Ji[ie]=Ve.start,gn&&(Ve.end=Ve.start,Ve.start=0))}}function df(S,V){var ee,ie,he,de,ye;for(ee in S)if(ie=Ft(ee),he=V[ie],de=S[ee],Array.isArray(de)&&(he=de[1],de=S[ee]=de[0]),ee!==ie&&(S[ie]=de,delete S[ee]),ye=x.cssHooks[ie],ye&&"expand"in ye){de=ye.expand(de),delete S[ie];for(ee in de)ee in S||(S[ee]=de[ee],V[ee]=he)}else V[ie]=he}function _l(S,V,ee){var ie,he,de=0,ye=_l.prefilters.length,Qe=x.Deferred().always(function(){delete Ve.elem}),Ve=function(){if(he)return!1;for(var Vt=dl||Ho(),Bt=Math.max(0,at.startTime+at.duration-Vt),hr=Bt/at.duration||0,Oi=1-hr,gn=0,Ji=at.tweens.length;gn<Ji;gn++)at.tweens[gn].run(Oi);return Qe.notifyWith(S,[at,Oi,Bt]),Oi<1&&Ji?Bt:(Ji||Qe.notifyWith(S,[at,1,0]),Qe.resolveWith(S,[at]),!1)},at=Qe.promise({elem:S,props:x.extend({},V),opts:x.extend(!0,{specialEasing:{},easing:x.easing._default},ee),originalProperties:V,originalOptions:ee,startTime:dl||Ho(),duration:ee.duration,tweens:[],createTween:function(Vt,Bt){var hr=x.Tween(S,at.opts,Vt,Bt,at.opts.specialEasing[Vt]||at.opts.easing);return at.tweens.push(hr),hr},stop:function(Vt){var Bt=0,hr=Vt?at.tweens.length:0;if(he)return this;for(he=!0;Bt<hr;Bt++)at.tweens[Bt].run(1);return Vt?(Qe.notifyWith(S,[at,1,0]),Qe.resolveWith(S,[at,Vt])):Qe.rejectWith(S,[at,Vt]),this}}),Ot=at.props;for(df(Ot,at.opts.specialEasing);de<ye;de++)if(ie=_l.prefilters[de].call(at,S,Ot,at.opts),ie)return f(ie.stop)&&(x._queueHooks(at.elem,at.opts.queue).stop=ie.stop.bind(ie)),ie;return x.map(Ot,Xa,at),f(at.opts.start)&&at.opts.start.call(S,at),at.progress(at.opts.progress).done(at.opts.done,at.opts.complete).fail(at.opts.fail).always(at.opts.always),x.fx.timer(x.extend(Ve,{elem:S,anim:at,queue:at.opts.queue})),at}x.Animation=x.extend(_l,{tweeners:{"*":[function(S,V){var ee=this.createTween(S,V);return st(ee.elem,S,K.exec(V),ee),ee}]},tweener:function(S,V){f(S)?(V=S,S=["*"]):S=S.match(Le);for(var ee,ie=0,he=S.length;ie<he;ie++)ee=S[ie],_l.tweeners[ee]=_l.tweeners[ee]||[],_l.tweeners[ee].unshift(V)},prefilters:[cA],prefilter:function(S,V){V?_l.prefilters.unshift(S):_l.prefilters.push(S)}}),x.speed=function(S,V,ee){var ie=S&&typeof S=="object"?x.extend({},S):{complete:ee||!ee&&V||f(S)&&S,duration:S,easing:ee&&V||V&&!f(V)&&V};return x.fx.off?ie.duration=0:typeof ie.duration!="number"&&(ie.duration in x.fx.speeds?ie.duration=x.fx.speeds[ie.duration]:ie.duration=x.fx.speeds._default),(ie.queue==null||ie.queue===!0)&&(ie.queue="fx"),ie.old=ie.complete,ie.complete=function(){f(ie.old)&&ie.old.call(this),ie.queue&&x.dequeue(this,ie.queue)},ie},x.fn.extend({fadeTo:function(S,V,ee,ie){return this.filter(Ce).css("opacity",0).show().end().animate({opacity:V},S,ee,ie)},animate:function(S,V,ee,ie){var he=x.isEmptyObject(S),de=x.speed(V,ee,ie),ye=function(){var Qe=_l(this,x.extend({},S),de);(he||Pt.get(this,"finish"))&&Qe.stop(!0)};return ye.finish=ye,he||de.queue===!1?this.each(ye):this.queue(de.queue,ye)},stop:function(S,V,ee){var ie=function(he){var de=he.stop;delete he.stop,de(ee)};return typeof S!="string"&&(ee=V,V=S,S=void 0),V&&this.queue(S||"fx",[]),this.each(function(){var he=!0,de=S!=null&&S+"queueHooks",ye=x.timers,Qe=Pt.get(this);if(de)Qe[de]&&Qe[de].stop&&ie(Qe[de]);else for(de in Qe)Qe[de]&&Qe[de].stop&&hf.test(de)&&ie(Qe[de]);for(de=ye.length;de--;)ye[de].elem===this&&(S==null||ye[de].queue===S)&&(ye[de].anim.stop(ee),he=!1,ye.splice(de,1));(he||!ee)&&x.dequeue(this,S)})},finish:function(S){return S!==!1&&(S=S||"fx"),this.each(function(){var V,ee=Pt.get(this),ie=ee[S+"queue"],he=ee[S+"queueHooks"],de=x.timers,ye=ie?ie.length:0;for(ee.finish=!0,x.queue(this,S,[]),he&&he.stop&&he.stop.call(this,!0),V=de.length;V--;)de[V].elem===this&&de[V].queue===S&&(de[V].anim.stop(!0),de.splice(V,1));for(V=0;V<ye;V++)ie[V]&&ie[V].finish&&ie[V].finish.call(this);delete ee.finish})}}),x.each(["toggle","show","hide"],function(S,V){var ee=x.fn[V];x.fn[V]=function(ie,he,de){return ie==null||typeof ie=="boolean"?ee.apply(this,arguments):this.animate(Dl(V,!0),ie,he,de)}}),x.each({slideDown:Dl("show"),slideUp:Dl("hide"),slideToggle:Dl("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(S,V){x.fn[S]=function(ee,ie,he){return this.animate(V,ee,ie,he)}}),x.timers=[],x.fx.tick=function(){var S,V=0,ee=x.timers;for(dl=Date.now();V<ee.length;V++)S=ee[V],!S()&&ee[V]===S&&ee.splice(V--,1);ee.length||x.fx.stop(),dl=void 0},x.fx.timer=function(S){x.timers.push(S),x.fx.start()},x.fx.interval=13,x.fx.start=function(){zc||(zc=!0,za())},x.fx.stop=function(){zc=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fn.delay=function(S,V){return S=x.fx&&x.fx.speeds[S]||S,V=V||"fx",this.queue(V,function(ee,ie){var he=t.setTimeout(ee,S);ie.stop=function(){t.clearTimeout(he)}})},(function(){var S=m.createElement("input"),V=m.createElement("select"),ee=V.appendChild(m.createElement("option"));S.type="checkbox",h.checkOn=S.value!=="",h.optSelected=ee.selected,S=m.createElement("input"),S.value="t",S.type="radio",h.radioValue=S.value==="t"})();var Td,Oh=x.expr.attrHandle;x.fn.extend({attr:function(S,V){return ft(this,x.attr,S,V,arguments.length>1)},removeAttr:function(S){return this.each(function(){x.removeAttr(this,S)})}}),x.extend({attr:function(S,V,ee){var ie,he,de=S.nodeType;if(!(de===3||de===8||de===2)){if(typeof S.getAttribute>"u")return x.prop(S,V,ee);if((de!==1||!x.isXMLDoc(S))&&(he=x.attrHooks[V.toLowerCase()]||(x.expr.match.bool.test(V)?Td:void 0)),ee!==void 0){if(ee===null){x.removeAttr(S,V);return}return he&&"set"in he&&(ie=he.set(S,ee,V))!==void 0?ie:(S.setAttribute(V,ee+""),ee)}return he&&"get"in he&&(ie=he.get(S,V))!==null?ie:(ie=x.find.attr(S,V),ie==null?void 0:ie)}},attrHooks:{type:{set:function(S,V){if(!h.radioValue&&V==="radio"&&C(S,"input")){var ee=S.value;return S.setAttribute("type",V),ee&&(S.value=ee),V}}}},removeAttr:function(S,V){var ee,ie=0,he=V&&V.match(Le);if(he&&S.nodeType===1)for(;ee=he[ie++];)S.removeAttribute(ee)}}),Td={set:function(S,V,ee){return V===!1?x.removeAttr(S,ee):S.setAttribute(ee,ee),ee}},x.each(x.expr.match.bool.source.match(/\w+/g),function(S,V){var ee=Oh[V]||x.find.attr;Oh[V]=function(ie,he,de){var ye,Qe,Ve=he.toLowerCase();return de||(Qe=Oh[Ve],Oh[Ve]=ye,ye=ee(ie,he,de)!=null?Ve:null,Oh[Ve]=Qe),ye}});var Lu=/^(?:input|select|textarea|button)$/i,uA=/^(?:a|area)$/i;x.fn.extend({prop:function(S,V){return ft(this,x.prop,S,V,arguments.length>1)},removeProp:function(S){return this.each(function(){delete this[x.propFix[S]||S]})}}),x.extend({prop:function(S,V,ee){var ie,he,de=S.nodeType;if(!(de===3||de===8||de===2))return(de!==1||!x.isXMLDoc(S))&&(V=x.propFix[V]||V,he=x.propHooks[V]),ee!==void 0?he&&"set"in he&&(ie=he.set(S,ee,V))!==void 0?ie:S[V]=ee:he&&"get"in he&&(ie=he.get(S,V))!==null?ie:S[V]},propHooks:{tabIndex:{get:function(S){var V=x.find.attr(S,"tabindex");return V?parseInt(V,10):Lu.test(S.nodeName)||uA.test(S.nodeName)&&S.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),h.optSelected||(x.propHooks.selected={get:function(S){var V=S.parentNode;return V&&V.parentNode&&V.parentNode.selectedIndex,null},set:function(S){var V=S.parentNode;V&&(V.selectedIndex,V.parentNode&&V.parentNode.selectedIndex)}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this});function qa(S){var V=S.match(Le)||[];return V.join(" ")}function Pl(S){return S.getAttribute&&S.getAttribute("class")||""}function Id(S){return Array.isArray(S)?S:typeof S=="string"?S.match(Le)||[]:[]}x.fn.extend({addClass:function(S){var V,ee,ie,he,de,ye;return f(S)?this.each(function(Qe){x(this).addClass(S.call(this,Qe,Pl(this)))}):(V=Id(S),V.length?this.each(function(){if(ie=Pl(this),ee=this.nodeType===1&&" "+qa(ie)+" ",ee){for(de=0;de<V.length;de++)he=V[de],ee.indexOf(" "+he+" ")<0&&(ee+=he+" ");ye=qa(ee),ie!==ye&&this.setAttribute("class",ye)}}):this)},removeClass:function(S){var V,ee,ie,he,de,ye;return f(S)?this.each(function(Qe){x(this).removeClass(S.call(this,Qe,Pl(this)))}):arguments.length?(V=Id(S),V.length?this.each(function(){if(ie=Pl(this),ee=this.nodeType===1&&" "+qa(ie)+" ",ee){for(de=0;de<V.length;de++)for(he=V[de];ee.indexOf(" "+he+" ")>-1;)ee=ee.replace(" "+he+" "," ");ye=qa(ee),ie!==ye&&this.setAttribute("class",ye)}}):this):this.attr("class","")},toggleClass:function(S,V){var ee,ie,he,de,ye=typeof S,Qe=ye==="string"||Array.isArray(S);return f(S)?this.each(function(Ve){x(this).toggleClass(S.call(this,Ve,Pl(this),V),V)}):typeof V=="boolean"&&Qe?V?this.addClass(S):this.removeClass(S):(ee=Id(S),this.each(function(){if(Qe)for(de=x(this),he=0;he<ee.length;he++)ie=ee[he],de.hasClass(ie)?de.removeClass(ie):de.addClass(ie);else(S===void 0||ye==="boolean")&&(ie=Pl(this),ie&&Pt.set(this,"__className__",ie),this.setAttribute&&this.setAttribute("class",ie||S===!1?"":Pt.get(this,"__className__")||""))}))},hasClass:function(S){var V,ee,ie=0;for(V=" "+S+" ";ee=this[ie++];)if(ee.nodeType===1&&(" "+qa(Pl(ee))+" ").indexOf(V)>-1)return!0;return!1}});var hA=/\r/g;x.fn.extend({val:function(S){var V,ee,ie,he=this[0];return arguments.length?(ie=f(S),this.each(function(de){var ye;this.nodeType===1&&(ie?ye=S.call(this,de,x(this).val()):ye=S,ye==null?ye="":typeof ye=="number"?ye+="":Array.isArray(ye)&&(ye=x.map(ye,function(Qe){return Qe==null?"":Qe+""})),V=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],(!V||!("set"in V)||V.set(this,ye,"value")===void 0)&&(this.value=ye))})):he?(V=x.valHooks[he.type]||x.valHooks[he.nodeName.toLowerCase()],V&&"get"in V&&(ee=V.get(he,"value"))!==void 0?ee:(ee=he.value,typeof ee=="string"?ee.replace(hA,""):ee==null?"":ee)):void 0}}),x.extend({valHooks:{option:{get:function(S){var V=x.find.attr(S,"value");return V!=null?V:qa(x.text(S))}},select:{get:function(S){var V,ee,ie,he=S.options,de=S.selectedIndex,ye=S.type==="select-one",Qe=ye?null:[],Ve=ye?de+1:he.length;for(de<0?ie=Ve:ie=ye?de:0;ie<Ve;ie++)if(ee=he[ie],(ee.selected||ie===de)&&!ee.disabled&&(!ee.parentNode.disabled||!C(ee.parentNode,"optgroup"))){if(V=x(ee).val(),ye)return V;Qe.push(V)}return Qe},set:function(S,V){for(var ee,ie,he=S.options,de=x.makeArray(V),ye=he.length;ye--;)ie=he[ye],(ie.selected=x.inArray(x.valHooks.option.get(ie),de)>-1)&&(ee=!0);return ee||(S.selectedIndex=-1),de}}}}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(S,V){if(Array.isArray(V))return S.checked=x.inArray(x(S).val(),V)>-1}},h.checkOn||(x.valHooks[this].get=function(S){return S.getAttribute("value")===null?"on":S.value})});var Al=t.location,eo={guid:Date.now()},Nh=/\?/;x.parseXML=function(S){var V,ee;if(!S||typeof S!="string")return null;try{V=new t.DOMParser().parseFromString(S,"text/xml")}catch{}return ee=V&&V.getElementsByTagName("parsererror")[0],(!V||ee)&&x.error("Invalid XML: "+(ee?x.map(ee.childNodes,function(ie){return ie.textContent}).join(`
`):S)),V};var Af=/^(?:focusinfocus|focusoutblur)$/,_n=function(S){S.stopPropagation()};x.extend(x.event,{trigger:function(S,V,ee,ie){var he,de,ye,Qe,Ve,at,Ot,Vt,Bt=[ee||m],hr=u.call(S,"type")?S.type:S,Oi=u.call(S,"namespace")?S.namespace.split("."):[];if(de=Vt=ye=ee=ee||m,!(ee.nodeType===3||ee.nodeType===8)&&!Af.test(hr+x.event.triggered)&&(hr.indexOf(".")>-1&&(Oi=hr.split("."),hr=Oi.shift(),Oi.sort()),Ve=hr.indexOf(":")<0&&"on"+hr,S=S[x.expando]?S:new x.Event(hr,typeof S=="object"&&S),S.isTrigger=ie?2:3,S.namespace=Oi.join("."),S.rnamespace=S.namespace?new RegExp("(^|\\.)"+Oi.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,S.result=void 0,S.target||(S.target=ee),V=V==null?[S]:x.makeArray(V,[S]),Ot=x.event.special[hr]||{},!(!ie&&Ot.trigger&&Ot.trigger.apply(ee,V)===!1))){if(!ie&&!Ot.noBubble&&!p(ee)){for(Qe=Ot.delegateType||hr,Af.test(Qe+hr)||(de=de.parentNode);de;de=de.parentNode)Bt.push(de),ye=de;ye===(ee.ownerDocument||m)&&Bt.push(ye.defaultView||ye.parentWindow||t)}for(he=0;(de=Bt[he++])&&!S.isPropagationStopped();)Vt=de,S.type=he>1?Qe:Ot.bindType||hr,at=(Pt.get(de,"events")||Object.create(null))[S.type]&&Pt.get(de,"handle"),at&&at.apply(de,V),at=Ve&&de[Ve],at&&at.apply&&kt(de)&&(S.result=at.apply(de,V),S.result===!1&&S.preventDefault());return S.type=hr,!ie&&!S.isDefaultPrevented()&&(!Ot._default||Ot._default.apply(Bt.pop(),V)===!1)&&kt(ee)&&Ve&&f(ee[hr])&&!p(ee)&&(ye=ee[Ve],ye&&(ee[Ve]=null),x.event.triggered=hr,S.isPropagationStopped()&&Vt.addEventListener(hr,_n),ee[hr](),S.isPropagationStopped()&&Vt.removeEventListener(hr,_n),x.event.triggered=void 0,ye&&(ee[Ve]=ye)),S.result}},simulate:function(S,V,ee){var ie=x.extend(new x.Event,ee,{type:S,isSimulated:!0});x.event.trigger(ie,null,V)}}),x.fn.extend({trigger:function(S,V){return this.each(function(){x.event.trigger(S,V,this)})},triggerHandler:function(S,V){var ee=this[0];if(ee)return x.event.trigger(S,V,ee,!0)}});var bc=/\[\]$/,ff=/\r?\n/g,Fi=/^(?:submit|button|image|reset|file)$/i,pf=/^(?:input|select|textarea|keygen)/i;function dA(S,V,ee,ie){var he;if(Array.isArray(V))x.each(V,function(de,ye){ee||bc.test(S)?ie(S,ye):dA(S+"["+(typeof ye=="object"&&ye!=null?de:"")+"]",ye,ee,ie)});else if(!ee&&b(V)==="object")for(he in V)dA(S+"["+he+"]",V[he],ee,ie);else ie(S,V)}x.param=function(S,V){var ee,ie=[],he=function(de,ye){var Qe=f(ye)?ye():ye;ie[ie.length]=encodeURIComponent(de)+"="+encodeURIComponent(Qe==null?"":Qe)};if(S==null)return"";if(Array.isArray(S)||S.jquery&&!x.isPlainObject(S))x.each(S,function(){he(this.name,this.value)});else for(ee in S)dA(ee,S[ee],V,he);return ie.join("&")},x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var S=x.prop(this,"elements");return S?x.makeArray(S):this}).filter(function(){var S=this.type;return this.name&&!x(this).is(":disabled")&&pf.test(this.nodeName)&&!Fi.test(S)&&(this.checked||!lr.test(S))}).map(function(S,V){var ee=x(this).val();return ee==null?null:Array.isArray(ee)?x.map(ee,function(ie){return{name:V.name,value:ie.replace(ff,`\r
`)}}):{name:V.name,value:ee.replace(ff,`\r
`)}}).get()}});var Xc=/%20/g,Cp=/#.*$/,Go=/([?&])_=[^&]*/,Ah=/^(.*?):[ \t]*([^\r\n]*)$/mg,AA=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,fl=/^(?:GET|HEAD)$/,fA=/^\/\//,mf={},Rh={},Ou="*/".concat("*"),pl=m.createElement("a");pl.href=Al.href;function tc(S){return function(V,ee){typeof V!="string"&&(ee=V,V="*");var ie,he=0,de=V.toLowerCase().match(Le)||[];if(f(ee))for(;ie=de[he++];)ie[0]==="+"?(ie=ie.slice(1)||"*",(S[ie]=S[ie]||[]).unshift(ee)):(S[ie]=S[ie]||[]).push(ee)}}function fh(S,V,ee,ie){var he={},de=S===Rh;function ye(Qe){var Ve;return he[Qe]=!0,x.each(S[Qe]||[],function(at,Ot){var Vt=Ot(V,ee,ie);if(typeof Vt=="string"&&!de&&!he[Vt])return V.dataTypes.unshift(Vt),ye(Vt),!1;if(de)return!(Ve=Vt)}),Ve}return ye(V.dataTypes[0])||!he["*"]&&ye("*")}function Mh(S,V){var ee,ie,he=x.ajaxSettings.flatOptions||{};for(ee in V)V[ee]!==void 0&&((he[ee]?S:ie||(ie={}))[ee]=V[ee]);return ie&&x.extend(!0,S,ie),S}function Pa(S,V,ee){for(var ie,he,de,ye,Qe=S.contents,Ve=S.dataTypes;Ve[0]==="*";)Ve.shift(),ie===void 0&&(ie=S.mimeType||V.getResponseHeader("Content-Type"));if(ie){for(he in Qe)if(Qe[he]&&Qe[he].test(ie)){Ve.unshift(he);break}}if(Ve[0]in ee)de=Ve[0];else{for(he in ee){if(!Ve[0]||S.converters[he+" "+Ve[0]]){de=he;break}ye||(ye=he)}de=de||ye}if(de)return de!==Ve[0]&&Ve.unshift(de),ee[de]}function gf(S,V,ee,ie){var he,de,ye,Qe,Ve,at={},Ot=S.dataTypes.slice();if(Ot[1])for(ye in S.converters)at[ye.toLowerCase()]=S.converters[ye];for(de=Ot.shift();de;)if(S.responseFields[de]&&(ee[S.responseFields[de]]=V),!Ve&&ie&&S.dataFilter&&(V=S.dataFilter(V,S.dataType)),Ve=de,de=Ot.shift(),de){if(de==="*")de=Ve;else if(Ve!=="*"&&Ve!==de){if(ye=at[Ve+" "+de]||at["* "+de],!ye){for(he in at)if(Qe=he.split(" "),Qe[1]===de&&(ye=at[Ve+" "+Qe[0]]||at["* "+Qe[0]],ye)){ye===!0?ye=at[he]:at[he]!==!0&&(de=Qe[0],Ot.unshift(Qe[1]));break}}if(ye!==!0)if(ye&&S.throws)V=ye(V);else try{V=ye(V)}catch(Vt){return{state:"parsererror",error:ye?Vt:"No conversion from "+Ve+" to "+de}}}}return{state:"success",data:V}}x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Al.href,type:"GET",isLocal:AA.test(Al.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ou,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(S,V){return V?Mh(Mh(S,x.ajaxSettings),V):Mh(x.ajaxSettings,S)},ajaxPrefilter:tc(mf),ajaxTransport:tc(Rh),ajax:function(S,V){typeof S=="object"&&(V=S,S=void 0),V=V||{};var ee,ie,he,de,ye,Qe,Ve,at,Ot,Vt,Bt=x.ajaxSetup({},V),hr=Bt.context||Bt,Oi=Bt.context&&(hr.nodeType||hr.jquery)?x(hr):x.event,gn=x.Deferred(),Ji=x.Callbacks("once memory"),Vs=Bt.statusCode||{},Ha={},J={},fe="canceled",Oe={readyState:0,getResponseHeader:function(Je){var _t;if(Ve){if(!de)for(de={};_t=Ah.exec(he);)de[_t[1].toLowerCase()+" "]=(de[_t[1].toLowerCase()+" "]||[]).concat(_t[2]);_t=de[Je.toLowerCase()+" "]}return _t==null?null:_t.join(", ")},getAllResponseHeaders:function(){return Ve?he:null},setRequestHeader:function(Je,_t){return Ve==null&&(Je=J[Je.toLowerCase()]=J[Je.toLowerCase()]||Je,Ha[Je]=_t),this},overrideMimeType:function(Je){return Ve==null&&(Bt.mimeType=Je),this},statusCode:function(Je){var _t;if(Je)if(Ve)Oe.always(Je[Oe.status]);else for(_t in Je)Vs[_t]=[Vs[_t],Je[_t]];return this},abort:function(Je){var _t=Je||fe;return ee&&ee.abort(_t),Xe(0,_t),this}};if(gn.promise(Oe),Bt.url=((S||Bt.url||Al.href)+"").replace(fA,Al.protocol+"//"),Bt.type=V.method||V.type||Bt.method||Bt.type,Bt.dataTypes=(Bt.dataType||"*").toLowerCase().match(Le)||[""],Bt.crossDomain==null){Qe=m.createElement("a");try{Qe.href=Bt.url,Qe.href=Qe.href,Bt.crossDomain=pl.protocol+"//"+pl.host!=Qe.protocol+"//"+Qe.host}catch{Bt.crossDomain=!0}}if(Bt.data&&Bt.processData&&typeof Bt.data!="string"&&(Bt.data=x.param(Bt.data,Bt.traditional)),fh(mf,Bt,V,Oe),Ve)return Oe;at=x.event&&Bt.global,at&&x.active++===0&&x.event.trigger("ajaxStart"),Bt.type=Bt.type.toUpperCase(),Bt.hasContent=!fl.test(Bt.type),ie=Bt.url.replace(Cp,""),Bt.hasContent?Bt.data&&Bt.processData&&(Bt.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(Bt.data=Bt.data.replace(Xc,"+")):(Vt=Bt.url.slice(ie.length),Bt.data&&(Bt.processData||typeof Bt.data=="string")&&(ie+=(Nh.test(ie)?"&":"?")+Bt.data,delete Bt.data),Bt.cache===!1&&(ie=ie.replace(Go,"$1"),Vt=(Nh.test(ie)?"&":"?")+"_="+eo.guid+++Vt),Bt.url=ie+Vt),Bt.ifModified&&(x.lastModified[ie]&&Oe.setRequestHeader("If-Modified-Since",x.lastModified[ie]),x.etag[ie]&&Oe.setRequestHeader("If-None-Match",x.etag[ie])),(Bt.data&&Bt.hasContent&&Bt.contentType!==!1||V.contentType)&&Oe.setRequestHeader("Content-Type",Bt.contentType),Oe.setRequestHeader("Accept",Bt.dataTypes[0]&&Bt.accepts[Bt.dataTypes[0]]?Bt.accepts[Bt.dataTypes[0]]+(Bt.dataTypes[0]!=="*"?", "+Ou+"; q=0.01":""):Bt.accepts["*"]);for(Ot in Bt.headers)Oe.setRequestHeader(Ot,Bt.headers[Ot]);if(Bt.beforeSend&&(Bt.beforeSend.call(hr,Oe,Bt)===!1||Ve))return Oe.abort();if(fe="abort",Ji.add(Bt.complete),Oe.done(Bt.success),Oe.fail(Bt.error),ee=fh(Rh,Bt,V,Oe),!ee)Xe(-1,"No Transport");else{if(Oe.readyState=1,at&&Oi.trigger("ajaxSend",[Oe,Bt]),Ve)return Oe;Bt.async&&Bt.timeout>0&&(ye=t.setTimeout(function(){Oe.abort("timeout")},Bt.timeout));try{Ve=!1,ee.send(Ha,Xe)}catch(Je){if(Ve)throw Je;Xe(-1,Je)}}function Xe(Je,_t,or,Nr){var ei,Ui,Si,Vi,gi,$n=_t;Ve||(Ve=!0,ye&&t.clearTimeout(ye),ee=void 0,he=Nr||"",Oe.readyState=Je>0?4:0,ei=Je>=200&&Je<300||Je===304,or&&(Vi=Pa(Bt,Oe,or)),!ei&&x.inArray("script",Bt.dataTypes)>-1&&x.inArray("json",Bt.dataTypes)<0&&(Bt.converters["text script"]=function(){}),Vi=gf(Bt,Vi,Oe,ei),ei?(Bt.ifModified&&(gi=Oe.getResponseHeader("Last-Modified"),gi&&(x.lastModified[ie]=gi),gi=Oe.getResponseHeader("etag"),gi&&(x.etag[ie]=gi)),Je===204||Bt.type==="HEAD"?$n="nocontent":Je===304?$n="notmodified":($n=Vi.state,Ui=Vi.data,Si=Vi.error,ei=!Si)):(Si=$n,(Je||!$n)&&($n="error",Je<0&&(Je=0))),Oe.status=Je,Oe.statusText=(_t||$n)+"",ei?gn.resolveWith(hr,[Ui,$n,Oe]):gn.rejectWith(hr,[Oe,$n,Si]),Oe.statusCode(Vs),Vs=void 0,at&&Oi.trigger(ei?"ajaxSuccess":"ajaxError",[Oe,Bt,ei?Ui:Si]),Ji.fireWith(hr,[Oe,$n]),at&&(Oi.trigger("ajaxComplete",[Oe,Bt]),--x.active||x.event.trigger("ajaxStop")))}return Oe},getJSON:function(S,V,ee){return x.get(S,V,ee,"json")},getScript:function(S,V){return x.get(S,void 0,V,"script")}}),x.each(["get","post"],function(S,V){x[V]=function(ee,ie,he,de){return f(ie)&&(de=de||he,he=ie,ie=void 0),x.ajax(x.extend({url:ee,type:V,dataType:de,data:ie,success:he},x.isPlainObject(ee)&&ee))}}),x.ajaxPrefilter(function(S){var V;for(V in S.headers)V.toLowerCase()==="content-type"&&(S.contentType=S.headers[V]||"")}),x._evalUrl=function(S,V,ee){return x.ajax({url:S,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(ie){x.globalEval(ie,V,ee)}})},x.fn.extend({wrapAll:function(S){var V;return this[0]&&(f(S)&&(S=S.call(this[0])),V=x(S,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&V.insertBefore(this[0]),V.map(function(){for(var ee=this;ee.firstElementChild;)ee=ee.firstElementChild;return ee}).append(this)),this},wrapInner:function(S){return f(S)?this.each(function(V){x(this).wrapInner(S.call(this,V))}):this.each(function(){var V=x(this),ee=V.contents();ee.length?ee.wrapAll(S):V.append(S)})},wrap:function(S){var V=f(S);return this.each(function(ee){x(this).wrapAll(V?S.call(this,ee):S)})},unwrap:function(S){return this.parent(S).not("body").each(function(){x(this).replaceWith(this.childNodes)}),this}}),x.expr.pseudos.hidden=function(S){return!x.expr.pseudos.visible(S)},x.expr.pseudos.visible=function(S){return!!(S.offsetWidth||S.offsetHeight||S.getClientRects().length)},x.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch{}};var ph={0:200,1223:204},$r=x.ajaxSettings.xhr();h.cors=!!$r&&"withCredentials"in $r,h.ajax=$r=!!$r,x.ajaxTransport(function(S){var V,ee;if(h.cors||$r&&!S.crossDomain)return{send:function(ie,he){var de,ye=S.xhr();if(ye.open(S.type,S.url,S.async,S.username,S.password),S.xhrFields)for(de in S.xhrFields)ye[de]=S.xhrFields[de];S.mimeType&&ye.overrideMimeType&&ye.overrideMimeType(S.mimeType),!S.crossDomain&&!ie["X-Requested-With"]&&(ie["X-Requested-With"]="XMLHttpRequest");for(de in ie)ye.setRequestHeader(de,ie[de]);V=function(Qe){return function(){V&&(V=ee=ye.onload=ye.onerror=ye.onabort=ye.ontimeout=ye.onreadystatechange=null,Qe==="abort"?ye.abort():Qe==="error"?typeof ye.status!="number"?he(0,"error"):he(ye.status,ye.statusText):he(ph[ye.status]||ye.status,ye.statusText,(ye.responseType||"text")!=="text"||typeof ye.responseText!="string"?{binary:ye.response}:{text:ye.responseText},ye.getAllResponseHeaders()))}},ye.onload=V(),ee=ye.onerror=ye.ontimeout=V("error"),ye.onabort!==void 0?ye.onabort=ee:ye.onreadystatechange=function(){ye.readyState===4&&t.setTimeout(function(){V&&ee()})},V=V("abort");try{ye.send(S.hasContent&&S.data||null)}catch(Qe){if(V)throw Qe}},abort:function(){V&&V()}}}),x.ajaxPrefilter(function(S){S.crossDomain&&(S.contents.script=!1)}),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(S){return x.globalEval(S),S}}}),x.ajaxPrefilter("script",function(S){S.cache===void 0&&(S.cache=!1),S.crossDomain&&(S.type="GET")}),x.ajaxTransport("script",function(S){if(S.crossDomain||S.scriptAttrs){var V,ee;return{send:function(ie,he){V=x("<script>").attr(S.scriptAttrs||{}).prop({charset:S.scriptCharset,src:S.url}).on("load error",ee=function(de){V.remove(),ee=null,de&&he(de.type==="error"?404:200,de.type)}),m.head.appendChild(V[0])},abort:function(){ee&&ee()}}}});var $e=[],ir=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var S=$e.pop()||x.expando+"_"+eo.guid++;return this[S]=!0,S}}),x.ajaxPrefilter("json jsonp",function(S,V,ee){var ie,he,de,ye=S.jsonp!==!1&&(ir.test(S.url)?"url":typeof S.data=="string"&&(S.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&ir.test(S.data)&&"data");if(ye||S.dataTypes[0]==="jsonp")return ie=S.jsonpCallback=f(S.jsonpCallback)?S.jsonpCallback():S.jsonpCallback,ye?S[ye]=S[ye].replace(ir,"$1"+ie):S.jsonp!==!1&&(S.url+=(Nh.test(S.url)?"&":"?")+S.jsonp+"="+ie),S.converters["script json"]=function(){return de||x.error(ie+" was not called"),de[0]},S.dataTypes[0]="json",he=t[ie],t[ie]=function(){de=arguments},ee.always(function(){he===void 0?x(t).removeProp(ie):t[ie]=he,S[ie]&&(S.jsonpCallback=V.jsonpCallback,$e.push(ie)),de&&f(he)&&he(de[0]),de=he=void 0}),"script"}),h.createHTMLDocument=(function(){var S=m.implementation.createHTMLDocument("").body;return S.innerHTML="<form></form><form></form>",S.childNodes.length===2})(),x.parseHTML=function(S,V,ee){if(typeof S!="string")return[];typeof V=="boolean"&&(ee=V,V=!1);var ie,he,de;return V||(h.createHTMLDocument?(V=m.implementation.createHTMLDocument(""),ie=V.createElement("base"),ie.href=m.location.href,V.head.appendChild(ie)):V=m),he=q.exec(S),de=!ee&&[],he?[V.createElement(he[1])]:(he=Dn([S],V,de),de&&de.length&&x(de).remove(),x.merge([],he.childNodes))},x.fn.load=function(S,V,ee){var ie,he,de,ye=this,Qe=S.indexOf(" ");return Qe>-1&&(ie=qa(S.slice(Qe)),S=S.slice(0,Qe)),f(V)?(ee=V,V=void 0):V&&typeof V=="object"&&(he="POST"),ye.length>0&&x.ajax({url:S,type:he||"GET",dataType:"html",data:V}).done(function(Ve){de=arguments,ye.html(ie?x("<div>").append(x.parseHTML(Ve)).find(ie):Ve)}).always(ee&&function(Ve,at){ye.each(function(){ee.apply(this,de||[Ve.responseText,at,Ve])})}),this},x.expr.pseudos.animated=function(S){return x.grep(x.timers,function(V){return S===V.elem}).length},x.offset={setOffset:function(S,V,ee){var ie,he,de,ye,Qe,Ve,at,Ot=x.css(S,"position"),Vt=x(S),Bt={};Ot==="static"&&(S.style.position="relative"),Qe=Vt.offset(),de=x.css(S,"top"),Ve=x.css(S,"left"),at=(Ot==="absolute"||Ot==="fixed")&&(de+Ve).indexOf("auto")>-1,at?(ie=Vt.position(),ye=ie.top,he=ie.left):(ye=parseFloat(de)||0,he=parseFloat(Ve)||0),f(V)&&(V=V.call(S,ee,x.extend({},Qe))),V.top!=null&&(Bt.top=V.top-Qe.top+ye),V.left!=null&&(Bt.left=V.left-Qe.left+he),"using"in V?V.using.call(S,Bt):Vt.css(Bt)}},x.fn.extend({offset:function(S){if(arguments.length)return S===void 0?this:this.each(function(he){x.offset.setOffset(this,S,he)});var V,ee,ie=this[0];if(ie)return ie.getClientRects().length?(V=ie.getBoundingClientRect(),ee=ie.ownerDocument.defaultView,{top:V.top+ee.pageYOffset,left:V.left+ee.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var S,V,ee,ie=this[0],he={top:0,left:0};if(x.css(ie,"position")==="fixed")V=ie.getBoundingClientRect();else{for(V=this.offset(),ee=ie.ownerDocument,S=ie.offsetParent||ee.documentElement;S&&(S===ee.body||S===ee.documentElement)&&x.css(S,"position")==="static";)S=S.parentNode;S&&S!==ie&&S.nodeType===1&&(he=x(S).offset(),he.top+=x.css(S,"borderTopWidth",!0),he.left+=x.css(S,"borderLeftWidth",!0))}return{top:V.top-he.top-x.css(ie,"marginTop",!0),left:V.left-he.left-x.css(ie,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var S=this.offsetParent;S&&x.css(S,"position")==="static";)S=S.offsetParent;return S||ae})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(S,V){var ee=V==="pageYOffset";x.fn[S]=function(ie){return ft(this,function(he,de,ye){var Qe;if(p(he)?Qe=he:he.nodeType===9&&(Qe=he.defaultView),ye===void 0)return Qe?Qe[V]:he[de];Qe?Qe.scrollTo(ee?Qe.pageXOffset:ye,ee?ye:Qe.pageYOffset):he[de]=ye},S,ie,arguments.length)}}),x.each(["top","left"],function(S,V){x.cssHooks[V]=uh(h.pixelPosition,function(ee,ie){if(ie)return ie=is(ee,V),hl.test(ie)?x(ee).position()[V]+"px":ie})}),x.each({Height:"height",Width:"width"},function(S,V){x.each({padding:"inner"+S,content:V,"":"outer"+S},function(ee,ie){x.fn[ie]=function(he,de){var ye=arguments.length&&(ee||typeof he!="boolean"),Qe=ee||(he===!0||de===!0?"margin":"border");return ft(this,function(Ve,at,Ot){var Vt;return p(Ve)?ie.indexOf("outer")===0?Ve["inner"+S]:Ve.document.documentElement["client"+S]:Ve.nodeType===9?(Vt=Ve.documentElement,Math.max(Ve.body["scroll"+S],Vt["scroll"+S],Ve.body["offset"+S],Vt["offset"+S],Vt["client"+S])):Ot===void 0?x.css(Ve,at,Qe):x.style(Ve,at,Ot,Qe)},V,ye?he:void 0,ye)}})}),x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(S,V){x.fn[V]=function(ee){return this.on(V,ee)}}),x.fn.extend({bind:function(S,V,ee){return this.on(S,null,V,ee)},unbind:function(S,V){return this.off(S,null,V)},delegate:function(S,V,ee,ie){return this.on(V,S,ee,ie)},undelegate:function(S,V,ee){return arguments.length===1?this.off(S,"**"):this.off(V,S||"**",ee)},hover:function(S,V){return this.on("mouseenter",S).on("mouseleave",V||S)}}),x.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(S,V){x.fn[V]=function(ee,ie){return arguments.length>0?this.on(V,null,ee,ie):this.trigger(V)}});var wr=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;x.proxy=function(S,V){var ee,ie,he;if(typeof V=="string"&&(ee=S[V],V=S,S=ee),!!f(S))return ie=n.call(arguments,2),he=function(){return S.apply(V||this,ie.concat(n.call(arguments)))},he.guid=S.guid=S.guid||x.guid++,he},x.holdReady=function(S){S?x.readyWait++:x.ready(!0)},x.isArray=Array.isArray,x.parseJSON=JSON.parse,x.nodeName=C,x.isFunction=f,x.isWindow=p,x.camelCase=Ft,x.type=b,x.now=Date.now,x.isNumeric=function(S){var V=x.type(S);return(V==="number"||V==="string")&&!isNaN(S-parseFloat(S))},x.trim=function(S){return S==null?"":(S+"").replace(wr,"$1")},typeof define=="function"&&define.amd&&define("jquery",[],function(){return x});var Cn=t.jQuery,da=t.$;return x.noConflict=function(S){return t.$===x&&(t.$=da),S&&t.jQuery===x&&(t.jQuery=Cn),x},typeof e>"u"&&(t.jQuery=t.$=x),x})});var pv=yt((F6e,IH)=>{"use strict";var uR=Object.defineProperty,_ue=Object.getOwnPropertyDescriptor,Pue=Object.getOwnPropertyNames,Lue=Object.prototype.hasOwnProperty,Oue=(t,e)=>{for(var r in e)uR(t,r,{get:e[r],enumerable:!0})},Nue=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Pue(e))!Lue.call(t,n)&&n!==r&&uR(t,n,{get:()=>e[n],enumerable:!(i=_ue(e,n))||i.enumerable});return t},Rue=t=>Nue(uR({},"__esModule",{value:!0}),t),bH={};Oue(bH,{BroadcastChannelMessageBus:()=>$ue,MessageBus:()=>Xue,MessageBus2:()=>Kue,MessageBusTask:()=>lR,MessageBusTask2:()=>fv,WindowMessageBridge:()=>zue,WorkerMessageBridge:()=>Que,createBroadcastP2PStream:()=>SH,createBufferedByteBufferStream:()=>CH,createBufferedStream:()=>AR,createBufferedStringStream:()=>vH,dropP2PStream:()=>Zue,flowRead:()=>the,flowWrite:()=>ehe});IH.exports=Rue(bH);var uB=class{constructor(t=1.5){this.growthFactor=t,this.capacity=10,this.buffer=new Array(this.capacity),this.head=0,this.tail=0,this.count=0}enqueue(t){if(this.count===this.capacity){let e=Math.floor(this.capacity*this.growthFactor);console.log("grow",this.capacity,e);let r=new Array(e);for(let i=0;i<this.count;i++)r[i]=this.buffer[(this.head+i)%this.capacity];this.buffer=r,this.head=0,this.tail=this.count,this.capacity=e}this.buffer[this.tail]=t,this.tail=(this.tail+1)%this.capacity,this.count++}dequeue(){if(this.isEmpty())return;let t=this.buffer[this.head];return this.head=(this.head+1)%this.capacity,this.count--,t}peek(){return this.buffer[this.head]}isEmpty(){return this.count===0}clear(){this.buffer.length=0,this.head=0,this.tail=0,this.count=0}},hR=new ArrayBuffer(8),R6e=new Float64Array(hR),M6e=new Uint32Array(hR),k6e=new Uint16Array(hR),oR=ArrayBuffer;try{oR=self.HTMLImageElement||oR}catch{}var Mue=typeof SharedArrayBuffer<"u";function hB(t){if(typeof t!="object"||t===null||t instanceof Date||t instanceof ArrayBuffer||Mue&&t instanceof SharedArrayBuffer||t instanceof Blob||t instanceof FormData||t instanceof Function||t instanceof Uint8ClampedArray||t instanceof oR)return t;if(Array.isArray(t))return t.map(hB);{let e={};for(let r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=hB(t[r]));return e}}function aR(t,e){return kue(t,e,()=>[])}function kue(t,e,r){let i=t[e];return i!==void 0||(i=r(e),t[e]=i),i}var Fue=class{constructor(t){this.maxResources=t,this.idle=new uB,this.isClosed=!1,this.resources=t}acquire(t){this.isClosed?Promise.resolve(!1).then(t):this.resources>0?(this.resources--,Promise.resolve(!0).then(t)):this.idle.enqueue(t)}acquireSync(){return new Promise(t=>{this.acquire(t)})}release(){if(!this.isClosed){let t=this.idle.dequeue();t?Promise.resolve(!0).then(t):this.resources++}}close(){if(!this.isClosed)for(this.isClosed=!0;!this.idle.isEmpty();){let t=this.idle.dequeue();Promise.resolve(!1).then(t)}}};function Uue(){if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global}function Hue(t,e){let r=0,i=t.length;for(let n=0;n<i;n++)t[n]===e&&(t.splice(n,1),n--,i--,r++);return r}var Gue=Uue(),Yue=Gue.WeakRef||(t=>t);function l1(t){if(t!=null){if(typeof t=="object")return new Yue(t);console.error(t,t instanceof Object,typeof t);return}}function E0(t){return t==null?void 0:t.deref()}var Vue="_MSG_BUS_RPC_",dR=300*1e3,jue=(t=>(t.PUBLISH="publish",t.SUBSCRIBE="subscribe",t.PUSH="push",t.PULL="pull",t))(jue||{}),xH=class{constructor(t){this.bus=t}processRemoteMessage(t,e){let r=l1(e),i=t.topic,n=t.type,s=t.message;switch(n){case"pull":this.bus.pull(i,a=>{this.push(i,a,E0(r))});break;case"subscribe":this.bus.subscribe(i,a=>{this.publish(i,a,E0(r))});break;case"publish":this.bus.publish(i,s,this,E0(r));break;case"push":this.bus.push(i,s,this,E0(r));break;default:console.debug("unknown message type "+n)}}rpcCall(t,e,r,i=dR){let n=l1(r),s=new Promise(a=>{let o=this.bus.uniqueRpcTopic(t);this.publish(t,{message:e,reply:o},E0(n)),this.bus.pull(o,(l,c,u)=>{a({message:l,bridge:c,source:l1(u)})})});return i>0?Promise.race([s,new Promise((a,o)=>{setTimeout(o,i)})]):s}},Que=class extends xH{constructor(t,e){super(t),this.worker=e,e.onmessage=r=>{this.processRemoteMessage(r.data,void 0)}}publish(t,e){this.postMessage(t,"publish",e)}subscribe(t){this.postMessage(t,"subscribe",null)}push(t,e){this.postMessage(t,"push",e)}pull(t){this.postMessage(t,"pull",null)}rpcCall(t,e,r=dR){return super.rpcCall(t,e,void 0,r)}postMessage(t,e,r){let i={topic:t,type:e,message:r};this.worker.postMessage(i)}discard(){this.worker.terminate()}},zue=class extends xH{constructor(t){super(t),window.addEventListener("message",e=>{this.processRemoteMessage(e.data,e.source)},!1)}publish(t,e,r){this.postMessage(t,"publish",e,r)}subscribe(t,e){if(e===window)throw new Error("regist remote subscribe from current window is not permitted");this.postMessage(t,"subscribe",null,e)}push(t,e,r){this.postMessage(t,"push",e,r)}pull(t,e){if(e===window)throw new Error("regist remote pull from current window is not permitted");this.postMessage(t,"pull",null,e)}postMessage(t,e,r,i){let n={topic:t,type:e,message:r};i&&i.postMessage(n,"*")}},lR=class{constructor(t){this.isRunning=!0,this.callback=t}cancel(){this.callback=null,this.isRunning=!1}running(){return this.isRunning}execute(t,e,r,i){try{t=i?t:hB(t),this.callback(t,e,r)}catch(n){console.error(n)}}},Xue=class{constructor(t=!1){this.subscribed={},this.pulled={},this.pushed={},this.uuid=crypto.randomUUID().replace(/-/g,""),this.rpcTicket=0,this.unsafe=t}uniqueRpcTopic(t){return`${Vue}-${t}-${this.uuid}-${this.rpcTicket++}`}publish(t,e,r,i){let n=this.subscribed[t];if(n){let s;for(let a of n)a.running()?a.execute(e,r,i,this.unsafe):(s=s||new Array,s.push(a));if(s)for(let a of s)Hue(n,a)}else console.debug("no sub on topic: "+t)}subscribe(t,e){let r=new lR(e);return aR(this.subscribed,t).push(r),r}push(t,e,r,i){let n=!1,s=this.pulled[t];if(s){for(;s.length>0;){let a=s.shift();if(a.running()){a.execute(e,r,i,this.unsafe),n=!0;break}}s.length===0&&delete this.pulled[t]}n||aR(this.pushed,t).push({message:e,bridge:r,source:l1(i)})}pull(t,e){let r=new lR(e),i=this.pushed[t];if(i){let n=i.shift();r.execute(n.message,n.bridge,E0(n.source),this.unsafe),i.length===0&&delete this.pushed[t]}else aR(this.pulled,t).push(r);return r}pullA(t){return new Promise(e=>{this.pull(t,(r,i,n)=>{e({message:r,bridge:i,source:l1(n)})})})}rpcService(t,e){this.subscribe(t,(r,i,n)=>{let{message:s,reply:a}=r;try{let o=e(s);if(o instanceof Promise){let l=l1(n);o.then(c=>{this.rpcReply(c,a,i,E0(l))},c=>{console.error(c),this.rpcReply(void 0,a,i,E0(l))})}else this.rpcReply(o,a,i,n)}catch(o){console.error(o),this.rpcReply(void 0,a,i,n)}})}rpcCall(t,e,r=dR){let i=new Promise(n=>{let s=this.uniqueRpcTopic(t);this.publish(t,{message:e,reply:s}),this.pull(s,(a,o,l)=>{n({message:a,bridge:o,source:l1(l)})})});return r>0?Promise.race([i,new Promise((n,s)=>{setTimeout(s,r)})]):i}rpcReply(t,e,r,i){r?r.push(e,t,i):this.push(e,t)}},que="_MSG_BUS_RPC_";function cR(t,e){let r=0,i=t.length;for(let n=0;n<i;n++)t[n]===e&&(t.splice(n,1),n--,i--,r++);return r}function Bx(t,e){return Wue(t,e,()=>[])}function Wue(t,e,r){let i=t[e];return i!==void 0||(i=r(e),t[e]=i),i}var fv=class{constructor(t,e){this.callback=t,this.unsafe=e,this.isRunning=!0}cancel(){this.callback=null,this.isRunning=!1}running(){return this.isRunning}async execute(t){try{t=this.unsafe?t:hB(t),this.callback(t)}catch(e){console.error(e)}}},EH=class{constructor(t=crypto.randomUUID()){this.uuid=t,this.rpcTicket=0}subscribeOnce(t,e){let r=this.subscribe(t,i=>{r.cancel(),e(i)});return r}pullA(t){return new Promise(e=>{this.pull(t,e)})}rpcService(t,e){let r=i=>{try{let{message:n,replyTopic:s}=i;try{let a=e(n);a instanceof Promise?a.then(o=>{this.publish(s,{success:!0,result:o})}).catch(o=>{console.error(o),this.publish(s,{success:!1,err:String(o)})}):this.publish(s,{success:!0,result:a})}catch(a){this.publish(s,{success:!1,err:String(a)})}}finally{this.pull(t,r)}};this.pull(t,r)}rpcCall(t,e,r=0){let i=new Promise((n,s)=>{let a=`${que}-${t}-${this.uuid}-${this.rpcTicket++}`;this.subscribeOnce(a,o=>{o.success?n(o.result):s(new Error(o.err))}),this.push(t,{message:e,replyTopic:a})});return r>0?Promise.race([i,new Promise((n,s)=>{setTimeout(s,r)})]):i}},Kue=class extends EH{constructor(t=!1){super(),this.unsafe=t,this.subscribed={},this.pulled={},this.pushed={}}publish(t,e){let r=this.subscribed[t];if(r){let i;for(let n of r)n.running()?n.execute(e):(i=i||new Array,i.push(n));if(i)for(let n of i)cR(r,n)}}subscribe(t,e){let r=new fv(e,this.unsafe);return Bx(this.subscribed,t).push(r),r}push(t,e){let r=!1,i=this.pulled[t];if(i){for(;i.length>0;){let n=i.shift();if(n&&n.running()){n.execute(e),r=!0;break}}i.length===0&&delete this.pulled[t]}r||Bx(this.pushed,t).push(e)}pull(t,e){let r=new fv(e,this.unsafe);return this.repull(t,r),r}repull(t,e){let r=this.pushed[t];if(r){let i=r.shift();i&&(e.execute(i),r.length===0&&delete this.pushed[t])}else Bx(this.pulled,t).push(e)}},Jue=class extends EH{constructor(t=crypto.randomUUID()){super(t),this.subscribed={},this.pushed={},this.pulled={},this.pushCnt=0}publish(t,e){console.debug("BC",this.uuid,"PUBLISH",t,e),this.broadcastPublish(t,e)}subscribe(t,e){console.debug("BC",this.uuid,"SUBSCRIBE",t);let r=new fv(e,!0);return Bx(this.subscribed,t).push(r),r}push(t,e){let r=this.pushCnt++;console.debug("BC",this.uuid,"PUSH",t,`(${r})`,e),Bx(this.pushed,t).push({id:r,message:e}),this.broadcastPushedHeadMessage(t)}pull(t,e){console.debug("BC",this.uuid,"PULL",t);let r=new fv(e,!0);return Bx(this.pulled,t).push(r),this.broadcastWhoHas(t),r}broadcastPushedHeadMessage(t){let e=this.pushed[t];e&&e[0]&&this.broadcastIHave(t,e[0].id)}onReceivedPublish(t,e,r){console.debug("BCMSG(",this.uuid,")","from",t,"PUBLISH",e,"message",r);let i=this.subscribed[e];if(i){let n;for(let s of i)s.running()?s.execute(r):(n=n||new Array,n.push(s));if(n)for(let s of n)cR(i,s);i.length===0&&delete this.subscribed[e]}}onReceivedWhoHas(t,e){console.debug("BCMSG(",this.uuid,")","from",t,"WHOHAS",e),this.broadcastPushedHeadMessage(e)}onReceivedIHave(t,e,r){console.debug("BCMSG(",this.uuid,")","from",t,"IHAVE",e,"id",r);let i=this.pulled[e];if(i){let n;for(let s of i)if(s.running()){this.broadcastINeed(e,t,r);break}else n=n||new Array,n.push(s);if(n)for(let s of n)cR(i,s);i.length===0&&delete this.pulled[e]}}onReceivedINeed(t,e,r,i){if(console.debug("BCMSG(",this.uuid,")","from",t,"INEED",e,"source",r,"id",i),this.uuid===r){let n=this.pushed[e];if(n&&n[0]&&n[0].id===i){let{message:s}=n.shift();this.broadcastIGive(e,i,t,s),this.broadcastPushedHeadMessage(e),n.length===0&&delete this.pushed[e]}}}onReceivedIGive(t,e,r,i,n){console.debug("BCMSG(",this.uuid,")","from",t,"IGIVE",e,"id",r,"target",i,"message",n);let s=this.pulled[e];if(s&&this.uuid===i){let a=!1;for(;s.length>0;){let o=s.shift();if(o.running()){o.execute(n),a=!0;break}}a||this.push(e,n),s.length===0&&delete this.pulled[e]}}},$ue=class extends Jue{constructor(t,e=crypto.randomUUID()){super(e),this.bc=new BroadcastChannel(t),this.bc.onmessage=r=>{this.onMessage(r.data)}}onMessage(t){let{type:e,uuid:r,topic:i}=t;switch(e){case"PUBLISH":{let{message:n}=t;this.onReceivedPublish(r,i,n);break}case"WHOHAS":{this.onReceivedWhoHas(r,i);break}case"IHAVE":{let{id:n}=t;this.onReceivedIHave(r,i,n);break}case"INEED":{let{source:n,id:s}=t;this.onReceivedINeed(r,i,n,s);break}case"IGIVE":{let{target:n,id:s,message:a}=t;this.onReceivedIGive(r,i,s,n,a);break}default:console.warn("unsupported",t)}}broadcastPublish(t,e){this.post({type:"PUBLISH",uuid:this.uuid,topic:t,message:e})}broadcastWhoHas(t){this.post({type:"WHOHAS",uuid:this.uuid,topic:t})}broadcastIHave(t,e){this.post({type:"IHAVE",uuid:this.uuid,topic:t,id:e})}broadcastINeed(t,e,r){this.post({type:"INEED",uuid:this.uuid,topic:t,source:e,id:r})}broadcastIGive(t,e,r,i){this.post({type:"IGIVE",uuid:this.uuid,topic:t,id:e,target:r,message:i})}post(t){this.bc.postMessage(t),Promise.resolve().then(()=>{this.onMessage(t)})}},Dx=Symbol("BLOCKING_QUEUE_RESET"),wH=class{constructor(t,e=()=>1){if(this.maxSize=t,this.itemSizeOf=e,this.queue=new uB,this.waitingConsumers=new uB,this.waitingProducers=new uB,this.queueSize=0,this.closePromise=null,this.closeResolve=null,t<=0)throw new Error("Max size must be greater than 0")}enqueue(t){return this.closePromise?!1:this.isFull()?(async()=>{console.debug("queue is full",this.queueSize,this.maxSize);let e=await new Promise(r=>{this.waitingProducers.enqueue(r)});return console.debug("queue is not full",this.size(),e),e?(this.innerEnqueue(t),!0):!1})():(this.innerEnqueue(t),!0)}innerEnqueue(t){if(this.waitingConsumers.isEmpty())this.queue.enqueue(t),this.queueSize+=this.itemSizeOf(t),console.debug("queue pushed",t,"size",this.queueSize);else{let e=this.waitingConsumers.dequeue();Promise.resolve(t).then(e),console.debug("queue direct",t,"size",this.queueSize)}}dequeue(){if(this.queue.isEmpty())if(this.closePromise){for(;!this.waitingConsumers.isEmpty();){let t=this.waitingConsumers.dequeue();Promise.resolve(Dx).then(t)}return setTimeout(()=>this.closeResolve(),0),Dx}else return new Promise(t=>{this.waitingConsumers.enqueue(t)});else{let t=this.queue.dequeue();if(this.queueSize-=this.itemSizeOf(t),!this.waitingProducers.isEmpty()){let e=this.waitingProducers.dequeue();Promise.resolve(!0).then(e)}return t}}size(){return this.queueSize}isEmpty(){return this.queueSize===0}isFull(){return this.queueSize>=this.maxSize}close(){return this.closePromise||(this.closePromise=new Promise(t=>{for(this.closeResolve=t;!this.waitingProducers.isEmpty();){let e=this.waitingProducers.dequeue();Promise.resolve(!1).then(e)}if(this.queueSize===0){for(;!this.waitingConsumers.isEmpty();){let e=this.waitingConsumers.dequeue();Promise.resolve(Dx).then(e)}t()}})),this.closePromise}};function AR(t,e,r=Number.MAX_SAFE_INTEGER){let i=new wH(r,e),n=new ReadableStream({pull(a){let o=!0,l=(async()=>{let c=new Array;do{let u=i.dequeue();if(u instanceof Promise){o=!1;let d=await u;d===Dx?a.close():c.push(d)}else{let d=u;d===Dx?a.close():c.push(d)}}while(i.size()>0);if(c.length>0){let u=t(c);a.enqueue(u)}})();if(!o)return console.debug("read stream stucked --------------------------------------"),l},async cancel(){console.debug("buffered readable cancel"),await i.close()}}),s=new WritableStream({write(a,o){let l=!0,c=(async()=>{let u=i.enqueue(a);typeof u=="boolean"?u||o.error(new Error("Write stream closed")):(l=!1,await u||o.error(new Error("Write stream closed")))})();if(!l)return console.debug("read stream stucked >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"),c},async close(){console.debug("buffered writable closing",i.size()),await i.close(),console.debug("buffered writable closed",i.size())},async abort(){console.debug("buffered writable aborting",i.size()),await i.close(),console.debug("buffered writable aborted",i.size())}});return{readable:n,writable:s}}function vH(t=Number.MAX_SAFE_INTEGER){return AR(e=>e.join(""),e=>e.length,t)}function CH(t=Number.MAX_SAFE_INTEGER){return AR(e=>{let r=new Uint8Array(e.reduce((n,s)=>n+s.byteLength,0)),i=0;return e.forEach(n=>{r.set(n,i),i+=n.byteLength}),r},e=>e.byteLength,t)}function SH(t){return new Promise((e,r)=>{let i=new BroadcastChannel(t),n=new wH(1),s=new Fue(1),a=null,o=!1,l=!1,c=!1;i.onmessage=u=>{let d=u.data,{type:A}=d;if(console.debug("p2p",t,"type",A,"data",A==="DATA"&&d.data),A==="DATA")n.enqueue(d.data);else if(A==="HI"){if(!a){i.postMessage({type:"HI"});let m=0;a={rs:new ReadableStream({async pull(y){let g=await n.dequeue();g===Dx?(await f(),y.close()):(y.enqueue(g),i.postMessage({type:"ACK"}))},cancel(){return f()}}),ws:new WritableStream({async write(y,g){await s.acquireSync()?i.postMessage({type:"DATA",id:m++,data:y}):(h(),g.error(new Error("Write stream closed")))},close(){h()},abort(){h()}})},e(a)}}else A==="REND"?a?s.close():p("REND1"):A==="WEND"?a?n.close():p("WEND1"):A==="ACK"&&s.release();function h(){o||(o=!0,console.debug(t,"p2p write stream closed"),s.close(),i.postMessage({type:"WEND"}),l&&(console.debug(t,"p2p channel closed on ws"),i.close()))}async function f(){l||(l=!0,console.debug(t,"p2p read stream closed"),i.postMessage({type:"REND"}),await n.close(),o&&(console.debug(t,"p2p channel closed on rs"),i.close()))}async function p(m){c||(c=!0,console.debug(t,"p2p channel connection released on",m),s.close(),n.close(),a?(a.rs.locked||(console.debug(t,"p2p unlocked read stream direct cancel"),a.rs.cancel()),a.ws.locked||(console.debug(t,"p2p unlocked write stream direct close"),a.ws.close())):(i.postMessage({type:"HI"}),i.close()),r(new Error("p2p channel connection released")))}},i.postMessage({type:"HI"})})}function Zue(t){return new Promise(e=>{let r=new BroadcastChannel(t);r.onmessage=i=>{let n=i.data,{type:s}=n;s==="HI"&&(r.postMessage({type:"REND"}),r.close(),e())},r.postMessage({type:"REND"})})}async function TH(t){try{return await SH(t)}catch(e){e.message!=="p2p channel connection released"&&console.error(e)}}async function ehe(t,e,r=10*1024*1024,i=!0){let n=await TH(t);if(!n)return!1;let s=!1;try{let a,o=l=>{if(!a)if(!i)a=n.ws.getWriter();else if(typeof l=="string"){let c=vH(r);c.readable.pipeTo(n.ws),a=c.writable.getWriter()}else{let c=CH(r);c.readable.pipeTo(n.ws),a=c.writable.getWriter()}return a.write(l)};if(Array.isArray(e))for(let l of e)await o(l);else await e({write:o,get desiredSize(){return((a==null?void 0:a.desiredSize)||0)+10}});a&&await a.close(),s=!0}catch(a){console.error(a)}finally{return n.rs.cancel(),s}}async function the(t,e){var i,n;let r=await TH(t);if(r)try{let s=r.rs.getReader();for((i=e.start)==null?void 0:i.call(e);;){let{value:a,done:o}=await s.read();if(a!==void 0){let l;if(e.update instanceof Promise?l=await e.update(a):l=e.update(a),l){await s.cancel();break}}if(o){(n=e.end)==null||n.call(e);break}}}catch(s){console.error(s)}finally{r.ws.close()}}});var bW=yt((bdt,yW)=>{var _L=[];_L.push("g.selected>.primitive-text{fill:var(--selectColor)}g.highlight>.primitive-text{fill:var(--highlight)}#selectBox1,.cross-path{stroke:var(--selectColor)}.cross-path-content{fill:var(--selectColor)}.control-dot:hover,.handle-dot:hover{fill:var(--highlight)}.control-dot.selected,.handle-dot.selected{fill:var(--selectColor)}.dimensionAngle text,.dimensionLength text,.dimensionRadius text{fill:var(--normalDimensionColor)}.dimensionAngle line,.dimensionAngle path,.dimensionAngle polyline,.dimensionLength line,.dimensionLength path,.dimensionLength polyline,.dimensionRadius line,.dimensionRadius path,.dimensionRadius polyline{stroke:var(--normalDimensionColor)}.dimensionAngle.selected .key-point,.dimensionLength.selected .key-point,.dimensionRadius.selected .key-point{display:inline;display:initial}.dimensionAngle .key-point,.dimensionLength .key-point,.dimensionRadius .key-point{display:none}.dimensionAngle.highlight text,.dimensionLength.highlight text,.dimensionRadius.highlight text{fill:var(--highlight);stroke:none}.dimensionAngle.highlight line,.dimensionAngle.highlight path,.dimensionAngle.highlight polyline,.dimensionLength.highlight line,.dimensionLength.highlight path,.dimensionLength.highlight polyline,.dimensionRadius.highlight line,.dimensionRadius.highlight path,.dimensionRadius.highlight polyline{stroke:var(--highlight)}.dimensionAngle.selected text,.dimensionLength.selected text,.dimensionRadius.selected text{fill:var(--selectColor);stroke:none}.dimensionAngle.selected line,.dimensionAngle.selected path,.dimensionAngle.selected polyline,.dimensionLength.selected line,.dimensionLength.selected path,.dimensionLength.selected polyline,.dimensionRadius.selected line,.dimensionRadius.selected path,.dimensionRadius.selected polyline{stroke:var(--selectColor)}[c_partid=dimension][category=Constraint] text{fill:var(--dimensionConstraintColor);stroke:none}[c_partid=dimension][category=Constraint] line,[c_partid=dimension][category=Constraint] polyline{stroke:var(--dimensionConstraintColor)}[c_partid=dimension][category=Annotation] text{fill:var(--dimensionLabelColor);stroke:none}[c_partid=dimension][category=Annotation] line,[c_partid=dimension][category=Annotation] polyline{stroke:var(--dimensionLabelColor)}[c_partid=dimension].highlight text{fill:var(--highlight);stroke:none}[c_partid=dimension].highlight line,[c_partid=dimension].highlight polyline{stroke:var(--highlight)}[c_partid=dimension].selected text{fill:var(--selectColor);stroke:none}[c_partid=dimension].selected line,[c_partid=dimension].selected polyline{stroke:var(--selectColor)}#gridCell [type=dot]{fill:var(--gridColor)}#gridCell [type=line]{stroke:var(--gridColor)}");_L=_L.join("");function gW(){let t=document.createElement("style");t.innerHTML=_L,document.head.appendChild(t)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",gW):gW();yW.exports={selected:"selected","primitive-text":"primitive-text",highlight:"highlight",selectBox1:"selectBox1","cross-path":"cross-path","cross-path-content":"cross-path-content","control-dot":"control-dot","handle-dot":"handle-dot",dimensionAngle:"dimensionAngle",dimensionLength:"dimensionLength",dimensionRadius:"dimensionRadius","key-point":"key-point",gridCell:"gridCell"}});var EW=yt((xdt,xW)=>{var PL=[];PL.push(`<!-- \u9762\u677F\u5E93\u9884\u89C8\u8981\u590D\u7528\u8FD9\u4E2A\u6587\u4EF6\uFF0C\u62BD\u53D6\u51FA\u6765 -->
<style type="text/css" id="layer-css-container">
	html,
	body {
		padding: 0px;
		margin: 0px;
		border: none;
		/* \u68CB\u76D8\u683C\u80CC\u666F\u56FE\u7247 */
		background-image: url(data:image/gif;base64,R0lGODlhEAAQAIAAAP///9/f3yH5BAAHAP8ALAAAAAAQABAAAAIfjG+gq4jM3IFLJgpswNly/XkcBpIiVaInlLJr9FZWAQA7);
	}

	body > #root {
		position: absolute;
		left: 0px;
		top: 0px;
		margin: 0;
	}
	.panel-mark,
	rect.panel-border {
		pointer-events: none;
		stroke-width: 1;
		vector-effect: non-scaling-stroke;
	}
	[layer='2']:not([stroke='none']) /* \u900F\u660E\u63A7\u5236\u5C42 */ {
		stroke: #999;
		stroke-width: 1;
		vector-effect: non-scaling-stroke;
	}
	[layer='2'], [layer='2'] path:not([fill='none']):not(.hitbox) /* \u900F\u660E\u63A7\u5236\u5C42 */ {
		fill: url(#slashPattern);
	}
	[layer='2'][c_partid="part_text"] path:not([fill='none']):not(.hitbox) /* \u900F\u660E\u63A7\u5236\u5C42\u7684\u6587\u672C */ {
		stroke-width: 0.5px;
	}

	/* \u677F\u6846\u6316\u7A7A\u5C42 */
	[layer='4'] {
		fill: url(#transparent-pattern);
		stroke-width: 1;
		vector-effect: non-scaling-stroke;
		stroke: #000;
	}

	/* \u80CC\u80F6\u6316\u7A7A\u5C42 */
	[layer='5'] {
		stroke-width: 1;
		vector-effect: non-scaling-stroke;
		fill: url(#grid-45-degree);
		stroke: #ccc;
	}
	/* \u9F13\u5305\u5C42 */
	[layer='7'] {
		fill: transparent;
		stroke: #ff00ff;
		stroke-width: 1;
		stroke-dasharray: 12 4 2 4;
		vector-effect: non-scaling-stroke;
	}

	/* \u677F\u6846\u5C42 */
	[layer='3'] {
		stroke-width: 1;
		stroke: black;
		vector-effect: non-scaling-stroke;
		fill: none;
	}
	[layer='3'][stroke='none'] {
		stroke: #000;
	}
	/* svg g\u6807\u7B7E\u8F83\u4E3A\u7279\u6B8A\uFF0C\u5B58\u5728\u5B50\u5143\u7D20\u65E0\u6CD5\u7EE7\u627F\u5176\u5C5E\u6027\u60C5\u51B5 */
	*[hide='1']:not([stroke='none']),
	g[hide='1'] > *:not([stroke='none']) {
		stroke: #ffff00 !important;
		stroke-opacity: 0.2 !important;
		opacity: 1 !important;
	}
	*[hide='1']:not([fill='none']),
	g[hide='1'] > *:not([fill='none']) {
		fill: #ffff00 !important;
		fill-opacity: 0.2 !important;
		opacity: 1 !important;
	}
	/* \u4E0D\u900F\u660E\u5EA6\u503C\u592A\u5C0F\u4E86\u770B\u4E0D\u89C1\u4E0D\u65B9\u4FBF\u8BC6\u522B\uFF0C\u8FDB\u884C\u4E00\u4E0B\u589E\u5F3A */
	#g1 [opacity='0'],
	#g1 [opacity^='0.0'] {
		opacity: 0.1;
	}

	.key-point {
		display: none;
	}

	/* \u8F85\u52A9\u7EBF start */
	[c_partid='auxiliaryLine']:not([stroke]) {
		stroke: var(--auxiliaryLineColor);
	}
	[c_partid='auxiliaryLine']:not([stroke-dasharray]) {
		stroke-dasharray: var(--auxiliaryLineDashArray);
	}
	[c_partid='auxiliaryLine'].selected {
		stroke: var(--selectColor);
	}
	[c_partid='auxiliaryLine'].highlight {
		stroke: var(--highlight);
	}
	/* \u8F85\u52A9\u7EBF end */

	/* \u8F85\u52A9\u70B9 start */
	[c_partid='auxiliaryPoint']:not([fill]) {
		fill: var(--auxiliaryPointFillColor);
	}
	[c_partid='auxiliaryPoint'].selected {
		fill: var(--selectColor);
	}
	[c_partid='auxiliaryPoint'].highlight {
		fill: var(--highlight);
	}
	/* \u8F85\u52A9\u70B9 end */

	`);PL.push(bW());PL.push(`
</style>
`);xW.exports=PL.join("")});var CW=yt((Edt,vW)=>{var wW=[];wW.push(`<defs id="patterns">
	<pattern id="gridPattern" x="0" y="0" width="5" height="5" patternUnits="userSpaceOnUse">
		<g id="gridCell"></g>
		<!-- <rect id="gridCell" x="0" y="0" width="1" height="1" fill="#CCCCCC" stroke="none" fill-opacity="0.8" type="dot"></rect> -->
	</pattern>
	<pattern id="chessPattern" x="0" y="0" width="16" height="16" patternUnits="userSpaceOnUse">
		<rect x="0" y="0" width="16" height="16" fill="#fff"></rect>
		<polyline points="0,8 8,0, 16,8 8,16" stroke="none" fill="#999"></polyline>
	</pattern>

	<pattern id="transparent-pattern" x="0" y="0" width="16" height="16" patternUnits="userSpaceOnUse">
		<rect x="0" y="0" width="16" height="16" fill="#fff" stroke="none"></rect>
		<rect x="0" y="0" width="8" height="8" fill="#dfdfdf" stroke="none"></rect>
		<rect x="8" y="8" width="8" height="8" fill="#dfdfdf" stroke="none"></rect>
	</pattern>

	<filter id="inset-shadow" x="-50%" y="-50%" width="200%" height="200%">
		<feComponentTransfer in="SourceAlpha">
			<feFuncA type="table" tableValues="1 0"></feFuncA>
		</feComponentTransfer>

		<feGaussianBlur stdDeviation="10"></feGaussianBlur>

		<feOffset dx="0" dy="0" result="offsetblur"></feOffset>

		<feFlood flood-color="#eee" result="color"></feFlood>

		<feComposite in2="offsetblur" operator="in"></feComposite>
		<feComposite in2="SourceAlpha" operator="in"></feComposite>

		<feMerge>
			<feMergeNode in="SourceGraphic"></feMergeNode>
			<feMergeNode></feMergeNode>
			<feMergeNode></feMergeNode>
			<feMergeNode></feMergeNode>
			<feMergeNode></feMergeNode>
		</feMerge>
	</filter>

	<pattern id="grid-45-degree" x="0" y="0" width="8" height="8" patternUnits="userSpaceOnUse">
		<rect x="0" y="0" width="8" height="8" fill="#fff"></rect>
		<line x1="0" y1="0" x2="8" y2="8" stroke="#ccc" fill="none"></line>
		<line x1="8" y1="0" x2="0" y2="8" stroke="#ccc" fill="none"></line>
	</pattern>

	<pattern id="slashPattern" x="0" y="0" width="16" height="16" patternUnits="userSpaceOnUse">
		<rect x="0" y="0" width="16" height="16" fill="#ccc" stroke="none"></rect>
		<path d="M 8 0 L 16 0 0 16 0 8 Z M 8 16 L 16 8 16 16 Z" fill="#999" stroke="none"></path>
	</pattern>

	<svg id="icon-lock" viewBox="0 0 20 20" height="20" width="20">
		<path
			stroke="#F0F"
			stroke-width="2"
			style="cursor:pointer;fill-opacity:0.001;fill:#fff;"
			d="M 5 7 C 5 -1 15 -1 15 7L1 7 1 19 19 19 19 7 15 7"
		></path>
	</svg>
</defs>
`);vW.exports=wW.join("")});function ys(t){"@babel/helpers - typeof";return ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ys(t)}var PO=p0(()=>{});var e$=yt((I8,B8)=>{(function(t,e){typeof I8=="object"&&typeof B8<"u"?B8.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self,t.html2canvas=e())})(I8,(function(){"use strict";var t=function(L,D){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(F,k){F.__proto__=k}||function(F,k){for(var re in k)Object.prototype.hasOwnProperty.call(k,re)&&(F[re]=k[re])},t(L,D)};function e(L,D){if(typeof D!="function"&&D!==null)throw new TypeError("Class extends value "+String(D)+" is not a constructor or null");t(L,D);function F(){this.constructor=L}L.prototype=D===null?Object.create(D):(F.prototype=D.prototype,new F)}var r=function(){return r=Object.assign||function(D){for(var F,k=1,re=arguments.length;k<re;k++){F=arguments[k];for(var ce in F)Object.prototype.hasOwnProperty.call(F,ce)&&(D[ce]=F[ce])}return D},r.apply(this,arguments)};function i(L,D,F,k){function re(ce){return ce instanceof F?ce:new F(function(xe){xe(ce)})}return new(F||(F=Promise))(function(ce,xe){function Re(lt){try{tt(k.next(lt))}catch(St){xe(St)}}function Ne(lt){try{tt(k.throw(lt))}catch(St){xe(St)}}function tt(lt){lt.done?ce(lt.value):re(lt.value).then(Re,Ne)}tt((k=k.apply(L,D||[])).next())})}function n(L,D){var F={label:0,sent:function(){if(ce[0]&1)throw ce[1];return ce[1]},trys:[],ops:[]},k,re,ce,xe;return xe={next:Re(0),throw:Re(1),return:Re(2)},typeof Symbol=="function"&&(xe[Symbol.iterator]=function(){return this}),xe;function Re(tt){return function(lt){return Ne([tt,lt])}}function Ne(tt){if(k)throw new TypeError("Generator is already executing.");for(;F;)try{if(k=1,re&&(ce=tt[0]&2?re.return:tt[0]?re.throw||((ce=re.return)&&ce.call(re),0):re.next)&&!(ce=ce.call(re,tt[1])).done)return ce;switch(re=0,ce&&(tt=[tt[0]&2,ce.value]),tt[0]){case 0:case 1:ce=tt;break;case 4:return F.label++,{value:tt[1],done:!1};case 5:F.label++,re=tt[1],tt=[0];continue;case 7:tt=F.ops.pop(),F.trys.pop();continue;default:if(ce=F.trys,!(ce=ce.length>0&&ce[ce.length-1])&&(tt[0]===6||tt[0]===2)){F=0;continue}if(tt[0]===3&&(!ce||tt[1]>ce[0]&&tt[1]<ce[3])){F.label=tt[1];break}if(tt[0]===6&&F.label<ce[1]){F.label=ce[1],ce=tt;break}if(ce&&F.label<ce[2]){F.label=ce[2],F.ops.push(tt);break}ce[2]&&F.ops.pop(),F.trys.pop();continue}tt=D.call(L,F)}catch(lt){tt=[6,lt],re=0}finally{k=ce=0}if(tt[0]&5)throw tt[1];return{value:tt[0]?tt[1]:void 0,done:!0}}}function s(L,D,F){if(F||arguments.length===2)for(var k=0,re=D.length,ce;k<re;k++)(ce||!(k in D))&&(ce||(ce=Array.prototype.slice.call(D,0,k)),ce[k]=D[k]);return L.concat(ce||D)}for(var a=(function(){function L(D,F,k,re){this.left=D,this.top=F,this.width=k,this.height=re}return L.prototype.add=function(D,F,k,re){return new L(this.left+D,this.top+F,this.width+k,this.height+re)},L.fromClientRect=function(D,F){return new L(F.left+D.windowBounds.left,F.top+D.windowBounds.top,F.width,F.height)},L.fromDOMRectList=function(D,F){var k=Array.from(F).find(function(re){return re.width!==0});return k?new L(k.left+D.windowBounds.left,k.top+D.windowBounds.top,k.width,k.height):L.EMPTY},L.EMPTY=new L(0,0,0,0),L})(),o=function(L,D){return a.fromClientRect(L,D.getBoundingClientRect())},l=function(L){var D=L.body,F=L.documentElement;if(!D||!F)throw new Error("Unable to get document size");var k=Math.max(Math.max(D.scrollWidth,F.scrollWidth),Math.max(D.offsetWidth,F.offsetWidth),Math.max(D.clientWidth,F.clientWidth)),re=Math.max(Math.max(D.scrollHeight,F.scrollHeight),Math.max(D.offsetHeight,F.offsetHeight),Math.max(D.clientHeight,F.clientHeight));return new a(0,0,k,re)},c=function(L){for(var D=[],F=0,k=L.length;F<k;){var re=L.charCodeAt(F++);if(re>=55296&&re<=56319&&F<k){var ce=L.charCodeAt(F++);(ce&64512)===56320?D.push(((re&1023)<<10)+(ce&1023)+65536):(D.push(re),F--)}else D.push(re)}return D},u=function(){for(var L=[],D=0;D<arguments.length;D++)L[D]=arguments[D];if(String.fromCodePoint)return String.fromCodePoint.apply(String,L);var F=L.length;if(!F)return"";for(var k=[],re=-1,ce="";++re<F;){var xe=L[re];xe<=65535?k.push(xe):(xe-=65536,k.push((xe>>10)+55296,xe%1024+56320)),(re+1===F||k.length>16384)&&(ce+=String.fromCharCode.apply(String,k),k.length=0)}return ce},d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",A=typeof Uint8Array>"u"?[]:new Uint8Array(256),h=0;h<d.length;h++)A[d.charCodeAt(h)]=h;for(var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=typeof Uint8Array>"u"?[]:new Uint8Array(256),m=0;m<f.length;m++)p[f.charCodeAt(m)]=m;for(var y=function(L){var D=L.length*.75,F=L.length,k,re=0,ce,xe,Re,Ne;L[L.length-1]==="="&&(D--,L[L.length-2]==="="&&D--);var tt=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(D):new Array(D),lt=Array.isArray(tt)?tt:new Uint8Array(tt);for(k=0;k<F;k+=4)ce=p[L.charCodeAt(k)],xe=p[L.charCodeAt(k+1)],Re=p[L.charCodeAt(k+2)],Ne=p[L.charCodeAt(k+3)],lt[re++]=ce<<2|xe>>4,lt[re++]=(xe&15)<<4|Re>>2,lt[re++]=(Re&3)<<6|Ne&63;return tt},g=function(L){for(var D=L.length,F=[],k=0;k<D;k+=2)F.push(L[k+1]<<8|L[k]);return F},b=function(L){for(var D=L.length,F=[],k=0;k<D;k+=4)F.push(L[k+3]<<24|L[k+2]<<16|L[k+1]<<8|L[k]);return F},E=5,w=11,x=2,I=w-E,C=65536>>E,G=1<<E,U=G-1,_=1024>>E,H=C+_,Q=H,j=32,$=Q+j,B=65536>>w,M=1<<I,v=M-1,N=function(L,D,F){return L.slice?L.slice(D,F):new Uint16Array(Array.prototype.slice.call(L,D,F))},R=function(L,D,F){return L.slice?L.slice(D,F):new Uint32Array(Array.prototype.slice.call(L,D,F))},q=function(L,D){var F=y(L),k=Array.isArray(F)?b(F):new Uint32Array(F),re=Array.isArray(F)?g(F):new Uint16Array(F),ce=24,xe=N(re,ce/2,k[4]/2),Re=k[5]===2?N(re,(ce+k[4])/2):R(k,Math.ceil((ce+k[4])/4));return new P(k[0],k[1],k[2],k[3],xe,Re)},P=(function(){function L(D,F,k,re,ce,xe){this.initialValue=D,this.errorValue=F,this.highStart=k,this.highValueIndex=re,this.index=ce,this.data=xe}return L.prototype.get=function(D){var F;if(D>=0){if(D<55296||D>56319&&D<=65535)return F=this.index[D>>E],F=(F<<x)+(D&U),this.data[F];if(D<=65535)return F=this.index[C+(D-55296>>E)],F=(F<<x)+(D&U),this.data[F];if(D<this.highStart)return F=$-B+(D>>w),F=this.index[F],F+=D>>E&v,F=this.index[F],F=(F<<x)+(D&U),this.data[F];if(D<=1114111)return this.data[this.highValueIndex]}return this.errorValue},L})(),z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",W=typeof Uint8Array>"u"?[]:new Uint8Array(256),oe=0;oe<z.length;oe++)W[z.charCodeAt(oe)]=oe;var Ae="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",me=50,ve=1,Le=2,He=3,rt=4,qe=5,xt=7,Gt=8,ut=9,Pe=10,ft=11,ht=12,Qt=13,Yt=14,Ft=15,kt=16,sr=17,Pt=18,_r=19,Lt=20,ct=21,Zt=22,Jt=23,O=24,K=25,se=26,ae=27,ue=28,Ie=29,Ce=30,st=31,it=32,Kt=33,ar=34,lr=35,yr=36,xi=37,Tr=38,ii=39,nn=40,sn=41,Dn=42,Za=43,ai=[9001,65288],xa="!",Lr="\xD7",mn="\xF7",bs=q(Ae),Zi=[Ce,yr],Do=[ve,Le,He,qe],Su=[Pe,Gt],gc=[ae,se],jc=Do.concat(Su),ec=[Tr,ii,nn,ar,lr],Qc=[Ft,Qt],Uo=function(L,D){D===void 0&&(D="strict");var F=[],k=[],re=[];return L.forEach(function(ce,xe){var Re=bs.get(ce);if(Re>me?(re.push(!0),Re-=me):re.push(!1),["normal","auto","loose"].indexOf(D)!==-1&&[8208,8211,12316,12448].indexOf(ce)!==-1)return k.push(xe),F.push(kt);if(Re===rt||Re===ft){if(xe===0)return k.push(xe),F.push(Ce);var Ne=F[xe-1];return jc.indexOf(Ne)===-1?(k.push(k[xe-1]),F.push(Ne)):(k.push(xe),F.push(Ce))}if(k.push(xe),Re===st)return F.push(D==="strict"?ct:xi);if(Re===Dn||Re===Ie)return F.push(Ce);if(Re===Za)return ce>=131072&&ce<=196605||ce>=196608&&ce<=262141?F.push(xi):F.push(Ce);F.push(Re)}),[k,F,re]},ul=function(L,D,F,k){var re=k[F];if(Array.isArray(L)?L.indexOf(re)!==-1:L===re)for(var ce=F;ce<=k.length;){ce++;var xe=k[ce];if(xe===D)return!0;if(xe!==Pe)break}if(re===Pe)for(var ce=F;ce>0;){ce--;var Re=k[ce];if(Array.isArray(L)?L.indexOf(Re)!==-1:L===Re)for(var Ne=F;Ne<=k.length;){Ne++;var xe=k[Ne];if(xe===D)return!0;if(xe!==Pe)break}if(Re!==Pe)break}return!1},hl=function(L,D){for(var F=L;F>=0;){var k=D[F];if(k===Pe)F--;else return k}return 0},Ms=function(L,D,F,k,re){if(F[k]===0)return Lr;var ce=k-1;if(Array.isArray(re)&&re[ce]===!0)return Lr;var xe=ce-1,Re=ce+1,Ne=D[ce],tt=xe>=0?D[xe]:0,lt=D[Re];if(Ne===Le&&lt===He)return Lr;if(Do.indexOf(Ne)!==-1)return xa;if(Do.indexOf(lt)!==-1||Su.indexOf(lt)!==-1)return Lr;if(hl(ce,D)===Gt)return mn;if(bs.get(L[ce])===ft||(Ne===it||Ne===Kt)&&bs.get(L[Re])===ft||Ne===xt||lt===xt||Ne===ut||[Pe,Qt,Ft].indexOf(Ne)===-1&&lt===ut||[sr,Pt,_r,O,ue].indexOf(lt)!==-1||hl(ce,D)===Zt||ul(Jt,Zt,ce,D)||ul([sr,Pt],ct,ce,D)||ul(ht,ht,ce,D))return Lr;if(Ne===Pe)return mn;if(Ne===Jt||lt===Jt)return Lr;if(lt===kt||Ne===kt)return mn;if([Qt,Ft,ct].indexOf(lt)!==-1||Ne===Yt||tt===yr&&Qc.indexOf(Ne)!==-1||Ne===ue&&lt===yr||lt===Lt||Zi.indexOf(lt)!==-1&&Ne===K||Zi.indexOf(Ne)!==-1&&lt===K||Ne===ae&&[xi,it,Kt].indexOf(lt)!==-1||[xi,it,Kt].indexOf(Ne)!==-1&&lt===se||Zi.indexOf(Ne)!==-1&&gc.indexOf(lt)!==-1||gc.indexOf(Ne)!==-1&&Zi.indexOf(lt)!==-1||[ae,se].indexOf(Ne)!==-1&&(lt===K||[Zt,Ft].indexOf(lt)!==-1&&D[Re+1]===K)||[Zt,Ft].indexOf(Ne)!==-1&&lt===K||Ne===K&&[K,ue,O].indexOf(lt)!==-1)return Lr;if([K,ue,O,sr,Pt].indexOf(lt)!==-1)for(var St=ce;St>=0;){var Ht=D[St];if(Ht===K)return Lr;if([ue,O].indexOf(Ht)!==-1)St--;else break}if([ae,se].indexOf(lt)!==-1)for(var St=[sr,Pt].indexOf(Ne)!==-1?xe:ce;St>=0;){var Ht=D[St];if(Ht===K)return Lr;if([ue,O].indexOf(Ht)!==-1)St--;else break}if(Tr===Ne&&[Tr,ii,ar,lr].indexOf(lt)!==-1||[ii,ar].indexOf(Ne)!==-1&&[ii,nn].indexOf(lt)!==-1||[nn,lr].indexOf(Ne)!==-1&&lt===nn||ec.indexOf(Ne)!==-1&&[Lt,se].indexOf(lt)!==-1||ec.indexOf(lt)!==-1&&Ne===ae||Zi.indexOf(Ne)!==-1&&Zi.indexOf(lt)!==-1||Ne===O&&Zi.indexOf(lt)!==-1||Zi.concat(K).indexOf(Ne)!==-1&&lt===Zt&&ai.indexOf(L[Re])===-1||Zi.concat(K).indexOf(lt)!==-1&&Ne===Pt)return Lr;if(Ne===sn&&lt===sn){for(var Wr=F[ce],Er=1;Wr>0&&(Wr--,D[Wr]===sn);)Er++;if(Er%2!==0)return Lr}return Ne===it&&lt===Kt?Lr:mn},Tu=function(L,D){D||(D={lineBreak:"normal",wordBreak:"normal"});var F=Uo(L,D.lineBreak),k=F[0],re=F[1],ce=F[2];(D.wordBreak==="break-all"||D.wordBreak==="break-word")&&(re=re.map(function(Re){return[K,Ce,Dn].indexOf(Re)!==-1?xi:Re}));var xe=D.wordBreak==="keep-all"?ce.map(function(Re,Ne){return Re&&L[Ne]>=19968&&L[Ne]<=40959}):void 0;return[k,re,xe]},ha=(function(){function L(D,F,k,re){this.codePoints=D,this.required=F===xa,this.start=k,this.end=re}return L.prototype.slice=function(){return u.apply(void 0,this.codePoints.slice(this.start,this.end))},L})(),Sd=function(L,D){var F=c(L),k=Tu(F,D),re=k[0],ce=k[1],xe=k[2],Re=F.length,Ne=0,tt=0;return{next:function(){if(tt>=Re)return{done:!0,value:null};for(var lt=Lr;tt<Re&&(lt=Ms(F,ce,re,++tt,xe))===Lr;);if(lt!==Lr||tt===Re){var St=new ha(F,lt,Ne,tt);return Ne=tt,{value:St,done:!1}}return{done:!0,value:null}}}},is=1,uh=2,Iu=4,oA=8,yc=10,lA=47,Bu=92,Du=9,uf=32,Bl=34,_u=61,Pu=35,hh=36,xn=37,dl=39,zc=40,dh=41,hf=95,za=45,Ho=33,Dl=60,Xa=62,cA=64,df=91,_l=93,Td=61,Oh=123,Lu=63,uA=125,qa=124,Pl=126,Id=128,hA=65533,Al=42,eo=43,Nh=44,Af=58,_n=59,bc=46,ff=0,Fi=8,pf=11,dA=14,Xc=31,Cp=127,Go=-1,Ah=48,AA=97,fl=101,fA=102,mf=117,Rh=122,Ou=65,pl=69,tc=70,fh=85,Mh=90,Pa=function(L){return L>=Ah&&L<=57},gf=function(L){return L>=55296&&L<=57343},ph=function(L){return Pa(L)||L>=Ou&&L<=tc||L>=AA&&L<=fA},$r=function(L){return L>=AA&&L<=Rh},$e=function(L){return L>=Ou&&L<=Mh},ir=function(L){return $r(L)||$e(L)},wr=function(L){return L>=Id},Cn=function(L){return L===yc||L===Du||L===uf},da=function(L){return ir(L)||wr(L)||L===hf},S=function(L){return da(L)||Pa(L)||L===za},V=function(L){return L>=ff&&L<=Fi||L===pf||L>=dA&&L<=Xc||L===Cp},ee=function(L,D){return L!==Bu?!1:D!==yc},ie=function(L,D,F){return L===za?da(D)||ee(D,F):da(L)?!0:!!(L===Bu&&ee(L,D))},he=function(L,D,F){return L===eo||L===za?Pa(D)?!0:D===bc&&Pa(F):Pa(L===bc?D:L)},de=function(L){var D=0,F=1;(L[D]===eo||L[D]===za)&&(L[D]===za&&(F=-1),D++);for(var k=[];Pa(L[D]);)k.push(L[D++]);var re=k.length?parseInt(u.apply(void 0,k),10):0;L[D]===bc&&D++;for(var ce=[];Pa(L[D]);)ce.push(L[D++]);var xe=ce.length,Re=xe?parseInt(u.apply(void 0,ce),10):0;(L[D]===pl||L[D]===fl)&&D++;var Ne=1;(L[D]===eo||L[D]===za)&&(L[D]===za&&(Ne=-1),D++);for(var tt=[];Pa(L[D]);)tt.push(L[D++]);var lt=tt.length?parseInt(u.apply(void 0,tt),10):0;return F*(re+Re*Math.pow(10,-xe))*Math.pow(10,Ne*lt)},ye={type:2},Qe={type:3},Ve={type:4},at={type:13},Ot={type:8},Vt={type:21},Bt={type:9},hr={type:10},Oi={type:11},gn={type:12},Ji={type:14},Vs={type:23},Ha={type:1},J={type:25},fe={type:24},Oe={type:26},Xe={type:27},Je={type:28},_t={type:29},or={type:31},Nr={type:32},ei=(function(){function L(){this._value=[]}return L.prototype.write=function(D){this._value=this._value.concat(c(D))},L.prototype.read=function(){for(var D=[],F=this.consumeToken();F!==Nr;)D.push(F),F=this.consumeToken();return D},L.prototype.consumeToken=function(){var D=this.consumeCodePoint();switch(D){case Bl:return this.consumeStringToken(Bl);case Pu:var F=this.peekCodePoint(0),k=this.peekCodePoint(1),re=this.peekCodePoint(2);if(S(F)||ee(k,re)){var ce=ie(F,k,re)?uh:is,xe=this.consumeName();return{type:5,value:xe,flags:ce}}break;case hh:if(this.peekCodePoint(0)===_u)return this.consumeCodePoint(),at;break;case dl:return this.consumeStringToken(dl);case zc:return ye;case dh:return Qe;case Al:if(this.peekCodePoint(0)===_u)return this.consumeCodePoint(),Ji;break;case eo:if(he(D,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(D),this.consumeNumericToken();break;case Nh:return Ve;case za:var Re=D,Ne=this.peekCodePoint(0),tt=this.peekCodePoint(1);if(he(Re,Ne,tt))return this.reconsumeCodePoint(D),this.consumeNumericToken();if(ie(Re,Ne,tt))return this.reconsumeCodePoint(D),this.consumeIdentLikeToken();if(Ne===za&&tt===Xa)return this.consumeCodePoint(),this.consumeCodePoint(),fe;break;case bc:if(he(D,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(D),this.consumeNumericToken();break;case lA:if(this.peekCodePoint(0)===Al)for(this.consumeCodePoint();;){var lt=this.consumeCodePoint();if(lt===Al&&(lt=this.consumeCodePoint(),lt===lA))return this.consumeToken();if(lt===Go)return this.consumeToken()}break;case Af:return Oe;case _n:return Xe;case Dl:if(this.peekCodePoint(0)===Ho&&this.peekCodePoint(1)===za&&this.peekCodePoint(2)===za)return this.consumeCodePoint(),this.consumeCodePoint(),J;break;case cA:var St=this.peekCodePoint(0),Ht=this.peekCodePoint(1),Wr=this.peekCodePoint(2);if(ie(St,Ht,Wr)){var xe=this.consumeName();return{type:7,value:xe}}break;case df:return Je;case Bu:if(ee(D,this.peekCodePoint(0)))return this.reconsumeCodePoint(D),this.consumeIdentLikeToken();break;case _l:return _t;case Td:if(this.peekCodePoint(0)===_u)return this.consumeCodePoint(),Ot;break;case Oh:return Oi;case uA:return gn;case mf:case fh:var Er=this.peekCodePoint(0),kr=this.peekCodePoint(1);return Er===eo&&(ph(kr)||kr===Lu)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(D),this.consumeIdentLikeToken();case qa:if(this.peekCodePoint(0)===_u)return this.consumeCodePoint(),Bt;if(this.peekCodePoint(0)===qa)return this.consumeCodePoint(),Vt;break;case Pl:if(this.peekCodePoint(0)===_u)return this.consumeCodePoint(),hr;break;case Go:return Nr}return Cn(D)?(this.consumeWhiteSpace(),or):Pa(D)?(this.reconsumeCodePoint(D),this.consumeNumericToken()):da(D)?(this.reconsumeCodePoint(D),this.consumeIdentLikeToken()):{type:6,value:u(D)}},L.prototype.consumeCodePoint=function(){var D=this._value.shift();return typeof D>"u"?-1:D},L.prototype.reconsumeCodePoint=function(D){this._value.unshift(D)},L.prototype.peekCodePoint=function(D){return D>=this._value.length?-1:this._value[D]},L.prototype.consumeUnicodeRangeToken=function(){for(var D=[],F=this.consumeCodePoint();ph(F)&&D.length<6;)D.push(F),F=this.consumeCodePoint();for(var k=!1;F===Lu&&D.length<6;)D.push(F),F=this.consumeCodePoint(),k=!0;if(k){var re=parseInt(u.apply(void 0,D.map(function(Ne){return Ne===Lu?Ah:Ne})),16),ce=parseInt(u.apply(void 0,D.map(function(Ne){return Ne===Lu?tc:Ne})),16);return{type:30,start:re,end:ce}}var xe=parseInt(u.apply(void 0,D),16);if(this.peekCodePoint(0)===za&&ph(this.peekCodePoint(1))){this.consumeCodePoint(),F=this.consumeCodePoint();for(var Re=[];ph(F)&&Re.length<6;)Re.push(F),F=this.consumeCodePoint();var ce=parseInt(u.apply(void 0,Re),16);return{type:30,start:xe,end:ce}}else return{type:30,start:xe,end:xe}},L.prototype.consumeIdentLikeToken=function(){var D=this.consumeName();return D.toLowerCase()==="url"&&this.peekCodePoint(0)===zc?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===zc?(this.consumeCodePoint(),{type:19,value:D}):{type:20,value:D}},L.prototype.consumeUrlToken=function(){var D=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Go)return{type:22,value:""};var F=this.peekCodePoint(0);if(F===dl||F===Bl){var k=this.consumeStringToken(this.consumeCodePoint());return k.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Go||this.peekCodePoint(0)===dh)?(this.consumeCodePoint(),{type:22,value:k.value}):(this.consumeBadUrlRemnants(),Vs)}for(;;){var re=this.consumeCodePoint();if(re===Go||re===dh)return{type:22,value:u.apply(void 0,D)};if(Cn(re))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Go||this.peekCodePoint(0)===dh?(this.consumeCodePoint(),{type:22,value:u.apply(void 0,D)}):(this.consumeBadUrlRemnants(),Vs);if(re===Bl||re===dl||re===zc||V(re))return this.consumeBadUrlRemnants(),Vs;if(re===Bu)if(ee(re,this.peekCodePoint(0)))D.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Vs;else D.push(re)}},L.prototype.consumeWhiteSpace=function(){for(;Cn(this.peekCodePoint(0));)this.consumeCodePoint()},L.prototype.consumeBadUrlRemnants=function(){for(;;){var D=this.consumeCodePoint();if(D===dh||D===Go)return;ee(D,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},L.prototype.consumeStringSlice=function(D){for(var F=5e4,k="";D>0;){var re=Math.min(F,D);k+=u.apply(void 0,this._value.splice(0,re)),D-=re}return this._value.shift(),k},L.prototype.consumeStringToken=function(D){var F="",k=0;do{var re=this._value[k];if(re===Go||re===void 0||re===D)return F+=this.consumeStringSlice(k),{type:0,value:F};if(re===yc)return this._value.splice(0,k),Ha;if(re===Bu){var ce=this._value[k+1];ce!==Go&&ce!==void 0&&(ce===yc?(F+=this.consumeStringSlice(k),k=-1,this._value.shift()):ee(re,ce)&&(F+=this.consumeStringSlice(k),F+=u(this.consumeEscapedCodePoint()),k=-1))}k++}while(!0)},L.prototype.consumeNumber=function(){var D=[],F=Iu,k=this.peekCodePoint(0);for((k===eo||k===za)&&D.push(this.consumeCodePoint());Pa(this.peekCodePoint(0));)D.push(this.consumeCodePoint());k=this.peekCodePoint(0);var re=this.peekCodePoint(1);if(k===bc&&Pa(re))for(D.push(this.consumeCodePoint(),this.consumeCodePoint()),F=oA;Pa(this.peekCodePoint(0));)D.push(this.consumeCodePoint());k=this.peekCodePoint(0),re=this.peekCodePoint(1);var ce=this.peekCodePoint(2);if((k===pl||k===fl)&&((re===eo||re===za)&&Pa(ce)||Pa(re)))for(D.push(this.consumeCodePoint(),this.consumeCodePoint()),F=oA;Pa(this.peekCodePoint(0));)D.push(this.consumeCodePoint());return[de(D),F]},L.prototype.consumeNumericToken=function(){var D=this.consumeNumber(),F=D[0],k=D[1],re=this.peekCodePoint(0),ce=this.peekCodePoint(1),xe=this.peekCodePoint(2);if(ie(re,ce,xe)){var Re=this.consumeName();return{type:15,number:F,flags:k,unit:Re}}return re===xn?(this.consumeCodePoint(),{type:16,number:F,flags:k}):{type:17,number:F,flags:k}},L.prototype.consumeEscapedCodePoint=function(){var D=this.consumeCodePoint();if(ph(D)){for(var F=u(D);ph(this.peekCodePoint(0))&&F.length<6;)F+=u(this.consumeCodePoint());Cn(this.peekCodePoint(0))&&this.consumeCodePoint();var k=parseInt(F,16);return k===0||gf(k)||k>1114111?hA:k}return D===Go?hA:D},L.prototype.consumeName=function(){for(var D="";;){var F=this.consumeCodePoint();if(S(F))D+=u(F);else if(ee(F,this.peekCodePoint(0)))D+=u(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(F),D}},L})(),Ui=(function(){function L(D){this._tokens=D}return L.create=function(D){var F=new ei;return F.write(D),new L(F.read())},L.parseValue=function(D){return L.create(D).parseComponentValue()},L.parseValues=function(D){return L.create(D).parseComponentValues()},L.prototype.parseComponentValue=function(){for(var D=this.consumeToken();D.type===31;)D=this.consumeToken();if(D.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(D);var F=this.consumeComponentValue();do D=this.consumeToken();while(D.type===31);if(D.type===32)return F;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},L.prototype.parseComponentValues=function(){for(var D=[];;){var F=this.consumeComponentValue();if(F.type===32)return D;D.push(F),D.push()}},L.prototype.consumeComponentValue=function(){var D=this.consumeToken();switch(D.type){case 11:case 28:case 2:return this.consumeSimpleBlock(D.type);case 19:return this.consumeFunction(D)}return D},L.prototype.consumeSimpleBlock=function(D){for(var F={type:D,values:[]},k=this.consumeToken();;){if(k.type===32||qc(k,D))return F;this.reconsumeToken(k),F.values.push(this.consumeComponentValue()),k=this.consumeToken()}},L.prototype.consumeFunction=function(D){for(var F={name:D.value,values:[],type:18};;){var k=this.consumeToken();if(k.type===32||k.type===3)return F;this.reconsumeToken(k),F.values.push(this.consumeComponentValue())}},L.prototype.consumeToken=function(){var D=this._tokens.shift();return typeof D>"u"?Nr:D},L.prototype.reconsumeToken=function(D){this._tokens.unshift(D)},L})(),Si=function(L){return L.type===15},Vi=function(L){return L.type===17},gi=function(L){return L.type===20},$n=function(L){return L.type===0},La=function(L,D){return gi(L)&&L.value===D},Ea=function(L){return L.type!==31},cs=function(L){return L.type!==31&&L.type!==4},po=function(L){var D=[],F=[];return L.forEach(function(k){if(k.type===4){if(F.length===0)throw new Error("Error parsing function args, zero tokens for arg");D.push(F),F=[];return}k.type!==31&&F.push(k)}),F.length&&D.push(F),D},qc=function(L,D){return D===11&&L.type===12||D===28&&L.type===29?!0:D===2&&L.type===3},Ll=function(L){return L.type===17||L.type===15},Ni=function(L){return L.type===16||Ll(L)},Bd=function(L){return L.length>1?[L[0],L[1]]:[L[0]]},us={type:17,number:0,flags:Iu},Wc={type:16,number:50,flags:Iu},Nu={type:16,number:100,flags:Iu},Dd=function(L,D,F){var k=L[0],re=L[1];return[ns(k,D),ns(typeof re<"u"?re:k,F)]},ns=function(L,D){if(L.type===16)return L.number/100*D;if(Si(L))switch(L.unit){case"rem":case"em":return 16*L.number;case"px":default:return L.number}return L.number},to="deg",_d="grad",xc="rad",pA="turn",Ru={name:"angle",parse:function(L,D){if(D.type===15)switch(D.unit){case to:return Math.PI*D.number/180;case _d:return Math.PI/200*D.number;case xc:return D.number;case pA:return Math.PI*2*D.number}throw new Error("Unsupported angle type")}},Yo=function(L){return L.type===15&&(L.unit===to||L.unit===_d||L.unit===xc||L.unit===pA)},yf=function(L){var D=L.filter(gi).map(function(F){return F.value}).join(" ");switch(D){case"to bottom right":case"to right bottom":case"left top":case"top left":return[us,us];case"to top":case"bottom":return Vo(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[us,Nu];case"to right":case"left":return Vo(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Nu,Nu];case"to bottom":case"top":return Vo(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Nu,us];case"to left":case"right":return Vo(270)}return 0},Vo=function(L){return Math.PI*L/180},mh={name:"color",parse:function(L,D){if(D.type===18){var F=Ke[D.name];if(typeof F>"u")throw new Error('Attempting to parse an unsupported color function "'+D.name+'"');return F(L,D.values)}if(D.type===5){if(D.value.length===3){var k=D.value.substring(0,1),re=D.value.substring(1,2),ce=D.value.substring(2,3);return Mu(parseInt(k+k,16),parseInt(re+re,16),parseInt(ce+ce,16),1)}if(D.value.length===4){var k=D.value.substring(0,1),re=D.value.substring(1,2),ce=D.value.substring(2,3),xe=D.value.substring(3,4);return Mu(parseInt(k+k,16),parseInt(re+re,16),parseInt(ce+ce,16),parseInt(xe+xe,16)/255)}if(D.value.length===6){var k=D.value.substring(0,2),re=D.value.substring(2,4),ce=D.value.substring(4,6);return Mu(parseInt(k,16),parseInt(re,16),parseInt(ce,16),1)}if(D.value.length===8){var k=D.value.substring(0,2),re=D.value.substring(2,4),ce=D.value.substring(4,6),xe=D.value.substring(6,8);return Mu(parseInt(k,16),parseInt(re,16),parseInt(ce,16),parseInt(xe,16)/255)}}if(D.type===20){var Re=Tt[D.value.toUpperCase()];if(typeof Re<"u")return Re}return Tt.TRANSPARENT}},ro=function(L){return(255&L)===0},Oa=function(L){var D=255&L,F=255&L>>8,k=255&L>>16,re=255&L>>24;return D<255?"rgba("+re+","+k+","+F+","+D/255+")":"rgb("+re+","+k+","+F+")"},Mu=function(L,D,F,k){return(L<<24|D<<16|F<<8|Math.round(k*255)<<0)>>>0},t0=function(L,D){if(L.type===17)return L.number;if(L.type===16){var F=D===3?1:255;return D===3?L.number/100*F:Math.round(L.number/100*F)}return 0},gh=function(L,D){var F=D.filter(cs);if(F.length===3){var k=F.map(t0),re=k[0],ce=k[1],xe=k[2];return Mu(re,ce,xe,1)}if(F.length===4){var Re=F.map(t0),re=Re[0],ce=Re[1],xe=Re[2],Ne=Re[3];return Mu(re,ce,xe,Ne)}return 0};function rc(L,D,F){return F<0&&(F+=1),F>=1&&(F-=1),F<1/6?(D-L)*F*6+L:F<1/2?D:F<2/3?(D-L)*6*(2/3-F)+L:L}var Me=function(L,D){var F=D.filter(cs),k=F[0],re=F[1],ce=F[2],xe=F[3],Re=(k.type===17?Vo(k.number):Ru.parse(L,k))/(Math.PI*2),Ne=Ni(re)?re.number/100:0,tt=Ni(ce)?ce.number/100:0,lt=typeof xe<"u"&&Ni(xe)?ns(xe,1):1;if(Ne===0)return Mu(tt*255,tt*255,tt*255,1);var St=tt<=.5?tt*(Ne+1):tt+Ne-tt*Ne,Ht=tt*2-St,Wr=rc(Ht,St,Re+1/3),Er=rc(Ht,St,Re),kr=rc(Ht,St,Re-1/3);return Mu(Wr*255,Er*255,kr*255,lt)},Ke={hsl:Me,hsla:Me,rgb:gh,rgba:gh},mt=function(L,D){return mh.parse(L,Ui.create(D).parseComponentValue())},Tt={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Ut={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(L,D){return D.map(function(F){if(gi(F))switch(F.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},fr={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Br=function(L,D){var F=mh.parse(L,D[0]),k=D[1];return k&&Ni(k)?{color:F,stop:k}:{color:F,stop:null}},Zr=function(L,D){var F=L[0],k=L[L.length-1];F.stop===null&&(F.stop=us),k.stop===null&&(k.stop=Nu);for(var re=[],ce=0,xe=0;xe<L.length;xe++){var Re=L[xe].stop;if(Re!==null){var Ne=ns(Re,D);Ne>ce?re.push(Ne):re.push(ce),ce=Ne}else re.push(null)}for(var tt=null,xe=0;xe<re.length;xe++){var lt=re[xe];if(lt===null)tt===null&&(tt=xe);else if(tt!==null){for(var St=xe-tt,Ht=re[tt-1],Wr=(lt-Ht)/(St+1),Er=1;Er<=St;Er++)re[tt+Er-1]=Wr*Er;tt=null}}return L.map(function(kr,Sn){var yi=kr.color;return{color:yi,stop:Math.max(Math.min(1,re[Sn]/D),0)}})},Pr=function(L,D,F){var k=D/2,re=F/2,ce=ns(L[0],D)-k,xe=re-ns(L[1],F);return(Math.atan2(xe,ce)+Math.PI*2)%(Math.PI*2)},Gi=function(L,D,F){var k=typeof L=="number"?L:Pr(L,D,F),re=Math.abs(D*Math.sin(k))+Math.abs(F*Math.cos(k)),ce=D/2,xe=F/2,Re=re/2,Ne=Math.sin(k-Math.PI/2)*Re,tt=Math.cos(k-Math.PI/2)*Re;return[re,ce-tt,ce+tt,xe-Ne,xe+Ne]},qr=function(L,D){return Math.sqrt(L*L+D*D)},Di=function(L,D,F,k,re){var ce=[[0,0],[0,D],[L,0],[L,D]];return ce.reduce(function(xe,Re){var Ne=Re[0],tt=Re[1],lt=qr(F-Ne,k-tt);return(re?lt<xe.optimumDistance:lt>xe.optimumDistance)?{optimumCorner:Re,optimumDistance:lt}:xe},{optimumDistance:re?1/0:-1/0,optimumCorner:null}).optimumCorner},an=function(L,D,F,k,re){var ce=0,xe=0;switch(L.size){case 0:L.shape===0?ce=xe=Math.min(Math.abs(D),Math.abs(D-k),Math.abs(F),Math.abs(F-re)):L.shape===1&&(ce=Math.min(Math.abs(D),Math.abs(D-k)),xe=Math.min(Math.abs(F),Math.abs(F-re)));break;case 2:if(L.shape===0)ce=xe=Math.min(qr(D,F),qr(D,F-re),qr(D-k,F),qr(D-k,F-re));else if(L.shape===1){var Re=Math.min(Math.abs(F),Math.abs(F-re))/Math.min(Math.abs(D),Math.abs(D-k)),Ne=Di(k,re,D,F,!0),tt=Ne[0],lt=Ne[1];ce=qr(tt-D,(lt-F)/Re),xe=Re*ce}break;case 1:L.shape===0?ce=xe=Math.max(Math.abs(D),Math.abs(D-k),Math.abs(F),Math.abs(F-re)):L.shape===1&&(ce=Math.max(Math.abs(D),Math.abs(D-k)),xe=Math.max(Math.abs(F),Math.abs(F-re)));break;case 3:if(L.shape===0)ce=xe=Math.max(qr(D,F),qr(D,F-re),qr(D-k,F),qr(D-k,F-re));else if(L.shape===1){var Re=Math.max(Math.abs(F),Math.abs(F-re))/Math.max(Math.abs(D),Math.abs(D-k)),St=Di(k,re,D,F,!1),tt=St[0],lt=St[1];ce=qr(tt-D,(lt-F)/Re),xe=Re*ce}break}return Array.isArray(L.size)&&(ce=ns(L.size[0],k),xe=L.size.length===2?ns(L.size[1],re):ce),[ce,xe]},mi=function(L,D){var F=Vo(180),k=[];return po(D).forEach(function(re,ce){if(ce===0){var xe=re[0];if(xe.type===20&&xe.value==="to"){F=yf(re);return}else if(Yo(xe)){F=Ru.parse(L,xe);return}}var Re=Br(L,re);k.push(Re)}),{angle:F,stops:k,type:1}},Pn=function(L,D){var F=Vo(180),k=[];return po(D).forEach(function(re,ce){if(ce===0){var xe=re[0];if(xe.type===20&&["top","left","right","bottom"].indexOf(xe.value)!==-1){F=yf(re);return}else if(Yo(xe)){F=(Ru.parse(L,xe)+Vo(270))%Vo(360);return}}var Re=Br(L,re);k.push(Re)}),{angle:F,stops:k,type:1}},jo=function(L,D){var F=Vo(180),k=[],re=1,ce=0,xe=3,Re=[];return po(D).forEach(function(Ne,tt){var lt=Ne[0];if(tt===0){if(gi(lt)&&lt.value==="linear"){re=1;return}else if(gi(lt)&&lt.value==="radial"){re=2;return}}if(lt.type===18){if(lt.name==="from"){var St=mh.parse(L,lt.values[0]);k.push({stop:us,color:St})}else if(lt.name==="to"){var St=mh.parse(L,lt.values[0]);k.push({stop:Nu,color:St})}else if(lt.name==="color-stop"){var Ht=lt.values.filter(cs);if(Ht.length===2){var St=mh.parse(L,Ht[1]),Wr=Ht[0];Vi(Wr)&&k.push({stop:{type:16,number:Wr.number*100,flags:Wr.flags},color:St})}}}}),re===1?{angle:(F+Vo(180))%Vo(360),stops:k,type:re}:{size:xe,shape:ce,stops:k,position:Re,type:re}},ks="closest-side",io="farthest-side",Ln="closest-corner",ss="farthest-corner",On="circle",Qo="ellipse",mA="cover",bf="contain",r0=function(L,D){var F=0,k=3,re=[],ce=[];return po(D).forEach(function(xe,Re){var Ne=!0;if(Re===0){var tt=!1;Ne=xe.reduce(function(St,Ht){if(tt)if(gi(Ht))switch(Ht.value){case"center":return ce.push(Wc),St;case"top":case"left":return ce.push(us),St;case"right":case"bottom":return ce.push(Nu),St}else(Ni(Ht)||Ll(Ht))&&ce.push(Ht);else if(gi(Ht))switch(Ht.value){case On:return F=0,!1;case Qo:return F=1,!1;case"at":return tt=!0,!1;case ks:return k=0,!1;case mA:case io:return k=1,!1;case bf:case Ln:return k=2,!1;case ss:return k=3,!1}else if(Ll(Ht)||Ni(Ht))return Array.isArray(k)||(k=[]),k.push(Ht),!1;return St},Ne)}if(Ne){var lt=Br(L,xe);re.push(lt)}}),{size:k,shape:F,stops:re,position:ce,type:2}},_m=function(L,D){var F=0,k=3,re=[],ce=[];return po(D).forEach(function(xe,Re){var Ne=!0;if(Re===0?Ne=xe.reduce(function(lt,St){if(gi(St))switch(St.value){case"center":return ce.push(Wc),!1;case"top":case"left":return ce.push(us),!1;case"right":case"bottom":return ce.push(Nu),!1}else if(Ni(St)||Ll(St))return ce.push(St),!1;return lt},Ne):Re===1&&(Ne=xe.reduce(function(lt,St){if(gi(St))switch(St.value){case On:return F=0,!1;case Qo:return F=1,!1;case bf:case ks:return k=0,!1;case io:return k=1,!1;case Ln:return k=2,!1;case mA:case ss:return k=3,!1}else if(Ll(St)||Ni(St))return Array.isArray(k)||(k=[]),k.push(St),!1;return lt},Ne)),Ne){var tt=Br(L,xe);re.push(tt)}}),{size:k,shape:F,stops:re,position:ce,type:2}},cI=function(L){return L.type===1},uI=function(L){return L.type===2},Qb={name:"image",parse:function(L,D){if(D.type===22){var F={url:D.value,type:0};return L.cache.addImage(D.value),F}if(D.type===18){var k=Iw[D.name];if(typeof k>"u")throw new Error('Attempting to parse an unsupported image function "'+D.name+'"');return k(L,D.values)}throw new Error("Unsupported image type "+D.type)}};function hI(L){return!(L.type===20&&L.value==="none")&&(L.type!==18||!!Iw[L.name])}var Iw={"linear-gradient":mi,"-moz-linear-gradient":Pn,"-ms-linear-gradient":Pn,"-o-linear-gradient":Pn,"-webkit-linear-gradient":Pn,"radial-gradient":r0,"-moz-radial-gradient":_m,"-ms-radial-gradient":_m,"-o-radial-gradient":_m,"-webkit-radial-gradient":_m,"-webkit-gradient":jo},dI={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(L,D){if(D.length===0)return[];var F=D[0];return F.type===20&&F.value==="none"?[]:D.filter(function(k){return cs(k)&&hI(k)}).map(function(k){return Qb.parse(L,k)})}},Bw={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(L,D){return D.map(function(F){if(gi(F))switch(F.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},zb={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(L,D){return po(D).map(function(F){return F.filter(Ni)}).map(Bd)}},yh={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(L,D){return po(D).map(function(F){return F.filter(gi).map(function(k){return k.value}).join(" ")}).map(kh)}},kh=function(L){switch(L){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},xf;(function(L){L.AUTO="auto",L.CONTAIN="contain",L.COVER="cover"})(xf||(xf={}));var Xb={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(L,D){return po(D).map(function(F){return F.filter(AI)})}},AI=function(L){return gi(L)||Ni(L)},Pm=function(L){return{name:"border-"+L+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},qb=Pm("top"),Dw=Pm("right"),fI=Pm("bottom"),_w=Pm("left"),i0=function(L){return{name:"border-radius-"+L,initialValue:"0 0",prefix:!1,type:1,parse:function(D,F){return Bd(F.filter(Ni))}}},Wb=i0("top-left"),Pw=i0("top-right"),j3=i0("bottom-right"),Q3=i0("bottom-left"),Vy=function(L){return{name:"border-"+L+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(D,F){switch(F){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},z3=Vy("top"),X3=Vy("right"),q3=Vy("bottom"),W3=Vy("left"),Kb=function(L){return{name:"border-"+L+"-width",initialValue:"0",type:0,prefix:!1,parse:function(D,F){return Si(F)?F.number:0}}},Lw=Kb("top"),Ow=Kb("right"),jy=Kb("bottom"),K3=Kb("left"),J3={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},pI={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(L,D){switch(D){case"rtl":return 1;case"ltr":default:return 0}}},$3={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(L,D){return D.filter(gi).reduce(function(F,k){return F|Z3(k.value)},0)}},Z3=function(L){switch(L){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},eN={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(L,D){switch(D){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},tN={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(L,D){return D.type===20&&D.value==="normal"?0:D.type===17||D.type===15?D.number:0}},Pd;(function(L){L.NORMAL="normal",L.STRICT="strict"})(Pd||(Pd={}));var Ld={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(L,D){switch(D){case"strict":return Pd.STRICT;case"normal":default:return Pd.NORMAL}}},Ef={name:"line-height",initialValue:"normal",prefix:!1,type:4},mI=function(L,D){return gi(L)&&L.value==="normal"?1.2*D:L.type===17?D*L.number:Ni(L)?ns(L,D):D},gI={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(L,D){return D.type===20&&D.value==="none"?null:Qb.parse(L,D)}},Sp={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(L,D){switch(D){case"inside":return 0;case"outside":default:return 1}}},ku={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(L,D){switch(D){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Jb=function(L){return{name:"margin-"+L,initialValue:"0",prefix:!1,type:4}},rN=Jb("top"),yI=Jb("right"),bI=Jb("bottom"),xI=Jb("left"),EI={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(L,D){return D.filter(gi).map(function(F){switch(F.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},iN={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(L,D){switch(D){case"break-word":return"break-word";case"normal":default:return"normal"}}},Lm=function(L){return{name:"padding-"+L,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},$b=Lm("top"),Qy=Lm("right"),Nw=Lm("bottom"),wI=Lm("left"),nN={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(L,D){switch(D){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},vI={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(L,D){switch(D){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},sN={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(L,D){return D.length===1&&La(D[0],"none")?[]:po(D).map(function(F){for(var k={color:Tt.TRANSPARENT,offsetX:us,offsetY:us,blur:us},re=0,ce=0;ce<F.length;ce++){var xe=F[ce];Ll(xe)?(re===0?k.offsetX=xe:re===1?k.offsetY=xe:k.blur=xe,re++):k.color=mh.parse(L,xe)}return k})}},aN={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(L,D){switch(D){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},oN={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(L,D){if(D.type===20&&D.value==="none")return null;if(D.type===18){var F=uN[D.name];if(typeof F>"u")throw new Error('Attempting to parse an unsupported transform function "'+D.name+'"');return F(D.values)}return null}},lN=function(L){var D=L.filter(function(F){return F.type===17}).map(function(F){return F.number});return D.length===6?D:null},cN=function(L){var D=L.filter(function(Ne){return Ne.type===17}).map(function(Ne){return Ne.number}),F=D[0],k=D[1];D[2],D[3];var re=D[4],ce=D[5];D[6],D[7],D[8],D[9],D[10],D[11];var xe=D[12],Re=D[13];return D[14],D[15],D.length===16?[F,k,re,ce,xe,Re]:null},uN={matrix:lN,matrix3d:cN},Rw={type:16,number:50,flags:Iu},Zb=[Rw,Rw],hN={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(L,D){var F=D.filter(Ni);return F.length!==2?Zb:[F[0],F[1]]}},dN={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(L,D){switch(D){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},n0;(function(L){L.NORMAL="normal",L.BREAK_ALL="break-all",L.KEEP_ALL="keep-all"})(n0||(n0={}));for(var T={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(L,D){switch(D){case"break-all":return n0.BREAK_ALL;case"keep-all":return n0.KEEP_ALL;case"normal":default:return n0.NORMAL}}},Y={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(L,D){if(D.type===20)return{auto:!0,order:0};if(Vi(D))return{auto:!1,order:D.number};throw new Error("Invalid z-index number parsed")}},Z={name:"time",parse:function(L,D){if(D.type===15)switch(D.unit.toLowerCase()){case"s":return 1e3*D.number;case"ms":return D.number}throw new Error("Unsupported time type")}},le={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(L,D){return Vi(D)?D.number:1}},pe={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},be={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(L,D){return D.filter(gi).map(function(F){switch(F.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(F){return F!==0})}},we={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(L,D){var F=[],k=[];return D.forEach(function(re){switch(re.type){case 20:case 0:F.push(re.value);break;case 17:F.push(re.number.toString());break;case 4:k.push(F.join(" ")),F.length=0;break}}),F.length&&k.push(F.join(" ")),k.map(function(re){return re.indexOf(" ")===-1?re:"'"+re+"'"})}},Se={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},Te={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(L,D){if(Vi(D))return D.number;if(gi(D))switch(D.value){case"bold":return 700;case"normal":default:return 400}return 400}},ke={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(L,D){return D.filter(gi).map(function(F){return F.value})}},Ze={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(L,D){switch(D){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},At=function(L,D){return(L&D)!==0},It={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(L,D){if(D.length===0)return[];var F=D[0];return F.type===20&&F.value==="none"?[]:D}},dt={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(L,D){if(D.length===0)return null;var F=D[0];if(F.type===20&&F.value==="none")return null;for(var k=[],re=D.filter(Ea),ce=0;ce<re.length;ce++){var xe=re[ce],Re=re[ce+1];if(xe.type===20){var Ne=Re&&Vi(Re)?Re.number:1;k.push({counter:xe.value,increment:Ne})}}return k}},Wt={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(L,D){if(D.length===0)return[];for(var F=[],k=D.filter(Ea),re=0;re<k.length;re++){var ce=k[re],xe=k[re+1];if(gi(ce)&&ce.value!=="none"){var Re=xe&&Vi(xe)?xe.number:0;F.push({counter:ce.value,reset:Re})}}return F}},Mt={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(L,D){return D.filter(Si).map(function(F){return Z.parse(L,F)})}},et={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(L,D){if(D.length===0)return null;var F=D[0];if(F.type===20&&F.value==="none")return null;var k=[],re=D.filter($n);if(re.length%2!==0)return null;for(var ce=0;ce<re.length;ce+=2){var xe=re[ce].value,Re=re[ce+1].value;k.push({open:xe,close:Re})}return k}},ot=function(L,D,F){if(!L)return"";var k=L[Math.min(D,L.length-1)];return k?F?k.open:k.close:""},Xt={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(L,D){return D.length===1&&La(D[0],"none")?[]:po(D).map(function(F){for(var k={color:255,offsetX:us,offsetY:us,blur:us,spread:us,inset:!1},re=0,ce=0;ce<F.length;ce++){var xe=F[ce];La(xe,"inset")?k.inset=!0:Ll(xe)?(re===0?k.offsetX=xe:re===1?k.offsetY=xe:re===2?k.blur=xe:k.spread=xe,re++):k.color=mh.parse(L,xe)}return k})}},rr={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(L,D){var F=[0,1,2],k=[];return D.filter(gi).forEach(function(re){switch(re.value){case"stroke":k.push(1);break;case"fill":k.push(0);break;case"markers":k.push(2);break}}),F.forEach(function(re){k.indexOf(re)===-1&&k.push(re)}),k}},qt={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},Gr={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(L,D){return Si(D)?D.number:0}},Or=(function(){function L(D,F){var k,re;this.animationDuration=dr(D,Mt,F.animationDuration),this.backgroundClip=dr(D,Ut,F.backgroundClip),this.backgroundColor=dr(D,fr,F.backgroundColor),this.backgroundImage=dr(D,dI,F.backgroundImage),this.backgroundOrigin=dr(D,Bw,F.backgroundOrigin),this.backgroundPosition=dr(D,zb,F.backgroundPosition),this.backgroundRepeat=dr(D,yh,F.backgroundRepeat),this.backgroundSize=dr(D,Xb,F.backgroundSize),this.borderTopColor=dr(D,qb,F.borderTopColor),this.borderRightColor=dr(D,Dw,F.borderRightColor),this.borderBottomColor=dr(D,fI,F.borderBottomColor),this.borderLeftColor=dr(D,_w,F.borderLeftColor),this.borderTopLeftRadius=dr(D,Wb,F.borderTopLeftRadius),this.borderTopRightRadius=dr(D,Pw,F.borderTopRightRadius),this.borderBottomRightRadius=dr(D,j3,F.borderBottomRightRadius),this.borderBottomLeftRadius=dr(D,Q3,F.borderBottomLeftRadius),this.borderTopStyle=dr(D,z3,F.borderTopStyle),this.borderRightStyle=dr(D,X3,F.borderRightStyle),this.borderBottomStyle=dr(D,q3,F.borderBottomStyle),this.borderLeftStyle=dr(D,W3,F.borderLeftStyle),this.borderTopWidth=dr(D,Lw,F.borderTopWidth),this.borderRightWidth=dr(D,Ow,F.borderRightWidth),this.borderBottomWidth=dr(D,jy,F.borderBottomWidth),this.borderLeftWidth=dr(D,K3,F.borderLeftWidth),this.boxShadow=dr(D,Xt,F.boxShadow),this.color=dr(D,J3,F.color),this.direction=dr(D,pI,F.direction),this.display=dr(D,$3,F.display),this.float=dr(D,eN,F.cssFloat),this.fontFamily=dr(D,we,F.fontFamily),this.fontSize=dr(D,Se,F.fontSize),this.fontStyle=dr(D,Ze,F.fontStyle),this.fontVariant=dr(D,ke,F.fontVariant),this.fontWeight=dr(D,Te,F.fontWeight),this.letterSpacing=dr(D,tN,F.letterSpacing),this.lineBreak=dr(D,Ld,F.lineBreak),this.lineHeight=dr(D,Ef,F.lineHeight),this.listStyleImage=dr(D,gI,F.listStyleImage),this.listStylePosition=dr(D,Sp,F.listStylePosition),this.listStyleType=dr(D,ku,F.listStyleType),this.marginTop=dr(D,rN,F.marginTop),this.marginRight=dr(D,yI,F.marginRight),this.marginBottom=dr(D,bI,F.marginBottom),this.marginLeft=dr(D,xI,F.marginLeft),this.opacity=dr(D,le,F.opacity);var ce=dr(D,EI,F.overflow);this.overflowX=ce[0],this.overflowY=ce[ce.length>1?1:0],this.overflowWrap=dr(D,iN,F.overflowWrap),this.paddingTop=dr(D,$b,F.paddingTop),this.paddingRight=dr(D,Qy,F.paddingRight),this.paddingBottom=dr(D,Nw,F.paddingBottom),this.paddingLeft=dr(D,wI,F.paddingLeft),this.paintOrder=dr(D,rr,F.paintOrder),this.position=dr(D,vI,F.position),this.textAlign=dr(D,nN,F.textAlign),this.textDecorationColor=dr(D,pe,(k=F.textDecorationColor)!==null&&k!==void 0?k:F.color),this.textDecorationLine=dr(D,be,(re=F.textDecorationLine)!==null&&re!==void 0?re:F.textDecoration),this.textShadow=dr(D,sN,F.textShadow),this.textTransform=dr(D,aN,F.textTransform),this.transform=dr(D,oN,F.transform),this.transformOrigin=dr(D,hN,F.transformOrigin),this.visibility=dr(D,dN,F.visibility),this.webkitTextStrokeColor=dr(D,qt,F.webkitTextStrokeColor),this.webkitTextStrokeWidth=dr(D,Gr,F.webkitTextStrokeWidth),this.wordBreak=dr(D,T,F.wordBreak),this.zIndex=dr(D,Y,F.zIndex)}return L.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},L.prototype.isTransparent=function(){return ro(this.backgroundColor)},L.prototype.isTransformed=function(){return this.transform!==null},L.prototype.isPositioned=function(){return this.position!==0},L.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},L.prototype.isFloating=function(){return this.float!==0},L.prototype.isInlineLevel=function(){return At(this.display,4)||At(this.display,33554432)||At(this.display,268435456)||At(this.display,536870912)||At(this.display,67108864)||At(this.display,134217728)},L})(),Mi=(function(){function L(D,F){this.content=dr(D,It,F.content),this.quotes=dr(D,et,F.quotes)}return L})(),Rr=(function(){function L(D,F){this.counterIncrement=dr(D,dt,F.counterIncrement),this.counterReset=dr(D,Wt,F.counterReset)}return L})(),dr=function(L,D,F){var k=new ei,re=F!==null&&typeof F<"u"?F.toString():D.initialValue;k.write(re);var ce=new Ui(k.read());switch(D.type){case 2:var xe=ce.parseComponentValue();return D.parse(L,gi(xe)?xe.value:D.initialValue);case 0:return D.parse(L,ce.parseComponentValue());case 1:return D.parse(L,ce.parseComponentValues());case 4:return ce.parseComponentValue();case 3:switch(D.format){case"angle":return Ru.parse(L,ce.parseComponentValue());case"color":return mh.parse(L,ce.parseComponentValue());case"image":return Qb.parse(L,ce.parseComponentValue());case"length":var Re=ce.parseComponentValue();return Ll(Re)?Re:us;case"length-percentage":var Ne=ce.parseComponentValue();return Ni(Ne)?Ne:us;case"time":return Z.parse(L,ce.parseComponentValue())}break}},js="data-html2canvas-debug",hs=function(L){var D=L.getAttribute(js);switch(D){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Nn=function(L,D){var F=hs(L);return F===1||D===F},jn=(function(){function L(D,F){if(this.context=D,this.textNodes=[],this.elements=[],this.flags=0,Nn(F,3))debugger;this.styles=new Or(D,window.getComputedStyle(F,null)),yN(F)&&(this.styles.animationDuration.some(function(k){return k>0})&&(F.style.animationDuration="0s"),this.styles.transform!==null&&(F.style.transform="none")),this.bounds=o(this.context,F),Nn(F,4)&&(this.flags|=16)}return L})(),Aa="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",hn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wa=typeof Uint8Array>"u"?[]:new Uint8Array(256),ic=0;ic<hn.length;ic++)Wa[hn.charCodeAt(ic)]=ic;for(var zo=function(L){var D=L.length*.75,F=L.length,k,re=0,ce,xe,Re,Ne;L[L.length-1]==="="&&(D--,L[L.length-2]==="="&&D--);var tt=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(D):new Array(D),lt=Array.isArray(tt)?tt:new Uint8Array(tt);for(k=0;k<F;k+=4)ce=Wa[L.charCodeAt(k)],xe=Wa[L.charCodeAt(k+1)],Re=Wa[L.charCodeAt(k+2)],Ne=Wa[L.charCodeAt(k+3)],lt[re++]=ce<<2|xe>>4,lt[re++]=(xe&15)<<4|Re>>2,lt[re++]=(Re&3)<<6|Ne&63;return tt},Fu=function(L){for(var D=L.length,F=[],k=0;k<D;k+=2)F.push(L[k+1]<<8|L[k]);return F},Qs=function(L){for(var D=L.length,F=[],k=0;k<D;k+=4)F.push(L[k+3]<<24|L[k+2]<<16|L[k+1]<<8|L[k]);return F},ml=5,Kc=11,Xo=2,nc=Kc-ml,Ec=65536>>ml,Fh=1<<ml,Uh=Fh-1,Ol=1024>>ml,wf=Ec+Ol,Om=wf,s0=32,Tp=Om+s0,mo=65536>>Kc,Mw=1<<nc,CI=Mw-1,kw=function(L,D,F){return L.slice?L.slice(D,F):new Uint16Array(Array.prototype.slice.call(L,D,F))},ex=function(L,D,F){return L.slice?L.slice(D,F):new Uint32Array(Array.prototype.slice.call(L,D,F))},zy=function(L,D){var F=zo(L),k=Array.isArray(F)?Qs(F):new Uint32Array(F),re=Array.isArray(F)?Fu(F):new Uint16Array(F),ce=24,xe=kw(re,ce/2,k[4]/2),Re=k[5]===2?kw(re,(ce+k[4])/2):ex(k,Math.ceil((ce+k[4])/4));return new tx(k[0],k[1],k[2],k[3],xe,Re)},tx=(function(){function L(D,F,k,re,ce,xe){this.initialValue=D,this.errorValue=F,this.highStart=k,this.highValueIndex=re,this.index=ce,this.data=xe}return L.prototype.get=function(D){var F;if(D>=0){if(D<55296||D>56319&&D<=65535)return F=this.index[D>>ml],F=(F<<Xo)+(D&Uh),this.data[F];if(D<=65535)return F=this.index[Ec+(D-55296>>ml)],F=(F<<Xo)+(D&Uh),this.data[F];if(D<this.highStart)return F=Tp-mo+(D>>Kc),F=this.index[F],F+=D>>ml&CI,F=this.index[F],F=(F<<Xo)+(D&Uh),this.data[F];if(D<=1114111)return this.data[this.highValueIndex]}return this.errorValue},L})(),Hh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a0=typeof Uint8Array>"u"?[]:new Uint8Array(256),vf=0;vf<Hh.length;vf++)a0[Hh.charCodeAt(vf)]=vf;var SI=1,o0=2,rx=3,Xy=4,ix=5,nx=7,l0=8,Fw=9,Uw=10,sx=11,Cf=12,TI=13,II=14,Hw=15,BI=function(L){for(var D=[],F=0,k=L.length;F<k;){var re=L.charCodeAt(F++);if(re>=55296&&re<=56319&&F<k){var ce=L.charCodeAt(F++);(ce&64512)===56320?D.push(((re&1023)<<10)+(ce&1023)+65536):(D.push(re),F--)}else D.push(re)}return D},ax=function(){for(var L=[],D=0;D<arguments.length;D++)L[D]=arguments[D];if(String.fromCodePoint)return String.fromCodePoint.apply(String,L);var F=L.length;if(!F)return"";for(var k=[],re=-1,ce="";++re<F;){var xe=L[re];xe<=65535?k.push(xe):(xe-=65536,k.push((xe>>10)+55296,xe%1024+56320)),(re+1===F||k.length>16384)&&(ce+=String.fromCharCode.apply(String,k),k.length=0)}return ce},DI=zy(Aa),bh="\xD7",c0="\xF7",Gw=function(L){return DI.get(L)},qy=function(L,D,F){var k=F-2,re=D[k],ce=D[F-1],xe=D[F];if(ce===o0&&xe===rx)return bh;if(ce===o0||ce===rx||ce===Xy||xe===o0||xe===rx||xe===Xy)return c0;if(ce===l0&&[l0,Fw,sx,Cf].indexOf(xe)!==-1||(ce===sx||ce===Fw)&&(xe===Fw||xe===Uw)||(ce===Cf||ce===Uw)&&xe===Uw||xe===TI||xe===ix||xe===nx||ce===SI)return bh;if(ce===TI&&xe===II){for(;re===ix;)re=D[--k];if(re===II)return bh}if(ce===Hw&&xe===Hw){for(var Re=0;re===Hw;)Re++,re=D[--k];if(Re%2===0)return bh}return c0},_I=function(L){var D=BI(L),F=D.length,k=0,re=0,ce=D.map(Gw);return{next:function(){if(k>=F)return{done:!0,value:null};for(var xe=bh;k<F&&(xe=qy(D,ce,++k))===bh;);if(xe!==bh||k===F){var Re=ax.apply(null,D.slice(re,k));return re=k,{value:Re,done:!1}}return{done:!0,value:null}}}},AN=function(L){for(var D=_I(L),F=[],k;!(k=D.next()).done;)k.value&&F.push(k.value.slice());return F},ox=function(L){var D=123;if(L.createRange){var F=L.createRange();if(F.getBoundingClientRect){var k=L.createElement("boundtest");k.style.height=D+"px",k.style.display="block",L.body.appendChild(k),F.selectNode(k);var re=F.getBoundingClientRect(),ce=Math.round(re.height);if(L.body.removeChild(k),ce===D)return!0}}return!1},PI=function(L){var D=L.createElement("boundtest");D.style.width="50px",D.style.display="block",D.style.fontSize="12px",D.style.letterSpacing="0px",D.style.wordSpacing="0px",L.body.appendChild(D);var F=L.createRange();D.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var k=D.firstChild,re=c(k.data).map(function(Ne){return u(Ne)}),ce=0,xe={},Re=re.every(function(Ne,tt){F.setStart(k,ce),F.setEnd(k,ce+Ne.length);var lt=F.getBoundingClientRect();ce+=Ne.length;var St=lt.x>xe.x||lt.y>xe.y;return xe=lt,tt===0?!0:St});return L.body.removeChild(D),Re},Yw=function(){return typeof new Image().crossOrigin<"u"},Ip=function(){return typeof new XMLHttpRequest().responseType=="string"},LI=function(L){var D=new Image,F=L.createElement("canvas"),k=F.getContext("2d");if(!k)return!1;D.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{k.drawImage(D,0,0),F.toDataURL()}catch{return!1}return!0},Vw=function(L){return L[0]===0&&L[1]===255&&L[2]===0&&L[3]===255},fN=function(L){var D=L.createElement("canvas"),F=100;D.width=F,D.height=F;var k=D.getContext("2d");if(!k)return Promise.reject(!1);k.fillStyle="rgb(0, 255, 0)",k.fillRect(0,0,F,F);var re=new Image,ce=D.toDataURL();re.src=ce;var xe=lx(F,F,0,0,re);return k.fillStyle="red",k.fillRect(0,0,F,F),Nm(xe).then(function(Re){k.drawImage(Re,0,0);var Ne=k.getImageData(0,0,F,F).data;k.fillStyle="red",k.fillRect(0,0,F,F);var tt=L.createElement("div");return tt.style.backgroundImage="url("+ce+")",tt.style.height=F+"px",Vw(Ne)?Nm(lx(F,F,0,0,tt)):Promise.reject(!1)}).then(function(Re){return k.drawImage(Re,0,0),Vw(k.getImageData(0,0,F,F).data)}).catch(function(){return!1})},lx=function(L,D,F,k,re){var ce="http://www.w3.org/2000/svg",xe=document.createElementNS(ce,"svg"),Re=document.createElementNS(ce,"foreignObject");return xe.setAttributeNS(null,"width",L.toString()),xe.setAttributeNS(null,"height",D.toString()),Re.setAttributeNS(null,"width","100%"),Re.setAttributeNS(null,"height","100%"),Re.setAttributeNS(null,"x",F.toString()),Re.setAttributeNS(null,"y",k.toString()),Re.setAttributeNS(null,"externalResourcesRequired","true"),xe.appendChild(Re),Re.appendChild(re),xe},Nm=function(L){return new Promise(function(D,F){var k=new Image;k.onload=function(){return D(k)},k.onerror=F,k.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(L))})},sc={get SUPPORT_RANGE_BOUNDS(){var L=ox(document);return Object.defineProperty(sc,"SUPPORT_RANGE_BOUNDS",{value:L}),L},get SUPPORT_WORD_BREAKING(){var L=sc.SUPPORT_RANGE_BOUNDS&&PI(document);return Object.defineProperty(sc,"SUPPORT_WORD_BREAKING",{value:L}),L},get SUPPORT_SVG_DRAWING(){var L=LI(document);return Object.defineProperty(sc,"SUPPORT_SVG_DRAWING",{value:L}),L},get SUPPORT_FOREIGNOBJECT_DRAWING(){var L=typeof Array.from=="function"&&typeof window.fetch=="function"?fN(document):Promise.resolve(!1);return Object.defineProperty(sc,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:L}),L},get SUPPORT_CORS_IMAGES(){var L=Yw();return Object.defineProperty(sc,"SUPPORT_CORS_IMAGES",{value:L}),L},get SUPPORT_RESPONSE_TYPE(){var L=Ip();return Object.defineProperty(sc,"SUPPORT_RESPONSE_TYPE",{value:L}),L},get SUPPORT_CORS_XHR(){var L="withCredentials"in new XMLHttpRequest;return Object.defineProperty(sc,"SUPPORT_CORS_XHR",{value:L}),L},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var L=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(sc,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:L}),L}},u0=(function(){function L(D,F){this.text=D,this.bounds=F}return L})(),pN=function(L,D,F,k){var re=cx(D,F),ce=[],xe=0;return re.forEach(function(Re){if(F.textDecorationLine.length||Re.trim().length>0)if(sc.SUPPORT_RANGE_BOUNDS){var Ne=NI(k,xe,Re.length).getClientRects();if(Ne.length>1){var tt=Rm(Re),lt=0;tt.forEach(function(Ht){ce.push(new u0(Ht,a.fromDOMRectList(L,NI(k,lt+xe,Ht.length).getClientRects()))),lt+=Ht.length})}else ce.push(new u0(Re,a.fromDOMRectList(L,Ne)))}else{var St=k.splitText(Re.length);ce.push(new u0(Re,OI(L,k))),k=St}else sc.SUPPORT_RANGE_BOUNDS||(k=k.splitText(Re.length));xe+=Re.length}),ce},OI=function(L,D){var F=D.ownerDocument;if(F){var k=F.createElement("html2canvaswrapper");k.appendChild(D.cloneNode(!0));var re=D.parentNode;if(re){re.replaceChild(k,D);var ce=o(L,k);return k.firstChild&&re.replaceChild(k.firstChild,k),ce}}return a.EMPTY},NI=function(L,D,F){var k=L.ownerDocument;if(!k)throw new Error("Node has no owner document");var re=k.createRange();return re.setStart(L,D),re.setEnd(L,D+F),re},Rm=function(L){if(sc.SUPPORT_NATIVE_TEXT_SEGMENTATION){var D=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(D.segment(L)).map(function(F){return F.segment})}return AN(L)},jw=function(L,D){if(sc.SUPPORT_NATIVE_TEXT_SEGMENTATION){var F=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(F.segment(L)).map(function(k){return k.segment})}return Bp(L,D)},cx=function(L,D){return D.letterSpacing!==0?Rm(L):jw(L,D)},Sf=[32,160,4961,65792,65793,4153,4241],Bp=function(L,D){for(var F=Sd(L,{lineBreak:D.lineBreak,wordBreak:D.overflowWrap==="break-word"?"break-word":D.wordBreak}),k=[],re,ce=function(){if(re.value){var xe=re.value.slice(),Re=c(xe),Ne="";Re.forEach(function(tt){Sf.indexOf(tt)===-1?Ne+=u(tt):(Ne.length&&k.push(Ne),k.push(u(tt)),Ne="")}),Ne.length&&k.push(Ne)}};!(re=F.next()).done;)ce();return k},Dp=(function(){function L(D,F,k){this.text=ux(F.data,k.textTransform),this.textBounds=pN(D,this.text,k,F)}return L})(),ux=function(L,D){switch(D){case 1:return L.toLowerCase();case 3:return L.replace(Qw,RI);case 2:return L.toUpperCase();default:return L}},Qw=/(^|\s|:|-|\(|\))([a-z])/g,RI=function(L,D,F){return L.length>0?D+F.toUpperCase():L},MI=(function(L){e(D,L);function D(F,k){var re=L.call(this,F,k)||this;return re.src=k.currentSrc||k.src,re.intrinsicWidth=k.naturalWidth,re.intrinsicHeight=k.naturalHeight,re.context.cache.addImage(re.src),re}return D})(jn),hx=(function(L){e(D,L);function D(F,k){var re=L.call(this,F,k)||this;return re.canvas=k,re.intrinsicWidth=k.width,re.intrinsicHeight=k.height,re}return D})(jn),dx=(function(L){e(D,L);function D(F,k){var re=L.call(this,F,k)||this,ce=new XMLSerializer,xe=o(F,k);return k.setAttribute("width",xe.width+"px"),k.setAttribute("height",xe.height+"px"),re.svg="data:image/svg+xml,"+encodeURIComponent(ce.serializeToString(k)),re.intrinsicWidth=k.width.baseVal.value,re.intrinsicHeight=k.height.baseVal.value,re.context.cache.addImage(re.svg),re}return D})(jn),yU=(function(L){e(D,L);function D(F,k){var re=L.call(this,F,k)||this;return re.value=k.value,re}return D})(jn),mN=(function(L){e(D,L);function D(F,k){var re=L.call(this,F,k)||this;return re.start=k.start,re.reversed=typeof k.reversed=="boolean"&&k.reversed===!0,re}return D})(jn),gae=[{type:15,flags:0,unit:"px",number:3}],yae=[{type:16,flags:0,number:50}],bae=function(L){return L.width>L.height?new a(L.left+(L.width-L.height)/2,L.top,L.height,L.height):L.width<L.height?new a(L.left,L.top+(L.height-L.width)/2,L.width,L.width):L},xae=function(L){var D=L.type===Eae?new Array(L.value.length+1).join("\u2022"):L.value;return D.length===0?L.placeholder||"":D},kI="checkbox",FI="radio",Eae="password",bU=707406591,gN=(function(L){e(D,L);function D(F,k){var re=L.call(this,F,k)||this;switch(re.type=k.type.toLowerCase(),re.checked=k.checked,re.value=xae(k),(re.type===kI||re.type===FI)&&(re.styles.backgroundColor=3739148031,re.styles.borderTopColor=re.styles.borderRightColor=re.styles.borderBottomColor=re.styles.borderLeftColor=2779096575,re.styles.borderTopWidth=re.styles.borderRightWidth=re.styles.borderBottomWidth=re.styles.borderLeftWidth=1,re.styles.borderTopStyle=re.styles.borderRightStyle=re.styles.borderBottomStyle=re.styles.borderLeftStyle=1,re.styles.backgroundClip=[0],re.styles.backgroundOrigin=[0],re.bounds=bae(re.bounds)),re.type){case kI:re.styles.borderTopRightRadius=re.styles.borderTopLeftRadius=re.styles.borderBottomRightRadius=re.styles.borderBottomLeftRadius=gae;break;case FI:re.styles.borderTopRightRadius=re.styles.borderTopLeftRadius=re.styles.borderBottomRightRadius=re.styles.borderBottomLeftRadius=yae;break}return re}return D})(jn),xU=(function(L){e(D,L);function D(F,k){var re=L.call(this,F,k)||this,ce=k.options[k.selectedIndex||0];return re.value=ce&&ce.text||"",re}return D})(jn),EU=(function(L){e(D,L);function D(F,k){var re=L.call(this,F,k)||this;return re.value=k.value,re}return D})(jn),wU=(function(L){e(D,L);function D(F,k){var re=L.call(this,F,k)||this;re.src=k.src,re.width=parseInt(k.width,10)||0,re.height=parseInt(k.height,10)||0,re.backgroundColor=re.styles.backgroundColor;try{if(k.contentWindow&&k.contentWindow.document&&k.contentWindow.document.documentElement){re.tree=CU(F,k.contentWindow.document.documentElement);var ce=k.contentWindow.document.documentElement?mt(F,getComputedStyle(k.contentWindow.document.documentElement).backgroundColor):Tt.TRANSPARENT,xe=k.contentWindow.document.body?mt(F,getComputedStyle(k.contentWindow.document.body).backgroundColor):Tt.TRANSPARENT;re.backgroundColor=ro(ce)?ro(xe)?re.styles.backgroundColor:xe:ce}}catch{}return re}return D})(jn),wae=["OL","UL","MENU"],UI=function(L,D,F,k){for(var re=D.firstChild,ce=void 0;re;re=ce)if(ce=re.nextSibling,SU(re)&&re.data.trim().length>0)F.textNodes.push(new Dp(L,re,F.styles));else if(Ax(re))if(PU(re)&&re.assignedNodes)re.assignedNodes().forEach(function(Re){return UI(L,Re,F,k)});else{var xe=vU(L,re);xe.styles.isVisible()&&(vae(re,xe,k)?xe.flags|=4:Cae(xe.styles)&&(xe.flags|=2),wae.indexOf(re.tagName)!==-1&&(xe.flags|=8),F.elements.push(xe),re.slot,re.shadowRoot?UI(L,re.shadowRoot,xe,k):!GI(re)&&!TU(re)&&!YI(re)&&UI(L,re,xe,k))}},vU=function(L,D){return xN(D)?new MI(L,D):IU(D)?new hx(L,D):TU(D)?new dx(L,D):Sae(D)?new yU(L,D):Tae(D)?new mN(L,D):Iae(D)?new gN(L,D):YI(D)?new xU(L,D):GI(D)?new EU(L,D):DU(D)?new wU(L,D):new jn(L,D)},CU=function(L,D){var F=vU(L,D);return F.flags|=4,UI(L,D,F,F),F},vae=function(L,D,F){return D.styles.isPositionedWithZIndex()||D.styles.opacity<1||D.styles.isTransformed()||bN(L)&&F.styles.isTransparent()},Cae=function(L){return L.isPositioned()||L.isFloating()},SU=function(L){return L.nodeType===Node.TEXT_NODE},Ax=function(L){return L.nodeType===Node.ELEMENT_NODE},yN=function(L){return Ax(L)&&typeof L.style<"u"&&!HI(L)},HI=function(L){return typeof L.className=="object"},Sae=function(L){return L.tagName==="LI"},Tae=function(L){return L.tagName==="OL"},Iae=function(L){return L.tagName==="INPUT"},Bae=function(L){return L.tagName==="HTML"},TU=function(L){return L.tagName==="svg"},bN=function(L){return L.tagName==="BODY"},IU=function(L){return L.tagName==="CANVAS"},BU=function(L){return L.tagName==="VIDEO"},xN=function(L){return L.tagName==="IMG"},DU=function(L){return L.tagName==="IFRAME"},_U=function(L){return L.tagName==="STYLE"},Dae=function(L){return L.tagName==="SCRIPT"},GI=function(L){return L.tagName==="TEXTAREA"},YI=function(L){return L.tagName==="SELECT"},PU=function(L){return L.tagName==="SLOT"},LU=function(L){return L.tagName.indexOf("-")>0},_ae=(function(){function L(){this.counters={}}return L.prototype.getCounterValue=function(D){var F=this.counters[D];return F&&F.length?F[F.length-1]:1},L.prototype.getCounterValues=function(D){var F=this.counters[D];return F||[]},L.prototype.pop=function(D){var F=this;D.forEach(function(k){return F.counters[k].pop()})},L.prototype.parse=function(D){var F=this,k=D.counterIncrement,re=D.counterReset,ce=!0;k!==null&&k.forEach(function(Re){var Ne=F.counters[Re.counter];Ne&&Re.increment!==0&&(ce=!1,Ne.length||Ne.push(1),Ne[Math.max(0,Ne.length-1)]+=Re.increment)});var xe=[];return ce&&re.forEach(function(Re){var Ne=F.counters[Re.counter];xe.push(Re.counter),Ne||(Ne=F.counters[Re.counter]=[]),Ne.push(Re.reset)}),xe},L})(),OU={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},NU={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u0554","\u0553","\u0552","\u0551","\u0550","\u054F","\u054E","\u054D","\u054C","\u054B","\u054A","\u0549","\u0548","\u0547","\u0546","\u0545","\u0544","\u0543","\u0542","\u0541","\u0540","\u053F","\u053E","\u053D","\u053C","\u053B","\u053A","\u0539","\u0538","\u0537","\u0536","\u0535","\u0534","\u0533","\u0532","\u0531"]},Pae={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["\u05D9\u05F3","\u05D8\u05F3","\u05D7\u05F3","\u05D6\u05F3","\u05D5\u05F3","\u05D4\u05F3","\u05D3\u05F3","\u05D2\u05F3","\u05D1\u05F3","\u05D0\u05F3","\u05EA","\u05E9","\u05E8","\u05E7","\u05E6","\u05E4","\u05E2","\u05E1","\u05E0","\u05DE","\u05DC","\u05DB","\u05D9\u05D8","\u05D9\u05D7","\u05D9\u05D6","\u05D8\u05D6","\u05D8\u05D5","\u05D9","\u05D8","\u05D7","\u05D6","\u05D5","\u05D4","\u05D3","\u05D2","\u05D1","\u05D0"]},Lae={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u10F5","\u10F0","\u10EF","\u10F4","\u10EE","\u10ED","\u10EC","\u10EB","\u10EA","\u10E9","\u10E8","\u10E7","\u10E6","\u10E5","\u10E4","\u10F3","\u10E2","\u10E1","\u10E0","\u10DF","\u10DE","\u10DD","\u10F2","\u10DC","\u10DB","\u10DA","\u10D9","\u10D8","\u10D7","\u10F1","\u10D6","\u10D5","\u10D4","\u10D3","\u10D2","\u10D1","\u10D0"]},fx=function(L,D,F,k,re,ce){return L<D||L>F?Xw(L,re,ce.length>0):k.integers.reduce(function(xe,Re,Ne){for(;L>=Re;)L-=Re,xe+=k.values[Ne];return xe},"")+ce},RU=function(L,D,F,k){var re="";do F||L--,re=k(L)+re,L/=D;while(L*D>=D);return re},gl=function(L,D,F,k,re){var ce=F-D+1;return(L<0?"-":"")+(RU(Math.abs(L),ce,k,function(xe){return u(Math.floor(xe%ce)+D)})+re)},Wy=function(L,D,F){F===void 0&&(F=". ");var k=D.length;return RU(Math.abs(L),k,!1,function(re){return D[Math.floor(re%k)]})+F},px=1,h0=2,d0=4,zw=8,Mm=function(L,D,F,k,re,ce){if(L<-9999||L>9999)return Xw(L,4,re.length>0);var xe=Math.abs(L),Re=re;if(xe===0)return D[0]+Re;for(var Ne=0;xe>0&&Ne<=4;Ne++){var tt=xe%10;tt===0&&At(ce,px)&&Re!==""?Re=D[tt]+Re:tt>1||tt===1&&Ne===0||tt===1&&Ne===1&&At(ce,h0)||tt===1&&Ne===1&&At(ce,d0)&&L>100||tt===1&&Ne>1&&At(ce,zw)?Re=D[tt]+(Ne>0?F[Ne-1]:"")+Re:tt===1&&Ne>0&&(Re=F[Ne-1]+Re),xe=Math.floor(xe/10)}return(L<0?k:"")+Re},MU="\u5341\u767E\u5343\u842C",kU="\u62FE\u4F70\u4EDF\u842C",FU="\u30DE\u30A4\u30CA\u30B9",EN="\uB9C8\uC774\uB108\uC2A4",Xw=function(L,D,F){var k=F?". ":"",re=F?"\u3001":"",ce=F?", ":"",xe=F?" ":"";switch(D){case 0:return"\u2022"+xe;case 1:return"\u25E6"+xe;case 2:return"\u25FE"+xe;case 5:var Re=gl(L,48,57,!0,k);return Re.length<4?"0"+Re:Re;case 4:return Wy(L,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",re);case 6:return fx(L,1,3999,OU,3,k).toLowerCase();case 7:return fx(L,1,3999,OU,3,k);case 8:return gl(L,945,969,!1,k);case 9:return gl(L,97,122,!1,k);case 10:return gl(L,65,90,!1,k);case 11:return gl(L,1632,1641,!0,k);case 12:case 49:return fx(L,1,9999,NU,3,k);case 35:return fx(L,1,9999,NU,3,k).toLowerCase();case 13:return gl(L,2534,2543,!0,k);case 14:case 30:return gl(L,6112,6121,!0,k);case 15:return Wy(L,"\u5B50\u4E11\u5BC5\u536F\u8FB0\u5DF3\u5348\u672A\u7533\u9149\u620C\u4EA5",re);case 16:return Wy(L,"\u7532\u4E59\u4E19\u4E01\u620A\u5DF1\u5E9A\u8F9B\u58EC\u7678",re);case 17:case 48:return Mm(L,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",MU,"\u8CA0",re,h0|d0|zw);case 47:return Mm(L,"\u96F6\u58F9\u8CB3\u53C3\u8086\u4F0D\u9678\u67D2\u634C\u7396",kU,"\u8CA0",re,px|h0|d0|zw);case 42:return Mm(L,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",MU,"\u8D1F",re,h0|d0|zw);case 41:return Mm(L,"\u96F6\u58F9\u8D30\u53C1\u8086\u4F0D\u9646\u67D2\u634C\u7396",kU,"\u8D1F",re,px|h0|d0|zw);case 26:return Mm(L,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u4E07",FU,re,0);case 25:return Mm(L,"\u96F6\u58F1\u5F10\u53C2\u56DB\u4F0D\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343\u4E07",FU,re,px|h0|d0);case 31:return Mm(L,"\uC601\uC77C\uC774\uC0BC\uC0AC\uC624\uC721\uCE60\uD314\uAD6C","\uC2ED\uBC31\uCC9C\uB9CC",EN,ce,px|h0|d0);case 33:return Mm(L,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u842C",EN,ce,0);case 32:return Mm(L,"\u96F6\u58F9\u8CB3\u53C3\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343",EN,ce,px|h0|d0);case 18:return gl(L,2406,2415,!0,k);case 20:return fx(L,1,19999,Lae,3,k);case 21:return gl(L,2790,2799,!0,k);case 22:return gl(L,2662,2671,!0,k);case 22:return fx(L,1,10999,Pae,3,k);case 23:return Wy(L,"\u3042\u3044\u3046\u3048\u304A\u304B\u304D\u304F\u3051\u3053\u3055\u3057\u3059\u305B\u305D\u305F\u3061\u3064\u3066\u3068\u306A\u306B\u306C\u306D\u306E\u306F\u3072\u3075\u3078\u307B\u307E\u307F\u3080\u3081\u3082\u3084\u3086\u3088\u3089\u308A\u308B\u308C\u308D\u308F\u3090\u3091\u3092\u3093");case 24:return Wy(L,"\u3044\u308D\u306F\u306B\u307B\u3078\u3068\u3061\u308A\u306C\u308B\u3092\u308F\u304B\u3088\u305F\u308C\u305D\u3064\u306D\u306A\u3089\u3080\u3046\u3090\u306E\u304A\u304F\u3084\u307E\u3051\u3075\u3053\u3048\u3066\u3042\u3055\u304D\u3086\u3081\u307F\u3057\u3091\u3072\u3082\u305B\u3059");case 27:return gl(L,3302,3311,!0,k);case 28:return Wy(L,"\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F0\u30F1\u30F2\u30F3",re);case 29:return Wy(L,"\u30A4\u30ED\u30CF\u30CB\u30DB\u30D8\u30C8\u30C1\u30EA\u30CC\u30EB\u30F2\u30EF\u30AB\u30E8\u30BF\u30EC\u30BD\u30C4\u30CD\u30CA\u30E9\u30E0\u30A6\u30F0\u30CE\u30AA\u30AF\u30E4\u30DE\u30B1\u30D5\u30B3\u30A8\u30C6\u30A2\u30B5\u30AD\u30E6\u30E1\u30DF\u30B7\u30F1\u30D2\u30E2\u30BB\u30B9",re);case 34:return gl(L,3792,3801,!0,k);case 37:return gl(L,6160,6169,!0,k);case 38:return gl(L,4160,4169,!0,k);case 39:return gl(L,2918,2927,!0,k);case 40:return gl(L,1776,1785,!0,k);case 43:return gl(L,3046,3055,!0,k);case 44:return gl(L,3174,3183,!0,k);case 45:return gl(L,3664,3673,!0,k);case 46:return gl(L,3872,3881,!0,k);case 3:default:return gl(L,48,57,!0,k)}},UU="data-html2canvas-ignore",HU=(function(){function L(D,F,k){if(this.context=D,this.options=k,this.scrolledElements=[],this.referenceElement=F,this.counters=new _ae,this.quoteDepth=0,!F.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(F.ownerDocument.documentElement,!1)}return L.prototype.toIFrame=function(D,F){var k=this,re=Oae(D,F);if(!re.contentWindow)return Promise.reject("Unable to find iframe window");var ce=D.defaultView.pageXOffset,xe=D.defaultView.pageYOffset,Re=re.contentWindow,Ne=Re.document,tt=Mae(re).then(function(){return i(k,void 0,void 0,function(){var lt,St;return n(this,function(Ht){switch(Ht.label){case 0:return this.scrolledElements.forEach(Hae),Re&&(Re.scrollTo(F.left,F.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(Re.scrollY!==F.top||Re.scrollX!==F.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(Re.scrollX-F.left,Re.scrollY-F.top,0,0))),lt=this.options.onclone,St=this.clonedReferenceElement,typeof St>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:Ne.fonts&&Ne.fonts.ready?[4,Ne.fonts.ready]:[3,2];case 1:Ht.sent(),Ht.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Rae(Ne)]:[3,4];case 3:Ht.sent(),Ht.label=4;case 4:return typeof lt=="function"?[2,Promise.resolve().then(function(){return lt(Ne,St)}).then(function(){return re})]:[2,re]}})})});return Ne.open(),Ne.write(Fae(document.doctype)+"<html></html>"),Uae(this.referenceElement.ownerDocument,ce,xe),Ne.replaceChild(Ne.adoptNode(this.documentElement),Ne.documentElement),Ne.close(),tt},L.prototype.createElementClone=function(D){if(Nn(D,2))debugger;if(IU(D))return this.createCanvasClone(D);if(BU(D))return this.createVideoClone(D);if(_U(D))return this.createStyleClone(D);var F=D.cloneNode(!1);return xN(F)&&(xN(D)&&D.currentSrc&&D.currentSrc!==D.src&&(F.src=D.currentSrc,F.srcset=""),F.loading==="lazy"&&(F.loading="eager")),LU(F)?this.createCustomElementClone(F):F},L.prototype.createCustomElementClone=function(D){var F=document.createElement("html2canvascustomelement");return wN(D.style,F),F},L.prototype.createStyleClone=function(D){try{var F=D.sheet;if(F&&F.cssRules){var k=[].slice.call(F.cssRules,0).reduce(function(ce,xe){return xe&&typeof xe.cssText=="string"?ce+xe.cssText:ce},""),re=D.cloneNode(!1);return re.textContent=k,re}}catch(ce){if(this.context.logger.error("Unable to access cssRules property",ce),ce.name!=="SecurityError")throw ce}return D.cloneNode(!1)},L.prototype.createCanvasClone=function(D){var F;if(this.options.inlineImages&&D.ownerDocument){var k=D.ownerDocument.createElement("img");try{return k.src=D.toDataURL(),k}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",D)}}var re=D.cloneNode(!1);try{re.width=D.width,re.height=D.height;var ce=D.getContext("2d"),xe=re.getContext("2d");if(xe)if(!this.options.allowTaint&&ce)xe.putImageData(ce.getImageData(0,0,D.width,D.height),0,0);else{var Re=(F=D.getContext("webgl2"))!==null&&F!==void 0?F:D.getContext("webgl");if(Re){var Ne=Re.getContextAttributes();(Ne==null?void 0:Ne.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",D)}xe.drawImage(D,0,0)}return re}catch{this.context.logger.info("Unable to clone canvas as it is tainted",D)}return re},L.prototype.createVideoClone=function(D){var F=D.ownerDocument.createElement("canvas");F.width=D.offsetWidth,F.height=D.offsetHeight;var k=F.getContext("2d");try{return k&&(k.drawImage(D,0,0,F.width,F.height),this.options.allowTaint||k.getImageData(0,0,F.width,F.height)),F}catch{this.context.logger.info("Unable to clone video as it is tainted",D)}var re=D.ownerDocument.createElement("canvas");return re.width=D.offsetWidth,re.height=D.offsetHeight,re},L.prototype.appendChildNode=function(D,F,k){(!Ax(F)||!Dae(F)&&!F.hasAttribute(UU)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(F)))&&(!this.options.copyStyles||!Ax(F)||!_U(F))&&D.appendChild(this.cloneNode(F,k))},L.prototype.cloneChildNodes=function(D,F,k){for(var re=this,ce=D.shadowRoot?D.shadowRoot.firstChild:D.firstChild;ce;ce=ce.nextSibling)if(Ax(ce)&&PU(ce)&&typeof ce.assignedNodes=="function"){var xe=ce.assignedNodes();xe.length&&xe.forEach(function(Re){return re.appendChildNode(F,Re,k)})}else this.appendChildNode(F,ce,k)},L.prototype.cloneNode=function(D,F){if(SU(D))return document.createTextNode(D.data);if(!D.ownerDocument)return D.cloneNode(!1);var k=D.ownerDocument.defaultView;if(k&&Ax(D)&&(yN(D)||HI(D))){var re=this.createElementClone(D);re.style.transitionProperty="none";var ce=k.getComputedStyle(D),xe=k.getComputedStyle(D,":before"),Re=k.getComputedStyle(D,":after");this.referenceElement===D&&yN(re)&&(this.clonedReferenceElement=re),bN(re)&&Vae(re);var Ne=this.counters.parse(new Rr(this.context,ce)),tt=this.resolvePseudoContent(D,re,xe,qw.BEFORE);LU(D)&&(F=!0),BU(D)||this.cloneChildNodes(D,re,F),tt&&re.insertBefore(tt,re.firstChild);var lt=this.resolvePseudoContent(D,re,Re,qw.AFTER);return lt&&re.appendChild(lt),this.counters.pop(Ne),(ce&&(this.options.copyStyles||HI(D))&&!DU(D)||F)&&wN(ce,re),(D.scrollTop!==0||D.scrollLeft!==0)&&this.scrolledElements.push([re,D.scrollLeft,D.scrollTop]),(GI(D)||YI(D))&&(GI(re)||YI(re))&&(re.value=D.value),re}return D.cloneNode(!1)},L.prototype.resolvePseudoContent=function(D,F,k,re){var ce=this;if(k){var xe=k.content,Re=F.ownerDocument;if(!(!Re||!xe||xe==="none"||xe==="-moz-alt-content"||k.display==="none")){this.counters.parse(new Rr(this.context,k));var Ne=new Mi(this.context,k),tt=Re.createElement("html2canvaspseudoelement");wN(k,tt),Ne.content.forEach(function(St){if(St.type===0)tt.appendChild(Re.createTextNode(St.value));else if(St.type===22){var Ht=Re.createElement("img");Ht.src=St.value,Ht.style.opacity="1",tt.appendChild(Ht)}else if(St.type===18){if(St.name==="attr"){var Wr=St.values.filter(gi);Wr.length&&tt.appendChild(Re.createTextNode(D.getAttribute(Wr[0].value)||""))}else if(St.name==="counter"){var Er=St.values.filter(cs),kr=Er[0],Sn=Er[1];if(kr&&gi(kr)){var yi=ce.counters.getCounterValue(kr.value),Ai=Sn&&gi(Sn)?ku.parse(ce.context,Sn.value):3;tt.appendChild(Re.createTextNode(Xw(yi,Ai,!1)))}}else if(St.name==="counters"){var Fs=St.values.filter(cs),kr=Fs[0],Rn=Fs[1],Sn=Fs[2];if(kr&&gi(kr)){var en=ce.counters.getCounterValues(kr.value),zr=Sn&&gi(Sn)?ku.parse(ce.context,Sn.value):3,xs=Rn&&Rn.type===0?Rn.value:"",Es=en.map(function(Gh){return Xw(Gh,zr,!1)}).join(xs);tt.appendChild(Re.createTextNode(Es))}}}else if(St.type===20)switch(St.value){case"open-quote":tt.appendChild(Re.createTextNode(ot(Ne.quotes,ce.quoteDepth++,!0)));break;case"close-quote":tt.appendChild(Re.createTextNode(ot(Ne.quotes,--ce.quoteDepth,!1)));break;default:tt.appendChild(Re.createTextNode(St.value))}}),tt.className=vN+" "+CN;var lt=re===qw.BEFORE?" "+vN:" "+CN;return HI(F)?F.className.baseValue+=lt:F.className+=lt,tt}}},L.destroy=function(D){return D.parentNode?(D.parentNode.removeChild(D),!0):!1},L})(),qw;(function(L){L[L.BEFORE=0]="BEFORE",L[L.AFTER=1]="AFTER"})(qw||(qw={}));var Oae=function(L,D){var F=L.createElement("iframe");return F.className="html2canvas-container",F.style.visibility="hidden",F.style.position="fixed",F.style.left="-10000px",F.style.top="0px",F.style.border="0",F.width=D.width.toString(),F.height=D.height.toString(),F.scrolling="no",F.setAttribute(UU,"true"),L.body.appendChild(F),F},Nae=function(L){return new Promise(function(D){if(L.complete){D();return}if(!L.src){D();return}L.onload=D,L.onerror=D})},Rae=function(L){return Promise.all([].slice.call(L.images,0).map(Nae))},Mae=function(L){return new Promise(function(D,F){var k=L.contentWindow;if(!k)return F("No window assigned for iframe");var re=k.document;k.onload=L.onload=function(){k.onload=L.onload=null;var ce=setInterval(function(){re.body.childNodes.length>0&&re.readyState==="complete"&&(clearInterval(ce),D(L))},50)}})},kae=["all","d","content"],wN=function(L,D){for(var F=L.length-1;F>=0;F--){var k=L.item(F);kae.indexOf(k)===-1&&D.style.setProperty(k,L.getPropertyValue(k))}return D},Fae=function(L){var D="";return L&&(D+="<!DOCTYPE ",L.name&&(D+=L.name),L.internalSubset&&(D+=L.internalSubset),L.publicId&&(D+='"'+L.publicId+'"'),L.systemId&&(D+='"'+L.systemId+'"'),D+=">"),D},Uae=function(L,D,F){L&&L.defaultView&&(D!==L.defaultView.pageXOffset||F!==L.defaultView.pageYOffset)&&L.defaultView.scrollTo(D,F)},Hae=function(L){var D=L[0],F=L[1],k=L[2];D.scrollLeft=F,D.scrollTop=k},Gae=":before",Yae=":after",vN="___html2canvas___pseudoelement_before",CN="___html2canvas___pseudoelement_after",GU=`{
    content: "" !important;
    display: none !important;
}`,Vae=function(L){jae(L,"."+vN+Gae+GU+`
         .`+CN+Yae+GU)},jae=function(L,D){var F=L.ownerDocument;if(F){var k=F.createElement("style");k.textContent=D,L.appendChild(k)}},YU=(function(){function L(){}return L.getOrigin=function(D){var F=L._link;return F?(F.href=D,F.href=F.href,F.protocol+F.hostname+F.port):"about:blank"},L.isSameOrigin=function(D){return L.getOrigin(D)===L._origin},L.setContext=function(D){L._link=D.document.createElement("a"),L._origin=L.getOrigin(D.location.href)},L._origin="about:blank",L})(),Qae=(function(){function L(D,F){this.context=D,this._options=F,this._cache={}}return L.prototype.addImage=function(D){var F=Promise.resolve();return this.has(D)||(TN(D)||Wae(D))&&(this._cache[D]=this.loadImage(D)).catch(function(){}),F},L.prototype.match=function(D){return this._cache[D]},L.prototype.loadImage=function(D){return i(this,void 0,void 0,function(){var F,k,re,ce,xe=this;return n(this,function(Re){switch(Re.label){case 0:return F=YU.isSameOrigin(D),k=!SN(D)&&this._options.useCORS===!0&&sc.SUPPORT_CORS_IMAGES&&!F,re=!SN(D)&&!F&&!TN(D)&&typeof this._options.proxy=="string"&&sc.SUPPORT_CORS_XHR&&!k,!F&&this._options.allowTaint===!1&&!SN(D)&&!TN(D)&&!re&&!k?[2]:(ce=D,re?[4,this.proxy(ce)]:[3,2]);case 1:ce=Re.sent(),Re.label=2;case 2:return this.context.logger.debug("Added image "+D.substring(0,256)),[4,new Promise(function(Ne,tt){var lt=new Image;lt.onload=function(){return Ne(lt)},lt.onerror=tt,(Kae(ce)||k)&&(lt.crossOrigin="anonymous"),lt.src=ce,lt.complete===!0&&setTimeout(function(){return Ne(lt)},500),xe._options.imageTimeout>0&&setTimeout(function(){return tt("Timed out ("+xe._options.imageTimeout+"ms) loading image")},xe._options.imageTimeout)})];case 3:return[2,Re.sent()]}})})},L.prototype.has=function(D){return typeof this._cache[D]<"u"},L.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},L.prototype.proxy=function(D){var F=this,k=this._options.proxy;if(!k)throw new Error("No proxy defined");var re=D.substring(0,256);return new Promise(function(ce,xe){var Re=sc.SUPPORT_RESPONSE_TYPE?"blob":"text",Ne=new XMLHttpRequest;Ne.onload=function(){if(Ne.status===200)if(Re==="text")ce(Ne.response);else{var St=new FileReader;St.addEventListener("load",function(){return ce(St.result)},!1),St.addEventListener("error",function(Ht){return xe(Ht)},!1),St.readAsDataURL(Ne.response)}else xe("Failed to proxy resource "+re+" with status code "+Ne.status)},Ne.onerror=xe;var tt=k.indexOf("?")>-1?"&":"?";if(Ne.open("GET",""+k+tt+"url="+encodeURIComponent(D)+"&responseType="+Re),Re!=="text"&&Ne instanceof XMLHttpRequest&&(Ne.responseType=Re),F._options.imageTimeout){var lt=F._options.imageTimeout;Ne.timeout=lt,Ne.ontimeout=function(){return xe("Timed out ("+lt+"ms) proxying "+re)}}Ne.send()})},L})(),zae=/^data:image\/svg\+xml/i,Xae=/^data:image\/.*;base64,/i,qae=/^data:image\/.*/i,Wae=function(L){return sc.SUPPORT_SVG_DRAWING||!Jae(L)},SN=function(L){return qae.test(L)},Kae=function(L){return Xae.test(L)},TN=function(L){return L.substr(0,4)==="blob"},Jae=function(L){return L.substr(-3).toLowerCase()==="svg"||zae.test(L)},Yr=(function(){function L(D,F){this.type=0,this.x=D,this.y=F}return L.prototype.add=function(D,F){return new L(this.x+D,this.y+F)},L})(),mx=function(L,D,F){return new Yr(L.x+(D.x-L.x)*F,L.y+(D.y-L.y)*F)},VI=(function(){function L(D,F,k,re){this.type=1,this.start=D,this.startControl=F,this.endControl=k,this.end=re}return L.prototype.subdivide=function(D,F){var k=mx(this.start,this.startControl,D),re=mx(this.startControl,this.endControl,D),ce=mx(this.endControl,this.end,D),xe=mx(k,re,D),Re=mx(re,ce,D),Ne=mx(xe,Re,D);return F?new L(this.start,k,xe,Ne):new L(Ne,Re,ce,this.end)},L.prototype.add=function(D,F){return new L(this.start.add(D,F),this.startControl.add(D,F),this.endControl.add(D,F),this.end.add(D,F))},L.prototype.reverse=function(){return new L(this.end,this.endControl,this.startControl,this.start)},L})(),gA=function(L){return L.type===1},$ae=(function(){function L(D){var F=D.styles,k=D.bounds,re=Dd(F.borderTopLeftRadius,k.width,k.height),ce=re[0],xe=re[1],Re=Dd(F.borderTopRightRadius,k.width,k.height),Ne=Re[0],tt=Re[1],lt=Dd(F.borderBottomRightRadius,k.width,k.height),St=lt[0],Ht=lt[1],Wr=Dd(F.borderBottomLeftRadius,k.width,k.height),Er=Wr[0],kr=Wr[1],Sn=[];Sn.push((ce+Ne)/k.width),Sn.push((Er+St)/k.width),Sn.push((xe+kr)/k.height),Sn.push((tt+Ht)/k.height);var yi=Math.max.apply(Math,Sn);yi>1&&(ce/=yi,xe/=yi,Ne/=yi,tt/=yi,St/=yi,Ht/=yi,Er/=yi,kr/=yi);var Ai=k.width-Ne,Fs=k.height-Ht,Rn=k.width-St,en=k.height-kr,zr=F.borderTopWidth,xs=F.borderRightWidth,Es=F.borderBottomWidth,on=F.borderLeftWidth,Nl=ns(F.paddingTop,D.bounds.width),Gh=ns(F.paddingRight,D.bounds.width),Od=ns(F.paddingBottom,D.bounds.width),Na=ns(F.paddingLeft,D.bounds.width);this.topLeftBorderDoubleOuterBox=ce>0||xe>0?go(k.left+on/3,k.top+zr/3,ce-on/3,xe-zr/3,fa.TOP_LEFT):new Yr(k.left+on/3,k.top+zr/3),this.topRightBorderDoubleOuterBox=ce>0||xe>0?go(k.left+Ai,k.top+zr/3,Ne-xs/3,tt-zr/3,fa.TOP_RIGHT):new Yr(k.left+k.width-xs/3,k.top+zr/3),this.bottomRightBorderDoubleOuterBox=St>0||Ht>0?go(k.left+Rn,k.top+Fs,St-xs/3,Ht-Es/3,fa.BOTTOM_RIGHT):new Yr(k.left+k.width-xs/3,k.top+k.height-Es/3),this.bottomLeftBorderDoubleOuterBox=Er>0||kr>0?go(k.left+on/3,k.top+en,Er-on/3,kr-Es/3,fa.BOTTOM_LEFT):new Yr(k.left+on/3,k.top+k.height-Es/3),this.topLeftBorderDoubleInnerBox=ce>0||xe>0?go(k.left+on*2/3,k.top+zr*2/3,ce-on*2/3,xe-zr*2/3,fa.TOP_LEFT):new Yr(k.left+on*2/3,k.top+zr*2/3),this.topRightBorderDoubleInnerBox=ce>0||xe>0?go(k.left+Ai,k.top+zr*2/3,Ne-xs*2/3,tt-zr*2/3,fa.TOP_RIGHT):new Yr(k.left+k.width-xs*2/3,k.top+zr*2/3),this.bottomRightBorderDoubleInnerBox=St>0||Ht>0?go(k.left+Rn,k.top+Fs,St-xs*2/3,Ht-Es*2/3,fa.BOTTOM_RIGHT):new Yr(k.left+k.width-xs*2/3,k.top+k.height-Es*2/3),this.bottomLeftBorderDoubleInnerBox=Er>0||kr>0?go(k.left+on*2/3,k.top+en,Er-on*2/3,kr-Es*2/3,fa.BOTTOM_LEFT):new Yr(k.left+on*2/3,k.top+k.height-Es*2/3),this.topLeftBorderStroke=ce>0||xe>0?go(k.left+on/2,k.top+zr/2,ce-on/2,xe-zr/2,fa.TOP_LEFT):new Yr(k.left+on/2,k.top+zr/2),this.topRightBorderStroke=ce>0||xe>0?go(k.left+Ai,k.top+zr/2,Ne-xs/2,tt-zr/2,fa.TOP_RIGHT):new Yr(k.left+k.width-xs/2,k.top+zr/2),this.bottomRightBorderStroke=St>0||Ht>0?go(k.left+Rn,k.top+Fs,St-xs/2,Ht-Es/2,fa.BOTTOM_RIGHT):new Yr(k.left+k.width-xs/2,k.top+k.height-Es/2),this.bottomLeftBorderStroke=Er>0||kr>0?go(k.left+on/2,k.top+en,Er-on/2,kr-Es/2,fa.BOTTOM_LEFT):new Yr(k.left+on/2,k.top+k.height-Es/2),this.topLeftBorderBox=ce>0||xe>0?go(k.left,k.top,ce,xe,fa.TOP_LEFT):new Yr(k.left,k.top),this.topRightBorderBox=Ne>0||tt>0?go(k.left+Ai,k.top,Ne,tt,fa.TOP_RIGHT):new Yr(k.left+k.width,k.top),this.bottomRightBorderBox=St>0||Ht>0?go(k.left+Rn,k.top+Fs,St,Ht,fa.BOTTOM_RIGHT):new Yr(k.left+k.width,k.top+k.height),this.bottomLeftBorderBox=Er>0||kr>0?go(k.left,k.top+en,Er,kr,fa.BOTTOM_LEFT):new Yr(k.left,k.top+k.height),this.topLeftPaddingBox=ce>0||xe>0?go(k.left+on,k.top+zr,Math.max(0,ce-on),Math.max(0,xe-zr),fa.TOP_LEFT):new Yr(k.left+on,k.top+zr),this.topRightPaddingBox=Ne>0||tt>0?go(k.left+Math.min(Ai,k.width-xs),k.top+zr,Ai>k.width+xs?0:Math.max(0,Ne-xs),Math.max(0,tt-zr),fa.TOP_RIGHT):new Yr(k.left+k.width-xs,k.top+zr),this.bottomRightPaddingBox=St>0||Ht>0?go(k.left+Math.min(Rn,k.width-on),k.top+Math.min(Fs,k.height-Es),Math.max(0,St-xs),Math.max(0,Ht-Es),fa.BOTTOM_RIGHT):new Yr(k.left+k.width-xs,k.top+k.height-Es),this.bottomLeftPaddingBox=Er>0||kr>0?go(k.left+on,k.top+Math.min(en,k.height-Es),Math.max(0,Er-on),Math.max(0,kr-Es),fa.BOTTOM_LEFT):new Yr(k.left+on,k.top+k.height-Es),this.topLeftContentBox=ce>0||xe>0?go(k.left+on+Na,k.top+zr+Nl,Math.max(0,ce-(on+Na)),Math.max(0,xe-(zr+Nl)),fa.TOP_LEFT):new Yr(k.left+on+Na,k.top+zr+Nl),this.topRightContentBox=Ne>0||tt>0?go(k.left+Math.min(Ai,k.width+on+Na),k.top+zr+Nl,Ai>k.width+on+Na?0:Ne-on+Na,tt-(zr+Nl),fa.TOP_RIGHT):new Yr(k.left+k.width-(xs+Gh),k.top+zr+Nl),this.bottomRightContentBox=St>0||Ht>0?go(k.left+Math.min(Rn,k.width-(on+Na)),k.top+Math.min(Fs,k.height+zr+Nl),Math.max(0,St-(xs+Gh)),Ht-(Es+Od),fa.BOTTOM_RIGHT):new Yr(k.left+k.width-(xs+Gh),k.top+k.height-(Es+Od)),this.bottomLeftContentBox=Er>0||kr>0?go(k.left+on+Na,k.top+en,Math.max(0,Er-(on+Na)),kr-(Es+Od),fa.BOTTOM_LEFT):new Yr(k.left+on+Na,k.top+k.height-(Es+Od))}return L})(),fa;(function(L){L[L.TOP_LEFT=0]="TOP_LEFT",L[L.TOP_RIGHT=1]="TOP_RIGHT",L[L.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",L[L.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(fa||(fa={}));var go=function(L,D,F,k,re){var ce=4*((Math.sqrt(2)-1)/3),xe=F*ce,Re=k*ce,Ne=L+F,tt=D+k;switch(re){case fa.TOP_LEFT:return new VI(new Yr(L,tt),new Yr(L,tt-Re),new Yr(Ne-xe,D),new Yr(Ne,D));case fa.TOP_RIGHT:return new VI(new Yr(L,D),new Yr(L+xe,D),new Yr(Ne,tt-Re),new Yr(Ne,tt));case fa.BOTTOM_RIGHT:return new VI(new Yr(Ne,D),new Yr(Ne,D+Re),new Yr(L+xe,tt),new Yr(L,tt));case fa.BOTTOM_LEFT:default:return new VI(new Yr(Ne,tt),new Yr(Ne-xe,tt),new Yr(L,D+Re),new Yr(L,D))}},jI=function(L){return[L.topLeftBorderBox,L.topRightBorderBox,L.bottomRightBorderBox,L.bottomLeftBorderBox]},Zae=function(L){return[L.topLeftContentBox,L.topRightContentBox,L.bottomRightContentBox,L.bottomLeftContentBox]},QI=function(L){return[L.topLeftPaddingBox,L.topRightPaddingBox,L.bottomRightPaddingBox,L.bottomLeftPaddingBox]},eoe=(function(){function L(D,F,k){this.offsetX=D,this.offsetY=F,this.matrix=k,this.type=0,this.target=6}return L})(),zI=(function(){function L(D,F){this.path=D,this.target=F,this.type=1}return L})(),toe=(function(){function L(D){this.opacity=D,this.type=2,this.target=6}return L})(),roe=function(L){return L.type===0},VU=function(L){return L.type===1},ioe=function(L){return L.type===2},jU=function(L,D){return L.length===D.length?L.some(function(F,k){return F===D[k]}):!1},noe=function(L,D,F,k,re){return L.map(function(ce,xe){switch(xe){case 0:return ce.add(D,F);case 1:return ce.add(D+k,F);case 2:return ce.add(D+k,F+re);case 3:return ce.add(D,F+re)}return ce})},QU=(function(){function L(D){this.element=D,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return L})(),zU=(function(){function L(D,F){if(this.container=D,this.parent=F,this.effects=[],this.curves=new $ae(this.container),this.container.styles.opacity<1&&this.effects.push(new toe(this.container.styles.opacity)),this.container.styles.transform!==null){var k=this.container.bounds.left+this.container.styles.transformOrigin[0].number,re=this.container.bounds.top+this.container.styles.transformOrigin[1].number,ce=this.container.styles.transform;this.effects.push(new eoe(k,re,ce))}if(this.container.styles.overflowX!==0){var xe=jI(this.curves),Re=QI(this.curves);jU(xe,Re)?this.effects.push(new zI(xe,6)):(this.effects.push(new zI(xe,2)),this.effects.push(new zI(Re,4)))}}return L.prototype.getEffects=function(D){for(var F=[2,3].indexOf(this.container.styles.position)===-1,k=this.parent,re=this.effects.slice(0);k;){var ce=k.effects.filter(function(Ne){return!VU(Ne)});if(F||k.container.styles.position!==0||!k.parent){if(re.unshift.apply(re,ce),F=[2,3].indexOf(k.container.styles.position)===-1,k.container.styles.overflowX!==0){var xe=jI(k.curves),Re=QI(k.curves);jU(xe,Re)||re.unshift(new zI(Re,6))}}else re.unshift.apply(re,ce);k=k.parent}return re.filter(function(Ne){return At(Ne.target,D)})},L})(),IN=function(L,D,F,k){L.container.elements.forEach(function(re){var ce=At(re.flags,4),xe=At(re.flags,2),Re=new zU(re,L);At(re.styles.display,2048)&&k.push(Re);var Ne=At(re.flags,8)?[]:k;if(ce||xe){var tt=ce||re.styles.isPositioned()?F:D,lt=new QU(Re);if(re.styles.isPositioned()||re.styles.opacity<1||re.styles.isTransformed()){var St=re.styles.zIndex.order;if(St<0){var Ht=0;tt.negativeZIndex.some(function(Er,kr){return St>Er.element.container.styles.zIndex.order?(Ht=kr,!1):Ht>0}),tt.negativeZIndex.splice(Ht,0,lt)}else if(St>0){var Wr=0;tt.positiveZIndex.some(function(Er,kr){return St>=Er.element.container.styles.zIndex.order?(Wr=kr+1,!1):Wr>0}),tt.positiveZIndex.splice(Wr,0,lt)}else tt.zeroOrAutoZIndexOrTransformedOrOpacity.push(lt)}else re.styles.isFloating()?tt.nonPositionedFloats.push(lt):tt.nonPositionedInlineLevel.push(lt);IN(Re,lt,ce?lt:F,Ne)}else re.styles.isInlineLevel()?D.inlineLevel.push(Re):D.nonInlineLevel.push(Re),IN(Re,D,F,Ne);At(re.flags,8)&&XU(re,Ne)})},XU=function(L,D){for(var F=L instanceof mN?L.start:1,k=L instanceof mN?L.reversed:!1,re=0;re<D.length;re++){var ce=D[re];ce.container instanceof yU&&typeof ce.container.value=="number"&&ce.container.value!==0&&(F=ce.container.value),ce.listValue=Xw(F,ce.container.styles.listStyleType,!0),F+=k?-1:1}},soe=function(L){var D=new zU(L,null),F=new QU(D),k=[];return IN(D,F,F,k),XU(D.container,k),F},qU=function(L,D){switch(D){case 0:return yA(L.topLeftBorderBox,L.topLeftPaddingBox,L.topRightBorderBox,L.topRightPaddingBox);case 1:return yA(L.topRightBorderBox,L.topRightPaddingBox,L.bottomRightBorderBox,L.bottomRightPaddingBox);case 2:return yA(L.bottomRightBorderBox,L.bottomRightPaddingBox,L.bottomLeftBorderBox,L.bottomLeftPaddingBox);case 3:default:return yA(L.bottomLeftBorderBox,L.bottomLeftPaddingBox,L.topLeftBorderBox,L.topLeftPaddingBox)}},aoe=function(L,D){switch(D){case 0:return yA(L.topLeftBorderBox,L.topLeftBorderDoubleOuterBox,L.topRightBorderBox,L.topRightBorderDoubleOuterBox);case 1:return yA(L.topRightBorderBox,L.topRightBorderDoubleOuterBox,L.bottomRightBorderBox,L.bottomRightBorderDoubleOuterBox);case 2:return yA(L.bottomRightBorderBox,L.bottomRightBorderDoubleOuterBox,L.bottomLeftBorderBox,L.bottomLeftBorderDoubleOuterBox);case 3:default:return yA(L.bottomLeftBorderBox,L.bottomLeftBorderDoubleOuterBox,L.topLeftBorderBox,L.topLeftBorderDoubleOuterBox)}},ooe=function(L,D){switch(D){case 0:return yA(L.topLeftBorderDoubleInnerBox,L.topLeftPaddingBox,L.topRightBorderDoubleInnerBox,L.topRightPaddingBox);case 1:return yA(L.topRightBorderDoubleInnerBox,L.topRightPaddingBox,L.bottomRightBorderDoubleInnerBox,L.bottomRightPaddingBox);case 2:return yA(L.bottomRightBorderDoubleInnerBox,L.bottomRightPaddingBox,L.bottomLeftBorderDoubleInnerBox,L.bottomLeftPaddingBox);case 3:default:return yA(L.bottomLeftBorderDoubleInnerBox,L.bottomLeftPaddingBox,L.topLeftBorderDoubleInnerBox,L.topLeftPaddingBox)}},loe=function(L,D){switch(D){case 0:return XI(L.topLeftBorderStroke,L.topRightBorderStroke);case 1:return XI(L.topRightBorderStroke,L.bottomRightBorderStroke);case 2:return XI(L.bottomRightBorderStroke,L.bottomLeftBorderStroke);case 3:default:return XI(L.bottomLeftBorderStroke,L.topLeftBorderStroke)}},XI=function(L,D){var F=[];return gA(L)?F.push(L.subdivide(.5,!1)):F.push(L),gA(D)?F.push(D.subdivide(.5,!0)):F.push(D),F},yA=function(L,D,F,k){var re=[];return gA(L)?re.push(L.subdivide(.5,!1)):re.push(L),gA(F)?re.push(F.subdivide(.5,!0)):re.push(F),gA(k)?re.push(k.subdivide(.5,!0).reverse()):re.push(k),gA(D)?re.push(D.subdivide(.5,!1).reverse()):re.push(D),re},WU=function(L){var D=L.bounds,F=L.styles;return D.add(F.borderLeftWidth,F.borderTopWidth,-(F.borderRightWidth+F.borderLeftWidth),-(F.borderTopWidth+F.borderBottomWidth))},qI=function(L){var D=L.styles,F=L.bounds,k=ns(D.paddingLeft,F.width),re=ns(D.paddingRight,F.width),ce=ns(D.paddingTop,F.width),xe=ns(D.paddingBottom,F.width);return F.add(k+D.borderLeftWidth,ce+D.borderTopWidth,-(D.borderRightWidth+D.borderLeftWidth+k+re),-(D.borderTopWidth+D.borderBottomWidth+ce+xe))},coe=function(L,D){return L===0?D.bounds:L===2?qI(D):WU(D)},uoe=function(L,D){return L===0?D.bounds:L===2?qI(D):WU(D)},BN=function(L,D,F){var k=coe(yx(L.styles.backgroundOrigin,D),L),re=uoe(yx(L.styles.backgroundClip,D),L),ce=hoe(yx(L.styles.backgroundSize,D),F,k),xe=ce[0],Re=ce[1],Ne=Dd(yx(L.styles.backgroundPosition,D),k.width-xe,k.height-Re),tt=doe(yx(L.styles.backgroundRepeat,D),Ne,ce,k,re),lt=Math.round(k.left+Ne[0]),St=Math.round(k.top+Ne[1]);return[tt,lt,St,xe,Re]},gx=function(L){return gi(L)&&L.value===xf.AUTO},WI=function(L){return typeof L=="number"},hoe=function(L,D,F){var k=D[0],re=D[1],ce=D[2],xe=L[0],Re=L[1];if(!xe)return[0,0];if(Ni(xe)&&Re&&Ni(Re))return[ns(xe,F.width),ns(Re,F.height)];var Ne=WI(ce);if(gi(xe)&&(xe.value===xf.CONTAIN||xe.value===xf.COVER)){if(WI(ce)){var tt=F.width/F.height;return tt<ce!=(xe.value===xf.COVER)?[F.width,F.width/ce]:[F.height*ce,F.height]}return[F.width,F.height]}var lt=WI(k),St=WI(re),Ht=lt||St;if(gx(xe)&&(!Re||gx(Re))){if(lt&&St)return[k,re];if(!Ne&&!Ht)return[F.width,F.height];if(Ht&&Ne){var Wr=lt?k:re*ce,Er=St?re:k/ce;return[Wr,Er]}var kr=lt?k:F.width,Sn=St?re:F.height;return[kr,Sn]}if(Ne){var yi=0,Ai=0;return Ni(xe)?yi=ns(xe,F.width):Ni(Re)&&(Ai=ns(Re,F.height)),gx(xe)?yi=Ai*ce:(!Re||gx(Re))&&(Ai=yi/ce),[yi,Ai]}var Fs=null,Rn=null;if(Ni(xe)?Fs=ns(xe,F.width):Re&&Ni(Re)&&(Rn=ns(Re,F.height)),Fs!==null&&(!Re||gx(Re))&&(Rn=lt&&St?Fs/k*re:F.height),Rn!==null&&gx(xe)&&(Fs=lt&&St?Rn/re*k:F.width),Fs!==null&&Rn!==null)return[Fs,Rn];throw new Error("Unable to calculate background-size for element")},yx=function(L,D){var F=L[D];return typeof F>"u"?L[0]:F},doe=function(L,D,F,k,re){var ce=D[0],xe=D[1],Re=F[0],Ne=F[1];switch(L){case 2:return[new Yr(Math.round(k.left),Math.round(k.top+xe)),new Yr(Math.round(k.left+k.width),Math.round(k.top+xe)),new Yr(Math.round(k.left+k.width),Math.round(Ne+k.top+xe)),new Yr(Math.round(k.left),Math.round(Ne+k.top+xe))];case 3:return[new Yr(Math.round(k.left+ce),Math.round(k.top)),new Yr(Math.round(k.left+ce+Re),Math.round(k.top)),new Yr(Math.round(k.left+ce+Re),Math.round(k.height+k.top)),new Yr(Math.round(k.left+ce),Math.round(k.height+k.top))];case 1:return[new Yr(Math.round(k.left+ce),Math.round(k.top+xe)),new Yr(Math.round(k.left+ce+Re),Math.round(k.top+xe)),new Yr(Math.round(k.left+ce+Re),Math.round(k.top+xe+Ne)),new Yr(Math.round(k.left+ce),Math.round(k.top+xe+Ne))];default:return[new Yr(Math.round(re.left),Math.round(re.top)),new Yr(Math.round(re.left+re.width),Math.round(re.top)),new Yr(Math.round(re.left+re.width),Math.round(re.height+re.top)),new Yr(Math.round(re.left),Math.round(re.height+re.top))]}},Aoe="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",KU="Hidden Text",foe=(function(){function L(D){this._data={},this._document=D}return L.prototype.parseMetrics=function(D,F){var k=this._document.createElement("div"),re=this._document.createElement("img"),ce=this._document.createElement("span"),xe=this._document.body;k.style.visibility="hidden",k.style.fontFamily=D,k.style.fontSize=F,k.style.margin="0",k.style.padding="0",k.style.whiteSpace="nowrap",xe.appendChild(k),re.src=Aoe,re.width=1,re.height=1,re.style.margin="0",re.style.padding="0",re.style.verticalAlign="baseline",ce.style.fontFamily=D,ce.style.fontSize=F,ce.style.margin="0",ce.style.padding="0",ce.appendChild(this._document.createTextNode(KU)),k.appendChild(ce),k.appendChild(re);var Re=re.offsetTop-ce.offsetTop+2;k.removeChild(ce),k.appendChild(this._document.createTextNode(KU)),k.style.lineHeight="normal",re.style.verticalAlign="super";var Ne=re.offsetTop-k.offsetTop+2;return xe.removeChild(k),{baseline:Re,middle:Ne}},L.prototype.getMetrics=function(D,F){var k=D+" "+F;return typeof this._data[k]>"u"&&(this._data[k]=this.parseMetrics(D,F)),this._data[k]},L})(),JU=(function(){function L(D,F){this.context=D,this.options=F}return L})(),poe=1e4,moe=(function(L){e(D,L);function D(F,k){var re=L.call(this,F,k)||this;return re._activeEffects=[],re.canvas=k.canvas?k.canvas:document.createElement("canvas"),re.ctx=re.canvas.getContext("2d"),k.canvas||(re.canvas.width=Math.floor(k.width*k.scale),re.canvas.height=Math.floor(k.height*k.scale),re.canvas.style.width=k.width+"px",re.canvas.style.height=k.height+"px"),re.fontMetrics=new foe(document),re.ctx.scale(re.options.scale,re.options.scale),re.ctx.translate(-k.x,-k.y),re.ctx.textBaseline="bottom",re._activeEffects=[],re.context.logger.debug("Canvas renderer initialized ("+k.width+"x"+k.height+") with scale "+k.scale),re}return D.prototype.applyEffects=function(F){for(var k=this;this._activeEffects.length;)this.popEffect();F.forEach(function(re){return k.applyEffect(re)})},D.prototype.applyEffect=function(F){this.ctx.save(),ioe(F)&&(this.ctx.globalAlpha=F.opacity),roe(F)&&(this.ctx.translate(F.offsetX,F.offsetY),this.ctx.transform(F.matrix[0],F.matrix[1],F.matrix[2],F.matrix[3],F.matrix[4],F.matrix[5]),this.ctx.translate(-F.offsetX,-F.offsetY)),VU(F)&&(this.path(F.path),this.ctx.clip()),this._activeEffects.push(F)},D.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},D.prototype.renderStack=function(F){return i(this,void 0,void 0,function(){var k;return n(this,function(re){switch(re.label){case 0:return k=F.element.container.styles,k.isVisible()?[4,this.renderStackContent(F)]:[3,2];case 1:re.sent(),re.label=2;case 2:return[2]}})})},D.prototype.renderNode=function(F){return i(this,void 0,void 0,function(){return n(this,function(k){switch(k.label){case 0:if(At(F.container.flags,16))debugger;return F.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(F)]:[3,3];case 1:return k.sent(),[4,this.renderNodeContent(F)];case 2:k.sent(),k.label=3;case 3:return[2]}})})},D.prototype.renderTextWithLetterSpacing=function(F,k,re){var ce=this;if(k===0)this.ctx.fillText(F.text,F.bounds.left,F.bounds.top+re);else{var xe=Rm(F.text);xe.reduce(function(Re,Ne){return ce.ctx.fillText(Ne,Re,F.bounds.top+re),Re+ce.ctx.measureText(Ne).width},F.bounds.left)}},D.prototype.createFontStyle=function(F){var k=F.fontVariant.filter(function(xe){return xe==="normal"||xe==="small-caps"}).join(""),re=Eoe(F.fontFamily).join(", "),ce=Si(F.fontSize)?""+F.fontSize.number+F.fontSize.unit:F.fontSize.number+"px";return[[F.fontStyle,k,F.fontWeight,ce,re].join(" "),re,ce]},D.prototype.renderTextNode=function(F,k){return i(this,void 0,void 0,function(){var re,ce,xe,Re,Ne,tt,lt,St,Ht=this;return n(this,function(Wr){return re=this.createFontStyle(k),ce=re[0],xe=re[1],Re=re[2],this.ctx.font=ce,this.ctx.direction=k.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",Ne=this.fontMetrics.getMetrics(xe,Re),tt=Ne.baseline,lt=Ne.middle,St=k.paintOrder,F.textBounds.forEach(function(Er){St.forEach(function(kr){switch(kr){case 0:Ht.ctx.fillStyle=Oa(k.color),Ht.renderTextWithLetterSpacing(Er,k.letterSpacing,tt);var Sn=k.textShadow;Sn.length&&Er.text.trim().length&&(Sn.slice(0).reverse().forEach(function(yi){Ht.ctx.shadowColor=Oa(yi.color),Ht.ctx.shadowOffsetX=yi.offsetX.number*Ht.options.scale,Ht.ctx.shadowOffsetY=yi.offsetY.number*Ht.options.scale,Ht.ctx.shadowBlur=yi.blur.number,Ht.renderTextWithLetterSpacing(Er,k.letterSpacing,tt)}),Ht.ctx.shadowColor="",Ht.ctx.shadowOffsetX=0,Ht.ctx.shadowOffsetY=0,Ht.ctx.shadowBlur=0),k.textDecorationLine.length&&(Ht.ctx.fillStyle=Oa(k.textDecorationColor||k.color),k.textDecorationLine.forEach(function(yi){switch(yi){case 1:Ht.ctx.fillRect(Er.bounds.left,Math.round(Er.bounds.top+tt),Er.bounds.width,1);break;case 2:Ht.ctx.fillRect(Er.bounds.left,Math.round(Er.bounds.top),Er.bounds.width,1);break;case 3:Ht.ctx.fillRect(Er.bounds.left,Math.ceil(Er.bounds.top+lt),Er.bounds.width,1);break}}));break;case 1:k.webkitTextStrokeWidth&&Er.text.trim().length&&(Ht.ctx.strokeStyle=Oa(k.webkitTextStrokeColor),Ht.ctx.lineWidth=k.webkitTextStrokeWidth,Ht.ctx.lineJoin=window.chrome?"miter":"round",Ht.ctx.strokeText(Er.text,Er.bounds.left,Er.bounds.top+tt)),Ht.ctx.strokeStyle="",Ht.ctx.lineWidth=0,Ht.ctx.lineJoin="miter";break}})}),[2]})})},D.prototype.renderReplacedElement=function(F,k,re){if(re&&F.intrinsicWidth>0&&F.intrinsicHeight>0){var ce=qI(F),xe=QI(k);this.path(xe),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(re,0,0,F.intrinsicWidth,F.intrinsicHeight,ce.left,ce.top,ce.width,ce.height),this.ctx.restore()}},D.prototype.renderNodeContent=function(F){return i(this,void 0,void 0,function(){var k,re,ce,xe,Re,Ne,Ai,Ai,tt,lt,St,Ht,Rn,Wr,Er,en,kr,Sn,yi,Ai,Fs,Rn,en;return n(this,function(zr){switch(zr.label){case 0:this.applyEffects(F.getEffects(4)),k=F.container,re=F.curves,ce=k.styles,xe=0,Re=k.textNodes,zr.label=1;case 1:return xe<Re.length?(Ne=Re[xe],[4,this.renderTextNode(Ne,ce)]):[3,4];case 2:zr.sent(),zr.label=3;case 3:return xe++,[3,1];case 4:if(!(k instanceof MI))return[3,8];zr.label=5;case 5:return zr.trys.push([5,7,,8]),[4,this.context.cache.match(k.src)];case 6:return Ai=zr.sent(),this.renderReplacedElement(k,re,Ai),[3,8];case 7:return zr.sent(),this.context.logger.error("Error loading image "+k.src),[3,8];case 8:if(k instanceof hx&&this.renderReplacedElement(k,re,k.canvas),!(k instanceof dx))return[3,12];zr.label=9;case 9:return zr.trys.push([9,11,,12]),[4,this.context.cache.match(k.svg)];case 10:return Ai=zr.sent(),this.renderReplacedElement(k,re,Ai),[3,12];case 11:return zr.sent(),this.context.logger.error("Error loading svg "+k.svg.substring(0,255)),[3,12];case 12:return k instanceof wU&&k.tree?(tt=new D(this.context,{scale:this.options.scale,backgroundColor:k.backgroundColor,x:0,y:0,width:k.width,height:k.height}),[4,tt.render(k.tree)]):[3,14];case 13:lt=zr.sent(),k.width&&k.height&&this.ctx.drawImage(lt,0,0,k.width,k.height,k.bounds.left,k.bounds.top,k.bounds.width,k.bounds.height),zr.label=14;case 14:if(k instanceof gN&&(St=Math.min(k.bounds.width,k.bounds.height),k.type===kI?k.checked&&(this.ctx.save(),this.path([new Yr(k.bounds.left+St*.39363,k.bounds.top+St*.79),new Yr(k.bounds.left+St*.16,k.bounds.top+St*.5549),new Yr(k.bounds.left+St*.27347,k.bounds.top+St*.44071),new Yr(k.bounds.left+St*.39694,k.bounds.top+St*.5649),new Yr(k.bounds.left+St*.72983,k.bounds.top+St*.23),new Yr(k.bounds.left+St*.84,k.bounds.top+St*.34085),new Yr(k.bounds.left+St*.39363,k.bounds.top+St*.79)]),this.ctx.fillStyle=Oa(bU),this.ctx.fill(),this.ctx.restore()):k.type===FI&&k.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(k.bounds.left+St/2,k.bounds.top+St/2,St/4,0,Math.PI*2,!0),this.ctx.fillStyle=Oa(bU),this.ctx.fill(),this.ctx.restore())),goe(k)&&k.value.length){switch(Ht=this.createFontStyle(ce),Rn=Ht[0],Wr=Ht[1],Er=this.fontMetrics.getMetrics(Rn,Wr).baseline,this.ctx.font=Rn,this.ctx.fillStyle=Oa(ce.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=boe(k.styles.textAlign),en=qI(k),kr=0,k.styles.textAlign){case 1:kr+=en.width/2;break;case 2:kr+=en.width;break}Sn=en.add(kr,0,0,-en.height/2+1),this.ctx.save(),this.path([new Yr(en.left,en.top),new Yr(en.left+en.width,en.top),new Yr(en.left+en.width,en.top+en.height),new Yr(en.left,en.top+en.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new u0(k.value,Sn),ce.letterSpacing,Er),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!At(k.styles.display,2048))return[3,20];if(k.styles.listStyleImage===null)return[3,19];if(yi=k.styles.listStyleImage,yi.type!==0)return[3,18];Ai=void 0,Fs=yi.url,zr.label=15;case 15:return zr.trys.push([15,17,,18]),[4,this.context.cache.match(Fs)];case 16:return Ai=zr.sent(),this.ctx.drawImage(Ai,k.bounds.left-(Ai.width+10),k.bounds.top),[3,18];case 17:return zr.sent(),this.context.logger.error("Error loading list-style-image "+Fs),[3,18];case 18:return[3,20];case 19:F.listValue&&k.styles.listStyleType!==-1&&(Rn=this.createFontStyle(ce)[0],this.ctx.font=Rn,this.ctx.fillStyle=Oa(ce.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",en=new a(k.bounds.left,k.bounds.top+ns(k.styles.paddingTop,k.bounds.width),k.bounds.width,mI(ce.lineHeight,ce.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new u0(F.listValue,en),ce.letterSpacing,mI(ce.lineHeight,ce.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),zr.label=20;case 20:return[2]}})})},D.prototype.renderStackContent=function(F){return i(this,void 0,void 0,function(){var k,re,yi,ce,xe,yi,Re,Ne,yi,tt,lt,yi,St,Ht,yi,Wr,Er,yi,kr,Sn,yi;return n(this,function(Ai){switch(Ai.label){case 0:if(At(F.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(F.element)];case 1:Ai.sent(),k=0,re=F.negativeZIndex,Ai.label=2;case 2:return k<re.length?(yi=re[k],[4,this.renderStack(yi)]):[3,5];case 3:Ai.sent(),Ai.label=4;case 4:return k++,[3,2];case 5:return[4,this.renderNodeContent(F.element)];case 6:Ai.sent(),ce=0,xe=F.nonInlineLevel,Ai.label=7;case 7:return ce<xe.length?(yi=xe[ce],[4,this.renderNode(yi)]):[3,10];case 8:Ai.sent(),Ai.label=9;case 9:return ce++,[3,7];case 10:Re=0,Ne=F.nonPositionedFloats,Ai.label=11;case 11:return Re<Ne.length?(yi=Ne[Re],[4,this.renderStack(yi)]):[3,14];case 12:Ai.sent(),Ai.label=13;case 13:return Re++,[3,11];case 14:tt=0,lt=F.nonPositionedInlineLevel,Ai.label=15;case 15:return tt<lt.length?(yi=lt[tt],[4,this.renderStack(yi)]):[3,18];case 16:Ai.sent(),Ai.label=17;case 17:return tt++,[3,15];case 18:St=0,Ht=F.inlineLevel,Ai.label=19;case 19:return St<Ht.length?(yi=Ht[St],[4,this.renderNode(yi)]):[3,22];case 20:Ai.sent(),Ai.label=21;case 21:return St++,[3,19];case 22:Wr=0,Er=F.zeroOrAutoZIndexOrTransformedOrOpacity,Ai.label=23;case 23:return Wr<Er.length?(yi=Er[Wr],[4,this.renderStack(yi)]):[3,26];case 24:Ai.sent(),Ai.label=25;case 25:return Wr++,[3,23];case 26:kr=0,Sn=F.positiveZIndex,Ai.label=27;case 27:return kr<Sn.length?(yi=Sn[kr],[4,this.renderStack(yi)]):[3,30];case 28:Ai.sent(),Ai.label=29;case 29:return kr++,[3,27];case 30:return[2]}})})},D.prototype.mask=function(F){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(F.slice(0).reverse()),this.ctx.closePath()},D.prototype.path=function(F){this.ctx.beginPath(),this.formatPath(F),this.ctx.closePath()},D.prototype.formatPath=function(F){var k=this;F.forEach(function(re,ce){var xe=gA(re)?re.start:re;ce===0?k.ctx.moveTo(xe.x,xe.y):k.ctx.lineTo(xe.x,xe.y),gA(re)&&k.ctx.bezierCurveTo(re.startControl.x,re.startControl.y,re.endControl.x,re.endControl.y,re.end.x,re.end.y)})},D.prototype.renderRepeat=function(F,k,re,ce){this.path(F),this.ctx.fillStyle=k,this.ctx.translate(re,ce),this.ctx.fill(),this.ctx.translate(-re,-ce)},D.prototype.resizeImage=function(F,k,re){var ce;if(F.width===k&&F.height===re)return F;var xe=(ce=this.canvas.ownerDocument)!==null&&ce!==void 0?ce:document,Re=xe.createElement("canvas");Re.width=Math.max(1,k),Re.height=Math.max(1,re);var Ne=Re.getContext("2d");return Ne.drawImage(F,0,0,F.width,F.height,0,0,k,re),Re},D.prototype.renderBackgroundImage=function(F){return i(this,void 0,void 0,function(){var k,re,ce,xe,Re,Ne;return n(this,function(tt){switch(tt.label){case 0:k=F.styles.backgroundImage.length-1,re=function(lt){var St,Ht,Wr,Nl,Yh,Vh,Na,Jc,Es,Er,Nl,Yh,Vh,Na,Jc,kr,Sn,yi,Ai,Fs,Rn,en,zr,xs,Es,on,Nl,Gh,Od,Na,Jc,A0,Yh,Vh,Ky,_p,f0,Jy,$y,km,Zy,Fm;return n(this,function(bx){switch(bx.label){case 0:if(lt.type!==0)return[3,5];St=void 0,Ht=lt.url,bx.label=1;case 1:return bx.trys.push([1,3,,4]),[4,ce.context.cache.match(Ht)];case 2:return St=bx.sent(),[3,4];case 3:return bx.sent(),ce.context.logger.error("Error loading background-image "+Ht),[3,4];case 4:return St&&(Wr=BN(F,k,[St.width,St.height,St.width/St.height]),Nl=Wr[0],Yh=Wr[1],Vh=Wr[2],Na=Wr[3],Jc=Wr[4],Es=ce.ctx.createPattern(ce.resizeImage(St,Na,Jc),"repeat"),ce.renderRepeat(Nl,Es,Yh,Vh)),[3,6];case 5:cI(lt)?(Er=BN(F,k,[null,null,null]),Nl=Er[0],Yh=Er[1],Vh=Er[2],Na=Er[3],Jc=Er[4],kr=Gi(lt.angle,Na,Jc),Sn=kr[0],yi=kr[1],Ai=kr[2],Fs=kr[3],Rn=kr[4],en=document.createElement("canvas"),en.width=Na,en.height=Jc,zr=en.getContext("2d"),xs=zr.createLinearGradient(yi,Fs,Ai,Rn),Zr(lt.stops,Sn).forEach(function(Ww){return xs.addColorStop(Ww.stop,Oa(Ww.color))}),zr.fillStyle=xs,zr.fillRect(0,0,Na,Jc),Na>0&&Jc>0&&(Es=ce.ctx.createPattern(en,"repeat"),ce.renderRepeat(Nl,Es,Yh,Vh))):uI(lt)&&(on=BN(F,k,[null,null,null]),Nl=on[0],Gh=on[1],Od=on[2],Na=on[3],Jc=on[4],A0=lt.position.length===0?[Wc]:lt.position,Yh=ns(A0[0],Na),Vh=ns(A0[A0.length-1],Jc),Ky=an(lt,Yh,Vh,Na,Jc),_p=Ky[0],f0=Ky[1],_p>0&&f0>0&&(Jy=ce.ctx.createRadialGradient(Gh+Yh,Od+Vh,0,Gh+Yh,Od+Vh,_p),Zr(lt.stops,_p*2).forEach(function(Ww){return Jy.addColorStop(Ww.stop,Oa(Ww.color))}),ce.path(Nl),ce.ctx.fillStyle=Jy,_p!==f0?($y=F.bounds.left+.5*F.bounds.width,km=F.bounds.top+.5*F.bounds.height,Zy=f0/_p,Fm=1/Zy,ce.ctx.save(),ce.ctx.translate($y,km),ce.ctx.transform(1,0,0,Zy,0,0),ce.ctx.translate(-$y,-km),ce.ctx.fillRect(Gh,Fm*(Od-km)+km,Na,Jc*Fm),ce.ctx.restore()):ce.ctx.fill())),bx.label=6;case 6:return k--,[2]}})},ce=this,xe=0,Re=F.styles.backgroundImage.slice(0).reverse(),tt.label=1;case 1:return xe<Re.length?(Ne=Re[xe],[5,re(Ne)]):[3,4];case 2:tt.sent(),tt.label=3;case 3:return xe++,[3,1];case 4:return[2]}})})},D.prototype.renderSolidBorder=function(F,k,re){return i(this,void 0,void 0,function(){return n(this,function(ce){return this.path(qU(re,k)),this.ctx.fillStyle=Oa(F),this.ctx.fill(),[2]})})},D.prototype.renderDoubleBorder=function(F,k,re,ce){return i(this,void 0,void 0,function(){var xe,Re;return n(this,function(Ne){switch(Ne.label){case 0:return k<3?[4,this.renderSolidBorder(F,re,ce)]:[3,2];case 1:return Ne.sent(),[2];case 2:return xe=aoe(ce,re),this.path(xe),this.ctx.fillStyle=Oa(F),this.ctx.fill(),Re=ooe(ce,re),this.path(Re),this.ctx.fill(),[2]}})})},D.prototype.renderNodeBackgroundAndBorders=function(F){return i(this,void 0,void 0,function(){var k,re,ce,xe,Re,Ne,tt,lt,St=this;return n(this,function(Ht){switch(Ht.label){case 0:return this.applyEffects(F.getEffects(2)),k=F.container.styles,re=!ro(k.backgroundColor)||k.backgroundImage.length,ce=[{style:k.borderTopStyle,color:k.borderTopColor,width:k.borderTopWidth},{style:k.borderRightStyle,color:k.borderRightColor,width:k.borderRightWidth},{style:k.borderBottomStyle,color:k.borderBottomColor,width:k.borderBottomWidth},{style:k.borderLeftStyle,color:k.borderLeftColor,width:k.borderLeftWidth}],xe=yoe(yx(k.backgroundClip,0),F.curves),re||k.boxShadow.length?(this.ctx.save(),this.path(xe),this.ctx.clip(),ro(k.backgroundColor)||(this.ctx.fillStyle=Oa(k.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(F.container)]):[3,2];case 1:Ht.sent(),this.ctx.restore(),k.boxShadow.slice(0).reverse().forEach(function(Wr){St.ctx.save();var Er=jI(F.curves),kr=Wr.inset?0:poe,Sn=noe(Er,-kr+(Wr.inset?1:-1)*Wr.spread.number,(Wr.inset?1:-1)*Wr.spread.number,Wr.spread.number*(Wr.inset?-2:2),Wr.spread.number*(Wr.inset?-2:2));Wr.inset?(St.path(Er),St.ctx.clip(),St.mask(Sn)):(St.mask(Er),St.ctx.clip(),St.path(Sn)),St.ctx.shadowOffsetX=Wr.offsetX.number+kr,St.ctx.shadowOffsetY=Wr.offsetY.number,St.ctx.shadowColor=Oa(Wr.color),St.ctx.shadowBlur=Wr.blur.number,St.ctx.fillStyle=Wr.inset?Oa(Wr.color):"rgba(0,0,0,1)",St.ctx.fill(),St.ctx.restore()}),Ht.label=2;case 2:Re=0,Ne=0,tt=ce,Ht.label=3;case 3:return Ne<tt.length?(lt=tt[Ne],lt.style!==0&&!ro(lt.color)&&lt.width>0?lt.style!==2?[3,5]:[4,this.renderDashedDottedBorder(lt.color,lt.width,Re,F.curves,2)]:[3,11]):[3,13];case 4:return Ht.sent(),[3,11];case 5:return lt.style!==3?[3,7]:[4,this.renderDashedDottedBorder(lt.color,lt.width,Re,F.curves,3)];case 6:return Ht.sent(),[3,11];case 7:return lt.style!==4?[3,9]:[4,this.renderDoubleBorder(lt.color,lt.width,Re,F.curves)];case 8:return Ht.sent(),[3,11];case 9:return[4,this.renderSolidBorder(lt.color,Re,F.curves)];case 10:Ht.sent(),Ht.label=11;case 11:Re++,Ht.label=12;case 12:return Ne++,[3,3];case 13:return[2]}})})},D.prototype.renderDashedDottedBorder=function(F,k,re,ce,xe){return i(this,void 0,void 0,function(){var Re,Ne,tt,lt,St,Ht,Wr,Er,kr,Sn,yi,Ai,Fs,Rn,en,zr,en,zr;return n(this,function(xs){return this.ctx.save(),Re=loe(ce,re),Ne=qU(ce,re),xe===2&&(this.path(Ne),this.ctx.clip()),gA(Ne[0])?(tt=Ne[0].start.x,lt=Ne[0].start.y):(tt=Ne[0].x,lt=Ne[0].y),gA(Ne[1])?(St=Ne[1].end.x,Ht=Ne[1].end.y):(St=Ne[1].x,Ht=Ne[1].y),re===0||re===2?Wr=Math.abs(tt-St):Wr=Math.abs(lt-Ht),this.ctx.beginPath(),xe===3?this.formatPath(Re):this.formatPath(Ne.slice(0,2)),Er=k<3?k*3:k*2,kr=k<3?k*2:k,xe===3&&(Er=k,kr=k),Sn=!0,Wr<=Er*2?Sn=!1:Wr<=Er*2+kr?(yi=Wr/(2*Er+kr),Er*=yi,kr*=yi):(Ai=Math.floor((Wr+kr)/(Er+kr)),Fs=(Wr-Ai*Er)/(Ai-1),Rn=(Wr-(Ai+1)*Er)/Ai,kr=Rn<=0||Math.abs(kr-Fs)<Math.abs(kr-Rn)?Fs:Rn),Sn&&(xe===3?this.ctx.setLineDash([0,Er+kr]):this.ctx.setLineDash([Er,kr])),xe===3?(this.ctx.lineCap="round",this.ctx.lineWidth=k):this.ctx.lineWidth=k*2+1.1,this.ctx.strokeStyle=Oa(F),this.ctx.stroke(),this.ctx.setLineDash([]),xe===2&&(gA(Ne[0])&&(en=Ne[3],zr=Ne[0],this.ctx.beginPath(),this.formatPath([new Yr(en.end.x,en.end.y),new Yr(zr.start.x,zr.start.y)]),this.ctx.stroke()),gA(Ne[1])&&(en=Ne[1],zr=Ne[2],this.ctx.beginPath(),this.formatPath([new Yr(en.end.x,en.end.y),new Yr(zr.start.x,zr.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},D.prototype.render=function(F){return i(this,void 0,void 0,function(){var k;return n(this,function(re){switch(re.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Oa(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),k=soe(F),[4,this.renderStack(k)];case 1:return re.sent(),this.applyEffects([]),[2,this.canvas]}})})},D})(JU),goe=function(L){return L instanceof EU||L instanceof xU?!0:L instanceof gN&&L.type!==FI&&L.type!==kI},yoe=function(L,D){switch(L){case 0:return jI(D);case 2:return Zae(D);case 1:default:return QI(D)}},boe=function(L){switch(L){case 1:return"center";case 2:return"right";case 0:default:return"left"}},xoe=["-apple-system","system-ui"],Eoe=function(L){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?L.filter(function(D){return xoe.indexOf(D)===-1}):L},woe=(function(L){e(D,L);function D(F,k){var re=L.call(this,F,k)||this;return re.canvas=k.canvas?k.canvas:document.createElement("canvas"),re.ctx=re.canvas.getContext("2d"),re.options=k,re.canvas.width=Math.floor(k.width*k.scale),re.canvas.height=Math.floor(k.height*k.scale),re.canvas.style.width=k.width+"px",re.canvas.style.height=k.height+"px",re.ctx.scale(re.options.scale,re.options.scale),re.ctx.translate(-k.x,-k.y),re.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+k.width+"x"+k.height+" at "+k.x+","+k.y+") with scale "+k.scale),re}return D.prototype.render=function(F){return i(this,void 0,void 0,function(){var k,re;return n(this,function(ce){switch(ce.label){case 0:return k=lx(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,F),[4,voe(k)];case 1:return re=ce.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Oa(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(re,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},D})(JU),voe=function(L){return new Promise(function(D,F){var k=new Image;k.onload=function(){D(k)},k.onerror=F,k.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(L))})},Coe=(function(){function L(D){var F=D.id,k=D.enabled;this.id=F,this.enabled=k,this.start=Date.now()}return L.prototype.debug=function(){for(var D=[],F=0;F<arguments.length;F++)D[F]=arguments[F];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,s([this.id,this.getTime()+"ms"],D)):this.info.apply(this,D))},L.prototype.getTime=function(){return Date.now()-this.start},L.prototype.info=function(){for(var D=[],F=0;F<arguments.length;F++)D[F]=arguments[F];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,s([this.id,this.getTime()+"ms"],D))},L.prototype.warn=function(){for(var D=[],F=0;F<arguments.length;F++)D[F]=arguments[F];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,s([this.id,this.getTime()+"ms"],D)):this.info.apply(this,D))},L.prototype.error=function(){for(var D=[],F=0;F<arguments.length;F++)D[F]=arguments[F];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,s([this.id,this.getTime()+"ms"],D)):this.info.apply(this,D))},L.instances={},L})(),Soe=(function(){function L(D,F){var k;this.windowBounds=F,this.instanceName="#"+L.instanceCount++,this.logger=new Coe({id:this.instanceName,enabled:D.logging}),this.cache=(k=D.cache)!==null&&k!==void 0?k:new Qae(this,D)}return L.instanceCount=1,L})(),Toe=function(L,D){return D===void 0&&(D={}),Ioe(L,D)};typeof window<"u"&&YU.setContext(window);var Ioe=function(L,D){return i(void 0,void 0,void 0,function(){var F,k,re,ce,xe,Re,Ne,tt,lt,St,Ht,Wr,Er,kr,Sn,yi,Ai,Fs,Rn,en,xs,zr,xs,Es,on,Nl,Gh,Od,Na,Jc,A0,Yh,Vh,Ky,_p,f0,Jy,$y,km,Zy;return n(this,function(Fm){switch(Fm.label){case 0:if(!L||typeof L!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(F=L.ownerDocument,!F)throw new Error("Element is not attached to a Document");if(k=F.defaultView,!k)throw new Error("Document is not attached to a Window");return re={allowTaint:(Es=D.allowTaint)!==null&&Es!==void 0?Es:!1,imageTimeout:(on=D.imageTimeout)!==null&&on!==void 0?on:15e3,proxy:D.proxy,useCORS:(Nl=D.useCORS)!==null&&Nl!==void 0?Nl:!1},ce=r({logging:(Gh=D.logging)!==null&&Gh!==void 0?Gh:!0,cache:D.cache},re),xe={windowWidth:(Od=D.windowWidth)!==null&&Od!==void 0?Od:k.innerWidth,windowHeight:(Na=D.windowHeight)!==null&&Na!==void 0?Na:k.innerHeight,scrollX:(Jc=D.scrollX)!==null&&Jc!==void 0?Jc:k.pageXOffset,scrollY:(A0=D.scrollY)!==null&&A0!==void 0?A0:k.pageYOffset},Re=new a(xe.scrollX,xe.scrollY,xe.windowWidth,xe.windowHeight),Ne=new Soe(ce,Re),tt=(Yh=D.foreignObjectRendering)!==null&&Yh!==void 0?Yh:!1,lt={allowTaint:(Vh=D.allowTaint)!==null&&Vh!==void 0?Vh:!1,onclone:D.onclone,ignoreElements:D.ignoreElements,inlineImages:tt,copyStyles:tt},Ne.logger.debug("Starting document clone with size "+Re.width+"x"+Re.height+" scrolled to "+-Re.left+","+-Re.top),St=new HU(Ne,L,lt),Ht=St.clonedReferenceElement,Ht?[4,St.toIFrame(F,Re)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return Wr=Fm.sent(),Er=bN(Ht)||Bae(Ht)?l(Ht.ownerDocument):o(Ne,Ht),kr=Er.width,Sn=Er.height,yi=Er.left,Ai=Er.top,Fs=Boe(Ne,Ht,D.backgroundColor),Rn={canvas:D.canvas,backgroundColor:Fs,scale:(_p=(Ky=D.scale)!==null&&Ky!==void 0?Ky:k.devicePixelRatio)!==null&&_p!==void 0?_p:1,x:((f0=D.x)!==null&&f0!==void 0?f0:0)+yi,y:((Jy=D.y)!==null&&Jy!==void 0?Jy:0)+Ai,width:($y=D.width)!==null&&$y!==void 0?$y:Math.ceil(kr),height:(km=D.height)!==null&&km!==void 0?km:Math.ceil(Sn)},tt?(Ne.logger.debug("Document cloned, using foreign object rendering"),xs=new woe(Ne,Rn),[4,xs.render(Ht)]):[3,3];case 2:return en=Fm.sent(),[3,5];case 3:return Ne.logger.debug("Document cloned, element located at "+yi+","+Ai+" with size "+kr+"x"+Sn+" using computed rendering"),Ne.logger.debug("Starting DOM parsing"),zr=CU(Ne,Ht),Fs===zr.styles.backgroundColor&&(zr.styles.backgroundColor=Tt.TRANSPARENT),Ne.logger.debug("Starting renderer for element at "+Rn.x+","+Rn.y+" with size "+Rn.width+"x"+Rn.height),xs=new moe(Ne,Rn),[4,xs.render(zr)];case 4:en=Fm.sent(),Fm.label=5;case 5:return(!((Zy=D.removeContainer)!==null&&Zy!==void 0)||Zy)&&(HU.destroy(Wr)||Ne.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),Ne.logger.debug("Finished rendering"),[2,en]}})})},Boe=function(L,D,F){var k=D.ownerDocument,re=k.documentElement?mt(L,getComputedStyle(k.documentElement).backgroundColor):Tt.TRANSPARENT,ce=k.body?mt(L,getComputedStyle(k.body).backgroundColor):Tt.TRANSPARENT,xe=typeof F=="string"?mt(L,F):F===null?Tt.TRANSPARENT:4294967295;return D===k.documentElement?ro(re)?ro(ce)?xe:ce:re:xe};return Toe}))});var t$=yt((D8,_8)=>{(function(t,e){typeof D8=="object"&&typeof _8<"u"?_8.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self,t.DOMPurify=e())})(D8,(function(){"use strict";function t(Lt){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ct){return typeof ct}:function(ct){return ct&&typeof Symbol=="function"&&ct.constructor===Symbol&&ct!==Symbol.prototype?"symbol":typeof ct},t(Lt)}function e(Lt,ct){return e=Object.setPrototypeOf||function(Jt,O){return Jt.__proto__=O,Jt},e(Lt,ct)}function r(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function i(Lt,ct,Zt){return r()?i=Reflect.construct:i=function(O,K,se){var ae=[null];ae.push.apply(ae,K);var ue=Function.bind.apply(O,ae),Ie=new ue;return se&&e(Ie,se.prototype),Ie},i.apply(null,arguments)}function n(Lt){return s(Lt)||a(Lt)||o(Lt)||c()}function s(Lt){if(Array.isArray(Lt))return l(Lt)}function a(Lt){if(typeof Symbol<"u"&&Lt[Symbol.iterator]!=null||Lt["@@iterator"]!=null)return Array.from(Lt)}function o(Lt,ct){if(Lt){if(typeof Lt=="string")return l(Lt,ct);var Zt=Object.prototype.toString.call(Lt).slice(8,-1);if(Zt==="Object"&&Lt.constructor&&(Zt=Lt.constructor.name),Zt==="Map"||Zt==="Set")return Array.from(Lt);if(Zt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Zt))return l(Lt,ct)}}function l(Lt,ct){(ct==null||ct>Lt.length)&&(ct=Lt.length);for(var Zt=0,Jt=new Array(ct);Zt<ct;Zt++)Jt[Zt]=Lt[Zt];return Jt}function c(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u=Object.hasOwnProperty,d=Object.setPrototypeOf,A=Object.isFrozen,h=Object.getPrototypeOf,f=Object.getOwnPropertyDescriptor,p=Object.freeze,m=Object.seal,y=Object.create,g=typeof Reflect<"u"&&Reflect,b=g.apply,E=g.construct;b||(b=function(ct,Zt,Jt){return ct.apply(Zt,Jt)}),p||(p=function(ct){return ct}),m||(m=function(ct){return ct}),E||(E=function(ct,Zt){return i(ct,n(Zt))});var w=B(Array.prototype.forEach),x=B(Array.prototype.pop),I=B(Array.prototype.push),C=B(String.prototype.toLowerCase),G=B(String.prototype.toString),U=B(String.prototype.match),_=B(String.prototype.replace),H=B(String.prototype.indexOf),Q=B(String.prototype.trim),j=B(RegExp.prototype.test),$=M(TypeError);function B(Lt){return function(ct){for(var Zt=arguments.length,Jt=new Array(Zt>1?Zt-1:0),O=1;O<Zt;O++)Jt[O-1]=arguments[O];return b(Lt,ct,Jt)}}function M(Lt){return function(){for(var ct=arguments.length,Zt=new Array(ct),Jt=0;Jt<ct;Jt++)Zt[Jt]=arguments[Jt];return E(Lt,Zt)}}function v(Lt,ct,Zt){var Jt;Zt=(Jt=Zt)!==null&&Jt!==void 0?Jt:C,d&&d(Lt,null);for(var O=ct.length;O--;){var K=ct[O];if(typeof K=="string"){var se=Zt(K);se!==K&&(A(ct)||(ct[O]=se),K=se)}Lt[K]=!0}return Lt}function N(Lt){var ct=y(null),Zt;for(Zt in Lt)b(u,Lt,[Zt])===!0&&(ct[Zt]=Lt[Zt]);return ct}function R(Lt,ct){for(;Lt!==null;){var Zt=f(Lt,ct);if(Zt){if(Zt.get)return B(Zt.get);if(typeof Zt.value=="function")return B(Zt.value)}Lt=h(Lt)}function Jt(O){return console.warn("fallback value for",O),null}return Jt}var q=p(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),P=p(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),z=p(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),W=p(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),oe=p(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Ae=p(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),me=p(["#text"]),ve=p(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Le=p(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),He=p(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),rt=p(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),qe=m(/\{\{[\w\W]*|[\w\W]*\}\}/gm),xt=m(/<%[\w\W]*|[\w\W]*%>/gm),Gt=m(/\${[\w\W]*}/gm),ut=m(/^data-[\-\w.\u00B7-\uFFFF]/),Pe=m(/^aria-[\-\w]+$/),ft=m(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ht=m(/^(?:\w+script|data):/i),Qt=m(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Yt=m(/^html$/i),Ft=m(/^[a-z][.\w]*(-[.\w]+)+$/i),kt=function(){return typeof window>"u"?null:window},sr=function(ct,Zt){if(t(ct)!=="object"||typeof ct.createPolicy!="function")return null;var Jt=null,O="data-tt-policy-suffix";Zt.currentScript&&Zt.currentScript.hasAttribute(O)&&(Jt=Zt.currentScript.getAttribute(O));var K="dompurify"+(Jt?"#"+Jt:"");try{return ct.createPolicy(K,{createHTML:function(ae){return ae},createScriptURL:function(ae){return ae}})}catch{return console.warn("TrustedTypes policy "+K+" could not be created."),null}};function Pt(){var Lt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:kt(),ct=function($e){return Pt($e)};if(ct.version="2.5.5",ct.removed=[],!Lt||!Lt.document||Lt.document.nodeType!==9)return ct.isSupported=!1,ct;var Zt=Lt.document,Jt=Lt.document,O=Lt.DocumentFragment,K=Lt.HTMLTemplateElement,se=Lt.Node,ae=Lt.Element,ue=Lt.NodeFilter,Ie=Lt.NamedNodeMap,Ce=Ie===void 0?Lt.NamedNodeMap||Lt.MozNamedAttrMap:Ie,st=Lt.HTMLFormElement,it=Lt.DOMParser,Kt=Lt.trustedTypes,ar=ae.prototype,lr=R(ar,"cloneNode"),yr=R(ar,"nextSibling"),xi=R(ar,"childNodes"),Tr=R(ar,"parentNode");if(typeof K=="function"){var ii=Jt.createElement("template");ii.content&&ii.content.ownerDocument&&(Jt=ii.content.ownerDocument)}var nn=sr(Kt,Zt),sn=nn?nn.createHTML(""):"",Dn=Jt,Za=Dn.implementation,ai=Dn.createNodeIterator,xa=Dn.createDocumentFragment,Lr=Dn.getElementsByTagName,mn=Zt.importNode,bs={};try{bs=N(Jt).documentMode?Jt.documentMode:{}}catch{}var Zi={};ct.isSupported=typeof Tr=="function"&&Za&&Za.createHTMLDocument!==void 0&&bs!==9;var Do=qe,Su=xt,gc=Gt,jc=ut,ec=Pe,Qc=ht,Uo=Qt,ul=Ft,hl=ft,Ms=null,Tu=v({},[].concat(n(q),n(P),n(z),n(oe),n(me))),ha=null,Sd=v({},[].concat(n(ve),n(Le),n(He),n(rt))),is=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),uh=null,Iu=null,oA=!0,yc=!0,lA=!1,Bu=!0,Du=!1,uf=!0,Bl=!1,_u=!1,Pu=!1,hh=!1,xn=!1,dl=!1,zc=!0,dh=!1,hf="user-content-",za=!0,Ho=!1,Dl={},Xa=null,cA=v({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),df=null,_l=v({},["audio","video","img","source","image","track"]),Td=null,Oh=v({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Lu="http://www.w3.org/1998/Math/MathML",uA="http://www.w3.org/2000/svg",qa="http://www.w3.org/1999/xhtml",Pl=qa,Id=!1,hA=null,Al=v({},[Lu,uA,qa],G),eo,Nh=["application/xhtml+xml","text/html"],Af="text/html",_n,bc=null,ff=Jt.createElement("form"),Fi=function($e){return $e instanceof RegExp||$e instanceof Function},pf=function($e){bc&&bc===$e||((!$e||t($e)!=="object")&&($e={}),$e=N($e),eo=Nh.indexOf($e.PARSER_MEDIA_TYPE)===-1?eo=Af:eo=$e.PARSER_MEDIA_TYPE,_n=eo==="application/xhtml+xml"?G:C,Ms="ALLOWED_TAGS"in $e?v({},$e.ALLOWED_TAGS,_n):Tu,ha="ALLOWED_ATTR"in $e?v({},$e.ALLOWED_ATTR,_n):Sd,hA="ALLOWED_NAMESPACES"in $e?v({},$e.ALLOWED_NAMESPACES,G):Al,Td="ADD_URI_SAFE_ATTR"in $e?v(N(Oh),$e.ADD_URI_SAFE_ATTR,_n):Oh,df="ADD_DATA_URI_TAGS"in $e?v(N(_l),$e.ADD_DATA_URI_TAGS,_n):_l,Xa="FORBID_CONTENTS"in $e?v({},$e.FORBID_CONTENTS,_n):cA,uh="FORBID_TAGS"in $e?v({},$e.FORBID_TAGS,_n):{},Iu="FORBID_ATTR"in $e?v({},$e.FORBID_ATTR,_n):{},Dl="USE_PROFILES"in $e?$e.USE_PROFILES:!1,oA=$e.ALLOW_ARIA_ATTR!==!1,yc=$e.ALLOW_DATA_ATTR!==!1,lA=$e.ALLOW_UNKNOWN_PROTOCOLS||!1,Bu=$e.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Du=$e.SAFE_FOR_TEMPLATES||!1,uf=$e.SAFE_FOR_XML!==!1,Bl=$e.WHOLE_DOCUMENT||!1,hh=$e.RETURN_DOM||!1,xn=$e.RETURN_DOM_FRAGMENT||!1,dl=$e.RETURN_TRUSTED_TYPE||!1,Pu=$e.FORCE_BODY||!1,zc=$e.SANITIZE_DOM!==!1,dh=$e.SANITIZE_NAMED_PROPS||!1,za=$e.KEEP_CONTENT!==!1,Ho=$e.IN_PLACE||!1,hl=$e.ALLOWED_URI_REGEXP||hl,Pl=$e.NAMESPACE||qa,is=$e.CUSTOM_ELEMENT_HANDLING||{},$e.CUSTOM_ELEMENT_HANDLING&&Fi($e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(is.tagNameCheck=$e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),$e.CUSTOM_ELEMENT_HANDLING&&Fi($e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(is.attributeNameCheck=$e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),$e.CUSTOM_ELEMENT_HANDLING&&typeof $e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(is.allowCustomizedBuiltInElements=$e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Du&&(yc=!1),xn&&(hh=!0),Dl&&(Ms=v({},n(me)),ha=[],Dl.html===!0&&(v(Ms,q),v(ha,ve)),Dl.svg===!0&&(v(Ms,P),v(ha,Le),v(ha,rt)),Dl.svgFilters===!0&&(v(Ms,z),v(ha,Le),v(ha,rt)),Dl.mathMl===!0&&(v(Ms,oe),v(ha,He),v(ha,rt))),$e.ADD_TAGS&&(Ms===Tu&&(Ms=N(Ms)),v(Ms,$e.ADD_TAGS,_n)),$e.ADD_ATTR&&(ha===Sd&&(ha=N(ha)),v(ha,$e.ADD_ATTR,_n)),$e.ADD_URI_SAFE_ATTR&&v(Td,$e.ADD_URI_SAFE_ATTR,_n),$e.FORBID_CONTENTS&&(Xa===cA&&(Xa=N(Xa)),v(Xa,$e.FORBID_CONTENTS,_n)),za&&(Ms["#text"]=!0),Bl&&v(Ms,["html","head","body"]),Ms.table&&(v(Ms,["tbody"]),delete uh.tbody),p&&p($e),bc=$e)},dA=v({},["mi","mo","mn","ms","mtext"]),Xc=v({},["foreignobject","annotation-xml"]),Cp=v({},["title","style","font","a","script"]),Go=v({},P);v(Go,z),v(Go,W);var Ah=v({},oe);v(Ah,Ae);var AA=function($e){var ir=Tr($e);(!ir||!ir.tagName)&&(ir={namespaceURI:Pl,tagName:"template"});var wr=C($e.tagName),Cn=C(ir.tagName);return hA[$e.namespaceURI]?$e.namespaceURI===uA?ir.namespaceURI===qa?wr==="svg":ir.namespaceURI===Lu?wr==="svg"&&(Cn==="annotation-xml"||dA[Cn]):!!Go[wr]:$e.namespaceURI===Lu?ir.namespaceURI===qa?wr==="math":ir.namespaceURI===uA?wr==="math"&&Xc[Cn]:!!Ah[wr]:$e.namespaceURI===qa?ir.namespaceURI===uA&&!Xc[Cn]||ir.namespaceURI===Lu&&!dA[Cn]?!1:!Ah[wr]&&(Cp[wr]||!Go[wr]):!!(eo==="application/xhtml+xml"&&hA[$e.namespaceURI]):!1},fl=function($e){I(ct.removed,{element:$e});try{$e.parentNode.removeChild($e)}catch{try{$e.outerHTML=sn}catch{$e.remove()}}},fA=function($e,ir){try{I(ct.removed,{attribute:ir.getAttributeNode($e),from:ir})}catch{I(ct.removed,{attribute:null,from:ir})}if(ir.removeAttribute($e),$e==="is"&&!ha[$e])if(hh||xn)try{fl(ir)}catch{}else try{ir.setAttribute($e,"")}catch{}},mf=function($e){var ir,wr;if(Pu)$e="<remove></remove>"+$e;else{var Cn=U($e,/^[\r\n\t ]+/);wr=Cn&&Cn[0]}eo==="application/xhtml+xml"&&Pl===qa&&($e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+$e+"</body></html>");var da=nn?nn.createHTML($e):$e;if(Pl===qa)try{ir=new it().parseFromString(da,eo)}catch{}if(!ir||!ir.documentElement){ir=Za.createDocument(Pl,"template",null);try{ir.documentElement.innerHTML=Id?sn:da}catch{}}var S=ir.body||ir.documentElement;return $e&&wr&&S.insertBefore(Jt.createTextNode(wr),S.childNodes[0]||null),Pl===qa?Lr.call(ir,Bl?"html":"body")[0]:Bl?ir.documentElement:S},Rh=function($e){return ai.call($e.ownerDocument||$e,$e,ue.SHOW_ELEMENT|ue.SHOW_COMMENT|ue.SHOW_TEXT|ue.SHOW_PROCESSING_INSTRUCTION|ue.SHOW_CDATA_SECTION,null,!1)},Ou=function($e){return $e instanceof st&&(typeof $e.nodeName!="string"||typeof $e.textContent!="string"||typeof $e.removeChild!="function"||!($e.attributes instanceof Ce)||typeof $e.removeAttribute!="function"||typeof $e.setAttribute!="function"||typeof $e.namespaceURI!="string"||typeof $e.insertBefore!="function"||typeof $e.hasChildNodes!="function")},pl=function($e){return t(se)==="object"?$e instanceof se:$e&&t($e)==="object"&&typeof $e.nodeType=="number"&&typeof $e.nodeName=="string"},tc=function($e,ir,wr){Zi[$e]&&w(Zi[$e],function(Cn){Cn.call(ct,ir,wr,bc)})},fh=function($e){var ir;if(tc("beforeSanitizeElements",$e,null),Ou($e)||j(/[\u0080-\uFFFF]/,$e.nodeName))return fl($e),!0;var wr=_n($e.nodeName);if(tc("uponSanitizeElement",$e,{tagName:wr,allowedTags:Ms}),$e.hasChildNodes()&&!pl($e.firstElementChild)&&(!pl($e.content)||!pl($e.content.firstElementChild))&&j(/<[/\w]/g,$e.innerHTML)&&j(/<[/\w]/g,$e.textContent)||wr==="select"&&j(/<template/i,$e.innerHTML)||$e.nodeType===7||uf&&$e.nodeType===8&&j(/<[/\w]/g,$e.data))return fl($e),!0;if(!Ms[wr]||uh[wr]){if(!uh[wr]&&Pa(wr)&&(is.tagNameCheck instanceof RegExp&&j(is.tagNameCheck,wr)||is.tagNameCheck instanceof Function&&is.tagNameCheck(wr)))return!1;if(za&&!Xa[wr]){var Cn=Tr($e)||$e.parentNode,da=xi($e)||$e.childNodes;if(da&&Cn)for(var S=da.length,V=S-1;V>=0;--V){var ee=lr(da[V],!0);ee.__removalCount=($e.__removalCount||0)+1,Cn.insertBefore(ee,yr($e))}}return fl($e),!0}return $e instanceof ae&&!AA($e)||(wr==="noscript"||wr==="noembed"||wr==="noframes")&&j(/<\/no(script|embed|frames)/i,$e.innerHTML)?(fl($e),!0):(Du&&$e.nodeType===3&&(ir=$e.textContent,ir=_(ir,Do," "),ir=_(ir,Su," "),ir=_(ir,gc," "),$e.textContent!==ir&&(I(ct.removed,{element:$e.cloneNode()}),$e.textContent=ir)),tc("afterSanitizeElements",$e,null),!1)},Mh=function($e,ir,wr){if(zc&&(ir==="id"||ir==="name")&&(wr in Jt||wr in ff))return!1;if(!(yc&&!Iu[ir]&&j(jc,ir))){if(!(oA&&j(ec,ir))){if(!ha[ir]||Iu[ir]){if(!(Pa($e)&&(is.tagNameCheck instanceof RegExp&&j(is.tagNameCheck,$e)||is.tagNameCheck instanceof Function&&is.tagNameCheck($e))&&(is.attributeNameCheck instanceof RegExp&&j(is.attributeNameCheck,ir)||is.attributeNameCheck instanceof Function&&is.attributeNameCheck(ir))||ir==="is"&&is.allowCustomizedBuiltInElements&&(is.tagNameCheck instanceof RegExp&&j(is.tagNameCheck,wr)||is.tagNameCheck instanceof Function&&is.tagNameCheck(wr))))return!1}else if(!Td[ir]){if(!j(hl,_(wr,Uo,""))){if(!((ir==="src"||ir==="xlink:href"||ir==="href")&&$e!=="script"&&H(wr,"data:")===0&&df[$e])){if(!(lA&&!j(Qc,_(wr,Uo,"")))){if(wr)return!1}}}}}}return!0},Pa=function($e){return $e!=="annotation-xml"&&U($e,ul)},gf=function($e){var ir,wr,Cn,da;tc("beforeSanitizeAttributes",$e,null);var S=$e.attributes;if(S){var V={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ha};for(da=S.length;da--;){ir=S[da];var ee=ir,ie=ee.name,he=ee.namespaceURI;if(wr=ie==="value"?ir.value:Q(ir.value),Cn=_n(ie),V.attrName=Cn,V.attrValue=wr,V.keepAttr=!0,V.forceKeepAttr=void 0,tc("uponSanitizeAttribute",$e,V),wr=V.attrValue,!V.forceKeepAttr&&(fA(ie,$e),!!V.keepAttr)){if(!Bu&&j(/\/>/i,wr)){fA(ie,$e);continue}if(uf&&j(/((--!?|])>)|<\/(style|title)/i,wr)){fA(ie,$e);continue}Du&&(wr=_(wr,Do," "),wr=_(wr,Su," "),wr=_(wr,gc," "));var de=_n($e.nodeName);if(Mh(de,Cn,wr)){if(dh&&(Cn==="id"||Cn==="name")&&(fA(ie,$e),wr=hf+wr),nn&&t(Kt)==="object"&&typeof Kt.getAttributeType=="function"&&!he)switch(Kt.getAttributeType(de,Cn)){case"TrustedHTML":{wr=nn.createHTML(wr);break}case"TrustedScriptURL":{wr=nn.createScriptURL(wr);break}}try{he?$e.setAttributeNS(he,ie,wr):$e.setAttribute(ie,wr),Ou($e)?fl($e):x(ct.removed)}catch{}}}}tc("afterSanitizeAttributes",$e,null)}},ph=function $r($e){var ir,wr=Rh($e);for(tc("beforeSanitizeShadowDOM",$e,null);ir=wr.nextNode();)tc("uponSanitizeShadowNode",ir,null),!fh(ir)&&(ir.content instanceof O&&$r(ir.content),gf(ir));tc("afterSanitizeShadowDOM",$e,null)};return ct.sanitize=function($r){var $e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ir,wr,Cn,da,S;if(Id=!$r,Id&&($r="<!-->"),typeof $r!="string"&&!pl($r))if(typeof $r.toString=="function"){if($r=$r.toString(),typeof $r!="string")throw $("dirty is not a string, aborting")}else throw $("toString is not a function");if(!ct.isSupported){if(t(Lt.toStaticHTML)==="object"||typeof Lt.toStaticHTML=="function"){if(typeof $r=="string")return Lt.toStaticHTML($r);if(pl($r))return Lt.toStaticHTML($r.outerHTML)}return $r}if(_u||pf($e),ct.removed=[],typeof $r=="string"&&(Ho=!1),Ho){if($r.nodeName){var V=_n($r.nodeName);if(!Ms[V]||uh[V])throw $("root node is forbidden and cannot be sanitized in-place")}}else if($r instanceof se)ir=mf("<!---->"),wr=ir.ownerDocument.importNode($r,!0),wr.nodeType===1&&wr.nodeName==="BODY"||wr.nodeName==="HTML"?ir=wr:ir.appendChild(wr);else{if(!hh&&!Du&&!Bl&&$r.indexOf("<")===-1)return nn&&dl?nn.createHTML($r):$r;if(ir=mf($r),!ir)return hh?null:dl?sn:""}ir&&Pu&&fl(ir.firstChild);for(var ee=Rh(Ho?$r:ir);Cn=ee.nextNode();)Cn.nodeType===3&&Cn===da||fh(Cn)||(Cn.content instanceof O&&ph(Cn.content),gf(Cn),da=Cn);if(da=null,Ho)return $r;if(hh){if(xn)for(S=xa.call(ir.ownerDocument);ir.firstChild;)S.appendChild(ir.firstChild);else S=ir;return(ha.shadowroot||ha.shadowrootmod)&&(S=mn.call(Zt,S,!0)),S}var ie=Bl?ir.outerHTML:ir.innerHTML;return Bl&&Ms["!doctype"]&&ir.ownerDocument&&ir.ownerDocument.doctype&&ir.ownerDocument.doctype.name&&j(Yt,ir.ownerDocument.doctype.name)&&(ie="<!DOCTYPE "+ir.ownerDocument.doctype.name+`>
`+ie),Du&&(ie=_(ie,Do," "),ie=_(ie,Su," "),ie=_(ie,gc," ")),nn&&dl?nn.createHTML(ie):ie},ct.setConfig=function($r){pf($r),_u=!0},ct.clearConfig=function(){bc=null,_u=!1},ct.isValidAttribute=function($r,$e,ir){bc||pf({});var wr=_n($r),Cn=_n($e);return Mh(wr,Cn,ir)},ct.addHook=function($r,$e){typeof $e=="function"&&(Zi[$r]=Zi[$r]||[],I(Zi[$r],$e))},ct.removeHook=function($r){if(Zi[$r])return x(Zi[$r])},ct.removeHooks=function($r){Zi[$r]&&(Zi[$r]=[])},ct.removeAllHooks=function(){Zi={}},ct}var _r=Pt();return _r}))});var sl=yt((P8,r$)=>{"use strict";var CT=function(t){return t&&t.Math===Math&&t};r$.exports=CT(typeof globalThis=="object"&&globalThis)||CT(typeof window=="object"&&window)||CT(typeof self=="object"&&self)||CT(typeof global=="object"&&global)||CT(typeof P8=="object"&&P8)||(function(){return this})()||Function("return this")()});var al=yt((r6t,i$)=>{"use strict";i$.exports=function(t){try{return!!t()}catch{return!0}}});var nf=yt((i6t,n$)=>{"use strict";var LBe=al();n$.exports=!LBe(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})});var ST=yt((n6t,s$)=>{"use strict";var OBe=al();s$.exports=!OBe(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")})});var Yc=yt((s6t,a$)=>{"use strict";var NBe=ST(),VO=Function.prototype.call;a$.exports=NBe?VO.bind(VO):function(){return VO.apply(VO,arguments)}});var u$=yt(c$=>{"use strict";var o$={}.propertyIsEnumerable,l$=Object.getOwnPropertyDescriptor,RBe=l$&&!o$.call({1:2},1);c$.f=RBe?function(e){var r=l$(this,e);return!!r&&r.enumerable}:o$});var jO=yt((o6t,h$)=>{"use strict";h$.exports=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}});var ol=yt((l6t,f$)=>{"use strict";var d$=ST(),A$=Function.prototype,L8=A$.call,MBe=d$&&A$.bind.bind(L8,L8);f$.exports=d$?MBe:function(t){return function(){return L8.apply(t,arguments)}}});var Py=yt((c6t,m$)=>{"use strict";var p$=ol(),kBe=p$({}.toString),FBe=p$("".slice);m$.exports=function(t){return FBe(kBe(t),8,-1)}});var N8=yt((u6t,g$)=>{"use strict";var UBe=ol(),HBe=al(),GBe=Py(),O8=Object,YBe=UBe("".split);g$.exports=HBe(function(){return!O8("z").propertyIsEnumerable(0)})?function(t){return GBe(t)==="String"?YBe(t,""):O8(t)}:O8});var Ly=yt((h6t,y$)=>{"use strict";y$.exports=function(t){return t==null}});var sf=yt((d6t,b$)=>{"use strict";var VBe=Ly(),jBe=TypeError;b$.exports=function(t){if(VBe(t))throw new jBe("Can't call method on "+t);return t}});var WE=yt((A6t,x$)=>{"use strict";var QBe=N8(),zBe=sf();x$.exports=function(t){return QBe(zBe(t))}});var ll=yt((f6t,E$)=>{"use strict";var R8=typeof document=="object"&&document.all;E$.exports=typeof R8>"u"&&R8!==void 0?function(t){return typeof t=="function"||t===R8}:function(t){return typeof t=="function"}});var af=yt((p6t,w$)=>{"use strict";var XBe=ll();w$.exports=function(t){return typeof t=="object"?t!==null:XBe(t)}});var Oy=yt((m6t,v$)=>{"use strict";var M8=sl(),qBe=ll(),WBe=function(t){return qBe(t)?t:void 0};v$.exports=function(t,e){return arguments.length<2?WBe(M8[t]):M8[t]&&M8[t][e]}});var TT=yt((g6t,C$)=>{"use strict";var KBe=ol();C$.exports=KBe({}.isPrototypeOf)});var IT=yt((y6t,S$)=>{"use strict";S$.exports=typeof navigator<"u"&&String(navigator.userAgent)||""});var zO=yt((b6t,P$)=>{"use strict";var _$=sl(),k8=IT(),T$=_$.process,I$=_$.Deno,B$=T$&&T$.versions||I$&&I$.version,D$=B$&&B$.v8,fp,QO;D$&&(fp=D$.split("."),QO=fp[0]>0&&fp[0]<4?1:+(fp[0]+fp[1]));!QO&&k8&&(fp=k8.match(/Edge\/(\d+)/),(!fp||fp[1]>=74)&&(fp=k8.match(/Chrome\/(\d+)/),fp&&(QO=+fp[1])));P$.exports=QO});var F8=yt((x6t,O$)=>{"use strict";var L$=zO(),JBe=al(),$Be=sl(),ZBe=$Be.String;O$.exports=!!Object.getOwnPropertySymbols&&!JBe(function(){var t=Symbol("symbol detection");return!ZBe(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&L$&&L$<41})});var U8=yt((E6t,N$)=>{"use strict";var eDe=F8();N$.exports=eDe&&!Symbol.sham&&typeof Symbol.iterator=="symbol"});var H8=yt((w6t,R$)=>{"use strict";var tDe=Oy(),rDe=ll(),iDe=TT(),nDe=U8(),sDe=Object;R$.exports=nDe?function(t){return typeof t=="symbol"}:function(t){var e=tDe("Symbol");return rDe(e)&&iDe(e.prototype,sDe(t))}});var BT=yt((v6t,M$)=>{"use strict";var aDe=String;M$.exports=function(t){try{return aDe(t)}catch{return"Object"}}});var vm=yt((C6t,k$)=>{"use strict";var oDe=ll(),lDe=BT(),cDe=TypeError;k$.exports=function(t){if(oDe(t))return t;throw new cDe(lDe(t)+" is not a function")}});var Db=yt((S6t,F$)=>{"use strict";var uDe=vm(),hDe=Ly();F$.exports=function(t,e){var r=t[e];return hDe(r)?void 0:uDe(r)}});var H$=yt((T6t,U$)=>{"use strict";var G8=Yc(),Y8=ll(),V8=af(),dDe=TypeError;U$.exports=function(t,e){var r,i;if(e==="string"&&Y8(r=t.toString)&&!V8(i=G8(r,t))||Y8(r=t.valueOf)&&!V8(i=G8(r,t))||e!=="string"&&Y8(r=t.toString)&&!V8(i=G8(r,t)))return i;throw new dDe("Can't convert object to primitive value")}});var pp=yt((I6t,G$)=>{"use strict";G$.exports=!1});var XO=yt((B6t,V$)=>{"use strict";var Y$=sl(),ADe=Object.defineProperty;V$.exports=function(t,e){try{ADe(Y$,t,{value:e,configurable:!0,writable:!0})}catch{Y$[t]=e}return e}});var qO=yt((D6t,z$)=>{"use strict";var fDe=pp(),pDe=sl(),mDe=XO(),j$="__core-js_shared__",Q$=z$.exports=pDe[j$]||mDe(j$,{});(Q$.versions||(Q$.versions=[])).push({version:"3.37.1",mode:fDe?"pure":"global",copyright:"\xA9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.1/LICENSE",source:"https://github.com/zloirock/core-js"})});var WO=yt((_6t,q$)=>{"use strict";var X$=qO();q$.exports=function(t,e){return X$[t]||(X$[t]=e||{})}});var DT=yt((P6t,W$)=>{"use strict";var gDe=sf(),yDe=Object;W$.exports=function(t){return yDe(gDe(t))}});var of=yt((L6t,K$)=>{"use strict";var bDe=ol(),xDe=DT(),EDe=bDe({}.hasOwnProperty);K$.exports=Object.hasOwn||function(e,r){return EDe(xDe(e),r)}});var j8=yt((O6t,J$)=>{"use strict";var wDe=ol(),vDe=0,CDe=Math.random(),SDe=wDe(1 .toString);J$.exports=function(t){return"Symbol("+(t===void 0?"":t)+")_"+SDe(++vDe+CDe,36)}});var mc=yt((N6t,Z$)=>{"use strict";var TDe=sl(),IDe=WO(),$$=of(),BDe=j8(),DDe=F8(),_De=U8(),KE=TDe.Symbol,Q8=IDe("wks"),PDe=_De?KE.for||KE:KE&&KE.withoutSetter||BDe;Z$.exports=function(t){return $$(Q8,t)||(Q8[t]=DDe&&$$(KE,t)?KE[t]:PDe("Symbol."+t)),Q8[t]}});var iZ=yt((R6t,rZ)=>{"use strict";var LDe=Yc(),eZ=af(),tZ=H8(),ODe=Db(),NDe=H$(),RDe=mc(),MDe=TypeError,kDe=RDe("toPrimitive");rZ.exports=function(t,e){if(!eZ(t)||tZ(t))return t;var r=ODe(t,kDe),i;if(r){if(e===void 0&&(e="default"),i=LDe(r,t,e),!eZ(i)||tZ(i))return i;throw new MDe("Can't convert object to primitive value")}return e===void 0&&(e="number"),NDe(t,e)}});var z8=yt((M6t,nZ)=>{"use strict";var FDe=iZ(),UDe=H8();nZ.exports=function(t){var e=FDe(t,"string");return UDe(e)?e:e+""}});var _T=yt((k6t,aZ)=>{"use strict";var HDe=sl(),sZ=af(),X8=HDe.document,GDe=sZ(X8)&&sZ(X8.createElement);aZ.exports=function(t){return GDe?X8.createElement(t):{}}});var q8=yt((F6t,oZ)=>{"use strict";var YDe=nf(),VDe=al(),jDe=_T();oZ.exports=!YDe&&!VDe(function(){return Object.defineProperty(jDe("div"),"a",{get:function(){return 7}}).a!==7})});var PT=yt(cZ=>{"use strict";var QDe=nf(),zDe=Yc(),XDe=u$(),qDe=jO(),WDe=WE(),KDe=z8(),JDe=of(),$De=q8(),lZ=Object.getOwnPropertyDescriptor;cZ.f=QDe?lZ:function(e,r){if(e=WDe(e),r=KDe(r),$De)try{return lZ(e,r)}catch{}if(JDe(e,r))return qDe(!zDe(XDe.f,e,r),e[r])}});var W8=yt((H6t,uZ)=>{"use strict";var ZDe=nf(),e_e=al();uZ.exports=ZDe&&e_e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})});var nh=yt((G6t,hZ)=>{"use strict";var t_e=af(),r_e=String,i_e=TypeError;hZ.exports=function(t){if(t_e(t))return t;throw new i_e(r_e(t)+" is not an object")}});var Kg=yt(AZ=>{"use strict";var n_e=nf(),s_e=q8(),a_e=W8(),KO=nh(),dZ=z8(),o_e=TypeError,K8=Object.defineProperty,l_e=Object.getOwnPropertyDescriptor,J8="enumerable",$8="configurable",Z8="writable";AZ.f=n_e?a_e?function(e,r,i){if(KO(e),r=dZ(r),KO(i),typeof e=="function"&&r==="prototype"&&"value"in i&&Z8 in i&&!i[Z8]){var n=l_e(e,r);n&&n[Z8]&&(e[r]=i.value,i={configurable:$8 in i?i[$8]:n[$8],enumerable:J8 in i?i[J8]:n[J8],writable:!1})}return K8(e,r,i)}:K8:function(e,r,i){if(KO(e),r=dZ(r),KO(i),s_e)try{return K8(e,r,i)}catch{}if("get"in i||"set"in i)throw new o_e("Accessors not supported");return"value"in i&&(e[r]=i.value),e}});var JE=yt((V6t,fZ)=>{"use strict";var c_e=nf(),u_e=Kg(),h_e=jO();fZ.exports=c_e?function(t,e,r){return u_e.f(t,e,h_e(1,r))}:function(t,e,r){return t[e]=r,t}});var LT=yt((j6t,mZ)=>{"use strict";var eF=nf(),d_e=of(),pZ=Function.prototype,A_e=eF&&Object.getOwnPropertyDescriptor,tF=d_e(pZ,"name"),f_e=tF&&(function(){}).name==="something",p_e=tF&&(!eF||eF&&A_e(pZ,"name").configurable);mZ.exports={EXISTS:tF,PROPER:f_e,CONFIGURABLE:p_e}});var JO=yt((Q6t,gZ)=>{"use strict";var m_e=ol(),g_e=ll(),rF=qO(),y_e=m_e(Function.toString);g_e(rF.inspectSource)||(rF.inspectSource=function(t){return y_e(t)});gZ.exports=rF.inspectSource});var xZ=yt((z6t,bZ)=>{"use strict";var b_e=sl(),x_e=ll(),yZ=b_e.WeakMap;bZ.exports=x_e(yZ)&&/native code/.test(String(yZ))});var $O=yt((X6t,wZ)=>{"use strict";var E_e=WO(),w_e=j8(),EZ=E_e("keys");wZ.exports=function(t){return EZ[t]||(EZ[t]=w_e(t))}});var ZO=yt((q6t,vZ)=>{"use strict";vZ.exports={}});var NT=yt((W6t,TZ)=>{"use strict";var v_e=xZ(),SZ=sl(),C_e=af(),S_e=JE(),iF=of(),nF=qO(),T_e=$O(),I_e=ZO(),CZ="Object already initialized",sF=SZ.TypeError,B_e=SZ.WeakMap,e5,OT,t5,D_e=function(t){return t5(t)?OT(t):e5(t,{})},__e=function(t){return function(e){var r;if(!C_e(e)||(r=OT(e)).type!==t)throw new sF("Incompatible receiver, "+t+" required");return r}};v_e||nF.state?(mp=nF.state||(nF.state=new B_e),mp.get=mp.get,mp.has=mp.has,mp.set=mp.set,e5=function(t,e){if(mp.has(t))throw new sF(CZ);return e.facade=t,mp.set(t,e),e},OT=function(t){return mp.get(t)||{}},t5=function(t){return mp.has(t)}):(_b=T_e("state"),I_e[_b]=!0,e5=function(t,e){if(iF(t,_b))throw new sF(CZ);return e.facade=t,S_e(t,_b,e),e},OT=function(t){return iF(t,_b)?t[_b]:{}},t5=function(t){return iF(t,_b)});var mp,_b;TZ.exports={set:e5,get:OT,has:t5,enforce:D_e,getterFor:__e}});var lF=yt((K6t,DZ)=>{"use strict";var oF=ol(),P_e=al(),L_e=ll(),r5=of(),aF=nf(),O_e=LT().CONFIGURABLE,N_e=JO(),BZ=NT(),R_e=BZ.enforce,M_e=BZ.get,IZ=String,i5=Object.defineProperty,k_e=oF("".slice),F_e=oF("".replace),U_e=oF([].join),H_e=aF&&!P_e(function(){return i5(function(){},"length",{value:8}).length!==8}),G_e=String(String).split("String"),Y_e=DZ.exports=function(t,e,r){k_e(IZ(e),0,7)==="Symbol("&&(e="["+F_e(IZ(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!r5(t,"name")||O_e&&t.name!==e)&&(aF?i5(t,"name",{value:e,configurable:!0}):t.name=e),H_e&&r&&r5(r,"arity")&&t.length!==r.arity&&i5(t,"length",{value:r.arity});try{r&&r5(r,"constructor")&&r.constructor?aF&&i5(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var i=R_e(t);return r5(i,"source")||(i.source=U_e(G_e,typeof e=="string"?e:"")),t};Function.prototype.toString=Y_e(function(){return L_e(this)&&M_e(this).source||N_e(this)},"toString")});var Ny=yt((J6t,_Z)=>{"use strict";var V_e=ll(),j_e=Kg(),Q_e=lF(),z_e=XO();_Z.exports=function(t,e,r,i){i||(i={});var n=i.enumerable,s=i.name!==void 0?i.name:e;if(V_e(r)&&Q_e(r,s,i),i.global)n?t[e]=r:z_e(e,r);else{try{i.unsafe?t[e]&&(n=!0):delete t[e]}catch{}n?t[e]=r:j_e.f(t,e,{value:r,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return t}});var LZ=yt(($6t,PZ)=>{"use strict";var X_e=Math.ceil,q_e=Math.floor;PZ.exports=Math.trunc||function(e){var r=+e;return(r>0?q_e:X_e)(r)}});var RT=yt((Z6t,OZ)=>{"use strict";var W_e=LZ();OZ.exports=function(t){var e=+t;return e!==e||e===0?0:W_e(e)}});var RZ=yt((ekt,NZ)=>{"use strict";var K_e=RT(),J_e=Math.max,$_e=Math.min;NZ.exports=function(t,e){var r=K_e(t);return r<0?J_e(r+e,0):$_e(r,e)}});var Pb=yt((tkt,MZ)=>{"use strict";var Z_e=RT(),ePe=Math.min;MZ.exports=function(t){var e=Z_e(t);return e>0?ePe(e,9007199254740991):0}});var n5=yt((rkt,kZ)=>{"use strict";var tPe=Pb();kZ.exports=function(t){return tPe(t.length)}});var cF=yt((ikt,UZ)=>{"use strict";var rPe=WE(),iPe=RZ(),nPe=n5(),FZ=function(t){return function(e,r,i){var n=rPe(e),s=nPe(n);if(s===0)return!t&&-1;var a=iPe(i,s),o;if(t&&r!==r){for(;s>a;)if(o=n[a++],o!==o)return!0}else for(;s>a;a++)if((t||a in n)&&n[a]===r)return t||a||0;return!t&&-1}};UZ.exports={includes:FZ(!0),indexOf:FZ(!1)}});var hF=yt((nkt,GZ)=>{"use strict";var sPe=ol(),uF=of(),aPe=WE(),oPe=cF().indexOf,lPe=ZO(),HZ=sPe([].push);GZ.exports=function(t,e){var r=aPe(t),i=0,n=[],s;for(s in r)!uF(lPe,s)&&uF(r,s)&&HZ(n,s);for(;e.length>i;)uF(r,s=e[i++])&&(~oPe(n,s)||HZ(n,s));return n}});var s5=yt((skt,YZ)=>{"use strict";YZ.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]});var jZ=yt(VZ=>{"use strict";var cPe=hF(),uPe=s5(),hPe=uPe.concat("length","prototype");VZ.f=Object.getOwnPropertyNames||function(e){return cPe(e,hPe)}});var zZ=yt(QZ=>{"use strict";QZ.f=Object.getOwnPropertySymbols});var qZ=yt((lkt,XZ)=>{"use strict";var dPe=Oy(),APe=ol(),fPe=jZ(),pPe=zZ(),mPe=nh(),gPe=APe([].concat);XZ.exports=dPe("Reflect","ownKeys")||function(e){var r=fPe.f(mPe(e)),i=pPe.f;return i?gPe(r,i(e)):r}});var JZ=yt((ckt,KZ)=>{"use strict";var WZ=of(),yPe=qZ(),bPe=PT(),xPe=Kg();KZ.exports=function(t,e,r){for(var i=yPe(e),n=xPe.f,s=bPe.f,a=0;a<i.length;a++){var o=i[a];!WZ(t,o)&&!(r&&WZ(r,o))&&n(t,o,s(e,o))}}});var dF=yt((ukt,$Z)=>{"use strict";var EPe=al(),wPe=ll(),vPe=/#|\.prototype\./,MT=function(t,e){var r=SPe[CPe(t)];return r===IPe?!0:r===TPe?!1:wPe(e)?EPe(e):!!e},CPe=MT.normalize=function(t){return String(t).replace(vPe,".").toLowerCase()},SPe=MT.data={},TPe=MT.NATIVE="N",IPe=MT.POLYFILL="P";$Z.exports=MT});var sh=yt((hkt,ZZ)=>{"use strict";var a5=sl(),BPe=PT().f,DPe=JE(),_Pe=Ny(),PPe=XO(),LPe=JZ(),OPe=dF();ZZ.exports=function(t,e){var r=t.target,i=t.global,n=t.stat,s,a,o,l,c,u;if(i?a=a5:n?a=a5[r]||PPe(r,{}):a=a5[r]&&a5[r].prototype,a)for(o in e){if(c=e[o],t.dontCallGetSet?(u=BPe(a,o),l=u&&u.value):l=a[o],s=OPe(i?o:r+(n?".":"#")+o,t.forced),!s&&l!==void 0){if(typeof c==typeof l)continue;LPe(c,l)}(t.sham||l&&l.sham)&&DPe(c,"sham",!0),_Pe(a,o,c,t)}}});var $E=yt((dkt,eee)=>{"use strict";var NPe=sl(),RPe=Py();eee.exports=RPe(NPe.process)==="process"});var ree=yt((Akt,tee)=>{"use strict";var MPe=ol(),kPe=vm();tee.exports=function(t,e,r){try{return MPe(kPe(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}}});var nee=yt((fkt,iee)=>{"use strict";var FPe=af();iee.exports=function(t){return FPe(t)||t===null}});var aee=yt((pkt,see)=>{"use strict";var UPe=nee(),HPe=String,GPe=TypeError;see.exports=function(t){if(UPe(t))return t;throw new GPe("Can't set "+HPe(t)+" as a prototype")}});var AF=yt((mkt,oee)=>{"use strict";var YPe=ree(),VPe=af(),jPe=sf(),QPe=aee();oee.exports=Object.setPrototypeOf||("__proto__"in{}?(function(){var t=!1,e={},r;try{r=YPe(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(n,s){return jPe(n),QPe(s),VPe(n)&&(t?r(n,s):n.__proto__=s),n}})():void 0)});var kT=yt((gkt,cee)=>{"use strict";var zPe=Kg().f,XPe=of(),qPe=mc(),lee=qPe("toStringTag");cee.exports=function(t,e,r){t&&!r&&(t=t.prototype),t&&!XPe(t,lee)&&zPe(t,lee,{configurable:!0,value:e})}});var dee=yt((ykt,hee)=>{"use strict";var uee=lF(),WPe=Kg();hee.exports=function(t,e,r){return r.get&&uee(r.get,e,{getter:!0}),r.set&&uee(r.set,e,{setter:!0}),WPe.f(t,e,r)}});var pee=yt((bkt,fee)=>{"use strict";var KPe=Oy(),JPe=dee(),$Pe=mc(),ZPe=nf(),Aee=$Pe("species");fee.exports=function(t){var e=KPe(t);ZPe&&e&&!e[Aee]&&JPe(e,Aee,{configurable:!0,get:function(){return this}})}});var gee=yt((xkt,mee)=>{"use strict";var eLe=TT(),tLe=TypeError;mee.exports=function(t,e){if(eLe(e,t))return t;throw new tLe("Incorrect invocation")}});var xee=yt((Ekt,bee)=>{"use strict";var rLe=mc(),iLe=rLe("toStringTag"),yee={};yee[iLe]="z";bee.exports=String(yee)==="[object z]"});var l5=yt((wkt,Eee)=>{"use strict";var nLe=xee(),sLe=ll(),o5=Py(),aLe=mc(),oLe=aLe("toStringTag"),lLe=Object,cLe=o5((function(){return arguments})())==="Arguments",uLe=function(t,e){try{return t[e]}catch{}};Eee.exports=nLe?o5:function(t){var e,r,i;return t===void 0?"Undefined":t===null?"Null":typeof(r=uLe(e=lLe(t),oLe))=="string"?r:cLe?o5(e):(i=o5(e))==="Object"&&sLe(e.callee)?"Arguments":i}});var Iee=yt((vkt,Tee)=>{"use strict";var hLe=ol(),dLe=al(),wee=ll(),ALe=l5(),fLe=Oy(),pLe=JO(),vee=function(){},Cee=fLe("Reflect","construct"),fF=/^\s*(?:class|function)\b/,mLe=hLe(fF.exec),gLe=!fF.test(vee),FT=function(e){if(!wee(e))return!1;try{return Cee(vee,[],e),!0}catch{return!1}},See=function(e){if(!wee(e))return!1;switch(ALe(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return gLe||!!mLe(fF,pLe(e))}catch{return!0}};See.sham=!0;Tee.exports=!Cee||dLe(function(){var t;return FT(FT.call)||!FT(Object)||!FT(function(){t=!0})||t})?See:FT});var Dee=yt((Ckt,Bee)=>{"use strict";var yLe=Iee(),bLe=BT(),xLe=TypeError;Bee.exports=function(t){if(yLe(t))return t;throw new xLe(bLe(t)+" is not a constructor")}});var pF=yt((Skt,Pee)=>{"use strict";var _ee=nh(),ELe=Dee(),wLe=Ly(),vLe=mc(),CLe=vLe("species");Pee.exports=function(t,e){var r=_ee(t).constructor,i;return r===void 0||wLe(i=_ee(r)[CLe])?e:ELe(i)}});var mF=yt((Tkt,Ree)=>{"use strict";var SLe=ST(),Nee=Function.prototype,Lee=Nee.apply,Oee=Nee.call;Ree.exports=typeof Reflect=="object"&&Reflect.apply||(SLe?Oee.bind(Lee):function(){return Oee.apply(Lee,arguments)})});var UT=yt((Ikt,Mee)=>{"use strict";var TLe=Py(),ILe=ol();Mee.exports=function(t){if(TLe(t)==="Function")return ILe(t)}});var c5=yt((Bkt,Fee)=>{"use strict";var kee=UT(),BLe=vm(),DLe=ST(),_Le=kee(kee.bind);Fee.exports=function(t,e){return BLe(t),e===void 0?t:DLe?_Le(t,e):function(){return t.apply(e,arguments)}}});var gF=yt((Dkt,Uee)=>{"use strict";var PLe=Oy();Uee.exports=PLe("document","documentElement")});var Gee=yt((_kt,Hee)=>{"use strict";var LLe=ol();Hee.exports=LLe([].slice)});var Vee=yt((Pkt,Yee)=>{"use strict";var OLe=TypeError;Yee.exports=function(t,e){if(t<e)throw new OLe("Not enough arguments");return t}});var yF=yt((Lkt,jee)=>{"use strict";var NLe=IT();jee.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(NLe)});var IF=yt((Okt,Zee)=>{"use strict";var aA=sl(),RLe=mF(),MLe=c5(),Qee=ll(),kLe=of(),$ee=al(),zee=gF(),FLe=Gee(),Xee=_T(),ULe=Vee(),HLe=yF(),GLe=$E(),CF=aA.setImmediate,SF=aA.clearImmediate,YLe=aA.process,bF=aA.Dispatch,VLe=aA.Function,qee=aA.MessageChannel,jLe=aA.String,xF=0,HT={},Wee="onreadystatechange",GT,Lb,EF,wF;$ee(function(){GT=aA.location});var TF=function(t){if(kLe(HT,t)){var e=HT[t];delete HT[t],e()}},vF=function(t){return function(){TF(t)}},Kee=function(t){TF(t.data)},Jee=function(t){aA.postMessage(jLe(t),GT.protocol+"//"+GT.host)};(!CF||!SF)&&(CF=function(e){ULe(arguments.length,1);var r=Qee(e)?e:VLe(e),i=FLe(arguments,1);return HT[++xF]=function(){RLe(r,void 0,i)},Lb(xF),xF},SF=function(e){delete HT[e]},GLe?Lb=function(t){YLe.nextTick(vF(t))}:bF&&bF.now?Lb=function(t){bF.now(vF(t))}:qee&&!HLe?(EF=new qee,wF=EF.port2,EF.port1.onmessage=Kee,Lb=MLe(wF.postMessage,wF)):aA.addEventListener&&Qee(aA.postMessage)&&!aA.importScripts&&GT&&GT.protocol!=="file:"&&!$ee(Jee)?(Lb=Jee,aA.addEventListener("message",Kee,!1)):Wee in Xee("script")?Lb=function(t){zee.appendChild(Xee("script"))[Wee]=function(){zee.removeChild(this),TF(t)}}:Lb=function(t){setTimeout(vF(t),0)});Zee.exports={set:CF,clear:SF}});var rte=yt((Nkt,tte)=>{"use strict";var ete=sl(),QLe=nf(),zLe=Object.getOwnPropertyDescriptor;tte.exports=function(t){if(!QLe)return ete[t];var e=zLe(ete,t);return e&&e.value}});var BF=yt((Rkt,nte)=>{"use strict";var ite=function(){this.head=null,this.tail=null};ite.prototype={add:function(t){var e={item:t,next:null},r=this.tail;r?r.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t){var e=this.head=t.next;return e===null&&(this.tail=null),t.item}}};nte.exports=ite});var ate=yt((Mkt,ste)=>{"use strict";var XLe=IT();ste.exports=/ipad|iphone|ipod/i.test(XLe)&&typeof Pebble<"u"});var lte=yt((kkt,ote)=>{"use strict";var qLe=IT();ote.exports=/web0s(?!.*chrome)/i.test(qLe)});var pte=yt((Fkt,fte)=>{"use strict";var ew=sl(),WLe=rte(),cte=c5(),DF=IF().set,KLe=BF(),JLe=yF(),$Le=ate(),ZLe=lte(),_F=$E(),ute=ew.MutationObserver||ew.WebKitMutationObserver,hte=ew.document,dte=ew.process,u5=ew.Promise,OF=WLe("queueMicrotask"),ZE,PF,LF,h5,Ate;OF||(YT=new KLe,VT=function(){var t,e;for(_F&&(t=dte.domain)&&t.exit();e=YT.get();)try{e()}catch(r){throw YT.head&&ZE(),r}t&&t.enter()},!JLe&&!_F&&!ZLe&&ute&&hte?(PF=!0,LF=hte.createTextNode(""),new ute(VT).observe(LF,{characterData:!0}),ZE=function(){LF.data=PF=!PF}):!$Le&&u5&&u5.resolve?(h5=u5.resolve(void 0),h5.constructor=u5,Ate=cte(h5.then,h5),ZE=function(){Ate(VT)}):_F?ZE=function(){dte.nextTick(VT)}:(DF=cte(DF,ew),ZE=function(){DF(VT)}),OF=function(t){YT.head||ZE(),YT.add(t)});var YT,VT;fte.exports=OF});var gte=yt((Ukt,mte)=>{"use strict";mte.exports=function(t,e){try{arguments.length===1?console.error(t):console.error(t,e)}catch{}}});var d5=yt((Hkt,yte)=>{"use strict";yte.exports=function(t){try{return{error:!1,value:t()}}catch(e){return{error:!0,value:e}}}});var tw=yt((Gkt,bte)=>{"use strict";var eOe=sl();bte.exports=eOe.Promise});var NF=yt((Ykt,xte)=>{"use strict";xte.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"});var wte=yt((Vkt,Ete)=>{"use strict";var tOe=NF(),rOe=$E();Ete.exports=!tOe&&!rOe&&typeof window=="object"&&typeof document=="object"});var rw=yt((jkt,Ste)=>{"use strict";var iOe=sl(),jT=tw(),nOe=ll(),sOe=dF(),aOe=JO(),oOe=mc(),lOe=wte(),cOe=NF(),uOe=pp(),RF=zO(),vte=jT&&jT.prototype,hOe=oOe("species"),MF=!1,Cte=nOe(iOe.PromiseRejectionEvent),dOe=sOe("Promise",function(){var t=aOe(jT),e=t!==String(jT);if(!e&&RF===66||uOe&&!(vte.catch&&vte.finally))return!0;if(!RF||RF<51||!/native code/.test(t)){var r=new jT(function(s){s(1)}),i=function(s){s(function(){},function(){})},n=r.constructor={};if(n[hOe]=i,MF=r.then(function(){})instanceof i,!MF)return!0}return!e&&(lOe||cOe)&&!Cte});Ste.exports={CONSTRUCTOR:dOe,REJECTION_EVENT:Cte,SUBCLASSING:MF}});var iw=yt((Qkt,Ite)=>{"use strict";var Tte=vm(),AOe=TypeError,fOe=function(t){var e,r;this.promise=new t(function(i,n){if(e!==void 0||r!==void 0)throw new AOe("Bad Promise constructor");e=i,r=n}),this.resolve=Tte(e),this.reject=Tte(r)};Ite.exports.f=function(t){return new fOe(t)}});var zte=yt(()=>{"use strict";var pOe=sh(),mOe=pp(),m5=$E(),Ry=sl(),ow=Yc(),Bte=Ny(),Dte=AF(),gOe=kT(),yOe=pee(),bOe=vm(),p5=ll(),xOe=af(),EOe=gee(),wOe=pF(),Nte=IF().set,GF=pte(),vOe=gte(),COe=d5(),SOe=BF(),Rte=NT(),g5=tw(),YF=rw(),Mte=iw(),y5="Promise",kte=YF.CONSTRUCTOR,TOe=YF.REJECTION_EVENT,IOe=YF.SUBCLASSING,kF=Rte.getterFor(y5),BOe=Rte.set,nw=g5&&g5.prototype,Ob=g5,A5=nw,Fte=Ry.TypeError,FF=Ry.document,VF=Ry.process,UF=Mte.f,DOe=UF,_Oe=!!(FF&&FF.createEvent&&Ry.dispatchEvent),Ute="unhandledrejection",POe="rejectionhandled",_te=0,Hte=1,LOe=2,jF=1,Gte=2,f5,Pte,OOe,Lte,Yte=function(t){var e;return xOe(t)&&p5(e=t.then)?e:!1},Vte=function(t,e){var r=e.value,i=e.state===Hte,n=i?t.ok:t.fail,s=t.resolve,a=t.reject,o=t.domain,l,c,u;try{n?(i||(e.rejection===Gte&&ROe(e),e.rejection=jF),n===!0?l=r:(o&&o.enter(),l=n(r),o&&(o.exit(),u=!0)),l===t.promise?a(new Fte("Promise-chain cycle")):(c=Yte(l))?ow(c,l,s,a):s(l)):a(r)}catch(d){o&&!u&&o.exit(),a(d)}},jte=function(t,e){t.notified||(t.notified=!0,GF(function(){for(var r=t.reactions,i;i=r.get();)Vte(i,t);t.notified=!1,e&&!t.rejection&&NOe(t)}))},Qte=function(t,e,r){var i,n;_Oe?(i=FF.createEvent("Event"),i.promise=e,i.reason=r,i.initEvent(t,!1,!0),Ry.dispatchEvent(i)):i={promise:e,reason:r},!TOe&&(n=Ry["on"+t])?n(i):t===Ute&&vOe("Unhandled promise rejection",r)},NOe=function(t){ow(Nte,Ry,function(){var e=t.facade,r=t.value,i=Ote(t),n;if(i&&(n=COe(function(){m5?VF.emit("unhandledRejection",r,e):Qte(Ute,e,r)}),t.rejection=m5||Ote(t)?Gte:jF,n.error))throw n.value})},Ote=function(t){return t.rejection!==jF&&!t.parent},ROe=function(t){ow(Nte,Ry,function(){var e=t.facade;m5?VF.emit("rejectionHandled",e):Qte(POe,e,t.value)})},sw=function(t,e,r){return function(i){t(e,i,r)}},aw=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=LOe,jte(t,!0))},HF=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw new Fte("Promise can't be resolved itself");var i=Yte(e);i?GF(function(){var n={done:!1};try{ow(i,e,sw(HF,n,t),sw(aw,n,t))}catch(s){aw(n,s,t)}}):(t.value=e,t.state=Hte,jte(t,!1))}catch(n){aw({done:!1},n,t)}}};if(kte&&(Ob=function(e){EOe(this,A5),bOe(e),ow(f5,this);var r=kF(this);try{e(sw(HF,r),sw(aw,r))}catch(i){aw(r,i)}},A5=Ob.prototype,f5=function(e){BOe(this,{type:y5,done:!1,notified:!1,parent:!1,reactions:new SOe,rejection:!1,state:_te,value:void 0})},f5.prototype=Bte(A5,"then",function(e,r){var i=kF(this),n=UF(wOe(this,Ob));return i.parent=!0,n.ok=p5(e)?e:!0,n.fail=p5(r)&&r,n.domain=m5?VF.domain:void 0,i.state===_te?i.reactions.add(n):GF(function(){Vte(n,i)}),n.promise}),Pte=function(){var t=new f5,e=kF(t);this.promise=t,this.resolve=sw(HF,e),this.reject=sw(aw,e)},Mte.f=UF=function(t){return t===Ob||t===OOe?new Pte(t):DOe(t)},!mOe&&p5(g5)&&nw!==Object.prototype)){Lte=nw.then,IOe||Bte(nw,"then",function(e,r){var i=this;return new Ob(function(n,s){ow(Lte,i,n,s)}).then(e,r)},{unsafe:!0});try{delete nw.constructor}catch{}Dte&&Dte(nw,A5)}pOe({global:!0,constructor:!0,wrap:!0,forced:kte},{Promise:Ob});gOe(Ob,y5,!1,!0);yOe(y5)});var lw=yt((qkt,Xte)=>{"use strict";Xte.exports={}});var Wte=yt((Wkt,qte)=>{"use strict";var MOe=mc(),kOe=lw(),FOe=MOe("iterator"),UOe=Array.prototype;qte.exports=function(t){return t!==void 0&&(kOe.Array===t||UOe[FOe]===t)}});var QF=yt((Kkt,Jte)=>{"use strict";var HOe=l5(),Kte=Db(),GOe=Ly(),YOe=lw(),VOe=mc(),jOe=VOe("iterator");Jte.exports=function(t){if(!GOe(t))return Kte(t,jOe)||Kte(t,"@@iterator")||YOe[HOe(t)]}});var Zte=yt((Jkt,$te)=>{"use strict";var QOe=Yc(),zOe=vm(),XOe=nh(),qOe=BT(),WOe=QF(),KOe=TypeError;$te.exports=function(t,e){var r=arguments.length<2?WOe(t):e;if(zOe(r))return XOe(QOe(r,t));throw new KOe(qOe(t)+" is not iterable")}});var rre=yt(($kt,tre)=>{"use strict";var JOe=Yc(),ere=nh(),$Oe=Db();tre.exports=function(t,e,r){var i,n;ere(t);try{if(i=$Oe(t,"return"),!i){if(e==="throw")throw r;return r}i=JOe(i,t)}catch(s){n=!0,i=s}if(e==="throw")throw r;if(n)throw i;return ere(i),r}});var zF=yt((Zkt,are)=>{"use strict";var ZOe=c5(),e5e=Yc(),t5e=nh(),r5e=BT(),i5e=Wte(),n5e=n5(),ire=TT(),s5e=Zte(),a5e=QF(),nre=rre(),o5e=TypeError,b5=function(t,e){this.stopped=t,this.result=e},sre=b5.prototype;are.exports=function(t,e,r){var i=r&&r.that,n=!!(r&&r.AS_ENTRIES),s=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),o=!!(r&&r.INTERRUPTED),l=ZOe(e,i),c,u,d,A,h,f,p,m=function(g){return c&&nre(c,"normal",g),new b5(!0,g)},y=function(g){return n?(t5e(g),o?l(g[0],g[1],m):l(g[0],g[1])):o?l(g,m):l(g)};if(s)c=t.iterator;else if(a)c=t;else{if(u=a5e(t),!u)throw new o5e(r5e(t)+" is not iterable");if(i5e(u)){for(d=0,A=n5e(t);A>d;d++)if(h=y(t[d]),h&&ire(sre,h))return h;return new b5(!1)}c=s5e(t,u)}for(f=s?t.next:c.next;!(p=e5e(f,c)).done;){try{h=y(p.value)}catch(g){nre(c,"throw",g)}if(typeof h=="object"&&h&&ire(sre,h))return h}return new b5(!1)}});var hre=yt((e8t,ure)=>{"use strict";var l5e=mc(),lre=l5e("iterator"),cre=!1;try{ore=0,XF={next:function(){return{done:!!ore++}},return:function(){cre=!0}},XF[lre]=function(){return this},Array.from(XF,function(){throw 2})}catch{}var ore,XF;ure.exports=function(t,e){try{if(!e&&!cre)return!1}catch{return!1}var r=!1;try{var i={};i[lre]=function(){return{next:function(){return{done:r=!0}}}},t(i)}catch{}return r}});var qF=yt((t8t,dre)=>{"use strict";var c5e=tw(),u5e=hre(),h5e=rw().CONSTRUCTOR;dre.exports=h5e||!u5e(function(t){c5e.all(t).then(void 0,function(){})})});var Are=yt(()=>{"use strict";var d5e=sh(),A5e=Yc(),f5e=vm(),p5e=iw(),m5e=d5(),g5e=zF(),y5e=qF();d5e({target:"Promise",stat:!0,forced:y5e},{all:function(e){var r=this,i=p5e.f(r),n=i.resolve,s=i.reject,a=m5e(function(){var o=f5e(r.resolve),l=[],c=0,u=1;g5e(e,function(d){var A=c++,h=!1;u++,A5e(o,r,d).then(function(f){h||(h=!0,l[A]=f,--u||n(l))},s)}),--u||n(l)});return a.error&&s(a.value),i.promise}})});var pre=yt(()=>{"use strict";var b5e=sh(),x5e=pp(),E5e=rw().CONSTRUCTOR,KF=tw(),w5e=Oy(),v5e=ll(),C5e=Ny(),fre=KF&&KF.prototype;b5e({target:"Promise",proto:!0,forced:E5e,real:!0},{catch:function(t){return this.then(void 0,t)}});!x5e&&v5e(KF)&&(WF=w5e("Promise").prototype.catch,fre.catch!==WF&&C5e(fre,"catch",WF,{unsafe:!0}));var WF});var mre=yt(()=>{"use strict";var S5e=sh(),T5e=Yc(),I5e=vm(),B5e=iw(),D5e=d5(),_5e=zF(),P5e=qF();S5e({target:"Promise",stat:!0,forced:P5e},{race:function(e){var r=this,i=B5e.f(r),n=i.reject,s=D5e(function(){var a=I5e(r.resolve);_5e(e,function(o){T5e(a,r,o).then(i.resolve,n)})});return s.error&&n(s.value),i.promise}})});var gre=yt(()=>{"use strict";var L5e=sh(),O5e=iw(),N5e=rw().CONSTRUCTOR;L5e({target:"Promise",stat:!0,forced:N5e},{reject:function(e){var r=O5e.f(this),i=r.reject;return i(e),r.promise}})});var bre=yt((u8t,yre)=>{"use strict";var R5e=nh(),M5e=af(),k5e=iw();yre.exports=function(t,e){if(R5e(t),M5e(e)&&e.constructor===t)return e;var r=k5e.f(t),i=r.resolve;return i(e),r.promise}});var wre=yt(()=>{"use strict";var F5e=sh(),U5e=Oy(),xre=pp(),H5e=tw(),Ere=rw().CONSTRUCTOR,G5e=bre(),Y5e=U5e("Promise"),V5e=xre&&!Ere;F5e({target:"Promise",stat:!0,forced:xre||Ere},{resolve:function(e){return G5e(V5e&&this===Y5e?H5e:this,e)}})});var vre=yt(()=>{"use strict";zte();Are();pre();mre();gre();wre()});function Cre(t,e,r,i,n,s,a){try{var o=t[s](a),l=o.value}catch(c){return void r(c)}o.done?e(l):Promise.resolve(l).then(i,n)}function Cm(t){return function(){var e=this,r=arguments;return new Promise(function(i,n){var s=t.apply(e,r);function a(l){Cre(s,i,n,a,o,"next",l)}function o(l){Cre(s,i,n,a,o,"throw",l)}a(void 0)})}}var Sre=p0(()=>{});var gp=yt((m8t,Tre)=>{"use strict";var j5e=l5(),Q5e=String;Tre.exports=function(t){if(j5e(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return Q5e(t)}});var JF=yt((g8t,Ire)=>{"use strict";var z5e=nh();Ire.exports=function(){var t=z5e(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}});var t7=yt((y8t,Bre)=>{"use strict";var $F=al(),X5e=sl(),ZF=X5e.RegExp,e7=$F(function(){var t=ZF("a","y");return t.lastIndex=2,t.exec("abcd")!==null}),q5e=e7||$F(function(){return!ZF("a","y").sticky}),W5e=e7||$F(function(){var t=ZF("^r","gy");return t.lastIndex=2,t.exec("str")!==null});Bre.exports={BROKEN_CARET:W5e,MISSED_STICKY:q5e,UNSUPPORTED_Y:e7}});var _re=yt((b8t,Dre)=>{"use strict";var K5e=hF(),J5e=s5();Dre.exports=Object.keys||function(e){return K5e(e,J5e)}});var Lre=yt(Pre=>{"use strict";var $5e=nf(),Z5e=W8(),e3e=Kg(),t3e=nh(),r3e=WE(),i3e=_re();Pre.f=$5e&&!Z5e?Object.defineProperties:function(e,r){t3e(e);for(var i=r3e(r),n=i3e(r),s=n.length,a=0,o;s>a;)e3e.f(e,o=n[a++],i[o]);return e}});var QT=yt((E8t,Ure)=>{"use strict";var n3e=nh(),s3e=Lre(),Ore=s5(),a3e=ZO(),o3e=gF(),l3e=_T(),c3e=$O(),Nre=">",Rre="<",i7="prototype",n7="script",kre=c3e("IE_PROTO"),r7=function(){},Fre=function(t){return Rre+n7+Nre+t+Rre+"/"+n7+Nre},Mre=function(t){t.write(Fre("")),t.close();var e=t.parentWindow.Object;return t=null,e},u3e=function(){var t=l3e("iframe"),e="java"+n7+":",r;return t.style.display="none",o3e.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(Fre("document.F=Object")),r.close(),r.F},x5,E5=function(){try{x5=new ActiveXObject("htmlfile")}catch{}E5=typeof document<"u"?document.domain&&x5?Mre(x5):u3e():Mre(x5);for(var t=Ore.length;t--;)delete E5[i7][Ore[t]];return E5()};a3e[kre]=!0;Ure.exports=Object.create||function(e,r){var i;return e!==null?(r7[i7]=n3e(e),i=new r7,r7[i7]=null,i[kre]=e):i=E5(),r===void 0?i:s3e.f(i,r)}});var Gre=yt((w8t,Hre)=>{"use strict";var h3e=al(),d3e=sl(),A3e=d3e.RegExp;Hre.exports=h3e(function(){var t=A3e(".","s");return!(t.dotAll&&t.test(`
`)&&t.flags==="s")})});var Vre=yt((v8t,Yre)=>{"use strict";var f3e=al(),p3e=sl(),m3e=p3e.RegExp;Yre.exports=f3e(function(){var t=m3e("(?<a>b)","g");return t.exec("b").groups.a!=="b"||"b".replace(t,"$<a>c")!=="bc"})});var C5=yt((C8t,Qre)=>{"use strict";var cw=Yc(),v5=ol(),g3e=gp(),y3e=JF(),b3e=t7(),x3e=WO(),E3e=QT(),w3e=NT().get,v3e=Gre(),C3e=Vre(),S3e=x3e("native-string-replace",String.prototype.replace),w5=RegExp.prototype.exec,a7=w5,T3e=v5("".charAt),I3e=v5("".indexOf),B3e=v5("".replace),s7=v5("".slice),o7=(function(){var t=/a/,e=/b*/g;return cw(w5,t,"a"),cw(w5,e,"a"),t.lastIndex!==0||e.lastIndex!==0})(),jre=b3e.BROKEN_CARET,l7=/()??/.exec("")[1]!==void 0,D3e=o7||l7||jre||v3e||C3e;D3e&&(a7=function(e){var r=this,i=w3e(r),n=g3e(e),s=i.raw,a,o,l,c,u,d,A;if(s)return s.lastIndex=r.lastIndex,a=cw(a7,s,n),r.lastIndex=s.lastIndex,a;var h=i.groups,f=jre&&r.sticky,p=cw(y3e,r),m=r.source,y=0,g=n;if(f&&(p=B3e(p,"y",""),I3e(p,"g")===-1&&(p+="g"),g=s7(n,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&T3e(n,r.lastIndex-1)!==`
`)&&(m="(?: "+m+")",g=" "+g,y++),o=new RegExp("^(?:"+m+")",p)),l7&&(o=new RegExp("^"+m+"$(?!\\s)",p)),o7&&(l=r.lastIndex),c=cw(w5,f?o:r,g),f?c?(c.input=s7(c.input,y),c[0]=s7(c[0],y),c.index=r.lastIndex,r.lastIndex+=c[0].length):r.lastIndex=0:o7&&c&&(r.lastIndex=r.global?c.index+c[0].length:l),l7&&c&&c.length>1&&cw(S3e,c[0],o,function(){for(u=1;u<arguments.length-2;u++)arguments[u]===void 0&&(c[u]=void 0)}),c&&h)for(c.groups=d=E3e(null),u=0;u<h.length;u++)A=h[u],d[A[0]]=c[A[1]];return c});Qre.exports=a7});var Xre=yt(()=>{"use strict";var _3e=sh(),zre=C5();_3e({target:"RegExp",proto:!0,forced:/./.exec!==zre},{exec:zre})});var S5=yt((I8t,$re)=>{"use strict";Xre();var qre=Yc(),Wre=Ny(),P3e=C5(),Kre=al(),Jre=mc(),L3e=JE(),O3e=Jre("species"),c7=RegExp.prototype;$re.exports=function(t,e,r,i){var n=Jre(t),s=!Kre(function(){var c={};return c[n]=function(){return 7},""[t](c)!==7}),a=s&&!Kre(function(){var c=!1,u=/a/;return t==="split"&&(u={},u.constructor={},u.constructor[O3e]=function(){return u},u.flags="",u[n]=/./[n]),u.exec=function(){return c=!0,null},u[n](""),!c});if(!s||!a||r){var o=/./[n],l=e(n,""[t],function(c,u,d,A,h){var f=u.exec;return f===P3e||f===c7.exec?s&&!h?{done:!0,value:qre(o,u,d,A)}:{done:!0,value:qre(c,d,u,A)}:{done:!1}});Wre(String.prototype,t,l[0]),Wre(c7,n,l[1])}i&&L3e(c7[n],"sham",!0)}});var rie=yt((B8t,tie)=>{"use strict";var u7=ol(),N3e=RT(),R3e=gp(),M3e=sf(),k3e=u7("".charAt),Zre=u7("".charCodeAt),F3e=u7("".slice),eie=function(t){return function(e,r){var i=R3e(M3e(e)),n=N3e(r),s=i.length,a,o;return n<0||n>=s?t?"":void 0:(a=Zre(i,n),a<55296||a>56319||n+1===s||(o=Zre(i,n+1))<56320||o>57343?t?k3e(i,n):a:t?F3e(i,n,n+2):(a-55296<<10)+(o-56320)+65536)}};tie.exports={codeAt:eie(!1),charAt:eie(!0)}});var T5=yt((D8t,iie)=>{"use strict";var U3e=rie().charAt;iie.exports=function(t,e,r){return e+(r?U3e(t,e).length:1)}});var I5=yt((_8t,sie)=>{"use strict";var nie=Yc(),H3e=nh(),G3e=ll(),Y3e=Py(),V3e=C5(),j3e=TypeError;sie.exports=function(t,e){var r=t.exec;if(G3e(r)){var i=nie(r,t,e);return i!==null&&H3e(i),i}if(Y3e(t)==="RegExp")return nie(V3e,t,e);throw new j3e("RegExp#exec called on incompatible receiver")}});var oie=yt(()=>{"use strict";var Q3e=Yc(),z3e=S5(),X3e=nh(),q3e=Ly(),W3e=Pb(),h7=gp(),K3e=sf(),J3e=Db(),$3e=T5(),aie=I5();z3e("match",function(t,e,r){return[function(n){var s=K3e(this),a=q3e(n)?void 0:J3e(n,t);return a?Q3e(a,n,s):new RegExp(n)[t](h7(s))},function(i){var n=X3e(this),s=h7(i),a=r(e,n,s);if(a.done)return a.value;if(!n.global)return aie(n,s);var o=n.unicode;n.lastIndex=0;for(var l=[],c=0,u;(u=aie(n,s))!==null;){var d=h7(u[0]);l[c]=d,d===""&&(n.lastIndex=$3e(s,W3e(n.lastIndex),o)),c++}return c===0?null:l}]})});var cie=yt((O8t,lie)=>{"use strict";var f7=ol(),Z3e=DT(),eNe=Math.floor,d7=f7("".charAt),tNe=f7("".replace),A7=f7("".slice),rNe=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,iNe=/\$([$&'`]|\d{1,2})/g;lie.exports=function(t,e,r,i,n,s){var a=r+t.length,o=i.length,l=iNe;return n!==void 0&&(n=Z3e(n),l=rNe),tNe(s,l,function(c,u){var d;switch(d7(u,0)){case"$":return"$";case"&":return t;case"`":return A7(e,0,r);case"'":return A7(e,a);case"<":d=n[A7(u,1,-1)];break;default:var A=+u;if(A===0)return c;if(A>o){var h=eNe(A/10);return h===0?c:h<=o?i[h-1]===void 0?d7(u,1):i[h-1]+d7(u,1):c}d=i[A-1]}return d===void 0?"":d})}});var fie=yt(()=>{"use strict";var nNe=mF(),uie=Yc(),B5=ol(),sNe=S5(),aNe=al(),oNe=nh(),lNe=ll(),cNe=Ly(),uNe=RT(),hNe=Pb(),uw=gp(),dNe=sf(),ANe=T5(),fNe=Db(),pNe=cie(),mNe=I5(),gNe=mc(),m7=gNe("replace"),yNe=Math.max,bNe=Math.min,xNe=B5([].concat),p7=B5([].push),hie=B5("".indexOf),die=B5("".slice),ENe=function(t){return t===void 0?t:String(t)},wNe=(function(){return"a".replace(/./,"$0")==="$0"})(),Aie=(function(){return/./[m7]?/./[m7]("a","$0")==="":!1})(),vNe=!aNe(function(){var t=/./;return t.exec=function(){var e=[];return e.groups={a:"7"},e},"".replace(t,"$<a>")!=="7"});sNe("replace",function(t,e,r){var i=Aie?"$":"$0";return[function(s,a){var o=dNe(this),l=cNe(s)?void 0:fNe(s,m7);return l?uie(l,s,o,a):uie(e,uw(o),s,a)},function(n,s){var a=oNe(this),o=uw(n);if(typeof s=="string"&&hie(s,i)===-1&&hie(s,"$<")===-1){var l=r(e,a,o,s);if(l.done)return l.value}var c=lNe(s);c||(s=uw(s));var u=a.global,d;u&&(d=a.unicode,a.lastIndex=0);for(var A=[],h;h=mNe(a,o),!(h===null||(p7(A,h),!u));){var f=uw(h[0]);f===""&&(a.lastIndex=ANe(o,hNe(a.lastIndex),d))}for(var p="",m=0,y=0;y<A.length;y++){h=A[y];for(var g=uw(h[0]),b=yNe(bNe(uNe(h.index),o.length),0),E=[],w,x=1;x<h.length;x++)p7(E,ENe(h[x]));var I=h.groups;if(c){var C=xNe([g],E,b,o);I!==void 0&&p7(C,I),w=uw(nNe(s,void 0,C))}else w=pNe(g,o,b,E,I,s);b>=m&&(p+=die(o,m,b)+w,m=b+g.length)}return p+die(o,m)}]},!vNe||!wNe||Aie)});var mie=yt((M8t,pie)=>{"use strict";var CNe=af(),SNe=Py(),TNe=mc(),INe=TNe("match");pie.exports=function(t){var e;return CNe(t)&&((e=t[INe])!==void 0?!!e:SNe(t)==="RegExp")}});var D5=yt((k8t,gie)=>{"use strict";var BNe=mie(),DNe=TypeError;gie.exports=function(t){if(BNe(t))throw new DNe("The method doesn't accept regular expressions");return t}});var _5=yt((F8t,yie)=>{"use strict";var _Ne=mc(),PNe=_Ne("match");yie.exports=function(t){var e=/./;try{"/./"[t](e)}catch{try{return e[PNe]=!1,"/./"[t](e)}catch{}}return!1}});var Eie=yt(()=>{"use strict";var LNe=sh(),ONe=UT(),NNe=PT().f,RNe=Pb(),bie=gp(),MNe=D5(),kNe=sf(),FNe=_5(),UNe=pp(),HNe=ONe("".slice),GNe=Math.min,xie=FNe("startsWith"),YNe=!UNe&&!xie&&!!(function(){var t=NNe(String.prototype,"startsWith");return t&&!t.writable})();LNe({target:"String",proto:!0,forced:!YNe&&!xie},{startsWith:function(e){var r=bie(kNe(this));MNe(e);var i=RNe(GNe(arguments.length>1?arguments[1]:void 0,r.length)),n=bie(e);return HNe(r,i,i+n.length)===n}})});var vie=yt((G8t,wie)=>{"use strict";var VNe=mc(),jNe=QT(),QNe=Kg().f,g7=VNe("unscopables"),y7=Array.prototype;y7[g7]===void 0&&QNe(y7,g7,{configurable:!0,value:jNe(null)});wie.exports=function(t){y7[g7][t]=!0}});var Sie=yt((Y8t,Cie)=>{"use strict";var zNe=al();Cie.exports=!zNe(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})});var x7=yt((V8t,Iie)=>{"use strict";var XNe=of(),qNe=ll(),WNe=DT(),KNe=$O(),JNe=Sie(),Tie=KNe("IE_PROTO"),b7=Object,$Ne=b7.prototype;Iie.exports=JNe?b7.getPrototypeOf:function(t){var e=WNe(t);if(XNe(e,Tie))return e[Tie];var r=e.constructor;return qNe(r)&&e instanceof r?r.prototype:e instanceof b7?$Ne:null}});var C7=yt((j8t,_ie)=>{"use strict";var ZNe=al(),eRe=ll(),tRe=af(),rRe=QT(),Bie=x7(),iRe=Ny(),nRe=mc(),sRe=pp(),v7=nRe("iterator"),Die=!1,Jg,E7,w7;[].keys&&(w7=[].keys(),"next"in w7?(E7=Bie(Bie(w7)),E7!==Object.prototype&&(Jg=E7)):Die=!0);var aRe=!tRe(Jg)||ZNe(function(){var t={};return Jg[v7].call(t)!==t});aRe?Jg={}:sRe&&(Jg=rRe(Jg));eRe(Jg[v7])||iRe(Jg,v7,function(){return this});_ie.exports={IteratorPrototype:Jg,BUGGY_SAFARI_ITERATORS:Die}});var Lie=yt((Q8t,Pie)=>{"use strict";var oRe=C7().IteratorPrototype,lRe=QT(),cRe=jO(),uRe=kT(),hRe=lw(),dRe=function(){return this};Pie.exports=function(t,e,r,i){var n=e+" Iterator";return t.prototype=lRe(oRe,{next:cRe(+!i,r)}),uRe(t,n,!1,!0),hRe[n]=dRe,t}});var Vie=yt((z8t,Yie)=>{"use strict";var ARe=sh(),fRe=Yc(),P5=pp(),Hie=LT(),pRe=ll(),mRe=Lie(),Oie=x7(),Nie=AF(),gRe=kT(),yRe=JE(),S7=Ny(),bRe=mc(),Rie=lw(),Gie=C7(),xRe=Hie.PROPER,ERe=Hie.CONFIGURABLE,Mie=Gie.IteratorPrototype,L5=Gie.BUGGY_SAFARI_ITERATORS,zT=bRe("iterator"),kie="keys",XT="values",Fie="entries",Uie=function(){return this};Yie.exports=function(t,e,r,i,n,s,a){mRe(r,e,i);var o=function(y){if(y===n&&A)return A;if(!L5&&y&&y in u)return u[y];switch(y){case kie:return function(){return new r(this,y)};case XT:return function(){return new r(this,y)};case Fie:return function(){return new r(this,y)}}return function(){return new r(this)}},l=e+" Iterator",c=!1,u=t.prototype,d=u[zT]||u["@@iterator"]||n&&u[n],A=!L5&&d||o(n),h=e==="Array"&&u.entries||d,f,p,m;if(h&&(f=Oie(h.call(new t)),f!==Object.prototype&&f.next&&(!P5&&Oie(f)!==Mie&&(Nie?Nie(f,Mie):pRe(f[zT])||S7(f,zT,Uie)),gRe(f,l,!0,!0),P5&&(Rie[l]=Uie))),xRe&&n===XT&&d&&d.name!==XT&&(!P5&&ERe?yRe(u,"name",XT):(c=!0,A=function(){return fRe(d,this)})),n)if(p={values:o(XT),keys:s?A:o(kie),entries:o(Fie)},a)for(m in p)(L5||c||!(m in u))&&S7(u,m,p[m]);else ARe({target:e,proto:!0,forced:L5||c},p);return(!P5||a)&&u[zT]!==A&&S7(u,zT,A,{name:n}),Rie[e]=A,p}});var Qie=yt((X8t,jie)=>{"use strict";jie.exports=function(t,e){return{value:t,done:e}}});var I7=yt((q8t,Kie)=>{"use strict";var wRe=WE(),T7=vie(),zie=lw(),qie=NT(),vRe=Kg().f,CRe=Vie(),O5=Qie(),SRe=pp(),TRe=nf(),Wie="Array Iterator",IRe=qie.set,BRe=qie.getterFor(Wie);Kie.exports=CRe(Array,"Array",function(t,e){IRe(this,{type:Wie,target:wRe(t),index:0,kind:e})},function(){var t=BRe(this),e=t.target,r=t.index++;if(!e||r>=e.length)return t.target=void 0,O5(void 0,!0);switch(t.kind){case"keys":return O5(r,!1);case"values":return O5(e[r],!1)}return O5([r,e[r]],!1)},"values");var Xie=zie.Arguments=zie.Array;T7("keys");T7("values");T7("entries");if(!SRe&&TRe&&Xie.name!=="values")try{vRe(Xie,"name",{value:"values"})}catch{}});var $ie=yt((W8t,Jie)=>{"use strict";Jie.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}});var tne=yt((K8t,ene)=>{"use strict";var DRe=_T(),B7=DRe("span").classList,Zie=B7&&B7.constructor&&B7.constructor.prototype;ene.exports=Zie===Object.prototype?void 0:Zie});var ane=yt(()=>{"use strict";var rne=sl(),nne=$ie(),_Re=tne(),qT=I7(),ine=JE(),PRe=kT(),LRe=mc(),D7=LRe("iterator"),_7=qT.values,sne=function(t,e){if(t){if(t[D7]!==_7)try{ine(t,D7,_7)}catch{t[D7]=_7}if(PRe(t,e,!0),nne[e]){for(var r in qT)if(t[r]!==qT[r])try{ine(t,r,qT[r])}catch{t[r]=qT[r]}}}};for(N5 in nne)sne(rne[N5]&&rne[N5].prototype,N5);var N5;sne(_Re,"DOMTokenList")});function one(t,e){if(ys(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(ys(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lne=p0(()=>{PO()});function cne(t){var e=one(t,"string");return ys(e)=="symbol"?e:e+""}var une=p0(()=>{PO();lne()});function R5(t,e,r){return(e=cne(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var hne=p0(()=>{une()});var mne=yt((aFt,pne)=>{"use strict";var ORe=vm(),NRe=DT(),RRe=N8(),MRe=n5(),dne=TypeError,Ane="Reduce of empty array with no initial value",fne=function(t){return function(e,r,i,n){var s=NRe(e),a=RRe(s),o=MRe(s);if(ORe(r),o===0&&i<2)throw new dne(Ane);var l=t?o-1:0,c=t?-1:1;if(i<2)for(;;){if(l in a){n=a[l],l+=c;break}if(l+=c,t?l<0:o<=l)throw new dne(Ane)}for(;t?l>=0:o>l;l+=c)l in a&&(n=r(n,a[l],l,s));return n}};pne.exports={left:fne(!1),right:fne(!0)}});var P7=yt((oFt,gne)=>{"use strict";var kRe=al();gne.exports=function(t,e){var r=[][t];return!!r&&kRe(function(){r.call(null,e||function(){return 1},1)})}});var bne=yt(()=>{"use strict";var FRe=sh(),URe=mne().left,HRe=P7(),yne=zO(),GRe=$E(),YRe=!GRe&&yne>79&&yne<83,VRe=YRe||!HRe("reduce");FRe({target:"Array",proto:!0,forced:VRe},{reduce:function(e){var r=arguments.length;return URe(this,e,r,r>1?arguments[1]:void 0)}})});var wne=yt(()=>{"use strict";var jRe=sh(),QRe=UT(),zRe=PT().f,XRe=Pb(),xne=gp(),qRe=D5(),WRe=sf(),KRe=_5(),JRe=pp(),$Re=QRe("".slice),ZRe=Math.min,Ene=KRe("endsWith"),e4e=!JRe&&!Ene&&!!(function(){var t=zRe(String.prototype,"endsWith");return t&&!t.writable})();jRe({target:"String",proto:!0,forced:!e4e&&!Ene},{endsWith:function(e){var r=xne(WRe(this));qRe(e);var i=arguments.length>1?arguments[1]:void 0,n=r.length,s=i===void 0?n:ZRe(XRe(i),n),a=xne(e);return $Re(r,s-a.length,s)===a}})});var Ine=yt(()=>{"use strict";var L7=Yc(),Tne=ol(),t4e=S5(),r4e=nh(),i4e=Ly(),n4e=sf(),s4e=pF(),a4e=T5(),o4e=Pb(),vne=gp(),l4e=Db(),Cne=I5(),c4e=t7(),u4e=al(),hw=c4e.UNSUPPORTED_Y,h4e=4294967295,d4e=Math.min,O7=Tne([].push),N7=Tne("".slice),A4e=!u4e(function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return r.length!==2||r[0]!=="a"||r[1]!=="b"}),Sne="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;t4e("split",function(t,e,r){var i="0".split(void 0,0).length?function(n,s){return n===void 0&&s===0?[]:L7(e,this,n,s)}:e;return[function(s,a){var o=n4e(this),l=i4e(s)?void 0:l4e(s,t);return l?L7(l,s,o,a):L7(i,vne(o),s,a)},function(n,s){var a=r4e(this),o=vne(n);if(!Sne){var l=r(i,a,o,s,i!==e);if(l.done)return l.value}var c=s4e(a,RegExp),u=a.unicode,d=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(hw?"g":"y"),A=new c(hw?"^(?:"+a.source+")":a,d),h=s===void 0?h4e:s>>>0;if(h===0)return[];if(o.length===0)return Cne(A,o)===null?[o]:[];for(var f=0,p=0,m=[];p<o.length;){A.lastIndex=hw?0:p;var y=Cne(A,hw?N7(o,p):o),g;if(y===null||(g=d4e(o4e(A.lastIndex+(hw?p:0)),o.length))===f)p=a4e(o,p,u);else{if(O7(m,N7(o,f,p)),m.length===h)return m;for(var b=1;b<=y.length-1;b++)if(O7(m,y[b]),m.length===h)return m;p=f=g}}return O7(m,N7(o,f)),m}]},Sne||!A4e,hw)});var Dne=yt((Bne,WT)=>{(function(){var t,e,r,i,n,s;typeof performance<"u"&&performance!==null&&performance.now?WT.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(WT.exports=function(){return(t()-n)/1e6},e=process.hrtime,t=function(){var a;return a=e(),a[0]*1e9+a[1]},i=t(),s=process.uptime()*1e9,n=i-s):Date.now?(WT.exports=function(){return Date.now()-r},r=Date.now()):(WT.exports=function(){return new Date().getTime()-r},r=new Date().getTime())}).call(Bne)});var Pne=yt((fFt,F5)=>{var f4e=Dne(),$g=typeof window>"u"?global:window,M5=["moz","webkit"],Aw="AnimationFrame",fw=$g["request"+Aw],KT=$g["cancel"+Aw]||$g["cancelRequest"+Aw];for(dw=0;!fw&&dw<M5.length;dw++)fw=$g[M5[dw]+"Request"+Aw],KT=$g[M5[dw]+"Cancel"+Aw]||$g[M5[dw]+"CancelRequest"+Aw];var dw;(!fw||!KT)&&(k5=0,R7=0,My=[],_ne=1e3/60,fw=function(t){if(My.length===0){var e=f4e(),r=Math.max(0,_ne-(e-k5));k5=r+e,setTimeout(function(){var i=My.slice(0);My.length=0;for(var n=0;n<i.length;n++)if(!i[n].cancelled)try{i[n].callback(k5)}catch(s){setTimeout(function(){throw s},0)}},Math.round(r))}return My.push({handle:++R7,callback:t,cancelled:!1}),R7},KT=function(t){for(var e=0;e<My.length;e++)My[e].handle===t&&(My[e].cancelled=!0)});var k5,R7,My,_ne;F5.exports=function(t){return fw.call($g,t)};F5.exports.cancel=function(){KT.apply($g,arguments)};F5.exports.polyfill=function(t){t||(t=$g),t.requestAnimationFrame=fw,t.cancelAnimationFrame=KT}});var M7=yt((pFt,Lne)=>{"use strict";Lne.exports=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`});var Rne=yt((mFt,Nne)=>{"use strict";var p4e=ol(),m4e=sf(),g4e=gp(),F7=M7(),One=p4e("".replace),y4e=RegExp("^["+F7+"]+"),b4e=RegExp("(^|[^"+F7+"])["+F7+"]+$"),k7=function(t){return function(e){var r=g4e(m4e(e));return t&1&&(r=One(r,y4e,"")),t&2&&(r=One(r,b4e,"$1")),r}};Nne.exports={start:k7(1),end:k7(2),trim:k7(3)}});var Une=yt((gFt,Fne)=>{"use strict";var x4e=LT().PROPER,E4e=al(),Mne=M7(),kne="\u200B\x85\u180E";Fne.exports=function(t){return E4e(function(){return!!Mne[t]()||kne[t]()!==kne||x4e&&Mne[t].name!==t})}});var Hne=yt(()=>{"use strict";var w4e=sh(),v4e=Rne().trim,C4e=Une();w4e({target:"String",proto:!0,forced:C4e("trim")},{trim:function(){return v4e(this)}})});var Yne=yt((xFt,Gne)=>{Gne.exports=function(t){this.ok=!1,this.alpha=1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t=t.replace(/ /g,""),t=t.toLowerCase();var e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};t=e[t]||t;for(var r=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3]),parseFloat(l[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],i=0;i<r.length;i++){var n=r[i].re,s=r[i].process,a=n.exec(t);if(a){var o=s(a);this.r=o[0],this.g=o[1],this.b=o[2],o.length>3&&(this.alpha=o[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u},this.getHelpXML=function(){for(var l=new Array,c=0;c<r.length;c++)for(var u=r[c].example,d=0;d<u.length;d++)l[l.length]=u[d];for(var A in e)l[l.length]=A;var h=document.createElement("ul");h.setAttribute("id","rgbcolor-examples");for(var c=0;c<l.length;c++)try{var f=document.createElement("li"),p=new RGBColor(l[c]),m=document.createElement("div");m.style.cssText="margin: 3px; border: 1px solid black; background:"+p.toHex()+"; color:"+p.toHex(),m.appendChild(document.createTextNode("test"));var y=document.createTextNode(" "+l[c]+" -> "+p.toRGB()+" -> "+p.toHex());f.appendChild(m),f.appendChild(y),h.appendChild(f)}catch{}return h}}});var jne=yt(()=>{"use strict";var S4e=sh(),T4e=UT(),I4e=cF().indexOf,B4e=P7(),U7=T4e([].indexOf),Vne=!!U7&&1/U7([1],1,-0)<0,D4e=Vne||!B4e("indexOf");S4e({target:"Array",proto:!0,forced:D4e},{indexOf:function(e){var r=arguments.length>1?arguments[1]:void 0;return Vne?U7(this,e,r)||0:I4e(this,e,r)}})});var zne=yt(()=>{"use strict";var _4e=sh(),P4e=ol(),L4e=D5(),O4e=sf(),Qne=gp(),N4e=_5(),R4e=P4e("".indexOf);_4e({target:"String",proto:!0,forced:!N4e("includes")},{includes:function(e){return!!~R4e(Qne(O4e(this)),Qne(L4e(e)),arguments.length>1?arguments[1]:void 0)}})});var qne=yt((SFt,Xne)=>{"use strict";var M4e=Py();Xne.exports=Array.isArray||function(e){return M4e(e)==="Array"}});var Kne=yt(()=>{"use strict";var k4e=sh(),F4e=ol(),U4e=qne(),H4e=F4e([].reverse),Wne=[1,2];k4e({target:"Array",proto:!0,forced:String(Wne)===String(Wne.reverse())},{reverse:function(){return U4e(this)&&(this.length=this.length),H4e(this)}})});function nse(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}ise(t,e),t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function G4e(t){var e="";Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;r++){var i=t[r];if(i.type===cr.CLOSE_PATH)e+="z";else if(i.type===cr.HORIZ_LINE_TO)e+=(i.relative?"h":"H")+i.x;else if(i.type===cr.VERT_LINE_TO)e+=(i.relative?"v":"V")+i.y;else if(i.type===cr.MOVE_TO)e+=(i.relative?"m":"M")+i.x+" "+i.y;else if(i.type===cr.LINE_TO)e+=(i.relative?"l":"L")+i.x+" "+i.y;else if(i.type===cr.CURVE_TO)e+=(i.relative?"c":"C")+i.x1+" "+i.y1+" "+i.x2+" "+i.y2+" "+i.x+" "+i.y;else if(i.type===cr.SMOOTH_CURVE_TO)e+=(i.relative?"s":"S")+i.x2+" "+i.y2+" "+i.x+" "+i.y;else if(i.type===cr.QUAD_TO)e+=(i.relative?"q":"Q")+i.x1+" "+i.y1+" "+i.x+" "+i.y;else if(i.type===cr.SMOOTH_QUAD_TO)e+=(i.relative?"t":"T")+i.x+" "+i.y;else{if(i.type!==cr.ARC)throw new Error('Unexpected command type "'+i.type+'" at index '+r+".");e+=(i.relative?"a":"A")+i.rX+" "+i.rY+" "+i.xRot+" "+ +i.lArcFlag+" "+ +i.sweepFlag+" "+i.x+" "+i.y}}return e}function G7(t,e){var r=t[0],i=t[1];return[r*Math.cos(e)-i*Math.sin(e),r*Math.sin(e)+i*Math.cos(e)]}function bp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0;r<t.length;r++)if(typeof t[r]!="number")throw new Error("assertNumbers arguments["+r+"] is not a number. "+typeof t[r]+" == typeof "+t[r]);return!0}function H7(t,e,r){t.lArcFlag=t.lArcFlag===0?0:1,t.sweepFlag=t.sweepFlag===0?0:1;var i=t.rX,n=t.rY,s=t.x,a=t.y;i=Math.abs(t.rX),n=Math.abs(t.rY);var o=G7([(e-s)/2,(r-a)/2],-t.xRot/180*ky),l=o[0],c=o[1],u=Math.pow(l,2)/Math.pow(i,2)+Math.pow(c,2)/Math.pow(n,2);1<u&&(i*=Math.sqrt(u),n*=Math.sqrt(u)),t.rX=i,t.rY=n;var d=Math.pow(i,2)*Math.pow(c,2)+Math.pow(n,2)*Math.pow(l,2),A=(t.lArcFlag!==t.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(i,2)*Math.pow(n,2)-d)/d)),h=i*c/n*A,f=-n*l/i*A,p=G7([h,f],t.xRot/180*ky);t.cX=p[0]+(e+s)/2,t.cY=p[1]+(r+a)/2,t.phi1=Math.atan2((c-f)/n,(l-h)/i),t.phi2=Math.atan2((-c-f)/n,(-l-h)/i),t.sweepFlag===0&&t.phi2>t.phi1&&(t.phi2-=2*ky),t.sweepFlag===1&&t.phi2<t.phi1&&(t.phi2+=2*ky),t.phi1*=180/ky,t.phi2*=180/ky}function Jne(t,e,r){bp(t,e,r);var i=t*t+e*e-r*r;if(0>i)return[];if(i===0)return[[t*r/(t*t+e*e),e*r/(t*t+e*e)]];var n=Math.sqrt(i);return[[(t*r+e*n)/(t*t+e*e),(e*r-t*n)/(t*t+e*e)],[(t*r-e*n)/(t*t+e*e),(e*r+t*n)/(t*t+e*e)]]}function $ne(t,e,r){return(1-r)*t+r*e}function Zne(t,e,r,i){return t+Math.cos(i/180*ky)*e+Math.sin(i/180*ky)*r}function ese(t,e,r,i){var n=1e-6,s=e-t,a=r-e,o=3*s+3*(i-r)-6*a,l=6*(a-s),c=3*s;return Math.abs(o)<n?[-c/l]:(function(u,d,A){A===void 0&&(A=1e-6);var h=u*u/4-d;if(h<-A)return[];if(h<=A)return[-u/2];var f=Math.sqrt(h);return[-u/2-f,-u/2+f]})(l/o,c/o,n)}function tse(t,e,r,i,n){var s=1-n;return t*(s*s*s)+e*(3*s*s*n)+r*(3*s*n*n)+i*(n*n*n)}var ise,ky,Jl,Zg,yp,sse,Y4e,rse,V4e,cr,j4e,ase=p0(()=>{ise=function(t,e){return(ise=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(t,e)};ky=Math.PI;Zg=Math.PI/180;(function(t){function e(){return n((function(o,l,c){return o.relative&&(o.x1!==void 0&&(o.x1+=l),o.y1!==void 0&&(o.y1+=c),o.x2!==void 0&&(o.x2+=l),o.y2!==void 0&&(o.y2+=c),o.x!==void 0&&(o.x+=l),o.y!==void 0&&(o.y+=c),o.relative=!1),o}))}function r(){var o=NaN,l=NaN,c=NaN,u=NaN;return n((function(d,A,h){return d.type&cr.SMOOTH_CURVE_TO&&(d.type=cr.CURVE_TO,o=isNaN(o)?A:o,l=isNaN(l)?h:l,d.x1=d.relative?A-o:2*A-o,d.y1=d.relative?h-l:2*h-l),d.type&cr.CURVE_TO?(o=d.relative?A+d.x2:d.x2,l=d.relative?h+d.y2:d.y2):(o=NaN,l=NaN),d.type&cr.SMOOTH_QUAD_TO&&(d.type=cr.QUAD_TO,c=isNaN(c)?A:c,u=isNaN(u)?h:u,d.x1=d.relative?A-c:2*A-c,d.y1=d.relative?h-u:2*h-u),d.type&cr.QUAD_TO?(c=d.relative?A+d.x1:d.x1,u=d.relative?h+d.y1:d.y1):(c=NaN,u=NaN),d}))}function i(){var o=NaN,l=NaN;return n((function(c,u,d){if(c.type&cr.SMOOTH_QUAD_TO&&(c.type=cr.QUAD_TO,o=isNaN(o)?u:o,l=isNaN(l)?d:l,c.x1=c.relative?u-o:2*u-o,c.y1=c.relative?d-l:2*d-l),c.type&cr.QUAD_TO){o=c.relative?u+c.x1:c.x1,l=c.relative?d+c.y1:c.y1;var A=c.x1,h=c.y1;c.type=cr.CURVE_TO,c.x1=((c.relative?0:u)+2*A)/3,c.y1=((c.relative?0:d)+2*h)/3,c.x2=(c.x+2*A)/3,c.y2=(c.y+2*h)/3}else o=NaN,l=NaN;return c}))}function n(o){var l=0,c=0,u=NaN,d=NaN;return function(A){if(isNaN(u)&&!(A.type&cr.MOVE_TO))throw new Error("path must start with moveto");var h=o(A,l,c,u,d);return A.type&cr.CLOSE_PATH&&(l=u,c=d),A.x!==void 0&&(l=A.relative?l+A.x:A.x),A.y!==void 0&&(c=A.relative?c+A.y:A.y),A.type&cr.MOVE_TO&&(u=l,d=c),h}}function s(o,l,c,u,d,A){return bp(o,l,c,u,d,A),n((function(h,f,p,m){var y=h.x1,g=h.x2,b=h.relative&&!isNaN(m),E=h.x!==void 0?h.x:b?0:f,w=h.y!==void 0?h.y:b?0:p;function x(P){return P*P}h.type&cr.HORIZ_LINE_TO&&l!==0&&(h.type=cr.LINE_TO,h.y=h.relative?0:p),h.type&cr.VERT_LINE_TO&&c!==0&&(h.type=cr.LINE_TO,h.x=h.relative?0:f),h.x!==void 0&&(h.x=h.x*o+w*c+(b?0:d)),h.y!==void 0&&(h.y=E*l+h.y*u+(b?0:A)),h.x1!==void 0&&(h.x1=h.x1*o+h.y1*c+(b?0:d)),h.y1!==void 0&&(h.y1=y*l+h.y1*u+(b?0:A)),h.x2!==void 0&&(h.x2=h.x2*o+h.y2*c+(b?0:d)),h.y2!==void 0&&(h.y2=g*l+h.y2*u+(b?0:A));var I=o*u-l*c;if(h.xRot!==void 0&&(o!==1||l!==0||c!==0||u!==1))if(I===0)delete h.rX,delete h.rY,delete h.xRot,delete h.lArcFlag,delete h.sweepFlag,h.type=cr.LINE_TO;else{var C=h.xRot*Math.PI/180,G=Math.sin(C),U=Math.cos(C),_=1/x(h.rX),H=1/x(h.rY),Q=x(U)*_+x(G)*H,j=2*G*U*(_-H),$=x(G)*_+x(U)*H,B=Q*u*u-j*l*u+$*l*l,M=j*(o*u+l*c)-2*(Q*c*u+$*o*l),v=Q*c*c-j*o*c+$*o*o,N=(Math.atan2(M,B-v)+Math.PI)%Math.PI/2,R=Math.sin(N),q=Math.cos(N);h.rX=Math.abs(I)/Math.sqrt(B*x(q)+M*R*q+v*x(R)),h.rY=Math.abs(I)/Math.sqrt(B*x(R)-M*R*q+v*x(q)),h.xRot=180*N/Math.PI}return h.sweepFlag!==void 0&&0>I&&(h.sweepFlag=+!h.sweepFlag),h}))}function a(){return function(o){var l={};for(var c in o)l[c]=o[c];return l}}t.ROUND=function(o){function l(c){return Math.round(c*o)/o}return o===void 0&&(o=1e13),bp(o),function(c){return c.x1!==void 0&&(c.x1=l(c.x1)),c.y1!==void 0&&(c.y1=l(c.y1)),c.x2!==void 0&&(c.x2=l(c.x2)),c.y2!==void 0&&(c.y2=l(c.y2)),c.x!==void 0&&(c.x=l(c.x)),c.y!==void 0&&(c.y=l(c.y)),c.rX!==void 0&&(c.rX=l(c.rX)),c.rY!==void 0&&(c.rY=l(c.rY)),c}},t.TO_ABS=e,t.TO_REL=function(){return n((function(o,l,c){return o.relative||(o.x1!==void 0&&(o.x1-=l),o.y1!==void 0&&(o.y1-=c),o.x2!==void 0&&(o.x2-=l),o.y2!==void 0&&(o.y2-=c),o.x!==void 0&&(o.x-=l),o.y!==void 0&&(o.y-=c),o.relative=!0),o}))},t.NORMALIZE_HVZ=function(o,l,c){return o===void 0&&(o=!0),l===void 0&&(l=!0),c===void 0&&(c=!0),n((function(u,d,A,h,f){if(isNaN(h)&&!(u.type&cr.MOVE_TO))throw new Error("path must start with moveto");return l&&u.type&cr.HORIZ_LINE_TO&&(u.type=cr.LINE_TO,u.y=u.relative?0:A),c&&u.type&cr.VERT_LINE_TO&&(u.type=cr.LINE_TO,u.x=u.relative?0:d),o&&u.type&cr.CLOSE_PATH&&(u.type=cr.LINE_TO,u.x=u.relative?h-d:h,u.y=u.relative?f-A:f),u.type&cr.ARC&&(u.rX===0||u.rY===0)&&(u.type=cr.LINE_TO,delete u.rX,delete u.rY,delete u.xRot,delete u.lArcFlag,delete u.sweepFlag),u}))},t.NORMALIZE_ST=r,t.QT_TO_C=i,t.INFO=n,t.SANITIZE=function(o){o===void 0&&(o=0),bp(o);var l=NaN,c=NaN,u=NaN,d=NaN;return n((function(A,h,f,p,m){var y=Math.abs,g=!1,b=0,E=0;if(A.type&cr.SMOOTH_CURVE_TO&&(b=isNaN(l)?0:h-l,E=isNaN(c)?0:f-c),A.type&(cr.CURVE_TO|cr.SMOOTH_CURVE_TO)?(l=A.relative?h+A.x2:A.x2,c=A.relative?f+A.y2:A.y2):(l=NaN,c=NaN),A.type&cr.SMOOTH_QUAD_TO?(u=isNaN(u)?h:2*h-u,d=isNaN(d)?f:2*f-d):A.type&cr.QUAD_TO?(u=A.relative?h+A.x1:A.x1,d=A.relative?f+A.y1:A.y2):(u=NaN,d=NaN),A.type&cr.LINE_COMMANDS||A.type&cr.ARC&&(A.rX===0||A.rY===0||!A.lArcFlag)||A.type&cr.CURVE_TO||A.type&cr.SMOOTH_CURVE_TO||A.type&cr.QUAD_TO||A.type&cr.SMOOTH_QUAD_TO){var w=A.x===void 0?0:A.relative?A.x:A.x-h,x=A.y===void 0?0:A.relative?A.y:A.y-f;b=isNaN(u)?A.x1===void 0?b:A.relative?A.x:A.x1-h:u-h,E=isNaN(d)?A.y1===void 0?E:A.relative?A.y:A.y1-f:d-f;var I=A.x2===void 0?0:A.relative?A.x:A.x2-h,C=A.y2===void 0?0:A.relative?A.y:A.y2-f;y(w)<=o&&y(x)<=o&&y(b)<=o&&y(E)<=o&&y(I)<=o&&y(C)<=o&&(g=!0)}return A.type&cr.CLOSE_PATH&&y(h-p)<=o&&y(f-m)<=o&&(g=!0),g?[]:A}))},t.MATRIX=s,t.ROTATE=function(o,l,c){l===void 0&&(l=0),c===void 0&&(c=0),bp(o,l,c);var u=Math.sin(o),d=Math.cos(o);return s(d,u,-u,d,l-l*d+c*u,c-l*u-c*d)},t.TRANSLATE=function(o,l){return l===void 0&&(l=0),bp(o,l),s(1,0,0,1,o,l)},t.SCALE=function(o,l){return l===void 0&&(l=o),bp(o,l),s(o,0,0,l,0,0)},t.SKEW_X=function(o){return bp(o),s(1,0,Math.atan(o),1,0,0)},t.SKEW_Y=function(o){return bp(o),s(1,Math.atan(o),0,1,0,0)},t.X_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),bp(o),s(-1,0,0,1,o,0)},t.Y_AXIS_SYMMETRY=function(o){return o===void 0&&(o=0),bp(o),s(1,0,0,-1,0,o)},t.A_TO_C=function(){return n((function(o,l,c){return cr.ARC===o.type?(function(u,d,A){var h,f,p,m;u.cX||H7(u,d,A);for(var y=Math.min(u.phi1,u.phi2),g=Math.max(u.phi1,u.phi2)-y,b=Math.ceil(g/90),E=new Array(b),w=d,x=A,I=0;I<b;I++){var C=$ne(u.phi1,u.phi2,I/b),G=$ne(u.phi1,u.phi2,(I+1)/b),U=G-C,_=4/3*Math.tan(U*Zg/4),H=[Math.cos(C*Zg)-_*Math.sin(C*Zg),Math.sin(C*Zg)+_*Math.cos(C*Zg)],Q=H[0],j=H[1],$=[Math.cos(G*Zg),Math.sin(G*Zg)],B=$[0],M=$[1],v=[B+_*Math.sin(G*Zg),M-_*Math.cos(G*Zg)],N=v[0],R=v[1];E[I]={relative:u.relative,type:cr.CURVE_TO};var q=function(P,z){var W=G7([P*u.rX,z*u.rY],u.xRot),oe=W[0],Ae=W[1];return[u.cX+oe,u.cY+Ae]};h=q(Q,j),E[I].x1=h[0],E[I].y1=h[1],f=q(N,R),E[I].x2=f[0],E[I].y2=f[1],p=q(B,M),E[I].x=p[0],E[I].y=p[1],u.relative&&(E[I].x1-=w,E[I].y1-=x,E[I].x2-=w,E[I].y2-=x,E[I].x-=w,E[I].y-=x),w=(m=[E[I].x,E[I].y])[0],x=m[1]}return E})(o,o.relative?0:l,o.relative?0:c):o}))},t.ANNOTATE_ARCS=function(){return n((function(o,l,c){return o.relative&&(l=0,c=0),cr.ARC===o.type&&H7(o,l,c),o}))},t.CLONE=a,t.CALCULATE_BOUNDS=function(){var o=function(A){var h={};for(var f in A)h[f]=A[f];return h},l=e(),c=i(),u=r(),d=n((function(A,h,f){var p=u(c(l(o(A))));function m(R){R>d.maxX&&(d.maxX=R),R<d.minX&&(d.minX=R)}function y(R){R>d.maxY&&(d.maxY=R),R<d.minY&&(d.minY=R)}if(p.type&cr.DRAWING_COMMANDS&&(m(h),y(f)),p.type&cr.HORIZ_LINE_TO&&m(p.x),p.type&cr.VERT_LINE_TO&&y(p.y),p.type&cr.LINE_TO&&(m(p.x),y(p.y)),p.type&cr.CURVE_TO){m(p.x),y(p.y);for(var g=0,b=ese(h,p.x1,p.x2,p.x);g<b.length;g++)0<(N=b[g])&&1>N&&m(tse(h,p.x1,p.x2,p.x,N));for(var E=0,w=ese(f,p.y1,p.y2,p.y);E<w.length;E++)0<(N=w[E])&&1>N&&y(tse(f,p.y1,p.y2,p.y,N))}if(p.type&cr.ARC){m(p.x),y(p.y),H7(p,h,f);for(var x=p.xRot/180*Math.PI,I=Math.cos(x)*p.rX,C=Math.sin(x)*p.rX,G=-Math.sin(x)*p.rY,U=Math.cos(x)*p.rY,_=p.phi1<p.phi2?[p.phi1,p.phi2]:-180>p.phi2?[p.phi2+360,p.phi1+360]:[p.phi2,p.phi1],H=_[0],Q=_[1],j=function(R){var q=R[0],P=R[1],z=180*Math.atan2(P,q)/Math.PI;return z<H?z+360:z},$=0,B=Jne(G,-I,0).map(j);$<B.length;$++)(N=B[$])>H&&N<Q&&m(Zne(p.cX,I,G,N));for(var M=0,v=Jne(U,-C,0).map(j);M<v.length;M++){var N;(N=v[M])>H&&N<Q&&y(Zne(p.cY,C,U,N))}}return A}));return d.minX=1/0,d.maxX=-1/0,d.minY=1/0,d.maxY=-1/0,d}})(Jl||(Jl={}));sse=(function(){function t(){}return t.prototype.round=function(e){return this.transform(Jl.ROUND(e))},t.prototype.toAbs=function(){return this.transform(Jl.TO_ABS())},t.prototype.toRel=function(){return this.transform(Jl.TO_REL())},t.prototype.normalizeHVZ=function(e,r,i){return this.transform(Jl.NORMALIZE_HVZ(e,r,i))},t.prototype.normalizeST=function(){return this.transform(Jl.NORMALIZE_ST())},t.prototype.qtToC=function(){return this.transform(Jl.QT_TO_C())},t.prototype.aToC=function(){return this.transform(Jl.A_TO_C())},t.prototype.sanitize=function(e){return this.transform(Jl.SANITIZE(e))},t.prototype.translate=function(e,r){return this.transform(Jl.TRANSLATE(e,r))},t.prototype.scale=function(e,r){return this.transform(Jl.SCALE(e,r))},t.prototype.rotate=function(e,r,i){return this.transform(Jl.ROTATE(e,r,i))},t.prototype.matrix=function(e,r,i,n,s,a){return this.transform(Jl.MATRIX(e,r,i,n,s,a))},t.prototype.skewX=function(e){return this.transform(Jl.SKEW_X(e))},t.prototype.skewY=function(e){return this.transform(Jl.SKEW_Y(e))},t.prototype.xSymmetry=function(e){return this.transform(Jl.X_AXIS_SYMMETRY(e))},t.prototype.ySymmetry=function(e){return this.transform(Jl.Y_AXIS_SYMMETRY(e))},t.prototype.annotateArcs=function(){return this.transform(Jl.ANNOTATE_ARCS())},t})(),Y4e=function(t){return t===" "||t==="	"||t==="\r"||t===`
`},rse=function(t){return 48<=t.charCodeAt(0)&&t.charCodeAt(0)<=57},V4e=(function(t){function e(){var r=t.call(this)||this;return r.curNumber="",r.curCommandType=-1,r.curCommandRelative=!1,r.canParseCommandOrComma=!0,r.curNumberHasExp=!1,r.curNumberHasExpDigits=!1,r.curNumberHasDecimal=!1,r.curArgs=[],r}return nse(e,t),e.prototype.finish=function(r){if(r===void 0&&(r=[]),this.parse(" ",r),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return r},e.prototype.parse=function(r,i){var n=this;i===void 0&&(i=[]);for(var s=function(d){i.push(d),n.curArgs.length=0,n.canParseCommandOrComma=!0},a=0;a<r.length;a++){var o=r[a],l=!(this.curCommandType!==cr.ARC||this.curArgs.length!==3&&this.curArgs.length!==4||this.curNumber.length!==1||this.curNumber!=="0"&&this.curNumber!=="1"),c=rse(o)&&(this.curNumber==="0"&&o==="0"||l);if(!rse(o)||c)if(o!=="e"&&o!=="E")if(o!=="-"&&o!=="+"||!this.curNumberHasExp||this.curNumberHasExpDigits)if(o!=="."||this.curNumberHasExp||this.curNumberHasDecimal||l){if(this.curNumber&&this.curCommandType!==-1){var u=Number(this.curNumber);if(isNaN(u))throw new SyntaxError("Invalid number ending at "+a);if(this.curCommandType===cr.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>u)throw new SyntaxError('Expected positive number, got "'+u+'" at index "'+a+'"')}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+a+'"')}this.curArgs.push(u),this.curArgs.length===j4e[this.curCommandType]&&(cr.HORIZ_LINE_TO===this.curCommandType?s({type:cr.HORIZ_LINE_TO,relative:this.curCommandRelative,x:u}):cr.VERT_LINE_TO===this.curCommandType?s({type:cr.VERT_LINE_TO,relative:this.curCommandRelative,y:u}):this.curCommandType===cr.MOVE_TO||this.curCommandType===cr.LINE_TO||this.curCommandType===cr.SMOOTH_QUAD_TO?(s({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),cr.MOVE_TO===this.curCommandType&&(this.curCommandType=cr.LINE_TO)):this.curCommandType===cr.CURVE_TO?s({type:cr.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===cr.SMOOTH_CURVE_TO?s({type:cr.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===cr.QUAD_TO?s({type:cr.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===cr.ARC&&s({type:cr.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!Y4e(o))if(o===","&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if(o!=="+"&&o!=="-"&&o!==".")if(c)this.curNumber=o,this.curNumberHasDecimal=!1;else{if(this.curArgs.length!==0)throw new SyntaxError("Unterminated command at index "+a+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+o+'" at index '+a+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,o!=="z"&&o!=="Z")if(o==="h"||o==="H")this.curCommandType=cr.HORIZ_LINE_TO,this.curCommandRelative=o==="h";else if(o==="v"||o==="V")this.curCommandType=cr.VERT_LINE_TO,this.curCommandRelative=o==="v";else if(o==="m"||o==="M")this.curCommandType=cr.MOVE_TO,this.curCommandRelative=o==="m";else if(o==="l"||o==="L")this.curCommandType=cr.LINE_TO,this.curCommandRelative=o==="l";else if(o==="c"||o==="C")this.curCommandType=cr.CURVE_TO,this.curCommandRelative=o==="c";else if(o==="s"||o==="S")this.curCommandType=cr.SMOOTH_CURVE_TO,this.curCommandRelative=o==="s";else if(o==="q"||o==="Q")this.curCommandType=cr.QUAD_TO,this.curCommandRelative=o==="q";else if(o==="t"||o==="T")this.curCommandType=cr.SMOOTH_QUAD_TO,this.curCommandRelative=o==="t";else{if(o!=="a"&&o!=="A")throw new SyntaxError('Unexpected character "'+o+'" at index '+a+".");this.curCommandType=cr.ARC,this.curCommandRelative=o==="a"}else i.push({type:cr.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=o,this.curNumberHasDecimal=o==="."}else this.curNumber+=o,this.curNumberHasDecimal=!0;else this.curNumber+=o;else this.curNumber+=o,this.curNumberHasExp=!0;else this.curNumber+=o,this.curNumberHasExpDigits=this.curNumberHasExp}return i},e.prototype.transform=function(r){return Object.create(this,{parse:{value:function(i,n){n===void 0&&(n=[]);for(var s=0,a=Object.getPrototypeOf(this).parse.call(this,i);s<a.length;s++){var o=a[s],l=r(o);Array.isArray(l)?n.push.apply(n,l):n.push(l)}return n}}})},e})(sse),cr=(function(t){function e(r){var i=t.call(this)||this;return i.commands=typeof r=="string"?e.parse(r):r,i}return nse(e,t),e.prototype.encode=function(){return e.encode(this.commands)},e.prototype.getBounds=function(){var r=Jl.CALCULATE_BOUNDS();return this.transform(r),r},e.prototype.transform=function(r){for(var i=[],n=0,s=this.commands;n<s.length;n++){var a=r(s[n]);Array.isArray(a)?i.push.apply(i,a):i.push(a)}return this.commands=i,this},e.encode=function(r){return G4e(r)},e.parse=function(r){var i=new V4e,n=[];return i.parse(r,n),i.finish(n),n},e.CLOSE_PATH=1,e.MOVE_TO=2,e.HORIZ_LINE_TO=4,e.VERT_LINE_TO=8,e.LINE_TO=16,e.CURVE_TO=32,e.SMOOTH_CURVE_TO=64,e.QUAD_TO=128,e.SMOOTH_QUAD_TO=256,e.ARC=512,e.LINE_COMMANDS=e.LINE_TO|e.HORIZ_LINE_TO|e.VERT_LINE_TO,e.DRAWING_COMMANDS=e.HORIZ_LINE_TO|e.VERT_LINE_TO|e.LINE_TO|e.CURVE_TO|e.SMOOTH_CURVE_TO|e.QUAD_TO|e.SMOOTH_QUAD_TO|e.ARC,e})(sse),j4e=((yp={})[cr.MOVE_TO]=2,yp[cr.LINE_TO]=2,yp[cr.HORIZ_LINE_TO]=1,yp[cr.VERT_LINE_TO]=1,yp[cr.CLOSE_PATH]=0,yp[cr.QUAD_TO]=4,yp[cr.SMOOTH_QUAD_TO]=2,yp[cr.CURVE_TO]=6,yp[cr.SMOOTH_CURVE_TO]=4,yp[cr.ARC]=7,yp)});var cse=yt((DFt,lse)=>{"use strict";var Q4e=Yc(),z4e=of(),X4e=TT(),q4e=JF(),ose=RegExp.prototype;lse.exports=function(t){var e=t.flags;return e===void 0&&!("flags"in ose)&&!z4e(t,"flags")&&X4e(ose,t)?Q4e(q4e,t):e}});var Ase=yt(()=>{"use strict";var W4e=LT().PROPER,K4e=Ny(),J4e=nh(),use=gp(),$4e=al(),Z4e=cse(),Y7="toString",hse=RegExp.prototype,dse=hse[Y7],eMe=$4e(function(){return dse.call({source:"a",flags:"b"})!=="/a/b"}),tMe=W4e&&dse.name!==Y7;(eMe||tMe)&&K4e(hse,Y7,function(){var e=J4e(this),r=use(e.source),i=use(Z4e(e));return"/"+r+"/"+i},{unsafe:!0})});function U5(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?U5=function(e){return typeof e}:U5=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U5(t)}function rMe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sMe(t,e,r,i,n){if(typeof t=="string"&&(t=document.getElementById(t)),!t||U5(t)!=="object"||!("getContext"in t))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var s=t.getContext("2d");try{return s.getImageData(e,r,i,n)}catch(a){throw new Error("unable to access image data: "+a)}}function pse(t,e,r,i,n,s){if(!(isNaN(s)||s<1)){s|=0;var a=sMe(t,e,r,i,n);a=aMe(a,e,r,i,n,s),t.getContext("2d").putImageData(a,e,r)}}function aMe(t,e,r,i,n,s){for(var a=t.data,o=2*s+1,l=i-1,c=n-1,u=s+1,d=u*(u+1)/2,A=new fse,h=A,f,p=1;p<o;p++)h=h.next=new fse,p===u&&(f=h);h.next=A;for(var m=null,y=null,g=0,b=0,E=iMe[s],w=nMe[s],x=0;x<n;x++){h=A;for(var I=a[b],C=a[b+1],G=a[b+2],U=a[b+3],_=0;_<u;_++)h.r=I,h.g=C,h.b=G,h.a=U,h=h.next;for(var H=0,Q=0,j=0,$=0,B=u*I,M=u*C,v=u*G,N=u*U,R=d*I,q=d*C,P=d*G,z=d*U,W=1;W<u;W++){var oe=b+((l<W?l:W)<<2),Ae=a[oe],me=a[oe+1],ve=a[oe+2],Le=a[oe+3],He=u-W;R+=(h.r=Ae)*He,q+=(h.g=me)*He,P+=(h.b=ve)*He,z+=(h.a=Le)*He,H+=Ae,Q+=me,j+=ve,$+=Le,h=h.next}m=A,y=f;for(var rt=0;rt<i;rt++){var qe=z*E>>>w;if(a[b+3]=qe,qe!==0){var xt=255/qe;a[b]=(R*E>>>w)*xt,a[b+1]=(q*E>>>w)*xt,a[b+2]=(P*E>>>w)*xt}else a[b]=a[b+1]=a[b+2]=0;R-=B,q-=M,P-=v,z-=N,B-=m.r,M-=m.g,v-=m.b,N-=m.a;var Gt=rt+s+1;Gt=g+(Gt<l?Gt:l)<<2,H+=m.r=a[Gt],Q+=m.g=a[Gt+1],j+=m.b=a[Gt+2],$+=m.a=a[Gt+3],R+=H,q+=Q,P+=j,z+=$,m=m.next;var ut=y,Pe=ut.r,ft=ut.g,ht=ut.b,Qt=ut.a;B+=Pe,M+=ft,v+=ht,N+=Qt,H-=Pe,Q-=ft,j-=ht,$-=Qt,y=y.next,b+=4}g+=i}for(var Yt=0;Yt<i;Yt++){b=Yt<<2;var Ft=a[b],kt=a[b+1],sr=a[b+2],Pt=a[b+3],_r=u*Ft,Lt=u*kt,ct=u*sr,Zt=u*Pt,Jt=d*Ft,O=d*kt,K=d*sr,se=d*Pt;h=A;for(var ae=0;ae<u;ae++)h.r=Ft,h.g=kt,h.b=sr,h.a=Pt,h=h.next;for(var ue=i,Ie=0,Ce=0,st=0,it=0,Kt=1;Kt<=s;Kt++){b=ue+Yt<<2;var ar=u-Kt;Jt+=(h.r=Ft=a[b])*ar,O+=(h.g=kt=a[b+1])*ar,K+=(h.b=sr=a[b+2])*ar,se+=(h.a=Pt=a[b+3])*ar,it+=Ft,Ie+=kt,Ce+=sr,st+=Pt,h=h.next,Kt<c&&(ue+=i)}b=Yt,m=A,y=f;for(var lr=0;lr<n;lr++){var yr=b<<2;a[yr+3]=Pt=se*E>>>w,Pt>0?(Pt=255/Pt,a[yr]=(Jt*E>>>w)*Pt,a[yr+1]=(O*E>>>w)*Pt,a[yr+2]=(K*E>>>w)*Pt):a[yr]=a[yr+1]=a[yr+2]=0,Jt-=_r,O-=Lt,K-=ct,se-=Zt,_r-=m.r,Lt-=m.g,ct-=m.b,Zt-=m.a,yr=Yt+((yr=lr+u)<c?yr:c)*i<<2,Jt+=it+=m.r=a[yr],O+=Ie+=m.g=a[yr+1],K+=Ce+=m.b=a[yr+2],se+=st+=m.a=a[yr+3],m=m.next,_r+=Ft=y.r,Lt+=kt=y.g,ct+=sr=y.b,Zt+=Pt=y.a,it-=Ft,Ie-=kt,Ce-=sr,st-=Pt,y=y.next,b+=i}}return t}var iMe,nMe,fse,mse=p0(()=>{iMe=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],nMe=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];fse=function t(){rMe(this,t),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}});var Bse={};Ooe(Bse,{AElement:()=>m3,AnimateColorElement:()=>u3,AnimateElement:()=>gw,AnimateTransformElement:()=>h3,BoundingBox:()=>wd,CB1:()=>Q7,CB2:()=>z7,CB3:()=>X7,CB4:()=>q7,Canvg:()=>eU,CircleElement:()=>e3,ClipPathElement:()=>w3,DefsElement:()=>a3,DescElement:()=>B3,Document:()=>Ub,Element:()=>Ao,EllipseElement:()=>t3,FeColorMatrixElement:()=>sI,FeCompositeElement:()=>S3,FeDropShadowElement:()=>v3,FeGaussianBlurElement:()=>T3,FeMorphologyElement:()=>C3,FilterElement:()=>oI,Font:()=>lf,FontElement:()=>d3,FontFaceElement:()=>A3,GElement:()=>mw,GlyphElement:()=>ZT,GradientElement:()=>iI,ImageElement:()=>y3,LineElement:()=>r3,LinearGradientElement:()=>o3,MarkerElement:()=>s3,MaskElement:()=>aI,Matrix:()=>JT,MissingGlyphElement:()=>f3,Mouse:()=>X5,PSEUDO_ZERO:()=>Mb,Parser:()=>pw,PathElement:()=>Cl,PathParser:()=>pn,PatternElement:()=>n3,Point:()=>Zl,PolygonElement:()=>i3,PolylineElement:()=>rI,Property:()=>ki,QB1:()=>W7,QB2:()=>K7,QB3:()=>J7,RadialGradientElement:()=>l3,RectElement:()=>tI,RenderedElement:()=>Sm,Rotate:()=>W5,SVGElement:()=>Uy,SVGFontLoader:()=>x3,Scale:()=>K5,Screen:()=>kb,Skew:()=>$T,SkewX:()=>J5,SkewY:()=>$5,StopElement:()=>c3,StyleElement:()=>nI,SymbolElement:()=>b3,TRefElement:()=>p3,TSpanElement:()=>eI,TextElement:()=>Fy,TextPathElement:()=>g3,TitleElement:()=>I3,Transform:()=>Fb,Translate:()=>q5,UnknownElement:()=>Z5,UseElement:()=>E3,ViewPort:()=>z5,compressSpaces:()=>Hb,default:()=>eU,getSelectorSpecificity:()=>Sse,normalizeAttributeName:()=>vse,normalizeColor:()=>Cse,parseExternalUrl:()=>tU,presets:()=>cMe,toNumbers:()=>Ed,trimLeft:()=>Ese,trimRight:()=>wse,vectorMagnitude:()=>V7,vectorsAngle:()=>j7,vectorsRatio:()=>Q5});function oMe(){var{DOMParser:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e={window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:t,createCanvas(r,i){return new OffscreenCanvas(r,i)},createImage(r){return Cm(function*(){var i=yield fetch(r),n=yield i.blob(),s=yield createImageBitmap(n);return s})()}};return(typeof DOMParser<"u"||typeof t>"u")&&Reflect.deleteProperty(e,"DOMParser"),e}function lMe(t){var{DOMParser:e,canvas:r,fetch:i}=t;return{window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:e,fetch:i,createCanvas:r.createCanvas,createImage:r.loadImage}}function Hb(t){return t.replace(/(?!\u3000)\s+/gm," ")}function Ese(t){return t.replace(/^[\n \t]+/,"")}function wse(t){return t.replace(/[\n \t]+$/,"")}function Ed(t){var e=(t||"").match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm)||[];return e.map(parseFloat)}function vse(t){return uMe.test(t)?t.toLowerCase():t}function tU(t){var e=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(t)||[];return e[2]||e[3]||e[4]}function Cse(t){if(!t.startsWith("rgb"))return t;var e=3,r=t.replace(/\d+(\.\d+)?/g,(i,n)=>e--&&n?String(Math.round(parseFloat(i))):i);return r}function Nb(t,e){var r=e.exec(t);return r?[t.replace(e," "),r.length]:[t,0]}function Sse(t){var e=[0,0,0],r=t.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),i=0;return[r,i]=Nb(r,hMe),e[1]+=i,[r,i]=Nb(r,dMe),e[0]+=i,[r,i]=Nb(r,AMe),e[1]+=i,[r,i]=Nb(r,fMe),e[2]+=i,[r,i]=Nb(r,pMe),e[1]+=i,[r,i]=Nb(r,mMe),e[1]+=i,r=r.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[r,i]=Nb(r,gMe),e[2]+=i,e.join("")}function V7(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))}function Q5(t,e){return(t[0]*e[0]+t[1]*e[1])/(V7(t)*V7(e))}function j7(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(Q5(t,e))}function Q7(t){return t*t*t}function z7(t){return 3*t*t*(1-t)}function X7(t){return 3*t*(1-t)*(1-t)}function q7(t){return(1-t)*(1-t)*(1-t)}function W7(t){return t*t}function K7(t){return 2*t*(1-t)}function J7(t){return(1-t)*(1-t)}function xMe(t){return Hb(t).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}function EMe(t){var[e,r]=t.split("(");return[e.trim(),r.trim().replace(")","")]}function wMe(t){var e=t.trim();return/^('|")/.test(e)?e:'"'.concat(e,'"')}function vMe(t){return typeof process>"u"?t:t.trim().split(",").map(wMe).join(",")}function CMe(t){if(!t)return"";var e=t.trim().toLowerCase();switch(e){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return e;default:return/^oblique\s+(-|)\d+deg$/.test(e)?e:""}}function SMe(t){if(!t)return"";var e=t.trim().toLowerCase();switch(e){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return e;default:return/^[\d.]+$/.test(e)?e:""}}function gse(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,i)}return r}function H5(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gse(Object(r),!0).forEach(function(i){R5(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gse(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function G5(t,e,r,i,n,s){return t[r*i*4+e*4+s]}function Y5(t,e,r,i,n,s,a){t[r*i*4+e*4+s]=a}function $l(t,e,r){var i=t[e];return i*r}function e0(t,e,r,i){return e+Math.cos(t)*r+Math.sin(t)*i}function bse(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,i)}return r}function BMe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bse(Object(r),!0).forEach(function(i){R5(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bse(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function DMe(t,e){var r=document.createElement("canvas");return r.width=t,r.height=e,r}function _Me(t){return Z7.apply(this,arguments)}function Z7(){return Z7=Cm(function*(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=document.createElement("img");return e&&(r.crossOrigin="Anonymous"),new Promise((i,n)=>{r.onload=()=>{i(r)},r.onerror=(s,a,o,l,c)=>{n(c)},r.src=t})}),Z7.apply(this,arguments)}function xse(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,i)}return r}function Rb(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?xse(Object(r),!0).forEach(function(i){R5(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xse(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var OFt,RFt,MFt,kFt,FFt,UFt,GFt,YFt,VFt,V5,jFt,j5,QFt,zFt,XFt,WFt,cMe,uMe,hMe,dMe,AMe,fMe,pMe,mMe,gMe,Mb,ki,z5,Zl,X5,Tse,Ise,kb,yMe,bMe,pw,q5,W5,K5,JT,$T,J5,$5,Fb,Ao,Z5,lf,wd,pn,Sm,Cl,ZT,Fy,eI,$7,Uy,tI,e3,t3,r3,rI,i3,n3,s3,a3,mw,iI,o3,l3,c3,gw,u3,h3,d3,A3,f3,p3,m3,g3,TMe,y3,b3,x3,nI,E3,sI,aI,yse,w3,oI,v3,C3,S3,T3,I3,B3,IMe,Ub,eU,Dse=p0(()=>{OFt=pa(vre(),1);Sre();RFt=pa(oie(),1),MFt=pa(fie(),1),kFt=pa(Eie(),1),FFt=pa(I7(),1),UFt=pa(ane(),1);hne();GFt=pa(bne(),1),YFt=pa(wne(),1),VFt=pa(Ine(),1),V5=pa(Pne(),1),jFt=pa(Hne(),1),j5=pa(Yne(),1),QFt=pa(jne(),1),zFt=pa(zne(),1),XFt=pa(Kne(),1);ase();WFt=pa(Ase(),1);mse();cMe=Object.freeze({__proto__:null,offscreen:oMe,node:lMe});uMe=/^[A-Z-]+$/;hMe=/(\[[^\]]+\])/g,dMe=/(#[^\s+>~.[:]+)/g,AMe=/(\.[^\s+>~.[:]+)/g,fMe=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,pMe=/(:[\w-]+\([^)]*\))/gi,mMe=/(:[^\s+>~.[:]+)/g,gMe=/([^\s+>~.[:]+)/g;Mb=1e-8;ki=class t{constructor(e,r,i){this.document=e,this.name=r,this.value=i,this.isNormalizedColor=!1}static empty(e){return new t(e,"EMPTY","")}split(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:" ",{document:r,name:i}=this;return Hb(this.getString()).trim().split(e).map(n=>new t(r,i,n))}hasValue(e){var{value:r}=this;return r!==null&&r!==""&&(e||r!==0)&&typeof r<"u"}isString(e){var{value:r}=this,i=typeof r=="string";return!i||!e?i:e.test(r)}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;var e=this.getString();switch(!0){case e.endsWith("px"):case/^[0-9]+$/.test(e):return!0;default:return!1}}setValue(e){return this.value=e,this}getValue(e){return typeof e>"u"||this.hasValue()?this.value:e}getNumber(e){if(!this.hasValue())return typeof e>"u"?0:parseFloat(e);var{value:r}=this,i=parseFloat(r);return this.isString(/%$/)&&(i/=100),i}getString(e){return typeof e>"u"||this.hasValue()?typeof this.value>"u"?"":String(this.value):String(e)}getColor(e){var r=this.getString(e);return this.isNormalizedColor||(this.isNormalizedColor=!0,r=Cse(r),this.value=r),r}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!this.hasValue())return 0;var[i,n]=typeof e=="boolean"?[void 0,e]:[e],{viewPort:s}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(s.computeSize("x"),s.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(s.computeSize("x"),s.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*s.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*s.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return this.getNumber()*15;case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case(this.isString(/%$/)&&n):return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*s.computeSize(i);default:{var a=this.getNumber();return r&&a<1?a*s.computeSize(i):a}}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():this.getNumber()*1e3:0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){var e=this.getString(),r=/#([^)'"]+)/.exec(e);return r&&(r=r[1]),r||(r=e),this.document.definitions[r]}getFillStyleDefinition(e,r){var i=this.getDefinition();if(!i)return null;if(typeof i.createGradient=="function")return i.createGradient(this.document.ctx,e,r);if(typeof i.createPattern=="function"){if(i.getHrefAttribute().hasValue()){var n=i.getAttribute("patternTransform");i=i.getHrefAttribute().getDefinition(),n.hasValue()&&i.getAttribute("patternTransform",!0).setValue(n.value)}return i.createPattern(this.document.ctx,e,r)}return null}getTextBaseline(){return this.hasValue()?t.textBaselineMapping[this.getString()]:null}addOpacity(e){for(var r=this.getColor(),i=r.length,n=0,s=0;s<i&&(r[s]===","&&n++,n!==3);s++);if(e.hasValue()&&this.isString()&&n!==3){var a=new j5.default(r);a.ok&&(a.alpha=e.getNumber(),r=a.toRGBA())}return new t(this.document,this.name,r)}};ki.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};z5=class{constructor(){this.viewPorts=[]}clear(){this.viewPorts=[]}setCurrent(e,r){this.viewPorts.push({width:e,height:r})}removeCurrent(){this.viewPorts.pop()}getCurrent(){var{viewPorts:e}=this;return e[e.length-1]}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(e){return typeof e=="number"?e:e==="x"?this.width:e==="y"?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}},Zl=class t{constructor(e,r){this.x=e,this.y=r}static parse(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,[i=r,n=r]=Ed(e);return new t(i,n)}static parseScale(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,[i=r,n=i]=Ed(e);return new t(i,n)}static parsePath(e){for(var r=Ed(e),i=r.length,n=[],s=0;s<i;s+=2)n.push(new t(r[s],r[s+1]));return n}angleTo(e){return Math.atan2(e.y-this.y,e.x-this.x)}applyTransform(e){var{x:r,y:i}=this,n=r*e[0]+i*e[2]+e[4],s=r*e[1]+i*e[3]+e[5];this.x=n,this.y=s}},X5=class{constructor(e){this.screen=e,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}isWorking(){return this.working}start(){if(!this.working){var{screen:e,onClick:r,onMouseMove:i}=this,n=e.ctx.canvas;n.onclick=r,n.onmousemove=i,this.working=!0}}stop(){if(this.working){var e=this.screen.ctx.canvas;this.working=!1,e.onclick=null,e.onmousemove=null}}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(this.working){var{screen:e,events:r,eventElements:i}=this,{style:n}=e.ctx.canvas;n&&(n.cursor=""),r.forEach((s,a)=>{for(var{run:o}=s,l=i[a];l;)o(l),l=l.parent}),this.events=[],this.eventElements=[]}}checkPath(e,r){if(!(!this.working||!r)){var{events:i,eventElements:n}=this;i.forEach((s,a)=>{var{x:o,y:l}=s;!n[a]&&r.isPointInPath&&r.isPointInPath(o,l)&&(n[a]=e)})}}checkBoundingBox(e,r){if(!(!this.working||!r)){var{events:i,eventElements:n}=this;i.forEach((s,a)=>{var{x:o,y:l}=s;!n[a]&&r.isPointInBox(o,l)&&(n[a]=e)})}}mapXY(e,r){for(var{window:i,ctx:n}=this.screen,s=new Zl(e,r),a=n.canvas;a;)s.x-=a.offsetLeft,s.y-=a.offsetTop,a=a.offsetParent;return i.scrollX&&(s.x+=i.scrollX),i.scrollY&&(s.y+=i.scrollY),s}onClick(e){var{x:r,y:i}=this.mapXY(e.clientX,e.clientY);this.events.push({type:"onclick",x:r,y:i,run(n){n.onClick&&n.onClick()}})}onMouseMove(e){var{x:r,y:i}=this.mapXY(e.clientX,e.clientY);this.events.push({type:"onmousemove",x:r,y:i,run(n){n.onMouseMove&&n.onMouseMove()}})}},Tse=typeof window<"u"?window:null,Ise=typeof fetch<"u"?fetch.bind(void 0):null,kb=class{constructor(e){var{fetch:r=Ise,window:i=Tse}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.ctx=e,this.FRAMERATE=30,this.MAX_VIRTUAL_PIXELS=3e4,this.CLIENT_WIDTH=800,this.CLIENT_HEIGHT=600,this.viewPort=new z5,this.mouse=new X5(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=i,this.fetch=r}wait(e){this.waits.push(e)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;var e=this.waits.every(r=>r());return e&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=e,e}setDefaults(e){e.strokeStyle="rgba(0,0,0,0)",e.lineCap="butt",e.lineJoin="miter",e.miterLimit=4}setViewBox(e){var{document:r,ctx:i,aspectRatio:n,width:s,desiredWidth:a,height:o,desiredHeight:l,minX:c=0,minY:u=0,refX:d,refY:A,clip:h=!1,clipX:f=0,clipY:p=0}=e,m=Hb(n).replace(/^defer\s/,""),[y,g]=m.split(" "),b=y||"xMidYMid",E=g||"meet",w=s/a,x=o/l,I=Math.min(w,x),C=Math.max(w,x),G=a,U=l;E==="meet"&&(G*=I,U*=I),E==="slice"&&(G*=C,U*=C);var _=new ki(r,"refX",d),H=new ki(r,"refY",A),Q=_.hasValue()&&H.hasValue();if(Q&&i.translate(-I*_.getPixels("x"),-I*H.getPixels("y")),h){var j=I*f,$=I*p;i.beginPath(),i.moveTo(j,$),i.lineTo(s,$),i.lineTo(s,o),i.lineTo(j,o),i.closePath(),i.clip()}if(!Q){var B=E==="meet"&&I===x,M=E==="slice"&&C===x,v=E==="meet"&&I===w,N=E==="slice"&&C===w;b.startsWith("xMid")&&(B||M)&&i.translate(s/2-G/2,0),b.endsWith("YMid")&&(v||N)&&i.translate(0,o/2-U/2),b.startsWith("xMax")&&(B||M)&&i.translate(s-G,0),b.endsWith("YMax")&&(v||N)&&i.translate(0,o-U)}switch(!0){case b==="none":i.scale(w,x);break;case E==="meet":i.scale(I,I);break;case E==="slice":i.scale(C,C);break}i.translate(-c,-u)}start(e){var{enableRedraw:r=!1,ignoreMouse:i=!1,ignoreAnimation:n=!1,ignoreDimensions:s=!1,ignoreClear:a=!1,forceRedraw:o,scaleWidth:l,scaleHeight:c,offsetX:u,offsetY:d}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{FRAMERATE:A,mouse:h}=this,f=1e3/A;if(this.frameDuration=f,this.readyPromise=new Promise(b=>{this.resolveReady=b}),this.isReady()&&this.render(e,s,a,l,c,u,d),!!r){var p=Date.now(),m=p,y=0,g=()=>{p=Date.now(),y=p-m,y>=f&&(m=p-y%f,this.shouldUpdate(n,o)&&(this.render(e,s,a,l,c,u,d),h.runEvents())),this.intervalId=(0,V5.default)(g)};i||h.start(),this.intervalId=(0,V5.default)(g)}}stop(){this.intervalId&&(V5.default.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(e,r){if(!e){var{frameDuration:i}=this,n=this.animations.reduce((s,a)=>a.update(i)||s,!1);if(n)return!0}return!!(typeof r=="function"&&r()||!this.isReadyLock&&this.isReady()||this.mouse.hasEvents())}render(e,r,i,n,s,a,o){var{CLIENT_WIDTH:l,CLIENT_HEIGHT:c,viewPort:u,ctx:d,isFirstRender:A}=this,h=d.canvas;u.clear(),h.width&&h.height?u.setCurrent(h.width,h.height):u.setCurrent(l,c);var f=e.getStyle("width"),p=e.getStyle("height");!r&&(A||typeof n!="number"&&typeof s!="number")&&(f.hasValue()&&(h.width=f.getPixels("x"),h.style&&(h.style.width="".concat(h.width,"px"))),p.hasValue()&&(h.height=p.getPixels("y"),h.style&&(h.style.height="".concat(h.height,"px"))));var m=h.clientWidth||h.width,y=h.clientHeight||h.height;if(r&&f.hasValue()&&p.hasValue()&&(m=f.getPixels("x"),y=p.getPixels("y")),u.setCurrent(m,y),typeof a=="number"&&e.getAttribute("x",!0).setValue(a),typeof o=="number"&&e.getAttribute("y",!0).setValue(o),typeof n=="number"||typeof s=="number"){var g=Ed(e.getAttribute("viewBox").getString()),b=0,E=0;if(typeof n=="number"){var w=e.getStyle("width");w.hasValue()?b=w.getPixels("x")/n:isNaN(g[2])||(b=g[2]/n)}if(typeof s=="number"){var x=e.getStyle("height");x.hasValue()?E=x.getPixels("y")/s:isNaN(g[3])||(E=g[3]/s)}b||(b=E),E||(E=b),e.getAttribute("width",!0).setValue(n),e.getAttribute("height",!0).setValue(s);var I=e.getStyle("transform",!0,!0);I.setValue("".concat(I.getString()," scale(").concat(1/b,", ").concat(1/E,")"))}i||d.clearRect(0,0,m,y),e.render(d),A&&(this.isFirstRender=!1)}};kb.defaultWindow=Tse;kb.defaultFetch=Ise;({defaultFetch:yMe}=kb),bMe=typeof DOMParser<"u"?DOMParser:null,pw=class{constructor(){var{fetch:e=yMe,DOMParser:r=bMe}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fetch=e,this.DOMParser=r}parse(e){var r=this;return Cm(function*(){return e.startsWith("<")?r.parseFromString(e):r.load(e)})()}parseFromString(e){var r=new this.DOMParser;try{return this.checkDocument(r.parseFromString(e,"image/svg+xml"))}catch{return this.checkDocument(r.parseFromString(e,"text/xml"))}}checkDocument(e){var r=e.getElementsByTagName("parsererror")[0];if(r)throw new Error(r.textContent);return e}load(e){var r=this;return Cm(function*(){var i=yield r.fetch(e),n=yield i.text();return r.parseFromString(n)})()}},q5=class{constructor(e,r){this.type="translate",this.point=null,this.point=Zl.parse(r)}apply(e){var{x:r,y:i}=this.point;e.translate(r||0,i||0)}unapply(e){var{x:r,y:i}=this.point;e.translate(-1*r||0,-1*i||0)}applyToPoint(e){var{x:r,y:i}=this.point;e.applyTransform([1,0,0,1,r||0,i||0])}},W5=class{constructor(e,r,i){this.type="rotate",this.angle=null,this.originX=null,this.originY=null,this.cx=0,this.cy=0;var n=Ed(r);this.angle=new ki(e,"angle",n[0]),this.originX=i[0],this.originY=i[1],this.cx=n[1]||0,this.cy=n[2]||0}apply(e){var{cx:r,cy:i,originX:n,originY:s,angle:a}=this,o=r+n.getPixels("x"),l=i+s.getPixels("y");e.translate(o,l),e.rotate(a.getRadians()),e.translate(-o,-l)}unapply(e){var{cx:r,cy:i,originX:n,originY:s,angle:a}=this,o=r+n.getPixels("x"),l=i+s.getPixels("y");e.translate(o,l),e.rotate(-1*a.getRadians()),e.translate(-o,-l)}applyToPoint(e){var{cx:r,cy:i,angle:n}=this,s=n.getRadians();e.applyTransform([1,0,0,1,r||0,i||0]),e.applyTransform([Math.cos(s),Math.sin(s),-Math.sin(s),Math.cos(s),0,0]),e.applyTransform([1,0,0,1,-r||0,-i||0])}},K5=class{constructor(e,r,i){this.type="scale",this.scale=null,this.originX=null,this.originY=null;var n=Zl.parseScale(r);(n.x===0||n.y===0)&&(n.x=Mb,n.y=Mb),this.scale=n,this.originX=i[0],this.originY=i[1]}apply(e){var{scale:{x:r,y:i},originX:n,originY:s}=this,a=n.getPixels("x"),o=s.getPixels("y");e.translate(a,o),e.scale(r,i||r),e.translate(-a,-o)}unapply(e){var{scale:{x:r,y:i},originX:n,originY:s}=this,a=n.getPixels("x"),o=s.getPixels("y");e.translate(a,o),e.scale(1/r,1/i||r),e.translate(-a,-o)}applyToPoint(e){var{x:r,y:i}=this.scale;e.applyTransform([r||0,0,0,i||0,0,0])}},JT=class{constructor(e,r,i){this.type="matrix",this.matrix=[],this.originX=null,this.originY=null,this.matrix=Ed(r),this.originX=i[0],this.originY=i[1]}apply(e){var{originX:r,originY:i,matrix:n}=this,s=r.getPixels("x"),a=i.getPixels("y");e.translate(s,a),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),e.translate(-s,-a)}unapply(e){var{originX:r,originY:i,matrix:n}=this,s=n[0],a=n[2],o=n[4],l=n[1],c=n[3],u=n[5],d=0,A=0,h=1,f=1/(s*(c*h-u*A)-a*(l*h-u*d)+o*(l*A-c*d)),p=r.getPixels("x"),m=i.getPixels("y");e.translate(p,m),e.transform(f*(c*h-u*A),f*(u*d-l*h),f*(o*A-a*h),f*(s*h-o*d),f*(a*u-o*c),f*(o*l-s*u)),e.translate(-p,-m)}applyToPoint(e){e.applyTransform(this.matrix)}},$T=class extends JT{constructor(e,r,i){super(e,r,i),this.type="skew",this.angle=null,this.angle=new ki(e,"angle",r)}},J5=class extends $T{constructor(e,r,i){super(e,r,i),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}},$5=class extends $T{constructor(e,r,i){super(e,r,i),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}};Fb=class t{constructor(e,r,i){this.document=e,this.transforms=[];var n=xMe(r);n.forEach(s=>{if(s!=="none"){var[a,o]=EMe(s),l=t.transformTypes[a];typeof l<"u"&&this.transforms.push(new l(this.document,o,i))}})}static fromElement(e,r){var i=r.getStyle("transform",!1,!0),[n,s=n]=r.getStyle("transform-origin",!1,!0).split(),a=[n,s];return i.hasValue()?new t(e,i.getString(),a):null}apply(e){for(var{transforms:r}=this,i=r.length,n=0;n<i;n++)r[n].apply(e)}unapply(e){for(var{transforms:r}=this,i=r.length,n=i-1;n>=0;n--)r[n].unapply(e)}applyToPoint(e){for(var{transforms:r}=this,i=r.length,n=0;n<i;n++)r[n].applyToPoint(e)}};Fb.transformTypes={translate:q5,rotate:W5,scale:K5,matrix:JT,skewX:J5,skewY:$5};Ao=class t{constructor(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.document=e,this.node=r,this.captureTextNodes=i,this.attributes={},this.styles={},this.stylesSpecificity={},this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],!(!r||r.nodeType!==1)){if(Array.from(r.attributes).forEach(o=>{var l=vse(o.nodeName);this.attributes[l]=new ki(e,l,o.value)}),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()){var n=this.getAttribute("style").getString().split(";").map(o=>o.trim());n.forEach(o=>{if(o){var[l,c]=o.split(":").map(u=>u.trim());this.styles[l]=new ki(e,l,c)}})}var{definitions:s}=e,a=this.getAttribute("id");a.hasValue()&&(s[a.getString()]||(s[a.getString()]=this)),Array.from(r.childNodes).forEach(o=>{if(o.nodeType===1)this.addChild(o);else if(i&&(o.nodeType===3||o.nodeType===4)){var l=e.createTextNode(o);l.getText().length>0&&this.addChild(l)}})}}getAttribute(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.attributes[e];if(!i&&r){var n=new ki(this.document,e,"");return this.attributes[e]=n,n}return i||ki.empty(this.document)}getHrefAttribute(){for(var e in this.attributes)if(e==="href"||e.endsWith(":href"))return this.attributes[e];return ki.empty(this.document)}getStyle(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=this.styles[e];if(n)return n;var s=this.getAttribute(e);if(s!=null&&s.hasValue())return this.styles[e]=s,s;if(!i){var{parent:a}=this;if(a){var o=a.getStyle(e);if(o!=null&&o.hasValue())return o}}if(r){var l=new ki(this.document,e,"");return this.styles[e]=l,l}return n||ki.empty(this.document)}render(e){if(!(this.getStyle("display").getString()==="none"||this.getStyle("visibility").getString()==="hidden")){if(e.save(),this.getStyle("mask").hasValue()){var r=this.getStyle("mask").getDefinition();r&&(this.applyEffects(e),r.apply(e,this))}else if(this.getStyle("filter").getValue("none")!=="none"){var i=this.getStyle("filter").getDefinition();i&&(this.applyEffects(e),i.apply(e,this))}else this.setContext(e),this.renderChildren(e),this.clearContext(e);e.restore()}}setContext(e){}applyEffects(e){var r=Fb.fromElement(this.document,this);r&&r.apply(e);var i=this.getStyle("clip-path",!1,!0);if(i.hasValue()){var n=i.getDefinition();n&&n.apply(e)}}clearContext(e){}renderChildren(e){this.children.forEach(r=>{r.render(e)})}addChild(e){var r=e instanceof t?e:this.document.createElement(e);r.parent=this,t.ignoreChildTypes.includes(r.type)||this.children.push(r)}matchesSelector(e){var r,{node:i}=this;if(typeof i.matches=="function")return i.matches(e);var n=(r=i.getAttribute)===null||r===void 0?void 0:r.call(i,"class");return!n||n===""?!1:n.split(" ").some(s=>".".concat(s)===e)}addStylesFromStyleDefinition(){var{styles:e,stylesSpecificity:r}=this.document;for(var i in e)if(!i.startsWith("@")&&this.matchesSelector(i)){var n=e[i],s=r[i];if(n)for(var a in n){var o=this.stylesSpecificity[a];typeof o>"u"&&(o="000"),s>=o&&(this.styles[a]=n[a],this.stylesSpecificity[a]=s)}}}removeStyles(e,r){var i=r.reduce((n,s)=>{var a=e.getStyle(s);if(!a.hasValue())return n;var o=a.getString();return a.setValue(""),[...n,[s,o]]},[]);return i}restoreStyles(e,r){r.forEach(i=>{var[n,s]=i;e.getStyle(n,!0).setValue(s)})}isFirstChild(){var e;return((e=this.parent)===null||e===void 0?void 0:e.children.indexOf(this))===0}};Ao.ignoreChildTypes=["title"];Z5=class extends Ao{constructor(e,r,i){super(e,r,i)}};lf=class t{constructor(e,r,i,n,s,a){var o=a?typeof a=="string"?t.parse(a):a:{};this.fontFamily=s||o.fontFamily,this.fontSize=n||o.fontSize,this.fontStyle=e||o.fontStyle,this.fontWeight=i||o.fontWeight,this.fontVariant=r||o.fontVariant}static parse(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0,i="",n="",s="",a="",o="",l=Hb(e).trim().split(" "),c={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return l.forEach(u=>{switch(!0){case(!c.fontStyle&&t.styles.includes(u)):u!=="inherit"&&(i=u),c.fontStyle=!0;break;case(!c.fontVariant&&t.variants.includes(u)):u!=="inherit"&&(n=u),c.fontStyle=!0,c.fontVariant=!0;break;case(!c.fontWeight&&t.weights.includes(u)):u!=="inherit"&&(s=u),c.fontStyle=!0,c.fontVariant=!0,c.fontWeight=!0;break;case!c.fontSize:u!=="inherit"&&([a]=u.split("/")),c.fontStyle=!0,c.fontVariant=!0,c.fontWeight=!0,c.fontSize=!0;break;default:u!=="inherit"&&(o+=u)}}),new t(i,n,s,a,o,r)}toString(){return[CMe(this.fontStyle),this.fontVariant,SMe(this.fontWeight),this.fontSize,vMe(this.fontFamily)].join(" ").trim()}};lf.styles="normal|italic|oblique|inherit";lf.variants="normal|small-caps|inherit";lf.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";wd=class{constructor(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.NaN,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.NaN,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Number.NaN,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Number.NaN;this.x1=e,this.y1=r,this.x2=i,this.y2=n,this.addPoint(e,r),this.addPoint(i,n)}get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(e,r){typeof e<"u"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),typeof r<"u"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=r,this.y2=r),r<this.y1&&(this.y1=r),r>this.y2&&(this.y2=r))}addX(e){this.addPoint(e,null)}addY(e){this.addPoint(null,e)}addBoundingBox(e){if(e){var{x1:r,y1:i,x2:n,y2:s}=e;this.addPoint(r,i),this.addPoint(n,s)}}sumCubic(e,r,i,n,s){return Math.pow(1-e,3)*r+3*Math.pow(1-e,2)*e*i+3*(1-e)*Math.pow(e,2)*n+Math.pow(e,3)*s}bezierCurveAdd(e,r,i,n,s){var a=6*r-12*i+6*n,o=-3*r+9*i-9*n+3*s,l=3*i-3*r;if(o===0){if(a===0)return;var c=-l/a;0<c&&c<1&&(e?this.addX(this.sumCubic(c,r,i,n,s)):this.addY(this.sumCubic(c,r,i,n,s)));return}var u=Math.pow(a,2)-4*l*o;if(!(u<0)){var d=(-a+Math.sqrt(u))/(2*o);0<d&&d<1&&(e?this.addX(this.sumCubic(d,r,i,n,s)):this.addY(this.sumCubic(d,r,i,n,s)));var A=(-a-Math.sqrt(u))/(2*o);0<A&&A<1&&(e?this.addX(this.sumCubic(A,r,i,n,s)):this.addY(this.sumCubic(A,r,i,n,s)))}}addBezierCurve(e,r,i,n,s,a,o,l){this.addPoint(e,r),this.addPoint(o,l),this.bezierCurveAdd(!0,e,i,s,o),this.bezierCurveAdd(!1,r,n,a,l)}addQuadraticCurve(e,r,i,n,s,a){var o=e+.6666666666666666*(i-e),l=r+2/3*(n-r),c=o+1/3*(s-e),u=l+1/3*(a-r);this.addBezierCurve(e,r,o,c,l,u,s,a)}isPointInBox(e,r){var{x1:i,y1:n,x2:s,y2:a}=this;return i<=e&&e<=s&&n<=r&&r<=a}},pn=class extends cr{constructor(e){super(e.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=null,this.start=null,this.current=null,this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new Zl(0,0),this.control=new Zl(0,0),this.current=new Zl(0,0),this.points=[],this.angles=[]}isEnd(){var{i:e,commands:r}=this;return e>=r.length-1}next(){var e=this.commands[++this.i];return this.previousCommand=this.command,this.command=e,e}getPoint(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"x",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"y",i=new Zl(this.command[e],this.command[r]);return this.makeAbsolute(i)}getAsControlPoint(e,r){var i=this.getPoint(e,r);return this.control=i,i}getAsCurrentPoint(e,r){var i=this.getPoint(e,r);return this.current=i,i}getReflectedControlPoint(){var e=this.previousCommand.type;if(e!==cr.CURVE_TO&&e!==cr.SMOOTH_CURVE_TO&&e!==cr.QUAD_TO&&e!==cr.SMOOTH_QUAD_TO)return this.current;var{current:{x:r,y:i},control:{x:n,y:s}}=this,a=new Zl(2*r-n,2*i-s);return a}makeAbsolute(e){if(this.command.relative){var{x:r,y:i}=this.current;e.x+=r,e.y+=i}return e}addMarker(e,r,i){var{points:n,angles:s}=this;i&&s.length>0&&!s[s.length-1]&&(s[s.length-1]=n[n.length-1].angleTo(i)),this.addMarkerAngle(e,r?r.angleTo(e):null)}addMarkerAngle(e,r){this.points.push(e),this.angles.push(r)}getMarkerPoints(){return this.points}getMarkerAngles(){for(var{angles:e}=this,r=e.length,i=0;i<r;i++)if(!e[i]){for(var n=i+1;n<r;n++)if(e[n]){e[i]=e[n];break}}return e}},Sm=class extends Ao{constructor(){super(...arguments),this.modifiedEmSizeStack=!1}calculateOpacity(){for(var e=1,r=this;r;){var i=r.getStyle("opacity",!1,!0);i.hasValue(!0)&&(e*=i.getNumber()),r=r.parent}return e}setContext(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r){var i=this.getStyle("fill"),n=this.getStyle("fill-opacity"),s=this.getStyle("stroke"),a=this.getStyle("stroke-opacity");if(i.isUrlDefinition()){var o=i.getFillStyleDefinition(this,n);o&&(e.fillStyle=o)}else if(i.hasValue()){i.getString()==="currentColor"&&i.setValue(this.getStyle("color").getColor());var l=i.getColor();l!=="inherit"&&(e.fillStyle=l==="none"?"rgba(0,0,0,0)":l)}if(n.hasValue()){var c=new ki(this.document,"fill",e.fillStyle).addOpacity(n).getColor();e.fillStyle=c}if(s.isUrlDefinition()){var u=s.getFillStyleDefinition(this,a);u&&(e.strokeStyle=u)}else if(s.hasValue()){s.getString()==="currentColor"&&s.setValue(this.getStyle("color").getColor());var d=s.getString();d!=="inherit"&&(e.strokeStyle=d==="none"?"rgba(0,0,0,0)":d)}if(a.hasValue()){var A=new ki(this.document,"stroke",e.strokeStyle).addOpacity(a).getString();e.strokeStyle=A}var h=this.getStyle("stroke-width");if(h.hasValue()){var f=h.getPixels();e.lineWidth=f||Mb}var p=this.getStyle("stroke-linecap"),m=this.getStyle("stroke-linejoin"),y=this.getStyle("stroke-miterlimit"),g=this.getStyle("stroke-dasharray"),b=this.getStyle("stroke-dashoffset");if(p.hasValue()&&(e.lineCap=p.getString()),m.hasValue()&&(e.lineJoin=m.getString()),y.hasValue()&&(e.miterLimit=y.getNumber()),g.hasValue()&&g.getString()!=="none"){var E=Ed(g.getString());typeof e.setLineDash<"u"?e.setLineDash(E):typeof e.webkitLineDash<"u"?e.webkitLineDash=E:typeof e.mozDash<"u"&&!(E.length===1&&E[0]===0)&&(e.mozDash=E);var w=b.getPixels();typeof e.lineDashOffset<"u"?e.lineDashOffset=w:typeof e.webkitLineDashOffset<"u"?e.webkitLineDashOffset=w:typeof e.mozDashOffset<"u"&&(e.mozDashOffset=w)}}if(this.modifiedEmSizeStack=!1,typeof e.font<"u"){var x=this.getStyle("font"),I=this.getStyle("font-style"),C=this.getStyle("font-variant"),G=this.getStyle("font-weight"),U=this.getStyle("font-size"),_=this.getStyle("font-family"),H=new lf(I.getString(),C.getString(),G.getString(),U.hasValue()?"".concat(U.getPixels(!0),"px"):"",_.getString(),lf.parse(x.getString(),e.font));I.setValue(H.fontStyle),C.setValue(H.fontVariant),G.setValue(H.fontWeight),U.setValue(H.fontSize),_.setValue(H.fontFamily),e.font=H.toString(),U.isPixels()&&(this.document.emSize=U.getPixels(),this.modifiedEmSizeStack=!0)}r||(this.applyEffects(e),e.globalAlpha=this.calculateOpacity())}clearContext(e){super.clearContext(e),this.modifiedEmSizeStack&&this.document.popEmSize()}},Cl=class t extends Sm{constructor(e,r,i){super(e,r,i),this.type="path",this.pathParser=null,this.pathParser=new pn(this.getAttribute("d").getString())}path(e){var{pathParser:r}=this,i=new wd;for(r.reset(),e&&e.beginPath();!r.isEnd();)switch(r.next().type){case pn.MOVE_TO:this.pathM(e,i);break;case pn.LINE_TO:this.pathL(e,i);break;case pn.HORIZ_LINE_TO:this.pathH(e,i);break;case pn.VERT_LINE_TO:this.pathV(e,i);break;case pn.CURVE_TO:this.pathC(e,i);break;case pn.SMOOTH_CURVE_TO:this.pathS(e,i);break;case pn.QUAD_TO:this.pathQ(e,i);break;case pn.SMOOTH_QUAD_TO:this.pathT(e,i);break;case pn.ARC:this.pathA(e,i);break;case pn.CLOSE_PATH:this.pathZ(e,i);break}return i}getBoundingBox(e){return this.path()}getMarkers(){var{pathParser:e}=this,r=e.getMarkerPoints(),i=e.getMarkerAngles(),n=r.map((s,a)=>[s,i[a]]);return n}renderChildren(e){this.path(e),this.document.screen.mouse.checkPath(this,e);var r=this.getStyle("fill-rule");e.fillStyle!==""&&(r.getString("inherit")!=="inherit"?e.fill(r.getString()):e.fill()),e.strokeStyle!==""&&(this.getAttribute("vector-effect").getString()==="non-scaling-stroke"?(e.save(),e.setTransform(1,0,0,1,0,0),e.stroke(),e.restore()):e.stroke());var i=this.getMarkers();if(i){var n=i.length-1,s=this.getStyle("marker-start"),a=this.getStyle("marker-mid"),o=this.getStyle("marker-end");if(s.isUrlDefinition()){var l=s.getDefinition(),[c,u]=i[0];l.render(e,c,u)}if(a.isUrlDefinition())for(var d=a.getDefinition(),A=1;A<n;A++){var[h,f]=i[A];d.render(e,h,f)}if(o.isUrlDefinition()){var p=o.getDefinition(),[m,y]=i[n];p.render(e,m,y)}}}static pathM(e){var r=e.getAsCurrentPoint();return e.start=e.current,{point:r}}pathM(e,r){var{pathParser:i}=this,{point:n}=t.pathM(i),{x:s,y:a}=n;i.addMarker(n),r.addPoint(s,a),e&&e.moveTo(s,a)}static pathL(e){var{current:r}=e,i=e.getAsCurrentPoint();return{current:r,point:i}}pathL(e,r){var{pathParser:i}=this,{current:n,point:s}=t.pathL(i),{x:a,y:o}=s;i.addMarker(s,n),r.addPoint(a,o),e&&e.lineTo(a,o)}static pathH(e){var{current:r,command:i}=e,n=new Zl((i.relative?r.x:0)+i.x,r.y);return e.current=n,{current:r,point:n}}pathH(e,r){var{pathParser:i}=this,{current:n,point:s}=t.pathH(i),{x:a,y:o}=s;i.addMarker(s,n),r.addPoint(a,o),e&&e.lineTo(a,o)}static pathV(e){var{current:r,command:i}=e,n=new Zl(r.x,(i.relative?r.y:0)+i.y);return e.current=n,{current:r,point:n}}pathV(e,r){var{pathParser:i}=this,{current:n,point:s}=t.pathV(i),{x:a,y:o}=s;i.addMarker(s,n),r.addPoint(a,o),e&&e.lineTo(a,o)}static pathC(e){var{current:r}=e,i=e.getPoint("x1","y1"),n=e.getAsControlPoint("x2","y2"),s=e.getAsCurrentPoint();return{current:r,point:i,controlPoint:n,currentPoint:s}}pathC(e,r){var{pathParser:i}=this,{current:n,point:s,controlPoint:a,currentPoint:o}=t.pathC(i);i.addMarker(o,a,s),r.addBezierCurve(n.x,n.y,s.x,s.y,a.x,a.y,o.x,o.y),e&&e.bezierCurveTo(s.x,s.y,a.x,a.y,o.x,o.y)}static pathS(e){var{current:r}=e,i=e.getReflectedControlPoint(),n=e.getAsControlPoint("x2","y2"),s=e.getAsCurrentPoint();return{current:r,point:i,controlPoint:n,currentPoint:s}}pathS(e,r){var{pathParser:i}=this,{current:n,point:s,controlPoint:a,currentPoint:o}=t.pathS(i);i.addMarker(o,a,s),r.addBezierCurve(n.x,n.y,s.x,s.y,a.x,a.y,o.x,o.y),e&&e.bezierCurveTo(s.x,s.y,a.x,a.y,o.x,o.y)}static pathQ(e){var{current:r}=e,i=e.getAsControlPoint("x1","y1"),n=e.getAsCurrentPoint();return{current:r,controlPoint:i,currentPoint:n}}pathQ(e,r){var{pathParser:i}=this,{current:n,controlPoint:s,currentPoint:a}=t.pathQ(i);i.addMarker(a,s,s),r.addQuadraticCurve(n.x,n.y,s.x,s.y,a.x,a.y),e&&e.quadraticCurveTo(s.x,s.y,a.x,a.y)}static pathT(e){var{current:r}=e,i=e.getReflectedControlPoint();e.control=i;var n=e.getAsCurrentPoint();return{current:r,controlPoint:i,currentPoint:n}}pathT(e,r){var{pathParser:i}=this,{current:n,controlPoint:s,currentPoint:a}=t.pathT(i);i.addMarker(a,s,s),r.addQuadraticCurve(n.x,n.y,s.x,s.y,a.x,a.y),e&&e.quadraticCurveTo(s.x,s.y,a.x,a.y)}static pathA(e){var{current:r,command:i}=e,{rX:n,rY:s,xRot:a,lArcFlag:o,sweepFlag:l}=i,c=a*(Math.PI/180),u=e.getAsCurrentPoint(),d=new Zl(Math.cos(c)*(r.x-u.x)/2+Math.sin(c)*(r.y-u.y)/2,-Math.sin(c)*(r.x-u.x)/2+Math.cos(c)*(r.y-u.y)/2),A=Math.pow(d.x,2)/Math.pow(n,2)+Math.pow(d.y,2)/Math.pow(s,2);A>1&&(n*=Math.sqrt(A),s*=Math.sqrt(A));var h=(o===l?-1:1)*Math.sqrt((Math.pow(n,2)*Math.pow(s,2)-Math.pow(n,2)*Math.pow(d.y,2)-Math.pow(s,2)*Math.pow(d.x,2))/(Math.pow(n,2)*Math.pow(d.y,2)+Math.pow(s,2)*Math.pow(d.x,2)));isNaN(h)&&(h=0);var f=new Zl(h*n*d.y/s,h*-s*d.x/n),p=new Zl((r.x+u.x)/2+Math.cos(c)*f.x-Math.sin(c)*f.y,(r.y+u.y)/2+Math.sin(c)*f.x+Math.cos(c)*f.y),m=j7([1,0],[(d.x-f.x)/n,(d.y-f.y)/s]),y=[(d.x-f.x)/n,(d.y-f.y)/s],g=[(-d.x-f.x)/n,(-d.y-f.y)/s],b=j7(y,g);return Q5(y,g)<=-1&&(b=Math.PI),Q5(y,g)>=1&&(b=0),{currentPoint:u,rX:n,rY:s,sweepFlag:l,xAxisRotation:c,centp:p,a1:m,ad:b}}pathA(e,r){var{pathParser:i}=this,{currentPoint:n,rX:s,rY:a,sweepFlag:o,xAxisRotation:l,centp:c,a1:u,ad:d}=t.pathA(i),A=1-o?1:-1,h=u+A*(d/2),f=new Zl(c.x+s*Math.cos(h),c.y+a*Math.sin(h));if(i.addMarkerAngle(f,h-A*Math.PI/2),i.addMarkerAngle(n,h-A*Math.PI),r.addPoint(n.x,n.y),e&&!isNaN(u)&&!isNaN(d)){var p=s>a?s:a,m=s>a?1:s/a,y=s>a?a/s:1;e.translate(c.x,c.y),e.rotate(l),e.scale(m,y),e.arc(0,0,p,u,u+d,!!(1-o)),e.scale(1/m,1/y),e.rotate(-l),e.translate(-c.x,-c.y)}}static pathZ(e){e.current=e.start}pathZ(e,r){t.pathZ(this.pathParser),e&&r.x1!==r.x2&&r.y1!==r.y2&&e.closePath()}},ZT=class extends Cl{constructor(e,r,i){super(e,r,i),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}},Fy=class t extends Sm{constructor(e,r,i){super(e,r,new.target===t?!0:i),this.type="text",this.x=0,this.y=0,this.measureCache=-1}setContext(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.setContext(e,r);var i=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();i&&(e.textBaseline=i)}initializeCoordinates(){this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY}getBoundingBox(e){if(this.type!=="text")return this.getTElementBoundingBox(e);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(e);var r=null;return this.children.forEach((i,n)=>{var s=this.getChildBoundingBox(e,this,this,n);r?r.addBoundingBox(s):r=s}),r}getFontSize(){var{document:e,parent:r}=this,i=lf.parse(e.ctx.font).fontSize,n=r.getStyle("font-size").getNumber(i);return n}getTElementBoundingBox(e){var r=this.getFontSize();return new wd(this.x,this.y-r,this.x+this.measureText(e),this.y)}getGlyph(e,r,i){var n=r[i],s=null;if(e.isArabic){var a=r.length,o=r[i-1],l=r[i+1],c="isolated";if((i===0||o===" ")&&i<a-1&&l!==" "&&(c="terminal"),i>0&&o!==" "&&i<a-1&&l!==" "&&(c="medial"),i>0&&o!==" "&&(i===a-1||l===" ")&&(c="initial"),typeof e.glyphs[n]<"u"){var u=e.glyphs[n];s=u instanceof ZT?u:u[c]}}else s=e.glyphs[n];return s||(s=e.missingGlyph),s}getText(){return""}getTextFromNode(e){var r=e||this.node,i=Array.from(r.parentNode.childNodes),n=i.indexOf(r),s=i.length-1,a=Hb(r.textContent||"");return n===0&&(a=Ese(a)),n===s&&(a=wse(a)),a}renderChildren(e){if(this.type!=="text"){this.renderTElementChildren(e);return}this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(e),this.children.forEach((i,n)=>{this.renderChild(e,this,this,n)});var{mouse:r}=this.document.screen;r.isWorking()&&r.checkBoundingBox(this,this.getBoundingBox(e))}renderTElementChildren(e){var{document:r,parent:i}=this,n=this.getText(),s=i.getStyle("font-family").getDefinition();if(s){for(var{unitsPerEm:a}=s.fontFace,o=lf.parse(r.ctx.font),l=i.getStyle("font-size").getNumber(o.fontSize),c=i.getStyle("font-style").getString(o.fontStyle),u=l/a,d=s.isRTL?n.split("").reverse().join(""):n,A=Ed(i.getAttribute("dx").getString()),h=d.length,f=0;f<h;f++){var p=this.getGlyph(s,d,f);e.translate(this.x,this.y),e.scale(u,-u);var m=e.lineWidth;e.lineWidth=e.lineWidth*a/l,c==="italic"&&e.transform(1,0,.4,1,0,0),p.render(e),c==="italic"&&e.transform(1,0,-.4,1,0,0),e.lineWidth=m,e.scale(1/u,-1/u),e.translate(-this.x,-this.y),this.x+=l*(p.horizAdvX||s.horizAdvX)/a,typeof A[f]<"u"&&!isNaN(A[f])&&(this.x+=A[f])}return}var{x:y,y:g}=this;e.fillStyle&&e.fillText(n,y,g),e.strokeStyle&&e.strokeText(n,y,g)}applyAnchoring(){if(!(this.textChunkStart>=this.leafTexts.length)){var e=this.leafTexts[this.textChunkStart],r=e.getStyle("text-anchor").getString("start"),i=!1,n=0;r==="start"&&!i||r==="end"&&i?n=e.x-this.minX:r==="end"&&!i||r==="start"&&i?n=e.x-this.maxX:n=e.x-(this.minX+this.maxX)/2;for(var s=this.textChunkStart;s<this.leafTexts.length;s++)this.leafTexts[s].x+=n;this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.textChunkStart=this.leafTexts.length}}adjustChildCoordinatesRecursive(e){this.children.forEach((r,i)=>{this.adjustChildCoordinatesRecursiveCore(e,this,this,i)}),this.applyAnchoring()}adjustChildCoordinatesRecursiveCore(e,r,i,n){var s=i.children[n];s.children.length>0?s.children.forEach((a,o)=>{r.adjustChildCoordinatesRecursiveCore(e,r,s,o)}):this.adjustChildCoordinates(e,r,i,n)}adjustChildCoordinates(e,r,i,n){var s=i.children[n];if(typeof s.measureText!="function")return s;e.save(),s.setContext(e,!0);var a=s.getAttribute("x"),o=s.getAttribute("y"),l=s.getAttribute("dx"),c=s.getAttribute("dy"),u=s.getStyle("font-family").getDefinition(),d=!!u&&u.isRTL;n===0&&(a.hasValue()||a.setValue(s.getInheritedAttribute("x")),o.hasValue()||o.setValue(s.getInheritedAttribute("y")),l.hasValue()||l.setValue(s.getInheritedAttribute("dx")),c.hasValue()||c.setValue(s.getInheritedAttribute("dy")));var A=s.measureText(e);return d&&(r.x-=A),a.hasValue()?(r.applyAnchoring(),s.x=a.getPixels("x"),l.hasValue()&&(s.x+=l.getPixels("x"))):(l.hasValue()&&(r.x+=l.getPixels("x")),s.x=r.x),r.x=s.x,d||(r.x+=A),o.hasValue()?(s.y=o.getPixels("y"),c.hasValue()&&(s.y+=c.getPixels("y"))):(c.hasValue()&&(r.y+=c.getPixels("y")),s.y=r.y),r.y=s.y,r.leafTexts.push(s),r.minX=Math.min(r.minX,s.x,s.x+A),r.maxX=Math.max(r.maxX,s.x,s.x+A),s.clearContext(e),e.restore(),s}getChildBoundingBox(e,r,i,n){var s=i.children[n];if(typeof s.getBoundingBox!="function")return null;var a=s.getBoundingBox(e);return a?(s.children.forEach((o,l)=>{var c=r.getChildBoundingBox(e,r,s,l);a.addBoundingBox(c)}),a):null}renderChild(e,r,i,n){var s=i.children[n];s.render(e),s.children.forEach((a,o)=>{r.renderChild(e,r,s,o)})}measureText(e){var{measureCache:r}=this;if(~r)return r;var i=this.getText(),n=this.measureTargetText(e,i);return this.measureCache=n,n}measureTargetText(e,r){if(!r.length)return 0;var{parent:i}=this,n=i.getStyle("font-family").getDefinition();if(n){for(var s=this.getFontSize(),a=n.isRTL?r.split("").reverse().join(""):r,o=Ed(i.getAttribute("dx").getString()),l=a.length,c=0,u=0;u<l;u++){var d=this.getGlyph(n,a,u);c+=(d.horizAdvX||n.horizAdvX)*s/n.fontFace.unitsPerEm,typeof o[u]<"u"&&!isNaN(o[u])&&(c+=o[u])}return c}if(!e.measureText)return r.length*10;e.save(),this.setContext(e,!0);var{width:A}=e.measureText(r);return this.clearContext(e),e.restore(),A}getInheritedAttribute(e){for(var r=this;r instanceof t&&r.isFirstChild();){var i=r.parent.getAttribute(e);if(i.hasValue(!0))return i.getValue("0");r=r.parent}return null}},eI=class t extends Fy{constructor(e,r,i){super(e,r,new.target===t?!0:i),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}getText(){return this.text}},$7=class extends eI{constructor(){super(...arguments),this.type="textNode"}},Uy=class extends Sm{constructor(){super(...arguments),this.type="svg",this.root=!1}setContext(e){var r,{document:i}=this,{screen:n,window:s}=i,a=e.canvas;if(n.setDefaults(e),a.style&&typeof e.font<"u"&&s&&typeof s.getComputedStyle<"u"){e.font=s.getComputedStyle(a).getPropertyValue("font");var o=new ki(i,"fontSize",lf.parse(e.font).fontSize);o.hasValue()&&(i.rootEmSize=o.getPixels("y"),i.emSize=i.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);var{width:l,height:c}=n.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");var u=this.getAttribute("refX"),d=this.getAttribute("refY"),A=this.getAttribute("viewBox"),h=A.hasValue()?Ed(A.getString()):null,f=!this.root&&this.getStyle("overflow").getValue("hidden")!=="visible",p=0,m=0,y=0,g=0;h&&(p=h[0],m=h[1]),this.root||(l=this.getStyle("width").getPixels("x"),c=this.getStyle("height").getPixels("y"),this.type==="marker"&&(y=p,g=m,p=0,m=0)),n.viewPort.setCurrent(l,c),this.node&&(!this.parent||((r=this.node.parentNode)===null||r===void 0?void 0:r.nodeName)==="foreignObject")&&this.getStyle("transform",!1,!0).hasValue()&&!this.getStyle("transform-origin",!1,!0).hasValue()&&this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(e),e.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),h&&(l=h[2],c=h[3]),i.setViewBox({ctx:e,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:n.viewPort.width,desiredWidth:l,height:n.viewPort.height,desiredHeight:c,minX:p,minY:m,refX:u.getValue(),refY:d.getValue(),clip:f,clipX:y,clipY:g}),h&&(n.viewPort.removeCurrent(),n.viewPort.setCurrent(l,c))}clearContext(e){super.clearContext(e),this.document.screen.viewPort.removeCurrent()}resize(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=this.getAttribute("width",!0),s=this.getAttribute("height",!0),a=this.getAttribute("viewBox"),o=this.getAttribute("style"),l=n.getNumber(0),c=s.getNumber(0);if(i)if(typeof i=="string")this.getAttribute("preserveAspectRatio",!0).setValue(i);else{var u=this.getAttribute("preserveAspectRatio");u.hasValue()&&u.setValue(u.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(n.setValue(e),s.setValue(r),a.hasValue()||a.setValue("0 0 ".concat(l||e," ").concat(c||r)),o.hasValue()){var d=this.getStyle("width"),A=this.getStyle("height");d.hasValue()&&d.setValue("".concat(e,"px")),A.hasValue()&&A.setValue("".concat(r,"px"))}}},tI=class extends Cl{constructor(){super(...arguments),this.type="rect"}path(e){var r=this.getAttribute("x").getPixels("x"),i=this.getAttribute("y").getPixels("y"),n=this.getStyle("width",!1,!0).getPixels("x"),s=this.getStyle("height",!1,!0).getPixels("y"),a=this.getAttribute("rx"),o=this.getAttribute("ry"),l=a.getPixels("x"),c=o.getPixels("y");if(a.hasValue()&&!o.hasValue()&&(c=l),o.hasValue()&&!a.hasValue()&&(l=c),l=Math.min(l,n/2),c=Math.min(c,s/2),e){var u=4*((Math.sqrt(2)-1)/3);e.beginPath(),s>0&&n>0&&(e.moveTo(r+l,i),e.lineTo(r+n-l,i),e.bezierCurveTo(r+n-l+u*l,i,r+n,i+c-u*c,r+n,i+c),e.lineTo(r+n,i+s-c),e.bezierCurveTo(r+n,i+s-c+u*c,r+n-l+u*l,i+s,r+n-l,i+s),e.lineTo(r+l,i+s),e.bezierCurveTo(r+l-u*l,i+s,r,i+s-c+u*c,r,i+s-c),e.lineTo(r,i+c),e.bezierCurveTo(r,i+c-u*c,r+l-u*l,i,r+l,i),e.closePath())}return new wd(r,i,r+n,i+s)}getMarkers(){return null}},e3=class extends Cl{constructor(){super(...arguments),this.type="circle"}path(e){var r=this.getAttribute("cx").getPixels("x"),i=this.getAttribute("cy").getPixels("y"),n=this.getAttribute("r").getPixels();return e&&n>0&&(e.beginPath(),e.arc(r,i,n,0,Math.PI*2,!1),e.closePath()),new wd(r-n,i-n,r+n,i+n)}getMarkers(){return null}},t3=class extends Cl{constructor(){super(...arguments),this.type="ellipse"}path(e){var r=4*((Math.sqrt(2)-1)/3),i=this.getAttribute("rx").getPixels("x"),n=this.getAttribute("ry").getPixels("y"),s=this.getAttribute("cx").getPixels("x"),a=this.getAttribute("cy").getPixels("y");return e&&i>0&&n>0&&(e.beginPath(),e.moveTo(s+i,a),e.bezierCurveTo(s+i,a+r*n,s+r*i,a+n,s,a+n),e.bezierCurveTo(s-r*i,a+n,s-i,a+r*n,s-i,a),e.bezierCurveTo(s-i,a-r*n,s-r*i,a-n,s,a-n),e.bezierCurveTo(s+r*i,a-n,s+i,a-r*n,s+i,a),e.closePath()),new wd(s-i,a-n,s+i,a+n)}getMarkers(){return null}},r3=class extends Cl{constructor(){super(...arguments),this.type="line"}getPoints(){return[new Zl(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new Zl(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(e){var[{x:r,y:i},{x:n,y:s}]=this.getPoints();return e&&(e.beginPath(),e.moveTo(r,i),e.lineTo(n,s)),new wd(r,i,n,s)}getMarkers(){var[e,r]=this.getPoints(),i=e.angleTo(r);return[[e,i],[r,i]]}},rI=class extends Cl{constructor(e,r,i){super(e,r,i),this.type="polyline",this.points=[],this.points=Zl.parsePath(this.getAttribute("points").getString())}path(e){var{points:r}=this,[{x:i,y:n}]=r,s=new wd(i,n);return e&&(e.beginPath(),e.moveTo(i,n)),r.forEach(a=>{var{x:o,y:l}=a;s.addPoint(o,l),e&&e.lineTo(o,l)}),s}getMarkers(){var{points:e}=this,r=e.length-1,i=[];return e.forEach((n,s)=>{s!==r&&i.push([n,n.angleTo(e[s+1])])}),i.length>0&&i.push([e[e.length-1],i[i.length-1][1]]),i}},i3=class extends rI{constructor(){super(...arguments),this.type="polygon"}path(e){var r=super.path(e),[{x:i,y:n}]=this.points;return e&&(e.lineTo(i,n),e.closePath()),r}},n3=class extends Ao{constructor(){super(...arguments),this.type="pattern"}createPattern(e,r,i){var n=this.getStyle("width").getPixels("x",!0),s=this.getStyle("height").getPixels("y",!0),a=new Uy(this.document,null);a.attributes.viewBox=new ki(this.document,"viewBox",this.getAttribute("viewBox").getValue()),a.attributes.width=new ki(this.document,"width","".concat(n,"px")),a.attributes.height=new ki(this.document,"height","".concat(s,"px")),a.attributes.transform=new ki(this.document,"transform",this.getAttribute("patternTransform").getValue()),a.children=this.children;var o=this.document.createCanvas(n,s),l=o.getContext("2d"),c=this.getAttribute("x"),u=this.getAttribute("y");c.hasValue()&&u.hasValue()&&l.translate(c.getPixels("x",!0),u.getPixels("y",!0)),i.hasValue()?this.styles["fill-opacity"]=i:Reflect.deleteProperty(this.styles,"fill-opacity");for(var d=-1;d<=1;d++)for(var A=-1;A<=1;A++)l.save(),a.attributes.x=new ki(this.document,"x",d*o.width),a.attributes.y=new ki(this.document,"y",A*o.height),a.render(l),l.restore();var h=e.createPattern(o,"repeat");return h}},s3=class extends Ao{constructor(){super(...arguments),this.type="marker"}render(e,r,i){if(r){var{x:n,y:s}=r,a=this.getAttribute("orient").getString("auto"),o=this.getAttribute("markerUnits").getString("strokeWidth");e.translate(n,s),a==="auto"&&e.rotate(i),o==="strokeWidth"&&e.scale(e.lineWidth,e.lineWidth),e.save();var l=new Uy(this.document,null);l.type=this.type,l.attributes.viewBox=new ki(this.document,"viewBox",this.getAttribute("viewBox").getValue()),l.attributes.refX=new ki(this.document,"refX",this.getAttribute("refX").getValue()),l.attributes.refY=new ki(this.document,"refY",this.getAttribute("refY").getValue()),l.attributes.width=new ki(this.document,"width",this.getAttribute("markerWidth").getValue()),l.attributes.height=new ki(this.document,"height",this.getAttribute("markerHeight").getValue()),l.attributes.overflow=new ki(this.document,"overflow",this.getAttribute("overflow").getValue()),l.attributes.fill=new ki(this.document,"fill",this.getAttribute("fill").getColor("black")),l.attributes.stroke=new ki(this.document,"stroke",this.getAttribute("stroke").getValue("none")),l.children=this.children,l.render(e),e.restore(),o==="strokeWidth"&&e.scale(1/e.lineWidth,1/e.lineWidth),a==="auto"&&e.rotate(-i),e.translate(-n,-s)}}},a3=class extends Ao{constructor(){super(...arguments),this.type="defs"}render(){}},mw=class extends Sm{constructor(){super(...arguments),this.type="g"}getBoundingBox(e){var r=new wd;return this.children.forEach(i=>{r.addBoundingBox(i.getBoundingBox(e))}),r}},iI=class extends Ao{constructor(e,r,i){super(e,r,i),this.attributesToInherit=["gradientUnits"],this.stops=[];var{stops:n,children:s}=this;s.forEach(a=>{a.type==="stop"&&n.push(a)})}getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(e,r,i){var n=this;this.getHrefAttribute().hasValue()&&(n=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(n));var{stops:s}=n,a=this.getGradient(e,r);if(!a)return this.addParentOpacity(i,s[s.length-1].color);if(s.forEach(m=>{a.addColorStop(m.offset,this.addParentOpacity(i,m.color))}),this.getAttribute("gradientTransform").hasValue()){var{document:o}=this,{MAX_VIRTUAL_PIXELS:l,viewPort:c}=o.screen,[u]=c.viewPorts,d=new tI(o,null);d.attributes.x=new ki(o,"x",-l/3),d.attributes.y=new ki(o,"y",-l/3),d.attributes.width=new ki(o,"width",l),d.attributes.height=new ki(o,"height",l);var A=new mw(o,null);A.attributes.transform=new ki(o,"transform",this.getAttribute("gradientTransform").getValue()),A.children=[d];var h=new Uy(o,null);h.attributes.x=new ki(o,"x",0),h.attributes.y=new ki(o,"y",0),h.attributes.width=new ki(o,"width",u.width),h.attributes.height=new ki(o,"height",u.height),h.children=[A];var f=o.createCanvas(u.width,u.height),p=f.getContext("2d");return p.fillStyle=a,h.render(p),p.createPattern(f,"no-repeat")}return a}inheritStopContainer(e){this.attributesToInherit.forEach(r=>{!this.getAttribute(r).hasValue()&&e.getAttribute(r).hasValue()&&this.getAttribute(r,!0).setValue(e.getAttribute(r).getValue())})}addParentOpacity(e,r){if(e.hasValue()){var i=new ki(this.document,"color",r);return i.addOpacity(e).getColor()}return r}},o3=class extends iI{constructor(e,r,i){super(e,r,i),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}getGradient(e,r){var i=this.getGradientUnits()==="objectBoundingBox",n=i?r.getBoundingBox(e):null;if(i&&!n)return null;!this.getAttribute("x1").hasValue()&&!this.getAttribute("y1").hasValue()&&!this.getAttribute("x2").hasValue()&&!this.getAttribute("y2").hasValue()&&(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));var s=i?n.x+n.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),a=i?n.y+n.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),o=i?n.x+n.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),l=i?n.y+n.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return s===o&&a===l?null:e.createLinearGradient(s,a,o,l)}},l3=class extends iI{constructor(e,r,i){super(e,r,i),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}getGradient(e,r){var i=this.getGradientUnits()==="objectBoundingBox",n=r.getBoundingBox(e);if(i&&!n)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");var s=i?n.x+n.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),a=i?n.y+n.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y"),o=s,l=a;this.getAttribute("fx").hasValue()&&(o=i?n.x+n.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(l=i?n.y+n.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));var c=i?(n.width+n.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),u=this.getAttribute("fr").getPixels();return e.createRadialGradient(o,l,u,s,a,c)}},c3=class extends Ao{constructor(e,r,i){super(e,r,i),this.type="stop";var n=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),s=this.getStyle("stop-opacity"),a=this.getStyle("stop-color",!0);a.getString()===""&&a.setValue("#000"),s.hasValue()&&(a=a.addOpacity(s)),this.offset=n,this.color=a.getColor()}},gw=class extends Ao{constructor(e,r,i){super(e,r,i),this.type="animate",this.duration=0,this.initialValue=null,this.initialUnits="",this.removed=!1,this.frozen=!1,e.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new ki(e,"values",null);var n=this.getAttribute("values");n.hasValue()&&this.values.setValue(n.getString().split(";"))}getProperty(){var e=this.getAttribute("attributeType").getString(),r=this.getAttribute("attributeName").getString();return e==="CSS"?this.parent.getStyle(r,!0):this.parent.getAttribute(r,!0)}calcValue(){var{initialUnits:e}=this,{progress:r,from:i,to:n}=this.getProgress(),s=i.getNumber()+(n.getNumber()-i.getNumber())*r;return e==="%"&&(s*=100),"".concat(s).concat(e)}update(e){var{parent:r}=this,i=this.getProperty();if(this.initialValue||(this.initialValue=i.getString(),this.initialUnits=i.getUnits()),this.duration>this.maxDuration){var n=this.getAttribute("fill").getString("remove");if(this.getAttribute("repeatCount").getString()==="indefinite"||this.getAttribute("repeatDur").getString()==="indefinite")this.duration=0;else if(n==="freeze"&&!this.frozen)this.frozen=!0,r.animationFrozen=!0,r.animationFrozenValue=i.getString();else if(n==="remove"&&!this.removed)return this.removed=!0,i.setValue(r.animationFrozen?r.animationFrozenValue:this.initialValue),!0;return!1}this.duration+=e;var s=!1;if(this.begin<this.duration){var a=this.calcValue(),o=this.getAttribute("type");if(o.hasValue()){var l=o.getString();a="".concat(l,"(").concat(a,")")}i.setValue(a),s=!0}return s}getProgress(){var{document:e,values:r}=this,i={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(r.hasValue()){var n=i.progress*(r.getValue().length-1),s=Math.floor(n),a=Math.ceil(n);i.from=new ki(e,"from",parseFloat(r.getValue()[s])),i.to=new ki(e,"to",parseFloat(r.getValue()[a])),i.progress=(n-s)/(a-s)}else i.from=this.from,i.to=this.to;return i}},u3=class extends gw{constructor(){super(...arguments),this.type="animateColor"}calcValue(){var{progress:e,from:r,to:i}=this.getProgress(),n=new j5.default(r.getColor()),s=new j5.default(i.getColor());if(n.ok&&s.ok){var a=n.r+(s.r-n.r)*e,o=n.g+(s.g-n.g)*e,l=n.b+(s.b-n.b)*e;return"rgb(".concat(Math.floor(a),", ").concat(Math.floor(o),", ").concat(Math.floor(l),")")}return this.getAttribute("from").getColor()}},h3=class extends gw{constructor(){super(...arguments),this.type="animateTransform"}calcValue(){var{progress:e,from:r,to:i}=this.getProgress(),n=Ed(r.getString()),s=Ed(i.getString()),a=n.map((o,l)=>{var c=s[l];return o+(c-o)*e}).join(" ");return a}},d3=class extends Ao{constructor(e,r,i){super(e,r,i),this.type="font",this.glyphs={},this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();var{definitions:n}=e,{children:s}=this;for(var a of s)switch(a.type){case"font-face":{this.fontFace=a;var o=a.getStyle("font-family");o.hasValue()&&(n[o.getString()]=this);break}case"missing-glyph":this.missingGlyph=a;break;case"glyph":{var l=a;l.arabicForm?(this.isRTL=!0,this.isArabic=!0,typeof this.glyphs[l.unicode]>"u"&&(this.glyphs[l.unicode]={}),this.glyphs[l.unicode][l.arabicForm]=l):this.glyphs[l.unicode]=l;break}}}render(){}},A3=class extends Ao{constructor(e,r,i){super(e,r,i),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}},f3=class extends Cl{constructor(){super(...arguments),this.type="missing-glyph",this.horizAdvX=0}},p3=class extends Fy{constructor(){super(...arguments),this.type="tref"}getText(){var e=this.getHrefAttribute().getDefinition();if(e){var r=e.children[0];if(r)return r.getText()}return""}},m3=class extends Fy{constructor(e,r,i){super(e,r,i),this.type="a";var{childNodes:n}=r,s=n[0],a=n.length>0&&Array.from(n).every(o=>o.nodeType===3);this.hasText=a,this.text=a?this.getTextFromNode(s):""}getText(){return this.text}renderChildren(e){if(this.hasText){super.renderChildren(e);var{document:r,x:i,y:n}=this,{mouse:s}=r.screen,a=new ki(r,"fontSize",lf.parse(r.ctx.font).fontSize);s.isWorking()&&s.checkBoundingBox(this,new wd(i,n-a.getPixels("y"),i+this.measureText(e),n))}else if(this.children.length>0){var o=new mw(this.document,null);o.children=this.children,o.parent=this,o.render(e)}}onClick(){var{window:e}=this.document;e&&e.open(this.getHrefAttribute().getString())}onMouseMove(){var e=this.document.ctx;e.canvas.style.cursor="pointer"}};g3=class extends Fy{constructor(e,r,i){super(e,r,i),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);var n=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(n)}getText(){return this.text}path(e){var{dataArray:r}=this;e&&e.beginPath(),r.forEach(i=>{var{type:n,points:s}=i;switch(n){case pn.LINE_TO:e&&e.lineTo(s[0],s[1]);break;case pn.MOVE_TO:e&&e.moveTo(s[0],s[1]);break;case pn.CURVE_TO:e&&e.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case pn.QUAD_TO:e&&e.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case pn.ARC:{var[a,o,l,c,u,d,A,h]=s,f=l>c?l:c,p=l>c?1:l/c,m=l>c?c/l:1;e&&(e.translate(a,o),e.rotate(A),e.scale(p,m),e.arc(0,0,f,u,u+d,!!(1-h)),e.scale(1/p,1/m),e.rotate(-A),e.translate(-a,-o));break}case pn.CLOSE_PATH:e&&e.closePath();break}})}renderChildren(e){this.setTextData(e),e.save();var r=this.parent.getStyle("text-decoration").getString(),i=this.getFontSize(),{glyphInfo:n}=this,s=e.fillStyle;r==="underline"&&e.beginPath(),n.forEach((a,o)=>{var{p0:l,p1:c,rotation:u,text:d}=a;e.save(),e.translate(l.x,l.y),e.rotate(u),e.fillStyle&&e.fillText(d,0,0),e.strokeStyle&&e.strokeText(d,0,0),e.restore(),r==="underline"&&(o===0&&e.moveTo(l.x,l.y+i/8),e.lineTo(c.x,c.y+i/5))}),r==="underline"&&(e.lineWidth=i/20,e.strokeStyle=s,e.stroke(),e.closePath()),e.restore()}getLetterSpacingAt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.letterSpacingCache[e]||0}findSegmentToFitChar(e,r,i,n,s,a,o,l,c){var u=a,d=this.measureText(e,l);l===" "&&r==="justify"&&i<n&&(d+=(n-i)/s),c>-1&&(u+=this.getLetterSpacingAt(c));var A=this.textHeight/20,h=this.getEquidistantPointOnPath(u,A,0),f=this.getEquidistantPointOnPath(u+d,A,0),p={p0:h,p1:f},m=h&&f?Math.atan2(f.y-h.y,f.x-h.x):0;if(o){var y=Math.cos(Math.PI/2+m)*o,g=Math.cos(-m)*o;p.p0=H5(H5({},h),{},{x:h.x+y,y:h.y+g}),p.p1=H5(H5({},f),{},{x:f.x+y,y:f.y+g})}return u+=d,{offset:u,segment:p,rotation:m}}measureText(e,r){var{measuresCache:i}=this,n=r||this.getText();if(i.has(n))return i.get(n);var s=this.measureTargetText(e,n);return i.set(n,s),s}setTextData(e){if(!this.glyphInfo){var r=this.getText(),i=r.split(""),n=r.split(" ").length-1,s=this.parent.getAttribute("dx").split().map(E=>E.getPixels("x")),a=this.parent.getAttribute("dy").getPixels("y"),o=this.parent.getStyle("text-anchor").getString("start"),l=this.getStyle("letter-spacing"),c=this.parent.getStyle("letter-spacing"),u=0;!l.hasValue()||l.getValue()==="inherit"?u=c.getPixels():l.hasValue()&&l.getValue()!=="initial"&&l.getValue()!=="unset"&&(u=l.getPixels());var d=[],A=r.length;this.letterSpacingCache=d;for(var h=0;h<A;h++)d.push(typeof s[h]<"u"?s[h]:u);var f=d.reduce((E,w,x)=>x===0?0:E+w||0,0),p=this.measureText(e),m=Math.max(p+f,0);this.textWidth=p,this.textHeight=this.getFontSize(),this.glyphInfo=[];var y=this.getPathLength(),g=this.getStyle("startOffset").getNumber(0)*y,b=0;(o==="middle"||o==="center")&&(b=-m/2),(o==="end"||o==="right")&&(b=-m),b+=g,i.forEach((E,w)=>{var{offset:x,segment:I,rotation:C}=this.findSegmentToFitChar(e,o,m,y,n,b,a,E,w);b=x,!(!I.p0||!I.p1)&&this.glyphInfo.push({text:i[w],p0:I.p0,p1:I.p1,rotation:C})})}}parsePathData(e){if(this.pathLength=-1,!e)return[];var r=[],{pathParser:i}=e;for(i.reset();!i.isEnd();){var{current:n}=i,s=n?n.x:0,a=n?n.y:0,o=i.next(),l=o.type,c=[];switch(o.type){case pn.MOVE_TO:this.pathM(i,c);break;case pn.LINE_TO:l=this.pathL(i,c);break;case pn.HORIZ_LINE_TO:l=this.pathH(i,c);break;case pn.VERT_LINE_TO:l=this.pathV(i,c);break;case pn.CURVE_TO:this.pathC(i,c);break;case pn.SMOOTH_CURVE_TO:l=this.pathS(i,c);break;case pn.QUAD_TO:this.pathQ(i,c);break;case pn.SMOOTH_QUAD_TO:l=this.pathT(i,c);break;case pn.ARC:c=this.pathA(i);break;case pn.CLOSE_PATH:Cl.pathZ(i);break}o.type!==pn.CLOSE_PATH?r.push({type:l,points:c,start:{x:s,y:a},pathLength:this.calcLength(s,a,l,c)}):r.push({type:pn.CLOSE_PATH,points:[],pathLength:0})}return r}pathM(e,r){var{x:i,y:n}=Cl.pathM(e).point;r.push(i,n)}pathL(e,r){var{x:i,y:n}=Cl.pathL(e).point;return r.push(i,n),pn.LINE_TO}pathH(e,r){var{x:i,y:n}=Cl.pathH(e).point;return r.push(i,n),pn.LINE_TO}pathV(e,r){var{x:i,y:n}=Cl.pathV(e).point;return r.push(i,n),pn.LINE_TO}pathC(e,r){var{point:i,controlPoint:n,currentPoint:s}=Cl.pathC(e);r.push(i.x,i.y,n.x,n.y,s.x,s.y)}pathS(e,r){var{point:i,controlPoint:n,currentPoint:s}=Cl.pathS(e);return r.push(i.x,i.y,n.x,n.y,s.x,s.y),pn.CURVE_TO}pathQ(e,r){var{controlPoint:i,currentPoint:n}=Cl.pathQ(e);r.push(i.x,i.y,n.x,n.y)}pathT(e,r){var{controlPoint:i,currentPoint:n}=Cl.pathT(e);return r.push(i.x,i.y,n.x,n.y),pn.QUAD_TO}pathA(e){var{rX:r,rY:i,sweepFlag:n,xAxisRotation:s,centp:a,a1:o,ad:l}=Cl.pathA(e);return n===0&&l>0&&(l-=2*Math.PI),n===1&&l<0&&(l+=2*Math.PI),[a.x,a.y,r,i,o,l,s,n]}calcLength(e,r,i,n){var s=0,a=null,o=null,l=0;switch(i){case pn.LINE_TO:return this.getLineLength(e,r,n[0],n[1]);case pn.CURVE_TO:for(s=0,a=this.getPointOnCubicBezier(0,e,r,n[0],n[1],n[2],n[3],n[4],n[5]),l=.01;l<=1;l+=.01)o=this.getPointOnCubicBezier(l,e,r,n[0],n[1],n[2],n[3],n[4],n[5]),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return s;case pn.QUAD_TO:for(s=0,a=this.getPointOnQuadraticBezier(0,e,r,n[0],n[1],n[2],n[3]),l=.01;l<=1;l+=.01)o=this.getPointOnQuadraticBezier(l,e,r,n[0],n[1],n[2],n[3]),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return s;case pn.ARC:{s=0;var c=n[4],u=n[5],d=n[4]+u,A=Math.PI/180;if(Math.abs(c-d)<A&&(A=Math.abs(c-d)),a=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],c,0),u<0)for(l=c-A;l>d;l-=A)o=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],l,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;else for(l=c+A;l<d;l+=A)o=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],l,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),a=o;return o=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],d,0),s+=this.getLineLength(a.x,a.y,o.x,o.y),s}}return 0}getPointOnLine(e,r,i,n,s){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:r,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:i,l=(s-i)/(n-r+Mb),c=Math.sqrt(e*e/(1+l*l));n<r&&(c*=-1);var u=l*c,d=null;if(n===r)d={x:a,y:o+u};else if((o-i)/(a-r+Mb)===l)d={x:a+c,y:o+u};else{var A=0,h=0,f=this.getLineLength(r,i,n,s);if(f<Mb)return null;var p=(a-r)*(n-r)+(o-i)*(s-i);p/=f*f,A=r+p*(n-r),h=i+p*(s-i);var m=this.getLineLength(a,o,A,h),y=Math.sqrt(e*e-m*m);c=Math.sqrt(y*y/(1+l*l)),n<r&&(c*=-1),u=l*c,d={x:A+c,y:h+u}}return d}getPointOnPath(e){var r=this.getPathLength(),i=0,n=null;if(e<-5e-5||e-5e-5>r)return null;var{dataArray:s}=this;for(var a of s){if(a&&(a.pathLength<5e-5||i+a.pathLength+5e-5<e)){i+=a.pathLength;continue}var o=e-i,l=0;switch(a.type){case pn.LINE_TO:n=this.getPointOnLine(o,a.start.x,a.start.y,a.points[0],a.points[1],a.start.x,a.start.y);break;case pn.ARC:{var c=a.points[4],u=a.points[5],d=a.points[4]+u;if(l=c+o/a.pathLength*u,u<0&&l<d||u>=0&&l>d)break;n=this.getPointOnEllipticalArc(a.points[0],a.points[1],a.points[2],a.points[3],l,a.points[6]);break}case pn.CURVE_TO:l=o/a.pathLength,l>1&&(l=1),n=this.getPointOnCubicBezier(l,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3],a.points[4],a.points[5]);break;case pn.QUAD_TO:l=o/a.pathLength,l>1&&(l=1),n=this.getPointOnQuadraticBezier(l,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3]);break}if(n)return n;break}return null}getLineLength(e,r,i,n){return Math.sqrt((i-e)*(i-e)+(n-r)*(n-r))}getPathLength(){return this.pathLength===-1&&(this.pathLength=this.dataArray.reduce((e,r)=>r.pathLength>0?e+r.pathLength:e,0)),this.pathLength}getPointOnCubicBezier(e,r,i,n,s,a,o,l,c){var u=l*Q7(e)+a*z7(e)+n*X7(e)+r*q7(e),d=c*Q7(e)+o*z7(e)+s*X7(e)+i*q7(e);return{x:u,y:d}}getPointOnQuadraticBezier(e,r,i,n,s,a,o){var l=a*W7(e)+n*K7(e)+r*J7(e),c=o*W7(e)+s*K7(e)+i*J7(e);return{x:l,y:c}}getPointOnEllipticalArc(e,r,i,n,s,a){var o=Math.cos(a),l=Math.sin(a),c={x:i*Math.cos(s),y:n*Math.sin(s)};return{x:e+(c.x*o-c.y*l),y:r+(c.x*l+c.y*o)}}buildEquidistantCache(e,r){var i=this.getPathLength(),n=r||.25,s=e||i/100;if(!this.equidistantCache||this.equidistantCache.step!==s||this.equidistantCache.precision!==n){this.equidistantCache={step:s,precision:n,points:[]};for(var a=0,o=0;o<=i;o+=n){var l=this.getPointOnPath(o),c=this.getPointOnPath(o+n);!l||!c||(a+=this.getLineLength(l.x,l.y,c.x,c.y),a>=s&&(this.equidistantCache.points.push({x:l.x,y:l.y,distance:o}),a-=s))}}}getEquidistantPointOnPath(e,r,i){if(this.buildEquidistantCache(r,i),e<0||e-this.getPathLength()>5e-5)return null;var n=Math.round(e/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[n]||null}},TMe=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i,y3=class extends Sm{constructor(e,r,i){super(e,r,i),this.type="image",this.loaded=!1;var n=this.getHrefAttribute().getString();if(n){var s=n.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(n);e.images.push(this),s?this.loadSvg(n):this.loadImage(n),this.isSvg=s}}loadImage(e){var r=this;return Cm(function*(){try{var i=yield r.document.createImage(e);r.image=i}catch(n){console.error('Error while loading image "'.concat(e,'":'),n)}r.loaded=!0})()}loadSvg(e){var r=this;return Cm(function*(){var i=TMe.exec(e);if(i){var n=i[5];i[4]==="base64"?r.image=atob(n):r.image=decodeURIComponent(n)}else try{var s=yield r.document.fetch(e),a=yield s.text();r.image=a}catch(o){console.error('Error while loading image "'.concat(e,'":'),o)}r.loaded=!0})()}renderChildren(e){var{document:r,image:i,loaded:n}=this,s=this.getAttribute("x").getPixels("x"),a=this.getAttribute("y").getPixels("y"),o=this.getStyle("width").getPixels("x"),l=this.getStyle("height").getPixels("y");if(!(!n||!i||!o||!l)){if(e.save(),e.translate(s,a),this.isSvg){var c=r.canvg.forkString(e,this.image,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:o,scaleHeight:l});c.document.documentElement.parent=this,c.render()}else{var u=this.image;r.setViewBox({ctx:e,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:o,desiredWidth:u.width,height:l,desiredHeight:u.height}),this.loaded&&(typeof u.complete>"u"||u.complete)&&e.drawImage(u,0,0)}e.restore()}}getBoundingBox(){var e=this.getAttribute("x").getPixels("x"),r=this.getAttribute("y").getPixels("y"),i=this.getStyle("width").getPixels("x"),n=this.getStyle("height").getPixels("y");return new wd(e,r,e+i,r+n)}},b3=class extends Sm{constructor(){super(...arguments),this.type="symbol"}render(e){}},x3=class{constructor(e){this.document=e,this.loaded=!1,e.fonts.push(this)}load(e,r){var i=this;return Cm(function*(){try{var{document:n}=i,s=yield n.canvg.parser.load(r),a=s.getElementsByTagName("font");Array.from(a).forEach(o=>{var l=n.createElement(o);n.definitions[e]=l})}catch(o){console.error('Error while loading font "'.concat(r,'":'),o)}i.loaded=!0})()}},nI=class extends Ao{constructor(e,r,i){super(e,r,i),this.type="style";var n=Hb(Array.from(r.childNodes).map(a=>a.textContent).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")),s=n.split("}");s.forEach(a=>{var o=a.trim();if(o){var l=o.split("{"),c=l[0].split(","),u=l[1].split(";");c.forEach(d=>{var A=d.trim();if(A){var h=e.styles[A]||{};if(u.forEach(m=>{var y=m.indexOf(":"),g=m.substr(0,y).trim(),b=m.substr(y+1,m.length-y).trim();g&&b&&(h[g]=new ki(e,g,b))}),e.styles[A]=h,e.stylesSpecificity[A]=Sse(A),A==="@font-face"){var f=h["font-family"].getString().replace(/"|'/g,""),p=h.src.getString().split(",");p.forEach(m=>{if(m.indexOf('format("svg")')>0){var y=tU(m);y&&new x3(e).load(f,y)}})}}})}})}};nI.parseExternalUrl=tU;E3=class extends Sm{constructor(){super(...arguments),this.type="use"}setContext(e){super.setContext(e);var r=this.getAttribute("x"),i=this.getAttribute("y");r.hasValue()&&e.translate(r.getPixels("x"),0),i.hasValue()&&e.translate(0,i.getPixels("y"))}path(e){var{element:r}=this;r&&r.path(e)}renderChildren(e){var{document:r,element:i}=this;if(i){var n=i;if(i.type==="symbol"&&(n=new Uy(r,null),n.attributes.viewBox=new ki(r,"viewBox",i.getAttribute("viewBox").getString()),n.attributes.preserveAspectRatio=new ki(r,"preserveAspectRatio",i.getAttribute("preserveAspectRatio").getString()),n.attributes.overflow=new ki(r,"overflow",i.getAttribute("overflow").getString()),n.children=i.children,i.styles.opacity=new ki(r,"opacity",this.calculateOpacity())),n.type==="svg"){var s=this.getStyle("width",!1,!0),a=this.getStyle("height",!1,!0);s.hasValue()&&(n.attributes.width=new ki(r,"width",s.getString())),a.hasValue()&&(n.attributes.height=new ki(r,"height",a.getString()))}var o=n.parent;n.parent=this,n.render(e),n.parent=o}}getBoundingBox(e){var{element:r}=this;return r?r.getBoundingBox(e):null}elementTransform(){var{document:e,element:r}=this;return Fb.fromElement(e,r)}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}};sI=class extends Ao{constructor(e,r,i){super(e,r,i),this.type="feColorMatrix";var n=Ed(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":{var s=n[0];n=[.213+.787*s,.715-.715*s,.072-.072*s,0,0,.213-.213*s,.715+.285*s,.072-.072*s,0,0,.213-.213*s,.715-.715*s,.072+.928*s,0,0,0,0,0,1,0,0,0,0,0,1];break}case"hueRotate":{var a=n[0]*Math.PI/180;n=[e0(a,.213,.787,-.213),e0(a,.715,-.715,-.715),e0(a,.072,-.072,.928),0,0,e0(a,.213,-.213,.143),e0(a,.715,.285,.14),e0(a,.072,-.072,-.283),0,0,e0(a,.213,-.213,-.787),e0(a,.715,-.715,.715),e0(a,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break}case"luminanceToAlpha":n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1];break}this.matrix=n,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}apply(e,r,i,n,s){for(var{includeOpacity:a,matrix:o}=this,l=e.getImageData(0,0,n,s),c=0;c<s;c++)for(var u=0;u<n;u++){var d=G5(l.data,u,c,n,s,0),A=G5(l.data,u,c,n,s,1),h=G5(l.data,u,c,n,s,2),f=G5(l.data,u,c,n,s,3),p=$l(o,0,d)+$l(o,1,A)+$l(o,2,h)+$l(o,3,f)+$l(o,4,1),m=$l(o,5,d)+$l(o,6,A)+$l(o,7,h)+$l(o,8,f)+$l(o,9,1),y=$l(o,10,d)+$l(o,11,A)+$l(o,12,h)+$l(o,13,f)+$l(o,14,1),g=$l(o,15,d)+$l(o,16,A)+$l(o,17,h)+$l(o,18,f)+$l(o,19,1);a&&(p=0,m=0,y=0,g*=f/255),Y5(l.data,u,c,n,s,0,p),Y5(l.data,u,c,n,s,1,m),Y5(l.data,u,c,n,s,2,y),Y5(l.data,u,c,n,s,3,g)}e.clearRect(0,0,n,s),e.putImageData(l,0,0)}},aI=class t extends Ao{constructor(){super(...arguments),this.type="mask"}apply(e,r){var{document:i}=this,n=this.getAttribute("x").getPixels("x"),s=this.getAttribute("y").getPixels("y"),a=this.getStyle("width").getPixels("x"),o=this.getStyle("height").getPixels("y");if(!a&&!o){var l=new wd;this.children.forEach(f=>{l.addBoundingBox(f.getBoundingBox(e))}),n=Math.floor(l.x1),s=Math.floor(l.y1),a=Math.floor(l.width),o=Math.floor(l.height)}var c=this.removeStyles(r,t.ignoreStyles),u=i.createCanvas(n+a,s+o),d=u.getContext("2d");i.screen.setDefaults(d),this.renderChildren(d),new sI(i,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(d,0,0,n+a,s+o);var A=i.createCanvas(n+a,s+o),h=A.getContext("2d");i.screen.setDefaults(h),r.render(h),h.globalCompositeOperation="destination-in",h.fillStyle=d.createPattern(u,"no-repeat"),h.fillRect(0,0,n+a,s+o),e.fillStyle=h.createPattern(A,"no-repeat"),e.fillRect(0,0,n+a,s+o),this.restoreStyles(r,c)}render(e){}};aI.ignoreStyles=["mask","transform","clip-path"];yse=()=>{},w3=class extends Ao{constructor(){super(...arguments),this.type="clipPath"}apply(e){var{document:r}=this,i=Reflect.getPrototypeOf(e),{beginPath:n,closePath:s}=e;i&&(i.beginPath=yse,i.closePath=yse),Reflect.apply(n,e,[]),this.children.forEach(a=>{if(!(typeof a.path>"u")){var o=typeof a.elementTransform<"u"?a.elementTransform():null;o||(o=Fb.fromElement(r,a)),o&&o.apply(e),a.path(e),i&&(i.closePath=s),o&&o.unapply(e)}}),Reflect.apply(s,e,[]),e.clip(),i&&(i.beginPath=n,i.closePath=s)}render(e){}},oI=class t extends Ao{constructor(){super(...arguments),this.type="filter"}apply(e,r){var{document:i,children:n}=this,s=r.getBoundingBox(e);if(s){var a=0,o=0;n.forEach(y=>{var g=y.extraFilterDistance||0;a=Math.max(a,g),o=Math.max(o,g)});var l=Math.floor(s.width),c=Math.floor(s.height),u=l+2*a,d=c+2*o;if(!(u<1||d<1)){var A=Math.floor(s.x),h=Math.floor(s.y),f=this.removeStyles(r,t.ignoreStyles),p=i.createCanvas(u,d),m=p.getContext("2d");i.screen.setDefaults(m),m.translate(-A+a,-h+o),r.render(m),n.forEach(y=>{typeof y.apply=="function"&&y.apply(m,0,0,u,d)}),e.drawImage(p,0,0,u,d,A-a,h-o,u,d),this.restoreStyles(r,f)}}}render(e){}};oI.ignoreStyles=["filter","transform","clip-path"];v3=class extends Ao{constructor(e,r,i){super(e,r,i),this.type="feDropShadow",this.addStylesFromStyleDefinition()}apply(e,r,i,n,s){}},C3=class extends Ao{constructor(){super(...arguments),this.type="feMorphology"}apply(e,r,i,n,s){}},S3=class extends Ao{constructor(){super(...arguments),this.type="feComposite"}apply(e,r,i,n,s){}},T3=class extends Ao{constructor(e,r,i){super(e,r,i),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}apply(e,r,i,n,s){var{document:a,blurRadius:o}=this,l=a.window?a.window.document.body:null,c=e.canvas;c.id=a.getUniqueId(),l&&(c.style.display="none",l.appendChild(c)),pse(c,r,i,n,s,o),l&&l.removeChild(c)}},I3=class extends Ao{constructor(){super(...arguments),this.type="title"}},B3=class extends Ao{constructor(){super(...arguments),this.type="desc"}},IMe={svg:Uy,rect:tI,circle:e3,ellipse:t3,line:r3,polyline:rI,polygon:i3,path:Cl,pattern:n3,marker:s3,defs:a3,linearGradient:o3,radialGradient:l3,stop:c3,animate:gw,animateColor:u3,animateTransform:h3,font:d3,"font-face":A3,"missing-glyph":f3,glyph:ZT,text:Fy,tspan:eI,tref:p3,a:m3,textPath:g3,image:y3,g:mw,symbol:b3,style:nI,use:E3,mask:aI,clipPath:w3,filter:oI,feDropShadow:v3,feMorphology:C3,feComposite:S3,feColorMatrix:sI,feGaussianBlur:T3,title:I3,desc:B3};Ub=class t{constructor(e){var{rootEmSize:r=12,emSize:i=12,createCanvas:n=t.createCanvas,createImage:s=t.createImage,anonymousCrossOrigin:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.canvg=e,this.definitions={},this.styles={},this.stylesSpecificity={},this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=e.screen,this.rootEmSize=r,this.emSize=i,this.createCanvas=n,this.createImage=this.bindCreateImage(s,a),this.screen.wait(this.isImagesLoaded.bind(this)),this.screen.wait(this.isFontsLoaded.bind(this))}bindCreateImage(e,r){return typeof r=="boolean"?(i,n)=>e(i,typeof n=="boolean"?n:r):e}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){var{emSizeStack:e}=this;return e[e.length-1]}set emSize(e){var{emSizeStack:r}=this;r.push(e)}popEmSize(){var{emSizeStack:e}=this;e.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every(e=>e.loaded)}isFontsLoaded(){return this.fonts.every(e=>e.loaded)}createDocumentElement(e){var r=this.createElement(e.documentElement);return r.root=!0,r.addStylesFromStyleDefinition(),this.documentElement=r,r}createElement(e){var r=e.nodeName.replace(/^[^:]+:/,""),i=t.elementTypes[r];return typeof i<"u"?new i(this,e):new Z5(this,e)}createTextNode(e){return new $7(this,e)}setViewBox(e){this.screen.setViewBox(BMe({document:this},e))}};Ub.createCanvas=DMe;Ub.createImage=_Me;Ub.elementTypes=IMe;eU=class t{constructor(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.parser=new pw(i),this.screen=new kb(e,i),this.options=i;var n=new Ub(this,i),s=n.createDocumentElement(r);this.document=n,this.documentElement=s}static from(e,r){var i=arguments;return Cm(function*(){var n=i.length>2&&i[2]!==void 0?i[2]:{},s=new pw(n),a=yield s.parse(r);return new t(e,a,n)})()}static fromString(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=new pw(i),s=n.parseFromString(r);return new t(e,s,i)}fork(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t.from(e,r,Rb(Rb({},this.options),i))}forkString(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t.fromString(e,r,Rb(Rb({},this.options),i))}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}render(){var e=arguments,r=this;return Cm(function*(){var i=e.length>0&&e[0]!==void 0?e[0]:{};r.start(Rb({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0},i)),yield r.ready(),r.stop()})()}start(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{documentElement:r,screen:i,options:n}=this;i.start(r,Rb(Rb({enableRedraw:!0},n),e))}stop(){this.screen.stop()}resize(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.documentElement.resize(e,r,i)}}});var Lh=pa(Um());function Sx(t){let e=t.length;for(;--e>=0;)t[e]=0}var Roe=0,F9=1,Moe=2,koe=3,Foe=258,$N=29,uv=256,rv=uv+1+$N,wx=30,ZN=19,U9=2*rv+1,e1=15,DN=16,Uoe=7,eR=256,H9=16,G9=17,Y9=18,VN=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),iB=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Hoe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),V9=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Goe=512,Gm=new Array((rv+2)*2);Sx(Gm);var Zw=new Array(wx*2);Sx(Zw);var iv=new Array(Goe);Sx(iv);var nv=new Array(Foe-koe+1);Sx(nv);var tR=new Array($N);Sx(tR);var nB=new Array(wx);Sx(nB);function _N(t,e,r,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}var j9,Q9,z9;function PN(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}var X9=t=>t<256?iv[t]:iv[256+(t>>>7)],sv=(t,e)=>{t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255},Qh=(t,e,r)=>{t.bi_valid>DN-r?(t.bi_buf|=e<<t.bi_valid&65535,sv(t,t.bi_buf),t.bi_buf=e>>DN-t.bi_valid,t.bi_valid+=r-DN):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},Lp=(t,e,r)=>{Qh(t,r[e*2],r[e*2+1])},q9=(t,e)=>{let r=0;do r|=t&1,t>>>=1,r<<=1;while(--e>0);return r>>>1},Yoe=t=>{t.bi_valid===16?(sv(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},Voe=(t,e)=>{let r=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,l=e.stat_desc.max_length,c,u,d,A,h,f,p=0;for(A=0;A<=e1;A++)t.bl_count[A]=0;for(r[t.heap[t.heap_max]*2+1]=0,c=t.heap_max+1;c<U9;c++)u=t.heap[c],A=r[r[u*2+1]*2+1]+1,A>l&&(A=l,p++),r[u*2+1]=A,!(u>i)&&(t.bl_count[A]++,h=0,u>=o&&(h=a[u-o]),f=r[u*2],t.opt_len+=f*(A+h),s&&(t.static_len+=f*(n[u*2+1]+h)));if(p!==0){do{for(A=l-1;t.bl_count[A]===0;)A--;t.bl_count[A]--,t.bl_count[A+1]+=2,t.bl_count[l]--,p-=2}while(p>0);for(A=l;A!==0;A--)for(u=t.bl_count[A];u!==0;)d=t.heap[--c],!(d>i)&&(r[d*2+1]!==A&&(t.opt_len+=(A-r[d*2+1])*r[d*2],r[d*2+1]=A),u--)}},W9=(t,e,r)=>{let i=new Array(e1+1),n=0,s,a;for(s=1;s<=e1;s++)n=n+r[s-1]<<1,i[s]=n;for(a=0;a<=e;a++){let o=t[a*2+1];o!==0&&(t[a*2]=q9(i[o]++,o))}},joe=()=>{let t,e,r,i,n,s=new Array(e1+1);for(r=0,i=0;i<$N-1;i++)for(tR[i]=r,t=0;t<1<<VN[i];t++)nv[r++]=i;for(nv[r-1]=i,n=0,i=0;i<16;i++)for(nB[i]=n,t=0;t<1<<iB[i];t++)iv[n++]=i;for(n>>=7;i<wx;i++)for(nB[i]=n<<7,t=0;t<1<<iB[i]-7;t++)iv[256+n++]=i;for(e=0;e<=e1;e++)s[e]=0;for(t=0;t<=143;)Gm[t*2+1]=8,t++,s[8]++;for(;t<=255;)Gm[t*2+1]=9,t++,s[9]++;for(;t<=279;)Gm[t*2+1]=7,t++,s[7]++;for(;t<=287;)Gm[t*2+1]=8,t++,s[8]++;for(W9(Gm,rv+1,s),t=0;t<wx;t++)Zw[t*2+1]=5,Zw[t*2]=q9(t,5);j9=new _N(Gm,VN,uv+1,rv,e1),Q9=new _N(Zw,iB,0,wx,e1),z9=new _N(new Array(0),Hoe,0,ZN,Uoe)},K9=t=>{let e;for(e=0;e<rv;e++)t.dyn_ltree[e*2]=0;for(e=0;e<wx;e++)t.dyn_dtree[e*2]=0;for(e=0;e<ZN;e++)t.bl_tree[e*2]=0;t.dyn_ltree[eR*2]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},J9=t=>{t.bi_valid>8?sv(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},e9=(t,e,r,i)=>{let n=e*2,s=r*2;return t[n]<t[s]||t[n]===t[s]&&i[e]<=i[r]},LN=(t,e,r)=>{let i=t.heap[r],n=r<<1;for(;n<=t.heap_len&&(n<t.heap_len&&e9(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!e9(e,i,t.heap[n],t.depth));)t.heap[r]=t.heap[n],r=n,n<<=1;t.heap[r]=i},t9=(t,e,r)=>{let i,n,s=0,a,o;if(t.sym_next!==0)do i=t.pending_buf[t.sym_buf+s++]&255,i+=(t.pending_buf[t.sym_buf+s++]&255)<<8,n=t.pending_buf[t.sym_buf+s++],i===0?Lp(t,n,e):(a=nv[n],Lp(t,a+uv+1,e),o=VN[a],o!==0&&(n-=tR[a],Qh(t,n,o)),i--,a=X9(i),Lp(t,a,r),o=iB[a],o!==0&&(i-=nB[a],Qh(t,i,o)));while(s<t.sym_next);Lp(t,eR,e)},jN=(t,e)=>{let r=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems,a,o,l=-1,c;for(t.heap_len=0,t.heap_max=U9,a=0;a<s;a++)r[a*2]!==0?(t.heap[++t.heap_len]=l=a,t.depth[a]=0):r[a*2+1]=0;for(;t.heap_len<2;)c=t.heap[++t.heap_len]=l<2?++l:0,r[c*2]=1,t.depth[c]=0,t.opt_len--,n&&(t.static_len-=i[c*2+1]);for(e.max_code=l,a=t.heap_len>>1;a>=1;a--)LN(t,r,a);c=s;do a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],LN(t,r,1),o=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=o,r[c*2]=r[a*2]+r[o*2],t.depth[c]=(t.depth[a]>=t.depth[o]?t.depth[a]:t.depth[o])+1,r[a*2+1]=r[o*2+1]=c,t.heap[1]=c++,LN(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],Voe(t,e),W9(r,l,t.bl_count)},r9=(t,e,r)=>{let i,n=-1,s,a=e[1],o=0,l=7,c=4;for(a===0&&(l=138,c=3),e[(r+1)*2+1]=65535,i=0;i<=r;i++)s=a,a=e[(i+1)*2+1],!(++o<l&&s===a)&&(o<c?t.bl_tree[s*2]+=o:s!==0?(s!==n&&t.bl_tree[s*2]++,t.bl_tree[H9*2]++):o<=10?t.bl_tree[G9*2]++:t.bl_tree[Y9*2]++,o=0,n=s,a===0?(l=138,c=3):s===a?(l=6,c=3):(l=7,c=4))},i9=(t,e,r)=>{let i,n=-1,s,a=e[1],o=0,l=7,c=4;for(a===0&&(l=138,c=3),i=0;i<=r;i++)if(s=a,a=e[(i+1)*2+1],!(++o<l&&s===a)){if(o<c)do Lp(t,s,t.bl_tree);while(--o!==0);else s!==0?(s!==n&&(Lp(t,s,t.bl_tree),o--),Lp(t,H9,t.bl_tree),Qh(t,o-3,2)):o<=10?(Lp(t,G9,t.bl_tree),Qh(t,o-3,3)):(Lp(t,Y9,t.bl_tree),Qh(t,o-11,7));o=0,n=s,a===0?(l=138,c=3):s===a?(l=6,c=3):(l=7,c=4)}},Qoe=t=>{let e;for(r9(t,t.dyn_ltree,t.l_desc.max_code),r9(t,t.dyn_dtree,t.d_desc.max_code),jN(t,t.bl_desc),e=ZN-1;e>=3&&t.bl_tree[V9[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e},zoe=(t,e,r,i)=>{let n;for(Qh(t,e-257,5),Qh(t,r-1,5),Qh(t,i-4,4),n=0;n<i;n++)Qh(t,t.bl_tree[V9[n]*2+1],3);i9(t,t.dyn_ltree,e-1),i9(t,t.dyn_dtree,r-1)},Xoe=t=>{let e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&t.dyn_ltree[r*2]!==0)return 0;if(t.dyn_ltree[18]!==0||t.dyn_ltree[20]!==0||t.dyn_ltree[26]!==0)return 1;for(r=32;r<uv;r++)if(t.dyn_ltree[r*2]!==0)return 1;return 0},n9=!1,qoe=t=>{n9||(joe(),n9=!0),t.l_desc=new PN(t.dyn_ltree,j9),t.d_desc=new PN(t.dyn_dtree,Q9),t.bl_desc=new PN(t.bl_tree,z9),t.bi_buf=0,t.bi_valid=0,K9(t)},$9=(t,e,r,i)=>{Qh(t,(Roe<<1)+(i?1:0),3),J9(t),sv(t,r),sv(t,~r),r&&t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r},Woe=t=>{Qh(t,F9<<1,3),Lp(t,eR,Gm),Yoe(t)},Koe=(t,e,r,i)=>{let n,s,a=0;t.level>0?(t.strm.data_type===2&&(t.strm.data_type=Xoe(t)),jN(t,t.l_desc),jN(t,t.d_desc),a=Qoe(t),n=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=n&&(n=s)):n=s=r+5,r+4<=n&&e!==-1?$9(t,e,r,i):t.strategy===4||s===n?(Qh(t,(F9<<1)+(i?1:0),3),t9(t,Gm,Zw)):(Qh(t,(Moe<<1)+(i?1:0),3),zoe(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),t9(t,t.dyn_ltree,t.dyn_dtree)),K9(t),i&&J9(t)},Joe=(t,e,r)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=r,e===0?t.dyn_ltree[r*2]++:(t.matches++,e--,t.dyn_ltree[(nv[r]+uv+1)*2]++,t.dyn_dtree[X9(e)*2]++),t.sym_next===t.sym_end),$oe=qoe,Zoe=$9,ele=Koe,tle=Joe,rle=Woe,ile={_tr_init:$oe,_tr_stored_block:Zoe,_tr_flush_block:ele,_tr_tally:tle,_tr_align:rle},nle=(t,e,r,i)=>{let n=t&65535|0,s=t>>>16&65535|0,a=0;for(;r!==0;){a=r>2e3?2e3:r,r-=a;do n=n+e[i++]|0,s=s+n|0;while(--a);n%=65521,s%=65521}return n|s<<16|0},av=nle,sle=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},ale=new Uint32Array(sle()),ole=(t,e,r,i)=>{let n=ale,s=i+r;t^=-1;for(let a=i;a<s;a++)t=t>>>8^n[(t^e[a])&255];return t^-1},wc=ole,i1={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},a1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},{_tr_init:lle,_tr_stored_block:QN,_tr_flush_block:cle,_tr_tally:y0,_tr_align:ule}=ile,{Z_NO_FLUSH:b0,Z_PARTIAL_FLUSH:hle,Z_FULL_FLUSH:dle,Z_FINISH:bA,Z_BLOCK:s9,Z_OK:$c,Z_STREAM_END:a9,Z_STREAM_ERROR:Op,Z_DATA_ERROR:Ale,Z_BUF_ERROR:ON,Z_DEFAULT_COMPRESSION:fle,Z_FILTERED:ple,Z_HUFFMAN_ONLY:$I,Z_RLE:mle,Z_FIXED:gle,Z_DEFAULT_STRATEGY:yle,Z_UNKNOWN:ble,Z_DEFLATED:oB}=a1,xle=9,Ele=15,wle=8,vle=29,Cle=256,zN=Cle+1+vle,Sle=30,Tle=19,Ile=2*zN+1,Ble=15,ds=3,g0=258,Np=g0+ds+1,Dle=32,vx=42,rR=57,XN=69,qN=73,WN=91,KN=103,t1=113,Jw=666,xh=1,Tx=2,n1=3,Ix=4,_le=3,r1=(t,e)=>(t.msg=i1[e],e),o9=t=>t*2-(t>4?9:0),m0=t=>{let e=t.length;for(;--e>=0;)t[e]=0},Ple=t=>{let e,r,i,n=t.w_size;e=t.hash_size,i=e;do r=t.head[--i],t.head[i]=r>=n?r-n:0;while(--e);e=n,i=e;do r=t.prev[--i],t.prev[i]=r>=n?r-n:0;while(--e)},Lle=(t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask,x0=Lle,Nd=t=>{let e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))},Rd=(t,e)=>{cle(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Nd(t.strm)},zs=(t,e)=>{t.pending_buf[t.pending++]=e},Kw=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255},JN=(t,e,r,i)=>{let n=t.avail_in;return n>i&&(n=i),n===0?0:(t.avail_in-=n,e.set(t.input.subarray(t.next_in,t.next_in+n),r),t.state.wrap===1?t.adler=av(t.adler,e,n,r):t.state.wrap===2&&(t.adler=wc(t.adler,e,n,r)),t.next_in+=n,t.total_in+=n,n)},Z9=(t,e)=>{let r=t.max_chain_length,i=t.strstart,n,s,a=t.prev_length,o=t.nice_match,l=t.strstart>t.w_size-Np?t.strstart-(t.w_size-Np):0,c=t.window,u=t.w_mask,d=t.prev,A=t.strstart+g0,h=c[i+a-1],f=c[i+a];t.prev_length>=t.good_match&&(r>>=2),o>t.lookahead&&(o=t.lookahead);do if(n=e,!(c[n+a]!==f||c[n+a-1]!==h||c[n]!==c[i]||c[++n]!==c[i+1])){i+=2,n++;do;while(c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&i<A);if(s=g0-(A-i),i=A-g0,s>a){if(t.match_start=e,a=s,s>=o)break;h=c[i+a-1],f=c[i+a]}}while((e=d[e&u])>l&&--r!==0);return a<=t.lookahead?a:t.lookahead},Cx=t=>{let e=t.w_size,r,i,n;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Np)&&(t.window.set(t.window.subarray(e,e+e-i),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),Ple(t),i+=e),t.strm.avail_in===0)break;if(r=JN(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=r,t.lookahead+t.insert>=ds)for(n=t.strstart-t.insert,t.ins_h=t.window[n],t.ins_h=x0(t,t.ins_h,t.window[n+1]);t.insert&&(t.ins_h=x0(t,t.ins_h,t.window[n+ds-1]),t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,t.insert--,!(t.lookahead+t.insert<ds)););}while(t.lookahead<Np&&t.strm.avail_in!==0)},eH=(t,e)=>{let r=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,i,n,s,a=0,o=t.strm.avail_in;do{if(i=65535,s=t.bi_valid+42>>3,t.strm.avail_out<s||(s=t.strm.avail_out-s,n=t.strstart-t.block_start,i>n+t.strm.avail_in&&(i=n+t.strm.avail_in),i>s&&(i=s),i<r&&(i===0&&e!==bA||e===b0||i!==n+t.strm.avail_in)))break;a=e===bA&&i===n+t.strm.avail_in?1:0,QN(t,0,0,a),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,Nd(t.strm),n&&(n>i&&(n=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+n),t.strm.next_out),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n,t.block_start+=n,i-=n),i&&(JN(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(a===0);return o-=t.strm.avail_in,o&&(o>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=o&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-o,t.strm.next_in),t.strstart),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),a?Ix:e!==b0&&e!==bA&&t.strm.avail_in===0&&t.strstart===t.block_start?Tx:(s=t.window_size-t.strstart,t.strm.avail_in>s&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,s+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),s>t.strm.avail_in&&(s=t.strm.avail_in),s&&(JN(t.strm,t.window,t.strstart,s),t.strstart+=s,t.insert+=s>t.w_size-t.insert?t.w_size-t.insert:s),t.high_water<t.strstart&&(t.high_water=t.strstart),s=t.bi_valid+42>>3,s=t.pending_buf_size-s>65535?65535:t.pending_buf_size-s,r=s>t.w_size?t.w_size:s,n=t.strstart-t.block_start,(n>=r||(n||e===bA)&&e!==b0&&t.strm.avail_in===0&&n<=s)&&(i=n>s?s:n,a=e===bA&&t.strm.avail_in===0&&i===n?1:0,QN(t,t.block_start,i,a),t.block_start+=i,Nd(t.strm)),a?n1:xh)},NN=(t,e)=>{let r,i;for(;;){if(t.lookahead<Np){if(Cx(t),t.lookahead<Np&&e===b0)return xh;if(t.lookahead===0)break}if(r=0,t.lookahead>=ds&&(t.ins_h=x0(t,t.ins_h,t.window[t.strstart+ds-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-Np&&(t.match_length=Z9(t,r)),t.match_length>=ds)if(i=y0(t,t.strstart-t.match_start,t.match_length-ds),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=ds){t.match_length--;do t.strstart++,t.ins_h=x0(t,t.ins_h,t.window[t.strstart+ds-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=x0(t,t.ins_h,t.window[t.strstart+1]);else i=y0(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(Rd(t,!1),t.strm.avail_out===0))return xh}return t.insert=t.strstart<ds-1?t.strstart:ds-1,e===bA?(Rd(t,!0),t.strm.avail_out===0?n1:Ix):t.sym_next&&(Rd(t,!1),t.strm.avail_out===0)?xh:Tx},xx=(t,e)=>{let r,i,n;for(;;){if(t.lookahead<Np){if(Cx(t),t.lookahead<Np&&e===b0)return xh;if(t.lookahead===0)break}if(r=0,t.lookahead>=ds&&(t.ins_h=x0(t,t.ins_h,t.window[t.strstart+ds-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=ds-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Np&&(t.match_length=Z9(t,r),t.match_length<=5&&(t.strategy===ple||t.match_length===ds&&t.strstart-t.match_start>4096)&&(t.match_length=ds-1)),t.prev_length>=ds&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-ds,i=y0(t,t.strstart-1-t.prev_match,t.prev_length-ds),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=n&&(t.ins_h=x0(t,t.ins_h,t.window[t.strstart+ds-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=ds-1,t.strstart++,i&&(Rd(t,!1),t.strm.avail_out===0))return xh}else if(t.match_available){if(i=y0(t,0,t.window[t.strstart-1]),i&&Rd(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return xh}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=y0(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<ds-1?t.strstart:ds-1,e===bA?(Rd(t,!0),t.strm.avail_out===0?n1:Ix):t.sym_next&&(Rd(t,!1),t.strm.avail_out===0)?xh:Tx},Ole=(t,e)=>{let r,i,n,s,a=t.window;for(;;){if(t.lookahead<=g0){if(Cx(t),t.lookahead<=g0&&e===b0)return xh;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=ds&&t.strstart>0&&(n=t.strstart-1,i=a[n],i===a[++n]&&i===a[++n]&&i===a[++n])){s=t.strstart+g0;do;while(i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&n<s);t.match_length=g0-(s-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=ds?(r=y0(t,1,t.match_length-ds),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=y0(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(Rd(t,!1),t.strm.avail_out===0))return xh}return t.insert=0,e===bA?(Rd(t,!0),t.strm.avail_out===0?n1:Ix):t.sym_next&&(Rd(t,!1),t.strm.avail_out===0)?xh:Tx},Nle=(t,e)=>{let r;for(;;){if(t.lookahead===0&&(Cx(t),t.lookahead===0)){if(e===b0)return xh;break}if(t.match_length=0,r=y0(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(Rd(t,!1),t.strm.avail_out===0))return xh}return t.insert=0,e===bA?(Rd(t,!0),t.strm.avail_out===0?n1:Ix):t.sym_next&&(Rd(t,!1),t.strm.avail_out===0)?xh:Tx};function Pp(t,e,r,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=i,this.func=n}var $w=[new Pp(0,0,0,0,eH),new Pp(4,4,8,4,NN),new Pp(4,5,16,8,NN),new Pp(4,6,32,32,NN),new Pp(4,4,16,16,xx),new Pp(8,16,32,32,xx),new Pp(8,16,128,128,xx),new Pp(8,32,128,256,xx),new Pp(32,128,258,1024,xx),new Pp(32,258,258,4096,xx)],Rle=t=>{t.window_size=2*t.w_size,m0(t.head),t.max_lazy_match=$w[t.level].max_lazy,t.good_match=$w[t.level].good_length,t.nice_match=$w[t.level].nice_length,t.max_chain_length=$w[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=ds-1,t.match_available=0,t.ins_h=0};function Mle(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=oB,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Ile*2),this.dyn_dtree=new Uint16Array((2*Sle+1)*2),this.bl_tree=new Uint16Array((2*Tle+1)*2),m0(this.dyn_ltree),m0(this.dyn_dtree),m0(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Ble+1),this.heap=new Uint16Array(2*zN+1),m0(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*zN+1),m0(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var hv=t=>{if(!t)return 1;let e=t.state;return!e||e.strm!==t||e.status!==vx&&e.status!==rR&&e.status!==XN&&e.status!==qN&&e.status!==WN&&e.status!==KN&&e.status!==t1&&e.status!==Jw?1:0},tH=t=>{if(hv(t))return r1(t,Op);t.total_in=t.total_out=0,t.data_type=ble;let e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?rR:e.wrap?vx:t1,t.adler=e.wrap===2?0:1,e.last_flush=-2,lle(e),$c},rH=t=>{let e=tH(t);return e===$c&&Rle(t.state),e},kle=(t,e)=>hv(t)||t.state.wrap!==2?Op:(t.state.gzhead=e,$c),iH=(t,e,r,i,n,s)=>{if(!t)return Op;let a=1;if(e===fle&&(e=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),n<1||n>xle||r!==oB||i<8||i>15||e<0||e>9||s<0||s>gle||i===8&&a!==1)return r1(t,Op);i===8&&(i=9);let o=new Mle;return t.state=o,o.strm=t,o.status=vx,o.wrap=a,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+ds-1)/ds),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=(o.lit_bufsize-1)*3,o.level=e,o.strategy=s,o.method=r,rH(t)},Fle=(t,e)=>iH(t,e,oB,Ele,wle,yle),Ule=(t,e)=>{if(hv(t)||e>s9||e<0)return t?r1(t,Op):Op;let r=t.state;if(!t.output||t.avail_in!==0&&!t.input||r.status===Jw&&e!==bA)return r1(t,t.avail_out===0?ON:Op);let i=r.last_flush;if(r.last_flush=e,r.pending!==0){if(Nd(t),t.avail_out===0)return r.last_flush=-1,$c}else if(t.avail_in===0&&o9(e)<=o9(i)&&e!==bA)return r1(t,ON);if(r.status===Jw&&t.avail_in!==0)return r1(t,ON);if(r.status===vx&&r.wrap===0&&(r.status=t1),r.status===vx){let n=oB+(r.w_bits-8<<4)<<8,s=-1;if(r.strategy>=$I||r.level<2?s=0:r.level<6?s=1:r.level===6?s=2:s=3,n|=s<<6,r.strstart!==0&&(n|=Dle),n+=31-n%31,Kw(r,n),r.strstart!==0&&(Kw(r,t.adler>>>16),Kw(r,t.adler&65535)),t.adler=1,r.status=t1,Nd(t),r.pending!==0)return r.last_flush=-1,$c}if(r.status===rR){if(t.adler=0,zs(r,31),zs(r,139),zs(r,8),r.gzhead)zs(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),zs(r,r.gzhead.time&255),zs(r,r.gzhead.time>>8&255),zs(r,r.gzhead.time>>16&255),zs(r,r.gzhead.time>>24&255),zs(r,r.level===9?2:r.strategy>=$I||r.level<2?4:0),zs(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(zs(r,r.gzhead.extra.length&255),zs(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=wc(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=XN;else if(zs(r,0),zs(r,0),zs(r,0),zs(r,0),zs(r,0),zs(r,r.level===9?2:r.strategy>=$I||r.level<2?4:0),zs(r,_le),r.status=t1,Nd(t),r.pending!==0)return r.last_flush=-1,$c}if(r.status===XN){if(r.gzhead.extra){let n=r.pending,s=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+s>r.pending_buf_size;){let o=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+o),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>n&&(t.adler=wc(t.adler,r.pending_buf,r.pending-n,n)),r.gzindex+=o,Nd(t),r.pending!==0)return r.last_flush=-1,$c;n=0,s-=o}let a=new Uint8Array(r.gzhead.extra);r.pending_buf.set(a.subarray(r.gzindex,r.gzindex+s),r.pending),r.pending+=s,r.gzhead.hcrc&&r.pending>n&&(t.adler=wc(t.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=qN}if(r.status===qN){if(r.gzhead.name){let n=r.pending,s;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(t.adler=wc(t.adler,r.pending_buf,r.pending-n,n)),Nd(t),r.pending!==0)return r.last_flush=-1,$c;n=0}r.gzindex<r.gzhead.name.length?s=r.gzhead.name.charCodeAt(r.gzindex++)&255:s=0,zs(r,s)}while(s!==0);r.gzhead.hcrc&&r.pending>n&&(t.adler=wc(t.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=WN}if(r.status===WN){if(r.gzhead.comment){let n=r.pending,s;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(t.adler=wc(t.adler,r.pending_buf,r.pending-n,n)),Nd(t),r.pending!==0)return r.last_flush=-1,$c;n=0}r.gzindex<r.gzhead.comment.length?s=r.gzhead.comment.charCodeAt(r.gzindex++)&255:s=0,zs(r,s)}while(s!==0);r.gzhead.hcrc&&r.pending>n&&(t.adler=wc(t.adler,r.pending_buf,r.pending-n,n))}r.status=KN}if(r.status===KN){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Nd(t),r.pending!==0))return r.last_flush=-1,$c;zs(r,t.adler&255),zs(r,t.adler>>8&255),t.adler=0}if(r.status=t1,Nd(t),r.pending!==0)return r.last_flush=-1,$c}if(t.avail_in!==0||r.lookahead!==0||e!==b0&&r.status!==Jw){let n=r.level===0?eH(r,e):r.strategy===$I?Nle(r,e):r.strategy===mle?Ole(r,e):$w[r.level].func(r,e);if((n===n1||n===Ix)&&(r.status=Jw),n===xh||n===n1)return t.avail_out===0&&(r.last_flush=-1),$c;if(n===Tx&&(e===hle?ule(r):e!==s9&&(QN(r,0,0,!1),e===dle&&(m0(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),Nd(t),t.avail_out===0))return r.last_flush=-1,$c}return e!==bA?$c:r.wrap<=0?a9:(r.wrap===2?(zs(r,t.adler&255),zs(r,t.adler>>8&255),zs(r,t.adler>>16&255),zs(r,t.adler>>24&255),zs(r,t.total_in&255),zs(r,t.total_in>>8&255),zs(r,t.total_in>>16&255),zs(r,t.total_in>>24&255)):(Kw(r,t.adler>>>16),Kw(r,t.adler&65535)),Nd(t),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?$c:a9)},Hle=t=>{if(hv(t))return Op;let e=t.state.status;return t.state=null,e===t1?r1(t,Ale):$c},Gle=(t,e)=>{let r=e.length;if(hv(t))return Op;let i=t.state,n=i.wrap;if(n===2||n===1&&i.status!==vx||i.lookahead)return Op;if(n===1&&(t.adler=av(t.adler,e,r,0)),i.wrap=0,r>=i.w_size){n===0&&(m0(i.head),i.strstart=0,i.block_start=0,i.insert=0);let l=new Uint8Array(i.w_size);l.set(e.subarray(r-i.w_size,r),0),e=l,r=i.w_size}let s=t.avail_in,a=t.next_in,o=t.input;for(t.avail_in=r,t.next_in=0,t.input=e,Cx(i);i.lookahead>=ds;){let l=i.strstart,c=i.lookahead-(ds-1);do i.ins_h=x0(i,i.ins_h,i.window[l+ds-1]),i.prev[l&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=l,l++;while(--c);i.strstart=l,i.lookahead=ds-1,Cx(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=ds-1,i.match_available=0,t.next_in=a,t.input=o,t.avail_in=s,i.wrap=n,$c},Yle=Fle,Vle=iH,jle=rH,Qle=tH,zle=kle,Xle=Ule,qle=Hle,Wle=Gle,Kle="pako deflate (from Nodeca project)",ev={deflateInit:Yle,deflateInit2:Vle,deflateReset:jle,deflateResetKeep:Qle,deflateSetHeader:zle,deflate:Xle,deflateEnd:qle,deflateSetDictionary:Wle,deflateInfo:Kle},Jle=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),$le=function(t){let e=Array.prototype.slice.call(arguments,1);for(;e.length;){let r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(let i in r)Jle(r,i)&&(t[i]=r[i])}}return t},Zle=t=>{let e=0;for(let i=0,n=t.length;i<n;i++)e+=t[i].length;let r=new Uint8Array(e);for(let i=0,n=0,s=t.length;i<s;i++){let a=t[i];r.set(a,n),n+=a.length}return r},lB={assign:$le,flattenChunks:Zle},nH=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{nH=!1}var ov=new Uint8Array(256);for(let t=0;t<256;t++)ov[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;ov[254]=ov[254]=1;var ece=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,i,n,s,a=t.length,o=0;for(n=0;n<a;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<a&&(i=t.charCodeAt(n+1),(i&64512)===56320&&(r=65536+(r-55296<<10)+(i-56320),n++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(o),s=0,n=0;s<o;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<a&&(i=t.charCodeAt(n+1),(i&64512)===56320&&(r=65536+(r-55296<<10)+(i-56320),n++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e},tce=(t,e)=>{if(e<65534&&t.subarray&&nH)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let i=0;i<e;i++)r+=String.fromCharCode(t[i]);return r},rce=(t,e)=>{let r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let i,n,s=new Array(r*2);for(n=0,i=0;i<r;){let a=t[i++];if(a<128){s[n++]=a;continue}let o=ov[a];if(o>4){s[n++]=65533,i+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&i<r;)a=a<<6|t[i++]&63,o--;if(o>1){s[n++]=65533;continue}a<65536?s[n++]=a:(a-=65536,s[n++]=55296|a>>10&1023,s[n++]=56320|a&1023)}return tce(s,n)},ice=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+ov[t[r]]>e?r:e},lv={string2buf:ece,buf2string:rce,utf8border:ice};function nce(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var sH=nce,aH=Object.prototype.toString,{Z_NO_FLUSH:sce,Z_SYNC_FLUSH:ace,Z_FULL_FLUSH:oce,Z_FINISH:lce,Z_OK:sB,Z_STREAM_END:cce,Z_DEFAULT_COMPRESSION:uce,Z_DEFAULT_STRATEGY:hce,Z_DEFLATED:dce}=a1;function dv(t){this.options=lB.assign({level:uce,method:dce,chunkSize:16384,windowBits:15,memLevel:8,strategy:hce},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new sH,this.strm.avail_out=0;let r=ev.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==sB)throw new Error(i1[r]);if(e.header&&ev.deflateSetHeader(this.strm,e.header),e.dictionary){let i;if(typeof e.dictionary=="string"?i=lv.string2buf(e.dictionary):aH.call(e.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(e.dictionary):i=e.dictionary,r=ev.deflateSetDictionary(this.strm,i),r!==sB)throw new Error(i1[r]);this._dict_set=!0}}dv.prototype.push=function(t,e){let r=this.strm,i=this.options.chunkSize,n,s;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?lce:sce,typeof t=="string"?r.input=lv.string2buf(t):aH.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),(s===ace||s===oce)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(n=ev.deflate(r,s),n===cce)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),n=ev.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===sB;if(r.avail_out===0){this.onData(r.output);continue}if(s>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};dv.prototype.onData=function(t){this.chunks.push(t)};dv.prototype.onEnd=function(t){t===sB&&(this.result=lB.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function iR(t,e){let r=new dv(e);if(r.push(t,!0),r.err)throw r.msg||i1[r.err];return r.result}function Ace(t,e){return e=e||{},e.raw=!0,iR(t,e)}function fce(t,e){return e=e||{},e.gzip=!0,iR(t,e)}var pce=dv,mce=iR,gce=Ace,yce=fce,bce=a1,xce={Deflate:pce,deflate:mce,deflateRaw:gce,gzip:yce,constants:bce},ZI=16209,Ece=16191,wce=function(e,r){let i,n,s,a,o,l,c,u,d,A,h,f,p,m,y,g,b,E,w,x,I,C,G,U,_=e.state;i=e.next_in,G=e.input,n=i+(e.avail_in-5),s=e.next_out,U=e.output,a=s-(r-e.avail_out),o=s+(e.avail_out-257),l=_.dmax,c=_.wsize,u=_.whave,d=_.wnext,A=_.window,h=_.hold,f=_.bits,p=_.lencode,m=_.distcode,y=(1<<_.lenbits)-1,g=(1<<_.distbits)-1;e:do{f<15&&(h+=G[i++]<<f,f+=8,h+=G[i++]<<f,f+=8),b=p[h&y];t:for(;;){if(E=b>>>24,h>>>=E,f-=E,E=b>>>16&255,E===0)U[s++]=b&65535;else if(E&16){w=b&65535,E&=15,E&&(f<E&&(h+=G[i++]<<f,f+=8),w+=h&(1<<E)-1,h>>>=E,f-=E),f<15&&(h+=G[i++]<<f,f+=8,h+=G[i++]<<f,f+=8),b=m[h&g];r:for(;;){if(E=b>>>24,h>>>=E,f-=E,E=b>>>16&255,E&16){if(x=b&65535,E&=15,f<E&&(h+=G[i++]<<f,f+=8,f<E&&(h+=G[i++]<<f,f+=8)),x+=h&(1<<E)-1,x>l){e.msg="invalid distance too far back",_.mode=ZI;break e}if(h>>>=E,f-=E,E=s-a,x>E){if(E=x-E,E>u&&_.sane){e.msg="invalid distance too far back",_.mode=ZI;break e}if(I=0,C=A,d===0){if(I+=c-E,E<w){w-=E;do U[s++]=A[I++];while(--E);I=s-x,C=U}}else if(d<E){if(I+=c+d-E,E-=d,E<w){w-=E;do U[s++]=A[I++];while(--E);if(I=0,d<w){E=d,w-=E;do U[s++]=A[I++];while(--E);I=s-x,C=U}}}else if(I+=d-E,E<w){w-=E;do U[s++]=A[I++];while(--E);I=s-x,C=U}for(;w>2;)U[s++]=C[I++],U[s++]=C[I++],U[s++]=C[I++],w-=3;w&&(U[s++]=C[I++],w>1&&(U[s++]=C[I++]))}else{I=s-x;do U[s++]=U[I++],U[s++]=U[I++],U[s++]=U[I++],w-=3;while(w>2);w&&(U[s++]=U[I++],w>1&&(U[s++]=U[I++]))}}else if((E&64)===0){b=m[(b&65535)+(h&(1<<E)-1)];continue r}else{e.msg="invalid distance code",_.mode=ZI;break e}break}}else if((E&64)===0){b=p[(b&65535)+(h&(1<<E)-1)];continue t}else if(E&32){_.mode=Ece;break e}else{e.msg="invalid literal/length code",_.mode=ZI;break e}break}}while(i<n&&s<o);w=f>>3,i-=w,f-=w<<3,h&=(1<<f)-1,e.next_in=i,e.next_out=s,e.avail_in=i<n?5+(n-i):5-(i-n),e.avail_out=s<o?257+(o-s):257-(s-o),_.hold=h,_.bits=f},Ex=15,l9=852,c9=592,u9=0,RN=1,h9=2,vce=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Cce=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Sce=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Tce=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Ice=(t,e,r,i,n,s,a,o)=>{let l=o.bits,c=0,u=0,d=0,A=0,h=0,f=0,p=0,m=0,y=0,g=0,b,E,w,x,I,C=null,G,U=new Uint16Array(Ex+1),_=new Uint16Array(Ex+1),H=null,Q,j,$;for(c=0;c<=Ex;c++)U[c]=0;for(u=0;u<i;u++)U[e[r+u]]++;for(h=l,A=Ex;A>=1&&U[A]===0;A--);if(h>A&&(h=A),A===0)return n[s++]=1<<24|64<<16|0,n[s++]=1<<24|64<<16|0,o.bits=1,0;for(d=1;d<A&&U[d]===0;d++);for(h<d&&(h=d),m=1,c=1;c<=Ex;c++)if(m<<=1,m-=U[c],m<0)return-1;if(m>0&&(t===u9||A!==1))return-1;for(_[1]=0,c=1;c<Ex;c++)_[c+1]=_[c]+U[c];for(u=0;u<i;u++)e[r+u]!==0&&(a[_[e[r+u]]++]=u);if(t===u9?(C=H=a,G=20):t===RN?(C=vce,H=Cce,G=257):(C=Sce,H=Tce,G=0),g=0,u=0,c=d,I=s,f=h,p=0,w=-1,y=1<<h,x=y-1,t===RN&&y>l9||t===h9&&y>c9)return 1;for(;;){Q=c-p,a[u]+1<G?(j=0,$=a[u]):a[u]>=G?(j=H[a[u]-G],$=C[a[u]-G]):(j=96,$=0),b=1<<c-p,E=1<<f,d=E;do E-=b,n[I+(g>>p)+E]=Q<<24|j<<16|$|0;while(E!==0);for(b=1<<c-1;g&b;)b>>=1;if(b!==0?(g&=b-1,g+=b):g=0,u++,--U[c]===0){if(c===A)break;c=e[r+a[u]]}if(c>h&&(g&x)!==w){for(p===0&&(p=h),I+=d,f=c-p,m=1<<f;f+p<A&&(m-=U[f+p],!(m<=0));)f++,m<<=1;if(y+=1<<f,t===RN&&y>l9||t===h9&&y>c9)return 1;w=g&x,n[w]=h<<24|f<<16|I-s|0}}return g!==0&&(n[I+g]=c-p<<24|64<<16|0),o.bits=h,0},tv=Ice,Bce=0,oH=1,lH=2,{Z_FINISH:d9,Z_BLOCK:Dce,Z_TREES:eB,Z_OK:s1,Z_STREAM_END:_ce,Z_NEED_DICT:Pce,Z_STREAM_ERROR:xA,Z_DATA_ERROR:cH,Z_MEM_ERROR:uH,Z_BUF_ERROR:Lce,Z_DEFLATED:A9}=a1,cB=16180,f9=16181,p9=16182,m9=16183,g9=16184,y9=16185,b9=16186,x9=16187,E9=16188,w9=16189,aB=16190,Hm=16191,MN=16192,v9=16193,kN=16194,C9=16195,S9=16196,T9=16197,I9=16198,tB=16199,rB=16200,B9=16201,D9=16202,_9=16203,P9=16204,L9=16205,FN=16206,O9=16207,N9=16208,yo=16209,hH=16210,dH=16211,Oce=852,Nce=592,Rce=15,Mce=Rce,R9=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function kce(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var o1=t=>{if(!t)return 1;let e=t.state;return!e||e.strm!==t||e.mode<cB||e.mode>dH?1:0},AH=t=>{if(o1(t))return xA;let e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=cB,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Oce),e.distcode=e.distdyn=new Int32Array(Nce),e.sane=1,e.back=-1,s1},fH=t=>{if(o1(t))return xA;let e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,AH(t)},pH=(t,e)=>{let r;if(o1(t))return xA;let i=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?xA:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=r,i.wbits=e,fH(t))},mH=(t,e)=>{if(!t)return xA;let r=new kce;t.state=r,r.strm=t,r.window=null,r.mode=cB;let i=pH(t,e);return i!==s1&&(t.state=null),i},Fce=t=>mH(t,Mce),M9=!0,UN,HN,Uce=t=>{if(M9){UN=new Int32Array(512),HN=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(tv(oH,t.lens,0,288,UN,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;tv(lH,t.lens,0,32,HN,0,t.work,{bits:5}),M9=!1}t.lencode=UN,t.lenbits=9,t.distcode=HN,t.distbits=5},gH=(t,e,r,i)=>{let n,s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),s.window.set(e.subarray(r-i,r-i+n),s.wnext),i-=n,i?(s.window.set(e.subarray(r-i,r),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0},Hce=(t,e)=>{let r,i,n,s,a,o,l,c,u,d,A,h,f,p,m=0,y,g,b,E,w,x,I,C,G=new Uint8Array(4),U,_,H=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(o1(t)||!t.output||!t.input&&t.avail_in!==0)return xA;r=t.state,r.mode===Hm&&(r.mode=MN),a=t.next_out,n=t.output,l=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,c=r.hold,u=r.bits,d=o,A=l,C=s1;e:for(;;)switch(r.mode){case cB:if(r.wrap===0){r.mode=MN;break}for(;u<16;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(r.wrap&2&&c===35615){r.wbits===0&&(r.wbits=15),r.check=0,G[0]=c&255,G[1]=c>>>8&255,r.check=wc(r.check,G,2,0),c=0,u=0,r.mode=f9;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((c&255)<<8)+(c>>8))%31){t.msg="incorrect header check",r.mode=yo;break}if((c&15)!==A9){t.msg="unknown compression method",r.mode=yo;break}if(c>>>=4,u-=4,I=(c&15)+8,r.wbits===0&&(r.wbits=I),I>15||I>r.wbits){t.msg="invalid window size",r.mode=yo;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=c&512?w9:Hm,c=0,u=0;break;case f9:for(;u<16;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(r.flags=c,(r.flags&255)!==A9){t.msg="unknown compression method",r.mode=yo;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=yo;break}r.head&&(r.head.text=c>>8&1),r.flags&512&&r.wrap&4&&(G[0]=c&255,G[1]=c>>>8&255,r.check=wc(r.check,G,2,0)),c=0,u=0,r.mode=p9;case p9:for(;u<32;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}r.head&&(r.head.time=c),r.flags&512&&r.wrap&4&&(G[0]=c&255,G[1]=c>>>8&255,G[2]=c>>>16&255,G[3]=c>>>24&255,r.check=wc(r.check,G,4,0)),c=0,u=0,r.mode=m9;case m9:for(;u<16;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}r.head&&(r.head.xflags=c&255,r.head.os=c>>8),r.flags&512&&r.wrap&4&&(G[0]=c&255,G[1]=c>>>8&255,r.check=wc(r.check,G,2,0)),c=0,u=0,r.mode=g9;case g9:if(r.flags&1024){for(;u<16;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}r.length=c,r.head&&(r.head.extra_len=c),r.flags&512&&r.wrap&4&&(G[0]=c&255,G[1]=c>>>8&255,r.check=wc(r.check,G,2,0)),c=0,u=0}else r.head&&(r.head.extra=null);r.mode=y9;case y9:if(r.flags&1024&&(h=r.length,h>o&&(h=o),h&&(r.head&&(I=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(i.subarray(s,s+h),I)),r.flags&512&&r.wrap&4&&(r.check=wc(r.check,i,h,s)),o-=h,s+=h,r.length-=h),r.length))break e;r.length=0,r.mode=b9;case b9:if(r.flags&2048){if(o===0)break e;h=0;do I=i[s+h++],r.head&&I&&r.length<65536&&(r.head.name+=String.fromCharCode(I));while(I&&h<o);if(r.flags&512&&r.wrap&4&&(r.check=wc(r.check,i,h,s)),o-=h,s+=h,I)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=x9;case x9:if(r.flags&4096){if(o===0)break e;h=0;do I=i[s+h++],r.head&&I&&r.length<65536&&(r.head.comment+=String.fromCharCode(I));while(I&&h<o);if(r.flags&512&&r.wrap&4&&(r.check=wc(r.check,i,h,s)),o-=h,s+=h,I)break e}else r.head&&(r.head.comment=null);r.mode=E9;case E9:if(r.flags&512){for(;u<16;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(r.wrap&4&&c!==(r.check&65535)){t.msg="header crc mismatch",r.mode=yo;break}c=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Hm;break;case w9:for(;u<32;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}t.adler=r.check=R9(c),c=0,u=0,r.mode=aB;case aB:if(r.havedict===0)return t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=o,r.hold=c,r.bits=u,Pce;t.adler=r.check=1,r.mode=Hm;case Hm:if(e===Dce||e===eB)break e;case MN:if(r.last){c>>>=u&7,u-=u&7,r.mode=FN;break}for(;u<3;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}switch(r.last=c&1,c>>>=1,u-=1,c&3){case 0:r.mode=v9;break;case 1:if(Uce(r),r.mode=tB,e===eB){c>>>=2,u-=2;break e}break;case 2:r.mode=S9;break;case 3:t.msg="invalid block type",r.mode=yo}c>>>=2,u-=2;break;case v9:for(c>>>=u&7,u-=u&7;u<32;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if((c&65535)!==(c>>>16^65535)){t.msg="invalid stored block lengths",r.mode=yo;break}if(r.length=c&65535,c=0,u=0,r.mode=kN,e===eB)break e;case kN:r.mode=C9;case C9:if(h=r.length,h){if(h>o&&(h=o),h>l&&(h=l),h===0)break e;n.set(i.subarray(s,s+h),a),o-=h,s+=h,l-=h,a+=h,r.length-=h;break}r.mode=Hm;break;case S9:for(;u<14;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(r.nlen=(c&31)+257,c>>>=5,u-=5,r.ndist=(c&31)+1,c>>>=5,u-=5,r.ncode=(c&15)+4,c>>>=4,u-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=yo;break}r.have=0,r.mode=T9;case T9:for(;r.have<r.ncode;){for(;u<3;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}r.lens[H[r.have++]]=c&7,c>>>=3,u-=3}for(;r.have<19;)r.lens[H[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,U={bits:r.lenbits},C=tv(Bce,r.lens,0,19,r.lencode,0,r.work,U),r.lenbits=U.bits,C){t.msg="invalid code lengths set",r.mode=yo;break}r.have=0,r.mode=I9;case I9:for(;r.have<r.nlen+r.ndist;){for(;m=r.lencode[c&(1<<r.lenbits)-1],y=m>>>24,g=m>>>16&255,b=m&65535,!(y<=u);){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(b<16)c>>>=y,u-=y,r.lens[r.have++]=b;else{if(b===16){for(_=y+2;u<_;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(c>>>=y,u-=y,r.have===0){t.msg="invalid bit length repeat",r.mode=yo;break}I=r.lens[r.have-1],h=3+(c&3),c>>>=2,u-=2}else if(b===17){for(_=y+3;u<_;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}c>>>=y,u-=y,I=0,h=3+(c&7),c>>>=3,u-=3}else{for(_=y+7;u<_;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}c>>>=y,u-=y,I=0,h=11+(c&127),c>>>=7,u-=7}if(r.have+h>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=yo;break}for(;h--;)r.lens[r.have++]=I}}if(r.mode===yo)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=yo;break}if(r.lenbits=9,U={bits:r.lenbits},C=tv(oH,r.lens,0,r.nlen,r.lencode,0,r.work,U),r.lenbits=U.bits,C){t.msg="invalid literal/lengths set",r.mode=yo;break}if(r.distbits=6,r.distcode=r.distdyn,U={bits:r.distbits},C=tv(lH,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,U),r.distbits=U.bits,C){t.msg="invalid distances set",r.mode=yo;break}if(r.mode=tB,e===eB)break e;case tB:r.mode=rB;case rB:if(o>=6&&l>=258){t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=o,r.hold=c,r.bits=u,wce(t,A),a=t.next_out,n=t.output,l=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,c=r.hold,u=r.bits,r.mode===Hm&&(r.back=-1);break}for(r.back=0;m=r.lencode[c&(1<<r.lenbits)-1],y=m>>>24,g=m>>>16&255,b=m&65535,!(y<=u);){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(g&&(g&240)===0){for(E=y,w=g,x=b;m=r.lencode[x+((c&(1<<E+w)-1)>>E)],y=m>>>24,g=m>>>16&255,b=m&65535,!(E+y<=u);){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}c>>>=E,u-=E,r.back+=E}if(c>>>=y,u-=y,r.back+=y,r.length=b,g===0){r.mode=L9;break}if(g&32){r.back=-1,r.mode=Hm;break}if(g&64){t.msg="invalid literal/length code",r.mode=yo;break}r.extra=g&15,r.mode=B9;case B9:if(r.extra){for(_=r.extra;u<_;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=D9;case D9:for(;m=r.distcode[c&(1<<r.distbits)-1],y=m>>>24,g=m>>>16&255,b=m&65535,!(y<=u);){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if((g&240)===0){for(E=y,w=g,x=b;m=r.distcode[x+((c&(1<<E+w)-1)>>E)],y=m>>>24,g=m>>>16&255,b=m&65535,!(E+y<=u);){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}c>>>=E,u-=E,r.back+=E}if(c>>>=y,u-=y,r.back+=y,g&64){t.msg="invalid distance code",r.mode=yo;break}r.offset=b,r.extra=g&15,r.mode=_9;case _9:if(r.extra){for(_=r.extra;u<_;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=yo;break}r.mode=P9;case P9:if(l===0)break e;if(h=A-l,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=yo;break}h>r.wnext?(h-=r.wnext,f=r.wsize-h):f=r.wnext-h,h>r.length&&(h=r.length),p=r.window}else p=n,f=a-r.offset,h=r.length;h>l&&(h=l),l-=h,r.length-=h;do n[a++]=p[f++];while(--h);r.length===0&&(r.mode=rB);break;case L9:if(l===0)break e;n[a++]=r.length,l--,r.mode=rB;break;case FN:if(r.wrap){for(;u<32;){if(o===0)break e;o--,c|=i[s++]<<u,u+=8}if(A-=l,t.total_out+=A,r.total+=A,r.wrap&4&&A&&(t.adler=r.check=r.flags?wc(r.check,n,A,a-A):av(r.check,n,A,a-A)),A=l,r.wrap&4&&(r.flags?c:R9(c))!==r.check){t.msg="incorrect data check",r.mode=yo;break}c=0,u=0}r.mode=O9;case O9:if(r.wrap&&r.flags){for(;u<32;){if(o===0)break e;o--,c+=i[s++]<<u,u+=8}if(r.wrap&4&&c!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=yo;break}c=0,u=0}r.mode=N9;case N9:C=_ce;break e;case yo:C=cH;break e;case hH:return uH;case dH:default:return xA}return t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=o,r.hold=c,r.bits=u,(r.wsize||A!==t.avail_out&&r.mode<yo&&(r.mode<FN||e!==d9))&&gH(t,t.output,t.next_out,A-t.avail_out),d-=t.avail_in,A-=t.avail_out,t.total_in+=d,t.total_out+=A,r.total+=A,r.wrap&4&&A&&(t.adler=r.check=r.flags?wc(r.check,n,A,t.next_out-A):av(r.check,n,A,t.next_out-A)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Hm?128:0)+(r.mode===tB||r.mode===kN?256:0),(d===0&&A===0||e===d9)&&C===s1&&(C=Lce),C},Gce=t=>{if(o1(t))return xA;let e=t.state;return e.window&&(e.window=null),t.state=null,s1},Yce=(t,e)=>{if(o1(t))return xA;let r=t.state;return(r.wrap&2)===0?xA:(r.head=e,e.done=!1,s1)},Vce=(t,e)=>{let r=e.length,i,n,s;return o1(t)||(i=t.state,i.wrap!==0&&i.mode!==aB)?xA:i.mode===aB&&(n=1,n=av(n,e,r,0),n!==i.check)?cH:(s=gH(t,e,r,r),s?(i.mode=hH,uH):(i.havedict=1,s1))},jce=fH,Qce=pH,zce=AH,Xce=Fce,qce=mH,Wce=Hce,Kce=Gce,Jce=Yce,$ce=Vce,Zce="pako inflate (from Nodeca project)",Ym={inflateReset:jce,inflateReset2:Qce,inflateResetKeep:zce,inflateInit:Xce,inflateInit2:qce,inflate:Wce,inflateEnd:Kce,inflateGetHeader:Jce,inflateSetDictionary:$ce,inflateInfo:Zce};function eue(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var tue=eue,yH=Object.prototype.toString,{Z_NO_FLUSH:rue,Z_FINISH:iue,Z_OK:cv,Z_STREAM_END:GN,Z_NEED_DICT:YN,Z_STREAM_ERROR:nue,Z_DATA_ERROR:k9,Z_MEM_ERROR:sue}=a1;function Av(t){this.options=lB.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});let e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new sH,this.strm.avail_out=0;let r=Ym.inflateInit2(this.strm,e.windowBits);if(r!==cv)throw new Error(i1[r]);if(this.header=new tue,Ym.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=lv.string2buf(e.dictionary):yH.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Ym.inflateSetDictionary(this.strm,e.dictionary),r!==cv)))throw new Error(i1[r])}Av.prototype.push=function(t,e){let r=this.strm,i=this.options.chunkSize,n=this.options.dictionary,s,a,o;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?iue:rue,yH.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),s=Ym.inflate(r,a),s===YN&&n&&(s=Ym.inflateSetDictionary(r,n),s===cv?s=Ym.inflate(r,a):s===k9&&(s=YN));r.avail_in>0&&s===GN&&r.state.wrap>0&&t[r.next_in]!==0;)Ym.inflateReset(r),s=Ym.inflate(r,a);switch(s){case nue:case k9:case YN:case sue:return this.onEnd(s),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||s===GN))if(this.options.to==="string"){let l=lv.utf8border(r.output,r.next_out),c=r.next_out-l,u=lv.buf2string(r.output,l);r.next_out=c,r.avail_out=i-c,c&&r.output.set(r.output.subarray(l,l+c),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===cv&&o===0)){if(s===GN)return s=Ym.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Av.prototype.onData=function(t){this.chunks.push(t)};Av.prototype.onEnd=function(t){t===cv&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=lB.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function nR(t,e){let r=new Av(e);if(r.push(t),r.err)throw r.msg||i1[r.err];return r.result}function aue(t,e){return e=e||{},e.raw=!0,nR(t,e)}var oue=Av,lue=nR,cue=aue,uue=nR,hue=a1,due={Inflate:oue,inflate:lue,inflateRaw:cue,ungzip:uue,constants:hue},{Deflate:Aue,deflate:fue,deflateRaw:pue,gzip:mue}=xce,{Inflate:gue,inflate:yue,inflateRaw:bue,ungzip:xue}=due,Eue=Aue,wue=fue,vue=pue,Cue=mue,Sue=gue,Tue=yue,Iue=bue,Bue=xue,Due=a1,sR={Deflate:Eue,deflate:wue,deflateRaw:vue,gzip:Cue,Inflate:Sue,inflate:Tue,inflateRaw:Iue,ungzip:Bue,constants:Due};var V3=pa(pv());var rhe=Object.create,cG=Object.defineProperty,ihe=Object.getOwnPropertyDescriptor,nhe=Object.getOwnPropertyNames,she=Object.getPrototypeOf,ahe=Object.prototype.hasOwnProperty,ohe=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),lhe=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of nhe(e))!ahe.call(t,n)&&n!==r&&cG(t,n,{get:()=>e[n],enumerable:!(i=ihe(e,n))||i.enumerable});return t},che=(t,e,r)=>(r=t!=null?rhe(she(t)):{},lhe(e||!t||!t.__esModule?cG(r,"default",{value:t,enumerable:!0}):r,t)),uhe=ohe((t,e)=>{"use strict";e.exports=r,e.exports.default=r;function r(v,N,R){R=R||2;var q=N&&N.length,P=q?N[0]*R:v.length,z=i(v,0,P,R,!0),W=[];if(!z||z.next===z.prev)return W;var oe,Ae,me,ve,Le,He,rt;if(q&&(z=u(v,N,z,R)),v.length>80*R){oe=me=v[0],Ae=ve=v[1];for(var qe=R;qe<P;qe+=R)Le=v[qe],He=v[qe+1],Le<oe&&(oe=Le),He<Ae&&(Ae=He),Le>me&&(me=Le),He>ve&&(ve=He);rt=Math.max(me-oe,ve-Ae),rt=rt!==0?32767/rt:0}return s(z,W,R,oe,Ae,rt,0),W}function i(v,N,R,q,P){var z,W;if(P===M(v,N,R,q)>0)for(z=N;z<R;z+=q)W=j(z,v[z],v[z+1],W);else for(z=R-q;z>=N;z-=q)W=j(z,v[z],v[z+1],W);return W&&x(W,W.next)&&($(W),W=W.next),W}function n(v,N){if(!v)return v;N||(N=v);var R=v,q;do if(q=!1,!R.steiner&&(x(R,R.next)||w(R.prev,R,R.next)===0)){if($(R),R=N=R.prev,R===R.next)break;q=!0}else R=R.next;while(q||R!==N);return N}function s(v,N,R,q,P,z,W){if(v){!W&&z&&p(v,q,P,z);for(var oe=v,Ae,me;v.prev!==v.next;){if(Ae=v.prev,me=v.next,z?o(v,q,P,z):a(v)){N.push(Ae.i/R|0),N.push(v.i/R|0),N.push(me.i/R|0),$(v),v=me.next,oe=me.next;continue}if(v=me,v===oe){W?W===1?(v=l(n(v),N,R),s(v,N,R,q,P,z,2)):W===2&&c(v,N,R,q,P,z):s(n(v),N,R,q,P,z,1);break}}}}function a(v){var N=v.prev,R=v,q=v.next;if(w(N,R,q)>=0)return!1;for(var P=N.x,z=R.x,W=q.x,oe=N.y,Ae=R.y,me=q.y,ve=P<z?P<W?P:W:z<W?z:W,Le=oe<Ae?oe<me?oe:me:Ae<me?Ae:me,He=P>z?P>W?P:W:z>W?z:W,rt=oe>Ae?oe>me?oe:me:Ae>me?Ae:me,qe=q.next;qe!==N;){if(qe.x>=ve&&qe.x<=He&&qe.y>=Le&&qe.y<=rt&&b(P,oe,z,Ae,W,me,qe.x,qe.y)&&w(qe.prev,qe,qe.next)>=0)return!1;qe=qe.next}return!0}function o(v,N,R,q){var P=v.prev,z=v,W=v.next;if(w(P,z,W)>=0)return!1;for(var oe=P.x,Ae=z.x,me=W.x,ve=P.y,Le=z.y,He=W.y,rt=oe<Ae?oe<me?oe:me:Ae<me?Ae:me,qe=ve<Le?ve<He?ve:He:Le<He?Le:He,xt=oe>Ae?oe>me?oe:me:Ae>me?Ae:me,Gt=ve>Le?ve>He?ve:He:Le>He?Le:He,ut=y(rt,qe,N,R,q),Pe=y(xt,Gt,N,R,q),ft=v.prevZ,ht=v.nextZ;ft&&ft.z>=ut&&ht&&ht.z<=Pe;){if(ft.x>=rt&&ft.x<=xt&&ft.y>=qe&&ft.y<=Gt&&ft!==P&&ft!==W&&b(oe,ve,Ae,Le,me,He,ft.x,ft.y)&&w(ft.prev,ft,ft.next)>=0||(ft=ft.prevZ,ht.x>=rt&&ht.x<=xt&&ht.y>=qe&&ht.y<=Gt&&ht!==P&&ht!==W&&b(oe,ve,Ae,Le,me,He,ht.x,ht.y)&&w(ht.prev,ht,ht.next)>=0))return!1;ht=ht.nextZ}for(;ft&&ft.z>=ut;){if(ft.x>=rt&&ft.x<=xt&&ft.y>=qe&&ft.y<=Gt&&ft!==P&&ft!==W&&b(oe,ve,Ae,Le,me,He,ft.x,ft.y)&&w(ft.prev,ft,ft.next)>=0)return!1;ft=ft.prevZ}for(;ht&&ht.z<=Pe;){if(ht.x>=rt&&ht.x<=xt&&ht.y>=qe&&ht.y<=Gt&&ht!==P&&ht!==W&&b(oe,ve,Ae,Le,me,He,ht.x,ht.y)&&w(ht.prev,ht,ht.next)>=0)return!1;ht=ht.nextZ}return!0}function l(v,N,R){var q=v;do{var P=q.prev,z=q.next.next;!x(P,z)&&I(P,q,q.next,z)&&_(P,z)&&_(z,P)&&(N.push(P.i/R|0),N.push(q.i/R|0),N.push(z.i/R|0),$(q),$(q.next),q=v=z),q=q.next}while(q!==v);return n(q)}function c(v,N,R,q,P,z){var W=v;do{for(var oe=W.next.next;oe!==W.prev;){if(W.i!==oe.i&&E(W,oe)){var Ae=Q(W,oe);W=n(W,W.next),Ae=n(Ae,Ae.next),s(W,N,R,q,P,z,0),s(Ae,N,R,q,P,z,0);return}oe=oe.next}W=W.next}while(W!==v)}function u(v,N,R,q){var P=[],z,W,oe,Ae,me;for(z=0,W=N.length;z<W;z++)oe=N[z]*q,Ae=z<W-1?N[z+1]*q:v.length,me=i(v,oe,Ae,q,!1),me===me.next&&(me.steiner=!0),P.push(g(me));for(P.sort(d),z=0;z<P.length;z++)R=A(P[z],R);return R}function d(v,N){return v.x-N.x}function A(v,N){var R=h(v,N);if(!R)return N;var q=Q(R,v);return n(q,q.next),n(R,R.next)}function h(v,N){var R=N,q=v.x,P=v.y,z=-1/0,W;do{if(P<=R.y&&P>=R.next.y&&R.next.y!==R.y){var oe=R.x+(P-R.y)*(R.next.x-R.x)/(R.next.y-R.y);if(oe<=q&&oe>z&&(z=oe,W=R.x<R.next.x?R:R.next,oe===q))return W}R=R.next}while(R!==N);if(!W)return null;var Ae=W,me=W.x,ve=W.y,Le=1/0,He;R=W;do q>=R.x&&R.x>=me&&q!==R.x&&b(P<ve?q:z,P,me,ve,P<ve?z:q,P,R.x,R.y)&&(He=Math.abs(P-R.y)/(q-R.x),_(R,v)&&(He<Le||He===Le&&(R.x>W.x||R.x===W.x&&f(W,R)))&&(W=R,Le=He)),R=R.next;while(R!==Ae);return W}function f(v,N){return w(v.prev,v,N.prev)<0&&w(N.next,v,v.next)<0}function p(v,N,R,q){var P=v;do P.z===0&&(P.z=y(P.x,P.y,N,R,q)),P.prevZ=P.prev,P.nextZ=P.next,P=P.next;while(P!==v);P.prevZ.nextZ=null,P.prevZ=null,m(P)}function m(v){var N,R,q,P,z,W,oe,Ae,me=1;do{for(R=v,v=null,z=null,W=0;R;){for(W++,q=R,oe=0,N=0;N<me&&(oe++,q=q.nextZ,!!q);N++);for(Ae=me;oe>0||Ae>0&&q;)oe!==0&&(Ae===0||!q||R.z<=q.z)?(P=R,R=R.nextZ,oe--):(P=q,q=q.nextZ,Ae--),z?z.nextZ=P:v=P,P.prevZ=z,z=P;R=q}z.nextZ=null,me*=2}while(W>1);return v}function y(v,N,R,q,P){return v=(v-R)*P|0,N=(N-q)*P|0,v=(v|v<<8)&16711935,v=(v|v<<4)&252645135,v=(v|v<<2)&858993459,v=(v|v<<1)&1431655765,N=(N|N<<8)&16711935,N=(N|N<<4)&252645135,N=(N|N<<2)&858993459,N=(N|N<<1)&1431655765,v|N<<1}function g(v){var N=v,R=v;do(N.x<R.x||N.x===R.x&&N.y<R.y)&&(R=N),N=N.next;while(N!==v);return R}function b(v,N,R,q,P,z,W,oe){return(P-W)*(N-oe)>=(v-W)*(z-oe)&&(v-W)*(q-oe)>=(R-W)*(N-oe)&&(R-W)*(z-oe)>=(P-W)*(q-oe)}function E(v,N){return v.next.i!==N.i&&v.prev.i!==N.i&&!U(v,N)&&(_(v,N)&&_(N,v)&&H(v,N)&&(w(v.prev,v,N.prev)||w(v,N.prev,N))||x(v,N)&&w(v.prev,v,v.next)>0&&w(N.prev,N,N.next)>0)}function w(v,N,R){return(N.y-v.y)*(R.x-N.x)-(N.x-v.x)*(R.y-N.y)}function x(v,N){return v.x===N.x&&v.y===N.y}function I(v,N,R,q){var P=G(w(v,N,R)),z=G(w(v,N,q)),W=G(w(R,q,v)),oe=G(w(R,q,N));return!!(P!==z&&W!==oe||P===0&&C(v,R,N)||z===0&&C(v,q,N)||W===0&&C(R,v,q)||oe===0&&C(R,N,q))}function C(v,N,R){return N.x<=Math.max(v.x,R.x)&&N.x>=Math.min(v.x,R.x)&&N.y<=Math.max(v.y,R.y)&&N.y>=Math.min(v.y,R.y)}function G(v){return v>0?1:v<0?-1:0}function U(v,N){var R=v;do{if(R.i!==v.i&&R.next.i!==v.i&&R.i!==N.i&&R.next.i!==N.i&&I(R,R.next,v,N))return!0;R=R.next}while(R!==v);return!1}function _(v,N){return w(v.prev,v,v.next)<0?w(v,N,v.next)>=0&&w(v,v.prev,N)>=0:w(v,N,v.prev)<0||w(v,v.next,N)<0}function H(v,N){var R=v,q=!1,P=(v.x+N.x)/2,z=(v.y+N.y)/2;do R.y>z!=R.next.y>z&&R.next.y!==R.y&&P<(R.next.x-R.x)*(z-R.y)/(R.next.y-R.y)+R.x&&(q=!q),R=R.next;while(R!==v);return q}function Q(v,N){var R=new B(v.i,v.x,v.y),q=new B(N.i,N.x,N.y),P=v.next,z=N.prev;return v.next=N,N.prev=v,R.next=P,P.prev=R,q.next=R,R.prev=q,z.next=q,q.prev=z,q}function j(v,N,R,q){var P=new B(v,N,R);return q?(P.next=q.next,P.prev=q,q.next.prev=P,q.next=P):(P.prev=P,P.next=P),P}function $(v){v.next.prev=v.prev,v.prev.next=v.next,v.prevZ&&(v.prevZ.nextZ=v.nextZ),v.nextZ&&(v.nextZ.prevZ=v.prevZ)}function B(v,N,R){this.i=v,this.x=N,this.y=R,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}r.deviation=function(v,N,R,q){var P=N&&N.length,z=P?N[0]*R:v.length,W=Math.abs(M(v,0,z,R));if(P)for(var oe=0,Ae=N.length;oe<Ae;oe++){var me=N[oe]*R,ve=oe<Ae-1?N[oe+1]*R:v.length;W-=Math.abs(M(v,me,ve,R))}var Le=0;for(oe=0;oe<q.length;oe+=3){var He=q[oe]*R,rt=q[oe+1]*R,qe=q[oe+2]*R;Le+=Math.abs((v[He]-v[qe])*(v[rt+1]-v[He+1])-(v[He]-v[rt])*(v[qe+1]-v[He+1]))}return W===0&&Le===0?0:Math.abs((Le-W)/W)};function M(v,N,R,q){for(var P=0,z=N,W=R-q;z<R;z+=q)P+=(v[W]-v[z])*(v[z+1]+v[W+1]),W=z;return P}r.flatten=function(v){for(var N=v[0][0].length,R={vertices:[],holes:[],dimensions:N},q=0,P=0;P<v.length;P++){for(var z=0;z<v[P].length;z++)for(var W=0;W<N;W++)R.vertices.push(v[P][z][W]);P>0&&(q+=v[P-1].length,R.holes.push(q))}return R}}),hhe=(t=>(t[t.MIL=1]="MIL",t[t.INCH=1e3]="INCH",t[t.FT=12e3]="FT",t[t.YARD=36e3]="YARD",t[t.MILE=6336e4]="MILE",t[t.KM=3937007874e-2]="KM",t[t.M=39370]="M",t[t.DM=3937]="DM",t[t.CM=393.7]="CM",t[t.MM=39.37]="MM",t[t.UM=.039]="UM",t[t.NM=394e-7]="NM",t[t.PT=13.88888888888889]="PT",t[t.PX72=13.88888888888889]="PX72",t[t.PX96=10.416666666666666]="PX96",t[t.PX100=10]="PX100",t[t.LTSPICE=6.25]="LTSPICE",t[t.PX1=.1]="PX1",t[t.PX001=.001]="PX001",t))(hhe||{}),dhe=(t=>(t.MIL="mil",t.INCH="inch",t.FT="ft",t.YARD="yard",t.MILE="mile",t.KM="km",t.M="m",t.DM="dm",t.CM="cm",t.MM="mm",t.UM="um",t.NM="nm",t.PT="pt",t.PX72="px(72)",t.PX96="px(96)",t.PX100="px(100)",t))(dhe||{}),BH={mil:1,inch:1e3,ft:12e3,yard:36e3,mile:6336e4,km:3937007874e-2,dm:3937,mm:39.37,um:.039,nm:394e-7,pt:13.88888888888889,"px(72)":13.88888888888889,"px(96)":10.416666666666666,"px(100)":10},$6e=(()=>{let t={};for(let e in BH)t[BH[e]]=e;return t})();var A1,Z6e=(A1=class{constructor(e,r){this.ratio=e/r}wrap(e){return e*this.ratio}static convert(e,r,i){return e*r/i}},A1.ASIS=new A1(1,1),A1),dB=class{conversion(t,e,r){if(t===e)return r;let i=t+2+e;return this[i](r)}conversion1(t,e,r){let i=t+2+e,n=this[i](r);return e=="mil"?Math.round(n*10)/10:Math.round(n*1e3)/1e3}mil2mil(t){return t}mil2mm(t){return t*.0254}mil2cm(t){return t*.00254}mil2inch(t){return t/1e3}mm2mm(t){return t}mm2mil(t){let e=Math.pow(10,5);return Math.round(t*39.37007874015748*e)/e}mm2cm(t){return t/10}mm2inch(t){let e=Math.pow(10,8);return Math.round(t*.03937007874015748*e)/e}cm2mil(t){let e=Math.pow(10,6);return Math.round(t*393.7007874015748*e)/e}cm2mm(t){return t*10}cm2inch(t){let e=Math.pow(10,7);return Math.round(t*.3937007874015748*e)/e}inch2mil(t){return t*1e3}inch2mm(t){return t*25.4}inch2cm(t){return t*2.54}};dB.prototype["px(100)2mil"]=t=>t*10,dB.prototype["px(100)2mm"]=t=>t*.254,dB.prototype["mil2px(100)"]=t=>t/10,dB.prototype["mm2px(100)"]=t=>{let e=Math.pow(10,5);return Math.round(t*3.937007874015748*e)/e};var AB=null,GR=new ArrayBuffer(8),fR=new Float64Array(GR),pR=new Uint32Array(GR),DH=new Uint16Array(GR);var _H=class{static repeat(t,e){let r=new Array(e);for(;e-- >0;)r[e]=t;return r.join("")}static lpad(t,e,r){let i=r-t.length;return i>0?this.repeat(e,i)+t:t}static rpad(t,e,r){let i=r-t.length;return i>0?t+this.repeat(e,i):t}static strHashcode(t){if(t.length>0){let e=0;for(let r=0;r<t.length;r++)e=31*e+t.charCodeAt(r)|0;return e}else return 0}static arraycopy(t,e,r,i,n){if(t.length>=e+n&&r.length>=i+n)for(;n-- >0;)r[i++]=t[e++];else throw new Error("arraycopy out of range")}static undefAsNull(t){return null}static reverse(t,e){for(let r=0,i=t.length-1;i>=0;r++,i--)e[r]=t[i];return e}static sortAsc(t,e){return t-e}static xmlDecode(t){let e=t.length,r=new Array,i=-1;for(let n=0;n<e;n++){let s=t.charAt(n);if(i>=0){if(s===";"){let a=t.substring(i+1,n);switch(a){case"lt":r.push("<");break;case"gt":r.push(">");break;case"quot":r.push('"');break;case"apos":r.push("'");break;case"amp":r.push("&");break;default:if(a.charAt(0)==="#"){let o=parseInt(a.substring(1));r.push(String.fromCharCode(o))}else r.push("&"+a+";")}i=-1}}else s==="&"?i=n:r.push(s)}return i>=0&&r.push(t.substring(i)),r.join("")}static addAll(t,e){for(let r of e)t.push(r)}static addAllSet(t,e){for(let r of e)t.add(r)}static contains(t,e){for(let r of t)if(r.equals(e))return!0;return!1}static equals(t,e){if(t.length==e.length){for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}else return!1}static remove(t,e){let r=0,i=t.length;for(let n=0;n<i;n++)t[n]===e&&(t.splice(n,1),n--,i--,r++);return r}static getUrlVars(){for(var t={},e=location.href.slice(location.href.indexOf("?")+1).split("&"),r=0;r<e.length;r++){var i=e[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}static prefix(){if(!AB){let t=this.getUrlVars().version;t?AB="/analyzer/v"+t:AB="/analyzer"}return AB}static add2objS(t,e,r){if(e in t)return t[e];{let i=r(e);return t[e]=i,i}}static downloadFile(t,e){let r=document.createElement("a"),i=URL.createObjectURL(e);r.download=t,r.href=i,r.click(),URL.revokeObjectURL(i)}static uuid(){let t=new Array;fR[0]=new Date().getTime(),t.push(pR[1].toString(16)),fR[0]=Math.random(),t.push(DH[3].toString(16));let e=DH[2].toString(16);t.push("4"+e.substr(0,3)),fR[0]=performance.now();let r=pR[0].toString(16)+pR[1].toString(16);return t.push("0"+r.substr(0,3)),t.push(r.substr(3)),t.join("-")}static funcCopy(t){return(0,eval)("("+t.toString()+")")}static NVL(...t){for(let e of t)if(e!==null)return e;return null}static isSingle(t){return Array.from(new Set(t)).length===t.length}};var uG=class{static rgb(t){if(0<=t&&t<=255)return t;throw new Error(Ux.format("RGB should not nagative and not over 255(0xFF): %X",t))}static normal(t){if(isFinite(t))return t;throw new Error(Ux.format("%f is not permitted",t))}static positiveOr0(t){if(t>=0)return t;throw new Error(Ux.format("%f must >= 0",t))}static positive(t){if(t>0)return t;throw new Error(Ux.format("%f must > 0",t))}static notnull(t){if(t!=null)return t;throw new Error("invalid null value")}static mustnull(t){if(t===null)return null;throw new Error("value must be null")}static notEmpty(t){if(t==null||t.length===0)throw new Error("invalid empty string");return t}static nullOrEmpty(t){return t==null||t.length===0}static notNullOrUndef(t){if(t!=null)return t;throw new Error("null or undefined is not permitted")}},Ahe=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.PERCENT=1]="PERCENT",t[t.LEFT_PAD0=2]="LEFT_PAD0",t))(Ahe||{}),fhe=/(\.?0+)$/,Ux=class{static format(t,...e){return this.format1(t,e)}static format1(t,e){let r=this._format(t,e);if(typeof r=="string")return r;throw new Error(this.format("Invalid state on (%d) %s",r,t))}static _format(t,e){let r=[],i=0,n=0,s,a=0,o=0;for(let l=0;l<t.length;l++){let c=t.charAt(l),u=c.charCodeAt(0);switch(i){case 0:u===37?i=1:r.push(c);break;case 1:switch(u){case 100:if(s=e[n++],typeof s=="number")r.push(s.toFixed(0)),i=0;else return l;break;case 102:if(s=e[n++],typeof s=="number")r.push(s.toString()),i=0;else return l;break;case 120:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16)),i=0;else return l;break;case 88:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16).toUpperCase()),i=0;else return l;break;case 115:case 99:s=e[n++],r.push(s===null?"null":s.toString()),i=0;break;case 48:a=l+1,o=-1,i=2;break;case 37:r.push("%"),i=0;break;default:return l}break;case 2:switch(u){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=l;break;case 120:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(_H.lpad((s|0).toString(16),"0",d)),i=0;else return l}else return l;break;case 88:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(_H.lpad((s|0).toString(16).toUpperCase(),"0",d)),i=0;else return l}else return l;break;default:return l}break;default:return l}}return r.join("")}static startsWith(t,e){return t.length>=e.length?t.substring(0,e.length)===e:!1}static endsWith(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}static split(t,e){let r=new Array,i=0;for(;;){let n=t.exec(e);if(n!==null){let s=t.lastIndex-n[0].length;r.push(e.substring(i,s)),i=t.lastIndex}else{let s=e.substring(i);uG.nullOrEmpty(s)||r.push(s);break}}return r}static fmtNumber(t){return t.toFixed(5).replace(fhe,"")}},phe=(t=>(t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARNING=2]="WARNING",t[t.ERROR=3]="ERROR",t[t.DUMMY=4]="DUMMY",t))(phe||{});function mhe(t){switch(t){case 0:return"DEBUG";case 1:return"INFO";case 2:return"WARNING";case 3:return"ERROR";case 4:return"DUMMY"}}var ghe=(t,e)=>{t===3?console.error(e):console.log(e)},yhe=(t,e)=>Ux.format("%s %s: %s",new Date,mhe(t),e),Wm,QB=(Wm=class{constructor(e,r=ghe,i=yhe){this.debug=!1,this.level=e,this.writer=r,this.fmt=i}static mix(...e){let r=4;for(let i of e)i.level<r&&(r=i.level);return new Wm(r,(i,n)=>{for(let s of e)s.write1(i,n)},(i,n)=>n)}wrap(e=null,r=null){let i=e===null?this.fmt:(s,a)=>(a=e(s,a),this.fmt(s,a)),n=r===null?this.writer:(s,a)=>{r(s,a),this.writer(s,a)};return new Wm(this.level,n,i)}chain(e){return e.wrap(this.fmt.bind(this),this.writer.bind(this))}include(e){return this.level<=e}write3(e,r,i){this.include(e)&&this.writer(e,this.fmt(e,Ux.format(r,...i)))}write2(e,r){this.include(e)&&(r instanceof Error?this.writer(e,this.fmt(e,r.stack)):this.writer(e,this.fmt(e,r.toString())))}write1(e,r){this.include(e)&&this.writer(e,this.fmt(e,r))}debug3(e,...r){this.write3(0,e,r)}debug2(e){this.write2(0,e)}debug1(e){this.write1(0,e)}info3(e,...r){this.write3(1,e,r)}info2(e){this.write2(1,e)}info1(e){this.write1(1,e)}warning3(e,...r){this.write3(2,e,r)}warning2(e){this.write2(2,e)}warning1(e){this.write1(2,e)}error3(e,...r){this.write3(3,e,r)}error2(e){this.write2(3,e)}error1(e){this.write1(3,e)}},Wm.DUMMY=new Wm(4),Wm),YR=new ArrayBuffer(8),mR=new Float64Array(YR),gR=new Uint32Array(YR),PH=new Uint16Array(YR),LH=ArrayBuffer;try{LH=self.HTMLImageElement||LH}catch{}var fB=null;function p1(t,e,r=0,i=t.length){n(t,null,e,r,i);function n(a,o,l,c,u){let d,A,h,f;if(c<u-1){let p=u-c;if(p>50)o===null&&(o=new Array(p+1)),s(a,o,l,c,(c+u)/2|0,u);else{d=a[c],A=c,h=c,f=u;let m=A+1;for(;m<f;){if(h!=f){if(f=f+-1,l(d,a[f])<=0)continue;a[h]=a[f],h=f;continue}if(l(d,a[m])>=0){A=m,m=A+1;continue}a[h]=a[m],A=m,h=m,m=A+1}a[h]=d,n(a,o,l,c,h),n(a,o,l,h+1,u)}}}function s(a,o,l,c,u,d){n(a,o,l,c,u),n(a,o,l,u,d);for(var A=c,h=u,f=0,p=a[A],m=a[h];A<u&&h<d;){var y=l(p,m);isNaN(y)?(o[f++]=m,m=a[++h]):(y<=0&&(o[f++]=p,p=a[++A]),y>=0&&(o[f++]=m,m=a[++h]))}for(;A<u;A++)o[f++]=a[A];for(;h<d;h++)o[f++]=a[h];for(A=c,h=0;h<f;A++,h++)a[A]=o[h]}}var Zc=class{static repeat(t,e){let r=new Array(e);for(;e-- >0;)r[e]=t;return r.join("")}static lpad(t,e,r){let i=r-t.length;return i>0?this.repeat(e,i)+t:t}static rpad(t,e,r){let i=r-t.length;return i>0?t+this.repeat(e,i):t}static strHashcode(t){if(t.length>0){let e=0;for(let r=0;r<t.length;r++)e=31*e+t.charCodeAt(r)|0;return e}else return 0}static arraycopy(t,e,r,i,n){if(t.length>=e+n&&r.length>=i+n)for(;n-- >0;)r[i++]=t[e++];else throw new Error("arraycopy out of range")}static undefAsNull(t){return null}static reverse(t,e){for(let r=0,i=t.length-1;i>=0;r++,i--)e[r]=t[i];return e}static sortAsc(t,e){return t-e}static xmlDecode(t){let e=t.length,r=new Array,i=-1;for(let n=0;n<e;n++){let s=t.charAt(n);if(i>=0){if(s===";"){let a=t.substring(i+1,n);switch(a){case"lt":r.push("<");break;case"gt":r.push(">");break;case"quot":r.push('"');break;case"apos":r.push("'");break;case"amp":r.push("&");break;default:if(a.charAt(0)==="#"){let o=parseInt(a.substring(1));r.push(String.fromCharCode(o))}else r.push("&"+a+";")}i=-1}}else s==="&"?i=n:r.push(s)}return i>=0&&r.push(t.substring(i)),r.join("")}static addAll(t,e){for(let r of e)t.push(r)}static addAllSet(t,e){for(let r of e)t.add(r)}static contains(t,e){for(let r of t)if(r.equals(e))return!0;return!1}static equals(t,e){if(t.length==e.length){for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}else return!1}static remove(t,e){let r=0,i=t.length;for(let n=0;n<i;n++)t[n]===e&&(t.splice(n,1),n--,i--,r++);return r}static getUrlVars(){for(var t={},e=location.href.slice(location.href.indexOf("?")+1).split("&"),r=0;r<e.length;r++){var i=e[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}static prefix(){if(!fB){let t=this.getUrlVars().version;t?fB="/analyzer/v"+t:fB="/analyzer"}return fB}static add2objS(t,e,r){if(e in t)return t[e];{let i=r(e);return t[e]=i,i}}static downloadFile(t,e){let r=document.createElement("a"),i=URL.createObjectURL(e);r.download=t,r.href=i,r.click(),URL.revokeObjectURL(i)}static uuid(){let t=new Array;mR[0]=new Date().getTime(),t.push(gR[1].toString(16)),mR[0]=Math.random(),t.push(PH[3].toString(16));let e=PH[2].toString(16);t.push("4"+e.substr(0,3)),mR[0]=performance.now();let r=gR[0].toString(16)+gR[1].toString(16);return t.push("0"+r.substr(0,3)),t.push(r.substr(3)),t.join("-")}static funcCopy(t){return(0,eval)("("+t.toString()+")")}static NVL(...t){for(let e of t)if(e!==null)return e;return null}static isSingle(t){return Array.from(new Set(t)).length===t.length}},bhe=[1,10,100,1e3];var pB=0,c1=0;function OH(t,e,r){return pB=Math.abs(t-e),r>=5&&pB>1e-5||isNaN(r)&&pB>1e-8?!1:pB<1e-13?!0:(c1=Math.min(NH(t),NH(e)),c1<10&&(c1=10),isNaN(r)||(c1=Math.min(c1,r)),RH(t,c1)===RH(e,c1))}var mB=0,gB=0;function NH(t){return mB=0,gB=0,t>0?mB=t-Math.floor(t):mB=t-Math.ceil(t),gB=(mB.toString()||"").length,gB>2?gB-2:0}function RH(t,e,r){if(typeof t!="number"&&(t=+t),isNaN(t))return NaN;if(e=e|0,e<=0||!t&&!r)return Math.round(t);var i=bhe[e]||Math.pow(10,e)||10;if(r){var n=t<0?"-":"";for(t=t<0?-t:t,t=Math.round(t*i)+"";t.length<=e;)t="0"+t;return t=t.slice(0,-e)+"."+t.slice(-e),parseFloat(n+t)}else return Math.round(t*i+1e-10)/i}var xhe=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.PERCENT=1]="PERCENT",t[t.LEFT_PAD0=2]="LEFT_PAD0",t))(xhe||{}),Ehe=/(\.?0+)$/,Hx=class{static format(t,...e){return this.format1(t,e)}static format1(t,e){let r=this._format(t,e);if(typeof r=="string")return r;throw new Error(this.format("Invalid state on (%d) %s",r,t))}static _format(t,e){let r=[],i=0,n=0,s,a=0,o=0;for(let l=0;l<t.length;l++){let c=t.charAt(l),u=c.charCodeAt(0);switch(i){case 0:u===37?i=1:r.push(c);break;case 1:switch(u){case 100:if(s=e[n++],typeof s=="number")r.push(s.toFixed(0)),i=0;else return l;break;case 102:if(s=e[n++],typeof s=="number")r.push(s.toString()),i=0;else return l;break;case 120:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16)),i=0;else return l;break;case 88:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16).toUpperCase()),i=0;else return l;break;case 115:case 99:s=e[n++],r.push(s===null?"null":s.toString()),i=0;break;case 48:a=l+1,o=-1,i=2;break;case 37:r.push("%"),i=0;break;default:return l}break;case 2:switch(u){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=l;break;case 120:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(Zc.lpad((s|0).toString(16),"0",d)),i=0;else return l}else return l;break;case 88:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(Zc.lpad((s|0).toString(16).toUpperCase(),"0",d)),i=0;else return l}else return l;break;default:return l}break;default:return l}}return r.join("")}static startsWith(t,e){return t.length>=e.length?t.substring(0,e.length)===e:!1}static endsWith(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}static split(t,e){let r=new Array,i=0;for(;;){let n=t.exec(e);if(n!==null){let s=t.lastIndex-n[0].length;r.push(e.substring(i,s)),i=t.lastIndex}else{let s=e.substring(i);wa.nullOrEmpty(s)||r.push(s);break}}return r}static fmtNumber(t){return t.toFixed(5).replace(Ehe,"")}},wa=class{static rgb(t){if(0<=t&&t<=255)return t;throw new Error(Hx.format("RGB should not nagative and not over 255(0xFF): %X",t))}static normal(t){if(isFinite(t))return t;throw new Error(Hx.format("%f is not permitted",t))}static positiveOr0(t){if(t>=0)return t;throw new Error(Hx.format("%f must >= 0",t))}static positive(t){if(t>0)return t;throw new Error(Hx.format("%f must > 0",t))}static notnull(t){if(t!=null)return t;throw new Error("invalid null value")}static mustnull(t){if(t===null)return null;throw new Error("value must be null")}static notEmpty(t){if(t==null||t.length===0)throw new Error("invalid empty string");return t}static nullOrEmpty(t){return t==null||t.length===0}static notNullOrUndef(t){if(t!=null)return t;throw new Error("null or undefined is not permitted")}},f1,wt=(f1=class{static regular(e){return Math.round(e*this.precision)/this.precision}static eq(e,r){return Math.abs(e-r)<=this.eps}static neq(e,r){return Math.abs(e-r)>this.eps}static less(e,r){return e-r<-this.eps}static lesseq(e,r){return e-r<=this.eps}static greater(e,r){return e-r>this.eps}static greatereq(e,r){return e-r>=-this.eps}static sqrt(e){return Math.abs(e)<=1e-10?0:Math.sqrt(e)}static sortAsc(e,r){return e-r}static sortDesc(e,r){return r-e}},f1.eps=1e-8,f1.precision=1e8,f1);function Yx(t,e){RB(t.iterator(),e)}function RB(t,e){let r=0;for(;t.hasNext();){let i=t.next();e(r++,i)}}var whe=class{constructor(t){this.idx=-1,this.lst=t}hasNext(){return this.idx<this.lst.length-1}next(){if(this.idx<this.lst.length-1)return this.idx++,this.lst[this.idx];throw new Error("bug")}};function PR(t){return new whe(t)}var Rl,Ti=(Rl=class{static toDegrees(e){return e*180/Math.PI}static toRadians(e){return e/180*Math.PI}static regularD(e){return e=e%360,e=e<0?360+e:e,e===360?0:e}static regular(e){return e=e%Rl.PIx2,e=e<0?Rl.PIx2+e:e,e===Rl.PIx2?0:e}static toQuarterBase(e){return Rl.regular((e+Rl.PI_4)/Rl.PI_2*Rl.PI_2)}static toQuarterBaseD(e){return Rl.regularD(((e+45)/90|0)*90)}static transformD(e,r){return Rl.toDegrees(Rl.transform(Rl.toRadians(e),r))}static transform(e,r){let i=Math.cos(e),n=Math.sin(e),s=new ne(r.data[6],r.data[7]),a=new ne(i,n).multiply3(r);return Rl.regular(a.angle(s))}},Rl.PIx2=Math.PI*2,Rl.PI_2=Math.PI/2,Rl.PI_4=Math.PI/4,Rl),no=class{static dotProd1(t,e,r,i){return t*r+e*i}static dotProd2(t,e,r,i,n,s){return this.dotProd1(r-t,i-e,n-r,s-i)}static dotProd3(t,e,r){return this.dotProd2(t.x,t.y,e.x,e.y,r.x,r.y)}static crossProd1(t,e,r,i){return t*i-e*r}static crossProd2(t,e,r,i,n,s){return this.crossProd1(r-t,i-e,n-r,s-i)}static crossProd3(t,e,r){return this.crossProd2(t.x,t.y,e.x,e.y,r.x,r.y)}static distance2(t,e,r,i){let n=r-t,s=i-e;return n*n+s*s}static distance1(t,e,r,i){return this.hypot(r-t,i-e)}static distance1p(t,e){return this.distance1(t.x,t.y,e.x,e.y)}static hypot(t,e){if(t=Math.abs(t),e=Math.abs(e),e>t){var r=e;e=t,t=r}if(t===0)return e;var i=e/t;return t*Math.sqrt(1+i*i)}},hG=new ArrayBuffer(16),MH=new Float64Array(hG),yB=new Int32Array(hG),Mn,ne=(Mn=class{static sortByXAsc(e,r){return e.x-r.x}static sortByYAsc(e,r){return e.y-r.y}static sortByXYAsc(e,r){return e.x<r.x?-1:e.x>r.x?1:e.y-r.y}static caculateAngle(e,r){let i=Math.cos(e),n=Math.sin(e),s=i*r.data[0]+n*r.data[4],a=i*r.data[1]+n*r.data[5],o=new Mn(s,a).normalize();return Math.atan2(o.y,o.x)}static normal(e,r,i){let n=r.sub(e),s=i.sub(r);return n.cross(s)}static getVector2(e){return new Mn(Math.cos(e),Math.sin(e))}static getCrossPoint1(e,r,i,n){if(e.equals1(r)||i.equals1(n)||wt.eq(1,Math.abs(r.sub(e).normalize().dot(n.sub(i).normalize()))))return null;let s=r.y-e.y,a=e.x-r.x,o=r.x*e.y-e.x*r.y,l=n.y-i.y,c=i.x-n.x,u=n.x*i.y-i.x*n.y,d=s*c-l*a;return new Mn((u*a-o*c)/d,(o*l-u*s)/d)}static getCrossPoint2(e,r,i,n){return this.getCrossPoint1(e,e.add(r),i,i.add(n))}constructor(e,r){this.x=wa.normal(e),this.y=wa.normal(r)}get hashed(){return this._hashed==null&&(MH[0]=this.x,MH[1]=this.y,this._hashed=yB[0]^yB[1]^yB[2]^yB[3]),this._hashed}dot(e){return this.x*e.x+this.y*e.y}length(){return Math.sqrt(this.dot(this))}getCos(){return this.x/this.length()}sub(e){var r=this.x-e.x,i=this.y-e.y;return new Mn(r,i)}add(e){var r=this.x+e.x,i=this.y+e.y;return new Mn(r,i)}div(e){return new Mn(this.x/e,this.y/e)}add1(e,r){return new Mn(this.x+e,this.y+r)}mul(e){return new Mn(this.x*e,this.y*e)}cross(e){return this.x*e.y-this.y*e.x}getSin(){return this.y/this.length()}angle2(e){let r=this.y-e.y,i=this.x-e.x;return r=Math.abs(r-0)<10**-4?0:r,i=Math.abs(i-0)<10**-4?0:i,Math.atan2(r,i)}angleD2(e){return Ti.toDegrees(this.angle2(e))}angle(e){return Math.atan2(this.y-e.y,this.x-e.x)}angleX(e=Mn.ORIGIN){let r=this.angle(e);return r<0&&(r=Math.PI*2+r),r}angleD(e){return Ti.toDegrees(this.angle(e))}distance1(e){let r=e.x-this.x,i=e.y-this.y;return no.hypot(r,i)}distance2(e){let r=e.x-this.x,i=e.y-this.y;return r*r+i*i}rotateD(e,r){return this.rotate(e,Ti.toRadians(r))}rotate(e,r){let i=Math.cos(r),n=Math.sin(r),s=this.x-e.x,a=this.y-e.y,o=s*i+a*-n,l=s*n+a*i;return e.add1(o,l)}multiply3(e){let r=this.x*e.data[0]+this.y*e.data[3]+e.data[6],i=this.x*e.data[1]+this.y*e.data[4]+e.data[7];return new Mn(r,i)}multiply4(e){let r=this.x*e.data[0]+this.y*e.data[4]+e.data[12],i=this.x*e.data[1]+this.y*e.data[5]+e.data[13];return new Mn(r,i)}hashCode(){return this.hashed}equals(e,r){return e instanceof Mn?OH(e.x,this.x,r)&&OH(e.y,this.y,r):!1}equals1(e){return e?wt.eq(this.x,e.x)&&wt.eq(this.y,e.y):!1}equals2(e,r){return e instanceof Mn?Math.abs(this.x-e.x)<=r&&Math.abs(this.y-e.y)<=r:!1}similarEquals(e,r=.5){return Math.abs(this.x*.1-e.x*.1)<=r&&Math.abs(this.y*.1-e.y*.1)<=r}toString(){return"Vector [X="+this.x+", Y="+this.y+"]"}bbox(){let e=this.x,r=this.y;return new Mr(e,e,r,r)}normalize(){if(this.x===0&&this.y===0)return new Mn(0,0);let e=this.x/this.length(),r=this.y/this.length();return new Mn(e,r)}regular(e=1e-4){let r=Math.round(1/e);return new Mn(Math.round(this.x*r)/r,Math.round(this.y*r)/r)}round(e=4){let r=10**(e|0);return new Mn(Math.round(this.x*r)/r,Math.round(this.y*r)/r)}mirrorX(e=Mn.ORIGIN){return new Mn(this.x,2*e.y-this.y)}mirrorY(e=Mn.ORIGIN){return new Mn(2*e.x-this.x,this.y)}mirrorCenter(e=Mn.ORIGIN){return new Mn(2*e.x-this.x,2*e.y-this.y)}clone(){return new Mn(this.x,this.y)}mirror(e=Mn.ORIGIN){return new Mn(2*e.x-this.x,2*e.y-this.y)}pointOnRays(e,r){let i=Ti.toRadians(e);return new Mn(this.x+Math.cos(i)*r,this.y+Math.sin(i)*r)}pointOnRays2(e,r){let i=e.angle(this);return new Mn(this.x+Math.cos(i)*r,this.y+Math.sin(i)*r)}scale(e){return new Mn(this.x*e,this.y*e)}},Mn.ORIGIN=new Mn(0,0),Mn.X_UNIT_VECTOR=new Mn(1,0),Mn.Y_UNIT_VECTOR=new Mn(0,1),Mn),vhe=(t=>(t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT",t))(vhe||{}),Che=(t=>(t[t.TOP=0]="TOP",t[t.CENTER=1]="CENTER",t[t.BOTTOM=2]="BOTTOM",t))(Che||{}),Po,Vm=(Po=class{constructor(e,r){this.horizontal=e,this.vertical=r}},Po.LT=new Po(0,0),Po.LC=new Po(0,1),Po.LB=new Po(0,2),Po.CT=new Po(1,0),Po.CC=new Po(1,1),Po.CB=new Po(1,2),Po.RT=new Po(2,0),Po.RC=new Po(2,1),Po.RB=new Po(2,2),Po),She=(t=>(t[t.INNER=0]="INNER",t[t.OUTER=1]="OUTER",t[t.SEPARATED=2]="SEPARATED",t[t.INTERSECTED=3]="INTERSECTED",t[t.EQ=4]="EQ",t[t.INSIDE_TOUCHED=5]="INSIDE_TOUCHED",t[t.OUTSIDE_TOUCHED=6]="OUTSIDE_TOUCHED",t))(She||{}),pr=class{constructor(){this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY}ext1(t){return this.minX=Math.min(this.minX,t.minX),this.maxX=Math.max(this.maxX,t.maxX),this.minY=Math.min(this.minY,t.minY),this.maxY=Math.max(this.maxY,t.maxY),this}ext2(t){return this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y),this}ext3(t){for(let e=0;e<t.length;e++){let r=t[e];this.ext2(r)}return this}ext4(t){return Yx(t,(e,r)=>(this.ext2(r),!0)),this}ext5(t,e,r,i){return this.minX=Math.min(this.minX,t),this.maxX=Math.max(this.maxX,e),this.minY=Math.min(this.minY,r),this.maxY=Math.max(this.maxY,i),this}ext6(t,e){return this.minX=Math.min(this.minX,t),this.maxX=Math.max(this.maxX,t),this.minY=Math.min(this.minY,e),this.maxY=Math.max(this.maxY,e),this}ext7(t){if(t<0){let e=t*2;if(e<this.minX-this.maxX||e<this.minY-this.maxY)throw new Error("")}return this.minX-=t,this.maxX+=t,this.minY-=t,this.maxY+=t,this}ext8(t){let e=[];for(let r=0;r<t.length;r+=2)e.push(new ne(t[r],t[r+1]));return this.ext3(e)}ext9(t,e,r,i){return this.minX=Math.min(this.minX,t),this.maxX=Math.max(this.maxX,t+r),this.minY=Math.min(this.minY,e),this.maxY=Math.max(this.maxY,e+i),this}ext10({x:t,y:e,width:r,height:i}){return this.ext9(t,e,r,i)}valid(){return isFinite(this.minX)&&isFinite(this.maxX)&&isFinite(this.minY)&&isFinite(this.maxY)}clear(){this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY}build(){return new Mr(this.minX,this.maxX,this.minY,this.maxY)}build1(){return this.valid()?new Mr(this.minX,this.maxX,this.minY,this.maxY):new Mr(0,0,0,0)}},mv=new Float64Array(4),Mr=class EA{static extendRect({x:e,y:r,width:i,height:n}){return new EA(e,e+i,r,r+n)}static extend1(e,r){if(e===null)return new EA(r.x,r.x,r.y,r.y);{let i=Math.min(e.minX,r.x),n=Math.max(e.maxX,r.x),s=Math.min(e.minY,r.y),a=Math.max(e.maxY,r.y);return new EA(i,n,s,a)}}static extend2(e,r){if(e){let i=Math.min(e.minX,r.minX),n=Math.max(e.maxX,r.maxX),s=Math.min(e.minY,r.minY),a=Math.max(e.maxY,r.maxY);return new EA(i,n,s,a)}else return r}static extend3(e,r){let i=Math.min(e.x,r.x),n=Math.max(e.x,r.x),s=Math.min(e.y,r.y),a=Math.max(e.y,r.y);return new EA(i,n,s,a)}static extend4(e,r,i){return new EA(e.x-r/2,e.x+r/2,e.y-i/2,e.y+i/2)}constructor(e,r,i,n){if(this.minX=wa.normal(e),this.maxX=wa.normal(r),this.minY=wa.normal(i),this.maxY=wa.normal(n),e>r||i>n)throw new Error(`min > max is not permitted: [${e}, ${r}, ${i}, ${n}]`)}get data(){return mv[0]=this.minX,mv[1]=this.maxX,mv[2]=this.minY,mv[3]=this.maxY,mv}isContains(e){return this.isContains1(e.x,e.y)}points(){return[this.LL(),this.LR(),this.UR(),this.UL(),this.LL()]}isContains1(e,r){return this.isContainsX(e)&&this.isContainsY(r)}isContains2(e,r){return this.isContainsX1(e)&&this.isContainsY1(r)}isContainsX(e){return e>=this.minX&&e<=this.maxX}isContainsX1(e){return wt.greatereq(e,this.minX)&&wt.lesseq(e,this.maxX)}isContainsY(e){return e>=this.minY&&e<=this.maxY}isContainsY1(e){return wt.greatereq(e,this.minY)&&wt.lesseq(e,this.maxY)}isIntersect(e){return!(this.maxX<e.minX||this.minX>e.maxX||this.maxY<e.minY||this.minY>e.maxY)}extendOfSize(e){return wa.positiveOr0(this.maxX-this.minX+e*2),wa.positiveOr0(this.maxY-this.minY+e*2),new EA(this.minX-e,this.maxX+e,this.minY-e,this.maxY+e)}isInside(e){return this.minX>=e.minX&&this.maxX<=e.maxX&&this.minY>=e.minY&&this.maxY<=e.maxY}isContainsBBox(e){return this.maxX>=e.maxX&&this.minX<=e.minX&&this.maxY>=e.maxY&&this.minY<=e.minY}isContainsBBox1(e){return wt.greatereq(this.maxX,e.maxX)&&wt.lesseq(this.minX,e.minX)&&wt.greatereq(this.maxY,e.maxY)&&wt.lesseq(this.minY,e.minY)}intersect(e){let r=Math.max(this.minX,e.minX),i=Math.min(this.maxX,e.maxX);if(r>i)return null;let n=Math.max(this.minY,e.minY),s=Math.min(this.maxY,e.maxY);return n>s?null:new EA(r,i,n,s)}intersection1(e){let r=Math.max(this.minX,e.minX),i=Math.min(this.maxX,e.maxX);if(wt.greater(r,i))return null;r>i&&(i=r);let n=Math.max(this.minY,e.minY),s=Math.min(this.maxY,e.maxY);return wt.greater(n,s)?null:(n>s&&(s=n),new EA(r,i,n,s))}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}UL(){return new ne(this.minX,this.maxY)}UR(){return new ne(this.maxX,this.maxY)}LL(){return new ne(this.minX,this.minY)}LR(){return new ne(this.maxX,this.minY)}center(){return new ne(this.maxX-(this.maxX-this.minX)/2,this.maxY-(this.maxY-this.minY)/2)}area(){return this.width()*this.height()}transform(e){let r=new pr;return r.ext2(this.LL().multiply3(e)),r.ext2(this.LR().multiply3(e)),r.ext2(this.UR().multiply3(e)),r.ext2(this.UL().multiply3(e)),r.build()}transform4(e){let r=new pr;return r.ext2(this.LL().multiply4(e)),r.ext2(this.LR().multiply4(e)),r.ext2(this.UR().multiply4(e)),r.ext2(this.UL().multiply4(e)),r.build()}isSeparated(e){if(e==null||e==null)return!1;let r;this.minX>=e.minX?r=this.minX:r=e.minX;let i;if(this.maxX<=e.maxX?i=this.maxX:i=e.maxX,r>i)return!0;{let n;this.minY>=e.minY?n=this.minY:n=e.minY;let s;return this.maxY<=e.maxY?s=this.maxY:s=e.maxY,n>s}}relation(e){let r=0,i=0,n;this.minX>e.minX?(r++,n=this.minX):this.minX===e.minX?n=this.minX:(i++,n=e.minX);let s;if(this.maxX<e.maxX?(r++,s=this.maxX):this.maxX===e.maxX?s=this.maxX:(i++,s=e.maxX),n>s)return 2;{let a;this.minY>e.minY?(r++,a=this.minY):this.minY===e.minY?a=this.minY:(i++,a=e.minY);let o;return this.maxY<e.maxY?(r++,o=this.maxY):this.maxY===e.maxY?o=this.maxY:(i++,o=e.maxY),a>o?2:r===4?0:i===4?1:r===0&&i===0?4:n===s||a===o?6:r!==i?5:3}}zoom(e){let r=this.width(),i=this.height(),n=this.center();return e!=0&&(r/=e/2,i/=e/2),new EA(n.x-r,n.x+r,n.y-r,n.y+r)}toString(){return"BBox [minX="+this.minX+", maxX="+this.maxX+", minY="+this.minY+", maxY="+this.maxY+"]"}equals(e){return this.minY==e.minY&&this.minX==e.minX&&this.maxX==e.maxX&&this.maxY==e.maxY}extendSize(e,r){return Object.is(void 0,r)&&(r=e),EA.extend4(this.center(),this.width()+e,this.height()+r)}positionOnBBox(e,r=0){let i=this.center(),n=this.width()*r/2,s=this.height()*r/2,a=e.x-i.x,o=e.y-i.y;return a>n?o>s?Vm.RT:o<-s?Vm.RB:Vm.RC:a<-n?o>s?Vm.LT:o<-s?Vm.LB:Vm.LC:o>s?Vm.CT:o<-s?Vm.CB:Vm.CC}bbox(){return this}},MB=class Gn{static mul(e,r,i,n,s,a){let o=0,l=0;for(let c=0;c<e;c++){for(let u=0;u<i;u++){let d=u,A=0;for(let h=0;h<r;h++)A+=n[l+h]*s[d],d+=i;a[o++]=A}l+=r}}constructor(e,r,i){this.m=wa.normal(e),this.n=wa.normal(r);let n=e*r;if(i.length===n){for(let s=0;s<i.length;s++)wa.normal(i[s]);this.data=i}else throw new Error("invalid matrix size")}mul(e){if(this.n===e.m){let r=new Array(this.m*e.n);return Gn.mul(this.m,this.n,e.n,this.data,e.data,r),new Gn(this.m,e.n,r)}else throw new Error("m !== p")}toString(){let e=[];e.push("Matrix ("),e.push(this.m.toString()),e.push(" x "),e.push(this.n.toString()),e.push(")");let r=0;for(let i=0;i<this.m;i++)for(let n=0;n<this.n;n++){let s=this.data[r++].toString();n===0?(e.push(`
`),e.push("	"),e.push(s)):(e.push(", "),e.push(s))}return e.join("")}static on(e,r,i){return e*r+i}initExpandMatrix(e){let r=this.m,i=this.n,n=i*2,s=new Array(r*n);for(let a=0;a<r;a++)for(let o=0;o<n;o++)o<i?s[Gn.on(n,a,o)]=e[Gn.on(i,a,o)]:o===r+a?s[Gn.on(n,a,o)]=1:s[Gn.on(n,a,o)]=0;return s}inverseMatrix(e,r,i){for(let n=0;n<r;n++){let s=e[Gn.on(i,n,n)];for(let a=0;a<i;a++)e[Gn.on(i,n,a)]/=s}return e}getMatrixRank(e,r,i){let n=Math.min(r,i);for(let s=0;s<r;s++){if(e[Gn.on(i,s,s)]===0){let a=new Array(i),o;for(o=s;o<r;o++)if(e[Gn.on(i,o,s)]!==0){Zc.arraycopy(e,Gn.on(i,o,0),a,0,i),Zc.arraycopy(e,Gn.on(i,s,0),e,Gn.on(i,o,0),i),Zc.arraycopy(a,0,e,Gn.on(i,s,0),i);break}o>=r&&(n-=1)}if(!(n<r))for(let a=0;a<r;a++){if(a===s)continue;let o=e[Gn.on(i,a,s)]/e[Gn.on(i,s,s)];for(let l=0;l<i;l++)e[Gn.on(i,a,l)]-=e[Gn.on(i,s,l)]*o}}return n}getInverseMatrix(){if(this.m!==this.n)throw new Error("The matrix is an "+this.m+"x"+this.n+" order matrix, non-square matrix, please check!");function e(a){return wt.lesseq(Math.abs(a),0)}let r=this.initExpandMatrix(this.data.slice(0)),i=this.n*2;function n(a,o){for(let l=0;l<i;l++){let c=r[Gn.on(i,a,l)];r[Gn.on(i,a,l)]=r[Gn.on(i,o,l)],r[Gn.on(i,o,l)]=c}}for(let a=0;a<this.m;a++){let o=Math.abs(r[Gn.on(i,a,a)]),l=a;if(e(r[Gn.on(i,a,a)]))for(let u=a+1;u<this.m;u++){if(e(r[Gn.on(i,u,a)])){Math.abs(r[Gn.on(i,u,a)])>o&&(o=Math.abs(r[Gn.on(i,u,a)]),l=u);continue}n(a,u);break}if(e(r[Gn.on(i,a,a)])){if(o===0)throw new Error("The matrix is a non-full rank matrix, please check!");console.warn("The matrix may be a non-full rank matrix, please check!"),l!==a&&n(a,l)}let c=1/r[Gn.on(i,a,a)];for(let u=0;u<i;u++)r[Gn.on(i,a,u)]*=c;for(let u=0;u<this.m;u++){if(a===u)continue;let d=r[Gn.on(i,u,a)];for(let A=a;A<i;A++)r[Gn.on(i,u,A)]-=r[Gn.on(i,a,A)]*d}}let s=[];for(let a=0;a<this.m;a++)for(let o=this.n;o<i;o++)s[Gn.on(this.n,a,o-this.n)]=r[Gn.on(i,a,o)];return new Gn(this.m,this.n,s)}getTransposeMatrix(){let e=new Array(this.data.length);for(let r=0;r<this.m;r++)for(let i=0;i<this.n;i++)e[i*this.n+r]=this.data[r*this.m+i];return new Gn(this.n,this.m,e)}hashCode(){let e=0;for(let r of this.data)e+=r;return e}equals(e){return this===e?!0:e===null?!1:e instanceof Gn?!(this.m!=e.m||this.n!=e.n||!Zc.equals(this.data,e.data)):!1}},The=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],qs,dG=(qs=class extends MB{static translate(e,r,i){return new qs([1,0,0,0,0,1,0,0,0,0,1,0,e,r,i,1])}static translate1(e){return new qs([1,0,0,0,0,1,0,0,0,0,1,0,e.x,e.y,e.z,1])}static rotateX(e){let r=Math.cos(e),i=Math.sin(e);return new qs([1,0,0,0,0,r,i,0,0,-i,r,0,0,0,0,1])}static rotateY(e){let r=Math.cos(e),i=Math.sin(e);return new qs([r,0,-i,0,0,1,0,0,i,0,r,0,0,0,0,1])}static rotateZ(e){let r=Math.cos(e),i=Math.sin(e);return new qs([r,i,0,0,-i,r,0,0,0,0,1,0,0,0,0,1])}static rotateAxis(e,r){e=e.normalize();let i=e.x,n=e.y,s=e.z,a=Math.sin(r),o=Math.cos(r);return new qs([i*i*(1-o)+o,i*n*(1-o)+s*a,i*s*(1-o)-n*a,0,i*n*(1-o)-s*a,n*n*(1-o)+o,n*s*(1-o)+i*a,0,i*s*(1-o)+n*a,n*s*(1-o)-i*a,s*s*(1-o)+o,0,0,0,0,1])}static scale(e,r=e,i=e){return new qs([e,0,0,0,0,r,0,0,0,0,i,0,0,0,0,1])}static flipX(){return new qs([1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])}static flipY(){return new qs([-1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}static rotateZForPoint(e,r){return e.equals1(ne.ORIGIN)?qs.rotateZ(r):qs.translate(-e.x,-e.y,0).rotateZ(r).translate1(e.x,e.y,0)}static getMatrix4(e,r,i,n){let s=Math.cos(r),a=Math.sin(r),o=i*(e.x*s-e.y*a)+n.x,l=e.x*a+e.y*s+n.y,c=[i*s,a,0,0,-a*i,s,0,0,0,0,1,0,o,l,0,1];return new qs(c)}constructor(e=The){super(4,4,e)}translate(e){return this.multiply4(qs.translate1(e))}translate1(e,r,i){return this.multiply4(qs.translate(e,r,i))}rotateX(e){return this.multiply4(qs.rotateX(e))}rotateY(e){return this.multiply4(qs.rotateY(e))}rotateZ(e){return this.multiply4(qs.rotateZ(e))}scale(e,r=e,i=e){return this.multiply4(qs.scale(e,r,i))}scale1(e){return this.multiply4(qs.scale(e.x,e.y,e.z))}setOrigin(e,r,i){return qs.translate(-e,-r,-i).multiply4(this).translate1(e,r,i)}setOrigin1(e){return this.setOrigin(e.x,e.y,e.z)}multiply4(e){let r=new Array(16);return MB.mul(4,4,4,this.data,e.data,r),new qs(r)}getInverseMatrix(){let e=super.getInverseMatrix();return new qs(e.data)}getTransposeMatrix(){let e=super.getTransposeMatrix();return new qs(e.data)}inverse(){let e=this.getInverseMatrix();return new qs(e.data)}toMatrix3(){let e=this.data;return new Ue([e[0],e[1],0,e[4],e[5],0,e[12],e[13],1])}},qs.ORIGIN=new qs,qs);function gv(t){return uG.normal(parseFloat(t))}var Ihe=[1,0,0,0,1,0,0,0,1],Is,Ue=(Is=class extends MB{static translate(e,r){return new Is([1,0,0,0,1,0,e,r,1])}static translate1(e){return this.translate(e.x,e.y)}static rotate(e){let r=Math.cos(e),i=Math.sin(e);return new Is([r,i,0,-i,r,0,0,0,1])}static rotateD(e){return this.rotate(Ti.toRadians(e))}static scale(e,r=e){return new Is([e,0,0,0,r,0,0,0,1])}static scale1(e,r){return new Is([e,0,0,0,r,0,0,0,1])}static toDOMMatrix(e){let[r,i,,n,s,,a,o]=e.data;return`matrix(${[r,i,n,s,a,o].join(",")})`}static svgTrasform(e){let r=e.split(" "),i=null;return r.forEach(n=>{n=n.trim();let s=n.trim().replace(")","").split("("),a=s[0],o=s[1].split(",");switch(a){case"translate":let l=gv(o[0]),c=gv(o[1]);i=i?i.translate(l,c):Is.translate(l,c);break;case"rotate":let u=gv(o[0]),d=gv(o[1]),A=gv(o[2]);i=i?i.setOrigin(d,A):Is.translate(d,A),i=i.rotateD(u);break;default:return}}),i}constructor(e=Ihe){super(3,3,e);let r=e[0],i=e[3],n=e[1],s=e[4];this.iScale=Math.sqrt(r*r+n*n),this.jScale=Math.sqrt(i*i+s*s)}isMirrored(){return this.det()<0}multiply3(e){let r=new Array(9);return MB.mul(3,3,3,this.data,e.data,r),new Is(r)}translate(e,r){return this.multiply3(Is.translate(e,r))}translate1(e){return this.multiply3(Is.translate1(e))}scale(e,r=e){return this.multiply3(Is.scale(e,r))}scale1(e,r){return this.multiply3(Is.scale1(e,r))}det(){return this.data[0]*this.data[4]-this.data[3]*this.data[1]}invert(){let e=this.getInverseMatrix();return new Is(e.data)}rotateD(e){return this.multiply3(Is.rotateD(e))}rotate(e){return this.multiply3(Is.rotate(e))}resetOffset(){let e=this.data;return new Is([e[0],e[1],0,e[3],e[4],0,0,0,1])}setOrigin(e,r){return Is.translate(-e,-r).multiply3(this).translate(e,r)}setOrigin1(e){return this.setOrigin(e.x,e.y)}getInverseMatrix(){return new Is(super.getInverseMatrix().data)}getTransposeMatrix(){let e=super.getTransposeMatrix();return new Is(e.data)}toMatrix4(){let e=this.data;return new dG([e[0],e[1],0,e[2],e[3],e[4],0,e[5],0,0,1,0,e[6],e[7],0,e[8]])}scaleNum(e){return!e||isNaN(e)?e:e*this.iScale}},Is.ORIGIN=new Is,Is.MIRROR_Y=new Is([1,0,0,0,-1,0,0,0,1]),Is.MIRROR_X=new Is([-1,0,0,0,1,0,0,0,1]),Is.ROT_90=new Is([0,1,0,-1,0,0,0,0,1]),Is.ROT_N90=new Is([0,-1,0,1,0,0,0,0,1]),Is),g1=(t=>(t[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE",t))(g1||{}),kl=(t=>(t[t.CW=0]="CW",t[t.CCW=1]="CCW",t))(kl||{}),Nv=class{},jx=class wv{constructor(e,r,i){this.p1=e,this.p2=r,this.p3=i}barycentre(){return wv.barycentre(this.p1,this.p2,this.p3)}incentre(){return wv.incentre(this.p1,this.p2,this.p3)}static barycentre(e,r,i){let n=e.x+r.x+i.x,s=e.y+r.y+i.y;return new ne(n/3,s/3)}static incentre(e,r,i){let n=r.sub(i).length(),s=e.sub(i).length(),a=e.sub(r).length(),o=n+s+a,l=n*e.x+s*r.x+a*i.x,c=n*e.y+s*r.y+a*i.y;return new ne(l/o,c/o)}area(){return wv.area(this.p1,this.p2,this.p3)}static area(e,r,i){return this.area2(e.x,e.y,r.x,r.y,i.x,i.y)/2}static area2(e,r,i,n,s,a){return Math.abs(no.crossProd2(e,r,i,n,s,a))}scale(e,r){let i=Ue.translate(-e.x,-e.y).scale(r).translate1(e),n=this.p1.multiply3(i),s=this.p2.multiply3(i),a=this.p3.multiply3(i);return new wv(n,s,a)}scaleOnBarycentre(e){return this.scale(this.barycentre(),e)}scaleOnIncentre(e){return this.scale(this.incentre(),e)}extend(e){let r=this.incentre(),i=this.p1.add(this.p2).sub(r).scale(1/2),n=i.length(),s=ne.ORIGIN.pointOnRays2(i,n+e).length()/n;return this.scaleOnIncentre(s)}container(e){let r=this.p3.sub(this.p1),i=this.p2.sub(this.p1),n=e.sub(this.p1),s=r.dot(r),a=r.dot(i),o=r.dot(n),l=i.dot(i),c=i.dot(n),u=1/(s*l-a*a),d=(l*o-a*c)*u;if(d<0||d>1)return!1;let A=(s*c-a*o)*u;return A<0||A>1?!1:d+A<=1}};function bB(){return{minDistance:Number.POSITIVE_INFINITY,start:null,end:null}}var Df=class v0{static getMinDistanceWithoutCross(e,r){let i=bB();return v0.minLine(e,r,i),i.minDistance}static getMinDistance(e,r){return wA(e,r)?0:this.getMinDistanceWithoutCross(e,r)}static getMinLineWithCross(e,r){let i=bB();return v0.minLine(e,r,i),new Ee(i.start,i.end)}static getMinLine(e,r){return v0.intersection(e,r)||this.getMinLineWithCross(e,r)}static getMinDistanceFromPoint(e,r){let i=bB();if(r instanceof Ee)this.point2LineMinLine(i,r,e);else if(r instanceof ze)this.point2ArcMinDistance(e,r,i);else throw new Error("not support");return i.minDistance}constructor(e,r){if(this.pt1=e,this.pt2=r,this.minline=v0.intersection(e,r),this.minline)this.minDistance=0;else{let i=bB();v0.minLine(e,r,i),this.minline=new Ee(i.start,i.end),this.minDistance=i.minDistance}}getDistance(){return this.minDistance}getLine(){return this.minline}static intersection(e,r){let i=wA(e,r);if(i===0)return;let n=new Array;for(let s=0;s<i;s+=2){let a=new ne(Be[s],Be[s+1]);n.push(a)}return n.length>1?new Ee(n[0],n[1]):new Ee(n[0],n[0])}static minLine(e,r,i){if(e instanceof Ee&&r instanceof Ee)return this.minDistanceForLines(e,r,i);if(e instanceof ze&&r instanceof Ee)return this.minDistanceForLineAndArc(e,r,i);if(e instanceof Ee&&r instanceof ze)return this.minDistanceForLineAndArc(r,e,i);if(e instanceof ze&&r instanceof ze)return this.minDistanceForArcs(e,r,i);throw new Error("not support")}static minDistanceForLines(e,r,i){[e.start(),e.end(),r.start(),r.end()].forEach((n,s)=>{s<2?this.point2LineMinLine(i,r,n):this.point2LineMinLine(i,e,n)})}static minDistanceForLineAndArc(e,r,i){this.point2LineMinLine(i,r,e.start()),this.point2LineMinLine(i,r,e.svgEnd);let n=v0.foot(r,e.center);r.bbox().extendOfSize(1e-8).isContains(n)&&this.point2ArcMinLine(i,e,n),this.point2ArcMinLine(i,e,r.start()),this.point2ArcMinLine(i,e,r.end())}static minDistanceForArcs(e,r,i){this.concentricArc(e,r,i),this.point2ArcMinDistance(r.start(),e,i),this.point2ArcMinDistance(r.svgEnd,e,i),this.point2ArcMinDistance(e.start(),r,i),this.point2ArcMinDistance(e.svgEnd,r,i),(Tf(e,r.center)||Tf(r,e.center))&&this.shortestLineForArcs(e,r,i)}static minLineForArcAndLine(e,r,i){let n=e.pointOn(i.angleD(e.center)),s=e.pointOn(e.center.angleD(i));this.arcShortestLine(e,r,i,n),this.arcShortestLine(e,r,i,s)}static arcInnerLineFootSegment(e,r,i){let n=i.distance1(e.center);if(n!==0){let s=e.rx*(i.y-e.center.y)/n+e.center.y,a=e.rx*(i.x-e.center.x)/n+e.center.x;n=e.rx-n,n<r.minDistance&&(r.minDistance=n,r.start=new ne(a,s),r.end=i)}else n=e.rx-n,n<r.minDistance&&(r.minDistance=n,r.start=e.start(),r.end=i)}static shortestLineForArcs(e,r,i){let n=e.center.angleD(r.center),s=r.center.angleD(e.center),a=e.pointOn(n),o=e.pointOn(s),l=r.pointOn(n),c=r.pointOn(s);Tf(e,a)&&(this.arcShortestLine(r,i,a,l),this.arcShortestLine(r,i,a,c)),Tf(e,o)&&(this.arcShortestLine(r,i,o,l),this.arcShortestLine(r,i,o,c)),this.shortestLineForArcs1(e,r,i)}static shortestLineForArcs1(e,r,i){let n=r.start().sub(e.center).normalize(),s=r.end().sub(e.center).normalize(),a=e.start().sub(r.center).normalize(),o=e.end().sub(r.center).normalize(),l=e.center.add(n.mul(e.rx)),c=e.center.add(s.mul(e.rx)),u=r.center.add(a.mul(r.rx)),d=r.center.add(o.mul(r.rx));Tf(e,l)&&wt.greater(r.start().distance2(e.center),0)&&this.arcShortestLine(e,i,r.start(),l),Tf(e,c)&&wt.greater(r.end().distance2(e.center),0)&&this.arcShortestLine(e,i,r.end(),c),Tf(r,u)&&wt.greater(e.start().distance2(r.center),0)&&this.arcShortestLine(r,i,e.start(),u),Tf(r,d)&&wt.greater(e.end().distance2(r.center),0)&&this.arcShortestLine(r,i,e.end(),d)}static concentricArc(e,r,i){if(!(e.center.distance1(r.center)<1e-5&&e.rx===r.rx&&e.ry===r.ry))return;let n=e.start().distance1(r.svgEnd);n<i.minDistance&&(i.minDistance=n,i.start=e.start(),i.end=r.svgEnd),n=r.start().distance1(e.svgEnd),n<i.minDistance&&(i.minDistance=n,i.start=r.start(),i.end=e.svgEnd)}static point2ArcMinDistance(e,r,i){if(Tf(r,e)){let n=r.pointOn(e.angleD(r.center)),s=r.pointOn(r.center.angleD(e));this.arcShortestLine(r,i,e,n),this.arcShortestLine(r,i,e,s)}else this.minLineSegment(i,r.start(),e),this.minLineSegment(i,r.svgEnd,e)}static point2ArcMinLine(e,r,i){if(Tf(r,i)){let n=i.distance1(r.center);n>r.rx||n>r.ry?this.minLineForArcAndLine(r,e,i):this.arcInnerLineFootSegment(r,e,i)}}static point2LineMinLine(e,r,i){let n=v0.foot(r,i);r.bbox().extendOfSize(1e-8).isContains(n)?this.minLineSegment(e,n,i):(this.minLineSegment(e,r.start(),i),this.minLineSegment(e,r.end(),i))}static minLineSegment(e,r,i){let n=r.distance1(i);n<e.minDistance&&(e.minDistance=n,e.start=r,e.end=i)}static arcShortestLine(e,r,i,n){if(!Tf(e,n))return;let s=i.distance1(n);s<r.minDistance&&(r.minDistance=s,r.start=i,r.end=n)}static foot(e,r){if(e.isPoint())return e.start();if(!wt.eq(e.b,0)&&!wt.eq(e.a,0)){let i=e.start(),n=e.direct,s=(r.x-i.x)*n.x+(r.y-i.y)*n.y;return new ne(i.x+n.x*s,i.y+n.y*s)}else return wt.eq(e.b,0)&&!wt.eq(e.a,0)?new ne(e.start().x,r.y):!wt.eq(e.b,0)&&wt.eq(e.a,0)?new ne(r.x,e.start().y):r}};function Tf(t,e){if(wt.eq(t.sweepAngle,360))return!0;let r=Ti.regularD(e.angleD(t.center));return t.sweepAngle>0?(wt.less(r,t.startAngle)&&(r+=360),wt.greatereq(t.endAngle(),r)):(wt.greater(r,t.startAngle)&&(r-=360),wt.lesseq(t.endAngle(),r))}var Bhe=[1,10,100,1e3],kH="http://www.w3.org/2000/svg",FH="http://www.w3.org/1999/xlink",UH="http://www.w3.org/XML/1998/namespace",HH="https://easyeda.com/",eke=(function(){var t={svg:kH,xlink:FH,xml:UH,c:HH};return t[kH]="svg",t[FH]="xlink",t[UH]="xml",t[HH]="c",t})();var _o=(function(){var t={RATLINES:9,MODEL3D:19,ALL:11,TOPSILKLAYER:3,TOPLAYER:1,TOPPASTERLAYER:5,TOPSOLDERLAYER:7,LIBBODY:99,PADSURFACE:100,BOARDOUTLINE:10,DOCUMENT:12,TOPASSEMBLY:13,MECHANICAL:15,TOPCOMPONENT:16,SUBSTRATE:18},e;for(e=21;e<53;e++)t["INNER"+(e-20)]=e;for(t.BOTTOMSILKLAYER=4,t.BOTTOMLAYER=2,t.BOTTOMPASTERLAYER=6,t.BOTTOMSOLDERLAYER=8,t.BOTTOMASSEMBLY=14,t.BOTTOMCOMPONENT=17,e=53;e<85;e++)t["BOARD"+(e-52)]=e;return t})(),tke=(function(){var t={COPPERAREA:[1,2,21,22,23,24],PLANEZONE:[1,2,21,22,23,24],RECT:[1,2,3,4,5,6,7,8,12,13,14,15,21,22,23,24,99],TRACK:[1,2,3,4,5,6,7,8,10,12,13,14,15,21,22,23,24,99],PAD:[11,1,2],VIA:[11],HOLE:[11],TEXT:[3,4,1,2,7,8,12,13,14,15,21,22,23,24],ARC:[1,2,3,4,5,6,7,8,10,12,13,14,15,21,22,23,24,99],ELLIPSE:[3,4,12,13,14,15],CIRCLE:[1,2,3,4,5,6,7,8,10,12,13,14,15,21,22,23,24,99],DIMENSION:[3,4,12,13,14,15],FOOTPRINT:[1,2],SOLIDREGION:[1,2,3,4,5,6,7,8,12,13,14,15,21,22,23,24,11,99,100],SVGNODE:[1,2,3,4,7,8,12,13,14,15],PROTRACTOR:[3,4,12,13,14,15],SHEET:[12,13,14,15]};t["3D"]=(function(){for(var n=[16,19,3,7,5,1],s=21;s<52;s++)n.push(s+32,s);return n.push(2,6,8,4,17),n})();var e,r,i;for(e in t)if(t.hasOwnProperty(e)&&(i=t[e],i.indexOf(21)>0&&i.indexOf(25)===-1))for(r=25;r<=52;r++)i.push(r);return t})(),ac=(function(){var t={1:"TopLayer",2:"BottomLayer",3:"TopSilkLayer",4:"BottomSilkLayer",5:"TopPasteMaskLayer",6:"BottomPasteMaskLayer",7:"TopSolderMaskLayer",8:"BottomSolderMaskLayer",9:"Ratlines",10:"BoardOutLine",11:"Multi-Layer",12:"Document",13:"TopAssembly",14:"BottomAssembly",15:"Mechanical",16:"TopComponents",17:"BottomComponents",18:"Substrate",19:"3DModel",99:"ComponentShapeLayer",100:"LeadShapeLayer"},e;for(e=21;e<53;e++)t[e]="Inner"+(e-20);for(e=53;e<85;e++)t[e]="Substrate"+(e-52);return t})(),rke=(function(){var t=[],e=[];for(var r in _o)if(_o.hasOwnProperty(r)){if(r.match(/^BOARD\d+/))continue;t.push(_o[r])}t.sort(),e.sort();var i={},n,s={21:"#999966",22:"#008000",23:"#00FF00",24:"#BC8E00",25:"#70DBFA",26:"#00CC66",27:"#9966FF",28:"#800080",29:"#008080",30:"#15935F",31:"#000080",32:"#00B400",33:"#2E4756",34:"#99842F",35:"#FFFFAA",36:"#99842F",37:"#2E4756",38:"#3535FF",39:"#8000BC",40:"#43AE5F",41:"#C3ECCE",42:"#728978",43:"#39503F",44:"#0C715D",45:"#5A8A80",46:"#2B937E",47:"#23999D",48:"#45B4E3",49:"#215DA1",50:"#4564D7",51:"#6969E9",52:"#9069E9"};t.forEach(function(o){switch(o){case _o.TOPLAYER:n={name:ac[o],color:"#FF0000",darkColor:"#CC0000",visible:!0,active:!0,config:!0};break;case _o.BOTTOMLAYER:n={name:ac[o],color:"#0000FF",darkColor:"#000080",visible:!0,active:!1,config:!0};break;case _o.TOPSILKLAYER:n={name:ac[o],color:"#FFCC00",darkColor:"#806600",visible:!0,active:!1,config:!0};break;case _o.BOTTOMSILKLAYER:n={name:ac[o],color:"#66CC33",darkColor:"#33661A",visible:!0,active:!1,config:!0};break;case _o.TOPPASTERLAYER:n={name:ac[o],color:"#808080",darkColor:"#666666",visible:!0,active:!1,config:!0};break;case _o.BOTTOMPASTERLAYER:n={name:ac[o],color:"#800000",darkColor:"#660000",visible:!0,active:!1,config:!0};break;case _o.TOPSOLDERLAYER:n={name:ac[o],color:"#800080",darkColor:"#660066",visible:!0,active:!1,transparency:.3,config:!0};break;case _o.BOTTOMSOLDERLAYER:n={name:ac[o],color:"#AA00FF",darkColor:"#8800CC",visible:!0,active:!1,transparency:.3,config:!0};break;case _o.RATLINES:n={name:ac[o],color:"#6464FF",darkColor:"#5050CC",visible:!1,active:!1,config:!0};break;case _o.BOARDOUTLINE:n={name:ac[o],color:"#FF00FF",darkColor:"#CC00CC",visible:!0,active:!1,config:!0};break;case _o.ALL:n={name:ac[o],color:"#C0C0C0",darkColor:"#999999",visible:!0,active:!1,config:!0};break;case _o.DOCUMENT:n={name:ac[o],color:"#FFFFFF",darkColor:"#CCCCCC",visible:!0,active:!1,config:!0};break;case _o.TOPASSEMBLY:n={name:ac[o],color:"#33CC99",darkColor:"#33AA99",visible:!1,active:!1,config:!1};break;case _o.BOTTOMASSEMBLY:n={name:ac[o],color:"#5555FF",darkColor:"#8888FF",visible:!1,active:!1,config:!1};break;case _o.MECHANICAL:n={name:ac[o],color:"#F022F0",darkColor:"#F088F0",visible:!1,active:!1,config:!1};break;case _o.MODEL3D:n={name:ac[o],color:"#66CCFF",visible:!1,active:!1,config:!1};break;case _o.LIBBODY:n={name:ac[o],color:"#00CCCC",visible:!1,active:!1,config:!1};break;case _o.PADSURFACE:n={name:ac[o],color:"#CC9999",visible:!1,active:!1,config:!1};break;default:o>=_o.INNER1&&o<=_o.INNER32?n={name:ac[o],color:s[o],darkColor:a(s[o]),visible:!1,active:!1,config:!1}:n=null;break}n&&(i[o]=n)}),i.Hole={config:!0,name:"Hole",darkColor:"#222222",color:"#222222"},i.DRCError={config:!0,name:"DRCError",color:"#FAD609",darkColor:"#FAD609"};function a(o){if(typeof o!="string"||!o.match(/#?([\da-f]{6})/i))return o;var l=parseInt(RegExp.$1,16),c=.5,u=Math.min(255,Math.round((l>>16)*c)),d=Math.min(255,Math.round((l>>8&255)*c)),A=Math.min(255,Math.round((l&255)*c)),h=((u<<16)+(d<<8)+A).toString(16);return"#"+("00000"+h).substr(-6).toUpperCase()}return i})(),GH={BLANK:0,SCH:1,PART:2,PCB:3,FOOTPRINT:4,PRJ:5,SUBPART:6,SPICESYMBOL:7,SUBCKT:8,NETLIST:9,WAVEFORM:10,SCHLIB3D:11,PHOTOVIEW:12,SCHMODULE:13,PCBMODULE:14,VIEW3D:15,PCBLIB3D:16,BLOCK_SYMBOL:17,NETFLAG:18,NETPORT:19,SHEET_SYMBOL:20,NONEELEC_SYMBOL:21,SHORT_SYMBOL:22,FOOTPRINTVIEW:23,CNCPRINTVIEW:24,PCB2D:31,PCB3D:32},ike=(function(){var t={};for(let e in GH)t[GH[e]]=e;return t})();var zB=Math.PI*2,kB=Math.PI/2,nke=Math.sin(Math.PI/180);function Dhe(t,e,r){if(typeof t!="number"&&(t=+t),isNaN(t))return NaN;if(e=e|0,e<=0||!t&&!r)return Math.round(t);var i=Bhe[e]||Math.pow(10,e)||10;if(r){var n=t<0?"-":"";for(t=t<0?-t:t,t=Math.round(t*i)+"";t.length<=e;)t="0"+t;return t=t.slice(0,-e)+"."+t.slice(-e),parseFloat(n+t)}else return Math.round(t*i+1e-10)/i}function AG(t,e,r){var i=t-e;return r||(r=1e-10),(i>0?i:-i)<r}function _he(t,e,r){var i=u(t)&&u(e)&&u(r);if(!i)return console.warn("Bad arguments"),null;var n=e.x-r.x>0?e.x:r.x,s=e.y-r.y>0?e.y:r.y,a=e.x-r.x>0?r.x:e.x,o=e.y-r.y>0?r.y:e.y,l=t.x,c=t.y;return l<=n+.001&&l>=a-.001&&c<=s+.001&&c>=o-.001;function u(d){return d?(d.x=Number(d.x),d.y=Number(d.y),isNaN(d.x)||isNaN(d.y)?(console.warn("Can not convert to Number, NaN found"),!1):!0):(console.warn("Empty input!"),!1)}}function Phe(t,e,r,i,n,s){var a=(n-r)*(t-r)+(s-i)*(e-i),o=(n-r)*(n-r)+(s-i)*(s-i),l=a/o,c=r+(n-r)*l,u=i+(s-i)*l;return a<=0?Math.sqrt((t-r)*(t-r)+(e-i)*(e-i)):a>=o?Math.sqrt((t-n)*(t-n)+(e-s)*(e-s)):Math.sqrt((t-c)*(t-c)+(u-e)*(u-e))}function Lhe(t,e,r){return _he(t,e,r)?AG((t.x-e.x)*(r.y-e.y),(r.x-e.x)*(t.y-e.y),.001):!1}var vv=1e-4,Be=new Float64Array(100);function wA(t,e){if(t instanceof Ee&&e instanceof Ee)return Hp(t,e);if(t instanceof ze&&e instanceof Ee)return LR(t,e);if(t instanceof Ee&&e instanceof ze)return LR(e,t);if(t instanceof ze&&e instanceof ze)return pG(t,e);if(t instanceof Nt&&e instanceof Nt)return DB(t,e);if(t instanceof Nt&&e instanceof Ee)return DB(t,new Nt([e.start(),e.end()]));if(t instanceof Ee&&e instanceof Nt)return DB(new Nt([t.start(),t.end()]),e);if(t instanceof Nt&&e instanceof ze)return qH(e,t);if(t instanceof ze&&e instanceof Nt)return qH(t,e);throw new Error("not supported operation")}function Ohe(t,e){let r=t.bbox();if(r.isContainsY1(e)){let i=new Ee(new ne(r.minX-1,e),new ne(r.maxX+1,e));return Hp(i,t)>0?1:0}else return 0}function Nhe(t,e){if(t.rx===t.ry){let r=t.bbox();if(r.isContainsY1(e)){let i=new Ee(new ne(r.minX-1,e),new ne(r.maxX+1,e));return FB(t,i)>0?1:0}else return 0}else throw new Error("not supported operation")}function YH(t,e){let r=t.bbox();return r.isContainsY1(e)&&DB(new Nt([new ne(r.minX-1,e),new ne(r.maxX+1,e)]),t)>0?1:0}function VH(t,e,r){return isFinite(e)&&isFinite(r)?t.isContains2(e,r):!1}function Rhe(t,e){let r=e.length(),i=no.crossProd3(e.start(),e.end(),t.start())/r,n=no.crossProd3(e.start(),e.end(),t.end())/r;return Math.abs(i)<1e-8||Math.abs(n)<1e-8||i*n<0}function Hp(t,e){let r=t.bbox().intersection1(e.bbox());if(!r)return 0;if(t.isPoint())if(e.isPoint()){let i=r.center();return Be[0]=i.x,Be[1]=i.y,2}else return jH(e,t,r);else{if(e.isPoint())return jH(t,e,r);{let i=function(b,E){r.isContains2(b,E)&&(Be[g++]=b,Be[g++]=E)};if(!Rhe(t,e))return 0;let n=t.start().x,s=t.start().y,a=t.end().x,o=t.end().y,l=e.start().x,c=e.start().y,u=e.end().x,d=e.end().y,A=e.length(),h=no.crossProd2(n,s,l,c,u,d)/A,f=no.crossProd2(a,o,l,c,u,d)/A;if(h*f>0&&!wt.eq(h,0)&&!wt.eq(f,0))return 0;let p=t.length(),m=no.crossProd2(l,c,n,s,a,o)/p,y=no.crossProd2(u,d,n,s,a,o)/p;if(m*y>0&&!wt.eq(m,0)&&!wt.eq(y,0))return 0;let g=0;if(wt.eq(h,0)&&wt.eq(f,0)){let b=r.UL(),E=r.UR(),w=r.LL(),x=r.LR();if(wt.eq(r.width(),0))wt.eq(r.height(),0)?(Be[g++]=b.x,Be[g++]=b.y):(Be[g++]=b.x,Be[g++]=b.y,Be[g++]=w.x,Be[g++]=w.y);else if(wt.eq(r.height(),0))Be[g++]=b.x,Be[g++]=b.y,Be[g++]=E.x,Be[g++]=E.y;else{let I=jx.area2(b.x,b.y,l,c,u,d),C=jx.area2(E.x,E.y,l,c,u,d);I<C?(Be[g++]=b.x,Be[g++]=b.y,Be[g++]=x.x,Be[g++]=x.y):(Be[g++]=E.x,Be[g++]=E.y,Be[g++]=w.x,Be[g++]=w.y)}}else if(wt.eq(h,0))i(n,s);else if(wt.eq(f,0))i(a,o);else{let b=Math.abs(h/(h-f));i(n+(a-n)*b,s+(o-s)*b)}return g}}}function jH(t,e,r){let i=e.start(),n=e.end(),s=no.crossProd3(t.start(),t.end(),e.start()),a=no.crossProd3(t.start(),t.end(),e.end());if(s*a<0){let o=r.center();return Be[0]=o.x,Be[1]=o.y,2}else if(Math.abs(s)<Math.abs(a)){if(wt.eq(s/t.length(),0))return Be[0]=i.x,Be[1]=i.y,2}else if(wt.eq(a/t.length(),0))return Be[0]=n.x,Be[1]=n.y,2;return 0}function FB(t,e){let r=t.bbox().intersection1(e.bbox());if(r!=null){r=r.extendOfSize(vv);let i=t.center.x,n=t.center.y,s=t.rx,a=t.rx2,o=e.start().x,l=e.start().y,c=e.end().x,u=e.end().y,d=t.center.distance1(e.start()),A=t.center.distance1(e.end()),h=wt.eq(d,s)?0:d>s?1:-1,f=wt.eq(A,s)?0:A>s?1:-1,p=0;if(h===-1&&f===-1)return 0;if(h===0&&f===0)Be[p++]=o,Be[p++]=l,Be[p++]=c,Be[p++]=u;else if(h===1&&f===1){let m=Df.foot(e,t.center),y=m.distance1(t.center);if(wt.greater(y,s))return 0;if(wt.eq(y,s))wt.eq(e.distance2(t.start()),0)?(Be[p++]=t.start().x,Be[p++]=t.start().y,Be[p++]=t.start().x,Be[p++]=t.start().y):wt.eq(e.distance2(t.end()),0)?(Be[p++]=t.end().x,Be[p++]=t.end().y,Be[p++]=t.end().x,Be[p++]=t.end().y):(Be[p++]=m.x,Be[p++]=m.y,Be[p++]=m.x,Be[p++]=m.y);else{p=fG(i,n,o,l,c,u,p,m);let g=Be[p-2],b=Be[p-1];p-=2;let E=no.distance1(i,n,g,b);if(wt.eq(E,s))Be[p++]=g,Be[p++]=b,Be[p++]=g,Be[p++]=b;else if(E<s)p=vc(a,i,n,o,l,g,b,p),p=vc(a,i,n,g,b,c,u,p);else return 0}}else if(h===-1||f===-1)p=vc(a,i,n,o,l,c,u,p);else{let m=Df.foot(e,t.center),y=m.distance1(t.center);if(wt.eq(y,s)){let g=function(w){return VH(r,w.x,w.y)&&xo(t,w)},b=t.start(),E=t.end();if(h===0){let w=e.start();if(g(w))return Be[p++]=w.x,Be[p++]=w.y,Be[p++]=w.x,Be[p++]=w.y,p;if(g(m))return Be[p++]=m.x,Be[p++]=m.y,Be[p++]=m.x,Be[p++]=m.y,p;if(wt.eq(e.distance2(b),0)&&g(b))return Be[p++]=b.x,Be[p++]=b.y,Be[p++]=b.x,Be[p++]=b.y,p;if(wt.eq(e.distance2(E),0)&&g(E))return Be[p++]=E.x,Be[p++]=E.y,Be[p++]=E.x,Be[p++]=E.y,p;if(d<=s)p=vc(a,i,n,m.x,m.y,c,u,p),p===2&&(Be[p++]=Be[0],Be[p++]=Be[1]);else if(y<s){if(p=vc(a,i,n,m.x,m.y,c,u,p),p===2&&g(new ne(Be[0],Be[1])))return Be[p++]=Be[0],Be[p++]=Be[1],p;p=vc(a,i,n,m.x,m.y,o,l,0),p===2&&(Be[p++]=Be[0],Be[p++]=Be[1])}}else{let w=e.end();if(g(w))return Be[p++]=w.x,Be[p++]=w.y,Be[p++]=w.x,Be[p++]=w.y,p;if(g(m))return Be[p++]=m.x,Be[p++]=m.y,Be[p++]=m.x,Be[p++]=m.y,p;if(wt.eq(e.distance2(b),0)&&g(b))return Be[p++]=b.x,Be[p++]=b.y,Be[p++]=b.x,Be[p++]=b.y,p;if(wt.eq(e.distance2(E),0)&&g(E))return Be[p++]=E.x,Be[p++]=E.y,Be[p++]=E.x,Be[p++]=E.y,p;if(A<=s)p=vc(a,i,n,m.x,m.y,o,l,p),p===2&&(Be[p++]=Be[0],Be[p++]=Be[1]);else if(y<s){if(p=vc(a,i,n,m.x,m.y,o,l,p),p===2&&g(new ne(Be[0],Be[1])))return Be[p++]=Be[0],Be[p++]=Be[1],p;p=vc(a,i,n,m.x,m.y,c,u,0),p===2&&(Be[p++]=Be[0],Be[p++]=Be[1])}}}else if(h===0){let g=e.start();Be[p++]=g.x,Be[p++]=g.y,(o-m.x)*(c-m.x)+(l-m.y)*(u-m.y)<0&&(p=vc(a,i,n,m.x,m.y,c,u,p))}else{let g=e.end();Be[p++]=g.x,Be[p++]=g.y,(o-m.x)*(c-m.x)+(l-m.y)*(u-m.y)<0&&(p=vc(a,i,n,m.x,m.y,o,l,p))}}if(p>0){let m=0;for(let y=0;y<p;y+=2){let g=Be[y],b=Be[y+1];isFinite(g)&&isFinite(b)&&VH(r,g,b)&&xo(t,new ne(g,b))&&(Be[m++]=g,Be[m++]=b)}return m}else return 0}else return 0}function Mhe(t,e){if(t.bbox()){let r=t.center.x,i=t.center.y,n=t.rx2,s=e.start().x,a=e.start().y,o=e.end().x,l=e.end().y,c=t.center.distance2(e.start()),u=t.center.distance2(e.end()),d=wt.eq(c,n)?0:c>n?1:-1,A=wt.eq(u,n)?0:u>n?1:-1,h=0;if(d===-1&&A===-1)return 0;if(d===0&&A===0)Be[h++]=s,Be[h++]=a,Be[h++]=o,Be[h++]=l;else if(d===1&&A===1){let f=Df.foot(e,t.center),p=f.distance2(t.center);if(wt.greater(p,n))return 0;if(wt.eq(p,n)){let m=f.distance2(t.start()),y=f.distance2(t.end());wt.eq(m,0)?(Be[h++]=t.start().x,Be[h++]=t.start().y):wt.eq(y,0)?(Be[h++]=t.end().x,Be[h++]=t.end().y):(Be[h++]=f.x,Be[h++]=f.y)}else{h=fG(r,i,s,a,o,l,h,f);let m=Be[h-2],y=Be[h-1],g=no.distance2(r,i,m,y);if(h-=2,wt.eq(g,n))Be[h++]=m,Be[h++]=y;else if(g<n)h=vc(n,r,i,s,a,m,y,h),h=vc(n,r,i,m,y,o,l,h);else return 0}}else if(d===-1||A===-1)h=vc(n,r,i,s,a,o,l,h);else{let f=Df.foot(e,t.center);d===0?(Be[h++]=e.start().x,Be[h++]=e.start().y,wt.neq(f.distance2(e.start()),0)&&(s-f.x)*(o-f.x)+(a-f.y)*(l-f.y)<0&&(h=vc(n,r,i,f.x,f.y,o,l,h))):(Be[h++]=e.end().x,Be[h++]=e.end().y,wt.neq(f.distance2(e.end()),0)&&(s-f.x)*(o-f.x)+(a-f.y)*(l-f.y)<0&&(h=vc(n,r,i,f.x,f.y,s,a,h)))}if(h>0){let f=0;for(let p=0;p<h;p+=2){let m=Be[p],y=Be[p+1];isFinite(m)&&isFinite(y)&&(Be[f++]=m,Be[f++]=y)}return f}else return 0}else return 0}function vc(t,e,r,i,n,s,a,o){if(n==a){let b=t-(n-r)*(n-r);if(wt.greater(b,0)){let E=Math.sqrt(b),w=e-E,x=e+E,I=Math.min(i,s),C=Math.max(i,s);return w>=I&&w<=C&&(Be[o++]=w,Be[o++]=n),x>=I&&x<=C&&(Be[o++]=x,Be[o++]=n),o}}let l=no.distance2(i,n,e,r)-t;if(l===0)return Be[o++]=i,Be[o++]=n,o;let c=no.distance2(s,a,e,r)-t;if(c===0)return Be[o++]=s,Be[o++]=a,o;let u=i,d=n,A=s,h=a,f=NaN,p=NaN,m=Number.POSITIVE_INFINITY,y=0;for(;m!==0;){y++;let b=Math.max(Math.min(Math.abs(l)/(Math.abs(l)+Math.abs(c)),.75),.25);if(f=u+(A-u)*b,p=d+(h-d)*b,u===f&&d===p||A===f&&h===p){Math.abs(l)>Math.abs(c)?(f=A,p=h,m=c):(f=u,p=d,m=l);break}else m=no.distance2(f,p,e,r)-t,m<0&&l>c||m>0&&l<c?(A=f,h=p,c=m):(u=f,d=p,l=m)}let g=Math.sqrt(t)-no.distance1(f,p,e,r);return(wt.eq(0,m)||wt.eq(0,g))&&(Be[o++]=f,Be[o++]=p),o}function fG(t,e,r,i,n,s,a,o){let l=no.dotProd2(r,i,n,s,t,e),c=no.dotProd2(n,s,r,i,t,e);if(l>=0)return Be[a++]=n,Be[a++]=s,a;if(c>=0)return Be[a++]=r,Be[a++]=i,a;if(no.crossProd2(r,i,n,s,t,e)==0)return Be[a++]=t,Be[a++]=e,a;{let u=NaN,d=NaN,A=r,h=i,f=n,p=s,m=no.distance2(r,i,t,e),y=no.distance2(n,s,t,e),g=Number.POSITIVE_INFINITY,b=0;for(;g>0&&(b++,u=A+(f-A)*.5,d=h+(p-h)*.5,!(m==y||A==u&&h==d||f==u&&p==d));){g=no.distance2(u,d,t,e);let E=no.dotProd2(A,h,u,d,t,e);if(E==0)break;E<0?(f=u,p=d,y=g):(A=u,h=d,m=g)}return no.distance2(u,d,t,e)<no.distance2(o.x,o.y,t,e)?(Be[a++]=u,Be[a++]=d):(Be[a++]=o.x,Be[a++]=o.y),a}}function LR(t,e){if(t.rx===t.ry)return FB(t,e);throw new Error("not supported")}function khe(t,e){if(t.rx===t.ry)return Mhe(t,e);throw new Error("not supported")}function pG(t,e){if(t.bbox().intersection1(e.bbox())!=null){if(t.rx===t.ry&&e.rx===e.ry)return Fhe(t,e);throw new Error("not supported operation")}return 0}function Fhe(t,e){let r=t.center.x,i=t.center.y,n=e.center.x,s=e.center.y,a=t.rx,o=e.rx,l=t.rx2,c=e.rx2,u=t.center.distance1(e.center),d=Math.abs(a-o),A=a+o;if(wt.greater(u,A)||wt.less(u,d))return 0;if(wt.eq(d+u,0)){let h=0,f;return xo(t,e.start())&&(Be[h]=e.start().x,Be[h+1]=e.start().y,h+=2,f=e.start()),xo(t,e.end())&&(Be[h]=e.end().x,Be[h+1]=e.end().y,h+=2,f=e.end()),h===0?(xo(e,t.start())&&(Be[h]=t.start().x,Be[h+1]=t.start().y,h+=2),xo(e,t.end())&&(Be[h]=t.end().x,Be[h+1]=t.end().y,h+=2)):h===2&&(!f.equals1(t.start())&&xo(e,t.start())&&(Be[h]=t.start().x,Be[h+1]=t.start().y,h+=2),!f.equals1(t.end())&&xo(e,t.end())&&(Be[h]=t.end().x,Be[h+1]=t.end().y,h+=2)),h}else if(wt.eq(u,A)){if(QH(t,e))return 4;let h=new Ee(t.center,e.center),f=FB(e,h);return f=zH(t,f),f!==0?f:(f=FB(t,h),zH(e,f))}else if(wt.eq(u,d)){if(QH(t,e))return 4;if(a>o){let h=(a-o)/a;return Be[0]=r+(n-r)/h,Be[1]=i+(s-i)/h,XH(t,e,2)}else{let h=(o-a)/o;return Be[0]=n+(r-n)/h,Be[1]=s+(i-s)/h,XH(t,e,2)}}else{let h=(t.center.distance2(e.center)-c+l)/(u*2)/u,f=(n-r)*h+r,p=(s-i)*h+i,m=n-r,y=s-i,g=Math.max(a,o),b,E,w,x;if(Math.abs(m)<Math.abs(y)){let U=m/-y,_=p-U*f;b=f-g,E=U*b+_,w=f+g,x=U*w+_}else{let U=y/-m,_=f-U*p;E=p-g,b=U*E+_,x=p+g,w=U*x+_}let I=vc(l,r,i,b,E,f,p,0);if(I=vc(l,r,i,f,p,w,x,I),I!==4)throw new Error("cnt !== 4");let C=new ne(Be[0],Be[1]),G=new ne(Be[2],Be[3]);if(xo(t,C)&&xo(e,C))return xo(t,G)&&xo(e,G)?4:w0(t.start(),e,G,C)?(Be[2]=t.start().x,Be[3]=t.start().y,4):w0(t.end(),e,G,C)?(Be[2]=t.end().x,Be[3]=t.end().y,4):w0(e.start(),t,G,C)?(Be[2]=e.start().x,Be[3]=e.start().y,4):w0(e.end(),t,G,C)?(Be[2]=e.end().x,Be[3]=e.end().y,4):2;if(xo(t,G)&&xo(e,G))return w0(t.start(),e,C,G)?(Be[0]=t.start().x,Be[1]=t.start().y,4):w0(t.end(),e,C,G)?(Be[0]=t.end().x,Be[1]=t.end().y,4):w0(e.start(),t,C,G)?(Be[0]=e.start().x,Be[1]=e.start().y,4):w0(e.end(),t,C,G)?(Be[0]=e.end().x,Be[1]=e.end().y,4):(Be[0]=Be[2],Be[1]=Be[3],2);{let U=function(j,$){if(wt.eq(j.distance1($.center),$.rx)&&xo($,j)){if(j.distance2(C)<j.distance2(G)){if(_)return;_=!0}else{if(H)return;H=!0}Be[Q++]=j.x,Be[Q++]=j.y}},_=!1,H=!1,Q=0;return U(t.start(),e),U(t.end(),e),U(e.start(),t),U(e.end(),t),Q}}}function w0(t,e,r,i){return wt.eq(t.distance1(e.center),e.rx)&&xo(e,t)&&t.distance2(r)<t.distance2(i)}function QH(t,e){return wt.eq(e.start().distance1(t.center),t.rx)&&xo(t,e.start())?(Be[0]=e.start().x,Be[1]=e.start().y,Be[2]=e.start().x,Be[3]=e.start().y,!0):wt.eq(e.end().distance1(t.center),t.rx)&&xo(t,e.end())?(Be[0]=e.end().x,Be[1]=e.end().y,Be[2]=e.end().x,Be[3]=e.end().y,!0):wt.eq(t.start().distance1(e.center),e.rx)&&xo(e,t.start())?(Be[0]=t.start().x,Be[1]=t.start().y,Be[2]=t.start().x,Be[3]=t.start().y,!0):wt.eq(t.end().distance1(e.center),e.rx)&&xo(e,t.end())?(Be[0]=t.end().x,Be[1]=t.end().y,Be[2]=t.end().x,Be[3]=t.end().y,!0):!1}function zH(t,e){if(e===0)return 0;let r=Be[0],i=Be[1];return xo(t,new ne(r,i))?(Be[0]=r,Be[1]=i,Be[2]=r,Be[3]=i,4):0}function XH(t,e,r){if(r===0)return 0;let i=Be[0],n=Be[1],s=new ne(i,n);return xo(t,s)&&xo(e,s)?(Be[0]=i,Be[1]=n,Be[2]=i,Be[3]=n,4):0}function _x(t,e){return Math.abs(t-e)<=1e-6}function xo(t,e){let r=t.bbox();if(e.x-r.minX>-vv&&e.x-r.maxX<vv&&e.y-r.minY>-vv&&e.y-r.maxY<vv){let i=Ti.regularD(e.angleD(t.center));return _x(i,t.startAngle)||_x(i,t.startAngle+360)||_x(i,t.startAngle-360)||_x(i,t.endAngle())||_x(i,t.endAngle()+360)||_x(i,t.endAngle()-360)?!0:t.sweepAngle>0?(wt.less(i,t.startAngle)&&(i+=360),wt.greatereq(t.endAngle(),i)):(wt.greater(i,t.startAngle)&&(i-=360),wt.lesseq(t.endAngle(),i))}else return!1}function Uhe(t,e){let r=t[1].x-t[0].x,i=t[1].y-t[0].y,n=e[1].x-e[0].x,s=e[1].y-e[0].y;if(r===0&&n!==0||r!==0&&n===0)return!1;if(r===0&&n===0)return!0;let a=i/r,o=s/n;return AG(a,o,Math.sin(Math.PI/180))}function Hhe(t,e,r){var i,n=+e.x,s=+e.y,a=+r.x,o=+r.y,l=+t.x,c=+t.y,u=a-n,d=o-s,A=l-n,h=c-s,f,p,m,y,g,b;return u===0&&d===0?{d:Math.sqrt(A*A+h*h),point:new ne(n,s)}:(i=(A*u+h*d)/(u*u+d*d),i<0?{d:Math.sqrt(A*A+h*h),point:new ne(n,s)}:i>1?(f=l-a,p=c-o,{d:Math.sqrt(f*f+p*p),point:new ne(a,o)}):(g=n+i*u,b=s+i*d,m=l-g,y=c-b,{d:Math.sqrt(m*m+y*y),point:new ne(g,b)}))}function Bf(t,e){if(!t||!e||t.length!=e.length)return!1;let r="equals1";return!t.some((i,n)=>{let s=e[n],a=!1;return i&&s&&typeof i=="object"&&typeof s=="object"?typeof i[r]=="function"&&Yhe(i,s)?a=!i[r].call(i,s):a=!(i===s||i.toString()===s.toString()):typeof i=="number"&&typeof s=="number"?a=!(Ghe(i,s)||Number.isNaN(i)&&Number.isNaN(s)):a=i!==s,a})}function Ghe(t,e,r=5){return Math.abs(t-e)*Math.pow(10,r)<1}function Yhe(t,e){return!t||!e||typeof t!="object"||typeof e!="object"?t===e:t.constructor===e.constructor}var Qi=new Float64Array(100);function DB(t,e){if(t.bbox().extendOfSize(wt.eps).isSeparated(e.bbox()))return 0;let r=[[t,e]],i=(t.controls.length-1)*(e.controls.length-1)*8,n=0,s=Number.POSITIVE_INFINITY;for(;r.length!==0;){let a=function(B){_=Math.min(_,B),H=Math.max(H,B)},o=function(B,M){let v=Hp(B,M);if(v===0)throw new Error("cnt === 0");for(let N=0;N<v;N+=2)a(Be[N])};if(n>i){for(let B=n-2;B>=2;B-=2)for(let M=B-2;M>=0;M-=2)if(wt.eq(Qi[B],Qi[M])&&wt.eq(Qi[B+1],Qi[M+1])){Qi[M]=(Qi[B]+Qi[M])/2,Qi[M+1]=(Qi[B+1]+Qi[M+1])/2;for(let v=n-3;v>=B;v--)Qi[v]=Qi[v+2];n-=2;break}if(n>i){n=0;let B=e.start(),M=new Float64Array(8);t.getPercent(B)!==null&&(M[n++]=B.x,M[n++]=B.y);let v=e.end();t.getPercent(v)!==null&&(M[n++]=v.x,M[n++]=v.y);let N=t.start();e.getPercent(N)!==null&&(M[n++]=N.x,M[n++]=N.y);let R=t.end();return e.getPercent(R)!==null&&(M[n++]=R.x,M[n++]=R.y),Be.set(M),n}}let[l,c]=r.pop(),u=l.controls,d=c.controls;if(u.length===2&&d.length===2){let B=Hp(new Ee(u[0],u[1]),new Ee(d[0],d[1]));for(let M=0;M<B;M++)Qi[n++]=Be[M];continue}let A=u[0],h=u[u.length-1];A.equals1(h)&&(h=A.add1(1,0));let f=h.y-A.y,p=A.x-h.x,m=-f*A.x-p*A.y,y=Math.sqrt(1/(f**2+p**2));f*=y,p*=y,m*=y;let g=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY;if(u.forEach(B=>{let M=f*B.x+p*B.y+m;M<g&&(g=M),M>b&&(b=M)}),wt.eq(g,b)){if(c.controls.length===2){let B=Hp(new Ee(l.start(),l.end()),new Ee(c.start(),c.end()));for(let M=0;M<B;M++)Qi[n++]=Be[M];if(B!==0)continue}l=new Nt([u[0],u[u.length-1]]),u=l.controls}let E=d.map(B=>{let M=f*B.x+p*B.y+m,v=Math.abs(M);return v<s&&(s=v),M}),w=0;for(let B of E){if(wt.less(B,g))w=w|1;else if(wt.greater(B,b))w=w|2;else{w=3;break}if(w===3)break}if(w!==3)continue;let x=0,I=0,C=h.x-A.x,G=h.y-A.y,U=Math.sqrt(1/(C**2+G**2));C*=U,G*=U;for(let B=1;B<u.length;B++){let M=u[B],v=(M.x-A.x)*C+(M.y-A.y)*G;v<x?x=v:v>I&&(I=v)}w=0;for(let B of d){let M=(B.x-A.x)*C+(B.y-A.y)*G;if(wt.less(M,x))w=w|1;else if(wt.greater(M,I))w=w|2;else{w=3;break}if(w===3)break}if(w!==3)continue;let _=Number.POSITIVE_INFINITY,H=Number.NEGATIVE_INFINITY;s/=2,s<=wt.eps&&(s=wt.eps),g-=s,b+=s,E.forEach((B,M)=>{B>=g&&B<=b&&a(M/(E.length-1))});let Q=new Ee(new ne(0,g),new ne(1,g)),j=new Ee(new ne(0,b),new ne(1,b));for(let B=0;B<E.length-1;B++){let M=new ne(B/(E.length-1),E[B]),v=M.y<g?1:M.y>b?2:3;for(let N=0;N<E.length;N++){let R=new ne(N/(E.length-1),E[N]),q=R.y<g?1:R.y>b?2:3;v!==q&&(v===1?q===2?(o(new Ee(M,R),Q),o(new Ee(M,R),j)):o(new Ee(M,R),Q):v===2?q===1?(o(new Ee(M,R),Q),o(new Ee(M,R),j)):o(new Ee(M,R),j):q===1?o(new Ee(M,R),Q):o(new Ee(M,R),j))}}_!==0&&(c=c.clip(_)[1]),H!==1&&(c=c.clip((H-_)/(1-_))[0]);let $=c.bbox();if(wt.eq($.minX,$.maxX)&&wt.eq($.minY,$.maxY)){w=0;for(let B of c.controls){let M=(B.x-A.x)*C+(B.y-A.y)*G;if(wt.less(M,x))w=w|1;else if(wt.greater(M,I))w=w|2;else{w=3;break}if(w===3)break}if(w===3){let B=new ne(($.minX+$.maxX)/2,($.minY+$.maxY)/2);l.getPercent(B)&&(Qi[n++]=B.x,Qi[n++]=B.y)}continue}if(H-_>.8){let[B,M]=c.clip(.5);r.push([B,l]),r.push([M,l])}else r.push([c,l])}for(let a=0;a<n;a++)Be[a]=Qi[a];return n}function Vhe(t,e){if(t.bbox().extendOfSize(wt.eps).isSeparated(e.bbox()))return{cnt:0};let r=[[t,e]],i=(t.controls.length-1)*(e.controls.length-1)*8,n=0,s=Number.POSITIVE_INFINITY;for(;r.length!==0;){let a=function(B){_=Math.min(_,B),H=Math.max(H,B)},o=function(B,M){let v=Hp(B,M);if(v===0)throw new Error("cnt === 0");for(let N=0;N<v;N+=2)a(Be[N])};if(n>i){for(let B=n-2;B>=2;B-=2)for(let M=B-2;M>=0;M-=2)if(wt.eq(Qi[B],Qi[M])&&wt.eq(Qi[B+1],Qi[M+1])){Qi[M]=(Qi[B]+Qi[M])/2,Qi[M+1]=(Qi[B+1]+Qi[M+1])/2;for(let v=n-3;v>=B;v--)Qi[v]=Qi[v+2];n-=2;break}if(n>i){n=0;let B=new Float64Array(8),M=e.end(),v=0;t.getPercent(M)!==null&&(B[n++]=M.x,B[n++]=M.y,v=2);let N=t.end();return e.getPercent(N)!==null&&(B[n++]=N.x,B[n++]=N.y,v=v===0?1:3),Be.set(B),{havOverlap:v,cnt:n}}}let[l,c]=r.pop(),u=l.controls,d=c.controls;if(u.length===2&&d.length===2){let B=Hp(new Ee(u[0],u[1]),new Ee(d[0],d[1]));for(let M=0;M<B;M++)Qi[n++]=Be[M];continue}let A=u[0],h=u[u.length-1];A.equals1(h)&&(h=A.add1(1,0));let f=h.y-A.y,p=A.x-h.x,m=-f*A.x-p*A.y,y=Math.sqrt(1/(f**2+p**2));f*=y,p*=y,m*=y;let g=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY;if(u.forEach(B=>{let M=f*B.x+p*B.y+m;M<g&&(g=M),M>b&&(b=M)}),wt.eq(g,b)){if(c.controls.length===2){let B=Hp(new Ee(l.start(),l.end()),new Ee(c.start(),c.end()));for(let M=0;M<B;M++)Qi[n++]=Be[M];if(B!==0)continue}l=new Nt([u[0],u[u.length-1]]),u=l.controls}let E=d.map(B=>{let M=f*B.x+p*B.y+m,v=Math.abs(M);return v<s&&(s=v),M}),w=0;for(let B of E){if(wt.less(B,g))w=w|1;else if(wt.greater(B,b))w=w|2;else{w=3;break}if(w===3)break}if(w!==3)continue;let x=0,I=0,C=h.x-A.x,G=h.y-A.y,U=Math.sqrt(1/(C**2+G**2));C*=U,G*=U;for(let B=1;B<u.length;B++){let M=u[B],v=(M.x-A.x)*C+(M.y-A.y)*G;v<x?x=v:v>I&&(I=v)}w=0;for(let B of d){let M=(B.x-A.x)*C+(B.y-A.y)*G;if(wt.less(M,x))w=w|1;else if(wt.greater(M,I))w=w|2;else{w=3;break}if(w===3)break}if(w!==3)continue;let _=Number.POSITIVE_INFINITY,H=Number.NEGATIVE_INFINITY;s/=2,s<=wt.eps&&(s=wt.eps),g-=s,b+=s,E.forEach((B,M)=>{B>=g&&B<=b&&a(M/(E.length-1))});let Q=new Ee(new ne(0,g),new ne(1,g)),j=new Ee(new ne(0,b),new ne(1,b));for(let B=0;B<E.length-1;B++){let M=new ne(B/(E.length-1),E[B]),v=M.y<g?1:M.y>b?2:3;for(let N=0;N<E.length;N++){let R=new ne(N/(E.length-1),E[N]),q=R.y<g?1:R.y>b?2:3;v!==q&&(v===1?q===2?(o(new Ee(M,R),Q),o(new Ee(M,R),j)):o(new Ee(M,R),Q):v===2?q===1?(o(new Ee(M,R),Q),o(new Ee(M,R),j)):o(new Ee(M,R),j):q===1?o(new Ee(M,R),Q):o(new Ee(M,R),j))}}_!==0&&(c=c.clip(_)[1]),H!==1&&(c=c.clip((H-_)/(1-_))[0]);let $=c.bbox();if(wt.eq($.minX,$.maxX)&&wt.eq($.minY,$.maxY)){w=0;for(let B of c.controls){let M=(B.x-A.x)*C+(B.y-A.y)*G;if(wt.less(M,x))w=w|1;else if(wt.greater(M,I))w=w|2;else{w=3;break}if(w===3)break}if(w===3){let B=new ne(($.minX+$.maxX)/2,($.minY+$.maxY)/2);l.getPercent(B)&&(Qi[n++]=B.x,Qi[n++]=B.y)}continue}if(H-_>.8){let[B,M]=c.clip(.5);r.push([B,l]),r.push([M,l])}else r.push([c,l])}for(let a=0;a<n;a++)Be[a]=Qi[a];return{cnt:n}}var jhe=class{constructor(t=wt.eps){this.eps=t}eq(t,e){return Math.abs(t-e)<=this.eps}setEps(t){this.eps=t}},yv=new jhe;function qH(t,e){if(t.bbox().extendOfSize(wt.eps).isSeparated(e.bbox()))return 0;let r=[[t,e]],i=(e.controls.length-1)*16,n=0;for(;r.length!==0;){if(n>i){let a=function(){for(let c=0;c<n;c+=2)for(let u=c+2;u<n;u+=2)if(!(yv.eq(Qi[c],Qi[u])&&yv.eq(Qi[c+1],Qi[u+1]))){l(Qi[u],Qi[u+1],o);break}function l(c,u,d){let A=!1;for(let h=0;h<d.length;h+=2)if(yv.eq(c,d[h])&&yv.eq(u,d[h+1])){A=!0;break}A||d.push(c,u)}},o=[Qi[0],Qi[1]];if(a(),o.length>=100&&(yv.setEps(.001),o=[Qi[0],Qi[1]],a(),o.length>=100))throw new Error("clearSamePoint()");n=o.length,o.forEach((l,c)=>Qi[c]=l)}let s=r.pop();if(s[0]instanceof ze){let a=function(j){G=Math.min(G,j),U=Math.max(U,j)},o=function(j,$){let B=Hp(j,$);if(B===0)throw new Error("cnt === 0");for(let M=0;M<B;M+=2)a(Be[M])},[l,c]=s,u=c.controls;if(u.length===2){let j=LR(l,new Ee(u[0],u[1]));for(let $=0;$<j;$++)Qi[n++]=Be[$];continue}let d=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,h,f,p,m,y;if(Math.abs(l.sweepAngle)>359){let j=l.rx;h=l.center.add1(j,0),f=l.center.add1(-j,0),d=-j,A=j,p=0,m=1,y=-l.center.y}else{h=l.start(),f=l.end(),p=f.y-h.y,m=h.x-f.x,y=-p*h.x-m*h.y;let j=Math.sqrt(1/(p**2+m**2));p*=j,m*=j,y*=j;let $=p*l.center.x+m*l.center.y+y;l.isCCW?(A=l.rx+$,d=0):(d=$-l.rx,A=0)}let g=u.map(j=>p*j.x+m*j.y+y),b=0;for(let j of g){if(wt.less(j,d))b=b|1;else if(wt.greater(j,A))b=b|2;else{b=3;break}if(b===3)break}if(b!==3)continue;let E=0,w=0,x=f.x-h.x,I=f.y-h.y,C=Math.sqrt(1/(x**2+I**2));if(x*=C,I*=C,Math.abs(l.sweepAngle)<=180)E=0,w=(f.x-h.x)*x+(f.y-h.y)*I;else throw new Error("not support");b=0;for(let j of u){let $=(j.x-h.x)*x+(j.y-h.y)*I;if(wt.less($,E))b=b|1;else if(wt.greater($,w))b=b|2;else{b=3;break}if(b===3)break}if(b!==3)continue;let G=Number.POSITIVE_INFINITY,U=Number.NEGATIVE_INFINITY;d-=wt.eps,A+=wt.eps,g.forEach((j,$)=>{j>=d&&j<=A&&a($/(g.length-1))});let _=new Ee(new ne(0,d),new ne(1,d)),H=new Ee(new ne(0,A),new ne(1,A));for(let j=0;j<g.length-1;j++){let $=new ne(j/(g.length-1),g[j]),B=$.y<d?1:$.y>A?2:3;for(let M=0;M<g.length;M++){let v=new ne(M/(g.length-1),g[M]),N=v.y<d?1:v.y>A?2:3;B!==N&&(B===1?N===2?(o(new Ee($,v),_),o(new Ee($,v),H)):o(new Ee($,v),_):B===2?N===1?(o(new Ee($,v),_),o(new Ee($,v),H)):o(new Ee($,v),H):N===1?o(new Ee($,v),_):o(new Ee($,v),H))}}G!==0&&(c=c.clip(G)[1]),U!==1&&(c=c.clip((U-G)/(1-G))[0]);let Q=c.bbox();if(wt.eq(Q.minX,Q.maxX)&&wt.eq(Q.minY,Q.maxY)){b=0;for(let j of c.controls){let $=(j.x-h.x)*x+(j.y-h.y)*I;if(wt.less($,E))b=b|1;else if(wt.greater($,w))b=b|2;else{b=3;break}if(b===3)break}b===3&&(Qi[n++]=(Q.minX+Q.maxX)/2,Qi[n++]=(Q.minY+Q.maxY)/2);continue}U-G>.8?c.clip(.5).forEach(j=>r.push([j,l])):r.push([c,l])}else{let[a,o]=s;r.push([ze.build3(o.center,o.startAngle,o.sweepAngle/2,o.rx,o.ry),a]),r.push([ze.build3(o.center,o.startAngle+o.sweepAngle/2,o.sweepAngle/2,o.rx,o.ry),a])}}for(let s=0;s<n;s++)Be[s]=Qi[s];return n}var Qhe=class{static getSweep(t){if(t.length>2){let e=0,r=t.length;for(let s=0;s<r-1;s++){let a=t[s],o=t[s+1];e+=(o.x+a.x)*(o.y-a.y)}let i=t[0],n=t[r-1];return e+=(i.x+n.x)*(i.y-n.y),e>0}else throw new Error("Unable to determine the direction of rotation!")}static isClose(t){return!!(t.primitives.length>0&&t.primitives[0].start().equals1(t.primitives[t.primitives.length-1].end()))}};function zhe(t){let e=t.primitives,r=e[0],i=r instanceof ze?r.sweepAngle%360:null;if(e.length===1&&r instanceof ze&&(wt.eq(i,0)||wt.eq(Math.abs(i),360)))return!!r.isCCW;let n=new Array;return t.points(.1,s=>{n.push(s)}),Qhe.getSweep(n)}var Xhe=class{static zoomCorner(t,e){let r=new Array,i=new Array,n=new Array;return this.getPanPrimitive(t,r,n,e),this.rearrange(r,n),this.processStart(r,n),this.getResult(r,n,i,e),i.length>0?Fr.build2(i):null}static zoomPolygon(t,e){let r=new Array,i=new Array,n=new Array;return zhe(t)&&(t=t.reverse().asClose()),this.getPanPrimitive(t,r,n,e),this.rearrange(r,n),this.processStart(r,n),this.getResult(r,n,i,e),i.length>0?Fr.build2(i):null}static zoomLines(t,e){return this.zoomPolygon(Fr.build2(t.primitives.concat(t.reverse().primitives)),e/2)}static getPanPrimitive(t,e,r,i){let n=t.primitives;for(let s of n){let a=this.panDistance(s,i);a!==void 0&&(e.push(a),r.push(s))}}static rearrange(t,e){let r=t.length,i=0;for(let a=0;a<r;a++){let o=e[a],l=t[a],c=a==r-1?t[0]:t[a+1];if(!(l instanceof ze&&c instanceof ze)&&!this.isCW(l.end(),c.start(),o.end())){if(wA(l,c)!=0){i=a==r-1?0:a+1;break}}else{i=a;break}}let n=this.start4Index(e,i),s=this.start4Index(t,i);e.length=0,t.length=0,n.forEach(a=>{e.push(a)}),s.forEach(a=>{t.push(a)})}static processStart(t,e){let r=t.length;if(r>2){let i=t[r-1],n=t[0],s=e[r-1];if(!(i instanceof ze&&n instanceof ze)&&!this.isCW(i.end(),n.start(),s.end())){let a=wA(i,n);for(let o=0;o<a;o+=2){let l=new ne(Be[o],Be[o+1]);t[r-1]=this.generatePrimitive(i,i.start(),l),t[0]=this.generatePrimitive(n,l,n.end())}}}}static getResult(t,e,r,i){let n=t.length;for(let s=0;s<n;s++){let a=e[s],o=s===n-1?e[0]:e[s+1],l=s==n-1?0:s+1,c=l==n-1?e[0]:e[l+1],u=t[s],d=s==n-1?t[0]:t[s+1],A=l==n-1?t[0]:t[l+1];if(!(u instanceof ze&&d instanceof ze)&&!this.isCW(u.end(),d.start(),a.end())){let f=this.add(t,r,s,u,d,0);f=this.update(t,r,s,d,f);let p=this.generateArc(o,c,d,A,i);if(f=this.add(t,r,s,u,p,f),f=this.update(t,r,s,p,f),f>0)continue}r.push(u);let h=this.generateArc(a,o,u,d,i);h!==void 0&&r.push(h)}}static generateArc(t,e,r,i,n){if(n>0){let s=t.end(),a=e.start(),o=r.end(),l=i.start();if(o.distance2(l)>1e-8)if(s.equals(a)){let c=o.angleD(s),u=l.angleD(s);return ze.build2(s,c,u,n,n,0)}else{let c=o.angleD(s),u=l.angleD(s),d=o.angleD(a),A=l.angleD(a),h=ze.build2(s,c,u,n,n,0),f=ze.build2(a,d,A,n,n,0);return h.pointOn(h.endAngle()).equals1(l)?h:f.pointOn(f.endAngle()).equals1(l)?f:h}}}static updateNews(t,e,r,i){let n=t.length,s=e==n-1?0:e+1;t[s]=this.generatePrimitive(r,i,r.end())}static add(t,e,r,i,n,s){if(s>0)return s;if(i!=null&&n!=null){let a=wA(i,n);for(let o=0;o<a;o+=2){let l=new ne(Be[o],Be[o+1]);e.push(this.generatePrimitive(i,i.start(),l)),this.updateNews(t,r,n,l);break}return a}else return 0}static update(t,e,r,i,n){if(n>0)return n;let s=e.length;if(s>0&&i!=null){let a=e[s-1],o=wA(a,i);for(let l=0;l<o;l+=2){let c=new ne(Be[l],Be[l+1]);e[s-1]=this.generatePrimitive(a,a.start(),c),this.updateNews(t,r,i,c)}return o}else return 0}static generatePrimitive(t,e,r){if(t instanceof Ee)return new Ee(e,r);if(t instanceof ze){let i=t,n=e.angleD(i.center),s=r.angleD(i.center);return ze.build2(i.center,n,s,i.rx,i.ry,i.sweep())}else throw new Error("not supported operation")}static start4Index(t,e){let r=t.length,i=new Array;for(let n=e;n<r;n++)i.push(t[n]);for(let n=0;n<e;n++)i.push(t[n]);return i}static isCW(t,e,r){let i=new Ee(r,t),n=new Ee(r,e),s=i.end().x-i.start().x,a=i.end().y-i.start().y,o=n.end().x-n.start().x,l=n.end().y-n.start().y;return!(s*l-a*o>0)}static panDistance(t,e){if(t instanceof Ee){if(t.isPoint())return;{let r=t.panDistance(e);return r.length()>1e-5?r:void 0}}else if(t instanceof ze){let r=t;if(r.sweepAngle>0){if(r.rx-e<=0||r.ry-e<=0)return}else if(r.sweepAngle<0&&(r.rx+e<=0||r.ry+e<=0))return;return r=r.panDistance(e),r.start().distance1(r.end())>1e-5||wt.eq(Math.abs(r.sweepAngle),360)?r:void 0}else throw new Error("not supported operation")}},li=.001,tu=li**2;function Vr(t,e){return t.distance2(e)<tu}function Gp(t,e){return Math.abs(t-e)<=1e-4}function qhe(t,e){if(t instanceof Ee)return new Ee(t.start(),e);if(t instanceof ze){let r=e.angleD(t.center);return Gp(Ti.regularD(t.startAngle),Ti.regularD(r))?ze.build3(t.center,t.startAngle,0,t.rx,t.ry):ze.build2(t.center,t.startAngle,r,t.rx,t.ry,t.isCCW?1:0)}else{if(t instanceof Nt)return t.clip(t.getPercent(e,li))[0];throw new Error("not supported operation")}}function _f(t,e=Ti.toRadians(t.startAngle)){return t.isCCW?e+=kB:e-=kB,new ne(Math.cos(e),Math.sin(e))}function Pv(t,e=0){let r=t.controls;if(e===0){let i=r[0],n=r.slice(1).find(s=>!(s.x===i.x&&s.y===i.y));if(!n)throw Error("getTangentBezier(bezier: Bezier, t: number = 0)");return n.sub(i)}else if(e===1){let i=r[r.length-1],n=r.slice(0,-1).reverse().find(s=>!(s.x===i.x&&s.y===i.y));if(!n)throw Error("getTangentBezier(bezier: Bezier, t: number = 0)");return i.sub(n)}if(r.length===3){let[i,n,s]=r;return n.sub(i).mul(2*(1-e)).add(s.sub(n).mul(2*e)).normalize()}else{let[i,n,s,a]=r;return n.sub(i).mul(3*(1-e)**2).add(s.sub(n).mul(6*(1-e)*e)).add(a.sub(s).mul(3*e**2)).normalize()}}function Gx(t,e,r){let i=t.slice(1).findIndex(s=>!(s.x===e.x&&s.y===e.y)),n=t[i+1];if(r&&(r.getPercent(n,li)!==null||new Ee(r.start(),r.end()).distance(n)<=li)&&(n=t[i+2]),!n)throw Error("getSecondPoint(controls: readonly Vector2[])");return n}function oi(t,e){if(t instanceof Ee)return t.end().sub(t.start()).normalize();if(t instanceof ze)return(e?_f(t,e.angle(t.center)):_f(t)).normalize();if(t instanceof Nt)if(t.controls.length===2){let[r,i]=t.controls;if(Vr(r,i))throw Error("equalsPP(p0, p1)");return i.sub(r).normalize()}else return(e?Pv(t,t.getPercent(e,li)):Pv(t)).normalize();else throw new Error("not support")}function Whe(t,e,r){let i=[],n=e**2-4*t*r;if(n>=0){let s=-e/(2*t),a=Math.sqrt(n)/(2*t),o=s+a;if(i.push(o),n>0){let l=s-a;i.push(l)}}return i}function Khe(t,e,r,i,n=0,s=1){let a=[],o=t*Math.pow(n,3)+e*Math.pow(n,2)+r*n+i,l=t*Math.pow(s,3)+e*Math.pow(s,2)+r*s+i,c,u;if(o*l<0)for(;Math.abs(n-s)>li;)if(c=(n+s)/2,u=t*Math.pow(c,3)+e*Math.pow(c,2)+r*c+i,Math.abs(u)<li){a.push(c);break}else o*u<0?s=c:l*u<0&&(n=c);else o*l===0&&(o===0&&a.push(n),l===0&&a.push(s));return a}function yR(t,e,r){if(t instanceof Ee||e.distance2(r)<=tu)return new Ee(e,r);if(t instanceof ze)return ze.build2(t.center,e.angleD(t.center),r.angleD(t.center),t.rx,t.ry,t.isCCW?1:0);if(t instanceof Nt){let i=t.getPercent(e,li),n=t.getPercent(r,li);return t.clip(i)[1].clip((n-i)/(1-i))[0]}else throw new Error("not supported operation")}function OR(t){return wt.greater(t,0)&&wt.less(t,1)}function UB(t,e,r,i){let n=t[i]-2*e[i]+r[i],s=e[i]-t[i];if(n===0)return[];let a=-s/n,o=[];return OR(a)&&o.push(a),o}function HB(t,e,r,i,n){let s,a,o=-t[n]+3*e[n]-3*r[n]+i[n],l=2*(t[n]-2*e[n]+r[n]),c=e[n]-t[n],u=l**2-4*o*c;if(wt.lesseq(u,0))s=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY;else{let A=Math.sqrt(u);s=(-l-A)/(2*o),a=(-l+A)/(2*o);let h=o*2;if(wt.lesseq(s,1)&&wt.greatereq(s,0)){let f=Number.NEGATIVE_INFINITY;for(;wt.neq(s,f);){f=s;let p=h*s+l;s=-(o*s**2+l*s+c-p*s)/p}}if(wt.lesseq(a,1)&&wt.greatereq(a,0)){let f=Number.NEGATIVE_INFINITY;for(;wt.neq(a,f);){f=a;let p=h*a+l;a=-(o*a**2+l*a+c-p*a)/p}}}let d=[];return OR(a)&&d.push(a),OR(s)&&d.push(s),d}function XB(t,e){if(t.controls.length===2){let[o,l]=t.controls;Vr(o,l)||e.push(new Ee(o,l));return}let r,i;if(t.controls.length===3){let[o,l,c]=t.controls;r=UB(o,l,c,"x"),i=UB(o,l,c,"y")}else{let[o,l,c,u]=t.controls;r=HB(o,l,c,u,"x"),i=HB(o,l,c,u,"y")}r.sort((o,l)=>l-o),i.sort((o,l)=>l-o);let n=r.pop()||1,s=i.pop()||1,a=0;for(;n!==1||s!==1;)if(wt.eq(n,s))n=r.pop()||1,s=i.pop()||1;else if(n<s){let[o,l]=t.clip((n-a)/(1-a));a=n,e.push(o),t=l,n=r.pop()||1}else{let[o,l]=t.clip((s-a)/(1-a));a=s,e.push(o),t=l,s=i.pop()||1}e.push(t)}var Jhe=1e-5,VR=1,Nt=class Hu extends Nv{constructor(e){if(super(),this._startToEndL=null,e.length<2)throw new Error("Bezier needs at least 2 endpoints");this.controls=e.slice()}get startToEndL(){return this._startToEndL===null&&(this._startToEndL=new Ee(this.start(),this.end())),this._startToEndL}build1(e){let r=[];return Yx(e,(i,n)=>(r.push(n),!0)),new Hu(r)}start(){return this.controls[0]}end(){return this.controls[this.controls.length-1]}static pointOn(e,r){if(r.length<1)throw new Error("bezier must have at least 1 point");if(r.length===1)return r[0];{let i=new Array(r.length-1);for(let n=1;n<r.length;n++){let s=r[n-1],a=r[n],o=(a.x-s.x)*e,l=(a.y-s.y)*e;i[n-1]=s.add1(o,l)}return Hu.pointOn(e,i)}}clip1(e,r,i,n){if(i.push(r[0]),n.push(r[r.length-1]),r.length<2)throw new Error("bezier clip must have at least 2 point");if(r.length===2){let s=r[0],a=r[1],o=(a.x-s.x)*e,l=(a.y-s.y)*e,c=s.add1(o,l);i.push(c),n.push(c)}else{let s=new Array(r.length-1);for(let a=1;a<r.length;a++){let o=r[a-1],l=r[a],c=(l.x-o.x)*e,u=(l.y-o.y)*e;s[a-1]=o.add1(c,u)}this.clip1(e,s,i,n)}}clip(e){let r=[],i=[];return this.clip1(e,this.controls,r,i),[new Hu(r),new Hu(i.reverse())]}greater(e,r,i){return e-r>i}less(e,r,i){return e-r<-i}eq(e,r,i){return Math.abs(e-r)<=i}eqPP(e,r,i){return!e||!r?!1:this.eq(e.x,r.x,i)&&this.eq(e.y,r.y,i)}isInRange(e,r=wt.eps){let i=this.controls.map(s=>s.y-e.y),n=0;for(let s of i){if(this.less(s,0,r))n=n|1;else if(this.greater(s,0,r))n=n|2;else{n=3;break}if(n===3)break}if(n!==3)return!1;n=0;for(let s of this.controls){let a=s.x-e.x;if(this.less(a,0,r))n=n|1;else if(this.greater(a,0,r))n=n|2;else{n=3;break}if(n===3)break}return n===3}getPercent(e,r=wt.eps){if(!this.isInRange(e,r))return null;let i=Number.POSITIVE_INFINITY,n=[[this,0,1]];for(;n.length!==0;){let s=function(m){u=Math.min(u,m),d=Math.max(d,m)},a=function(m,y){let g=Hp(m,y);if(g===0)throw new Error("cnt === 0");for(let b=0;b<g;b+=2)s(Be[b])},[o,l,c]=n.pop();if(this.eqPP(o.start(),e,r))return l;if(this.eqPP(o.end(),e,r))return c;let u=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,A=o.controls.map(m=>m.y-e.y);i=A.reduce((m,y)=>{let g=Math.abs(y);return g<m?g:m},i),i/=2,i<=r&&(i=r),A.forEach((m,y)=>{this.eq(m,0,r)&&s(y/(A.length-1))});let h=new Ee(new ne(0,-i),new ne(1,-i)),f=new Ee(new ne(0,i),new ne(1,i));for(let m=0;m<A.length-1;m++){let y=new ne(m/(A.length-1),A[m]),g=this.less(y.y,0,r)?1:this.greater(y.y,0,r)?2:3;for(let b=0;b<A.length;b++){let E=new ne(b/(A.length-1),A[b]),w=this.less(E.y,0,r)?1:this.greater(E.y,0,r)?2:3;g!==w&&(g===1?w===2?(a(new Ee(y,E),h),a(new Ee(y,E),f)):a(new Ee(y,E),h):g===2?w===1?(a(new Ee(y,E),h),a(new Ee(y,E),f)):a(new Ee(y,E),f):w===1?a(new Ee(y,E),h):a(new Ee(y,E),f))}}if(!isFinite(u)){if(Math.max(...A.map(m=>Math.abs(m)))<r*4)return(l+c)/2;continue}if(u!==0&&(o=o.clip(u)[1],l=(c-l)*u+l),d!==1){let m=(d-u)/(1-u);o=o.clip(m)[0],c=(c-l)*m+l}if(!o.isInRange(e,r))continue;let p=o.controls.reduce((m,y)=>m.ext2(y),new pr).build1();if(this.eq(p.minX,p.maxX,r)&&this.eq(p.minY,p.maxY,r))return(l+c)/2;if(d-u>.8){let[m,y]=o.clip(.5);m.isInRange(e,r)?(n.push([m,l,(l+c)/2]),y.isInRange(e,r)&&n.push([y,(l+c)/2,c])):n.push([y,(l+c)/2,c])}else n.push([o,l,c])}return null}toBezier(){return this}toString(){return"Bezier ["+this.controls.join(" ")+"]"}bbox(){return this._bbox||(this._bbox=new pr().ext3(this.points(.1)).build1()),this._bbox}bboxWithControls(){return this._bbox_controls||(this._bbox_controls=new pr().ext3(this.controls).build()),this._bbox_controls}multiply3(e){let r=new Array(this.controls.length);for(let i=0;i<this.controls.length;i++){let n=this.controls[i];r[i]=n.multiply3(e)}return new Hu(r)}stroke(e,r,i,n=VR){let s=Xhe.zoomLines(Fr.build4(this.points(n)),e);return i===0?s:s.reverse()}points(e){let r=[];return this.getBezierPoints(e,i=>r.push(i)),r}getBezierPoints(e,r){if(this.controls.length===2){r(this.start()),r(this.end());return}let i=[this];for(r(this.start());i.length!==0;){let s=i.pop(),a=new Ee(s.start(),s.end());if(n(s.controls,a)<=e)r(s.end());else{let[o,l]=s.clip(.5);i.push(l,o)}}function n(s,a){let o=a.start(),l=a.end();o.equals1(l)&&(l=o.add1(1,0));let c=l.y-o.y,u=o.x-l.x,d=-c*o.x-u*o.y,A=Math.sqrt(1/(c**2+u**2));c*=A,u*=A,d*=A;let h=s.map(f=>Math.abs(c*f.x+u*f.y+d));return Math.max(...h)}}getBezierPoints3(e,r){if(this.controls.length===2){r(this.start()),r(this.end());return}let i=e*e,n=this.controls[0],s=.5;for(;s>Jhe&&!(n.distance2(Hu.pointOn(s,this.controls))<=i);s*=.5);let a=Math.ceil(1/s);s=1/a,r(n);let o=0;for(let l=1;l<a;l++)o+=s,r(Hu.pointOn(o,this.controls));r(this.end())}getPointsBySlope(e){if(this.controls.length===4)return this.getPointsBySlope4(e);throw new Error("Currently, only 4 control points are supported!")}getPointsBySlope4(e){let[r,i,n,s]=this.controls,a=-3*r.x+9*i.x-9*n.x+3*s.x,o=6*r.x-12*i.x+6*n.x,l=-3*r.x+3*i.x,c=[];if(Number.isFinite(e)){let u=-3*r.y+9*i.y-9*n.y+3*s.y,d=6*r.y-12*i.y+6*n.y,A=-3*r.y+3*i.y,h=u-a*e,f=d-o*e,p=A-l*e,m=-f/(2*h),y=Math.sqrt(f**2-4*h*p)/(2*h),g=m+y;g>=0&&g<=1&&c.push(Hu.pointOn(g,this.controls));let b=m-y;b>=0&&b<=1&&c.push(Hu.pointOn(b,this.controls))}else{let u=-o/(2*a),d=Math.sqrt(o**2-4*a*l)/(2*a),A=u+d;A>=0&&A<=1&&c.push(Hu.pointOn(A,this.controls));let h=u-d;h>=0&&h<=1&&c.push(Hu.pointOn(h,this.controls))}return c}buildConverxHull(e=wt.eps){let r=[...this.controls],i=[],n=r[0],s=1;do{let a=r[s%r.length];this.eqPP(n,a,e)||i.push(new Ee(n,a)),n=a,s++}while(n!==r[0]);if(i.length===0)throw Error("buildConverxHull(diff = DoubleKit.eps)");return Fr.build7(i).asClose()}getExtremePoints(e){if(!e)return a(this.controls);let r=e.start(),i=e.end(),n=i.x-r.x,s=i.y-r.y;if(Math.abs(n)<=wt.eps||Math.abs(s)<=wt.eps)return a(this.controls);{let o=s/n;if(this.controls.length===3){r.equals1(i)&&(i=r.add1(1,0));let l=i.y-r.y,c=r.x-i.x,u=-l*r.x-c*r.y,d=Math.sqrt(1/(l**2+c**2));l*=d,c*=d,u*=d;let A=this.controls.map(p=>l*p.x+c*p.y+u),h=A[0]-2*A[1]+A[2],f=A[1]-A[0]-o/2;if(h!==0){let p=-f/h;if(wt.greater(p,0)&&wt.less(p,1))return[Hu.pointOn(p,this.controls)]}}else if(this.controls.length===4)return this.getPointsBySlope(o)}return[];function a(o){let l,c;if(o.length===3){let[h,f,p]=o;l=UB(h,f,p,"x"),c=UB(h,f,p,"y")}else if(o.length===4){let[h,f,p,m]=o;l=HB(h,f,p,m,"x"),c=HB(h,f,p,m,"y")}l.sort((h,f)=>f-h),c.sort((h,f)=>f-h);let u=l.pop()||1,d=c.pop()||1,A=[];for(;u!==1||d!==1;)wt.eq(u,d)?(u=l.pop()||1,d=c.pop()||1):u<d?(A.push(Hu.pointOn(u,o)),u=l.pop()||1):(A.push(Hu.pointOn(d,o)),d=c.pop()||1);return A}}getToLineMaxDis2(e){let r=this.getExtremePoints(e),i=e.distance2(this.start()),n=e.distance2(this.end()),s=Math.max(i,n);return r.forEach(o=>a(e.distance2(o))),s;function a(o){s=Math.max(s,o)}}getToLineMinAndMaxDis_Controls(e){let r=e.start(),i=e.end();e.start().equals1(e.end())&&(i=r.add1(1,0));let n=i.y-r.y,s=r.x-i.x,a=-n*r.x-s*r.y,o=Math.sqrt(1/(n**2+s**2));n*=o,s*=o,a*=o;let l=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY;return this.controls.forEach(u=>{let d=n*u.x+s*u.y+a;d<l&&(l=d),d>c&&(c=d)}),{minDis:l,maxDis:c}}getPercentInLine(e){let r=[],i=[],n=this.controls,s=e.start(),a=e.end(),o=a.y-s.y,l=s.x-a.x,c=-o*s.x-l*s.y,u=Math.sqrt(1/(o**2+l**2));if(o*=u,l*=u,c*=u,o**2+l**2<=0)return r;if(n.length===3){let[d,A,h]=n,f=o*(d.x-2*A.x+h.x)+l*(d.y-2*A.y+h.y),p=2*(o*(A.x-d.x)+l*(A.y-d.y)),m=o*d.x+l*d.y+c;i=Whe(f,p,m)}else if(n.length===4){let[d,A,h,f]=n,p=f.sub(h.mul(3)).add(A.mul(3)).sub(d),m=d.sub(A.mul(2)).add(h).mul(3),y=A.sub(d).mul(3),g=d,b=o*p.x+l*p.y,E=o*m.x+l*m.y,w=o*y.x+l*y.y,x=o*g.x+l*g.y+c,I=Math.sqrt(1/(b**2+E**2));b*=I,E*=I,w*=I,x*=I,i=Khe(b,E,w,x)}else throw Error("not support getBeizerPointInLine");return i.forEach(d=>{d>=0&&d<=1&&r.push(d)}),r}reverse(){return new Hu(this.controls.slice().reverse())}},Fp,mG=(Fp=class{constructor(){this.textCache=new Map,this.numCache=new Array(20),this.boxCache=new Array(4),this.textOffsetCache=new Array(9),this.BuildLineCache=new Array(7),this.BuildTrackCache=new Array(7),this.BuildViaCache=new Array(11),this.BuildBoxCache=new Array(10),this.BuildArcCache=new Array(10),this.BuildArcTrackCache=new Array(10),this.BuildTextCache=new Array(7),this.BuildPadStyleCache=new Array(4),this.BuildPadCache=new Array(12),this.ARRAY1=new Array(1),this.ARRAY2=new Array(2),this.ARRAY3=new Array(3),this.ARRAY4=new Array(4),this.ARRAY5=new Array(5),this.ARRAY6=new Array(6),this.ARRAY7=new Array(7),this.ARRAY8=new Array(8),this.ARRAY9=new Array(9),this.ARRAY10=new Array(10),this.ARRAY11=new Array(11),this.ARRAY12=new Array(12),this.textOffsetCache[0]=ne.ORIGIN,this.textOffsetCache[1]=new ne(0,-.5),this.textOffsetCache[2]=new ne(0,-1),this.textOffsetCache[3]=new ne(-.5,0),this.textOffsetCache[4]=new ne(-.5,-.5),this.textOffsetCache[5]=new ne(-.5,-1),this.textOffsetCache[6]=new ne(-1,0),this.textOffsetCache[7]=new ne(-1,-.5),this.textOffsetCache[8]=new ne(-1,-1)}static getCache(){return Fp.instance==null&&(Fp.instance=new Fp),Fp.instance}},Fp.instance=null,Fp),Ee=class u1 extends Nv{constructor(e,r){super(),this._a=null,this._b=null,this._c=null,this.__bbox=null,this._hashed=null,this._direct=null,this._start=e,this._end=r}get a(){return this._a===null&&(this._start.equals1(this._end)?(this._a=NaN,this._b=NaN,this._c=NaN):(this._a=this._end.y-this._start.y,this._b=this._start.x-this._end.x,this._c=this._end.x*this._start.y-this._start.x*this._end.y)),this._a}get b(){return this._b===null&&(this._start.equals1(this._end)?(this._a=NaN,this._b=NaN,this._c=NaN):(this._a=this._end.y-this._start.y,this._b=this._start.x-this._end.x,this._c=this._end.x*this._start.y-this._start.x*this._end.y)),this._b}get c(){return this._c===null&&(this._start.equals1(this._end)?(this._a=NaN,this._b=NaN,this._c=NaN):(this._a=this._end.y-this._start.y,this._b=this._start.x-this._end.x,this._c=this._end.x*this._start.y-this._start.x*this._end.y)),this._c}get hashed(){return this._hashed==null&&(this._hashed=this._hashCode()),this._hashed}get direct(){return this._direct==null&&(this._direct=this._end.sub(this._start).normalize()),this._direct}cutLine(e){if(wt.eq(this.distance(e),0)){let r=new u1(this._start,e);return r._a=this._a,r._b=this._b,r._c=this._c,r}return new u1(this._start,e)}get midPoint(){return this._start.add(this._end).mul(.5)}toBezier(){return new Nt([this._start,this._end])}_hashCode(){let e=31,r=1;return r=e*r+this._start.hashCode(),r=e*r+this._end.hashCode(),r}start(){return this._start}end(){return this._end}center(){let e=this.start(),r=this.end();return e.add(r).mul(.5)}panDistance(e){let r=this._end.x-this._start.x,i=this._end.y-this._start.y,n=this.length();r=r*e/n,i=-i*e/n;let s=new ne(this._start.x+i,this._start.y+r),a=new ne(this._end.x+i,this._end.y+r);return new u1(s,a)}isPoint(){return this._start.distance2(this._end)<=1e-8}length(){return this._start.distance1(this._end)}toString(){return"Line [start="+this._start+", end="+this._end+"]"}bbox(){if(this.__bbox==null){let e=mG.getCache().boxCache;e[0]=Math.min(this._start.x,this._end.x),e[1]=Math.max(this._start.x,this._end.x),e[2]=Math.min(this._start.y,this._end.y),e[3]=Math.max(this._start.y,this._end.y),this.__bbox=new Mr(e[0],e[1],e[2],e[3])}return this.__bbox}multiply3(e){return new u1(this._start.multiply3(e),this._end.multiply3(e))}hashCode(){return this.hashed}equals(e){let r=e;return this.hashed===r.hashed&&this._start.equals(r._start)&&this._end.equals(r._end)}equals1(e){let r=e;return this.hashed===r.hashed&&this._start.equals1(r._start)&&this._end.equals1(r._end)}equals2(e){let r=[this.start(),this.end()],i=[e.start(),e.end()];return Bf(r,i)||Bf(r,i.reverse())}stroke(e,r,i){let n,s,a;this._end.x<this._start.x?(s=this._start.x-this._end.x,a=this._start.y-this._end.y,n=this._end):(s=this._end.x-this._start.x,a=this._end.y-this._start.y,n=this._start);let o=Math.sqrt(s*s+a*a),l=e/2,c,u,d;r===2?(u=-l,d=o+l):(u=0,d=o),r===0||r===2?i===0?c=Fr.build5([u,-l,u,l,d,l,d,-l]):c=Fr.build5([u,l,u,-l,d,-l,d,l]):i===0?c=Fr.build2([ze.build3(new ne(u,0),-90,-180,l,l),ze.build3(new ne(d,0),90,-180,l,l)]):c=Fr.build2([ze.build3(new ne(u,0),90,180,l,l),ze.build3(new ne(d,0),-90,180,l,l)]);let A=Math.atan2(a,s),h=Ue.rotate(A).translate1(n);return c.asClose().multiply3(h)}points(e){return[this._start,this._end]}mirrorY(e){return new u1(this.start().mirrorY(e),this.end().mirrorY(e))}reverse(){return new u1(this._end,this._start)}inArea(e,r,i){let n=e.x,s=e.y,a=this._start,o=this._end,l=i==1,c=n-a.x,u=s-a.y,d=n-o.x,A=s-o.y,h=o.x-a.x,f=o.y-a.y,p=new ne(-f,h).normalize(),m=h+p.x*r/2,y=f+p.y*r/2,g=m*m+y*y,b=c*c+u*u,E=d*d+A*A,w=Math.abs(c*f-u*h)/2,x=Math.sqrt(h*h+f*f)*r/4;if(w<=x&&b<=g&&E<=g){if(l)return!0;{let I=new ne(n,s).sub(o).normalize(),C=new ne(n,s).sub(a).normalize(),G=new ne(p.x,p.y).cross(I),U=new ne(p.x,p.y).cross(C);return G>=0&&U<=0}}else if(l){let I=r/2;return b<=I*I?!0:E<=I*I}else return!1}isParallel(e,r=!1){let i=wt.eq(Math.abs(this.direct.cross(e.direct)),0),n=!r||wt.greatereq(this.direct.dot(e.direct),0);return i&&n}distance2(e){return(this.a*e.x+this.b*e.y+this.c)**2/(this.a**2+this.b**2)}distance2ForPP(e){let{x:r,y:i}=e,{x:n,y:s}=this.start(),{x:a,y:o}=this.end();return((r-n)*(o-s)-(i-s)*(a-n))**2/((o-s)**2+(a-n)**2)}distance(e){return Math.abs(this.a*e.x+this.b*e.y+this.c)/Math.sqrt(this.a**2+this.b**2)}};function $he(t,e=.05){if(t.length<3)return t.slice();let r=t.slice(0,1),i=(s,a,o)=>Phe(s.x,s.y,a.x,a.y,o.x,o.y);for(;;){r=t.slice(0,1);for(let s=1;s<t.length-1;s+=2)i(t[s],t[s-1],t[s+1])>e&&r.push(t[s]),r.push(t[s+1]);if(r.at(-1).equals1(t.at(-1))||r.push(t.at(-1)),t.length==r.length)break;t=r}let n=t[t.length-1];return r.push(n),r}var Zhe=che(uhe());function gG(t){if(t.length>2){let e=t[0],r=new Array;r.push(e);for(let i=1,n=t.length;i<n;i++){let s=t[i],a=!1;if(i+1<n){let o=s.sub(e).normalize(),l=t[i+1].sub(e).normalize(),c=o.cross(l);Math.abs(c)<.01&&(a=!0)}a||(r.push(s),e=s)}return r}else return t}var ede=class{constructor(){this.fac=new pr,this.length=0,this.box=null,this.pt=null,this.i=0}calcBBox(t){for(this.fac.clear(),this.length=t.length,this.box=null,this.pt=null,this.i=0;this.i<this.length;this.i++)this.pt=t[this.i],this.box=this.pt.bbox(),this.fac.ext1(this.box);return this.fac.build1()}},tde=new ede,Fr=class bo{constructor(e,r){this.__bbox=null,this.primitives=e,this.__bbox=r}static calcBBox(e){return tde.calcBBox(e)}static build1(e){let r=[],i=null;return RB(e,(n,s)=>{let a=s.start();return i!==null&&!a.equals(i)&&r.push(new Ee(i,a)),r.push(s),i=s.end(),!0}),r.length===0&&i!=null&&r.push(new Ee(i,i)),new bo(r)}static build2(e){return bo.build1(PR(e))}static build3(e){let r=[],i=null;return RB(e,(n,s)=>(i!==null&&r.push(new Ee(i,s)),i=s,!0)),new bo(r)}static build4(e){return this.build3(PR(e))}static build5(e){let r=[];for(let i=0;i<e.length;i+=2)r.push(new ne(e[i],e[i+1]));return this.build4(r)}static build6(e){return bo.build4([e.LL(),e.LR(),e.UR(),e.UL(),e.LL()])}static build7(e){return new bo(e)}static build8(e){let r=new ne(e[0],e[1]),i,n=[],s,a=(o,l)=>o.length==l&&o.every(c=>typeof c=="number");for(let o=2;o<e.length;)switch(typeof e[o]=="string"?s=e[o]:o-=1,s){case"ARC":{let l=e.slice(o+1,o+4);if(!a(l,3))throw new Error("invalid rawData");let c=l[0];i=new ne(l[1],l[2]),n.push(ze.build5(r,i,c)),r=i,o+=4;break}case"L":{let l=e.slice(o+1,o+3);if(!a(l,2))throw new Error("invalid rawData");i=new ne(l[0],l[1]),n.push(new Ee(r,i)),r=i,o+=3;break}case"C":{let l=e.slice(o+1,o+7);if(!a(l,7))throw new Error("invalid rawData");let c=new ne(l[0],l[1]),u=new ne(l[2],l[3]);i=new ne(l[4],l[5]),n.push(new Nt([r,c,u,i])),r=i,o+=7;break}default:throw new Error("invalid rawData")}return bo.build2(n)}static buildBBox(e,r=0){return r===1?bo.build5([e.minX,e.minY,e.maxX,e.minY,e.maxX,e.maxY,e.minX,e.maxY,e.minX,e.minY]):bo.build5([e.minX,e.minY,e.minX,e.maxY,e.maxX,e.maxY,e.maxX,e.minY,e.minX,e.minY])}static triangulate(e,r,i=1){if(e.length===1){let l=new Array;e[0].asClose().points2(i,A=>l.push(A));let c,u=l[0],d=[];for(let A=0;A<l.length-2;A+=2){let h=l[A+1],f=l[A+2],p=h.sub(u).normalize().cross(f.sub(u).normalize());if(wt.neq(p,0)){if(c===!0){if(p<0){d.length=0;break}}else if(c===!1){if(p>0){d.length=0;break}}else c=p>0;d.push(u),d.push(h),d.push(f)}l.push(u),u=f}if(d.length!==0){for(let A=0;A<d.length;A+=3)r(d[A],d[A+1],d[A+2]);return}}let n=[],s=[];e.forEach(l=>{n.length!==0&&s.push(n.length/2),l.asClose().points2(i,c=>n.push(c.x,c.y))});let a=Zhe.default(n,s),o=[];for(let l=1;l<n.length;l+=2)o.push(new ne(n[l-1],n[l]));for(let l=0;l<a.length;l+=3)r(o[a[l]],o[a[l+1]],o[a[l+2]])}lines(e,r){let i=new Array;this.points(e,s=>i.push(s));let n=i[0];for(let s=1;s<i.length;s++){let a=i[s];r(n),r(a),n=a}}triangles(e,r){bo.triangulate([this],(...i)=>{i.forEach(n=>r(n))},e)}mirror(){let e=[];return this.primitives.forEach(r=>{if(r instanceof Ee)r=new Ee(r.start().mirror(),r.end().mirror());else if(r instanceof ze)r=r.mirror();else if(r instanceof Nt){let i=r.controls.map(n=>n.mirror());r=new Nt(i)}else throw new Error("bug");e.push(r)}),new bo(e,this.__bbox)}getPoints(e){let r=[];for(let i of this.primitives)for(let n of i.points(e))r.push(n);return r}round(e=4){let r=this.primitives.slice();for(let i=0;i<r.length;i++){let n=r[i];if(n instanceof Ee){let s=n.start().round(e),a=n.end().round(e);r[i]=new Ee(s,a)}else if(n instanceof Nt){let s=n.controls.map(a=>a.round(e));r[i]=new Nt(s)}else if(n instanceof ze){let s=n.start().round(e),a=n.end().round(e),o=n.sweepAngle;r[i]=ze.build5(s,a,o)}}return new bo(r,this.__bbox)}simplify(e=.05){let r=[],i=!1,n=[],s=this.closed();if(this.primitives.length<=1)return bo.build2(this.primitives);let a=()=>{if(n.length>2){let l=$he(n,e);for(let c=1;c<l.length;c++)r.push(new Ee(l[c-1],l[c]))}else r.push(new Ee(n[0],n[1]));n.length=0,i=!1};for(let l=0;l<this.primitives.length;l++){let c=this.primitives[l];c instanceof Ee?(i?n.push(c.end()):(n.length=0,n.push(c.start(),c.end()),i=!0),l===this.primitives.length-1&&a()):(i&&a(),r.push(c))}let o=new bo(r,this.__bbox);return s&&!o.closed()&&(o=o.asClose()),o}hasBackLine(){let{primitives:e}=this,r;for(let i=0;i<e.length;i++){let n=e[i];if(n instanceof Ee){if(n.end().equals1(n.start()))continue;if(r&&(n.end().equals1(r.start())||Lhe(n.end(),r.start(),r.end())))return!0;r=n}else r=null}return!1}area(e=.1){let r=0,i=this.end();return this.primitives.forEach(n=>{let s=n.start(),a=n.end();if(r+=(s.x+i.x)*(s.y-i.y),n instanceof Ee)r+=(a.x+s.x)*(a.y-s.y);else if(n instanceof ze)r+=(a.x+s.x)*(a.y-s.y),r+=Math.PI*n.rx2*n.sweepAngle/180-ne.normal(n.center,n.start(),n.end());else if(n instanceof Nt){let o=s;n.points(e).forEach(l=>{r+=(l.x+o.x)*(l.y-o.y),o=l}),r+=(a.x+o.x)*(a.y-o.y)}i=a}),r/2}closed(e){return this.primitives.length===0?!1:this.start().equals(this.end(),e)}asClose(){let e=this.primitives[0],r=this.primitives[this.primitives.length-1],i=e.start(),n=r.end();if(i.equals(n))return this;{let s=new Array;return Zc.addAll(s,this.primitives),s.push(new Ee(n,i)),bo.build2(s)}}closeEndpoint(){let e=this.primitives[0],r=this.primitives[this.primitives.length-1],i=e.start(),n=r.end();if(i.equals1(n))return this;{let s=new Array;return Zc.addAll(s,this.primitives),s.push(new Ee(n,i)),new bo(s)}}reverse(){let e=new Array(this.primitives.length);for(let r=0,i=this.primitives.length-1;i>=0;r++,i--){let n=this.primitives[i];if(n instanceof Ee)n=new Ee(n.end(),n.start());else if(n instanceof ze)n=n.exchangeSweep();else if(n instanceof Nt)n=new Nt(n.controls.slice().reverse());else throw new Error("bug");e[r]=n}return new bo(e,this.__bbox)}reverse1(){let e=new Array(this.primitives.length);for(let r=0,i=this.primitives.length-1;i>=0;r++,i--){let n=this.primitives[i];if(n instanceof Ee)n=new Ee(n.end(),n.start());else if(n instanceof ze)n=n.exchangeSweep1();else if(n instanceof Nt)n=new Nt(n.controls.slice().reverse());else throw new Error("bug");e[r]=n}return new bo(e,this.__bbox)}mirrorY(e){let r=[];return this.primitives.forEach(i=>{if(i instanceof Ee)i=i.mirrorY(e);else if(i instanceof ze)i=i.mirrorY(e);else if(i instanceof Nt){let n=i.controls.map(s=>s.mirrorY(e));i=new Nt(n)}else throw new Error("bug");r.push(i)}),new bo(r,this.__bbox)}points(e,r){if(this.primitives.length!==0){for(let i=0;i<this.primitives.length-1;i++){let n=this.primitives[i].points(e);n.pop(),n.forEach(s=>r(s))}this.primitives[this.primitives.length-1].points(e).forEach(i=>r(i))}}points1(e,r){if(this.primitives.length===0)return;for(let n=0;n<this.primitives.length-1;n++){let s=this.primitives[n],a=s instanceof ze?s.points1(e):s.points(e);a.pop(),a.forEach(o=>r(o))}let i=this.primitives[this.primitives.length-1];(i instanceof ze?i.points1(e):i.points(e)).forEach(n=>r(n))}points2(e,r){if(this.primitives.length===0)return;for(let n=0;n<this.primitives.length-1;n++){let s=this.primitives[n],a=s instanceof ze?s.points2():s.points(e);a.pop(),a.forEach(o=>r(o))}let i=this.primitives[this.primitives.length-1];(i instanceof ze?i.points2():i.points(e)).forEach(n=>r(n))}multiply3(e){let r=new Array(this.primitives.length);for(let i=0;i<this.primitives.length;i++)r[i]=this.primitives[i].multiply3(e);return bo.build7(r)}bbox(){return this.__bbox==null&&(this.__bbox=bo.calcBBox(this.primitives)),this.__bbox}start(){return this.primitives.length!==0?this.primitives[0].start():null}end(){return this.primitives.length!==0?this.primitives[this.primitives.length-1].end():null}isClose(e){if(this.primitives.length<=1&&!(this.primitives[0]instanceof ze))return!1;{let r=this.primitives[0],i=this.primitives[this.primitives.length-1];return r.start().equals(i.end(),e)}}isEqual(e){if(e instanceof bo&&e.primitives.length==this.primitives.length){let r=e.primitives.length;for(let i=0;i<r;i++){let n=e.primitives[i],s=this.primitives[i];if(JSON.stringify(n)!=JSON.stringify(s))return!1}return!0}return!1}equals(e){if(!e)return!1;let r=this.primitives,i=e.primitives;if(r.length!=i.length)return!1;if(e.isClose()){let n=0;for(;n<r.length;){let s=r.slice(n).concat(r.slice(0,n));if(Bf(s,i)||Bf(s.reverse(),i))return!0;n++}return!1}else return Bf(this.primitives,e.primitives)}clone(){return bo.build2(this.primitives)}putItem(e,r){if(!e)return!1;if(e instanceof bo)return this.mergePolyline(e,r);let i=this.start();if(!i){this.primitives.push(e),this.__bbox=e.bbox();return}let n=this.end();if(i.equals(n,r))return!1;let s=e.start(),a=e.end(),o=!1,l=!1;if(i.equals(s,r))o=!0,l=!1;else if(i.equals(a,r))o=!1,l=!1;else if(n.equals(s,r))o=!1,l=!0;else if(n.equals(a,r))o=!0,l=!0;else return!1;return l?this.primitives.push(o?e.reverse():e):this.primitives.unshift(o?e.reverse():e),this.__bbox=Mr.extend2(this.__bbox,e.bbox()),!0}mergePolyline(e,r,i=0){if(!e)return!1;let n=this.start();if(!n){this.primitives.push(...e.primitives),this.__bbox=e.bbox();return}let s=this.end();if(n.equals(s,r))return!1;let a=e.start(),o=e.end(),l=!1,c=!1;if(n.equals(a,r))l=!0,c=!1;else if(n.equals(o,r))l=!1,c=!1;else if(s.equals(a,r))l=!1,c=!0;else if(s.equals(o,r))l=!0,c=!0;else return!1;let u=l?e.reverse():e;return c?this.primitives.push(...u.primitives):this.primitives.unshift(...u.primitives),this.__bbox=Mr.extend2(this.__bbox,e.bbox()),!0}deDuplicationPoint(e){let r=this.primitives[this.primitives.length-1].start(),i=this.primitives[this.primitives.length-1].end(),n=e.primitives[0].start(),s=e.primitives[0].end();if(this.primitives[this.primitives.length-1]instanceof Ee&&e.primitives[0]instanceof Ee&&Uhe([r,i],[n,s])){this.primitives.pop(),e.primitives.shift();let a=[];a.push(new Ee(r,s)),this.primitives.push(...a)}}getMaxBBoxHeightByVec(e){let r=e.normalize(),i=-1/0,n=1/0;if(this.primitives.forEach(a=>{let o=a.start().dot(r),l=a.end().dot(r);if(s(o),s(l),a instanceof ze){let c=e.angleD(ne.ORIGIN);if(a.angleIsInArc(c)){let u=a.pointOn(c).dot(r);s(u)}if(a.angleIsInArc(c+180)){let u=a.pointOn(c-180).dot(r);s(u)}}}),i-n<=0)throw new Error("getMaxBBoxHeightByVec");return i-n;function s(a){a>i&&(i=a),a<n&&(n=a)}}getWindingNum(e){let r=this.end(),i=0,{x:n,y:s}=e;for(let o of this.primitives){if(r.y>s?o.bbox().minY>s:o.bbox().maxY<=s){r=o.end();continue}if(o instanceof ze&&(o.isCCW?Math.floor(o.startAngle/90)+1!==Math.ceil(o.endAngle()/90):Math.ceil(o.startAngle/90)-1!==Math.floor(o.endAngle()/90))){let l=o.startAngle,c=o.endAngle();if(o.sweepAngle>0){let u=90;for(;u<=c;)u>l&&(a(ze.build3(o.center,l,u-l,o.rx,o.ry)),l=u),u+=90;l<c&&a(ze.build3(o.center,l,c-l,o.rx,o.ry))}else{let u=270;for(;u>=c;)u<l&&(a(ze.build3(o.center,l,u-l,o.rx,o.ry)),l=u),u-=90;l>c&&a(ze.build3(o.center,l,c-l,o.rx,o.ry))}}else if(o instanceof Nt){let l=[];XB(o,l),l.forEach(c=>a(c))}else a(o)}return i;function a(o){let l=o.start(),c=o.end();if(r.y>s!=l.y>s&&(r.x>n?l.x>n?i+=l.y>r.y?1:-1:r.y>l.y?(r.x-n)*(l.y-s)-(r.y-s)*(l.x-n)<0&&i--:(r.x-n)*(l.y-s)-(r.y-s)*(l.x-n)>0&&i++:l.x>n&&(r.y>l.y?(r.x-n)*(l.y-s)-(r.y-s)*(l.x-n)<0&&i--:(r.x-n)*(l.y-s)-(r.y-s)*(l.x-n)>0&&i++)),l.y>s!=c.y>s){if(l.x>n)if(c.x>n)i+=c.y>l.y?1:-1;else if(o instanceof Ee)l.y>c.y?(l.x-n)*(c.y-s)-(l.y-s)*(c.x-n)<0&&i--:(l.x-n)*(c.y-s)-(l.y-s)*(c.x-n)>0&&i++;else if(o instanceof ze){let{center:u,isCCW:d,rx2:A}=o,h=(u.x-n)**2+(u.y-s)**2;l.y>c.y?(d?h>A:h<A)&&i--:(d?h<A:h>A)&&i++}else if(o instanceof Nt){if(YH(o,s)===0)throw new Error("no inters");Be[0]>n&&(i+=c.y>l.y?1:-1)}else throw new Error("not support!");else if(c.x>n)if(o instanceof Ee)l.y>c.y?(l.x-n)*(c.y-s)-(l.y-s)*(c.x-n)<0&&i--:(l.x-n)*(c.y-s)-(l.y-s)*(c.x-n)>0&&i++;else if(o instanceof ze){let{center:u,isCCW:d,rx2:A}=o,h=(u.x-n)**2+(u.y-s)**2;l.y>c.y?(d?h>A:h<A)&&i--:(d?h<A:h>A)&&i++}else if(o instanceof Nt){if(YH(o,s)===0)throw new Error("no inters");Be[0]>n&&(i+=c.y>l.y?1:-1)}else throw new Error("not support!")}r=c}}},xB=Math.PI*2;var ske=Math.PI/2,ake=Math.sin(Math.PI/180);var rde=4,ze=class Xs extends Nv{constructor(e,r,i,n,s){super(),this._rx2=null,this._ry2=null,this._svgEnd=null,this._hashed=null,this.__bbox=null,this.rx=e,this.ry=r,this.center=i,this.startAngle=n,this.sweepAngle=s,this._start=ne.ORIGIN,this._end=ne.ORIGIN,this._start=this.pointOn(n),this._end=this.pointOn(n+s)}get hashed(){return this._hashed==null&&(this._hashed=this._hashCode()),this._hashed}hashCode(){return this.hashed}_hashCode(){let e=31,r=1;return r=e*r+new ne(this.rx,this.rx).hashCode(),r=e*r+this.center.hashCode(),r=e*r+new ne(this.startAngle,this.sweepAngle).hashCode(),r}get rx2(){return this._rx2==null&&(this._rx2=this.rx*this.rx),this._rx2}get ry2(){return this._ry2==null&&(this._ry2=this.ry*this.ry),this._ry2}get svgEnd(){return this._svgEnd==null&&(this._svgEnd=this.getSvgEnd(this.startAngle,this.sweepAngle,this._start,this._end)),this._svgEnd}getSvgEnd(e,r,i,n){let s=r>=0?-.01:.01,a=e+r;for(;(r>=0&&a>e||r<0&&a<e)&&i.distance2(n)<2e-4;)s*=2,a+=s,n=this.pointOn(a);return n}static build1(e,r,i,n,s,a){wa.positive(i),wa.positive(n);let o=e.equals(r);if(o)return new Xs(i,n,e,0,s?360:0);{let l=e.x,c=-e.y,u=r.x,d=-r.y,A=a===0,h=(l-u)/2,f=(c-d)/2,p=Math.cos(0),m=Math.sin(0),y=p*h+m*f,g=-m*h+p*f;i=Math.abs(i),n=Math.abs(n);let b=i*i,E=n*n,w=y*y,x=g*g,I=s===A?-1:1,C=(b*E-b*x-E*w)/(b*x+E*w);C=C<0?0:C;let G=I*Math.sqrt(C),U=G*(i*g/n),_=G*-(n*y/i),H=(l+u)/2,Q=(c+d)/2,j=H+(p*U-m*_),$=Q+(m*U+p*_),B=(y-U)/i,M=(g-_)/n,v=(-y-U)/i,N=(-g-_)/n,R,q;q=Math.sqrt(B*B+M*M),R=B,I=M<0?-1:1;let P=Ti.toDegrees(I*Math.acos(R/q));q=Math.sqrt((B*B+M*M)*(v*v+N*N)),R=B*v+M*N,I=B*N-M*v<0?-1:1;let z=R/q,W;z<-1?W=Math.acos(-1):z>1?W=Math.acos(1):W=Math.acos(z);let oe=Ti.toDegrees(I*W);!A&&oe>0?oe-=360:A&&oe<0&&(oe+=360),wa.normal(P),wa.normal(oe);let Ae=h*h/b+f*f/E,me=e.distance1(r)/2;i<me&&n<me&&(i*=Math.sqrt(Ae),n*=Math.sqrt(Ae));let ve=o?0:Ti.regularD(-P),Le=o?s?360:0:-oe;return new Xs(i,n,new ne(j,-$),ve,Le)}}static build2(e,r,i,n,s,a){wa.positive(n),wa.positive(s),wa.normal(r),wa.normal(i);let o;return r===i?(r=Ti.regularD(r),i=Ti.regularD(i),o=0):(r=Ti.regularD(r),i=Ti.regularD(i),a===1?i<=r&&(i+=360):i>=r&&(r+=360),o=i-r),new Xs(n,s,e,Ti.regularD(r),o)}static build3(e,r,i,n,s){return wa.positive(n),wa.positive(s),wa.normal(i),new Xs(n,s,e,Ti.regularD(r),i)}static build4(e,r,i,n,s,a){let o=e.angleD(i),l=r.angleD(i);return Xs.build2(i,o,l,n,s,a)}static build5(e,r,i){i=Ti.toRadians(i);let n=r.sub(e),s=new ne(-n.y,n.x).normalize(),a=Math.abs(i)/2,o;if(a!=0)o=n.length()/2/Math.sin(a);else throw new Error("Can't represent circle!!!");let l=s.rotate(ne.ORIGIN,a),c,u;i>0?(c=1,u=r.add(l.scale(o))):(c=0,u=e.sub(l.scale(o)));let d=Ti.toDegrees(e.angle(u)),A=Ti.toDegrees(r.angle(u));return Xs.build2(u,d,A,o,o,c)}static buildCircle(e,r,i=0){return Xs.build2(e,0,360,r,r,i)}start(){return this._start}end(){return this._end}isLarge(){return Math.abs(this.sweepAngle)>180}sweep(){return this.sweepAngle>=0?1:0}get isCCW(){return this.sweepAngle>=0}endAngle(){return this.startAngle+this.sweepAngle}pointOn(e){e=Ti.regularD(e);let r=this.rx,i=this.ry;if(e===0)return this.center.add1(r,0);if(e===90)return this.center.add1(0,i);if(e===180)return this.center.add1(-r,0);if(e===270)return this.center.add1(0,-i);{let n=this.rx2,s=this.ry2,a=Math.tan(Ti.toRadians(e)),o=a*a,l=Math.sqrt(n*s/(n+s/o)),c=Math.sqrt(n*s/(s+n*o));return e>90&&e<270&&(c=-c),e>180&&e<360&&(l=-l),isNaN(c)&&(c=0),isNaN(l)&&(l=0),this.center.add1(c,l)}}exchangeSweep(){return Xs.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle,this.rx,this.ry)}exchangeSweepAndStart(){return Xs.build1(this.end(),this.start(),this.rx,this.ry,this.isLarge(),this.sweepAngle>=0?0:1)}exchangeSweep1(){return Xs.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle+.01,this.rx,this.ry)}mirrorY(e){let r=this.start(),i=this.end();return r.equals(i)?Xs.build3(this.center.mirrorY(),0,360,this.rx,this.ry):Xs.build1(r.mirrorY(e),i.mirrorY(e),this.rx,this.ry,this.isLarge(),this.sweepAngle>=0?0:1)}mirror(e=ne.ORIGIN){let r=this.start(),i=this.end();return r.equals(i)?Xs.build3(this.center.mirror(e),0,360,this.rx,this.ry):Xs.build1(r.mirror(e),i.mirror(e),this.rx,this.ry,this.isLarge(),this.sweep())}sectorArea(){return Math.abs(this.sweepAngle)/360*Math.PI*this.rx*this.ry}area(){let e=jx.area(this.center,this._start,this.pointOn(this.endAngle()));return this.sectorArea()-e}multiply3(e){let r;e.isMirrored()?r=-this.sweepAngle:r=this.sweepAngle;let i;return e.equals(Ue.ROT_90)?i=Ti.regularD(this.startAngle+90):e.equals(Ue.ROT_N90)?i=Ti.regularD(this.startAngle-90):i=Ti.transformD(this.startAngle,e),Xs.build3(this.center.multiply3(e),i,r,e.iScale*this.rx,e.iScale*this.ry)}angleIsInArc(e){return e=Ti.regularD(e),this.sweepAngle>0?(e<this.startAngle&&(e+=360),this.endAngle()>e):(e>this.startAngle&&(e-=360),this.endAngle()<e)}toBezier(){if(Math.abs(this.sweepAngle)>90)throw new Error("not support!");let e=this.start(),r=this.end(),i=Ti.toRadians(this.sweepAngle)/2,n=4/3*(1-Math.cos(i))/Math.sin(i)*this.rx;return new Nt([e,e.add(new ne(n,0).multiply3(Ue.rotateD(this.startAngle+90))),r.add(new ne(n,0).multiply3(Ue.rotateD(this.endAngle()-90))),r])}toBezier2(){let e=[];i(this,90);let r=[];return e.forEach(n=>r.push(n.toBezier())),r;function i(n,s){if(Math.abs(n.sweepAngle)>s){let a=n.sweepAngle/2;i(Xs.build3(n.center,n.startAngle,a,n.rx,n.ry),s),i(Xs.build3(n.center,n.startAngle+a,a,n.rx,n.ry),s)}else e.push(n)}}buildBBox(){let e=mG.getCache().boxCache,r=this.startAngle+this.sweepAngle;if(e[0]=Math.min(this._start.x,this._end.x),e[1]=Math.max(this._start.x,this._end.x),e[2]=Math.min(this._start.y,this._end.y),e[3]=Math.max(this._start.y,this._end.y),this.sweepAngle>0){let i=0;for(;i<r;){if(i>this.startAngle){let n=this.pointOn(i);e[0]=Math.min(e[0],n.x),e[1]=Math.max(e[1],n.x),e[2]=Math.min(e[2],n.y),e[3]=Math.max(e[3],n.y)}i+=90}}else if(this.sweepAngle<0){let i=360;for(;i>r;){if(i<this.startAngle){let n=this.pointOn(i);e[0]=Math.min(e[0],n.x),e[1]=Math.max(e[1],n.x),e[2]=Math.min(e[2],n.y),e[3]=Math.max(e[3],n.y)}i-=90}}return new Mr(e[0],e[1],e[2],e[3])}bbox(){return this.__bbox==null&&(this.__bbox=this.buildBBox()),this.__bbox}length(){return Math.abs(this.rx*this.sweepAngle*Math.PI/180)}toString(){return Hx.format("Arc [start=%s, end=%s, rx=%s, ry=%s, center=%s, startAngle=%s, sweepAngle=%s]",this._start,this._end,this.rx,this.ry,this.center,this.startAngle,this.sweepAngle)}stroke(e,r,i){let n=e/2,s=this.rx+n,a=this.ry+n,o=this.rx-n,l=this.ry-n,c=new Ue;o<0&&(o=-o,c=c.multiply3(Ue.MIRROR_Y)),l<0&&(l=-l,c=c.multiply3(Ue.MIRROR_X)),o===0&&(o=.001),l===0&&(l=.001),c=c.setOrigin1(this.center);let u,d;switch(i===this.sweep()?(u=Xs.build3(this.center,this.startAngle,this.sweepAngle,s,a),d=Xs.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle,o,l)):(u=Xs.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle,s,a),d=Xs.build3(this.center,this.startAngle,this.sweepAngle,o,l)),d=d.multiply3(c),r){case 1:{let A=i===1?180:-180,h=i===this.sweep()?this.pointOn(this.endAngle()):this.pointOn(this.startAngle),f=i===this.sweep()?this.pointOn(this.startAngle):this.pointOn(this.endAngle()),p=u.pointOn(u.endAngle()).angleD(h),m=d.pointOn(d.endAngle()).angleD(f);return Fr.build2([u,Xs.build3(h,p,A,n,n),d,Xs.build3(f,m,A,n,n)])}default:return Fr.build2([u,d])}}points2(){let e=Math.ceil(Math.abs(this.sweepAngle)/rde),r=this.sweepAngle/e,i=[this._start];for(let n=1;n<e;n++)i.push(this.pointOn(this.startAngle+r*n));return i.push(this._end),i}points1(e){let r=Math.max(this.rx,this.ry);if(r<=e)return[this.start(),this.svgEnd];let i=(r-e)/r,n=Math.ceil(Math.abs(this.sweepAngle/Ti.toDegrees(Math.acos(i))/2)),s=new Array(n+1),a=this.sweepAngle/n,o=this.startAngle;for(let l=0;l<=n;l++,o+=a)s[l]=this.pointOn(o);return s}points(e){let r=Math.max(this.rx,this.ry);if(e=Math.abs(e),r<=e)return[this.start(),this.svgEnd];e=Math.max(e,r*1e-5),e=Math.min(e,r*(1-Math.SQRT1_2));let i=(r-e)/r,n=Math.ceil(Math.abs(this.sweepAngle/Ti.toDegrees(Math.acos(i))/2));n=Math.max(n,2);let s=new Array(n+1),a=this.sweepAngle/n,o=this.startAngle+a;s[0]=this.start();for(let l=1;l<n;l++,o+=a)s[l]=this.pointOn(o);return s[n]=this.end(),s}panDistance(e){return this.sweepAngle>0?new Xs(this.rx-e,this.ry-e,this.center,this.startAngle,this.sweepAngle):new Xs(this.rx+e,this.ry+e,this.center,this.startAngle,this.sweepAngle)}panDistance1(e){if(this.sweepAngle>0){let r=this.rx-e;return r<0?(r=Math.abs(r),Xs.build3(this.center,this.startAngle-180,this.sweepAngle,r,r)):new Xs(r,r,this.center,this.startAngle,this.sweepAngle)}else{let r=this.rx+e;return r<0?(r=Math.abs(r),Xs.build3(this.center,this.startAngle-180,this.sweepAngle,r,r)):new Xs(r,r,this.center,this.startAngle,this.sweepAngle)}}get bulge(){let e=Math.abs(Dhe(this.sweepAngle,3))/180*Math.PI;return Math.tan(e/4)}get midPoint(){let e=Ti.toRadians(this.startAngle),r=Ti.toRadians(this.endAngle()),i=this.sweep(),n=this.center,s=this.rx;if(i==1)if(r>e){let a=(r-e)/2+e;return n.add(new ne(Math.cos(a),Math.sin(a)).mul(s))}else{if(r==e)return n.add(new ne(Math.cos(Math.PI*3/2),Math.sin(Math.PI*3/2)).mul(s));{let a=(r+xB-e)/2+e;return n.add(new ne(Math.cos(a),Math.sin(a)).mul(s))}}else if(r>e){let a=(e+xB-r)/2+r;return n.add(new ne(Math.cos(a),Math.sin(a)).mul(s))}else{if(r==e)return n.add(new ne(Math.cos(Math.PI*3/2),Math.sin(Math.PI*3/2)).mul(s));{let a=(e-r)/2+r;return n.add(new ne(Math.cos(a),Math.sin(a)).mul(s))}}}get svgPathData(){return[{type:"M",values:[this._start.x,this._start.y]},{type:"A",values:[this.rx,this.ry,0,this.isLarge()?1:0,this.isCCW,this._end.x,this._end.y]}]}equals(e){let r=Ti.regularD(this.startAngle),i=Ti.regularD(this.sweepAngle),n=Ti.regularD(e.startAngle),s=Ti.regularD(e.sweepAngle);return Bf([this.rx,this.ry,this.center,Math.abs(i)],[e.rx,e.ry,e.center,Math.abs(s)])&&(Bf([i,r],[s,n])||Bf([Ti.regularD(r+i)],[n]))}equals1(e){let r=Ti.regularD(this.startAngle),i=Ti.regularD(this.sweepAngle),n=Ti.regularD(e.startAngle),s=Ti.regularD(e.sweepAngle);return Bf([this.rx,this.ry,this.center,Math.abs(i)],[e.rx,e.ry,e.center,Math.abs(s)])&&(Bf([i,r],[s,n])||Bf([Ti.regularD(r+i)],[n]))}inArea(e,r){let i=e.x,n=e.y,s=this.center,a=this.rx,o=Ti.toRadians(this.startAngle);this.sweep()==0&&(o=Ti.toRadians(this.endAngle()));let l=Ti.toRadians(this.endAngle());this.sweep()==0&&(l=Ti.toRadians(this.startAngle));let c=a-r/2,u=a+r/2;var d=i-s.x,A=n-s.y,h=Math.atan2(A,d);if(h<0&&(h+=xB),o<=l&&h>=o&&h<=l||o>l&&(h>=o&&h<=xB||h>=0&&h<=l)||o==l){var f=Math.sqrt(d*d+A*A);return f<=u&&f>=c}else{var f=(u+c)/2,p=new ne(s.x+Math.cos(o)*f,s.y+Math.sin(o)*f),m=new ne(s.x+Math.cos(l)*f,s.y+Math.sin(l)*f),y=i-p.x,g=n-p.y,b=i-m.x,E=n-m.y;return y*y+g*g<=r*r/4?!0:b*b+E*E<=r*r/4}}isCircle(){return(wt.eq(Math.abs(this.sweepAngle),360)||this._start.equals1(this._end))&&this.rx==this.ry}reverse(){return Xs.build3(this.center,this.endAngle(),-this.sweepAngle,this.rx,this.ry)}getAngle(){let e=Math.PI*2;return this.sweep()==1?(this.endAngle()-this.startAngle+e)%e:(this.startAngle-this.endAngle()+e)%e}isValid(){return this.rx>0&&this.ry>0}},yG=new ArrayBuffer(24),bR=new Float64Array(yG),Px=new Int32Array(yG),qo,oke=(qo=class{static normal(e,r,i){let n=r.sub(e),s=i.sub(r);return n.cross(s)}constructor(e,r,i){this.x=wa.normal(e),this.y=wa.normal(r),this.z=wa.normal(i),bR[0]=e,bR[1]=r,bR[2]=i,this.hashed=Px[0]^Px[1]^Px[2]^Px[3]^Px[4]^Px[5]}isZeroVector(){return this.x===0&&this.y===0&&this.z===0}hashCode(){return this.hashed}equals(e){return e instanceof qo?e.x===this.x&&e.y===this.y&&e.z===this.z:!1}cross(e){return new qo(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){var e=this.length();return new qo(this.x/e,this.y/e,this.z/e)}sub(e){return new qo(this.x-e.x,this.y-e.y,this.z-e.z)}add(e){return new qo(this.x+e.x,this.y+e.y,this.z+e.z)}scale(e){return new qo(this.x*e,this.y*e,this.z*e)}neg(){return new qo(-this.x,-this.y,-this.z)}multiply4(e){var r=this.x*e.data[0]+this.y*e.data[4]+this.z*e.data[8]+e.data[12],i=this.x*e.data[1]+this.y*e.data[5]+this.z*e.data[9]+e.data[13],n=this.x*e.data[2]+this.y*e.data[6]+this.z*e.data[10]+e.data[14],s=this.x*e.data[3]+this.y*e.data[7]+this.z*e.data[11]+e.data[15];return s!=0?new qo(r/s,i/s,n/s):new qo(r,i,n)}rotate(e,r){return this.multiply4(dG.rotateAxis(e,r))}toVector2(){return new ne(this.x,this.y)}},qo.ORIGIN=new qo(0,0,0),qo.X_UNIT_VECTOR=new qo(1,0,0),qo.Y_UNIT_VECTOR=new qo(0,1,0),qo.Z_UNIT_VECTOR=new qo(0,0,1),qo);var Ga=class Mx{static build(e){return e instanceof Fr?new Mx([new va([e])]):e instanceof va?new Mx([e]):e}static buildByPolygon(e){return e?new Mx([e]):new Mx([])}static buildByStroke(e,r,i=1,n){return this.buildByPolygon(va.buildByStroke(e,r,i,VR,n))}static buildCircle(e,r){return this.buildByPolygon(va.buildCircle(e,r))}static buildRect(e){return this.buildByPolygon(va.buildRect(e))}static buildBBox(e){return this.buildByPolygon(va.buildBBox(e))}constructor(e){this.items=e.slice()}multiply3(e){return new Mx(this.items.map(r=>r.multiply3(e)))}bbox(){return this._bbox||(this._bbox=this.items.reduce((e,r)=>e.ext1(r.bbox()),new pr).build1()),this._bbox}toPolylineGroups(){return this.items.map(e=>e.toPolylineGroup())}},ws,Qn=(ws=class{static isHexFormate(e){return!e||typeof e!="string"?!1:/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)}static of1(e){return this.of2(e>>16&255,e>>8&255,e&255)}static of2(e,r,i,n=255){return new ws(e/255,r/255,i/255,n/255)}static of3(e){e.startsWith("#")&&(e=e.substr(1));let r=e.length;if(r==3)return new ws(parseInt(e[0],16)/15,parseInt(e[1],16)/15,parseInt(e[2],16)/15);if(r==6)return new ws(parseInt(e.substr(0,2),16)/255,parseInt(e.substr(2,2),16)/255,parseInt(e.substr(4,2),16)/255);if(r==8)return new ws(parseInt(e.substr(0,2),16)/255,parseInt(e.substr(2,2),16)/255,parseInt(e.substr(4,2),16)/255,parseInt(e.substr(6,2),16)/255);throw new Error("invalid color string")}static of4(e){let r=parseInt(e.r*255+"").toString(16),i=parseInt(e.g*255+"").toString(16),n=parseInt(e.b*255+"").toString(16);return r.length<2&&(r="0"+r),i.length<2&&(i="0"+i),n.length<2&&(n="0"+n),("#"+r+i+n).toUpperCase()}static of5(e,r){if(e.startsWith("#")&&(e=e.substr(1)),e.length==3)return new ws(parseInt(e[0],16)/15,parseInt(e[1],16)/15,parseInt(e[2],16)/15,r);if(e.length==6)return new ws(parseInt(e.substr(0,2),16)/255,parseInt(e.substr(2,2),16)/255,parseInt(e.substr(4,2),16)/255,r);throw new Error("invalid color string")}static of6(e,r){return new ws(e.r,e.g,e.b,r)}static of7(e){return e==null?null:ws.of3(e)}constructor(e,r,i,n=1){this.r=wa.positiveOr0(e),this.g=wa.positiveOr0(r),this.b=wa.positiveOr0(i),this.alpha=n}hashCode(){return this.r+this.g+this.b+this.alpha}equals(e,r=!1){let i=this.r===e.r&&this.g===e.g&&this.b===e.b;return r?i:i&&this.alpha===e.alpha}add(e,r,i,n){return new ws(Math.max(0,Math.min(1,this.r+e)),Math.max(0,Math.min(1,this.g+r)),Math.max(0,Math.min(1,this.b+i)),Math.max(0,Math.min(1,this.alpha+n)))}mul(e){return new ws(Math.max(0,Math.min(1,this.r*e)),Math.max(0,Math.min(1,this.g*e)),Math.max(0,Math.min(1,this.b*e)),this.alpha)}mul1(e){return new ws(Math.max(0,this.r*e),Math.max(0,this.g*e),Math.max(0,this.b*e),this.alpha)}getData(){return[this.r,this.g,this.b,this.alpha]}toString(){let e=(this.r*255).toString(16),r=(this.g*255).toString(16),i=(this.b*255).toString(16);return e.length<2&&(e="0"+e),r.length<2&&(r="0"+r),i.length<2&&(i="0"+i),"#"+e.substr(0,2)+r.substr(0,2)+i.substr(0,2)}toString1(){let e=(this.r*255).toString(16),r=(this.g*255).toString(16),i=(this.b*255).toString(16),n=(this.alpha*255).toString(16);return e.length<2&&(e="0"+e),r.length<2&&(r="0"+r),i.length<2&&(i="0"+i),n.length<2&&(n="0"+n),"#"+e.substr(0,2)+r.substr(0,2)+i.substr(0,2)+n.substr(0,2)}toRGBA(){let e=this.r*255,r=this.g*255,i=this.b*255;return[e,r,i,this.alpha]}toRGBAString(){let e=this.r*255,r=this.g*255,i=this.b*255;return`rgba(${e},${r},${i},${this.alpha})`}isWHITE(){return this.r===1&&this.g===1&&this.b===1&&this.alpha===1}},ws.WHITE=new ws(1,1,1,1),ws.BLACK=new ws(0,0,0,1),ws.RED=new ws(1,0,0,1),ws.GREEN=new ws(0,1,0,1),ws.BLUE=new ws(0,0,1,1),ws.Gray=ws.of3("#9966ff"),ws.Silver=ws.of3("#D2D2D2"),ws.Golden=ws.of3("#DCAA14"),ws.Pink=ws.of3("#ffaec9"),ws),WH=!1,bG=class{onRTreeBBox(t){}onResultSide(t){}onOriginSide(t){}onSplitedSide(t){}onDebugSide(t){}onSweep(t,e,r,i,n,s){}onIntersect(t,e,r){}onSegment(t,e,r,i,n,s){}onSegment1(t,e,r){if(WH){let i=new ne(t.getX(r),r),n=new ne(e.getX(r),r);this.onSegment(i,t.weight,t,n,e.weight,e)}else this.onSegment(t.start,t.weight,t,e.end,e.weight,e)}onSweep1(t,e,r){if(WH){let i=new ne(t.getX(r),r),n=new ne(e.getX(r),r);this.onSweep(i,t.weight,t,n,e.weight,e)}else this.onSweep(t.start,t.weight,t,e.end,e.weight,e)}},Dv=class extends bG{constructor(t){super(),this.plGrps=new Array,this.debug=t}onPolylineGroup(t,e){this.plGrps.push(t)}},Rv=class{constructor(t){this.cache={},this.levels=t,this.result=new Array(t),this.weights=new Array(t),this.maxIdx=t-1,this.rule=this.decide.bind(this);let e=1;for(let r=0;r<t;r++)this.weights[r]=e,e*=50}weight(t){return this.weights[t]}decide(t){t=Math.abs(t);let e=this.cache[t];if(e===void 0){let r=t;for(let i=this.maxIdx;i>=0;i--){let n=this.weights[i],s=t/n|0,a=t%n;a>(n/2|0)?(t=n-a,s++):t=a,this.result[i]=s>0}e=this.decide1(this.result),this.cache[r]=e}return e}},ide=t=>t!==0;var nde=new class extends Rv{decide1(t){return t[0]||t[1]}}(2),_B=new class extends Rv{decide1(t){return t[0]&&!t[1]}}(2),PB=new class extends Rv{decide1(t){return t[0]&&t[1]}}(2),LB=new class extends Rv{decide1(t){return t[0]&&!t[1]||!t[0]&&t[1]}}(2),sde=(t=>(t[t.UNMARKED=0]="UNMARKED",t[t.INSIDE=1]="INSIDE",t[t.OUTSIDE=2]="OUTSIDE",t[t.INVALID=3]="INVALID",t))(sde||{}),Qx=class kx{constructor(e,r,i,n,s,a,o){this.inters=[],this.connect=new Array,this.previous=null,this.next=null,this.finalGrp=-1,this.trans=NaN,this.outsideWeight=0,this.insideWeight=0,this.invalidWeight=0,this._confidence=0,this._confidence_y=NaN,this._x=NaN,this._x_y=NaN,this.status=0,this.bo=e,this.shape=r,this.baseWeight=i,n.y>s.y?this.weight=-i:n.y==s.y?this.weight=0:this.weight=i,this.start=n,this.end=s,this.polyGrp=a,this.polyIndex=o,this._bbox=new pr().ext1(r.bbox()).ext2(n).ext2(s).build1(),this.inters.push(n),this.inters.push(s);let l=31,c=1;c=l*c+this.polyGrp,c=l*c+this.polyIndex,this._hashcode=c}static rebuild(e,r,i){if(e instanceof Ee||r.distance2(i)<1e-6)return new Ee(r,i);if(e instanceof ze){let n=e,s=e.bbox().center().x,a;r.y>i.y?a=s>n.center.x?0:1:a=s>n.center.x?1:0;let o=r.angleD(n.center),l=i.angleD(n.center);return ze.build2(n.center,o,l,n.rx,n.ry,a)}else throw new Error("not supported operation")}updateBbox(){this._bbox=new pr().ext2(this.start).ext2(this.end).build1()}is(e,r){return e===this.polyGrp&&r===this.polyIndex}confidence(e){if(this._confidence_y!=e){let r=this._bbox.height();if(r!==0)if(Math.abs(e-this._bbox.maxY)>5e-4&&Math.abs(e-this._bbox.minY)>5e-4){let i=1-Math.abs(2*e-this._bbox.maxY-this._bbox.minY)/r;this._confidence=i*1e4|0}else this._confidence=0;else this._confidence=1;this._confidence_y=e}return this._confidence}needCountWeight(){return this.outsideWeight+this.insideWeight+this.invalidWeight<5e3}revokeOutside(e){let r=this.confidence(e);return this.outsideWeight-=r,this.invalidWeight+=r,r}revokeInside(e){let r=this.confidence(e);return this.insideWeight-=r,this.invalidWeight+=r,r}setOutside(e){let r=this.confidence(e);return this.outsideWeight+=r,r}setInside(e){let r=this.confidence(e);return this.insideWeight+=r,r}setInvalid(e){let r=this.confidence(e);return this.invalidWeight+=r,r}prevNot0(){let e=this.previous;for(;e!=null&&e!=this;){if(e.weight!=0)return e;e=e.previous}return null}nextNot0(){let e=this.next;for(;e!=null&&e!=this;){if(e.weight!=0)return e;e=e.next}return null}getX(e){if(this.bo!==null)return(this._x_y!=e||isNaN(this._x))&&(Ade(this,e)>0?this._x=Be[0]:this._x=NaN,this._x_y=e),this._x;throw new Error("not supported operation")}voteStatus(){return this.outsideWeight>this.insideWeight&&this.outsideWeight>this.invalidWeight?2:this.insideWeight>this.outsideWeight&&this.insideWeight>this.invalidWeight?1:this.invalidWeight>this.outsideWeight&&this.invalidWeight>this.insideWeight?3:0}reverse(e){if(e===2)if(this.start.y>this.end.y){let r=kx.rebuild(this.shape,this.end,this.start),i=new kx(this.bo,r,this.baseWeight,this.end,this.start,this.polyGrp,this.polyIndex);return Zc.addAll(i.connect,this.connect),i}else return this;else if(e===1)if(this.start.y<this.end.y){let r=kx.rebuild(this.shape,this.end,this.start),i=new kx(this.bo,r,this.baseWeight,this.end,this.start,this.polyGrp,this.polyIndex);return Zc.addAll(i.connect,this.connect),i}else return this;return this}isNeedScan(e){return this.needCountWeight()&&this.confidence(e)>0}hashCode(){return this._hashcode}equals(e){return e instanceof kx?!(this.polyGrp!==e.polyGrp||this.polyIndex!==e.polyIndex):!1}bbox(){return this._bbox}toString(){return Hx.format("(%d,%d,%d) (%d,%d,%d) %s %s",this.polyGrp,this.polyIndex,this.weight,this.outsideWeight,this.invalidWeight,this.insideWeight,this.start,this.end)}};function ade(t,e){let r=t.bbox(),i=e.bbox(),n=(r.minY+r.maxY)/2,s=(i.minY+i.maxY)/2;return n-s}function ode(t,e){let r=t.bbox(),i=e.bbox(),n=(r.minX+r.maxX)/2,s=(i.minX+i.maxX)/2;return n-s}var Lx=class{constructor(t){if(this.__bbox=null,typeof t<"u")if(t instanceof Array){this.__items=[];for(let e of t)this.add(e)}else this.__items=t,this.__bbox=t.bbox();else this.__items=[]}add(t){if(this.__items instanceof Array)this.__items.push(t),this.__bbox=Mr.extend2(this.__bbox,t.bbox());else throw new Error("can't insert multiple item into leaf node")}items(){return this.__items}bbox(){if(this.__bbox!==null)return this.__bbox;throw new Error("bug")}},Lv=class{constructor(t){this.changed=!1,this.root=new Lx,this.capacity=t,this.capacity2=t*t,this.itemList=[]}size(){return this.itemList.length}items(){return this.flushWhenNeed(),this.itemList}add(t){this.itemList.push(t),this.changed=!0}remove(t){Zc.remove(this.itemList,t),this.changed=!0}clear(){this.changed=!1,this.root=new Lx,this.itemList.length=0}flushWhenNeed(){if(this.changed){let t=new Array;for(let e of this.itemList)t.push(new Lx(e));for(;;){let e=this.organize(t);if(e.length>1)t=e;else break}this.root=new Lx(t),this.changed=!1}}organize(t){p1(t,ode,0,t.length);let e=t.length,r=[];for(let i=0;i<e;)if(i+this.capacity2<=e){let n=i+this.capacity2;p1(t,ade,i,n);for(let s=i;s<n;s+=this.capacity){let a=new Lx(t.slice(s,s+this.capacity));r.push(a)}i=i+this.capacity*this.capacity}else{let n=new Lx(t.slice(i,i+this.capacity));r.push(n),i=i+this.capacity}return r}search(t){this.flushWhenNeed();let e=[],r=[];for(r.push(this.root);;){let i=r.shift();if(typeof i<"u"){let n=i.items();if(n instanceof Array){for(let s of n)if(!t.isSeparated(s.bbox())){let a=s.items();a instanceof Array?r.push(s):e.push(a)}}else t.isSeparated(i.bbox())||e.push(n)}else break}return e}walker(t){this.flushWhenNeed(),this._walker(this.root,0,t)}_walker(t,e,r){this.flushWhenNeed();let i=t.items();if(i instanceof Array)for(let n of i)this._walker(n,e+1,r);else r(i,e)}bbox(){return this.flushWhenNeed(),this.root.bbox()}};function xR(t,e){lde(t.iterator(),e)}function lde(t,e){let r=0;for(;t.hasNext();){let i=t.next();e(r++,i)}}var EB=new Error("list is empty"),wB=class{constructor(t,e){this.prev=null,this.next=null,this.parent=t,this.item=e}insertAfter(t){t.next=this.next,this.next=t,t.prev=this,t.next!==null&&(t.next.prev=t)}insertBefore(t){t.prev=this.prev,this.prev=t,t.next=this,t.prev!==null&&(t.prev.next=t)}remove(){this.prev!==null&&(this.prev.next=this.next),this.next!==null&&(this.next.prev=this.prev)}set(t){this.item=t}},cde=class{constructor(t){this._next=t}hasNext(){return this._next!==null}next(){let t=this._next;if(t!==null)return this._next=t.next,t.item;throw new Error("iterator is null")}},ude=class{constructor(t){this._next=t}hasNext(){return this._next!==null}next(){let t=this._next;if(t!==null)return this._next=t.next,t;throw new Error("iterator is null")}},h1=class{constructor(){this.first=null,this.last=null,this.cnt=0}add(t){return this.addLast(t)}push(t){return this.addLast(t)}pop(){return this.removeLast()}shift(){return this.removeFirst()}removeFirst(){let t=this.first;if(t===null)throw EB;return this.remove(t),t.item}removeLast(){let t=this.last;if(t===null)throw EB;return this.remove(t),t.item}addLast(t){return this.first===null||this.last===null?(this.first=new wB(this,t),this.last=this.first,this.cnt=1,this.first):this.insertAfter(this.last,t)}addFirst(t){if(this.first===null||this.last===null){let e=new wB(this,t);return this.first=e,this.last=e,this.cnt++,e}else return this.insertBefore(this.first,t)}getFirst(){if(this.first===null)throw EB;return this.first.item}getLast(){if(this.last===null)throw EB;return this.last.item}insertAfter(t,e){let r=new wB(this,e);return t.insertAfter(r),t===this.last&&(this.last=r),this.cnt++,r}insertBefore(t,e){let r=new wB(this,e);return t.insertBefore(r),t===this.first&&(this.first=r),this.cnt++,r}remove(t){t.remove(),t===this.first&&(this.first=t.next),t===this.last&&(this.last=t.prev),this.cnt--}size(){return this.cnt}clear(){this.first=null,this.last=null,this.cnt=0}iterator(){return new cde(this.first)}listIterator(){return new ude(this.first)}toArray(){let t=new Array(this.cnt),e=this.first,r=0;for(;e!=null;)t[r]=e.item,e=e.next,r++;return t}};function ER(t){throw new Error("")}var vB=class{constructor(t,e){this.node1=null,this.node2=null,this.key=t,this.value=e}},hde=class{constructor(t){this.itors=t}hasNext(){return this.itors.hasNext()}next(){return this.itors.next().key}},dde=class{constructor(t){this.itors=t}hasNext(){return this.itors.hasNext()}next(){return this.itors.next().value}},GB=class{constructor(){this.innerList=new h1,this.innerMap={}}replace(t,e){t.node1!==null&&(t.node1.set(e),e.node1=t.node1),t.node2!==null&&(t.node2.set(e),e.node2=t.node2)}clear(){this.innerList.clear();for(let t in this.innerMap)delete this.innerMap[t]}put(t,e){let r=t.hashCode(),i=new vB(t,e),n=this.innerMap[r];if(n===void 0)return i.node1=this.innerList.add(i),this.innerMap[r]=i,null;if(n instanceof vB){if(n.key.equals(t))return this.innerMap[r]=i,this.replace(n,i),n.value;{i.node1=this.innerList.add(i);let s=new h1;return n.node2=s.add(n),i.node2=s.add(i),this.innerMap[r]=s,null}}if(n instanceof h1){let s=null;return xR(n,(a,o)=>o.key.equals(t)?(this.replace(o,i),s=o.value,!1):!0),s===null?(i.node1=this.innerList.add(i),i.node2=n.push(i),null):s}return ER(n)}get(t){let e=t.hashCode(),r=this.innerMap[e];if(r===void 0)return null;if(r instanceof vB)return r.key.equals(t)?r.value:null;if(r instanceof h1){let i=null;return xR(r,(n,s)=>s.key.equals(t)?(i=s.value,!1):!0),i}return ER(r)}containsKey(t){return this.get(t)!==null}delete(t){t.node1!==null&&t.node1.parent.remove(t.node1),t.node2===null?delete this.innerMap[t.key.hashCode()]:t.node2.parent.remove(t.node2)}remove(t){let e=t.hashCode(),r=this.innerMap[e];if(r===void 0)return null;if(r instanceof vB)return r.key.equals(t)?(this.delete(r),r.value):null;if(r instanceof h1){let i=null;return xR(r,(n,s)=>s.key.equals(t)?(i=s.value,this.delete(s),!1):!0),i}return ER(r)}computeIfAbsent(t,e){let r=this.get(t);if(r===null){let i=e(t);return this.put(t,i),i}else return r}size(){return this.innerList.size()}isEmpty(){return this.innerList.size()===0}keys(){return new hde(this.innerList.iterator())}values(){return new dde(this.innerList.iterator())}entries(){return this.innerList.iterator()}},Vx=class{constructor(){this.innerMap=new GB}add(t){return this.innerMap.put(t,!0)!==!0}remove(t){this.innerMap.remove(t)}contains(t){return this.innerMap.get(t)===!0}iterator(){return this.innerMap.keys()}addAll(t){let e=t.iterator();for(;e.hasNext();)this.add(e.next())}size(){return this.innerMap.size()}clear(){let t=this.iterator();for(;t.hasNext();){let e=t.next();this.remove(e)}}},KH=Zc.funcCopy(p1);function Ade(t,e){let r=0;if(Math.abs(t.start.y-e)<=1e-4)Be[r++]=t.start.x;else if(Math.abs(t.end.y-e)<=1e-4)Be[r++]=t.end.x;else if(t.shape instanceof Ee)r=Ohe(t.shape,e);else if(t.shape instanceof ze)r=Nhe(t.shape,e);else throw new Error("not supported operation");return r}var OB=class{constructor(t,e,r,i){this.sides=new Array,this.loader=t,this.loader.bo=this,this.logger=r,this.rule=e,this.event=i}static sortByBBoxMinY(t,e){return t.bbox().minY-e.bbox().minY}static sortByBBoxAreaDesc(t,e){return e.bbox().area()-t.bbox().area()}addPolyline(t,e=1,r=.01,i=!0){for(let n of this.loader.buildGroup(t,e,r,i))this.sides.push(n),this.event.onOriginSide(n)}buildRTree(){let t=new Lv(10);for(let e of this.sides)t.add(e);return t}fillValidSides(t,e,r){for(let i of e)isFinite(i.getX(r))&&t.push(i)}getSortedEndpointsLineAsc(t){let e=new Array;for(let n of t)n.needCountWeight()&&(e.push(n.start),e.push(n.end));KH(e,ne.sortByYAsc,0,e.length);let r=new Array,i=Number.NEGATIVE_INFINITY;for(let n of e){let s=n.y;s>i&&(r.push(s),i=s)}return r}splitSides(t,e,r){let i=t.start,n=t.end,s=new ne(n.x+(i.x-n.x)*2,n.y+(i.y-n.y)*2);KH(t.inters,(o,l)=>o.distance2(s)-l.distance2(s),0,t.inters.length);let a=null;for(let o of t.inters)if(a==null)o.equals(i)&&(a=o);else if(!o.equals(a)){let l=Qx.rebuild(t.shape,a,o);l instanceof ze&&Math.abs(l.sweepAngle)>190&&(l=new Ee(a,o));let c=new Qx(this,l,t.baseWeight,a,o,t.polyGrp,r++);if(e.push(c),c.updateBbox(),o.equals(n))break;a=o}return r}splitSidesByInters(){let t=new Array;for(let e of this.sides)if(e.polyIndex==0){let r=0,i=null,n=null;do{let s=new Array;r=this.splitSides(e,s,r);for(let a of s)i!=null?(i.next=a,a.previous=i):n=a,i=a,this.event.onSplitedSide(a),t.push(a);if(e.next===null)throw new Error("not supported operation");e=e.next}while(e.polyIndex!==0);n!=null&&i!=null&&(n.previous=i,i.next=n)}this.sides.length=0;for(let e of t)this.sides.push(e)}seekIntersection(){if(this.sides.length>0){let t=this.buildRTree(),e=new Vx;for(let r of this.sides){e.add(r);let i=r.bbox().extendOfSize(1e-5),n=r.shape instanceof Ee;for(let s of t.search(i))if(!e.contains(s)){let a=s.shape instanceof Ee;if(!(n&&a&&r.next!==null&&r.previous!==null&&(r.next.equals(s)||r.previous.equals(s)))){let o=wA(r.shape,s.shape);for(let l=0;l<o;l+=2){let c=new ne(Be[l],Be[l+1]);r.inters.push(c),s.inters.push(c),this.event.onIntersect(c,r,s)}}}}}}},fde=class xG{constructor(e){this.sides=new Vx,this.others=new Vx,this.id=e}add(e){this.sides.add(e),e.finalGrp=this.id;for(let r of e.connect)this.others.add(r)}polyline(){let e=new Array;return Yx(this.sides,(r,i)=>(e.push(i.shape),!0)),Fr.build2(e).asClose()}hashCode(){return this.id}equals(e){return e!=null&&e instanceof xG?this.id===e.id:!1}},EG=class{constructor(t){this.bo=null,this.sides=new Array,this.polyGrp=0,this.polyIndex=0,this.prevSide=null,this.firstSide=null,this.noWeight0=t}completeGroup(t){this.prevSide!=null&&this.firstSide!=null&&!this.prevSide.end.equals(this.firstSide.start)&&this.addSide(new Ee(this.prevSide.end,this.firstSide.start),t);let e=new Array,r=null,i=null;for(let n of this.sides)(!this.noWeight0||n.weight!==0)&&(r!=null?(r.next=n,n.previous=r):i=n,r=n,e.push(n));return r!=null&&i!=null&&(i.previous=r,r.next=i),this.polyGrp++,this.sides.length=0,this.prevSide=null,this.firstSide=null,this.polyIndex=0,e}buildGroup(t,e,r,i=!0){for(let n of t.primitives)if(n instanceof Ee)this.addSide(n,e);else if(i&&n instanceof ze&&n.rx===n.ry)this.addArc(n,e);else{let s=null;for(let a of n.points(r))s!=null&&this.addSide(new Ee(s,a),e),s=a}return this.completeGroup(e)}addArc(t,e){let r=t.sweepAngle,i=Ti.regularD(t.startAngle),n=i+r;if(r>0){let s=90;for(;s<=n;)s>i&&(this.addSide(ze.build3(t.center,i,s-i,t.rx,t.ry),e),i=s),s+=90;i<n&&this.addSide(ze.build3(t.center,i,n-i,t.rx,t.ry),e)}else if(r<0){let s=270;for(;s>=n;)s<i&&(this.addSide(ze.build3(t.center,i,s-i,t.rx,t.ry),e),i=s),s-=90;i>n&&this.addSide(ze.build3(t.center,i,n-i,t.rx,t.ry),e)}}addSide(t,e){if(t.start().equals(t.end()))return;let r=t.start(),i;this.prevSide!=null?(this.prevSide.end.equals(r)||this.addSide(new Ee(this.prevSide.end,r),e),i=new Qx(this.bo,t,e,t.start(),t.end(),this.polyGrp,this.polyIndex++)):(i=new Qx(this.bo,t,e,t.start(),t.end(),this.polyGrp,this.polyIndex++),this.firstSide=i),this.prevSide=i,this.sides.push(i)}},wG=class{constructor(t,e,r){this.eps=new Array,this.curWeight=0,this.start=null,this.last=null,this.prevStart=null,this.prevEnd=null,this.y=r,this.rule=t,this.bo=e,this.event=e.event}onEp(t){this.tuningWeight(t),this.start===null?this.rule(this.curWeight)?this.in(t):t.setInvalid(this.y):this.rule(this.curWeight)?t.setInvalid(this.y):this.out(t,this.start),this.last!==null&&this.event.onSweep1(this.last,t,this.y),this.last=t}in(t){this.prevEnd!=null&&this.onSameX(t,this.prevEnd)?(this.start=this.prevStart,this.prevStart=null,this.prevEnd.revokeInside(this.y),this.prevEnd=null):(this.start=t,this.start.setOutside(this.y))}out(t,e){if(this.onSameX(e,t))e.revokeOutside(this.y);else{if(t.setInside(this.y)>0&&e.confidence(this.y)>0){let r=e.voteStatus(),i=t.voteStatus();this.isValid(r)&&this.isValid(i)?r==2&&i==1&&(t.connect.push(e),e.connect.push(t)):(t.connect.push(e),e.connect.push(t))}this.event.onSegment1(e,t,this.y),this.eps.push(e),this.eps.push(t),this.prevStart=e,this.prevEnd=t}this.start=null}isValid(t){return t==1||t==2}onSameX(t,e){return t.bbox().isIntersect(e.bbox())&&wt.eq(t.getX(this.y),e.getX(this.y))}tuningWeight(t){this.curWeight+=t.weight;let e=t.nextNot0(),r=t.prevNot0();e!=null&&t.weight===e.weight&&e.trans===this.y&&(this.curWeight-=t.weight),r!=null&&t.weight===r.weight&&r.trans===this.y&&(this.curWeight-=t.weight),t.trans=this.y}},YB=new Error,JH=new class extends Rv{decide1(t){return t[0]&&t[1]}}(2),pde=new class extends bG{onPolylineGroup(t,e){throw YB}onSegment(t,e,r,i,n,s){throw YB}},mde=class{constructor(t,e){this.rtree=t,this.level=e}},gde=class vG extends OB{static isIntersect(e,r,i=QB.DUMMY){let n=new vG(i),s=n.createGroup1(e.items),a=n.createGroup2(r.items);return s.rtree.itemList.length==0||a.rtree.itemList.length==0?!1:n.isIntersect(s,a)}constructor(e){super(new EG(!1),JH.rule,e,pde)}createGroup1(e){return this.createGroup(e,0)}createGroup2(e){return this.createGroup(e,1)}createGroup(e,r){let i=JH.weight(r);for(let s of e)this.addPolyline(s,i);let n=this.buildRTree();return this.sides.length=0,new mde(n,r)}isIntersect(e,r){if(e.level!==r.level){let i=e.rtree.bbox().intersection1(r.rtree.bbox());if(i!==null){try{this.inters(e,r);let n=(i.minY+i.maxY)/2;this.sweep(e,r,n)}catch(n){if(n===YB)return!0;throw n}return!1}else return!1}else throw new Error("inersection detection should not in same group")}inters(e,r){if(e.rtree.size()>r.rtree.size()){let i=e;e=r,r=i}for(let i of e.rtree.items()){i.trans=NaN;let n=i.bbox().extendOfSize(1e-5);for(let s of r.rtree.search(n))if(s.trans=NaN,wA(i.shape,s.shape)>0)throw YB}}sweep(e,r,i){let n=Mr.extend2(e.rtree.bbox(),r.rtree.bbox()).extendOfSize(1e-5),s=new Array;this.fillValidSides(s,e.rtree.search(n),i),this.fillValidSides(s,r.rtree.search(n),i),p1(s,(o,l)=>o.getX(i)-l.getX(i),0,s.length);let a=new wG(this.rule,this,i);for(let o of s)a.onEp(o)}},Ws=class jm{constructor(e){this.items=new Array(e.length),Zc.arraycopy(e,0,this.items,0,e.length),this.__bbox=this.calcBBox()}static build1(e){let r=[];return RB(e,(i,n)=>(r.push(n),!0)),new jm(r)}static build2(e){let r=e.map(i=>Fr.build8(i));return new jm(r)}static combinePolylineGroupArr(e){let r=[];for(let i of e)r=r.concat(i.items);return new jm(r)}calcBBox(){let e=new pr;for(let r=0;r<this.items.length;r++)e.ext1(this.items[r].bbox());return e.build1()}multiply3(e){let r=new Array(this.items.length);for(let i=0;i<r.length;i++)r[i]=this.items[i].multiply3(e);return new jm(r)}bbox(){return this.__bbox}asClose(){return this.items.forEach(e=>e.asClose()),this}mirrorY(e){return this.items.forEach(r=>r.mirrorY(e)),this}closeEndpoint(){return this.items.forEach(e=>e.closeEndpoint()),this}get primitives(){return this.items.map(e=>e.primitives).flat(2)}isEqual(e){return e instanceof jm?this.items.every(r=>e.items.some(i=>i.isEqual(r))):!1}getOutMostPolyline(){return this.items.reduce((e,r)=>r.bbox().area()>e.bbox().area()?r:e,this.items[0])}getOutline(){let e=this.items;if(e.length===1)return{outline:e,hole:new Array};let r=new Set,i=new Set;for(let n=0,s=e.length;n<s;n++){let a=e[n];if(!r.has(a)&&!i.has(a)){n+1>=s&&r.add(a);for(let o=n+1;o<s;o++){let l=e[o];if(!r.has(l)&&!i.has(l)){if(!a.bbox().isInside(l.bbox().extendOfSize(1e-4))&&!l.bbox().isInside(a.bbox().extendOfSize(1e-4)))continue;gde.isIntersect(new jm([a]),new jm([l]))&&(a.bbox().area()>l.bbox().area()?(r.add(a),i.add(l)):(r.add(l),i.add(a)))}}!r.has(a)&&!i.has(a)&&r.add(a)}}return{outline:[...r],hole:[...i]}}round(e=4){let r=this.items.map(i=>i.round(e));return new jm(r)}},yde=Zc.funcCopy(p1),bde=Zc.funcCopy(p1),xde=Zc.funcCopy(p1);function Ede(t){return new Array}function wde(t,e){let r=new Dv(!1),i=new _v(t,QB.DUMMY,r);for(let n of e)i.addPolyline(n);return i.simplify(),r.plGrps}var _v=class extends OB{constructor(t,e,r){super(new EG(!1),t,e,r),this.finalSides=new Array,this.sideGroups={},this.vecSides=new Array,this.scanY=NaN,this.curNetIndex=0,this.curIndex=-1,this.scanLines=0}sweep(t,e,r){this.scanY=NaN,this.scanLines=0,yde(e,OB.sortByBBoxMinY,0,e.length);let i=new h1;this.curNetIndex=0;let n=Number.POSITIVE_INFINITY;for(let s of t)s>n&&this.scan(i,(n+s)/2,e),n=s;this.getAllMarkPrimitive(r,e),this.logger.debug3("scan %s %d",r,this.scanLines)}simplify(){this.seekIntersection(),this.splitSidesByInters(),this.sweep(this.getSortedEndpointsLineAsc(this.sides),this.sides,!1),this.flipSides(),this.sweep(this.getSortedEndpointsLineAsc(this.vecSides),this.vecSides,!0),this.connectSides(),this.fillResult()}addPolyline(t,e=1,r=.01,i=!0){super.addPolyline(t,e,r,i)}scan(t,e,r){if(this.scanY==e)return;this.scanY=e;let i=!1,n=t.listIterator();for(;n.hasNext();){let s=n.next(),a=s.item;wt.less(a.bbox().maxY,e)?t.remove(s):!i&&a.isNeedScan(e)&&(i=!0)}for(;this.curNetIndex<r.length;){let s=r[this.curNetIndex];if(wt.less(s.bbox().minY,e))wt.greatereq(s.bbox().maxY,e)&&(this.add2AET(t,s),!i&&s.isNeedScan(e)&&(i=!0)),this.curNetIndex++;else break}if(i){this.scanLines++;let s=new wG(this.rule,this,e),a=t.iterator();for(;a.hasNext();){let o=a.next();s.onEp(o)}}}add2AET(t,e){let r=e.bbox().minX,i=e.bbox().maxX,n=e.bbox().minY,s=e.bbox().maxY,a=t.listIterator(),o=null;for(;a.hasNext();){let l,c=a.next(),u=c.item,d=u.bbox().minX,A=u.bbox().maxX;if(i<=d)l=-1;else if(A<=r)l=1;else{let f=u.bbox().minY,p=u.bbox().maxY,m=Math.max(n,f),y=Math.min(s,p);l=this.compareBySweep(e,u,(m+y)/2)}let h=u.shape;if(h instanceof Ee&&h.length()<.001&&o==null&&l<0){o=c;continue}if(o!=null&&l<0){t.insertBefore(o,e);return}if(l<0){t.insertBefore(c,e);return}else o=null}t.add(e)}getLineAngle(t){let e=t.start().angle(t.end());return e<0&&(e+=Math.PI),e}getArcAngle(t,e){let r=Math.asin((e-t.center.y)/t.rx);return t.startAngle>90&&t.startAngle<270&&(r=-r),r<0&&(r+=Math.PI),(r+Math.PI/2)%Math.PI}compareArcLine(t,e,r){let i=this.getArcAngle(t,r),n=this.getLineAngle(e);return wt.eq(i,n)?-t.sweepAngle:n-i}compareBySweep(t,e,r){let i=t.getX(r);if(!isFinite(i))return 0;let n=e.getX(r);if(!isFinite(n))return 0;if(!wt.eq(i,n))return i-n;if(t.shape instanceof Ee)return e.shape instanceof Ee?this.getLineAngle(e.shape)-this.getLineAngle(t.shape):-this.compareArcLine(e.shape,t.shape,r);if(e.shape instanceof Ee)return this.compareArcLine(t.shape,e.shape,r);{let s=t.shape,a=e.shape,o=this.getArcAngle(s,r),l=this.getArcAngle(a,r);return wt.eq(o,l)?s.sweepAngle*a.sweepAngle<=0?s.sweepAngle<=0?1:-1:s.sweepAngle>0?s.rx-a.rx:a.rx-s.rx:l-o}}getAllMarkPrimitive(t,e){for(let r of e)if(r.status===0&&r.bbox().height()!=0){let i=r.voteStatus();if(i===2||i===1){r.status=i;let n=r.reverse(i);if(t){this.event.onResultSide(n);let s=n.shape.multiply3(Ue.ROT_N90),a=n.start.multiply3(Ue.ROT_N90),o=n.end.multiply3(Ue.ROT_N90);n=new Qx(this,s,n.baseWeight,a,o,n.polyGrp,n.polyIndex)}this.finalSides.push(n),this.event.onResultSide(n)}}}flipSides(){for(let t of this.sides)if(t.polyIndex==0){let e=null,r=null;do{let i=t.shape.multiply3(Ue.ROT_90),n=t.start.multiply3(Ue.ROT_90),s=t.end.multiply3(Ue.ROT_90),a=new Qx(this,i,t.baseWeight,n,s,t.polyGrp,t.polyIndex);if(a.outsideWeight=t.outsideWeight,a.insideWeight=t.insideWeight,a.invalidWeight=t.invalidWeight,a.status=t.status,e!=null?(e.next=a,a.previous=e):r=a,this.vecSides.push(a),this.event.onSplitedSide(a),e=a,t.next!==null)t=t.next;else break}while(t.polyIndex!=0);r!=null&&(r.previous=e,e.next=r)}}canBeEnd(t,e){if(t.size()==1){let r=t.getFirst().shape;if(r instanceof ze){if(e&&r.rx<=e)return!1}else if(r instanceof Ee&&e&&r.length()<=e)return!1}return!0}connectSides(){let t=new GB,e=new Lv(10);for(let s of this.finalSides)t.computeIfAbsent(s.start,Ede).push(s),e.add(s.start);let r=0,i=new Vx,n=new Array;for(let s of this.finalSides)if(!i.contains(s)){let a=new Vx,o=s.start,l=new h1;l.add(s),i.add(s);let c=s.end;for(;l.size()>0;)if(this.isStart(o,c)&&this.canBeEnd(l,.01)){l.size()>1&&this.fillSideGroups(l,r++);break}else{let u=t.get(c),d=this.findNext(i,u);if(d==null&&(c=this.findNeigber(c,a,e,.01),c!==null&&(u=t.get(c),d=this.findNext(i,u))),d!=null)l.add(d),i.add(d),c=d.end;else if(c!=null?a.add(c):(n.length==0&&l.size()>1&&this.logger.warning3("unable to connect at %s",l.getLast()),n.push(l.removeLast())),l.size()>0)c=l.getLast().end;else break}}}fillSideGroups(t,e){let r=new fde(e);Yx(t,(i,n)=>(r.add(n),!0)),this.sideGroups[r.id]=r}isStart(t,e){return t.distance2(e)<=1e-4}findNext(t,e){if(e!=null){for(let r of e)if(!t.contains(r))return r}return null}fillResult(){let t=0,e=new GB;for(let i in this.sideGroups){let n=this.sideGroups[i];Yx(n.sides,(s,a)=>(a.polyGrp!=-2&&e.put(a,a),!0))}let r=new Vx;for(let i in this.sideGroups){let n=this.sideGroups[i];if(r.add(n)){let s=0,a=new Array;for(a.push(n);s<a.length;){let l=a[s],c=new Array;Yx(l.others,(d,A)=>{let h=e.get(A);return h!=null&&c.push(h.finalGrp),!0}),bde(c,Zc.sortAsc,0,c.length);let u=l.id;for(let d of c)if(d!=u&&d!=l.id){let A=this.sideGroups[d];r.add(A)&&a.push(A),u=d}s++}let o=new Array;for(let l of a)o.push(l.polyline());xde(o,OB.sortByBBoxAreaDesc,0,o.length),this.event.onPolylineGroup(new Ws(o),t++)}}}findNeigber(t,e,r,i){let n=i*i,s=Number.MAX_VALUE,a=null;for(let o of r.search(t.bbox().extendOfSize(i)))if(!e.contains(o)){let l=t.distance2(o);l<s&&(s=l,a=o)}return s<n?a:null}},vde=class{constructor(){this.points=[],this.lines=[],this.arcs=[],this.beziers=[],this.listText=[],this.fonts=[]}addPt(t,e=!0){if(t instanceof Ee)this.lines.push(t);else if(t instanceof ze)this.arcs.push(t);else if(t instanceof Nt)this.beziers.push(t);else throw new Error("not support");e&&this.points.push(t.start())}addPoint(t){this.points.push(t)}addText(t,e,r=1,i=.1,n=!0){this.listText.push({pos:t,str:e,size:r,width:i}),n&&this.points.push(t)}addPly(t,e=!0){t.primitives.forEach(r=>this.addPt(r,e))}build(){let t=[],e=[],r=[],i=[],n=[],s=[];return this.points.forEach(a=>t.push(a.x,a.y)),this.lines.forEach(a=>e.push(a.start().x,a.start().y,a.end().x,a.end().y)),this.arcs.forEach(a=>r.push(a.center.x,a.center.y,a.rx,Ti.toRadians(a.startAngle),Ti.toRadians(a.endAngle()),a.sweep())),this.beziers.forEach(a=>{a.controls.forEach(o=>{i.push(o.x,o.y)}),i.push("end")}),this.listText.forEach(a=>n.push(a.pos.x,a.pos.y,a.str,a.width,a.size)),this.fonts.forEach(a=>s.push(a)),{points:t,lines:e,arcs:r,texts:n,beziers:i,fonts:s}}},S0,Mv=(S0=class{constructor(e){this.map=new GB,this.bus=e}initColor(e){return this.map.computeIfAbsent(e,()=>new vde)}draw(){let e={},r=this.map.entries();for(;r.hasNext();){let i=r.next();e[i.key.toString()]=i.value.build()}this.bus.publish("/debug/draw",e)}clear(){this.map.clear()}static init(e){if(!e)throw new Error("bus is undefined!");this.palette=new S0(e)}static initPalette(e){this.palette=e}static getDefaultColor(){for(let e of this.colorBuffersMap)if(e[0]!==null&&e[0])return e[0]=!1,e[1];return this.colorBuffersMap.forEach(e=>{if(e[0]===null){console.log(1);return}e[0]=!0}),this.getDefaultColor()}static clear(){this.palette.clear()}static auto(e,r=this.getDefaultColor()){if(Array.isArray(e))e.forEach(i=>{this.auto(i,r)});else if(e instanceof ne)this.point(e,r);else if(e instanceof Mr)this.bbox(e,r);else if(e instanceof Nv)this.primitive(e,r);else if(e instanceof Fr)this.polyline(e,r);else if(e instanceof va)this.polygon(e,r);else if(e instanceof Ga)this.group(e,r);else if(e instanceof Ws)this.auto(e.items,r);else{debugger;throw new Error("No incoming type!")}}static text(e,r,i=.5,n=this.getDefaultColor()){if(!this.palette)throw new Error("palette  is not initialised!");this.palette.initColor(n).addText(e,r,i,i/10),this.palette.draw()}static point(e,r=this.getDefaultColor()){if(!this.palette)throw new Error("palette  is not initialised!");let i=this.palette.initColor(r);Array.isArray(e)?e.forEach(n=>{this.point(n,r)}):i.addPoint(e),this.palette.draw()}static bbox(e,r=this.getDefaultColor()){Array.isArray(e)?e.forEach(i=>{this.bbox(i,r)}):(this.primitive(new Ee(new ne(e.maxX,e.maxY),new ne(e.maxX,e.minY)),r),this.primitive(new Ee(new ne(e.maxX,e.maxY),new ne(e.minX,e.maxY)),r),this.primitive(new Ee(new ne(e.minX,e.minY),new ne(e.maxX,e.minY)),r),this.primitive(new Ee(new ne(e.minX,e.minY),new ne(e.minX,e.maxY)),r))}static primitive(e,r=this.getDefaultColor()){if(!this.palette)throw new Error("palette  is not initialised!");let i=this.palette.initColor(r);Array.isArray(e)?e.forEach(n=>{this.primitive(n,r)}):i.addPt(e),this.palette.draw()}static polyline(e,r=this.getDefaultColor()){Array.isArray(e)?e.forEach(i=>{this.polyline(i,r)}):e.primitives.forEach(i=>{this.primitive(i,r)})}static polygon(e,r=this.getDefaultColor()){Array.isArray(e)?e.forEach(i=>{this.polygon(i,r)}):e.items.forEach(i=>{this.polyline(i,r)})}static group(e,r=this.getDefaultColor()){Array.isArray(e)?e.forEach(i=>{this.group(i,r)}):e.items.forEach(i=>{this.polygon(i,r)})}static async begin(){this.t1=performance.now()}static async end(e){console.log(e||"t1:",performance.now()-this.t1)}static async log(e){console.log(e||"==================")}},S0.colorBuffersMap=[[!0,Qn.BLUE],[!0,Qn.GREEN],[!0,Qn.WHITE],[!0,Qn.RED],[!0,Qn.Golden],[!0,Qn.Gray]],S0.t1=0,S0),Cde=0,kv=class NR{constructor(e,r){this.inters=[],this.shape=e,this.start=e.start(),this.end=e.end(),this.judgeOverlapMap=new Map,r&&(this.id=Cde++)}reverse(){this.shape=this.shape.reverse();let e=this.start;this.start=this.end,this.end=e}getCenterPoint(e=this.end){let{x:r,y:i}=this.start,{x:n,y:s}=e;if(this.shape instanceof ze){let a=this.shape.rx,o=new ne((r+n)/2,(i+s)/2),l=this.shape.center,c;return o.x!==l.x||o.y!==l.y?(c=o.angle(l),Math.abs(this.shape.sweepAngle)>180&&(c+=c>=0?-180:180)):c=(this.shape.startAngle+this.shape.endAngle())/2,new ne(l.x+Math.cos(c)*a,l.y+Math.sin(c)*a)}else{if(this.shape instanceof Ee)return new ne((r+n)/2,(i+s)/2);if(this.shape instanceof Nt){let a=this.shape.getPercent(e,li);return Nt.pointOn(a/2,this.shape.controls)}else throw Error("not support")}}static finalAngle(e,r,i){let n=e.cross(r)>0,s=Math.acos(Math.min(1,Math.max(-1,e.dot(r)/r.length())));return(i?!n:n)&&(s=zB-s),s}sortInters(){if(this.shape instanceof ze){let e=this.shape.center,r=this.shape.start().sub(e).normalize(),i=this.shape.isCCW;this.inters.sort((n,s)=>{let a=n.coord.sub(e),o=s.coord.sub(e);return NR.finalAngle(r,a,i)-NR.finalAngle(r,o,i)<=0?-1:1})}else if(this.shape instanceof Ee){let e=this.start,r=this.end,i=new ne(r.x+(e.x-r.x)*2,r.y+(e.y-r.y)*2);this.inters.sort((n,s)=>n.coord.distance2(i)-s.coord.distance2(i)<=0?-1:1)}else if(this.shape instanceof Nt){let e=this.shape;this.inters.sort((r,i)=>e.getPercent(r.coord,li)-e.getPercent(i.coord,li)<=0?-1:1)}else throw Error("not support the primitive type");this.inters.forEach((e,r)=>e.setIndex(r))}getStart(){return this.start}getEnd(){return this.end}getShape(){return this.shape}connect(e){this.nextSide=e,e.prevSide=this}static returnPolygonList(e){let r=[];return e.forEach(i=>{let n=[];i.forEach((s,a)=>{let o=[];s.forEach(l=>{o.push(l.shape)}),n.push(Fr.build7(o))}),r.push(new va(n))}),r}addInter(e){this.inters.push(e)}static returnPolygonGroup(e){let r=[];return e.forEach(i=>{let n=[];i.forEach((s,a)=>{let o=[];s.forEach(l=>{o.push(l.shape)}),n.push(Fr.build7(o))}),r.push(new va(n))}),new Ga(r)}static rebuild(e,r,i){let n;if(e instanceof Ee||r.distance2(i)<1e-6)n=new Ee(r,i);else if(e instanceof ze)n=ze.build2(e.center,r.angleD(e.center),i.angleD(e.center),e.rx,e.ry,e.isCCW?1:0);else if(e instanceof Nt){let s=e.getPercent(r,li),a=e.clip(s)[1];n=a.clip(a.getPercent(i,li))[0]}else throw new Error("not supported operation");return oi(e,r).dot(oi(n,r))<0?null:n}static returnPolyline(e){return Fr.build7(e.map(r=>r.shape))}bbox(){return this.shape.bbox()}},Sde=(t=>(t[t.END1=0]="END1",t[t.END2=1]="END2",t[t.END12=2]="END12",t[t.LEFT1=3]="LEFT1",t[t.LEFT2=4]="LEFT2",t))(Sde||{});function eu(t,e,r){if(t instanceof ze&&e instanceof ze)return Bde(t,e);if(t instanceof ze&&e instanceof Ee)return eG(t,e);if(t instanceof Ee&&e instanceof ze)return ZH(t,e);if(t instanceof Ee&&e instanceof Ee)return d1(t,e);if(t instanceof Nt&&e instanceof Ee)return t.controls.length===2||qm(t)?d1(new Ee(t.start(),t.end()),e):CG(t,e);if(t instanceof Ee&&e instanceof Nt)return e.controls.length===2||qm(e)?d1(t,new Ee(e.start(),e.end())):RR(t,e);if(t instanceof ze&&e instanceof Nt)return e.controls.length===2||qm(e)?eG(t,new Ee(e.start(),e.end())):Tde(t,e);if(t instanceof Nt&&e instanceof ze)return t.controls.length===2||qm(t)?ZH(new Ee(t.start(),t.end()),e):Ide(t,e);if(t instanceof Nt&&e instanceof Nt)return jR(t,e);throw new Error("not support")}function Ox(t,e){return oi(t,e.start()).dot(oi(e,e.start()))<=0?!1:eu(t,e).state<=2}function wR(t,e){let r=e.getPercent(t.end(),li);if(r===null)return!1;if(r===0)return!0;let i=e.clip(r)[0],n=t.buildConverxHull(li),s=i.buildConverxHull(li),a=c(n),o=c(s);return l(a,o);function l(u,d){let A=new Map([[0,1],[1,0],[2,2],[3,4],[4,3]]),h=u[0],f=d[0];if(!h||!f)throw Error("isAllOverlap(sides1: PackSide[], sides2: PackSide[])");let p=!0;do{let m=h.getShape(),y=f.getShape();if(m instanceof Ee&&y instanceof Ee){let g=p?d1(m,y).state:A.get(d1(y,m).state);if(g===0)h=h.nextSide,p=!1;else if(g===1)f=f.nextSide,p=!0;else if(g===2)h=h.nextSide,f=f.nextSide,p=!0;else return!1}else throw Error("not support")}while(h!==u[0].prevSide&&f!==d[0].prevSide);return!0}function c(u){let d=u.primitives.map(h=>new kv(h)),A=d[d.length-1];return d.forEach(h=>{A.connect(h),A=h}),d}}function $H(t,e){let r=t.end().distance2(e.center);if(r>(e.rx+li)**2||r<(e.rx-li)**2||!(Vr(t.end(),e.end())||QR(e,t.end())))return!1;if(t.center.equals1(e.center))return!0;let i=t.center.distance1(e.center),n=Math.abs(t.rx-e.rx);if(i>Math.min(t.rx,e.rx)){let s=t.center.angleD(e.center);return t.rx>e.rx?!(i+n>li&&Mp(t,s))&&!(i-n>li&&t.rx+e.rx-i>li&&Mp(t,s+180)):!(i-n>li&&Mp(t,s))&&!(t.rx+e.rx-i>li&&Mp(t,s+180))}else{if(i+n<=li)return!0;let s=t.rx>e.rx?t.center.angleD(e.center):e.center.angleD(t.center);return Mp(t,s)?!1:i-n<=li?!0:!Mp(t,s+180)}}function Tde(t,e){let r=zR(t,e.start()).toBezier2(),i,n=0;for(let s=r.length;n<s;n++){let a=r[n];if(i=jR(a,e).state,i!==0)break}return i===2&&n!==r.length-1?{state:1}:{state:i}}function Ide(t,e){let r=e.toBezier2(),i,n=0;for(let s=r.length;n<s;n++){let a=r[n];if(i=jR(t,a).state,i!==1)break}return i===2&&n!==r.length-1?{state:0}:{state:i}}function jR(t,e){if(t.controls.length===2||qm(t))return e.controls.length===2||qm(e)?d1(new Ee(t.start(),e.end()),new Ee(e.start(),e.end())):RR(new Ee(e.start(),t.end()),e);if(e.controls.length===2||qm(e))return CG(MR(t,e.start()),new Ee(e.start(),e.end()));let r=MR(t,e.start());if(qm(r))return RR(new Ee(e.start(),t.end()),e);let i=wR(r,e),n=wR(e,r);if(!i&&!n){let s=Vhe(r,e);if(s.havOverlap){let a=s.havOverlap!==2,o=s.havOverlap!==1;return Jm(t,e,a,o)}else{let a=function(){for(let d=0;d<c;d+=2)Be[d]=u[d],Be[d+1]=u[d+1]},o,l,c=s.cnt,u=new Array(c).fill(0).map((d,A)=>Be[A]);for(let d=0;d<c;d+=2){let A=new ne(Be[d],Be[d+1]),h=r.getPercent(A,li),f=e.getPercent(A,li);if(h===0||f===0)continue;let p=h===1?r:r.clip(h)[0],m=f===1?e:e.clip(f)[0];if(wR(p,m)){let y=oi(t,A).cross(oi(e,A));if(y===0){o=r.end(),l=e.end();break}return{state:y<0?3:4}}a()}return(!o||!l)&&(o=Gx(r.controls,r.controls[0],e),l=Gx(e.controls,r.controls[0],r)),{state:o.sub(r.controls[0]).cross(l.sub(r.controls[0]))>0?4:3}}}return Jm(t,e,i,n)}function CG(t,e){let r=MR(t,e.start());if(qm(r))return d1(new Ee(r.start(),r.end()),e);let i=TG(r,e),{isIn:n,bezierIsInLeft:s}=SG(e,r);if(!i&&!n){if(s!==void 0)return{state:s?3:4};let a=null,o=t.getPercent(e.start(),li)+.01;for(let l=o>1?1:o;l<=1;){let c=Nt.pointOn(l,t.controls);if(Ov(e,c)>tu){a=c;break}l+=.01,l>1&&(l=1)}if(!a)throw Error("!end1 && !end2 not result");return{state:e.direct.cross(a.sub(e.start()))<0?4:3}}return Jm(r,e,i,n)}function RR(t,e){let{isIn:r,bezierIsInLeft:i}=SG(t,e),n=TG(e,t);if(!r&&!n){if(i!==void 0)return{state:i?4:3};let s=null;for(let a=.01;a<=1;){let o=Nt.pointOn(a,e.controls);if(Ov(t,o)>tu){s=o;break}a+=.01,a>1&&(a=1)}if(!s)throw Error("!end1 && !end2 not result");return{state:t.direct.cross(s.sub(t.start()))<0?3:4}}return Jm(e,t,r,n)}function Bde(t,e){let r=$H(zR(t,e.start()),e),i=$H(e,t);if(!r&&!i){let n=_f(e);if(t.center.sub(e.start()).dot(e.center.sub(e.start()))>0){if(t.rx===e.rx)return t.isCCW?{state:n.dot(t.center.sub(e.center))<0?3:4,exitIsInvalid:!1}:{state:n.dot(t.center.sub(e.center))>0?3:4,exitIsInvalid:!1};let s,a;return t.rx>e.rx?(s=t,a=e):(s=e,a=t),n.dot(a.center.sub(s.center))>0&&a.rx+a.center.distance1(s.center)-s.rx>li?t.isCCW?{state:t.rx>e.rx?3:4,exitIsInvalid:!1}:{state:t.rx<e.rx?3:4,exitIsInvalid:!1}:t.isCCW?{state:t.rx<e.rx?3:4,exitIsInvalid:!0}:{state:t.rx>e.rx?3:4,exitIsInvalid:!0}}else return t.rx+e.rx-t.center.distance1(e.center)>li&&n.dot(t.center.sub(e.center))>0?{state:e.isCCW?3:4,exitIsInvalid:!1}:{state:t.isCCW?3:4,exitIsInvalid:!0}}return Jm(t,e,r,i)}function ZH(t,e){let r=Df.foot(t,e.center),i=t.end().distance2(e.center),n=t.end().sub(t.start()),s=(e.rx-li)**2,a=i<=(e.rx+li)**2&&i>=s&&(n.dot(r.sub(e.start()))<=0||t.start().distance2(t.end())<=t.start().distance2(r)||r.distance2(e.center)>=s)&&(Vr(t.end(),e.end())||QR(e,t.end())),o=IG(e,t);if(!a&&!o){let l=t.distance2(e.center);return l<=tu?{state:n.cross(_f(e))>0?4:3}:n.dot(r.sub(e.start()))>=0&&(i<s||t.start().distance2(e.center)<s||l<s)?{state:n.cross(e.center.sub(t.start()))<0?4:3}:{state:n.cross(e.center.sub(t.start()))>0?4:3}}return Jm(e,t,a,o)}function Mp(t,e){return e=Ti.regularD(e),t.sweepAngle>0?(e<t.startAngle&&(e+=360),t.endAngle()>e):(e>t.startAngle&&(e-=360),t.endAngle()<e)}function QR(t,e){return Vr(t.end(),e)||Vr(t.start(),e)||Mp(t,e.angleD(t.center))}function SG(t,e){let r=t.panDistance(li),i=t.panDistance(-li),n=tG(e,r),s=tG(e,i);if(!n.length&&!s.length)return{isIn:e.getPercent(t.end(),li)!==null};let a=[...n,...s].sort((u,d)=>u.t-d.t),o=new Ee(i.start(),r.start()),l=[];for(let u=0,d=a.length;u<d;u++){let A=a[u];if(l.push(A),o.distance(A.interP)>t.length()+li)break;if(l.length===2){let h=(l[1].t*10+l.shift().t*10)/20,f=Nt.pointOn(h,e.controls);if(t.distance2(f)>tu)return{isIn:!1,bezierIsInLeft:t.direct.cross(f.sub(t.start()))>0}}}let c=l.length?o.distance(l[0].interP)>=t.length()+li:!0;return{isIn:c,bezierIsInLeft:c?void 0:t.direct.cross(l[0].interP.sub(t.start()))>0}}function TG(t,e){if(Ov(e,t.end())>tu||t.getToLineMaxDis2(e)>tu)return!1;let r=_de(e,tu);return t.getToLineMaxDis2(r)<=(e.length()+li)**2}function IG(t,e){let r=e.end().angleD(e.start()),i=Dde(e,t.end());if(i>tu)return!1;if(Mp(t,r+90)){if(Df.foot(e,t.center).distance1(t.pointOn(r+90))>t.rx)return!1;i=Math.max(i,(t.rx-e.distance(t.center))**2)}if(Mp(t,r-90)){if(Df.foot(e,t.center).distance1(t.pointOn(r-90))>t.rx)return!1;i=Math.max(i,(t.rx-e.distance(t.center))**2)}return i<=tu&&(Vr(t.end(),e.end())||kR(e,t.end()))}var BG=(li*2)**2;function zR(t,e){if(Vr(t.end(),e))return ze.build3(t.center,t.endAngle(),0,t.rx,t.ry);if(t.start().distance2(e)<BG)return t;let r=Ti.regularD(e.angleD(t.center));if(!Mp(t,r))throw new Error("!angleIsInArc(arc, angle)");return ze.build2(t.center,r,t.endAngle(),t.rx,t.ry,t.isCCW?1:0)}function MR(t,e){if(Vr(t.end(),e))return new Nt([e,e]);if(t.start().distance2(e)<BG)return t;let r=t.getPercent(e,li);if(r===null)throw new Error("!cutBezier(bezier: Bezier, p: Vector2)");return t.clip(r)[1]}function eG(t,e){let r=IG(zR(t,e.start()),e),i=e.end().distance2(t.center),n=e.end().sub(e.start()),s=Df.foot(e,t.center),a=(t.rx-li)**2,o=i<=(t.rx+li)**2&&i>=a&&(n.dot(s.sub(e.start()))<=0||e.start().distance2(e.end())<=e.start().distance2(s)||s.distance2(t.center)>=a)&&(Vr(t.end(),e.end())||QR(t,e.end()));if(!r&&!o){let l=e.distance2(t.center);return l<=tu?{state:n.cross(_f(t,e.start().angle(t.center)))>0?3:4}:n.dot(s.sub(e.start()))>=0&&(i<a||e.start().distance2(t.center)<a||l<a)?{state:n.cross(t.center.sub(e.start()))>0?4:3}:{state:n.cross(t.center.sub(e.start()))<0?4:3}}return Jm(e,t,r,o)}function d1(t,e){if(Vr(t.end(),e.end()))return Jm(t,e,!0,!0);let r=Ov(e,t.end())<=tu&&kR(e,t.end()),i=Ov(t,e.end())<=tu&&kR(t,e.end());if(!r&&!i){let n=t.direct.x===0&&t.direct.y===0,s=e.direct.x===0&&e.direct.y===0;if(n&&s)throw Error("2LineAllIsPoint");return n?{state:e.direct.cross(t.end().sub(e.start()))>0?3:4}:{state:t.end().sub(t.start()).cross(e.end().sub(t.start()))>0?4:3}}return Jm(t,e,r,i)}function kR(t,e){return Df.foot(t,e).distance2(t.start())<t.end().distance2(t.start())}function Jm(t,e,r,i){if(r)return i?Vr(t.end(),e.end())?{state:2}:{state:0}:{state:0};if(i)return{state:1};throw new Error("!end1 && !end2")}function Ov(t,e){return(t.a*e.x+t.b*e.y+t.c)**2/(t.a**2+t.b**2)}function Dde(t,e){return Math.min(t.distance2(e),Df.foot(t,e).distance2(e))}function _de(t,e){let r=t.panDistance(e),i=t.panDistance(-e);return new Ee(i.start(),r.start())}function qm(t){let e=t.start(),r=t.end();e.equals1(r)&&(r=e.add1(1,0));let i=r.y-e.y,n=e.x-r.x,s=-i*e.x-n*e.y,a=Math.sqrt(1/(i**2+n**2));i*=a,n*=a,s*=a;let o=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;return t.controls.forEach(c=>{let u=i*c.x+n*c.y+s;u<o&&(o=u),u>l&&(l=u)}),Gp(o,l)}function tG(t,e){let r=wA(t,e),i=[],n=new Array(r).fill(0).map((a,o)=>Be[o]);for(let a=0;a<r;a+=2){let o=new ne(Be[a],Be[a+1]),l=t.getPercent(o);i.push({interP:o,t:l}),s()}function s(){for(let a=0;a<r;a+=2)Be[a]=n[a],Be[a+1]=n[a+1]}return i}var Rp=.01,Pde=270;function Pf(t){let e=Rp**2,r=t.end(),i=[],n=[];for(let h=0,f=t.primitives.length;h<f;h++){let p=function(U,_){return U instanceof Ee&&_ instanceof Ee&&Math.abs(U.direct.cross(_.direct))<wt.eps&&U.direct.dot(_.direct)>0||U instanceof ze&&_ instanceof ze&&Math.abs(U.rx-_.rx)<=wt.eps&&U.center.distance2(_.center)<wt.eps&&U.isCCW===_.isCCW},m=function(U){if(Md(U,Rp))n.push(null);else{if(U instanceof Ee)n.push(U);else if(U instanceof ze&&U.rx===U.ry)d(U,n);else if(U instanceof Nt){let _=[];XB(U,_),_.forEach(H=>{let Q=H.start(),j=H.end();u(Q,j)||n.push(H)})}else throw new Error("not support!");r=E}},y=function(U){if(U instanceof Ee)return U.direct.x===0&&U.direct.y===0;if(U instanceof ze)return U.sweepAngle===0;if(U instanceof Nt){let _=new Set(U.controls.map(Q=>Q.x)),H=new Set(U.controls.map(Q=>Q.y));return _.size===1&&H.size===1}else throw new Error("not support")},g=t.primitives[h],b=g.start(),E=g.end();if(y(g))continue;u(r,b)||(n.push(new Ee(r,b)),r=b);let w=(h+1)%f,x=t.primitives[w];for(;p(g,x)&&(w=(w+1)%f,x=t.primitives[w],x!==g););if(w===(h+1)%f){m(g);continue}if(x===g){if(!(g instanceof ze)){if(Math.abs(t.area(.1))<e)return null;throw new Error("simplifyPolyline not support")}let U=g instanceof ze?g.isCCW:t.area(.1)>0;n.length=0;let _=U?180:-180;n.push(ze.build3(g.center,g.startAngle,_,g.rx,g.ry),ze.build3(g.center,g.startAngle+_,_,g.rx,g.ry));break}let I=(()=>{if(g instanceof Ee)return(U,_)=>{let H=new Ee(U,_);return Md(H,Rp)?null:[H]};if(g instanceof ze)return(U,_)=>{let H;if(U.equals1(_)?H=ze.build3(g.center,g.startAngle,g.sweep()===1?360:-360,g.rx,g.ry):H=ze.build4(U,_,g.center,g.rx,g.ry,g.sweep()),Md(H,Rp))return null;let Q=H.pointOn(H.startAngle+H.sweepAngle/2),j=ze.build4(H.start(),Q,g.center,g.rx,g.ry,g.sweep()),$=ze.build4(Q,H.end(),g.center,g.rx,g.ry,g.sweep());return Md(j,Rp)||Md($,Rp)?[H]:[j,$]};throw new Error("not support")})(),C=w===0;if(w<h&&!C&&(C=!I(t.primitives[0].start(),t.primitives[w-1].end()),!C)){let U=I(g.start(),t.primitives[f-1].end());if(U)n.push(...U);else{let _=I(g.start(),n[0].end());if(_.length===1)n[0]=_[0];else if(_.length===2)n[0]=_[1],n.push(_[0]);else throw new Error("!!!generatorPt")}break}h=w===0?f-1:w-1,x=t.primitives[h];let G=I(g.start(),x.end());if(G?(G.forEach(U=>n.push(U)),r=x.end()):m(null),C)break}let s=n.length;if(n.forEach((h,f)=>{if(h)i.push(h);else{let p,m;f===s-1&&(p=i[0],m=i[i.length-1]);let y=(f+1)%s;if(p=p!=null?p:n[y],p){let g=f,b=!1;for(;m=m!=null?m:n[(--g+s)%s],m!==p;)if(m){b=!0;break}if(b){if(p.start().equals1(m.end()))return;if(oi(m,m.end()).dot(oi(p,p.start()))<0){if(!u(m.end(),p.start())){let I=new Ee(m.end(),p.start());i.push(I);return}let{rebuildPrevPt:E,rebuildNextPt:w,rebuildLinkLine:x}=rG(n[(g-1+s)%s],m,new Ee(m.end(),p.start()),p,n[(f+2)%s]);E&&w&&(E!==m?(n[(g+s)%s]=E,i[i.length-1]&&(i[i.length-1]=E)):w!==p&&(n[(f+1)%s]=w,i[0]===p&&(i[0]=w)),x&&i.push(x))}}}}}),i.length===0)return null;u(r,i[0].start())||i.push(new Ee(r,i[0].start()));let a=i[i.length-1];if(i.length===1)return a instanceof ze?Fr.build7([ze.build2(a.center,0,180,a.rx,a.ry,a.sweep()),ze.build2(a.center,180,360,a.rx,a.ry,a.sweep())]):a instanceof Nt?Fr.build7(a.clip(.5)):null;let o=i.map(h=>new Lde(h)),l=o[o.length-1];for(o.forEach(h=>{h.connect(l),l=h});!l.isVisited;){let h=function(){l.next.connect(p),l=l.next,l.isConnected=!1,l.isVisited=!1},f=function(){l.connect(p.prev),l.isConnected=!1},p=l.prev;if(l===p)break;let m=l.pt,y=p.pt,g=y.end();if(!l.isConnected&&!g.equals(m.start())){let b=function(w){l.isConnected=!0,l.pt=m=w,l.next.isVisited=!1},E=function(w){l.isConnected=!0,p.pt=w,p.isVisited=!1,l=p};if(m instanceof Ee)if(u(g,m.end())){h();continue}else b(new Ee(g,m.end()));else if(y instanceof Ee){u(y.start(),m.start())?f():E(new Ee(y.start(),m.start()));continue}else if(m instanceof Nt)if(u(g,m.end())&&!(m.controls.length!==2&&m.getToLineMaxDis2(m.startToEndL)>=e)){h();continue}else b(new Nt([g,...m.controls.slice(1)]));else if(y instanceof Nt)u(y.start(),m.start())&&!(y.controls.length!==2&&y.getToLineMaxDis2(y.startToEndL)>=e)?f():E(new Nt([...y.controls.slice(0,-1),m.start()]));else if(m instanceof ze&&y instanceof ze)if(Math.abs(Math.abs(m.sweepAngle)-180)<Math.abs(Math.abs(y.sweepAngle)-180)){let w=ze.build5(g,m.end(),m.sweepAngle);if(u(w.start(),w.end())&&!(w.rx>=Rp&&Math.abs(w.sweepAngle)>180)){h();continue}else b(w)}else{let w=ze.build5(y.start(),m.start(),y.sweepAngle);u(w.start(),w.end())&&!(w.rx>=Rp&&Math.abs(w.sweepAngle)>180)?f():E(w);continue}else throw new Error("not support")}if(oi(m,m.start()).dot(oi(y,y.end()))<0){let b=function(x,I,C,G,U,_){if(l.next===p){l=null;return}let{rebuildLinkLine:H,rebuildPrevPt:Q,rebuildNextPt:j}=rG(x,I,C,G,U);Q&&j&&(Q!==I&&(p.prev.pt=Q),j!==G&&(l.next.pt=j),H?_.pt=H:h())},E=function(){l.next===p?l=null:(l.next.connect(p.prev),l=l.next,l.isConnected=!1,l.isVisited=!1)},w=eu(y.reverse(),m).state;if(w===0){let x=iG(m,y.start(),m.end());if(A(x)){let I=p.prev.pt,C=l.next.pt;if(oi(C,C.start()).dot(oi(I,I.end()))>=0){if(E(),!l)break;continue}if(b(p.prev.prev.pt,I,x instanceof Ee?x:new Ee(x.start(),x.end()),C,l.next.next.pt,l),!l)break}else l.pt=x;f();continue}else if(w===1){let x=iG(y,y.start(),m.end());if(A(x)){let I=p.prev.pt,C=l.next.pt;if(oi(C,C.start()).dot(oi(I,I.end()))>=0){if(E(),!l)break;continue}if(b(p.prev.prev.pt,I,x instanceof Ee?x:new Ee(x.start(),x.end()),C,l.next.next.pt,p),!l)break}else p.pt=x;h();continue}else if(w===2){if(E(),!l)break;continue}}l.isVisited=!0,l=l.next}if(!l)return null;i.length=0;let c=l;for(i.push(l.pt),l=l.next;l!==c;)i.push(l.pt),l=l.next;if(i.length===1){let h=i[0];return h instanceof ze?(u(h.start(),h.end())?i[0]=ze.buildCircle(h.center,h.rx,h.sweep()):i.push(new Ee(h.end(),h.start())),Fr.build7(i)):h instanceof Nt?(u(h.start(),h.end())||i.push(new Ee(h.end(),h.start())),Fr.build7(i)):null}if(t=Fr.build7(i),Math.abs(t.area(.1))<e)return null;return t;function u(h,f){return h.distance2(f)<e}function d(h,f){if(Math.abs(h.sweepAngle)>Pde){let p=h.sweepAngle/2;d(ze.build3(h.center,h.startAngle,p,h.rx,h.ry),f),d(ze.build3(h.center,h.startAngle+p,p,h.rx,h.ry),f)}else f.push(h)}function A(h){return h.start().distance2(h.end())<e&&!(h instanceof ze&&h.rx>=Rp&&Math.abs(h.sweepAngle)>180||h instanceof Nt&&h.controls.length!==2&&h.getToLineMaxDis2(new Ee(h.start().add1(1,0),h.end()))>=e)}}function Md(t,e){if(!t)return!0;let r=t.start(),i=t.end();if(r.distance2(i)<e**2)if(t instanceof ze){if(!(t.rx>=e&&Math.abs(t.sweepAngle)>180))return!0}else if(t instanceof Nt){if(!(t.controls.length!==2&&t.getToLineMaxDis2(new Ee(t.start().add1(1,0),t.end()))>=e))return!0}else return!0;return!1}function Nx(t){if(t.direct.x===0&&t.direct.y===0)throw Error("getEndOfExtendLine(line: Line, distance: number)");let e=Math.abs(Rp-t.length())+wt.eps,r={x:t.direct.normalize().x*e,y:t.direct.normalize().y*e},i=t.end();return new ne(i.x+r.x,i.y+r.y)}function rG(t,e,r,i,n){if(!t)a();else if(!n)o();else{let l=oi(t,t.end()),c=oi(e,t.end()),u=l.dot(c);if(u>=0)a();else{let d=oi(i,i.end()),A=oi(n,i.end()),h=d.dot(A);if(h>=0)o();else if(Gp(u,-1)&&Gp(h,-1)){let f=r.center();s(f),r=null}else u>h?a():o()}}function s(l){let c;if(e instanceof Ee)c=new Ee(e.start(),l);else if(e instanceof Nt)c=new Nt([...e.controls.slice(0,-1),l]);else if(e instanceof ze)c=ze.build5(e.start(),l,e.sweepAngle);else throw new Error("not supported");e=Md(c,li)?null:c;let u;if(i instanceof Ee)u=new Ee(l,i.end());else if(i instanceof Nt)u=new Nt([l,...i.controls.slice(1)]);else if(i instanceof ze)u=ze.build5(l,i.end(),i.sweepAngle);else throw new Error("supported");i=Md(u,li)?null:u}function a(){if(e instanceof Ee){let l=Nx(r.reverse());r=new Ee(l,r.end());let c=new Ee(e.start(),l);e=Md(c,li)?null:c}else if(e instanceof Nt){let l=Nx(r.reverse());r=new Ee(l,r.end());let c=new Nt([...e.controls.slice(0,-1),l]);e=Md(c,li)?null:c}else if(e instanceof ze){let l=Nx(r.reverse());r=new Ee(l,r.end());let c=ze.build5(e.start(),l,e.sweepAngle);e=Md(c,li)?null:c}else throw new Error("not supported")}function o(){if(i instanceof Ee){let l=Nx(r);r=new Ee(r.start(),l);let c=new Ee(l,i.end());i=Md(c,li)?null:c}else if(i instanceof Nt){let l=Nx(r);r=new Ee(r.start(),l);let c=new Nt([l,...i.controls.slice(1)]);i=Md(c,li)?null:c}else if(i instanceof ze){let l=Nx(r);r=new Ee(r.start(),l);let c=ze.build5(l,i.end(),i.sweepAngle);i=Md(c,li)?null:c}else throw new Error("not supported")}return{rebuildPrevPt:e,rebuildNextPt:i,rebuildLinkLine:r}}function iG(t,e,r){if(t instanceof Ee||e.distance2(r)<=tu)return new Ee(e,r);if(t instanceof ze)return ze.build2(t.center,e.angleD(t.center),r.angleD(t.center),t.rx,t.ry,t.isCCW?1:0);if(t instanceof Nt){let i=t.getPercent(e,li),n=t.getPercent(r,li);return t.clip(i)[1].clip((n-i)/(1-i))[0]}else throw new Error("not supported operation")}var Lde=class{constructor(t){this.pt=t}connect(t){this.prev=t,t.next=this}};function VB(t){let e=y1(),r;if(t instanceof Fr){let i=Pf(t);if(i===null)return null;r=i}else if(t instanceof va){let i=t.items.map(n=>VB(n)).filter(n=>n!==null);if(i.length===0)return null;r=new va(i)}else{let i=t.items.map(n=>VB(n)).filter(n=>n!==null);if(i.length===0)return null;r=new Ga(i)}return vA.preprocessPolyline+=Up(e),r}var vA={addDocShapes2RTree:0,getPour:0,prepare:0,getSinglePourLayerPolyline:0,combindOutlines:0,mergeSameNet:0,run:0,end:0,deSelfIntersection:0,changeDirect:0,extend:0,preprocessPolyline:0,runBoolean:0,IntersectionSeeker:0,BooleanTools:0,totalBool:0};function y1(){return{timeIndex:Object.assign({},vA),start:performance.now()}}function nG(t){return Object.values(t).reduce((e,r)=>e+r,0)}function Up(t){return performance.now()-t.start-(nG(vA)-nG(t.timeIndex))}function Ml(t,e,r,i){let n=Qn.RED,s=Qn.Golden;function a(){if(!i)return;let A=i.initColor(Qn.Golden);A.addPt(o),A.addPoint(o.end()),i.initColor(Qn.RED).addPt(l),i.draw();debugger}let o=t.getShape(),l=r?e.getShape():e.getShape().reverse(),c=oi(o,l.start()),u=oi(l),d=c.cross(u);if(Gp(d,0))if(o instanceof Ee)if(l instanceof Ee){if(wt.eq(d,0)&&(c.dot(u)>0?!Vr(o.end(),l.start()):!Vr(o.start(),l.start())))throw a(),new Error("line and line");return d<0}else{if(l instanceof ze)return c.cross(l.center.sub(o.start()))<0;if(l instanceof Nt){let A=l.getExtremePoints(o),h=A.length?A[0]:Gx(l.controls,o.start());return c.cross(h.sub(o.start()))<0}else throw new Error("not support")}else if(o instanceof ze){if(l instanceof Ee)return o.isCCW;if(l instanceof ze){if(l.center.equals1(o.center)&&(c.dot(u)>0?!Vr(o.end(),l.start())&&o.end().sub(l.start()).dot(u)>0:!Vr(o.start(),l.start())&&o.start().sub(l.start()).dot(u)>0))throw a(),new Error("arc and arc");return l.rx>=o.rx||l.center.distance2(o.center)>o.rx2?o.isCCW:!o.isCCW}else throw new Error("not support")}else if(o instanceof Nt)if(l instanceof Ee){let A=o.getPercent(l.start(),li),h=o.clip(A)[1],f=h.getExtremePoints(l);return(f.length?f[0]:Gx(h.controls,l.start())).sub(l.start()).cross(u)<0}else if(l instanceof Nt){let A=o.getPercent(l.start(),li),h=o.clip(A)[1],f=h.getExtremePoints(new Ee(l.start(),l.end())),p=l.getExtremePoints(new Ee(h.start(),h.end())),m=f.length?f[0]:Gx(h.controls,l.start()),y=p.length?p[0]:Gx(l.controls,l.start()),g=m.sub(l.start()),b=y.sub(l.start());return g.cross(b)<0}else throw Error("not support");else throw new Error("not support");else return d<0}function m1(t,e,r,i,n){let s=t.getShape(),a=e.getShape(),o=s instanceof ze?_f(s,Ti.toRadians(s.endAngle())):s instanceof Nt?Pv(s,1):s.end().sub(s.start()).normalize(),l=oi(a),c=o.dot(l);if(Gp(c,-1))return Ml(t,e,!0,n)?Ml(t,r,i,n)&&Ml(e,r,i,n):Ml(t,r,i,n)||Ml(e,r,i,n);{let u=o.scale(-1).angle(ne.ORIGIN),d=l.angle(ne.ORIGIN);u>d&&(u-=zB);let A=(u+d)/2,h=new ne(Math.cos(A),Math.sin(A)),f=i?r.getShape():r.getShape().reverse(),p=oi(f);return h.cross(p)<0?Ml(t,r,i,n):Ml(e,r,i,n)}}function vR(t,e,r,i,n){let s=t.getShape(),a=e.getShape(),o=s instanceof ze?_f(s,Ti.toRadians(s.endAngle())):s instanceof Nt?Pv(s,1):s.end().sub(s.start()).normalize(),l=oi(a),c=o.dot(l);if(Gp(c,-1))return Ml(t,e,!0,n)?Ml(t,r,i,n)&&Ml(e,r,i,n):Ml(t,r,i,n)||Ml(e,r,i,n);{let u=o.scale(-1).angle(ne.ORIGIN),d=l.angle(ne.ORIGIN);u>d&&(u-=zB);let A=(u+d)/2,h=new ne(Math.cos(A),Math.sin(A)),f=i?r.getShape():r.getShape().reverse(),p=oi(f);if(h.cross(p)<0){let m=o.dot(p)<0,y=eu(m?t.getShape().reverse():t.getShape(),f).state;return y!==3&&y!==4?Ml(t,r,i,n):y===(m?4:3)}else{let m=l.dot(p)<0,y=eu(m?e.getShape().reverse():e.getShape(),f).state;return y!==3&&y!==4?Ml(e,r,i,n):y===(m?4:3)}}}var Ode=(t=>(t[t.NOT_IN=0]="NOT_IN",t[t.IS_IN=1]="IS_IN",t[t.IS_OVERLAP=2]="IS_OVERLAP",t))(Ode||{}),Nde=(t=>(t[t.AllClear=0]="AllClear",t[t.MapClear=1]="MapClear",t))(Nde||{}),kp,C0=!1;function kd(t,e,r,i,n,s,a,o=r.side===e,l=!0,c){return kp=n,C0=s,DG(_G(t,e,l,c,a,r,o,i),r,o,i,0)}function Qm(t,e,r,i,n,s,a,o=i.side===r){kp=n,C0=s;let l=PG(t,e,r,new Map,i,o,a),c=l instanceof Array?-1:1;return DG(l,i,o,a,c)}function DG(t,e,r,i,n){for(;t instanceof Array;)n++,t.length===4?t=PG(...t,e,r,i):t=_G(...t,e,r,i);return{...t,existOverlap:n>0}}function _G(t,e,r,i,n,s,a,o){if(jB===-1){o.initColor(Qn.RED).addPt(t.getShape()),o.initColor(Qn.Golden).addPt(e.getShape()),o.draw();debugger}let l=t.getShape(),c=a?e.getShape().reverse():e.getShape(),u=(l instanceof ze?_f(l,r?c.start().angle(l.center):i?Ti.toRadians(l.endAngle()):void 0):l instanceof Nt?oi(l,r?c.start():i?l.end():l.start()):l.end().sub(l.start())).normalize(),d=(c instanceof ze?_f(c,r?void 0:(i?l.end():l.start()).angle(c.center)):c instanceof Nt?oi(c,r?void 0:i?l.end():l.start()):c.end().sub(c.start())).normalize();if(i===void 0){let f=u.dot(d);if(i=f<0,Gp(f,0))return{state:Ml(t,e,!a,o)?1:0,inter:zm(t,e,s,a,r,i,n)}}else if(i?u.dot(d)>0:u.dot(d)<0)if(r){let f,p=!0;if(l instanceof Ee&&Vr(Df.foot(l,c.start()),i?l.end():l.start()))p=!1;else if(l instanceof ze||l instanceof Nt){let m=i?l.reverse():l,y=eu(c,qhe(m,c.start()).reverse()).state;(y===1||y===2)&&(p=!1)}if(p){let m=!i;f=eu(m?l.reverse():l,c,o).state===(m?4:3)?1:0}else i?f=m1(t,t.nextSide,e,!a,o)?1:0:f=m1(t.prevSide,t,e,!a,o)?1:0;return{state:f,inter:zm(t,e,s,a,r,i,n)}}else return i?{state:Ml(t,t.nextSide,!0,o)?0:1,inter:zm(t,e,s,a,r,i,n),isReversed:!0}:{state:Ml(t.prevSide,t,!0,o)?0:1,inter:zm(t,e,s,a,r,i,n),isReversed:!0};let A,h=new Map([[3,4],[4,3],[0,1],[1,0],[2,2]]);if(r)if(t.judgeOverlapMap.has(e)&&!C0){let f=t.judgeOverlapMap.get(e);A=i?h.get(f.state):f.state}else A=eu(i?l.reverse():l,c).state,(A===3||A===4)&&t.judgeOverlapMap.set(e,{state:i?h.get(A):A});else{if(e.judgeOverlapMap.has(t)&&!C0){let f=e.judgeOverlapMap.get(t);A=a?h.get(f.state):f.state}else A=eu(c,i?l.reverse():l).state,(A===3||A===4)&&e.judgeOverlapMap.set(t,{state:a?h.get(A):A});A=h.get(A)}if(A===1||A===2){let f=a?e.prevSide:e,p=f.inters,m=f.getEnd();for(let y=p.length-1;y>=0;y--){let g=p[y];if(!(f.getShape()instanceof Nt)&&!Vr(m,g.coord))break;if(g===s)return{state:2,inter:zm(t,e,s,a,r,i,n)}}}if(A===3||A===4)return{state:A===(i?4:3)?1:0,inter:zm(t,e,s,a,r,i,n)};if(n.has(t)?n.get(t).mapSideList.push(e):n.set(t,{sideIsReversed:i,mapSideList:[e]}),n.has(e)?n.get(e).mapSideList.push(t):n.set(e,{sideIsReversed:a,mapSideList:[t]}),A===2)return i?[t.prevSide,t,a?e.prevSide:e.nextSide,n]:[t,t.nextSide,a?e.prevSide:e.nextSide,n];if(A===0)return[i?t.prevSide:t.nextSide,e,!1,i,n];if(A===1)return[t,a?e.prevSide:e.nextSide,!0,i,n];throw Error("not support")}function zm(t,e,r,i,n,s,a){if(C0)return null;let o=t.getShape(),l=i?e.getShape().reverse():e.getShape(),c=i;if(!n){let h=e;e=t,t=h,i=s,r=r.getBindedInter()}let u=h=>!(n?s:c)&&Vr(h,t.prevSide.getEnd())?t.prevSide:t;if(i){let h=e.inters;for(let f=0;f<h.length;f++){let p=h[f];if(p.isInvalid&&s===void 0)continue;if(p===r&&Vr(l.start(),r.coord))return n?p:p.getBindedInter();let m=p.getBindedInter().side,y=u(p.coord);if(m===y&&d(p))return A(p)}for(;;){e=e.nextSide;let f=e.inters;for(let p=0;p<f.length;p++){let m=f[p];if(m===r)return n?m:m.getBindedInter();if(a.has(e)){let y=m.getBindedInter().side;if(a.get(e).mapSideList.includes(y)||Vr(m.coord,y.getEnd())&&a.get(e).mapSideList.includes(y.nextSide))return A(m);if(a.has(y)){let g=e.getShape().reverse(),b=oi(g,m.coord).dot(oi(y.getShape(),m.coord))<0,E=b?y.getShape().reverse():y.getShape(),w=eu(g,b?yR(E,m.coord,E.end()):yR(E,E.start(),m.coord)).state;if(w===1||w===2)return A(m)}else a.has(y.nextSide)}else if(m.side===r.side&&d(m))return A(m)}}}else{let h=e.inters;for(let f=h.length-1;f>=0;f--){let p=h[f];if(p.isInvalid&&s===void 0)continue;if(p===r&&Vr(l.start(),r.coord))return n?p:p.getBindedInter();let m=p.getBindedInter().side,y=u(p.coord);if(m===y&&d(p))return A(p)}for(;;){e=e.prevSide;let f=e.inters;for(let p=f.length-1;p>=0;p--){let m=f[p];if(m===r)return n?m:m.getBindedInter();if(a.has(e)){let y=m.getBindedInter().side;if(a.get(e).mapSideList.includes(y)||Vr(m.coord,m.getBindedInter().side.getEnd())&&a.get(e).mapSideList.includes(y.nextSide))return A(m);if(!a.has(y)&&a.has(y.prevSide)){let g=e.getShape().reverse(),b=oi(g,m.coord).dot(oi(y.getShape(),m.coord))<0;if(a.has(y.prevSide)){let E=b?y.getShape().reverse():y.getShape(),w=eu(e.getShape(),yR(E,m.coord,E.end())).state;if(w===1||w===2)return A(m)}}}else if(m.side===r.side&&d(m))return A(m)}}}function d(h){if(h.isInvalid||h.getBindedInter().side!==(Vr(h.coord,t.prevSide.getEnd())?t.prevSide:t))return!1;let f;if(n){if(Vr(h.coord,l.start()))return!0;f=eu(s?o.reverse():o,p(l)).state}else{if(Vr(h.coord,s?o.end():o.start()))return!0;f=eu(l,p(s?o.reverse():o)).state}return f===2||f===1;function p(m){if(m instanceof Ee)return Vr(h.coord,m.end())?m:m.cutLine(h.coord);if(m instanceof ze)return ze.build2(m.center,m.startAngle,h.coord.angleD(m.center),m.rx,m.ry,m.isCCW?1:0);if(m instanceof Nt)return m.clip(m.getPercent(h.coord,li))[0];throw new Error("not supported operation")}}function A(h){let f=r.getBindedInter(),p=r.side,m=f.side,y=r===h,g=r;if(i){let b=r.getIndex()-1;for(;p;){let E=p.inters;for(;b>=0;b--)if(r=E[b],r===h){y||(r.setIsInvalid(),r.isDealed(),g=r),p=null;break}else if(kp===0)!r.isInvalid&&(!Vr(r.coord,h.coord)||r.side===h.side&&r.getBindedInter().side===h.getBindedInter().side)&&(r.setIsInvalid(),r.isDealed(),g=r);else if(kp===1){if(r.isInvalid)continue;let w=r.getBindedInter().side;a.has(p)&&a.get(p).mapSideList.includes(w)&&(r.setIsInvalid(),r.isDealed(),g=r)}p=p==null?void 0:p.prevSide,b=(p==null?void 0:p.inters.length)-1}}else{let b=r.getIndex()+1;for(;p;){let E=p.inters;for(;b<E.length;b++){r=E[b];let w=r.getBindedInter();if(r===h){y||(r.setIsInvalid(),r.isDealed(),g=r),p=null;break}else if(kp===0)!r.isInvalid&&(!Vr(r.coord,h.coord)||p===h.side&&(Vr(w.side.getEnd(),r.coord)?w.side.nextSide:w.side)===h.getBindedInter().side)&&(r.setIsInvalid(),r.isDealed(),g=r);else if(kp===1){let x=w.side;a.has(p)&&a.get(p).mapSideList.includes(x)&&(r.setIsInvalid(),r.isDealed(),g=r)}}p=p==null?void 0:p.nextSide,b=0}}if(kp===0&&!Vr(f.coord,h.coord))if(n?a.has(m)?a.get(m).sideIsReversed:s:c){let b=f.getIndex()-1;for(;m;){let E=a.has(m),w=m.inters;for(;b>=0;b--){if(f=w[b],f===h.getBindedInter()){m=null;break}f.isInvalid||!E||(!Vr(f.coord,h.getBindedInter().coord)||f.side===h.side&&f.getBindedInter().side===h.getBindedInter().side)&&(f.setIsInvalid(),f.isDealed())}m=m==null?void 0:m.prevSide,b=(m==null?void 0:m.inters.length)-1}}else{let b=f.getIndex()+1;for(;m;){let E=m.inters,w=a.has(m);for(;b<E.length;b++){if(f=E[b],f===h.getBindedInter()){m=null;break}let x=Vr(m.getEnd(),f.coord)?a.has(m.nextSide):!1;f.isInvalid||!(w||x)||(!Vr(f.coord,h.getBindedInter().coord)||f.side===h.side&&f.getBindedInter().side===h.getBindedInter().side)&&(f.setIsInvalid(),f.isDealed())}m=m==null?void 0:m.nextSide,b=0}}return n?g:g.getBindedInter()}}function PG(t,e,r,i,n,s,a){let o=t.getShape(),l=e.getShape(),c=s?r.getShape().reverse():r.getShape(),u=(o instanceof ze?_f(o,c.start().angle(o.center)):o instanceof Nt?oi(o,c.start()):o.end().sub(o.start())).normalize(),d=(l instanceof ze?_f(l,c.start().angle(l.center)):l instanceof Nt?oi(l,c.start()):l.end().sub(l.start())).normalize(),A=u.dot(d);if(Gp(A,-1)){let h=s?r.getShape().reverse():r.getShape(),f=oi(h).normalize(),p=u.add(d.scale(-1)).normalize().dot(f),m=eu(o.reverse(),l,a).state;if(p>-.9&&(m===3||m===4))return{state:m===4?0:1,inter:zm(e,r,n,s,!0,!1,i)};let y=kd(t,r,n,a,kp,C0,i.size===0?new Map:i,s);return y.state===2?y:m===4?y.state===0||y.inter!==n?y:kd(e,r,n,a,kp,C0,i.size===0?new Map:i,s):y.state===1||y.inter!==n?y:kd(e,r,n,a,kp,C0,i.size===0?new Map:i,s)}else{let h=u.scale(-1).angle(ne.ORIGIN),f=d.angle(ne.ORIGIN);h>f&&(h-=zB);let p=(h+f)/2,m=new ne(Math.cos(p),Math.sin(p)),y=oi(c).normalize(),g=y.angle(ne.ORIGIN),b=h<g&&g<f&&o instanceof Ee&&l instanceof Ee&&c instanceof Ee;if(m.cross(y)<=0){if(u.scale(-1).dot(y)<0){let E;return n.coord.equals1(c.start())?E=oi(o,n.coord).dot(oi(c,n.coord))<0:c instanceof Ee&&(E=oi(o,o.end()).dot(c.direct)<0),{state:m1(t,e,r,!s,a)?1:0,inter:zm(t,r,n,s,!0,E,i)}}return b&&o.distance2(c.start())>tu?[e,r,!0,void 0,i]:[t,r,!0,void 0,i]}else return d.dot(y)<=0?{state:m1(t,e,r,!s,a)?1:0,inter:zm(e,r,n,s,!0,void 0,i)}:b&&l.distance2(c.start())>tu?[t,r,!0,void 0,i]:[e,r,!0,void 0,i]}}var jB=0;function Rde(t,e,r,i){let n=e.getBindedInter(),s=e.side,a=n.side,o=s.getShape(),l=a.getShape();if(i&&(jB++,jB===-1)){i.initColor(Qn.RED).addPt(o),i.initColor(Qn.Golden).addPt(l),i.draw();debugger}let c=0,u=!1;if(t===-1){let I=Qm(s,s.nextSide,a,n,c,u,i),C=I.state!==0;if(I.state===2){let U=oi(o,e.coord).add(oi(s.nextSide.getShape(),e.coord)).normalize(),_=oi(l,e.coord).add(oi(a.nextSide.getShape(),e.coord)).normalize();return x(C,U.dot(_)>0)}let G=Qm(s,s.nextSide,a.nextSide,n,c,u,i);return I.state!==G.state?(w(I,G),1):x(C,I.state!==Qm(a,a.nextSide,s,e,c,!0,i).state,I.inter,G.inter)}if(t===1){let I=kd(s,a,n,i,c,u,new Map),C=I.state!==0;if(I.state===2)return x(C,oi(o,e.coord).dot(oi(l,e.coord))>0);let G;if(I.isReversed&&I.existOverlap&&Vr(I.inter.coord,a.getEnd())&&I.inter.getBindedInter().side!==s){let H=I.inter.getBindedInter().side;if(H===s.nextSide)G={state:m1(s,H,a.nextSide,!0,i)?1:0,inter:n};else if(H===s.prevSide){if(G={state:m1(H,s,a.nextSide,!0,i)?1:0,inter:I.inter},I.state===G.state&&e!==I.inter){let Q=oi(l,e.coord),j=oi(a.nextSide.getShape(),e.coord),$=oi(H.getShape(),e.coord);return x(C,Q.add(j).dot($)>0,I.inter,G.inter)}}else G=kd(s,a.nextSide,n,i,c,u,new Map)}else G=kd(s,a.nextSide,n,i,c,u,new Map);if(I.state!==G.state)return w(I,G),1;let U=oi(l,e.coord),_=oi(a.nextSide.getShape(),e.coord);if(Gp(U.dot(_),-1)){let H=Ml(a,a.nextSide,!0,i);return x(C,I.state!==kd(a.nextSide,s,e,i,c,!0,new Map,H?!C:C,!1).state,I.inter,G.inter)}else{let H=oi(o,e.coord);return x(C,U.add(_).dot(H)>0,I.inter,G.inter)}}if(!(o instanceof Nt||l instanceof Nt))return 1;let d=oi(o,e.coord),A=oi(l,e.coord),h,f;if(l instanceof Ee)h=new Ee(e.coord,l.start()),f=new Ee(e.coord,l.end());else if(l instanceof ze){let I=e.coord.angleD(l.center);h=ze.build2(l.center,I,l.startAngle,l.rx,l.ry,l.isCCW?0:1),f=ze.build2(l.center,I,l.endAngle(),l.rx,l.ry,l.isCCW?1:0)}else if(l instanceof Nt){let I=l.getPercent(e.coord,li);[h,f]=l.clip(I),h=h.reverse()}else throw new Error("not support");let p=d.dot(A)>0,m,y;p?(m=eu(o.reverse(),h).state,y=eu(o,f).state):(m=eu(o,h).state,y=eu(o.reverse(),f).state);let g;m===0?g=kd(p?s.prevSide:s.nextSide,a,n,i,c,u,new Map,!0,!1,p):m===1?g=kd(s,a.prevSide,n,i,c,u,new Map,!0,!0,p):m===2?p?g=Qm(s.prevSide,s,a.prevSide,n,c,u,i,!0):g=Qm(s,s.nextSide,a.prevSide,n,c,u,i,!0):p?m===3?g={inter:n,state:0}:g={inter:n,state:1}:m===3?g={inter:n,state:1}:g={inter:n,state:0};let b=g.state!==0;if(g.state===2)return x(b,p);let E;if(y===0?E=kd(p?s.nextSide:s.prevSide,a,n,i,c,u,new Map,!1,!1,!p):y===1?E=kd(s,a.nextSide,n,i,c,u,new Map,!1,!0,!p):y===2?p?E=Qm(s,s.nextSide,a.nextSide,n,c,u,i,!1):E=Qm(s.prevSide,s,a.nextSide,n,c,u,i,!1):p?y===3?E={inter:n,state:1}:E={inter:n,state:0}:y===3?E={inter:n,state:0}:E={inter:n,state:1},g.state===E.state)return g.inter===E.inter?(e.setIsInvalid(),0):x(b,p,g.inter,E.inter);return w(g,E),1;function w(I,C){let G=I.state!==0;if(I.inter===C.inter){e.setOutToIn(G);return}else Rx(I.inter,C.inter,!0),Rx(C.inter,I.inter,!1);let U=[];if(t===-1){let H=oi(o,e.coord),Q=oi(s.nextSide.getShape(),e.coord),j=oi(l,e.coord),$=oi(a.nextSide.getShape(),e.coord);U.push(H.dot(j)),U.push(H.dot($)),U.push(Q.dot(j)),U.push(Q.dot($))}else{let H=oi(o,e.coord);U.push(oi(l,e.coord).dot(H)),U.push(oi(a.nextSide.getShape(),e.coord).dot(H))}if(U.reduce((H,Q)=>Math.abs(H)>Math.abs(Q)?H:Q,0)>0)if(r===1||r===0||r===2||r===3)e.setOutToIn(G);else throw new Error("not support");else if(r===1)_(!G);else if(r===0||r===2||r===3)_(G);else throw new Error("not support");function _(H){e.setIsInvalid();let Q=(H?I:C).inter;delete Q.isInvalid,delete Q.getBindedInter().isInvalid,Q.setOutToIn(!G)}}function x(I,C,G,U){if(G===U){if(e.side.outline.inters.find(Q=>!Q.isInvalid&&Q!==e&&Vr(Q.coord,e.coord)))return e.setIsInvalid(),0;let _=new Xm(e.coord,s,i),H=new Xm(e.coord,a,i);return _.bind(H),C?s.inters.splice(e.getIndex(),0,_):s.inters.splice(e.getIndex()+1,0,_),a.inters.splice(e.getBindedInter().getIndex(),0,H),_.setOutToIn(I),e.setOutToIn(!I),_.isDealed(),s.inters.forEach((Q,j)=>Q.setIndex(j)),a.inters.forEach((Q,j)=>Q.setIndex(j)),2}else{let _=function(){let H=G.getBindedInter(),Q=U.getBindedInter();delete G.isInvalid,delete H.isInvalid,delete U.isInvalid,delete Q.isInvalid,G.setOutToIn(!I),U.setOutToIn(I),Rx(G,U,!0),Rx(U,G,!1),Rx(H,Q,C),Rx(Q,H,!C)};if(e.setIsInvalid(),C){if(r===1||r===0||r===2||r===3)return _(),2;throw new Error("not support")}else{if(r===1)return I?0:(_(),2);if(r===0||r===2||r===3)return I?(_(),2):0;throw new Error("not support")}}}}function Rx(t,e,r){let{judge:i,changeNum:n}=a(),s=t.getIndex();for(let o=s+n,l=t.side.inters;i(o);o+=n){if(l[o].isInvalid)continue;if(!Vr(l[o].coord,t.coord))break;l[o].setIndex(s),l[s].setIndex(o);let c=l[o];l[o]=l[s],l[s]=c,s=o}function a(){let o=t.side===e.side;if(r){let l=o?e.getIndex():t.side.inters.length;return{judge:c=>c<l,changeNum:1}}else{let l=o?e.getIndex()+1:0;return{judge:c=>c>=l,changeNum:-1}}}}var sG=0,Xm=class{constructor(t,e,r){this.id=sG++,this.coord=t,this.side=e,r&&(this.id=sG++,this.drawDebug=r);let i=new pr;i.ext2(t),this._bbox=i.build1()}bbox(){return this._bbox}resetVisitStatus(){this.visited=!1,this.bindedInter.visited=!1}isDealed(){this.dealed=!0,this.getBindedInter().dealed=!0}setOutToIn(t){this.outToIn=t,this.bindedInter.outToIn=!t}setIsInvalid(){this.isInvalid=!0,this.getBindedInter().isInvalid=!0}getBindedInter(){return this.bindedInter}bind(t){this.bindedInter=t,t.bindedInter=this}setIndex(t){this.index=t}isSorted(){return this.index!==void 0}getIndex(){return this.index}getVisited(){return this.visited}visitSelf(){this.visited=!0}visit(){this.visited=!0,this.bindedInter.visited=!0}getPrevPoint(){let t=this.getIndex(),e=this.side.getStart();return t&&(e=this.side.inters[t-1].coord),e}getTangent(){let t=this.side.getShape();if(t instanceof Ee)return t.end().sub(t.start());if(t instanceof ze){let e=this.coord.angle(t.center);return t.isCCW?e+=kB:e-=kB,new ne(Math.cos(e),Math.sin(e))}else{if(t instanceof Nt)return Pv(t,t.getPercent(this.coord,li));throw new Error("not support")}}findStartInter(){return this.outToIn===void 0?this.getTangent().cross(this.bindedInter.getTangent())>0?this:this.bindedInter:this.outToIn?this:this.bindedInter}run(){let t=[],e=this,r;if(this.drawDebug){CR++;let i=CR===-1,n=this.drawDebug.initColor(Qn.RED);if(i){this.drawDebug.draw();debugger}r=s=>{if(t.push(s),i){n.addPt(t[t.length-1]),this.drawDebug.draw();debugger}}}else r=i=>t.push(i);for(;!e.visited;){let i=function(o,l){if(wt.eq(o.distance2(l),0))return;let c=kv.rebuild(s.getShape(),o,l);if(!c)return!0;r(c)};e.visit();let n=e.getIndex(),s=e.side,a=s.inters[n+1];for(;a!=null&&a.isInvalid;)a=s.inters[a.getIndex()+1];if(a)i(e.coord,a.coord),e=a.bindedInter;else{let o=i(e.coord,s.getEnd()),l=e.coord;for(s=s.nextSide,e=null;;){for(let c of s.inters)if(!c.isInvalid){e=c.bindedInter;break}if(e)break;o?(i(l,s.getEnd()),o=!1):r(s.getShape()),s=s.nextSide}o?(wt.eq(l.distance2(e.coord),0)?i(l,s.getEnd()):i(l,e.coord),o=!1):wt.eq(s.getEnd().distance2(e.coord),0)?r(s.getShape()):i(s.getStart(),e.coord)}}if(e!==this)throw this.drawDebug&&console.log(JSON.stringify({runId:CR,handleId:jB,boolId:Sv})),new Error("inter !== this");return Pf(Fr.build7(t))}},CR=0,SR=class FR{constructor(e,r,i,n,s){this.inters=[],this.allInterIsInvalid=!0,this.isVisit=!1,this.sides=e,this.isGroup1=i,this.isOutside=n,this.finalIsOutside=n,this.polyline=r,s&&(this.polygon=s),e.forEach(a=>a.outline=this)}static build(e,r,i,n,s){let a=e.primitives.map(l=>new kv(l,n)),o=a[a.length-1];return a.forEach(l=>{o.connect(l),o=l}),s?new FR(a,e,r,i,s):new FR(a,e,r,i)}setFinalIsOutSide(e){this.finalIsOutside=e}startAndEndIsSameOutsideFlag(){return this.isOutside===this.finalIsOutside}get hasInter(){return!!this.interOutlines}isAllInterIsInvalid(){return this.allInterIsInvalid}setAllInterIsInvalidToFalse(){this.allInterIsInvalid=!1}resetVisited(){this.isVisit=!1}intersect(e,r){if(!(e.interOutlines&&e.interOutlines===this.interOutlines))if(e.interOutlines)if(this.interOutlines){let i,n;this.interOutlines.length>e.interOutlines.length?(i=this.interOutlines,n=e.interOutlines):(i=e.interOutlines,n=this.interOutlines),n.forEach(s=>{i.push(s),s.interOutlines=i}),r.delete(n)}else e.interOutlines.push(this),this.interOutlines=e.interOutlines;else this.interOutlines?(this.interOutlines.push(e),e.interOutlines=this.interOutlines):(e.interOutlines=this.interOutlines=[this,e],r.add(this.interOutlines))}isContain(e){if(!this.polyline.bbox().extendOfSize(li).isContainsBBox(e.polyline.bbox()))return!1;let r=e.polyline.primitives[0].start();if(e.hasInter&&e.isAllInterIsInvalid()){let i=e.inters[0];i.getBindedInter().side.outline!==this?r=i.side.getCenterPoint():r=i.side.getCenterPoint(i.coord)}return!!this.polyline.getWindingNum(r)}isInternally(e){return!!this.polyline.getWindingNum(e)}isEqual(e){return this.polyline===e.polyline}bbox(){return this.polyline.bbox()}reverse(){this.sides.reverse();let e=this.sides[this.sides.length-1];this.sides.forEach(r=>{r.reverse(),e.connect(r),e=r})}returnPolyline(){let e=this.sides.map(i=>i.getShape()),r=this.polyline.primitives;if(this.sides.length===r.length){let i=new Set(r);if(!e.some(n=>!i.has(n)))return this.polyline}return Fr.build7(e)}};function aG(t,e,r){let i=[];return t.forEach(n=>n.forEach(s=>{if(s.hasInter&&!s.isAllInterIsInvalid())return;let a=s.bbox(),o=e.search(a.extendOfSize(li)).filter(l=>l.bbox().extendOfSize(li).isContainsBBox(a)).sort((l,c)=>l.bbox().area()-c.bbox().area());for(let l of o)if(l.isContain(s)){let c=r(!s.isOutside,l.isOutside),u=r(s.isOutside,l.isOutside);c!==u&&(i.push(s),s.setFinalIsOutSide(!c));return}r(s.isOutside,!1)!==r(!s.isOutside,!1)&&i.push(s)})),i}function Mde(t,e,r){let i;switch(r){case 0:i=(o,l)=>o&&l;break;case 1:i=(o,l)=>o||l;break;case 2:i=(o,l)=>o&&!l;break;case 3:i=(o,l)=>o&&!l||!o&&l;break;default:throw Error("not support the rule")}let n=new Lv(10),s=new Lv(10);t.forEach(o=>o.forEach(l=>n.add(l))),e.forEach(o=>o.forEach(l=>s.add(l)));let a=aG(t,s,i);return aG(e,n,(o,l)=>i(l,o)).forEach(o=>a.push(o)),a}var kde=class{constructor(t){this.roots=[],this.nodes=t.sort((e,r)=>e.bbox().minX-r.bbox().minX).map(e=>new Fde(e)),this.nodes.forEach((e,r)=>{e.visit()&&(this.roots.push(e),this.build(r))})}build(t){let e=this.nodes[t];for(let r=t+1,i=this.nodes.length;r<i;r++){let n=this.nodes[r];if(e.key.bbox().maxX<n.key.bbox().minX)break;n.getIsVisit()||e.isContain(n)&&(n.visit(),e.addChild(n),this.build(r))}}getPolygons(){let t=[];return this.roots.forEach(e=>e.getPolygons().forEach(r=>t.push(r))),t}},Fde=class{constructor(t){this.children=[],this.isVisit=!1,this.key=t}getIsVisit(){return this.isVisit}isContain(t){return this.key.isContain(t.key)}addChild(t){this.children.push(t)}getPolygons(){let t=[];return this.getPolylineList(t),t.map(e=>{let r=e[0].polygon;if(r&&r.items.length===e.length){let i=e.map(s=>s.returnPolyline()),n=new Set(r.items);return i.some(s=>!n.has(s))?new va(i):r}else return new va(e.map(i=>i.returnPolyline()))})}getPolylineList(t,e){e?(e.push(this.key),e=null):(e=[this.key],t.push(e)),this.children.forEach(r=>r.getPolylineList(t,e))}visit(){return this.isVisit?!1:(this.isVisit=!0,!0)}};function oG(t){let e="";return t.items.forEach((r,i)=>{let n="$";if(r.items.forEach((s,a)=>{let o="[";if(s.primitives.forEach((l,c)=>{let u="";if(l instanceof Ee)u=`Line,${l.start().x},${l.start().y},${l.end().x},${l.end().y}`;else if(l instanceof ze)u=`Arc,${l.center.x},${l.center.y},${l.startAngle},${l.sweepAngle},${l.rx}`;else if(l instanceof Nt)u=`Bezier,${l.controls.map(d=>`${d.x},${d.y}`).join(",")}`;else throw new Error("not supported");if(c===s.primitives.length-1){o+=`${u}]`;return}o+=`${u},`}),a===r.items.length-1){n+=`${o}$`;return}n+=`${o}_`}),i===t.items.length-1){e+=`${n}`;return}e+=`${n}^`}),console.log(e),e}function lG(t){let e=t.split("^"),r=[];return e.forEach(n=>{let s=/\$(.*?)\$/,a=n.match(s)[1].split("_"),o=[];a.forEach(c=>{let u=/\[(.*?)\]/,d=c.match(u)[1].split(","),A=[],h=[];for(let p=0;p<d.length;p++){let m=d[p];if(m==="Line"||m==="Arc"||m==="Bezier"){if(A.length){let y=i(A);h.push(y),A.length=0}A.push(m);continue}A.push(Number(m))}A.length&&(h.push(i(A)),A.length=0);let f=Fr.build7(h);o.push(f)});let l=new va(o);r.push(l)}),new Ga(r);function i(n){let s=n[0];if(s==="Line")return new Ee(new ne(n[1],n[2]),new ne(n[3],n[4]));if(s==="Arc")return ze.build3(new ne(n[1],n[2]),n[3],n[4],n[5],n[5]);if(s==="Bezier"){let a=[];for(let o=1;o<n.length;o+=2)a.push(new ne(n[o],n[o+1]));return new Nt(a)}else throw new Error("not support")}}var Ude=class{constructor(t=1){this.group1Str="$[Line,20193.777980000017,4122.200439600661,20193.77082,4211.848760073709,Arc,20193.972672902382,4211.8487570980205,179.99915535323618,-89.99540000050294,0.2018529024026465,Line,20193.972659672283,4212.050609999989,20193.972660393258,4212.039610000013,Arc,20193.97217289501,4211.848257065248,89.85403133887164,89.99540000041924,0.19135355574930143,Line,20193.78082,4211.848759926291,20193.78897999998,4122.200440479205,Line,20193.78897999998,4122.200440479205,20193.777980000017,4122.200439600661]$",this.group2Str="$[Arc,20209.72784128151,4122.2007625157785,258.46768032837986,-75.66780748375947,4.138846238512183,Line,20205.593935808283,4121.998590004101,20193.97982992629,4121.998600000001,Arc,20193.97983290198,4122.2004529023825,269.9991553532362,-89.99540000050297,0.20185290240401074,Arc,20193.782979999996,4122.20044,180.00375535340328,-180.0000000000027,0.004999999999025513,Arc,20193.979332869207,4122.200952909754,180.15347936671733,89.99540000008247,0.19135355575111057,Line,20193.97983008845,4122.009599999999,20205.603694309226,4122.003828485546,Arc,20209.733142304296,4122.194577876843,182.64475341258483,75.73379999998886,4.133851239977064,Line,20208.900400396684,4118.145470939558,20208.902599535475,4118.156248870184,Arc,20206.972515961093,4108.700057667588,78.46393309088245,-78.46759999998636,9.65115405866796,Arc,20216.618669999996,4108.69944,359.99996825446135,-180,0.004999999999200412,Arc,20206.973015966745,4108.699445349495,359.99996822365375,78.46759999998409,9.640654033253735]$^$[Line,20193.997796883676,4095.399470032799,20205.596133314026,4095.4013992171836,Arc,20209.72470159858,4095.1923799234505,177.10172964919312,-75.64935037184974,4.133855965730166,Arc,20209.73000213952,4095.198565517174,101.5415133143569,75.7293000000185,4.128850963459707,Line,20205.605834328744,4095.395161923586,20193.997203529463,4095.389485743675,Arc,20193.994588809255,4095.197684525904,89.21896662213764,4.544099999999517,0.19181903946188483,Arc,20193.981499796217,4095.1977402038,89.85034659953621,89.9999999995926,0.19135044893494071,Arc,20193.78515,4095.19824,0,-180,0.005,Arc,20193.98200016982,4095.1982398301675,179.99995179248322,-89.99999999974185,0.20185016982129908,Arc,20193.981986624152,4095.198185381971,89.9961078637802,-4.487285276547311,0.2019046184835962]$",this.rule=t}getGroup1(){return lG(this.group1Str)}getGroup2(){return lG(this.group2Str)}},TR=new QB(2),Cv=class{getUnion(t,e=!0){return e&&(t=t.map(r=>this.asSameSweep([r])[0])),wde(ide,t)}asSameSweep(t){let e=0;return t.forEach(r=>e+=r.area(.01)),e>0?t.map(r=>r.reverse()):t}getSubtraction(t,e){let r=new Dv(!1),i=new _v(_B.rule,TR,r);for(let n of t){let s=_B.weight(0);i.addPolyline(n,s)}for(let n of e){let s=_B.weight(1);i.addPolyline(n,s)}return i.simplify(),r.plGrps}getIntersection(t,e){let r=new Dv(!1),i=new _v(PB.rule,TR,r);for(let n of t){let s=PB.weight(0);i.addPolyline(n,s)}for(let n of e){let s=PB.weight(1);i.addPolyline(n,s)}return i.simplify(),r.plGrps}getMutuallyExclusive(t,e){let r=new Dv(!1),i=new _v(LB.rule,TR,r);for(let n of t){let s=LB.weight(0);i.addPolyline(n,s)}for(let n of e){let s=LB.weight(1);i.addPolyline(n,s)}return i.simplify(),r.plGrps}},Sv=0,IR=!1;function Tv(t,e,r,i,n){let s=y1(),a=[],o=[],l=[],c=new Set,u;if(n){if(u=new Mv(n),Sv++,IR){debugger;IR=!1;let E=new Ude;Tv(E.rule,E.getGroup1(),E.getGroup2(),i,n)}if(Sv===-1||IR){console.table({rule:t,group1:oG(e),group2:oG(r)}),u.clear();let E=u.initColor(Qn.GREEN),w=u.initColor(Qn.WHITE),x=u.initColor(Qn.BLUE),I=u.initColor(Qn.Gray);e.items.forEach(C=>C.items.forEach((G,U)=>{U>0?w.addPly(G):E.addPly(G)})),r.items.forEach(C=>C.items.forEach((G,U)=>{U>0?I.addPly(G):x.addPly(G)})),u.draw();debugger}}let d=e.items.length!==0&&r.items.length!==0?e.bbox().extendOfSize(li).intersection1(r.bbox().extendOfSize(li)):null;if(d){let E=[],w=[];switch(t){case 0:{for(let x of e.items)x.bbox().isIntersect(d)&&E.push(x);for(let x of r.items)x.bbox().isIntersect(d)&&w.push(x);break}case 1:case 3:{for(let x of e.items)x.bbox().isIntersect(d)?E.push(x):a.push(x);for(let x of r.items)x.bbox().isIntersect(d)?w.push(x):a.push(x);break}case 2:{for(let x of e.items)x.bbox().isIntersect(d)?E.push(x):a.push(x);for(let x of r.items)x.bbox().isIntersect(d)&&w.push(x);break}default:throw new Error("not support")}E.length!==e.items.length&&(e=new Ga(E)),w.length!==r.items.length&&(r=new Ga(w))}else{switch(t){case 0:break;case 1:case 3:{e.items.forEach(E=>a.push(E)),r.items.forEach(E=>a.push(E));break}case 2:{e.items.forEach(E=>a.push(E));break}default:throw new Error("not support")}e=new Ga([]),r=new Ga([])}g(e,o,!0),g(r,l,!1);let A=t===2||t===3?(E,w)=>Vr(E.getEnd(),w)?E.nextSide:E:(E,w)=>Vr(E.prevSide.getEnd(),w)?E.prevSide:E,h=(E,w,x)=>{if(Vr(E.getEnd(),x)){if(E.inters.findIndex(I=>I.getBindedInter().side===w&&Vr(I.coord,E.getEnd()))===-1)return new Xm(x,E,u)}else return new Xm(x,E,u)},f=t===2||t===3?(E,w,x)=>{if(Vr(E.getStart(),x)){if(E.inters.findIndex(I=>I.getBindedInter().side===w&&Vr(I.coord,E.getStart()))===-1)return new Xm(x,E,u)}else return new Xm(x,E,u)}:h;i.seek(e,r,(E,w,x,I,C,G)=>{let U=o[E][w],_=l[I][C],H=U.sides[x],Q=_.sides[G],j=wA(H.getShape(),Q.getShape());if((H.getShape()instanceof Nt||Q.getShape()instanceof Nt)&&j>=4){if(H.getShape()instanceof ze||Q.getShape()instanceof ze){let B=function(v,N){let R=!1;for(let q=0;q<N.length;q+=2)Vr(new ne(N[q],N[q+1]),v)&&(R=!0);R||N.push(v.x,v.y)},M=[Be[0],Be[1]];for(let v=0;v<j;v+=2){let N=new ne(Be[v],Be[v+1]);for(let R=v+2;R<j;R+=2){let q=new ne(Be[R],Be[R+1]);if(!Vr(N,q)){B(q,M);break}}}j=M.length,M.forEach((v,N)=>Be[N]=v)}else for(let B=j-2;B>=2;B-=2)for(let M=B-2;M>=0;M-=2)if(Vr(new ne(Be[B],Be[B+1]),new ne(Be[M],Be[M+1]))){Be[M]=(Be[B]+Be[M])/2,Be[M+1]=(Be[B+1]+Be[M+1])/2;for(let v=j-3;v>=B;v--)Be[v]=Be[v+2];j-=2;break}}let $=0;if(j===4){let B=function(N){return Vr(H.getEnd(),N)||Vr(H.prevSide.getEnd(),N)||Vr(Q.prevSide.getEnd(),N)||Vr(Q.getEnd(),N)},M=new ne(Be[0],Be[1]),v=()=>{let N=new Xm(M,H,u),R=new Xm(M,Q,u);N.bind(R),N.setIsInvalid(),N.isDealed(),U.inters.push(N),_.inters.push(R)};if(Be[0]===Be[2]&&Be[1]===Be[3])if(B(M))$=2;else{v();return}}for(;$<j;$+=2){let B=new ne(Be[$],Be[$+1]),M=H,v=Q;if(Vr(M.prevSide.getEnd(),B)&&(M=M.prevSide),v=A(v,B),H!==M&&Q!==v){let R=t===2||t===3?Q.getEnd():v.getEnd();M.getEnd().distance1(B)<R.distance1(B)?(B=M.getEnd(),Vr(R,B)||(v=Q)):(B=R,Vr(M.getEnd(),B)||(M=H))}let N=h(M,v,B);if(N){let R=f(v,M,B);R&&(M.addInter(N),U.inters.push(N),v.addInter(R),_.inters.push(R),N.bind(R),U.intersect(_,c))}}return j},n);let p=b(),m=Mde(o,l,t);m.forEach(E=>!E.startAndEndIsSameOutsideFlag()&&E.reverse()),new kde(p.concat(m)).getPolygons().forEach(E=>a.push(E));let y=new Ga(a);if(u){if(Sv===-1){let E=u.initColor(Qn.RED),w=u.initColor(Qn.Golden);a.forEach(x=>{E.addPly(x.items[0]),x.items.slice(1).forEach(I=>w.addPly(I))}),u.draw();debugger;throw new Error}y.id=Sv}return vA.BooleanTools+=Up(s),y;function g(E,w,x){E.items.forEach(I=>{let C=[];C.push(SR.build(I.items[0],x,!0,u,I)),I.items.slice(1).forEach(G=>{C.push(SR.build(G,x,!1,u))}),w.push(C)})}function b(){let E=[];return c.forEach(x=>{t===2||t===3?x.forEach(C=>{C.isGroup1||C.reverse(),C.sides.forEach(G=>G.sortInters())}):x.forEach(C=>C.sides.forEach(G=>G.sortInters())),x.map(C=>C.sides.filter(G=>G.inters.length)).flat(2).sort((C,G)=>{let U=C.inters,_=G.inters,H=Vr(U[U.length-1].coord,C.getEnd()),Q=Vr(_[_.length-1].coord,G.getEnd());if(H&&Q){let j=0,$=0;for(let B=U.length-2;B>=0&&Vr(U[B].coord,C.getEnd());B--)j++;for(let B=_.length-2;B>=0&&Vr(_[B].coord,G.getEnd());B--)$++;return $-j}else return H?-1:1}).forEach(C=>{C.inters.forEach(G=>{if(G.dealed)return;let U=G.side,_=G.getBindedInter().side,H;Vr(U.getEnd(),G.coord)&&Vr(_.getEnd(),G.coord)?H=-1:Vr(U.getEnd(),G.coord)?(H=1,G=G.getBindedInter()):Vr(_.getEnd(),G.coord)&&(H=1);let Q=Rde(H,G,t,u);G.isDealed(),Q&&(U.outline.setAllInterIsInvalidToFalse(),_.outline.setAllInterIsInvalidToFalse())})}),I(x),t===3&&(x.forEach(C=>{C.reverse(),C.sides.forEach(G=>{G.sortInters(),G.inters.forEach(U=>{U.resetVisitStatus()})})}),I(x));function I(C){C.forEach(G=>{G.inters.forEach(U=>{if(U.isInvalid||U.getVisited())return;let _=U.findStartInter(),H=w(t)?_.run():_.getBindedInter().run(),Q=G.polyline.primitives;if(H){if(Q.length===H.primitives.length){let j=new Set(Q);if(!H.primitives.some($=>!j.has($))){E.push(G);return}}E.push(SR.build(H,!0,!0,u))}})})}}),E;function w(x){switch(x){case 0:case 2:case 3:return!0;case 1:return!1;default:throw Error("not support the rule")}}}}var CB=/\bstablilizetion\b/.test(self.location.href)||!0,bv={intersect(t,e,r,i){try{return Tv(0,t,e,r,i)}catch(n){if(CB){let s=new Cv().getIntersection(t.items.map(a=>a.items.map(o=>o)).flat(2),e.items.map(a=>a.items.map(o=>o)).flat(2));return new Ga(s.map(a=>new va(a.items)))}throw n}},union(t,e,r,i){try{return Tv(1,t,e,r,i)}catch(n){if(CB){let s=new Cv,a=t.items.map(l=>l.items.map(c=>c)).flat(2);e.items.forEach(l=>l.items.forEach(c=>a.push(c)));let o=s.getUnion(a);return new Ga(o.map(l=>new va(l.items)))}throw n}},diff(t,e,r,i){try{return Tv(2,t,e,r,i)}catch(n){if(CB){let s=new Cv().getSubtraction(t.items.map(a=>a.items.map(o=>o)).flat(2),e.items.map(a=>a.items.map(o=>o)).flat(2));return new Ga(s.map(a=>new va(a.items)))}throw n}},xor(t,e,r,i){try{return Tv(3,t,e,r,i)}catch(n){if(CB){let s=new Cv().getMutuallyExclusive(t.items.map(a=>a.items.map(o=>o)).flat(2),e.items.map(a=>a.items.map(o=>o)).flat(2));return new Ga(s.map(a=>new va(a.items)))}throw n}}},Hde=class extends _v{constructor(t,e,r,i,n,s){super(t.rule,QB.DUMMY,e),this.sideGroup1=[],this.sideGroup2=[],this.group1=r,this.group2=i,this.seeker=n,this.addGroup(r,t.weight(0),this.sideGroup1),this.addGroup(i,t.weight(1),this.sideGroup2),this.bus=s}addGroup(t,e,r){if(!t)debugger;t.items.forEach(i=>{let n=[];i.items.forEach(s=>{let a=this.sides.length;this.addPolyline(s,e),n.push(this.sides.slice(a))}),r.push(n)})}seekIntersection(){this.seeker.seek(this.group1,this.group2,(t,e,r,i,n,s)=>{let a=this.sideGroup1[t][e][r],o=this.sideGroup2[i][n][s],l=wA(a.shape,o.shape);for(let c=0;c<l;c+=2){let u=new ne(Be[c],Be[c+1]);a.inters.push(u),o.inters.push(u),this.event.onIntersect(u,a,o)}return l},this.bus)}},Gde=class extends Dv{constructor(t){super(!!t),t&&(this.drawDebug=new Mv(t),this.blueDrawing=this.drawDebug.initColor(Qn.BLUE),this.greenDrawing=this.drawDebug.initColor(Qn.GREEN),this.redDrawing=this.drawDebug.initColor(Qn.RED))}onOriginSide(t){super.onOriginSide(t),this.debug&&this.blueDrawing.addPt(t.shape)}onPolylineGroup(t,e){super.onPolylineGroup(t,e),this.debug&&t.items.forEach(r=>this.greenDrawing.addPly(r))}draw(){this.drawDebug.draw()}};function SB(t,e,r,i,n){let s=y1(),a=new Gde(n);new Hde(t,a,e,r,i,n).simplify();let o=[];a.plGrps.forEach(c=>{let u=c.items.map(d=>VB(d));u[0]&&o.push(new va(u.filter(d=>d)))});let l=new Ga(o);return vA.BooleanTools+=Up(s),l}var TB=!0,xv={intersect(t,e,r,i){try{return bv.intersect(t,e,r,i)}catch(n){if(TB)throw n;return console.error(n),SB(PB,t,e,r,i)}},union(t,e,r,i){try{return bv.union(t,e,r,i)}catch(n){if(TB)throw n;return console.error(n),SB(nde,t,e,r,i)}},diff(t,e,r,i){try{return bv.diff(t,e,r,i)}catch(n){if(TB)throw n;return console.error(n),SB(_B,t,e,r,i)}},xor(t,e,r,i){return bv.xor(t,e,r,i)}};var Yde=class{init(t){}seek(t,e,r,i){let n=t.bbox().extendOfSize(5e-6).intersection1(e.bbox().extendOfSize(5e-6));if(!n)return;let s=y1(),a=[];for(let A=0,h=t.items.length;A<h;A++){let f=t.items[A];if(n.isIntersect(f.bbox()))for(let p=0,m=f.items.length;p<m;p++){let y=f.items[p];if(n.isIntersect(y.bbox()))for(let g=0,b=y.primitives.length;g<b;g++){let E=y.primitives[g].bbox();n.isIntersect(E)&&a.push({bbox:E,polygonIndex:A,polylineIndex:p,ptIndex:g})}}}let o=a.length;if(o===0){vA.IntersectionSeeker+=Up(s);return}let l=[];for(let A=0,h=e.items.length;A<h;A++){let f=e.items[A];if(n.isIntersect(f.bbox()))for(let p=0,m=f.items.length;p<m;p++){let y=f.items[p];if(n.isIntersect(y.bbox()))for(let g=0,b=y.primitives.length;g<b;g++){let E=y.primitives[g].bbox();n.isIntersect(E)&&l.push({bbox:E,polygonIndex:A,polylineIndex:p,ptIndex:g})}}}let c=l.length;if(c===0){vA.IntersectionSeeker+=Up(s);return}if(o<5||c<5){for(let A=0,h=a.length;A<h;A++)for(let f=0,p=l.length;f<p;f++)if(a[A].bbox.isIntersect(l[f].bbox.extendOfSize(1e-5))){let m=a[A],y=l[f];r(m.polygonIndex,m.polylineIndex,m.ptIndex,y.polygonIndex,y.polylineIndex,y.ptIndex)}vA.IntersectionSeeker+=Up(s);return}a.sort((A,h)=>A.bbox.minX-h.bbox.minX),l.sort((A,h)=>A.bbox.minX-h.bbox.minX);let u=0,d=0;for(;u<o&&d<c;)if(a[u].bbox.minX<l[d].bbox.minX){let A=a[u],h=A.bbox;for(let f=d;f<c;f++){let p=l[f],m=p.bbox;if(m.minX>h.maxX+1e-5)break;(h.minY<m.minY?m.minY:h.minY)<(h.maxY<m.maxY?h.maxY:m.maxY)+1e-5&&r(A.polygonIndex,A.polylineIndex,A.ptIndex,p.polygonIndex,p.polylineIndex,p.ptIndex)}u++}else{let A=l[d],h=A.bbox;for(let f=u;f<o;f++){let p=a[f],m=p.bbox;if(m.minX>h.maxX+1e-5)break;(m.minY<h.minY?h.minY:m.minY)<(m.maxY<h.maxY?m.maxY:h.maxY)+1e-5&&r(p.polygonIndex,p.polylineIndex,p.ptIndex,A.polygonIndex,A.polylineIndex,A.ptIndex)}d++}vA.IntersectionSeeker+=Up(s)}},oc,Cc=(oc=class{static getDebug(){return oc.drawDebug||(oc.drawDebug=new Mv(oc.curBus)),oc.drawDebug}static getDrawing(e=Qn.GREEN){return this.getDebug().initColor(e)}static clearDrawing(){oc.getDebug().clear()}static drawText(e,r,i=Qn.GREEN){oc.getDrawing(i).addText(e,r,1.5,.1,!0)}static drawBBox(e,r=Qn.GREEN){if(!e)return;let i=oc.getDrawing(r),n=new Ee(e.UL(),e.UR()),s=new Ee(e.UR(),e.LR()),a=new Ee(e.LR(),e.LL()),o=new Ee(e.LL(),e.UL());i.addPt(n),i.addPt(s),i.addPt(a),i.addPt(o)}static drawPolyType(e,r){let i=oc.getDrawing(r);if(e instanceof Fr)i.addPly(e);else if(e instanceof va)for(let n of e.items)n instanceof Fr?i.addPly(n):this.drawPolyType(n,r);else if(e instanceof Ga)for(let n of e.items)this.drawPolyType(n,r)}static translate(e){switch(e){case 0:return"\u2229";case 2:return"-";case 1:return"U";case 3:return"X";default:break}}},oc.UseRunArrange=!0,oc.UseOptimizeSplit=!0,oc.LocalBestThread=4,oc.HandleDiff=!0,oc.OcTreeSplitStep=4,oc.PrintStart=new ne(150,-200),oc),Ev=class UR{static getPolyTypeLine(e){let r=[];if(e instanceof Fr)for(let i of e.primitives)r.push(i);else if(e instanceof va)for(let i of e.items)if(i instanceof Fr)for(let n of i.primitives)r.push(n);else{let n=this.getPolyTypeLine(i);for(let s of n)r.push(s)}else if(e instanceof Ga)for(let i of e.items){let n=this.getPolyTypeLine(i);for(let s of n)r.push(s)}return r}static getPolyTypePolyLine(e){let r=[];if(e instanceof Fr)r.push(e);else if(e instanceof va)for(let i of e.items)if(i instanceof Fr)r.push(i);else{let n=this.getPolyTypePolyLine(i);for(let s of n)r.push(s)}else if(e instanceof Ga)for(let i of e.items){let n=this.getPolyTypePolyLine(i);for(let s of n)r.push(s)}return r}static getListBBox(e){if(e.length<=0)return;let r=new pr;for(let i of e){let n=UR.getSingleBBox(i);r.ext1(n)}return r.build1()}static getSingleBBox(e){if(e instanceof Array){let r=new pr,i=UR.getListBBox(e.slice(1));return r.ext1(i),r.build1()}else return e.bbox()}static doDrawRule(e,r=Cc.PrintStart){if(e.length<2)return[r,r,r];let i=5,n=10,s=e[0],a=Cc.translate(s),o=[],l=r.y,c=r.x,u=r.x;r=r.add(new ne(0,-n));for(let h=1;h<e.length;h++){let f=e[h];if(f instanceof Array){r=r.add(new ne(i,0));let p=this.doDrawRule(f,r);o.push(p[0]),p[1].x<=c&&(c=p[1].x),p[2].x>=u&&(u=p[2].x),r=new ne(p[2].x+i,r.y)}else o.push(r.clone()),r.x<=c&&(c=r.x),r.x>=u&&(u=r.x),Cc.drawText(r,f.name),r=r.add(new ne(i,0))}let d=0;for(let h of o)d+=h.x;let A=new ne(d/o.length,r.y+n);Cc.drawText(A,"N:"+a);for(let h of o){let f=new Ee(h,A),p=new Array;p.push(f);let m=Fr.build1(PR(p));Cc.drawPolyType(m,Qn.GREEN)}return[A,new ne(c,l),new ne(u,l)]}static drawRule(e,r=Cc.PrintStart,i=!1,n){Cc.clearDrawing(),this.doDrawRule(e,r),i&&this.doDrawRulePolygon(e,n),Cc.getDebug().draw()}static doDrawRulePolygon(e,r){let i=e[0];for(let n=1;n<e.length;n++){let s=e[n];if(s instanceof Array)this.doDrawRulePolygon(s,r);else{let a=r;i===2&&n===1&&(a=Qn.RED),s.name&&Cc.drawText(s.bbox().UL(),s.name,a),Cc.drawPolyType(s,a)}}}static IsCenterBBoxPointInPolygonType(e,r){let i=e.center();for(let n of r.items)if(n.getOutMostPolyline().getWindingNum(i))return!0;return!1}static KeepBBoxPolygonGroup(e,r){let i=r.bbox().intersection1(e);if(!i)return!1;for(let n of r.items)if(n.bbox().isIntersect(i)){for(let s of n.items)if(s.bbox().isIntersect(i)){for(let a of s.primitives)if(i.isIntersect(a.bbox()))return!0}}return!!this.IsCenterBBoxPointInPolygonType(e,r)}},Vde=class Fx{static createNode(e,r,i){let n=e.UL(),s=e.width()/r,a=e.height()/r,o=~~(i/r),l=i-o*r,c=n.x+l*s,u=n.y-(o+1)*a,d=c+s,A=u+a;return new Mr(c,d,u,A)}static ocTreeSplitNode(e,r,i,n,s=2){if(e.length<=i)return e;let a=[],o=s**2,l=new Array(o),c=new Array(o);for(let h=0;h<o;h++)l[h]=new Array(e.length),c[h]=0;let u=r.UL(),d=r.width()/s,A=r.height()/s;for(let h of e){let f=n(h).center(),p=~~((f.x-u.x)/d),m=~~((u.y-f.y)/A)*s+p;try{l[m][c[m]]=h,c[m]+=1}catch{a.push(h)}}for(let h=0;h<l.length;h++){let f=c[h];if(f<=0)continue;let p=l[h].slice(0,f);if(p.length===e.length)return e;let m=Fx.createNode(r,s,h),y=Fx.ocTreeSplitNode(p,m,i,n,s);if(y.length===e.length)return e;a.push(y)}return a}static ocTreeSplitNodeMinIntersect(e,r,i,n){let s=[];if(e.length<=i)return e;let a=3,o=r.LL(),l=r.UR(),c=r.width()/(a+1),u=r.height()/(a+1),d=-(2**32),A=[],h=[];for(let f=1;f<=a;f++)for(let p=1;p<=a;p++){let m=o.x+c*f,y=o.y+u*p,g=[[],[],[],[]],b=new Array(4),E=new Array(4);E[0]=new Mr(o.x,m,y,l.y),E[1]=new Mr(m,l.x,y,l.y),E[2]=new Mr(o.x,m,o.y,y),E[3]=new Mr(m,l.x,o.y,y);for(let C of e){let G=n(C).center(),U=-1,_=-1;G.x===m?U=Math.random()>=.5?1:-1:G.x>m?U=1:G.x<m&&(U=-1),G.y===y?_=Math.random()>=.5?1:-1:G.y>y?_=1:G.y<y&&(_=-1),U===1&&_===1?g[1].push(C):U===1&&_===-1?g[3].push(C):U===-1&&_===-1?g[2].push(C):U===-1&&_===1&&g[0].push(C)}for(let C=0;C<4;C++){let G=g[C];if(G.length<=0)continue;let U=new pr;for(let _ of G)U.ext1(n(_));b[C]=U.build1()}let w=0,x=0;for(let C of b)C&&(w+=C.area());x=w;let I=(C,G)=>{if(!b[C]||!b[G])return 0;let U=b[C].intersection1(b[G]);return U?U.area():0};x-=I(0,1),x-=I(0,2),x-=I(0,3),x-=I(1,2),x-=I(1,3),x-=I(2,3),x/w>=d&&(A=g,h=E)}for(let f=0;f<A.length;f++){let p=A[f];if(p.length<=0)continue;let m=h[f],y;if(p.length===e.length?y=Fx.ocTreeSplitNode(p,m,i,n):y=Fx.ocTreeSplitNodeMinIntersect(p,m,i,n),y.length===e.length)return e;s.push(y)}return s}static ocTreeSplit(e,r,i,n){return Fx.ocTreeSplitNode(e,r,i,n,Cc.OcTreeSplitStep)}},jde=class LG{static simplifyRules(e,r){return Cc.UseOptimizeSplit&&(e=this.optimizeSplit(e,r)),e}static OcTreeOptimizeSplit(e){let r=e[0];if(r!==1||e.length<=Cc.LocalBestThread+1)return e;let i=e.slice(1),n=new Array(i.length);for(let c=1;c<e.length;c++)n[c-1]=c;let s=Ev.getListBBox(i),a=Vde.ocTreeSplit(n,s,Cc.LocalBestThread,c=>{let u=e[c];return Ev.getSingleBBox(u)}),o=(c,u)=>{if(!(c.length<=0))for(let d of c)if(Array.isArray(d)){let A=[u[0]];o(d,A),u.push(A)}else{let A=e[d];u.push(A)}},l=[r];return o(a,l),l}static optimizeSplit(e,r){let i=e[0];if(i===2){if(Cc.HandleDiff){let s=e[1],a;if(Array.isArray(s)){let o=this.optimizeSplit(s,r);if(o.length<=1)return[2];a=HR(o,r)}else a=HR([2,s],r);if(e.length>3){let o;o=[1];for(let l=2;l<e.length;l++){let c=e[l];if(Array.isArray(c)){let u=Ev.getListBBox([...c.slice(1)]);Ev.KeepBBoxPolygonGroup(u,a)&&o.push(c)}else Ev.KeepBBoxPolygonGroup(c.bbox(),a)&&o.push(c)}return o.length<=1?[2,a]:(o=this.optimizeSplit(o,r),o.length>1?[2,a,...o.slice(1)]:[2,a])}else{let o=e[2];if(Array.isArray(o)&&o[0]===1&&o.length>2){let l=o.slice(1);return this.optimizeSplit([2,a,...l],r)}}}else if(e.slice(1).length>2){let s=e[1],a=e.slice(2),o=this.optimizeSplit([1,...a],r);return o.length>1?[2,s,...o.slice(1)]:s}}else if(i===1){if(e.length-1>Cc.LocalBestThread){let s=!1;for(let a=1;a<e.length;a++){let o=e[a];if(!Array.isArray(o)){s=!0;break}}s&&(e=LG.OcTreeOptimizeSplit(e))}}else if(i===0&&e.length<=2)return[0];let n=[i];for(let s=1;s<e.length;s++){let a=e[s];if(Array.isArray(a)){let o=this.optimizeSplit(a,r);if(o.length<=1)continue;n.push(o)}else n.push(a)}return n}},Lf=(t=>(t[t.INTERSECT=0]="INTERSECT",t[t.UNION=1]="UNION",t[t.DIFF=2]="DIFF",t[t.XOR=3]="XOR",t))(Lf||{});function Iv(t){let e=t[0],r=[e];switch(e){case 0:for(let n=1;n<t.length;n++){let s=t[n];if(Array.isArray(s)&&(s=Iv(s),!s))return null;r.push(s)}break;case 1:case 3:for(let n=1;n<t.length;n++){let s=t[n];Array.isArray(s)&&(s=Iv(s),!s)||r.push(s)}break;case 2:let i=t[1];if(Array.isArray(i)&&(i=Iv(i)),!i)return null;r.push(i);for(let n=2;n<t.length;n++){let s=t[n];Array.isArray(s)&&(s=Iv(s),!s)||r.push(s)}break;default:throw new Error("not support boolean rule!")}return r.length===1?null:r}function BR(t,e,r){return Array.isArray(t)?OG(t,e,r):t}function DR(t,e,r,i,n=!0){if(n)for(;t.length>1;){let s,a=[];for(t.length%2===1?(a.push(t[0]),s=1):s=0;s<t.length;s+=2)a.push(e(t[s],t[s+1],r,i));t=a}else for(;t.length>1;){if(t.length===2)return e(t[0],t[1],r,i);t=[e(t[0],t[1],r,i),...t.slice(2)]}return t[0]}function OG(t,e,r,i=!0){let n=new Array(t.length-1);for(let s=1;s<t.length;s++)n[s-1]=BR(t[s],e,r);switch(t[0]){case 0:return DR(n,xv.intersect,e,r);case 1:return DR(n,xv.union,e,r);case 2:let s=DR(n.slice(1),xv.union,e,r);return s?xv.diff(n[0],s,e,r):n[0];case 3:let a=BR(t[1],e,r);for(let o=2;o<t.length;o++)a=xv.xor(a,BR(t[o],e,r),e,r);return a;default:throw new Error("not support boolean rule! "+t[0])}}function NG(t){let e=[t[0]];for(let r=1;r<t.length;r++){let i=t[r];if(Array.isArray(i)){let n=NG(i);Array.isArray(n)?n.length>1&&e.push(n):e.push(n)}else{let n=VB(i);n!==null&&e.push(Ga.build(n))}}return e}function XR(t,e){Cc.curBus=e,t=NG(t);let r;return Cc.UseRunArrange?r=jde.simplifyRules(t,e):r=Iv(t),r.length<=1?new Ga([]):HR(r,e)}function HR(t,e,r=!0){if(!t||t.length===1)return new Ga([]);let i=t,n=new Yde,s=[];function a(o){for(let l=1;l<o.length;l++){let c=o[l];Array.isArray(c)?a(c):s.push(c)}}return a(i),n.init(s),OG(i,n,e,r)}var IB=new Error("list is empty"),BB=class{constructor(t,e){this.prev=null,this.next=null,this.parent=t,this.item=e}insertAfter(t){t.next=this.next,this.next=t,t.prev=this,t.next!==null&&(t.next.prev=t)}insertBefore(t){t.prev=this.prev,this.prev=t,t.next=this,t.prev!==null&&(t.prev.next=t)}remove(){this.prev!==null&&(this.prev.next=this.next),this.next!==null&&(this.next.prev=this.prev)}set(t){this.item=t}},Qde=class{constructor(t){this._next=t}hasNext(){return this._next!==null}next(){let t=this._next;if(t!==null)return this._next=t.next,t.item;throw new Error("iterator is null")}},zde=class{constructor(t){this._next=t}hasNext(){return this._next!==null}next(){let t=this._next;if(t!==null)return this._next=t.next,t;throw new Error("iterator is null")}},Xde=class{constructor(){this.first=null,this.last=null,this.cnt=0}add(t){return this.addLast(t)}push(t){return this.addLast(t)}pop(){return this.removeLast()}shift(){return this.removeFirst()}removeFirst(){let t=this.first;if(t===null)throw IB;return this.remove(t),t.item}removeLast(){let t=this.last;if(t===null)throw IB;return this.remove(t),t.item}addLast(t){if(this.first===null||this.last===null){let e=new BB(this,t);return this.first=e,this.last=e,this.cnt++,e}else return this.insertAfter(this.last,t)}addFirst(t){if(this.first===null||this.last===null){let e=new BB(this,t);return this.first=e,this.last=e,this.cnt++,e}else return this.insertBefore(this.first,t)}getFirst(){if(this.first===null)throw IB;return this.first.item}getLast(){if(this.last===null)throw IB;return this.last.item}insertAfter(t,e){let r=new BB(this,e);return t.insertAfter(r),t===this.last&&(this.last=r),this.cnt++,r}insertBefore(t,e){let r=new BB(this,e);return t.insertBefore(r),t===this.first&&(this.first=r),this.cnt++,r}remove(t){t.remove(),t===this.first&&(this.first=t.next),t===this.last&&(this.last=t.prev),this.cnt--}size(){return this.cnt}clear(){this.first=null,this.last=null,this.cnt=0}iterator(){return new Qde(this.first)}listIterator(){return new zde(this.first)}toArray(){let t=new Array,e=this.first;for(;e!=null;)t.push(e.item),e=e.next;return t}},NB=class{constructor(t){this.inters=[],t&&(this.inters=t)}addInter(t){this.inters.push(t),t.group=this}findInter(t){let e=this.inters.find(r=>Vr(r.coord,t.coord));return e&&this.inters.find(r=>r.side===t.side)&&t.visitSelf(),e}getOutInter(t){let e=this.inters.filter(r=>!r.getVisited());if(e.length!==0)return e.length===1?e[0]:e.reduce((r,i)=>{if(!r||r.side.getShape()===t)return i;if(i.side.getShape()===t)return r;let n=r.coord,s=oi(t,n),a=oi(r.side.getShape(),n),o=oi(i.side.getShape(),n);return s.dot(a)>s.dot(o)?r:i},void 0)}getEntryInter(){}},_R=0;function RG(t,e){let r=t.primitives[0];if(t.primitives.length===1&&r instanceof ze&&Math.abs(r.sweepAngle)===360)return[t];let i=y1();_R++;let n,s=rAe(t);if(s.length===0)return[];let a=Kde(s);if(_R===-1){n=new Mv(e);let u=n.initColor(Qn.BLUE);s.forEach(A=>u.addPt(A.getShape()));let d=n.initColor(Qn.GREEN);a.forEach(A=>d.addPoint(A.coord)),n.draw();debugger;throw new Error}if(a.length===0)return[Fr.build7(s.map(u=>u.getShape()))];Jde(a);let o=[],l=!1;try{eAe(a,n)}catch(u){u.customType==="IS_OVERLAP"?(l=!0,o=new Cv().getUnion([t]).map(d=>d.items).flat(2)):console.error(u)}if(l)return o;let c=Zde(a);if(!c.length)return[Fr.build7(s.map(u=>u.getShape()))];if(o=qde(c,n),o.length===0)return console.warn("=====deSelfIntersection=====",_R),[];if(n)throw o.forEach(u=>{n.initColor(Qn.WHITE).addPly(u),n.draw();debugger}),new Error;return vA.deSelfIntersection+=Up(i),o}function qde(t,e){let r=[];return t.forEach(i=>{let n=i;i.inters.forEach(s=>{if(s.getVisited())return;let a=[],o=[],l;if(e){debugger;let u=e.initColor(Qn.RED);l=d=>{a.push(d),u.addPt(a[a.length-1]),e.draw();debugger}}else l=u=>a.push(u);do{let u=function(p,m){wt.eq(p.distance2(m),0)||l(MG(h.getShape(),p,m))},d=o.findIndex(p=>p===s.group);if(d!==-1){let p=a.findIndex(g=>g===s.group),m=a.splice(p).filter(g=>!(g instanceof NB));if(m.length){let g=Pf(Fr.build7(m));g&&r.push(g)}let y=a.filter(g=>!(g instanceof NB));if(s=o[d].getOutInter(y[y.length-1]),o.splice(d),!s)throw Error("interGroup not hav inter!!!2");continue}s.visitSelf(),o.push(s.group),a.push(s.group);let A=s.getIndex(),h=s.side,f=h.inters[A+1];for(;f!=null&&f.isInvalid||f&&f.group===s.group;)f=h.inters[f.getIndex()+1];if(f){u(s.coord,f.coord);let p=f.getBindedInter();if(s=p.getVisited()?p.group.getOutInter(p.side.getShape()):p,!s){if(f.group===n)break;throw new Error("interGroup not hav inter!!!3")}}else{for(u(s.coord,h.getEnd()),h=h.nextSide,s=null;;){for(let p of h.inters)if(!p.isInvalid){let m=p.group.getOutInter(h.getShape());if(!m){if(p.group===n){s=p;break}else if(p.getBindedInter().group===n){s=p.getBindedInter();break}continue}s=m;break}if(s)break;l(h.getShape()),h=h.nextSide}wt.eq(h.getEnd().distance2(s.coord),0)?l(h.getShape()):u(h.getStart(),s.coord)}}while(s.group!==n);let c=Pf(Fr.build7(a.filter(u=>!(u instanceof NB))));c&&r.push(c)})}),r}function Wde(t){return{next(){return t.hasNext()?{value:t.next()}:{done:!0,value:void 0}},[Symbol.iterator](){return this}}}function Kde(t){let e=[],r=new Xde;for(let i of t.slice().sort((n,s)=>n.bbox().minY-s.bbox().minY)){for(let n of Wde(r.listIterator())){let s=n.item;if(s.bbox().maxY<i.bbox().minY)r.remove(n);else{let a=function(A,h){let f=new Xm(h,A,null);return A.inters.push(f),e.push(f),f},o=function(A,h){let f=A.getEnd(),p=new ne(Be[0],Be[1]),m=new ne(Be[2],Be[3]),y=f.distance2(p)>f.distance2(m)?p:m,g=A.prevSide;a(Vr(g.getEnd(),y)?g:A,y).bind(a(h,y))},l=s.getShape(),c=i.getShape(),u=wA(l,c),d=u===4&&Be[0]===Be[2]&&Be[1]===Be[3];if(d&&(u-=2),s.nextSide===i)s.prevSide!==i&&u===4&&o(s,i);else if(s.prevSide===i)u===4&&o(i,s);else if(u!==0){let A=function(f,p){let m=f.prevSide;return a(Vr(m.getEnd(),p)?m:f,p)},h=new ne(Be[0],Be[1]);if(d&&!Vr(h,s.prevSide.getEnd())&&!Vr(h,i.prevSide.getEnd())&&oi(l,h).dot(oi(c,h))>0)continue;for(let f=0;f<u;f+=2){let p=new ne(Be[f],Be[f+1]);A(s,p).bind(A(i,p))}}}}r.add(i)}return e.forEach(i=>{i.getIndex()===void 0&&i.side.sortInters()}),e}function Jde(t){t.forEach(e=>{let r=e.side.getEnd();if(e.isInvalid||!Vr(e.coord,r))return;let i=e.side.inters,n=e.getBindedInter().side;for(let s=i.length-1;s>=0;s--){let a=i[s];if(!Vr(a.coord,r))break;a!==e&&a.getBindedInter().side===n&&a.setIsInvalid()}})}function $de(t){let e=new Lv(10);return t.forEach(r=>{r.isInvalid||e.add(r)}),e}function Zde(t){let e=[],r=$de(t);return t.forEach(i=>{if(i.isInvalid||i.group)return;let n=r.search(i.bbox().extendOfSize(wt.eps)).filter(s=>!s.group);if(n.length){let s=new Set,a=new NB(n);n.forEach(o=>{o.group=a,s.has(o.side)&&o.visitSelf(),s.add(o.side)}),e.push(a)}}),e}function eAe(t,e){t.forEach(r=>{if(r.isInvalid||r.dealed)return;let i=r.side,n=r.getBindedInter().side,s;Vr(i.getEnd(),r.coord)&&Vr(n.getEnd(),r.coord)?s=-1:Vr(i.getEnd(),r.coord)?i.nextSide!==n&&(s=1,r=r.getBindedInter()):Vr(n.getEnd(),r.coord)&&n.nextSide!==i&&(s=1),tAe(s,r,e),r.isDealed()})}function tAe(t,e,r){let i=e.getBindedInter(),n=e.side,s=i.side,a=n.getShape(),o=s.getShape(),l=1,c=!1;if(t===-1){if(Ox(a.reverse(),o.reverse())||Ox(n.nextSide.getShape(),s.nextSide.getShape())){let d=Qm(n,n.nextSide,s,i,l,c,r);if(d.state===2){let h=new Error("info1.state === InState.IS_OVERLAP");throw h.customType="IS_OVERLAP",h}let A=Qm(n,n.nextSide,s.nextSide,i,l,c,r);d.state===A.state&&u(d,A)}else if(!(Ox(a.reverse(),s.nextSide.getShape())||Ox(n.nextSide.getShape(),o.reverse()))){let d=vR(n,n.nextSide,s,!1,r);d===vR(n,n.nextSide,s.nextSide,!0,r)&&d!==vR(s,s.nextSide,n.nextSide,!0,r)&&e.setIsInvalid()}}else if(t===1){let d=function(A,h){return oi(A,h.start()).dot(oi(h,h.start()))>0};if(Ox(a.reverse(),o.reverse())||Ox(a,s.nextSide.getShape())){let A=kd(n,s,i,r,l,c,new Map);if(A.state===2){let f=new Error("info1.state === InState.IS_OVERLAP");throw f.customType="IS_OVERLAP",f}let h=kd(n,s.nextSide,i,r,l,c,new Map);A.state===h.state&&u(A,h)}else if(d(a.reverse(),o.reverse())&&d(a,s.nextSide.getShape())){let A=Ml(n,s,!1,r);A===Ml(n,s.nextSide,!0,r)&&A!==m1(s,s.nextSide,new kv(MG(a,e.coord,a.end()),r),!0,r)&&e.setIsInvalid()}}function u(d,A){d.inter.setIsInvalid(),A.inter.setIsInvalid(),e.setIsInvalid()}}function MG(t,e,r){if(t instanceof Ee||e.distance2(r)<1e-6)return new Ee(e,r);if(t instanceof ze)return ze.build2(t.center,e.angleD(t.center),r.angleD(t.center),t.rx,t.ry,t.sweep());if(t instanceof Nt){let i=t.getPercent(e,li),n=t.getPercent(r,li);return t.clip(i)[1].clip((n-i)/(1-i))[0]}else throw new Error("not supported operation")}function rAe(t){let e=Pf(t);if(!e)return[];let r=e.primitives.map(n=>new kv(n,null)),i=r[r.length-1];return r.forEach(n=>{i.connect(n),i=n}),r}var Km,iAe=(Km=class{static clearData(e){this.originalPrimitive=[],this.offsetPrimitive=[],this.rawOffsetPrimitive=[],this.offsetDistance=0,this.testI++,this.testI===0?this.drawDebug=new Mv(e):delete this.drawDebug}static createRawOffsetEdge(){if(this.drawDebug){let e=this.drawDebug.initColor(Qn.WHITE);this.originalPrimitive.forEach(r=>e.addPt(r)),this.drawDebug.draw();debugger}for(let e=0;e<this.originalPrimitive.length;e+=1){let r=this.originalPrimitive[e];this.offsetPrimitive.push({index:e,offsetEdge:this.createOffsetEdge(r)})}if(this.drawDebug){let e=this.drawDebug.initColor(Qn.Golden);this.offsetPrimitive.forEach(r=>e.addPt(r.offsetEdge)),this.drawDebug.draw();debugger}if(this.offsetPrimitive.length>1)for(let e=0;e<this.offsetPrimitive.length;e+=1)if(e===this.offsetPrimitive.length-1){this.connectPrimitive(this.offsetPrimitive[e],this.offsetPrimitive[0]);let r=this.rawOffsetPrimitive[0],i;r instanceof ze?i=ze.build4(this.offsetPrimitive[0].offsetEdge.start(),r.end(),r.center,r.rx,r.ry,r.sweep()):i=new Ee(this.offsetPrimitive[0].offsetEdge.start(),r.end()),this.rawOffsetPrimitive.shift(),this.rawOffsetPrimitive.unshift(i)}else this.connectPrimitive(this.offsetPrimitive[e],this.offsetPrimitive[e+1]);else this.rawOffsetPrimitive=[]}static createCirclePrimitive(e,r){let i=e.width()*.5,n=e.height()*.5,s=Math.sqrt(i**2+n**2)+r;return[ze.buildCircle(e.center(),s)]}static getExtendPolyLine(e,r,i=!0,n){var o,l;if(!((o=e==null?void 0:e.primitives)!=null&&o.length))return[];let s=Pf(e);if(!((l=s==null?void 0:s.primitives)!=null&&l.length)){if(this.isExpansion){let c=[1],u=r*2;e.primitives.forEach(A=>c.push(A.stroke(u,1,0)));let d=XR(c,n);if(d.items.length!==1)throw new Error("group.items.length !== 1 ");return[d.items[0].items[0]]}return[]}if(e=s,this.clearData(n),this.originalPrimitive=e.primitives,this.isExpansion=r>0,this.offsetDistance=r,this.createRawOffsetEdge(),this.drawDebug){let c=this.drawDebug.initColor(Qn.BLUE);this.rawOffsetPrimitive.forEach(u=>c.addPt(u)),this.drawDebug.draw();debugger}let a=i?this.createClippingEdge(n):[Fr.build2(this.rawOffsetPrimitive)];if(this.drawDebug){let c=this.drawDebug.initColor(Qn.RED);a.forEach(u=>c.addPly(u)),this.drawDebug.draw();debugger}if(a.length&&(!this.isExpansion||this.isExpansion&&a.length>1)&&(a=this.getValidityPrimitive(a)),this.drawDebug){let c=this.drawDebug.initColor(Qn.GREEN);a.forEach(u=>c.addPly(u)),this.drawDebug.draw();debugger;throw new Error}return a}static getValidityPrimitive(e){let r=[],i=Math.abs(this.offsetDistance);for(let n=0;n<e.length;n+=1){let s=!0,a=e[n].primitives;e:for(let o=0;o<a.length;o+=1){let l=a[o],c;if(l instanceof ze)c=l.midPoint;else if(l instanceof Ee)c=l.start();else throw new Error("not support!");for(let u=0;u<this.originalPrimitive.length;u+=1){let d=this.originalPrimitive[u],A;if(d instanceof ze?A=this.pointArcClosest(c,d):A=Hhe(c,d.start(),d.end()).d,i-A>.01){s=!1;break e}}}s&&r.push(e[n])}return r}static getInters(e){let r=[];for(let i=0;i<e;i+=2)r.push(new ne(Be[i],Be[i+1]));return r}static pointArcClosest(e,r){let i=r.center;if(e.equals1(r.center))return r.rx;if(r.inArea(e,0)){let a=e.sub(i);return Math.abs(a.length()-r.rx)}let n=e.distance2(r.start()),s=e.distance2(r.end());return wt.less(n,s)?Math.sqrt(n):Math.sqrt(s)}static createClippingEdge(e){let r=[],i=[],n=RG(Fr.build2(this.rawOffsetPrimitive),e);n.forEach(a=>{let o=a.area(.01);r.push(o)});let s=Math.min(...r.filter(a=>a<0));for(let a=0;a<r.length;a+=1){let o=r[a];wt.eq(o,0)||(!this.isExpansion&&o<0||this.isExpansion&&(o<0&&r[a]===s||o>0))&&i.push(n[a])}return i}static createOffsetEdge(e){if(e instanceof ze)return e.panDistance1(this.offsetDistance);if(e instanceof Ee)return e.panDistance(this.offsetDistance);throw new Error("not support!")}static connectPrimitive(e,r){e.offsetEdge instanceof Ee&&r.offsetEdge instanceof Ee?this.lineToLineConnect(e,r):e.offsetEdge instanceof ze&&r.offsetEdge instanceof ze?this.arcToArcConnect(e,r):e.offsetEdge instanceof Ee&&r.offsetEdge instanceof ze?this.lineToArcConnect(e,r):this.arcToLineConnect(e,r)}static isFalseIntersection(e){return e>1||e<0}static lineToLineConnect(e,r){let i=e.offsetEdge,n=r.offsetEdge,s=r.index,a=this.originalPrimitive[s].start();if(i.isParallel(n))i.bbox().intersection1(n.bbox())?this.rawOffsetPrimitive.push(i):this.lineToLineUseArcToConnect(a,i,n);else{let o=this.getLineToLineT(i,n),l=o[0],c=o[1];if(this.isFalseIntersection(l)||this.isFalseIntersection(c))l>1&&this.isFalseIntersection(c)?this.lineToLineUseArcToConnect(a,i,n):this.useLineToConnect(i,n);else if(!this.isFalseIntersection(l)&&!this.isFalseIntersection(c)){let u=i.end().sub(i.start()),d=i.start().add(u.mul(l)),A=new Ee(i.start(),d);this.rawOffsetPrimitive.push(A);let h=new Ee(d,n.end());this.updateNextOffsetPrimitive(s,h)}}}static updateNextOffsetPrimitive(e,r){this.offsetPrimitive[e].offsetEdge=r}static useLineToConnect(e,r){this.rawOffsetPrimitive.push(e);let i=new Ee(e.end(),r.start());this.rawOffsetPrimitive.push(i)}static lineToLineUseArcToConnect(e,r,i){let n=this.getSweep(e,r),s=this.getSweepAngel(r.end(),i.start(),e,n);if(s===0){this.useLineToConnect(r,i);return}this.rawOffsetPrimitive.push(r);let a=ze.build5(r.end(),i.start(),s);this.rawOffsetPrimitive.push(a)}static getSweep(e,r,i){let n=null,s=i||i===0?this.originalPrimitive[i]:r;if(s instanceof ze){let a=s.center.sub(s.end()).normalize();s.isCCW?n=new ne(a.y,-a.x):n=new ne(-a.y,a.x)}else n=r.end().sub(r.start()).normalize();return e.sub(r.end()).normalize().cross(n)>0?0:1}static getLineToLineT(e,r){let i=e.end().sub(e.start()),n=r.end().sub(r.start()),s=i.cross(n),a=r.start().sub(e.start()),o=e.start().sub(r.start()),l=a.cross(n)/s,c=o.cross(i)/-s;return[l,c]}static lineToArcConnect(e,r){let i=e.offsetEdge,n=r.offsetEdge,s=e.index,a=r.index,o=this.getLineJoinArcScalarAndIntersectionNum(i,n),l=this.originalPrimitive[a].start();if(o.intersectionNum===0)this.lineAndArcUseArcConnect(l,i,n,s);else if(o.intersectionNum===1){let c=o.points[0];this.lineAndArcConnectionDetail(i,n,o.t[0],c,l,s,a)}else if(o.intersectionNum===2){let c=o.points[0],u=o.points[1],d=c.distance2(l),A=u.distance2(l);this.lineAndArcConnectionDetail(i,n,d<A?o.t[0]:o.t[1],d<A?c:u,l,s,a)}}static lineAndArcConnectionDetail(e,r,i,n,s,a,o){let l=this.isTrueArcIntersection(r,n);if(!this.isFalseIntersection(i)&&l){let c=new Ee(e.start(),n);this.rawOffsetPrimitive.push(c);let u;!r.center.equals1(n)||r.sweepAngle>1e-4?(u=ze.build4(n,r.end(),r.center,r.rx,r.ry,r.sweep()),u instanceof ze&&u.sweepAngle===0&&(u=new Ee(u.start(),u.end()))):u=new Ee(r.center,n),this.updateNextOffsetPrimitive(o,u)}else l?this.useLineToConnect(e,r):this.lineAndArcUseArcConnect(s,e,r,a)}static lineAndArcUseArcConnect(e,r,i,n){let s=this.getSweep(e,r,n),a=this.getSweepAngel(r.end(),i.start(),e,s);if(a===0){this.useLineToConnect(r,i);return}let o=ze.build5(r.end(),i.start(),a);this.rawOffsetPrimitive.push(r),this.rawOffsetPrimitive.push(o)}static arcToLineConnectionDetail(e,r,i,n,s,a,o){let l=this.isTrueArcIntersection(e,n);if(!this.isFalseIntersection(i)&&l){let c;e.center.equals1(n)?c=new Ee(e.center,n):Math.abs(e.sweepAngle)<1e-4?c=new Ee(e.start(),n):(c=ze.build4(e.start(),n,e.center,e.rx,e.ry,e.sweep()),c instanceof ze&&c.sweepAngle===0&&(c=new Ee(c.start(),c.end()))),this.rawOffsetPrimitive.push(c);let u=new Ee(n,r.end());this.updateNextOffsetPrimitive(o,u)}else l?this.useLineToConnect(e,r):this.lineAndArcUseArcConnect(s,e,r,a)}static isTrueArcIntersection(e,r){return xo(e,r)}static getSweepAngel(e,r,i,n){let s=e.angleD(i),a=r.angleD(i),o;return s===a?o=0:(s=Ti.regularD(s),a=Ti.regularD(a),n===1?a<=s&&(a+=360):a>=s&&(s+=360),o=a-s),o}static getLineJoinArcScalarAndIntersectionNum(e,r){let i={t:[],intersectionNum:0,points:[]},n=khe(r,e);if(n){i.intersectionNum=n/2;for(let s=0;s<n-1;s+=2){let a=new ne(Be[s],Be[s+1]);i.points.push(a),a.sub(e.start()).x<1e-4||a.sub(e.start()).y<1e-4?i.t.push(0):i.t.push(a.sub(e.start()).x/e.end().sub(e.start()).x)}}else i.intersectionNum=0;return i}static arcToLineConnect(e,r){let i=e.offsetEdge,n=r.offsetEdge,s=e.index,a=r.index,o=this.getLineJoinArcScalarAndIntersectionNum(n,i),l=this.originalPrimitive[a].start();if(o.intersectionNum===0)this.lineAndArcUseArcConnect(l,i,n,s);else if(o.intersectionNum===1){let c=o.points[0];this.arcToLineConnectionDetail(i,n,o.t[0],c,l,s,a)}else if(o.intersectionNum===2){let c=o.points[0],u=o.points[1],d=c.distance2(l),A=u.distance2(l);this.arcToLineConnectionDetail(i,n,d<A?o.t[0]:o.t[1],d<A?c:u,l,s,a)}}static rxChangeStatus(e){return e===1?!this.isExpansion:this.isExpansion}static arcToArcConnect(e,r){let i=e.offsetEdge,n=r.offsetEdge,s=pG(i,n);if(s){let a=this.getInters(s),o;if(a.length===2){let u=this.originalPrimitive[r.index].start(),d=a[0],A=a[1],h=d.distance2(u),f=A.distance2(u);h<f?o=d:o=A}else o=a[0];let l,c;o.equals1(i.center)?l=new Ee(i.center,o):Math.abs(i.sweepAngle)<1e-4?l=new Ee(i.start(),o):(l=ze.build4(i.start(),o,i.center,i.rx,i.ry,i.sweep()),l instanceof ze&&l.sweepAngle===0&&(l=new Ee(l.start(),l.end()))),this.rawOffsetPrimitive.push(l),o.equals1(n.center)?c=new Ee(o,n.center):Math.abs(n.sweepAngle)<1e-4?c=new Ee(o,n.end()):(c=ze.build4(o,n.end(),n.center,n.rx,n.ry,n.sweep()),c instanceof ze&&c.sweepAngle===0&&(c=new Ee(c.start(),c.end()))),this.updateNextOffsetPrimitive(r.index,c)}else{let a=this.originalPrimitive[e.index],o=this.originalPrimitive[r.index],l=this.rxChangeStatus(a.sweep()),c=this.rxChangeStatus(o.sweep()),u=this.originalPrimitive[r.index].start(),d=this.getSweep(u,i,e.index),A=Math.abs(this.offsetDistance),h=ze.build2(u,l?a.endAngle():a.endAngle()+180,c?o.startAngle:o.startAngle+180,A,A,d);this.rawOffsetPrimitive.push(i),this.rawOffsetPrimitive.push(h)}}},Km.originalPrimitive=[],Km.offsetPrimitive=[],Km.rawOffsetPrimitive=[],Km.testI=0,Km),nAe=class Bv extends Nv{constructor(e,r,i,n,s,a){if(super(),r<0||i<0)throw new Error("The width and height of rect can't be less than 0!");this.leftUpPoint=e,this.width=r,this.height=i,this.angle=n,this.isCCW=s,this.radius=Math.min(Math.max(a,0),r/2,i/2)}get radiusRatio(){return this.radius/Math.min(this.width,this.height)}start(){return this.leftUpPoint.add(new ne(this.radius,0).multiply3(Ue.rotateD(this.angle)))}end(){return this.start()}getLeftPoint(){return this.leftUpPoint.add(new ne(0,-this.height/2).multiply3(Ue.rotateD(this.angle)))}getRightPoint(){return this.leftUpPoint.add(new ne(this.width,-this.height/2).multiply3(Ue.rotateD(this.angle)))}extend(e){return new Bv(this.leftUpPoint.add(new ne(-e,e).rotateD(ne.ORIGIN,this.angle)),this.width+e*2,this.height+e*2,this.angle,this.isCCW,this.radius+e)}bbox(){let e=Ue.rotateD(this.angle),{leftUpPoint:r,width:i,height:n,radius:s}=this,a=r.add(new ne(s,-s).multiply3(e)),o=r.add(new ne(s,s-n).multiply3(e)),l=r.add(new ne(i-s,-s).multiply3(e)),c=r.add(new ne(i-s,s-n).multiply3(e));return new Mr(Math.min(a.x,o.x,l.x,c.x)-s,Math.max(a.x,o.x,l.x,c.x)+s,Math.min(a.y,o.y,l.y,c.y)-s,Math.max(a.y,o.y,l.y,c.y)+s)}toPolyline(){let e=[],{leftUpPoint:r,width:i,height:n,radius:s}=this;if(s===0){let o=ne.ORIGIN,l=new ne(i,0),c=new ne(i,-n),u=new ne(0,-n);e.push(new Ee(o,l),new Ee(l,c),new Ee(c,u),new Ee(u,o))}else{let o=new ne(0,-s),l=new ne(s,0),c=new ne(i-s,0),u=new ne(i,-s),d=new ne(i,s-n),A=new ne(i-s,-n),h=new ne(s,-n),f=new ne(0,s-n);e.push(ze.build1(o,l,s,s,!1,0),new Ee(l,c),ze.build1(c,u,s,s,!1,0),new Ee(u,d),ze.build1(d,A,s,s,!1,0),new Ee(A,h),ze.build1(h,f,s,s,!1,0),new Ee(f,o))}e=e.filter(o=>!o.start().equals1(o.end())),this.isCCW&&(e.forEach((o,l)=>e[l]=o.reverse()),e.reverse());let a=Ue.rotateD(this.angle).translate1(r);return Fr.build2(e.map(o=>o.multiply3(a)))}center(){return this.leftUpPoint.add1(this.width/2,this.height/2).rotateD(this.leftUpPoint,this.angle)}multiply3(e){let r=this.leftUpPoint.multiply3(e),i=new ne(this.width,0).multiply3(Ue.rotateD(this.angle)).multiply3(e),n=new ne(0,-this.height).multiply3(Ue.rotateD(this.angle)).multiply3(e);return e.isMirrored()?new Bv(r,n.length(),i.length(),n.angleD(ne.ORIGIN),this.isCCW===1?0:1,this.radius*i.length()/this.width):new Bv(r,i.length(),n.length(),i.angleD(ne.ORIGIN),this.isCCW,this.radius*i.length()/this.width)}reverse(){return new Bv(this.leftUpPoint,this.width,this.height,this.angle,this.isCCW===1?0:1,this.radius)}stroke(e,r,i){let n=this.stroke1(e,r,i);if(n.length===1)return n[0];{let[s,a]=n;return Fr.build2(s.primitives.concat(new Ee(s.primitives[0].start(),a.primitives[0].start()),a.primitives,new Ee(a.primitives[0].start(),s.primitives[0].start())))}}stroke1(e,r,i){let n=i===this.isCCW?this:this.reverse(),s=e/2,a=Math.min(n.width,n.height)/2,o=n.extend(s).toPolyline();return a<=s?[o]:[o,n.extend(-s).toPolyline().reverse()]}points(e){let r=this.toPolyline(),i=[];return r.points(e,n=>i.push(n)),i}toBezier(){throw new Error("Method not implemented.")}},sAe=.01,va=class If{static simplify(e){return e=Pf(e),e?new If([e]):null}static buildByStroke(e,r,i=1,n=VR,s){if(e instanceof ze&&(e.rx<r/2+sAe||Math.abs(e.sweepAngle)>180&&wt.lesseq(e.start().distance1(e.end()),r))){let o=RG(e.stroke(r,i,0),s);if(o.length===0)return null;if(o.length===1)return new If(o);let l=[null],c=Number.POSITIVE_INFINITY;return o.forEach(u=>{let d=u.area(.1);d<0?d<c&&(l[0]=u,c=d):l.push(u)}),new If(l)}else if(e instanceof nAe){let o=e.stroke1(r,i,0).map(l=>Pf(l));return o[0]?o[1]?new If(o):new If([o[0]]):null}let a=e.stroke(r,i,0,n);return a?this.simplify(a):null}static buildCircle(e,r){return this.simplify(Fr.build7([ze.buildCircle(e,r,0)]))}static buildRect(e){return this.simplify(e.toPolyline())}static buildBBox(e){return this.simplify(Fr.buildBBox(e,0))}constructor(e){this.items=e.slice()}multiply3(e){return new If(this.items.map(r=>r.multiply3(e)))}bbox(){return this.items[0].bbox()}isEqual(e){return e instanceof If?this.items.every(r=>e.items.some(i=>i.isEqual(r))):!1}getOutMostPolyline(){return this.items[0]}extend(e,r){if(this.items.length!==1)throw new Error("this.items.length !== 1");if(e===0)return new Ga([this]);let i=this.items[0],n=[];for(let u of i.primitives)if(u instanceof Ee)n.push(u);else if(u instanceof ze&&u.rx===u.ry)a(u);else if(u instanceof Nt)s(u);else throw new Error("not support!");i=Fr.build7(n);function s(u){let d=u.points(.1);for(let A=0;A<d.length-1;A++){let h=d[A],f=d[A+1];n.push(new Ee(h,f))}}function a(u){if(Math.abs(u.sweepAngle)>270){let d=u.sweepAngle/2;a(ze.build3(u.center,u.startAngle,d,u.rx,u.ry)),a(ze.build3(u.center,u.startAngle+d,d,u.rx,u.ry))}else n.push(u)}let o=[],l=[];iAe.getExtendPolyLine(i,e,!0,r).forEach(u=>{(u.area(.1)>0?l:o).push(u)});let c;if(o.length===1)l.forEach(u=>o.push(u)),c=new Ga([new If(o)]);else if(o.length===0)console.warn("outlines.length === 0"),c=new Ga([]);else if(l.length===0)c=new Ga(o.map(u=>new If([u])));else{let u=o.map(d=>[d]);l.forEach(d=>{let A=[],h=d.bbox();if(u.forEach(f=>{f[0].bbox().isContainsBBox1(h)&&A.push(f)}),A.length===1)A[0].push(d);else{if(A.length===0)throw new Error("inPlsArr.length === 0");for(let f of A.sort((p,m)=>p[0].bbox().area()-m[0].bbox().area()))if(f[0].getWindingNum(d.start())===-1){f.push(d);break}}}),c=new Ga(u.map(d=>new If(d)))}return c}toPolylineGroup(){return new Ws(this.items)}};var aAe=(t=>(t[t.POLYGON=1]="POLYGON",t[t.POLYLINE=2]="POLYLINE",t[t.LINE=3]="LINE",t[t.ARC=4]="ARC",t[t.BEZIER2=5]="BEZIER2",t[t.BEZIER3=6]="BEZIER3",t[t.BOOLEAN_OUTPUT=7]="BOOLEAN_OUTPUT",t[t.BOOLEAN_INTERSECTION=8]="BOOLEAN_INTERSECTION",t[t.BOOLEAN_UNION=9]="BOOLEAN_UNION",t[t.BOOLEAN_DIFF=10]="BOOLEAN_DIFF",t[t.BOOLEAN_RESULT=11]="BOOLEAN_RESULT",t[t.LINES=12]="LINES",t[t.ARCS=13]="ARCS",t[t.BEZIER2S=14]="BEZIER2S",t[t.BEZIER3S=15]="BEZIER3S",t[t.CIRCLE_CW=16]="CIRCLE_CW",t[t.CIRCLE_CCW=17]="CIRCLE_CCW",t[t.POLYGON_GROUP=18]="POLYGON_GROUP",t))(aAe||{});var oAe=Object.create,z4=Object.defineProperty,lAe=Object.getOwnPropertyDescriptor,cAe=Object.getOwnPropertyNames,uAe=Object.getPrototypeOf,hAe=Object.prototype.hasOwnProperty,zx=(t=>typeof jh<"u"?jh:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof jh<"u"?jh:e)[r]}):t)(function(t){if(typeof jh<"u")return jh.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')}),dAe=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),AAe=(t,e)=>{for(var r in e)z4(t,r,{get:e[r],enumerable:!0})},fAe=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of cAe(e))!hAe.call(t,n)&&n!==r&&z4(t,n,{get:()=>e[n],enumerable:!(i=lAe(e,n))||i.enumerable});return t},AC=(t,e,r)=>(r=t!=null?oAe(uAe(t)):{},fAe(e||!t||!t.__esModule?z4(r,"default",{value:t,enumerable:!0}):r,t)),fC=dAe((t,e)=>{"use strict";var r=Object.defineProperty,i=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,a=(O,K)=>{for(var se in K)r(O,se,{get:K[se],enumerable:!0})},o=(O,K,se,ae)=>{if(K&&typeof K=="object"||typeof K=="function")for(let ue of n(K))!s.call(O,ue)&&ue!==se&&r(O,ue,{get:()=>K[ue],enumerable:!(ae=i(K,ue))||ae.enumerable});return O},l=O=>o(r({},"__esModule",{value:!0}),O),c={};a(c,{BroadcastChannelMessageBus:()=>Qt,MessageBus:()=>He,MessageBus2:()=>ft,MessageBusTask:()=>Le,MessageBusTask2:()=>ut,WindowMessageBridge:()=>ve,WorkerMessageBridge:()=>me,createBroadcastP2PStream:()=>_r,createBufferedByteBufferStream:()=>Pt,createBufferedStream:()=>kt,createBufferedStringStream:()=>sr,dropP2PStream:()=>Lt,flowRead:()=>Jt,flowWrite:()=>Zt}),e.exports=l(c);var u=class{constructor(O=1.5){this.growthFactor=O,this.capacity=10,this.buffer=new Array(this.capacity),this.head=0,this.tail=0,this.count=0}enqueue(O){if(this.count===this.capacity){let K=Math.floor(this.capacity*this.growthFactor);console.log("grow",this.capacity,K);let se=new Array(K);for(let ae=0;ae<this.count;ae++)se[ae]=this.buffer[(this.head+ae)%this.capacity];this.buffer=se,this.head=0,this.tail=this.count,this.capacity=K}this.buffer[this.tail]=O,this.tail=(this.tail+1)%this.capacity,this.count++}dequeue(){if(this.isEmpty())return;let O=this.buffer[this.head];return this.head=(this.head+1)%this.capacity,this.count--,O}peek(){return this.buffer[this.head]}isEmpty(){return this.count===0}clear(){this.buffer.length=0,this.head=0,this.tail=0,this.count=0}},d=new ArrayBuffer(8),A=new Float64Array(d),h=new Uint32Array(d),f=new Uint16Array(d),p=ArrayBuffer;try{p=self.HTMLImageElement||p}catch{}var m=typeof SharedArrayBuffer<"u";function y(O){if(typeof O!="object"||O===null||O instanceof Date||O instanceof ArrayBuffer||m&&O instanceof SharedArrayBuffer||O instanceof Blob||O instanceof FormData||O instanceof Function||O instanceof Uint8ClampedArray||O instanceof p)return O;if(Array.isArray(O))return O.map(y);{let K={};for(let se in O)Object.hasOwnProperty.call(O,se)&&(K[se]=y(O[se]));return K}}function g(O,K){return b(O,K,()=>[])}function b(O,K,se){let ae=O[K];return ae!==void 0||(ae=se(K),O[K]=ae),ae}function E(O,K){if(Array.isArray(O)){for(let se=0,ae=O.length;se<ae;se++)if(K(void 0,O[se],se)===!1)return}else{let se=0;for(let ae in O)if(O.hasOwnProperty(ae)){let ue=O[ae];if(K(ae,ue,se)===!1)return;se++}}}var w=Object.prototype.hasOwnProperty;async function x(O,K){if(Array.isArray(O)){for(let se=0,ae=O.length;se<ae;se++)if(await K(void 0,O[se],se)===!1)return}else{let se=0;for(let ae in O)if(w.call(O,ae)){let ue=O[ae];if(await K(ae,ue,se)===!1)return;se++}}}function I(O,K,se){return typeof O=="string"&&(/https?:/.test(O)||(O=location.origin+O)),Promise.race([fetch(O,K),new Promise((ae,ue)=>setTimeout(ue,se))])}function C(O,K){let se=0,ae=0;return(...ue)=>{let Ie=++se;setTimeout(()=>{let Ce=performance.now();if(Ie===se||Ce-ae>=O){try{K(...ue)}catch(st){console.log(st)}ae=Ce}},Math.max(0,O-(performance.now()-ae)))}}function G(O,K){let se=O.length,ae=0;for(;ae<se;){let ue=O.indexOf(`
`,ae);ue<0&&(ue=se);let Ie=O.substring(ae,ue);try{if(K(Ie)===!1)return}catch(Ce){console.error(Ce)}ae=ue+1}}function U(O){let K=null;return()=>(K===null&&(K=O()),K)}var _=0;function H(){_===0&&(_=Date.now()-performance.now());let O=new Array,K=_+performance.now();A[0]=K,O.push(h[1].toString(16)),A[0]=Math.random(),O.push(f[3].toString(16));let se=f[2].toString(16);O.push("4"+se.substr(0,3)),A[0]=K;let ae=h[0].toString(16)+h[1].toString(16);return O.push("0"+ae.substr(0,3)),O.push(ae.substr(3)),O.join("-")}var Q=class{constructor(O){this.maxResources=O,this.idle=new u,this.isClosed=!1,this.resources=O}acquire(O){this.isClosed?Promise.resolve(!1).then(O):this.resources>0?(this.resources--,Promise.resolve(!0).then(O)):this.idle.enqueue(O)}acquireSync(){return new Promise(O=>{this.acquire(O)})}release(){if(!this.isClosed){let O=this.idle.dequeue();O?Promise.resolve(!0).then(O):this.resources++}}close(){if(!this.isClosed)for(this.isClosed=!0;!this.idle.isEmpty();){let O=this.idle.dequeue();Promise.resolve(!1).then(O)}}};function j(){if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global}function $(O,K,se){let ae=O.length+K-1;for(let ue=0;ue<ae;ue++){let Ie=new Array;for(let Ce=ue-K+1;Ce<=ue;Ce++)Ie.push(O[Ce]);if(se(Ie)===!1)break}}function B(){let O=new Date,K=O.getFullYear(),se=O.getMonth()+1,ae=O.getDate(),ue=O.getHours(),Ie=O.getMinutes(),Ce=O.getSeconds(),st=O.getMilliseconds();return"["+K+"-"+(se<10?"0"+se:se)+"-"+(ae<10?"0"+ae:ae)+" "+(ue<10?"0"+ue:ue)+":"+(Ie<10?"0"+Ie:Ie)+":"+(Ce<10?"0"+Ce:Ce)+"."+(st<100?st<10?"00"+st:"0"+st:st)+"] "}function M(O){return new Promise(K=>setTimeout(K,O))}function v(O,K){let se=0,ae=O.length;for(let ue=0;ue<ae;ue++)O[ue]===K&&(O.splice(ue,1),ue--,ae--,se++);return se}var N=j(),R=N.WeakRef||(O=>O);function q(O){if(O!=null){if(typeof O=="object")return new R(O);console.error(O,O instanceof Object,typeof O);return}}function P(O){return O==null?void 0:O.deref()}var z="_MSG_BUS_RPC_",W=300*1e3,oe=(O=>(O.PUBLISH="publish",O.SUBSCRIBE="subscribe",O.PUSH="push",O.PULL="pull",O))(oe||{}),Ae=class{constructor(O){this.bus=O}processRemoteMessage(O,K){let se=q(K),ae=O.topic,ue=O.type,Ie=O.message;switch(ue){case"pull":this.bus.pull(ae,Ce=>{this.push(ae,Ce,P(se))});break;case"subscribe":this.bus.subscribe(ae,Ce=>{this.publish(ae,Ce,P(se))});break;case"publish":this.bus.publish(ae,Ie,this,P(se));break;case"push":this.bus.push(ae,Ie,this,P(se));break;default:console.debug("unknown message type "+ue)}}rpcCall(O,K,se,ae=W){let ue=q(se),Ie=new Promise(Ce=>{let st=this.bus.uniqueRpcTopic(O);this.publish(O,{message:K,reply:st},P(ue)),this.bus.pull(st,(it,Kt,ar)=>{Ce({message:it,bridge:Kt,source:q(ar)})})});return ae>0?Promise.race([Ie,new Promise((Ce,st)=>{setTimeout(st,ae)})]):Ie}},me=class extends Ae{constructor(O,K){super(O),this.worker=K,K.onmessage=se=>{this.processRemoteMessage(se.data,void 0)}}publish(O,K){this.postMessage(O,"publish",K)}subscribe(O){this.postMessage(O,"subscribe",null)}push(O,K){this.postMessage(O,"push",K)}pull(O){this.postMessage(O,"pull",null)}rpcCall(O,K,se=W){return super.rpcCall(O,K,void 0,se)}postMessage(O,K,se){let ae={topic:O,type:K,message:se};this.worker.postMessage(ae)}discard(){this.worker.terminate()}},ve=class extends Ae{constructor(O){super(O),window.addEventListener("message",K=>{this.processRemoteMessage(K.data,K.source)},!1)}publish(O,K,se){this.postMessage(O,"publish",K,se)}subscribe(O,K){if(K===window)throw new Error("regist remote subscribe from current window is not permitted");this.postMessage(O,"subscribe",null,K)}push(O,K,se){this.postMessage(O,"push",K,se)}pull(O,K){if(K===window)throw new Error("regist remote pull from current window is not permitted");this.postMessage(O,"pull",null,K)}postMessage(O,K,se,ae){let ue={topic:O,type:K,message:se};ae&&ae.postMessage(ue,"*")}},Le=class{constructor(O){this.isRunning=!0,this.callback=O}cancel(){this.callback=null,this.isRunning=!1}running(){return this.isRunning}execute(O,K,se,ae){try{O=ae?O:y(O),this.callback(O,K,se)}catch(ue){console.error(ue)}}},He=class{constructor(O=!1){this.subscribed={},this.pulled={},this.pushed={},this.uuid=crypto.randomUUID().replace(/-/g,""),this.rpcTicket=0,this.unsafe=O}uniqueRpcTopic(O){return`${z}-${O}-${this.uuid}-${this.rpcTicket++}`}publish(O,K,se,ae){let ue=this.subscribed[O];if(ue){let Ie;for(let Ce of ue)Ce.running()?Ce.execute(K,se,ae,this.unsafe):(Ie=Ie||new Array,Ie.push(Ce));if(Ie)for(let Ce of Ie)v(ue,Ce)}else console.debug("no sub on topic: "+O)}subscribe(O,K){let se=new Le(K);return g(this.subscribed,O).push(se),se}push(O,K,se,ae){let ue=!1,Ie=this.pulled[O];if(Ie){for(;Ie.length>0;){let Ce=Ie.shift();if(Ce.running()){Ce.execute(K,se,ae,this.unsafe),ue=!0;break}}Ie.length===0&&delete this.pulled[O]}ue||g(this.pushed,O).push({message:K,bridge:se,source:q(ae)})}pull(O,K){let se=new Le(K),ae=this.pushed[O];if(ae){let ue=ae.shift();se.execute(ue.message,ue.bridge,P(ue.source),this.unsafe),ae.length===0&&delete this.pushed[O]}else g(this.pulled,O).push(se);return se}pullA(O){return new Promise(K=>{this.pull(O,(se,ae,ue)=>{K({message:se,bridge:ae,source:q(ue)})})})}rpcService(O,K){this.subscribe(O,(se,ae,ue)=>{let{message:Ie,reply:Ce}=se;try{let st=K(Ie);if(st instanceof Promise){let it=q(ue);st.then(Kt=>{this.rpcReply(Kt,Ce,ae,P(it))},Kt=>{console.error(Kt),this.rpcReply(void 0,Ce,ae,P(it))})}else this.rpcReply(st,Ce,ae,ue)}catch(st){console.error(st),this.rpcReply(void 0,Ce,ae,ue)}})}rpcCall(O,K,se=W){let ae=new Promise(ue=>{let Ie=this.uniqueRpcTopic(O);this.publish(O,{message:K,reply:Ie}),this.pull(Ie,(Ce,st,it)=>{ue({message:Ce,bridge:st,source:q(it)})})});return se>0?Promise.race([ae,new Promise((ue,Ie)=>{setTimeout(Ie,se)})]):ae}rpcReply(O,K,se,ae){se?se.push(K,O,ae):this.push(K,O)}},rt="_MSG_BUS_RPC_";function qe(O,K){let se=0,ae=O.length;for(let ue=0;ue<ae;ue++)O[ue]===K&&(O.splice(ue,1),ue--,ae--,se++);return se}function xt(O,K){return Gt(O,K,()=>[])}function Gt(O,K,se){let ae=O[K];return ae!==void 0||(ae=se(K),O[K]=ae),ae}var ut=class{constructor(O,K){this.callback=O,this.unsafe=K,this.isRunning=!0}cancel(){this.callback=null,this.isRunning=!1}running(){return this.isRunning}async execute(O){try{O=this.unsafe?O:y(O),this.callback(O)}catch(K){console.error(K)}}},Pe=class{constructor(O=crypto.randomUUID()){this.uuid=O,this.rpcTicket=0}subscribeOnce(O,K){let se=this.subscribe(O,ae=>{se.cancel(),K(ae)});return se}pullA(O){return new Promise(K=>{this.pull(O,K)})}rpcService(O,K){let se=ae=>{try{let{message:ue,replyTopic:Ie}=ae;try{let Ce=K(ue);Ce instanceof Promise?Ce.then(st=>{this.publish(Ie,{success:!0,result:st})}).catch(st=>{console.error(st),this.publish(Ie,{success:!1,err:String(st)})}):this.publish(Ie,{success:!0,result:Ce})}catch(Ce){this.publish(Ie,{success:!1,err:String(Ce)})}}finally{this.pull(O,se)}};this.pull(O,se)}rpcCall(O,K,se=0){let ae=new Promise((ue,Ie)=>{let Ce=`${rt}-${O}-${this.uuid}-${this.rpcTicket++}`;this.subscribeOnce(Ce,st=>{st.success?ue(st.result):Ie(new Error(st.err))}),this.push(O,{message:K,replyTopic:Ce})});return se>0?Promise.race([ae,new Promise((ue,Ie)=>{setTimeout(Ie,se)})]):ae}},ft=class extends Pe{constructor(O=!1){super(),this.unsafe=O,this.subscribed={},this.pulled={},this.pushed={}}publish(O,K){let se=this.subscribed[O];if(se){let ae;for(let ue of se)ue.running()?ue.execute(K):(ae=ae||new Array,ae.push(ue));if(ae)for(let ue of ae)qe(se,ue)}}subscribe(O,K){let se=new ut(K,this.unsafe);return xt(this.subscribed,O).push(se),se}push(O,K){let se=!1,ae=this.pulled[O];if(ae){for(;ae.length>0;){let ue=ae.shift();if(ue&&ue.running()){ue.execute(K),se=!0;break}}ae.length===0&&delete this.pulled[O]}se||xt(this.pushed,O).push(K)}pull(O,K){let se=new ut(K,this.unsafe);return this.repull(O,se),se}repull(O,K){let se=this.pushed[O];if(se){let ae=se.shift();ae&&(K.execute(ae),se.length===0&&delete this.pushed[O])}else xt(this.pulled,O).push(K)}},ht=class extends Pe{constructor(O=crypto.randomUUID()){super(O),this.subscribed={},this.pushed={},this.pulled={},this.pushCnt=0}publish(O,K){console.debug("BC",this.uuid,"PUBLISH",O,K),this.broadcastPublish(O,K)}subscribe(O,K){console.debug("BC",this.uuid,"SUBSCRIBE",O);let se=new ut(K,!0);return xt(this.subscribed,O).push(se),se}push(O,K){let se=this.pushCnt++;console.debug("BC",this.uuid,"PUSH",O,`(${se})`,K),xt(this.pushed,O).push({id:se,message:K}),this.broadcastPushedHeadMessage(O)}pull(O,K){console.debug("BC",this.uuid,"PULL",O);let se=new ut(K,!0);return xt(this.pulled,O).push(se),this.broadcastWhoHas(O),se}broadcastPushedHeadMessage(O){let K=this.pushed[O];K&&K[0]&&this.broadcastIHave(O,K[0].id)}onReceivedPublish(O,K,se){console.debug("BCMSG(",this.uuid,")","from",O,"PUBLISH",K,"message",se);let ae=this.subscribed[K];if(ae){let ue;for(let Ie of ae)Ie.running()?Ie.execute(se):(ue=ue||new Array,ue.push(Ie));if(ue)for(let Ie of ue)qe(ae,Ie);ae.length===0&&delete this.subscribed[K]}}onReceivedWhoHas(O,K){console.debug("BCMSG(",this.uuid,")","from",O,"WHOHAS",K),this.broadcastPushedHeadMessage(K)}onReceivedIHave(O,K,se){console.debug("BCMSG(",this.uuid,")","from",O,"IHAVE",K,"id",se);let ae=this.pulled[K];if(ae){let ue;for(let Ie of ae)if(Ie.running()){this.broadcastINeed(K,O,se);break}else ue=ue||new Array,ue.push(Ie);if(ue)for(let Ie of ue)qe(ae,Ie);ae.length===0&&delete this.pulled[K]}}onReceivedINeed(O,K,se,ae){if(console.debug("BCMSG(",this.uuid,")","from",O,"INEED",K,"source",se,"id",ae),this.uuid===se){let ue=this.pushed[K];if(ue&&ue[0]&&ue[0].id===ae){let{message:Ie}=ue.shift();this.broadcastIGive(K,ae,O,Ie),this.broadcastPushedHeadMessage(K),ue.length===0&&delete this.pushed[K]}}}onReceivedIGive(O,K,se,ae,ue){console.debug("BCMSG(",this.uuid,")","from",O,"IGIVE",K,"id",se,"target",ae,"message",ue);let Ie=this.pulled[K];if(Ie&&this.uuid===ae){let Ce=!1;for(;Ie.length>0;){let st=Ie.shift();if(st.running()){st.execute(ue),Ce=!0;break}}Ce||this.push(K,ue),Ie.length===0&&delete this.pulled[K]}}},Qt=class extends ht{constructor(O,K=crypto.randomUUID()){super(K),this.bc=new BroadcastChannel(O),this.bc.onmessage=se=>{this.onMessage(se.data)}}onMessage(O){let{type:K,uuid:se,topic:ae}=O;switch(K){case"PUBLISH":{let{message:ue}=O;this.onReceivedPublish(se,ae,ue);break}case"WHOHAS":{this.onReceivedWhoHas(se,ae);break}case"IHAVE":{let{id:ue}=O;this.onReceivedIHave(se,ae,ue);break}case"INEED":{let{source:ue,id:Ie}=O;this.onReceivedINeed(se,ae,ue,Ie);break}case"IGIVE":{let{target:ue,id:Ie,message:Ce}=O;this.onReceivedIGive(se,ae,Ie,ue,Ce);break}default:console.warn("unsupported",O)}}broadcastPublish(O,K){this.post({type:"PUBLISH",uuid:this.uuid,topic:O,message:K})}broadcastWhoHas(O){this.post({type:"WHOHAS",uuid:this.uuid,topic:O})}broadcastIHave(O,K){this.post({type:"IHAVE",uuid:this.uuid,topic:O,id:K})}broadcastINeed(O,K,se){this.post({type:"INEED",uuid:this.uuid,topic:O,source:K,id:se})}broadcastIGive(O,K,se,ae){this.post({type:"IGIVE",uuid:this.uuid,topic:O,id:K,target:se,message:ae})}post(O){this.bc.postMessage(O),Promise.resolve().then(()=>{this.onMessage(O)})}},Yt=Symbol("BLOCKING_QUEUE_RESET"),Ft=class{constructor(O,K=()=>1){if(this.maxSize=O,this.itemSizeOf=K,this.queue=new u,this.waitingConsumers=new u,this.waitingProducers=new u,this.queueSize=0,this.closePromise=null,this.closeResolve=null,O<=0)throw new Error("Max size must be greater than 0")}enqueue(O){return this.closePromise?!1:this.isFull()?(async()=>{console.debug("queue is full",this.queueSize,this.maxSize);let K=await new Promise(se=>{this.waitingProducers.enqueue(se)});return console.debug("queue is not full",this.size(),K),K?(this.innerEnqueue(O),!0):!1})():(this.innerEnqueue(O),!0)}innerEnqueue(O){if(this.waitingConsumers.isEmpty())this.queue.enqueue(O),this.queueSize+=this.itemSizeOf(O),console.debug("queue pushed",O,"size",this.queueSize);else{let K=this.waitingConsumers.dequeue();Promise.resolve(O).then(K),console.debug("queue direct",O,"size",this.queueSize)}}dequeue(){if(this.queue.isEmpty())if(this.closePromise){for(;!this.waitingConsumers.isEmpty();){let O=this.waitingConsumers.dequeue();Promise.resolve(Yt).then(O)}return setTimeout(()=>this.closeResolve(),0),Yt}else return new Promise(O=>{this.waitingConsumers.enqueue(O)});else{let O=this.queue.dequeue();if(this.queueSize-=this.itemSizeOf(O),!this.waitingProducers.isEmpty()){let K=this.waitingProducers.dequeue();Promise.resolve(!0).then(K)}return O}}size(){return this.queueSize}isEmpty(){return this.queueSize===0}isFull(){return this.queueSize>=this.maxSize}close(){return this.closePromise||(this.closePromise=new Promise(O=>{for(this.closeResolve=O;!this.waitingProducers.isEmpty();){let K=this.waitingProducers.dequeue();Promise.resolve(!1).then(K)}if(this.queueSize===0){for(;!this.waitingConsumers.isEmpty();){let K=this.waitingConsumers.dequeue();Promise.resolve(Yt).then(K)}O()}})),this.closePromise}};function kt(O,K,se=Number.MAX_SAFE_INTEGER){let ae=new Ft(se,K),ue=new ReadableStream({pull(Ce){let st=!0,it=(async()=>{let Kt=new Array;do{let ar=ae.dequeue();if(ar instanceof Promise){st=!1;let lr=await ar;lr===Yt?Ce.close():Kt.push(lr)}else{let lr=ar;lr===Yt?Ce.close():Kt.push(lr)}}while(ae.size()>0);if(Kt.length>0){let ar=O(Kt);Ce.enqueue(ar)}})();if(!st)return console.debug("read stream stucked --------------------------------------"),it},async cancel(){console.debug("buffered readable cancel"),await ae.close()}}),Ie=new WritableStream({write(Ce,st){let it=!0,Kt=(async()=>{let ar=ae.enqueue(Ce);typeof ar=="boolean"?ar||st.error(new Error("Write stream closed")):(it=!1,await ar||st.error(new Error("Write stream closed")))})();if(!it)return console.debug("read stream stucked >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"),Kt},async close(){console.debug("buffered writable closing",ae.size()),await ae.close(),console.debug("buffered writable closed",ae.size())},async abort(){console.debug("buffered writable aborting",ae.size()),await ae.close(),console.debug("buffered writable aborted",ae.size())}});return{readable:ue,writable:Ie}}function sr(O=Number.MAX_SAFE_INTEGER){return kt(K=>K.join(""),K=>K.length,O)}function Pt(O=Number.MAX_SAFE_INTEGER){return kt(K=>{let se=new Uint8Array(K.reduce((ue,Ie)=>ue+Ie.byteLength,0)),ae=0;return K.forEach(ue=>{se.set(ue,ae),ae+=ue.byteLength}),se},K=>K.byteLength,O)}function _r(O){return new Promise((K,se)=>{let ae=new BroadcastChannel(O),ue=new Ft(1),Ie=new Q(1),Ce=null,st=!1,it=!1,Kt=!1;ae.onmessage=ar=>{let lr=ar.data,{type:yr}=lr;if(console.debug("p2p",O,"type",yr,"data",yr==="DATA"&&lr.data),yr==="DATA")ue.enqueue(lr.data);else if(yr==="HI"){if(!Ce){ae.postMessage({type:"HI"});let nn=0;Ce={rs:new ReadableStream({async pull(sn){let Dn=await ue.dequeue();Dn===Yt?(await Tr(),sn.close()):(sn.enqueue(Dn),ae.postMessage({type:"ACK"}))},cancel(){return Tr()}}),ws:new WritableStream({async write(sn,Dn){await Ie.acquireSync()?ae.postMessage({type:"DATA",id:nn++,data:sn}):(xi(),Dn.error(new Error("Write stream closed")))},close(){xi()},abort(){xi()}})},K(Ce)}}else yr==="REND"?Ce?Ie.close():ii("REND1"):yr==="WEND"?Ce?ue.close():ii("WEND1"):yr==="ACK"&&Ie.release();function xi(){st||(st=!0,console.debug(O,"p2p write stream closed"),Ie.close(),ae.postMessage({type:"WEND"}),it&&(console.debug(O,"p2p channel closed on ws"),ae.close()))}async function Tr(){it||(it=!0,console.debug(O,"p2p read stream closed"),ae.postMessage({type:"REND"}),await ue.close(),st&&(console.debug(O,"p2p channel closed on rs"),ae.close()))}async function ii(nn){Kt||(Kt=!0,console.debug(O,"p2p channel connection released on",nn),Ie.close(),ue.close(),Ce?(Ce.rs.locked||(console.debug(O,"p2p unlocked read stream direct cancel"),Ce.rs.cancel()),Ce.ws.locked||(console.debug(O,"p2p unlocked write stream direct close"),Ce.ws.close())):(ae.postMessage({type:"HI"}),ae.close()),se(new Error("p2p channel connection released")))}},ae.postMessage({type:"HI"})})}function Lt(O){return new Promise(K=>{let se=new BroadcastChannel(O);se.onmessage=ae=>{let ue=ae.data,{type:Ie}=ue;Ie==="HI"&&(se.postMessage({type:"REND"}),se.close(),K())},se.postMessage({type:"REND"})})}async function ct(O){try{return await _r(O)}catch(K){K.message!=="p2p channel connection released"&&console.error(K)}}async function Zt(O,K,se=10*1024*1024,ae=!0){let ue=await ct(O);if(!ue)return!1;let Ie=!1;try{let Ce,st=it=>{if(!Ce)if(!ae)Ce=ue.ws.getWriter();else if(typeof it=="string"){let Kt=sr(se);Kt.readable.pipeTo(ue.ws),Ce=Kt.writable.getWriter()}else{let Kt=Pt(se);Kt.readable.pipeTo(ue.ws),Ce=Kt.writable.getWriter()}return Ce.write(it)};if(Array.isArray(K))for(let it of K)await st(it);else await K({write:st,get desiredSize(){return((Ce==null?void 0:Ce.desiredSize)||0)+10}});Ce&&await Ce.close(),Ie=!0}catch(Ce){console.error(Ce)}finally{return ue.rs.cancel(),Ie}}async function Jt(O,K){var ae,ue;let se=await ct(O);if(se)try{let Ie=se.rs.getReader();for((ae=K.start)==null?void 0:ae.call(K);;){let{value:Ce,done:st}=await Ie.read();if(Ce!==void 0){let it;if(K.update instanceof Promise?it=await K.update(Ce):it=K.update(Ce),it){await Ie.cancel();break}}if(st){(ue=K.end)==null||ue.call(K);break}}}catch(Ie){console.error(Ie)}finally{se.ws.close()}}}),pAe={UNAUTHORIZED:"Not logged in yet, please log in and try again",LOGIN_FAIL:"The login status is invalid",PERMISSION_DENIED:"No permission or project does not exist",PERMISSION_DENIED1:"No permission",PRJ_NOT_EXIST:"No permission or project does not exist",ERROR_PATH:"No permission or project does not exist",PROJECT_NOT_FOUND:"The project was not found",PERMISSION_DENIED_PARAMS:"No permission to operate {type}",DATA_NOT_FOUND:"Data not found",PARAMS_DATA_NOT_FOUND:"The {type} data was not found",REQUEST_PARAM_ILLEGAL:"Parameter error",REQUEST_PARAM_ILLEGAL1:"Parameter error",REQUEST_PARAMS_ILLEGAL2:"The {type} parameter request is incorrect",REQUEST_PARAMS_NOT_NULL:"The {type} parameter of the request cannot be empty",REQUEST_PARAMS_NOT_ALL_NULL:"The {type} parameter of the request cannot be empty simultaneously",REQUEST_PARAMS_MUST_ARRAY:"The request parameter {type} must be an array",REQUEST_PARAMS_MUST_STRING:"The request parameter {type} must be a string",REQUEST_PARAMS_MUST_NUMBER:"The request parameter {type} must be a number",REQUEST_PARAMS_MUST_NUMBER_ARRAY:"The request parameter {type} must be a numeric array",REQUEST_PARAMS_MUST_STRING_ARRAY:"The request parameter {type} must be a string array",REQUEST_PARAMS_LENGTH_ERROR:"The length of the request parameter {type} is incorrect",REQUEST_PARAMS_TYPE_ERROR:"The request parameter {type} is of incorrect type",ILLEGAL_NAME:'The name is illegal and contains illegal characters such as /:*?"<>|',ILLEGAL_NAME1:'The name is illegal and contains illegal characters such as /:*?"<>|',ILLEGAL_NAME_ZH:"The name cannot contain Chinese characters",UUID_ERROR:"uuid error",DUPLICATE_DATA:"Duplicate title",DUPLICATE_DATA1:"Library duplicate name",DUPLICATE_DATA_PARAMS:"{type} Duplicate data",UPLOAD_LIMIT:"Document {documentName} size over 15MB, it is too big to save in the server, please modify and then try again.",MORE_THAN_LIMIT:"Exceed the maximum limit",FILE_MORE_THAN_LIMIT:"Exceed the maximum upload limit of {type}",PARAMS_MORE_THAN_LIMIT:"Exceed the maximum upload limit of the parameter {type}",IMAGE_MORE_THAN_LIMIT_PARAMS:"The picture exceeds the maximum upload limit",FILE_MORE_THAN_LIMIT_PARAMS:"The file exceeds the maximum upload limit",END_MUST_AFTER_START:"The start time cannot be later than the end time",FILE_READ_ONLY:"The project file eprj or library file elib property was set as read only, please enable the read only property at File Manager and try again, and contact with support",FILE_READ_ONLY1:"The project file eprj or library file elib property was set as read only, please enable the read only property at File Manager and try again, and contact with support",DATA_NOT_EXIST:"document {documentName} not exists",REQUEST_PARAMS_TIME_ERROR:"The time request parameter is incorrect",FILES_PATH_NOT_FOUND:"The file address cannot be found",FILES_DATA_NOT_FOUND:"The file data cannot be found",FILES_TYPE_ERROR:"File type error",FILES_TYPE_MUST_BE_ONE:"The file type must be {type}",SET_WATERMARK_FAIL:"Watermark setting failed",MYSQL_CRUD_ERROR:"{type} data execution failed. Please contact technical support for resolution",PARAMS_JSON_FAILED:"{type} data parsing failed",MYSQL_ERROR:"Database operation anomaly",NOT_FOUND:"The request does not exist",PRJ_NAME_EXISTS:"The name of the project already exists",BACKUP_NAME_EXISTS:"Backup Name already exists",TITLE_ILLEGAL_LEN:"The {documentName} length must be 1~128 bytes!",LIB_NOT_EXIST:"The component library does not exist",CONFIG_API_URLS_ERROR:"Real-time prices and inventory are not enabled. Please contact the administrator",ONE_CLICK_ORDER_NOT_OPEN:"The order placement function is not enabled. Please contact the administrator",MATERIAL_NOT_OPEN:"The material warehouse is not open. Please contact the administrator",SNAPSHOT_DEPTH_LIMIT:"There is a snapshot near the latest node or the snapshot has been applied for",OCR_SYMBOL_URL_ERROR:"The OCR request address is not configured",USER_DATA_NOT_FOUND:"The user does not exist",USER_DISABLE_ERROR:"The account has been deactivated",USER_EXISTS_LOGIN_ERROR:"The user has logged in elsewhere",USER_UNAUTHORIZED_MODULES_ERROR:"This account has not authorized the module",USER_UNAUTHORIZED_ACCESS_ERROR:"Access type error",ADMIN_NOT_CHANGE_PASSWORD:"The super administrator cannot reset the password",SAME_PASSWORD_NEW_PASSWORD:"The original password is the same as the new one",USER_ONLINE_REGISTRATION_FAILED:"The registration of the user online failed",USER_PASSWORD_CAN_NOT_DEFAULT:"The default password cannot be used",USER_BEFORE_PASSWORD_ERROR:"The original password is incorrect",USER_PASSWORD_LENGTH_ERROR:"The password length is 8 to 255 characters",ORG_ROLE_NOT_CREATE:"System roles cannot be created. Please make the necessary modifications",ORG_ROLE_NAME_DUPLICATE:"The character name already exists. Please modify it",ORG_ROLE_ORIGIN_ERROR:"Unknown character source {message}",ORG_ROLE_NOT_DEFAULT:"This character is not a preset one and cannot be operated",ADMIN_ROLE_NOT_CHANGE:"Administrator privileges do not allow for modification",ADMIN_NOT_CHANGE_STATUS:"The admin account cannot change its status",PROJECT_ARCHIVED:"The project has been locked",PROJECT_UUID_NULL:"The project uuid cannot be empty",PROJECT_UUID_ERROR:"uuid error or the project uuid already exists",PROJECT_OR_TEAM_UUID_ERROR:"The project uuid is incorrect or the team uuid already exists",PROJECT_NOT_PERSON_ERROR:"Personal projects are not allowed to be created",PROJECT_DUPLICATE_NAME:"Duplicate title",ANNOTATION_HAS_BE_FOUND:"The annotation has been created",ANNOTATION_NOT_FOUND:"The annotation block does not exist",ANNOTATION_CREATE_ERROR:"The annotation block creation failed",ANNOTATION_UPDATE_ERROR:"The update of the annotation block failed",ANNOTATION_DELETE_ERROR:"The annotation failed to be deleted",PROJECT_DUPLICATE_PATH:"The same path cannot be created",TEAM_NOT_FOUND:"The team does not exist",TEAM_UUID_NULL:"The team uuid cannot be empty",TEAM_FOLDER_ERROR:"The parent folder does not exist or does not belong to the current team",TEAM_FOLDER_UUID_ERROR:"The folder uuid is incorrect or the project uuid already exists",TEAM_URL_DUPLICATE:"Team link repetition",TEAM_CAN_NOT_DELETE:"There are still projects in the team. Please transfer or delete them first",COMPONENT_UUID_NULL:"The uuid of a component cannot be empty",COMPONENT_DATA_NOT_FOUND:"The component library data does not exist",COMPONENT_NAME_DUPLICATE:"Component libraries cannot have the same name",COMPONENT_TYPE_ERROR:"Library type error",DELETE_SON_CATEGORY:"The subcategories need to be deleted first",LICENSE:"License not found",START_TIME:"The start time of the license is incorrect",END_TIME:"The end time of the license is incorrect",PROJECT_LIMIT:"The maximum number of projects has been reached",USER_LIMIT:"The maximum number of accounts has been reached",ONLINE_NUMBER_LIMIT:"The maximum number of online users has been reached",LIMIT_PCB:"The PCB authorization quota has been reached and the addition failed",LIMIT_SCH:"The schematic authorization number is full, and the addition failed",LIMIT_PANEL:"The panel authorization number is full and the addition failed",TIME_ERROR:"If the system time is incorrect, please restart the server or fix the system time. After fixing, the private service needs to be restarted",LICENSE_ERROR:"Authorization error",LICENSE_TYPE_ERROR:"The type of authorized application is incorrect",LICENSE_ORIGIN_ERROR:"Unknown authorized application {type}",BRANCH_DATA_NOT_FOUND:"There is no engineering branch",PARENT_UUID_ERROR:"parent uuid error",BRANCH_MUST_AFTER_NODE:"The branch must be after the node",BRANCH_NAME_ERROR:"Incorrect branch name",BRANCH_NAME_DUPLICATE:"The branch name already exists",BRANCH_UUID_ERROR:"The branch uuid is incorrect",BRANCH_NODE_SET_ERROR:"Nodes cannot be set as default branches or marked as master",BRANCH_DELETE_MAIN_ERROR:"Nodes or branches on the main branch cannot be deleted",BRANCH_CHECK_OUT_ERROR:"There are documents that have been checked out",DOCUMENT_UUID_ERROR:"The document uuid is incorrect",UPDATE_FAILED:"Update failed",INNER_API_KEY_ERROR:"The ApiKey of the internal interface of the server is incorrect",BRANCH_MORE_THAN_LIMIT:"The version exceeds the maximum limit",WORKSPACE_API_ERROR:"The workspace request response is abnormal"},mAe={UNAUTHORIZED:"\u5C1A\u672A\u767B\u5F55\uFF0C\u8BF7\u767B\u5F55\u540E\u518D\u8BD5",LOGIN_FAIL:"\u767B\u5F55\u72B6\u6001\u5F02\u5E38",PERMISSION_DENIED:"\u6CA1\u6709\u6743\u9650\u6216\u5DE5\u7A0B\u4E0D\u5B58\u5728",PERMISSION_DENIED1:"\u6CA1\u6709\u6743\u9650",PRJ_NOT_EXIST:"\u6CA1\u6709\u6743\u9650\u6216\u5DE5\u7A0B\u4E0D\u5B58\u5728",ERROR_PATH:"\u6CA1\u6709\u6743\u9650\u6216\u5DE5\u7A0B\u4E0D\u5B58\u5728",PROJECT_NOT_FOUND:"\u5DE5\u7A0B\u672A\u627E\u5230",PERMISSION_DENIED_PARAMS:"\u6CA1\u6709\u6743\u9650\u64CD\u4F5C{type}",DATA_NOT_FOUND:"\u6570\u636E\u672A\u627E\u5230",PARAMS_DATA_NOT_FOUND:"{type}\u6570\u636E\u672A\u627E\u5230",REQUEST_PARAM_ILLEGAL:"\u53C2\u6570\u9519\u8BEF",REQUEST_PARAM_ILLEGAL1:"\u53C2\u6570\u9519\u8BEF",REQUEST_PARAMS_ILLEGAL2:"\u8BF7\u6C42{type}\u53C2\u6570\u9519\u8BEF",REQUEST_PARAMS_NOT_NULL:"\u8BF7\u6C42{type}\u53C2\u6570\u4E0D\u80FD\u4E3A\u7A7A",REQUEST_PARAMS_NOT_ALL_NULL:"\u8BF7\u6C42{type}\u53C2\u6570\u4E0D\u80FD\u540C\u65F6\u4E3A\u7A7A",REQUEST_PARAMS_MUST_ARRAY:"\u8BF7\u6C42\u53C2\u6570{type}\u5FC5\u987B\u662F\u6570\u7EC4",REQUEST_PARAMS_MUST_STRING:"\u8BF7\u6C42\u53C2\u6570{type}\u5FC5\u987B\u662F\u5B57\u7B26\u4E32",REQUEST_PARAMS_MUST_NUMBER:"\u8BF7\u6C42\u53C2\u6570{type}\u5FC5\u987B\u662F\u6570\u5B57",REQUEST_PARAMS_MUST_NUMBER_ARRAY:"\u8BF7\u6C42\u53C2\u6570{type}\u5FC5\u987B\u662F\u6570\u5B57\u6570\u7EC4",REQUEST_PARAMS_MUST_STRING_ARRAY:"\u8BF7\u6C42\u53C2\u6570{type}\u5FC5\u987B\u662F\u5B57\u7B26\u4E32\u6570\u7EC4",REQUEST_PARAMS_LENGTH_ERROR:"\u8BF7\u6C42\u53C2\u6570{type}\u957F\u5EA6\u9519\u8BEF",REQUEST_PARAMS_TYPE_ERROR:"\u8BF7\u6C42\u53C2\u6570{type}\u7C7B\u578B\u9519\u8BEF",ILLEGAL_NAME:'\u540D\u79F0\u975E\u6CD5, \u5305\u542B /:*?"<>| \u7B49\u975E\u6CD5\u5B57\u7B26',ILLEGAL_NAME1:'\u540D\u79F0\u975E\u6CD5, \u5305\u542B /:*?"<>| \u7B49\u975E\u6CD5\u5B57\u7B26',ILLEGAL_NAME_ZH:"\u540D\u79F0\u4E0D\u80FD\u5305\u542B\u4E2D\u6587",UUID_ERROR:"uuid \u9519\u8BEF",DUPLICATE_DATA:"\u6807\u9898\u5DF2\u5B58\u5728",DUPLICATE_DATA1:"\u5E93\u91CD\u540D",DUPLICATE_DATA_PARAMS:"{type}\u91CD\u590D\u6570\u636E",UPLOAD_LIMIT:"\u6587\u6863 {documentName} \u8D85\u8FC715MB\uFF0C\u5BFC\u81F4\u65E0\u6CD5\u6B63\u5E38\u4FDD\u5B58\uFF0C\u8BF7\u4FEE\u6539\u540E\u518D\u5BFC\u5165",MORE_THAN_LIMIT:"\u8D85\u8FC7\u6700\u5927\u9650\u5236",FILE_MORE_THAN_LIMIT:"\u8D85\u8FC7{type}\u6700\u5927\u4E0A\u4F20\u9650\u5236",PARAMS_MORE_THAN_LIMIT:"\u8D85\u8FC7\u53C2\u6570{type}\u7684\u6700\u5927\u4E0A\u4F20\u9650\u5236",IMAGE_MORE_THAN_LIMIT_PARAMS:"\u56FE\u7247\u8D85\u8FC7\u6700\u5927\u4E0A\u4F20\u9650\u5236",FILE_MORE_THAN_LIMIT_PARAMS:"\u6587\u4EF6\u8D85\u8FC7\u6700\u5927\u4E0A\u4F20\u9650\u5236",END_MUST_AFTER_START:"\u5F00\u59CB\u65F6\u95F4\u4E0D\u80FD\u665A\u4E8E\u7ED3\u675F\u65F6\u95F4",FILE_READ_ONLY:"\u5DE5\u7A0B\u6587\u4EF6eprj\u6216\u5E93\u6587\u4EF6elib\u5C5E\u6027\u53D8\u4E3A\u53EA\u8BFB\uFF0C\u8BF7\u5728\u8D44\u6E90\u7BA1\u7406\u5668\u53D6\u6D88\u53EA\u8BFB\u540E\u518D\u8BD5\uFF0C\u5E76\u8054\u7CFB\u6280\u672F\u652F\u6301",FILE_READ_ONLY1:"\u5DE5\u7A0B\u6587\u4EF6eprj\u6216\u5E93\u6587\u4EF6elib\u5C5E\u6027\u53D8\u4E3A\u53EA\u8BFB\uFF0C\u8BF7\u5728\u8D44\u6E90\u7BA1\u7406\u5668\u53D6\u6D88\u53EA\u8BFB\u540E\u518D\u8BD5\uFF0C\u5E76\u8054\u7CFB\u6280\u672F\u652F\u6301",DATA_NOT_EXIST:"\u6587\u6863{documentName}\u4E0D\u5B58\u5728",REQUEST_PARAMS_TIME_ERROR:"\u65F6\u95F4\u8BF7\u6C42\u53C2\u6570\u9519\u8BEF",FILES_PATH_NOT_FOUND:"\u627E\u4E0D\u5230\u6587\u4EF6\u5730\u5740",FILES_DATA_NOT_FOUND:"\u627E\u4E0D\u5230\u6587\u4EF6\u6570\u636E",FILES_TYPE_ERROR:"\u6587\u4EF6\u7C7B\u578B\u9519\u8BEF",FILES_TYPE_MUST_BE_ONE:"\u6587\u4EF6\u7C7B\u578B\u5FC5\u987B\u4E3A{type}",SET_WATERMARK_FAIL:"\u6C34\u5370\u8BBE\u7F6E\u5931\u8D25",MYSQL_CRUD_ERROR:"{type}\u6570\u636E\u6267\u884C\u5931\u8D25, \u8BF7\u8054\u7CFB\u6280\u672F\u652F\u6301\u89E3\u51B3",PARAMS_JSON_FAILED:"{type}\u6570\u636E\u89E3\u6790\u5931\u8D25",MYSQL_ERROR:"\u6570\u636E\u5E93\u64CD\u4F5C\u5F02\u5E38",NOT_FOUND:"\u8BF7\u6C42\u4E0D\u5B58\u5728",PRJ_NAME_EXISTS:"\u5DE5\u7A0B\u540D\u79F0\u5DF2\u5B58\u5728",BACKUP_NAME_EXISTS:"\u5907\u4EFD\u540D\u79F0\u5DF2\u5B58\u5728",TITLE_ILLEGAL_LEN:"{documentName}\u957F\u5EA6\u5FC5\u987B\u4E3A1~128\u5B57\u7B26\u957F\u5EA6\uFF01",LIB_NOT_EXIST:"\u5143\u4EF6\u5E93\u4E0D\u5B58\u5728",CONFIG_API_URLS_ERROR:"\u5B9E\u65F6\u4EF7\u683C\u548C\u5E93\u5B58\u672A\u5F00\u542F, \u8BF7\u8054\u7CFB\u7BA1\u7406\u5458",ONE_CLICK_ORDER_NOT_OPEN:"\u4E00\u4EF6\u4E0B\u5355\u529F\u80FD\u672A\u5F00\u542F, \u8BF7\u8054\u7CFB\u7BA1\u7406\u5458",MATERIAL_NOT_OPEN:"\u7269\u6599\u5E93\u672A\u5F00\u542F, \u8BF7\u8054\u7CFB\u7BA1\u7406\u5458",SNAPSHOT_DEPTH_LIMIT:"\u6700\u65B0\u8282\u70B9\u9644\u8FD1\u5B58\u5728\u5FEB\u7167\u6216\u5FEB\u7167\u5DF2\u88AB\u7533\u8BF7",OCR_SYMBOL_URL_ERROR:"OCR\u8BF7\u6C42\u5730\u5740\u672A\u914D\u7F6E",USER_DATA_NOT_FOUND:"\u7528\u6237\u4E0D\u5B58\u5728",USER_DISABLE_ERROR:"\u8D26\u53F7\u5DF2\u505C\u7528",USER_EXISTS_LOGIN_ERROR:"\u7528\u6237\u5DF2\u5728\u522B\u7684\u5730\u65B9\u767B\u5F55",USER_UNAUTHORIZED_MODULES_ERROR:"\u8BE5\u8D26\u53F7\u672A\u6388\u6743\u6A21\u5757",USER_UNAUTHORIZED_ACCESS_ERROR:"\u8BBF\u95EE\u7C7B\u578B\u9519\u8BEF",ADMIN_NOT_CHANGE_PASSWORD:"\u8D85\u7EA7\u7BA1\u7406\u5458\u65E0\u6CD5\u91CD\u7F6E\u5BC6\u7801",SAME_PASSWORD_NEW_PASSWORD:"\u539F\u5BC6\u7801\u8DDF\u65B0\u5BC6\u7801\u76F8\u540C",USER_ONLINE_REGISTRATION_FAILED:"\u767B\u8BB0\u7528\u6237\u5728\u7EBF\u5931\u8D25",USER_PASSWORD_CAN_NOT_DEFAULT:"\u4E0D\u80FD\u4F7F\u7528\u9ED8\u8BA4\u5BC6\u7801",USER_BEFORE_PASSWORD_ERROR:"\u539F\u5BC6\u7801\u9519\u8BEF",USER_PASSWORD_LENGTH_ERROR:"\u5BC6\u7801\u957F\u5EA6\u4E3A8-255\u4F4D",ORG_ROLE_NOT_CREATE:"\u4E0D\u80FD\u521B\u5EFA\u7CFB\u7EDF\u89D2\u8272, \u8BF7\u4FEE\u6539",ORG_ROLE_NAME_DUPLICATE:"\u89D2\u8272\u540D\u79F0\u5DF2\u5B58\u5728, \u8BF7\u4FEE\u6539",ORG_ROLE_ORIGIN_ERROR:"\u672A\u77E5\u7684\u89D2\u8272\u6765\u6E90{message}",ORG_ROLE_NOT_DEFAULT:"\u8BE5\u89D2\u8272\u4E0D\u662F\u9884\u8BBE\u89D2\u8272, \u4E0D\u80FD\u64CD\u4F5C",ADMIN_ROLE_NOT_CHANGE:"\u7BA1\u7406\u5458\u6743\u9650\u4E0D\u5141\u8BB8\u4FEE\u6539",ADMIN_NOT_CHANGE_STATUS:"admin\u8D26\u53F7\u4E0D\u80FD\u66F4\u6539\u72B6\u6001",PROJECT_ARCHIVED:"\u5DE5\u7A0B\u5DF2\u88AB\u9501\u5B9A",PROJECT_UUID_NULL:"\u5DE5\u7A0Buuid\u4E0D\u80FD\u4E3A\u7A7A",PROJECT_UUID_ERROR:"uuid\u9519\u8BEF\u6216\u8005\u5DE5\u7A0Buuid\u5DF2\u5B58\u5728",PROJECT_OR_TEAM_UUID_ERROR:"\u5DE5\u7A0Buuid\u9519\u8BEF\u6216\u8005\u5DF2\u5B58\u5728\u56E2\u961Fuuid",PROJECT_NOT_PERSON_ERROR:"\u4E0D\u5141\u8BB8\u521B\u5EFA\u4E2A\u4EBA\u5DE5\u7A0B",PROJECT_DUPLICATE_NAME:"\u6807\u9898\u5DF2\u5B58\u5728",ANNOTATION_HAS_BE_FOUND:"\u6279\u6CE8\u5DF2\u521B\u5EFA",ANNOTATION_NOT_FOUND:"\u6279\u6CE8\u5757\u4E0D\u5B58\u5728",ANNOTATION_CREATE_ERROR:"\u6279\u6CE8\u5757\u521B\u5EFA\u5931\u8D25",ANNOTATION_UPDATE_ERROR:"\u66F4\u65B0\u6279\u6CE8\u5757\u5931\u8D25",ANNOTATION_DELETE_ERROR:"\u6279\u6CE8\u6761\u5220\u9664\u5931\u8D25",PROJECT_DUPLICATE_PATH:"\u4E0D\u80FD\u521B\u5EFA\u76F8\u540C\u7684\u8DEF\u5F84",TEAM_NOT_FOUND:"\u56E2\u961F\u4E0D\u5B58\u5728",TEAM_UUID_NULL:"\u56E2\u961Fuuid\u4E0D\u80FD\u4E3A\u7A7A",TEAM_FOLDER_ERROR:"\u7236\u6587\u4EF6\u5939\u4E0D\u5B58\u5728\u6216\u4E0D\u5C5E\u4E8E\u5F53\u524D\u56E2\u961F",TEAM_FOLDER_UUID_ERROR:"\u6587\u4EF6\u5939uuid\u9519\u8BEF\u6216\u8005\u5DE5\u7A0Buuid\u5DF2\u5B58\u5728",TEAM_URL_DUPLICATE:"\u56E2\u961F\u94FE\u63A5\u91CD\u590D",TEAM_CAN_NOT_DELETE:"\u56E2\u961F\u4ECD\u5B58\u5728\u5DE5\u7A0B, \u8BF7\u5148\u8F6C\u79FB\u6216\u8005\u5220\u9664",COMPONENT_UUID_NULL:"\u5143\u4EF6uuid\u4E0D\u80FD\u4E3A\u7A7A",COMPONENT_DATA_NOT_FOUND:"\u5143\u4EF6\u5E93\u6570\u636E\u4E0D\u5B58\u5728",COMPONENT_NAME_DUPLICATE:"\u5143\u4EF6\u5E93\u4E0D\u80FD\u91CD\u540D",COMPONENT_TYPE_ERROR:"\u5E93\u7C7B\u578B\u9519\u8BEF",DELETE_SON_CATEGORY:"\u9700\u8981\u5148\u5220\u9664\u5B50\u7C7B\u522B",LICENSE:"\u672A\u627E\u5230\u8BB8\u53EF\u8BC1",START_TIME:"\u8BB8\u53EF\u8BC1\u5F00\u59CB\u65F6\u95F4\u9519\u8BEF",END_TIME:"\u8BB8\u53EF\u8BC1\u7ED3\u675F\u65F6\u95F4\u9519\u8BEF",PROJECT_LIMIT:"\u5DF2\u8FBE\u5230\u6700\u5927\u5DE5\u7A0B\u6570",USER_LIMIT:"\u5DF2\u8FBE\u5230\u6700\u5927\u8D26\u53F7\u6570",ONLINE_NUMBER_LIMIT:"\u5DF2\u8FBE\u5230\u6700\u5927\u5728\u7EBF\u6570",LIMIT_PCB:"PCB\u6388\u6743\u6570\u5DF2\u6EE1, \u6DFB\u52A0\u5931\u8D25",LIMIT_SCH:"\u539F\u7406\u56FE\u6388\u6743\u6570\u5DF2\u6EE1, \u6DFB\u52A0\u5931\u8D25",LIMIT_PANEL:"\u9762\u677F\u6388\u6743\u6570\u5DF2\u6EE1, \u6DFB\u52A0\u5931\u8D25",TIME_ERROR:"\u7CFB\u7EDF\u65F6\u95F4\u9519\u8BEF\u8BF7\u91CD\u542F\u670D\u52A1\u5668\u6216\u4FEE\u590D\u7CFB\u7EDF\u65F6\u95F4, \u4FEE\u590D\u540E\u9700\u8981\u91CD\u542F\u79C1\u6709\u5316\u670D\u52A1",LICENSE_ERROR:"\u6388\u6743\u9519\u8BEF",LICENSE_TYPE_ERROR:"\u6388\u6743\u5E94\u7528\u7C7B\u578B\u9519\u8BEF",LICENSE_ORIGIN_ERROR:"\u672A\u77E5\u7684\u6388\u6743\u5E94\u7528{type}",BRANCH_DATA_NOT_FOUND:"\u5DE5\u7A0B\u5206\u652F\u4E0D\u5B58\u5728",PARENT_UUID_ERROR:"\u7236\u7EA7uuid\u9519\u8BEF",BRANCH_MUST_AFTER_NODE:"\u5206\u652F\u5FC5\u987B\u5728\u8282\u70B9\u540E",BRANCH_NAME_ERROR:"\u5206\u652F\u540D\u9519\u8BEF",BRANCH_NAME_DUPLICATE:"\u5206\u652F\u540D\u5DF2\u5B58\u5728",BRANCH_UUID_ERROR:"\u5206\u652Fuuid\u9519\u8BEF",BRANCH_NODE_SET_ERROR:"\u8282\u70B9\u4E0D\u80FD\u8BBE\u7F6E\u4E3A\u9ED8\u8BA4\u5206\u652F\u6216\u6807\u8BB0\u4E3Amaster",BRANCH_DELETE_MAIN_ERROR:"\u4E0D\u80FD\u5220\u9664\u4E3B\u5206\u652F\u4E0A\u7684\u8282\u70B9\u6216\u5206\u652F",BRANCH_CHECK_OUT_ERROR:"\u5B58\u5728\u6587\u6863\u5DF2\u7B7E\u51FA",DOCUMENT_UUID_ERROR:"\u6587\u6863uuid\u9519\u8BEF",UPDATE_FAILED:"\u66F4\u65B0\u5931\u8D25",INNER_API_KEY_ERROR:"\u670D\u52A1\u7AEF\u5185\u90E8\u63A5\u53E3 ApiKey \u9519\u8BEF",BRANCH_MORE_THAN_LIMIT:"\u7248\u672C\u8D85\u8FC7\u6700\u5927\u9650\u5236",WORKSPACE_API_ERROR:"\u5DE5\u4F5C\u533A\u8BF7\u6C42\u54CD\u5E94\u5F02\u5E38"},kG={codeEN:pAe,codeCN:mAe},D1,x4=(D1=class{static load(){typeof kG=="object"&&(D1.cache=kG)}static match(e,r,i){if(!this.cache||!this.cache[e])return;let n=this.cache[e][r];if(i&&Object.prototype.toString.call(i)==="[object Object]")for(let s in i){let a=i[s];n=n.replace(`{${s}}`,a)}return n}},D1.cache={},D1);function gAe(){console.log("common init----------------"),x4.load()}var yAe=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.PERCENT=1]="PERCENT",t[t.LEFT_PAD0=2]="LEFT_PAD0",t))(yAe||{});function Fd(t,e){throw new Error(`invalid format state on (${e}) of ${t}`)}function bAe(t,...e){let r=[],i=0,n=0,s,a=0,o=0;for(let l=0;l<t.length;l++){let c=t.charAt(l);switch(i){case 0:c==="%"?i=1:r.push(c);break;case 1:switch(c){case"d":s=e[n++],typeof s=="number"?(r.push(s.toFixed(0)),i=0):Fd(t,l);break;case"f":s=e[n++],typeof s=="number"?(r.push(s.toString()),i=0):Fd(t,l);break;case"x":s=e[n++],typeof s=="number"?(r.push((s|0).toString(16)),i=0):Fd(t,l);break;case"X":s=e[n++],typeof s=="number"?(r.push((s|0).toString(16).toUpperCase()),i=0):Fd(t,l);break;case"s":case"c":s=e[n++],r.push(s===null?"null":s.toString()),i=0;break;case"0":a=l+1,o=-1,i=2;break;case"%":r.push("%"),i=0;break;default:Fd(t,l)}break;case 2:switch(c){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":o=l;break;case"d":if(o>=a){let u=parseInt(t.substring(a,o+1));s=e[n++],typeof s=="number"?(r.push((s|0).toString(10).padStart(u,"0")),i=0):Fd(t,l)}else Fd(t,l);break;case"x":if(o>=a){let u=parseInt(t.substring(a,o+1));s=e[n++],typeof s=="number"?(r.push((s|0).toString(16).padStart(u,"0")),i=0):Fd(t,l)}else Fd(t,l);break;case"X":if(o>=a){let u=parseInt(t.substring(a,o+1));s=e[n++],typeof s=="number"?(r.push((s|0).toString(16).toUpperCase().padStart(u,"0")),i=0):Fd(t,l)}else Fd(t,l);break;default:Fd(t,l)}break;default:Fd(t,l)}}return r.join("")}function HY(t){let e="";try{let r=/.*\\(.*)$/.exec(t);r&&r[1]&&typeof r[1]=="string"&&(e=r[1])}catch(r){console.error("Query Folder Name Error:",r)}return e}function GY(t,e){let r=Math.max(t.length,e.length);for(let i=0;i<r;i++){let n=t[i],s=e[i],a=0;if(typeof n=="string"&&typeof s=="string")a=n.localeCompare(s);else if(typeof n=="number"&&typeof s=="number")a=n-s;else{if(typeof n=="number"&&typeof s=="string")return-1;if(typeof n=="string"&&typeof s=="number")return 1;if(n===void 0&&s!==void 0)return-1;if(n!==void 0&&s===void 0)return 1}if(a!==0)return a}return 0}function E4(t){let e=/\d+/g,r=new Array,i=0;for(;;){let n=e.exec(t);if(n)i<n.index&&r.push(t.substring(i,n.index)),i=n.index+n[0].length,r.push(parseInt(n[0]));else break}return r.push(t),r}function xAe(t,e,r,i){var c,u;let n=[],s=[],a=[];for(let d=0,A=t.length;d<A;d++){n[d]=d;let h;if(Array.isArray(e)){let f="";for(let p=0;p<e.length;p++)if(Object.hasOwnProperty.call(t[d],e[p])){f=t[d][e[p]];break}}else h=e?t[d][e]||((u=(c=t[d])==null?void 0:c[i])==null?void 0:u[e])||"":t[d];if(s[d]=String(h).toUpperCase().match(/\D+|\d+(?:\.\d+)?/g),a[d]=[],s[d])for(let f=0;f<s[d].length;f++)a[d][f]=s[d][f].match(/\d/)?1:2}let o=function(d,A){let h=s[d],f=s[A],p=a[d],m=a[A];if(!h||!f)return r?h==f?0:h?-1:1:h==f?0:h?1:-1;let y=Math.max(h.length,f.length);for(let g=0;g<y;g++){if(r)if(h[g])if(f[g]){if(h[g]!=f[g])return p[g]!=m[g]?p[g]==1?1:-1:p[g]==1?f[g]-h[g]:h[g]<f[g]?1:-1}else return-1;else return 1;if(h[g])if(f[g]){if(h[g]!=f[g])return p[g]!=m[g]?p[g]==1?-1:1:p[g]==1?h[g]-f[g]:h[g]<f[g]?-1:1}else return 1;else return-1}return 0};n.sort(o);let l=[];for(let d=0;d<t.length;d++)l[d]=t[n[d]];return l}function EAe(t,e,r){let i=[],n=[],s=[],a=[t,e];for(let o=0,l=a.length;o<l;o++){i[o]=o;let c=a[o];if(n[o]=String(c).toUpperCase().match(/\D+|\d+(?:\.\d+)?/g),s[o]=[],n[o])for(let u=0;u<n[o].length;u++)s[o][u]=n[o][u].match(/\d/)?1:2}return(function(o,l){let c=n[o],u=n[l],d=s[o],A=s[l];if(!c||!u)return r?c==u?0:c?-1:1:c==u?0:c?1:-1;let h=Math.max(c.length,u.length);for(let f=0;f<h;f++){if(r)if(c[f])if(u[f]){if(c[f]!=u[f])return d[f]!=A[f]?d[f]==1?1:-1:d[f]==1?u[f]-c[f]:c[f]<u[f]?1:-1}else return-1;else return 1;if(c[f])if(u[f]){if(c[f]!=u[f])return d[f]!=A[f]?d[f]==1?-1:1:d[f]==1?c[f]-u[f]:c[f]<u[f]?-1:1}else return 1;else return-1}return 0})(i[0],i[1])}function zD(t,e){let r=!1;for(let i in e)if(Object.hasOwnProperty.call(e,i)&&t.indexOf(i)!==-1){r=!0;break}return r}function wAe(t,e=""){return t.sort((i,n)=>GY(E4(r(i)),E4(r(n)))),t;function r(i){if(!i)return i;let n;if(Array.isArray(e)){let s="";for(let a=0;a<e.length;a++)if(Object.hasOwnProperty.call(i,e[a])){s=i[e[a]];break}}else n=i[e]||i;return n}}function vAe(t,e,r=1){var o,l,c,u;let i=(o=t.match(/^\D+/))==null?void 0:o[0],n=(l=t.match(/\d+$/))==null?void 0:l[0],s=(c=e.match(/^\D+/))==null?void 0:c[0],a=(u=e.match(/\d+$/))==null?void 0:u[0];return i&&s?i!==s?r===1?i.localeCompare(s):s.localeCompare(i):n!==a?+n>+a?1*r:-1*r:0:i?-1*r:s?1*r:0}function CAe(t){return new Promise(e=>{setTimeout(e,t)})}var u8e=Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map(t=>t.charCodeAt(0));function SAe(){try{if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof globalThis<"u")return globalThis}catch{return null}}function ur(){return self.EDITOR_TOP||self}function TAe(t,e,r){e=e||1,r=r||32;var i="",n=e,s=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];t&&(n=Math.round(Math.random()*(r-e))+e);for(var a=0;a<n;a++){let o=Math.round(Math.random()*(s.length-1));i+=s[o]}return i}function IAe(t){try{return JSON.parse(t)}catch{return console.error(`ParseJSON failed:
`+t),null}}var BAe=(t=>(t[t.TRACE=0]="TRACE",t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.DUMMY=5]="DUMMY",t))(BAe||{}),DAe=(t,e)=>{switch(t){case 4:console.error(...e);break;case 3:console.warn(...e);break;case 2:console.info(...e);break;default:console.log(...e)}},_Ae=(t,e)=>e,PAe=class Qv{constructor(e,r=DAe,i=_Ae){this.level=e,this.writer=r,this.formatter=i}wrap(e){return new Qv(this.level,this.writer,(r,i)=>(i=this.formatter(r,i),e(r,i)))}inject(e){return new Qv(this.level,this.writer,(r,i)=>(i=e(r,i),this.formatter(r,i)))}shadow(...e){return new Qv(this.level,(r,i)=>{this.writer(r,i);for(let n of e)n(r,i)},this.formatter)}mix(...e){return new Qv(0,(r,i)=>{this.process(r,i);for(let n of e)n.process(r,i)},(r,i)=>i)}process(e,r){this.level<=e&&this.writer(e,this.formatter(e,r))}process1(e,r,i){this.level<=e&&this.writer(e,this.formatter(e,[bAe(r,...i)]))}trace(...e){this.process(0,e)}trace1(e,...r){this.process1(0,e,r)}debug(...e){this.process(1,e)}debug1(e,...r){this.process1(1,e,r)}info(...e){this.process(2,e)}info1(e,...r){this.process1(2,e,r)}warn(...e){this.process(3,e)}warn1(e,...r){this.process1(3,e,r)}error(...e){this.process(4,e)}error1(e,...r){this.process1(4,e,r)}},h8e=new PAe(5),d8e=Date.now()-performance.now(),YY=new ArrayBuffer(10),A8e=new Float64Array(YY,0,1),f8e=new Uint8Array(YY);var X4={};AAe(X4,{HAS_PANEL:()=>KAe,HAS_PCB:()=>WAe,HAS_SCH:()=>qAe,IS_CLIENT:()=>kf,IS_CLIENT_HALF_OFFLINE:()=>ID,IS_CLIENT_NOT_ONLINE:()=>q4,IS_CLIENT_OFFLINE:()=>VAe,IS_CLIENT_ONLINE:()=>BD,IS_DEV:()=>NAe,IS_EASYEDA:()=>jY,IS_EASYEDA_CLIENT:()=>YAe,IS_ECAD:()=>RAe,IS_HALF_OFFLINE:()=>WD,IS_LCEDA:()=>VY,IS_LCEDA_CLIENT:()=>GAe,IS_OFFLINE:()=>KD,IS_ONLINE:()=>qD,IS_PCBLUXSHARE:()=>MAe,IS_PRIVATE:()=>XD,PRO_EDITOR_MODE:()=>jAe,PRO_EDITOR_MODES:()=>Bc,SSO_EXTERNAL_IDENTITY_DOMAIN:()=>FAe,SSO_EXTERNAL_PERMISSION_DOMAIN:()=>UAe,SSO_EXTERNAL_PERMISSION_MANAGED_DOMAIN:()=>HAe,SSO_IDENTITY_CONNECT:()=>kAe});var LAe=(t=>(t.ruler="ruler",t.un_ruler="un_ruler",t))(LAe||{}),pC=(t=>(t[t.HOME=-1]="HOME",t[t.BLANKTAB=0]="BLANKTAB",t[t.SCH=1]="SCH",t[t.PART=2]="PART",t[t.PCB=3]="PCB",t[t.FOOTPRINT=4]="FOOTPRINT",t[t.PRJ=5]="PRJ",t[t.SUBPART=6]="SUBPART",t[t.NGSPICE_MODEL=7]="NGSPICE_MODEL",t[t.NGSPICE=8]="NGSPICE",t[t.SIMULIDE=9]="SIMULIDE",t[t.WAVEFORM=10]="WAVEFORM",t[t.SCHLIB3D=11]="SCHLIB3D",t[t.PHOTOVIEW=12]="PHOTOVIEW",t[t.SCHMODULE=13]="SCHMODULE",t[t.PCBMODULE=14]="PCBMODULE",t[t.VIEW3D=15]="VIEW3D",t[t.PCBLIB3D=16]="PCBLIB3D",t[t.BLOCK_SYMBOL=17]="BLOCK_SYMBOL",t[t.NETFLAG=18]="NETFLAG",t[t.NETPORT=19]="NETPORT",t[t.SHEET_SYMBOL=20]="SHEET_SYMBOL",t[t.NONEELEC_SYMBOL=21]="NONEELEC_SYMBOL",t[t.SHORT_SYMBOL=22]="SHORT_SYMBOL",t[t.FOOTPRINTVIEW=23]="FOOTPRINTVIEW",t[t.CNCPRINTVIEW=24]="CNCPRINTVIEW",t[t.OFF_PAGE_CONNECTOR=25]="OFF_PAGE_CONNECTOR",t[t.PANEL=26]="PANEL",t[t.PANEL3D=27]="PANEL3D",t[t.DEVICE=28]="DEVICE",t[t.PANEL_LIB=29]="PANEL_LIB",t[t.ASSEMBLY_VARIANT=30]="ASSEMBLY_VARIANT",t[t.DIFF_PAIRS_FLAG=31]="DIFF_PAIRS_FLAG",t[t.SIMULIDE_MODEL=32]="SIMULIDE_MODEL",t))(pC||{}),OAe=(t=>(t.SCH="SCH",t.PCB="PCB",t.PANEL="PANEL",t))(OAe||{}),qR=SAe(),Bc=String((qR==null?void 0:qR.PRO_EDITOR_MODE)||"LCEDA").split("-"),NAe=Bc.indexOf("DEVPRO")>=0,kf=Bc.indexOf("CLIENT")>=0,VY=Bc.indexOf("LCEDA")>=0,jY=Bc.indexOf("EASYEDA")>=0,XD=Bc.indexOf("PRIVATE")>=0,qD=Bc.indexOf("ONLINE")>=0,WD=Bc.indexOf("HALF_OFFLINE")>=0,KD=Bc.indexOf("OFFLINE")>=0,RAe=Bc.indexOf("ECAD")>=0,MAe=Bc.indexOf("PCB_LUXSHARE")>=0,kAe=Bc.indexOf("SSO_IDENTITY_CONNECT")>=0,FAe=Bc.indexOf("SSO_EXTERNAL_IDENTITY_DOMAIN")>=0,UAe=Bc.indexOf("SSO_EXTERNAL_PERMISSION_DOMAIN")>=0,HAe=Bc.indexOf("SSO_EXTERNAL_PERMISSION_MANAGED_DOMAIN")>=0,GAe=kf&&VY,YAe=kf&&jY,ID=kf&&WD,q4=kf&&!qD,VAe=kf&&KD,BD=kf&&qD,jAe=kf?qD?"ONLINE":WD?"HALF_OFFLINE":KD?"OFFLINE":"":"",QAe=Bc.indexOf("SCH")>=0,zAe=Bc.indexOf("PCB")>=0,XAe=Bc.indexOf("PANEL")>=0,qAe=QAe,WAe=zAe,KAe=XAe,mC=(t=>(t.PROJECT_BACKUPS_MANUAL="Backup Project Manually",t.PROJECT_BACKUPS_AUTO="Backup Project Automatically",t.DELETE_BACKUPS="Delete Backup",t.SAVE="Save",t.CREATE_SHEET="New Page",t.DELETE_SHEET="Delete Page",t.RENAME_SHEET="Rename Page",t.SIGNED_SHEET="Check Out Page",t.SIGNIN_SHEET="Check In Page",t.CLEAR_SIGNED="Clear Check Out",t.PROJECT_LOCK="Lock Project",t.PROJECT_UNLOCK="Unlock Project",t.PROJECT_OPEN="Open Project",t.PROJECT_CLOSE="Close Project",t.DOCUMENT_PASTE="Paste Document",t.DOCUMENT_PASTE_ACROSS_PROJECT="Paste Document Across Projects",t.SCHEMATIC_PASTE="Paste Schematic",t.SCHEMATIC_PASTE_ACROSS_PROJECT="Paste Schematic Across Projects",t.PRIMITIVE_PASTE_ACROSS_PROJECT="Paste Elements Across Projects",t.PROJECT_SAVEAS_REMOTE="Save Project to Cloud",t.PROJECT_SAVEAS_LOCAL="Save Project to Local",t.LIBRARY_SAVEAS_LOCAL="Save Library to Local",t.DOCUMENT_SAVEAS_REMOTE="Save Document to Cloud",t.DOCUMENT_SAVEAS_LOCAL="Save Document to Local",t.CBB_SAVEAS_REMOTE="Save Reuse Module to Cloud",t.CBB_SAVEAS_LOCAL="Save Reuse Module to Local",t.SVG_EXPORT="Export SVG",t.PNG_EXPORT="Export PNG",t.PDF_EXPORT="Export PDF",t.BOM_EXPORT="Export BOM",t.PRINT="Print",t.GERBER_EXPORT="Export Gerber",t.COORDINATE_EXPORT="Export Pick and Place File",t.D3FILE_EXPORT="Export 3D File",t.D3SHELLFILE_EXPORT="Export 3D Shell File",t.TESTPOINT_REPORT_EXPORT="Export Test Point Report",t.DXF_EXPORT="Export DXF",t.ODBPLUSS_EXPORT="Export ODB++",t.AD_EXPORT="Export Altium Designer",t.DEVICE_REPLACE="Replace Device",t.FOOTPRINT_REPLACE="Replace Footprint",t.D3MODEL_REPLACE="Replace 3D Model",t.PROJECTLIB_UPDATE="Update Project Library",t.REPLACE="Find and Replace",t.TRACK_BATCH_RENAME="Rename Wires in Batch",t.SHEET_BATCH_RENAME="Rename Pages in Batch",t.NET_CREATED_AUTO="Automatic Network Generation",t.DESIGNATOR_ALLOCATION="Annotate Designator",t.UNIQUE_ID_RESET="Reset Unique ID",t.NET_TABLE_EXPORT="Export Netlist",t.REFRESH_PCB_BY_SCH="Update Schematic to PCB",t.REFRESH_SCH_BY_PCB="Update PCB to Schematic",t.CLEAR_DESIGNATOR="Clear Designator",t.UPDATE_PORT_BY_MODULE_SYMBOL="Update Ports from Module Symbol",t.DESIGN_RULE="Set Design Rules",t.NET_CLASS="Set Network Class",t.EQUAL_LENGTH_GROUP="Set Equal Length Group",t.DIFFERENTIAL_PAIR="Set Differential Pair",t))(mC||{}),Eh,p8e=(Eh=class{constructor(e,r=crypto.randomUUID()){this.fileName=e,this.uuid=r,this._params=new URLSearchParams,this._aTarget=document.createElement("a"),this._params.append("uuid",r),this._params.append("fileName",e)}static get URL_VERSION(){var e;try{let r=location.host,i="/";return((e=new RegExp(`${r}(/[\\w|.]+)${i}`).exec(location.href))==null?void 0:e[1])||""}catch{return""}}static getOpenedStream(e){return this._openedInstances.get(e)}get createURL(){return`${Eh.CREATE_URL}?${this._params}`}get writeURL(){return`${Eh.WRITE_URL}?${this._params}`}get closeURL(){return`${Eh.CLOSE_URL}?${this._params}`}async create(){this._aTarget.href=this.createURL,this._aTarget.click(),this._aTarget.remove(),Eh._openedInstances.set(this.uuid,this),await CAe(100)}async write(e){await(await fetch(this.writeURL,{method:"post",body:e})).json()}async close(){await fetch(this.closeURL,{method:"post"}),Eh._openedInstances.delete(this.uuid)}},Eh.CREATE_URL=`${Eh.URL_VERSION}/sw/download/stream/create`,Eh.WRITE_URL="/sw/download/stream/write",Eh.CLOSE_URL="/sw/download/stream/close",Eh._openedInstances=new Map,Eh);var JAe=Object.create,QY=Object.defineProperty,$Ae=Object.getOwnPropertyDescriptor,ZAe=Object.getOwnPropertyNames,efe=Object.getPrototypeOf,tfe=Object.prototype.hasOwnProperty,rfe=(t=>typeof zx<"u"?zx:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof zx<"u"?zx:e)[r]}):t)(function(t){if(typeof zx<"u")return zx.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')}),qn=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),ife=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of ZAe(e))!tfe.call(t,n)&&n!==r&&QY(t,n,{get:()=>e[n],enumerable:!(i=$Ae(e,n))||i.enumerable});return t},x2=(t,e,r)=>(r=t!=null?JAe(efe(t)):{},ife(e||!t||!t.__esModule?QY(r,"default",{value:t,enumerable:!0}):r,t)),gC=qn((t,e)=>{"use strict";var r=Object.defineProperty,i=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,a=(O,K)=>{for(var se in K)r(O,se,{get:K[se],enumerable:!0})},o=(O,K,se,ae)=>{if(K&&typeof K=="object"||typeof K=="function")for(let ue of n(K))!s.call(O,ue)&&ue!==se&&r(O,ue,{get:()=>K[ue],enumerable:!(ae=i(K,ue))||ae.enumerable});return O},l=O=>o(r({},"__esModule",{value:!0}),O),c={};a(c,{BroadcastChannelMessageBus:()=>Qt,MessageBus:()=>He,MessageBus2:()=>ft,MessageBusTask:()=>Le,MessageBusTask2:()=>ut,WindowMessageBridge:()=>ve,WorkerMessageBridge:()=>me,createBroadcastP2PStream:()=>_r,createBufferedByteBufferStream:()=>Pt,createBufferedStream:()=>kt,createBufferedStringStream:()=>sr,dropP2PStream:()=>Lt,flowRead:()=>Jt,flowWrite:()=>Zt}),e.exports=l(c);var u=class{constructor(O=1.5){this.growthFactor=O,this.capacity=10,this.buffer=new Array(this.capacity),this.head=0,this.tail=0,this.count=0}enqueue(O){if(this.count===this.capacity){let K=Math.floor(this.capacity*this.growthFactor);console.log("grow",this.capacity,K);let se=new Array(K);for(let ae=0;ae<this.count;ae++)se[ae]=this.buffer[(this.head+ae)%this.capacity];this.buffer=se,this.head=0,this.tail=this.count,this.capacity=K}this.buffer[this.tail]=O,this.tail=(this.tail+1)%this.capacity,this.count++}dequeue(){if(this.isEmpty())return;let O=this.buffer[this.head];return this.head=(this.head+1)%this.capacity,this.count--,O}peek(){return this.buffer[this.head]}isEmpty(){return this.count===0}clear(){this.buffer.length=0,this.head=0,this.tail=0,this.count=0}},d=new ArrayBuffer(8),A=new Float64Array(d),h=new Uint32Array(d),f=new Uint16Array(d),p=ArrayBuffer;try{p=self.HTMLImageElement||p}catch{}var m=typeof SharedArrayBuffer<"u";function y(O){if(typeof O!="object"||O===null||O instanceof Date||O instanceof ArrayBuffer||m&&O instanceof SharedArrayBuffer||O instanceof Blob||O instanceof FormData||O instanceof Function||O instanceof Uint8ClampedArray||O instanceof p)return O;if(Array.isArray(O))return O.map(y);{let K={};for(let se in O)Object.hasOwnProperty.call(O,se)&&(K[se]=y(O[se]));return K}}function g(O,K){return b(O,K,()=>[])}function b(O,K,se){let ae=O[K];return ae!==void 0||(ae=se(K),O[K]=ae),ae}function E(O,K){if(Array.isArray(O)){for(let se=0,ae=O.length;se<ae;se++)if(K(void 0,O[se],se)===!1)return}else{let se=0;for(let ae in O)if(O.hasOwnProperty(ae)){let ue=O[ae];if(K(ae,ue,se)===!1)return;se++}}}var w=Object.prototype.hasOwnProperty;async function x(O,K){if(Array.isArray(O)){for(let se=0,ae=O.length;se<ae;se++)if(await K(void 0,O[se],se)===!1)return}else{let se=0;for(let ae in O)if(w.call(O,ae)){let ue=O[ae];if(await K(ae,ue,se)===!1)return;se++}}}function I(O,K,se){return typeof O=="string"&&(/https?:/.test(O)||(O=location.origin+O)),Promise.race([fetch(O,K),new Promise((ae,ue)=>setTimeout(ue,se))])}function C(O,K){let se=0,ae=0;return(...ue)=>{let Ie=++se;setTimeout(()=>{let Ce=performance.now();if(Ie===se||Ce-ae>=O){try{K(...ue)}catch(st){console.log(st)}ae=Ce}},Math.max(0,O-(performance.now()-ae)))}}function G(O,K){let se=O.length,ae=0;for(;ae<se;){let ue=O.indexOf(`
`,ae);ue<0&&(ue=se);let Ie=O.substring(ae,ue);try{if(K(Ie)===!1)return}catch(Ce){console.error(Ce)}ae=ue+1}}function U(O){let K=null;return()=>(K===null&&(K=O()),K)}var _=0;function H(){_===0&&(_=Date.now()-performance.now());let O=new Array,K=_+performance.now();A[0]=K,O.push(h[1].toString(16)),A[0]=Math.random(),O.push(f[3].toString(16));let se=f[2].toString(16);O.push("4"+se.substr(0,3)),A[0]=K;let ae=h[0].toString(16)+h[1].toString(16);return O.push("0"+ae.substr(0,3)),O.push(ae.substr(3)),O.join("-")}var Q=class{constructor(O){this.maxResources=O,this.idle=new u,this.isClosed=!1,this.resources=O}acquire(O){this.isClosed?Promise.resolve(!1).then(O):this.resources>0?(this.resources--,Promise.resolve(!0).then(O)):this.idle.enqueue(O)}acquireSync(){return new Promise(O=>{this.acquire(O)})}release(){if(!this.isClosed){let O=this.idle.dequeue();O?Promise.resolve(!0).then(O):this.resources++}}close(){if(!this.isClosed)for(this.isClosed=!0;!this.idle.isEmpty();){let O=this.idle.dequeue();Promise.resolve(!1).then(O)}}};function j(){if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global}function $(O,K,se){let ae=O.length+K-1;for(let ue=0;ue<ae;ue++){let Ie=new Array;for(let Ce=ue-K+1;Ce<=ue;Ce++)Ie.push(O[Ce]);if(se(Ie)===!1)break}}function B(){let O=new Date,K=O.getFullYear(),se=O.getMonth()+1,ae=O.getDate(),ue=O.getHours(),Ie=O.getMinutes(),Ce=O.getSeconds(),st=O.getMilliseconds();return"["+K+"-"+(se<10?"0"+se:se)+"-"+(ae<10?"0"+ae:ae)+" "+(ue<10?"0"+ue:ue)+":"+(Ie<10?"0"+Ie:Ie)+":"+(Ce<10?"0"+Ce:Ce)+"."+(st<100?st<10?"00"+st:"0"+st:st)+"] "}function M(O){return new Promise(K=>setTimeout(K,O))}function v(O,K){let se=0,ae=O.length;for(let ue=0;ue<ae;ue++)O[ue]===K&&(O.splice(ue,1),ue--,ae--,se++);return se}var N=j(),R=N.WeakRef||(O=>O);function q(O){if(O!=null){if(typeof O=="object")return new R(O);console.error(O,O instanceof Object,typeof O);return}}function P(O){return O==null?void 0:O.deref()}var z="_MSG_BUS_RPC_",W=300*1e3,oe=(O=>(O.PUBLISH="publish",O.SUBSCRIBE="subscribe",O.PUSH="push",O.PULL="pull",O))(oe||{}),Ae=class{constructor(O){this.bus=O}processRemoteMessage(O,K){let se=q(K),ae=O.topic,ue=O.type,Ie=O.message;switch(ue){case"pull":this.bus.pull(ae,Ce=>{this.push(ae,Ce,P(se))});break;case"subscribe":this.bus.subscribe(ae,Ce=>{this.publish(ae,Ce,P(se))});break;case"publish":this.bus.publish(ae,Ie,this,P(se));break;case"push":this.bus.push(ae,Ie,this,P(se));break;default:console.debug("unknown message type "+ue)}}rpcCall(O,K,se,ae=W){let ue=q(se),Ie=new Promise(Ce=>{let st=this.bus.uniqueRpcTopic(O);this.publish(O,{message:K,reply:st},P(ue)),this.bus.pull(st,(it,Kt,ar)=>{Ce({message:it,bridge:Kt,source:q(ar)})})});return ae>0?Promise.race([Ie,new Promise((Ce,st)=>{setTimeout(st,ae)})]):Ie}},me=class extends Ae{constructor(O,K){super(O),this.worker=K,K.onmessage=se=>{this.processRemoteMessage(se.data,void 0)}}publish(O,K){this.postMessage(O,"publish",K)}subscribe(O){this.postMessage(O,"subscribe",null)}push(O,K){this.postMessage(O,"push",K)}pull(O){this.postMessage(O,"pull",null)}rpcCall(O,K,se=W){return super.rpcCall(O,K,void 0,se)}postMessage(O,K,se){let ae={topic:O,type:K,message:se};this.worker.postMessage(ae)}discard(){this.worker.terminate()}},ve=class extends Ae{constructor(O){super(O),window.addEventListener("message",K=>{this.processRemoteMessage(K.data,K.source)},!1)}publish(O,K,se){this.postMessage(O,"publish",K,se)}subscribe(O,K){if(K===window)throw new Error("regist remote subscribe from current window is not permitted");this.postMessage(O,"subscribe",null,K)}push(O,K,se){this.postMessage(O,"push",K,se)}pull(O,K){if(K===window)throw new Error("regist remote pull from current window is not permitted");this.postMessage(O,"pull",null,K)}postMessage(O,K,se,ae){let ue={topic:O,type:K,message:se};ae&&ae.postMessage(ue,"*")}},Le=class{constructor(O){this.isRunning=!0,this.callback=O}cancel(){this.callback=null,this.isRunning=!1}running(){return this.isRunning}execute(O,K,se,ae){try{O=ae?O:y(O),this.callback(O,K,se)}catch(ue){console.error(ue)}}},He=class{constructor(O=!1){this.subscribed={},this.pulled={},this.pushed={},this.uuid=crypto.randomUUID().replace(/-/g,""),this.rpcTicket=0,this.unsafe=O}uniqueRpcTopic(O){return`${z}-${O}-${this.uuid}-${this.rpcTicket++}`}publish(O,K,se,ae){let ue=this.subscribed[O];if(ue){let Ie;for(let Ce of ue)Ce.running()?Ce.execute(K,se,ae,this.unsafe):(Ie=Ie||new Array,Ie.push(Ce));if(Ie)for(let Ce of Ie)v(ue,Ce)}else console.debug("no sub on topic: "+O)}subscribe(O,K){let se=new Le(K);return g(this.subscribed,O).push(se),se}push(O,K,se,ae){let ue=!1,Ie=this.pulled[O];if(Ie){for(;Ie.length>0;){let Ce=Ie.shift();if(Ce.running()){Ce.execute(K,se,ae,this.unsafe),ue=!0;break}}Ie.length===0&&delete this.pulled[O]}ue||g(this.pushed,O).push({message:K,bridge:se,source:q(ae)})}pull(O,K){let se=new Le(K),ae=this.pushed[O];if(ae){let ue=ae.shift();se.execute(ue.message,ue.bridge,P(ue.source),this.unsafe),ae.length===0&&delete this.pushed[O]}else g(this.pulled,O).push(se);return se}pullA(O){return new Promise(K=>{this.pull(O,(se,ae,ue)=>{K({message:se,bridge:ae,source:q(ue)})})})}rpcService(O,K){this.subscribe(O,(se,ae,ue)=>{let{message:Ie,reply:Ce}=se;try{let st=K(Ie);if(st instanceof Promise){let it=q(ue);st.then(Kt=>{this.rpcReply(Kt,Ce,ae,P(it))},Kt=>{console.error(Kt),this.rpcReply(void 0,Ce,ae,P(it))})}else this.rpcReply(st,Ce,ae,ue)}catch(st){console.error(st),this.rpcReply(void 0,Ce,ae,ue)}})}rpcCall(O,K,se=W){let ae=new Promise(ue=>{let Ie=this.uniqueRpcTopic(O);this.publish(O,{message:K,reply:Ie}),this.pull(Ie,(Ce,st,it)=>{ue({message:Ce,bridge:st,source:q(it)})})});return se>0?Promise.race([ae,new Promise((ue,Ie)=>{setTimeout(Ie,se)})]):ae}rpcReply(O,K,se,ae){se?se.push(K,O,ae):this.push(K,O)}},rt="_MSG_BUS_RPC_";function qe(O,K){let se=0,ae=O.length;for(let ue=0;ue<ae;ue++)O[ue]===K&&(O.splice(ue,1),ue--,ae--,se++);return se}function xt(O,K){return Gt(O,K,()=>[])}function Gt(O,K,se){let ae=O[K];return ae!==void 0||(ae=se(K),O[K]=ae),ae}var ut=class{constructor(O,K){this.callback=O,this.unsafe=K,this.isRunning=!0}cancel(){this.callback=null,this.isRunning=!1}running(){return this.isRunning}async execute(O){try{O=this.unsafe?O:y(O),this.callback(O)}catch(K){console.error(K)}}},Pe=class{constructor(O=crypto.randomUUID()){this.uuid=O,this.rpcTicket=0}subscribeOnce(O,K){let se=this.subscribe(O,ae=>{se.cancel(),K(ae)});return se}pullA(O){return new Promise(K=>{this.pull(O,K)})}rpcService(O,K){let se=ae=>{try{let{message:ue,replyTopic:Ie}=ae;try{let Ce=K(ue);Ce instanceof Promise?Ce.then(st=>{this.publish(Ie,{success:!0,result:st})}).catch(st=>{console.error(st),this.publish(Ie,{success:!1,err:String(st)})}):this.publish(Ie,{success:!0,result:Ce})}catch(Ce){this.publish(Ie,{success:!1,err:String(Ce)})}}finally{this.pull(O,se)}};this.pull(O,se)}rpcCall(O,K,se=0){let ae=new Promise((ue,Ie)=>{let Ce=`${rt}-${O}-${this.uuid}-${this.rpcTicket++}`;this.subscribeOnce(Ce,st=>{st.success?ue(st.result):Ie(new Error(st.err))}),this.push(O,{message:K,replyTopic:Ce})});return se>0?Promise.race([ae,new Promise((ue,Ie)=>{setTimeout(Ie,se)})]):ae}},ft=class extends Pe{constructor(O=!1){super(),this.unsafe=O,this.subscribed={},this.pulled={},this.pushed={}}publish(O,K){let se=this.subscribed[O];if(se){let ae;for(let ue of se)ue.running()?ue.execute(K):(ae=ae||new Array,ae.push(ue));if(ae)for(let ue of ae)qe(se,ue)}}subscribe(O,K){let se=new ut(K,this.unsafe);return xt(this.subscribed,O).push(se),se}push(O,K){let se=!1,ae=this.pulled[O];if(ae){for(;ae.length>0;){let ue=ae.shift();if(ue&&ue.running()){ue.execute(K),se=!0;break}}ae.length===0&&delete this.pulled[O]}se||xt(this.pushed,O).push(K)}pull(O,K){let se=new ut(K,this.unsafe);return this.repull(O,se),se}repull(O,K){let se=this.pushed[O];if(se){let ae=se.shift();ae&&(K.execute(ae),se.length===0&&delete this.pushed[O])}else xt(this.pulled,O).push(K)}},ht=class extends Pe{constructor(O=crypto.randomUUID()){super(O),this.subscribed={},this.pushed={},this.pulled={},this.pushCnt=0}publish(O,K){console.debug("BC",this.uuid,"PUBLISH",O,K),this.broadcastPublish(O,K)}subscribe(O,K){console.debug("BC",this.uuid,"SUBSCRIBE",O);let se=new ut(K,!0);return xt(this.subscribed,O).push(se),se}push(O,K){let se=this.pushCnt++;console.debug("BC",this.uuid,"PUSH",O,`(${se})`,K),xt(this.pushed,O).push({id:se,message:K}),this.broadcastPushedHeadMessage(O)}pull(O,K){console.debug("BC",this.uuid,"PULL",O);let se=new ut(K,!0);return xt(this.pulled,O).push(se),this.broadcastWhoHas(O),se}broadcastPushedHeadMessage(O){let K=this.pushed[O];K&&K[0]&&this.broadcastIHave(O,K[0].id)}onReceivedPublish(O,K,se){console.debug("BCMSG(",this.uuid,")","from",O,"PUBLISH",K,"message",se);let ae=this.subscribed[K];if(ae){let ue;for(let Ie of ae)Ie.running()?Ie.execute(se):(ue=ue||new Array,ue.push(Ie));if(ue)for(let Ie of ue)qe(ae,Ie);ae.length===0&&delete this.subscribed[K]}}onReceivedWhoHas(O,K){console.debug("BCMSG(",this.uuid,")","from",O,"WHOHAS",K),this.broadcastPushedHeadMessage(K)}onReceivedIHave(O,K,se){console.debug("BCMSG(",this.uuid,")","from",O,"IHAVE",K,"id",se);let ae=this.pulled[K];if(ae){let ue;for(let Ie of ae)if(Ie.running()){this.broadcastINeed(K,O,se);break}else ue=ue||new Array,ue.push(Ie);if(ue)for(let Ie of ue)qe(ae,Ie);ae.length===0&&delete this.pulled[K]}}onReceivedINeed(O,K,se,ae){if(console.debug("BCMSG(",this.uuid,")","from",O,"INEED",K,"source",se,"id",ae),this.uuid===se){let ue=this.pushed[K];if(ue&&ue[0]&&ue[0].id===ae){let{message:Ie}=ue.shift();this.broadcastIGive(K,ae,O,Ie),this.broadcastPushedHeadMessage(K),ue.length===0&&delete this.pushed[K]}}}onReceivedIGive(O,K,se,ae,ue){console.debug("BCMSG(",this.uuid,")","from",O,"IGIVE",K,"id",se,"target",ae,"message",ue);let Ie=this.pulled[K];if(Ie&&this.uuid===ae){let Ce=!1;for(;Ie.length>0;){let st=Ie.shift();if(st.running()){st.execute(ue),Ce=!0;break}}Ce||this.push(K,ue),Ie.length===0&&delete this.pulled[K]}}},Qt=class extends ht{constructor(O,K=crypto.randomUUID()){super(K),this.bc=new BroadcastChannel(O),this.bc.onmessage=se=>{this.onMessage(se.data)}}onMessage(O){let{type:K,uuid:se,topic:ae}=O;switch(K){case"PUBLISH":{let{message:ue}=O;this.onReceivedPublish(se,ae,ue);break}case"WHOHAS":{this.onReceivedWhoHas(se,ae);break}case"IHAVE":{let{id:ue}=O;this.onReceivedIHave(se,ae,ue);break}case"INEED":{let{source:ue,id:Ie}=O;this.onReceivedINeed(se,ae,ue,Ie);break}case"IGIVE":{let{target:ue,id:Ie,message:Ce}=O;this.onReceivedIGive(se,ae,Ie,ue,Ce);break}default:console.warn("unsupported",O)}}broadcastPublish(O,K){this.post({type:"PUBLISH",uuid:this.uuid,topic:O,message:K})}broadcastWhoHas(O){this.post({type:"WHOHAS",uuid:this.uuid,topic:O})}broadcastIHave(O,K){this.post({type:"IHAVE",uuid:this.uuid,topic:O,id:K})}broadcastINeed(O,K,se){this.post({type:"INEED",uuid:this.uuid,topic:O,source:K,id:se})}broadcastIGive(O,K,se,ae){this.post({type:"IGIVE",uuid:this.uuid,topic:O,id:K,target:se,message:ae})}post(O){this.bc.postMessage(O),Promise.resolve().then(()=>{this.onMessage(O)})}},Yt=Symbol("BLOCKING_QUEUE_RESET"),Ft=class{constructor(O,K=()=>1){if(this.maxSize=O,this.itemSizeOf=K,this.queue=new u,this.waitingConsumers=new u,this.waitingProducers=new u,this.queueSize=0,this.closePromise=null,this.closeResolve=null,O<=0)throw new Error("Max size must be greater than 0")}enqueue(O){return this.closePromise?!1:this.isFull()?(async()=>{console.debug("queue is full",this.queueSize,this.maxSize);let K=await new Promise(se=>{this.waitingProducers.enqueue(se)});return console.debug("queue is not full",this.size(),K),K?(this.innerEnqueue(O),!0):!1})():(this.innerEnqueue(O),!0)}innerEnqueue(O){if(this.waitingConsumers.isEmpty())this.queue.enqueue(O),this.queueSize+=this.itemSizeOf(O),console.debug("queue pushed",O,"size",this.queueSize);else{let K=this.waitingConsumers.dequeue();Promise.resolve(O).then(K),console.debug("queue direct",O,"size",this.queueSize)}}dequeue(){if(this.queue.isEmpty())if(this.closePromise){for(;!this.waitingConsumers.isEmpty();){let O=this.waitingConsumers.dequeue();Promise.resolve(Yt).then(O)}return setTimeout(()=>this.closeResolve(),0),Yt}else return new Promise(O=>{this.waitingConsumers.enqueue(O)});else{let O=this.queue.dequeue();if(this.queueSize-=this.itemSizeOf(O),!this.waitingProducers.isEmpty()){let K=this.waitingProducers.dequeue();Promise.resolve(!0).then(K)}return O}}size(){return this.queueSize}isEmpty(){return this.queueSize===0}isFull(){return this.queueSize>=this.maxSize}close(){return this.closePromise||(this.closePromise=new Promise(O=>{for(this.closeResolve=O;!this.waitingProducers.isEmpty();){let K=this.waitingProducers.dequeue();Promise.resolve(!1).then(K)}if(this.queueSize===0){for(;!this.waitingConsumers.isEmpty();){let K=this.waitingConsumers.dequeue();Promise.resolve(Yt).then(K)}O()}})),this.closePromise}};function kt(O,K,se=Number.MAX_SAFE_INTEGER){let ae=new Ft(se,K),ue=new ReadableStream({pull(Ce){let st=!0,it=(async()=>{let Kt=new Array;do{let ar=ae.dequeue();if(ar instanceof Promise){st=!1;let lr=await ar;lr===Yt?Ce.close():Kt.push(lr)}else{let lr=ar;lr===Yt?Ce.close():Kt.push(lr)}}while(ae.size()>0);if(Kt.length>0){let ar=O(Kt);Ce.enqueue(ar)}})();if(!st)return console.debug("read stream stucked --------------------------------------"),it},async cancel(){console.debug("buffered readable cancel"),await ae.close()}}),Ie=new WritableStream({write(Ce,st){let it=!0,Kt=(async()=>{let ar=ae.enqueue(Ce);typeof ar=="boolean"?ar||st.error(new Error("Write stream closed")):(it=!1,await ar||st.error(new Error("Write stream closed")))})();if(!it)return console.debug("read stream stucked >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"),Kt},async close(){console.debug("buffered writable closing",ae.size()),await ae.close(),console.debug("buffered writable closed",ae.size())},async abort(){console.debug("buffered writable aborting",ae.size()),await ae.close(),console.debug("buffered writable aborted",ae.size())}});return{readable:ue,writable:Ie}}function sr(O=Number.MAX_SAFE_INTEGER){return kt(K=>K.join(""),K=>K.length,O)}function Pt(O=Number.MAX_SAFE_INTEGER){return kt(K=>{let se=new Uint8Array(K.reduce((ue,Ie)=>ue+Ie.byteLength,0)),ae=0;return K.forEach(ue=>{se.set(ue,ae),ae+=ue.byteLength}),se},K=>K.byteLength,O)}function _r(O){return new Promise((K,se)=>{let ae=new BroadcastChannel(O),ue=new Ft(1),Ie=new Q(1),Ce=null,st=!1,it=!1,Kt=!1;ae.onmessage=ar=>{let lr=ar.data,{type:yr}=lr;if(console.debug("p2p",O,"type",yr,"data",yr==="DATA"&&lr.data),yr==="DATA")ue.enqueue(lr.data);else if(yr==="HI"){if(!Ce){ae.postMessage({type:"HI"});let nn=0;Ce={rs:new ReadableStream({async pull(sn){let Dn=await ue.dequeue();Dn===Yt?(await Tr(),sn.close()):(sn.enqueue(Dn),ae.postMessage({type:"ACK"}))},cancel(){return Tr()}}),ws:new WritableStream({async write(sn,Dn){await Ie.acquireSync()?ae.postMessage({type:"DATA",id:nn++,data:sn}):(xi(),Dn.error(new Error("Write stream closed")))},close(){xi()},abort(){xi()}})},K(Ce)}}else yr==="REND"?Ce?Ie.close():ii("REND1"):yr==="WEND"?Ce?ue.close():ii("WEND1"):yr==="ACK"&&Ie.release();function xi(){st||(st=!0,console.debug(O,"p2p write stream closed"),Ie.close(),ae.postMessage({type:"WEND"}),it&&(console.debug(O,"p2p channel closed on ws"),ae.close()))}async function Tr(){it||(it=!0,console.debug(O,"p2p read stream closed"),ae.postMessage({type:"REND"}),await ue.close(),st&&(console.debug(O,"p2p channel closed on rs"),ae.close()))}async function ii(nn){Kt||(Kt=!0,console.debug(O,"p2p channel connection released on",nn),Ie.close(),ue.close(),Ce?(Ce.rs.locked||(console.debug(O,"p2p unlocked read stream direct cancel"),Ce.rs.cancel()),Ce.ws.locked||(console.debug(O,"p2p unlocked write stream direct close"),Ce.ws.close())):(ae.postMessage({type:"HI"}),ae.close()),se(new Error("p2p channel connection released")))}},ae.postMessage({type:"HI"})})}function Lt(O){return new Promise(K=>{let se=new BroadcastChannel(O);se.onmessage=ae=>{let ue=ae.data,{type:Ie}=ue;Ie==="HI"&&(se.postMessage({type:"REND"}),se.close(),K())},se.postMessage({type:"REND"})})}async function ct(O){try{return await _r(O)}catch(K){K.message!=="p2p channel connection released"&&console.error(K)}}async function Zt(O,K,se=10*1024*1024,ae=!0){let ue=await ct(O);if(!ue)return!1;let Ie=!1;try{let Ce,st=it=>{if(!Ce)if(!ae)Ce=ue.ws.getWriter();else if(typeof it=="string"){let Kt=sr(se);Kt.readable.pipeTo(ue.ws),Ce=Kt.writable.getWriter()}else{let Kt=Pt(se);Kt.readable.pipeTo(ue.ws),Ce=Kt.writable.getWriter()}return Ce.write(it)};if(Array.isArray(K))for(let it of K)await st(it);else await K({write:st,get desiredSize(){return((Ce==null?void 0:Ce.desiredSize)||0)+10}});Ce&&await Ce.close(),Ie=!0}catch(Ce){console.error(Ce)}finally{return ue.rs.cancel(),Ie}}async function Jt(O,K){var ae,ue;let se=await ct(O);if(se)try{let Ie=se.rs.getReader();for((ae=K.start)==null?void 0:ae.call(K);;){let{value:Ce,done:st}=await Ie.read();if(Ce!==void 0){let it;if(K.update instanceof Promise?it=await K.update(Ce):it=K.update(Ce),it){await Ie.cancel();break}}if(st){(ue=K.end)==null||ue.call(K);break}}}catch(Ie){console.error(Ie)}finally{se.ws.close()}}}),nfe=qn(()=>{}),As=qn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i():typeof define=="function"&&define.amd?define([],i):r.CryptoJS=i()})(t,function(){var r=r||(function(i,n){var s;if(typeof window<"u"&&window.crypto&&(s=window.crypto),typeof self<"u"&&self.crypto&&(s=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(s=globalThis.crypto),!s&&typeof window<"u"&&window.msCrypto&&(s=window.msCrypto),!s&&typeof global<"u"&&global.crypto&&(s=global.crypto),!s&&typeof rfe=="function")try{s=nfe()}catch{}var a=function(){if(s){if(typeof s.getRandomValues=="function")try{return s.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof s.randomBytes=="function")try{return s.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||(function(){function b(){}return function(E){var w;return b.prototype=E,w=new b,b.prototype=null,w}})(),l={},c=l.lib={},u=c.Base=(function(){return{extend:function(b){var E=o(this);return b&&E.mixIn(b),(!E.hasOwnProperty("init")||this.init===E.init)&&(E.init=function(){E.$super.init.apply(this,arguments)}),E.init.prototype=E,E.$super=this,E},create:function(){var b=this.extend();return b.init.apply(b,arguments),b},init:function(){},mixIn:function(b){for(var E in b)b.hasOwnProperty(E)&&(this[E]=b[E]);b.hasOwnProperty("toString")&&(this.toString=b.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),d=c.WordArray=u.extend({init:function(b,E){b=this.words=b||[],E!=n?this.sigBytes=E:this.sigBytes=b.length*4},toString:function(b){return(b||h).stringify(this)},concat:function(b){var E=this.words,w=b.words,x=this.sigBytes,I=b.sigBytes;if(this.clamp(),x%4)for(var C=0;C<I;C++){var G=w[C>>>2]>>>24-C%4*8&255;E[x+C>>>2]|=G<<24-(x+C)%4*8}else for(var U=0;U<I;U+=4)E[x+U>>>2]=w[U>>>2];return this.sigBytes+=I,this},clamp:function(){var b=this.words,E=this.sigBytes;b[E>>>2]&=4294967295<<32-E%4*8,b.length=i.ceil(E/4)},clone:function(){var b=u.clone.call(this);return b.words=this.words.slice(0),b},random:function(b){for(var E=[],w=0;w<b;w+=4)E.push(a());return new d.init(E,b)}}),A=l.enc={},h=A.Hex={stringify:function(b){for(var E=b.words,w=b.sigBytes,x=[],I=0;I<w;I++){var C=E[I>>>2]>>>24-I%4*8&255;x.push((C>>>4).toString(16)),x.push((C&15).toString(16))}return x.join("")},parse:function(b){for(var E=b.length,w=[],x=0;x<E;x+=2)w[x>>>3]|=parseInt(b.substr(x,2),16)<<24-x%8*4;return new d.init(w,E/2)}},f=A.Latin1={stringify:function(b){for(var E=b.words,w=b.sigBytes,x=[],I=0;I<w;I++){var C=E[I>>>2]>>>24-I%4*8&255;x.push(String.fromCharCode(C))}return x.join("")},parse:function(b){for(var E=b.length,w=[],x=0;x<E;x++)w[x>>>2]|=(b.charCodeAt(x)&255)<<24-x%4*8;return new d.init(w,E)}},p=A.Utf8={stringify:function(b){try{return decodeURIComponent(escape(f.stringify(b)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(b){return f.parse(unescape(encodeURIComponent(b)))}},m=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(b){typeof b=="string"&&(b=p.parse(b)),this._data.concat(b),this._nDataBytes+=b.sigBytes},_process:function(b){var E,w=this._data,x=w.words,I=w.sigBytes,C=this.blockSize,G=C*4,U=I/G;b?U=i.ceil(U):U=i.max((U|0)-this._minBufferSize,0);var _=U*C,H=i.min(_*4,I);if(_){for(var Q=0;Q<_;Q+=C)this._doProcessBlock(x,Q);E=x.splice(0,_),w.sigBytes-=H}return new d.init(E,H)},clone:function(){var b=u.clone.call(this);return b._data=this._data.clone(),b},_minBufferSize:0}),y=c.Hasher=m.extend({cfg:u.extend(),init:function(b){this.cfg=this.cfg.extend(b),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(b){return this._append(b),this._process(),this},finalize:function(b){b&&this._append(b);var E=this._doFinalize();return E},blockSize:512/32,_createHelper:function(b){return function(E,w){return new b.init(w).finalize(E)}},_createHmacHelper:function(b){return function(E,w){return new g.HMAC.init(b,w).finalize(E)}}}),g=l.algo={};return l})(Math);return r})}),JD=qn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(As()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(i){var n=r,s=n.lib,a=s.Base,o=s.WordArray,l=n.x64={},c=l.Word=a.extend({init:function(d,A){this.high=d,this.low=A}}),u=l.WordArray=a.extend({init:function(d,A){d=this.words=d||[],A!=i?this.sigBytes=A:this.sigBytes=d.length*8},toX32:function(){for(var d=this.words,A=d.length,h=[],f=0;f<A;f++){var p=d[f];h.push(p.high),h.push(p.low)}return o.create(h,this.sigBytes)},clone:function(){for(var d=a.clone.call(this),A=d.words=this.words.slice(0),h=A.length,f=0;f<h;f++)A[f]=A[f].clone();return d}})})(),r})}),sfe=qn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(As()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(){if(typeof ArrayBuffer=="function"){var i=r,n=i.lib,s=n.WordArray,a=s.init,o=s.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var c=l.byteLength,u=[],d=0;d<c;d++)u[d>>>2]|=l[d]<<24-d%4*8;a.call(this,u,c)}else a.apply(this,arguments)};o.prototype=s}})(),r.lib.WordArray})}),afe=qn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(As()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.WordArray,a=i.enc,o=a.Utf16=a.Utf16BE={stringify:function(c){for(var u=c.words,d=c.sigBytes,A=[],h=0;h<d;h+=2){var f=u[h>>>2]>>>16-h%4*8&65535;A.push(String.fromCharCode(f))}return A.join("")},parse:function(c){for(var u=c.length,d=[],A=0;A<u;A++)d[A>>>1]|=c.charCodeAt(A)<<16-A%2*16;return s.create(d,u*2)}};a.Utf16LE={stringify:function(c){for(var u=c.words,d=c.sigBytes,A=[],h=0;h<d;h+=2){var f=l(u[h>>>2]>>>16-h%4*8&65535);A.push(String.fromCharCode(f))}return A.join("")},parse:function(c){for(var u=c.length,d=[],A=0;A<u;A++)d[A>>>1]|=l(c.charCodeAt(A)<<16-A%2*16);return s.create(d,u*2)}};function l(c){return c<<8&4278255360|c>>>8&16711935}})(),r.enc.Utf16})}),N1=qn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(As()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.WordArray,a=i.enc,o=a.Base64={stringify:function(c){var u=c.words,d=c.sigBytes,A=this._map;c.clamp();for(var h=[],f=0;f<d;f+=3)for(var p=u[f>>>2]>>>24-f%4*8&255,m=u[f+1>>>2]>>>24-(f+1)%4*8&255,y=u[f+2>>>2]>>>24-(f+2)%4*8&255,g=p<<16|m<<8|y,b=0;b<4&&f+b*.75<d;b++)h.push(A.charAt(g>>>6*(3-b)&63));var E=A.charAt(64);if(E)for(;h.length%4;)h.push(E);return h.join("")},parse:function(c){var u=c.length,d=this._map,A=this._reverseMap;if(!A){A=this._reverseMap=[];for(var h=0;h<d.length;h++)A[d.charCodeAt(h)]=h}var f=d.charAt(64);if(f){var p=c.indexOf(f);p!==-1&&(u=p)}return l(c,u,A)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function l(c,u,d){for(var A=[],h=0,f=0;f<u;f++)if(f%4){var p=d[c.charCodeAt(f-1)]<<f%4*2,m=d[c.charCodeAt(f)]>>>6-f%4*2,y=p|m;A[h>>>2]|=y<<24-h%4*8,h++}return s.create(A,h)}})(),r.enc.Base64})}),ofe=qn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(As()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.WordArray,a=i.enc,o=a.Base64url={stringify:function(c,u){u===void 0&&(u=!0);var d=c.words,A=c.sigBytes,h=u?this._safe_map:this._map;c.clamp();for(var f=[],p=0;p<A;p+=3)for(var m=d[p>>>2]>>>24-p%4*8&255,y=d[p+1>>>2]>>>24-(p+1)%4*8&255,g=d[p+2>>>2]>>>24-(p+2)%4*8&255,b=m<<16|y<<8|g,E=0;E<4&&p+E*.75<A;E++)f.push(h.charAt(b>>>6*(3-E)&63));var w=h.charAt(64);if(w)for(;f.length%4;)f.push(w);return f.join("")},parse:function(c,u){u===void 0&&(u=!0);var d=c.length,A=u?this._safe_map:this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var f=0;f<A.length;f++)h[A.charCodeAt(f)]=f}var p=A.charAt(64);if(p){var m=c.indexOf(p);m!==-1&&(d=m)}return l(c,d,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function l(c,u,d){for(var A=[],h=0,f=0;f<u;f++)if(f%4){var p=d[c.charCodeAt(f-1)]<<f%4*2,m=d[c.charCodeAt(f)]>>>6-f%4*2,y=p|m;A[h>>>2]|=y<<24-h%4*8,h++}return s.create(A,h)}})(),r.enc.Base64url})}),R1=qn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(As()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(i){var n=r,s=n.lib,a=s.WordArray,o=s.Hasher,l=n.algo,c=[];(function(){for(var p=0;p<64;p++)c[p]=i.abs(i.sin(p+1))*4294967296|0})();var u=l.MD5=o.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(p,m){for(var y=0;y<16;y++){var g=m+y,b=p[g];p[g]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360}var E=this._hash.words,w=p[m+0],x=p[m+1],I=p[m+2],C=p[m+3],G=p[m+4],U=p[m+5],_=p[m+6],H=p[m+7],Q=p[m+8],j=p[m+9],$=p[m+10],B=p[m+11],M=p[m+12],v=p[m+13],N=p[m+14],R=p[m+15],q=E[0],P=E[1],z=E[2],W=E[3];q=d(q,P,z,W,w,7,c[0]),W=d(W,q,P,z,x,12,c[1]),z=d(z,W,q,P,I,17,c[2]),P=d(P,z,W,q,C,22,c[3]),q=d(q,P,z,W,G,7,c[4]),W=d(W,q,P,z,U,12,c[5]),z=d(z,W,q,P,_,17,c[6]),P=d(P,z,W,q,H,22,c[7]),q=d(q,P,z,W,Q,7,c[8]),W=d(W,q,P,z,j,12,c[9]),z=d(z,W,q,P,$,17,c[10]),P=d(P,z,W,q,B,22,c[11]),q=d(q,P,z,W,M,7,c[12]),W=d(W,q,P,z,v,12,c[13]),z=d(z,W,q,P,N,17,c[14]),P=d(P,z,W,q,R,22,c[15]),q=A(q,P,z,W,x,5,c[16]),W=A(W,q,P,z,_,9,c[17]),z=A(z,W,q,P,B,14,c[18]),P=A(P,z,W,q,w,20,c[19]),q=A(q,P,z,W,U,5,c[20]),W=A(W,q,P,z,$,9,c[21]),z=A(z,W,q,P,R,14,c[22]),P=A(P,z,W,q,G,20,c[23]),q=A(q,P,z,W,j,5,c[24]),W=A(W,q,P,z,N,9,c[25]),z=A(z,W,q,P,C,14,c[26]),P=A(P,z,W,q,Q,20,c[27]),q=A(q,P,z,W,v,5,c[28]),W=A(W,q,P,z,I,9,c[29]),z=A(z,W,q,P,H,14,c[30]),P=A(P,z,W,q,M,20,c[31]),q=h(q,P,z,W,U,4,c[32]),W=h(W,q,P,z,Q,11,c[33]),z=h(z,W,q,P,B,16,c[34]),P=h(P,z,W,q,N,23,c[35]),q=h(q,P,z,W,x,4,c[36]),W=h(W,q,P,z,G,11,c[37]),z=h(z,W,q,P,H,16,c[38]),P=h(P,z,W,q,$,23,c[39]),q=h(q,P,z,W,v,4,c[40]),W=h(W,q,P,z,w,11,c[41]),z=h(z,W,q,P,C,16,c[42]),P=h(P,z,W,q,_,23,c[43]),q=h(q,P,z,W,j,4,c[44]),W=h(W,q,P,z,M,11,c[45]),z=h(z,W,q,P,R,16,c[46]),P=h(P,z,W,q,I,23,c[47]),q=f(q,P,z,W,w,6,c[48]),W=f(W,q,P,z,H,10,c[49]),z=f(z,W,q,P,N,15,c[50]),P=f(P,z,W,q,U,21,c[51]),q=f(q,P,z,W,M,6,c[52]),W=f(W,q,P,z,C,10,c[53]),z=f(z,W,q,P,$,15,c[54]),P=f(P,z,W,q,x,21,c[55]),q=f(q,P,z,W,Q,6,c[56]),W=f(W,q,P,z,R,10,c[57]),z=f(z,W,q,P,_,15,c[58]),P=f(P,z,W,q,v,21,c[59]),q=f(q,P,z,W,G,6,c[60]),W=f(W,q,P,z,B,10,c[61]),z=f(z,W,q,P,I,15,c[62]),P=f(P,z,W,q,j,21,c[63]),E[0]=E[0]+q|0,E[1]=E[1]+P|0,E[2]=E[2]+z|0,E[3]=E[3]+W|0},_doFinalize:function(){var p=this._data,m=p.words,y=this._nDataBytes*8,g=p.sigBytes*8;m[g>>>5]|=128<<24-g%32;var b=i.floor(y/4294967296),E=y;m[(g+64>>>9<<4)+15]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,m[(g+64>>>9<<4)+14]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,p.sigBytes=(m.length+1)*4,this._process();for(var w=this._hash,x=w.words,I=0;I<4;I++){var C=x[I];x[I]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360}return w},clone:function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p}});function d(p,m,y,g,b,E,w){var x=p+(m&y|~m&g)+b+w;return(x<<E|x>>>32-E)+m}function A(p,m,y,g,b,E,w){var x=p+(m&g|y&~g)+b+w;return(x<<E|x>>>32-E)+m}function h(p,m,y,g,b,E,w){var x=p+(m^y^g)+b+w;return(x<<E|x>>>32-E)+m}function f(p,m,y,g,b,E,w){var x=p+(y^(m|~g))+b+w;return(x<<E|x>>>32-E)+m}n.MD5=o._createHelper(u),n.HmacMD5=o._createHmacHelper(u)})(Math),r.MD5})}),zY=qn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(As()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.WordArray,a=n.Hasher,o=i.algo,l=[],c=o.SHA1=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,d){for(var A=this._hash.words,h=A[0],f=A[1],p=A[2],m=A[3],y=A[4],g=0;g<80;g++){if(g<16)l[g]=u[d+g]|0;else{var b=l[g-3]^l[g-8]^l[g-14]^l[g-16];l[g]=b<<1|b>>>31}var E=(h<<5|h>>>27)+y+l[g];g<20?E+=(f&p|~f&m)+1518500249:g<40?E+=(f^p^m)+1859775393:g<60?E+=(f&p|f&m|p&m)-1894007588:E+=(f^p^m)-899497514,y=m,m=p,p=f<<30|f>>>2,f=h,h=E}A[0]=A[0]+h|0,A[1]=A[1]+f|0,A[2]=A[2]+p|0,A[3]=A[3]+m|0,A[4]=A[4]+y|0},_doFinalize:function(){var u=this._data,d=u.words,A=this._nDataBytes*8,h=u.sigBytes*8;return d[h>>>5]|=128<<24-h%32,d[(h+64>>>9<<4)+14]=Math.floor(A/4294967296),d[(h+64>>>9<<4)+15]=A,u.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var u=a.clone.call(this);return u._hash=this._hash.clone(),u}});i.SHA1=a._createHelper(c),i.HmacSHA1=a._createHmacHelper(c)})(),r.SHA1})}),W4=qn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(As()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(i){var n=r,s=n.lib,a=s.WordArray,o=s.Hasher,l=n.algo,c=[],u=[];(function(){function h(y){for(var g=i.sqrt(y),b=2;b<=g;b++)if(!(y%b))return!1;return!0}function f(y){return(y-(y|0))*4294967296|0}for(var p=2,m=0;m<64;)h(p)&&(m<8&&(c[m]=f(i.pow(p,1/2))),u[m]=f(i.pow(p,1/3)),m++),p++})();var d=[],A=l.SHA256=o.extend({_doReset:function(){this._hash=new a.init(c.slice(0))},_doProcessBlock:function(h,f){for(var p=this._hash.words,m=p[0],y=p[1],g=p[2],b=p[3],E=p[4],w=p[5],x=p[6],I=p[7],C=0;C<64;C++){if(C<16)d[C]=h[f+C]|0;else{var G=d[C-15],U=(G<<25|G>>>7)^(G<<14|G>>>18)^G>>>3,_=d[C-2],H=(_<<15|_>>>17)^(_<<13|_>>>19)^_>>>10;d[C]=U+d[C-7]+H+d[C-16]}var Q=E&w^~E&x,j=m&y^m&g^y&g,$=(m<<30|m>>>2)^(m<<19|m>>>13)^(m<<10|m>>>22),B=(E<<26|E>>>6)^(E<<21|E>>>11)^(E<<7|E>>>25),M=I+B+Q+u[C]+d[C],v=$+j;I=x,x=w,w=E,E=b+M|0,b=g,g=y,y=m,m=M+v|0}p[0]=p[0]+m|0,p[1]=p[1]+y|0,p[2]=p[2]+g|0,p[3]=p[3]+b|0,p[4]=p[4]+E|0,p[5]=p[5]+w|0,p[6]=p[6]+x|0,p[7]=p[7]+I|0},_doFinalize:function(){var h=this._data,f=h.words,p=this._nDataBytes*8,m=h.sigBytes*8;return f[m>>>5]|=128<<24-m%32,f[(m+64>>>9<<4)+14]=i.floor(p/4294967296),f[(m+64>>>9<<4)+15]=p,h.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var h=o.clone.call(this);return h._hash=this._hash.clone(),h}});n.SHA256=o._createHelper(A),n.HmacSHA256=o._createHmacHelper(A)})(Math),r.SHA256})}),lfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),W4()):typeof define=="function"&&define.amd?define(["./core","./sha256"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.WordArray,a=i.algo,o=a.SHA256,l=a.SHA224=o.extend({_doReset:function(){this._hash=new s.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=o._doFinalize.call(this);return c.sigBytes-=4,c}});i.SHA224=o._createHelper(l),i.HmacSHA224=o._createHmacHelper(l)})(),r.SHA224})}),XY=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),JD()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.Hasher,a=i.x64,o=a.Word,l=a.WordArray,c=i.algo;function u(){return o.create.apply(o,arguments)}var d=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],A=[];(function(){for(var f=0;f<80;f++)A[f]=u()})();var h=c.SHA512=s.extend({_doReset:function(){this._hash=new l.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(f,p){for(var m=this._hash.words,y=m[0],g=m[1],b=m[2],E=m[3],w=m[4],x=m[5],I=m[6],C=m[7],G=y.high,U=y.low,_=g.high,H=g.low,Q=b.high,j=b.low,$=E.high,B=E.low,M=w.high,v=w.low,N=x.high,R=x.low,q=I.high,P=I.low,z=C.high,W=C.low,oe=G,Ae=U,me=_,ve=H,Le=Q,He=j,rt=$,qe=B,xt=M,Gt=v,ut=N,Pe=R,ft=q,ht=P,Qt=z,Yt=W,Ft=0;Ft<80;Ft++){var kt,sr,Pt=A[Ft];if(Ft<16)sr=Pt.high=f[p+Ft*2]|0,kt=Pt.low=f[p+Ft*2+1]|0;else{var _r=A[Ft-15],Lt=_r.high,ct=_r.low,Zt=(Lt>>>1|ct<<31)^(Lt>>>8|ct<<24)^Lt>>>7,Jt=(ct>>>1|Lt<<31)^(ct>>>8|Lt<<24)^(ct>>>7|Lt<<25),O=A[Ft-2],K=O.high,se=O.low,ae=(K>>>19|se<<13)^(K<<3|se>>>29)^K>>>6,ue=(se>>>19|K<<13)^(se<<3|K>>>29)^(se>>>6|K<<26),Ie=A[Ft-7],Ce=Ie.high,st=Ie.low,it=A[Ft-16],Kt=it.high,ar=it.low;kt=Jt+st,sr=Zt+Ce+(kt>>>0<Jt>>>0?1:0),kt=kt+ue,sr=sr+ae+(kt>>>0<ue>>>0?1:0),kt=kt+ar,sr=sr+Kt+(kt>>>0<ar>>>0?1:0),Pt.high=sr,Pt.low=kt}var lr=xt&ut^~xt&ft,yr=Gt&Pe^~Gt&ht,xi=oe&me^oe&Le^me&Le,Tr=Ae&ve^Ae&He^ve&He,ii=(oe>>>28|Ae<<4)^(oe<<30|Ae>>>2)^(oe<<25|Ae>>>7),nn=(Ae>>>28|oe<<4)^(Ae<<30|oe>>>2)^(Ae<<25|oe>>>7),sn=(xt>>>14|Gt<<18)^(xt>>>18|Gt<<14)^(xt<<23|Gt>>>9),Dn=(Gt>>>14|xt<<18)^(Gt>>>18|xt<<14)^(Gt<<23|xt>>>9),Za=d[Ft],ai=Za.high,xa=Za.low,Lr=Yt+Dn,mn=Qt+sn+(Lr>>>0<Yt>>>0?1:0),Lr=Lr+yr,mn=mn+lr+(Lr>>>0<yr>>>0?1:0),Lr=Lr+xa,mn=mn+ai+(Lr>>>0<xa>>>0?1:0),Lr=Lr+kt,mn=mn+sr+(Lr>>>0<kt>>>0?1:0),bs=nn+Tr,Zi=ii+xi+(bs>>>0<nn>>>0?1:0);Qt=ft,Yt=ht,ft=ut,ht=Pe,ut=xt,Pe=Gt,Gt=qe+Lr|0,xt=rt+mn+(Gt>>>0<qe>>>0?1:0)|0,rt=Le,qe=He,Le=me,He=ve,me=oe,ve=Ae,Ae=Lr+bs|0,oe=mn+Zi+(Ae>>>0<Lr>>>0?1:0)|0}U=y.low=U+Ae,y.high=G+oe+(U>>>0<Ae>>>0?1:0),H=g.low=H+ve,g.high=_+me+(H>>>0<ve>>>0?1:0),j=b.low=j+He,b.high=Q+Le+(j>>>0<He>>>0?1:0),B=E.low=B+qe,E.high=$+rt+(B>>>0<qe>>>0?1:0),v=w.low=v+Gt,w.high=M+xt+(v>>>0<Gt>>>0?1:0),R=x.low=R+Pe,x.high=N+ut+(R>>>0<Pe>>>0?1:0),P=I.low=P+ht,I.high=q+ft+(P>>>0<ht>>>0?1:0),W=C.low=W+Yt,C.high=z+Qt+(W>>>0<Yt>>>0?1:0)},_doFinalize:function(){var f=this._data,p=f.words,m=this._nDataBytes*8,y=f.sigBytes*8;p[y>>>5]|=128<<24-y%32,p[(y+128>>>10<<5)+30]=Math.floor(m/4294967296),p[(y+128>>>10<<5)+31]=m,f.sigBytes=p.length*4,this._process();var g=this._hash.toX32();return g},clone:function(){var f=s.clone.call(this);return f._hash=this._hash.clone(),f},blockSize:1024/32});i.SHA512=s._createHelper(h),i.HmacSHA512=s._createHmacHelper(h)})(),r.SHA512})}),cfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),JD(),XY()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./sha512"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.x64,s=n.Word,a=n.WordArray,o=i.algo,l=o.SHA512,c=o.SHA384=l.extend({_doReset:function(){this._hash=new a.init([new s.init(3418070365,3238371032),new s.init(1654270250,914150663),new s.init(2438529370,812702999),new s.init(355462360,4144912697),new s.init(1731405415,4290775857),new s.init(2394180231,1750603025),new s.init(3675008525,1694076839),new s.init(1203062813,3204075428)])},_doFinalize:function(){var u=l._doFinalize.call(this);return u.sigBytes-=16,u}});i.SHA384=l._createHelper(c),i.HmacSHA384=l._createHmacHelper(c)})(),r.SHA384})}),ufe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),JD()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],i):i(r.CryptoJS)})(t,function(r){return(function(i){var n=r,s=n.lib,a=s.WordArray,o=s.Hasher,l=n.x64,c=l.Word,u=n.algo,d=[],A=[],h=[];(function(){for(var m=1,y=0,g=0;g<24;g++){d[m+5*y]=(g+1)*(g+2)/2%64;var b=y%5,E=(2*m+3*y)%5;m=b,y=E}for(var m=0;m<5;m++)for(var y=0;y<5;y++)A[m+5*y]=y+(2*m+3*y)%5*5;for(var w=1,x=0;x<24;x++){for(var I=0,C=0,G=0;G<7;G++){if(w&1){var U=(1<<G)-1;U<32?C^=1<<U:I^=1<<U-32}w&128?w=w<<1^113:w<<=1}h[x]=c.create(I,C)}})();var f=[];(function(){for(var m=0;m<25;m++)f[m]=c.create()})();var p=u.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var m=this._state=[],y=0;y<25;y++)m[y]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(m,y){for(var g=this._state,b=this.blockSize/2,E=0;E<b;E++){var w=m[y+2*E],x=m[y+2*E+1];w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,x=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360;var I=g[E];I.high^=x,I.low^=w}for(var C=0;C<24;C++){for(var G=0;G<5;G++){for(var U=0,_=0,H=0;H<5;H++){var I=g[G+5*H];U^=I.high,_^=I.low}var Q=f[G];Q.high=U,Q.low=_}for(var G=0;G<5;G++)for(var j=f[(G+4)%5],$=f[(G+1)%5],B=$.high,M=$.low,U=j.high^(B<<1|M>>>31),_=j.low^(M<<1|B>>>31),H=0;H<5;H++){var I=g[G+5*H];I.high^=U,I.low^=_}for(var v=1;v<25;v++){var U,_,I=g[v],N=I.high,R=I.low,q=d[v];q<32?(U=N<<q|R>>>32-q,_=R<<q|N>>>32-q):(U=R<<q-32|N>>>64-q,_=N<<q-32|R>>>64-q);var P=f[A[v]];P.high=U,P.low=_}var z=f[0],W=g[0];z.high=W.high,z.low=W.low;for(var G=0;G<5;G++)for(var H=0;H<5;H++){var v=G+5*H,I=g[v],oe=f[v],Ae=f[(G+1)%5+5*H],me=f[(G+2)%5+5*H];I.high=oe.high^~Ae.high&me.high,I.low=oe.low^~Ae.low&me.low}var I=g[0],ve=h[C];I.high^=ve.high,I.low^=ve.low}},_doFinalize:function(){var m=this._data,y=m.words,g=this._nDataBytes*8,b=m.sigBytes*8,E=this.blockSize*32;y[b>>>5]|=1<<24-b%32,y[(i.ceil((b+1)/E)*E>>>5)-1]|=128,m.sigBytes=y.length*4,this._process();for(var w=this._state,x=this.cfg.outputLength/8,I=x/8,C=[],G=0;G<I;G++){var U=w[G],_=U.high,H=U.low;_=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,H=(H<<8|H>>>24)&16711935|(H<<24|H>>>8)&4278255360,C.push(H),C.push(_)}return new a.init(C,x)},clone:function(){for(var m=o.clone.call(this),y=m._state=this._state.slice(0),g=0;g<25;g++)y[g]=y[g].clone();return m}});n.SHA3=o._createHelper(p),n.HmacSHA3=o._createHmacHelper(p)})(Math),r.SHA3})}),hfe=qn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(As()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(i){var n=r,s=n.lib,a=s.WordArray,o=s.Hasher,l=n.algo,c=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),d=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),A=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),h=a.create([0,1518500249,1859775393,2400959708,2840853838]),f=a.create([1352829926,1548603684,1836072691,2053994217,0]),p=l.RIPEMD160=o.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(x,I){for(var C=0;C<16;C++){var G=I+C,U=x[G];x[G]=(U<<8|U>>>24)&16711935|(U<<24|U>>>8)&4278255360}var _=this._hash.words,H=h.words,Q=f.words,j=c.words,$=u.words,B=d.words,M=A.words,v,N,R,q,P,z,W,oe,Ae,me;z=v=_[0],W=N=_[1],oe=R=_[2],Ae=q=_[3],me=P=_[4];for(var ve,C=0;C<80;C+=1)ve=v+x[I+j[C]]|0,C<16?ve+=m(N,R,q)+H[0]:C<32?ve+=y(N,R,q)+H[1]:C<48?ve+=g(N,R,q)+H[2]:C<64?ve+=b(N,R,q)+H[3]:ve+=E(N,R,q)+H[4],ve=ve|0,ve=w(ve,B[C]),ve=ve+P|0,v=P,P=q,q=w(R,10),R=N,N=ve,ve=z+x[I+$[C]]|0,C<16?ve+=E(W,oe,Ae)+Q[0]:C<32?ve+=b(W,oe,Ae)+Q[1]:C<48?ve+=g(W,oe,Ae)+Q[2]:C<64?ve+=y(W,oe,Ae)+Q[3]:ve+=m(W,oe,Ae)+Q[4],ve=ve|0,ve=w(ve,M[C]),ve=ve+me|0,z=me,me=Ae,Ae=w(oe,10),oe=W,W=ve;ve=_[1]+R+Ae|0,_[1]=_[2]+q+me|0,_[2]=_[3]+P+z|0,_[3]=_[4]+v+W|0,_[4]=_[0]+N+oe|0,_[0]=ve},_doFinalize:function(){var x=this._data,I=x.words,C=this._nDataBytes*8,G=x.sigBytes*8;I[G>>>5]|=128<<24-G%32,I[(G+64>>>9<<4)+14]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,x.sigBytes=(I.length+1)*4,this._process();for(var U=this._hash,_=U.words,H=0;H<5;H++){var Q=_[H];_[H]=(Q<<8|Q>>>24)&16711935|(Q<<24|Q>>>8)&4278255360}return U},clone:function(){var x=o.clone.call(this);return x._hash=this._hash.clone(),x}});function m(x,I,C){return x^I^C}function y(x,I,C){return x&I|~x&C}function g(x,I,C){return(x|~I)^C}function b(x,I,C){return x&C|I&~C}function E(x,I,C){return x^(I|~C)}function w(x,I){return x<<I|x>>>32-I}n.RIPEMD160=o._createHelper(p),n.HmacRIPEMD160=o._createHmacHelper(p)})(Math),r.RIPEMD160})}),K4=qn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(As()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){(function(){var i=r,n=i.lib,s=n.Base,a=i.enc,o=a.Utf8,l=i.algo,c=l.HMAC=s.extend({init:function(u,d){u=this._hasher=new u.init,typeof d=="string"&&(d=o.parse(d));var A=u.blockSize,h=A*4;d.sigBytes>h&&(d=u.finalize(d)),d.clamp();for(var f=this._oKey=d.clone(),p=this._iKey=d.clone(),m=f.words,y=p.words,g=0;g<A;g++)m[g]^=1549556828,y[g]^=909522486;f.sigBytes=p.sigBytes=h,this.reset()},reset:function(){var u=this._hasher;u.reset(),u.update(this._iKey)},update:function(u){return this._hasher.update(u),this},finalize:function(u){var d=this._hasher,A=d.finalize(u);d.reset();var h=d.finalize(this._oKey.clone().concat(A));return h}})})()})}),dfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),W4(),K4()):typeof define=="function"&&define.amd?define(["./core","./sha256","./hmac"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.Base,a=n.WordArray,o=i.algo,l=o.SHA256,c=o.HMAC,u=o.PBKDF2=s.extend({cfg:s.extend({keySize:128/32,hasher:l,iterations:25e4}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,A){for(var h=this.cfg,f=c.create(h.hasher,d),p=a.create(),m=a.create([1]),y=p.words,g=m.words,b=h.keySize,E=h.iterations;y.length<b;){var w=f.update(A).finalize(m);f.reset();for(var x=w.words,I=x.length,C=w,G=1;G<E;G++){C=f.finalize(C),f.reset();for(var U=C.words,_=0;_<I;_++)x[_]^=U[_]}p.concat(w),g[0]++}return p.sigBytes=b*4,p}});i.PBKDF2=function(d,A,h){return u.create(h).compute(d,A)}})(),r.PBKDF2})}),H0=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),zY(),K4()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.Base,a=n.WordArray,o=i.algo,l=o.MD5,c=o.EvpKDF=s.extend({cfg:s.extend({keySize:128/32,hasher:l,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,d){for(var A,h=this.cfg,f=h.hasher.create(),p=a.create(),m=p.words,y=h.keySize,g=h.iterations;m.length<y;){A&&f.update(A),A=f.update(u).finalize(d),f.reset();for(var b=1;b<g;b++)A=f.finalize(A),f.reset();p.concat(A)}return p.sigBytes=y*4,p}});i.EvpKDF=function(u,d,A){return c.create(A).compute(u,d)}})(),r.EvpKDF})}),Dc=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),H0()):typeof define=="function"&&define.amd?define(["./core","./evpkdf"],i):i(r.CryptoJS)})(t,function(r){r.lib.Cipher||(function(i){var n=r,s=n.lib,a=s.Base,o=s.WordArray,l=s.BufferedBlockAlgorithm,c=n.enc,u=c.Utf8,d=c.Base64,A=n.algo,h=A.EvpKDF,f=s.Cipher=l.extend({cfg:a.extend(),createEncryptor:function(Q,j){return this.create(this._ENC_XFORM_MODE,Q,j)},createDecryptor:function(Q,j){return this.create(this._DEC_XFORM_MODE,Q,j)},init:function(Q,j,$){this.cfg=this.cfg.extend($),this._xformMode=Q,this._key=j,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(Q){return this._append(Q),this._process()},finalize:function(Q){Q&&this._append(Q);var j=this._doFinalize();return j},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function Q(j){return typeof j=="string"?H:G}return function(j){return{encrypt:function($,B,M){return Q(B).encrypt(j,$,B,M)},decrypt:function($,B,M){return Q(B).decrypt(j,$,B,M)}}}})()}),p=s.StreamCipher=f.extend({_doFinalize:function(){var Q=this._process(!0);return Q},blockSize:1}),m=n.mode={},y=s.BlockCipherMode=a.extend({createEncryptor:function(Q,j){return this.Encryptor.create(Q,j)},createDecryptor:function(Q,j){return this.Decryptor.create(Q,j)},init:function(Q,j){this._cipher=Q,this._iv=j}}),g=m.CBC=(function(){var Q=y.extend();Q.Encryptor=Q.extend({processBlock:function($,B){var M=this._cipher,v=M.blockSize;j.call(this,$,B,v),M.encryptBlock($,B),this._prevBlock=$.slice(B,B+v)}}),Q.Decryptor=Q.extend({processBlock:function($,B){var M=this._cipher,v=M.blockSize,N=$.slice(B,B+v);M.decryptBlock($,B),j.call(this,$,B,v),this._prevBlock=N}});function j($,B,M){var v,N=this._iv;N?(v=N,this._iv=i):v=this._prevBlock;for(var R=0;R<M;R++)$[B+R]^=v[R]}return Q})(),b=n.pad={},E=b.Pkcs7={pad:function(Q,j){for(var $=j*4,B=$-Q.sigBytes%$,M=B<<24|B<<16|B<<8|B,v=[],N=0;N<B;N+=4)v.push(M);var R=o.create(v,B);Q.concat(R)},unpad:function(Q){var j=Q.words[Q.sigBytes-1>>>2]&255;Q.sigBytes-=j}},w=s.BlockCipher=f.extend({cfg:f.cfg.extend({mode:g,padding:E}),reset:function(){var Q;f.reset.call(this);var j=this.cfg,$=j.iv,B=j.mode;this._xformMode==this._ENC_XFORM_MODE?Q=B.createEncryptor:(Q=B.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==Q?this._mode.init(this,$&&$.words):(this._mode=Q.call(B,this,$&&$.words),this._mode.__creator=Q)},_doProcessBlock:function(Q,j){this._mode.processBlock(Q,j)},_doFinalize:function(){var Q,j=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(j.pad(this._data,this.blockSize),Q=this._process(!0)):(Q=this._process(!0),j.unpad(Q)),Q},blockSize:128/32}),x=s.CipherParams=a.extend({init:function(Q){this.mixIn(Q)},toString:function(Q){return(Q||this.formatter).stringify(this)}}),I=n.format={},C=I.OpenSSL={stringify:function(Q){var j,$=Q.ciphertext,B=Q.salt;return B?j=o.create([1398893684,1701076831]).concat(B).concat($):j=$,j.toString(d)},parse:function(Q){var j,$=d.parse(Q),B=$.words;return B[0]==1398893684&&B[1]==1701076831&&(j=o.create(B.slice(2,4)),B.splice(0,4),$.sigBytes-=16),x.create({ciphertext:$,salt:j})}},G=s.SerializableCipher=a.extend({cfg:a.extend({format:C}),encrypt:function(Q,j,$,B){B=this.cfg.extend(B);var M=Q.createEncryptor($,B),v=M.finalize(j),N=M.cfg;return x.create({ciphertext:v,key:$,iv:N.iv,algorithm:Q,mode:N.mode,padding:N.padding,blockSize:Q.blockSize,formatter:B.format})},decrypt:function(Q,j,$,B){B=this.cfg.extend(B),j=this._parse(j,B.format);var M=Q.createDecryptor($,B).finalize(j.ciphertext);return M},_parse:function(Q,j){return typeof Q=="string"?j.parse(Q,this):Q}}),U=n.kdf={},_=U.OpenSSL={execute:function(Q,j,$,B,M){if(B||(B=o.random(64/8)),M)var v=h.create({keySize:j+$,hasher:M}).compute(Q,B);else var v=h.create({keySize:j+$}).compute(Q,B);var N=o.create(v.words.slice(j),$*4);return v.sigBytes=j*4,x.create({key:v,iv:N,salt:B})}},H=s.PasswordBasedCipher=G.extend({cfg:G.cfg.extend({kdf:_}),encrypt:function(Q,j,$,B){B=this.cfg.extend(B);var M=B.kdf.execute($,Q.keySize,Q.ivSize,B.salt,B.hasher);B.iv=M.iv;var v=G.encrypt.call(this,Q,j,M.key,B);return v.mixIn(M),v},decrypt:function(Q,j,$,B){B=this.cfg.extend(B),j=this._parse(j,B.format);var M=B.kdf.execute($,Q.keySize,Q.ivSize,j.salt,B.hasher);B.iv=M.iv;var v=G.decrypt.call(this,Q,j,M.key,B);return v}})})()})}),Afe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),Dc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.mode.CFB=(function(){var i=r.lib.BlockCipherMode.extend();i.Encryptor=i.extend({processBlock:function(s,a){var o=this._cipher,l=o.blockSize;n.call(this,s,a,l,o),this._prevBlock=s.slice(a,a+l)}}),i.Decryptor=i.extend({processBlock:function(s,a){var o=this._cipher,l=o.blockSize,c=s.slice(a,a+l);n.call(this,s,a,l,o),this._prevBlock=c}});function n(s,a,o,l){var c,u=this._iv;u?(c=u.slice(0),this._iv=void 0):c=this._prevBlock,l.encryptBlock(c,0);for(var d=0;d<o;d++)s[a+d]^=c[d]}return i})(),r.mode.CFB})}),ffe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),Dc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.mode.CTR=(function(){var i=r.lib.BlockCipherMode.extend(),n=i.Encryptor=i.extend({processBlock:function(s,a){var o=this._cipher,l=o.blockSize,c=this._iv,u=this._counter;c&&(u=this._counter=c.slice(0),this._iv=void 0);var d=u.slice(0);o.encryptBlock(d,0),u[l-1]=u[l-1]+1|0;for(var A=0;A<l;A++)s[a+A]^=d[A]}});return i.Decryptor=n,i})(),r.mode.CTR})}),pfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),Dc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.mode.CTRGladman=(function(){var i=r.lib.BlockCipherMode.extend();function n(o){if((o>>24&255)===255){var l=o>>16&255,c=o>>8&255,u=o&255;l===255?(l=0,c===255?(c=0,u===255?u=0:++u):++c):++l,o=0,o+=l<<16,o+=c<<8,o+=u}else o+=1<<24;return o}function s(o){return(o[0]=n(o[0]))===0&&(o[1]=n(o[1])),o}var a=i.Encryptor=i.extend({processBlock:function(o,l){var c=this._cipher,u=c.blockSize,d=this._iv,A=this._counter;d&&(A=this._counter=d.slice(0),this._iv=void 0),s(A);var h=A.slice(0);c.encryptBlock(h,0);for(var f=0;f<u;f++)o[l+f]^=h[f]}});return i.Decryptor=a,i})(),r.mode.CTRGladman})}),mfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),Dc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.mode.OFB=(function(){var i=r.lib.BlockCipherMode.extend(),n=i.Encryptor=i.extend({processBlock:function(s,a){var o=this._cipher,l=o.blockSize,c=this._iv,u=this._keystream;c&&(u=this._keystream=c.slice(0),this._iv=void 0),o.encryptBlock(u,0);for(var d=0;d<l;d++)s[a+d]^=u[d]}});return i.Decryptor=n,i})(),r.mode.OFB})}),gfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),Dc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.mode.ECB=(function(){var i=r.lib.BlockCipherMode.extend();return i.Encryptor=i.extend({processBlock:function(n,s){this._cipher.encryptBlock(n,s)}}),i.Decryptor=i.extend({processBlock:function(n,s){this._cipher.decryptBlock(n,s)}}),i})(),r.mode.ECB})}),yfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),Dc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.pad.AnsiX923={pad:function(i,n){var s=i.sigBytes,a=n*4,o=a-s%a,l=s+o-1;i.clamp(),i.words[l>>>2]|=o<<24-l%4*8,i.sigBytes+=o},unpad:function(i){var n=i.words[i.sigBytes-1>>>2]&255;i.sigBytes-=n}},r.pad.Ansix923})}),bfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),Dc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.pad.Iso10126={pad:function(i,n){var s=n*4,a=s-i.sigBytes%s;i.concat(r.lib.WordArray.random(a-1)).concat(r.lib.WordArray.create([a<<24],1))},unpad:function(i){var n=i.words[i.sigBytes-1>>>2]&255;i.sigBytes-=n}},r.pad.Iso10126})}),xfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),Dc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.pad.Iso97971={pad:function(i,n){i.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(i,n)},unpad:function(i){r.pad.ZeroPadding.unpad(i),i.sigBytes--}},r.pad.Iso97971})}),Efe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),Dc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.pad.ZeroPadding={pad:function(i,n){var s=n*4;i.clamp(),i.sigBytes+=s-(i.sigBytes%s||s)},unpad:function(i){for(var n=i.words,s=i.sigBytes-1,s=i.sigBytes-1;s>=0;s--)if(n[s>>>2]>>>24-s%4*8&255){i.sigBytes=s+1;break}}},r.pad.ZeroPadding})}),wfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),Dc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding})}),vfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),Dc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return(function(i){var n=r,s=n.lib,a=s.CipherParams,o=n.enc,l=o.Hex,c=n.format,u=c.Hex={stringify:function(d){return d.ciphertext.toString(l)},parse:function(d){var A=l.parse(d);return a.create({ciphertext:A})}}})(),r.format.Hex})}),Cfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),N1(),R1(),H0(),Dc()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.BlockCipher,a=i.algo,o=[],l=[],c=[],u=[],d=[],A=[],h=[],f=[],p=[],m=[];(function(){for(var b=[],E=0;E<256;E++)E<128?b[E]=E<<1:b[E]=E<<1^283;for(var w=0,x=0,E=0;E<256;E++){var I=x^x<<1^x<<2^x<<3^x<<4;I=I>>>8^I&255^99,o[w]=I,l[I]=w;var C=b[w],G=b[C],U=b[G],_=b[I]*257^I*16843008;c[w]=_<<24|_>>>8,u[w]=_<<16|_>>>16,d[w]=_<<8|_>>>24,A[w]=_;var _=U*16843009^G*65537^C*257^w*16843008;h[I]=_<<24|_>>>8,f[I]=_<<16|_>>>16,p[I]=_<<8|_>>>24,m[I]=_,w?(w=C^b[b[b[U^C]]],x^=b[b[x]]):w=x=1}})();var y=[0,1,2,4,8,16,32,64,128,27,54],g=a.AES=s.extend({_doReset:function(){var b;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var E=this._keyPriorReset=this._key,w=E.words,x=E.sigBytes/4,I=this._nRounds=x+6,C=(I+1)*4,G=this._keySchedule=[],U=0;U<C;U++)U<x?G[U]=w[U]:(b=G[U-1],U%x?x>6&&U%x==4&&(b=o[b>>>24]<<24|o[b>>>16&255]<<16|o[b>>>8&255]<<8|o[b&255]):(b=b<<8|b>>>24,b=o[b>>>24]<<24|o[b>>>16&255]<<16|o[b>>>8&255]<<8|o[b&255],b^=y[U/x|0]<<24),G[U]=G[U-x]^b);for(var _=this._invKeySchedule=[],H=0;H<C;H++){var U=C-H;if(H%4)var b=G[U];else var b=G[U-4];H<4||U<=4?_[H]=b:_[H]=h[o[b>>>24]]^f[o[b>>>16&255]]^p[o[b>>>8&255]]^m[o[b&255]]}}},encryptBlock:function(b,E){this._doCryptBlock(b,E,this._keySchedule,c,u,d,A,o)},decryptBlock:function(b,E){var w=b[E+1];b[E+1]=b[E+3],b[E+3]=w,this._doCryptBlock(b,E,this._invKeySchedule,h,f,p,m,l);var w=b[E+1];b[E+1]=b[E+3],b[E+3]=w},_doCryptBlock:function(b,E,w,x,I,C,G,U){for(var _=this._nRounds,H=b[E]^w[0],Q=b[E+1]^w[1],j=b[E+2]^w[2],$=b[E+3]^w[3],B=4,M=1;M<_;M++){var v=x[H>>>24]^I[Q>>>16&255]^C[j>>>8&255]^G[$&255]^w[B++],N=x[Q>>>24]^I[j>>>16&255]^C[$>>>8&255]^G[H&255]^w[B++],R=x[j>>>24]^I[$>>>16&255]^C[H>>>8&255]^G[Q&255]^w[B++],q=x[$>>>24]^I[H>>>16&255]^C[Q>>>8&255]^G[j&255]^w[B++];H=v,Q=N,j=R,$=q}var v=(U[H>>>24]<<24|U[Q>>>16&255]<<16|U[j>>>8&255]<<8|U[$&255])^w[B++],N=(U[Q>>>24]<<24|U[j>>>16&255]<<16|U[$>>>8&255]<<8|U[H&255])^w[B++],R=(U[j>>>24]<<24|U[$>>>16&255]<<16|U[H>>>8&255]<<8|U[Q&255])^w[B++],q=(U[$>>>24]<<24|U[H>>>16&255]<<16|U[Q>>>8&255]<<8|U[j&255])^w[B++];b[E]=v,b[E+1]=N,b[E+2]=R,b[E+3]=q},keySize:256/32});i.AES=s._createHelper(g)})(),r.AES})}),Sfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),N1(),R1(),H0(),Dc()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.WordArray,a=n.BlockCipher,o=i.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],d=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],A=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],h=o.DES=a.extend({_doReset:function(){for(var y=this._key,g=y.words,b=[],E=0;E<56;E++){var w=l[E]-1;b[E]=g[w>>>5]>>>31-w%32&1}for(var x=this._subKeys=[],I=0;I<16;I++){for(var C=x[I]=[],G=u[I],E=0;E<24;E++)C[E/6|0]|=b[(c[E]-1+G)%28]<<31-E%6,C[4+(E/6|0)]|=b[28+(c[E+24]-1+G)%28]<<31-E%6;C[0]=C[0]<<1|C[0]>>>31;for(var E=1;E<7;E++)C[E]=C[E]>>>(E-1)*4+3;C[7]=C[7]<<5|C[7]>>>27}for(var U=this._invSubKeys=[],E=0;E<16;E++)U[E]=x[15-E]},encryptBlock:function(y,g){this._doCryptBlock(y,g,this._subKeys)},decryptBlock:function(y,g){this._doCryptBlock(y,g,this._invSubKeys)},_doCryptBlock:function(y,g,b){this._lBlock=y[g],this._rBlock=y[g+1],f.call(this,4,252645135),f.call(this,16,65535),p.call(this,2,858993459),p.call(this,8,16711935),f.call(this,1,1431655765);for(var E=0;E<16;E++){for(var w=b[E],x=this._lBlock,I=this._rBlock,C=0,G=0;G<8;G++)C|=d[G][((I^w[G])&A[G])>>>0];this._lBlock=I,this._rBlock=x^C}var U=this._lBlock;this._lBlock=this._rBlock,this._rBlock=U,f.call(this,1,1431655765),p.call(this,8,16711935),p.call(this,2,858993459),f.call(this,16,65535),f.call(this,4,252645135),y[g]=this._lBlock,y[g+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function f(y,g){var b=(this._lBlock>>>y^this._rBlock)&g;this._rBlock^=b,this._lBlock^=b<<y}function p(y,g){var b=(this._rBlock>>>y^this._lBlock)&g;this._lBlock^=b,this._rBlock^=b<<y}i.DES=a._createHelper(h);var m=o.TripleDES=a.extend({_doReset:function(){var y=this._key,g=y.words;if(g.length!==2&&g.length!==4&&g.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var b=g.slice(0,2),E=g.length<4?g.slice(0,2):g.slice(2,4),w=g.length<6?g.slice(0,2):g.slice(4,6);this._des1=h.createEncryptor(s.create(b)),this._des2=h.createEncryptor(s.create(E)),this._des3=h.createEncryptor(s.create(w))},encryptBlock:function(y,g){this._des1.encryptBlock(y,g),this._des2.decryptBlock(y,g),this._des3.encryptBlock(y,g)},decryptBlock:function(y,g){this._des3.decryptBlock(y,g),this._des2.encryptBlock(y,g),this._des1.decryptBlock(y,g)},keySize:192/32,ivSize:64/32,blockSize:64/32});i.TripleDES=a._createHelper(m)})(),r.TripleDES})}),Tfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),N1(),R1(),H0(),Dc()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.StreamCipher,a=i.algo,o=a.RC4=s.extend({_doReset:function(){for(var u=this._key,d=u.words,A=u.sigBytes,h=this._S=[],f=0;f<256;f++)h[f]=f;for(var f=0,p=0;f<256;f++){var m=f%A,y=d[m>>>2]>>>24-m%4*8&255;p=(p+h[f]+y)%256;var g=h[f];h[f]=h[p],h[p]=g}this._i=this._j=0},_doProcessBlock:function(u,d){u[d]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var u=this._S,d=this._i,A=this._j,h=0,f=0;f<4;f++){d=(d+1)%256,A=(A+u[d])%256;var p=u[d];u[d]=u[A],u[A]=p,h|=u[(u[d]+u[A])%256]<<24-f*8}return this._i=d,this._j=A,h}i.RC4=s._createHelper(o);var c=a.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)l.call(this)}});i.RC4Drop=s._createHelper(c)})(),r.RC4})}),Ife=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),N1(),R1(),H0(),Dc()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.StreamCipher,a=i.algo,o=[],l=[],c=[],u=a.Rabbit=s.extend({_doReset:function(){for(var A=this._key.words,h=this.cfg.iv,f=0;f<4;f++)A[f]=(A[f]<<8|A[f]>>>24)&16711935|(A[f]<<24|A[f]>>>8)&4278255360;var p=this._X=[A[0],A[3]<<16|A[2]>>>16,A[1],A[0]<<16|A[3]>>>16,A[2],A[1]<<16|A[0]>>>16,A[3],A[2]<<16|A[1]>>>16],m=this._C=[A[2]<<16|A[2]>>>16,A[0]&4294901760|A[1]&65535,A[3]<<16|A[3]>>>16,A[1]&4294901760|A[2]&65535,A[0]<<16|A[0]>>>16,A[2]&4294901760|A[3]&65535,A[1]<<16|A[1]>>>16,A[3]&4294901760|A[0]&65535];this._b=0;for(var f=0;f<4;f++)d.call(this);for(var f=0;f<8;f++)m[f]^=p[f+4&7];if(h){var y=h.words,g=y[0],b=y[1],E=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,w=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,x=E>>>16|w&4294901760,I=w<<16|E&65535;m[0]^=E,m[1]^=x,m[2]^=w,m[3]^=I,m[4]^=E,m[5]^=x,m[6]^=w,m[7]^=I;for(var f=0;f<4;f++)d.call(this)}},_doProcessBlock:function(A,h){var f=this._X;d.call(this),o[0]=f[0]^f[5]>>>16^f[3]<<16,o[1]=f[2]^f[7]>>>16^f[5]<<16,o[2]=f[4]^f[1]>>>16^f[7]<<16,o[3]=f[6]^f[3]>>>16^f[1]<<16;for(var p=0;p<4;p++)o[p]=(o[p]<<8|o[p]>>>24)&16711935|(o[p]<<24|o[p]>>>8)&4278255360,A[h+p]^=o[p]},blockSize:128/32,ivSize:64/32});function d(){for(var A=this._X,h=this._C,f=0;f<8;f++)l[f]=h[f];h[0]=h[0]+1295307597+this._b|0,h[1]=h[1]+3545052371+(h[0]>>>0<l[0]>>>0?1:0)|0,h[2]=h[2]+886263092+(h[1]>>>0<l[1]>>>0?1:0)|0,h[3]=h[3]+1295307597+(h[2]>>>0<l[2]>>>0?1:0)|0,h[4]=h[4]+3545052371+(h[3]>>>0<l[3]>>>0?1:0)|0,h[5]=h[5]+886263092+(h[4]>>>0<l[4]>>>0?1:0)|0,h[6]=h[6]+1295307597+(h[5]>>>0<l[5]>>>0?1:0)|0,h[7]=h[7]+3545052371+(h[6]>>>0<l[6]>>>0?1:0)|0,this._b=h[7]>>>0<l[7]>>>0?1:0;for(var f=0;f<8;f++){var p=A[f]+h[f],m=p&65535,y=p>>>16,g=((m*m>>>17)+m*y>>>15)+y*y,b=((p&4294901760)*p|0)+((p&65535)*p|0);c[f]=g^b}A[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,A[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,A[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,A[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,A[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,A[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,A[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,A[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}i.Rabbit=s._createHelper(u)})(),r.Rabbit})}),Bfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),N1(),R1(),H0(),Dc()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.StreamCipher,a=i.algo,o=[],l=[],c=[],u=a.RabbitLegacy=s.extend({_doReset:function(){var A=this._key.words,h=this.cfg.iv,f=this._X=[A[0],A[3]<<16|A[2]>>>16,A[1],A[0]<<16|A[3]>>>16,A[2],A[1]<<16|A[0]>>>16,A[3],A[2]<<16|A[1]>>>16],p=this._C=[A[2]<<16|A[2]>>>16,A[0]&4294901760|A[1]&65535,A[3]<<16|A[3]>>>16,A[1]&4294901760|A[2]&65535,A[0]<<16|A[0]>>>16,A[2]&4294901760|A[3]&65535,A[1]<<16|A[1]>>>16,A[3]&4294901760|A[0]&65535];this._b=0;for(var m=0;m<4;m++)d.call(this);for(var m=0;m<8;m++)p[m]^=f[m+4&7];if(h){var y=h.words,g=y[0],b=y[1],E=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,w=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,x=E>>>16|w&4294901760,I=w<<16|E&65535;p[0]^=E,p[1]^=x,p[2]^=w,p[3]^=I,p[4]^=E,p[5]^=x,p[6]^=w,p[7]^=I;for(var m=0;m<4;m++)d.call(this)}},_doProcessBlock:function(A,h){var f=this._X;d.call(this),o[0]=f[0]^f[5]>>>16^f[3]<<16,o[1]=f[2]^f[7]>>>16^f[5]<<16,o[2]=f[4]^f[1]>>>16^f[7]<<16,o[3]=f[6]^f[3]>>>16^f[1]<<16;for(var p=0;p<4;p++)o[p]=(o[p]<<8|o[p]>>>24)&16711935|(o[p]<<24|o[p]>>>8)&4278255360,A[h+p]^=o[p]},blockSize:128/32,ivSize:64/32});function d(){for(var A=this._X,h=this._C,f=0;f<8;f++)l[f]=h[f];h[0]=h[0]+1295307597+this._b|0,h[1]=h[1]+3545052371+(h[0]>>>0<l[0]>>>0?1:0)|0,h[2]=h[2]+886263092+(h[1]>>>0<l[1]>>>0?1:0)|0,h[3]=h[3]+1295307597+(h[2]>>>0<l[2]>>>0?1:0)|0,h[4]=h[4]+3545052371+(h[3]>>>0<l[3]>>>0?1:0)|0,h[5]=h[5]+886263092+(h[4]>>>0<l[4]>>>0?1:0)|0,h[6]=h[6]+1295307597+(h[5]>>>0<l[5]>>>0?1:0)|0,h[7]=h[7]+3545052371+(h[6]>>>0<l[6]>>>0?1:0)|0,this._b=h[7]>>>0<l[7]>>>0?1:0;for(var f=0;f<8;f++){var p=A[f]+h[f],m=p&65535,y=p>>>16,g=((m*m>>>17)+m*y>>>15)+y*y,b=((p&4294901760)*p|0)+((p&65535)*p|0);c[f]=g^b}A[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,A[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,A[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,A[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,A[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,A[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,A[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,A[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}i.RabbitLegacy=s._createHelper(u)})(),r.RabbitLegacy})}),Dfe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),N1(),R1(),H0(),Dc()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.BlockCipher,a=i.algo;let o=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var u={pbox:[],sbox:[]};function d(m,y){let g=y>>24&255,b=y>>16&255,E=y>>8&255,w=y&255,x=m.sbox[0][g]+m.sbox[1][b];return x=x^m.sbox[2][E],x=x+m.sbox[3][w],x}function A(m,y,g){let b=y,E=g,w;for(let x=0;x<o;++x)b=b^m.pbox[x],E=d(m,b)^E,w=b,b=E,E=w;return w=b,b=E,E=w,E=E^m.pbox[o],b=b^m.pbox[o+1],{left:b,right:E}}function h(m,y,g){let b=y,E=g,w;for(let x=o+1;x>1;--x)b=b^m.pbox[x],E=d(m,b)^E,w=b,b=E,E=w;return w=b,b=E,E=w,E=E^m.pbox[1],b=b^m.pbox[0],{left:b,right:E}}function f(m,y,g){for(let I=0;I<4;I++){m.sbox[I]=[];for(let C=0;C<256;C++)m.sbox[I][C]=c[I][C]}let b=0;for(let I=0;I<o+2;I++)m.pbox[I]=l[I]^y[b],b++,b>=g&&(b=0);let E=0,w=0,x=0;for(let I=0;I<o+2;I+=2)x=A(m,E,w),E=x.left,w=x.right,m.pbox[I]=E,m.pbox[I+1]=w;for(let I=0;I<4;I++)for(let C=0;C<256;C+=2)x=A(m,E,w),E=x.left,w=x.right,m.sbox[I][C]=E,m.sbox[I][C+1]=w;return!0}var p=a.Blowfish=s.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var m=this._keyPriorReset=this._key,y=m.words,g=m.sigBytes/4;f(u,y,g)}},encryptBlock:function(m,y){var g=A(u,m[y],m[y+1]);m[y]=g.left,m[y+1]=g.right},decryptBlock:function(m,y){var g=h(u,m[y],m[y+1]);m[y]=g.left,m[y+1]=g.right},blockSize:64/32,keySize:128/32,ivSize:64/32});i.Blowfish=s._createHelper(p)})(),r.Blowfish})}),_fe=qn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(As(),JD(),sfe(),afe(),N1(),ofe(),R1(),zY(),W4(),lfe(),XY(),cfe(),ufe(),hfe(),K4(),dfe(),H0(),Dc(),Afe(),ffe(),pfe(),mfe(),gfe(),yfe(),bfe(),xfe(),Efe(),wfe(),vfe(),Cfe(),Sfe(),Tfe(),Ife(),Bfe(),Dfe()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./lib-typedarrays","./enc-utf16","./enc-base64","./enc-base64url","./md5","./sha1","./sha256","./sha224","./sha512","./sha384","./sha3","./ripemd160","./hmac","./pbkdf2","./evpkdf","./cipher-core","./mode-cfb","./mode-ctr","./mode-ctr-gladman","./mode-ofb","./mode-ecb","./pad-ansix923","./pad-iso10126","./pad-iso97971","./pad-zeropadding","./pad-nopadding","./format-hex","./aes","./tripledes","./rc4","./rabbit","./rabbit-legacy","./blowfish"],i):r.CryptoJS=i(r.CryptoJS)})(t,function(r){return r})}),Pfe=(t=>(t.Device="Device",t.Symbol="Symbol",t.Footprint="Footprint",t.OBJ="OBJ",t.ModelID="3D Model",t.ModelName="3D Model Title",t.OriginModelName="Origin 3D Model Title",t.ModelTransform="3D Model Transform",t.OriginFootprint="Origin Footprint",t))(Pfe||{}),tC=(t=>(t.DOCHEAD="DOCHEAD",t.EDIT_HEAD="EDIT_HEAD",t.SCH="SCH",t.SCH_PAGE="SCH_PAGE",t.PCB="PCB",t.PANEL="PANEL",t.PANEL_LIB="PANEL_LIB",t.SYMBOL="SYMBOL",t.FOOTPRINT="FOOTPRINT",t.DEVICE="DEVICE",t.BLOB="BLOB",t.INSTANCE="INSTANCE",t.CONFIG="CONFIG",t.BOARD="BOARD",t.FONT="FONT",t.VARIANT="VARIANT",t.COMPONENT_GROUP="COMPONENT_GROUP",t.COMPONENT_GROUP_DATA="COMPONENT_GROUP_DATA",t.SIMULATION="SIMULATION",t))(tC||{}),Lfe=(t=>(t.META="META",t.META_SORT="META_SORT",t.META_CREATE="META_CREATE",t.META_MODIFY="META_MODIFY",t.FONT="FONT",t.BLOB="BLOB",t.MAX_NUM="MAX_NUM",t.INSTANCE_ATTR="INSTANCE_ATTR",t.DELETE_DOC="DELETE_DOC",t.META_Z_INDEX="META_Z_INDEX",t.VARIANT_GROUPED="VARIANT_GROUPED",t.GROUP_INDEX="GROUP_INDEX",t.GROUP_DATA="GROUP_DATA",t.RULE_TEMPLATE="RULE_TEMPLATE",t.RULE="RULE",t.RULE_SELECTOR="RULE_SELECTOR",t.ELE_PLACEHOLDER="ELE_PLACEHOLDER",t.META_PLACEHOLDER="META_PLACEHOLDER",t))(Lfe||{}),Mf="||",No=`|
`;function rC(t,e,r){return t.slice(e,r)}function DD(t,e,r){let i=t.length,n=0;for(;n<i;){let s=t.indexOf(No,n);if(s<0){if(r)return t.substring(n);s=i}let a=rC(t,n,s);try{if(a){let o=a.indexOf(Mf),l=o>-1,c=l?rC(a,0,o):a,u=l?rC(a,o+Mf.length):"";if(e(c,u,a,l?n+o+Mf.length:n)===!1){a=null;break}a=null}}catch(o){console.error(o)}n=s+No.length}t=null}var Ofe=["SYMBOL","FOOTPRINT","BLOB","FONT","PANEL_LIB","DEVICE","BOARD","INSTANCE","CONFIG","VARIANT","COMPONENT_GROUP","COMPONENT_GROUP_DATA"];function WR(t,e){return Ofe.includes(e)?e:t}var Nfe=class{parseFull(t,e,r){let i=e,n=r,s,a=null;DD(t,(o,l,c)=>{let u=JSON.parse(o);if(u.type==="EDIT_HEAD")a=JSON.parse(l),this.onEditHead&&this.onEditHead(a);else if(u.type==="DOCHEAD"){let d=JSON.parse(l);n=d.docType,i=d.uuid,s=d.client,d.ticket=u.ticket,this.onDocHead(d,a,c)}else this.onLine(u.id,u.ticket,l,u.type,u.client||s,n,i,u.firstTicket,u.pend,a,u.num,c)}),this.onEnd(),t=null}flowParseFull(t={}){let{cache:e,chunkLength:r=100*1024*1024,idsData:i,history:n}=t,s="",a=null,o,l=null,c=!0,u="",d=0,A=!1,h={},f=e?{}:void 0,p=g=>{f[g]===void 0&&(f[g]=-1),e(g,++f[g],h[g].data.join(No)),h[g].data.length=0,h[g].size=0,h[g].data.push(h[g].head),h[g].size+=h[g].head.length},m=g=>{let b=WR(s,a);e&&(h[b].data.push(g),h[b].size+=(h[b].size?No.length:0)+g.length,h[b].size+g.length>r&&p(b))},y=(g,b)=>DD(g,(E,w,x,I)=>{var G,U,_,H,Q,j,$,B;let C=JSON.parse(E);if(C.type==="EDIT_HEAD")l=JSON.parse(w),(G=this.onEditHead)==null||G.call(this,l),(U=t.onEditHead)==null||U.call(t,l),A=!0;else if(C.type==="DOCHEAD"){let M=JSON.parse(w);a=M.docType,s=M.uuid,o=M.client,M.ticket=C.ticket,A||(l={uuid:M.uuid,username:(_=M==null?void 0:M.user)==null?void 0:_.username,nickname:(H=M==null?void 0:M.user)==null?void 0:H.nickname,updateTime:M==null?void 0:M.updateTime},(Q=t.onEditHead)==null||Q.call(t,l),A=!0),this.onDocHead(M,l,x);let v=WR(s,a);e&&!h[v]&&(h[v]={size:0,data:[],head:""}),e&&(h[v].head=x),m(x)}else{let M=C.num,v=C.client||o;if(i){let N=(B=($=(j=i.ids)==null?void 0:j[s])==null?void 0:$[v])==null?void 0:B[C.id];if(!N||N[0]!==C.ticket)return;M=N[1],i.size-=1,delete i.ids[s][v][C.id]}if(n){let N=WR(s,a);e&&(n.dNum=(f==null?void 0:f[N])===void 0?0:(f==null?void 0:f[N])+1),n.start=e?h[N].size+No.length+E.length+Mf.length:d+I}this.onLine(C.id,C.ticket,w,C.type,v,a,s,C.firstTicket,C.pend,l||(n==null?void 0:n.editHead),M,x,n),m(x)}},b);return{start:()=>{c=!0},end:()=>{if(u&&y(u,!1),e)for(let g in h)h[g].size&&h[g].data.length>1&&p(g),h[g]=null;c=!1,u="",s="",s=null,o="",l=null,this.onEnd()},update:g=>{if(!c)throw new Error("\u66F4\u65B0\u524D\u672A\u8C03\u7528 start \u65B9\u6CD5");let b=y(u+g,!0);d=d+u.length+g.length-((b==null?void 0:b.length)||0),u="",b&&(u=b)},docMap:f}}parseLine(t,e,r){let i=t.indexOf(Mf),n=i!==-1,s=n?rC(t,0,i):t,a=n?rC(t,i+Mf.length):"",o=JSON.parse(s);this.onLine(o.id,o.ticket,a,o.type,o.client,r,e,o.firstTicket,o.pend,void 0,o.num,t),t=null}onEditHead(t){}},KR=new Uint8Array(8);function Vu(){crypto.getRandomValues(KR);let t="";for(let e=0;e<KR.length;e++)t+=KR[e].toString(16).padStart(2,"0");return t}function T1(t,e,r,i,n,s,a){let o={docType:t,client:e,uuid:r};return(i||i===0)&&(o.updateTime=i),(n||o.updateTime||o.updateTime===0)&&(o.version=n||String(i)),s&&(o.user=s),`${JSON.stringify({type:"DOCHEAD",ticket:a})}${Mf}${JSON.stringify(o)}`}function Kh(t,e,r,i,n,s,a,o){let l={type:t,ticket:e,id:r};return s!==void 0&&(l.firstTicket=s),a!==void 0&&(l.pend=a),o!==void 0&&(l.num=o),n&&(l.client=n),`${JSON.stringify(l)}${Mf}${i}`}var qY=class extends Nfe{constructor(t){super(),this.unique=Vu(),this.maxTicket=0,this.isPendChange=!0,this.isLocalChange=!0,this.cbArr=[],this.tempLocalIds={},this.client=t||Vu()}onLine(t,e,r,i,n,s,a,o,l,c,u){this.remoteChange(e,n,a,t,r,i,s,void 0,o,l,c,void 0,void 0,u)}getUnique(){return this.unique}setUnique(t){this.unique=t}onDocHead(t,e){}onEnd(){}setIsPendChange(t){this.isPendChange=t}getIsPendChange(){return this.isPendChange}getMaxTicket(){return this.maxTicket}setMaxTicket(t,e){t&&(e||this.maxTicket<t)&&(this.maxTicket=t)}setIsLocalChange(t){this.isLocalChange=t}getIsLocalChange(){return this.isLocalChange}revoke(t,e,r,i,n,s,a,o,l,c,u){var d;if(!((d=this.tempLocalIds[t])!=null&&d[e]))return u?u(e,n,r,a,`${i}-1`,t,s,void 0,void 0,!0,c):this.cbArr.forEach(A=>A(t,e,r,a,`${i}-1`,n,void 0,s,void 0,void 0,void 0,c)),!0}getRandomUuid(){return Vu()}getClient(){return this.client}onChange(t){this.cbArr.push(t)}localChange(t,e,r,i,n,s){let a=this.maxTicket+1;return this.tempLocalIds[t]||(this.tempLocalIds[t]={}),this.tempLocalIds[t][e]=[this.getClient(),a],this.remoteChange(a,this.client,t,e,r,i,n,!0,void 0,!0,void 0,this.unique,void 0,s),a}remoteChange(t,e,r,i,n,s,a,o,l,c,u,d,A,h){var g;this.setMaxTicket(t);let f=d===this.unique,p=o||f,m=(!p||p&&this.isLocalChange)&&(!A||A&&this.isPendChange),y=(g=this.tempLocalIds[r])==null?void 0:g[i];!o&&f?y?(m=!1,y[0]===e&&y[1]===t&&delete this.tempLocalIds[r][i]):m=!0:!o&&y&&(y[1]>t||y[1]===t&&y[0]>e?m=!1:delete this.tempLocalIds[r][i]),m&&this.cbArr.forEach(b=>b(r,i,n,s,e,t,l,c,void 0,A,d,h))}};var J4=/^(?:ie|e)(\d+)$/;function sC(t){let e=t.match(J4);return e?Number(e[1]):null}function zn(t){if(!t||typeof t!="string")return t;let e=t.match(/(?:ie|e)\d+/g);return e&&e.length===2&&e.join("")===t?e.join("-"):t}function Sc(t){return t&&typeof t=="number"&&!isNaN(t)?-t:t}function Rfe(t,e){let r=[];for(let i=0;i<t.length;i+=2){let n={x:t[i],y:e?Sc(t[i+1]):t[i+1]};r.push(n)}return r}function Wh(t,e){return JSON.stringify([e,t])}function T0(t){try{let e=JSON.parse(t);return typeof e=="string"?t:e[1]}catch{return t}}var Mfe=(t=>(t.META="META",t.CANVAS="CANVAS",t.GROUP="GROUP",t.POLY="POLY",t.STRING="STRING",t.AUX_LINE="AUXLINE",t.DIMENSION="DIMENSION",t.ELE_PLACEHOLDER="ELE_PLACEHOLDER",t))(Mfe||{}),kfe=(t=>(t.META="META",t.CANVAS="CANVAS",t.LAYER="LAYER",t.LAYER_PHYS="LAYER_PHYS",t.ACTIVE_LAYER="ACTIVE_LAYER",t.PARTITION="PARTITION",t.NET="NET",t.PRIMITIVE="PRIMITIVE",t.GROUP="GROUP",t.SILK_OPTS="SILK_OPTS",t.PREFERENCE="PREFERENCE",t.VIA="VIA",t.PAD="PAD",t.LINE="LINE",t.ARC="ARC",t.OBJ="OBJ",t.EQLEN_GRP="EQLEN_GRP",t.POLY="POLY",t.FILL="FILL",t.LAYER_FILL="LAYER_FILL",t.REGION="REGION",t.POUR="POUR",t.POURED="POURED",t.IMAGE="IMAGE",t.TEARDROP="TEARDROP",t.FPC_FILL="FPC_FILL",t.SHELL="SHELL",t.CREASE="CREASE",t.SHELLCUT="SHELLCUT",t.SHELL_ENTITY="SHELL_ENTITY",t.BOSS="BOSS",t.STRING="STRING",t.ATTR="ATTR",t.DIMENSION="DIMENSION",t.COMPONENT="COMPONENT",t.PAD_NET="PAD_NET",t.RULE_TEMPLATE="RULE_TEMPLATE",t.RULE="RULE",t.RULE_SELECTOR="RULE_SELECTOR",t.PANELIZE="PANELIZE",t.BOARD="BOARD",t.ELE_PLACEHOLDER="ELE_PLACEHOLDER",t))(kfe||{}),Ffe=(t=>(t.META="META",t.CANVAS="CANVAS",t.GROUP="GROUP",t.ATTR="ATTR",t.LINE="LINE",t.WIRE="WIRE",t.BUS="BUS",t.TEXT="TEXT",t.POLY="POLY",t.CIRCLE="CIRCLE",t.ARC="ARC",t.BUSENTRY="BUSENTRY",t.RECT="RECT",t.MASK_REGION="MASK_REGION",t.PIN="PIN",t.OBJ="OBJ",t.COMPONENT="COMPONENT",t.PART="PART",t.ELLIPSE="ELLIPSE",t.BEZIER="BEZIER",t.TABLE="TABLE",t.ELE_PLACEHOLDER="ELE_PLACEHOLDER",t.NG_SETTING="NG_SETTING",t))(Ffe||{});var Ufe=["PARTITION","VIA","PAD","LINE","ARC","OBJ","POLY","FILL","REGION","POUR","POURED","IMAGE","TEARDROP","FPC_FILL","SHELL","CREASE","SHELLCUT","SHELL_ENTITY","BOSS","STRING","ATTR","DIMENSION","COMPONENT"];var Hfe=(t=>(t.SOLID="SOLID",t.SHORT_DASH="SHORT_DASH",t.DOT="DOT",t.DOT_DASH="DOT_DASH",t))(Hfe||{}),Gfe=(t=>(t.PRINT="PRINT",t.COVER="COVER",t.PRINT_AND_COVER="PRINT&COVER",t))(Gfe||{}),Yfe=(t=>(t.LEFT="LEFT",t.CENTER="CENTER",t.RIGHT="RIGHT",t))(Yfe||{}),Vfe=(t=>(t.TOP="TOP",t.MIDDLE="MIDDLE",t.BOTTOM="BOTTOM",t))(Vfe||{}),jfe=(t=>(t.LEFT_BOTTOM="LEFT_BOTTOM",t.CENTER_BOTTOM="CENTER_BOTTOM",t.RIGHT_BOTTOM="RIGHT_BOTTOM",t.LEFT_MIDDLE="LEFT_MIDDLE",t.CENTER_MIDDLE="CENTER_MIDDLE",t.RIGHT_MIDDLE="RIGHT_MIDDLE",t.LEFT_TOP="LEFT_TOP",t.CENTER_TOP="CENTER_TOP",t.RIGHT_TOP="RIGHT_TOP",t))(jfe||{}),Qfe=(t=>(t.NONE="NONE",t.SOLID="SOLID",t.GRID="GRID",t.HORIZONTAL_LINE="HORIZONTAL_LINE",t.VERTICAL_LINE="VERTICAL_LINE",t.RHOMBIC="RHOMBIC",t.LEFT_SLASH_LINE="LEFT_SLASH_LINE",t.RIGHT_SLASH_LINE="RIGHT_SLASH_LINE",t))(Qfe||{}),zfe=(t=>(t.NONE="NONE",t.CLOCK="CLOCK",t.INVERTED="INVERTED",t.INVERTED_CLOCK="INVERTED_CLOCK",t))(zfe||{}),Xfe=(t=>(t.NONE="NONE",t.GRID="GRID",t.OUTLETS="OUTLETS",t))(Xfe||{}),qfe=(t=>(t.NONE="NONE",t.PUSH="PUSH",t.SURROUND="SURROUND",t.OBSTRUCT="OBSTRUCT",t.SURROUND_AND_PUSH="SURROUND&PUSH",t))(qfe||{}),Wfe=(t=>(t.ELLIPSE="ELLIPSE",t.RECT="RECT",t.OVAL="OVAL",t.POLYGON="POLYGON",t))(Wfe||{}),Kfe=(t=>(t.ROUND="ROUND",t.RECT="RECT",t.SLOT="SLOT",t))(Kfe||{}),Jfe=(t=>(t.SOLID="SOLID",t.GRID_LINE="GRID_LINE",t.HORIZONTAL_LINE="HORIZONTAL_LINE",t.VERTICAL_LINE="VERTICAL_LINE",t))(Jfe||{}),$fe=(t=>(t.ALL="ALL",t.PAD="PAD",t.VIA="VIA",t))($fe||{}),Zfe=(t=>(t.NONE="NONE",t.SINGLE="SINGLE",t.ALL="ALL",t))(Zfe||{}),epe=(t=>(t.OPTIMIZA_OPEN="OPTIMIZA_OPEN",t.OPTIMIZA_NONE="OPTIMIZA_NONE",t))(epe||{}),tpe=(t=>(t.OPTIMIZA_STRONG="OPTIMIZA_STRONG",t.OPTIMIZA_WEAK="OPTIMIZA_WEAK",t.OPTIMIZA_NONE="OPTIMIZA_NONE",t))(tpe||{}),rpe=(t=>(t.L45="L45",t.L90="L90",t.L="L",t.R45="R45",t.R90="R90",t.R="R",t))(rpe||{}),ipe=(t=>(t.NORMAL="NORMAL",t.BLIND="BLIND",t.SUTURE="SUTURE",t))(ipe||{}),npe=(t=>(t.NORMAL="NORMAL",t.TEST="TEST",t.MARKER="MARKER",t))(npe||{}),spe=(t=>(t.DIVERGENCE="DIVERGENCE",t.DIRECT="DIRECT",t.NON_CONNECT="NON_CONNECT",t))(spe||{}),ape=(t=>(t.DOT="DOT",t.CENTER="CENT",t))(ape||{}),ope=(t=>(t.NORMAL="NORMAL",t.BOARD_OUTLINE="BOARD_OUTLINE",t))(ope||{}),lpe=(t=>(t.SOLID="SOLID",t.GRID="GRID",t.PLANE="PLANE",t))(lpe||{}),cpe=(t=>(t.PROHIBIT="PROHIBIT",t.CONSTRAINT="CONSTRAINT",t))(cpe||{}),upe=(t=>(t.COMPONENT="COMPONENT",t.VIA="VIA",t.TRACK="TRACK",t.FILL="FILL",t.COPPER="COPPER",t.PLANE="PLANE",t))(upe||{}),hpe=(t=>(t.PI="Polyimide",t.FR4="FR4",t.STEEL_SHEET="Stainless Steel",t.M3_DOUBLE_SIDED_TAPE="3M Tape",t.EMI_SHIELDING_FILM="EMI Shielding Film",t))(hpe||{}),dpe=(t=>(t.PUSH_COVER="DRAWER",t.UPPER_LOWER_SHELLS="T&B",t))(dpe||{}),Ape=(t=>(t.X_AXIS_POSITIVE="X_AXIS_POSITIVE",t.X_AXIS_NEGATIVE="X_AXIS_NEGATIVE",t.Y_AXIS_POSITIVE="Y_AXIS_POSITIVE",t.Y_AXIS_NEGATIVE="Y_AXIS_NEGATIVE",t))(Ape||{}),fpe=(t=>(t.SLOT="SLOT",t.ENTITY="ENTITY",t))(fpe||{}),ppe=(t=>(t.AUTO="AUTO",t.UPPER_SHELLS="UPPER_SHELLS",t.LOWER_SHELLS="LOWER_SHELLS",t))(ppe||{}),mpe=(t=>(t.OUTLINE="OUTLINE",t.SCREW_PILLAR="SCREW_PILLAR",t.ENTITY="ENTITY",t))(mpe||{}),gpe=(t=>(t.M2="M2",t.M3="M3",t.M4="M4",t.M5="M5",t.M6="M6",t))(gpe||{}),ype=(t=>(t.LENGTH="LENGTH",t.RADIUS="RADIUS",t.ANGLE="ANGLE",t))(ype||{}),bpe=(t=>(t.MIL="mil",t.INCH="inch",t.CM="cm",t.MM="mm",t))(bpe||{}),xpe=(t=>(t.SAFE="SAFE",t.OTHER="OTHER",t.TRACK="TRACK",t.BLIND="BLIND",t.RADIUS="RADIUS",t.PLANE="PLANE",t.COPPER="COPPER",t.PASTE="PASTE",t.SOLDER="SOLDER",t.DIFFER_ENTAIL="DIFFER_ENTAIL",t.NET_LENGTH="NET_LENGTH",t.AUTO_ROUTER="AUTO_ROUTER",t.NET_LENGTH_TOLERANCE="NET_LENGTH_TOLERANCE",t))(xpe||{}),Epe=(t=>(t.NORMAL="NORMAL",t.DEFAULT="DEFAULT",t))(Epe||{}),wpe=(t=>(t.ALL="ALL",t.LAYERED="LAYERED",t))(wpe||{}),vpe=(t=>(t.DIRECT="DIRECT",t.NON_CONNECT="NON_CONNECT",t))(vpe||{}),Cpe=(t=>(t.FORTY_FIVE="L45",t.NINETY="L90",t.NINETY_ARC="A90",t))(Cpe||{}),Spe=(t=>(t.LESS="LESS",t.MID="MID",t.MORE="MORE",t))(Spe||{}),Tpe=(t=>(t.SPEED_FIRST="SPEED_FIRST",t.COMPLETION_FIRST="COMPLETION_FIRST",t))(Tpe||{}),Ipe=(t=>(t.DesignRule="DesignRule",t.Board="Board",t.SlotRegion="SlotRegion",t.ProhibitedRegion="ProhibitedRegion",t.ConstraintRegion="ConstraintRegion",t.Component="Component",t.Track="Track",t.TestPoint="TestPoint",t.Pad="Pad",t.Via="Via",t.SutureHole="SutureHole",t.Text="Text",t.ColorfulImage="ColorfulImage",t.Image="Image",t.FPCStiffener="FPCStiffener",t.Dimension="Dimension",t.CopperRegion="CopperRegion",t.FillRegion="Fill Region",t.Line="Line",t.Teardrop="Teardrop",t.D3Shell="D3Shell",t))(Ipe||{}),Bpe=x2(_fe());function w4(t,e,r,i,n,s,a,o){return JSON.stringify([t||"",e||"",r,i,n?1:0,s?1:0,a?1:0,o])}function Dpe(t){let e=JSON.parse(t);return{text:e[0],fontFamily:e[1],fontSize:e[2],thickness:e[3],bold:!!e[4],italic:!!e[5],reverse:!!e[6],expansion:e[7]}}function $D(t){return Bpe.default.SHA256(t).toString()}function _pe(t,e){let r=[],i=[],n={};DD(t,(c,u)=>{let d=JSON.parse(c);if(d.type==="DOCHEAD"||d.type==="META"||d.type==="META_CREATE"||d.type==="META_MODIFY"||d.type==="ELE_PLACEHOLDER"||d.type==="ELE_PLACEHOLDER"||d.type==="ELE_PLACEHOLDER")return;let{id:A}=d;n[A]=Object.assign(d,{data:u})});let s={};DD(e,(c,u="")=>{let d=JSON.parse(c);if(d.type==="BLOB")r.push(c+Mf+u);else if(d.type==="FONT")i.push(c+Mf+u);else{if(d.type==="DOCHEAD"||d.type==="META_MODIFY")return;let{id:A}=d;s[A]=Object.assign(d,{data:u})}});let a={},o={},l={};for(let c in n)if(!s.hasOwnProperty(c))o[c]=n[c];else{let{ticket:u}=n[c],{type:d,data:A,client:h}=s[c];a[c]={type:d,ticket:u,data:A,client:h},delete s[c]}for(let c in s){let{type:u,data:d,ticket:A,client:h}=s[c];l[c]={type:u,data:d,ticket:A,client:h}}return{delete:o,cover:a,add:l,blobs:r,fonts:i}}function JR(t,e,r){let{docType:i,uuid:n,client:s,updateTime:a,version:o,user:l,ticket:c}=r,u=[T1(i,s,n,a,o,l,c)],{delete:d,cover:A,add:h,blobs:f,fonts:p}=_pe(t,e);for(let m in d){let{ticket:y,type:g,client:b}=d[m];u.push(Kh(g,y+1,m,"",b))}for(let m in A){let{type:y,ticket:g,data:b,client:E}=A[m];u.push(Kh(y,g+1,m,b,E))}for(let m in h){let{type:y,ticket:g,data:b,client:E}=h[m];u.push(Kh(y,g,m,b,E))}return f.length&&(u.push(T1("BLOB",s,"BLOB",a,o,l,c)),u=u.concat(f)),p.length&&(u.push(T1("FONT",s,"FONT",a,o,l,c)),u=u.concat(p)),u.join(No)}var m8e=x2(gC());var Ppe=class{constructor(t,e=1,r=[]){this.consistencyManager=t,this.startNum=e,this.needOrderType=r,this.initIng=!1,this.allOrderNum={},this.maxNum={},this.consistencyManager.onChange((i,n,s,a,o,l,c,u,d,A,h,f)=>{try{this.onParseLine(n,a,s?JSON.parse(s):null,o,l,u,f)}catch(p){console.error(p)}})}setIsInit(t){this.initIng=t}setNeedNum(t){this.needNum=t}setOrderNum(t,e,r){this.needNum&&this.needOrderType&&this.needOrderType.includes(r)&&e!==void 0&&(this.allOrderNum[t]=e,this.setMaxNum(r,e))}deleteOrderNum(t){delete this.allOrderNum[t]}getOrderNum(t){return this.allOrderNum[t]}setMaxNum(t,e,r){(r||this.maxNum[t]===void 0||this.maxNum[t]<e)&&(this.maxNum[t]=e)}getMaxNum(t){return this.maxNum[t]===void 0&&(this.maxNum[t]=this.startNum-1),++this.maxNum[t]}};function WY(t){switch(t=String(t),t){case"1":return"SAFE";case"2":return"OTHER";case"3":return"TRACK";case"4":return"BLIND";case"5":return"RADIUS";case"6":return"PLANE";case"7":return"COPPER";case"8":return"PASTE";case"9":return"SOLDER";case"10":return"DIFFER_ENTAIL";case"11":return"NET_LENGTH";case"12":return"AUTO_ROUTER";case"13":return"NET_LENGTH_TOLERANCE"}return t}function e2(t){if(!t)return{};let e=["1","2","3","4","5","6","7","8","9","10","11","12","13"];for(let r of e)if(t.hasOwnProperty(r)){let i=t[r];delete t[r],t[WY(r)]=i}return t}var Lpe=(t=>(t[t.TRACK=0]="TRACK",t[t.SMDPad=1]="SMDPad",t[t.THPad=2]="THPad",t[t.SMD_Test_Point=3]="SMD_Test_Point",t[t.TH_Test_Point=4]="TH_Test_Point",t[t.VIA=5]="VIA",t[t.REGION=6]="REGION",t[t.PLANE=7]="PLANE",t[t.SLOT=8]="SLOT",t[t.LINE=9]="LINE",t[t.OTHER=10]="OTHER",t[t.SHEETFRAME=11]="SHEETFRAME",t[t.Hole=12]="Hole",t[t.Copper=13]="Copper",t[t.Inner=14]="Inner",t[t.PROHIBITAREA=15]="PROHIBITAREA",t[t.COMPONENT=16]="COMPONENT",t))(Lpe||{}),FG=class{constructor(){this.init=!1,this.defaultSafeData=null,this.defaultCopperSpace=null,this.defaultInnerSpace=null,this.copperChangeMap=new Map,this.innerChangeMap=new Map}addDefaultSafeSpaceData(t){this.init=!0,this.defaultSafeData=t}addDefaultCopperSpace(t,e){this.defaultCopperSpace={netClearance:t,boardClearance:e}}addDefaultInnerSpace(t,e){this.defaultInnerSpace={netClearance:t,boardClearance:e}}getNewDefaultData(t,e){if(t&&this.defaultSafeData==null||!t&&this.defaultInnerSpace==null)return null;let r=t?this.copperChangeMap.get(e):this.innerChangeMap.get(e);if(r==null)return null;let{netClearance:i,boardClearance:n}=r,s=this.defaultSafeData.safeSpacing[0].content,a=new Array(s.length);for(let o=0;o<s.length;o++)a[o]=Array.from(s[o]);return this.updateSafeData(a,i,n),a}fixSafeData(t){if(this.defaultCopperSpace!=null)for(let e of t.safeSpacing)this.updateSafeData(e.content,this.defaultCopperSpace.netClearance,this.defaultCopperSpace.netClearance)}updateSafeData(t,e,r){for(let i=0;i<t.length;i++){let n=t[i];for(let s=0;s<n.length;s++)i==7?s==11||s==8?n[s]=r:n[s]=e:s==7&&(i==11||i==8?n[s]=r:n[s]=e)}}addCopper2SafeChangeMap(t,e,r,i,n){this.copperChangeMap.set(t,{name:e,isDefault:r,netClearance:i,boardClearance:n})}addInner2SafeChangeMap(t,e,r,i,n){this.innerChangeMap.set(t,{name:e,isDefault:r,netClearance:i,boardClearance:n})}getSafeName4Copper(t){var e;return(e=this.copperChangeMap.get(t))==null?void 0:e.name}getSafeName4Plane(t){var e;return(e=this.innerChangeMap.get(t))==null?void 0:e.name}getDefaultCopper(){for(let[,t]of this.copperChangeMap)if(t.isDefault)return t.name;return null}getDefaultPlane(){for(let[,t]of this.innerChangeMap)if(t.isDefault)return t.name;return null}};function UG(t,e){let r=t,i={TWO_LAYERS_BOARD:"JLCPCB Capability(Two Layers Board)",SINGLE_LAYER_BOARD:"JLCPCB Capability(Single Layer Board)",MULTIPLE_LAYERS_BOARD:"JLCPCB Capability(Multiple Layers Board)",HIGH_FREQUENCY_BOARD:"JLCPCB Capability(High Frequency Board)",ALUMINUM_SUBSTRATE_BOARD:"JLCPCB Capability(Aluminum Substrate Board)",COPPER_SUBSTRATE_BOARD:"JLCPCB Capability(Copper Substrate Board)"};if(r.length==8){Object.values(i).includes(e)&&(r[4][0]=11.811,r[5][4]=11.811),r.splice(1,0,r[1].slice(0));for(let s=2;s<r.length;s++)r[s].splice(1,0,r[s][1]);r.push([].concat(r[1][0],r.slice(1).map(s=>s[1])))}r[1].push(r[1][r[1].length-1]),r.splice(3,0,[...r[1]]),r.splice(4,0,[...r[2]]),r[1].pop();for(let s=5;s<r.length;s++)r[s].splice(3,0,r[s][1]),r[s].splice(4,0,r[s][2]);r[3][3]=r[1][1],r[4][3]=r[2][1],r[4][4]=r[2][2];let n=6;r.splice(7,0,new Array(7).fill(n));for(let s=7;s<r.length;s++)r[s].splice(7,0,n);return r}function Ope(t,e){let r=t[0],i=t[1],n=[],s="ALL";if(i instanceof Array){let a=UG(i,e);n.push({layerId:1,isOpen:!0,content:a})}else{for(let a in i){let o=i[a],l=UG(o,e);n.push({layerId:+a,isOpen:!0,content:l})}Object.keys(i).length>1&&(s="LAYERED")}return{unit:r,isForAll:s,safeSpacing:n}}function Npe(t){let e=t[0],r=t[1],i=t[2];isNaN(i)&&(i=0);let n=t[3];return isNaN(n)&&(n=11.8),{unit:e,deviceClearance:r,thru2SmdClearance:i,holeClearance:n}}function Rpe(t){let e=t[0],r=t[1],i=!0,n=[];if(r instanceof Object)for(let s in r){let a=r[s];n.push({layerId:+s,stroMin:a[0],stroDef:a[1],stroMax:a[2]})}else n.push({layerId:1,stroMin:t[1],stroDef:t[2],stroMax:t[3]});return{unit:e,track:{isOpen:i,content:n}}}function Mpe(t){return{unit:t[0],netLenMin:t[1],netLenMax:t[2]}}function kpe(t){return{unit:t[0],netLengthTolerance:t[1]}}function Fpe(t){let e=t[0],r=t[1],i=!0,n=[],s=[],a=0;if(r instanceof Object)for(let o in r){let l=r[o],{stroke:c,spacing:u,lenTolerMax:d}=l;n.push({layerId:+o,stroMin:c[0],stroDef:c[1],stroMax:c[2]}),s.push({layerId:+o,spacMin:u[0],spacDef:u[1]}),a=d}else n.push({layerId:1,stroMin:t[1],stroDef:t[2],stroMax:t[3]}),s.push({layerId:1,spacMin:t[4],spacDef:t[5]}),a=t[7];return{unit:e,stroWidth:{isOpen:i,content:n},spacing:{isOpen:i,content:s},differPairLenTolerMax:a}}function Upe(t){let e=new Array;for(let r of t){let i=+r[1],n=+r[2];isNaN(i)||i<=0||isNaN(n)||n<=0||i===n||i===1&&n===2||i===2&&n===1||e.push({name:r[0],staLayerId:i,endLayerId:n,viaSizeRule:r[3]})}return{blinds:{content:e}}}function Hpe(t){return{unit:t[0],minRadius:t[1],defRadius:t[2],maxRadius:t[3],minInner:t[4],defInner:t[5],maxInner:t[6]}}function Gpe(t){let e=[{layerId:1,connType:h2(t[7]!==void 0?t[7]:t[3]),spoWidth:t[8]!==void 0?t[8]:t[4],spoSpac:t[9]!==void 0?t[9]:t[5],spoAng:t[10]?t[10]:t[6]}];return{unit:t[0],mulPad:{isOpen:!0,content:e}}}function Ype(t){let e=[{layerId:1,connType:h2(t[3]),spoWidth:t[4],spoSpac:t[5],spoAng:t[6]}],r=[{layerId:1,connType:Number(t[7])?"NON_CONNECT":"DIRECT"}],i=[{layerId:1,connType:h2(t[8]!==void 0?t[8]:t[3]),spoWidth:t[9]!==void 0?t[9]:t[4],spoSpac:t[10]!==void 0?t[10]:t[5],spoAng:t[11]?t[11]:t[6]}];return{unit:t[0],sglPad:{isOpen:!0,content:e},mulPad:{isOpen:!0,content:i},track:{isOpen:!0,content:r}}}function Vpe(t){return{unit:t[0],padTopExpan:t[1],padBotExpan:t[2],testPointTopExpan:t[3]?t[3]:-1e3,testPointBotExpan:t[4]?t[4]:-1e3}}function jpe(t){return{unit:t[0],padTopExpan:t[1],padBotExpan:t[2],viaTopExpan:t[3],viaBotExpan:t[4],testPointTopExpan:t[5]?t[5]:2,testPointBotExpan:t[6]?t[6]:2}}function Qpe(t){function e(n){switch(n=n&&Number(n),n){case 0:return"L45";case 1:return"L90";case 2:return"A90";default:return"L45"}}function r(n){switch(n=n&&Number(n),n){case 0:return"LESS";case 1:return"MID";case 2:return"MORE";default:return"LESS"}}function i(n){switch(n=n&&Number(n),n){case 0:return"SPEED_FIRST";case 1:return"COMPLETION_FIRST";default:return"COMPLETION_FIRST"}}return{routingCorner:e(t[0]),isKeep:!!t[1],viaQuantity:r(t[2]),routingEffectPriority:i(t[3]),layers:t[5],ignoreNets:t[6]}}function h2(t){switch(t=t&&Number(t),t){case 0:return"DIVERGENCE";case 1:return"DIRECT";case 2:return"NON_CONNECT";default:return null}}function zpe(t,e){let r=e;switch(t){case"SAFE":{let i=e;if(i.isForAll=i.isForAll?"LAYERED":"ALL",i.safeSpacing)for(let n of i.safeSpacing)n.isOpen=!!n.isOpen;r=i;break}case"OTHER":break;case"TRACK":{let i=e;i!=null&&i.track&&(i.track.isOpen=!!i.track.isOpen),r=i;break}case"NET_LENGTH":break;case"NET_LENGTH_TOLERANCE":break;case"DIFFER_ENTAIL":{let i=e;i!=null&&i.stroWidth&&(i.stroWidth.isOpen=!!i.stroWidth.isOpen),i!=null&&i.spacing&&(i.spacing.isOpen=!!i.spacing.isOpen),r=i;break}case"BLIND":break;case"RADIUS":break;case"PLANE":{let i=e;if(i!=null&&i.mulPad&&(i.mulPad.isOpen=!!i.mulPad.isOpen),i.mulPad&&i.mulPad.content)for(let n of i.mulPad.content)n.connType=h2(n.connType);r=i;break}case"COPPER":{let i=e;if(i!=null&&i.sglPad&&(i.sglPad.isOpen=!!i.sglPad.isOpen),i!=null&&i.mulPad&&(i.mulPad.isOpen=!!i.mulPad.isOpen),i!=null&&i.track&&(i.track.isOpen=!!i.track.isOpen),i.track&&i.track.content&&(i.track.content=i.track.content.map(n=>(n.connType=Number(n.connType)?"NON_CONNECT":"DIRECT",n))),i.sglPad&&i.sglPad.content)for(let n of i.sglPad.content)n.connType=h2(n.connType);if(i.mulPad&&i.mulPad.content)for(let n of i.mulPad.content)n.connType=h2(n.connType);r=i;break}case"PASTE":break;case"SOLDER":break;case"AUTO_ROUTER":break}return r}function Xpe(t,e,r,i,n,s){if(!(i instanceof Array))return zpe(t,i);let a,o=!1;switch(r&&(r==="NORMAL"?o=!1:r==="DEFAULT"&&(o=!0)),t){case"SAFE":{a=Ope(i,s),o&&n.addDefaultSafeSpaceData(a);break}case"OTHER":{a=Npe(i);break}case"TRACK":{a=Rpe(i);break}case"NET_LENGTH":{a=Mpe(i);break}case"NET_LENGTH_TOLERANCE":{a=kpe(i);break}case"DIFFER_ENTAIL":{a=Fpe(i);break}case"BLIND":{a=Upe(i);break}case"RADIUS":{a=Hpe(i);break}case"PLANE":{let l=i[1],c=i[2];o&&n.addDefaultInnerSpace(l,c),n.addInner2SafeChangeMap(e,"Plane_"+e,o,l,c),a=Gpe(i);break}case"COPPER":{let l=i[1],c=i[2];o&&n.addDefaultCopperSpace(l,c),n.addCopper2SafeChangeMap(e,"Copper_"+e,o,l,c),a=Ype(i);break}case"PASTE":{a=Vpe(i);break}case"SOLDER":{a=jpe(i);break}case"AUTO_ROUTER":{a=Qpe(i);break}}return a}function qpe(t,e,r,i){if(!i.init)return null;function n(s,a){let o=s?"Copper_":"Plane_",l=["RULE"];l[1]="SAFE",l[2]=o+e,l[3]=0;let c=a.getNewDefaultData(s,e);return c==null?null:(l[4]={unit:a.defaultSafeData.unit,isForAll:"ALL",safeSpacing:[{layerId:1,isOpen:!0,content:c}]},l)}switch(t){case"SAFE":return i.fixSafeData(r),null;case"PLANE":return n(!1,i);case"COPPER":return n(!0,i);default:return null}}function Wpe(t,e,r,i){if(!i.init)return{ruleKeyValue:r};let n=t[0],s,a;if(e==4){if(n==="NET_CLASS"||n==="NET"){for(let o in r)String(o)==="COPPER"&&(s={COPPER:i.getSafeName4Copper(r[o])}),String(o)==="PLANE"&&(a={PLANE:i.getSafeName4Plane(r[o])});t[1]==""?(s!=null&&s.COPPER||(s={COPPER:"default"}),a!=null&&a.PLANE||(a={PLANE:"default"})):(s!=null&&s.COPPER||(s={COPPER:i.getDefaultCopper()}),a!=null&&a.PLANE||(a={PLANE:i.getDefaultPlane()}))}}else for(let o in r){if(String(o)==="COPPER"){let l=r[o],c=i.getSafeName4Copper(l);if(c==null&&l=="default"&&(c=i.getDefaultCopper()),c==null)continue;s={COPPER:c}}if(String(o)==="PLANE"){let l=r[o],c=i.getSafeName4Plane(l);if(c==null&&l=="default"&&(c=i.getDefaultPlane()),c==null)continue;a={PLANE:c}}}return{ruleKeyValue:r,copperRuleValue:s,innerPlaneRuleValue:a}}function KY(t,e){let r=t.length,i=0;for(;i<r;){let n=t.indexOf(`
`,i);n<0&&(n=r);let s=t.substring(i,n);try{if(e(s)===!1)break}catch(a){console.error(a)}i=n+1}}function Kpe(t){let e={};return KY(t,r=>{if(r.startsWith('["PAD"')){let i=JSON.parse(r);e[i[5]]||(e[i[5]]=[]),e[i[5]].push(i[1])}}),e}var $4=class{parseFull(t){KY(t,e=>this.onParseLine(JSON.parse(e))),this.onParseEnd()}},Jpe=(t=>(t[t.pro1=1]="pro1",t[t.pro2=1.1]="pro2",t[t.pro3=1.2]="pro3",t[t.pro4=1.3]="pro4",t[t.pro5=1.4]="pro5",t[t.pro6=1.5]="pro6",t[t.pro7=1.6]="pro7",t[t.pro8=1.7]="pro8",t[t.pro9=1.8]="pro9",t[t.pro=1.8]="pro",t))(Jpe||{}),$pe=class extends $4{constructor(t={},e={},r=[],i=[],n=!1){super(),this.deviceName=t,this.footprintName=e,this.footprints=r,this.devices=i,this.footprintIsConnectDevice=n,this.fontCache=[],this.poured={},this.curPartition="",this.eQLenData={},this.eQLenSort=1,this.cache={},this.components={},this.errorIds={},this.dimension={},this.connects={},this.specialColors={},this.reuseBlock={},this.panelize={data:[],stamp:{h:null,v:null},size:{h:null,v:null}},this.layerPhys=0,this.fac=new FG,this.rules=[],this.ruleSelectors=[],this.ruleTemplateName="",this.layerFill={},this.idsSet=new Set,this.oldId={},this.cachePadNet={},this.creaseIds=[],this.stringId={},this.padNumId={},this.componentPadNum={}}getOldId(t){var e;return(e=this.oldId[t])!=null?e:t}handConnect(){for(let t of this.creaseIds)if(this.connects[t])for(let e of this.connects[t])this.connects[e]?this.connects[e].push(t):this.connects[e]=[t]}getConnect(t){return this.connects[t]||[]}transRuleType(t){return WY(t)}transRuleStatus(t){switch(t=t&&Number(t),t){case 0:return"NORMAL";case 1:return"DEFAULT";default:return"NORMAL"}}transGridType(t){switch(t=t&&Number(t),t){case 0:return"NONE";case 1:return"GRID";case 2:return"OUTLETS";default:return"NONE"}}transLayerStatus(t){t=t&&Number(t);let e=!1,r=!1,i=!1;return t!=null&&!isNaN(t)?(t>=4&&(i=!0,t-=4),t>=2&&(r=!0,t-=2),t===1&&(e=!0)):e=!0,{use:e,show:r,locked:i}}transRoutingMode(t){switch(t=t&&Number(t),t){case 0:return"NONE";case 1:return"PUSH";case 2:return"SURROUND";case 3:return"OBSTRUCT";case 4:return"SURROUND&PUSH";default:return"NONE"}}transPadDef(t){switch(t==null?void 0:t[0]){case"ELLIPSE":return{padType:"ELLIPSE",width:t[1],height:t[2]};case"RECT":return{padType:"RECT",width:t[1],height:t[2],radius:t[3]};case"OVAL":return{padType:"OVAL",width:t[1],height:t[2]};case"POLYGON":case"POLY":return{padType:"POLYGON",path:t[1]};default:return null}}transHoleDef(t){return t?{holeType:t[0],width:t[1],height:t[2]}:null}transPourDef(t){function e(r){switch(r=r&&Number(r),r){case 0:return"GRID_LINE";case 1:return"HORIZONTAL_LINE";case 2:return"VERTICAL_LINE";default:return"GRID_LINE"}}switch(t==null?void 0:t[0]){case"SOLID":return{pourType:"SOLID",fineness:t[1]};case"LINE":return{pourType:e(t[1]),angle:t[2],strokeWidth:t[3],strokeSpacing:t[4]};default:return null}}transUnusedPadRange(t){switch(t=t&&Number(t),t){case 1:return"ALL";case 2:return"PAD";case 3:return"VIA";default:return"VIA"}}transPathOptimization(t){switch(t=t&&Number(t),t){case 0:return"SINGLE";case 1:return"ALL";case 2:return"NONE";default:return"SINGLE"}}transViaType(t){switch(t=t&&Number(t),t){case 0:return"NORMAL";case 1:return"SUTURE";default:return"NORMAL"}}transPadFuncType(t){switch(t=t&&Number(t),t){case 0:return"NORMAL";case 1:return"TEST";case 2:return"MARKER";default:return"NORMAL"}}transPadConnect(t){switch(t=t&&Number(t),t){case 0:return"DIVERGENCE";case 1:return"DIRECT";case 2:return"NON_CONNECT";default:return null}}transFillStyle(t){switch(t=t&&Number(t),t){case 0:return"SOLID";case 1:return"GRID";case 2:return"PLANE";default:return null}}transProhibitType(t){let e=new Set;if(!t)return[];for(let r of t)switch(r=r&&Number(r),r){case 1:e.add("TRACK"),e.add("FILL");break;case 2:e.add("COMPONENT");break;case 3:e.add("VIA");break;case 4:e.add("COPPER"),e.add("PLANE");break;case 5:e.add("TRACK");break;case 6:e.add("FILL");break;case 7:e.add("COPPER");break;case 8:e.add("PLANE");break}return Array.from(e)}transPushCoverDir(t){switch(t=t&&Number(t),t){case 1:return"X_AXIS_POSITIVE";case 2:return"X_AXIS_NEGATIVE";case 4:return"Y_AXIS_POSITIVE";case 8:return"Y_AXIS_NEGATIVE";default:return"X_AXIS_POSITIVE"}}transEntityBelong(t){switch(t=t&&Number(t),t){case 0:return"AUTO";case 1:return"UPPER_SHELLS";case 2:return"LOWER_SHELLS";default:return"AUTO"}}transSlotOption(t){t=t&&Number(t);let e=t;if(!e||e<4)return["OUTLINE","SCREW_PILLAR","ENTITY"];let r=[];return e>=16&&(r.push("ENTITY"),e-=16),e>=8&&(r.push("SCREW_PILLAR"),e-=8),e>=4&&(r.push("OUTLINE"),e-=4),r}transAlignType(t){switch(t=t&&Number(t),t){case 1:return"LEFT_TOP";case 4:return"CENTER_TOP";case 7:return"RIGHT_TOP";case 2:return"LEFT_MIDDLE";case 5:return"CENTER_MIDDLE";case 8:return"RIGHT_MIDDLE";case 3:return"LEFT_BOTTOM";case 6:return"CENTER_BOTTOM";case 9:return"RIGHT_BOTTOM";default:return"LEFT_BOTTOM"}}onParseLine(t){var r;let e=t[0];switch(e){case"DOCTYPE":this.parseDocType(t);break;case"HEAD":this.parseHead(t);break;case"CANVAS":this.parseCanvas(t);break;case"LAYER":this.parseLayer(t);break;case"LAYER_PHYS":this.parseLayerPhys(t);break;case"ACTIVE_LAYER":this.parseActiveLayer(t);break;case"NET":this.parseNet(t);break;case"PRIMITIVE":this.parsePrimitive(t);break;case"GROUP":this.parseGroup(t);break;case"SILK_OPTS":this.parseSilkOpts(t);break;case"PREFERENCE":this.parsePreference(t);break;case"CONNECT":this.parseConnect(t);break;case"ITEM_ORDER":this.parseItemOrder(t);break;case"PROP":this.parseProp(t);break;case"EQLEN_GRP":this.parseEQLenGrp(t);break;case"EQLEN":this.parseEQLen(t);break;case"FONT":this.parseFont(t);break;case"PAD_NET":{this.cachePadNet[t[1]]||(this.cachePadNet[t[1]]=[]),this.cachePadNet[t[1]].push(t);break}case"REUSE_BLOCK":this.parseReuseBlock(t);break;case"RULE_TEMPLATE":this.parseRuleTemplate(t);break;case"RULE":this.rules.push(t);break;case"RULE_SELECTOR":this.ruleSelectors.push(t);break;case"PANELIZE":this.panelize.data=t;break;case"PANELIZE_STAMP":this.parsePanelizeStamp(t);break;case"PANELIZE_SIDE":this.parsePanelizeSide(t);break;case"POURED":{this.parsePoured(t);break}case"PARTITION":e==="PARTITION"&&(this.curPartition=t[3]?t[1]:"");case"VIA":case"PAD":case"LINE":case"ARC":case"CARC":case"OBJ":case"POLY":case"FILL":if(e==="FILL"&&t[6]===2){this.layerFill[t[4]]||(this.layerFill[t[4]]=[]),this.layerFill[t[4]].push(t);break}case"REGION":case"POUR":case"IMAGE":case"TEARDROP":case"FPC_FILL":case"SHELL":case"CREASE":e==="CREASE"&&this.creaseIds.push(t[1]);case"SHELLCUT":case"SHELL_ENTITY":case"BOSS":case"STRING":if(e==="STRING"&&!/^[a-zA-Z]+\d+$/.test(t[1])){let i=t[1],n=i.split(/([0-9].*)/);if(n.length>=2){let s=n[0],a=n[1];for(let o=0;o<a.length;o++){let l=a.charCodeAt(o);s+=l}i=s}this.stringId[i]=t[1],t[1]=i}case"DIMENSION":case"COMPONENT":{let i=e==="CARC"?"ARC":e,n=sC(t[1]);this.cache[i]||(this.cache[i]={}),n!==null&&!this.cache[i][n]?this.cache[i][n]={part:this.curPartition,value:t}:(this.errorIds[i]||(this.errorIds[i]=[]),this.errorIds[i].push({part:this.curPartition,value:t})),i==="COMPONENT"&&(this.components[t[1]]||(this.components[t[1]]={attrs:{},footprint:"",device:""}),this.components[t[1]].attrs=t[7]||{}),i==="DIMENSION"&&(this.dimension[t[1]]={attr:[]});break}case"ATTR":{if(this.docType==="PCB"&&!t[3])break;if(t[7]==="Footprint"&&(this.components[t[3]]||(this.components[t[3]]={attrs:{},footprint:"",device:""}),this.components[t[3]].footprint=t[8]),t[7]==="Device"&&(this.components[t[3]]||(this.components[t[3]]={attrs:{},footprint:"",device:""}),this.components[t[3]].device=t[8]),this.dimension[t[1]]){this.dimension[t[1]].attr=t;break}let i=Object.keys(((r=this.cache)==null?void 0:r.COMPONENT)||{}).find(s=>this.cache.COMPONENT[s].value[1]===t[3]);if(i){let s=this.cache.COMPONENT[i];s.attr||(s.attr=[]),s.attr.push({part:this.curPartition,value:t});break}let n=sC(t[1]);this.cache[e]||(this.cache[e]={}),n!==null&&!this.cache[e][n]?this.cache[e][n]={part:this.curPartition,value:t}:(this.errorIds[e]||(this.errorIds[e]=[]),this.errorIds[e].push({part:this.curPartition,value:t}));break}default:console.warn("can not find hanlder with",t)}}async secondParseLine(t,e,r){let i=t[0];if(this.idsSet.has(t[1])||!t[1]){let n=Vu();if(this.oldId[n]=t[1],t[1]=n,r)for(let s of r)s[3]=n}else this.idsSet.add(t[1]);switch(i){case"DOCTYPE":case"HEAD":case"CANVAS":case"LAYER":case"LAYER_PHYS":case"ACTIVE_LAYER":case"NET":case"PRIMITIVE":case"GROUP":case"SILK_OPTS":case"PREFERENCE":case"ITEM_ORDER":case"RULE_TEMPLATE":case"RULE":case"RULE_SELECTOR":case"PANELIZE":case"PANELIZE_STAMP":case"PANELIZE_SIDE":case"CONNECT":case"EQLEN_GRP":case"EQLEN":case"FONT":case"PAD_NET":case"REUSE_BLOCK":case"PROP":break;case"PARTITION":this.parsePartition(t);break;case"VIA":this.parseVia(t);break;case"PAD":this.parsePad(t);break;case"LINE":await this.parseLine(t);break;case"ARC":this.parseArc(t);break;case"CARC":this.parseCArc(t);break;case"OBJ":this.parseObj(t);break;case"POLY":this.parsePoly(t);break;case"FILL":this.parseFill(t);break;case"REGION":this.parseRegion(t);break;case"POUR":this.parsePour(t);break;case"IMAGE":this.parseImage(t);break;case"TEARDROP":this.parseTeardrop(t);break;case"FPC_FILL":this.parseFpcFill(t);break;case"SHELL":this.parseShell(t);break;case"CREASE":this.parseCrease(t);break;case"SHELLCUT":this.parseShellCut(t);break;case"SHELL_ENTITY":this.parseShellEntity(t);break;case"BOSS":this.parseBoss(t);break;case"STRING":this.parseString(t);break;case"ATTR":this.parseAttr(t,e);break;case"DIMENSION":this.parseDimension(t);break;case"COMPONENT":this.parseComponent(t);break;default:console.warn("can not find hanlder with",t)}}onParseEnd(){for(let e of this.rules)e[1]=this.transRuleType(e[1]),e[3]=this.transRuleStatus(e[3]),e[4]=Xpe(e[1],e[2],e[3],e[4],this.fac,this.ruleTemplateName);if(this.fac.init){let e=Array.from(this.rules);for(let r of e){let i=qpe(r[1],r[2],r[4],this.fac);i&&this.rules.push(i)}}for(let e of this.rules)this.parseRule(e);let t={};for(let e of this.ruleSelectors){let r=Wpe(e[1],e[2],e2(e[3]),this.fac),i=JSON.stringify(e[1]);t[i]?(e[2]&&(t[i].ruleOrder=e[2]),r.ruleKeyValue&&(t[i].ruleKeyValue=Object.assign(t[i].ruleKeyValue,r.ruleKeyValue)),(r.copperRuleValue||e[4])&&(t[i].copperValue=r.copperRuleValue||e2(e[4])),(r.innerPlaneRuleValue||e[5])&&(t[i].innerPlaneValue=r.innerPlaneRuleValue||e2(e[5]))):t[i]={ruleSelect:e[1],ruleOrder:e[2],ruleKeyValue:r.ruleKeyValue,copperValue:r.copperRuleValue||e2(e[4])||{},innerPlaneValue:r.innerPlaneRuleValue||e2(e[5])||{}}}for(let e in t)this.parseRuleSelector(t[e]);this.handConnect(),this.parseEQLenGrpFull(),this.parsePanelize(),this.parseLayerFill();for(let e in this.cache){let r=this.cache[e],i=Object.keys(r).sort((s,a)=>Number(s)-Number(a)),n=-1;for(let s of i){let a=Number(s),o=a-n-1;o>=1&&this.onPHolder(e,o),n=a,this.curPartition=r[a].part,this.secondParseLine(r[a].value,void 0,r[a].attr),r[a].attr&&r[a].attr.forEach(l=>{this.curPartition=l.part,this.secondParseLine(l.value)})}if(this.errorIds[e])for(let s of this.errorIds[e])this.curPartition=s.part,this.secondParseLine(s.value)}this.clearCache()}clearCache(){this.version=void 0,this.docType=void 0,this.curPartition="",this.eQLenData={},this.eQLenSort=1,this.cache={},this.components={},this.errorIds={},this.dimension={},this.connects={},this.specialColors={},this.reuseBlock={},this.panelize.data.length&&(this.panelize.data.length=0,this.panelize.stamp={h:null,v:null},this.panelize.size={h:null,v:null}),this.layerPhys=0,this.fac.init&&(this.fac=new FG),this.rules=[],this.ruleSelectors=[],this.ruleTemplateName="",this.layerFill={},this.idsSet.clear(),this.oldId={},this.creaseIds.length=0}fixPolygon(t){if(t[0]=="R"){let e=parseFloat(t[3])/10,r=parseFloat(t[4])/10;t[6]=Math.min(e,r)/2*(parseFloat(t[6])||0)*10}}handleSimplePolygon(t){return!t||this.version>=1.5||this.fixPolygon(t),t}handlePolygon(t){if(this.version<1.5&&t&&t.length){if(!Array.isArray(t[0]))return this.handleSimplePolygon(t);for(let e of t)this.fixPolygon(e)}return t}parseEQLen(t){this.eQLenData[t[1]]?this.eQLenData[t[1]].pads?this.eQLenData[t[1]].pads.push(t[2]):this.eQLenData[t[1]].pads=[t[2]]:this.eQLenData[t[1]]={pads:[t[2]]}}parseEQLenGrp(t){this.eQLenData[t[1]]?(this.eQLenData[t[1]].id=t[1],this.eQLenData[t[1]].name=t[2],this.eQLenData[t[1]].sort=++this.eQLenSort):this.eQLenData[t[1]]={id:t[1],name:t[2],sort:++this.eQLenSort}}parseCanvas(t){this.onCanvas(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],this.transGridType(t[10]),this.transGridType(t[11]),t[12])}parseDocType(t){this.docType=t[1];let e=parseFloat(t[2]);this.version=e}parseHead(t){}parseLayer(t){let e=t[8];this.version<1.7&&(e=.5);let r=this.transLayerStatus(t[4]);this.onLayer(t[1],t[2],t[3],r.use,r.show,r.locked,t[5],t[6],t[7],e)}parseLayerPhys(t){this.onLayerPhys(t[1],t[2],t[3],t[4],t[5],!!t[6],++this.layerPhys)}parseActiveLayer(t){this.onActiveLayer(t[1])}parsePartition(t){this.onPartition(t[1],t[2],t[3],this.handlePolygon(t[4]))}parseNet(t){var e,r,i,n;this.onNet(t[1],(e=t[2])!=null?e:null,(r=t[3])!=null?r:null,!!t[4],(i=t[5])!=null?i:null,!!t[6],(n=t[7])!=null?n:null)}parsePrimitive(t){this.onPrimitive(t[1],!!t[2],!!t[3])}parseGroup(t){this.onGroup(t[1],t[2])}parseSilkOpts(t){this.onSilkOpts(t[1],t[2],t[3])}parsePreference(t){this.onPreference(!!t[1],t[2],!!t[3],t[4],t[5],!!t[6],this.transRoutingMode(t[7]),t[8],!!t[9],!!t[10],!!t[11],t[12],t[13],!!t[14],this.transUnusedPadRange(t[15]),t[16],this.transPathOptimization(t[17]),t[18],t[19],t[20])}parseConnect(t){this.connects[t[1]]=t[2]}parseVia(t){var e,r;this.onVia(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],t[6],t[7],t[8],this.transViaType(t[9]),(e=t[10])!=null?e:null,(r=t[11])!=null?r:null,!!t[12],t[13])}parsePad(t){var e,r,i,n,s,a,o,l,c;this.onPad(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],t[6],t[7],t[8],this.transHoleDef(t[9]),this.transPadDef(t[10]),t[11]&&(r=(e=t[11])==null?void 0:e.map(u=>({startLayer:u[0],endLayer:u[1],pad:this.transPadDef(u[2])})))!=null?r:null,t[12],t[13],t[14],!!t[15],this.transPadFuncType(t[16]),(i=t[17])!=null?i:null,(n=t[18])!=null?n:null,(s=t[19])!=null?s:null,(a=t[20])!=null?a:null,!!t[21],this.transPadConnect(t[22]),(o=t[23])!=null?o:null,(l=t[24])!=null?l:null,(c=t[25])!=null?c:null,t[26],this.getConnect(t[1]))}parseLine(t){this.onLine(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],!!t[10])}parseArc(t){this.onArc(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],!!t[11],this.specialColors[this.getOldId(t[1])])}parseCArc(t){this.onCArc(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],!!t[11],this.specialColors[this.getOldId(t[1])])}parseObj(t){this.onObj(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],!!t[10],t[11],!!t[12],this.specialColors[this.getOldId(t[1])])}parseItemOrder(t){this.itemOrder=t[1]}parseProp(t){this.specialColors[t[1]]=t[2]}parseEQLenGrpFull(){for(let t in this.eQLenData){let e=this.eQLenData[t];e.id&&this.onEQLenGrp(e.id,e.name,e.sort,e.pads||[])}this.eQLenData={},this.eQLenSort=1}parsePoly(t){this.onPoly(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],this.handleSimplePolygon(t[6]),!!t[7],this.specialColors[this.getOldId(t[1])])}parseFill(t){this.onFill(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],this.transFillStyle(t[6]),this.handlePolygon(t[7]),!!t[8],this.getConnect(t[1]),this.specialColors[this.getOldId(t[1])])}getZIndex1(t){let e=t.match(J4);return e!=null&&e.length?e[1]:null}parseLayerFill(){for(let t in this.layerFill){let e=this.layerFill[t];this.onLayerFill(Number(t),{fill:e.map(r=>{let i=this.getZIndex1(r[1]);return{id:r[1],partitionId:this.curPartition||"",groupId:r[2],locked:!!r[8],zIndex:i===null?null:Number(i),netName:r[3],width:r[5],path:this.handlePolygon(r[7]),refs:this.getConnect(r[1]),specialColor:this.specialColors[this.getOldId(r[1])]}})})}}parseRegion(t){let e=t[5],r=e&&e.includes(9)?"CONSTRAINT":"PROHIBIT";e=r?e.filter(i=>i!==9):e,this.onRegion(t[1],this.curPartition||"",t[2],t[3],t[4],this.transProhibitType(e),this.handlePolygon(t[6]),!!t[7],t[8],r)}parsePour(t){let e=t[9];this.version<=1.7&&e&&e[0]==="SOLID"&&e[1]&&(e[1]=8),this.onPour(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],t[6],t[7],this.handlePolygon(t[8]),this.transPourDef(e),!!t[10],!!t[11]),this.poured[t[1]]&&this.onPoured(t[1],this.poured[t[1]])}parsePoured(t){if(this.version<1.1){if(this.curPourId){let e={id:t[1],strokeWidth:t[2],fill:t[3],path:this.handlePolygon(t[4])};this.poured[this.curPourId]||(this.poured[this.curPourId]={pourFill:[]}),this.poured[this.curPourId].pourFill.push(e)}}else{let e={id:t[1],strokeWidth:t[3],fill:t[4],path:this.handlePolygon(t[5])};this.poured[t[2]]||(this.poured[t[2]]={pourFill:[]}),this.poured[t[2]].pourFill.push(e)}}parseImage(t){this.onImage(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],t[6],t[7],t[8],!!t[9],t[10],!!t[11],this.specialColors[this.getOldId(t[1])])}parseTeardrop(t){let e,r,i;this.version<1.2?(e=t[5],i=t[4]):(e=t[4],r=t[5],i=this.getConnect(t[1])),this.onTeardrop(t[1],this.curPartition||"",t[2],t[3],this.handleSimplePolygon(e),r!=null?r:null,i)}parseFpcFill(t){this.onFpcFill(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],this.handlePolygon(t[6]),!!t[7])}parseShell(t){let e=t[8];e&&e.Direction&&(e.Direction=this.transPushCoverDir(e.Direction)),this.onShell(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],t[6],this.handlePolygon(t[7]),e,!!t[9])}parseCrease(t){this.onCrease(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],t[6],t[7],t[8],!!t[9])}parseShellCut(t){this.onShellCut(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],this.handlePolygon(t[6]),!!t[7],this.getConnect(t[1]))}parseShellEntity(t){this.onShellEntity(t[1],this.curPartition||"",t[2],t[3],t[4],this.transEntityBelong(t[5]),this.transSlotOption(t[5]),t[6],t[7],this.handlePolygon(t[8]),!!t[9],this.getConnect(t[1]))}parseBoss(t){var e,r,i,n,s,a;this.version<1.4?this.onBoss(t[1],this.curPartition||"",t[2],t[3],t[5],t[6],(e=t[4])!=null?e:null,t[7],null,null,(r=t[8])!=null?r:null,(i=t[9])!=null?i:null,!!t[10]):this.onBoss(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],(n=t[6])!=null?n:null,t[7],t[8],t[9],(s=t[10])!=null?s:null,(a=t[11])!=null?a:null,!!t[12])}parseDimension(t){var n;let e=this.getOldId(t[1]),r=((n=this.dimension[e])==null?void 0:n.attr)||[];if(r.length){let s=this.fontCache.find(a=>a.id&&a.id===this.getOldId(r[1]));this.version<1.6&&s&&(s.text=r[8],s.fontFamily=r[11],s.fontSize=r[12]/10,s.thickness=r[13],s.bold=r[15],s.italic=r[16],s.reverse=r[18],s.expansion=r[19])}let i={groupId:r[2],layerId:r[4],x:r[5],y:r[6],text:r[8],fontFamily:r[11],fontSize:r[12],strokeWidth:r[13],bold:r[14],italic:r[15],origin:r[16],angle:r[17],reverse:r[18],expansion:r[19],mirror:r[20],locked:r[21],zIndex:null,specialColor:this.specialColors[this.getOldId(r[1])]};this.onDimension(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],t[6],!!t[7],t[8],!!t[9],i,this.specialColors[this.getOldId(t[1])],r[2]||"")}parseRuleTemplate(t){this.ruleTemplateName=t[1],this.onRuleTemplate(t[1])}parseRule(t){this.onRule(t[1],t[2],t[3],t[4])}parseRuleSelector(t){this.onRuleSelector(t.ruleSelect,t.ruleOrder,t.ruleKeyValue,t.copperValue,t.innerPlaneValue)}parsePanelize(){let t=this.panelize.data;t.length&&this.onPanelize(!!t[1],t[2],t[3],t[4],t[5],!!t[6],this.panelize.stamp.h,this.panelize.stamp.v,this.panelize.size.h,this.panelize.size.v)}parsePanelizeStamp(t){let e={on:!!t[2],stampHoleGroupQuantity:t[3],stampHoleDiameter:t[4],stampHoleQuantityPerGroup:t[5],stampHoleSpacing:t[6]};t[1]?this.panelize.stamp.v=e:this.panelize.stamp.h=e}parsePanelizeSide(t){let e={on:!!t[2],sideHeight:t[3],positionHoleDiameter:t[4],markDiameter:t[5],markExpansion:t[6]};t[1]?this.panelize.size.v=e:this.panelize.size.h=e}parseComponent(t){let e=this.getOldId(t[1]),r=t[7]||{},i=this.reuseBlock[e];if(i&&Object.assign(r,{"Group ID":i[2]||"","Channel ID":i[3]||""}),this.onComponent(t[1],this.curPartition||"",t[2],t[3],t[4],t[5],t[6],r,!!t[8],this.specialColors[e]),this.cachePadNet[e])for(let n of this.cachePadNet[e])this.parsePadNet(n)}parsePadNet(t){let e=this.getOldId(t[1]);if(t[4]===void 0&&this.components[e]){let r=this.components[e].footprint;if(!r){let n=this.components[e].device;r=this.devices.find(s=>s.uuid===n).attributes.Footprint}let i=this.padNumId[r];if(!i){let n=this.footprints.find(s=>s.uuid===r);n&&(this.padNumId[r]=Kpe(n==null?void 0:n.dataStr),i=this.padNumId[r])}if(i&&i[t[2]]){this.componentPadNum[e]||(this.componentPadNum[e]={}),this.componentPadNum[e][t[2]]===void 0&&(this.componentPadNum[e][t[2]]=-1);let n=++this.componentPadNum[e][t[2]];t[4]=i[t[2]][n]}else t[4]=t[2]}this.onPadNet(t[1],this.curPartition||"",t[2],t[3],t[4])}parseReuseBlock(t){this.reuseBlock[t[1]]=t}getFontCache(t,e,r,i,n,s,a,o){let l;return this.version<1.6?l=this.fontCache.find(c=>c.id===t):l=this.fontCache.find(c=>r==c.fontFamily&&e==c.text&&i/10==c.fontSize&&!!a==c.reverse&&o==c.expansion&&!!n==c.bold&&!!s==c.italic&&c.path.length>0),{paths:l==null?void 0:l.path,width:l==null?void 0:l.width,height:l==null?void 0:l.height}}getTextValue(t,e,r,i,n){let s="";return t!=""&&e===""&&this.docType!="PCB"&&!n&&t!="Footprint"&&!this.footprintIsConnectDevice&&(e=`<${t}>`),r?i?s=t+":"+e:s=t:i?s=e:s="",s}getFormulaName(t,e){if(!t||!t.startsWith("="))return t;t=t.slice(1);let r=/\{([^\}]+)\}/g,i=[],n=[];for(;i=r.exec(t);)n.push(i[1]);for(let s=0;s<n.length;s++){let a=n[s],o=`{${a}!}`;e.has(a)&&(o=e.get(a)),t=t.replace(`{${a}}`,o)}return t}parseAttr(t,e){let r=t[11],i=t[12];i&&this.version<1.2&&(r=="default"||r=="")&&(i*=1.5);let n=t[7],s=t[8],a=!!t[9],o=!!t[10],l=this.getOldId(t[3]),c=s;if(n==="Device"){let d=this.deviceName[s]||s;c=this.getTextValue(n,d,a,o,l)}else if(n==="Footprint"){let d=this.footprintName[s]||s;c=this.getTextValue(n,d,a,o,l)}else if(n==="Name"){let d=new Map;if(l){let A=this.components[l];if(d.set("ID",l),Object.entries(A.attrs).forEach(h=>d.set(h[0],h[1])),A.device){let h=this.devices.find(f=>f.uuid===A.device);h&&Object.entries(h.attributes).forEach(f=>d.set(f[0],f[1]))}}c=this.getTextValue(n,this.getFormulaName(s,d),a,o,l)}else c=this.getTextValue(n,s,a,o,l);let u=this.fontCache.find(d=>d.id&&d.id===this.getOldId(t[1]));this.version<1.6&&u&&(u.text=c,u.fontFamily=r,u.fontSize=i/10,u.thickness=t[13],u.bold=t[15],u.italic=t[16],u.reverse=t[18],u.expansion=t[19]),this.onAttr(t[1],this.curPartition||"",t[2],l,t[4],t[5],t[6],n,s,a,o,r,i,t[13],!!t[14],!!t[15],this.transAlignType(t[16]),t[17],!!t[18],t[19],!!t[20],!!t[21],e,this.specialColors[this.getOldId(t[1])])}parseFont(t){let e;switch(this.version){case 1:case 1.1:e={id:t[1],path:t[2]};break;case 1.2:case 1.3:case 1.4:case 1.5:e={id:t[1],width:t[2],height:t[3],path:t[4]};break;default:e={text:t[1],fontFamily:t[2],fontSize:t[3],thickness:t[4],bold:!!t[5],italic:!!t[6],reverse:!!t[7],expansion:t[8],width:t[9],height:t[10],path:t[11]};break}this.fontCache.push(e)}parseString(t){var E;let[,e,r,i,n,s,a,o,l,c,u,d,A,h,f,p,m,y]=t,g=(E=this.stringId[e])!=null?E:e;l&&this.version<1.2&&(o=="default"||o=="")&&(l*=1.5);let b=this.fontCache.find(w=>w.id&&w.id===this.getOldId(g));this.version<1.6&&b&&(b.text=a,b.fontFamily=o,b.fontSize=l/10,b.thickness=c,b.bold=u,b.italic=d,b.reverse=f,b.expansion=p),this.onString(e,this.curPartition||"",r,i,n,s,a,o,l,c,!!u,!!d,this.transAlignType(A),h,!!f,p,!!m,!!y,this.specialColors[this.getOldId(g)])}},Zpe=Object.create,JY=Object.defineProperty,eme=Object.getOwnPropertyDescriptor,tme=Object.getOwnPropertyNames,rme=Object.getPrototypeOf,ime=Object.prototype.hasOwnProperty,nme=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),sme=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of tme(e))!ime.call(t,n)&&n!==r&&JY(t,n,{get:()=>e[n],enumerable:!(i=eme(e,n))||i.enumerable});return t},ame=(t,e,r)=>(r=t!=null?Zpe(rme(t)):{},sme(e||!t||!t.__esModule?JY(r,"default",{value:t,enumerable:!0}):r,t)),ome=nme((t,e)=>{"use strict";e.exports=r,e.exports.default=r;function r(v,N,R){R=R||2;var q=N&&N.length,P=q?N[0]*R:v.length,z=i(v,0,P,R,!0),W=[];if(!z||z.next===z.prev)return W;var oe,Ae,me,ve,Le,He,rt;if(q&&(z=u(v,N,z,R)),v.length>80*R){oe=me=v[0],Ae=ve=v[1];for(var qe=R;qe<P;qe+=R)Le=v[qe],He=v[qe+1],Le<oe&&(oe=Le),He<Ae&&(Ae=He),Le>me&&(me=Le),He>ve&&(ve=He);rt=Math.max(me-oe,ve-Ae),rt=rt!==0?32767/rt:0}return s(z,W,R,oe,Ae,rt,0),W}function i(v,N,R,q,P){var z,W;if(P===M(v,N,R,q)>0)for(z=N;z<R;z+=q)W=j(z,v[z],v[z+1],W);else for(z=R-q;z>=N;z-=q)W=j(z,v[z],v[z+1],W);return W&&x(W,W.next)&&($(W),W=W.next),W}function n(v,N){if(!v)return v;N||(N=v);var R=v,q;do if(q=!1,!R.steiner&&(x(R,R.next)||w(R.prev,R,R.next)===0)){if($(R),R=N=R.prev,R===R.next)break;q=!0}else R=R.next;while(q||R!==N);return N}function s(v,N,R,q,P,z,W){if(v){!W&&z&&p(v,q,P,z);for(var oe=v,Ae,me;v.prev!==v.next;){if(Ae=v.prev,me=v.next,z?o(v,q,P,z):a(v)){N.push(Ae.i/R|0),N.push(v.i/R|0),N.push(me.i/R|0),$(v),v=me.next,oe=me.next;continue}if(v=me,v===oe){W?W===1?(v=l(n(v),N,R),s(v,N,R,q,P,z,2)):W===2&&c(v,N,R,q,P,z):s(n(v),N,R,q,P,z,1);break}}}}function a(v){var N=v.prev,R=v,q=v.next;if(w(N,R,q)>=0)return!1;for(var P=N.x,z=R.x,W=q.x,oe=N.y,Ae=R.y,me=q.y,ve=P<z?P<W?P:W:z<W?z:W,Le=oe<Ae?oe<me?oe:me:Ae<me?Ae:me,He=P>z?P>W?P:W:z>W?z:W,rt=oe>Ae?oe>me?oe:me:Ae>me?Ae:me,qe=q.next;qe!==N;){if(qe.x>=ve&&qe.x<=He&&qe.y>=Le&&qe.y<=rt&&b(P,oe,z,Ae,W,me,qe.x,qe.y)&&w(qe.prev,qe,qe.next)>=0)return!1;qe=qe.next}return!0}function o(v,N,R,q){var P=v.prev,z=v,W=v.next;if(w(P,z,W)>=0)return!1;for(var oe=P.x,Ae=z.x,me=W.x,ve=P.y,Le=z.y,He=W.y,rt=oe<Ae?oe<me?oe:me:Ae<me?Ae:me,qe=ve<Le?ve<He?ve:He:Le<He?Le:He,xt=oe>Ae?oe>me?oe:me:Ae>me?Ae:me,Gt=ve>Le?ve>He?ve:He:Le>He?Le:He,ut=y(rt,qe,N,R,q),Pe=y(xt,Gt,N,R,q),ft=v.prevZ,ht=v.nextZ;ft&&ft.z>=ut&&ht&&ht.z<=Pe;){if(ft.x>=rt&&ft.x<=xt&&ft.y>=qe&&ft.y<=Gt&&ft!==P&&ft!==W&&b(oe,ve,Ae,Le,me,He,ft.x,ft.y)&&w(ft.prev,ft,ft.next)>=0||(ft=ft.prevZ,ht.x>=rt&&ht.x<=xt&&ht.y>=qe&&ht.y<=Gt&&ht!==P&&ht!==W&&b(oe,ve,Ae,Le,me,He,ht.x,ht.y)&&w(ht.prev,ht,ht.next)>=0))return!1;ht=ht.nextZ}for(;ft&&ft.z>=ut;){if(ft.x>=rt&&ft.x<=xt&&ft.y>=qe&&ft.y<=Gt&&ft!==P&&ft!==W&&b(oe,ve,Ae,Le,me,He,ft.x,ft.y)&&w(ft.prev,ft,ft.next)>=0)return!1;ft=ft.prevZ}for(;ht&&ht.z<=Pe;){if(ht.x>=rt&&ht.x<=xt&&ht.y>=qe&&ht.y<=Gt&&ht!==P&&ht!==W&&b(oe,ve,Ae,Le,me,He,ht.x,ht.y)&&w(ht.prev,ht,ht.next)>=0)return!1;ht=ht.nextZ}return!0}function l(v,N,R){var q=v;do{var P=q.prev,z=q.next.next;!x(P,z)&&I(P,q,q.next,z)&&_(P,z)&&_(z,P)&&(N.push(P.i/R|0),N.push(q.i/R|0),N.push(z.i/R|0),$(q),$(q.next),q=v=z),q=q.next}while(q!==v);return n(q)}function c(v,N,R,q,P,z){var W=v;do{for(var oe=W.next.next;oe!==W.prev;){if(W.i!==oe.i&&E(W,oe)){var Ae=Q(W,oe);W=n(W,W.next),Ae=n(Ae,Ae.next),s(W,N,R,q,P,z,0),s(Ae,N,R,q,P,z,0);return}oe=oe.next}W=W.next}while(W!==v)}function u(v,N,R,q){var P=[],z,W,oe,Ae,me;for(z=0,W=N.length;z<W;z++)oe=N[z]*q,Ae=z<W-1?N[z+1]*q:v.length,me=i(v,oe,Ae,q,!1),me===me.next&&(me.steiner=!0),P.push(g(me));for(P.sort(d),z=0;z<P.length;z++)R=A(P[z],R);return R}function d(v,N){return v.x-N.x}function A(v,N){var R=h(v,N);if(!R)return N;var q=Q(R,v);return n(q,q.next),n(R,R.next)}function h(v,N){var R=N,q=v.x,P=v.y,z=-1/0,W;do{if(P<=R.y&&P>=R.next.y&&R.next.y!==R.y){var oe=R.x+(P-R.y)*(R.next.x-R.x)/(R.next.y-R.y);if(oe<=q&&oe>z&&(z=oe,W=R.x<R.next.x?R:R.next,oe===q))return W}R=R.next}while(R!==N);if(!W)return null;var Ae=W,me=W.x,ve=W.y,Le=1/0,He;R=W;do q>=R.x&&R.x>=me&&q!==R.x&&b(P<ve?q:z,P,me,ve,P<ve?z:q,P,R.x,R.y)&&(He=Math.abs(P-R.y)/(q-R.x),_(R,v)&&(He<Le||He===Le&&(R.x>W.x||R.x===W.x&&f(W,R)))&&(W=R,Le=He)),R=R.next;while(R!==Ae);return W}function f(v,N){return w(v.prev,v,N.prev)<0&&w(N.next,v,v.next)<0}function p(v,N,R,q){var P=v;do P.z===0&&(P.z=y(P.x,P.y,N,R,q)),P.prevZ=P.prev,P.nextZ=P.next,P=P.next;while(P!==v);P.prevZ.nextZ=null,P.prevZ=null,m(P)}function m(v){var N,R,q,P,z,W,oe,Ae,me=1;do{for(R=v,v=null,z=null,W=0;R;){for(W++,q=R,oe=0,N=0;N<me&&(oe++,q=q.nextZ,!!q);N++);for(Ae=me;oe>0||Ae>0&&q;)oe!==0&&(Ae===0||!q||R.z<=q.z)?(P=R,R=R.nextZ,oe--):(P=q,q=q.nextZ,Ae--),z?z.nextZ=P:v=P,P.prevZ=z,z=P;R=q}z.nextZ=null,me*=2}while(W>1);return v}function y(v,N,R,q,P){return v=(v-R)*P|0,N=(N-q)*P|0,v=(v|v<<8)&16711935,v=(v|v<<4)&252645135,v=(v|v<<2)&858993459,v=(v|v<<1)&1431655765,N=(N|N<<8)&16711935,N=(N|N<<4)&252645135,N=(N|N<<2)&858993459,N=(N|N<<1)&1431655765,v|N<<1}function g(v){var N=v,R=v;do(N.x<R.x||N.x===R.x&&N.y<R.y)&&(R=N),N=N.next;while(N!==v);return R}function b(v,N,R,q,P,z,W,oe){return(P-W)*(N-oe)>=(v-W)*(z-oe)&&(v-W)*(q-oe)>=(R-W)*(N-oe)&&(R-W)*(z-oe)>=(P-W)*(q-oe)}function E(v,N){return v.next.i!==N.i&&v.prev.i!==N.i&&!U(v,N)&&(_(v,N)&&_(N,v)&&H(v,N)&&(w(v.prev,v,N.prev)||w(v,N.prev,N))||x(v,N)&&w(v.prev,v,v.next)>0&&w(N.prev,N,N.next)>0)}function w(v,N,R){return(N.y-v.y)*(R.x-N.x)-(N.x-v.x)*(R.y-N.y)}function x(v,N){return v.x===N.x&&v.y===N.y}function I(v,N,R,q){var P=G(w(v,N,R)),z=G(w(v,N,q)),W=G(w(R,q,v)),oe=G(w(R,q,N));return!!(P!==z&&W!==oe||P===0&&C(v,R,N)||z===0&&C(v,q,N)||W===0&&C(R,v,q)||oe===0&&C(R,N,q))}function C(v,N,R){return N.x<=Math.max(v.x,R.x)&&N.x>=Math.min(v.x,R.x)&&N.y<=Math.max(v.y,R.y)&&N.y>=Math.min(v.y,R.y)}function G(v){return v>0?1:v<0?-1:0}function U(v,N){var R=v;do{if(R.i!==v.i&&R.next.i!==v.i&&R.i!==N.i&&R.next.i!==N.i&&I(R,R.next,v,N))return!0;R=R.next}while(R!==v);return!1}function _(v,N){return w(v.prev,v,v.next)<0?w(v,N,v.next)>=0&&w(v,v.prev,N)>=0:w(v,N,v.prev)<0||w(v,v.next,N)<0}function H(v,N){var R=v,q=!1,P=(v.x+N.x)/2,z=(v.y+N.y)/2;do R.y>z!=R.next.y>z&&R.next.y!==R.y&&P<(R.next.x-R.x)*(z-R.y)/(R.next.y-R.y)+R.x&&(q=!q),R=R.next;while(R!==v);return q}function Q(v,N){var R=new B(v.i,v.x,v.y),q=new B(N.i,N.x,N.y),P=v.next,z=N.prev;return v.next=N,N.prev=v,R.next=P,P.prev=R,q.next=R,R.prev=q,z.next=q,q.prev=z,q}function j(v,N,R,q){var P=new B(v,N,R);return q?(P.next=q.next,P.prev=q,q.next.prev=P,q.next=P):(P.prev=P,P.next=P),P}function $(v){v.next.prev=v.prev,v.prev.next=v.next,v.prevZ&&(v.prevZ.nextZ=v.nextZ),v.nextZ&&(v.nextZ.prevZ=v.prevZ)}function B(v,N,R){this.i=v,this.x=N,this.y=R,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}r.deviation=function(v,N,R,q){var P=N&&N.length,z=P?N[0]*R:v.length,W=Math.abs(M(v,0,z,R));if(P)for(var oe=0,Ae=N.length;oe<Ae;oe++){var me=N[oe]*R,ve=oe<Ae-1?N[oe+1]*R:v.length;W-=Math.abs(M(v,me,ve,R))}var Le=0;for(oe=0;oe<q.length;oe+=3){var He=q[oe]*R,rt=q[oe+1]*R,qe=q[oe+2]*R;Le+=Math.abs((v[He]-v[qe])*(v[rt+1]-v[He+1])-(v[He]-v[rt])*(v[qe+1]-v[He+1]))}return W===0&&Le===0?0:Math.abs((Le-W)/W)};function M(v,N,R,q){for(var P=0,z=N,W=R-q;z<R;z+=q)P+=(v[W]-v[z])*(v[z+1]+v[W+1]),W=z;return P}r.flatten=function(v){for(var N=v[0][0].length,R={vertices:[],holes:[],dimensions:N},q=0,P=0;P<v.length;P++){for(var z=0;z<v[P].length;z++)for(var W=0;W<N;W++)R.vertices.push(v[P][z][W]);P>0&&(q+=v[P-1].length,R.holes.push(q))}return R}}),lme=(t=>(t[t.MIL=1]="MIL",t[t.INCH=1e3]="INCH",t[t.FT=12e3]="FT",t[t.YARD=36e3]="YARD",t[t.MILE=6336e4]="MILE",t[t.KM=3937007874e-2]="KM",t[t.M=39370]="M",t[t.DM=3937]="DM",t[t.CM=393.7]="CM",t[t.MM=39.37]="MM",t[t.UM=.039]="UM",t[t.NM=394e-7]="NM",t[t.PT=13.88888888888889]="PT",t[t.PX72=13.88888888888889]="PX72",t[t.PX96=10.416666666666666]="PX96",t[t.PX100=10]="PX100",t[t.LTSPICE=6.25]="LTSPICE",t[t.PX1=.1]="PX1",t[t.PX001=.001]="PX001",t))(lme||{}),cme=(t=>(t.MIL="mil",t.INCH="inch",t.FT="ft",t.YARD="yard",t.MILE="mile",t.KM="km",t.M="m",t.DM="dm",t.CM="cm",t.MM="mm",t.UM="um",t.NM="nm",t.PT="pt",t.PX72="px(72)",t.PX96="px(96)",t.PX100="px(100)",t))(cme||{}),HG={mil:1,inch:1e3,ft:12e3,yard:36e3,mile:6336e4,km:3937007874e-2,dm:3937,mm:39.37,um:.039,nm:394e-7,pt:13.88888888888889,"px(72)":13.88888888888889,"px(96)":10.416666666666666,"px(100)":10},g8e=(()=>{let t={};for(let e in HG)t[HG[e]]=e;return t})();var _1,y8e=(_1=class{constructor(e,r){this.ratio=e/r}wrap(e){return e*this.ratio}static convert(e,r,i){return e*r/i}},_1.ASIS=new _1(1,1),_1),qB=class{conversion(t,e,r){if(t===e)return r;let i=t+2+e;return this[i](r)}conversion1(t,e,r){let i=t+2+e,n=this[i](r);return e=="mil"?Math.round(n*10)/10:Math.round(n*1e3)/1e3}mil2mil(t){return t}mil2mm(t){return t*.0254}mil2cm(t){return t*.00254}mil2inch(t){return t/1e3}mm2mm(t){return t}mm2mil(t){let e=Math.pow(10,5);return Math.round(t*39.37007874015748*e)/e}mm2cm(t){return t/10}mm2inch(t){let e=Math.pow(10,8);return Math.round(t*.03937007874015748*e)/e}cm2mil(t){let e=Math.pow(10,6);return Math.round(t*393.7007874015748*e)/e}cm2mm(t){return t*10}cm2inch(t){let e=Math.pow(10,7);return Math.round(t*.3937007874015748*e)/e}inch2mil(t){return t*1e3}inch2mm(t){return t*25.4}inch2cm(t){return t*2.54}};qB.prototype["px(100)2mil"]=t=>t*10,qB.prototype["px(100)2mm"]=t=>t*.254,qB.prototype["mil2px(100)"]=t=>t/10,qB.prototype["mm2px(100)"]=t=>{let e=Math.pow(10,5);return Math.round(t*3.937007874015748*e)/e};var WB=null,Z4=new ArrayBuffer(8),$R=new Float64Array(Z4),ZR=new Uint32Array(Z4),GG=new Uint16Array(Z4);var YG=class{static repeat(t,e){let r=new Array(e);for(;e-- >0;)r[e]=t;return r.join("")}static lpad(t,e,r){let i=r-t.length;return i>0?this.repeat(e,i)+t:t}static rpad(t,e,r){let i=r-t.length;return i>0?t+this.repeat(e,i):t}static strHashcode(t){if(t.length>0){let e=0;for(let r=0;r<t.length;r++)e=31*e+t.charCodeAt(r)|0;return e}else return 0}static arraycopy(t,e,r,i,n){if(t.length>=e+n&&r.length>=i+n)for(;n-- >0;)r[i++]=t[e++];else throw new Error("arraycopy out of range")}static undefAsNull(t){return null}static reverse(t,e){for(let r=0,i=t.length-1;i>=0;r++,i--)e[r]=t[i];return e}static sortAsc(t,e){return t-e}static xmlDecode(t){let e=t.length,r=new Array,i=-1;for(let n=0;n<e;n++){let s=t.charAt(n);if(i>=0){if(s===";"){let a=t.substring(i+1,n);switch(a){case"lt":r.push("<");break;case"gt":r.push(">");break;case"quot":r.push('"');break;case"apos":r.push("'");break;case"amp":r.push("&");break;default:if(a.charAt(0)==="#"){let o=parseInt(a.substring(1));r.push(String.fromCharCode(o))}else r.push("&"+a+";")}i=-1}}else s==="&"?i=n:r.push(s)}return i>=0&&r.push(t.substring(i)),r.join("")}static addAll(t,e){for(let r of e)t.push(r)}static addAllSet(t,e){for(let r of e)t.add(r)}static contains(t,e){for(let r of t)if(r.equals(e))return!0;return!1}static equals(t,e){if(t.length==e.length){for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}else return!1}static remove(t,e){let r=0,i=t.length;for(let n=0;n<i;n++)t[n]===e&&(t.splice(n,1),n--,i--,r++);return r}static getUrlVars(){for(var t={},e=location.href.slice(location.href.indexOf("?")+1).split("&"),r=0;r<e.length;r++){var i=e[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}static prefix(){if(!WB){let t=this.getUrlVars().version;t?WB="/analyzer/v"+t:WB="/analyzer"}return WB}static add2objS(t,e,r){if(e in t)return t[e];{let i=r(e);return t[e]=i,i}}static downloadFile(t,e){let r=document.createElement("a"),i=URL.createObjectURL(e);r.download=t,r.href=i,r.click(),URL.revokeObjectURL(i)}static uuid(){let t=new Array;$R[0]=new Date().getTime(),t.push(ZR[1].toString(16)),$R[0]=Math.random(),t.push(GG[3].toString(16));let e=GG[2].toString(16);t.push("4"+e.substr(0,3)),$R[0]=performance.now();let r=ZR[0].toString(16)+ZR[1].toString(16);return t.push("0"+r.substr(0,3)),t.push(r.substr(3)),t.join("-")}static funcCopy(t){return(0,eval)("("+t.toString()+")")}static NVL(...t){for(let e of t)if(e!==null)return e;return null}static isSingle(t){return Array.from(new Set(t)).length===t.length}};var $Y=class{static rgb(t){if(0<=t&&t<=255)return t;throw new Error(a2.format("RGB should not nagative and not over 255(0xFF): %X",t))}static normal(t){if(isFinite(t))return t;throw new Error(a2.format("%f is not permitted",t))}static positiveOr0(t){if(t>=0)return t;throw new Error(a2.format("%f must >= 0",t))}static positive(t){if(t>0)return t;throw new Error(a2.format("%f must > 0",t))}static notnull(t){if(t!=null)return t;throw new Error("invalid null value")}static mustnull(t){if(t===null)return null;throw new Error("value must be null")}static notEmpty(t){if(t==null||t.length===0)throw new Error("invalid empty string");return t}static nullOrEmpty(t){return t==null||t.length===0}static notNullOrUndef(t){if(t!=null)return t;throw new Error("null or undefined is not permitted")}},ume=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.PERCENT=1]="PERCENT",t[t.LEFT_PAD0=2]="LEFT_PAD0",t))(ume||{}),hme=/(\.?0+)$/,a2=class{static format(t,...e){return this.format1(t,e)}static format1(t,e){let r=this._format(t,e);if(typeof r=="string")return r;throw new Error(this.format("Invalid state on (%d) %s",r,t))}static _format(t,e){let r=[],i=0,n=0,s,a=0,o=0;for(let l=0;l<t.length;l++){let c=t.charAt(l),u=c.charCodeAt(0);switch(i){case 0:u===37?i=1:r.push(c);break;case 1:switch(u){case 100:if(s=e[n++],typeof s=="number")r.push(s.toFixed(0)),i=0;else return l;break;case 102:if(s=e[n++],typeof s=="number")r.push(s.toString()),i=0;else return l;break;case 120:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16)),i=0;else return l;break;case 88:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16).toUpperCase()),i=0;else return l;break;case 115:case 99:s=e[n++],r.push(s===null?"null":s.toString()),i=0;break;case 48:a=l+1,o=-1,i=2;break;case 37:r.push("%"),i=0;break;default:return l}break;case 2:switch(u){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=l;break;case 120:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(YG.lpad((s|0).toString(16),"0",d)),i=0;else return l}else return l;break;case 88:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(YG.lpad((s|0).toString(16).toUpperCase(),"0",d)),i=0;else return l}else return l;break;default:return l}break;default:return l}}return r.join("")}static startsWith(t,e){return t.length>=e.length?t.substring(0,e.length)===e:!1}static endsWith(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}static split(t,e){let r=new Array,i=0;for(;;){let n=t.exec(e);if(n!==null){let s=t.lastIndex-n[0].length;r.push(e.substring(i,s)),i=t.lastIndex}else{let s=e.substring(i);$Y.nullOrEmpty(s)||r.push(s);break}}return r}static fmtNumber(t){return t.toFixed(5).replace(hme,"")}},dme=(t=>(t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARNING=2]="WARNING",t[t.ERROR=3]="ERROR",t[t.DUMMY=4]="DUMMY",t))(dme||{});function Ame(t){switch(t){case 0:return"DEBUG";case 1:return"INFO";case 2:return"WARNING";case 3:return"ERROR";case 4:return"DUMMY"}}var fme=(t,e)=>{t===3?console.error(e):console.log(e)},pme=(t,e)=>a2.format("%s %s: %s",new Date,Ame(t),e),ag,ZD=(ag=class{constructor(e,r=fme,i=pme){this.debug=!1,this.level=e,this.writer=r,this.fmt=i}static mix(...e){let r=4;for(let i of e)i.level<r&&(r=i.level);return new ag(r,(i,n)=>{for(let s of e)s.write1(i,n)},(i,n)=>n)}wrap(e=null,r=null){let i=e===null?this.fmt:(s,a)=>(a=e(s,a),this.fmt(s,a)),n=r===null?this.writer:(s,a)=>{r(s,a),this.writer(s,a)};return new ag(this.level,n,i)}chain(e){return e.wrap(this.fmt.bind(this),this.writer.bind(this))}include(e){return this.level<=e}write3(e,r,i){this.include(e)&&this.writer(e,this.fmt(e,a2.format(r,...i)))}write2(e,r){this.include(e)&&(r instanceof Error?this.writer(e,this.fmt(e,r.stack)):this.writer(e,this.fmt(e,r.toString())))}write1(e,r){this.include(e)&&this.writer(e,this.fmt(e,r))}debug3(e,...r){this.write3(0,e,r)}debug2(e){this.write2(0,e)}debug1(e){this.write1(0,e)}info3(e,...r){this.write3(1,e,r)}info2(e){this.write2(1,e)}info1(e){this.write1(1,e)}warning3(e,...r){this.write3(2,e,r)}warning2(e){this.write2(2,e)}warning1(e){this.write1(2,e)}error3(e,...r){this.write3(3,e,r)}error2(e){this.write2(3,e)}error1(e){this.write1(3,e)}},ag.DUMMY=new ag(4),ag),eM=new ArrayBuffer(8),e4=new Float64Array(eM),t4=new Uint32Array(eM),VG=new Uint16Array(eM),jG=ArrayBuffer;try{jG=self.HTMLImageElement||jG}catch{}var KB=null;function L1(t,e,r=0,i=t.length){n(t,null,e,r,i);function n(a,o,l,c,u){let d,A,h,f;if(c<u-1){let p=u-c;if(p>50)o===null&&(o=new Array(p+1)),s(a,o,l,c,(c+u)/2|0,u);else{d=a[c],A=c,h=c,f=u;let m=A+1;for(;m<f;){if(h!=f){if(f=f+-1,l(d,a[f])<=0)continue;a[h]=a[f],h=f;continue}if(l(d,a[m])>=0){A=m,m=A+1;continue}a[h]=a[m],A=m,h=m,m=A+1}a[h]=d,n(a,o,l,c,h),n(a,o,l,h+1,u)}}}function s(a,o,l,c,u,d){n(a,o,l,c,u),n(a,o,l,u,d);for(var A=c,h=u,f=0,p=a[A],m=a[h];A<u&&h<d;){var y=l(p,m);isNaN(y)?(o[f++]=m,m=a[++h]):(y<=0&&(o[f++]=p,p=a[++A]),y>=0&&(o[f++]=m,m=a[++h]))}for(;A<u;A++)o[f++]=a[A];for(;h<d;h++)o[f++]=a[h];for(A=c,h=0;h<f;A++,h++)a[A]=o[h]}}var su=class{static repeat(t,e){let r=new Array(e);for(;e-- >0;)r[e]=t;return r.join("")}static lpad(t,e,r){let i=r-t.length;return i>0?this.repeat(e,i)+t:t}static rpad(t,e,r){let i=r-t.length;return i>0?t+this.repeat(e,i):t}static strHashcode(t){if(t.length>0){let e=0;for(let r=0;r<t.length;r++)e=31*e+t.charCodeAt(r)|0;return e}else return 0}static arraycopy(t,e,r,i,n){if(t.length>=e+n&&r.length>=i+n)for(;n-- >0;)r[i++]=t[e++];else throw new Error("arraycopy out of range")}static undefAsNull(t){return null}static reverse(t,e){for(let r=0,i=t.length-1;i>=0;r++,i--)e[r]=t[i];return e}static sortAsc(t,e){return t-e}static xmlDecode(t){let e=t.length,r=new Array,i=-1;for(let n=0;n<e;n++){let s=t.charAt(n);if(i>=0){if(s===";"){let a=t.substring(i+1,n);switch(a){case"lt":r.push("<");break;case"gt":r.push(">");break;case"quot":r.push('"');break;case"apos":r.push("'");break;case"amp":r.push("&");break;default:if(a.charAt(0)==="#"){let o=parseInt(a.substring(1));r.push(String.fromCharCode(o))}else r.push("&"+a+";")}i=-1}}else s==="&"?i=n:r.push(s)}return i>=0&&r.push(t.substring(i)),r.join("")}static addAll(t,e){for(let r of e)t.push(r)}static addAllSet(t,e){for(let r of e)t.add(r)}static contains(t,e){for(let r of t)if(r.equals(e))return!0;return!1}static equals(t,e){if(t.length==e.length){for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}else return!1}static remove(t,e){let r=0,i=t.length;for(let n=0;n<i;n++)t[n]===e&&(t.splice(n,1),n--,i--,r++);return r}static getUrlVars(){for(var t={},e=location.href.slice(location.href.indexOf("?")+1).split("&"),r=0;r<e.length;r++){var i=e[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}static prefix(){if(!KB){let t=this.getUrlVars().version;t?KB="/analyzer/v"+t:KB="/analyzer"}return KB}static add2objS(t,e,r){if(e in t)return t[e];{let i=r(e);return t[e]=i,i}}static downloadFile(t,e){let r=document.createElement("a"),i=URL.createObjectURL(e);r.download=t,r.href=i,r.click(),URL.revokeObjectURL(i)}static uuid(){let t=new Array;e4[0]=new Date().getTime(),t.push(t4[1].toString(16)),e4[0]=Math.random(),t.push(VG[3].toString(16));let e=VG[2].toString(16);t.push("4"+e.substr(0,3)),e4[0]=performance.now();let r=t4[0].toString(16)+t4[1].toString(16);return t.push("0"+r.substr(0,3)),t.push(r.substr(3)),t.join("-")}static funcCopy(t){return(0,eval)("("+t.toString()+")")}static NVL(...t){for(let e of t)if(e!==null)return e;return null}static isSingle(t){return Array.from(new Set(t)).length===t.length}},mme=[1,10,100,1e3];var JB=0,b1=0;function QG(t,e,r){return JB=Math.abs(t-e),r>=5&&JB>1e-5||isNaN(r)&&JB>1e-8?!1:JB<1e-13?!0:(b1=Math.min(zG(t),zG(e)),b1<10&&(b1=10),isNaN(r)||(b1=Math.min(b1,r)),XG(t,b1)===XG(e,b1))}var $B=0,ZB=0;function zG(t){return $B=0,ZB=0,t>0?$B=t-Math.floor(t):$B=t-Math.ceil(t),ZB=($B.toString()||"").length,ZB>2?ZB-2:0}function XG(t,e,r){if(typeof t!="number"&&(t=+t),isNaN(t))return NaN;if(e=e|0,e<=0||!t&&!r)return Math.round(t);var i=mme[e]||Math.pow(10,e)||10;if(r){var n=t<0?"-":"";for(t=t<0?-t:t,t=Math.round(t*i)+"";t.length<=e;)t="0"+t;return t=t.slice(0,-e)+"."+t.slice(-e),parseFloat(n+t)}else return Math.round(t*i+1e-10)/i}var gme=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.PERCENT=1]="PERCENT",t[t.LEFT_PAD0=2]="LEFT_PAD0",t))(gme||{}),yme=/(\.?0+)$/,o2=class{static format(t,...e){return this.format1(t,e)}static format1(t,e){let r=this._format(t,e);if(typeof r=="string")return r;throw new Error(this.format("Invalid state on (%d) %s",r,t))}static _format(t,e){let r=[],i=0,n=0,s,a=0,o=0;for(let l=0;l<t.length;l++){let c=t.charAt(l),u=c.charCodeAt(0);switch(i){case 0:u===37?i=1:r.push(c);break;case 1:switch(u){case 100:if(s=e[n++],typeof s=="number")r.push(s.toFixed(0)),i=0;else return l;break;case 102:if(s=e[n++],typeof s=="number")r.push(s.toString()),i=0;else return l;break;case 120:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16)),i=0;else return l;break;case 88:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16).toUpperCase()),i=0;else return l;break;case 115:case 99:s=e[n++],r.push(s===null?"null":s.toString()),i=0;break;case 48:a=l+1,o=-1,i=2;break;case 37:r.push("%"),i=0;break;default:return l}break;case 2:switch(u){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=l;break;case 120:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(su.lpad((s|0).toString(16),"0",d)),i=0;else return l}else return l;break;case 88:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(su.lpad((s|0).toString(16).toUpperCase(),"0",d)),i=0;else return l}else return l;break;default:return l}break;default:return l}}return r.join("")}static startsWith(t,e){return t.length>=e.length?t.substring(0,e.length)===e:!1}static endsWith(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}static split(t,e){let r=new Array,i=0;for(;;){let n=t.exec(e);if(n!==null){let s=t.lastIndex-n[0].length;r.push(e.substring(i,s)),i=t.lastIndex}else{let s=e.substring(i);Ca.nullOrEmpty(s)||r.push(s);break}}return r}static fmtNumber(t){return t.toFixed(5).replace(yme,"")}},Ca=class{static rgb(t){if(0<=t&&t<=255)return t;throw new Error(o2.format("RGB should not nagative and not over 255(0xFF): %X",t))}static normal(t){if(isFinite(t))return t;throw new Error(o2.format("%f is not permitted",t))}static positiveOr0(t){if(t>=0)return t;throw new Error(o2.format("%f must >= 0",t))}static positive(t){if(t>0)return t;throw new Error(o2.format("%f must > 0",t))}static notnull(t){if(t!=null)return t;throw new Error("invalid null value")}static mustnull(t){if(t===null)return null;throw new Error("value must be null")}static notEmpty(t){if(t==null||t.length===0)throw new Error("invalid empty string");return t}static nullOrEmpty(t){return t==null||t.length===0}static notNullOrUndef(t){if(t!=null)return t;throw new Error("null or undefined is not permitted")}},P1,vt=(P1=class{static regular(e){return Math.round(e*this.precision)/this.precision}static eq(e,r){return Math.abs(e-r)<=this.eps}static neq(e,r){return Math.abs(e-r)>this.eps}static less(e,r){return e-r<-this.eps}static lesseq(e,r){return e-r<=this.eps}static greater(e,r){return e-r>this.eps}static greatereq(e,r){return e-r>=-this.eps}static sqrt(e){return Math.abs(e)<=1e-10?0:Math.sqrt(e)}static sortAsc(e,r){return e-r}static sortDesc(e,r){return r-e}},P1.eps=1e-8,P1.precision=1e8,P1);function d2(t,e){_D(t.iterator(),e)}function _D(t,e){let r=0;for(;t.hasNext();){let i=t.next();e(r++,i)}}var bme=class{constructor(t){this.idx=-1,this.lst=t}hasNext(){return this.idx<this.lst.length-1}next(){if(this.idx<this.lst.length-1)return this.idx++,this.lst[this.idx];throw new Error("bug")}};function v4(t){return new bme(t)}var Ul,Ii=(Ul=class{static toDegrees(e){return e*180/Math.PI}static toRadians(e){return e/180*Math.PI}static regularD(e){return e=e%360,e=e<0?360+e:e,e===360?0:e}static regular(e){return e=e%Ul.PIx2,e=e<0?Ul.PIx2+e:e,e===Ul.PIx2?0:e}static toQuarterBase(e){return Ul.regular((e+Ul.PI_4)/Ul.PI_2*Ul.PI_2)}static toQuarterBaseD(e){return Ul.regularD(((e+45)/90|0)*90)}static transformD(e,r){return Ul.toDegrees(Ul.transform(Ul.toRadians(e),r))}static transform(e,r){let i=Math.cos(e),n=Math.sin(e),s=new We(r.data[6],r.data[7]),a=new We(i,n).multiply3(r);return Ul.regular(a.angle(s))}},Ul.PIx2=Math.PI*2,Ul.PI_2=Math.PI/2,Ul.PI_4=Math.PI/4,Ul),so=class{static dotProd1(t,e,r,i){return t*r+e*i}static dotProd2(t,e,r,i,n,s){return this.dotProd1(r-t,i-e,n-r,s-i)}static dotProd3(t,e,r){return this.dotProd2(t.x,t.y,e.x,e.y,r.x,r.y)}static crossProd1(t,e,r,i){return t*i-e*r}static crossProd2(t,e,r,i,n,s){return this.crossProd1(r-t,i-e,n-r,s-i)}static crossProd3(t,e,r){return this.crossProd2(t.x,t.y,e.x,e.y,r.x,r.y)}static distance2(t,e,r,i){let n=r-t,s=i-e;return n*n+s*s}static distance1(t,e,r,i){return this.hypot(r-t,i-e)}static distance1p(t,e){return this.distance1(t.x,t.y,e.x,e.y)}static hypot(t,e){if(t=Math.abs(t),e=Math.abs(e),e>t){var r=e;e=t,t=r}if(t===0)return e;var i=e/t;return t*Math.sqrt(1+i*i)}},ZY=new ArrayBuffer(16),qG=new Float64Array(ZY),eD=new Int32Array(ZY),kn,We=(kn=class{static sortByXAsc(e,r){return e.x-r.x}static sortByYAsc(e,r){return e.y-r.y}static sortByXYAsc(e,r){return e.x<r.x?-1:e.x>r.x?1:e.y-r.y}static caculateAngle(e,r){let i=Math.cos(e),n=Math.sin(e),s=i*r.data[0]+n*r.data[4],a=i*r.data[1]+n*r.data[5],o=new kn(s,a).normalize();return Math.atan2(o.y,o.x)}static normal(e,r,i){let n=r.sub(e),s=i.sub(r);return n.cross(s)}static getVector2(e){return new kn(Math.cos(e),Math.sin(e))}static getCrossPoint1(e,r,i,n){if(e.equals1(r)||i.equals1(n)||vt.eq(1,Math.abs(r.sub(e).normalize().dot(n.sub(i).normalize()))))return null;let s=r.y-e.y,a=e.x-r.x,o=r.x*e.y-e.x*r.y,l=n.y-i.y,c=i.x-n.x,u=n.x*i.y-i.x*n.y,d=s*c-l*a;return new kn((u*a-o*c)/d,(o*l-u*s)/d)}static getCrossPoint2(e,r,i,n){return this.getCrossPoint1(e,e.add(r),i,i.add(n))}constructor(e,r){this.x=Ca.normal(e),this.y=Ca.normal(r)}get hashed(){return this._hashed==null&&(qG[0]=this.x,qG[1]=this.y,this._hashed=eD[0]^eD[1]^eD[2]^eD[3]),this._hashed}dot(e){return this.x*e.x+this.y*e.y}length(){return Math.sqrt(this.dot(this))}getCos(){return this.x/this.length()}sub(e){var r=this.x-e.x,i=this.y-e.y;return new kn(r,i)}add(e){var r=this.x+e.x,i=this.y+e.y;return new kn(r,i)}div(e){return new kn(this.x/e,this.y/e)}add1(e,r){return new kn(this.x+e,this.y+r)}mul(e){return new kn(this.x*e,this.y*e)}cross(e){return this.x*e.y-this.y*e.x}getSin(){return this.y/this.length()}angle2(e){let r=this.y-e.y,i=this.x-e.x;return r=Math.abs(r-0)<10**-4?0:r,i=Math.abs(i-0)<10**-4?0:i,Math.atan2(r,i)}angleD2(e){return Ii.toDegrees(this.angle2(e))}angle(e){return Math.atan2(this.y-e.y,this.x-e.x)}angleX(e=kn.ORIGIN){let r=this.angle(e);return r<0&&(r=Math.PI*2+r),r}angleD(e){return Ii.toDegrees(this.angle(e))}distance1(e){let r=e.x-this.x,i=e.y-this.y;return so.hypot(r,i)}distance2(e){let r=e.x-this.x,i=e.y-this.y;return r*r+i*i}rotateD(e,r){return this.rotate(e,Ii.toRadians(r))}rotate(e,r){let i=Math.cos(r),n=Math.sin(r),s=this.x-e.x,a=this.y-e.y,o=s*i+a*-n,l=s*n+a*i;return e.add1(o,l)}multiply3(e){let r=this.x*e.data[0]+this.y*e.data[3]+e.data[6],i=this.x*e.data[1]+this.y*e.data[4]+e.data[7];return new kn(r,i)}multiply4(e){let r=this.x*e.data[0]+this.y*e.data[4]+e.data[12],i=this.x*e.data[1]+this.y*e.data[5]+e.data[13];return new kn(r,i)}hashCode(){return this.hashed}equals(e,r){return e instanceof kn?QG(e.x,this.x,r)&&QG(e.y,this.y,r):!1}equals1(e){return e?vt.eq(this.x,e.x)&&vt.eq(this.y,e.y):!1}equals2(e,r){return e instanceof kn?Math.abs(this.x-e.x)<=r&&Math.abs(this.y-e.y)<=r:!1}similarEquals(e,r=.5){return Math.abs(this.x*.1-e.x*.1)<=r&&Math.abs(this.y*.1-e.y*.1)<=r}toString(){return"Vector [X="+this.x+", Y="+this.y+"]"}bbox(){let e=this.x,r=this.y;return new nu(e,e,r,r)}normalize(){if(this.x===0&&this.y===0)return new kn(0,0);let e=this.x/this.length(),r=this.y/this.length();return new kn(e,r)}regular(e=1e-4){let r=Math.round(1/e);return new kn(Math.round(this.x*r)/r,Math.round(this.y*r)/r)}round(e=4){let r=10**(e|0);return new kn(Math.round(this.x*r)/r,Math.round(this.y*r)/r)}mirrorX(e=kn.ORIGIN){return new kn(this.x,2*e.y-this.y)}mirrorY(e=kn.ORIGIN){return new kn(2*e.x-this.x,this.y)}mirrorCenter(e=kn.ORIGIN){return new kn(2*e.x-this.x,2*e.y-this.y)}clone(){return new kn(this.x,this.y)}mirror(e=kn.ORIGIN){return new kn(2*e.x-this.x,2*e.y-this.y)}pointOnRays(e,r){let i=Ii.toRadians(e);return new kn(this.x+Math.cos(i)*r,this.y+Math.sin(i)*r)}pointOnRays2(e,r){let i=e.angle(this);return new kn(this.x+Math.cos(i)*r,this.y+Math.sin(i)*r)}scale(e){return new kn(this.x*e,this.y*e)}},kn.ORIGIN=new kn(0,0),kn.X_UNIT_VECTOR=new kn(1,0),kn.Y_UNIT_VECTOR=new kn(0,1),kn),xme=(t=>(t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT",t))(xme||{}),Eme=(t=>(t[t.TOP=0]="TOP",t[t.CENTER=1]="CENTER",t[t.BOTTOM=2]="BOTTOM",t))(Eme||{}),Oo,$m=(Oo=class{constructor(e,r){this.horizontal=e,this.vertical=r}},Oo.LT=new Oo(0,0),Oo.LC=new Oo(0,1),Oo.LB=new Oo(0,2),Oo.CT=new Oo(1,0),Oo.CC=new Oo(1,1),Oo.CB=new Oo(1,2),Oo.RT=new Oo(2,0),Oo.RC=new Oo(2,1),Oo.RB=new Oo(2,2),Oo),wme=(t=>(t[t.INNER=0]="INNER",t[t.OUTER=1]="OUTER",t[t.SEPARATED=2]="SEPARATED",t[t.INTERSECTED=3]="INTERSECTED",t[t.EQ=4]="EQ",t[t.INSIDE_TOUCHED=5]="INSIDE_TOUCHED",t[t.OUTSIDE_TOUCHED=6]="OUTSIDE_TOUCHED",t))(wme||{}),vh=class{constructor(){this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY}ext1(t){return this.minX=Math.min(this.minX,t.minX),this.maxX=Math.max(this.maxX,t.maxX),this.minY=Math.min(this.minY,t.minY),this.maxY=Math.max(this.maxY,t.maxY),this}ext2(t){return this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y),this}ext3(t){for(let e=0;e<t.length;e++){let r=t[e];this.ext2(r)}return this}ext4(t){return d2(t,(e,r)=>(this.ext2(r),!0)),this}ext5(t,e,r,i){return this.minX=Math.min(this.minX,t),this.maxX=Math.max(this.maxX,e),this.minY=Math.min(this.minY,r),this.maxY=Math.max(this.maxY,i),this}ext6(t,e){return this.minX=Math.min(this.minX,t),this.maxX=Math.max(this.maxX,t),this.minY=Math.min(this.minY,e),this.maxY=Math.max(this.maxY,e),this}ext7(t){if(t<0){let e=t*2;if(e<this.minX-this.maxX||e<this.minY-this.maxY)throw new Error("")}return this.minX-=t,this.maxX+=t,this.minY-=t,this.maxY+=t,this}ext8(t){let e=[];for(let r=0;r<t.length;r+=2)e.push(new We(t[r],t[r+1]));return this.ext3(e)}ext9(t,e,r,i){return this.minX=Math.min(this.minX,t),this.maxX=Math.max(this.maxX,t+r),this.minY=Math.min(this.minY,e),this.maxY=Math.max(this.maxY,e+i),this}ext10({x:t,y:e,width:r,height:i}){return this.ext9(t,e,r,i)}valid(){return isFinite(this.minX)&&isFinite(this.maxX)&&isFinite(this.minY)&&isFinite(this.maxY)}clear(){this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY}build(){return new nu(this.minX,this.maxX,this.minY,this.maxY)}build1(){return this.valid()?new nu(this.minX,this.maxX,this.minY,this.maxY):new nu(0,0,0,0)}},Fv=new Float64Array(4),nu=class CA{static extendRect({x:e,y:r,width:i,height:n}){return new CA(e,e+i,r,r+n)}static extend1(e,r){if(e===null)return new CA(r.x,r.x,r.y,r.y);{let i=Math.min(e.minX,r.x),n=Math.max(e.maxX,r.x),s=Math.min(e.minY,r.y),a=Math.max(e.maxY,r.y);return new CA(i,n,s,a)}}static extend2(e,r){if(e){let i=Math.min(e.minX,r.minX),n=Math.max(e.maxX,r.maxX),s=Math.min(e.minY,r.minY),a=Math.max(e.maxY,r.maxY);return new CA(i,n,s,a)}else return r}static extend3(e,r){let i=Math.min(e.x,r.x),n=Math.max(e.x,r.x),s=Math.min(e.y,r.y),a=Math.max(e.y,r.y);return new CA(i,n,s,a)}static extend4(e,r,i){return new CA(e.x-r/2,e.x+r/2,e.y-i/2,e.y+i/2)}constructor(e,r,i,n){if(this.minX=Ca.normal(e),this.maxX=Ca.normal(r),this.minY=Ca.normal(i),this.maxY=Ca.normal(n),e>r||i>n)throw new Error(`min > max is not permitted: [${e}, ${r}, ${i}, ${n}]`)}get data(){return Fv[0]=this.minX,Fv[1]=this.maxX,Fv[2]=this.minY,Fv[3]=this.maxY,Fv}isContains(e){return this.isContains1(e.x,e.y)}points(){return[this.LL(),this.LR(),this.UR(),this.UL(),this.LL()]}isContains1(e,r){return this.isContainsX(e)&&this.isContainsY(r)}isContains2(e,r){return this.isContainsX1(e)&&this.isContainsY1(r)}isContainsX(e){return e>=this.minX&&e<=this.maxX}isContainsX1(e){return vt.greatereq(e,this.minX)&&vt.lesseq(e,this.maxX)}isContainsY(e){return e>=this.minY&&e<=this.maxY}isContainsY1(e){return vt.greatereq(e,this.minY)&&vt.lesseq(e,this.maxY)}isIntersect(e){return!(this.maxX<e.minX||this.minX>e.maxX||this.maxY<e.minY||this.minY>e.maxY)}extendOfSize(e){return Ca.positiveOr0(this.maxX-this.minX+e*2),Ca.positiveOr0(this.maxY-this.minY+e*2),new CA(this.minX-e,this.maxX+e,this.minY-e,this.maxY+e)}isInside(e){return this.minX>=e.minX&&this.maxX<=e.maxX&&this.minY>=e.minY&&this.maxY<=e.maxY}isContainsBBox(e){return this.maxX>=e.maxX&&this.minX<=e.minX&&this.maxY>=e.maxY&&this.minY<=e.minY}isContainsBBox1(e){return vt.greatereq(this.maxX,e.maxX)&&vt.lesseq(this.minX,e.minX)&&vt.greatereq(this.maxY,e.maxY)&&vt.lesseq(this.minY,e.minY)}intersect(e){let r=Math.max(this.minX,e.minX),i=Math.min(this.maxX,e.maxX);if(r>i)return null;let n=Math.max(this.minY,e.minY),s=Math.min(this.maxY,e.maxY);return n>s?null:new CA(r,i,n,s)}intersection1(e){let r=Math.max(this.minX,e.minX),i=Math.min(this.maxX,e.maxX);if(vt.greater(r,i))return null;r>i&&(i=r);let n=Math.max(this.minY,e.minY),s=Math.min(this.maxY,e.maxY);return vt.greater(n,s)?null:(n>s&&(s=n),new CA(r,i,n,s))}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}UL(){return new We(this.minX,this.maxY)}UR(){return new We(this.maxX,this.maxY)}LL(){return new We(this.minX,this.minY)}LR(){return new We(this.maxX,this.minY)}center(){return new We(this.maxX-(this.maxX-this.minX)/2,this.maxY-(this.maxY-this.minY)/2)}area(){return this.width()*this.height()}transform(e){let r=new vh;return r.ext2(this.LL().multiply3(e)),r.ext2(this.LR().multiply3(e)),r.ext2(this.UR().multiply3(e)),r.ext2(this.UL().multiply3(e)),r.build()}transform4(e){let r=new vh;return r.ext2(this.LL().multiply4(e)),r.ext2(this.LR().multiply4(e)),r.ext2(this.UR().multiply4(e)),r.ext2(this.UL().multiply4(e)),r.build()}isSeparated(e){if(e==null||e==null)return!1;let r;this.minX>=e.minX?r=this.minX:r=e.minX;let i;if(this.maxX<=e.maxX?i=this.maxX:i=e.maxX,r>i)return!0;{let n;this.minY>=e.minY?n=this.minY:n=e.minY;let s;return this.maxY<=e.maxY?s=this.maxY:s=e.maxY,n>s}}relation(e){let r=0,i=0,n;this.minX>e.minX?(r++,n=this.minX):this.minX===e.minX?n=this.minX:(i++,n=e.minX);let s;if(this.maxX<e.maxX?(r++,s=this.maxX):this.maxX===e.maxX?s=this.maxX:(i++,s=e.maxX),n>s)return 2;{let a;this.minY>e.minY?(r++,a=this.minY):this.minY===e.minY?a=this.minY:(i++,a=e.minY);let o;return this.maxY<e.maxY?(r++,o=this.maxY):this.maxY===e.maxY?o=this.maxY:(i++,o=e.maxY),a>o?2:r===4?0:i===4?1:r===0&&i===0?4:n===s||a===o?6:r!==i?5:3}}zoom(e){let r=this.width(),i=this.height(),n=this.center();return e!=0&&(r/=e/2,i/=e/2),new CA(n.x-r,n.x+r,n.y-r,n.y+r)}toString(){return"BBox [minX="+this.minX+", maxX="+this.maxX+", minY="+this.minY+", maxY="+this.maxY+"]"}equals(e){return this.minY==e.minY&&this.minX==e.minX&&this.maxX==e.maxX&&this.maxY==e.maxY}extendSize(e,r){return Object.is(void 0,r)&&(r=e),CA.extend4(this.center(),this.width()+e,this.height()+r)}positionOnBBox(e,r=0){let i=this.center(),n=this.width()*r/2,s=this.height()*r/2,a=e.x-i.x,o=e.y-i.y;return a>n?o>s?$m.RT:o<-s?$m.RB:$m.RC:a<-n?o>s?$m.LT:o<-s?$m.LB:$m.LC:o>s?$m.CT:o<-s?$m.CB:$m.CC}bbox(){return this}},PD=class Yn{static mul(e,r,i,n,s,a){let o=0,l=0;for(let c=0;c<e;c++){for(let u=0;u<i;u++){let d=u,A=0;for(let h=0;h<r;h++)A+=n[l+h]*s[d],d+=i;a[o++]=A}l+=r}}constructor(e,r,i){this.m=Ca.normal(e),this.n=Ca.normal(r);let n=e*r;if(i.length===n){for(let s=0;s<i.length;s++)Ca.normal(i[s]);this.data=i}else throw new Error("invalid matrix size")}mul(e){if(this.n===e.m){let r=new Array(this.m*e.n);return Yn.mul(this.m,this.n,e.n,this.data,e.data,r),new Yn(this.m,e.n,r)}else throw new Error("m !== p")}toString(){let e=[];e.push("Matrix ("),e.push(this.m.toString()),e.push(" x "),e.push(this.n.toString()),e.push(")");let r=0;for(let i=0;i<this.m;i++)for(let n=0;n<this.n;n++){let s=this.data[r++].toString();n===0?(e.push(`
`),e.push("	"),e.push(s)):(e.push(", "),e.push(s))}return e.join("")}static on(e,r,i){return e*r+i}initExpandMatrix(e){let r=this.m,i=this.n,n=i*2,s=new Array(r*n);for(let a=0;a<r;a++)for(let o=0;o<n;o++)o<i?s[Yn.on(n,a,o)]=e[Yn.on(i,a,o)]:o===r+a?s[Yn.on(n,a,o)]=1:s[Yn.on(n,a,o)]=0;return s}inverseMatrix(e,r,i){for(let n=0;n<r;n++){let s=e[Yn.on(i,n,n)];for(let a=0;a<i;a++)e[Yn.on(i,n,a)]/=s}return e}getMatrixRank(e,r,i){let n=Math.min(r,i);for(let s=0;s<r;s++){if(e[Yn.on(i,s,s)]===0){let a=new Array(i),o;for(o=s;o<r;o++)if(e[Yn.on(i,o,s)]!==0){su.arraycopy(e,Yn.on(i,o,0),a,0,i),su.arraycopy(e,Yn.on(i,s,0),e,Yn.on(i,o,0),i),su.arraycopy(a,0,e,Yn.on(i,s,0),i);break}o>=r&&(n-=1)}if(!(n<r))for(let a=0;a<r;a++){if(a===s)continue;let o=e[Yn.on(i,a,s)]/e[Yn.on(i,s,s)];for(let l=0;l<i;l++)e[Yn.on(i,a,l)]-=e[Yn.on(i,s,l)]*o}}return n}getInverseMatrix(){if(this.m!==this.n)throw new Error("The matrix is an "+this.m+"x"+this.n+" order matrix, non-square matrix, please check!");function e(a){return vt.lesseq(Math.abs(a),0)}let r=this.initExpandMatrix(this.data.slice(0)),i=this.n*2;function n(a,o){for(let l=0;l<i;l++){let c=r[Yn.on(i,a,l)];r[Yn.on(i,a,l)]=r[Yn.on(i,o,l)],r[Yn.on(i,o,l)]=c}}for(let a=0;a<this.m;a++){let o=Math.abs(r[Yn.on(i,a,a)]),l=a;if(e(r[Yn.on(i,a,a)]))for(let u=a+1;u<this.m;u++){if(e(r[Yn.on(i,u,a)])){Math.abs(r[Yn.on(i,u,a)])>o&&(o=Math.abs(r[Yn.on(i,u,a)]),l=u);continue}n(a,u);break}if(e(r[Yn.on(i,a,a)])){if(o===0)throw new Error("The matrix is a non-full rank matrix, please check!");console.warn("The matrix may be a non-full rank matrix, please check!"),l!==a&&n(a,l)}let c=1/r[Yn.on(i,a,a)];for(let u=0;u<i;u++)r[Yn.on(i,a,u)]*=c;for(let u=0;u<this.m;u++){if(a===u)continue;let d=r[Yn.on(i,u,a)];for(let A=a;A<i;A++)r[Yn.on(i,u,A)]-=r[Yn.on(i,a,A)]*d}}let s=[];for(let a=0;a<this.m;a++)for(let o=this.n;o<i;o++)s[Yn.on(this.n,a,o-this.n)]=r[Yn.on(i,a,o)];return new Yn(this.m,this.n,s)}getTransposeMatrix(){let e=new Array(this.data.length);for(let r=0;r<this.m;r++)for(let i=0;i<this.n;i++)e[i*this.n+r]=this.data[r*this.m+i];return new Yn(this.n,this.m,e)}hashCode(){let e=0;for(let r of this.data)e+=r;return e}equals(e){return this===e?!0:e===null?!1:e instanceof Yn?!(this.m!=e.m||this.n!=e.n||!su.equals(this.data,e.data)):!1}},vme=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$s,eV=($s=class extends PD{static translate(e,r,i){return new $s([1,0,0,0,0,1,0,0,0,0,1,0,e,r,i,1])}static translate1(e){return new $s([1,0,0,0,0,1,0,0,0,0,1,0,e.x,e.y,e.z,1])}static rotateX(e){let r=Math.cos(e),i=Math.sin(e);return new $s([1,0,0,0,0,r,i,0,0,-i,r,0,0,0,0,1])}static rotateY(e){let r=Math.cos(e),i=Math.sin(e);return new $s([r,0,-i,0,0,1,0,0,i,0,r,0,0,0,0,1])}static rotateZ(e){let r=Math.cos(e),i=Math.sin(e);return new $s([r,i,0,0,-i,r,0,0,0,0,1,0,0,0,0,1])}static rotateAxis(e,r){e=e.normalize();let i=e.x,n=e.y,s=e.z,a=Math.sin(r),o=Math.cos(r);return new $s([i*i*(1-o)+o,i*n*(1-o)+s*a,i*s*(1-o)-n*a,0,i*n*(1-o)-s*a,n*n*(1-o)+o,n*s*(1-o)+i*a,0,i*s*(1-o)+n*a,n*s*(1-o)-i*a,s*s*(1-o)+o,0,0,0,0,1])}static scale(e,r=e,i=e){return new $s([e,0,0,0,0,r,0,0,0,0,i,0,0,0,0,1])}static flipX(){return new $s([1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])}static flipY(){return new $s([-1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}static rotateZForPoint(e,r){return e.equals1(We.ORIGIN)?$s.rotateZ(r):$s.translate(-e.x,-e.y,0).rotateZ(r).translate1(e.x,e.y,0)}static getMatrix4(e,r,i,n){let s=Math.cos(r),a=Math.sin(r),o=i*(e.x*s-e.y*a)+n.x,l=e.x*a+e.y*s+n.y,c=[i*s,a,0,0,-a*i,s,0,0,0,0,1,0,o,l,0,1];return new $s(c)}constructor(e=vme){super(4,4,e)}translate(e){return this.multiply4($s.translate1(e))}translate1(e,r,i){return this.multiply4($s.translate(e,r,i))}rotateX(e){return this.multiply4($s.rotateX(e))}rotateY(e){return this.multiply4($s.rotateY(e))}rotateZ(e){return this.multiply4($s.rotateZ(e))}scale(e,r=e,i=e){return this.multiply4($s.scale(e,r,i))}scale1(e){return this.multiply4($s.scale(e.x,e.y,e.z))}setOrigin(e,r,i){return $s.translate(-e,-r,-i).multiply4(this).translate1(e,r,i)}setOrigin1(e){return this.setOrigin(e.x,e.y,e.z)}multiply4(e){let r=new Array(16);return PD.mul(4,4,4,this.data,e.data,r),new $s(r)}getInverseMatrix(){let e=super.getInverseMatrix();return new $s(e.data)}getTransposeMatrix(){let e=super.getTransposeMatrix();return new $s(e.data)}inverse(){let e=this.getInverseMatrix();return new $s(e.data)}toMatrix3(){let e=this.data;return new as([e[0],e[1],0,e[4],e[5],0,e[12],e[13],1])}},$s.ORIGIN=new $s,$s);function Uv(t){return $Y.normal(parseFloat(t))}var Cme=[1,0,0,0,1,0,0,0,1],Bs,as=(Bs=class extends PD{static translate(e,r){return new Bs([1,0,0,0,1,0,e,r,1])}static translate1(e){return this.translate(e.x,e.y)}static rotate(e){let r=Math.cos(e),i=Math.sin(e);return new Bs([r,i,0,-i,r,0,0,0,1])}static rotateD(e){return this.rotate(Ii.toRadians(e))}static scale(e,r=e){return new Bs([e,0,0,0,r,0,0,0,1])}static scale1(e,r){return new Bs([e,0,0,0,r,0,0,0,1])}static toDOMMatrix(e){let[r,i,,n,s,,a,o]=e.data;return`matrix(${[r,i,n,s,a,o].join(",")})`}static svgTrasform(e){let r=e.split(" "),i=null;return r.forEach(n=>{n=n.trim();let s=n.trim().replace(")","").split("("),a=s[0],o=s[1].split(",");switch(a){case"translate":let l=Uv(o[0]),c=Uv(o[1]);i=i?i.translate(l,c):Bs.translate(l,c);break;case"rotate":let u=Uv(o[0]),d=Uv(o[1]),A=Uv(o[2]);i=i?i.setOrigin(d,A):Bs.translate(d,A),i=i.rotateD(u);break;default:return}}),i}constructor(e=Cme){super(3,3,e);let r=e[0],i=e[3],n=e[1],s=e[4];this.iScale=Math.sqrt(r*r+n*n),this.jScale=Math.sqrt(i*i+s*s)}isMirrored(){return this.det()<0}multiply3(e){let r=new Array(9);return PD.mul(3,3,3,this.data,e.data,r),new Bs(r)}translate(e,r){return this.multiply3(Bs.translate(e,r))}translate1(e){return this.multiply3(Bs.translate1(e))}scale(e,r=e){return this.multiply3(Bs.scale(e,r))}scale1(e,r){return this.multiply3(Bs.scale1(e,r))}det(){return this.data[0]*this.data[4]-this.data[3]*this.data[1]}invert(){let e=this.getInverseMatrix();return new Bs(e.data)}rotateD(e){return this.multiply3(Bs.rotateD(e))}rotate(e){return this.multiply3(Bs.rotate(e))}resetOffset(){let e=this.data;return new Bs([e[0],e[1],0,e[3],e[4],0,0,0,1])}setOrigin(e,r){return Bs.translate(-e,-r).multiply3(this).translate(e,r)}setOrigin1(e){return this.setOrigin(e.x,e.y)}getInverseMatrix(){return new Bs(super.getInverseMatrix().data)}getTransposeMatrix(){let e=super.getTransposeMatrix();return new Bs(e.data)}toMatrix4(){let e=this.data;return new eV([e[0],e[1],0,e[2],e[3],e[4],0,e[5],0,0,1,0,e[6],e[7],0,e[8]])}scaleNum(e){return!e||isNaN(e)?e:e*this.iScale}},Bs.ORIGIN=new Bs,Bs.MIRROR_Y=new Bs([1,0,0,0,-1,0,0,0,1]),Bs.MIRROR_X=new Bs([-1,0,0,0,1,0,0,0,1]),Bs.ROT_90=new Bs([0,1,0,-1,0,0,0,0,1]),Bs.ROT_N90=new Bs([0,-1,0,1,0,0,0,0,1]),Bs),Sme=(t=>(t[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE",t))(Sme||{}),_0=(t=>(t[t.CW=0]="CW",t[t.CCW=1]="CCW",t))(_0||{}),yC=class{},C4=class zv{constructor(e,r,i){this.p1=e,this.p2=r,this.p3=i}barycentre(){return zv.barycentre(this.p1,this.p2,this.p3)}incentre(){return zv.incentre(this.p1,this.p2,this.p3)}static barycentre(e,r,i){let n=e.x+r.x+i.x,s=e.y+r.y+i.y;return new We(n/3,s/3)}static incentre(e,r,i){let n=r.sub(i).length(),s=e.sub(i).length(),a=e.sub(r).length(),o=n+s+a,l=n*e.x+s*r.x+a*i.x,c=n*e.y+s*r.y+a*i.y;return new We(l/o,c/o)}area(){return zv.area(this.p1,this.p2,this.p3)}static area(e,r,i){return this.area2(e.x,e.y,r.x,r.y,i.x,i.y)/2}static area2(e,r,i,n,s,a){return Math.abs(so.crossProd2(e,r,i,n,s,a))}scale(e,r){let i=as.translate(-e.x,-e.y).scale(r).translate1(e),n=this.p1.multiply3(i),s=this.p2.multiply3(i),a=this.p3.multiply3(i);return new zv(n,s,a)}scaleOnBarycentre(e){return this.scale(this.barycentre(),e)}scaleOnIncentre(e){return this.scale(this.incentre(),e)}extend(e){let r=this.incentre(),i=this.p1.add(this.p2).sub(r).scale(1/2),n=i.length(),s=We.ORIGIN.pointOnRays2(i,n+e).length()/n;return this.scaleOnIncentre(s)}container(e){let r=this.p3.sub(this.p1),i=this.p2.sub(this.p1),n=e.sub(this.p1),s=r.dot(r),a=r.dot(i),o=r.dot(n),l=i.dot(i),c=i.dot(n),u=1/(s*l-a*a),d=(l*o-a*c)*u;if(d<0||d>1)return!1;let A=(s*c-a*o)*u;return A<0||A>1?!1:d+A<=1}};function tD(){return{minDistance:Number.POSITIVE_INFINITY,start:null,end:null}}var Ff=class D0{static getMinDistanceWithoutCross(e,r){let i=tD();return D0.minLine(e,r,i),i.minDistance}static getMinDistance(e,r){return IA(e,r)?0:this.getMinDistanceWithoutCross(e,r)}static getMinLineWithCross(e,r){let i=tD();return D0.minLine(e,r,i),new Ge(i.start,i.end)}static getMinLine(e,r){return D0.intersection(e,r)||this.getMinLineWithCross(e,r)}static getMinDistanceFromPoint(e,r){let i=tD();if(r instanceof Ge)this.point2LineMinLine(i,r,e);else if(r instanceof gt)this.point2ArcMinDistance(e,r,i);else throw new Error("not support");return i.minDistance}constructor(e,r){if(this.pt1=e,this.pt2=r,this.minline=D0.intersection(e,r),this.minline)this.minDistance=0;else{let i=tD();D0.minLine(e,r,i),this.minline=new Ge(i.start,i.end),this.minDistance=i.minDistance}}getDistance(){return this.minDistance}getLine(){return this.minline}static intersection(e,r){let i=IA(e,r);if(i===0)return;let n=new Array;for(let s=0;s<i;s+=2){let a=new We(De[s],De[s+1]);n.push(a)}return n.length>1?new Ge(n[0],n[1]):new Ge(n[0],n[0])}static minLine(e,r,i){if(e instanceof Ge&&r instanceof Ge)return this.minDistanceForLines(e,r,i);if(e instanceof gt&&r instanceof Ge)return this.minDistanceForLineAndArc(e,r,i);if(e instanceof Ge&&r instanceof gt)return this.minDistanceForLineAndArc(r,e,i);if(e instanceof gt&&r instanceof gt)return this.minDistanceForArcs(e,r,i);throw new Error("not support")}static minDistanceForLines(e,r,i){[e.start(),e.end(),r.start(),r.end()].forEach((n,s)=>{s<2?this.point2LineMinLine(i,r,n):this.point2LineMinLine(i,e,n)})}static minDistanceForLineAndArc(e,r,i){this.point2LineMinLine(i,r,e.start()),this.point2LineMinLine(i,r,e.svgEnd);let n=D0.foot(r,e.center);r.bbox().extendOfSize(1e-8).isContains(n)&&this.point2ArcMinLine(i,e,n),this.point2ArcMinLine(i,e,r.start()),this.point2ArcMinLine(i,e,r.end())}static minDistanceForArcs(e,r,i){this.concentricArc(e,r,i),this.point2ArcMinDistance(r.start(),e,i),this.point2ArcMinDistance(r.svgEnd,e,i),this.point2ArcMinDistance(e.start(),r,i),this.point2ArcMinDistance(e.svgEnd,r,i),(Of(e,r.center)||Of(r,e.center))&&this.shortestLineForArcs(e,r,i)}static minLineForArcAndLine(e,r,i){let n=e.pointOn(i.angleD(e.center)),s=e.pointOn(e.center.angleD(i));this.arcShortestLine(e,r,i,n),this.arcShortestLine(e,r,i,s)}static arcInnerLineFootSegment(e,r,i){let n=i.distance1(e.center);if(n!==0){let s=e.rx*(i.y-e.center.y)/n+e.center.y,a=e.rx*(i.x-e.center.x)/n+e.center.x;n=e.rx-n,n<r.minDistance&&(r.minDistance=n,r.start=new We(a,s),r.end=i)}else n=e.rx-n,n<r.minDistance&&(r.minDistance=n,r.start=e.start(),r.end=i)}static shortestLineForArcs(e,r,i){let n=e.center.angleD(r.center),s=r.center.angleD(e.center),a=e.pointOn(n),o=e.pointOn(s),l=r.pointOn(n),c=r.pointOn(s);Of(e,a)&&(this.arcShortestLine(r,i,a,l),this.arcShortestLine(r,i,a,c)),Of(e,o)&&(this.arcShortestLine(r,i,o,l),this.arcShortestLine(r,i,o,c)),this.shortestLineForArcs1(e,r,i)}static shortestLineForArcs1(e,r,i){let n=r.start().sub(e.center).normalize(),s=r.end().sub(e.center).normalize(),a=e.start().sub(r.center).normalize(),o=e.end().sub(r.center).normalize(),l=e.center.add(n.mul(e.rx)),c=e.center.add(s.mul(e.rx)),u=r.center.add(a.mul(r.rx)),d=r.center.add(o.mul(r.rx));Of(e,l)&&vt.greater(r.start().distance2(e.center),0)&&this.arcShortestLine(e,i,r.start(),l),Of(e,c)&&vt.greater(r.end().distance2(e.center),0)&&this.arcShortestLine(e,i,r.end(),c),Of(r,u)&&vt.greater(e.start().distance2(r.center),0)&&this.arcShortestLine(r,i,e.start(),u),Of(r,d)&&vt.greater(e.end().distance2(r.center),0)&&this.arcShortestLine(r,i,e.end(),d)}static concentricArc(e,r,i){if(!(e.center.distance1(r.center)<1e-5&&e.rx===r.rx&&e.ry===r.ry))return;let n=e.start().distance1(r.svgEnd);n<i.minDistance&&(i.minDistance=n,i.start=e.start(),i.end=r.svgEnd),n=r.start().distance1(e.svgEnd),n<i.minDistance&&(i.minDistance=n,i.start=r.start(),i.end=e.svgEnd)}static point2ArcMinDistance(e,r,i){if(Of(r,e)){let n=r.pointOn(e.angleD(r.center)),s=r.pointOn(r.center.angleD(e));this.arcShortestLine(r,i,e,n),this.arcShortestLine(r,i,e,s)}else this.minLineSegment(i,r.start(),e),this.minLineSegment(i,r.svgEnd,e)}static point2ArcMinLine(e,r,i){if(Of(r,i)){let n=i.distance1(r.center);n>r.rx||n>r.ry?this.minLineForArcAndLine(r,e,i):this.arcInnerLineFootSegment(r,e,i)}}static point2LineMinLine(e,r,i){let n=D0.foot(r,i);r.bbox().extendOfSize(1e-8).isContains(n)?this.minLineSegment(e,n,i):(this.minLineSegment(e,r.start(),i),this.minLineSegment(e,r.end(),i))}static minLineSegment(e,r,i){let n=r.distance1(i);n<e.minDistance&&(e.minDistance=n,e.start=r,e.end=i)}static arcShortestLine(e,r,i,n){if(!Of(e,n))return;let s=i.distance1(n);s<r.minDistance&&(r.minDistance=s,r.start=i,r.end=n)}static foot(e,r){if(e.isPoint())return e.start();if(!vt.eq(e.b,0)&&!vt.eq(e.a,0)){let i=e.start(),n=e.direct,s=(r.x-i.x)*n.x+(r.y-i.y)*n.y;return new We(i.x+n.x*s,i.y+n.y*s)}else return vt.eq(e.b,0)&&!vt.eq(e.a,0)?new We(e.start().x,r.y):!vt.eq(e.b,0)&&vt.eq(e.a,0)?new We(r.x,e.start().y):r}};function Of(t,e){if(vt.eq(t.sweepAngle,360))return!0;let r=Ii.regularD(e.angleD(t.center));return t.sweepAngle>0?(vt.less(r,t.startAngle)&&(r+=360),vt.greatereq(t.endAngle(),r)):(vt.greater(r,t.startAngle)&&(r-=360),vt.lesseq(t.endAngle(),r))}var Tme=[1,10,100,1e3],WG="http://www.w3.org/2000/svg",KG="http://www.w3.org/1999/xlink",JG="http://www.w3.org/XML/1998/namespace",$G="https://easyeda.com/",b8e=(function(){var t={svg:WG,xlink:KG,xml:JG,c:$G};return t[WG]="svg",t[KG]="xlink",t[JG]="xml",t[$G]="c",t})();var Lo=(function(){var t={RATLINES:9,MODEL3D:19,ALL:11,TOPSILKLAYER:3,TOPLAYER:1,TOPPASTERLAYER:5,TOPSOLDERLAYER:7,LIBBODY:99,PADSURFACE:100,BOARDOUTLINE:10,DOCUMENT:12,TOPASSEMBLY:13,MECHANICAL:15,TOPCOMPONENT:16,SUBSTRATE:18},e;for(e=21;e<53;e++)t["INNER"+(e-20)]=e;for(t.BOTTOMSILKLAYER=4,t.BOTTOMLAYER=2,t.BOTTOMPASTERLAYER=6,t.BOTTOMSOLDERLAYER=8,t.BOTTOMASSEMBLY=14,t.BOTTOMCOMPONENT=17,e=53;e<85;e++)t["BOARD"+(e-52)]=e;return t})(),x8e=(function(){var t={COPPERAREA:[1,2,21,22,23,24],PLANEZONE:[1,2,21,22,23,24],RECT:[1,2,3,4,5,6,7,8,12,13,14,15,21,22,23,24,99],TRACK:[1,2,3,4,5,6,7,8,10,12,13,14,15,21,22,23,24,99],PAD:[11,1,2],VIA:[11],HOLE:[11],TEXT:[3,4,1,2,7,8,12,13,14,15,21,22,23,24],ARC:[1,2,3,4,5,6,7,8,10,12,13,14,15,21,22,23,24,99],ELLIPSE:[3,4,12,13,14,15],CIRCLE:[1,2,3,4,5,6,7,8,10,12,13,14,15,21,22,23,24,99],DIMENSION:[3,4,12,13,14,15],FOOTPRINT:[1,2],SOLIDREGION:[1,2,3,4,5,6,7,8,12,13,14,15,21,22,23,24,11,99,100],SVGNODE:[1,2,3,4,7,8,12,13,14,15],PROTRACTOR:[3,4,12,13,14,15],SHEET:[12,13,14,15]};t["3D"]=(function(){for(var n=[16,19,3,7,5,1],s=21;s<52;s++)n.push(s+32,s);return n.push(2,6,8,4,17),n})();var e,r,i;for(e in t)if(t.hasOwnProperty(e)&&(i=t[e],i.indexOf(21)>0&&i.indexOf(25)===-1))for(r=25;r<=52;r++)i.push(r);return t})(),lc=(function(){var t={1:"TopLayer",2:"BottomLayer",3:"TopSilkLayer",4:"BottomSilkLayer",5:"TopPasteMaskLayer",6:"BottomPasteMaskLayer",7:"TopSolderMaskLayer",8:"BottomSolderMaskLayer",9:"Ratlines",10:"BoardOutLine",11:"Multi-Layer",12:"Document",13:"TopAssembly",14:"BottomAssembly",15:"Mechanical",16:"TopComponents",17:"BottomComponents",18:"Substrate",19:"3DModel",99:"ComponentShapeLayer",100:"LeadShapeLayer"},e;for(e=21;e<53;e++)t[e]="Inner"+(e-20);for(e=53;e<85;e++)t[e]="Substrate"+(e-52);return t})(),E8e=(function(){var t=[],e=[];for(var r in Lo)if(Lo.hasOwnProperty(r)){if(r.match(/^BOARD\d+/))continue;t.push(Lo[r])}t.sort(),e.sort();var i={},n,s={21:"#999966",22:"#008000",23:"#00FF00",24:"#BC8E00",25:"#70DBFA",26:"#00CC66",27:"#9966FF",28:"#800080",29:"#008080",30:"#15935F",31:"#000080",32:"#00B400",33:"#2E4756",34:"#99842F",35:"#FFFFAA",36:"#99842F",37:"#2E4756",38:"#3535FF",39:"#8000BC",40:"#43AE5F",41:"#C3ECCE",42:"#728978",43:"#39503F",44:"#0C715D",45:"#5A8A80",46:"#2B937E",47:"#23999D",48:"#45B4E3",49:"#215DA1",50:"#4564D7",51:"#6969E9",52:"#9069E9"};t.forEach(function(o){switch(o){case Lo.TOPLAYER:n={name:lc[o],color:"#FF0000",darkColor:"#CC0000",visible:!0,active:!0,config:!0};break;case Lo.BOTTOMLAYER:n={name:lc[o],color:"#0000FF",darkColor:"#000080",visible:!0,active:!1,config:!0};break;case Lo.TOPSILKLAYER:n={name:lc[o],color:"#FFCC00",darkColor:"#806600",visible:!0,active:!1,config:!0};break;case Lo.BOTTOMSILKLAYER:n={name:lc[o],color:"#66CC33",darkColor:"#33661A",visible:!0,active:!1,config:!0};break;case Lo.TOPPASTERLAYER:n={name:lc[o],color:"#808080",darkColor:"#666666",visible:!0,active:!1,config:!0};break;case Lo.BOTTOMPASTERLAYER:n={name:lc[o],color:"#800000",darkColor:"#660000",visible:!0,active:!1,config:!0};break;case Lo.TOPSOLDERLAYER:n={name:lc[o],color:"#800080",darkColor:"#660066",visible:!0,active:!1,transparency:.3,config:!0};break;case Lo.BOTTOMSOLDERLAYER:n={name:lc[o],color:"#AA00FF",darkColor:"#8800CC",visible:!0,active:!1,transparency:.3,config:!0};break;case Lo.RATLINES:n={name:lc[o],color:"#6464FF",darkColor:"#5050CC",visible:!1,active:!1,config:!0};break;case Lo.BOARDOUTLINE:n={name:lc[o],color:"#FF00FF",darkColor:"#CC00CC",visible:!0,active:!1,config:!0};break;case Lo.ALL:n={name:lc[o],color:"#C0C0C0",darkColor:"#999999",visible:!0,active:!1,config:!0};break;case Lo.DOCUMENT:n={name:lc[o],color:"#FFFFFF",darkColor:"#CCCCCC",visible:!0,active:!1,config:!0};break;case Lo.TOPASSEMBLY:n={name:lc[o],color:"#33CC99",darkColor:"#33AA99",visible:!1,active:!1,config:!1};break;case Lo.BOTTOMASSEMBLY:n={name:lc[o],color:"#5555FF",darkColor:"#8888FF",visible:!1,active:!1,config:!1};break;case Lo.MECHANICAL:n={name:lc[o],color:"#F022F0",darkColor:"#F088F0",visible:!1,active:!1,config:!1};break;case Lo.MODEL3D:n={name:lc[o],color:"#66CCFF",visible:!1,active:!1,config:!1};break;case Lo.LIBBODY:n={name:lc[o],color:"#00CCCC",visible:!1,active:!1,config:!1};break;case Lo.PADSURFACE:n={name:lc[o],color:"#CC9999",visible:!1,active:!1,config:!1};break;default:o>=Lo.INNER1&&o<=Lo.INNER32?n={name:lc[o],color:s[o],darkColor:a(s[o]),visible:!1,active:!1,config:!1}:n=null;break}n&&(i[o]=n)}),i.Hole={config:!0,name:"Hole",darkColor:"#222222",color:"#222222"},i.DRCError={config:!0,name:"DRCError",color:"#FAD609",darkColor:"#FAD609"};function a(o){if(typeof o!="string"||!o.match(/#?([\da-f]{6})/i))return o;var l=parseInt(RegExp.$1,16),c=.5,u=Math.min(255,Math.round((l>>16)*c)),d=Math.min(255,Math.round((l>>8&255)*c)),A=Math.min(255,Math.round((l&255)*c)),h=((u<<16)+(d<<8)+A).toString(16);return"#"+("00000"+h).substr(-6).toUpperCase()}return i})(),ZG={BLANK:0,SCH:1,PART:2,PCB:3,FOOTPRINT:4,PRJ:5,SUBPART:6,SPICESYMBOL:7,SUBCKT:8,NETLIST:9,WAVEFORM:10,SCHLIB3D:11,PHOTOVIEW:12,SCHMODULE:13,PCBMODULE:14,VIEW3D:15,PCBLIB3D:16,BLOCK_SYMBOL:17,NETFLAG:18,NETPORT:19,SHEET_SYMBOL:20,NONEELEC_SYMBOL:21,SHORT_SYMBOL:22,FOOTPRINTVIEW:23,CNCPRINTVIEW:24,PCB2D:31,PCB3D:32},w8e=(function(){var t={};for(let e in ZG)t[ZG[e]]=e;return t})();var e_=Math.PI*2,LD=Math.PI/2,v8e=Math.sin(Math.PI/180);function Ime(t,e,r){if(typeof t!="number"&&(t=+t),isNaN(t))return NaN;if(e=e|0,e<=0||!t&&!r)return Math.round(t);var i=Tme[e]||Math.pow(10,e)||10;if(r){var n=t<0?"-":"";for(t=t<0?-t:t,t=Math.round(t*i)+"";t.length<=e;)t="0"+t;return t=t.slice(0,-e)+"."+t.slice(-e),parseFloat(n+t)}else return Math.round(t*i+1e-10)/i}function tV(t,e,r){var i=t-e;return r||(r=1e-10),(i>0?i:-i)<r}function Bme(t,e,r){var i=u(t)&&u(e)&&u(r);if(!i)return console.warn("Bad arguments"),null;var n=e.x-r.x>0?e.x:r.x,s=e.y-r.y>0?e.y:r.y,a=e.x-r.x>0?r.x:e.x,o=e.y-r.y>0?r.y:e.y,l=t.x,c=t.y;return l<=n+.001&&l>=a-.001&&c<=s+.001&&c>=o-.001;function u(d){return d?(d.x=Number(d.x),d.y=Number(d.y),isNaN(d.x)||isNaN(d.y)?(console.warn("Can not convert to Number, NaN found"),!1):!0):(console.warn("Empty input!"),!1)}}function Dme(t,e,r,i,n,s){var a=(n-r)*(t-r)+(s-i)*(e-i),o=(n-r)*(n-r)+(s-i)*(s-i),l=a/o,c=r+(n-r)*l,u=i+(s-i)*l;return a<=0?Math.sqrt((t-r)*(t-r)+(e-i)*(e-i)):a>=o?Math.sqrt((t-n)*(t-n)+(e-s)*(e-s)):Math.sqrt((t-c)*(t-c)+(u-e)*(u-e))}function _me(t,e,r){return Bme(t,e,r)?tV((t.x-e.x)*(r.y-e.y),(r.x-e.x)*(t.y-e.y),.001):!1}var Xv=1e-4,De=new Float64Array(100);function IA(t,e){if(t instanceof Ge&&e instanceof Ge)return Wp(t,e);if(t instanceof gt&&e instanceof Ge)return S4(t,e);if(t instanceof Ge&&e instanceof gt)return S4(e,t);if(t instanceof gt&&e instanceof gt)return iV(t,e);if(t instanceof br&&e instanceof br)return mD(t,e);if(t instanceof br&&e instanceof Ge)return mD(t,new br([e.start(),e.end()]));if(t instanceof Ge&&e instanceof br)return mD(new br([t.start(),t.end()]),e);if(t instanceof br&&e instanceof gt)return aY(e,t);if(t instanceof gt&&e instanceof br)return aY(t,e);throw new Error("not supported operation")}function Pme(t,e){let r=t.bbox();if(r.isContainsY1(e)){let i=new Ge(new We(r.minX-1,e),new We(r.maxX+1,e));return Wp(i,t)>0?1:0}else return 0}function Lme(t,e){if(t.rx===t.ry){let r=t.bbox();if(r.isContainsY1(e)){let i=new Ge(new We(r.minX-1,e),new We(r.maxX+1,e));return OD(t,i)>0?1:0}else return 0}else throw new Error("not supported operation")}function eY(t,e){let r=t.bbox();return r.isContainsY1(e)&&mD(new br([new We(r.minX-1,e),new We(r.maxX+1,e)]),t)>0?1:0}function tY(t,e,r){return isFinite(e)&&isFinite(r)?t.isContains2(e,r):!1}function Ome(t,e){let r=e.length(),i=so.crossProd3(e.start(),e.end(),t.start())/r,n=so.crossProd3(e.start(),e.end(),t.end())/r;return Math.abs(i)<1e-8||Math.abs(n)<1e-8||i*n<0}function Wp(t,e){let r=t.bbox().intersection1(e.bbox());if(!r)return 0;if(t.isPoint())if(e.isPoint()){let i=r.center();return De[0]=i.x,De[1]=i.y,2}else return rY(e,t,r);else{if(e.isPoint())return rY(t,e,r);{let i=function(b,E){r.isContains2(b,E)&&(De[g++]=b,De[g++]=E)};if(!Ome(t,e))return 0;let n=t.start().x,s=t.start().y,a=t.end().x,o=t.end().y,l=e.start().x,c=e.start().y,u=e.end().x,d=e.end().y,A=e.length(),h=so.crossProd2(n,s,l,c,u,d)/A,f=so.crossProd2(a,o,l,c,u,d)/A;if(h*f>0&&!vt.eq(h,0)&&!vt.eq(f,0))return 0;let p=t.length(),m=so.crossProd2(l,c,n,s,a,o)/p,y=so.crossProd2(u,d,n,s,a,o)/p;if(m*y>0&&!vt.eq(m,0)&&!vt.eq(y,0))return 0;let g=0;if(vt.eq(h,0)&&vt.eq(f,0)){let b=r.UL(),E=r.UR(),w=r.LL(),x=r.LR();if(vt.eq(r.width(),0))vt.eq(r.height(),0)?(De[g++]=b.x,De[g++]=b.y):(De[g++]=b.x,De[g++]=b.y,De[g++]=w.x,De[g++]=w.y);else if(vt.eq(r.height(),0))De[g++]=b.x,De[g++]=b.y,De[g++]=E.x,De[g++]=E.y;else{let I=C4.area2(b.x,b.y,l,c,u,d),C=C4.area2(E.x,E.y,l,c,u,d);I<C?(De[g++]=b.x,De[g++]=b.y,De[g++]=x.x,De[g++]=x.y):(De[g++]=E.x,De[g++]=E.y,De[g++]=w.x,De[g++]=w.y)}}else if(vt.eq(h,0))i(n,s);else if(vt.eq(f,0))i(a,o);else{let b=Math.abs(h/(h-f));i(n+(a-n)*b,s+(o-s)*b)}return g}}}function rY(t,e,r){let i=e.start(),n=e.end(),s=so.crossProd3(t.start(),t.end(),e.start()),a=so.crossProd3(t.start(),t.end(),e.end());if(s*a<0){let o=r.center();return De[0]=o.x,De[1]=o.y,2}else if(Math.abs(s)<Math.abs(a)){if(vt.eq(s/t.length(),0))return De[0]=i.x,De[1]=i.y,2}else if(vt.eq(a/t.length(),0))return De[0]=n.x,De[1]=n.y,2;return 0}function OD(t,e){let r=t.bbox().intersection1(e.bbox());if(r!=null){r=r.extendOfSize(Xv);let i=t.center.x,n=t.center.y,s=t.rx,a=t.rx2,o=e.start().x,l=e.start().y,c=e.end().x,u=e.end().y,d=t.center.distance1(e.start()),A=t.center.distance1(e.end()),h=vt.eq(d,s)?0:d>s?1:-1,f=vt.eq(A,s)?0:A>s?1:-1,p=0;if(h===-1&&f===-1)return 0;if(h===0&&f===0)De[p++]=o,De[p++]=l,De[p++]=c,De[p++]=u;else if(h===1&&f===1){let m=Ff.foot(e,t.center),y=m.distance1(t.center);if(vt.greater(y,s))return 0;if(vt.eq(y,s))vt.eq(e.distance2(t.start()),0)?(De[p++]=t.start().x,De[p++]=t.start().y,De[p++]=t.start().x,De[p++]=t.start().y):vt.eq(e.distance2(t.end()),0)?(De[p++]=t.end().x,De[p++]=t.end().y,De[p++]=t.end().x,De[p++]=t.end().y):(De[p++]=m.x,De[p++]=m.y,De[p++]=m.x,De[p++]=m.y);else{p=rV(i,n,o,l,c,u,p,m);let g=De[p-2],b=De[p-1];p-=2;let E=so.distance1(i,n,g,b);if(vt.eq(E,s))De[p++]=g,De[p++]=b,De[p++]=g,De[p++]=b;else if(E<s)p=Tc(a,i,n,o,l,g,b,p),p=Tc(a,i,n,g,b,c,u,p);else return 0}}else if(h===-1||f===-1)p=Tc(a,i,n,o,l,c,u,p);else{let m=Ff.foot(e,t.center),y=m.distance1(t.center);if(vt.eq(y,s)){let g=function(w){return tY(r,w.x,w.y)&&wo(t,w)},b=t.start(),E=t.end();if(h===0){let w=e.start();if(g(w))return De[p++]=w.x,De[p++]=w.y,De[p++]=w.x,De[p++]=w.y,p;if(g(m))return De[p++]=m.x,De[p++]=m.y,De[p++]=m.x,De[p++]=m.y,p;if(vt.eq(e.distance2(b),0)&&g(b))return De[p++]=b.x,De[p++]=b.y,De[p++]=b.x,De[p++]=b.y,p;if(vt.eq(e.distance2(E),0)&&g(E))return De[p++]=E.x,De[p++]=E.y,De[p++]=E.x,De[p++]=E.y,p;if(d<=s)p=Tc(a,i,n,m.x,m.y,c,u,p),p===2&&(De[p++]=De[0],De[p++]=De[1]);else if(y<s){if(p=Tc(a,i,n,m.x,m.y,c,u,p),p===2&&g(new We(De[0],De[1])))return De[p++]=De[0],De[p++]=De[1],p;p=Tc(a,i,n,m.x,m.y,o,l,0),p===2&&(De[p++]=De[0],De[p++]=De[1])}}else{let w=e.end();if(g(w))return De[p++]=w.x,De[p++]=w.y,De[p++]=w.x,De[p++]=w.y,p;if(g(m))return De[p++]=m.x,De[p++]=m.y,De[p++]=m.x,De[p++]=m.y,p;if(vt.eq(e.distance2(b),0)&&g(b))return De[p++]=b.x,De[p++]=b.y,De[p++]=b.x,De[p++]=b.y,p;if(vt.eq(e.distance2(E),0)&&g(E))return De[p++]=E.x,De[p++]=E.y,De[p++]=E.x,De[p++]=E.y,p;if(A<=s)p=Tc(a,i,n,m.x,m.y,o,l,p),p===2&&(De[p++]=De[0],De[p++]=De[1]);else if(y<s){if(p=Tc(a,i,n,m.x,m.y,o,l,p),p===2&&g(new We(De[0],De[1])))return De[p++]=De[0],De[p++]=De[1],p;p=Tc(a,i,n,m.x,m.y,c,u,0),p===2&&(De[p++]=De[0],De[p++]=De[1])}}}else if(h===0){let g=e.start();De[p++]=g.x,De[p++]=g.y,(o-m.x)*(c-m.x)+(l-m.y)*(u-m.y)<0&&(p=Tc(a,i,n,m.x,m.y,c,u,p))}else{let g=e.end();De[p++]=g.x,De[p++]=g.y,(o-m.x)*(c-m.x)+(l-m.y)*(u-m.y)<0&&(p=Tc(a,i,n,m.x,m.y,o,l,p))}}if(p>0){let m=0;for(let y=0;y<p;y+=2){let g=De[y],b=De[y+1];isFinite(g)&&isFinite(b)&&tY(r,g,b)&&wo(t,new We(g,b))&&(De[m++]=g,De[m++]=b)}return m}else return 0}else return 0}function Nme(t,e){if(t.bbox()){let r=t.center.x,i=t.center.y,n=t.rx2,s=e.start().x,a=e.start().y,o=e.end().x,l=e.end().y,c=t.center.distance2(e.start()),u=t.center.distance2(e.end()),d=vt.eq(c,n)?0:c>n?1:-1,A=vt.eq(u,n)?0:u>n?1:-1,h=0;if(d===-1&&A===-1)return 0;if(d===0&&A===0)De[h++]=s,De[h++]=a,De[h++]=o,De[h++]=l;else if(d===1&&A===1){let f=Ff.foot(e,t.center),p=f.distance2(t.center);if(vt.greater(p,n))return 0;if(vt.eq(p,n)){let m=f.distance2(t.start()),y=f.distance2(t.end());vt.eq(m,0)?(De[h++]=t.start().x,De[h++]=t.start().y):vt.eq(y,0)?(De[h++]=t.end().x,De[h++]=t.end().y):(De[h++]=f.x,De[h++]=f.y)}else{h=rV(r,i,s,a,o,l,h,f);let m=De[h-2],y=De[h-1],g=so.distance2(r,i,m,y);if(h-=2,vt.eq(g,n))De[h++]=m,De[h++]=y;else if(g<n)h=Tc(n,r,i,s,a,m,y,h),h=Tc(n,r,i,m,y,o,l,h);else return 0}}else if(d===-1||A===-1)h=Tc(n,r,i,s,a,o,l,h);else{let f=Ff.foot(e,t.center);d===0?(De[h++]=e.start().x,De[h++]=e.start().y,vt.neq(f.distance2(e.start()),0)&&(s-f.x)*(o-f.x)+(a-f.y)*(l-f.y)<0&&(h=Tc(n,r,i,f.x,f.y,o,l,h))):(De[h++]=e.end().x,De[h++]=e.end().y,vt.neq(f.distance2(e.end()),0)&&(s-f.x)*(o-f.x)+(a-f.y)*(l-f.y)<0&&(h=Tc(n,r,i,f.x,f.y,s,a,h)))}if(h>0){let f=0;for(let p=0;p<h;p+=2){let m=De[p],y=De[p+1];isFinite(m)&&isFinite(y)&&(De[f++]=m,De[f++]=y)}return f}else return 0}else return 0}function Tc(t,e,r,i,n,s,a,o){if(n==a){let b=t-(n-r)*(n-r);if(vt.greater(b,0)){let E=Math.sqrt(b),w=e-E,x=e+E,I=Math.min(i,s),C=Math.max(i,s);return w>=I&&w<=C&&(De[o++]=w,De[o++]=n),x>=I&&x<=C&&(De[o++]=x,De[o++]=n),o}}let l=so.distance2(i,n,e,r)-t;if(l===0)return De[o++]=i,De[o++]=n,o;let c=so.distance2(s,a,e,r)-t;if(c===0)return De[o++]=s,De[o++]=a,o;let u=i,d=n,A=s,h=a,f=NaN,p=NaN,m=Number.POSITIVE_INFINITY,y=0;for(;m!==0;){y++;let b=Math.max(Math.min(Math.abs(l)/(Math.abs(l)+Math.abs(c)),.75),.25);if(f=u+(A-u)*b,p=d+(h-d)*b,u===f&&d===p||A===f&&h===p){Math.abs(l)>Math.abs(c)?(f=A,p=h,m=c):(f=u,p=d,m=l);break}else m=so.distance2(f,p,e,r)-t,m<0&&l>c||m>0&&l<c?(A=f,h=p,c=m):(u=f,d=p,l=m)}let g=Math.sqrt(t)-so.distance1(f,p,e,r);return(vt.eq(0,m)||vt.eq(0,g))&&(De[o++]=f,De[o++]=p),o}function rV(t,e,r,i,n,s,a,o){let l=so.dotProd2(r,i,n,s,t,e),c=so.dotProd2(n,s,r,i,t,e);if(l>=0)return De[a++]=n,De[a++]=s,a;if(c>=0)return De[a++]=r,De[a++]=i,a;if(so.crossProd2(r,i,n,s,t,e)==0)return De[a++]=t,De[a++]=e,a;{let u=NaN,d=NaN,A=r,h=i,f=n,p=s,m=so.distance2(r,i,t,e),y=so.distance2(n,s,t,e),g=Number.POSITIVE_INFINITY,b=0;for(;g>0&&(b++,u=A+(f-A)*.5,d=h+(p-h)*.5,!(m==y||A==u&&h==d||f==u&&p==d));){g=so.distance2(u,d,t,e);let E=so.dotProd2(A,h,u,d,t,e);if(E==0)break;E<0?(f=u,p=d,y=g):(A=u,h=d,m=g)}return so.distance2(u,d,t,e)<so.distance2(o.x,o.y,t,e)?(De[a++]=u,De[a++]=d):(De[a++]=o.x,De[a++]=o.y),a}}function S4(t,e){if(t.rx===t.ry)return OD(t,e);throw new Error("not supported")}function Rme(t,e){if(t.rx===t.ry)return Nme(t,e);throw new Error("not supported")}function iV(t,e){if(t.bbox().intersection1(e.bbox())!=null){if(t.rx===t.ry&&e.rx===e.ry)return Mme(t,e);throw new Error("not supported operation")}return 0}function Mme(t,e){let r=t.center.x,i=t.center.y,n=e.center.x,s=e.center.y,a=t.rx,o=e.rx,l=t.rx2,c=e.rx2,u=t.center.distance1(e.center),d=Math.abs(a-o),A=a+o;if(vt.greater(u,A)||vt.less(u,d))return 0;if(vt.eq(d+u,0)){let h=0,f;return wo(t,e.start())&&(De[h]=e.start().x,De[h+1]=e.start().y,h+=2,f=e.start()),wo(t,e.end())&&(De[h]=e.end().x,De[h+1]=e.end().y,h+=2,f=e.end()),h===0?(wo(e,t.start())&&(De[h]=t.start().x,De[h+1]=t.start().y,h+=2),wo(e,t.end())&&(De[h]=t.end().x,De[h+1]=t.end().y,h+=2)):h===2&&(!f.equals1(t.start())&&wo(e,t.start())&&(De[h]=t.start().x,De[h+1]=t.start().y,h+=2),!f.equals1(t.end())&&wo(e,t.end())&&(De[h]=t.end().x,De[h+1]=t.end().y,h+=2)),h}else if(vt.eq(u,A)){if(iY(t,e))return 4;let h=new Ge(t.center,e.center),f=OD(e,h);return f=nY(t,f),f!==0?f:(f=OD(t,h),nY(e,f))}else if(vt.eq(u,d)){if(iY(t,e))return 4;if(a>o){let h=(a-o)/a;return De[0]=r+(n-r)/h,De[1]=i+(s-i)/h,sY(t,e,2)}else{let h=(o-a)/o;return De[0]=n+(r-n)/h,De[1]=s+(i-s)/h,sY(t,e,2)}}else{let h=(t.center.distance2(e.center)-c+l)/(u*2)/u,f=(n-r)*h+r,p=(s-i)*h+i,m=n-r,y=s-i,g=Math.max(a,o),b,E,w,x;if(Math.abs(m)<Math.abs(y)){let U=m/-y,_=p-U*f;b=f-g,E=U*b+_,w=f+g,x=U*w+_}else{let U=y/-m,_=f-U*p;E=p-g,b=U*E+_,x=p+g,w=U*x+_}let I=Tc(l,r,i,b,E,f,p,0);if(I=Tc(l,r,i,f,p,w,x,I),I!==4)throw new Error("cnt !== 4");let C=new We(De[0],De[1]),G=new We(De[2],De[3]);if(wo(t,C)&&wo(e,C))return wo(t,G)&&wo(e,G)?4:I0(t.start(),e,G,C)?(De[2]=t.start().x,De[3]=t.start().y,4):I0(t.end(),e,G,C)?(De[2]=t.end().x,De[3]=t.end().y,4):I0(e.start(),t,G,C)?(De[2]=e.start().x,De[3]=e.start().y,4):I0(e.end(),t,G,C)?(De[2]=e.end().x,De[3]=e.end().y,4):2;if(wo(t,G)&&wo(e,G))return I0(t.start(),e,C,G)?(De[0]=t.start().x,De[1]=t.start().y,4):I0(t.end(),e,C,G)?(De[0]=t.end().x,De[1]=t.end().y,4):I0(e.start(),t,C,G)?(De[0]=e.start().x,De[1]=e.start().y,4):I0(e.end(),t,C,G)?(De[0]=e.end().x,De[1]=e.end().y,4):(De[0]=De[2],De[1]=De[3],2);{let U=function(j,$){if(vt.eq(j.distance1($.center),$.rx)&&wo($,j)){if(j.distance2(C)<j.distance2(G)){if(_)return;_=!0}else{if(H)return;H=!0}De[Q++]=j.x,De[Q++]=j.y}},_=!1,H=!1,Q=0;return U(t.start(),e),U(t.end(),e),U(e.start(),t),U(e.end(),t),Q}}}function I0(t,e,r,i){return vt.eq(t.distance1(e.center),e.rx)&&wo(e,t)&&t.distance2(r)<t.distance2(i)}function iY(t,e){return vt.eq(e.start().distance1(t.center),t.rx)&&wo(t,e.start())?(De[0]=e.start().x,De[1]=e.start().y,De[2]=e.start().x,De[3]=e.start().y,!0):vt.eq(e.end().distance1(t.center),t.rx)&&wo(t,e.end())?(De[0]=e.end().x,De[1]=e.end().y,De[2]=e.end().x,De[3]=e.end().y,!0):vt.eq(t.start().distance1(e.center),e.rx)&&wo(e,t.start())?(De[0]=t.start().x,De[1]=t.start().y,De[2]=t.start().x,De[3]=t.start().y,!0):vt.eq(t.end().distance1(e.center),e.rx)&&wo(e,t.end())?(De[0]=t.end().x,De[1]=t.end().y,De[2]=t.end().x,De[3]=t.end().y,!0):!1}function nY(t,e){if(e===0)return 0;let r=De[0],i=De[1];return wo(t,new We(r,i))?(De[0]=r,De[1]=i,De[2]=r,De[3]=i,4):0}function sY(t,e,r){if(r===0)return 0;let i=De[0],n=De[1],s=new We(i,n);return wo(t,s)&&wo(e,s)?(De[0]=i,De[1]=n,De[2]=i,De[3]=n,4):0}function Xx(t,e){return Math.abs(t-e)<=1e-6}function wo(t,e){let r=t.bbox();if(e.x-r.minX>-Xv&&e.x-r.maxX<Xv&&e.y-r.minY>-Xv&&e.y-r.maxY<Xv){let i=Ii.regularD(e.angleD(t.center));return Xx(i,t.startAngle)||Xx(i,t.startAngle+360)||Xx(i,t.startAngle-360)||Xx(i,t.endAngle())||Xx(i,t.endAngle()+360)||Xx(i,t.endAngle()-360)?!0:t.sweepAngle>0?(vt.less(i,t.startAngle)&&(i+=360),vt.greatereq(t.endAngle(),i)):(vt.greater(i,t.startAngle)&&(i-=360),vt.lesseq(t.endAngle(),i))}else return!1}function kme(t,e){let r=t[1].x-t[0].x,i=t[1].y-t[0].y,n=e[1].x-e[0].x,s=e[1].y-e[0].y;if(r===0&&n!==0||r!==0&&n===0)return!1;if(r===0&&n===0)return!0;let a=i/r,o=s/n;return tV(a,o,Math.sin(Math.PI/180))}function Fme(t,e,r){var i,n=+e.x,s=+e.y,a=+r.x,o=+r.y,l=+t.x,c=+t.y,u=a-n,d=o-s,A=l-n,h=c-s,f,p,m,y,g,b;return u===0&&d===0?{d:Math.sqrt(A*A+h*h),point:new We(n,s)}:(i=(A*u+h*d)/(u*u+d*d),i<0?{d:Math.sqrt(A*A+h*h),point:new We(n,s)}:i>1?(f=l-a,p=c-o,{d:Math.sqrt(f*f+p*p),point:new We(a,o)}):(g=n+i*u,b=s+i*d,m=l-g,y=c-b,{d:Math.sqrt(m*m+y*y),point:new We(g,b)}))}function Rf(t,e){if(!t||!e||t.length!=e.length)return!1;let r="equals1";return!t.some((i,n)=>{let s=e[n],a=!1;return i&&s&&typeof i=="object"&&typeof s=="object"?typeof i[r]=="function"&&Hme(i,s)?a=!i[r].call(i,s):a=!(i===s||i.toString()===s.toString()):typeof i=="number"&&typeof s=="number"?a=!(Ume(i,s)||Number.isNaN(i)&&Number.isNaN(s)):a=i!==s,a})}function Ume(t,e,r=5){return Math.abs(t-e)*Math.pow(10,r)<1}function Hme(t,e){return!t||!e||typeof t!="object"||typeof e!="object"?t===e:t.constructor===e.constructor}var zi=new Float64Array(100);function mD(t,e){if(t.bbox().extendOfSize(vt.eps).isSeparated(e.bbox()))return 0;let r=[[t,e]],i=(t.controls.length-1)*(e.controls.length-1)*8,n=0,s=Number.POSITIVE_INFINITY;for(;r.length!==0;){let a=function(B){_=Math.min(_,B),H=Math.max(H,B)},o=function(B,M){let v=Wp(B,M);if(v===0)throw new Error("cnt === 0");for(let N=0;N<v;N+=2)a(De[N])};if(n>i){for(let B=n-2;B>=2;B-=2)for(let M=B-2;M>=0;M-=2)if(vt.eq(zi[B],zi[M])&&vt.eq(zi[B+1],zi[M+1])){zi[M]=(zi[B]+zi[M])/2,zi[M+1]=(zi[B+1]+zi[M+1])/2;for(let v=n-3;v>=B;v--)zi[v]=zi[v+2];n-=2;break}if(n>i){n=0;let B=e.start(),M=new Float64Array(8);t.getPercent(B)!==null&&(M[n++]=B.x,M[n++]=B.y);let v=e.end();t.getPercent(v)!==null&&(M[n++]=v.x,M[n++]=v.y);let N=t.start();e.getPercent(N)!==null&&(M[n++]=N.x,M[n++]=N.y);let R=t.end();return e.getPercent(R)!==null&&(M[n++]=R.x,M[n++]=R.y),De.set(M),n}}let[l,c]=r.pop(),u=l.controls,d=c.controls;if(u.length===2&&d.length===2){let B=Wp(new Ge(u[0],u[1]),new Ge(d[0],d[1]));for(let M=0;M<B;M++)zi[n++]=De[M];continue}let A=u[0],h=u[u.length-1];A.equals1(h)&&(h=A.add1(1,0));let f=h.y-A.y,p=A.x-h.x,m=-f*A.x-p*A.y,y=Math.sqrt(1/(f**2+p**2));f*=y,p*=y,m*=y;let g=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY;if(u.forEach(B=>{let M=f*B.x+p*B.y+m;M<g&&(g=M),M>b&&(b=M)}),vt.eq(g,b)){if(c.controls.length===2){let B=Wp(new Ge(l.start(),l.end()),new Ge(c.start(),c.end()));for(let M=0;M<B;M++)zi[n++]=De[M];if(B!==0)continue}l=new br([u[0],u[u.length-1]]),u=l.controls}let E=d.map(B=>{let M=f*B.x+p*B.y+m,v=Math.abs(M);return v<s&&(s=v),M}),w=0;for(let B of E){if(vt.less(B,g))w=w|1;else if(vt.greater(B,b))w=w|2;else{w=3;break}if(w===3)break}if(w!==3)continue;let x=0,I=0,C=h.x-A.x,G=h.y-A.y,U=Math.sqrt(1/(C**2+G**2));C*=U,G*=U;for(let B=1;B<u.length;B++){let M=u[B],v=(M.x-A.x)*C+(M.y-A.y)*G;v<x?x=v:v>I&&(I=v)}w=0;for(let B of d){let M=(B.x-A.x)*C+(B.y-A.y)*G;if(vt.less(M,x))w=w|1;else if(vt.greater(M,I))w=w|2;else{w=3;break}if(w===3)break}if(w!==3)continue;let _=Number.POSITIVE_INFINITY,H=Number.NEGATIVE_INFINITY;s/=2,s<=vt.eps&&(s=vt.eps),g-=s,b+=s,E.forEach((B,M)=>{B>=g&&B<=b&&a(M/(E.length-1))});let Q=new Ge(new We(0,g),new We(1,g)),j=new Ge(new We(0,b),new We(1,b));for(let B=0;B<E.length-1;B++){let M=new We(B/(E.length-1),E[B]),v=M.y<g?1:M.y>b?2:3;for(let N=0;N<E.length;N++){let R=new We(N/(E.length-1),E[N]),q=R.y<g?1:R.y>b?2:3;v!==q&&(v===1?q===2?(o(new Ge(M,R),Q),o(new Ge(M,R),j)):o(new Ge(M,R),Q):v===2?q===1?(o(new Ge(M,R),Q),o(new Ge(M,R),j)):o(new Ge(M,R),j):q===1?o(new Ge(M,R),Q):o(new Ge(M,R),j))}}_!==0&&(c=c.clip(_)[1]),H!==1&&(c=c.clip((H-_)/(1-_))[0]);let $=c.bbox();if(vt.eq($.minX,$.maxX)&&vt.eq($.minY,$.maxY)){w=0;for(let B of c.controls){let M=(B.x-A.x)*C+(B.y-A.y)*G;if(vt.less(M,x))w=w|1;else if(vt.greater(M,I))w=w|2;else{w=3;break}if(w===3)break}if(w===3){let B=new We(($.minX+$.maxX)/2,($.minY+$.maxY)/2);l.getPercent(B)&&(zi[n++]=B.x,zi[n++]=B.y)}continue}if(H-_>.8){let[B,M]=c.clip(.5);r.push([B,l]),r.push([M,l])}else r.push([c,l])}for(let a=0;a<n;a++)De[a]=zi[a];return n}function Gme(t,e){if(t.bbox().extendOfSize(vt.eps).isSeparated(e.bbox()))return{cnt:0};let r=[[t,e]],i=(t.controls.length-1)*(e.controls.length-1)*8,n=0,s=Number.POSITIVE_INFINITY;for(;r.length!==0;){let a=function(B){_=Math.min(_,B),H=Math.max(H,B)},o=function(B,M){let v=Wp(B,M);if(v===0)throw new Error("cnt === 0");for(let N=0;N<v;N+=2)a(De[N])};if(n>i){for(let B=n-2;B>=2;B-=2)for(let M=B-2;M>=0;M-=2)if(vt.eq(zi[B],zi[M])&&vt.eq(zi[B+1],zi[M+1])){zi[M]=(zi[B]+zi[M])/2,zi[M+1]=(zi[B+1]+zi[M+1])/2;for(let v=n-3;v>=B;v--)zi[v]=zi[v+2];n-=2;break}if(n>i){n=0;let B=new Float64Array(8),M=e.end(),v=0;t.getPercent(M)!==null&&(B[n++]=M.x,B[n++]=M.y,v=2);let N=t.end();return e.getPercent(N)!==null&&(B[n++]=N.x,B[n++]=N.y,v=v===0?1:3),De.set(B),{havOverlap:v,cnt:n}}}let[l,c]=r.pop(),u=l.controls,d=c.controls;if(u.length===2&&d.length===2){let B=Wp(new Ge(u[0],u[1]),new Ge(d[0],d[1]));for(let M=0;M<B;M++)zi[n++]=De[M];continue}let A=u[0],h=u[u.length-1];A.equals1(h)&&(h=A.add1(1,0));let f=h.y-A.y,p=A.x-h.x,m=-f*A.x-p*A.y,y=Math.sqrt(1/(f**2+p**2));f*=y,p*=y,m*=y;let g=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY;if(u.forEach(B=>{let M=f*B.x+p*B.y+m;M<g&&(g=M),M>b&&(b=M)}),vt.eq(g,b)){if(c.controls.length===2){let B=Wp(new Ge(l.start(),l.end()),new Ge(c.start(),c.end()));for(let M=0;M<B;M++)zi[n++]=De[M];if(B!==0)continue}l=new br([u[0],u[u.length-1]]),u=l.controls}let E=d.map(B=>{let M=f*B.x+p*B.y+m,v=Math.abs(M);return v<s&&(s=v),M}),w=0;for(let B of E){if(vt.less(B,g))w=w|1;else if(vt.greater(B,b))w=w|2;else{w=3;break}if(w===3)break}if(w!==3)continue;let x=0,I=0,C=h.x-A.x,G=h.y-A.y,U=Math.sqrt(1/(C**2+G**2));C*=U,G*=U;for(let B=1;B<u.length;B++){let M=u[B],v=(M.x-A.x)*C+(M.y-A.y)*G;v<x?x=v:v>I&&(I=v)}w=0;for(let B of d){let M=(B.x-A.x)*C+(B.y-A.y)*G;if(vt.less(M,x))w=w|1;else if(vt.greater(M,I))w=w|2;else{w=3;break}if(w===3)break}if(w!==3)continue;let _=Number.POSITIVE_INFINITY,H=Number.NEGATIVE_INFINITY;s/=2,s<=vt.eps&&(s=vt.eps),g-=s,b+=s,E.forEach((B,M)=>{B>=g&&B<=b&&a(M/(E.length-1))});let Q=new Ge(new We(0,g),new We(1,g)),j=new Ge(new We(0,b),new We(1,b));for(let B=0;B<E.length-1;B++){let M=new We(B/(E.length-1),E[B]),v=M.y<g?1:M.y>b?2:3;for(let N=0;N<E.length;N++){let R=new We(N/(E.length-1),E[N]),q=R.y<g?1:R.y>b?2:3;v!==q&&(v===1?q===2?(o(new Ge(M,R),Q),o(new Ge(M,R),j)):o(new Ge(M,R),Q):v===2?q===1?(o(new Ge(M,R),Q),o(new Ge(M,R),j)):o(new Ge(M,R),j):q===1?o(new Ge(M,R),Q):o(new Ge(M,R),j))}}_!==0&&(c=c.clip(_)[1]),H!==1&&(c=c.clip((H-_)/(1-_))[0]);let $=c.bbox();if(vt.eq($.minX,$.maxX)&&vt.eq($.minY,$.maxY)){w=0;for(let B of c.controls){let M=(B.x-A.x)*C+(B.y-A.y)*G;if(vt.less(M,x))w=w|1;else if(vt.greater(M,I))w=w|2;else{w=3;break}if(w===3)break}if(w===3){let B=new We(($.minX+$.maxX)/2,($.minY+$.maxY)/2);l.getPercent(B)&&(zi[n++]=B.x,zi[n++]=B.y)}continue}if(H-_>.8){let[B,M]=c.clip(.5);r.push([B,l]),r.push([M,l])}else r.push([c,l])}for(let a=0;a<n;a++)De[a]=zi[a];return{cnt:n}}var Yme=class{constructor(t=vt.eps){this.eps=t}eq(t,e){return Math.abs(t-e)<=this.eps}setEps(t){this.eps=t}},Hv=new Yme;function aY(t,e){if(t.bbox().extendOfSize(vt.eps).isSeparated(e.bbox()))return 0;let r=[[t,e]],i=(e.controls.length-1)*16,n=0;for(;r.length!==0;){if(n>i){let a=function(){for(let c=0;c<n;c+=2)for(let u=c+2;u<n;u+=2)if(!(Hv.eq(zi[c],zi[u])&&Hv.eq(zi[c+1],zi[u+1]))){l(zi[u],zi[u+1],o);break}function l(c,u,d){let A=!1;for(let h=0;h<d.length;h+=2)if(Hv.eq(c,d[h])&&Hv.eq(u,d[h+1])){A=!0;break}A||d.push(c,u)}},o=[zi[0],zi[1]];if(a(),o.length>=100&&(Hv.setEps(.001),o=[zi[0],zi[1]],a(),o.length>=100))throw new Error("clearSamePoint()");n=o.length,o.forEach((l,c)=>zi[c]=l)}let s=r.pop();if(s[0]instanceof gt){let a=function(j){G=Math.min(G,j),U=Math.max(U,j)},o=function(j,$){let B=Wp(j,$);if(B===0)throw new Error("cnt === 0");for(let M=0;M<B;M+=2)a(De[M])},[l,c]=s,u=c.controls;if(u.length===2){let j=S4(l,new Ge(u[0],u[1]));for(let $=0;$<j;$++)zi[n++]=De[$];continue}let d=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,h,f,p,m,y;if(Math.abs(l.sweepAngle)>359){let j=l.rx;h=l.center.add1(j,0),f=l.center.add1(-j,0),d=-j,A=j,p=0,m=1,y=-l.center.y}else{h=l.start(),f=l.end(),p=f.y-h.y,m=h.x-f.x,y=-p*h.x-m*h.y;let j=Math.sqrt(1/(p**2+m**2));p*=j,m*=j,y*=j;let $=p*l.center.x+m*l.center.y+y;l.isCCW?(A=l.rx+$,d=0):(d=$-l.rx,A=0)}let g=u.map(j=>p*j.x+m*j.y+y),b=0;for(let j of g){if(vt.less(j,d))b=b|1;else if(vt.greater(j,A))b=b|2;else{b=3;break}if(b===3)break}if(b!==3)continue;let E=0,w=0,x=f.x-h.x,I=f.y-h.y,C=Math.sqrt(1/(x**2+I**2));if(x*=C,I*=C,Math.abs(l.sweepAngle)<=180)E=0,w=(f.x-h.x)*x+(f.y-h.y)*I;else throw new Error("not support");b=0;for(let j of u){let $=(j.x-h.x)*x+(j.y-h.y)*I;if(vt.less($,E))b=b|1;else if(vt.greater($,w))b=b|2;else{b=3;break}if(b===3)break}if(b!==3)continue;let G=Number.POSITIVE_INFINITY,U=Number.NEGATIVE_INFINITY;d-=vt.eps,A+=vt.eps,g.forEach((j,$)=>{j>=d&&j<=A&&a($/(g.length-1))});let _=new Ge(new We(0,d),new We(1,d)),H=new Ge(new We(0,A),new We(1,A));for(let j=0;j<g.length-1;j++){let $=new We(j/(g.length-1),g[j]),B=$.y<d?1:$.y>A?2:3;for(let M=0;M<g.length;M++){let v=new We(M/(g.length-1),g[M]),N=v.y<d?1:v.y>A?2:3;B!==N&&(B===1?N===2?(o(new Ge($,v),_),o(new Ge($,v),H)):o(new Ge($,v),_):B===2?N===1?(o(new Ge($,v),_),o(new Ge($,v),H)):o(new Ge($,v),H):N===1?o(new Ge($,v),_):o(new Ge($,v),H))}}G!==0&&(c=c.clip(G)[1]),U!==1&&(c=c.clip((U-G)/(1-G))[0]);let Q=c.bbox();if(vt.eq(Q.minX,Q.maxX)&&vt.eq(Q.minY,Q.maxY)){b=0;for(let j of c.controls){let $=(j.x-h.x)*x+(j.y-h.y)*I;if(vt.less($,E))b=b|1;else if(vt.greater($,w))b=b|2;else{b=3;break}if(b===3)break}b===3&&(zi[n++]=(Q.minX+Q.maxX)/2,zi[n++]=(Q.minY+Q.maxY)/2);continue}U-G>.8?c.clip(.5).forEach(j=>r.push([j,l])):r.push([c,l])}else{let[a,o]=s;r.push([gt.build3(o.center,o.startAngle,o.sweepAngle/2,o.rx,o.ry),a]),r.push([gt.build3(o.center,o.startAngle+o.sweepAngle/2,o.sweepAngle/2,o.rx,o.ry),a])}}for(let s=0;s<n;s++)De[s]=zi[s];return n}var Vme=class{static getSweep(t){if(t.length>2){let e=0,r=t.length;for(let s=0;s<r-1;s++){let a=t[s],o=t[s+1];e+=(o.x+a.x)*(o.y-a.y)}let i=t[0],n=t[r-1];return e+=(i.x+n.x)*(i.y-n.y),e>0}else throw new Error("Unable to determine the direction of rotation!")}static isClose(t){return!!(t.primitives.length>0&&t.primitives[0].start().equals1(t.primitives[t.primitives.length-1].end()))}};function jme(t){let e=t.primitives,r=e[0],i=r instanceof gt?r.sweepAngle%360:null;if(e.length===1&&r instanceof gt&&(vt.eq(i,0)||vt.eq(Math.abs(i),360)))return!!r.isCCW;let n=new Array;return t.points(.1,s=>{n.push(s)}),Vme.getSweep(n)}var Qme=class{static zoomCorner(t,e){let r=new Array,i=new Array,n=new Array;return this.getPanPrimitive(t,r,n,e),this.rearrange(r,n),this.processStart(r,n),this.getResult(r,n,i,e),i.length>0?cn.build2(i):null}static zoomPolygon(t,e){let r=new Array,i=new Array,n=new Array;return jme(t)&&(t=t.reverse().asClose()),this.getPanPrimitive(t,r,n,e),this.rearrange(r,n),this.processStart(r,n),this.getResult(r,n,i,e),i.length>0?cn.build2(i):null}static zoomLines(t,e){return this.zoomPolygon(cn.build2(t.primitives.concat(t.reverse().primitives)),e/2)}static getPanPrimitive(t,e,r,i){let n=t.primitives;for(let s of n){let a=this.panDistance(s,i);a!==void 0&&(e.push(a),r.push(s))}}static rearrange(t,e){let r=t.length,i=0;for(let a=0;a<r;a++){let o=e[a],l=t[a],c=a==r-1?t[0]:t[a+1];if(!(l instanceof gt&&c instanceof gt)&&!this.isCW(l.end(),c.start(),o.end())){if(IA(l,c)!=0){i=a==r-1?0:a+1;break}}else{i=a;break}}let n=this.start4Index(e,i),s=this.start4Index(t,i);e.length=0,t.length=0,n.forEach(a=>{e.push(a)}),s.forEach(a=>{t.push(a)})}static processStart(t,e){let r=t.length;if(r>2){let i=t[r-1],n=t[0],s=e[r-1];if(!(i instanceof gt&&n instanceof gt)&&!this.isCW(i.end(),n.start(),s.end())){let a=IA(i,n);for(let o=0;o<a;o+=2){let l=new We(De[o],De[o+1]);t[r-1]=this.generatePrimitive(i,i.start(),l),t[0]=this.generatePrimitive(n,l,n.end())}}}}static getResult(t,e,r,i){let n=t.length;for(let s=0;s<n;s++){let a=e[s],o=s===n-1?e[0]:e[s+1],l=s==n-1?0:s+1,c=l==n-1?e[0]:e[l+1],u=t[s],d=s==n-1?t[0]:t[s+1],A=l==n-1?t[0]:t[l+1];if(!(u instanceof gt&&d instanceof gt)&&!this.isCW(u.end(),d.start(),a.end())){let f=this.add(t,r,s,u,d,0);f=this.update(t,r,s,d,f);let p=this.generateArc(o,c,d,A,i);if(f=this.add(t,r,s,u,p,f),f=this.update(t,r,s,p,f),f>0)continue}r.push(u);let h=this.generateArc(a,o,u,d,i);h!==void 0&&r.push(h)}}static generateArc(t,e,r,i,n){if(n>0){let s=t.end(),a=e.start(),o=r.end(),l=i.start();if(o.distance2(l)>1e-8)if(s.equals(a)){let c=o.angleD(s),u=l.angleD(s);return gt.build2(s,c,u,n,n,0)}else{let c=o.angleD(s),u=l.angleD(s),d=o.angleD(a),A=l.angleD(a),h=gt.build2(s,c,u,n,n,0),f=gt.build2(a,d,A,n,n,0);return h.pointOn(h.endAngle()).equals1(l)?h:f.pointOn(f.endAngle()).equals1(l)?f:h}}}static updateNews(t,e,r,i){let n=t.length,s=e==n-1?0:e+1;t[s]=this.generatePrimitive(r,i,r.end())}static add(t,e,r,i,n,s){if(s>0)return s;if(i!=null&&n!=null){let a=IA(i,n);for(let o=0;o<a;o+=2){let l=new We(De[o],De[o+1]);e.push(this.generatePrimitive(i,i.start(),l)),this.updateNews(t,r,n,l);break}return a}else return 0}static update(t,e,r,i,n){if(n>0)return n;let s=e.length;if(s>0&&i!=null){let a=e[s-1],o=IA(a,i);for(let l=0;l<o;l+=2){let c=new We(De[l],De[l+1]);e[s-1]=this.generatePrimitive(a,a.start(),c),this.updateNews(t,r,i,c)}return o}else return 0}static generatePrimitive(t,e,r){if(t instanceof Ge)return new Ge(e,r);if(t instanceof gt){let i=t,n=e.angleD(i.center),s=r.angleD(i.center);return gt.build2(i.center,n,s,i.rx,i.ry,i.sweep())}else throw new Error("not supported operation")}static start4Index(t,e){let r=t.length,i=new Array;for(let n=e;n<r;n++)i.push(t[n]);for(let n=0;n<e;n++)i.push(t[n]);return i}static isCW(t,e,r){let i=new Ge(r,t),n=new Ge(r,e),s=i.end().x-i.start().x,a=i.end().y-i.start().y,o=n.end().x-n.start().x,l=n.end().y-n.start().y;return!(s*l-a*o>0)}static panDistance(t,e){if(t instanceof Ge){if(t.isPoint())return;{let r=t.panDistance(e);return r.length()>1e-5?r:void 0}}else if(t instanceof gt){let r=t;if(r.sweepAngle>0){if(r.rx-e<=0||r.ry-e<=0)return}else if(r.sweepAngle<0&&(r.rx+e<=0||r.ry+e<=0))return;return r=r.panDistance(e),r.start().distance1(r.end())>1e-5||vt.eq(Math.abs(r.sweepAngle),360)?r:void 0}else throw new Error("not supported operation")}},ui=.001,ou=ui**2;function jr(t,e){return t.distance2(e)<ou}function Jp(t,e){return Math.abs(t-e)<=1e-4}function zme(t,e){if(t instanceof Ge)return new Ge(t.start(),e);if(t instanceof gt){let r=e.angleD(t.center);return Jp(Ii.regularD(t.startAngle),Ii.regularD(r))?gt.build3(t.center,t.startAngle,0,t.rx,t.ry):gt.build2(t.center,t.startAngle,r,t.rx,t.ry,t.isCCW?1:0)}else{if(t instanceof br)return t.clip(t.getPercent(e,ui))[0];throw new Error("not supported operation")}}function Uf(t,e=Ii.toRadians(t.startAngle)){return t.isCCW?e+=LD:e-=LD,new We(Math.cos(e),Math.sin(e))}function aC(t,e=0){let r=t.controls;if(e===0){let i=r[0],n=r.slice(1).find(s=>!(s.x===i.x&&s.y===i.y));if(!n)throw Error("getTangentBezier(bezier: Bezier, t: number = 0)");return n.sub(i)}else if(e===1){let i=r[r.length-1],n=r.slice(0,-1).reverse().find(s=>!(s.x===i.x&&s.y===i.y));if(!n)throw Error("getTangentBezier(bezier: Bezier, t: number = 0)");return i.sub(n)}if(r.length===3){let[i,n,s]=r;return n.sub(i).mul(2*(1-e)).add(s.sub(n).mul(2*e)).normalize()}else{let[i,n,s,a]=r;return n.sub(i).mul(3*(1-e)**2).add(s.sub(n).mul(6*(1-e)*e)).add(a.sub(s).mul(3*e**2)).normalize()}}function l2(t,e,r){let i=t.slice(1).findIndex(s=>!(s.x===e.x&&s.y===e.y)),n=t[i+1];if(r&&(r.getPercent(n,ui)!==null||new Ge(r.start(),r.end()).distance(n)<=ui)&&(n=t[i+2]),!n)throw Error("getSecondPoint(controls: readonly Vector2[])");return n}function ci(t,e){if(t instanceof Ge)return t.end().sub(t.start()).normalize();if(t instanceof gt)return(e?Uf(t,e.angle(t.center)):Uf(t)).normalize();if(t instanceof br)if(t.controls.length===2){let[r,i]=t.controls;if(jr(r,i))throw Error("equalsPP(p0, p1)");return i.sub(r).normalize()}else return(e?aC(t,t.getPercent(e,ui)):aC(t)).normalize();else throw new Error("not support")}function Xme(t,e,r){let i=[],n=e**2-4*t*r;if(n>=0){let s=-e/(2*t),a=Math.sqrt(n)/(2*t),o=s+a;if(i.push(o),n>0){let l=s-a;i.push(l)}}return i}function qme(t,e,r,i,n=0,s=1){let a=[],o=t*Math.pow(n,3)+e*Math.pow(n,2)+r*n+i,l=t*Math.pow(s,3)+e*Math.pow(s,2)+r*s+i,c,u;if(o*l<0)for(;Math.abs(n-s)>ui;)if(c=(n+s)/2,u=t*Math.pow(c,3)+e*Math.pow(c,2)+r*c+i,Math.abs(u)<ui){a.push(c);break}else o*u<0?s=c:l*u<0&&(n=c);else o*l===0&&(o===0&&a.push(n),l===0&&a.push(s));return a}function r4(t,e,r){if(t instanceof Ge||e.distance2(r)<=ou)return new Ge(e,r);if(t instanceof gt)return gt.build2(t.center,e.angleD(t.center),r.angleD(t.center),t.rx,t.ry,t.isCCW?1:0);if(t instanceof br){let i=t.getPercent(e,ui),n=t.getPercent(r,ui);return t.clip(i)[1].clip((n-i)/(1-i))[0]}else throw new Error("not supported operation")}function T4(t){return vt.greater(t,0)&&vt.less(t,1)}function ND(t,e,r,i){let n=t[i]-2*e[i]+r[i],s=e[i]-t[i];if(n===0)return[];let a=-s/n,o=[];return T4(a)&&o.push(a),o}function RD(t,e,r,i,n){let s,a,o=-t[n]+3*e[n]-3*r[n]+i[n],l=2*(t[n]-2*e[n]+r[n]),c=e[n]-t[n],u=l**2-4*o*c;if(vt.lesseq(u,0))s=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY;else{let A=Math.sqrt(u);s=(-l-A)/(2*o),a=(-l+A)/(2*o);let h=o*2;if(vt.lesseq(s,1)&&vt.greatereq(s,0)){let f=Number.NEGATIVE_INFINITY;for(;vt.neq(s,f);){f=s;let p=h*s+l;s=-(o*s**2+l*s+c-p*s)/p}}if(vt.lesseq(a,1)&&vt.greatereq(a,0)){let f=Number.NEGATIVE_INFINITY;for(;vt.neq(a,f);){f=a;let p=h*a+l;a=-(o*a**2+l*a+c-p*a)/p}}}let d=[];return T4(a)&&d.push(a),T4(s)&&d.push(s),d}function nV(t,e){if(t.controls.length===2){let[o,l]=t.controls;jr(o,l)||e.push(new Ge(o,l));return}let r,i;if(t.controls.length===3){let[o,l,c]=t.controls;r=ND(o,l,c,"x"),i=ND(o,l,c,"y")}else{let[o,l,c,u]=t.controls;r=RD(o,l,c,u,"x"),i=RD(o,l,c,u,"y")}r.sort((o,l)=>l-o),i.sort((o,l)=>l-o);let n=r.pop()||1,s=i.pop()||1,a=0;for(;n!==1||s!==1;)if(vt.eq(n,s))n=r.pop()||1,s=i.pop()||1;else if(n<s){let[o,l]=t.clip((n-a)/(1-a));a=n,e.push(o),t=l,n=r.pop()||1}else{let[o,l]=t.clip((s-a)/(1-a));a=s,e.push(o),t=l,s=i.pop()||1}e.push(t)}var Wme=1e-5,tM=1,br=class Gu extends yC{constructor(e){if(super(),this._startToEndL=null,e.length<2)throw new Error("Bezier needs at least 2 endpoints");this.controls=e.slice()}get startToEndL(){return this._startToEndL===null&&(this._startToEndL=new Ge(this.start(),this.end())),this._startToEndL}build1(e){let r=[];return d2(e,(i,n)=>(r.push(n),!0)),new Gu(r)}start(){return this.controls[0]}end(){return this.controls[this.controls.length-1]}static pointOn(e,r){if(r.length<1)throw new Error("bezier must have at least 1 point");if(r.length===1)return r[0];{let i=new Array(r.length-1);for(let n=1;n<r.length;n++){let s=r[n-1],a=r[n],o=(a.x-s.x)*e,l=(a.y-s.y)*e;i[n-1]=s.add1(o,l)}return Gu.pointOn(e,i)}}clip1(e,r,i,n){if(i.push(r[0]),n.push(r[r.length-1]),r.length<2)throw new Error("bezier clip must have at least 2 point");if(r.length===2){let s=r[0],a=r[1],o=(a.x-s.x)*e,l=(a.y-s.y)*e,c=s.add1(o,l);i.push(c),n.push(c)}else{let s=new Array(r.length-1);for(let a=1;a<r.length;a++){let o=r[a-1],l=r[a],c=(l.x-o.x)*e,u=(l.y-o.y)*e;s[a-1]=o.add1(c,u)}this.clip1(e,s,i,n)}}clip(e){let r=[],i=[];return this.clip1(e,this.controls,r,i),[new Gu(r),new Gu(i.reverse())]}greater(e,r,i){return e-r>i}less(e,r,i){return e-r<-i}eq(e,r,i){return Math.abs(e-r)<=i}eqPP(e,r,i){return!e||!r?!1:this.eq(e.x,r.x,i)&&this.eq(e.y,r.y,i)}isInRange(e,r=vt.eps){let i=this.controls.map(s=>s.y-e.y),n=0;for(let s of i){if(this.less(s,0,r))n=n|1;else if(this.greater(s,0,r))n=n|2;else{n=3;break}if(n===3)break}if(n!==3)return!1;n=0;for(let s of this.controls){let a=s.x-e.x;if(this.less(a,0,r))n=n|1;else if(this.greater(a,0,r))n=n|2;else{n=3;break}if(n===3)break}return n===3}getPercent(e,r=vt.eps){if(!this.isInRange(e,r))return null;let i=Number.POSITIVE_INFINITY,n=[[this,0,1]];for(;n.length!==0;){let s=function(m){u=Math.min(u,m),d=Math.max(d,m)},a=function(m,y){let g=Wp(m,y);if(g===0)throw new Error("cnt === 0");for(let b=0;b<g;b+=2)s(De[b])},[o,l,c]=n.pop();if(this.eqPP(o.start(),e,r))return l;if(this.eqPP(o.end(),e,r))return c;let u=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,A=o.controls.map(m=>m.y-e.y);i=A.reduce((m,y)=>{let g=Math.abs(y);return g<m?g:m},i),i/=2,i<=r&&(i=r),A.forEach((m,y)=>{this.eq(m,0,r)&&s(y/(A.length-1))});let h=new Ge(new We(0,-i),new We(1,-i)),f=new Ge(new We(0,i),new We(1,i));for(let m=0;m<A.length-1;m++){let y=new We(m/(A.length-1),A[m]),g=this.less(y.y,0,r)?1:this.greater(y.y,0,r)?2:3;for(let b=0;b<A.length;b++){let E=new We(b/(A.length-1),A[b]),w=this.less(E.y,0,r)?1:this.greater(E.y,0,r)?2:3;g!==w&&(g===1?w===2?(a(new Ge(y,E),h),a(new Ge(y,E),f)):a(new Ge(y,E),h):g===2?w===1?(a(new Ge(y,E),h),a(new Ge(y,E),f)):a(new Ge(y,E),f):w===1?a(new Ge(y,E),h):a(new Ge(y,E),f))}}if(!isFinite(u)){if(Math.max(...A.map(m=>Math.abs(m)))<r*4)return(l+c)/2;continue}if(u!==0&&(o=o.clip(u)[1],l=(c-l)*u+l),d!==1){let m=(d-u)/(1-u);o=o.clip(m)[0],c=(c-l)*m+l}if(!o.isInRange(e,r))continue;let p=o.controls.reduce((m,y)=>m.ext2(y),new vh).build1();if(this.eq(p.minX,p.maxX,r)&&this.eq(p.minY,p.maxY,r))return(l+c)/2;if(d-u>.8){let[m,y]=o.clip(.5);m.isInRange(e,r)?(n.push([m,l,(l+c)/2]),y.isInRange(e,r)&&n.push([y,(l+c)/2,c])):n.push([y,(l+c)/2,c])}else n.push([o,l,c])}return null}toBezier(){return this}toString(){return"Bezier ["+this.controls.join(" ")+"]"}bbox(){return this._bbox||(this._bbox=new vh().ext3(this.points(.1)).build1()),this._bbox}bboxWithControls(){return this._bbox_controls||(this._bbox_controls=new vh().ext3(this.controls).build()),this._bbox_controls}multiply3(e){let r=new Array(this.controls.length);for(let i=0;i<this.controls.length;i++){let n=this.controls[i];r[i]=n.multiply3(e)}return new Gu(r)}stroke(e,r,i,n=tM){let s=Qme.zoomLines(cn.build4(this.points(n)),e);return i===0?s:s.reverse()}points(e){let r=[];return this.getBezierPoints(e,i=>r.push(i)),r}getBezierPoints(e,r){if(this.controls.length===2){r(this.start()),r(this.end());return}let i=[this];for(r(this.start());i.length!==0;){let s=i.pop(),a=new Ge(s.start(),s.end());if(n(s.controls,a)<=e)r(s.end());else{let[o,l]=s.clip(.5);i.push(l,o)}}function n(s,a){let o=a.start(),l=a.end();o.equals1(l)&&(l=o.add1(1,0));let c=l.y-o.y,u=o.x-l.x,d=-c*o.x-u*o.y,A=Math.sqrt(1/(c**2+u**2));c*=A,u*=A,d*=A;let h=s.map(f=>Math.abs(c*f.x+u*f.y+d));return Math.max(...h)}}getBezierPoints3(e,r){if(this.controls.length===2){r(this.start()),r(this.end());return}let i=e*e,n=this.controls[0],s=.5;for(;s>Wme&&!(n.distance2(Gu.pointOn(s,this.controls))<=i);s*=.5);let a=Math.ceil(1/s);s=1/a,r(n);let o=0;for(let l=1;l<a;l++)o+=s,r(Gu.pointOn(o,this.controls));r(this.end())}getPointsBySlope(e){if(this.controls.length===4)return this.getPointsBySlope4(e);throw new Error("Currently, only 4 control points are supported!")}getPointsBySlope4(e){let[r,i,n,s]=this.controls,a=-3*r.x+9*i.x-9*n.x+3*s.x,o=6*r.x-12*i.x+6*n.x,l=-3*r.x+3*i.x,c=[];if(Number.isFinite(e)){let u=-3*r.y+9*i.y-9*n.y+3*s.y,d=6*r.y-12*i.y+6*n.y,A=-3*r.y+3*i.y,h=u-a*e,f=d-o*e,p=A-l*e,m=-f/(2*h),y=Math.sqrt(f**2-4*h*p)/(2*h),g=m+y;g>=0&&g<=1&&c.push(Gu.pointOn(g,this.controls));let b=m-y;b>=0&&b<=1&&c.push(Gu.pointOn(b,this.controls))}else{let u=-o/(2*a),d=Math.sqrt(o**2-4*a*l)/(2*a),A=u+d;A>=0&&A<=1&&c.push(Gu.pointOn(A,this.controls));let h=u-d;h>=0&&h<=1&&c.push(Gu.pointOn(h,this.controls))}return c}buildConverxHull(e=vt.eps){let r=[...this.controls],i=[],n=r[0],s=1;do{let a=r[s%r.length];this.eqPP(n,a,e)||i.push(new Ge(n,a)),n=a,s++}while(n!==r[0]);if(i.length===0)throw Error("buildConverxHull(diff = DoubleKit.eps)");return cn.build7(i).asClose()}getExtremePoints(e){if(!e)return a(this.controls);let r=e.start(),i=e.end(),n=i.x-r.x,s=i.y-r.y;if(Math.abs(n)<=vt.eps||Math.abs(s)<=vt.eps)return a(this.controls);{let o=s/n;if(this.controls.length===3){r.equals1(i)&&(i=r.add1(1,0));let l=i.y-r.y,c=r.x-i.x,u=-l*r.x-c*r.y,d=Math.sqrt(1/(l**2+c**2));l*=d,c*=d,u*=d;let A=this.controls.map(p=>l*p.x+c*p.y+u),h=A[0]-2*A[1]+A[2],f=A[1]-A[0]-o/2;if(h!==0){let p=-f/h;if(vt.greater(p,0)&&vt.less(p,1))return[Gu.pointOn(p,this.controls)]}}else if(this.controls.length===4)return this.getPointsBySlope(o)}return[];function a(o){let l,c;if(o.length===3){let[h,f,p]=o;l=ND(h,f,p,"x"),c=ND(h,f,p,"y")}else if(o.length===4){let[h,f,p,m]=o;l=RD(h,f,p,m,"x"),c=RD(h,f,p,m,"y")}l.sort((h,f)=>f-h),c.sort((h,f)=>f-h);let u=l.pop()||1,d=c.pop()||1,A=[];for(;u!==1||d!==1;)vt.eq(u,d)?(u=l.pop()||1,d=c.pop()||1):u<d?(A.push(Gu.pointOn(u,o)),u=l.pop()||1):(A.push(Gu.pointOn(d,o)),d=c.pop()||1);return A}}getToLineMaxDis2(e){let r=this.getExtremePoints(e),i=e.distance2(this.start()),n=e.distance2(this.end()),s=Math.max(i,n);return r.forEach(o=>a(e.distance2(o))),s;function a(o){s=Math.max(s,o)}}getToLineMinAndMaxDis_Controls(e){let r=e.start(),i=e.end();e.start().equals1(e.end())&&(i=r.add1(1,0));let n=i.y-r.y,s=r.x-i.x,a=-n*r.x-s*r.y,o=Math.sqrt(1/(n**2+s**2));n*=o,s*=o,a*=o;let l=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY;return this.controls.forEach(u=>{let d=n*u.x+s*u.y+a;d<l&&(l=d),d>c&&(c=d)}),{minDis:l,maxDis:c}}getPercentInLine(e){let r=[],i=[],n=this.controls,s=e.start(),a=e.end(),o=a.y-s.y,l=s.x-a.x,c=-o*s.x-l*s.y,u=Math.sqrt(1/(o**2+l**2));if(o*=u,l*=u,c*=u,o**2+l**2<=0)return r;if(n.length===3){let[d,A,h]=n,f=o*(d.x-2*A.x+h.x)+l*(d.y-2*A.y+h.y),p=2*(o*(A.x-d.x)+l*(A.y-d.y)),m=o*d.x+l*d.y+c;i=Xme(f,p,m)}else if(n.length===4){let[d,A,h,f]=n,p=f.sub(h.mul(3)).add(A.mul(3)).sub(d),m=d.sub(A.mul(2)).add(h).mul(3),y=A.sub(d).mul(3),g=d,b=o*p.x+l*p.y,E=o*m.x+l*m.y,w=o*y.x+l*y.y,x=o*g.x+l*g.y+c,I=Math.sqrt(1/(b**2+E**2));b*=I,E*=I,w*=I,x*=I,i=qme(b,E,w,x)}else throw Error("not support getBeizerPointInLine");return i.forEach(d=>{d>=0&&d<=1&&r.push(d)}),r}reverse(){return new Gu(this.controls.slice().reverse())}},zp,sV=(zp=class{constructor(){this.textCache=new Map,this.numCache=new Array(20),this.boxCache=new Array(4),this.textOffsetCache=new Array(9),this.BuildLineCache=new Array(7),this.BuildTrackCache=new Array(7),this.BuildViaCache=new Array(11),this.BuildBoxCache=new Array(10),this.BuildArcCache=new Array(10),this.BuildArcTrackCache=new Array(10),this.BuildTextCache=new Array(7),this.BuildPadStyleCache=new Array(4),this.BuildPadCache=new Array(12),this.ARRAY1=new Array(1),this.ARRAY2=new Array(2),this.ARRAY3=new Array(3),this.ARRAY4=new Array(4),this.ARRAY5=new Array(5),this.ARRAY6=new Array(6),this.ARRAY7=new Array(7),this.ARRAY8=new Array(8),this.ARRAY9=new Array(9),this.ARRAY10=new Array(10),this.ARRAY11=new Array(11),this.ARRAY12=new Array(12),this.textOffsetCache[0]=We.ORIGIN,this.textOffsetCache[1]=new We(0,-.5),this.textOffsetCache[2]=new We(0,-1),this.textOffsetCache[3]=new We(-.5,0),this.textOffsetCache[4]=new We(-.5,-.5),this.textOffsetCache[5]=new We(-.5,-1),this.textOffsetCache[6]=new We(-1,0),this.textOffsetCache[7]=new We(-1,-.5),this.textOffsetCache[8]=new We(-1,-1)}static getCache(){return zp.instance==null&&(zp.instance=new zp),zp.instance}},zp.instance=null,zp),Ge=class x1 extends yC{constructor(e,r){super(),this._a=null,this._b=null,this._c=null,this.__bbox=null,this._hashed=null,this._direct=null,this._start=e,this._end=r}get a(){return this._a===null&&(this._start.equals1(this._end)?(this._a=NaN,this._b=NaN,this._c=NaN):(this._a=this._end.y-this._start.y,this._b=this._start.x-this._end.x,this._c=this._end.x*this._start.y-this._start.x*this._end.y)),this._a}get b(){return this._b===null&&(this._start.equals1(this._end)?(this._a=NaN,this._b=NaN,this._c=NaN):(this._a=this._end.y-this._start.y,this._b=this._start.x-this._end.x,this._c=this._end.x*this._start.y-this._start.x*this._end.y)),this._b}get c(){return this._c===null&&(this._start.equals1(this._end)?(this._a=NaN,this._b=NaN,this._c=NaN):(this._a=this._end.y-this._start.y,this._b=this._start.x-this._end.x,this._c=this._end.x*this._start.y-this._start.x*this._end.y)),this._c}get hashed(){return this._hashed==null&&(this._hashed=this._hashCode()),this._hashed}get direct(){return this._direct==null&&(this._direct=this._end.sub(this._start).normalize()),this._direct}cutLine(e){if(vt.eq(this.distance(e),0)){let r=new x1(this._start,e);return r._a=this._a,r._b=this._b,r._c=this._c,r}return new x1(this._start,e)}get midPoint(){return this._start.add(this._end).mul(.5)}toBezier(){return new br([this._start,this._end])}_hashCode(){let e=31,r=1;return r=e*r+this._start.hashCode(),r=e*r+this._end.hashCode(),r}start(){return this._start}end(){return this._end}center(){let e=this.start(),r=this.end();return e.add(r).mul(.5)}panDistance(e){let r=this._end.x-this._start.x,i=this._end.y-this._start.y,n=this.length();r=r*e/n,i=-i*e/n;let s=new We(this._start.x+i,this._start.y+r),a=new We(this._end.x+i,this._end.y+r);return new x1(s,a)}isPoint(){return this._start.distance2(this._end)<=1e-8}length(){return this._start.distance1(this._end)}toString(){return"Line [start="+this._start+", end="+this._end+"]"}bbox(){if(this.__bbox==null){let e=sV.getCache().boxCache;e[0]=Math.min(this._start.x,this._end.x),e[1]=Math.max(this._start.x,this._end.x),e[2]=Math.min(this._start.y,this._end.y),e[3]=Math.max(this._start.y,this._end.y),this.__bbox=new nu(e[0],e[1],e[2],e[3])}return this.__bbox}multiply3(e){return new x1(this._start.multiply3(e),this._end.multiply3(e))}hashCode(){return this.hashed}equals(e){let r=e;return this.hashed===r.hashed&&this._start.equals(r._start)&&this._end.equals(r._end)}equals1(e){let r=e;return this.hashed===r.hashed&&this._start.equals1(r._start)&&this._end.equals1(r._end)}equals2(e){let r=[this.start(),this.end()],i=[e.start(),e.end()];return Rf(r,i)||Rf(r,i.reverse())}stroke(e,r,i){let n,s,a;this._end.x<this._start.x?(s=this._start.x-this._end.x,a=this._start.y-this._end.y,n=this._end):(s=this._end.x-this._start.x,a=this._end.y-this._start.y,n=this._start);let o=Math.sqrt(s*s+a*a),l=e/2,c,u,d;r===2?(u=-l,d=o+l):(u=0,d=o),r===0||r===2?i===0?c=cn.build5([u,-l,u,l,d,l,d,-l]):c=cn.build5([u,l,u,-l,d,-l,d,l]):i===0?c=cn.build2([gt.build3(new We(u,0),-90,-180,l,l),gt.build3(new We(d,0),90,-180,l,l)]):c=cn.build2([gt.build3(new We(u,0),90,180,l,l),gt.build3(new We(d,0),-90,180,l,l)]);let A=Math.atan2(a,s),h=as.rotate(A).translate1(n);return c.asClose().multiply3(h)}points(e){return[this._start,this._end]}mirrorY(e){return new x1(this.start().mirrorY(e),this.end().mirrorY(e))}reverse(){return new x1(this._end,this._start)}inArea(e,r,i){let n=e.x,s=e.y,a=this._start,o=this._end,l=i==1,c=n-a.x,u=s-a.y,d=n-o.x,A=s-o.y,h=o.x-a.x,f=o.y-a.y,p=new We(-f,h).normalize(),m=h+p.x*r/2,y=f+p.y*r/2,g=m*m+y*y,b=c*c+u*u,E=d*d+A*A,w=Math.abs(c*f-u*h)/2,x=Math.sqrt(h*h+f*f)*r/4;if(w<=x&&b<=g&&E<=g){if(l)return!0;{let I=new We(n,s).sub(o).normalize(),C=new We(n,s).sub(a).normalize(),G=new We(p.x,p.y).cross(I),U=new We(p.x,p.y).cross(C);return G>=0&&U<=0}}else if(l){let I=r/2;return b<=I*I?!0:E<=I*I}else return!1}isParallel(e,r=!1){let i=vt.eq(Math.abs(this.direct.cross(e.direct)),0),n=!r||vt.greatereq(this.direct.dot(e.direct),0);return i&&n}distance2(e){return(this.a*e.x+this.b*e.y+this.c)**2/(this.a**2+this.b**2)}distance2ForPP(e){let{x:r,y:i}=e,{x:n,y:s}=this.start(),{x:a,y:o}=this.end();return((r-n)*(o-s)-(i-s)*(a-n))**2/((o-s)**2+(a-n)**2)}distance(e){return Math.abs(this.a*e.x+this.b*e.y+this.c)/Math.sqrt(this.a**2+this.b**2)}};function Kme(t,e=.05){if(t.length<3)return t.slice();let r=t.slice(0,1),i=(s,a,o)=>Dme(s.x,s.y,a.x,a.y,o.x,o.y);for(;;){r=t.slice(0,1);for(let s=1;s<t.length-1;s+=2)i(t[s],t[s-1],t[s+1])>e&&r.push(t[s]),r.push(t[s+1]);if(r.at(-1).equals1(t.at(-1))||r.push(t.at(-1)),t.length==r.length)break;t=r}let n=t[t.length-1];return r.push(n),r}var Jme=ame(ome());var $me=class{constructor(){this.fac=new vh,this.length=0,this.box=null,this.pt=null,this.i=0}calcBBox(t){for(this.fac.clear(),this.length=t.length,this.box=null,this.pt=null,this.i=0;this.i<this.length;this.i++)this.pt=t[this.i],this.box=this.pt.bbox(),this.fac.ext1(this.box);return this.fac.build1()}},Zme=new $me,cn=class Eo{constructor(e,r){this.__bbox=null,this.primitives=e,this.__bbox=r}static calcBBox(e){return Zme.calcBBox(e)}static build1(e){let r=[],i=null;return _D(e,(n,s)=>{let a=s.start();return i!==null&&!a.equals(i)&&r.push(new Ge(i,a)),r.push(s),i=s.end(),!0}),r.length===0&&i!=null&&r.push(new Ge(i,i)),new Eo(r)}static build2(e){return Eo.build1(v4(e))}static build3(e){let r=[],i=null;return _D(e,(n,s)=>(i!==null&&r.push(new Ge(i,s)),i=s,!0)),new Eo(r)}static build4(e){return this.build3(v4(e))}static build5(e){let r=[];for(let i=0;i<e.length;i+=2)r.push(new We(e[i],e[i+1]));return this.build4(r)}static build6(e){return Eo.build4([e.LL(),e.LR(),e.UR(),e.UL(),e.LL()])}static build7(e){return new Eo(e)}static build8(e){let r=new We(e[0],e[1]),i,n=[],s,a=(o,l)=>o.length==l&&o.every(c=>typeof c=="number");for(let o=2;o<e.length;)switch(typeof e[o]=="string"?s=e[o]:o-=1,s){case"ARC":{let l=e.slice(o+1,o+4);if(!a(l,3))throw new Error("invalid rawData");let c=l[0];i=new We(l[1],l[2]),n.push(gt.build5(r,i,c)),r=i,o+=4;break}case"L":{let l=e.slice(o+1,o+3);if(!a(l,2))throw new Error("invalid rawData");i=new We(l[0],l[1]),n.push(new Ge(r,i)),r=i,o+=3;break}case"C":{let l=e.slice(o+1,o+7);if(!a(l,7))throw new Error("invalid rawData");let c=new We(l[0],l[1]),u=new We(l[2],l[3]);i=new We(l[4],l[5]),n.push(new br([r,c,u,i])),r=i,o+=7;break}default:throw new Error("invalid rawData")}return Eo.build2(n)}static buildBBox(e,r=0){return r===1?Eo.build5([e.minX,e.minY,e.maxX,e.minY,e.maxX,e.maxY,e.minX,e.maxY,e.minX,e.minY]):Eo.build5([e.minX,e.minY,e.minX,e.maxY,e.maxX,e.maxY,e.maxX,e.minY,e.minX,e.minY])}static triangulate(e,r,i=1){if(e.length===1){let l=new Array;e[0].asClose().points2(i,A=>l.push(A));let c,u=l[0],d=[];for(let A=0;A<l.length-2;A+=2){let h=l[A+1],f=l[A+2],p=h.sub(u).normalize().cross(f.sub(u).normalize());if(vt.neq(p,0)){if(c===!0){if(p<0){d.length=0;break}}else if(c===!1){if(p>0){d.length=0;break}}else c=p>0;d.push(u),d.push(h),d.push(f)}l.push(u),u=f}if(d.length!==0){for(let A=0;A<d.length;A+=3)r(d[A],d[A+1],d[A+2]);return}}let n=[],s=[];e.forEach(l=>{n.length!==0&&s.push(n.length/2),l.asClose().points2(i,c=>n.push(c.x,c.y))});let a=Jme.default(n,s),o=[];for(let l=1;l<n.length;l+=2)o.push(new We(n[l-1],n[l]));for(let l=0;l<a.length;l+=3)r(o[a[l]],o[a[l+1]],o[a[l+2]])}lines(e,r){let i=new Array;this.points(e,s=>i.push(s));let n=i[0];for(let s=1;s<i.length;s++){let a=i[s];r(n),r(a),n=a}}triangles(e,r){Eo.triangulate([this],(...i)=>{i.forEach(n=>r(n))},e)}mirror(){let e=[];return this.primitives.forEach(r=>{if(r instanceof Ge)r=new Ge(r.start().mirror(),r.end().mirror());else if(r instanceof gt)r=r.mirror();else if(r instanceof br){let i=r.controls.map(n=>n.mirror());r=new br(i)}else throw new Error("bug");e.push(r)}),new Eo(e,this.__bbox)}getPoints(e){let r=[];for(let i of this.primitives)for(let n of i.points(e))r.push(n);return r}round(e=4){let r=this.primitives.slice();for(let i=0;i<r.length;i++){let n=r[i];if(n instanceof Ge){let s=n.start().round(e),a=n.end().round(e);r[i]=new Ge(s,a)}else if(n instanceof br){let s=n.controls.map(a=>a.round(e));r[i]=new br(s)}else if(n instanceof gt){let s=n.start().round(e),a=n.end().round(e),o=n.sweepAngle;r[i]=gt.build5(s,a,o)}}return new Eo(r,this.__bbox)}simplify(e=.05){let r=[],i=!1,n=[],s=this.closed();if(this.primitives.length<=1)return Eo.build2(this.primitives);let a=()=>{if(n.length>2){let l=Kme(n,e);for(let c=1;c<l.length;c++)r.push(new Ge(l[c-1],l[c]))}else r.push(new Ge(n[0],n[1]));n.length=0,i=!1};for(let l=0;l<this.primitives.length;l++){let c=this.primitives[l];c instanceof Ge?(i?n.push(c.end()):(n.length=0,n.push(c.start(),c.end()),i=!0),l===this.primitives.length-1&&a()):(i&&a(),r.push(c))}let o=new Eo(r,this.__bbox);return s&&!o.closed()&&(o=o.asClose()),o}hasBackLine(){let{primitives:e}=this,r;for(let i=0;i<e.length;i++){let n=e[i];if(n instanceof Ge){if(n.end().equals1(n.start()))continue;if(r&&(n.end().equals1(r.start())||_me(n.end(),r.start(),r.end())))return!0;r=n}else r=null}return!1}area(e=.1){let r=0,i=this.end();return this.primitives.forEach(n=>{let s=n.start(),a=n.end();if(r+=(s.x+i.x)*(s.y-i.y),n instanceof Ge)r+=(a.x+s.x)*(a.y-s.y);else if(n instanceof gt)r+=(a.x+s.x)*(a.y-s.y),r+=Math.PI*n.rx2*n.sweepAngle/180-We.normal(n.center,n.start(),n.end());else if(n instanceof br){let o=s;n.points(e).forEach(l=>{r+=(l.x+o.x)*(l.y-o.y),o=l}),r+=(a.x+o.x)*(a.y-o.y)}i=a}),r/2}closed(e){return this.primitives.length===0?!1:this.start().equals(this.end(),e)}asClose(){let e=this.primitives[0],r=this.primitives[this.primitives.length-1],i=e.start(),n=r.end();if(i.equals(n))return this;{let s=new Array;return su.addAll(s,this.primitives),s.push(new Ge(n,i)),Eo.build2(s)}}closeEndpoint(){let e=this.primitives[0],r=this.primitives[this.primitives.length-1],i=e.start(),n=r.end();if(i.equals1(n))return this;{let s=new Array;return su.addAll(s,this.primitives),s.push(new Ge(n,i)),new Eo(s)}}reverse(){let e=new Array(this.primitives.length);for(let r=0,i=this.primitives.length-1;i>=0;r++,i--){let n=this.primitives[i];if(n instanceof Ge)n=new Ge(n.end(),n.start());else if(n instanceof gt)n=n.exchangeSweep();else if(n instanceof br)n=new br(n.controls.slice().reverse());else throw new Error("bug");e[r]=n}return new Eo(e,this.__bbox)}reverse1(){let e=new Array(this.primitives.length);for(let r=0,i=this.primitives.length-1;i>=0;r++,i--){let n=this.primitives[i];if(n instanceof Ge)n=new Ge(n.end(),n.start());else if(n instanceof gt)n=n.exchangeSweep1();else if(n instanceof br)n=new br(n.controls.slice().reverse());else throw new Error("bug");e[r]=n}return new Eo(e,this.__bbox)}mirrorY(e){let r=[];return this.primitives.forEach(i=>{if(i instanceof Ge)i=i.mirrorY(e);else if(i instanceof gt)i=i.mirrorY(e);else if(i instanceof br){let n=i.controls.map(s=>s.mirrorY(e));i=new br(n)}else throw new Error("bug");r.push(i)}),new Eo(r,this.__bbox)}points(e,r){if(this.primitives.length!==0){for(let i=0;i<this.primitives.length-1;i++){let n=this.primitives[i].points(e);n.pop(),n.forEach(s=>r(s))}this.primitives[this.primitives.length-1].points(e).forEach(i=>r(i))}}points1(e,r){if(this.primitives.length===0)return;for(let n=0;n<this.primitives.length-1;n++){let s=this.primitives[n],a=s instanceof gt?s.points1(e):s.points(e);a.pop(),a.forEach(o=>r(o))}let i=this.primitives[this.primitives.length-1];(i instanceof gt?i.points1(e):i.points(e)).forEach(n=>r(n))}points2(e,r){if(this.primitives.length===0)return;for(let n=0;n<this.primitives.length-1;n++){let s=this.primitives[n],a=s instanceof gt?s.points2():s.points(e);a.pop(),a.forEach(o=>r(o))}let i=this.primitives[this.primitives.length-1];(i instanceof gt?i.points2():i.points(e)).forEach(n=>r(n))}multiply3(e){let r=new Array(this.primitives.length);for(let i=0;i<this.primitives.length;i++)r[i]=this.primitives[i].multiply3(e);return Eo.build7(r)}bbox(){return this.__bbox==null&&(this.__bbox=Eo.calcBBox(this.primitives)),this.__bbox}start(){return this.primitives.length!==0?this.primitives[0].start():null}end(){return this.primitives.length!==0?this.primitives[this.primitives.length-1].end():null}isClose(e){if(this.primitives.length<=1&&!(this.primitives[0]instanceof gt))return!1;{let r=this.primitives[0],i=this.primitives[this.primitives.length-1];return r.start().equals(i.end(),e)}}isEqual(e){if(e instanceof Eo&&e.primitives.length==this.primitives.length){let r=e.primitives.length;for(let i=0;i<r;i++){let n=e.primitives[i],s=this.primitives[i];if(JSON.stringify(n)!=JSON.stringify(s))return!1}return!0}return!1}equals(e){if(!e)return!1;let r=this.primitives,i=e.primitives;if(r.length!=i.length)return!1;if(e.isClose()){let n=0;for(;n<r.length;){let s=r.slice(n).concat(r.slice(0,n));if(Rf(s,i)||Rf(s.reverse(),i))return!0;n++}return!1}else return Rf(this.primitives,e.primitives)}clone(){return Eo.build2(this.primitives)}putItem(e,r){if(!e)return!1;if(e instanceof Eo)return this.mergePolyline(e,r);let i=this.start();if(!i){this.primitives.push(e),this.__bbox=e.bbox();return}let n=this.end();if(i.equals(n,r))return!1;let s=e.start(),a=e.end(),o=!1,l=!1;if(i.equals(s,r))o=!0,l=!1;else if(i.equals(a,r))o=!1,l=!1;else if(n.equals(s,r))o=!1,l=!0;else if(n.equals(a,r))o=!0,l=!0;else return!1;return l?this.primitives.push(o?e.reverse():e):this.primitives.unshift(o?e.reverse():e),this.__bbox=nu.extend2(this.__bbox,e.bbox()),!0}mergePolyline(e,r,i=0){if(!e)return!1;let n=this.start();if(!n){this.primitives.push(...e.primitives),this.__bbox=e.bbox();return}let s=this.end();if(n.equals(s,r))return!1;let a=e.start(),o=e.end(),l=!1,c=!1;if(n.equals(a,r))l=!0,c=!1;else if(n.equals(o,r))l=!1,c=!1;else if(s.equals(a,r))l=!1,c=!0;else if(s.equals(o,r))l=!0,c=!0;else return!1;let u=l?e.reverse():e;return c?this.primitives.push(...u.primitives):this.primitives.unshift(...u.primitives),this.__bbox=nu.extend2(this.__bbox,e.bbox()),!0}deDuplicationPoint(e){let r=this.primitives[this.primitives.length-1].start(),i=this.primitives[this.primitives.length-1].end(),n=e.primitives[0].start(),s=e.primitives[0].end();if(this.primitives[this.primitives.length-1]instanceof Ge&&e.primitives[0]instanceof Ge&&kme([r,i],[n,s])){this.primitives.pop(),e.primitives.shift();let a=[];a.push(new Ge(r,s)),this.primitives.push(...a)}}getMaxBBoxHeightByVec(e){let r=e.normalize(),i=-1/0,n=1/0;if(this.primitives.forEach(a=>{let o=a.start().dot(r),l=a.end().dot(r);if(s(o),s(l),a instanceof gt){let c=e.angleD(We.ORIGIN);if(a.angleIsInArc(c)){let u=a.pointOn(c).dot(r);s(u)}if(a.angleIsInArc(c+180)){let u=a.pointOn(c-180).dot(r);s(u)}}}),i-n<=0)throw new Error("getMaxBBoxHeightByVec");return i-n;function s(a){a>i&&(i=a),a<n&&(n=a)}}getWindingNum(e){let r=this.end(),i=0,{x:n,y:s}=e;for(let o of this.primitives){if(r.y>s?o.bbox().minY>s:o.bbox().maxY<=s){r=o.end();continue}if(o instanceof gt&&(o.isCCW?Math.floor(o.startAngle/90)+1!==Math.ceil(o.endAngle()/90):Math.ceil(o.startAngle/90)-1!==Math.floor(o.endAngle()/90))){let l=o.startAngle,c=o.endAngle();if(o.sweepAngle>0){let u=90;for(;u<=c;)u>l&&(a(gt.build3(o.center,l,u-l,o.rx,o.ry)),l=u),u+=90;l<c&&a(gt.build3(o.center,l,c-l,o.rx,o.ry))}else{let u=270;for(;u>=c;)u<l&&(a(gt.build3(o.center,l,u-l,o.rx,o.ry)),l=u),u-=90;l>c&&a(gt.build3(o.center,l,c-l,o.rx,o.ry))}}else if(o instanceof br){let l=[];nV(o,l),l.forEach(c=>a(c))}else a(o)}return i;function a(o){let l=o.start(),c=o.end();if(r.y>s!=l.y>s&&(r.x>n?l.x>n?i+=l.y>r.y?1:-1:r.y>l.y?(r.x-n)*(l.y-s)-(r.y-s)*(l.x-n)<0&&i--:(r.x-n)*(l.y-s)-(r.y-s)*(l.x-n)>0&&i++:l.x>n&&(r.y>l.y?(r.x-n)*(l.y-s)-(r.y-s)*(l.x-n)<0&&i--:(r.x-n)*(l.y-s)-(r.y-s)*(l.x-n)>0&&i++)),l.y>s!=c.y>s){if(l.x>n)if(c.x>n)i+=c.y>l.y?1:-1;else if(o instanceof Ge)l.y>c.y?(l.x-n)*(c.y-s)-(l.y-s)*(c.x-n)<0&&i--:(l.x-n)*(c.y-s)-(l.y-s)*(c.x-n)>0&&i++;else if(o instanceof gt){let{center:u,isCCW:d,rx2:A}=o,h=(u.x-n)**2+(u.y-s)**2;l.y>c.y?(d?h>A:h<A)&&i--:(d?h<A:h>A)&&i++}else if(o instanceof br){if(eY(o,s)===0)throw new Error("no inters");De[0]>n&&(i+=c.y>l.y?1:-1)}else throw new Error("not support!");else if(c.x>n)if(o instanceof Ge)l.y>c.y?(l.x-n)*(c.y-s)-(l.y-s)*(c.x-n)<0&&i--:(l.x-n)*(c.y-s)-(l.y-s)*(c.x-n)>0&&i++;else if(o instanceof gt){let{center:u,isCCW:d,rx2:A}=o,h=(u.x-n)**2+(u.y-s)**2;l.y>c.y?(d?h>A:h<A)&&i--:(d?h<A:h>A)&&i++}else if(o instanceof br){if(eY(o,s)===0)throw new Error("no inters");De[0]>n&&(i+=c.y>l.y?1:-1)}else throw new Error("not support!")}r=c}}},rD=Math.PI*2;var C8e=Math.PI/2,S8e=Math.sin(Math.PI/180);var ege=4,gt=class Js extends yC{constructor(e,r,i,n,s){super(),this._rx2=null,this._ry2=null,this._svgEnd=null,this._hashed=null,this.__bbox=null,this.rx=e,this.ry=r,this.center=i,this.startAngle=n,this.sweepAngle=s,this._start=We.ORIGIN,this._end=We.ORIGIN,this._start=this.pointOn(n),this._end=this.pointOn(n+s)}get hashed(){return this._hashed==null&&(this._hashed=this._hashCode()),this._hashed}hashCode(){return this.hashed}_hashCode(){let e=31,r=1;return r=e*r+new We(this.rx,this.rx).hashCode(),r=e*r+this.center.hashCode(),r=e*r+new We(this.startAngle,this.sweepAngle).hashCode(),r}get rx2(){return this._rx2==null&&(this._rx2=this.rx*this.rx),this._rx2}get ry2(){return this._ry2==null&&(this._ry2=this.ry*this.ry),this._ry2}get svgEnd(){return this._svgEnd==null&&(this._svgEnd=this.getSvgEnd(this.startAngle,this.sweepAngle,this._start,this._end)),this._svgEnd}getSvgEnd(e,r,i,n){let s=r>=0?-.01:.01,a=e+r;for(;(r>=0&&a>e||r<0&&a<e)&&i.distance2(n)<2e-4;)s*=2,a+=s,n=this.pointOn(a);return n}static build1(e,r,i,n,s,a){Ca.positive(i),Ca.positive(n);let o=e.equals(r);if(o)return new Js(i,n,e,0,s?360:0);{let l=e.x,c=-e.y,u=r.x,d=-r.y,A=a===0,h=(l-u)/2,f=(c-d)/2,p=Math.cos(0),m=Math.sin(0),y=p*h+m*f,g=-m*h+p*f;i=Math.abs(i),n=Math.abs(n);let b=i*i,E=n*n,w=y*y,x=g*g,I=s===A?-1:1,C=(b*E-b*x-E*w)/(b*x+E*w);C=C<0?0:C;let G=I*Math.sqrt(C),U=G*(i*g/n),_=G*-(n*y/i),H=(l+u)/2,Q=(c+d)/2,j=H+(p*U-m*_),$=Q+(m*U+p*_),B=(y-U)/i,M=(g-_)/n,v=(-y-U)/i,N=(-g-_)/n,R,q;q=Math.sqrt(B*B+M*M),R=B,I=M<0?-1:1;let P=Ii.toDegrees(I*Math.acos(R/q));q=Math.sqrt((B*B+M*M)*(v*v+N*N)),R=B*v+M*N,I=B*N-M*v<0?-1:1;let z=R/q,W;z<-1?W=Math.acos(-1):z>1?W=Math.acos(1):W=Math.acos(z);let oe=Ii.toDegrees(I*W);!A&&oe>0?oe-=360:A&&oe<0&&(oe+=360),Ca.normal(P),Ca.normal(oe);let Ae=h*h/b+f*f/E,me=e.distance1(r)/2;i<me&&n<me&&(i*=Math.sqrt(Ae),n*=Math.sqrt(Ae));let ve=o?0:Ii.regularD(-P),Le=o?s?360:0:-oe;return new Js(i,n,new We(j,-$),ve,Le)}}static build2(e,r,i,n,s,a){Ca.positive(n),Ca.positive(s),Ca.normal(r),Ca.normal(i);let o;return r===i?(r=Ii.regularD(r),i=Ii.regularD(i),o=0):(r=Ii.regularD(r),i=Ii.regularD(i),a===1?i<=r&&(i+=360):i>=r&&(r+=360),o=i-r),new Js(n,s,e,Ii.regularD(r),o)}static build3(e,r,i,n,s){return Ca.positive(n),Ca.positive(s),Ca.normal(i),new Js(n,s,e,Ii.regularD(r),i)}static build4(e,r,i,n,s,a){let o=e.angleD(i),l=r.angleD(i);return Js.build2(i,o,l,n,s,a)}static build5(e,r,i){i=Ii.toRadians(i);let n=r.sub(e),s=new We(-n.y,n.x).normalize(),a=Math.abs(i)/2,o;if(a!=0)o=n.length()/2/Math.sin(a);else throw new Error("Can't represent circle!!!");let l=s.rotate(We.ORIGIN,a),c,u;i>0?(c=1,u=r.add(l.scale(o))):(c=0,u=e.sub(l.scale(o)));let d=Ii.toDegrees(e.angle(u)),A=Ii.toDegrees(r.angle(u));return Js.build2(u,d,A,o,o,c)}static buildCircle(e,r,i=0){return Js.build2(e,0,360,r,r,i)}start(){return this._start}end(){return this._end}isLarge(){return Math.abs(this.sweepAngle)>180}sweep(){return this.sweepAngle>=0?1:0}get isCCW(){return this.sweepAngle>=0}endAngle(){return this.startAngle+this.sweepAngle}pointOn(e){e=Ii.regularD(e);let r=this.rx,i=this.ry;if(e===0)return this.center.add1(r,0);if(e===90)return this.center.add1(0,i);if(e===180)return this.center.add1(-r,0);if(e===270)return this.center.add1(0,-i);{let n=this.rx2,s=this.ry2,a=Math.tan(Ii.toRadians(e)),o=a*a,l=Math.sqrt(n*s/(n+s/o)),c=Math.sqrt(n*s/(s+n*o));return e>90&&e<270&&(c=-c),e>180&&e<360&&(l=-l),isNaN(c)&&(c=0),isNaN(l)&&(l=0),this.center.add1(c,l)}}exchangeSweep(){return Js.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle,this.rx,this.ry)}exchangeSweepAndStart(){return Js.build1(this.end(),this.start(),this.rx,this.ry,this.isLarge(),this.sweepAngle>=0?0:1)}exchangeSweep1(){return Js.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle+.01,this.rx,this.ry)}mirrorY(e){let r=this.start(),i=this.end();return r.equals(i)?Js.build3(this.center.mirrorY(),0,360,this.rx,this.ry):Js.build1(r.mirrorY(e),i.mirrorY(e),this.rx,this.ry,this.isLarge(),this.sweepAngle>=0?0:1)}mirror(e=We.ORIGIN){let r=this.start(),i=this.end();return r.equals(i)?Js.build3(this.center.mirror(e),0,360,this.rx,this.ry):Js.build1(r.mirror(e),i.mirror(e),this.rx,this.ry,this.isLarge(),this.sweep())}sectorArea(){return Math.abs(this.sweepAngle)/360*Math.PI*this.rx*this.ry}area(){let e=C4.area(this.center,this._start,this.pointOn(this.endAngle()));return this.sectorArea()-e}multiply3(e){let r;e.isMirrored()?r=-this.sweepAngle:r=this.sweepAngle;let i;return e.equals(as.ROT_90)?i=Ii.regularD(this.startAngle+90):e.equals(as.ROT_N90)?i=Ii.regularD(this.startAngle-90):i=Ii.transformD(this.startAngle,e),Js.build3(this.center.multiply3(e),i,r,e.iScale*this.rx,e.iScale*this.ry)}angleIsInArc(e){return e=Ii.regularD(e),this.sweepAngle>0?(e<this.startAngle&&(e+=360),this.endAngle()>e):(e>this.startAngle&&(e-=360),this.endAngle()<e)}toBezier(){if(Math.abs(this.sweepAngle)>90)throw new Error("not support!");let e=this.start(),r=this.end(),i=Ii.toRadians(this.sweepAngle)/2,n=4/3*(1-Math.cos(i))/Math.sin(i)*this.rx;return new br([e,e.add(new We(n,0).multiply3(as.rotateD(this.startAngle+90))),r.add(new We(n,0).multiply3(as.rotateD(this.endAngle()-90))),r])}toBezier2(){let e=[];i(this,90);let r=[];return e.forEach(n=>r.push(n.toBezier())),r;function i(n,s){if(Math.abs(n.sweepAngle)>s){let a=n.sweepAngle/2;i(Js.build3(n.center,n.startAngle,a,n.rx,n.ry),s),i(Js.build3(n.center,n.startAngle+a,a,n.rx,n.ry),s)}else e.push(n)}}buildBBox(){let e=sV.getCache().boxCache,r=this.startAngle+this.sweepAngle;if(e[0]=Math.min(this._start.x,this._end.x),e[1]=Math.max(this._start.x,this._end.x),e[2]=Math.min(this._start.y,this._end.y),e[3]=Math.max(this._start.y,this._end.y),this.sweepAngle>0){let i=0;for(;i<r;){if(i>this.startAngle){let n=this.pointOn(i);e[0]=Math.min(e[0],n.x),e[1]=Math.max(e[1],n.x),e[2]=Math.min(e[2],n.y),e[3]=Math.max(e[3],n.y)}i+=90}}else if(this.sweepAngle<0){let i=360;for(;i>r;){if(i<this.startAngle){let n=this.pointOn(i);e[0]=Math.min(e[0],n.x),e[1]=Math.max(e[1],n.x),e[2]=Math.min(e[2],n.y),e[3]=Math.max(e[3],n.y)}i-=90}}return new nu(e[0],e[1],e[2],e[3])}bbox(){return this.__bbox==null&&(this.__bbox=this.buildBBox()),this.__bbox}length(){return Math.abs(this.rx*this.sweepAngle*Math.PI/180)}toString(){return o2.format("Arc [start=%s, end=%s, rx=%s, ry=%s, center=%s, startAngle=%s, sweepAngle=%s]",this._start,this._end,this.rx,this.ry,this.center,this.startAngle,this.sweepAngle)}stroke(e,r,i){let n=e/2,s=this.rx+n,a=this.ry+n,o=this.rx-n,l=this.ry-n,c=new as;o<0&&(o=-o,c=c.multiply3(as.MIRROR_Y)),l<0&&(l=-l,c=c.multiply3(as.MIRROR_X)),o===0&&(o=.001),l===0&&(l=.001),c=c.setOrigin1(this.center);let u,d;switch(i===this.sweep()?(u=Js.build3(this.center,this.startAngle,this.sweepAngle,s,a),d=Js.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle,o,l)):(u=Js.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle,s,a),d=Js.build3(this.center,this.startAngle,this.sweepAngle,o,l)),d=d.multiply3(c),r){case 1:{let A=i===1?180:-180,h=i===this.sweep()?this.pointOn(this.endAngle()):this.pointOn(this.startAngle),f=i===this.sweep()?this.pointOn(this.startAngle):this.pointOn(this.endAngle()),p=u.pointOn(u.endAngle()).angleD(h),m=d.pointOn(d.endAngle()).angleD(f);return cn.build2([u,Js.build3(h,p,A,n,n),d,Js.build3(f,m,A,n,n)])}default:return cn.build2([u,d])}}points2(){let e=Math.ceil(Math.abs(this.sweepAngle)/ege),r=this.sweepAngle/e,i=[this._start];for(let n=1;n<e;n++)i.push(this.pointOn(this.startAngle+r*n));return i.push(this._end),i}points1(e){let r=Math.max(this.rx,this.ry);if(r<=e)return[this.start(),this.svgEnd];let i=(r-e)/r,n=Math.ceil(Math.abs(this.sweepAngle/Ii.toDegrees(Math.acos(i))/2)),s=new Array(n+1),a=this.sweepAngle/n,o=this.startAngle;for(let l=0;l<=n;l++,o+=a)s[l]=this.pointOn(o);return s}points(e){let r=Math.max(this.rx,this.ry);if(e=Math.abs(e),r<=e)return[this.start(),this.svgEnd];e=Math.max(e,r*1e-5),e=Math.min(e,r*(1-Math.SQRT1_2));let i=(r-e)/r,n=Math.ceil(Math.abs(this.sweepAngle/Ii.toDegrees(Math.acos(i))/2));n=Math.max(n,2);let s=new Array(n+1),a=this.sweepAngle/n,o=this.startAngle+a;s[0]=this.start();for(let l=1;l<n;l++,o+=a)s[l]=this.pointOn(o);return s[n]=this.end(),s}panDistance(e){return this.sweepAngle>0?new Js(this.rx-e,this.ry-e,this.center,this.startAngle,this.sweepAngle):new Js(this.rx+e,this.ry+e,this.center,this.startAngle,this.sweepAngle)}panDistance1(e){if(this.sweepAngle>0){let r=this.rx-e;return r<0?(r=Math.abs(r),Js.build3(this.center,this.startAngle-180,this.sweepAngle,r,r)):new Js(r,r,this.center,this.startAngle,this.sweepAngle)}else{let r=this.rx+e;return r<0?(r=Math.abs(r),Js.build3(this.center,this.startAngle-180,this.sweepAngle,r,r)):new Js(r,r,this.center,this.startAngle,this.sweepAngle)}}get bulge(){let e=Math.abs(Ime(this.sweepAngle,3))/180*Math.PI;return Math.tan(e/4)}get midPoint(){let e=Ii.toRadians(this.startAngle),r=Ii.toRadians(this.endAngle()),i=this.sweep(),n=this.center,s=this.rx;if(i==1)if(r>e){let a=(r-e)/2+e;return n.add(new We(Math.cos(a),Math.sin(a)).mul(s))}else{if(r==e)return n.add(new We(Math.cos(Math.PI*3/2),Math.sin(Math.PI*3/2)).mul(s));{let a=(r+rD-e)/2+e;return n.add(new We(Math.cos(a),Math.sin(a)).mul(s))}}else if(r>e){let a=(e+rD-r)/2+r;return n.add(new We(Math.cos(a),Math.sin(a)).mul(s))}else{if(r==e)return n.add(new We(Math.cos(Math.PI*3/2),Math.sin(Math.PI*3/2)).mul(s));{let a=(e-r)/2+r;return n.add(new We(Math.cos(a),Math.sin(a)).mul(s))}}}get svgPathData(){return[{type:"M",values:[this._start.x,this._start.y]},{type:"A",values:[this.rx,this.ry,0,this.isLarge()?1:0,this.isCCW,this._end.x,this._end.y]}]}equals(e){let r=Ii.regularD(this.startAngle),i=Ii.regularD(this.sweepAngle),n=Ii.regularD(e.startAngle),s=Ii.regularD(e.sweepAngle);return Rf([this.rx,this.ry,this.center,Math.abs(i)],[e.rx,e.ry,e.center,Math.abs(s)])&&(Rf([i,r],[s,n])||Rf([Ii.regularD(r+i)],[n]))}equals1(e){let r=Ii.regularD(this.startAngle),i=Ii.regularD(this.sweepAngle),n=Ii.regularD(e.startAngle),s=Ii.regularD(e.sweepAngle);return Rf([this.rx,this.ry,this.center,Math.abs(i)],[e.rx,e.ry,e.center,Math.abs(s)])&&(Rf([i,r],[s,n])||Rf([Ii.regularD(r+i)],[n]))}inArea(e,r){let i=e.x,n=e.y,s=this.center,a=this.rx,o=Ii.toRadians(this.startAngle);this.sweep()==0&&(o=Ii.toRadians(this.endAngle()));let l=Ii.toRadians(this.endAngle());this.sweep()==0&&(l=Ii.toRadians(this.startAngle));let c=a-r/2,u=a+r/2;var d=i-s.x,A=n-s.y,h=Math.atan2(A,d);if(h<0&&(h+=rD),o<=l&&h>=o&&h<=l||o>l&&(h>=o&&h<=rD||h>=0&&h<=l)||o==l){var f=Math.sqrt(d*d+A*A);return f<=u&&f>=c}else{var f=(u+c)/2,p=new We(s.x+Math.cos(o)*f,s.y+Math.sin(o)*f),m=new We(s.x+Math.cos(l)*f,s.y+Math.sin(l)*f),y=i-p.x,g=n-p.y,b=i-m.x,E=n-m.y;return y*y+g*g<=r*r/4?!0:b*b+E*E<=r*r/4}}isCircle(){return(vt.eq(Math.abs(this.sweepAngle),360)||this._start.equals1(this._end))&&this.rx==this.ry}reverse(){return Js.build3(this.center,this.endAngle(),-this.sweepAngle,this.rx,this.ry)}getAngle(){let e=Math.PI*2;return this.sweep()==1?(this.endAngle()-this.startAngle+e)%e:(this.startAngle-this.endAngle()+e)%e}isValid(){return this.rx>0&&this.ry>0}},aV=new ArrayBuffer(24),i4=new Float64Array(aV),qx=new Int32Array(aV),Wo,T8e=(Wo=class{static normal(e,r,i){let n=r.sub(e),s=i.sub(r);return n.cross(s)}constructor(e,r,i){this.x=Ca.normal(e),this.y=Ca.normal(r),this.z=Ca.normal(i),i4[0]=e,i4[1]=r,i4[2]=i,this.hashed=qx[0]^qx[1]^qx[2]^qx[3]^qx[4]^qx[5]}isZeroVector(){return this.x===0&&this.y===0&&this.z===0}hashCode(){return this.hashed}equals(e){return e instanceof Wo?e.x===this.x&&e.y===this.y&&e.z===this.z:!1}cross(e){return new Wo(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){var e=this.length();return new Wo(this.x/e,this.y/e,this.z/e)}sub(e){return new Wo(this.x-e.x,this.y-e.y,this.z-e.z)}add(e){return new Wo(this.x+e.x,this.y+e.y,this.z+e.z)}scale(e){return new Wo(this.x*e,this.y*e,this.z*e)}neg(){return new Wo(-this.x,-this.y,-this.z)}multiply4(e){var r=this.x*e.data[0]+this.y*e.data[4]+this.z*e.data[8]+e.data[12],i=this.x*e.data[1]+this.y*e.data[5]+this.z*e.data[9]+e.data[13],n=this.x*e.data[2]+this.y*e.data[6]+this.z*e.data[10]+e.data[14],s=this.x*e.data[3]+this.y*e.data[7]+this.z*e.data[11]+e.data[15];return s!=0?new Wo(r/s,i/s,n/s):new Wo(r,i,n)}rotate(e,r){return this.multiply4(eV.rotateAxis(e,r))}toVector2(){return new We(this.x,this.y)}},Wo.ORIGIN=new Wo(0,0,0),Wo.X_UNIT_VECTOR=new Wo(1,0,0),Wo.Y_UNIT_VECTOR=new Wo(0,1,0),Wo.Z_UNIT_VECTOR=new Wo(0,0,1),Wo);var ao=class t2{static build(e){return e instanceof cn?new t2([new Ko([e])]):e instanceof Ko?new t2([e]):e}static buildByPolygon(e){return e?new t2([e]):new t2([])}static buildByStroke(e,r,i=1,n){return this.buildByPolygon(Ko.buildByStroke(e,r,i,tM,n))}static buildCircle(e,r){return this.buildByPolygon(Ko.buildCircle(e,r))}static buildRect(e){return this.buildByPolygon(Ko.buildRect(e))}static buildBBox(e){return this.buildByPolygon(Ko.buildBBox(e))}constructor(e){this.items=e.slice()}multiply3(e){return new t2(this.items.map(r=>r.multiply3(e)))}bbox(){return this._bbox||(this._bbox=this.items.reduce((e,r)=>e.ext1(r.bbox()),new vh).build1()),this._bbox}toPolylineGroups(){return this.items.map(e=>e.toPolylineGroup())}},vs,Xn=(vs=class{static isHexFormate(e){return!e||typeof e!="string"?!1:/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)}static of1(e){return this.of2(e>>16&255,e>>8&255,e&255)}static of2(e,r,i,n=255){return new vs(e/255,r/255,i/255,n/255)}static of3(e){e.startsWith("#")&&(e=e.substr(1));let r=e.length;if(r==3)return new vs(parseInt(e[0],16)/15,parseInt(e[1],16)/15,parseInt(e[2],16)/15);if(r==6)return new vs(parseInt(e.substr(0,2),16)/255,parseInt(e.substr(2,2),16)/255,parseInt(e.substr(4,2),16)/255);if(r==8)return new vs(parseInt(e.substr(0,2),16)/255,parseInt(e.substr(2,2),16)/255,parseInt(e.substr(4,2),16)/255,parseInt(e.substr(6,2),16)/255);throw new Error("invalid color string")}static of4(e){let r=parseInt(e.r*255+"").toString(16),i=parseInt(e.g*255+"").toString(16),n=parseInt(e.b*255+"").toString(16);return r.length<2&&(r="0"+r),i.length<2&&(i="0"+i),n.length<2&&(n="0"+n),("#"+r+i+n).toUpperCase()}static of5(e,r){if(e.startsWith("#")&&(e=e.substr(1)),e.length==3)return new vs(parseInt(e[0],16)/15,parseInt(e[1],16)/15,parseInt(e[2],16)/15,r);if(e.length==6)return new vs(parseInt(e.substr(0,2),16)/255,parseInt(e.substr(2,2),16)/255,parseInt(e.substr(4,2),16)/255,r);throw new Error("invalid color string")}static of6(e,r){return new vs(e.r,e.g,e.b,r)}static of7(e){return e==null?null:vs.of3(e)}constructor(e,r,i,n=1){this.r=Ca.positiveOr0(e),this.g=Ca.positiveOr0(r),this.b=Ca.positiveOr0(i),this.alpha=n}hashCode(){return this.r+this.g+this.b+this.alpha}equals(e,r=!1){let i=this.r===e.r&&this.g===e.g&&this.b===e.b;return r?i:i&&this.alpha===e.alpha}add(e,r,i,n){return new vs(Math.max(0,Math.min(1,this.r+e)),Math.max(0,Math.min(1,this.g+r)),Math.max(0,Math.min(1,this.b+i)),Math.max(0,Math.min(1,this.alpha+n)))}mul(e){return new vs(Math.max(0,Math.min(1,this.r*e)),Math.max(0,Math.min(1,this.g*e)),Math.max(0,Math.min(1,this.b*e)),this.alpha)}mul1(e){return new vs(Math.max(0,this.r*e),Math.max(0,this.g*e),Math.max(0,this.b*e),this.alpha)}getData(){return[this.r,this.g,this.b,this.alpha]}toString(){let e=(this.r*255).toString(16),r=(this.g*255).toString(16),i=(this.b*255).toString(16);return e.length<2&&(e="0"+e),r.length<2&&(r="0"+r),i.length<2&&(i="0"+i),"#"+e.substr(0,2)+r.substr(0,2)+i.substr(0,2)}toString1(){let e=(this.r*255).toString(16),r=(this.g*255).toString(16),i=(this.b*255).toString(16),n=(this.alpha*255).toString(16);return e.length<2&&(e="0"+e),r.length<2&&(r="0"+r),i.length<2&&(i="0"+i),n.length<2&&(n="0"+n),"#"+e.substr(0,2)+r.substr(0,2)+i.substr(0,2)+n.substr(0,2)}toRGBA(){let e=this.r*255,r=this.g*255,i=this.b*255;return[e,r,i,this.alpha]}toRGBAString(){let e=this.r*255,r=this.g*255,i=this.b*255;return`rgba(${e},${r},${i},${this.alpha})`}isWHITE(){return this.r===1&&this.g===1&&this.b===1&&this.alpha===1}},vs.WHITE=new vs(1,1,1,1),vs.BLACK=new vs(0,0,0,1),vs.RED=new vs(1,0,0,1),vs.GREEN=new vs(0,1,0,1),vs.BLUE=new vs(0,0,1,1),vs.Gray=vs.of3("#9966ff"),vs.Silver=vs.of3("#D2D2D2"),vs.Golden=vs.of3("#DCAA14"),vs.Pink=vs.of3("#ffaec9"),vs),oY=!1,oV=class{onRTreeBBox(t){}onResultSide(t){}onOriginSide(t){}onSplitedSide(t){}onDebugSide(t){}onSweep(t,e,r,i,n,s){}onIntersect(t,e,r){}onSegment(t,e,r,i,n,s){}onSegment1(t,e,r){if(oY){let i=new We(t.getX(r),r),n=new We(e.getX(r),r);this.onSegment(i,t.weight,t,n,e.weight,e)}else this.onSegment(t.start,t.weight,t,e.end,e.weight,e)}onSweep1(t,e,r){if(oY){let i=new We(t.getX(r),r),n=new We(e.getX(r),r);this.onSweep(i,t.weight,t,n,e.weight,e)}else this.onSweep(t.start,t.weight,t,e.end,e.weight,e)}},iC=class extends oV{constructor(t){super(),this.plGrps=new Array,this.debug=t}onPolylineGroup(t,e){this.plGrps.push(t)}},bC=class{constructor(t){this.cache={},this.levels=t,this.result=new Array(t),this.weights=new Array(t),this.maxIdx=t-1,this.rule=this.decide.bind(this);let e=1;for(let r=0;r<t;r++)this.weights[r]=e,e*=50}weight(t){return this.weights[t]}decide(t){t=Math.abs(t);let e=this.cache[t];if(e===void 0){let r=t;for(let i=this.maxIdx;i>=0;i--){let n=this.weights[i],s=t/n|0,a=t%n;a>(n/2|0)?(t=n-a,s++):t=a,this.result[i]=s>0}e=this.decide1(this.result),this.cache[r]=e}return e}},tge=t=>t!==0;var rge=new class extends bC{decide1(t){return t[0]||t[1]}}(2),gD=new class extends bC{decide1(t){return t[0]&&!t[1]}}(2),yD=new class extends bC{decide1(t){return t[0]&&t[1]}}(2),bD=new class extends bC{decide1(t){return t[0]&&!t[1]||!t[0]&&t[1]}}(2),ige=(t=>(t[t.UNMARKED=0]="UNMARKED",t[t.INSIDE=1]="INSIDE",t[t.OUTSIDE=2]="OUTSIDE",t[t.INVALID=3]="INVALID",t))(ige||{}),y2=class r2{constructor(e,r,i,n,s,a,o){this.inters=[],this.connect=new Array,this.previous=null,this.next=null,this.finalGrp=-1,this.trans=NaN,this.outsideWeight=0,this.insideWeight=0,this.invalidWeight=0,this._confidence=0,this._confidence_y=NaN,this._x=NaN,this._x_y=NaN,this.status=0,this.bo=e,this.shape=r,this.baseWeight=i,n.y>s.y?this.weight=-i:n.y==s.y?this.weight=0:this.weight=i,this.start=n,this.end=s,this.polyGrp=a,this.polyIndex=o,this._bbox=new vh().ext1(r.bbox()).ext2(n).ext2(s).build1(),this.inters.push(n),this.inters.push(s);let l=31,c=1;c=l*c+this.polyGrp,c=l*c+this.polyIndex,this._hashcode=c}static rebuild(e,r,i){if(e instanceof Ge||r.distance2(i)<1e-6)return new Ge(r,i);if(e instanceof gt){let n=e,s=e.bbox().center().x,a;r.y>i.y?a=s>n.center.x?0:1:a=s>n.center.x?1:0;let o=r.angleD(n.center),l=i.angleD(n.center);return gt.build2(n.center,o,l,n.rx,n.ry,a)}else throw new Error("not supported operation")}updateBbox(){this._bbox=new vh().ext2(this.start).ext2(this.end).build1()}is(e,r){return e===this.polyGrp&&r===this.polyIndex}confidence(e){if(this._confidence_y!=e){let r=this._bbox.height();if(r!==0)if(Math.abs(e-this._bbox.maxY)>5e-4&&Math.abs(e-this._bbox.minY)>5e-4){let i=1-Math.abs(2*e-this._bbox.maxY-this._bbox.minY)/r;this._confidence=i*1e4|0}else this._confidence=0;else this._confidence=1;this._confidence_y=e}return this._confidence}needCountWeight(){return this.outsideWeight+this.insideWeight+this.invalidWeight<5e3}revokeOutside(e){let r=this.confidence(e);return this.outsideWeight-=r,this.invalidWeight+=r,r}revokeInside(e){let r=this.confidence(e);return this.insideWeight-=r,this.invalidWeight+=r,r}setOutside(e){let r=this.confidence(e);return this.outsideWeight+=r,r}setInside(e){let r=this.confidence(e);return this.insideWeight+=r,r}setInvalid(e){let r=this.confidence(e);return this.invalidWeight+=r,r}prevNot0(){let e=this.previous;for(;e!=null&&e!=this;){if(e.weight!=0)return e;e=e.previous}return null}nextNot0(){let e=this.next;for(;e!=null&&e!=this;){if(e.weight!=0)return e;e=e.next}return null}getX(e){if(this.bo!==null)return(this._x_y!=e||isNaN(this._x))&&(hge(this,e)>0?this._x=De[0]:this._x=NaN,this._x_y=e),this._x;throw new Error("not supported operation")}voteStatus(){return this.outsideWeight>this.insideWeight&&this.outsideWeight>this.invalidWeight?2:this.insideWeight>this.outsideWeight&&this.insideWeight>this.invalidWeight?1:this.invalidWeight>this.outsideWeight&&this.invalidWeight>this.insideWeight?3:0}reverse(e){if(e===2)if(this.start.y>this.end.y){let r=r2.rebuild(this.shape,this.end,this.start),i=new r2(this.bo,r,this.baseWeight,this.end,this.start,this.polyGrp,this.polyIndex);return su.addAll(i.connect,this.connect),i}else return this;else if(e===1)if(this.start.y<this.end.y){let r=r2.rebuild(this.shape,this.end,this.start),i=new r2(this.bo,r,this.baseWeight,this.end,this.start,this.polyGrp,this.polyIndex);return su.addAll(i.connect,this.connect),i}else return this;return this}isNeedScan(e){return this.needCountWeight()&&this.confidence(e)>0}hashCode(){return this._hashcode}equals(e){return e instanceof r2?!(this.polyGrp!==e.polyGrp||this.polyIndex!==e.polyIndex):!1}bbox(){return this._bbox}toString(){return o2.format("(%d,%d,%d) (%d,%d,%d) %s %s",this.polyGrp,this.polyIndex,this.weight,this.outsideWeight,this.invalidWeight,this.insideWeight,this.start,this.end)}};function nge(t,e){let r=t.bbox(),i=e.bbox(),n=(r.minY+r.maxY)/2,s=(i.minY+i.maxY)/2;return n-s}function sge(t,e){let r=t.bbox(),i=e.bbox(),n=(r.minX+r.maxX)/2,s=(i.minX+i.maxX)/2;return n-s}var Wx=class{constructor(t){if(this.__bbox=null,typeof t<"u")if(t instanceof Array){this.__items=[];for(let e of t)this.add(e)}else this.__items=t,this.__bbox=t.bbox();else this.__items=[]}add(t){if(this.__items instanceof Array)this.__items.push(t),this.__bbox=nu.extend2(this.__bbox,t.bbox());else throw new Error("can't insert multiple item into leaf node")}items(){return this.__items}bbox(){if(this.__bbox!==null)return this.__bbox;throw new Error("bug")}},oC=class{constructor(t){this.changed=!1,this.root=new Wx,this.capacity=t,this.capacity2=t*t,this.itemList=[]}size(){return this.itemList.length}items(){return this.flushWhenNeed(),this.itemList}add(t){this.itemList.push(t),this.changed=!0}remove(t){su.remove(this.itemList,t),this.changed=!0}clear(){this.changed=!1,this.root=new Wx,this.itemList.length=0}flushWhenNeed(){if(this.changed){let t=new Array;for(let e of this.itemList)t.push(new Wx(e));for(;;){let e=this.organize(t);if(e.length>1)t=e;else break}this.root=new Wx(t),this.changed=!1}}organize(t){L1(t,sge,0,t.length);let e=t.length,r=[];for(let i=0;i<e;)if(i+this.capacity2<=e){let n=i+this.capacity2;L1(t,nge,i,n);for(let s=i;s<n;s+=this.capacity){let a=new Wx(t.slice(s,s+this.capacity));r.push(a)}i=i+this.capacity*this.capacity}else{let n=new Wx(t.slice(i,i+this.capacity));r.push(n),i=i+this.capacity}return r}search(t){this.flushWhenNeed();let e=[],r=[];for(r.push(this.root);;){let i=r.shift();if(typeof i<"u"){let n=i.items();if(n instanceof Array){for(let s of n)if(!t.isSeparated(s.bbox())){let a=s.items();a instanceof Array?r.push(s):e.push(a)}}else t.isSeparated(i.bbox())||e.push(n)}else break}return e}walker(t){this.flushWhenNeed(),this._walker(this.root,0,t)}_walker(t,e,r){this.flushWhenNeed();let i=t.items();if(i instanceof Array)for(let n of i)this._walker(n,e+1,r);else r(i,e)}bbox(){return this.flushWhenNeed(),this.root.bbox()}};function n4(t,e){age(t.iterator(),e)}function age(t,e){let r=0;for(;t.hasNext();){let i=t.next();e(r++,i)}}var iD=new Error("list is empty"),nD=class{constructor(t,e){this.prev=null,this.next=null,this.parent=t,this.item=e}insertAfter(t){t.next=this.next,this.next=t,t.prev=this,t.next!==null&&(t.next.prev=t)}insertBefore(t){t.prev=this.prev,this.prev=t,t.next=this,t.prev!==null&&(t.prev.next=t)}remove(){this.prev!==null&&(this.prev.next=this.next),this.next!==null&&(this.next.prev=this.prev)}set(t){this.item=t}},oge=class{constructor(t){this._next=t}hasNext(){return this._next!==null}next(){let t=this._next;if(t!==null)return this._next=t.next,t.item;throw new Error("iterator is null")}},lge=class{constructor(t){this._next=t}hasNext(){return this._next!==null}next(){let t=this._next;if(t!==null)return this._next=t.next,t;throw new Error("iterator is null")}},C1=class{constructor(){this.first=null,this.last=null,this.cnt=0}add(t){return this.addLast(t)}push(t){return this.addLast(t)}pop(){return this.removeLast()}shift(){return this.removeFirst()}removeFirst(){let t=this.first;if(t===null)throw iD;return this.remove(t),t.item}removeLast(){let t=this.last;if(t===null)throw iD;return this.remove(t),t.item}addLast(t){return this.first===null||this.last===null?(this.first=new nD(this,t),this.last=this.first,this.cnt=1,this.first):this.insertAfter(this.last,t)}addFirst(t){if(this.first===null||this.last===null){let e=new nD(this,t);return this.first=e,this.last=e,this.cnt++,e}else return this.insertBefore(this.first,t)}getFirst(){if(this.first===null)throw iD;return this.first.item}getLast(){if(this.last===null)throw iD;return this.last.item}insertAfter(t,e){let r=new nD(this,e);return t.insertAfter(r),t===this.last&&(this.last=r),this.cnt++,r}insertBefore(t,e){let r=new nD(this,e);return t.insertBefore(r),t===this.first&&(this.first=r),this.cnt++,r}remove(t){t.remove(),t===this.first&&(this.first=t.next),t===this.last&&(this.last=t.prev),this.cnt--}size(){return this.cnt}clear(){this.first=null,this.last=null,this.cnt=0}iterator(){return new oge(this.first)}listIterator(){return new lge(this.first)}toArray(){let t=new Array(this.cnt),e=this.first,r=0;for(;e!=null;)t[r]=e.item,e=e.next,r++;return t}};function s4(t){throw new Error("")}var sD=class{constructor(t,e){this.node1=null,this.node2=null,this.key=t,this.value=e}},cge=class{constructor(t){this.itors=t}hasNext(){return this.itors.hasNext()}next(){return this.itors.next().key}},uge=class{constructor(t){this.itors=t}hasNext(){return this.itors.hasNext()}next(){return this.itors.next().value}},MD=class{constructor(){this.innerList=new C1,this.innerMap={}}replace(t,e){t.node1!==null&&(t.node1.set(e),e.node1=t.node1),t.node2!==null&&(t.node2.set(e),e.node2=t.node2)}clear(){this.innerList.clear();for(let t in this.innerMap)delete this.innerMap[t]}put(t,e){let r=t.hashCode(),i=new sD(t,e),n=this.innerMap[r];if(n===void 0)return i.node1=this.innerList.add(i),this.innerMap[r]=i,null;if(n instanceof sD){if(n.key.equals(t))return this.innerMap[r]=i,this.replace(n,i),n.value;{i.node1=this.innerList.add(i);let s=new C1;return n.node2=s.add(n),i.node2=s.add(i),this.innerMap[r]=s,null}}if(n instanceof C1){let s=null;return n4(n,(a,o)=>o.key.equals(t)?(this.replace(o,i),s=o.value,!1):!0),s===null?(i.node1=this.innerList.add(i),i.node2=n.push(i),null):s}return s4(n)}get(t){let e=t.hashCode(),r=this.innerMap[e];if(r===void 0)return null;if(r instanceof sD)return r.key.equals(t)?r.value:null;if(r instanceof C1){let i=null;return n4(r,(n,s)=>s.key.equals(t)?(i=s.value,!1):!0),i}return s4(r)}containsKey(t){return this.get(t)!==null}delete(t){t.node1!==null&&t.node1.parent.remove(t.node1),t.node2===null?delete this.innerMap[t.key.hashCode()]:t.node2.parent.remove(t.node2)}remove(t){let e=t.hashCode(),r=this.innerMap[e];if(r===void 0)return null;if(r instanceof sD)return r.key.equals(t)?(this.delete(r),r.value):null;if(r instanceof C1){let i=null;return n4(r,(n,s)=>s.key.equals(t)?(i=s.value,this.delete(s),!1):!0),i}return s4(r)}computeIfAbsent(t,e){let r=this.get(t);if(r===null){let i=e(t);return this.put(t,i),i}else return r}size(){return this.innerList.size()}isEmpty(){return this.innerList.size()===0}keys(){return new cge(this.innerList.iterator())}values(){return new uge(this.innerList.iterator())}entries(){return this.innerList.iterator()}},A2=class{constructor(){this.innerMap=new MD}add(t){return this.innerMap.put(t,!0)!==!0}remove(t){this.innerMap.remove(t)}contains(t){return this.innerMap.get(t)===!0}iterator(){return this.innerMap.keys()}addAll(t){let e=t.iterator();for(;e.hasNext();)this.add(e.next())}size(){return this.innerMap.size()}clear(){let t=this.iterator();for(;t.hasNext();){let e=t.next();this.remove(e)}}},lY=su.funcCopy(L1);function hge(t,e){let r=0;if(Math.abs(t.start.y-e)<=1e-4)De[r++]=t.start.x;else if(Math.abs(t.end.y-e)<=1e-4)De[r++]=t.end.x;else if(t.shape instanceof Ge)r=Pme(t.shape,e);else if(t.shape instanceof gt)r=Lme(t.shape,e);else throw new Error("not supported operation");return r}var xD=class{constructor(t,e,r,i){this.sides=new Array,this.loader=t,this.loader.bo=this,this.logger=r,this.rule=e,this.event=i}static sortByBBoxMinY(t,e){return t.bbox().minY-e.bbox().minY}static sortByBBoxAreaDesc(t,e){return e.bbox().area()-t.bbox().area()}addPolyline(t,e=1,r=.01,i=!0){for(let n of this.loader.buildGroup(t,e,r,i))this.sides.push(n),this.event.onOriginSide(n)}buildRTree(){let t=new oC(10);for(let e of this.sides)t.add(e);return t}fillValidSides(t,e,r){for(let i of e)isFinite(i.getX(r))&&t.push(i)}getSortedEndpointsLineAsc(t){let e=new Array;for(let n of t)n.needCountWeight()&&(e.push(n.start),e.push(n.end));lY(e,We.sortByYAsc,0,e.length);let r=new Array,i=Number.NEGATIVE_INFINITY;for(let n of e){let s=n.y;s>i&&(r.push(s),i=s)}return r}splitSides(t,e,r){let i=t.start,n=t.end,s=new We(n.x+(i.x-n.x)*2,n.y+(i.y-n.y)*2);lY(t.inters,(o,l)=>o.distance2(s)-l.distance2(s),0,t.inters.length);let a=null;for(let o of t.inters)if(a==null)o.equals(i)&&(a=o);else if(!o.equals(a)){let l=y2.rebuild(t.shape,a,o);l instanceof gt&&Math.abs(l.sweepAngle)>190&&(l=new Ge(a,o));let c=new y2(this,l,t.baseWeight,a,o,t.polyGrp,r++);if(e.push(c),c.updateBbox(),o.equals(n))break;a=o}return r}splitSidesByInters(){let t=new Array;for(let e of this.sides)if(e.polyIndex==0){let r=0,i=null,n=null;do{let s=new Array;r=this.splitSides(e,s,r);for(let a of s)i!=null?(i.next=a,a.previous=i):n=a,i=a,this.event.onSplitedSide(a),t.push(a);if(e.next===null)throw new Error("not supported operation");e=e.next}while(e.polyIndex!==0);n!=null&&i!=null&&(n.previous=i,i.next=n)}this.sides.length=0;for(let e of t)this.sides.push(e)}seekIntersection(){if(this.sides.length>0){let t=this.buildRTree(),e=new A2;for(let r of this.sides){e.add(r);let i=r.bbox().extendOfSize(1e-5),n=r.shape instanceof Ge;for(let s of t.search(i))if(!e.contains(s)){let a=s.shape instanceof Ge;if(!(n&&a&&r.next!==null&&r.previous!==null&&(r.next.equals(s)||r.previous.equals(s)))){let o=IA(r.shape,s.shape);for(let l=0;l<o;l+=2){let c=new We(De[l],De[l+1]);r.inters.push(c),s.inters.push(c),this.event.onIntersect(c,r,s)}}}}}}},dge=class lV{constructor(e){this.sides=new A2,this.others=new A2,this.id=e}add(e){this.sides.add(e),e.finalGrp=this.id;for(let r of e.connect)this.others.add(r)}polyline(){let e=new Array;return d2(this.sides,(r,i)=>(e.push(i.shape),!0)),cn.build2(e).asClose()}hashCode(){return this.id}equals(e){return e!=null&&e instanceof lV?this.id===e.id:!1}},cV=class{constructor(t){this.bo=null,this.sides=new Array,this.polyGrp=0,this.polyIndex=0,this.prevSide=null,this.firstSide=null,this.noWeight0=t}completeGroup(t){this.prevSide!=null&&this.firstSide!=null&&!this.prevSide.end.equals(this.firstSide.start)&&this.addSide(new Ge(this.prevSide.end,this.firstSide.start),t);let e=new Array,r=null,i=null;for(let n of this.sides)(!this.noWeight0||n.weight!==0)&&(r!=null?(r.next=n,n.previous=r):i=n,r=n,e.push(n));return r!=null&&i!=null&&(i.previous=r,r.next=i),this.polyGrp++,this.sides.length=0,this.prevSide=null,this.firstSide=null,this.polyIndex=0,e}buildGroup(t,e,r,i=!0){for(let n of t.primitives)if(n instanceof Ge)this.addSide(n,e);else if(i&&n instanceof gt&&n.rx===n.ry)this.addArc(n,e);else{let s=null;for(let a of n.points(r))s!=null&&this.addSide(new Ge(s,a),e),s=a}return this.completeGroup(e)}addArc(t,e){let r=t.sweepAngle,i=Ii.regularD(t.startAngle),n=i+r;if(r>0){let s=90;for(;s<=n;)s>i&&(this.addSide(gt.build3(t.center,i,s-i,t.rx,t.ry),e),i=s),s+=90;i<n&&this.addSide(gt.build3(t.center,i,n-i,t.rx,t.ry),e)}else if(r<0){let s=270;for(;s>=n;)s<i&&(this.addSide(gt.build3(t.center,i,s-i,t.rx,t.ry),e),i=s),s-=90;i>n&&this.addSide(gt.build3(t.center,i,n-i,t.rx,t.ry),e)}}addSide(t,e){if(t.start().equals(t.end()))return;let r=t.start(),i;this.prevSide!=null?(this.prevSide.end.equals(r)||this.addSide(new Ge(this.prevSide.end,r),e),i=new y2(this.bo,t,e,t.start(),t.end(),this.polyGrp,this.polyIndex++)):(i=new y2(this.bo,t,e,t.start(),t.end(),this.polyGrp,this.polyIndex++),this.firstSide=i),this.prevSide=i,this.sides.push(i)}},uV=class{constructor(t,e,r){this.eps=new Array,this.curWeight=0,this.start=null,this.last=null,this.prevStart=null,this.prevEnd=null,this.y=r,this.rule=t,this.bo=e,this.event=e.event}onEp(t){this.tuningWeight(t),this.start===null?this.rule(this.curWeight)?this.in(t):t.setInvalid(this.y):this.rule(this.curWeight)?t.setInvalid(this.y):this.out(t,this.start),this.last!==null&&this.event.onSweep1(this.last,t,this.y),this.last=t}in(t){this.prevEnd!=null&&this.onSameX(t,this.prevEnd)?(this.start=this.prevStart,this.prevStart=null,this.prevEnd.revokeInside(this.y),this.prevEnd=null):(this.start=t,this.start.setOutside(this.y))}out(t,e){if(this.onSameX(e,t))e.revokeOutside(this.y);else{if(t.setInside(this.y)>0&&e.confidence(this.y)>0){let r=e.voteStatus(),i=t.voteStatus();this.isValid(r)&&this.isValid(i)?r==2&&i==1&&(t.connect.push(e),e.connect.push(t)):(t.connect.push(e),e.connect.push(t))}this.event.onSegment1(e,t,this.y),this.eps.push(e),this.eps.push(t),this.prevStart=e,this.prevEnd=t}this.start=null}isValid(t){return t==1||t==2}onSameX(t,e){return t.bbox().isIntersect(e.bbox())&&vt.eq(t.getX(this.y),e.getX(this.y))}tuningWeight(t){this.curWeight+=t.weight;let e=t.nextNot0(),r=t.prevNot0();e!=null&&t.weight===e.weight&&e.trans===this.y&&(this.curWeight-=t.weight),r!=null&&t.weight===r.weight&&r.trans===this.y&&(this.curWeight-=t.weight),t.trans=this.y}},kD=new Error,cY=new class extends bC{decide1(t){return t[0]&&t[1]}}(2),Age=new class extends oV{onPolylineGroup(t,e){throw kD}onSegment(t,e,r,i,n,s){throw kD}},fge=class{constructor(t,e){this.rtree=t,this.level=e}},pge=class hV extends xD{static isIntersect(e,r,i=ZD.DUMMY){let n=new hV(i),s=n.createGroup1(e.items),a=n.createGroup2(r.items);return s.rtree.itemList.length==0||a.rtree.itemList.length==0?!1:n.isIntersect(s,a)}constructor(e){super(new cV(!1),cY.rule,e,Age)}createGroup1(e){return this.createGroup(e,0)}createGroup2(e){return this.createGroup(e,1)}createGroup(e,r){let i=cY.weight(r);for(let s of e)this.addPolyline(s,i);let n=this.buildRTree();return this.sides.length=0,new fge(n,r)}isIntersect(e,r){if(e.level!==r.level){let i=e.rtree.bbox().intersection1(r.rtree.bbox());if(i!==null){try{this.inters(e,r);let n=(i.minY+i.maxY)/2;this.sweep(e,r,n)}catch(n){if(n===kD)return!0;throw n}return!1}else return!1}else throw new Error("inersection detection should not in same group")}inters(e,r){if(e.rtree.size()>r.rtree.size()){let i=e;e=r,r=i}for(let i of e.rtree.items()){i.trans=NaN;let n=i.bbox().extendOfSize(1e-5);for(let s of r.rtree.search(n))if(s.trans=NaN,IA(i.shape,s.shape)>0)throw kD}}sweep(e,r,i){let n=nu.extend2(e.rtree.bbox(),r.rtree.bbox()).extendOfSize(1e-5),s=new Array;this.fillValidSides(s,e.rtree.search(n),i),this.fillValidSides(s,r.rtree.search(n),i),L1(s,(o,l)=>o.getX(i)-l.getX(i),0,s.length);let a=new uV(this.rule,this,i);for(let o of s)a.onEp(o)}},rM=class tg{constructor(e){this.items=new Array(e.length),su.arraycopy(e,0,this.items,0,e.length),this.__bbox=this.calcBBox()}static build1(e){let r=[];return _D(e,(i,n)=>(r.push(n),!0)),new tg(r)}static build2(e){let r=e.map(i=>cn.build8(i));return new tg(r)}static combinePolylineGroupArr(e){let r=[];for(let i of e)r=r.concat(i.items);return new tg(r)}calcBBox(){let e=new vh;for(let r=0;r<this.items.length;r++)e.ext1(this.items[r].bbox());return e.build1()}multiply3(e){let r=new Array(this.items.length);for(let i=0;i<r.length;i++)r[i]=this.items[i].multiply3(e);return new tg(r)}bbox(){return this.__bbox}asClose(){return this.items.forEach(e=>e.asClose()),this}mirrorY(e){return this.items.forEach(r=>r.mirrorY(e)),this}closeEndpoint(){return this.items.forEach(e=>e.closeEndpoint()),this}get primitives(){return this.items.map(e=>e.primitives).flat(2)}isEqual(e){return e instanceof tg?this.items.every(r=>e.items.some(i=>i.isEqual(r))):!1}getOutMostPolyline(){return this.items.reduce((e,r)=>r.bbox().area()>e.bbox().area()?r:e,this.items[0])}getOutline(){let e=this.items;if(e.length===1)return{outline:e,hole:new Array};let r=new Set,i=new Set;for(let n=0,s=e.length;n<s;n++){let a=e[n];if(!r.has(a)&&!i.has(a)){n+1>=s&&r.add(a);for(let o=n+1;o<s;o++){let l=e[o];if(!r.has(l)&&!i.has(l)){if(!a.bbox().isInside(l.bbox().extendOfSize(1e-4))&&!l.bbox().isInside(a.bbox().extendOfSize(1e-4)))continue;pge.isIntersect(new tg([a]),new tg([l]))&&(a.bbox().area()>l.bbox().area()?(r.add(a),i.add(l)):(r.add(l),i.add(a)))}}!r.has(a)&&!i.has(a)&&r.add(a)}}return{outline:[...r],hole:[...i]}}round(e=4){let r=this.items.map(i=>i.round(e));return new tg(r)}},mge=su.funcCopy(L1),gge=su.funcCopy(L1),yge=su.funcCopy(L1);function bge(t){return new Array}function xge(t,e){let r=new iC(!1),i=new nC(t,ZD.DUMMY,r);for(let n of e)i.addPolyline(n);return i.simplify(),r.plGrps}var nC=class extends xD{constructor(t,e,r){super(new cV(!1),t,e,r),this.finalSides=new Array,this.sideGroups={},this.vecSides=new Array,this.scanY=NaN,this.curNetIndex=0,this.curIndex=-1,this.scanLines=0}sweep(t,e,r){this.scanY=NaN,this.scanLines=0,mge(e,xD.sortByBBoxMinY,0,e.length);let i=new C1;this.curNetIndex=0;let n=Number.POSITIVE_INFINITY;for(let s of t)s>n&&this.scan(i,(n+s)/2,e),n=s;this.getAllMarkPrimitive(r,e),this.logger.debug3("scan %s %d",r,this.scanLines)}simplify(){this.seekIntersection(),this.splitSidesByInters(),this.sweep(this.getSortedEndpointsLineAsc(this.sides),this.sides,!1),this.flipSides(),this.sweep(this.getSortedEndpointsLineAsc(this.vecSides),this.vecSides,!0),this.connectSides(),this.fillResult()}addPolyline(t,e=1,r=.01,i=!0){super.addPolyline(t,e,r,i)}scan(t,e,r){if(this.scanY==e)return;this.scanY=e;let i=!1,n=t.listIterator();for(;n.hasNext();){let s=n.next(),a=s.item;vt.less(a.bbox().maxY,e)?t.remove(s):!i&&a.isNeedScan(e)&&(i=!0)}for(;this.curNetIndex<r.length;){let s=r[this.curNetIndex];if(vt.less(s.bbox().minY,e))vt.greatereq(s.bbox().maxY,e)&&(this.add2AET(t,s),!i&&s.isNeedScan(e)&&(i=!0)),this.curNetIndex++;else break}if(i){this.scanLines++;let s=new uV(this.rule,this,e),a=t.iterator();for(;a.hasNext();){let o=a.next();s.onEp(o)}}}add2AET(t,e){let r=e.bbox().minX,i=e.bbox().maxX,n=e.bbox().minY,s=e.bbox().maxY,a=t.listIterator(),o=null;for(;a.hasNext();){let l,c=a.next(),u=c.item,d=u.bbox().minX,A=u.bbox().maxX;if(i<=d)l=-1;else if(A<=r)l=1;else{let f=u.bbox().minY,p=u.bbox().maxY,m=Math.max(n,f),y=Math.min(s,p);l=this.compareBySweep(e,u,(m+y)/2)}let h=u.shape;if(h instanceof Ge&&h.length()<.001&&o==null&&l<0){o=c;continue}if(o!=null&&l<0){t.insertBefore(o,e);return}if(l<0){t.insertBefore(c,e);return}else o=null}t.add(e)}getLineAngle(t){let e=t.start().angle(t.end());return e<0&&(e+=Math.PI),e}getArcAngle(t,e){let r=Math.asin((e-t.center.y)/t.rx);return t.startAngle>90&&t.startAngle<270&&(r=-r),r<0&&(r+=Math.PI),(r+Math.PI/2)%Math.PI}compareArcLine(t,e,r){let i=this.getArcAngle(t,r),n=this.getLineAngle(e);return vt.eq(i,n)?-t.sweepAngle:n-i}compareBySweep(t,e,r){let i=t.getX(r);if(!isFinite(i))return 0;let n=e.getX(r);if(!isFinite(n))return 0;if(!vt.eq(i,n))return i-n;if(t.shape instanceof Ge)return e.shape instanceof Ge?this.getLineAngle(e.shape)-this.getLineAngle(t.shape):-this.compareArcLine(e.shape,t.shape,r);if(e.shape instanceof Ge)return this.compareArcLine(t.shape,e.shape,r);{let s=t.shape,a=e.shape,o=this.getArcAngle(s,r),l=this.getArcAngle(a,r);return vt.eq(o,l)?s.sweepAngle*a.sweepAngle<=0?s.sweepAngle<=0?1:-1:s.sweepAngle>0?s.rx-a.rx:a.rx-s.rx:l-o}}getAllMarkPrimitive(t,e){for(let r of e)if(r.status===0&&r.bbox().height()!=0){let i=r.voteStatus();if(i===2||i===1){r.status=i;let n=r.reverse(i);if(t){this.event.onResultSide(n);let s=n.shape.multiply3(as.ROT_N90),a=n.start.multiply3(as.ROT_N90),o=n.end.multiply3(as.ROT_N90);n=new y2(this,s,n.baseWeight,a,o,n.polyGrp,n.polyIndex)}this.finalSides.push(n),this.event.onResultSide(n)}}}flipSides(){for(let t of this.sides)if(t.polyIndex==0){let e=null,r=null;do{let i=t.shape.multiply3(as.ROT_90),n=t.start.multiply3(as.ROT_90),s=t.end.multiply3(as.ROT_90),a=new y2(this,i,t.baseWeight,n,s,t.polyGrp,t.polyIndex);if(a.outsideWeight=t.outsideWeight,a.insideWeight=t.insideWeight,a.invalidWeight=t.invalidWeight,a.status=t.status,e!=null?(e.next=a,a.previous=e):r=a,this.vecSides.push(a),this.event.onSplitedSide(a),e=a,t.next!==null)t=t.next;else break}while(t.polyIndex!=0);r!=null&&(r.previous=e,e.next=r)}}canBeEnd(t,e){if(t.size()==1){let r=t.getFirst().shape;if(r instanceof gt){if(e&&r.rx<=e)return!1}else if(r instanceof Ge&&e&&r.length()<=e)return!1}return!0}connectSides(){let t=new MD,e=new oC(10);for(let s of this.finalSides)t.computeIfAbsent(s.start,bge).push(s),e.add(s.start);let r=0,i=new A2,n=new Array;for(let s of this.finalSides)if(!i.contains(s)){let a=new A2,o=s.start,l=new C1;l.add(s),i.add(s);let c=s.end;for(;l.size()>0;)if(this.isStart(o,c)&&this.canBeEnd(l,.01)){l.size()>1&&this.fillSideGroups(l,r++);break}else{let u=t.get(c),d=this.findNext(i,u);if(d==null&&(c=this.findNeigber(c,a,e,.01),c!==null&&(u=t.get(c),d=this.findNext(i,u))),d!=null)l.add(d),i.add(d),c=d.end;else if(c!=null?a.add(c):(n.length==0&&l.size()>1&&this.logger.warning3("unable to connect at %s",l.getLast()),n.push(l.removeLast())),l.size()>0)c=l.getLast().end;else break}}}fillSideGroups(t,e){let r=new dge(e);d2(t,(i,n)=>(r.add(n),!0)),this.sideGroups[r.id]=r}isStart(t,e){return t.distance2(e)<=1e-4}findNext(t,e){if(e!=null){for(let r of e)if(!t.contains(r))return r}return null}fillResult(){let t=0,e=new MD;for(let i in this.sideGroups){let n=this.sideGroups[i];d2(n.sides,(s,a)=>(a.polyGrp!=-2&&e.put(a,a),!0))}let r=new A2;for(let i in this.sideGroups){let n=this.sideGroups[i];if(r.add(n)){let s=0,a=new Array;for(a.push(n);s<a.length;){let l=a[s],c=new Array;d2(l.others,(d,A)=>{let h=e.get(A);return h!=null&&c.push(h.finalGrp),!0}),gge(c,su.sortAsc,0,c.length);let u=l.id;for(let d of c)if(d!=u&&d!=l.id){let A=this.sideGroups[d];r.add(A)&&a.push(A),u=d}s++}let o=new Array;for(let l of a)o.push(l.polyline());yge(o,xD.sortByBBoxAreaDesc,0,o.length),this.event.onPolylineGroup(new rM(o),t++)}}}findNeigber(t,e,r,i){let n=i*i,s=Number.MAX_VALUE,a=null;for(let o of r.search(t.bbox().extendOfSize(i)))if(!e.contains(o)){let l=t.distance2(o);l<s&&(s=l,a=o)}return s<n?a:null}},Ege=class{constructor(){this.points=[],this.lines=[],this.arcs=[],this.beziers=[],this.listText=[],this.fonts=[]}addPt(t,e=!0){if(t instanceof Ge)this.lines.push(t);else if(t instanceof gt)this.arcs.push(t);else if(t instanceof br)this.beziers.push(t);else throw new Error("not support");e&&this.points.push(t.start())}addPoint(t){this.points.push(t)}addText(t,e,r=1,i=.1,n=!0){this.listText.push({pos:t,str:e,size:r,width:i}),n&&this.points.push(t)}addPly(t,e=!0){t.primitives.forEach(r=>this.addPt(r,e))}build(){let t=[],e=[],r=[],i=[],n=[],s=[];return this.points.forEach(a=>t.push(a.x,a.y)),this.lines.forEach(a=>e.push(a.start().x,a.start().y,a.end().x,a.end().y)),this.arcs.forEach(a=>r.push(a.center.x,a.center.y,a.rx,Ii.toRadians(a.startAngle),Ii.toRadians(a.endAngle()),a.sweep())),this.beziers.forEach(a=>{a.controls.forEach(o=>{i.push(o.x,o.y)}),i.push("end")}),this.listText.forEach(a=>n.push(a.pos.x,a.pos.y,a.str,a.width,a.size)),this.fonts.forEach(a=>s.push(a)),{points:t,lines:e,arcs:r,texts:n,beziers:i,fonts:s}}},N0,xC=(N0=class{constructor(e){this.map=new MD,this.bus=e}initColor(e){return this.map.computeIfAbsent(e,()=>new Ege)}draw(){let e={},r=this.map.entries();for(;r.hasNext();){let i=r.next();e[i.key.toString()]=i.value.build()}this.bus.publish("/debug/draw",e)}clear(){this.map.clear()}static init(e){if(!e)throw new Error("bus is undefined!");this.palette=new N0(e)}static initPalette(e){this.palette=e}static getDefaultColor(){for(let e of this.colorBuffersMap)if(e[0]!==null&&e[0])return e[0]=!1,e[1];return this.colorBuffersMap.forEach(e=>{if(e[0]===null){console.log(1);return}e[0]=!0}),this.getDefaultColor()}static clear(){this.palette.clear()}static auto(e,r=this.getDefaultColor()){if(Array.isArray(e))e.forEach(i=>{this.auto(i,r)});else if(e instanceof We)this.point(e,r);else if(e instanceof nu)this.bbox(e,r);else if(e instanceof yC)this.primitive(e,r);else if(e instanceof cn)this.polyline(e,r);else if(e instanceof Ko)this.polygon(e,r);else if(e instanceof ao)this.group(e,r);else if(e instanceof rM)this.auto(e.items,r);else{debugger;throw new Error("No incoming type!")}}static text(e,r,i=.5,n=this.getDefaultColor()){if(!this.palette)throw new Error("palette  is not initialised!");this.palette.initColor(n).addText(e,r,i,i/10),this.palette.draw()}static point(e,r=this.getDefaultColor()){if(!this.palette)throw new Error("palette  is not initialised!");let i=this.palette.initColor(r);Array.isArray(e)?e.forEach(n=>{this.point(n,r)}):i.addPoint(e),this.palette.draw()}static bbox(e,r=this.getDefaultColor()){Array.isArray(e)?e.forEach(i=>{this.bbox(i,r)}):(this.primitive(new Ge(new We(e.maxX,e.maxY),new We(e.maxX,e.minY)),r),this.primitive(new Ge(new We(e.maxX,e.maxY),new We(e.minX,e.maxY)),r),this.primitive(new Ge(new We(e.minX,e.minY),new We(e.maxX,e.minY)),r),this.primitive(new Ge(new We(e.minX,e.minY),new We(e.minX,e.maxY)),r))}static primitive(e,r=this.getDefaultColor()){if(!this.palette)throw new Error("palette  is not initialised!");let i=this.palette.initColor(r);Array.isArray(e)?e.forEach(n=>{this.primitive(n,r)}):i.addPt(e),this.palette.draw()}static polyline(e,r=this.getDefaultColor()){Array.isArray(e)?e.forEach(i=>{this.polyline(i,r)}):e.primitives.forEach(i=>{this.primitive(i,r)})}static polygon(e,r=this.getDefaultColor()){Array.isArray(e)?e.forEach(i=>{this.polygon(i,r)}):e.items.forEach(i=>{this.polyline(i,r)})}static group(e,r=this.getDefaultColor()){Array.isArray(e)?e.forEach(i=>{this.group(i,r)}):e.items.forEach(i=>{this.polygon(i,r)})}static async begin(){this.t1=performance.now()}static async end(e){console.log(e||"t1:",performance.now()-this.t1)}static async log(e){console.log(e||"==================")}},N0.colorBuffersMap=[[!0,Xn.BLUE],[!0,Xn.GREEN],[!0,Xn.WHITE],[!0,Xn.RED],[!0,Xn.Golden],[!0,Xn.Gray]],N0.t1=0,N0),wge=0,EC=class I4{constructor(e,r){this.inters=[],this.shape=e,this.start=e.start(),this.end=e.end(),this.judgeOverlapMap=new Map,r&&(this.id=wge++)}reverse(){this.shape=this.shape.reverse();let e=this.start;this.start=this.end,this.end=e}getCenterPoint(e=this.end){let{x:r,y:i}=this.start,{x:n,y:s}=e;if(this.shape instanceof gt){let a=this.shape.rx,o=new We((r+n)/2,(i+s)/2),l=this.shape.center,c;return o.x!==l.x||o.y!==l.y?(c=o.angle(l),Math.abs(this.shape.sweepAngle)>180&&(c+=c>=0?-180:180)):c=(this.shape.startAngle+this.shape.endAngle())/2,new We(l.x+Math.cos(c)*a,l.y+Math.sin(c)*a)}else{if(this.shape instanceof Ge)return new We((r+n)/2,(i+s)/2);if(this.shape instanceof br){let a=this.shape.getPercent(e,ui);return br.pointOn(a/2,this.shape.controls)}else throw Error("not support")}}static finalAngle(e,r,i){let n=e.cross(r)>0,s=Math.acos(Math.min(1,Math.max(-1,e.dot(r)/r.length())));return(i?!n:n)&&(s=e_-s),s}sortInters(){if(this.shape instanceof gt){let e=this.shape.center,r=this.shape.start().sub(e).normalize(),i=this.shape.isCCW;this.inters.sort((n,s)=>{let a=n.coord.sub(e),o=s.coord.sub(e);return I4.finalAngle(r,a,i)-I4.finalAngle(r,o,i)<=0?-1:1})}else if(this.shape instanceof Ge){let e=this.start,r=this.end,i=new We(r.x+(e.x-r.x)*2,r.y+(e.y-r.y)*2);this.inters.sort((n,s)=>n.coord.distance2(i)-s.coord.distance2(i)<=0?-1:1)}else if(this.shape instanceof br){let e=this.shape;this.inters.sort((r,i)=>e.getPercent(r.coord,ui)-e.getPercent(i.coord,ui)<=0?-1:1)}else throw Error("not support the primitive type");this.inters.forEach((e,r)=>e.setIndex(r))}getStart(){return this.start}getEnd(){return this.end}getShape(){return this.shape}connect(e){this.nextSide=e,e.prevSide=this}static returnPolygonList(e){let r=[];return e.forEach(i=>{let n=[];i.forEach((s,a)=>{let o=[];s.forEach(l=>{o.push(l.shape)}),n.push(cn.build7(o))}),r.push(new Ko(n))}),r}addInter(e){this.inters.push(e)}static returnPolygonGroup(e){let r=[];return e.forEach(i=>{let n=[];i.forEach((s,a)=>{let o=[];s.forEach(l=>{o.push(l.shape)}),n.push(cn.build7(o))}),r.push(new Ko(n))}),new ao(r)}static rebuild(e,r,i){let n;if(e instanceof Ge||r.distance2(i)<1e-6)n=new Ge(r,i);else if(e instanceof gt)n=gt.build2(e.center,r.angleD(e.center),i.angleD(e.center),e.rx,e.ry,e.isCCW?1:0);else if(e instanceof br){let s=e.getPercent(r,ui),a=e.clip(s)[1];n=a.clip(a.getPercent(i,ui))[0]}else throw new Error("not supported operation");return ci(e,r).dot(ci(n,r))<0?null:n}static returnPolyline(e){return cn.build7(e.map(r=>r.shape))}bbox(){return this.shape.bbox()}},vge=(t=>(t[t.END1=0]="END1",t[t.END2=1]="END2",t[t.END12=2]="END12",t[t.LEFT1=3]="LEFT1",t[t.LEFT2=4]="LEFT2",t))(vge||{});function au(t,e,r){if(t instanceof gt&&e instanceof gt)return Tge(t,e);if(t instanceof gt&&e instanceof Ge)return dY(t,e);if(t instanceof Ge&&e instanceof gt)return hY(t,e);if(t instanceof Ge&&e instanceof Ge)return I1(t,e);if(t instanceof br&&e instanceof Ge)return t.controls.length===2||sg(t)?I1(new Ge(t.start(),t.end()),e):dV(t,e);if(t instanceof Ge&&e instanceof br)return e.controls.length===2||sg(e)?I1(t,new Ge(e.start(),e.end())):B4(t,e);if(t instanceof gt&&e instanceof br)return e.controls.length===2||sg(e)?dY(t,new Ge(e.start(),e.end())):Cge(t,e);if(t instanceof br&&e instanceof gt)return t.controls.length===2||sg(t)?hY(new Ge(t.start(),t.end()),e):Sge(t,e);if(t instanceof br&&e instanceof br)return iM(t,e);throw new Error("not support")}function Kx(t,e){return ci(t,e.start()).dot(ci(e,e.start()))<=0?!1:au(t,e).state<=2}function a4(t,e){let r=e.getPercent(t.end(),ui);if(r===null)return!1;if(r===0)return!0;let i=e.clip(r)[0],n=t.buildConverxHull(ui),s=i.buildConverxHull(ui),a=c(n),o=c(s);return l(a,o);function l(u,d){let A=new Map([[0,1],[1,0],[2,2],[3,4],[4,3]]),h=u[0],f=d[0];if(!h||!f)throw Error("isAllOverlap(sides1: PackSide[], sides2: PackSide[])");let p=!0;do{let m=h.getShape(),y=f.getShape();if(m instanceof Ge&&y instanceof Ge){let g=p?I1(m,y).state:A.get(I1(y,m).state);if(g===0)h=h.nextSide,p=!1;else if(g===1)f=f.nextSide,p=!0;else if(g===2)h=h.nextSide,f=f.nextSide,p=!0;else return!1}else throw Error("not support")}while(h!==u[0].prevSide&&f!==d[0].prevSide);return!0}function c(u){let d=u.primitives.map(h=>new EC(h)),A=d[d.length-1];return d.forEach(h=>{A.connect(h),A=h}),d}}function uY(t,e){let r=t.end().distance2(e.center);if(r>(e.rx+ui)**2||r<(e.rx-ui)**2||!(jr(t.end(),e.end())||nM(e,t.end())))return!1;if(t.center.equals1(e.center))return!0;let i=t.center.distance1(e.center),n=Math.abs(t.rx-e.rx);if(i>Math.min(t.rx,e.rx)){let s=t.center.angleD(e.center);return t.rx>e.rx?!(i+n>ui&&jp(t,s))&&!(i-n>ui&&t.rx+e.rx-i>ui&&jp(t,s+180)):!(i-n>ui&&jp(t,s))&&!(t.rx+e.rx-i>ui&&jp(t,s+180))}else{if(i+n<=ui)return!0;let s=t.rx>e.rx?t.center.angleD(e.center):e.center.angleD(t.center);return jp(t,s)?!1:i-n<=ui?!0:!jp(t,s+180)}}function Cge(t,e){let r=sM(t,e.start()).toBezier2(),i,n=0;for(let s=r.length;n<s;n++){let a=r[n];if(i=iM(a,e).state,i!==0)break}return i===2&&n!==r.length-1?{state:1}:{state:i}}function Sge(t,e){let r=e.toBezier2(),i,n=0;for(let s=r.length;n<s;n++){let a=r[n];if(i=iM(t,a).state,i!==1)break}return i===2&&n!==r.length-1?{state:0}:{state:i}}function iM(t,e){if(t.controls.length===2||sg(t))return e.controls.length===2||sg(e)?I1(new Ge(t.start(),e.end()),new Ge(e.start(),e.end())):B4(new Ge(e.start(),t.end()),e);if(e.controls.length===2||sg(e))return dV(D4(t,e.start()),new Ge(e.start(),e.end()));let r=D4(t,e.start());if(sg(r))return B4(new Ge(e.start(),t.end()),e);let i=a4(r,e),n=a4(e,r);if(!i&&!n){let s=Gme(r,e);if(s.havOverlap){let a=s.havOverlap!==2,o=s.havOverlap!==1;return ug(t,e,a,o)}else{let a=function(){for(let d=0;d<c;d+=2)De[d]=u[d],De[d+1]=u[d+1]},o,l,c=s.cnt,u=new Array(c).fill(0).map((d,A)=>De[A]);for(let d=0;d<c;d+=2){let A=new We(De[d],De[d+1]),h=r.getPercent(A,ui),f=e.getPercent(A,ui);if(h===0||f===0)continue;let p=h===1?r:r.clip(h)[0],m=f===1?e:e.clip(f)[0];if(a4(p,m)){let y=ci(t,A).cross(ci(e,A));if(y===0){o=r.end(),l=e.end();break}return{state:y<0?3:4}}a()}return(!o||!l)&&(o=l2(r.controls,r.controls[0],e),l=l2(e.controls,r.controls[0],r)),{state:o.sub(r.controls[0]).cross(l.sub(r.controls[0]))>0?4:3}}}return ug(t,e,i,n)}function dV(t,e){let r=D4(t,e.start());if(sg(r))return I1(new Ge(r.start(),r.end()),e);let i=fV(r,e),{isIn:n,bezierIsInLeft:s}=AV(e,r);if(!i&&!n){if(s!==void 0)return{state:s?3:4};let a=null,o=t.getPercent(e.start(),ui)+.01;for(let l=o>1?1:o;l<=1;){let c=br.pointOn(l,t.controls);if(lC(e,c)>ou){a=c;break}l+=.01,l>1&&(l=1)}if(!a)throw Error("!end1 && !end2 not result");return{state:e.direct.cross(a.sub(e.start()))<0?4:3}}return ug(r,e,i,n)}function B4(t,e){let{isIn:r,bezierIsInLeft:i}=AV(t,e),n=fV(e,t);if(!r&&!n){if(i!==void 0)return{state:i?4:3};let s=null;for(let a=.01;a<=1;){let o=br.pointOn(a,e.controls);if(lC(t,o)>ou){s=o;break}a+=.01,a>1&&(a=1)}if(!s)throw Error("!end1 && !end2 not result");return{state:t.direct.cross(s.sub(t.start()))<0?3:4}}return ug(e,t,r,n)}function Tge(t,e){let r=uY(sM(t,e.start()),e),i=uY(e,t);if(!r&&!i){let n=Uf(e);if(t.center.sub(e.start()).dot(e.center.sub(e.start()))>0){if(t.rx===e.rx)return t.isCCW?{state:n.dot(t.center.sub(e.center))<0?3:4,exitIsInvalid:!1}:{state:n.dot(t.center.sub(e.center))>0?3:4,exitIsInvalid:!1};let s,a;return t.rx>e.rx?(s=t,a=e):(s=e,a=t),n.dot(a.center.sub(s.center))>0&&a.rx+a.center.distance1(s.center)-s.rx>ui?t.isCCW?{state:t.rx>e.rx?3:4,exitIsInvalid:!1}:{state:t.rx<e.rx?3:4,exitIsInvalid:!1}:t.isCCW?{state:t.rx<e.rx?3:4,exitIsInvalid:!0}:{state:t.rx>e.rx?3:4,exitIsInvalid:!0}}else return t.rx+e.rx-t.center.distance1(e.center)>ui&&n.dot(t.center.sub(e.center))>0?{state:e.isCCW?3:4,exitIsInvalid:!1}:{state:t.isCCW?3:4,exitIsInvalid:!0}}return ug(t,e,r,i)}function hY(t,e){let r=Ff.foot(t,e.center),i=t.end().distance2(e.center),n=t.end().sub(t.start()),s=(e.rx-ui)**2,a=i<=(e.rx+ui)**2&&i>=s&&(n.dot(r.sub(e.start()))<=0||t.start().distance2(t.end())<=t.start().distance2(r)||r.distance2(e.center)>=s)&&(jr(t.end(),e.end())||nM(e,t.end())),o=pV(e,t);if(!a&&!o){let l=t.distance2(e.center);return l<=ou?{state:n.cross(Uf(e))>0?4:3}:n.dot(r.sub(e.start()))>=0&&(i<s||t.start().distance2(e.center)<s||l<s)?{state:n.cross(e.center.sub(t.start()))<0?4:3}:{state:n.cross(e.center.sub(t.start()))>0?4:3}}return ug(e,t,a,o)}function jp(t,e){return e=Ii.regularD(e),t.sweepAngle>0?(e<t.startAngle&&(e+=360),t.endAngle()>e):(e>t.startAngle&&(e-=360),t.endAngle()<e)}function nM(t,e){return jr(t.end(),e)||jr(t.start(),e)||jp(t,e.angleD(t.center))}function AV(t,e){let r=t.panDistance(ui),i=t.panDistance(-ui),n=AY(e,r),s=AY(e,i);if(!n.length&&!s.length)return{isIn:e.getPercent(t.end(),ui)!==null};let a=[...n,...s].sort((u,d)=>u.t-d.t),o=new Ge(i.start(),r.start()),l=[];for(let u=0,d=a.length;u<d;u++){let A=a[u];if(l.push(A),o.distance(A.interP)>t.length()+ui)break;if(l.length===2){let h=(l[1].t*10+l.shift().t*10)/20,f=br.pointOn(h,e.controls);if(t.distance2(f)>ou)return{isIn:!1,bezierIsInLeft:t.direct.cross(f.sub(t.start()))>0}}}let c=l.length?o.distance(l[0].interP)>=t.length()+ui:!0;return{isIn:c,bezierIsInLeft:c?void 0:t.direct.cross(l[0].interP.sub(t.start()))>0}}function fV(t,e){if(lC(e,t.end())>ou||t.getToLineMaxDis2(e)>ou)return!1;let r=Bge(e,ou);return t.getToLineMaxDis2(r)<=(e.length()+ui)**2}function pV(t,e){let r=e.end().angleD(e.start()),i=Ige(e,t.end());if(i>ou)return!1;if(jp(t,r+90)){if(Ff.foot(e,t.center).distance1(t.pointOn(r+90))>t.rx)return!1;i=Math.max(i,(t.rx-e.distance(t.center))**2)}if(jp(t,r-90)){if(Ff.foot(e,t.center).distance1(t.pointOn(r-90))>t.rx)return!1;i=Math.max(i,(t.rx-e.distance(t.center))**2)}return i<=ou&&(jr(t.end(),e.end())||_4(e,t.end()))}var mV=(ui*2)**2;function sM(t,e){if(jr(t.end(),e))return gt.build3(t.center,t.endAngle(),0,t.rx,t.ry);if(t.start().distance2(e)<mV)return t;let r=Ii.regularD(e.angleD(t.center));if(!jp(t,r))throw new Error("!angleIsInArc(arc, angle)");return gt.build2(t.center,r,t.endAngle(),t.rx,t.ry,t.isCCW?1:0)}function D4(t,e){if(jr(t.end(),e))return new br([e,e]);if(t.start().distance2(e)<mV)return t;let r=t.getPercent(e,ui);if(r===null)throw new Error("!cutBezier(bezier: Bezier, p: Vector2)");return t.clip(r)[1]}function dY(t,e){let r=pV(sM(t,e.start()),e),i=e.end().distance2(t.center),n=e.end().sub(e.start()),s=Ff.foot(e,t.center),a=(t.rx-ui)**2,o=i<=(t.rx+ui)**2&&i>=a&&(n.dot(s.sub(e.start()))<=0||e.start().distance2(e.end())<=e.start().distance2(s)||s.distance2(t.center)>=a)&&(jr(t.end(),e.end())||nM(t,e.end()));if(!r&&!o){let l=e.distance2(t.center);return l<=ou?{state:n.cross(Uf(t,e.start().angle(t.center)))>0?3:4}:n.dot(s.sub(e.start()))>=0&&(i<a||e.start().distance2(t.center)<a||l<a)?{state:n.cross(t.center.sub(e.start()))>0?4:3}:{state:n.cross(t.center.sub(e.start()))<0?4:3}}return ug(e,t,r,o)}function I1(t,e){if(jr(t.end(),e.end()))return ug(t,e,!0,!0);let r=lC(e,t.end())<=ou&&_4(e,t.end()),i=lC(t,e.end())<=ou&&_4(t,e.end());if(!r&&!i){let n=t.direct.x===0&&t.direct.y===0,s=e.direct.x===0&&e.direct.y===0;if(n&&s)throw Error("2LineAllIsPoint");return n?{state:e.direct.cross(t.end().sub(e.start()))>0?3:4}:{state:t.end().sub(t.start()).cross(e.end().sub(t.start()))>0?4:3}}return ug(t,e,r,i)}function _4(t,e){return Ff.foot(t,e).distance2(t.start())<t.end().distance2(t.start())}function ug(t,e,r,i){if(r)return i?jr(t.end(),e.end())?{state:2}:{state:0}:{state:0};if(i)return{state:1};throw new Error("!end1 && !end2")}function lC(t,e){return(t.a*e.x+t.b*e.y+t.c)**2/(t.a**2+t.b**2)}function Ige(t,e){return Math.min(t.distance2(e),Ff.foot(t,e).distance2(e))}function Bge(t,e){let r=t.panDistance(e),i=t.panDistance(-e);return new Ge(i.start(),r.start())}function sg(t){let e=t.start(),r=t.end();e.equals1(r)&&(r=e.add1(1,0));let i=r.y-e.y,n=e.x-r.x,s=-i*e.x-n*e.y,a=Math.sqrt(1/(i**2+n**2));i*=a,n*=a,s*=a;let o=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;return t.controls.forEach(c=>{let u=i*c.x+n*c.y+s;u<o&&(o=u),u>l&&(l=u)}),Jp(o,l)}function AY(t,e){let r=IA(t,e),i=[],n=new Array(r).fill(0).map((a,o)=>De[o]);for(let a=0;a<r;a+=2){let o=new We(De[a],De[a+1]),l=t.getPercent(o);i.push({interP:o,t:l}),s()}function s(){for(let a=0;a<r;a+=2)De[a]=n[a],De[a+1]=n[a+1]}return i}var Yp=.01,Dge=270;function k0(t){let e=Yp**2,r=t.end(),i=[],n=[];for(let h=0,f=t.primitives.length;h<f;h++){let p=function(U,_){return U instanceof Ge&&_ instanceof Ge&&Math.abs(U.direct.cross(_.direct))<vt.eps&&U.direct.dot(_.direct)>0||U instanceof gt&&_ instanceof gt&&Math.abs(U.rx-_.rx)<=vt.eps&&U.center.distance2(_.center)<vt.eps&&U.isCCW===_.isCCW},m=function(U){if(Ud(U,Yp))n.push(null);else{if(U instanceof Ge)n.push(U);else if(U instanceof gt&&U.rx===U.ry)d(U,n);else if(U instanceof br){let _=[];nV(U,_),_.forEach(H=>{let Q=H.start(),j=H.end();u(Q,j)||n.push(H)})}else throw new Error("not support!");r=E}},y=function(U){if(U instanceof Ge)return U.direct.x===0&&U.direct.y===0;if(U instanceof gt)return U.sweepAngle===0;if(U instanceof br){let _=new Set(U.controls.map(Q=>Q.x)),H=new Set(U.controls.map(Q=>Q.y));return _.size===1&&H.size===1}else throw new Error("not support")},g=t.primitives[h],b=g.start(),E=g.end();if(y(g))continue;u(r,b)||(n.push(new Ge(r,b)),r=b);let w=(h+1)%f,x=t.primitives[w];for(;p(g,x)&&(w=(w+1)%f,x=t.primitives[w],x!==g););if(w===(h+1)%f){m(g);continue}if(x===g){if(!(g instanceof gt)){if(Math.abs(t.area(.1))<e)return null;throw new Error("simplifyPolyline not support")}let U=g instanceof gt?g.isCCW:t.area(.1)>0;n.length=0;let _=U?180:-180;n.push(gt.build3(g.center,g.startAngle,_,g.rx,g.ry),gt.build3(g.center,g.startAngle+_,_,g.rx,g.ry));break}let I=(()=>{if(g instanceof Ge)return(U,_)=>{let H=new Ge(U,_);return Ud(H,Yp)?null:[H]};if(g instanceof gt)return(U,_)=>{let H;if(U.equals1(_)?H=gt.build3(g.center,g.startAngle,g.sweep()===1?360:-360,g.rx,g.ry):H=gt.build4(U,_,g.center,g.rx,g.ry,g.sweep()),Ud(H,Yp))return null;let Q=H.pointOn(H.startAngle+H.sweepAngle/2),j=gt.build4(H.start(),Q,g.center,g.rx,g.ry,g.sweep()),$=gt.build4(Q,H.end(),g.center,g.rx,g.ry,g.sweep());return Ud(j,Yp)||Ud($,Yp)?[H]:[j,$]};throw new Error("not support")})(),C=w===0;if(w<h&&!C&&(C=!I(t.primitives[0].start(),t.primitives[w-1].end()),!C)){let U=I(g.start(),t.primitives[f-1].end());if(U)n.push(...U);else{let _=I(g.start(),n[0].end());if(_.length===1)n[0]=_[0];else if(_.length===2)n[0]=_[1],n.push(_[0]);else throw new Error("!!!generatorPt")}break}h=w===0?f-1:w-1,x=t.primitives[h];let G=I(g.start(),x.end());if(G?(G.forEach(U=>n.push(U)),r=x.end()):m(null),C)break}let s=n.length;if(n.forEach((h,f)=>{if(h)i.push(h);else{let p,m;f===s-1&&(p=i[0],m=i[i.length-1]);let y=(f+1)%s;if(p=p!=null?p:n[y],p){let g=f,b=!1;for(;m=m!=null?m:n[(--g+s)%s],m!==p;)if(m){b=!0;break}if(b){if(p.start().equals1(m.end()))return;if(ci(m,m.end()).dot(ci(p,p.start()))<0){if(!u(m.end(),p.start())){let I=new Ge(m.end(),p.start());i.push(I);return}let{rebuildPrevPt:E,rebuildNextPt:w,rebuildLinkLine:x}=fY(n[(g-1+s)%s],m,new Ge(m.end(),p.start()),p,n[(f+2)%s]);E&&w&&(E!==m?(n[(g+s)%s]=E,i[i.length-1]&&(i[i.length-1]=E)):w!==p&&(n[(f+1)%s]=w,i[0]===p&&(i[0]=w)),x&&i.push(x))}}}}}),i.length===0)return null;u(r,i[0].start())||i.push(new Ge(r,i[0].start()));let a=i[i.length-1];if(i.length===1)return a instanceof gt?cn.build7([gt.build2(a.center,0,180,a.rx,a.ry,a.sweep()),gt.build2(a.center,180,360,a.rx,a.ry,a.sweep())]):a instanceof br?cn.build7(a.clip(.5)):null;let o=i.map(h=>new _ge(h)),l=o[o.length-1];for(o.forEach(h=>{h.connect(l),l=h});!l.isVisited;){let h=function(){l.next.connect(p),l=l.next,l.isConnected=!1,l.isVisited=!1},f=function(){l.connect(p.prev),l.isConnected=!1},p=l.prev;if(l===p)break;let m=l.pt,y=p.pt,g=y.end();if(!l.isConnected&&!g.equals(m.start())){let b=function(w){l.isConnected=!0,l.pt=m=w,l.next.isVisited=!1},E=function(w){l.isConnected=!0,p.pt=w,p.isVisited=!1,l=p};if(m instanceof Ge)if(u(g,m.end())){h();continue}else b(new Ge(g,m.end()));else if(y instanceof Ge){u(y.start(),m.start())?f():E(new Ge(y.start(),m.start()));continue}else if(m instanceof br)if(u(g,m.end())&&!(m.controls.length!==2&&m.getToLineMaxDis2(m.startToEndL)>=e)){h();continue}else b(new br([g,...m.controls.slice(1)]));else if(y instanceof br)u(y.start(),m.start())&&!(y.controls.length!==2&&y.getToLineMaxDis2(y.startToEndL)>=e)?f():E(new br([...y.controls.slice(0,-1),m.start()]));else if(m instanceof gt&&y instanceof gt)if(Math.abs(Math.abs(m.sweepAngle)-180)<Math.abs(Math.abs(y.sweepAngle)-180)){let w=gt.build5(g,m.end(),m.sweepAngle);if(u(w.start(),w.end())&&!(w.rx>=Yp&&Math.abs(w.sweepAngle)>180)){h();continue}else b(w)}else{let w=gt.build5(y.start(),m.start(),y.sweepAngle);u(w.start(),w.end())&&!(w.rx>=Yp&&Math.abs(w.sweepAngle)>180)?f():E(w);continue}else throw new Error("not support")}if(ci(m,m.start()).dot(ci(y,y.end()))<0){let b=function(x,I,C,G,U,_){if(l.next===p){l=null;return}let{rebuildLinkLine:H,rebuildPrevPt:Q,rebuildNextPt:j}=fY(x,I,C,G,U);Q&&j&&(Q!==I&&(p.prev.pt=Q),j!==G&&(l.next.pt=j),H?_.pt=H:h())},E=function(){l.next===p?l=null:(l.next.connect(p.prev),l=l.next,l.isConnected=!1,l.isVisited=!1)},w=au(y.reverse(),m).state;if(w===0){let x=pY(m,y.start(),m.end());if(A(x)){let I=p.prev.pt,C=l.next.pt;if(ci(C,C.start()).dot(ci(I,I.end()))>=0){if(E(),!l)break;continue}if(b(p.prev.prev.pt,I,x instanceof Ge?x:new Ge(x.start(),x.end()),C,l.next.next.pt,l),!l)break}else l.pt=x;f();continue}else if(w===1){let x=pY(y,y.start(),m.end());if(A(x)){let I=p.prev.pt,C=l.next.pt;if(ci(C,C.start()).dot(ci(I,I.end()))>=0){if(E(),!l)break;continue}if(b(p.prev.prev.pt,I,x instanceof Ge?x:new Ge(x.start(),x.end()),C,l.next.next.pt,p),!l)break}else p.pt=x;h();continue}else if(w===2){if(E(),!l)break;continue}}l.isVisited=!0,l=l.next}if(!l)return null;i.length=0;let c=l;for(i.push(l.pt),l=l.next;l!==c;)i.push(l.pt),l=l.next;if(i.length===1){let h=i[0];return h instanceof gt?(u(h.start(),h.end())?i[0]=gt.buildCircle(h.center,h.rx,h.sweep()):i.push(new Ge(h.end(),h.start())),cn.build7(i)):h instanceof br?(u(h.start(),h.end())||i.push(new Ge(h.end(),h.start())),cn.build7(i)):null}if(t=cn.build7(i),Math.abs(t.area(.1))<e)return null;return t;function u(h,f){return h.distance2(f)<e}function d(h,f){if(Math.abs(h.sweepAngle)>Dge){let p=h.sweepAngle/2;d(gt.build3(h.center,h.startAngle,p,h.rx,h.ry),f),d(gt.build3(h.center,h.startAngle+p,p,h.rx,h.ry),f)}else f.push(h)}function A(h){return h.start().distance2(h.end())<e&&!(h instanceof gt&&h.rx>=Yp&&Math.abs(h.sweepAngle)>180||h instanceof br&&h.controls.length!==2&&h.getToLineMaxDis2(new Ge(h.start().add1(1,0),h.end()))>=e)}}function Ud(t,e){if(!t)return!0;let r=t.start(),i=t.end();if(r.distance2(i)<e**2)if(t instanceof gt){if(!(t.rx>=e&&Math.abs(t.sweepAngle)>180))return!0}else if(t instanceof br){if(!(t.controls.length!==2&&t.getToLineMaxDis2(new Ge(t.start().add1(1,0),t.end()))>=e))return!0}else return!0;return!1}function Jx(t){if(t.direct.x===0&&t.direct.y===0)throw Error("getEndOfExtendLine(line: Line, distance: number)");let e=Math.abs(Yp-t.length())+vt.eps,r={x:t.direct.normalize().x*e,y:t.direct.normalize().y*e},i=t.end();return new We(i.x+r.x,i.y+r.y)}function fY(t,e,r,i,n){if(!t)a();else if(!n)o();else{let l=ci(t,t.end()),c=ci(e,t.end()),u=l.dot(c);if(u>=0)a();else{let d=ci(i,i.end()),A=ci(n,i.end()),h=d.dot(A);if(h>=0)o();else if(Jp(u,-1)&&Jp(h,-1)){let f=r.center();s(f),r=null}else u>h?a():o()}}function s(l){let c;if(e instanceof Ge)c=new Ge(e.start(),l);else if(e instanceof br)c=new br([...e.controls.slice(0,-1),l]);else if(e instanceof gt)c=gt.build5(e.start(),l,e.sweepAngle);else throw new Error("not supported");e=Ud(c,ui)?null:c;let u;if(i instanceof Ge)u=new Ge(l,i.end());else if(i instanceof br)u=new br([l,...i.controls.slice(1)]);else if(i instanceof gt)u=gt.build5(l,i.end(),i.sweepAngle);else throw new Error("supported");i=Ud(u,ui)?null:u}function a(){if(e instanceof Ge){let l=Jx(r.reverse());r=new Ge(l,r.end());let c=new Ge(e.start(),l);e=Ud(c,ui)?null:c}else if(e instanceof br){let l=Jx(r.reverse());r=new Ge(l,r.end());let c=new br([...e.controls.slice(0,-1),l]);e=Ud(c,ui)?null:c}else if(e instanceof gt){let l=Jx(r.reverse());r=new Ge(l,r.end());let c=gt.build5(e.start(),l,e.sweepAngle);e=Ud(c,ui)?null:c}else throw new Error("not supported")}function o(){if(i instanceof Ge){let l=Jx(r);r=new Ge(r.start(),l);let c=new Ge(l,i.end());i=Ud(c,ui)?null:c}else if(i instanceof br){let l=Jx(r);r=new Ge(r.start(),l);let c=new br([l,...i.controls.slice(1)]);i=Ud(c,ui)?null:c}else if(i instanceof gt){let l=Jx(r);r=new Ge(r.start(),l);let c=gt.build5(l,i.end(),i.sweepAngle);i=Ud(c,ui)?null:c}else throw new Error("not supported")}return{rebuildPrevPt:e,rebuildNextPt:i,rebuildLinkLine:r}}function pY(t,e,r){if(t instanceof Ge||e.distance2(r)<=ou)return new Ge(e,r);if(t instanceof gt)return gt.build2(t.center,e.angleD(t.center),r.angleD(t.center),t.rx,t.ry,t.isCCW?1:0);if(t instanceof br){let i=t.getPercent(e,ui),n=t.getPercent(r,ui);return t.clip(i)[1].clip((n-i)/(1-i))[0]}else throw new Error("not supported operation")}var _ge=class{constructor(t){this.pt=t}connect(t){this.prev=t,t.next=this}};function FD(t){let e=wC(),r;if(t instanceof cn){let i=k0(t);if(i===null)return null;r=i}else if(t instanceof Ko){let i=t.items.map(n=>FD(n)).filter(n=>n!==null);if(i.length===0)return null;r=new Ko(i)}else{let i=t.items.map(n=>FD(n)).filter(n=>n!==null);if(i.length===0)return null;r=new ao(i)}return qp.preprocessPolyline+=P0(e),r}var qp={addDocShapes2RTree:0,getPour:0,prepare:0,getSinglePourLayerPolyline:0,combindOutlines:0,mergeSameNet:0,run:0,end:0,deSelfIntersection:0,changeDirect:0,extend:0,preprocessPolyline:0,runBoolean:0,IntersectionSeeker:0,BooleanTools:0,totalBool:0};function wC(){return{timeIndex:Object.assign({},qp),start:performance.now()}}function mY(t){return Object.values(t).reduce((e,r)=>e+r,0)}function P0(t){return performance.now()-t.start-(mY(qp)-mY(t.timeIndex))}function Gl(t,e,r,i){let n=Xn.RED,s=Xn.Golden;function a(){if(!i)return;let A=i.initColor(Xn.Golden);A.addPt(o),A.addPoint(o.end()),i.initColor(Xn.RED).addPt(l),i.draw();debugger}let o=t.getShape(),l=r?e.getShape():e.getShape().reverse(),c=ci(o,l.start()),u=ci(l),d=c.cross(u);if(Jp(d,0))if(o instanceof Ge)if(l instanceof Ge){if(vt.eq(d,0)&&(c.dot(u)>0?!jr(o.end(),l.start()):!jr(o.start(),l.start())))throw a(),new Error("line and line");return d<0}else{if(l instanceof gt)return c.cross(l.center.sub(o.start()))<0;if(l instanceof br){let A=l.getExtremePoints(o),h=A.length?A[0]:l2(l.controls,o.start());return c.cross(h.sub(o.start()))<0}else throw new Error("not support")}else if(o instanceof gt){if(l instanceof Ge)return o.isCCW;if(l instanceof gt){if(l.center.equals1(o.center)&&(c.dot(u)>0?!jr(o.end(),l.start())&&o.end().sub(l.start()).dot(u)>0:!jr(o.start(),l.start())&&o.start().sub(l.start()).dot(u)>0))throw a(),new Error("arc and arc");return l.rx>=o.rx||l.center.distance2(o.center)>o.rx2?o.isCCW:!o.isCCW}else throw new Error("not support")}else if(o instanceof br)if(l instanceof Ge){let A=o.getPercent(l.start(),ui),h=o.clip(A)[1],f=h.getExtremePoints(l);return(f.length?f[0]:l2(h.controls,l.start())).sub(l.start()).cross(u)<0}else if(l instanceof br){let A=o.getPercent(l.start(),ui),h=o.clip(A)[1],f=h.getExtremePoints(new Ge(l.start(),l.end())),p=l.getExtremePoints(new Ge(h.start(),h.end())),m=f.length?f[0]:l2(h.controls,l.start()),y=p.length?p[0]:l2(l.controls,l.start()),g=m.sub(l.start()),b=y.sub(l.start());return g.cross(b)<0}else throw Error("not support");else throw new Error("not support");else return d<0}function O1(t,e,r,i,n){let s=t.getShape(),a=e.getShape(),o=s instanceof gt?Uf(s,Ii.toRadians(s.endAngle())):s instanceof br?aC(s,1):s.end().sub(s.start()).normalize(),l=ci(a),c=o.dot(l);if(Jp(c,-1))return Gl(t,e,!0,n)?Gl(t,r,i,n)&&Gl(e,r,i,n):Gl(t,r,i,n)||Gl(e,r,i,n);{let u=o.scale(-1).angle(We.ORIGIN),d=l.angle(We.ORIGIN);u>d&&(u-=e_);let A=(u+d)/2,h=new We(Math.cos(A),Math.sin(A)),f=i?r.getShape():r.getShape().reverse(),p=ci(f);return h.cross(p)<0?Gl(t,r,i,n):Gl(e,r,i,n)}}function o4(t,e,r,i,n){let s=t.getShape(),a=e.getShape(),o=s instanceof gt?Uf(s,Ii.toRadians(s.endAngle())):s instanceof br?aC(s,1):s.end().sub(s.start()).normalize(),l=ci(a),c=o.dot(l);if(Jp(c,-1))return Gl(t,e,!0,n)?Gl(t,r,i,n)&&Gl(e,r,i,n):Gl(t,r,i,n)||Gl(e,r,i,n);{let u=o.scale(-1).angle(We.ORIGIN),d=l.angle(We.ORIGIN);u>d&&(u-=e_);let A=(u+d)/2,h=new We(Math.cos(A),Math.sin(A)),f=i?r.getShape():r.getShape().reverse(),p=ci(f);if(h.cross(p)<0){let m=o.dot(p)<0,y=au(m?t.getShape().reverse():t.getShape(),f).state;return y!==3&&y!==4?Gl(t,r,i,n):y===(m?4:3)}else{let m=l.dot(p)<0,y=au(m?e.getShape().reverse():e.getShape(),f).state;return y!==3&&y!==4?Gl(e,r,i,n):y===(m?4:3)}}}var Pge=(t=>(t[t.NOT_IN=0]="NOT_IN",t[t.IS_IN=1]="IS_IN",t[t.IS_OVERLAP=2]="IS_OVERLAP",t))(Pge||{}),Lge=(t=>(t[t.AllClear=0]="AllClear",t[t.MapClear=1]="MapClear",t))(Lge||{}),Qp,O0=!1;function Hd(t,e,r,i,n,s,a,o=r.side===e,l=!0,c){return Qp=n,O0=s,gV(yV(t,e,l,c,a,r,o,i),r,o,i,0)}function rg(t,e,r,i,n,s,a,o=i.side===r){Qp=n,O0=s;let l=bV(t,e,r,new Map,i,o,a),c=l instanceof Array?-1:1;return gV(l,i,o,a,c)}function gV(t,e,r,i,n){for(;t instanceof Array;)n++,t.length===4?t=bV(...t,e,r,i):t=yV(...t,e,r,i);return{...t,existOverlap:n>0}}function yV(t,e,r,i,n,s,a,o){if(UD===-1){o.initColor(Xn.RED).addPt(t.getShape()),o.initColor(Xn.Golden).addPt(e.getShape()),o.draw();debugger}let l=t.getShape(),c=a?e.getShape().reverse():e.getShape(),u=(l instanceof gt?Uf(l,r?c.start().angle(l.center):i?Ii.toRadians(l.endAngle()):void 0):l instanceof br?ci(l,r?c.start():i?l.end():l.start()):l.end().sub(l.start())).normalize(),d=(c instanceof gt?Uf(c,r?void 0:(i?l.end():l.start()).angle(c.center)):c instanceof br?ci(c,r?void 0:i?l.end():l.start()):c.end().sub(c.start())).normalize();if(i===void 0){let f=u.dot(d);if(i=f<0,Jp(f,0))return{state:Gl(t,e,!a,o)?1:0,inter:ig(t,e,s,a,r,i,n)}}else if(i?u.dot(d)>0:u.dot(d)<0)if(r){let f,p=!0;if(l instanceof Ge&&jr(Ff.foot(l,c.start()),i?l.end():l.start()))p=!1;else if(l instanceof gt||l instanceof br){let m=i?l.reverse():l,y=au(c,zme(m,c.start()).reverse()).state;(y===1||y===2)&&(p=!1)}if(p){let m=!i;f=au(m?l.reverse():l,c,o).state===(m?4:3)?1:0}else i?f=O1(t,t.nextSide,e,!a,o)?1:0:f=O1(t.prevSide,t,e,!a,o)?1:0;return{state:f,inter:ig(t,e,s,a,r,i,n)}}else return i?{state:Gl(t,t.nextSide,!0,o)?0:1,inter:ig(t,e,s,a,r,i,n),isReversed:!0}:{state:Gl(t.prevSide,t,!0,o)?0:1,inter:ig(t,e,s,a,r,i,n),isReversed:!0};let A,h=new Map([[3,4],[4,3],[0,1],[1,0],[2,2]]);if(r)if(t.judgeOverlapMap.has(e)&&!O0){let f=t.judgeOverlapMap.get(e);A=i?h.get(f.state):f.state}else A=au(i?l.reverse():l,c).state,(A===3||A===4)&&t.judgeOverlapMap.set(e,{state:i?h.get(A):A});else{if(e.judgeOverlapMap.has(t)&&!O0){let f=e.judgeOverlapMap.get(t);A=a?h.get(f.state):f.state}else A=au(c,i?l.reverse():l).state,(A===3||A===4)&&e.judgeOverlapMap.set(t,{state:a?h.get(A):A});A=h.get(A)}if(A===1||A===2){let f=a?e.prevSide:e,p=f.inters,m=f.getEnd();for(let y=p.length-1;y>=0;y--){let g=p[y];if(!(f.getShape()instanceof br)&&!jr(m,g.coord))break;if(g===s)return{state:2,inter:ig(t,e,s,a,r,i,n)}}}if(A===3||A===4)return{state:A===(i?4:3)?1:0,inter:ig(t,e,s,a,r,i,n)};if(n.has(t)?n.get(t).mapSideList.push(e):n.set(t,{sideIsReversed:i,mapSideList:[e]}),n.has(e)?n.get(e).mapSideList.push(t):n.set(e,{sideIsReversed:a,mapSideList:[t]}),A===2)return i?[t.prevSide,t,a?e.prevSide:e.nextSide,n]:[t,t.nextSide,a?e.prevSide:e.nextSide,n];if(A===0)return[i?t.prevSide:t.nextSide,e,!1,i,n];if(A===1)return[t,a?e.prevSide:e.nextSide,!0,i,n];throw Error("not support")}function ig(t,e,r,i,n,s,a){if(O0)return null;let o=t.getShape(),l=i?e.getShape().reverse():e.getShape(),c=i;if(!n){let h=e;e=t,t=h,i=s,r=r.getBindedInter()}let u=h=>!(n?s:c)&&jr(h,t.prevSide.getEnd())?t.prevSide:t;if(i){let h=e.inters;for(let f=0;f<h.length;f++){let p=h[f];if(p.isInvalid&&s===void 0)continue;if(p===r&&jr(l.start(),r.coord))return n?p:p.getBindedInter();let m=p.getBindedInter().side,y=u(p.coord);if(m===y&&d(p))return A(p)}for(;;){e=e.nextSide;let f=e.inters;for(let p=0;p<f.length;p++){let m=f[p];if(m===r)return n?m:m.getBindedInter();if(a.has(e)){let y=m.getBindedInter().side;if(a.get(e).mapSideList.includes(y)||jr(m.coord,y.getEnd())&&a.get(e).mapSideList.includes(y.nextSide))return A(m);if(a.has(y)){let g=e.getShape().reverse(),b=ci(g,m.coord).dot(ci(y.getShape(),m.coord))<0,E=b?y.getShape().reverse():y.getShape(),w=au(g,b?r4(E,m.coord,E.end()):r4(E,E.start(),m.coord)).state;if(w===1||w===2)return A(m)}else a.has(y.nextSide)}else if(m.side===r.side&&d(m))return A(m)}}}else{let h=e.inters;for(let f=h.length-1;f>=0;f--){let p=h[f];if(p.isInvalid&&s===void 0)continue;if(p===r&&jr(l.start(),r.coord))return n?p:p.getBindedInter();let m=p.getBindedInter().side,y=u(p.coord);if(m===y&&d(p))return A(p)}for(;;){e=e.prevSide;let f=e.inters;for(let p=f.length-1;p>=0;p--){let m=f[p];if(m===r)return n?m:m.getBindedInter();if(a.has(e)){let y=m.getBindedInter().side;if(a.get(e).mapSideList.includes(y)||jr(m.coord,m.getBindedInter().side.getEnd())&&a.get(e).mapSideList.includes(y.nextSide))return A(m);if(!a.has(y)&&a.has(y.prevSide)){let g=e.getShape().reverse(),b=ci(g,m.coord).dot(ci(y.getShape(),m.coord))<0;if(a.has(y.prevSide)){let E=b?y.getShape().reverse():y.getShape(),w=au(e.getShape(),r4(E,m.coord,E.end())).state;if(w===1||w===2)return A(m)}}}else if(m.side===r.side&&d(m))return A(m)}}}function d(h){if(h.isInvalid||h.getBindedInter().side!==(jr(h.coord,t.prevSide.getEnd())?t.prevSide:t))return!1;let f;if(n){if(jr(h.coord,l.start()))return!0;f=au(s?o.reverse():o,p(l)).state}else{if(jr(h.coord,s?o.end():o.start()))return!0;f=au(l,p(s?o.reverse():o)).state}return f===2||f===1;function p(m){if(m instanceof Ge)return jr(h.coord,m.end())?m:m.cutLine(h.coord);if(m instanceof gt)return gt.build2(m.center,m.startAngle,h.coord.angleD(m.center),m.rx,m.ry,m.isCCW?1:0);if(m instanceof br)return m.clip(m.getPercent(h.coord,ui))[0];throw new Error("not supported operation")}}function A(h){let f=r.getBindedInter(),p=r.side,m=f.side,y=r===h,g=r;if(i){let b=r.getIndex()-1;for(;p;){let E=p.inters;for(;b>=0;b--)if(r=E[b],r===h){y||(r.setIsInvalid(),r.isDealed(),g=r),p=null;break}else if(Qp===0)!r.isInvalid&&(!jr(r.coord,h.coord)||r.side===h.side&&r.getBindedInter().side===h.getBindedInter().side)&&(r.setIsInvalid(),r.isDealed(),g=r);else if(Qp===1){if(r.isInvalid)continue;let w=r.getBindedInter().side;a.has(p)&&a.get(p).mapSideList.includes(w)&&(r.setIsInvalid(),r.isDealed(),g=r)}p=p==null?void 0:p.prevSide,b=(p==null?void 0:p.inters.length)-1}}else{let b=r.getIndex()+1;for(;p;){let E=p.inters;for(;b<E.length;b++){r=E[b];let w=r.getBindedInter();if(r===h){y||(r.setIsInvalid(),r.isDealed(),g=r),p=null;break}else if(Qp===0)!r.isInvalid&&(!jr(r.coord,h.coord)||p===h.side&&(jr(w.side.getEnd(),r.coord)?w.side.nextSide:w.side)===h.getBindedInter().side)&&(r.setIsInvalid(),r.isDealed(),g=r);else if(Qp===1){let x=w.side;a.has(p)&&a.get(p).mapSideList.includes(x)&&(r.setIsInvalid(),r.isDealed(),g=r)}}p=p==null?void 0:p.nextSide,b=0}}if(Qp===0&&!jr(f.coord,h.coord))if(n?a.has(m)?a.get(m).sideIsReversed:s:c){let b=f.getIndex()-1;for(;m;){let E=a.has(m),w=m.inters;for(;b>=0;b--){if(f=w[b],f===h.getBindedInter()){m=null;break}f.isInvalid||!E||(!jr(f.coord,h.getBindedInter().coord)||f.side===h.side&&f.getBindedInter().side===h.getBindedInter().side)&&(f.setIsInvalid(),f.isDealed())}m=m==null?void 0:m.prevSide,b=(m==null?void 0:m.inters.length)-1}}else{let b=f.getIndex()+1;for(;m;){let E=m.inters,w=a.has(m);for(;b<E.length;b++){if(f=E[b],f===h.getBindedInter()){m=null;break}let x=jr(m.getEnd(),f.coord)?a.has(m.nextSide):!1;f.isInvalid||!(w||x)||(!jr(f.coord,h.getBindedInter().coord)||f.side===h.side&&f.getBindedInter().side===h.getBindedInter().side)&&(f.setIsInvalid(),f.isDealed())}m=m==null?void 0:m.nextSide,b=0}}return n?g:g.getBindedInter()}}function bV(t,e,r,i,n,s,a){let o=t.getShape(),l=e.getShape(),c=s?r.getShape().reverse():r.getShape(),u=(o instanceof gt?Uf(o,c.start().angle(o.center)):o instanceof br?ci(o,c.start()):o.end().sub(o.start())).normalize(),d=(l instanceof gt?Uf(l,c.start().angle(l.center)):l instanceof br?ci(l,c.start()):l.end().sub(l.start())).normalize(),A=u.dot(d);if(Jp(A,-1)){let h=s?r.getShape().reverse():r.getShape(),f=ci(h).normalize(),p=u.add(d.scale(-1)).normalize().dot(f),m=au(o.reverse(),l,a).state;if(p>-.9&&(m===3||m===4))return{state:m===4?0:1,inter:ig(e,r,n,s,!0,!1,i)};let y=Hd(t,r,n,a,Qp,O0,i.size===0?new Map:i,s);return y.state===2?y:m===4?y.state===0||y.inter!==n?y:Hd(e,r,n,a,Qp,O0,i.size===0?new Map:i,s):y.state===1||y.inter!==n?y:Hd(e,r,n,a,Qp,O0,i.size===0?new Map:i,s)}else{let h=u.scale(-1).angle(We.ORIGIN),f=d.angle(We.ORIGIN);h>f&&(h-=e_);let p=(h+f)/2,m=new We(Math.cos(p),Math.sin(p)),y=ci(c).normalize(),g=y.angle(We.ORIGIN),b=h<g&&g<f&&o instanceof Ge&&l instanceof Ge&&c instanceof Ge;if(m.cross(y)<=0){if(u.scale(-1).dot(y)<0){let E;return n.coord.equals1(c.start())?E=ci(o,n.coord).dot(ci(c,n.coord))<0:c instanceof Ge&&(E=ci(o,o.end()).dot(c.direct)<0),{state:O1(t,e,r,!s,a)?1:0,inter:ig(t,r,n,s,!0,E,i)}}return b&&o.distance2(c.start())>ou?[e,r,!0,void 0,i]:[t,r,!0,void 0,i]}else return d.dot(y)<=0?{state:O1(t,e,r,!s,a)?1:0,inter:ig(e,r,n,s,!0,void 0,i)}:b&&l.distance2(c.start())>ou?[t,r,!0,void 0,i]:[e,r,!0,void 0,i]}}var UD=0;function Oge(t,e,r,i){let n=e.getBindedInter(),s=e.side,a=n.side,o=s.getShape(),l=a.getShape();if(i&&(UD++,UD===-1)){i.initColor(Xn.RED).addPt(o),i.initColor(Xn.Golden).addPt(l),i.draw();debugger}let c=0,u=!1;if(t===-1){let I=rg(s,s.nextSide,a,n,c,u,i),C=I.state!==0;if(I.state===2){let U=ci(o,e.coord).add(ci(s.nextSide.getShape(),e.coord)).normalize(),_=ci(l,e.coord).add(ci(a.nextSide.getShape(),e.coord)).normalize();return x(C,U.dot(_)>0)}let G=rg(s,s.nextSide,a.nextSide,n,c,u,i);return I.state!==G.state?(w(I,G),1):x(C,I.state!==rg(a,a.nextSide,s,e,c,!0,i).state,I.inter,G.inter)}if(t===1){let I=Hd(s,a,n,i,c,u,new Map),C=I.state!==0;if(I.state===2)return x(C,ci(o,e.coord).dot(ci(l,e.coord))>0);let G;if(I.isReversed&&I.existOverlap&&jr(I.inter.coord,a.getEnd())&&I.inter.getBindedInter().side!==s){let H=I.inter.getBindedInter().side;if(H===s.nextSide)G={state:O1(s,H,a.nextSide,!0,i)?1:0,inter:n};else if(H===s.prevSide){if(G={state:O1(H,s,a.nextSide,!0,i)?1:0,inter:I.inter},I.state===G.state&&e!==I.inter){let Q=ci(l,e.coord),j=ci(a.nextSide.getShape(),e.coord),$=ci(H.getShape(),e.coord);return x(C,Q.add(j).dot($)>0,I.inter,G.inter)}}else G=Hd(s,a.nextSide,n,i,c,u,new Map)}else G=Hd(s,a.nextSide,n,i,c,u,new Map);if(I.state!==G.state)return w(I,G),1;let U=ci(l,e.coord),_=ci(a.nextSide.getShape(),e.coord);if(Jp(U.dot(_),-1)){let H=Gl(a,a.nextSide,!0,i);return x(C,I.state!==Hd(a.nextSide,s,e,i,c,!0,new Map,H?!C:C,!1).state,I.inter,G.inter)}else{let H=ci(o,e.coord);return x(C,U.add(_).dot(H)>0,I.inter,G.inter)}}if(!(o instanceof br||l instanceof br))return 1;let d=ci(o,e.coord),A=ci(l,e.coord),h,f;if(l instanceof Ge)h=new Ge(e.coord,l.start()),f=new Ge(e.coord,l.end());else if(l instanceof gt){let I=e.coord.angleD(l.center);h=gt.build2(l.center,I,l.startAngle,l.rx,l.ry,l.isCCW?0:1),f=gt.build2(l.center,I,l.endAngle(),l.rx,l.ry,l.isCCW?1:0)}else if(l instanceof br){let I=l.getPercent(e.coord,ui);[h,f]=l.clip(I),h=h.reverse()}else throw new Error("not support");let p=d.dot(A)>0,m,y;p?(m=au(o.reverse(),h).state,y=au(o,f).state):(m=au(o,h).state,y=au(o.reverse(),f).state);let g;m===0?g=Hd(p?s.prevSide:s.nextSide,a,n,i,c,u,new Map,!0,!1,p):m===1?g=Hd(s,a.prevSide,n,i,c,u,new Map,!0,!0,p):m===2?p?g=rg(s.prevSide,s,a.prevSide,n,c,u,i,!0):g=rg(s,s.nextSide,a.prevSide,n,c,u,i,!0):p?m===3?g={inter:n,state:0}:g={inter:n,state:1}:m===3?g={inter:n,state:1}:g={inter:n,state:0};let b=g.state!==0;if(g.state===2)return x(b,p);let E;if(y===0?E=Hd(p?s.nextSide:s.prevSide,a,n,i,c,u,new Map,!1,!1,!p):y===1?E=Hd(s,a.nextSide,n,i,c,u,new Map,!1,!0,!p):y===2?p?E=rg(s,s.nextSide,a.nextSide,n,c,u,i,!1):E=rg(s.prevSide,s,a.nextSide,n,c,u,i,!1):p?y===3?E={inter:n,state:1}:E={inter:n,state:0}:y===3?E={inter:n,state:0}:E={inter:n,state:1},g.state===E.state)return g.inter===E.inter?(e.setIsInvalid(),0):x(b,p,g.inter,E.inter);return w(g,E),1;function w(I,C){let G=I.state!==0;if(I.inter===C.inter){e.setOutToIn(G);return}else $x(I.inter,C.inter,!0),$x(C.inter,I.inter,!1);let U=[];if(t===-1){let H=ci(o,e.coord),Q=ci(s.nextSide.getShape(),e.coord),j=ci(l,e.coord),$=ci(a.nextSide.getShape(),e.coord);U.push(H.dot(j)),U.push(H.dot($)),U.push(Q.dot(j)),U.push(Q.dot($))}else{let H=ci(o,e.coord);U.push(ci(l,e.coord).dot(H)),U.push(ci(a.nextSide.getShape(),e.coord).dot(H))}if(U.reduce((H,Q)=>Math.abs(H)>Math.abs(Q)?H:Q,0)>0)if(r===1||r===0||r===2||r===3)e.setOutToIn(G);else throw new Error("not support");else if(r===1)_(!G);else if(r===0||r===2||r===3)_(G);else throw new Error("not support");function _(H){e.setIsInvalid();let Q=(H?I:C).inter;delete Q.isInvalid,delete Q.getBindedInter().isInvalid,Q.setOutToIn(!G)}}function x(I,C,G,U){if(G===U){if(e.side.outline.inters.find(Q=>!Q.isInvalid&&Q!==e&&jr(Q.coord,e.coord)))return e.setIsInvalid(),0;let _=new ng(e.coord,s,i),H=new ng(e.coord,a,i);return _.bind(H),C?s.inters.splice(e.getIndex(),0,_):s.inters.splice(e.getIndex()+1,0,_),a.inters.splice(e.getBindedInter().getIndex(),0,H),_.setOutToIn(I),e.setOutToIn(!I),_.isDealed(),s.inters.forEach((Q,j)=>Q.setIndex(j)),a.inters.forEach((Q,j)=>Q.setIndex(j)),2}else{let _=function(){let H=G.getBindedInter(),Q=U.getBindedInter();delete G.isInvalid,delete H.isInvalid,delete U.isInvalid,delete Q.isInvalid,G.setOutToIn(!I),U.setOutToIn(I),$x(G,U,!0),$x(U,G,!1),$x(H,Q,C),$x(Q,H,!C)};if(e.setIsInvalid(),C){if(r===1||r===0||r===2||r===3)return _(),2;throw new Error("not support")}else{if(r===1)return I?0:(_(),2);if(r===0||r===2||r===3)return I?(_(),2):0;throw new Error("not support")}}}}function $x(t,e,r){let{judge:i,changeNum:n}=a(),s=t.getIndex();for(let o=s+n,l=t.side.inters;i(o);o+=n){if(l[o].isInvalid)continue;if(!jr(l[o].coord,t.coord))break;l[o].setIndex(s),l[s].setIndex(o);let c=l[o];l[o]=l[s],l[s]=c,s=o}function a(){let o=t.side===e.side;if(r){let l=o?e.getIndex():t.side.inters.length;return{judge:c=>c<l,changeNum:1}}else{let l=o?e.getIndex()+1:0;return{judge:c=>c>=l,changeNum:-1}}}}var gY=0,ng=class{constructor(t,e,r){this.id=gY++,this.coord=t,this.side=e,r&&(this.id=gY++,this.drawDebug=r);let i=new vh;i.ext2(t),this._bbox=i.build1()}bbox(){return this._bbox}resetVisitStatus(){this.visited=!1,this.bindedInter.visited=!1}isDealed(){this.dealed=!0,this.getBindedInter().dealed=!0}setOutToIn(t){this.outToIn=t,this.bindedInter.outToIn=!t}setIsInvalid(){this.isInvalid=!0,this.getBindedInter().isInvalid=!0}getBindedInter(){return this.bindedInter}bind(t){this.bindedInter=t,t.bindedInter=this}setIndex(t){this.index=t}isSorted(){return this.index!==void 0}getIndex(){return this.index}getVisited(){return this.visited}visitSelf(){this.visited=!0}visit(){this.visited=!0,this.bindedInter.visited=!0}getPrevPoint(){let t=this.getIndex(),e=this.side.getStart();return t&&(e=this.side.inters[t-1].coord),e}getTangent(){let t=this.side.getShape();if(t instanceof Ge)return t.end().sub(t.start());if(t instanceof gt){let e=this.coord.angle(t.center);return t.isCCW?e+=LD:e-=LD,new We(Math.cos(e),Math.sin(e))}else{if(t instanceof br)return aC(t,t.getPercent(this.coord,ui));throw new Error("not support")}}findStartInter(){return this.outToIn===void 0?this.getTangent().cross(this.bindedInter.getTangent())>0?this:this.bindedInter:this.outToIn?this:this.bindedInter}run(){let t=[],e=this,r;if(this.drawDebug){l4++;let i=l4===-1,n=this.drawDebug.initColor(Xn.RED);if(i){this.drawDebug.draw();debugger}r=s=>{if(t.push(s),i){n.addPt(t[t.length-1]),this.drawDebug.draw();debugger}}}else r=i=>t.push(i);for(;!e.visited;){let i=function(o,l){if(vt.eq(o.distance2(l),0))return;let c=EC.rebuild(s.getShape(),o,l);if(!c)return!0;r(c)};e.visit();let n=e.getIndex(),s=e.side,a=s.inters[n+1];for(;a!=null&&a.isInvalid;)a=s.inters[a.getIndex()+1];if(a)i(e.coord,a.coord),e=a.bindedInter;else{let o=i(e.coord,s.getEnd()),l=e.coord;for(s=s.nextSide,e=null;;){for(let c of s.inters)if(!c.isInvalid){e=c.bindedInter;break}if(e)break;o?(i(l,s.getEnd()),o=!1):r(s.getShape()),s=s.nextSide}o?(vt.eq(l.distance2(e.coord),0)?i(l,s.getEnd()):i(l,e.coord),o=!1):vt.eq(s.getEnd().distance2(e.coord),0)?r(s.getShape()):i(s.getStart(),e.coord)}}if(e!==this)throw this.drawDebug&&console.log(JSON.stringify({runId:l4,handleId:UD,boolId:Wv})),new Error("inter !== this");return k0(cn.build7(t))}},l4=0,c4=class P4{constructor(e,r,i,n,s){this.inters=[],this.allInterIsInvalid=!0,this.isVisit=!1,this.sides=e,this.isGroup1=i,this.isOutside=n,this.finalIsOutside=n,this.polyline=r,s&&(this.polygon=s),e.forEach(a=>a.outline=this)}static build(e,r,i,n,s){let a=e.primitives.map(l=>new EC(l,n)),o=a[a.length-1];return a.forEach(l=>{o.connect(l),o=l}),s?new P4(a,e,r,i,s):new P4(a,e,r,i)}setFinalIsOutSide(e){this.finalIsOutside=e}startAndEndIsSameOutsideFlag(){return this.isOutside===this.finalIsOutside}get hasInter(){return!!this.interOutlines}isAllInterIsInvalid(){return this.allInterIsInvalid}setAllInterIsInvalidToFalse(){this.allInterIsInvalid=!1}resetVisited(){this.isVisit=!1}intersect(e,r){if(!(e.interOutlines&&e.interOutlines===this.interOutlines))if(e.interOutlines)if(this.interOutlines){let i,n;this.interOutlines.length>e.interOutlines.length?(i=this.interOutlines,n=e.interOutlines):(i=e.interOutlines,n=this.interOutlines),n.forEach(s=>{i.push(s),s.interOutlines=i}),r.delete(n)}else e.interOutlines.push(this),this.interOutlines=e.interOutlines;else this.interOutlines?(this.interOutlines.push(e),e.interOutlines=this.interOutlines):(e.interOutlines=this.interOutlines=[this,e],r.add(this.interOutlines))}isContain(e){if(!this.polyline.bbox().extendOfSize(ui).isContainsBBox(e.polyline.bbox()))return!1;let r=e.polyline.primitives[0].start();if(e.hasInter&&e.isAllInterIsInvalid()){let i=e.inters[0];i.getBindedInter().side.outline!==this?r=i.side.getCenterPoint():r=i.side.getCenterPoint(i.coord)}return!!this.polyline.getWindingNum(r)}isInternally(e){return!!this.polyline.getWindingNum(e)}isEqual(e){return this.polyline===e.polyline}bbox(){return this.polyline.bbox()}reverse(){this.sides.reverse();let e=this.sides[this.sides.length-1];this.sides.forEach(r=>{r.reverse(),e.connect(r),e=r})}returnPolyline(){let e=this.sides.map(i=>i.getShape()),r=this.polyline.primitives;if(this.sides.length===r.length){let i=new Set(r);if(!e.some(n=>!i.has(n)))return this.polyline}return cn.build7(e)}};function yY(t,e,r){let i=[];return t.forEach(n=>n.forEach(s=>{if(s.hasInter&&!s.isAllInterIsInvalid())return;let a=s.bbox(),o=e.search(a.extendOfSize(ui)).filter(l=>l.bbox().extendOfSize(ui).isContainsBBox(a)).sort((l,c)=>l.bbox().area()-c.bbox().area());for(let l of o)if(l.isContain(s)){let c=r(!s.isOutside,l.isOutside),u=r(s.isOutside,l.isOutside);c!==u&&(i.push(s),s.setFinalIsOutSide(!c));return}r(s.isOutside,!1)!==r(!s.isOutside,!1)&&i.push(s)})),i}function Nge(t,e,r){let i;switch(r){case 0:i=(o,l)=>o&&l;break;case 1:i=(o,l)=>o||l;break;case 2:i=(o,l)=>o&&!l;break;case 3:i=(o,l)=>o&&!l||!o&&l;break;default:throw Error("not support the rule")}let n=new oC(10),s=new oC(10);t.forEach(o=>o.forEach(l=>n.add(l))),e.forEach(o=>o.forEach(l=>s.add(l)));let a=yY(t,s,i);return yY(e,n,(o,l)=>i(l,o)).forEach(o=>a.push(o)),a}var Rge=class{constructor(t){this.roots=[],this.nodes=t.sort((e,r)=>e.bbox().minX-r.bbox().minX).map(e=>new Mge(e)),this.nodes.forEach((e,r)=>{e.visit()&&(this.roots.push(e),this.build(r))})}build(t){let e=this.nodes[t];for(let r=t+1,i=this.nodes.length;r<i;r++){let n=this.nodes[r];if(e.key.bbox().maxX<n.key.bbox().minX)break;n.getIsVisit()||e.isContain(n)&&(n.visit(),e.addChild(n),this.build(r))}}getPolygons(){let t=[];return this.roots.forEach(e=>e.getPolygons().forEach(r=>t.push(r))),t}},Mge=class{constructor(t){this.children=[],this.isVisit=!1,this.key=t}getIsVisit(){return this.isVisit}isContain(t){return this.key.isContain(t.key)}addChild(t){this.children.push(t)}getPolygons(){let t=[];return this.getPolylineList(t),t.map(e=>{let r=e[0].polygon;if(r&&r.items.length===e.length){let i=e.map(s=>s.returnPolyline()),n=new Set(r.items);return i.some(s=>!n.has(s))?new Ko(i):r}else return new Ko(e.map(i=>i.returnPolyline()))})}getPolylineList(t,e){e?(e.push(this.key),e=null):(e=[this.key],t.push(e)),this.children.forEach(r=>r.getPolylineList(t,e))}visit(){return this.isVisit?!1:(this.isVisit=!0,!0)}};function bY(t){let e="";return t.items.forEach((r,i)=>{let n="$";if(r.items.forEach((s,a)=>{let o="[";if(s.primitives.forEach((l,c)=>{let u="";if(l instanceof Ge)u=`Line,${l.start().x},${l.start().y},${l.end().x},${l.end().y}`;else if(l instanceof gt)u=`Arc,${l.center.x},${l.center.y},${l.startAngle},${l.sweepAngle},${l.rx}`;else if(l instanceof br)u=`Bezier,${l.controls.map(d=>`${d.x},${d.y}`).join(",")}`;else throw new Error("not supported");if(c===s.primitives.length-1){o+=`${u}]`;return}o+=`${u},`}),a===r.items.length-1){n+=`${o}$`;return}n+=`${o}_`}),i===t.items.length-1){e+=`${n}`;return}e+=`${n}^`}),console.log(e),e}function xY(t){let e=t.split("^"),r=[];return e.forEach(n=>{let s=/\$(.*?)\$/,a=n.match(s)[1].split("_"),o=[];a.forEach(c=>{let u=/\[(.*?)\]/,d=c.match(u)[1].split(","),A=[],h=[];for(let p=0;p<d.length;p++){let m=d[p];if(m==="Line"||m==="Arc"||m==="Bezier"){if(A.length){let y=i(A);h.push(y),A.length=0}A.push(m);continue}A.push(Number(m))}A.length&&(h.push(i(A)),A.length=0);let f=cn.build7(h);o.push(f)});let l=new Ko(o);r.push(l)}),new ao(r);function i(n){let s=n[0];if(s==="Line")return new Ge(new We(n[1],n[2]),new We(n[3],n[4]));if(s==="Arc")return gt.build3(new We(n[1],n[2]),n[3],n[4],n[5],n[5]);if(s==="Bezier"){let a=[];for(let o=1;o<n.length;o+=2)a.push(new We(n[o],n[o+1]));return new br(a)}else throw new Error("not support")}}var kge=class{constructor(t=1){this.group1Str="$[Line,20193.777980000017,4122.200439600661,20193.77082,4211.848760073709,Arc,20193.972672902382,4211.8487570980205,179.99915535323618,-89.99540000050294,0.2018529024026465,Line,20193.972659672283,4212.050609999989,20193.972660393258,4212.039610000013,Arc,20193.97217289501,4211.848257065248,89.85403133887164,89.99540000041924,0.19135355574930143,Line,20193.78082,4211.848759926291,20193.78897999998,4122.200440479205,Line,20193.78897999998,4122.200440479205,20193.777980000017,4122.200439600661]$",this.group2Str="$[Arc,20209.72784128151,4122.2007625157785,258.46768032837986,-75.66780748375947,4.138846238512183,Line,20205.593935808283,4121.998590004101,20193.97982992629,4121.998600000001,Arc,20193.97983290198,4122.2004529023825,269.9991553532362,-89.99540000050297,0.20185290240401074,Arc,20193.782979999996,4122.20044,180.00375535340328,-180.0000000000027,0.004999999999025513,Arc,20193.979332869207,4122.200952909754,180.15347936671733,89.99540000008247,0.19135355575111057,Line,20193.97983008845,4122.009599999999,20205.603694309226,4122.003828485546,Arc,20209.733142304296,4122.194577876843,182.64475341258483,75.73379999998886,4.133851239977064,Line,20208.900400396684,4118.145470939558,20208.902599535475,4118.156248870184,Arc,20206.972515961093,4108.700057667588,78.46393309088245,-78.46759999998636,9.65115405866796,Arc,20216.618669999996,4108.69944,359.99996825446135,-180,0.004999999999200412,Arc,20206.973015966745,4108.699445349495,359.99996822365375,78.46759999998409,9.640654033253735]$^$[Line,20193.997796883676,4095.399470032799,20205.596133314026,4095.4013992171836,Arc,20209.72470159858,4095.1923799234505,177.10172964919312,-75.64935037184974,4.133855965730166,Arc,20209.73000213952,4095.198565517174,101.5415133143569,75.7293000000185,4.128850963459707,Line,20205.605834328744,4095.395161923586,20193.997203529463,4095.389485743675,Arc,20193.994588809255,4095.197684525904,89.21896662213764,4.544099999999517,0.19181903946188483,Arc,20193.981499796217,4095.1977402038,89.85034659953621,89.9999999995926,0.19135044893494071,Arc,20193.78515,4095.19824,0,-180,0.005,Arc,20193.98200016982,4095.1982398301675,179.99995179248322,-89.99999999974185,0.20185016982129908,Arc,20193.981986624152,4095.198185381971,89.9961078637802,-4.487285276547311,0.2019046184835962]$",this.rule=t}getGroup1(){return xY(this.group1Str)}getGroup2(){return xY(this.group2Str)}},u4=new ZD(2),qv=class{getUnion(t,e=!0){return e&&(t=t.map(r=>this.asSameSweep([r])[0])),xge(tge,t)}asSameSweep(t){let e=0;return t.forEach(r=>e+=r.area(.01)),e>0?t.map(r=>r.reverse()):t}getSubtraction(t,e){let r=new iC(!1),i=new nC(gD.rule,u4,r);for(let n of t){let s=gD.weight(0);i.addPolyline(n,s)}for(let n of e){let s=gD.weight(1);i.addPolyline(n,s)}return i.simplify(),r.plGrps}getIntersection(t,e){let r=new iC(!1),i=new nC(yD.rule,u4,r);for(let n of t){let s=yD.weight(0);i.addPolyline(n,s)}for(let n of e){let s=yD.weight(1);i.addPolyline(n,s)}return i.simplify(),r.plGrps}getMutuallyExclusive(t,e){let r=new iC(!1),i=new nC(bD.rule,u4,r);for(let n of t){let s=bD.weight(0);i.addPolyline(n,s)}for(let n of e){let s=bD.weight(1);i.addPolyline(n,s)}return i.simplify(),r.plGrps}},Wv=0,h4=!1;function Kv(t,e,r,i,n){let s=wC(),a=[],o=[],l=[],c=new Set,u;if(n){if(u=new xC(n),Wv++,h4){debugger;h4=!1;let E=new kge;Kv(E.rule,E.getGroup1(),E.getGroup2(),i,n)}if(Wv===-1||h4){console.table({rule:t,group1:bY(e),group2:bY(r)}),u.clear();let E=u.initColor(Xn.GREEN),w=u.initColor(Xn.WHITE),x=u.initColor(Xn.BLUE),I=u.initColor(Xn.Gray);e.items.forEach(C=>C.items.forEach((G,U)=>{U>0?w.addPly(G):E.addPly(G)})),r.items.forEach(C=>C.items.forEach((G,U)=>{U>0?I.addPly(G):x.addPly(G)})),u.draw();debugger}}let d=e.items.length!==0&&r.items.length!==0?e.bbox().extendOfSize(ui).intersection1(r.bbox().extendOfSize(ui)):null;if(d){let E=[],w=[];switch(t){case 0:{for(let x of e.items)x.bbox().isIntersect(d)&&E.push(x);for(let x of r.items)x.bbox().isIntersect(d)&&w.push(x);break}case 1:case 3:{for(let x of e.items)x.bbox().isIntersect(d)?E.push(x):a.push(x);for(let x of r.items)x.bbox().isIntersect(d)?w.push(x):a.push(x);break}case 2:{for(let x of e.items)x.bbox().isIntersect(d)?E.push(x):a.push(x);for(let x of r.items)x.bbox().isIntersect(d)&&w.push(x);break}default:throw new Error("not support")}E.length!==e.items.length&&(e=new ao(E)),w.length!==r.items.length&&(r=new ao(w))}else{switch(t){case 0:break;case 1:case 3:{e.items.forEach(E=>a.push(E)),r.items.forEach(E=>a.push(E));break}case 2:{e.items.forEach(E=>a.push(E));break}default:throw new Error("not support")}e=new ao([]),r=new ao([])}g(e,o,!0),g(r,l,!1);let A=t===2||t===3?(E,w)=>jr(E.getEnd(),w)?E.nextSide:E:(E,w)=>jr(E.prevSide.getEnd(),w)?E.prevSide:E,h=(E,w,x)=>{if(jr(E.getEnd(),x)){if(E.inters.findIndex(I=>I.getBindedInter().side===w&&jr(I.coord,E.getEnd()))===-1)return new ng(x,E,u)}else return new ng(x,E,u)},f=t===2||t===3?(E,w,x)=>{if(jr(E.getStart(),x)){if(E.inters.findIndex(I=>I.getBindedInter().side===w&&jr(I.coord,E.getStart()))===-1)return new ng(x,E,u)}else return new ng(x,E,u)}:h;i.seek(e,r,(E,w,x,I,C,G)=>{let U=o[E][w],_=l[I][C],H=U.sides[x],Q=_.sides[G],j=IA(H.getShape(),Q.getShape());if((H.getShape()instanceof br||Q.getShape()instanceof br)&&j>=4){if(H.getShape()instanceof gt||Q.getShape()instanceof gt){let B=function(v,N){let R=!1;for(let q=0;q<N.length;q+=2)jr(new We(N[q],N[q+1]),v)&&(R=!0);R||N.push(v.x,v.y)},M=[De[0],De[1]];for(let v=0;v<j;v+=2){let N=new We(De[v],De[v+1]);for(let R=v+2;R<j;R+=2){let q=new We(De[R],De[R+1]);if(!jr(N,q)){B(q,M);break}}}j=M.length,M.forEach((v,N)=>De[N]=v)}else for(let B=j-2;B>=2;B-=2)for(let M=B-2;M>=0;M-=2)if(jr(new We(De[B],De[B+1]),new We(De[M],De[M+1]))){De[M]=(De[B]+De[M])/2,De[M+1]=(De[B+1]+De[M+1])/2;for(let v=j-3;v>=B;v--)De[v]=De[v+2];j-=2;break}}let $=0;if(j===4){let B=function(N){return jr(H.getEnd(),N)||jr(H.prevSide.getEnd(),N)||jr(Q.prevSide.getEnd(),N)||jr(Q.getEnd(),N)},M=new We(De[0],De[1]),v=()=>{let N=new ng(M,H,u),R=new ng(M,Q,u);N.bind(R),N.setIsInvalid(),N.isDealed(),U.inters.push(N),_.inters.push(R)};if(De[0]===De[2]&&De[1]===De[3])if(B(M))$=2;else{v();return}}for(;$<j;$+=2){let B=new We(De[$],De[$+1]),M=H,v=Q;if(jr(M.prevSide.getEnd(),B)&&(M=M.prevSide),v=A(v,B),H!==M&&Q!==v){let R=t===2||t===3?Q.getEnd():v.getEnd();M.getEnd().distance1(B)<R.distance1(B)?(B=M.getEnd(),jr(R,B)||(v=Q)):(B=R,jr(M.getEnd(),B)||(M=H))}let N=h(M,v,B);if(N){let R=f(v,M,B);R&&(M.addInter(N),U.inters.push(N),v.addInter(R),_.inters.push(R),N.bind(R),U.intersect(_,c))}}return j},n);let p=b(),m=Nge(o,l,t);m.forEach(E=>!E.startAndEndIsSameOutsideFlag()&&E.reverse()),new Rge(p.concat(m)).getPolygons().forEach(E=>a.push(E));let y=new ao(a);if(u){if(Wv===-1){let E=u.initColor(Xn.RED),w=u.initColor(Xn.Golden);a.forEach(x=>{E.addPly(x.items[0]),x.items.slice(1).forEach(I=>w.addPly(I))}),u.draw();debugger;throw new Error}y.id=Wv}return qp.BooleanTools+=P0(s),y;function g(E,w,x){E.items.forEach(I=>{let C=[];C.push(c4.build(I.items[0],x,!0,u,I)),I.items.slice(1).forEach(G=>{C.push(c4.build(G,x,!1,u))}),w.push(C)})}function b(){let E=[];return c.forEach(x=>{t===2||t===3?x.forEach(C=>{C.isGroup1||C.reverse(),C.sides.forEach(G=>G.sortInters())}):x.forEach(C=>C.sides.forEach(G=>G.sortInters())),x.map(C=>C.sides.filter(G=>G.inters.length)).flat(2).sort((C,G)=>{let U=C.inters,_=G.inters,H=jr(U[U.length-1].coord,C.getEnd()),Q=jr(_[_.length-1].coord,G.getEnd());if(H&&Q){let j=0,$=0;for(let B=U.length-2;B>=0&&jr(U[B].coord,C.getEnd());B--)j++;for(let B=_.length-2;B>=0&&jr(_[B].coord,G.getEnd());B--)$++;return $-j}else return H?-1:1}).forEach(C=>{C.inters.forEach(G=>{if(G.dealed)return;let U=G.side,_=G.getBindedInter().side,H;jr(U.getEnd(),G.coord)&&jr(_.getEnd(),G.coord)?H=-1:jr(U.getEnd(),G.coord)?(H=1,G=G.getBindedInter()):jr(_.getEnd(),G.coord)&&(H=1);let Q=Oge(H,G,t,u);G.isDealed(),Q&&(U.outline.setAllInterIsInvalidToFalse(),_.outline.setAllInterIsInvalidToFalse())})}),I(x),t===3&&(x.forEach(C=>{C.reverse(),C.sides.forEach(G=>{G.sortInters(),G.inters.forEach(U=>{U.resetVisitStatus()})})}),I(x));function I(C){C.forEach(G=>{G.inters.forEach(U=>{if(U.isInvalid||U.getVisited())return;let _=U.findStartInter(),H=w(t)?_.run():_.getBindedInter().run(),Q=G.polyline.primitives;if(H){if(Q.length===H.primitives.length){let j=new Set(Q);if(!H.primitives.some($=>!j.has($))){E.push(G);return}}E.push(c4.build(H,!0,!0,u))}})})}}),E;function w(x){switch(x){case 0:case 2:case 3:return!0;case 1:return!1;default:throw Error("not support the rule")}}}}var aD=/\bstablilizetion\b/.test(self.location.href)||!0,Gv={intersect(t,e,r,i){try{return Kv(0,t,e,r,i)}catch(n){if(aD){let s=new qv().getIntersection(t.items.map(a=>a.items.map(o=>o)).flat(2),e.items.map(a=>a.items.map(o=>o)).flat(2));return new ao(s.map(a=>new Ko(a.items)))}throw n}},union(t,e,r,i){try{return Kv(1,t,e,r,i)}catch(n){if(aD){let s=new qv,a=t.items.map(l=>l.items.map(c=>c)).flat(2);e.items.forEach(l=>l.items.forEach(c=>a.push(c)));let o=s.getUnion(a);return new ao(o.map(l=>new Ko(l.items)))}throw n}},diff(t,e,r,i){try{return Kv(2,t,e,r,i)}catch(n){if(aD){let s=new qv().getSubtraction(t.items.map(a=>a.items.map(o=>o)).flat(2),e.items.map(a=>a.items.map(o=>o)).flat(2));return new ao(s.map(a=>new Ko(a.items)))}throw n}},xor(t,e,r,i){try{return Kv(3,t,e,r,i)}catch(n){if(aD){let s=new qv().getMutuallyExclusive(t.items.map(a=>a.items.map(o=>o)).flat(2),e.items.map(a=>a.items.map(o=>o)).flat(2));return new ao(s.map(a=>new Ko(a.items)))}throw n}}},Fge=class extends nC{constructor(t,e,r,i,n,s){super(t.rule,ZD.DUMMY,e),this.sideGroup1=[],this.sideGroup2=[],this.group1=r,this.group2=i,this.seeker=n,this.addGroup(r,t.weight(0),this.sideGroup1),this.addGroup(i,t.weight(1),this.sideGroup2),this.bus=s}addGroup(t,e,r){if(!t)debugger;t.items.forEach(i=>{let n=[];i.items.forEach(s=>{let a=this.sides.length;this.addPolyline(s,e),n.push(this.sides.slice(a))}),r.push(n)})}seekIntersection(){this.seeker.seek(this.group1,this.group2,(t,e,r,i,n,s)=>{let a=this.sideGroup1[t][e][r],o=this.sideGroup2[i][n][s],l=IA(a.shape,o.shape);for(let c=0;c<l;c+=2){let u=new We(De[c],De[c+1]);a.inters.push(u),o.inters.push(u),this.event.onIntersect(u,a,o)}return l},this.bus)}},Uge=class extends iC{constructor(t){super(!!t),t&&(this.drawDebug=new xC(t),this.blueDrawing=this.drawDebug.initColor(Xn.BLUE),this.greenDrawing=this.drawDebug.initColor(Xn.GREEN),this.redDrawing=this.drawDebug.initColor(Xn.RED))}onOriginSide(t){super.onOriginSide(t),this.debug&&this.blueDrawing.addPt(t.shape)}onPolylineGroup(t,e){super.onPolylineGroup(t,e),this.debug&&t.items.forEach(r=>this.greenDrawing.addPly(r))}draw(){this.drawDebug.draw()}};function oD(t,e,r,i,n){let s=wC(),a=new Uge(n);new Fge(t,a,e,r,i,n).simplify();let o=[];a.plGrps.forEach(c=>{let u=c.items.map(d=>FD(d));u[0]&&o.push(new Ko(u.filter(d=>d)))});let l=new ao(o);return qp.BooleanTools+=P0(s),l}var lD=!0,Yv={intersect(t,e,r,i){try{return Gv.intersect(t,e,r,i)}catch(n){if(lD)throw n;return console.error(n),oD(yD,t,e,r,i)}},union(t,e,r,i){try{return Gv.union(t,e,r,i)}catch(n){if(lD)throw n;return console.error(n),oD(rge,t,e,r,i)}},diff(t,e,r,i){try{return Gv.diff(t,e,r,i)}catch(n){if(lD)throw n;return console.error(n),oD(gD,t,e,r,i)}},xor(t,e,r,i){return Gv.xor(t,e,r,i)}};var Hge=class{init(t){}seek(t,e,r,i){let n=t.bbox().extendOfSize(5e-6).intersection1(e.bbox().extendOfSize(5e-6));if(!n)return;let s=wC(),a=[];for(let A=0,h=t.items.length;A<h;A++){let f=t.items[A];if(n.isIntersect(f.bbox()))for(let p=0,m=f.items.length;p<m;p++){let y=f.items[p];if(n.isIntersect(y.bbox()))for(let g=0,b=y.primitives.length;g<b;g++){let E=y.primitives[g].bbox();n.isIntersect(E)&&a.push({bbox:E,polygonIndex:A,polylineIndex:p,ptIndex:g})}}}let o=a.length;if(o===0){qp.IntersectionSeeker+=P0(s);return}let l=[];for(let A=0,h=e.items.length;A<h;A++){let f=e.items[A];if(n.isIntersect(f.bbox()))for(let p=0,m=f.items.length;p<m;p++){let y=f.items[p];if(n.isIntersect(y.bbox()))for(let g=0,b=y.primitives.length;g<b;g++){let E=y.primitives[g].bbox();n.isIntersect(E)&&l.push({bbox:E,polygonIndex:A,polylineIndex:p,ptIndex:g})}}}let c=l.length;if(c===0){qp.IntersectionSeeker+=P0(s);return}if(o<5||c<5){for(let A=0,h=a.length;A<h;A++)for(let f=0,p=l.length;f<p;f++)if(a[A].bbox.isIntersect(l[f].bbox.extendOfSize(1e-5))){let m=a[A],y=l[f];r(m.polygonIndex,m.polylineIndex,m.ptIndex,y.polygonIndex,y.polylineIndex,y.ptIndex)}qp.IntersectionSeeker+=P0(s);return}a.sort((A,h)=>A.bbox.minX-h.bbox.minX),l.sort((A,h)=>A.bbox.minX-h.bbox.minX);let u=0,d=0;for(;u<o&&d<c;)if(a[u].bbox.minX<l[d].bbox.minX){let A=a[u],h=A.bbox;for(let f=d;f<c;f++){let p=l[f],m=p.bbox;if(m.minX>h.maxX+1e-5)break;(h.minY<m.minY?m.minY:h.minY)<(h.maxY<m.maxY?h.maxY:m.maxY)+1e-5&&r(A.polygonIndex,A.polylineIndex,A.ptIndex,p.polygonIndex,p.polylineIndex,p.ptIndex)}u++}else{let A=l[d],h=A.bbox;for(let f=u;f<o;f++){let p=a[f],m=p.bbox;if(m.minX>h.maxX+1e-5)break;(m.minY<h.minY?h.minY:m.minY)<(m.maxY<h.maxY?m.maxY:h.maxY)+1e-5&&r(p.polygonIndex,p.polylineIndex,p.ptIndex,A.polygonIndex,A.polylineIndex,A.ptIndex)}d++}qp.IntersectionSeeker+=P0(s)}},uc,Ic=(uc=class{static getDebug(){return uc.drawDebug||(uc.drawDebug=new xC(uc.curBus)),uc.drawDebug}static getDrawing(e=Xn.GREEN){return this.getDebug().initColor(e)}static clearDrawing(){uc.getDebug().clear()}static drawText(e,r,i=Xn.GREEN){uc.getDrawing(i).addText(e,r,1.5,.1,!0)}static drawBBox(e,r=Xn.GREEN){if(!e)return;let i=uc.getDrawing(r),n=new Ge(e.UL(),e.UR()),s=new Ge(e.UR(),e.LR()),a=new Ge(e.LR(),e.LL()),o=new Ge(e.LL(),e.UL());i.addPt(n),i.addPt(s),i.addPt(a),i.addPt(o)}static drawPolyType(e,r){let i=uc.getDrawing(r);if(e instanceof cn)i.addPly(e);else if(e instanceof Ko)for(let n of e.items)n instanceof cn?i.addPly(n):this.drawPolyType(n,r);else if(e instanceof ao)for(let n of e.items)this.drawPolyType(n,r)}static translate(e){switch(e){case 0:return"\u2229";case 2:return"-";case 1:return"U";case 3:return"X";default:break}}},uc.UseRunArrange=!0,uc.UseOptimizeSplit=!0,uc.LocalBestThread=4,uc.HandleDiff=!0,uc.OcTreeSplitStep=4,uc.PrintStart=new We(150,-200),uc),Vv=class L4{static getPolyTypeLine(e){let r=[];if(e instanceof cn)for(let i of e.primitives)r.push(i);else if(e instanceof Ko)for(let i of e.items)if(i instanceof cn)for(let n of i.primitives)r.push(n);else{let n=this.getPolyTypeLine(i);for(let s of n)r.push(s)}else if(e instanceof ao)for(let i of e.items){let n=this.getPolyTypeLine(i);for(let s of n)r.push(s)}return r}static getPolyTypePolyLine(e){let r=[];if(e instanceof cn)r.push(e);else if(e instanceof Ko)for(let i of e.items)if(i instanceof cn)r.push(i);else{let n=this.getPolyTypePolyLine(i);for(let s of n)r.push(s)}else if(e instanceof ao)for(let i of e.items){let n=this.getPolyTypePolyLine(i);for(let s of n)r.push(s)}return r}static getListBBox(e){if(e.length<=0)return;let r=new vh;for(let i of e){let n=L4.getSingleBBox(i);r.ext1(n)}return r.build1()}static getSingleBBox(e){if(e instanceof Array){let r=new vh,i=L4.getListBBox(e.slice(1));return r.ext1(i),r.build1()}else return e.bbox()}static doDrawRule(e,r=Ic.PrintStart){if(e.length<2)return[r,r,r];let i=5,n=10,s=e[0],a=Ic.translate(s),o=[],l=r.y,c=r.x,u=r.x;r=r.add(new We(0,-n));for(let h=1;h<e.length;h++){let f=e[h];if(f instanceof Array){r=r.add(new We(i,0));let p=this.doDrawRule(f,r);o.push(p[0]),p[1].x<=c&&(c=p[1].x),p[2].x>=u&&(u=p[2].x),r=new We(p[2].x+i,r.y)}else o.push(r.clone()),r.x<=c&&(c=r.x),r.x>=u&&(u=r.x),Ic.drawText(r,f.name),r=r.add(new We(i,0))}let d=0;for(let h of o)d+=h.x;let A=new We(d/o.length,r.y+n);Ic.drawText(A,"N:"+a);for(let h of o){let f=new Ge(h,A),p=new Array;p.push(f);let m=cn.build1(v4(p));Ic.drawPolyType(m,Xn.GREEN)}return[A,new We(c,l),new We(u,l)]}static drawRule(e,r=Ic.PrintStart,i=!1,n){Ic.clearDrawing(),this.doDrawRule(e,r),i&&this.doDrawRulePolygon(e,n),Ic.getDebug().draw()}static doDrawRulePolygon(e,r){let i=e[0];for(let n=1;n<e.length;n++){let s=e[n];if(s instanceof Array)this.doDrawRulePolygon(s,r);else{let a=r;i===2&&n===1&&(a=Xn.RED),s.name&&Ic.drawText(s.bbox().UL(),s.name,a),Ic.drawPolyType(s,a)}}}static IsCenterBBoxPointInPolygonType(e,r){let i=e.center();for(let n of r.items)if(n.getOutMostPolyline().getWindingNum(i))return!0;return!1}static KeepBBoxPolygonGroup(e,r){let i=r.bbox().intersection1(e);if(!i)return!1;for(let n of r.items)if(n.bbox().isIntersect(i)){for(let s of n.items)if(s.bbox().isIntersect(i)){for(let a of s.primitives)if(i.isIntersect(a.bbox()))return!0}}return!!this.IsCenterBBoxPointInPolygonType(e,r)}},Gge=class i2{static createNode(e,r,i){let n=e.UL(),s=e.width()/r,a=e.height()/r,o=~~(i/r),l=i-o*r,c=n.x+l*s,u=n.y-(o+1)*a,d=c+s,A=u+a;return new nu(c,d,u,A)}static ocTreeSplitNode(e,r,i,n,s=2){if(e.length<=i)return e;let a=[],o=s**2,l=new Array(o),c=new Array(o);for(let h=0;h<o;h++)l[h]=new Array(e.length),c[h]=0;let u=r.UL(),d=r.width()/s,A=r.height()/s;for(let h of e){let f=n(h).center(),p=~~((f.x-u.x)/d),m=~~((u.y-f.y)/A)*s+p;try{l[m][c[m]]=h,c[m]+=1}catch{a.push(h)}}for(let h=0;h<l.length;h++){let f=c[h];if(f<=0)continue;let p=l[h].slice(0,f);if(p.length===e.length)return e;let m=i2.createNode(r,s,h),y=i2.ocTreeSplitNode(p,m,i,n,s);if(y.length===e.length)return e;a.push(y)}return a}static ocTreeSplitNodeMinIntersect(e,r,i,n){let s=[];if(e.length<=i)return e;let a=3,o=r.LL(),l=r.UR(),c=r.width()/(a+1),u=r.height()/(a+1),d=-(2**32),A=[],h=[];for(let f=1;f<=a;f++)for(let p=1;p<=a;p++){let m=o.x+c*f,y=o.y+u*p,g=[[],[],[],[]],b=new Array(4),E=new Array(4);E[0]=new nu(o.x,m,y,l.y),E[1]=new nu(m,l.x,y,l.y),E[2]=new nu(o.x,m,o.y,y),E[3]=new nu(m,l.x,o.y,y);for(let C of e){let G=n(C).center(),U=-1,_=-1;G.x===m?U=Math.random()>=.5?1:-1:G.x>m?U=1:G.x<m&&(U=-1),G.y===y?_=Math.random()>=.5?1:-1:G.y>y?_=1:G.y<y&&(_=-1),U===1&&_===1?g[1].push(C):U===1&&_===-1?g[3].push(C):U===-1&&_===-1?g[2].push(C):U===-1&&_===1&&g[0].push(C)}for(let C=0;C<4;C++){let G=g[C];if(G.length<=0)continue;let U=new vh;for(let _ of G)U.ext1(n(_));b[C]=U.build1()}let w=0,x=0;for(let C of b)C&&(w+=C.area());x=w;let I=(C,G)=>{if(!b[C]||!b[G])return 0;let U=b[C].intersection1(b[G]);return U?U.area():0};x-=I(0,1),x-=I(0,2),x-=I(0,3),x-=I(1,2),x-=I(1,3),x-=I(2,3),x/w>=d&&(A=g,h=E)}for(let f=0;f<A.length;f++){let p=A[f];if(p.length<=0)continue;let m=h[f],y;if(p.length===e.length?y=i2.ocTreeSplitNode(p,m,i,n):y=i2.ocTreeSplitNodeMinIntersect(p,m,i,n),y.length===e.length)return e;s.push(y)}return s}static ocTreeSplit(e,r,i,n){return i2.ocTreeSplitNode(e,r,i,n,Ic.OcTreeSplitStep)}},Yge=class xV{static simplifyRules(e,r){return Ic.UseOptimizeSplit&&(e=this.optimizeSplit(e,r)),e}static OcTreeOptimizeSplit(e){let r=e[0];if(r!==1||e.length<=Ic.LocalBestThread+1)return e;let i=e.slice(1),n=new Array(i.length);for(let c=1;c<e.length;c++)n[c-1]=c;let s=Vv.getListBBox(i),a=Gge.ocTreeSplit(n,s,Ic.LocalBestThread,c=>{let u=e[c];return Vv.getSingleBBox(u)}),o=(c,u)=>{if(!(c.length<=0))for(let d of c)if(Array.isArray(d)){let A=[u[0]];o(d,A),u.push(A)}else{let A=e[d];u.push(A)}},l=[r];return o(a,l),l}static optimizeSplit(e,r){let i=e[0];if(i===2){if(Ic.HandleDiff){let s=e[1],a;if(Array.isArray(s)){let o=this.optimizeSplit(s,r);if(o.length<=1)return[2];a=O4(o,r)}else a=O4([2,s],r);if(e.length>3){let o;o=[1];for(let l=2;l<e.length;l++){let c=e[l];if(Array.isArray(c)){let u=Vv.getListBBox([...c.slice(1)]);Vv.KeepBBoxPolygonGroup(u,a)&&o.push(c)}else Vv.KeepBBoxPolygonGroup(c.bbox(),a)&&o.push(c)}return o.length<=1?[2,a]:(o=this.optimizeSplit(o,r),o.length>1?[2,a,...o.slice(1)]:[2,a])}else{let o=e[2];if(Array.isArray(o)&&o[0]===1&&o.length>2){let l=o.slice(1);return this.optimizeSplit([2,a,...l],r)}}}else if(e.slice(1).length>2){let s=e[1],a=e.slice(2),o=this.optimizeSplit([1,...a],r);return o.length>1?[2,s,...o.slice(1)]:s}}else if(i===1){if(e.length-1>Ic.LocalBestThread){let s=!1;for(let a=1;a<e.length;a++){let o=e[a];if(!Array.isArray(o)){s=!0;break}}s&&(e=xV.OcTreeOptimizeSplit(e))}}else if(i===0&&e.length<=2)return[0];let n=[i];for(let s=1;s<e.length;s++){let a=e[s];if(Array.isArray(a)){let o=this.optimizeSplit(a,r);if(o.length<=1)continue;n.push(o)}else n.push(a)}return n}},Vge=(t=>(t[t.INTERSECT=0]="INTERSECT",t[t.UNION=1]="UNION",t[t.DIFF=2]="DIFF",t[t.XOR=3]="XOR",t))(Vge||{});function Jv(t){let e=t[0],r=[e];switch(e){case 0:for(let n=1;n<t.length;n++){let s=t[n];if(Array.isArray(s)&&(s=Jv(s),!s))return null;r.push(s)}break;case 1:case 3:for(let n=1;n<t.length;n++){let s=t[n];Array.isArray(s)&&(s=Jv(s),!s)||r.push(s)}break;case 2:let i=t[1];if(Array.isArray(i)&&(i=Jv(i)),!i)return null;r.push(i);for(let n=2;n<t.length;n++){let s=t[n];Array.isArray(s)&&(s=Jv(s),!s)||r.push(s)}break;default:throw new Error("not support boolean rule!")}return r.length===1?null:r}function d4(t,e,r){return Array.isArray(t)?EV(t,e,r):t}function A4(t,e,r,i,n=!0){if(n)for(;t.length>1;){let s,a=[];for(t.length%2===1?(a.push(t[0]),s=1):s=0;s<t.length;s+=2)a.push(e(t[s],t[s+1],r,i));t=a}else for(;t.length>1;){if(t.length===2)return e(t[0],t[1],r,i);t=[e(t[0],t[1],r,i),...t.slice(2)]}return t[0]}function EV(t,e,r,i=!0){let n=new Array(t.length-1);for(let s=1;s<t.length;s++)n[s-1]=d4(t[s],e,r);switch(t[0]){case 0:return A4(n,Yv.intersect,e,r);case 1:return A4(n,Yv.union,e,r);case 2:let s=A4(n.slice(1),Yv.union,e,r);return s?Yv.diff(n[0],s,e,r):n[0];case 3:let a=d4(t[1],e,r);for(let o=2;o<t.length;o++)a=Yv.xor(a,d4(t[o],e,r),e,r);return a;default:throw new Error("not support boolean rule! "+t[0])}}function wV(t){let e=[t[0]];for(let r=1;r<t.length;r++){let i=t[r];if(Array.isArray(i)){let n=wV(i);Array.isArray(n)?n.length>1&&e.push(n):e.push(n)}else{let n=FD(i);n!==null&&e.push(ao.build(n))}}return e}function jge(t,e){Ic.curBus=e,t=wV(t);let r;return Ic.UseRunArrange?r=Yge.simplifyRules(t,e):r=Jv(t),r.length<=1?new ao([]):O4(r,e)}function O4(t,e,r=!0){if(!t||t.length===1)return new ao([]);let i=t,n=new Hge,s=[];function a(o){for(let l=1;l<o.length;l++){let c=o[l];Array.isArray(c)?a(c):s.push(c)}}return a(i),n.init(s),EV(i,n,e,r)}var cD=new Error("list is empty"),uD=class{constructor(t,e){this.prev=null,this.next=null,this.parent=t,this.item=e}insertAfter(t){t.next=this.next,this.next=t,t.prev=this,t.next!==null&&(t.next.prev=t)}insertBefore(t){t.prev=this.prev,this.prev=t,t.next=this,t.prev!==null&&(t.prev.next=t)}remove(){this.prev!==null&&(this.prev.next=this.next),this.next!==null&&(this.next.prev=this.prev)}set(t){this.item=t}},Qge=class{constructor(t){this._next=t}hasNext(){return this._next!==null}next(){let t=this._next;if(t!==null)return this._next=t.next,t.item;throw new Error("iterator is null")}},zge=class{constructor(t){this._next=t}hasNext(){return this._next!==null}next(){let t=this._next;if(t!==null)return this._next=t.next,t;throw new Error("iterator is null")}},Xge=class{constructor(){this.first=null,this.last=null,this.cnt=0}add(t){return this.addLast(t)}push(t){return this.addLast(t)}pop(){return this.removeLast()}shift(){return this.removeFirst()}removeFirst(){let t=this.first;if(t===null)throw cD;return this.remove(t),t.item}removeLast(){let t=this.last;if(t===null)throw cD;return this.remove(t),t.item}addLast(t){if(this.first===null||this.last===null){let e=new uD(this,t);return this.first=e,this.last=e,this.cnt++,e}else return this.insertAfter(this.last,t)}addFirst(t){if(this.first===null||this.last===null){let e=new uD(this,t);return this.first=e,this.last=e,this.cnt++,e}else return this.insertBefore(this.first,t)}getFirst(){if(this.first===null)throw cD;return this.first.item}getLast(){if(this.last===null)throw cD;return this.last.item}insertAfter(t,e){let r=new uD(this,e);return t.insertAfter(r),t===this.last&&(this.last=r),this.cnt++,r}insertBefore(t,e){let r=new uD(this,e);return t.insertBefore(r),t===this.first&&(this.first=r),this.cnt++,r}remove(t){t.remove(),t===this.first&&(this.first=t.next),t===this.last&&(this.last=t.prev),this.cnt--}size(){return this.cnt}clear(){this.first=null,this.last=null,this.cnt=0}iterator(){return new Qge(this.first)}listIterator(){return new zge(this.first)}toArray(){let t=new Array,e=this.first;for(;e!=null;)t.push(e.item),e=e.next;return t}},ED=class{constructor(t){this.inters=[],t&&(this.inters=t)}addInter(t){this.inters.push(t),t.group=this}findInter(t){let e=this.inters.find(r=>jr(r.coord,t.coord));return e&&this.inters.find(r=>r.side===t.side)&&t.visitSelf(),e}getOutInter(t){let e=this.inters.filter(r=>!r.getVisited());if(e.length!==0)return e.length===1?e[0]:e.reduce((r,i)=>{if(!r||r.side.getShape()===t)return i;if(i.side.getShape()===t)return r;let n=r.coord,s=ci(t,n),a=ci(r.side.getShape(),n),o=ci(i.side.getShape(),n);return s.dot(a)>s.dot(o)?r:i},void 0)}getEntryInter(){}},f4=0;function vV(t,e){let r=t.primitives[0];if(t.primitives.length===1&&r instanceof gt&&Math.abs(r.sweepAngle)===360)return[t];let i=wC();f4++;let n,s=r0e(t);if(s.length===0)return[];let a=Kge(s);if(f4===-1){n=new xC(e);let u=n.initColor(Xn.BLUE);s.forEach(A=>u.addPt(A.getShape()));let d=n.initColor(Xn.GREEN);a.forEach(A=>d.addPoint(A.coord)),n.draw();debugger;throw new Error}if(a.length===0)return[cn.build7(s.map(u=>u.getShape()))];Jge(a);let o=[],l=!1;try{e0e(a,n)}catch(u){u.customType==="IS_OVERLAP"?(l=!0,o=new qv().getUnion([t]).map(d=>d.items).flat(2)):console.error(u)}if(l)return o;let c=Zge(a);if(!c.length)return[cn.build7(s.map(u=>u.getShape()))];if(o=qge(c,n),o.length===0)return console.warn("=====deSelfIntersection=====",f4),[];if(n)throw o.forEach(u=>{n.initColor(Xn.WHITE).addPly(u),n.draw();debugger}),new Error;return qp.deSelfIntersection+=P0(i),o}function qge(t,e){let r=[];return t.forEach(i=>{let n=i;i.inters.forEach(s=>{if(s.getVisited())return;let a=[],o=[],l;if(e){debugger;let u=e.initColor(Xn.RED);l=d=>{a.push(d),u.addPt(a[a.length-1]),e.draw();debugger}}else l=u=>a.push(u);do{let u=function(p,m){vt.eq(p.distance2(m),0)||l(CV(h.getShape(),p,m))},d=o.findIndex(p=>p===s.group);if(d!==-1){let p=a.findIndex(g=>g===s.group),m=a.splice(p).filter(g=>!(g instanceof ED));if(m.length){let g=k0(cn.build7(m));g&&r.push(g)}let y=a.filter(g=>!(g instanceof ED));if(s=o[d].getOutInter(y[y.length-1]),o.splice(d),!s)throw Error("interGroup not hav inter!!!2");continue}s.visitSelf(),o.push(s.group),a.push(s.group);let A=s.getIndex(),h=s.side,f=h.inters[A+1];for(;f!=null&&f.isInvalid||f&&f.group===s.group;)f=h.inters[f.getIndex()+1];if(f){u(s.coord,f.coord);let p=f.getBindedInter();if(s=p.getVisited()?p.group.getOutInter(p.side.getShape()):p,!s){if(f.group===n)break;throw new Error("interGroup not hav inter!!!3")}}else{for(u(s.coord,h.getEnd()),h=h.nextSide,s=null;;){for(let p of h.inters)if(!p.isInvalid){let m=p.group.getOutInter(h.getShape());if(!m){if(p.group===n){s=p;break}else if(p.getBindedInter().group===n){s=p.getBindedInter();break}continue}s=m;break}if(s)break;l(h.getShape()),h=h.nextSide}vt.eq(h.getEnd().distance2(s.coord),0)?l(h.getShape()):u(h.getStart(),s.coord)}}while(s.group!==n);let c=k0(cn.build7(a.filter(u=>!(u instanceof ED))));c&&r.push(c)})}),r}function Wge(t){return{next(){return t.hasNext()?{value:t.next()}:{done:!0,value:void 0}},[Symbol.iterator](){return this}}}function Kge(t){let e=[],r=new Xge;for(let i of t.slice().sort((n,s)=>n.bbox().minY-s.bbox().minY)){for(let n of Wge(r.listIterator())){let s=n.item;if(s.bbox().maxY<i.bbox().minY)r.remove(n);else{let a=function(A,h){let f=new ng(h,A,null);return A.inters.push(f),e.push(f),f},o=function(A,h){let f=A.getEnd(),p=new We(De[0],De[1]),m=new We(De[2],De[3]),y=f.distance2(p)>f.distance2(m)?p:m,g=A.prevSide;a(jr(g.getEnd(),y)?g:A,y).bind(a(h,y))},l=s.getShape(),c=i.getShape(),u=IA(l,c),d=u===4&&De[0]===De[2]&&De[1]===De[3];if(d&&(u-=2),s.nextSide===i)s.prevSide!==i&&u===4&&o(s,i);else if(s.prevSide===i)u===4&&o(i,s);else if(u!==0){let A=function(f,p){let m=f.prevSide;return a(jr(m.getEnd(),p)?m:f,p)},h=new We(De[0],De[1]);if(d&&!jr(h,s.prevSide.getEnd())&&!jr(h,i.prevSide.getEnd())&&ci(l,h).dot(ci(c,h))>0)continue;for(let f=0;f<u;f+=2){let p=new We(De[f],De[f+1]);A(s,p).bind(A(i,p))}}}}r.add(i)}return e.forEach(i=>{i.getIndex()===void 0&&i.side.sortInters()}),e}function Jge(t){t.forEach(e=>{let r=e.side.getEnd();if(e.isInvalid||!jr(e.coord,r))return;let i=e.side.inters,n=e.getBindedInter().side;for(let s=i.length-1;s>=0;s--){let a=i[s];if(!jr(a.coord,r))break;a!==e&&a.getBindedInter().side===n&&a.setIsInvalid()}})}function $ge(t){let e=new oC(10);return t.forEach(r=>{r.isInvalid||e.add(r)}),e}function Zge(t){let e=[],r=$ge(t);return t.forEach(i=>{if(i.isInvalid||i.group)return;let n=r.search(i.bbox().extendOfSize(vt.eps)).filter(s=>!s.group);if(n.length){let s=new Set,a=new ED(n);n.forEach(o=>{o.group=a,s.has(o.side)&&o.visitSelf(),s.add(o.side)}),e.push(a)}}),e}function e0e(t,e){t.forEach(r=>{if(r.isInvalid||r.dealed)return;let i=r.side,n=r.getBindedInter().side,s;jr(i.getEnd(),r.coord)&&jr(n.getEnd(),r.coord)?s=-1:jr(i.getEnd(),r.coord)?i.nextSide!==n&&(s=1,r=r.getBindedInter()):jr(n.getEnd(),r.coord)&&n.nextSide!==i&&(s=1),t0e(s,r,e),r.isDealed()})}function t0e(t,e,r){let i=e.getBindedInter(),n=e.side,s=i.side,a=n.getShape(),o=s.getShape(),l=1,c=!1;if(t===-1){if(Kx(a.reverse(),o.reverse())||Kx(n.nextSide.getShape(),s.nextSide.getShape())){let d=rg(n,n.nextSide,s,i,l,c,r);if(d.state===2){let h=new Error("info1.state === InState.IS_OVERLAP");throw h.customType="IS_OVERLAP",h}let A=rg(n,n.nextSide,s.nextSide,i,l,c,r);d.state===A.state&&u(d,A)}else if(!(Kx(a.reverse(),s.nextSide.getShape())||Kx(n.nextSide.getShape(),o.reverse()))){let d=o4(n,n.nextSide,s,!1,r);d===o4(n,n.nextSide,s.nextSide,!0,r)&&d!==o4(s,s.nextSide,n.nextSide,!0,r)&&e.setIsInvalid()}}else if(t===1){let d=function(A,h){return ci(A,h.start()).dot(ci(h,h.start()))>0};if(Kx(a.reverse(),o.reverse())||Kx(a,s.nextSide.getShape())){let A=Hd(n,s,i,r,l,c,new Map);if(A.state===2){let f=new Error("info1.state === InState.IS_OVERLAP");throw f.customType="IS_OVERLAP",f}let h=Hd(n,s.nextSide,i,r,l,c,new Map);A.state===h.state&&u(A,h)}else if(d(a.reverse(),o.reverse())&&d(a,s.nextSide.getShape())){let A=Gl(n,s,!1,r);A===Gl(n,s.nextSide,!0,r)&&A!==O1(s,s.nextSide,new EC(CV(a,e.coord,a.end()),r),!0,r)&&e.setIsInvalid()}}function u(d,A){d.inter.setIsInvalid(),A.inter.setIsInvalid(),e.setIsInvalid()}}function CV(t,e,r){if(t instanceof Ge||e.distance2(r)<1e-6)return new Ge(e,r);if(t instanceof gt)return gt.build2(t.center,e.angleD(t.center),r.angleD(t.center),t.rx,t.ry,t.sweep());if(t instanceof br){let i=t.getPercent(e,ui),n=t.getPercent(r,ui);return t.clip(i)[1].clip((n-i)/(1-i))[0]}else throw new Error("not supported operation")}function r0e(t){let e=k0(t);if(!e)return[];let r=e.primitives.map(n=>new EC(n,null)),i=r[r.length-1];return r.forEach(n=>{i.connect(n),i=n}),r}var og,i0e=(og=class{static clearData(e){this.originalPrimitive=[],this.offsetPrimitive=[],this.rawOffsetPrimitive=[],this.offsetDistance=0,this.testI++,this.testI===0?this.drawDebug=new xC(e):delete this.drawDebug}static createRawOffsetEdge(){if(this.drawDebug){let e=this.drawDebug.initColor(Xn.WHITE);this.originalPrimitive.forEach(r=>e.addPt(r)),this.drawDebug.draw();debugger}for(let e=0;e<this.originalPrimitive.length;e+=1){let r=this.originalPrimitive[e];this.offsetPrimitive.push({index:e,offsetEdge:this.createOffsetEdge(r)})}if(this.drawDebug){let e=this.drawDebug.initColor(Xn.Golden);this.offsetPrimitive.forEach(r=>e.addPt(r.offsetEdge)),this.drawDebug.draw();debugger}if(this.offsetPrimitive.length>1)for(let e=0;e<this.offsetPrimitive.length;e+=1)if(e===this.offsetPrimitive.length-1){this.connectPrimitive(this.offsetPrimitive[e],this.offsetPrimitive[0]);let r=this.rawOffsetPrimitive[0],i;r instanceof gt?i=gt.build4(this.offsetPrimitive[0].offsetEdge.start(),r.end(),r.center,r.rx,r.ry,r.sweep()):i=new Ge(this.offsetPrimitive[0].offsetEdge.start(),r.end()),this.rawOffsetPrimitive.shift(),this.rawOffsetPrimitive.unshift(i)}else this.connectPrimitive(this.offsetPrimitive[e],this.offsetPrimitive[e+1]);else this.rawOffsetPrimitive=[]}static createCirclePrimitive(e,r){let i=e.width()*.5,n=e.height()*.5,s=Math.sqrt(i**2+n**2)+r;return[gt.buildCircle(e.center(),s)]}static getExtendPolyLine(e,r,i=!0,n){var o,l;if(!((o=e==null?void 0:e.primitives)!=null&&o.length))return[];let s=k0(e);if(!((l=s==null?void 0:s.primitives)!=null&&l.length)){if(this.isExpansion){let c=[1],u=r*2;e.primitives.forEach(A=>c.push(A.stroke(u,1,0)));let d=jge(c,n);if(d.items.length!==1)throw new Error("group.items.length !== 1 ");return[d.items[0].items[0]]}return[]}if(e=s,this.clearData(n),this.originalPrimitive=e.primitives,this.isExpansion=r>0,this.offsetDistance=r,this.createRawOffsetEdge(),this.drawDebug){let c=this.drawDebug.initColor(Xn.BLUE);this.rawOffsetPrimitive.forEach(u=>c.addPt(u)),this.drawDebug.draw();debugger}let a=i?this.createClippingEdge(n):[cn.build2(this.rawOffsetPrimitive)];if(this.drawDebug){let c=this.drawDebug.initColor(Xn.RED);a.forEach(u=>c.addPly(u)),this.drawDebug.draw();debugger}if(a.length&&(!this.isExpansion||this.isExpansion&&a.length>1)&&(a=this.getValidityPrimitive(a)),this.drawDebug){let c=this.drawDebug.initColor(Xn.GREEN);a.forEach(u=>c.addPly(u)),this.drawDebug.draw();debugger;throw new Error}return a}static getValidityPrimitive(e){let r=[],i=Math.abs(this.offsetDistance);for(let n=0;n<e.length;n+=1){let s=!0,a=e[n].primitives;e:for(let o=0;o<a.length;o+=1){let l=a[o],c;if(l instanceof gt)c=l.midPoint;else if(l instanceof Ge)c=l.start();else throw new Error("not support!");for(let u=0;u<this.originalPrimitive.length;u+=1){let d=this.originalPrimitive[u],A;if(d instanceof gt?A=this.pointArcClosest(c,d):A=Fme(c,d.start(),d.end()).d,i-A>.01){s=!1;break e}}}s&&r.push(e[n])}return r}static getInters(e){let r=[];for(let i=0;i<e;i+=2)r.push(new We(De[i],De[i+1]));return r}static pointArcClosest(e,r){let i=r.center;if(e.equals1(r.center))return r.rx;if(r.inArea(e,0)){let a=e.sub(i);return Math.abs(a.length()-r.rx)}let n=e.distance2(r.start()),s=e.distance2(r.end());return vt.less(n,s)?Math.sqrt(n):Math.sqrt(s)}static createClippingEdge(e){let r=[],i=[],n=vV(cn.build2(this.rawOffsetPrimitive),e);n.forEach(a=>{let o=a.area(.01);r.push(o)});let s=Math.min(...r.filter(a=>a<0));for(let a=0;a<r.length;a+=1){let o=r[a];vt.eq(o,0)||(!this.isExpansion&&o<0||this.isExpansion&&(o<0&&r[a]===s||o>0))&&i.push(n[a])}return i}static createOffsetEdge(e){if(e instanceof gt)return e.panDistance1(this.offsetDistance);if(e instanceof Ge)return e.panDistance(this.offsetDistance);throw new Error("not support!")}static connectPrimitive(e,r){e.offsetEdge instanceof Ge&&r.offsetEdge instanceof Ge?this.lineToLineConnect(e,r):e.offsetEdge instanceof gt&&r.offsetEdge instanceof gt?this.arcToArcConnect(e,r):e.offsetEdge instanceof Ge&&r.offsetEdge instanceof gt?this.lineToArcConnect(e,r):this.arcToLineConnect(e,r)}static isFalseIntersection(e){return e>1||e<0}static lineToLineConnect(e,r){let i=e.offsetEdge,n=r.offsetEdge,s=r.index,a=this.originalPrimitive[s].start();if(i.isParallel(n))i.bbox().intersection1(n.bbox())?this.rawOffsetPrimitive.push(i):this.lineToLineUseArcToConnect(a,i,n);else{let o=this.getLineToLineT(i,n),l=o[0],c=o[1];if(this.isFalseIntersection(l)||this.isFalseIntersection(c))l>1&&this.isFalseIntersection(c)?this.lineToLineUseArcToConnect(a,i,n):this.useLineToConnect(i,n);else if(!this.isFalseIntersection(l)&&!this.isFalseIntersection(c)){let u=i.end().sub(i.start()),d=i.start().add(u.mul(l)),A=new Ge(i.start(),d);this.rawOffsetPrimitive.push(A);let h=new Ge(d,n.end());this.updateNextOffsetPrimitive(s,h)}}}static updateNextOffsetPrimitive(e,r){this.offsetPrimitive[e].offsetEdge=r}static useLineToConnect(e,r){this.rawOffsetPrimitive.push(e);let i=new Ge(e.end(),r.start());this.rawOffsetPrimitive.push(i)}static lineToLineUseArcToConnect(e,r,i){let n=this.getSweep(e,r),s=this.getSweepAngel(r.end(),i.start(),e,n);if(s===0){this.useLineToConnect(r,i);return}this.rawOffsetPrimitive.push(r);let a=gt.build5(r.end(),i.start(),s);this.rawOffsetPrimitive.push(a)}static getSweep(e,r,i){let n=null,s=i||i===0?this.originalPrimitive[i]:r;if(s instanceof gt){let a=s.center.sub(s.end()).normalize();s.isCCW?n=new We(a.y,-a.x):n=new We(-a.y,a.x)}else n=r.end().sub(r.start()).normalize();return e.sub(r.end()).normalize().cross(n)>0?0:1}static getLineToLineT(e,r){let i=e.end().sub(e.start()),n=r.end().sub(r.start()),s=i.cross(n),a=r.start().sub(e.start()),o=e.start().sub(r.start()),l=a.cross(n)/s,c=o.cross(i)/-s;return[l,c]}static lineToArcConnect(e,r){let i=e.offsetEdge,n=r.offsetEdge,s=e.index,a=r.index,o=this.getLineJoinArcScalarAndIntersectionNum(i,n),l=this.originalPrimitive[a].start();if(o.intersectionNum===0)this.lineAndArcUseArcConnect(l,i,n,s);else if(o.intersectionNum===1){let c=o.points[0];this.lineAndArcConnectionDetail(i,n,o.t[0],c,l,s,a)}else if(o.intersectionNum===2){let c=o.points[0],u=o.points[1],d=c.distance2(l),A=u.distance2(l);this.lineAndArcConnectionDetail(i,n,d<A?o.t[0]:o.t[1],d<A?c:u,l,s,a)}}static lineAndArcConnectionDetail(e,r,i,n,s,a,o){let l=this.isTrueArcIntersection(r,n);if(!this.isFalseIntersection(i)&&l){let c=new Ge(e.start(),n);this.rawOffsetPrimitive.push(c);let u;!r.center.equals1(n)||r.sweepAngle>1e-4?(u=gt.build4(n,r.end(),r.center,r.rx,r.ry,r.sweep()),u instanceof gt&&u.sweepAngle===0&&(u=new Ge(u.start(),u.end()))):u=new Ge(r.center,n),this.updateNextOffsetPrimitive(o,u)}else l?this.useLineToConnect(e,r):this.lineAndArcUseArcConnect(s,e,r,a)}static lineAndArcUseArcConnect(e,r,i,n){let s=this.getSweep(e,r,n),a=this.getSweepAngel(r.end(),i.start(),e,s);if(a===0){this.useLineToConnect(r,i);return}let o=gt.build5(r.end(),i.start(),a);this.rawOffsetPrimitive.push(r),this.rawOffsetPrimitive.push(o)}static arcToLineConnectionDetail(e,r,i,n,s,a,o){let l=this.isTrueArcIntersection(e,n);if(!this.isFalseIntersection(i)&&l){let c;e.center.equals1(n)?c=new Ge(e.center,n):Math.abs(e.sweepAngle)<1e-4?c=new Ge(e.start(),n):(c=gt.build4(e.start(),n,e.center,e.rx,e.ry,e.sweep()),c instanceof gt&&c.sweepAngle===0&&(c=new Ge(c.start(),c.end()))),this.rawOffsetPrimitive.push(c);let u=new Ge(n,r.end());this.updateNextOffsetPrimitive(o,u)}else l?this.useLineToConnect(e,r):this.lineAndArcUseArcConnect(s,e,r,a)}static isTrueArcIntersection(e,r){return wo(e,r)}static getSweepAngel(e,r,i,n){let s=e.angleD(i),a=r.angleD(i),o;return s===a?o=0:(s=Ii.regularD(s),a=Ii.regularD(a),n===1?a<=s&&(a+=360):a>=s&&(s+=360),o=a-s),o}static getLineJoinArcScalarAndIntersectionNum(e,r){let i={t:[],intersectionNum:0,points:[]},n=Rme(r,e);if(n){i.intersectionNum=n/2;for(let s=0;s<n-1;s+=2){let a=new We(De[s],De[s+1]);i.points.push(a),a.sub(e.start()).x<1e-4||a.sub(e.start()).y<1e-4?i.t.push(0):i.t.push(a.sub(e.start()).x/e.end().sub(e.start()).x)}}else i.intersectionNum=0;return i}static arcToLineConnect(e,r){let i=e.offsetEdge,n=r.offsetEdge,s=e.index,a=r.index,o=this.getLineJoinArcScalarAndIntersectionNum(n,i),l=this.originalPrimitive[a].start();if(o.intersectionNum===0)this.lineAndArcUseArcConnect(l,i,n,s);else if(o.intersectionNum===1){let c=o.points[0];this.arcToLineConnectionDetail(i,n,o.t[0],c,l,s,a)}else if(o.intersectionNum===2){let c=o.points[0],u=o.points[1],d=c.distance2(l),A=u.distance2(l);this.arcToLineConnectionDetail(i,n,d<A?o.t[0]:o.t[1],d<A?c:u,l,s,a)}}static rxChangeStatus(e){return e===1?!this.isExpansion:this.isExpansion}static arcToArcConnect(e,r){let i=e.offsetEdge,n=r.offsetEdge,s=iV(i,n);if(s){let a=this.getInters(s),o;if(a.length===2){let u=this.originalPrimitive[r.index].start(),d=a[0],A=a[1],h=d.distance2(u),f=A.distance2(u);h<f?o=d:o=A}else o=a[0];let l,c;o.equals1(i.center)?l=new Ge(i.center,o):Math.abs(i.sweepAngle)<1e-4?l=new Ge(i.start(),o):(l=gt.build4(i.start(),o,i.center,i.rx,i.ry,i.sweep()),l instanceof gt&&l.sweepAngle===0&&(l=new Ge(l.start(),l.end()))),this.rawOffsetPrimitive.push(l),o.equals1(n.center)?c=new Ge(o,n.center):Math.abs(n.sweepAngle)<1e-4?c=new Ge(o,n.end()):(c=gt.build4(o,n.end(),n.center,n.rx,n.ry,n.sweep()),c instanceof gt&&c.sweepAngle===0&&(c=new Ge(c.start(),c.end()))),this.updateNextOffsetPrimitive(r.index,c)}else{let a=this.originalPrimitive[e.index],o=this.originalPrimitive[r.index],l=this.rxChangeStatus(a.sweep()),c=this.rxChangeStatus(o.sweep()),u=this.originalPrimitive[r.index].start(),d=this.getSweep(u,i,e.index),A=Math.abs(this.offsetDistance),h=gt.build2(u,l?a.endAngle():a.endAngle()+180,c?o.startAngle:o.startAngle+180,A,A,d);this.rawOffsetPrimitive.push(i),this.rawOffsetPrimitive.push(h)}}},og.originalPrimitive=[],og.offsetPrimitive=[],og.rawOffsetPrimitive=[],og.testI=0,og),n0e=class $v extends yC{constructor(e,r,i,n,s,a){if(super(),r<0||i<0)throw new Error("The width and height of rect can't be less than 0!");this.leftUpPoint=e,this.width=r,this.height=i,this.angle=n,this.isCCW=s,this.radius=Math.min(Math.max(a,0),r/2,i/2)}get radiusRatio(){return this.radius/Math.min(this.width,this.height)}start(){return this.leftUpPoint.add(new We(this.radius,0).multiply3(as.rotateD(this.angle)))}end(){return this.start()}getLeftPoint(){return this.leftUpPoint.add(new We(0,-this.height/2).multiply3(as.rotateD(this.angle)))}getRightPoint(){return this.leftUpPoint.add(new We(this.width,-this.height/2).multiply3(as.rotateD(this.angle)))}extend(e){return new $v(this.leftUpPoint.add(new We(-e,e).rotateD(We.ORIGIN,this.angle)),this.width+e*2,this.height+e*2,this.angle,this.isCCW,this.radius+e)}bbox(){let e=as.rotateD(this.angle),{leftUpPoint:r,width:i,height:n,radius:s}=this,a=r.add(new We(s,-s).multiply3(e)),o=r.add(new We(s,s-n).multiply3(e)),l=r.add(new We(i-s,-s).multiply3(e)),c=r.add(new We(i-s,s-n).multiply3(e));return new nu(Math.min(a.x,o.x,l.x,c.x)-s,Math.max(a.x,o.x,l.x,c.x)+s,Math.min(a.y,o.y,l.y,c.y)-s,Math.max(a.y,o.y,l.y,c.y)+s)}toPolyline(){let e=[],{leftUpPoint:r,width:i,height:n,radius:s}=this;if(s===0){let o=We.ORIGIN,l=new We(i,0),c=new We(i,-n),u=new We(0,-n);e.push(new Ge(o,l),new Ge(l,c),new Ge(c,u),new Ge(u,o))}else{let o=new We(0,-s),l=new We(s,0),c=new We(i-s,0),u=new We(i,-s),d=new We(i,s-n),A=new We(i-s,-n),h=new We(s,-n),f=new We(0,s-n);e.push(gt.build1(o,l,s,s,!1,0),new Ge(l,c),gt.build1(c,u,s,s,!1,0),new Ge(u,d),gt.build1(d,A,s,s,!1,0),new Ge(A,h),gt.build1(h,f,s,s,!1,0),new Ge(f,o))}e=e.filter(o=>!o.start().equals1(o.end())),this.isCCW&&(e.forEach((o,l)=>e[l]=o.reverse()),e.reverse());let a=as.rotateD(this.angle).translate1(r);return cn.build2(e.map(o=>o.multiply3(a)))}center(){return this.leftUpPoint.add1(this.width/2,this.height/2).rotateD(this.leftUpPoint,this.angle)}multiply3(e){let r=this.leftUpPoint.multiply3(e),i=new We(this.width,0).multiply3(as.rotateD(this.angle)).multiply3(e),n=new We(0,-this.height).multiply3(as.rotateD(this.angle)).multiply3(e);return e.isMirrored()?new $v(r,n.length(),i.length(),n.angleD(We.ORIGIN),this.isCCW===1?0:1,this.radius*i.length()/this.width):new $v(r,i.length(),n.length(),i.angleD(We.ORIGIN),this.isCCW,this.radius*i.length()/this.width)}reverse(){return new $v(this.leftUpPoint,this.width,this.height,this.angle,this.isCCW===1?0:1,this.radius)}stroke(e,r,i){let n=this.stroke1(e,r,i);if(n.length===1)return n[0];{let[s,a]=n;return cn.build2(s.primitives.concat(new Ge(s.primitives[0].start(),a.primitives[0].start()),a.primitives,new Ge(a.primitives[0].start(),s.primitives[0].start())))}}stroke1(e,r,i){let n=i===this.isCCW?this:this.reverse(),s=e/2,a=Math.min(n.width,n.height)/2,o=n.extend(s).toPolyline();return a<=s?[o]:[o,n.extend(-s).toPolyline().reverse()]}points(e){let r=this.toPolyline(),i=[];return r.points(e,n=>i.push(n)),i}toBezier(){throw new Error("Method not implemented.")}},s0e=.01,Ko=class Nf{static simplify(e){return e=k0(e),e?new Nf([e]):null}static buildByStroke(e,r,i=1,n=tM,s){if(e instanceof gt&&(e.rx<r/2+s0e||Math.abs(e.sweepAngle)>180&&vt.lesseq(e.start().distance1(e.end()),r))){let o=vV(e.stroke(r,i,0),s);if(o.length===0)return null;if(o.length===1)return new Nf(o);let l=[null],c=Number.POSITIVE_INFINITY;return o.forEach(u=>{let d=u.area(.1);d<0?d<c&&(l[0]=u,c=d):l.push(u)}),new Nf(l)}else if(e instanceof n0e){let o=e.stroke1(r,i,0).map(l=>k0(l));return o[0]?o[1]?new Nf(o):new Nf([o[0]]):null}let a=e.stroke(r,i,0,n);return a?this.simplify(a):null}static buildCircle(e,r){return this.simplify(cn.build7([gt.buildCircle(e,r,0)]))}static buildRect(e){return this.simplify(e.toPolyline())}static buildBBox(e){return this.simplify(cn.buildBBox(e,0))}constructor(e){this.items=e.slice()}multiply3(e){return new Nf(this.items.map(r=>r.multiply3(e)))}bbox(){return this.items[0].bbox()}isEqual(e){return e instanceof Nf?this.items.every(r=>e.items.some(i=>i.isEqual(r))):!1}getOutMostPolyline(){return this.items[0]}extend(e,r){if(this.items.length!==1)throw new Error("this.items.length !== 1");if(e===0)return new ao([this]);let i=this.items[0],n=[];for(let u of i.primitives)if(u instanceof Ge)n.push(u);else if(u instanceof gt&&u.rx===u.ry)a(u);else if(u instanceof br)s(u);else throw new Error("not support!");i=cn.build7(n);function s(u){let d=u.points(.1);for(let A=0;A<d.length-1;A++){let h=d[A],f=d[A+1];n.push(new Ge(h,f))}}function a(u){if(Math.abs(u.sweepAngle)>270){let d=u.sweepAngle/2;a(gt.build3(u.center,u.startAngle,d,u.rx,u.ry)),a(gt.build3(u.center,u.startAngle+d,d,u.rx,u.ry))}else n.push(u)}let o=[],l=[];i0e.getExtendPolyLine(i,e,!0,r).forEach(u=>{(u.area(.1)>0?l:o).push(u)});let c;if(o.length===1)l.forEach(u=>o.push(u)),c=new ao([new Nf(o)]);else if(o.length===0)console.warn("outlines.length === 0"),c=new ao([]);else if(l.length===0)c=new ao(o.map(u=>new Nf([u])));else{let u=o.map(d=>[d]);l.forEach(d=>{let A=[],h=d.bbox();if(u.forEach(f=>{f[0].bbox().isContainsBBox1(h)&&A.push(f)}),A.length===1)A[0].push(d);else{if(A.length===0)throw new Error("inPlsArr.length === 0");for(let f of A.sort((p,m)=>p[0].bbox().area()-m[0].bbox().area()))if(f[0].getWindingNum(d.start())===-1){f.push(d);break}}}),c=new ao(u.map(d=>new Nf(d)))}return c}toPolylineGroup(){return new rM(this.items)}};var a0e=(t=>(t[t.POLYGON=1]="POLYGON",t[t.POLYLINE=2]="POLYLINE",t[t.LINE=3]="LINE",t[t.ARC=4]="ARC",t[t.BEZIER2=5]="BEZIER2",t[t.BEZIER3=6]="BEZIER3",t[t.BOOLEAN_OUTPUT=7]="BOOLEAN_OUTPUT",t[t.BOOLEAN_INTERSECTION=8]="BOOLEAN_INTERSECTION",t[t.BOOLEAN_UNION=9]="BOOLEAN_UNION",t[t.BOOLEAN_DIFF=10]="BOOLEAN_DIFF",t[t.BOOLEAN_RESULT=11]="BOOLEAN_RESULT",t[t.LINES=12]="LINES",t[t.ARCS=13]="ARCS",t[t.BEZIER2S=14]="BEZIER2S",t[t.BEZIER3S=15]="BEZIER3S",t[t.CIRCLE_CW=16]="CIRCLE_CW",t[t.CIRCLE_CCW=17]="CIRCLE_CCW",t[t.POLYGON_GROUP=18]="POLYGON_GROUP",t))(a0e||{});var o0e=class{constructor(t){this.idx=-1,this.lst=t}hasNext(){return this.idx<this.lst.length-1}next(){if(this.idx<this.lst.length-1)return this.idx++,this.lst[this.idx];throw new Error("bug")}};function l0e(t){return new o0e(t)}function c0e(t){return t===32||t===9||t===13||t===10}var u0e=class{constructor(){this._line=1,this._col=0}line(){return this._line}col(){return this._col}_feed(t){return t===10?(this._col=0,this._line++):this._col++,this.feed(t)}parse(t){let e=t.length;for(let r=0;r<e;r++){let i=t.charCodeAt(r);if(!this._feed(i))return this}return this.finish(),this}},p4=class{static repeat(t,e){let r=new Array(e);for(;e-- >0;)r[e]=t;return r.join("")}static lpad(t,e,r){let i=r-t.length;return i>0?this.repeat(e,i)+t:t}},h0e=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.PERCENT=1]="PERCENT",t[t.LEFT_PAD0=2]="LEFT_PAD0",t))(h0e||{}),d0e=/(\.?0+)$/,N4=class{static format(t,...e){return this.format1(t,e)}static format1(t,e){let r=this._format(t,e);if(typeof r=="string")return r;throw new Error(this.format("Invalid state on (%d) %s",r,t))}static _format(t,e){let r=[],i=0,n=0,s,a=0,o=0;for(let l=0;l<t.length;l++){let c=t.charAt(l),u=c.charCodeAt(0);switch(i){case 0:u===37?i=1:r.push(c);break;case 1:switch(u){case 100:if(s=e[n++],typeof s=="number")r.push(s.toFixed(0)),i=0;else return l;break;case 102:if(s=e[n++],typeof s=="number")r.push(s.toString()),i=0;else return l;break;case 120:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16)),i=0;else return l;break;case 88:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16).toUpperCase()),i=0;else return l;break;case 115:case 99:s=e[n++],r.push(s===null?"null":s.toString()),i=0;break;case 48:a=l+1,o=-1,i=2;break;case 37:r.push("%"),i=0;break;default:return l}break;case 2:switch(u){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=l;break;case 100:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(p4.lpad((s|0).toString(10),"0",d)),i=0;else return l}else return l;break;case 120:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(p4.lpad((s|0).toString(16),"0",d)),i=0;else return l}else return l;break;case 88:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(p4.lpad((s|0).toString(16).toUpperCase(),"0",d)),i=0;else return l}else return l;break;default:return l}break;default:return l}}return r.join("")}static startsWith(t,e){return t.length>=e.length?t.substring(0,e.length)===e:!1}static endsWith(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}static fmtNumber(t){return t.toFixed(5).replace(d0e,"")}},A0e=(t=>(t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARNING=2]="WARNING",t[t.ERROR=3]="ERROR",t[t.DUMMY=4]="DUMMY",t))(A0e||{});function f0e(t){switch(t){case 0:return"DEBUG";case 1:return"INFO";case 2:return"WARNING";case 3:return"ERROR";case 4:return"DUMMY"}}var p0e=(t,e)=>{t===3?console.error(...e):t===2?console.warn(...e):console.log(...e)},m0e=(t,e)=>[f0e(t)].concat(e),lg,g0e=(lg=class{static mix(...e){return new lg(0,(r,i)=>{for(let n of e)n.write(r,i)},(r,i)=>i)}constructor(e,r=p0e,i=m0e){this.level=e,this.writer=r,this.fmt=i}setLevel(e){this.level=e}prepend(e=null,r=null){let i=e===null?this.fmt:(s,a)=>(a=e(s,a),this.fmt(s,a)),n=r===null?this.writer:(s,a)=>{r(s,a),this.writer(s,a)};return new lg(this.level,n,i)}chain(e){return e.prepend(this.fmt.bind(this),this.writer.bind(this))}include(e){return this.level<=e}formatWrite(e,r,i){this.include(e)&&this.writer(e,this.fmt(e,[N4.format(r,...i)]))}write(e,r){this.include(e)&&this.writer(e,this.fmt(e,r))}write3(e,r,i){this.include(e)&&this.writer(e,this.fmt(e,[N4.format(r,...i)]))}debug3(e,...r){this.write3(0,e,r)}warning3(e,...r){this.write3(2,e,r)}debugFmt(e,...r){this.formatWrite(0,e,r)}debug(...e){this.write(0,e)}infoFmt(e,...r){this.formatWrite(1,e,r)}info(...e){this.write(1,e)}warningFmt(e,...r){this.formatWrite(2,e,r)}warning(...e){this.write(2,e)}errorFmt(e,...r){this.formatWrite(3,e,r)}error(...e){this.write(3,e)}},lg.DUMMY=new lg(4),lg),m4=500,EY=String.fromCharCode,y0e=class{constructor(){this.buffer=new Array}size(){return this.buffer.length}isEOF(){return!1}write(t){return this.buffer.push(t),1}writen1(t){return this.writen2(t,0,t.length)}writen2(t,e,r){let i=this.buffer;for(let n=0,s=e;n<r;n++,s++)i.push(t[s]);return r}writeAsync(t,e){e(this.write(t))}writenAsync1(t,e){e(this.writen1(t))}writenAsync2(t,e,r,i){i(this.writen2(t,e,r))}writeStr(t){let e=t.length,r=new Array(e);for(let i=0;i<e;i++)r[i]=t.charCodeAt(i);return this.writen1(r)}clear(){this.buffer.length=0}toString(){let t=this.buffer,e=t.length;if(e<=m4)return EY.apply(null,t);{let r=new Array;for(let i=0;i<t.length;i+=m4){let n=Math.min(e-i,m4),s=EY.apply(null,t.slice(i,i+n));r.push(s)}return r.join("")}}},SV=(t=>(t[t.UNKNOW=0]="UNKNOW",t[t.NUMBER_INTEGER=1]="NUMBER_INTEGER",t[t.NUMBER_DECIMAL=2]="NUMBER_DECIMAL",t[t.NUMBER_E=3]="NUMBER_E",t[t.NUMBER_E_SIGNED=4]="NUMBER_E_SIGNED",t))(SV||{}),TV=(t=>(t[t.UNKNOW=0]="UNKNOW",t[t.MOVE_X=1]="MOVE_X",t[t.MOVE_Y=2]="MOVE_Y",t[t.LINE_X=3]="LINE_X",t[t.LINE_Y=4]="LINE_Y",t[t.HORIZONTAL_X=5]="HORIZONTAL_X",t[t.VERTICAL_Y=6]="VERTICAL_Y",t[t.CUBIC_BEZIER_X1=7]="CUBIC_BEZIER_X1",t[t.CUBIC_BEZIER_Y1=8]="CUBIC_BEZIER_Y1",t[t.CUBIC_BEZIER_X2=9]="CUBIC_BEZIER_X2",t[t.CUBIC_BEZIER_Y2=10]="CUBIC_BEZIER_Y2",t[t.CUBIC_BEZIER_X=11]="CUBIC_BEZIER_X",t[t.CUBIC_BEZIER_Y=12]="CUBIC_BEZIER_Y",t[t.ARC_RX=13]="ARC_RX",t[t.ARC_RY=14]="ARC_RY",t[t.ARC_ROTATION=15]="ARC_ROTATION",t[t.ARC_LARGE=16]="ARC_LARGE",t[t.ARC_SWEEP=17]="ARC_SWEEP",t[t.ARC_X=18]="ARC_X",t[t.ARC_Y=19]="ARC_Y",t[t.SMOOTH_CUBIC_BEZIER_X2=20]="SMOOTH_CUBIC_BEZIER_X2",t[t.SMOOTH_CUBIC_BEZIER_Y2=21]="SMOOTH_CUBIC_BEZIER_Y2",t[t.SMOOTH_CUBIC_BEZIER_X=22]="SMOOTH_CUBIC_BEZIER_X",t[t.SMOOTH_CUBIC_BEZIER_Y=23]="SMOOTH_CUBIC_BEZIER_Y",t[t.QUADRATIC_BEZIER_X1=24]="QUADRATIC_BEZIER_X1",t[t.QUADRATIC_BEZIER_Y1=25]="QUADRATIC_BEZIER_Y1",t[t.QUADRATIC_BEZIER_X=26]="QUADRATIC_BEZIER_X",t[t.QUADRATIC_BEZIER_Y=27]="QUADRATIC_BEZIER_Y",t))(TV||{});function b0e(t){return 97<=t&&t<=122||65<=t&&t<=90}function Fl(t){let e=parseFloat(t);if(isFinite(e))return e;throw new Error("expect number")}var wY=class extends u0e{constructor(t,e=!0,r=g0e.DUMMY){super(),this.buffer=new y0e,this.group=new Array,this.subPartStart=We.ORIGIN,this.curPoint=We.ORIGIN,this.lexState=0,this.parseState=0,this.isAbsolute=!1,this.isLargeArc=!1,this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=Number.NaN,this.y=Number.NaN,this.rx=Number.NaN,this.ry=Number.NaN,this.rotation=Number.NaN,this.sweep=_0.CCW,this.prevBezierCtrl2=null,this.logger=r,this.cb=t,this.yAxis=e?-1:1}on(t){return this.cb(t)}feed(t){switch(this.logger.include(0)&&this.logger.debug3("L: %c(%s)|%s",t,String.fromCharCode(t),SV[this.lexState]),this.lexState){case 0:return c0e(t)?!0:48<=t&&t<=57||t===45||t===43?(this.pushBuffer(t),this.lexState=1,!0):t===46?(this.pushBuffer(t),this.lexState=2,!0):b0e(t)?this.feedS(String.fromCharCode(t)):(this.logger.warning3("unknow letter %c",t),!0);case 1:return 48<=t&&t<=57?(this.pushBuffer(t),!0):t===46?(this.pushBuffer(t),this.lexState=2,!0):t===101||t===69?(this.pushBuffer(t),this.lexState=3,!0):this.feedS(this.getCleanBuffer())?(this.lexState=0,this.feed(t)):!1;case 2:return 48<=t&&t<=57?(this.pushBuffer(t),!0):t===101||t===69?(this.pushBuffer(t),this.lexState=3,!0):this.feedS(this.getCleanBuffer())?(this.lexState=0,this.feed(t)):!1;case 3:return 48<=t&&t<=57?(this.pushBuffer(t),!0):t===45||t===43?(this.pushBuffer(t),this.lexState=4,!0):this.feedS(this.getCleanBuffer())?(this.lexState=0,this.feed(t)):!1;case 4:return 48<=t&&t<=57?(this.pushBuffer(t),!0):this.feedS(this.getCleanBuffer())?(this.lexState=0,this.feed(t)):!1;default:return!0}}finish(){this.feed(32),this.tryNotify()}feedS(t){switch(this.logger.include(0)&&this.logger.debug3("P: %s|%s|%s|%s",t,TV[this.parseState],this.curPoint,this.subPartStart),this.parseState){case 0:switch(t){case"M":this.isAbsolute=!0,this.parseState=1;break;case"m":this.isAbsolute=!1,this.parseState=1;break;case"L":this.isAbsolute=!0,this.parseState=3;break;case"l":this.isAbsolute=!1,this.parseState=3;break;case"H":this.isAbsolute=!0,this.parseState=5;break;case"h":this.isAbsolute=!1,this.parseState=5;break;case"V":this.isAbsolute=!0,this.parseState=6;break;case"v":this.isAbsolute=!1,this.parseState=6;break;case"z":case"Z":{this.group.push(new Ge(this.curPoint,this.subPartStart));let i=this.tryNotify();return this.curPoint=this.subPartStart,i}case"C":this.isAbsolute=!0,this.parseState=7;break;case"c":this.isAbsolute=!1,this.parseState=7;break;case"S":this.isAbsolute=!0,this.parseState=20;break;case"s":this.isAbsolute=!1,this.parseState=20;break;case"A":this.isAbsolute=!0,this.parseState=13;break;case"a":this.isAbsolute=!1,this.parseState=13;break;case"Q":this.isAbsolute=!0,this.parseState=24;break;case"q":this.isAbsolute=!1,this.parseState=24;break;default:this.logger.warning3("unknow %s",t)}return!0;case 1:let e=this.tryNotify();return this.x=Fl(t),this.parseState=2,e;case 2:{this.y=this.yAxis*Fl(t);let i;return this.isAbsolute?i=new We(this.x,this.y):i=this.curPoint.add1(this.x,this.y),this.curPoint=i,this.subPartStart=i,this.parseState=3,!0}case 3:return this.x=parseFloat(t),isFinite(this.x)?(this.parseState=4,!0):(this.parseState=0,this.feedS(t));case 4:{this.y=this.yAxis*Fl(t);let i;return this.isAbsolute?i=new We(this.x,this.y):i=this.curPoint.add1(this.x,this.y),this.group.push(new Ge(this.curPoint,i)),this.curPoint=i,this.parseState=3,!0}case 5:if(this.x=parseFloat(t),isFinite(this.x)){let i;return this.isAbsolute?i=new We(this.x,this.curPoint.y):i=this.curPoint.add1(this.x,0),this.group.push(new Ge(this.curPoint,i)),this.curPoint=i,!0}else return this.parseState=0,this.feedS(t);case 6:if(this.y=parseFloat(t),isFinite(this.y)){this.y=this.yAxis*this.y;let i;return this.isAbsolute?i=new We(this.curPoint.x,this.y):i=this.curPoint.add1(0,this.y),this.group.push(new Ge(this.curPoint,i)),this.curPoint=i,!0}else return this.parseState=0,this.feedS(t);case 7:let r=parseFloat(t);return isFinite(r)?(this.x1=r,this.parseState=8,!0):(t!=="s"&&t!=="S"&&(this.prevBezierCtrl2=null),this.parseState=0,this.feedS(t));case 8:return this.y1=this.yAxis*Fl(t),this.parseState=9,!0;case 9:return this.x2=Fl(t),this.parseState=10,!0;case 10:return this.y2=this.yAxis*Fl(t),this.parseState=11,!0;case 11:return this.x=Fl(t),this.parseState=12,!0;case 12:{this.y=this.yAxis*Fl(t);let i,n,s;return this.isAbsolute?(i=new We(this.x1,this.y1),n=new We(this.x2,this.y2),s=new We(this.x,this.y)):(i=this.curPoint.add1(this.x1,this.y1),n=this.curPoint.add1(this.x2,this.y2),s=this.curPoint.add1(this.x,this.y)),this.prevBezierCtrl2=n,this.group.push(new br([this.curPoint,i,n,s])),this.curPoint=s,this.parseState=7,!0}case 13:return this.rx=parseFloat(t),isFinite(this.rx)?(this.parseState=14,!0):(this.parseState=0,this.feedS(t));case 14:return this.ry=Fl(t),this.parseState=15,!0;case 15:return this.rotation=Fl(t),this.parseState=16,!0;case 16:return this.isLargeArc=Fl(t)===1,this.parseState=17,!0;case 17:return this.sweep=Fl(t)===1?_0.CW:_0.CCW,this.parseState=18,!0;case 18:return this.x=Fl(t),this.parseState=19,!0;case 19:{this.y=this.yAxis*Fl(t);let i;return this.isAbsolute?i=new We(this.x,this.y):i=this.curPoint.add1(this.x,this.y),this.rx&&this.ry&&this.group.push(gt.build1(this.curPoint,i,this.rx,this.ry,this.isLargeArc,this.sweep)),this.curPoint=i,this.parseState=13,!0}case 20:return this.x2=parseFloat(t),isFinite(this.x2)?(this.parseState=21,!0):(t!=="s"&&t!=="S"&&(this.prevBezierCtrl2=null),this.parseState=0,this.feedS(t));case 21:return this.y2=this.yAxis*Fl(t),this.parseState=22,!0;case 22:return this.x=Fl(t),this.parseState=23,!0;case 23:{this.y=this.yAxis*Fl(t);let i,n;this.isAbsolute?(i=new We(this.x2,this.y2),n=new We(this.x,this.y)):(i=this.curPoint.add1(this.x2,this.y2),n=this.curPoint.add1(this.x,this.y));let s;return this.prevBezierCtrl2?s=this.curPoint.add(this.curPoint.sub(this.prevBezierCtrl2)):s=this.curPoint,this.prevBezierCtrl2=i,this.group.push(new br([this.curPoint,s,i,n])),this.curPoint=n,this.parseState=20,!0}case 24:return this.x1=parseFloat(t),isFinite(this.x1)?(this.parseState=25,!0):(t!=="s"&&t!=="S"&&(this.prevBezierCtrl2=null),this.parseState=0,this.feedS(t));case 25:return this.y1=this.yAxis*Fl(t),this.parseState=26,!0;case 26:return this.x=Fl(t),this.parseState=27,!0;case 27:{this.y=this.yAxis*Fl(t);let i,n;return this.isAbsolute?(i=new We(this.x1,this.y1),n=new We(this.x,this.y)):(i=this.curPoint.add1(this.x1,this.y1),n=this.curPoint.add1(this.x,this.y)),this.prevBezierCtrl2=i,this.group.push(new br([this.curPoint,i,n])),this.curPoint=n,this.parseState=24,!0}default:return this.logger.warning3("unsupported parse state %s",this.parseState),!0}}pushBuffer(t){this.buffer.write(t)}getCleanBuffer(){let t=this.buffer.toString();return this.buffer.clear(),t}tryNotify(){if(this.group.length===0)return!0;{let t=cn.build1(l0e(this.group));return this.group.length=0,this.on(t)}}onException(t){throw t}},x0e=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.ENC_LINE=1]="ENC_LINE",t[t.ENC_ARC=2]="ENC_ARC",t[t.ENC_CUBIC_BEZIER=3]="ENC_CUBIC_BEZIER",t[t.ENC_QUADRATIC_BEZIER=4]="ENC_QUADRATIC_BEZIER",t))(x0e||{}),I8e=N4.fmtNumber,vY=class{constructor(t=!0){this.buffer=new Array,this.state=0,this.prev=null,this.yAxis=t?-1:1}encPl(t){for(let e of t.primitives)this.encPt(e);return this}encPt(t){if(t instanceof Ge)this.encLine1(t);else if(t instanceof gt)this.encArc(t);else if(t instanceof br)this.encBezier(t);else throw new Error("");return this}encBezier(t){if(t.controls.length===3){let e=t.controls[0],r=t.controls[1],i=t.controls[2];this.state===0?this.buffer.push("M",e.x,this.yAxis*e.y,"Q",r.x,this.yAxis*r.y,i.x,this.yAxis*i.y):e.equals1(this.prev)?this.state!==4?this.buffer.push("Q",r.x,this.yAxis*r.y,i.x,this.yAxis*i.y):this.buffer.push(r.x,this.yAxis*r.y,i.x,this.yAxis*i.y):this.buffer.push("L",e.x,this.yAxis*e.y,"Q",r.x,this.yAxis*r.y,i.x,this.yAxis*i.y),this.prev=i,this.state=4}else if(t.controls.length===4){let e=t.controls[0],r=t.controls[1],i=t.controls[2],n=t.controls[3];this.state===0?this.buffer.push("M",e.x,this.yAxis*e.y,"C",r.x,this.yAxis*r.y,i.x,this.yAxis*i.y,n.x,this.yAxis*n.y):e.equals1(this.prev)?this.state!==3?this.buffer.push("C",r.x,this.yAxis*r.y,i.x,this.yAxis*i.y,n.x,this.yAxis*n.y):this.buffer.push(r.x,this.yAxis*r.y,i.x,this.yAxis*i.y,n.x,this.yAxis*n.y):this.buffer.push("L",e.x,this.yAxis*e.y,"C",r.x,this.yAxis*r.y,i.x,this.yAxis*i.y,n.x,this.yAxis*n.y),this.prev=n,this.state=3}else throw new Error("only bezier has 3 or 4 control points supported");return this}encArc(t){let e=t.svgEnd;return this.state===0?this.buffer.push("M",t.start().x,this.yAxis*t.start().y,"A",t.rx,t.ry,0,t.isLarge()?1:0,t.sweep()===_0.CCW?0:1,e.x,this.yAxis*e.y):t.start().equals1(this.prev)?this.state!==2?this.buffer.push("A",t.rx,t.ry,0,t.isLarge()?1:0,t.sweep()===_0.CCW?0:1,e.x,this.yAxis*e.y):this.buffer.push(t.rx,t.ry,0,t.isLarge()?1:0,t.sweep()===_0.CCW?0:1,e.x,this.yAxis*e.y):this.buffer.push("L",t.start().x,this.yAxis*t.start().y,"A",t.rx,t.ry,0,t.isLarge()?1:0,t.sweep()===_0.CCW?0:1,e.x,this.yAxis*e.y),this.prev=e,this.state=2,this}encLine1(t){return this.encLine2(t.start(),t.end()),this}encLine2(t,e){return this.state===0?this.buffer.push("M",t.x,this.yAxis*t.y,"L",e.x,this.yAxis*e.y):(this.state!==1&&this.buffer.push("L"),t.equals1(this.prev)?this.buffer.push(e.x,this.yAxis*e.y):this.buffer.push(t.x,this.yAxis*t.y,e.x,this.yAxis*e.y)),this.prev=e,this.state=1,this}close(t){return this.state!==0&&(t&&this.buffer.push("Z"),this.state=0,this.prev=null),this}fixNumber(t=4){return this.buffer.forEach((e,r,i)=>{typeof e=="number"&&(e|0)!==e&&(i[r]=+e.toFixed(t))}),this}toString(){return this.buffer.join(" ")}toArray(){return this.buffer}},E0e=class extends $4{constructor(){super(),this.lockConfig=[],this.hideConfig=[],this.invisibleConfig=[],this.coverConfig={},this.commentConfig={},this.trnCtrlConfig={},this.transformConfig={},this.fontCache={},this.cache={},this.zIndex=0,this.zIndexMap=new Map}onParseLine(t){let e=t[0];switch(e){case"DOCTYPE":this.parseDocType(t);break;case"HEAD":this.parseHead(t);break;case"LOCK":this.parseLock(t);break;case"HIDE":this.parseHide(t);break;case"INVISIBLE":this.parseInvisible(t);break;case"COVER":this.parseCover(t);break;case"TRN_CTRL":this.parseTrnCtrl(t);break;case"COMMENT":this.parseComment(t);break;case"FONT_CACHE":this.parseFontCache(t);break;case"TRANSFORM":this.parseTransform(t);break;case"GROUP":{let r=t[1];this.cache[e]||(this.cache[e]={errorIds:[]}),r!==null&&this.cache[e][r]?this.cache[e][r]=t:this.cache[e].errorIds.push(t);break}case"POLY":case"STRING":case"AUXLINE":case"DIMENSION":{this.zIndexMap.set(t[1],++this.zIndex);let r=sC(t[1]);this.cache[e]||(this.cache[e]={errorIds:[]}),r!==null&&!this.cache[e][r]?this.cache[e][r]=t:this.cache[e].errorIds.push(t);break}default:console.warn("can not find hanlder with",t)}}getZIndex(t){var e;return(e=this.zIndexMap.get(t))!=null?e:null}secondParseLine(t){switch(t[0]){case"GROUP":this.parseGroup(t);break;case"POLY":this.parsePoly(t);break;case"STRING":this.parseString(t);break;case"AUXLINE":this.parseAuxLine(t);break;case"DIMENSION":this.parseDimension(t);break}}onParseEnd(){for(let t in this.cache){let e=this.cache[t],r=Object.keys(e).sort((n,s)=>Number(n)-Number(s)),i=0;for(let n of r){if(n==="errorIds")continue;let s=Number(n),a=s-i-1;a>=1&&this.onPHolder(t,a),i=s,this.secondParseLine(e[s])}e.errorIds.forEach(n=>this.secondParseLine(n))}this.clearCache()}clearCache(){this.lockConfig=[],this.hideConfig=[],this.invisibleConfig=[],this.coverConfig={},this.commentConfig={},this.trnCtrlConfig={},this.transformConfig={},this.fontCache={},this.cache={},this.version=void 0}parseDocType(t){this.version=Number(t[2])}parseHead(t){this.version<2&&t[1]&&t[1].print==="AHead Side"&&(t[1].print="Ahead Side"),this.onCanvas(t[1])}parseGroup(t){this.onGroup(t[1],t[2],t[3],!!t[4],!!t[5])}parseLock(t){this.lockConfig.push(...t[1])}parseHide(t){this.hideConfig.push(...t[1])}parseInvisible(t){this.invisibleConfig.push(...t[1])}parseCover(t){this.coverConfig[t[1]]=t[2]}parseTrnCtrl(t){this.trnCtrlConfig[t[1]]={scope:t[2],trans_print:t[3],trans_white:t[4]}}parseComment(t){this.commentConfig[t[1]]=t[2]}matrix2svg(t){let[e,r,i,n,s,a,o,l,c]=t.data;return[e,r,n,s,o,l]}encPath(t){let e=new Array;return new wY(r=>(e.push(new vY(!0).encPl(r).toArray().slice(1)),!0),!0).parse(t),e}parseRect(t){var E,w,x,I,C,G,U,_;let[,e,,r,i,n,s,a,o,,,l,c]=t,u=l[0],d=u[1],A=-u[2],h=u[1]+u[3],f=-u[2]+u[4],p=u[5],m=u[6],y=+u[7],g=+u[8],b=as.scale(h-d,f-A).rotateD(-y);g&&(b=b.multiply3(as.MIRROR_X)),b=b.translate(d,A),b=this.matrix2svg(b),b=this.encMatrix(b),this.onPoly(e,0,r,-y,i,n,s,a,o,!0,[["R",0,0,1,1,p,m,0,0]],!0,!0,this.lockConfig.some(H=>H===t[1]),this.hideConfig.some(H=>H===t[1]),this.invisibleConfig.some(H=>H===t[1]),r===1?1:(E=this.coverConfig[t[1]])!=null?E:null,c||((w=this.commentConfig[t[1]])!=null?w:null),r===2?3:(I=(x=this.trnCtrlConfig[t[1]])==null?void 0:x.scope)!=null?I:null,r===2?o:(G=(C=this.trnCtrlConfig[t[1]])==null?void 0:C.trans_print)!=null?G:null,r===2?1-o:(_=(U=this.trnCtrlConfig[t[1]])==null?void 0:U.trans_white)!=null?_:null,b!=null?b:null)}parseObj(t){var C,G,U,_,H,Q,j,$;let[,e,,r,i,n,s,a,o,,,l,c]=t,[u,d,A,h,f,p,m,y,g]=l[0],b=as.rotateD(y);g&&(b=b.multiply3(as.MIRROR_X));let E;g?E=new Ge(new We(0,0),new We(0,-f)).multiply3(b):E=new Ge(new We(0,0),new We(h,0)).multiply3(b);let w=E.end().angleD(E.start()),x=g===1;h=g===1?f:h,f=g===1?h:f;let I=as.scale(h,f).rotateD(-w);x&&(I=I.multiply3(as.MIRROR_X)),I=I.translate(d,-A),I=this.matrix2svg(I),I=this.encMatrix(I),this.onPoly(e,0,r,-w,i,n,s,a,o,!0,[["R",0,0,1,1,0,0,0,0]],!1,!1,this.lockConfig.some(B=>B===t[1]),this.hideConfig.some(B=>B===t[1]),this.invisibleConfig.some(B=>B===t[1]),r===1?1:(C=this.coverConfig[t[1]])!=null?C:null,c||((G=this.commentConfig[t[1]])!=null?G:null),r===2?3:(_=(U=this.trnCtrlConfig[t[1]])==null?void 0:U.scope)!=null?_:null,r===2?o:(Q=(H=this.trnCtrlConfig[t[1]])==null?void 0:H.trans_print)!=null?Q:null,r===2?1-o:($=(j=this.trnCtrlConfig[t[1]])==null?void 0:j.trans_white)!=null?$:null,I!=null?I:null)}parseEllipse(t){var g,b,E,w,x,I,C,G;let[,e,,r,i,n,s,a,o,,,l,c]=t,u=l[0],d=u[1],A=-u[2],h=u[3],f=u[4],p=+u[5],m=+u[6],y=as.scale(h,f).rotateD(-p);m&&(y=y.multiply3(as.MIRROR_X)),y=y.translate(d,A),y=this.matrix2svg(y),y=this.encMatrix(y),this.onPoly(e,0,r,-p,i,n,s,a,o,!0,[["ELLIPSE",0,0,1,1,0,0]],!0,!0,this.lockConfig.some(U=>U===t[1]),this.hideConfig.some(U=>U===t[1]),this.invisibleConfig.some(U=>U===t[1]),r===1?1:(g=this.coverConfig[t[1]])!=null?g:null,c||((b=this.commentConfig[t[1]])!=null?b:null),r===2?3:(w=(E=this.trnCtrlConfig[t[1]])==null?void 0:E.scope)!=null?w:null,r===2?o:(I=(x=this.trnCtrlConfig[t[1]])==null?void 0:x.trans_print)!=null?I:null,r===2?1-o:(G=(C=this.trnCtrlConfig[t[1]])==null?void 0:C.trans_white)!=null?G:null,y!=null?y:null)}parsePolyGroup(t){var h,f,p,m,y,g,b,E;let[,e,,r,i,n,s,a,o,,,l,c]=t,u=!0,d=!0,A=this.decMultiPoly(l).d;this.onPoly(e,0,r,0,i,n,s,a,o,!0,this.encPath(A),u,d,this.lockConfig.some(w=>w===t[1]),this.hideConfig.some(w=>w===t[1]),this.invisibleConfig.some(w=>w===t[1]),r===1?1:(h=this.coverConfig[t[1]])!=null?h:null,c||((f=this.commentConfig[t[1]])!=null?f:null),r===2?3:(m=(p=this.trnCtrlConfig[t[1]])==null?void 0:p.scope)!=null?m:null,r===2?o:(g=(y=this.trnCtrlConfig[t[1]])==null?void 0:y.trans_print)!=null?g:null,r===2?1-o:(E=(b=this.trnCtrlConfig[t[1]])==null?void 0:b.trans_white)!=null?E:null,null)}parsePoly(t){var e,r,i,n,s,a,o,l,c,u;if(this.version<2)if(t[11].length===1)switch(t[11][0][0]){case"R":{let d=t[7];return d.startsWith("data:")||d.startsWith("blob:")?this.parseObj(t):this.parseRect(t)}case"ELLIPSE":return this.parseEllipse(t);default:return this.parsePolyGroup(t)}else return this.parsePolyGroup(t);else this.onPoly(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],!!(t[12]||t[12]===void 0),!!(t[13]||t[13]===void 0),this.lockConfig.some(d=>d===t[1]),this.hideConfig.some(d=>d===t[1]),this.invisibleConfig.some(d=>d===t[1]),(e=this.coverConfig[t[1]])!=null?e:null,(r=this.commentConfig[t[1]])!=null?r:null,(n=(i=this.trnCtrlConfig[t[1]])==null?void 0:i.scope)!=null?n:null,(a=(s=this.trnCtrlConfig[t[1]])==null?void 0:s.trans_print)!=null?a:null,(l=(o=this.trnCtrlConfig[t[1]])==null?void 0:o.trans_white)!=null?l:null,(u=(c=this.transformConfig[t[1]])==null?void 0:c.matrix)!=null?u:null)}decMultiPoly(t){let e=new vh,r=t.map(i=>{let n="";return new wY(s=>(e.ext1(s.bbox()),n=new vY().encPl(s).toString(),!1),!1).parse("M"+i.join(" ")),n}).join(" ");return{bbox:e.build(),d:r}}encMatrix(t){let[e,r,i,n,s,a]=t,o=new as([e,r,0,i,n,0,s,a,1]);o=as.MIRROR_Y.multiply3(o).multiply3(as.MIRROR_Y);let[l,c,u,d,A,h,f,p,m]=o.data;return[l,d,f,c,A,p]}parseString(t){var e,r,i,n,s,a,o,l,c,u,d,A,h,f,p,m,y,g,b;if(this.version<2){let[,E,w,x,I,C,G,U,_,H,Q,j,$,B,M,v,N,R,q,P]=t;C=Sc(C);let z=_;U=U===1,$=$===1,B=B===1,M=M===1;let W=-(v[15]/3|0)+2,oe=v%3;q=q||1,P=P||1;let Ae=this.fontCache[t[1]],{bbox:me,d:ve}=this.decMultiPoly(Ae),Le=me.width(),He=me.height();He=He||0,Le=Le||0;let rt=0;switch(oe){case 1:rt=-Le/2;break;case 2:rt=-Le;break}let qe=0;switch(W){case 1:qe=He/2;break;case 0:qe=He;break}let xt=as.translate(rt,qe).scale(q,P).rotateD(-G);U&&(xt=xt.multiply3(as.MIRROR_X)),xt=xt.translate(I,C);let Gt=this.matrix2svg(xt),ut=this.encMatrix(Gt);this.onString(E,w,x,G,z,H,Q,j,$,B,M,((-W||0)+2)*3+(oe||0),N,R,this.lockConfig.some(Pe=>Pe===t[1]),this.hideConfig.some(Pe=>Pe===t[1]),this.invisibleConfig.some(Pe=>Pe===t[1]),x===1?1:(e=this.coverConfig[t[1]])!=null?e:null,(r=this.commentConfig[t[1]])!=null?r:null,x===2?3:(n=(i=this.trnCtrlConfig[t[1]])==null?void 0:i.scope)!=null?n:null,x===2?R:(a=(s=this.trnCtrlConfig[t[1]])==null?void 0:s.trans_print)!=null?a:null,x===2?1-R:(l=(o=this.trnCtrlConfig[t[1]])==null?void 0:o.trans_white)!=null?l:null,ut,!!ut,this.encPath(ve))}else this.onString(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]===1,t[10]===1,t[11]===1,t[12],t[13],t[14],this.lockConfig.some(E=>E===t[1]),this.hideConfig.some(E=>E===t[1]),this.invisibleConfig.some(E=>E===t[1]),(c=this.coverConfig[t[1]])!=null?c:null,(u=this.commentConfig[t[1]])!=null?u:null,(A=(d=this.trnCtrlConfig[t[1]])==null?void 0:d.scope)!=null?A:null,(f=(h=this.trnCtrlConfig[t[1]])==null?void 0:h.trans_print)!=null?f:null,(m=(p=this.trnCtrlConfig[t[1]])==null?void 0:p.trans_white)!=null?m:null,(g=(y=this.transformConfig[t[1]])==null?void 0:y.matrix)!=null?g:null,!!((b=this.transformConfig[t[1]])!=null&&b.matrix),this.fontCache[t[1]])}parseFontCache(t){this.fontCache[t[1]]=t[2]}parseDimension(t){var e,r,i,n,s,a,o,l,c,u,d,A;this.onDimension(t[1],t[2],t[3],(e=t[4])!=null?e:null,t[5],t[6],t[7],t[8],this.lockConfig.some(h=>h===t[1]),this.hideConfig.some(h=>h===t[1]),this.invisibleConfig.some(h=>h===t[1]),(r=this.coverConfig[t[1]])!=null?r:null,(i=this.commentConfig[t[1]])!=null?i:null,(s=(n=this.trnCtrlConfig[t[1]])==null?void 0:n.scope)!=null?s:null,(o=(a=this.trnCtrlConfig[t[1]])==null?void 0:a.trans_print)!=null?o:null,(c=(l=this.trnCtrlConfig[t[1]])==null?void 0:l.trans_white)!=null?c:null,(d=(u=this.transformConfig[t[1]])==null?void 0:u.matrix)!=null?d:null,!!((A=this.transformConfig[t[1]])!=null&&A.matrix))}parseTransform(t){this.transformConfig[t[1]]={matrix:t[2],strokes:!!t[3]}}parseAuxLine(t){var e,r,i,n,s,a,o,l,c,u,d;this.onAuxLine(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],this.lockConfig.some(A=>A===t[1]),this.hideConfig.some(A=>A===t[1]),this.invisibleConfig.some(A=>A===t[1]),(e=this.coverConfig[t[1]])!=null?e:null,(r=this.commentConfig[t[1]])!=null?r:null,(n=(i=this.trnCtrlConfig[t[1]])==null?void 0:i.scope)!=null?n:null,(a=(s=this.trnCtrlConfig[t[1]])==null?void 0:s.trans_print)!=null?a:null,(l=(o=this.trnCtrlConfig[t[1]])==null?void 0:o.trans_white)!=null?l:null,(u=(c=this.transformConfig[t[1]])==null?void 0:c.matrix)!=null?u:null,!!((d=this.transformConfig[t[1]])!=null&&d.matrix))}},w0e=class extends $4{constructor(t={},e=[]){super(),this.symbolPartIds=t,this.device=e,this.defaultPartId="pid8a0e77bacb214e",this.curPart="",this.onlyPart="",this.partIdMap={},this.fontStyleIndex={},this.lineStyleIndex={},this.groupIndex={},this.zIndex=0,this.zIndexMap=new Map,this.cache={},this.errorIds={},this.tableCell={},this.hasPart=!1,this.components={},this.busEntryMap={},this.defaultLineStyle={strokeColor:null,strokeStyle:null,fillColor:null,strokeWidth:null,fillStyle:null},this.defaultFontStyle={color:null,fillColor:null,fontFamily:null,fontSize:null,strikeout:null,underline:null,italic:null,fontWeight:null,hAlign:null,vAlign:null}}getZIndex(t){var e;return(e=this.zIndexMap.get(t))!=null?e:null}transPinAttrKey(t){switch(t){case"NUMBER":{t="Pin Number";break}case"NAME":{t="Pin Name";break}}return t}transFontStyle(t){return{color:t.color,fillColor:t.fillColor,fontFamily:t.fontFamily,fontSize:t.fontSize,strikeout:t.strikeout,underline:t.underline,italic:t.italic,fontWeight:t.fontWeight,align:this.transAlign(t.vAlign,t.hAlign)}}transTableFontStyle(t){return{color:t.color,fillColor:t.fillColor,fontFamily:t.fontFamily,fontSize:t.fontSize,strikeout:t.strikeout,underline:t.underline,italic:t.italic,fontWeight:t.fontWeight,vAlign:this.transVAlign(t.vAlign),hAlign:this.transHAlign(t.hAlign)}}transVAlign(t){switch(t=t&&Number(t),t){case 0:return"TOP";case 1:return"MIDDLE";case 2:return"BOTTOM";default:return null}}transHAlign(t){switch(t=t&&Number(t),t){case 0:return"LEFT";case 1:return"CENTER";case 2:return"RIGHT";default:return null}}transAlign(t,e){if(t=t&&Number(t),e=e&&Number(e),e===0)switch(t){case 0:return"LEFT_TOP";case 1:return"LEFT_MIDDLE";case 2:return"LEFT_BOTTOM";default:return null}if(e===1)switch(t){case 0:return"CENTER_TOP";case 1:return"CENTER_MIDDLE";case 2:return"CENTER_BOTTOM";default:return null}if(e===2)switch(t){case 0:return"RIGHT_TOP";case 1:return"RIGHT_MIDDLE";case 2:return"RIGHT_BOTTOM";default:return null}return null}transStrokeStyle(t){switch(t=t&&Number(t),t){case 0:return"SOLID";case 1:return"SHORT_DASH";case 2:return"DOT";case 3:return"DOT_DASH";default:return null}}transFillStyle(t){switch(t=t&&Number(t),t){case 0:return"NONE";case 1:return"SOLID";case 2:return"GRID";case 3:return"HORIZONTAL_LINE";case 4:return"VERTICAL_LINE";case 5:return"RHOMBIC";case 6:return"LEFT_SLASH_LINE";case 7:return"RIGHT_SLASH_LINE";default:return null}}transPinShape(t){switch(t=t&&Number(t),t){case 0:return"NONE";case 1:return"CLOCK";case 2:return"INVERTED";case 3:return"INVERTED_CLOCK";default:return"NONE"}}onParseLine(t){var r,i;let e=t[0];switch(e){case"DOCTYPE":this.parseDocType(t);break;case"HEAD":this.parseHead(t);break;case"GROUP":this.parseGroup(t);break;case"FONTSTYLE":this.parseFontStyle(t);break;case"LINESTYLE":this.parseLineStyle(t);break;case"TERM":break;case"PART":this.hasPart=!0,this.parsePart(t);break;case"TABEL_CELL":this.parseTableCell(t);break;case"BUSENTRY":{this.parseBusEntry(t);break}case"WIRE":case"BUS":case"TEXT":case"POLY":case"CIRCLE":case"ARC":case"RECT":case"PIN":case"OBJ":case"COMPONENT":case"ELLIPSE":case"BEZIER":case"TABLE":{this.zIndexMap.set(t[1],++this.zIndex);let n=sC(t[1]);this.cache[e]||(this.cache[e]={}),n!==null&&!this.cache[e][n]?this.cache[e][n]={part:this.curPart,value:t}:(this.errorIds[e]||(this.errorIds[e]=[]),this.errorIds[e].push({part:this.curPart,value:t}));break}case"ATTR":{this.zIndexMap.set(t[1],++this.zIndex),t[3]==="Symbol"&&(this.components[t[2]]||(this.components[t[2]]={symbol:"",device:""}),this.components[t[2]].symbol=t[4]),t[3]==="Device"&&(this.components[t[3]]||(this.components[t[3]]={symbol:"",device:""}),this.components[t[3]].device=t[4]);let n=Object.keys(((r=this.cache)==null?void 0:r.COMPONENT)||{}).find(o=>this.cache.COMPONENT[o].value[1]===t[2]);if(n){let o=this.cache.COMPONENT[n];o.attr||(o.attr=[]),o.attr.push({part:this.curPart,value:t});break}let s=Object.keys(((i=this.cache)==null?void 0:i.PIN)||{}).find(o=>this.cache.PIN[o].value[1]===t[2]);if(s){let o=this.cache.PIN[s];o.attr||(o.attr=[]),o.attr.push({part:this.curPart,value:t});break}let a=sC(t[1]);this.cache[e]||(this.cache[e]={}),a!==null?this.cache[e][a]||(this.cache[e][a]={part:this.curPart,value:t}):(this.errorIds[e]||(this.errorIds[e]=[]),this.errorIds[e].push({part:this.curPart,value:t}));break}default:console.warn("can not find hanlder with",t)}}secondParseLine(t){switch(t[0]){case"DOCTYPE":case"HEAD":case"GROUP":case"FONTSTYLE":case"LINESTYLE":break;case"ATTR":this.parseAttr(t);break;case"WIRE":this.parseWire(t);break;case"BUS":this.parseBus(t);break;case"TEXT":this.parseText(t);break;case"POLY":this.parsePoly(t);break;case"CIRCLE":this.parseCircle(t);break;case"ARC":this.parseArc(t);break;case"BUSENTRY":break;case"RECT":this.parseRect(t);break;case"PIN":this.parsePin(t);break;case"OBJ":this.parseObj(t);break;case"COMPONENT":this.parseComponent(t);break;case"ELLIPSE":this.parseEllipse(t);break;case"BEZIER":this.parseBezier(t);break;case"TABLE":this.parseTable(t);break;case"TABEL_CELL":break}}onParseEnd(){this.docType==="SYMBOL"&&!this.hasPart&&(this.curPart=this.defaultPartId,this.onlyPart=this.curPart,this.partIdMap[""]=this.curPart,this.onPart(this.curPart,{title:""}));for(let t in this.cache){let e=this.cache[t],r=Object.keys(e).sort((n,s)=>Number(n)-Number(s)),i=0;for(let n of r){let s=Number(n),a=s-i-1;a>=1&&this.onPHolder(t,a),i=s,this.curPart=this.hasPart?e[s].part||this.onlyPart:this.curPart,this.secondParseLine(e[s].value),e[s].attr&&e[s].attr.forEach(o=>{this.curPart=this.hasPart?o.part||this.onlyPart:this.curPart,this.secondParseLine(o.value)})}if(this.errorIds[t])for(let n of this.errorIds[t])this.curPart=this.hasPart?n.part||this.onlyPart:this.curPart,this.secondParseLine(n.value)}this.clearCache()}clearCache(){this.fontStyleIndex={},this.lineStyleIndex={},this.groupIndex={},this.cache={},this.errorIds={},this.curPart="",this.components={},this.tableCell={},this.hasPart=!1,this.version=void 0,this.docType=void 0}parseDocType(t){this.docType=t[1];let e=parseFloat(t[2]);this.version=e}parseHead(t){this.onCanvas(t[1])}parseFontStyle(t){this.fontStyleIndex[t[1]]={color:t[3]===""?"none":t[3],fillColor:t[2],fontFamily:t[4],fontSize:t[5],strikeout:t[9]===null?null:t[9]===1,underline:t[8]===null?null:t[8]===1,italic:t[6]===null?null:t[6]===1,fontWeight:t[7]===null?null:t[7]===1,vAlign:t[10],hAlign:t[11]}}parseLineStyle(t){this.lineStyleIndex[t[1]]={strokeColor:t[2],strokeStyle:this.transStrokeStyle(t[3]),fillColor:t[4]===""?"none":t[4],strokeWidth:t[5],fillStyle:this.transFillStyle(t[6])}}getGroupId(t){var r;let e=this;for(let i in e.groupIndex)if((r=e.groupIndex[i])!=null&&r.includes(t))return i;return""}parseBezier(t){let e=this.lineStyleIndex[t[3]];e||(e=this.defaultLineStyle,console.warn("style not found",t));let r=this.getGroupId(t[1]);for(let i=0;i<t[2].length;i+=2)t[2][i+1]=Sc(t[2][i+1]);this.onBezier(t[1],this.curPart,r,!!t[4],t[2],e.strokeColor,e.strokeStyle,e.fillColor,e.strokeWidth,e.fillStyle)}parseGroup(t){this.groupIndex[t[1]]=t[4]||[],this.onGroup(t[1],t[2]||"",t[3]||"")}parseBus(t){let e=this.lineStyleIndex[t[3]];e||(e=this.defaultLineStyle,console.warn("style not found",t));let r=t[2]||[],i=this.getGroupId(t[1]);this.onBus(t[1],this.curPart,i,!!t[4],r,e.strokeColor,e.strokeStyle,e.fillColor,e.strokeWidth,e.fillStyle,this.busEntryMap[t[1]]||{})}parseWire(t){let e=this.lineStyleIndex[t[3]];e||(e=this.defaultLineStyle,console.warn("style not found",t));let r=t[2]||[],i=this.getGroupId(t[1]);this.onWire(t[1],this.curPart,i,!!t[4],r,e.strokeColor,e.strokeStyle,e.fillColor,e.strokeWidth,e.fillStyle)}parseText(t){let e=this.fontStyleIndex[t[6]];e||(e=this.defaultFontStyle,console.warn("font not found",t));let r=this.transFontStyle(e),i=this.getGroupId(t[1]);this.onText(t[1],this.curPart,i,!!t[7],t[2],t[3],t[4],t[5],r.color,r.fillColor,r.fontFamily,r.fontSize,r.strikeout,r.underline,r.italic,r.fontWeight,r.align)}parsePoly(t){let e=this.lineStyleIndex[t[4]];e||(e=this.defaultLineStyle,console.warn("style not found",t));let r=this.getGroupId(t[1]);this.onPoly(t[1],this.curPart,r,!!t[5],t[2]||[],!!t[3],e.strokeColor,e.strokeStyle,e.fillColor,e.strokeWidth,e.fillStyle)}parseCircle(t){let e=this.lineStyleIndex[t[5]];e||(e=this.defaultLineStyle,console.warn("style not found",t));let r=this.getGroupId(t[1]);this.onCircle(t[1],this.curPart,r,!!t[6],t[2],t[3],t[4],e.strokeColor,e.strokeStyle,e.fillColor,e.strokeWidth,e.fillStyle)}parseArc(t){let e=this.lineStyleIndex[t[8]];e||(e=this.defaultLineStyle,console.warn("style not found",t));let r=this.getGroupId(t[1]);this.onArc(t[1],this.curPart,r,!!t[9],t[2],t[3],t[4],t[5],t[6],t[7],e.strokeColor,e.strokeStyle,e.fillColor,e.strokeWidth,e.fillStyle)}parseBusEntry(t){let e=t[2],r={groupId:this.getGroupId(t[1]),locked:!1,zIndex:++this.zIndex,order:t[3],pointX:t[4],pointY:Sc(t[5]),rotation:t[6]};this.busEntryMap[e]||(this.busEntryMap[e]={}),this.busEntryMap[e][t[1]]=r}parseRect(t){let e=this.lineStyleIndex[t[9]];e||(e=this.defaultLineStyle,console.warn("style not found",t));let r=this.getGroupId(t[1]);this.onRect(t[1],this.curPart,r,!!t[10],t[2],t[3],t[4],t[5],t[6],t[7],t[8],e.strokeColor,e.strokeStyle,e.fillColor,e.strokeWidth,e.fillStyle)}parsePin(t){let e=this.getGroupId(t[1]);this.onPin(t[1],this.curPart,e,!!t[10],!!t[2],t[3],t[4],t[5],t[6],t[7],t[8],this.transPinShape(t[9]))}parseObj(t){let e=this.getGroupId(t[1]);this.version>=1.1?this.onObj(t[1],this.curPart,e,!!t[10],t[2],t[3],t[4],t[5],t[6],t[7],!!t[8],t[9]):this.onObj(t[1],this.curPart,e,!!t[10],t[2],t[4],t[5],t[6],t[7],t[8],!1,`data:${t[3]},${t[9]}`)}parseComponent(t){var n,s,a;let e=this.getGroupId(t[1]),r=t[2],i=this.components[t[1]];if(i){if(i.symbol){let o=this.symbolPartIds[i.symbol];o&&(r=o[t[2]]||t[2]||o[(n=Object.keys(o))==null?void 0:n[0]]||"")}else if(i.device){let o=this.device.find(c=>c.uuid===i.device),l=o?this.symbolPartIds[(s=o==null?void 0:o.attributes)==null?void 0:s.Symbol]:null;l&&(r=l[t[2]]||t[2]||l[(a=Object.keys(l))==null?void 0:a[0]]||"")}}this.onComponent(t[1],!!t[8],r,e,t[3],t[4],t[5],t[6]===1,t[7])}parseEllipse(t){let e=this.lineStyleIndex[t[7]];e||(e=this.defaultLineStyle,console.warn("style not found",t));let r=this.getGroupId(t[1]);this.onEllipse(t[1],this.curPart,r,!!t[8],t[2],t[3],t[4],t[5],t[6],e.strokeColor,e.strokeStyle,e.fillColor,e.strokeWidth,e.fillStyle)}parseTable(t){let e=this.getGroupId(t[1]);this.onTable(t[1],this.curPart,e,t[2],t[3],t[4],t[5],t[6],t[7],t[8],this.tableCell[t[1]]||[])}parseTableCell(t){let e=this.lineStyleIndex[t[8]],r=this.lineStyleIndex[t[9]],i=this.lineStyleIndex[t[10]],n=this.lineStyleIndex[t[11]],s=this.fontStyleIndex[t[12]],a=Object.assign({},s);a.color=s.fillColor,a.fillColor=s.color,(!e||!r||!i||!n||!a)&&console.warn("style not found",t);let o={id:t[1],value:t[3],rowIndex:t[4],columnIndex:t[5],rowSpan:t[6],colSpan:t[7],topStyle:e||this.defaultLineStyle,rightStyle:r||this.defaultLineStyle,bottomStyle:i||this.defaultLineStyle,leftStyle:n||this.defaultLineStyle,fontStyle:this.transTableFontStyle(a||this.defaultFontStyle),lineHeight:t[13],zIndex:++this.zIndex};this.tableCell[t[2]]||(this.tableCell[t[2]]=[]),this.tableCell[t[2]].push(o)}parseAttr(t){let e=this.fontStyleIndex[t[10]];e||(e=this.defaultFontStyle,console.warn("fontStyle not found",t));let r=this.transFontStyle(e),i=this.getGroupId(t[1]);this.onAttr(t[1],this.curPart,i,!!t[11],t[2]||"",this.transPinAttrKey(String(t[3])),t[4],t[5]===null?null:!!t[5],t[6]===null?null:!!t[6],t[7]!==null?t[7]:null,t[8]!==null?t[8]:null,t[9],r.color,r.fillColor,r.fontFamily,r.fontSize,r.strikeout,r.underline,r.italic,r.fontWeight,r.align)}parsePart(t){this.curPart=t[1]||this.defaultPartId,this.onlyPart=this.curPart,this.partIdMap[t[1]]=this.curPart;let e=Object.assign(t[2]||{},{title:t[1]||""});this.onPart(this.curPart,e)}},v0e=class{constructor(){}encodeCanvas(t){return{id:"CANVAS",dataType:"CANVAS",data:JSON.stringify(t)}}encodeGroup(t,e){return{id:t,dataType:"GROUP",data:JSON.stringify(e)}}encodeAuxLine(t,e){return{id:t,dataType:"AUXLINE",data:JSON.stringify(e)}}encodeDimension(t,e){return{id:t,dataType:"DIMENSION",data:JSON.stringify(e)}}encodeString(t,e){return{id:t,dataType:"STRING",data:JSON.stringify(e)}}encodePoly(t,e){return{id:t,dataType:"POLY",data:JSON.stringify(e)}}},IV=class{constructor(){}editHead(t,e){let r={uuid:t.uuid,nickname:t.nickname,username:t.username,updateTime:e};return`${JSON.stringify({type:"EDIT_HEAD"})}${Mf}${JSON.stringify(r)}`}head(t){return T1(this.doctype,t.client,t.doc,t.updateTime,t.version||String(t.updateTime),t.user,t.ticket)}creator(t,e){let r=typeof e=="string"?e:JSON.stringify(e);return Kh("META_CREATE",t,"META_CREATE",r)}modifier(t,e){let r=typeof e=="string"?e:JSON.stringify(e);return Kh("META_MODIFY",t,"META_MODIFY",r)}delete(t,e){let r=e||JSON.stringify({isDelete:!0});return Kh("DELETE_DOC",t,"DELETE_DOC",r)}},aM=class extends IV{constructor(){super(...arguments),this.doctype="BLOB"}buildStr(t,e,r){let i=typeof r=="string"?r:JSON.stringify(this.buildData(r));return Kh("BLOB",t,e,i)}buildData(t){return{filename:t.filename,content:t.content}}};var BV=class{constructor(){}encodeString(t,e){return{id:t,dataType:"STRING",data:JSON.stringify(e)}}encodeAttr(t,e){return{id:t,dataType:"ATTR",data:JSON.stringify(e)}}encodePanelize(t){return{id:"PANELIZE",dataType:"PANELIZE",data:JSON.stringify(t)}}encodeRuleSelector(t){let e=JSON.stringify(["RULE_SELECTOR",t.ruleSelect]),r={...t};return delete r.ruleSelect,{id:e,dataType:"RULE_SELECTOR",data:JSON.stringify(r)}}encodeRule(t){let e=JSON.stringify(["RULE",t.ruleType,t.ruleName]),r={...t};return delete r.ruleType,delete r.ruleName,{id:e,dataType:"RULE",data:JSON.stringify(r)}}encodeRuleTemplate(t){return{id:"RULE_TEMPLATE",dataType:"RULE_TEMPLATE",data:JSON.stringify(t)}}encodeDimension(t,e){return{id:t,dataType:"DIMENSION",data:JSON.stringify(e)}}encodeBoss(t,e){return{id:t,dataType:"BOSS",data:JSON.stringify(e)}}encodeShellEntity(t,e){return{id:t,dataType:"SHELL_ENTITY",data:JSON.stringify(e)}}encodeShellCut(t,e){return{id:t,dataType:"SHELLCUT",data:JSON.stringify(e)}}encodeCrease(t,e){return{id:t,dataType:"CREASE",data:JSON.stringify(e)}}encodeShell(t,e){return{id:t,dataType:"SHELL",data:JSON.stringify(e)}}encodeFpcFill(t,e){return{id:t,dataType:"FPC_FILL",data:JSON.stringify(e)}}encodeTeardrop(t,e){return{id:t,dataType:"TEARDROP",data:JSON.stringify(e)}}encodeImage(t,e){return{id:t,dataType:"IMAGE",data:JSON.stringify(e)}}encodePoured(t,e){return{id:Wh(t,"POURED"),dataType:"POURED",data:JSON.stringify(e)}}encodePour(t,e){return{id:t,dataType:"POUR",data:JSON.stringify(e)}}encodeRegion(t,e){return{id:t,dataType:"REGION",data:JSON.stringify(e)}}encodeFill(t,e){return{id:t,dataType:"FILL",data:JSON.stringify(e)}}encodeLayerFill(t,e){return{id:Wh(t,"LAYER_FILL"),dataType:"LAYER_FILL",data:JSON.stringify(e)}}encodePoly(t,e){return{id:t,dataType:"POLY",data:JSON.stringify(e)}}encodeEQLenGrp(t,e){return{id:t,dataType:"EQLEN_GRP",data:JSON.stringify(e)}}encodeObj(t,e){return{id:t,dataType:"OBJ",data:JSON.stringify(e)}}encodeArc(t,e){return{id:t,dataType:"ARC",data:JSON.stringify(e)}}encodeLine(t,e){return{id:t,dataType:"LINE",data:JSON.stringify(e)}}encodePad(t,e){return{id:t,dataType:"PAD",data:JSON.stringify(e)}}encodeVia(t,e){return{id:t,dataType:"VIA",data:JSON.stringify(e)}}encodePreference(t){return{id:"PREFERENCE",dataType:"PREFERENCE",data:JSON.stringify(t)}}encodeSilkOpts(t,e){return{id:Wh(t,"SILK_OPTS"),dataType:"SILK_OPTS",data:JSON.stringify(e)}}encodeGroup(t,e){return{id:t,dataType:"GROUP",data:JSON.stringify(e)}}encodePrimitive(t,e){return{id:Wh(t,"PRIMITIVE"),dataType:"PRIMITIVE",data:JSON.stringify(e)}}encodeNet(t,e){return{id:Wh(t,"NET"),dataType:"NET",data:JSON.stringify(e)}}encodeActiveLayer(t){return{id:"ACTIVE_LAYER",dataType:"ACTIVE_LAYER",data:JSON.stringify(t)}}encodeLayerPhys(t,e){return{id:Wh(t,"LAYER_PHYS"),dataType:"LAYER_PHYS",data:JSON.stringify(e)}}encodeLayer(t,e){return{id:Wh(t,"LAYER"),dataType:"LAYER",data:JSON.stringify(e)}}encodeCanvas(t){return{id:"CANVAS",dataType:"CANVAS",data:JSON.stringify(t)}}},C0e=class extends $pe{constructor(t=!1){super(void 0,void 0,void 0,void 0,t),this.encode=new BV,this.maxTicket=0,this.blobEncode=new aM,this.blobData=[],this.encodeData=""}handleData(t){this.encodeData?this.encodeData=this.encodeData+No+Kh(t.dataType,++this.maxTicket,t.id,t.data):this.encodeData=Kh(t.dataType,++this.maxTicket,t.id,t.data)}getZIndex(t){let e=t.match(J4);return e!=null&&e.length?e[1]:null}onPHolder(t,e){let r={dataType:t,max:e};this.handleData({id:Vu(),dataType:"ELE_PLACEHOLDER",data:JSON.stringify(r)})}onLayerFill(t,e){this.handleData(this.encode.encodeLayerFill(t,e))}onString(t,e,r,i,n,s,a,o,l,c,u,d,A,h,f,p,m,y,g){let b=this.getZIndex(t);this.handleData(this.encode.encodeString(zn(t),{groupId:r,layerId:i,x:n,y:s,text:a,fontFamily:o,fontSize:l,strokeWidth:c,bold:u,italic:d,origin:A,angle:h,reverse:f,expansion:p,mirror:m,locked:y,zIndex:b===null?null:Number(b),specialColor:g}))}onAttr(t,e,r,i,n,s,a,o,l,c,u,d,A,h,f,p,m,y,g,b,E,w,x,I){let C=this.getZIndex(t);C&&x&&(C=C+"."+String(x)),this.handleData(this.encode.encodeAttr(zn(t),{groupId:r,parentId:i,layerId:n,x:s,y:a,key:o,value:l,keyVisible:c,valueVisible:u,fontFamily:d,fontSize:A,strokeWidth:h,bold:f,italic:p,origin:m,angle:y,reverse:g,expansion:b,mirror:E,locked:w,zIndex:C===null?null:Number(C),specialColor:I}))}onPadNet(t,e,r,i,n){}onComponent(t,e,r,i,n,s,a,o,l){}onPanelize(t,e,r,i,n,s,a,o,l,c){this.handleData(this.encode.encodePanelize({on:t,row:e,column:r,rowSpacing:i,columnSpacing:n,onlyOutline:s,horizontalStamp:a,verticalStamp:o,horizontalSize:l,verticalSize:c}))}onRuleSelector(t,e,r,i,n){this.handleData(this.encode.encodeRuleSelector({ruleSelect:t,ruleOrder:e,ruleKeyValue:r,copperValue:i,innerPlaneValue:n}))}onRule(t,e,r,i){this.handleData(this.encode.encodeRule({ruleType:t,ruleName:e,ruleState:r,ruleContext:i}))}onRuleTemplate(t){this.handleData(this.encode.encodeRuleTemplate({name:t}))}onDimension(t,e,r,i,n,s,a,o,l,c,u,d,A){let h=this.getZIndex(t);this.handleData(this.encode.encodeDimension(zn(t),{type:r,layerId:i,unit:n,strokeWidth:s,precision:a,textFollow:o,coords:l,locked:c,zIndex:h===null?null:Number(h),text:u,specialColor:d,groupId:A}))}onBoss(t,e,r,i,n,s,a,o,l,c,u,d,A){let h=this.getZIndex(t);this.handleData(this.encode.encodeBoss(zn(t),{groupId:r,layerId:i,centerX:n,centerY:s,specification:a,depth:o,thickness:l,holeDiameter:c,counterBore:u?{height:u[0],diameter:u[1]}:null,stiffener:d?{topWidth:d[0],bottomWidth:d[1],height:d[2],stiffThickness:d[3]}:null,locked:A,zIndex:h===null?null:Number(h)}))}onShellEntity(t,e,r,i,n,s,a,o,l,c,u,d){let A=this.getZIndex(t),h={groupId:r,layerId:i,type:n?"ENTITY":"SLOT",depth:o,strokeWidth:l,path:c,locked:u,zIndex:A===null?null:Number(A),refs:d};h.type==="ENTITY"&&(h.entityBelong=s),h.type==="SLOT"&&(h.slotOptions=a),this.handleData(this.encode.encodeShellEntity(zn(t),h))}onShellCut(t,e,r,i,n,s,a,o,l){let c=this.getZIndex(t);this.handleData(this.encode.encodeShellCut(zn(t),{groupId:r,layerId:i,depth:n,strokeWidth:s,path:a,locked:o,zIndex:c===null?null:Number(c),refs:l}))}onCrease(t,e,r,i,n,s,a,o,l,c){let u=this.getZIndex(t);this.handleData(this.encode.encodeCrease(zn(t),{groupId:r,layerId:i,startX:n,startY:s,endX:a,endY:o,angle:l,locked:c,zIndex:u===null?null:Number(u)}))}onShell(t,e,r,i,n,s,a,o,l,c){let u=this.getZIndex(t),d={groupId:r,shellType:i,shellHeight:n,pcbHeight:s,strokeWidth:a,path:o,thickness:l.Thickness,locked:c,zIndex:u===null?null:Number(u)};i==="DRAWER"&&(d.direction=l.Direction),i==="T&B"&&(d.bottomHeight=l.BottomHeight,d.topInnerHeight=l.TopInnerHeight,d.bottomInnerHeight=l.BottomInnerHeight),this.handleData(this.encode.encodeShell(zn(t),d))}onFpcFill(t,e,r,i,n,s,a,o){let l=this.getZIndex(t);this.handleData(this.encode.encodeFpcFill(zn(t),{groupId:r,layerId:i,material:n,thickness:s,path:a,locked:o,zIndex:l===null?null:Number(l)}))}onTeardrop(t,e,r,i,n,s,a){this.handleData(this.encode.encodeTeardrop(zn(t),{netName:r,layerId:i,path:n,groupId:s,refs:a,locked:!1}))}onImage(t,e,r,i,n,s,a,o,l,c,u,d,A){let h=this.getZIndex(t);this.handleData(this.encode.encodeImage(zn(t),{groupId:r,layerId:i,startX:n,startY:s,width:a,height:o,angle:l,mirror:c,path:u,locked:d,zIndex:h===null?null:Number(h),specialColor:A}))}onPoured(t,e){this.handleData(this.encode.encodePoured(zn(t),e))}onPour(t,e,r,i,n,s,a,o,l,c,u,d){let A=this.getZIndex(t);this.handleData(this.encode.encodePour(zn(t),{groupId:r,netName:i,layerId:n,width:s,name:a,order:o,path:l,pourType:c,keepIsland:u,locked:d,zIndex:A===null?null:Number(A)}))}onRegion(t,e,r,i,n,s,a,o,l,c){let u=this.getZIndex(t);this.handleData(this.encode.encodeRegion(zn(t),{groupId:r,layerId:i,width:n,prohibitType:s,path:a,locked:o,zIndex:u===null?null:Number(u),name:l,regionType:c}))}onFill(t,e,r,i,n,s,a,o,l,c,u){let d=this.getZIndex(t);this.handleData(this.encode.encodeFill(zn(t),{groupId:r,netName:i,layerId:n,width:s,fillStyle:a,path:o,locked:l,zIndex:d===null?null:Number(d),isBridgingCopper:!1,networkList:[],refs:c,specialColor:u}))}onPoly(t,e,r,i,n,s,a,o,l){let c=this.getZIndex(t);this.handleData(this.encode.encodePoly(zn(t),{groupId:r,netName:i,layerId:n,width:s,path:a,locked:o,zIndex:c===null?null:Number(c),specialColor:l,polyType:n==11?"BOARD_OUTLINE":"NORMAL"}))}onEQLenGrp(t,e,r,i){this.handleData(this.encode.encodeEQLenGrp(zn(t),{name:e,sort:r,pads:i}))}onObj(t,e,r,i,n,s,a,o,l,c,u,d,A,h){if(d.startsWith("data:")){let p=$D(d);this.blobData.push(this.blobEncode.buildStr(1,p,{filename:n,content:d})),d=`blob:${p}`}let f=this.getZIndex(t);this.handleData(this.encode.encodeObj(zn(t),{groupId:r,layerId:i,fileName:n,startX:s,startY:a,width:o,height:l,angle:c,mirror:u,path:d,locked:A,zIndex:f===null?null:Number(f),specialColor:h}))}onArc(t,e,r,i,n,s,a,o,l,c,u,d,A){let h=this.getZIndex(t);this.handleData(this.encode.encodeArc(zn(t),{groupId:r,netName:i,layerId:n,startX:s,startY:a,endX:o,endY:l,angle:c,width:u,locked:d,zIndex:h===null?null:Number(h),arcType:"DOT",specialColor:A}))}onCArc(t,e,r,i,n,s,a,o,l,c,u,d,A){let h=this.getZIndex(t);this.handleData(this.encode.encodeArc(zn(t),{groupId:r,netName:i,layerId:n,startX:s,startY:a,endX:o,endY:l,angle:c,width:u,locked:d,zIndex:h===null?null:Number(h),arcType:"CENT",specialColor:A}))}onLine(t,e,r,i,n,s,a,o,l,c,u){let d=this.getZIndex(t);this.handleData(this.encode.encodeLine(zn(t),{groupId:r,netName:i,layerId:n,startX:s,startY:a,endX:o,endY:l,width:c,locked:u,zIndex:d===null?null:Number(d)}))}onPad(t,e,r,i,n,s,a,o,l,c,u,d,A,h,f,p,m,y,g,b,E,w,x,I,C,G,U){let _=this.getZIndex(t);this.handleData(this.encode.encodePad(zn(t),{groupId:r,netName:i,layerId:n,num:s,centerX:a,centerY:o,padAngle:l,hole:c,defaultPad:u,specialPad:d,padOffsetX:A,padOffsetY:h,relativeAngle:f,plated:p,padType:m,topSolderExpansion:y,bottomSolderExpansion:g,topPasteExpansion:b,bottomPasteExpansion:E,locked:w,zIndex:_===null?null:Number(_),connectMode:x,spokeSpace:I,spokeWidth:C,spokeAngle:G,unusedInnerLayers:U,padLen:0}))}onVia(t,e,r,i,n,s,a,o,l,c,u,d,A,h){let f=this.getZIndex(t);this.handleData(this.encode.encodeVia(zn(t),{groupId:r,netName:i,ruleName:n,centerX:s,centerY:a,holeDiameter:o,viaDiameter:l,viaType:c,topSolderExpansion:u,bottomSolderExpansion:d,locked:A,zIndex:f===null?null:Number(f),unusedInnerLayers:h}))}onPreference(t,e,r,i,n,s,a,o,l,c,u,d,A,h,f,p,m,y,g,b){this.handleData(this.encode.encodePreference({startTrackWidthFollowLast:t,lastTrackWidth:e,startViaSizeFollowLast:r,lastViaInnerDiameter:i,lastViaDiameter:n,snap:s,routingMode:a,routingCorner:o,removeLoop:l,rotatingObject:c,trackFollow:u,stretchTrackMinCorner:d,preferenceConfig:A,realTimeUpdateUnusedLayers:h,unusedPadRange:f,pushVia:p,pathOptimization4BePushed:m,currentPathOptimization4BePushed:y,removeCircuitsContainingVias:g,removeAntenna:b}))}onSilkOpts(t,e,r){this.handleData(this.encode.encodeSilkOpts(t,{defaultColor:e,baseColor:r}))}onGroup(t,e){this.handleData(this.encode.encodeGroup(t,{groupName:e}))}onPrimitive(t,e,r){this.handleData(this.encode.encodePrimitive(t,{display:e,pick:r}))}onNet(t,e,r,i,n,s,a){this.handleData(this.encode.encodeNet(t,{netType:e,specialColor:r,retLine:i,differentialName:n,isPositiveNet:s,equalLengthGroupName:a}))}onPartition(t,e,r,i){}onActiveLayer(t){this.handleData(this.encode.encodeActiveLayer({layerId:t}))}onLayerPhys(t,e,r,i,n,s,a){this.handleData(this.encode.encodeLayerPhys(t,{material:e,thickness:r,permittivity:i,lossTangent:n,isKeepIsland:s,zIndex:a}))}onLayer(t,e,r,i,n,s,a,o,l,c){this.handleData(this.encode.encodeLayer(t,{layerType:e,layerName:r,use:i,show:n,locked:s,activeColor:a,activateTransparency:o,inactiveColor:l,inactiveTransparency:c}))}onCanvas(t,e,r,i,n,s,a,o,l,c,u,d){this.handleData(this.encode.encodeCanvas({originX:t,originY:e,unit:r,gridXSize:i,gridYSize:n,snapXSize:s,snapYSize:a,altSnapXSize:o,altSnapYSize:l,gridType:c,multiGridType:u,multiGridRatio:d,highlightValue:.5}))}};function S0e(t,e,r,i=new Date().getTime(),n=String(i),s){let a=new C0e(r),o="",l=Vu();if(o=T1("FOOTPRINT",l,t,i,n,s),a.parseFull(e),a.encodeData&&(o=o+No+a.encodeData),a.blobData.length&&(o=o+No+a.blobEncode.head({doc:"BLOB",client:l,updateTime:i,version:n,user:s})+No+a.blobData.join(No)),a.fontCache.length){let c=new D0e,u=c.head({doc:"FONT",client:l,updateTime:i,version:n,user:s});for(let d of a.fontCache){let A=w4(d.text,d.fontFamily,d.fontSize,d.thickness,d.bold,d.italic,d.reverse,d.expansion),h=c.buildStr(1,A,d);u=u+No+h}o=u+No+o}return o}var T0e=class{constructor(){}encodePart(t,e){return{id:t,dataType:"PART",data:JSON.stringify(e)}}encodeCanvas(t){return{id:"CANVAS",dataType:"CANVAS",data:JSON.stringify(t)}}encodeAttr(t,e){return{id:t,dataType:"ATTR",data:JSON.stringify(e)}}encodeTable(t,e){return{id:t,dataType:"TABLE",data:JSON.stringify(e)}}encodeEllipse(t,e){return{id:t,dataType:"ELLIPSE",data:JSON.stringify(e)}}encodeObj(t,e){return{id:t,dataType:"OBJ",data:JSON.stringify(e)}}encodePin(t,e){return{id:t,dataType:"PIN",data:JSON.stringify(e)}}encodeRect(t,e){return{id:t,dataType:"RECT",data:JSON.stringify(e)}}encodeArc(t,e){return{id:t,dataType:"ARC",data:JSON.stringify(e)}}encodeCircle(t,e){return{id:t,dataType:"CIRCLE",data:JSON.stringify(e)}}encodePoly(t,e){return{id:t,dataType:"POLY",data:JSON.stringify(e)}}encodeText(t,e){return{id:t,dataType:"TEXT",data:JSON.stringify(e)}}encodeBezier(t,e){return{id:t,dataType:"BEZIER",data:JSON.stringify(e)}}encodeGroup(t,e){return{id:t,dataType:"GROUP",data:JSON.stringify(e)}}},I0e=class extends w0e{constructor(){super(),this.encode=new T0e,this.maxTicket=0,this.blobEncode=new aM,this.blobData=[],this.encodeData=""}handleData(t){this.encodeData?this.encodeData=this.encodeData+No+Kh(t.dataType,++this.maxTicket,t.id,t.data):this.encodeData=Kh(t.dataType,++this.maxTicket,t.id,t.data)}onPHolder(t,e){let r={dataType:t,max:e};this.handleData({id:Vu(),dataType:"ELE_PLACEHOLDER",data:JSON.stringify(r)})}onPart(t,e){this.handleData(this.encode.encodePart(t,e||{}))}onAttr(t,e,r,i,n,s,a,o,l,c,u,d,A,h,f,p,m,y,g,b,E){this.handleData(this.encode.encodeAttr(zn(t),{partId:e,groupId:r,locked:i,zIndex:this.getZIndex(t),parentId:n,key:s,value:a,keyVisible:o,valueVisible:l,x:c,y:Sc(u),rotation:d,color:A,fillColor:h,fontFamily:f,fontSize:p,strikeout:m,underline:y,italic:g,fontWeight:b,align:E,version:"2.0"}))}onTable(t,e,r,i,n,s,a,o,l,c,u){this.handleData(this.encode.encodeTable(zn(t),{partId:e,groupId:r,startX:i,startY:Sc(n),rowSizes:s,colSizes:a,rowLocked:o,colLocked:l,rotation:c,tableCell:u,zIndex:this.getZIndex(t)}))}onEllipse(t,e,r,i,n,s,a,o,l,c,u,d,A,h){this.handleData(this.encode.encodeEllipse(zn(t),{partId:e,groupId:r,locked:i,zIndex:this.getZIndex(t),centerX:n,centerY:Sc(s),radiusX:a,radiusY:Sc(o),rotation:l,strokeColor:c,strokeStyle:u,fillColor:d,strokeWidth:A,fillStyle:h}))}onComponent(){}onObj(t,e,r,i,n,s,a,o,l,c,u,d){if(d.startsWith("data:")){let A=$D(d);this.blobData.push(this.blobEncode.buildStr(1,A,{filename:"",content:d})),d=`blob:${A}`}this.handleData(this.encode.encodeObj(zn(t),{partId:e,groupId:r,locked:i,zIndex:this.getZIndex(t),fileName:n,startX:s,startY:Sc(a),width:o,height:l,rotation:c,isMirror:u,content:d}))}onPin(t,e,r,i,n,s,a,o,l,c,u,d){this.handleData(this.encode.encodePin(zn(t),{partId:e,groupId:r,locked:i,zIndex:this.getZIndex(t),display:n,x:a,y:Sc(o),length:l,rotation:c,color:u,pinShape:d}))}onRect(t,e,r,i,n,s,a,o,l,c,u,d,A,h,f,p){this.handleData(this.encode.encodeRect(zn(t),{partId:e,groupId:r,locked:i,zIndex:this.getZIndex(t),dotX1:n,dotY1:Sc(s),dotX2:a,dotY2:Sc(o),radiusX:l,radiusY:c,rotation:u,strokeColor:d,strokeStyle:A,fillColor:h,strokeWidth:f,fillStyle:p}))}onArc(t,e,r,i,n,s,a,o,l,c,u,d,A,h,f){this.handleData(this.encode.encodeArc(zn(t),{partId:e,groupId:r,locked:i,zIndex:this.getZIndex(t),startX:n,startY:Sc(s),referX:a,referY:Sc(o),endX:l,endY:Sc(c),strokeColor:u,strokeStyle:d,fillColor:A,strokeWidth:h,fillStyle:f}))}onCircle(t,e,r,i,n,s,a,o,l,c,u,d){this.handleData(this.encode.encodeCircle(zn(t),{partId:e,groupId:r,locked:i,zIndex:this.getZIndex(t),centerX:n,centerY:Sc(s),radius:a,strokeColor:o,strokeStyle:l,fillColor:c,strokeWidth:u,fillStyle:d}))}onPoly(t,e,r,i,n,s,a,o,l,c,u){this.handleData(this.encode.encodePoly(zn(t),{partId:e,groupId:r,locked:i,zIndex:this.getZIndex(t),points:Rfe(n,!0),closed:s,strokeColor:a,strokeStyle:o,fillColor:l,strokeWidth:c,fillStyle:u}))}onText(t,e,r,i,n,s,a,o,l,c,u,d,A,h,f,p,m){this.handleData(this.encode.encodeText(zn(t),{partId:e,groupId:r,locked:i,zIndex:this.getZIndex(t),x:n,y:Sc(s),rotation:a,value:o,color:l,fillColor:c,fontFamily:u,fontSize:d,strikeout:A,underline:h,italic:f,fontWeight:p,align:m,version:"2.0"}))}onCanvas(t){this.handleData(this.encode.encodeCanvas({originX:t.originX,originY:Sc(t.originY)}))}onBezier(t,e,r,i,n,s,a,o,l,c){this.handleData(this.encode.encodeBezier(zn(t),{partId:e,groupId:r,locked:i,zIndex:this.getZIndex(t),controls:n,strokeColor:s,strokeStyle:a,fillColor:o,strokeWidth:l,fillStyle:c}))}onGroup(t,e,r){this.handleData(this.encode.encodeGroup(String(t),{parentId:e,title:r}))}onBus(){}onWire(){}};function B0e(t,e,r=new Date().getTime(),i=String(r),n){let s=new I0e,a="";s.parseFull(e);let o=Vu();s.encodeData&&(a=T1("SYMBOL",o,t,r,i,n)+No+s.encodeData),a&&s.blobData.length&&(a=a+No+s.blobEncode.head({doc:"BLOB",client:o,updateTime:r,version:i,user:n})+No+s.blobData.join(No));let l=s.partIdMap;return s.partIdMap={},{dataStr:a,partIdMap:l}}var D0e=class extends IV{constructor(){super(...arguments),this.doctype="FONT"}buildStr(t,e,r){let i=typeof r=="string"?r:JSON.stringify(this.buildData(r));return Kh("FONT",t,e,i)}buildData(t){return{width:t.width,height:t.height,path:t.path}}};var _0e=class extends E0e{constructor(){super(),this.encode=new v0e,this.maxTicket=0,this.blobEncode=new aM,this.blobData=[],this.encodeData=""}handleData(t){this.encodeData?this.encodeData=this.encodeData+No+Kh(t.dataType,++this.maxTicket,t.id,t.data):this.encodeData=Kh(t.dataType,++this.maxTicket,t.id,t.data)}onPHolder(t,e){let r={dataType:t,max:e};this.handleData({id:Vu(),dataType:"ELE_PLACEHOLDER",data:JSON.stringify(r)})}strokeStyleType(t){switch(t=t&&Number(t),t){case 0:return"SOLID";case 1:return"SHORT_DASH";case 2:return"DOT";case 3:return"DOT_DASH";default:return null}}transScopeType(t){switch(t=t&&Number(t),t){case 1:return"PRINT";case 2:return"COVER";case 3:return"PRINT&COVER";default:return null}}transAlignType(t){switch(t=t&&Number(t),t){case 0:return"LEFT_BOTTOM";case 1:return"CENTER_BOTTOM";case 2:return"RIGHT_BOTTOM";case 3:return"LEFT_MIDDLE";case 4:return"CENTER_MIDDLE";case 5:return"RIGHT_MIDDLE";case 6:return"LEFT_TOP";case 7:return"CENTER_TOP";case 8:return"RIGHT_TOP";default:return null}}onAuxLine(t,e,r,i,n,s,a,o,l,c,u,d,A,h,f,p,m,y,g,b){this.handleData(this.encode.encodeAuxLine(zn(t),{groupId:e?`e${e}`:"",layer:r,x:i,y:n,rotation:s,strokeWidth:a,strokeStyle:this.strokeStyleType(o),color:l,length:c,locked:u,zIndex:this.getZIndex(t),visible:!A,cover:h,name:f}))}onDimension(t,e,r,i,n,s,a,o,l,c,u,d,A,h,f,p,m,y){this.handleData(this.encode.encodeDimension(zn(t),{layer:e,dimensionType:r,unit:i,strokeWidth:n,accuracy:s,controlDot:a,relationIds:o,locked:l,zIndex:this.getZIndex(t),valid:!c,visible:!u,cover:d,name:A,rotation:0}))}onString(t,e,r,i,n,s,a,o,l,c,u,d,A,h,f,p,m,y,g,b,E,w,x,I,C){this.handleData(this.encode.encodeString(zn(t),{groupId:e?`e${e}`:"",layer:r,rotation:i,value:n,fontFamily:s,fontSize:a,fontWeight:o,italic:l,underline:c,strikeout:u,align:this.transAlignType(d),strokeColor:A,opacity:h,locked:f,zIndex:this.getZIndex(t),valid:!p,visible:!m,cover:y,transScope:this.transScopeType(b),transPrint:E,transWhite:w,matrix:x,strokes:I,path:C,name:g}))}onPoly(t,e,r,i,n,s,a,o,l,c,u,d,A,h,f,p,m,y,g,b,E,w){if(typeof o=="string"&&o.startsWith("data:")){let x=$D(o);this.blobData.push(this.blobEncode.buildStr(1,x,{filename:"",content:o})),o=`blob:${x}`}this.handleData(this.encode.encodePoly(zn(t),{groupId:e?`e${e}`:"",layer:r,rotation:i,strokeWidth:n,strokeStyle:this.strokeStyleType(s),strokeColor:a,fillColor:o,opacity:l,autoClose:c,ploys:u,displayFill:d,displayStroke:A,locked:h,zIndex:this.getZIndex(t),valid:!f,visible:!p,cover:m,transScope:this.transScopeType(g),transPrint:b,transWhite:E,matrix:w,name:y}))}onGroup(t,e,r,i,n){this.handleData(this.encode.encodeGroup(`e${t}`,{parentId:e?`e${e}`:"",title:r,visible:i,locked:n}))}onCanvas(t){this.handleData(this.encode.encodeCanvas(t))}};function P0e(t,e,r,i=new Date().getTime(),n=String(i),s){let a=new _0e,o="";a.parseFull(e);let l=Vu();return a.encodeData&&(o=T1(r,l,t,i,n,s)+No+a.encodeData),o&&a.blobData.length&&(o=o+No+a.blobEncode.head({doc:"BLOB",client:l,updateTime:i,version:n,user:s})+No+a.blobData.join(No)),o}var DV=class extends Ppe{constructor(t){let e=t||new qY;super(e,0,Ufe),this.cacheNum=null}onParseLine(t,e,r,i,n,s,a){switch(this.setOrderNum(t,a,e),this.cacheNum=a,e){case"MAX_NUM":if(r)for(let l in r)this.setMaxNum(l,r[l]);break;case"BLOB":r?this.onBlob(t,i,n,r,s):this.onDelBlob(t,i,n,s);break;case"FONT":this.parseFont(t,r,i,n,s);break;case"META":r&&this.parseDetail(r,i,n,s);break;case"ELE_PLACEHOLDER":break;case"CANVAS":r&&this.parseCanvas(r,i,n,s);break;case"BOARD":r?this.parseBoard(r,i,n,s):this.onDelBoard(i,n,s);break;case"LAYER":{let l=T0(t);r?this.parseLayer(l,r,i,n,s):this.onDelLayer(l,i,n,s);break}case"LAYER_PHYS":{let l=T0(t);r?this.parseLayerPhys(l,r,i,n,s):this.onDelLayerPhys(l,i,n,s);break}case"ACTIVE_LAYER":r&&this.parseActiveLayer(t,r,i,n,s);break;case"PARTITION":r?this.parsePartition(t,r,i,n,s):this.onDelPartition(t,i,n,s);break;case"NET":{let l=T0(t);r?this.parseNet(l,r,i,n,s):this.onDelNet(l,i,n,s);break}case"PRIMITIVE":{let l=T0(t);r?this.parsePrimitive(l,r,i,n,s):this.onDelPrimitive(l,i,n,s);break}case"GROUP":r?this.parseGroup(t,r,i,n,s):this.onDelGroup(t,i,n,s);break;case"SILK_OPTS":{let l=T0(t);r?this.parseSilkOpts(l,r,i,n,s):this.onDelSilkOpts(l,i,n,s);break}case"PREFERENCE":r&&this.parsePreference(t,r,i,n,s);break;case"VIA":r?this.parseVia(t,r,i,n,s):this.onDelVia(t,i,n,s);break;case"PAD":r?this.parsePad(t,r,i,n,s):this.onDelPad(t,i,n,s);break;case"LINE":r?this.parseLine(t,r,i,n,s):this.onDelLine(t,i,n,s);break;case"ARC":r?this.parseArc(t,r,i,n,s):this.onDelArc(t,i,n,s);break;case"OBJ":r?this.parseObj(t,r,i,n,s):this.onDelObj(t,i,n,s);break;case"EQLEN_GRP":r?this.parseEQLenGrp(t,r,i,n,s):this.onDelEQLenGrp(t,i,n,s);break;case"POLY":r?this.parsePoly(t,r,i,n,s):this.onDelPoly(t,i,n,s);break;case"FILL":r?this.parseFill(t,r,i,n,s):this.onDelFill(t,i,n,s);break;case"LAYER_FILL":let o=T0(t);r?this.parseLayerFill(o,r,i,n,s):this.onDelLayerFill(o,i,n,s);break;case"REGION":r?this.parseRegion(t,r,i,n,s):this.onDelRegion(t,i,n,s);break;case"POUR":r?this.parsePour(t,r,i,n,s):this.onDelPour(t,i,n,s);break;case"POURED":{t=T0(t),r?this.parsePoured(t,r,i,n,s):this.onDelPoured(t,i,n,s);break}case"IMAGE":r?this.parseImage(t,r,i,n,s):this.onDelImage(t,i,n,s);break;case"TEARDROP":r?this.parseTeardrop(t,r,i,n,s):this.onDelTeardrop(t,i,n,s);break;case"FPC_FILL":r?this.parseFpcFill(t,r,i,n,s):this.onDelFpcFill(t,i,n,s);break;case"SHELL":r?this.parseShell(t,r,i,n,s):this.onDelShell(t,i,n,s);break;case"CREASE":r?this.parseCrease(t,r,i,n,s):this.onDelCrease(t,i,n,s);break;case"SHELLCUT":r?this.parseShellCut(t,r,i,n,s):this.onDelShellCut(t,i,n,s);break;case"SHELL_ENTITY":r?this.parseShellEntity(t,r,i,n,s):this.onDelShellEntity(t,i,n,s);break;case"BOSS":r?this.parseBoss(t,r,i,n,s):this.onDelBoss(t,i,n,s);break;case"STRING":r?this.parseString(t,r,i,n,s):this.onDelString(t,i,n,s);break;case"ATTR":r?this.parseAttr(t,r,i,n,s):this.onDelAttr(t,i,n,s);break;case"DIMENSION":r?this.parseDimension(t,r,i,n,s):this.onDelDimension(t,i,n,s);break;case"COMPONENT":r?this.parseComponent(t,r,i,n,s):this.onDelComponent(t,i,n,s);break;case"PAD_NET":{let l=JSON.parse(t);r?(r.componentId=l[1],r.padNum=l[2],r.padId=l[3],this.parsePadNet(r,i,n,s)):this.onDelPadNet(l[1],l[2],l[3]||"",i,n,s);break}case"RULE_TEMPLATE":r&&this.parseRuleTemplate(t,r,i,n,s);break;case"RULE":{let l=JSON.parse(t);r?(r.ruleType=l[1],r.ruleName=l[2],this.parseRule(r,i,n,s)):this.onDelRule(l[1],l[2],i,n,s);break}case"RULE_SELECTOR":{let l=JSON.parse(t);r?(r.ruleSelect=l[1],this.parseRuleSelector(r,i,n,s)):this.onDelRuleSelector(l[1],i,n,s);break}case"PANELIZE":r?this.parsePanelize(t,r,i,n,s):this.onDelPanelize(i,n,s);break;default:console.warn("can not find hanlder with",r,i,n)}this.cacheNum=null}onOrderNum(t,e,r){switch(this.setOrderNum(t,r,e),e){case"PARTITION":this.onPartitionNum&&this.onPartitionNum(t,r);break;case"VIA":this.onViaNum&&this.onViaNum(t,r);break;case"PAD":this.onPadNum&&this.onPadNum(t,r);break;case"LINE":this.onLineNum&&this.onLineNum(t,r);break;case"ARC":this.onArcNum&&this.onArcNum(t,r);break;case"OBJ":this.onObjNum&&this.onObjNum(t,r);break;case"POLY":this.onPolyNum&&this.onPolyNum(t,r);break;case"FILL":this.onFillNum&&this.onFillNum(t,r);break;case"REGION":this.onRegionNum&&this.onRegionNum(t,r);break;case"POUR":this.onPourNum&&this.onPourNum(t,r);break;case"POURED":let i=T0(t);this.onPouredNum&&this.onPouredNum(i,r);break;case"IMAGE":this.onImageNum&&this.onImageNum(t,r);break;case"TEARDROP":this.onTeardropNum&&this.onTeardropNum(t,r);break;case"FPC_FILL":this.onFpcFillNum&&this.onFpcFillNum(t,r);break;case"SHELL":this.onShellNum&&this.onShellNum(t,r);break;case"CREASE":this.onCreaseNum&&this.onCreaseNum(t,r);break;case"SHELLCUT":this.onShellCutNum&&this.onShellCutNum(t,r);break;case"SHELL_ENTITY":this.onShellEntityNum&&this.onShellEntityNum(t,r);break;case"BOSS":this.onBossNum&&this.onBossNum(t,r);break;case"STRING":this.onStringNum&&this.onStringNum(t,r);break;case"ATTR":this.onAttrNum&&this.onAttrNum(t,r);break;case"DIMENSION":this.onDimensionNum&&this.onDimensionNum(t,r);break;case"COMPONENT":this.onComponentNum&&this.onComponentNum(t,r);break}}onParseEnd(){}parseCanvas(t,e,r,i){this.onCanvas(e,r,t,i)}parseBoard(t,e,r,i){this.onBoard(t,e,r,i)}parseDetail(t,e,r,i){this.onDocDetail(e,r,t,i)}parseFont(t,e,r,i,n){let s=Dpe(t);e?this.onFont(r,i,Object.assign(e,s),n):this.onDelFont(s,r,i,n)}parseLayer(t,e,r,i,n){this.onLayer(t,r,i,e,n)}parseLayerPhys(t,e,r,i,n){this.onLayerPhys(t,r,i,e,n)}parseActiveLayer(t,e,r,i,n){this.onActiveLayer(r,i,e,n)}parsePartition(t,e,r,i,n){this.onPartition(t,this.cacheNum,r,i,e,n)}parseNet(t,e,r,i,n){this.onNet(t,r,i,e,n)}parsePrimitive(t,e,r,i,n){this.onPrimitive(t,r,i,e,n)}parseGroup(t,e,r,i,n){this.onGroup(t,r,i,e,n)}parseSilkOpts(t,e,r,i,n){this.onSilkOpts(t,r,i,e,n)}parsePreference(t,e,r,i,n){this.onPreference(r,i,e,n)}parseVia(t,e,r,i,n){this.onVia(t,this.cacheNum,r,i,e,n)}parsePad(t,e,r,i,n){this.onPad(t,this.cacheNum,r,i,e,n)}parseLine(t,e,r,i,n){this.onLine(t,this.cacheNum,r,i,e,n)}parseArc(t,e,r,i,n){this.onArc(t,this.cacheNum,r,i,e,n)}parseObj(t,e,r,i,n){this.onObj(t,this.cacheNum,r,i,e,n)}parseEQLenGrp(t,e,r,i,n){this.onEQLenGrp(t,r,i,e,n)}parsePoly(t,e,r,i,n){this.onPoly(t,this.cacheNum,r,i,e,n)}parseFill(t,e,r,i,n){e.fillStyle!=="PLANE"&&this.onFill(t,this.cacheNum,r,i,e,n)}parseLayerFill(t,e,r,i,n){this.onLayerFill(t,r,i,e,n)}parseRegion(t,e,r,i,n){this.onRegion(t,this.cacheNum,r,i,e,n)}parsePour(t,e,r,i,n){this.onPour(t,this.cacheNum,r,i,e,n)}parsePoured(t,e,r,i,n){let s=e;Array.isArray(e)&&(s={pourFill:e}),s.pourFill&&this.onPoured(t,this.cacheNum,r,i,s,n)}parseImage(t,e,r,i,n){this.onImage(t,this.cacheNum,r,i,e,n)}parseTeardrop(t,e,r,i,n){this.onTeardrop(t,this.cacheNum,r,i,e,n)}parseFpcFill(t,e,r,i,n){this.onFpcFill(t,this.cacheNum,r,i,e,n)}parseShell(t,e,r,i,n){this.onShell(t,this.cacheNum,r,i,e,n)}parseCrease(t,e,r,i,n){this.onCrease(t,this.cacheNum,r,i,e,n)}parseShellCut(t,e,r,i,n){this.onShellCut(t,this.cacheNum,r,i,e,n)}parseShellEntity(t,e,r,i,n){this.onShellEntity(t,this.cacheNum,r,i,e,n)}parseBoss(t,e,r,i,n){this.onBoss(t,this.cacheNum,r,i,e,n)}parseDimension(t,e,r,i,n){this.onDimension(t,this.cacheNum,r,i,e,n)}parseRuleTemplate(t,e,r,i,n){this.onRuleTemplate(r,i,e,n)}parseRule(t,e,r,i){this.onRule(e,r,t,i)}parseRuleSelector(t,e,r,i){if(t.ruleKeyValue&&(t.ruleKeyValue=e2(t.ruleKeyValue)),t.copperValue&&t.copperValue.hasOwnProperty("7")){let n=t.copperValue[7];delete t.copperValue[7],t.copperValue.COPPER=n}if(t.innerPlaneValue&&t.innerPlaneValue.hasOwnProperty("6")){let n=t.innerPlaneValue[6];delete t.innerPlaneValue[6],t.innerPlaneValue.PLANE=n}this.onRuleSelector(e,r,t,i)}parsePanelize(t,e,r,i,n){this.onPanelize(r,i,e,n)}parseComponent(t,e,r,i,n){this.onComponent(t,this.cacheNum,r,i,e,n)}parsePadNet(t,e,r,i){this.onPadNet(e,r,t,i)}parseAttr(t,e,r,i,n){this.onAttr(t,this.cacheNum,r,i,e,n)}parseString(t,e,r,i,n){this.onString(t,this.cacheNum,r,i,e,n)}};var L0e=(t=>(t.UNIVERSAL="UNIVERSAL",t))(L0e||{}),O0e=(t=>(t.SINGLE="SINGLE",t.MULTIPLE="MULTIPLE",t))(O0e||{}),N0e=(t=>(t.NONE="NONE",t.NAME="NAME",t.NUMBER="NUMBER",t))(N0e||{}),R0e=(t=>(t.NONE="NONE",t.ZONE="ZONE",t))(R0e||{});var M0e=x2(gC());function cC(){return self.EDITOR_TOP||self}function f2(t){return self[t]=self[t]||new M0e.BroadcastChannelMessageBus(t)}var E1=(t,e)=>{let r=/{([^}]*)}/gim,i=[...new Set(t.match(r))];for(let n=0;n<i.length;n++){let s=i[n],a=s.substring(1,s.length-1);e[a]&&(t=t.replace(s,e[a]))}return t};var Zs={getTime:"/pro-mgr/serverTime/now",getUserL:"/pro-ui/loginUser/get",subMaxTick:"/pro-mgr/project/ticket",subBlob:"/pro-mgr/canvas/BLOB/update",subFont:"/pro-mgr/canvas/FONT/update",subRevoke:"/pro-mgr/{uuid}/revoke",pushPend:"/pro-mgr/worker/batchPendData",pushSync:"/pro-mgr/dataWorker/sync",pushRevoke:"/pro-mgr/worker/revoke",pullASync:"/pro-mgr/dataWorker/sync/{id}",personDestroy:"/mgr/libWorker/destroy",projectUpdate:"/pro-mgr/canvas/{uuid}/update",personUpdate:"/mgr/libWorker/component/{uuid}/update",personSave:"/mgr/libWorker/save",projectSave:"/mgr/projectWorker/setCanvas",canSavePend:"/mgr/projectWorker/canSavePend",hasSaveData:"/mgr/check/hasSaveData"},k0e={projectUpdate:Zs.projectUpdate,personUpdate:Zs.personUpdate,projectCanSave:Zs.canSavePend,getProject:"/mgr/projectWorker/footprint/getCanvas",getPerson:"/mgr/libWorker/getFootprint",unwatch:"/mgr/projectWorker/footprint/unwatchCanvas"},F0e={projectUpdate:Zs.projectUpdate,projectCanSave:Zs.canSavePend,getProject:"/mgr/projectWorker/pcb/getCanvas",unwatch:"/mgr/projectWorker/pcb/unwatchCanvas"},B8e={projectUpdate:Zs.projectUpdate,projectCanSave:Zs.canSavePend,getProject:"/mgr/projectWorker/sheet/getCanvas",unwatch:"/mgr/projectWorker/sheet/unwatchCanvas"},D8e={projectUpdate:Zs.projectUpdate,getProject:"/mgr/projectWorker/schematic/getCanvas",unwatch:"/mgr/projectWorker/schematic/unwatchCanvas"},_8e={projectUpdate:Zs.projectUpdate,projectCanSave:Zs.canSavePend,getProject:"/mgr/projectWorker/simulation/getCanvas",unwatch:"/mgr/projectWorker/simulation/unwatchCanvas"},P8e={projectUpdate:Zs.projectUpdate,personUpdate:Zs.personUpdate,projectCanSave:Zs.canSavePend,getProject:"/mgr/projectWorker/symbol/getCanvasOnCompiler",getPerson:"/mgr/libWorker/getSymbol",unwatch:"/mgr/projectWorker/symbol/unwatchCanvas"},L8e={projectUpdate:Zs.projectUpdate,personUpdate:Zs.personUpdate,projectCanSave:Zs.canSavePend,getProject:"/mgr/projectWorker/panel/getCanvas",getPerson:"/mgr/libWorker/getPanelLib",unwatch:"/mgr/projectWorker/panel/unwatchCanvas"};var zh={send:"/pro-mgr/notify/send",sendMsg:"/document/sendMsg/cooperation",unwatch:"/document/unwatch/cooperation",watch:"/document/watch/cooperation",message:"/pro-mgr/notify/message/{path}/{uuid}/cooperation",established:"/pro-mgr/notify/message/ws/established",getWsId:"/pro-mgr/notify/getWsId",disconnect:"/pro-mgr/notify/message/ws/disconnect"},oM=class{constructor(t=!0){this._lockerTicket=0,this.isPull=!1,this.compiler={},this.order={SYMBOL:1,FOOTPRINT:2,DEVICE:3,SCH_PAGE:4,PCB:5},this._locker=t?++this._lockerTicket:0}getOrder(t){return this.order[t]||6}publish(){if(!this.isPull){this.isPull=!0,this._temporaryUnlock=this._locker;try{let t=Object.keys(this.compiler).sort((r,i)=>this.getOrder(r)-this.getOrder(i)),e=!1;for(let r of t){for(let[,i]of this.compiler[r])if(e=i.publish(),e)break;if(e)break}}finally{this._temporaryUnlock=0,this.isPull=!1}}}canPush(){return!this._locker||this._locker===this._temporaryUnlock}addCompiler(t){this.compiler[t.headType]||(this.compiler[t.headType]=new Map),this.compiler[t.headType].set(t.uniqueId,t)}removeCompiler(t){var e,r,i;(i=(r=(e=this.compiler)==null?void 0:e[t.headType])==null?void 0:r.delete)==null||i.call(r,t.uniqueId)}pull(){if(!this._locker)throw Error("\u4E0D\u5141\u8BB8\u5728\u975E pause \u72B6\u6001\u4E0B\u62C9\u53D6\u6570\u636E");this.publish()}resume(){this._locker=0,this.publish()}pause(){this._locker=++this._lockerTicket}dispose(){for(let t in this.compiler)this.compiler[t].clear();this.compiler=null}},B0={publish:"publish",destroy:"destroy",init:"init",selected:"selected"},U0e=class{constructor(t,e,r,i=(a=>(a=cC())==null?void 0:a._TAB_ID_)(),n,s){var o;this.uuid=t,this.path=e,this.user=r,this.windowId=i,this.initIds={},this.sub=[],this.wsBus=s||f2(`/${this.windowId}/notify`),this.dataBus=n||this.wsBus,this._client=(o=cC())==null?void 0:o._WS_ID_}get client(){return this._client}watch(){this.dataBus.publish(zh.send,{topic:zh.watch,uuid:this.uuid,path:this.path})}initPublish(){var t;this.dataBus.publish(zh.send,{topic:zh.sendMsg,uuid:this.uuid,path:this.path,msg:{type:B0.publish,user:this.user,client:this.client,data:((t=this.getSelect)==null?void 0:t.call(this))||""}})}async init(){if(!this.isInit){if(this.sub.push(this.wsBus.subscribe(zh.established,t=>{this._client=t,this.watch(),this.initPublish()})),!this.client){let t=await this.wsBus.rpcCall(zh.getWsId);if(!t||this.client)return;this._client=t}this.watch(),this.sub.push(this.wsBus.subscribe(zh.disconnect,t=>{this.initIds[t]&&this.onDestroy(this.initIds[t],t)})),this.sub.push(this.dataBus.subscribe(E1(zh.message,{uuid:this.uuid,path:this.path}),t=>{if(t.type===1)t.connectId&&this.initIds[t.connectId]&&this.onDestroy(this.initIds[t.connectId],t.connectId);else if(t.msg){let e=t.msg;if(e.client===this.client)return;switch(e.type){case B0.destroy:this.onDestroy(e.userId,e.client),delete this.initIds[e.client];break;case B0.init:this.initIds[e.client]||(this.initIds[e.client]=e.user.uuid,this.onSelected(e.user,e.client,e.data||""));break;case B0.selected:this.onSelected(e.user,e.client,e.data||"");break;case B0.publish:this.dataBus.publish(zh.send,{topic:zh.sendMsg,uuid:this.uuid,path:this.path,msg:{type:B0.init,user:this.user,client:this.client,data:this.getSelect()||""}}),this.initIds[e.client]=e.user.uuid,this.onSelected(e.user,e.client,e.data||"");break;default:break}}})),this.initPublish(),this.isInit=!0}}publishSelected(t,e){this.dataBus.publish(zh.send,{topic:zh.sendMsg,uuid:this.uuid,path:this.path,msg:{type:B0.selected,user:this.user,client:this.client,data:t}}),e&&this.onSelected(this.user,this.client,t)}destroy(){if(this.isInit){this.isInit=!1,this.dataBus.publish(zh.send,{topic:zh.unwatch,uuid:this.uuid,path:this.path,msg:{type:B0.destroy,userId:this.user.uuid,client:this.client}});for(let t of this.sub)t.cancel();this.sub=[],this.initIds={}}}},CY=class extends U0e{constructor(t,e,r,i,n,s,a,o){super(t,e,o,r,n,s),this.channel=i,this.selectedProps=a,this.cache=new Map,this.deleteCache=new Map}rePublish(){var t,e,r,i;if(this.channel.canPush()){for(let[n,s]of this.cache)(e=(t=this.selectedProps)==null?void 0:t.onSelect)==null||e.call(t,s.user,n,s.data);for(let[n,s]of this.deleteCache)(i=(r=this.selectedProps)==null?void 0:r.onQuit)==null||i.call(r,s,n)}}getSelect(){var t,e;return((e=(t=this.selectedProps)==null?void 0:t.getSelect)==null?void 0:e.call(t))||""}onSelected(t,e,r){var i,n;this.channel.canPush()?!this.deleteCache.has(e)&&this.cache.set(e,{user:t,data:r}):(n=(i=this.selectedProps)==null?void 0:i.onSelect)==null||n.call(i,t,e,r)}onDestroy(t,e){var r,i;this.channel.canPush()?(this.deleteCache.set(e,t),this.cache.delete(e)):(i=(r=this.selectedProps)==null?void 0:r.onQuit)==null||i.call(r,t,e)}dispose(){this.destroy(),this.cache.clear(),this.deleteCache.clear()}publishSelected(t,e){super.publishSelected(t,e)}},H0e=x2(gC()),G0e=class{constructor(t,e,r,i=(y=>(y=cC())==null?void 0:y._TAB_ID_)(),n=new oM,s=null,a,o,l,c,u,d,A,h,f,p,m){this.uuid=t,this.path=e,this.isProject=r,this.windowId=i,this.channel=n,this.consistencyManager=s,this.selectedProps=l,this.setInit=c,this.onDocDetail=u,this.onUpdate=d,this.handleInit=A,this.onDelete=h,this.publishCache=f,this.onOrderNm=p,this.setMaxNum=m,this.isInit=!1,this.canSave=!0,this.sub=[],this.isInitIng=!1,this.cache={},this.deleteCache=new Map,this.pendTimer=null,this.pendCache={},this.pendCacheLength=0,this.wsBus=f2(`/${i}/notify`),s||(this._unique=Vu()),this._headType=a,this.busTopic=o}get uniqueId(){return this._unique||this.consistencyManager.getUnique()}get headType(){return this._headType}setIsInitIng(t){var e;(e=this.setInit)==null||e.call(this,t),this.isInitIng=t}consoleDebug(...t){console.debug("[lc-protocol]",this._headType,this.uuid,...t)}publishLine(t,e,r,i,n,s=this.uuid,a,o,l,c,u){if(this.channel.canPush())return this.consistencyManager.remoteChange(e,n,s,t,r,i,void 0,void 0,void 0,a,void 0,o,l,u),!1;this.cache[s]||(this.cache[s]=new Map);let d=this.cache[s].get(t);return(c||!d||d.ticket<e||d.ticket===e&&(d.client<n||d.client===n&&!!d.pend!=!!a))&&this.cache[s].set(t,{client:n,ticket:e,dataType:i,data:r,pend:a,unique:o,pChange:d?void 0:l,num:u}),!0}onDocHead(){}onEnd(){}setDocType(t,e){t===this.uuid&&(this._headType=e)}setBusTopic(t){this.busTopic=t}publish(){var e,r,i;if(this.publishCache)return this.publishCache();let t=!1;for(let[n,s]of this.deleteCache){if(this.channel.canPush()){(e=this.onDelete)==null||e.call(this,s),delete this.cache[n];continue}t=!0;break}if(t)return t;for(let n in this.cache){let s=this.cache[n].keys();for(let a of s){let o=this.cache[n].get(a);if(t=this.publishLine(a,o.ticket,o.data,o.dataType,o.client,n,o.pend,o.unique,o.pChange,!1,o.num),t)break;this.cache[n].delete(a)}if(t)break}return(i=(r=this.selectManager)==null?void 0:r.rePublish)==null||i.call(r),t}publishSelected(t,e){this.selectManager.publishSelected(t,e)}clear(){var t,e;for(let r of this.sub)r.cancel();this.sub.length=0,this.cache={},this.deleteCache.clear(),this.setIsInitIng(!1),this.channel.removeCompiler(this),(e=(t=this.selectManager)==null?void 0:t.dispose)==null||e.call(t),this.selectManager=null,this.isInit=!1,this.setIsInitIng(!1)}async init(t=!0,e=!0,r=!0,i,n,s,a){try{if(this.isInit)return{success:!0};if(this.isInitIng)throw new Error("\u6B63\u5728\u521D\u59CB\u5316\u4E2D");return this.isProject?await this.initProject(t,e,r,i,s,a):await this.initLib(r,i,n,s,a)}catch(o){throw this.clear(),new Error(`${this._headType}+'Compiler' ${this.uuid} init false: ${(o==null?void 0:o.message)||o||""}`,{cause:o})}finally{this.isInitIng=!1}}async flowRead(t){let e=this.consistencyManager.flowParseFull(),r=e.update,i=this;e.update=n=>{if(i.isDestroy)return!0;r(n)},await(0,H0e.flowRead)(t,e)}pushOnLine(t,e){if(this.consistencyManager)for(let r of t)this.publishLine(r[0],r[1],r[2],r[3],r[4],e,r[5],r[6],r[7],!1,r[8])}async initProject(t,e,r,i,n,s){if(this.setIsInitIng(!0),this.channel.addCompiler(this),this.dataBus=f2(`/${this.windowId}/project/${this.path}`),n&&this.sub.push(this.dataBus.subscribe(`/pro-mgr/${this.uuid}/number/update`,l=>{if(this.onOrderNm)for(let c of l)this.onOrderNm(c[0],c[1],c[2])})),r&&this.busTopic.projectUpdate&&this.sub.push(this.dataBus.subscribe(E1(this.busTopic.projectUpdate,{uuid:this.uuid}),l=>{this.onUpdate?this.onUpdate(l):this.pushOnLine(l,this.uuid)})),r&&this.busTopic.projectCanSave&&this.sub.push(this.dataBus.subscribe(this.busTopic.projectCanSave,l=>{this.canSave=l})),r&&this.busTopic.subDelete&&this.sub.push(this.dataBus.subscribe(this.busTopic.subDelete,l=>{var c;this.channel.canPush()?(c=this.onDelete)==null||c.call(this,l):this.deleteCache.set(l[0],l)})),r&&this.consistencyManager&&this.sub.push(this.dataBus.subscribe(Zs.subMaxTick,l=>{this.consistencyManager.setMaxTicket(l.ticket,l.force)})),r&&e&&this.sub.push(this.dataBus.subscribe(Zs.subBlob,l=>{this.pushOnLine(l,"BLOB")})),r&&t&&this.sub.push(this.dataBus.subscribe(Zs.subFont,l=>{this.pushOnLine(l,"FONT")})),r&&this.consistencyManager&&this.sub.push(this.dataBus.subscribe(E1(Zs.subRevoke,{uuid:this.uuid}),l=>this.revoke(l))),!this.busTopic.getProject)throw new Error("\u83B7\u53D6\u6570\u636E\u5931\u8D25\uFF01\uFF01\uFF01");this.isDestroy=!1;let a={doc:[this.uuid],watch:r,needNum:n,needDelete:s};e&&a.doc.push("BLOB"),t&&a.doc.push("FONT");let o=await this.dataBus.rpcCall(this.busTopic.getProject,a);if(this.isWatch=r,!this.isDestroy){if(!o.success)throw new Error("\u83B7\u53D6\u6570\u636E\u5931\u8D25\uFF01\uFF01\uFF01",o);if(this.canSave=!(o!=null&&o.readOnly),this.consoleDebug("init",o.result),o.maxTicket&&this.consistencyManager&&this.consistencyManager.setMaxTicket(o.maxTicket),o.data&&this.onDocDetail&&this.onDocDetail(o.client||Vu(),0,o.data,!1),o.channel&&await this.flowRead(o.channel),!this.isDestroy){if(this.handleInit?this.handleInit(o):o.result&&this.consistencyManager&&this.consistencyManager.parseFull(o.result,this.uuid,this._headType),i){let l=this.user=this.user||o.user||await this.wsBus.rpcCall(Zs.getUserL);this.selectManager=new CY(this.uuid,this.path,this.windowId,this.channel,this.dataBus,this.wsBus,this.selectedProps,l),await this.selectManager.init()}return this.isInit=!0,this.setIsInitIng(!1),{success:!0}}}}async initLib(t,e,r,i,n){if(this.setIsInitIng(!0),this.channel.addCompiler(this),this.dataBus=f2(`/${this.windowId}/libWorker`),!this.busTopic.getPerson)throw new Error("\u83B7\u53D6\u6570\u636E\u5931\u8D25\uFF01\uFF01\uFF01");let s=r?Vu():"";this.isDestroy=!1;let a=await this.dataBus.rpcCall(this.busTopic.getPerson,{uuid:this.uuid,path:this.path,watch:t,channel:s,needNum:i,needDelete:n});if(this.isWatch=t,this.isDestroy)return;if(!a.success)throw new Error("\u83B7\u53D6\u6570\u636E\u5931\u8D25\uFF01\uFF01\uFF01",a);this.consoleDebug("init",a.dataStr);let o=a.data||a.result;if(o&&this.onDocDetail&&this.onDocDetail(a.client||Vu(),0,o,!1),i&&this.sub.push(this.dataBus.subscribe(`/pro-mgr/${this.uuid}/number/update`,l=>{if(this.onOrderNm)for(let c of l)this.onOrderNm(c[0],c[1],c[2])})),t&&this.busTopic.personUpdate&&this.sub.push(this.dataBus.subscribe(E1(this.busTopic.personUpdate,{uuid:this.uuid}),l=>{this.pushOnLine(l,this.uuid)})),t&&this.sub.push(this.dataBus.subscribe(E1(E1(Zs.subRevoke,{uuid:this.uuid}),{uuid:this.uuid}),l=>this.revoke(l))),s&&await this.flowRead(s),!this.isDestroy){if(a.dataStr&&this.consistencyManager&&this.consistencyManager.parseFull(a.dataStr),e){let l=this.user=this.user||a.user||await this.wsBus.rpcCall(Zs.getUserL);this.selectManager=new CY(this.uuid,this.path,this.windowId,this.channel,this.wsBus,this.wsBus,this.selectedProps,l),await this.selectManager.init()}return this.isInit=!0,this.setIsInitIng(!1),{success:!0}}}revoke(t){for(let e of t)this.consistencyManager&&this.consistencyManager.revoke(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],(...r)=>this.publishLine(...r)),e[10]&&this.setMaxNum&&this.setMaxNum(e[6],e[10],e[1])}cachePendData(t,e,r,i,n,s){this.pendCache[t]||(this.pendCache[t]={type:s,pend:[]}),this.pendCache[t].pend.push([e,r,n,i]),this.pendCacheLength+=i.length+1,this.pendCacheLength>1e7&&this.publishPendData(),this.pendTimer||(this.pendTimer=setTimeout(()=>{this.publishPendData(),this.pendTimer=null},0))}publishPendData(){if(this.pendCacheLength){this.dataBus.publish(Zs.pushPend,[this.pendCache,this.consistencyManager.getClient(),this.uniqueId,this.uuid]);for(let t in this.pendCache)this.pendCache[t].pend.length=0;this.pendCache={},this.pendCacheLength=0}}localChange(t,e,r,i=this.uuid,n,s){if(!this.isInit||!this.canSave||!this.consistencyManager)return 0;if(e&&!e.startsWith("{"))return console.error("\u4E0A\u4F20\u7684\u683C\u5F0F\u4E0D\u6B63\u786E",t,r,e),0;let a=this.consistencyManager.localChange(i,t,e,r,n,s);return this.cachePendData(i,t,a,e,r,n||this.headType),a}async sync(){if(!this.isInit)throw new Error("\u6570\u636E\u672A\u521D\u59CB\u5316\uFF0C\u65E0\u6CD5\u540C\u6B65");let t=Vu();this.dataBus.publish(Zs.pushSync,t),await this.dataBus.pullA(E1(Zs.pullASync,{id:t}))}async destroy(){return this.isDestroy?{success:!1}:(this.consistencyManager&&this.dataBus&&this.dataBus.publish(Zs.pushRevoke,[this.uuid,this.uniqueId,this.consistencyManager.getClient()]),this.clear(),this.isDestroy=!0,this.isWatch&&this.dataBus&&!this.isProject&&this.dataBus.publish(Zs.personDestroy,{uuid:this.uuid,path:this.path}),this.isWatch&&this.dataBus&&this.busTopic.unwatch&&this.dataBus.publish(this.busTopic.unwatch,this.uuid),this.isWatch=!1,{success:!0})}async save(t=[this.uuid,"BLOB","FONT"]){try{if(!this.isInit)throw new Error("\u6570\u636E\u672A\u521D\u59CB\u5316\uFF0C\u65E0\u6CD5\u4FDD\u5B58");if(!this.consistencyManager)throw new Error("\u65E0\u6CD5\u652F\u6301\u4FDD\u5B58");let e=this.isProject?Zs.projectSave:Zs.personSave;if(!e)throw new Error("\u65E0\u6CD5\u652F\u6301\u4FDD\u5B58");let r=await this.dataBus.rpcCall(e,{uuid:this.uuid,path:this.path,docIds:t,uniqueId:this.uniqueId,client:this.consistencyManager.getClient()});return this.consoleDebug("save",r),r}catch(e){throw new Error(`${this._headType}+'Compiler' ${this.uuid} \u4FDD\u5B58\u5931\u8D25: ${(e==null?void 0:e.message)||e||""}`,{cause:e})}}async getBlob(t){return this.dataBus.rpcCall("/mgr/projectWorker/blob/getBlob",t)}async getFont(t,e,r,i,n,s,a,o){let l={text:t,fontFamily:e,fontSize:r,thickness:i,bold:n,italic:s,reverse:a,expansion:o},c=await this.dataBus.rpcCall("/mgr/projectWorker/font/get",l);return c.success?{success:!0,result:Object.assign(l,JSON.parse(c.result))}:c}async checkSave(){return await this.dataBus.rpcCall(Zs.hasSaveData,{uuid:this.uuid,uniqueId:this.uniqueId})}};var Y0e=(t=>(t.DIFFERENTIAL_PAIR="DIFFERENTIAL_PAIR",t.NET_CLASS="NET_CLASS",t.EQL_NET_GRP="EQL_NET_GRP",t))(Y0e||{});var V0e=class extends DV{constructor(t){super(t)}onComponent(){}onComponentNum(){}onDelComponent(){}onPadNet(){}onDelPadNet(){}};var O8e=x2(gC());var N8e=x2(gC());var j0e=class extends DV{constructor(t,e,r,i,n,s,a,o=(l=>(l=cC())==null?void 0:l._TAB_ID_)()){let c=new qY(o);super(c),this.encode=s,this.base=new G0e(t,e,r,o,i,c,n,n==="PCB"?F0e:k0e,a,(...u)=>this.setIsInit(...u),(...u)=>this.onDocDetail(...u),void 0,void 0,void 0,void 0,(u,d,A)=>this.onOrderNum(u,d,A),(u,d,A)=>{this.setMaxNum(u,d,!!A),A&&this.deleteOrderNum(A)})}get dataBus(){return this.base.dataBus}set dataBus(t){this.base.dataBus=t}async init(t=!0,e=!0,r=!0,i,n=!0,s){return this.setNeedNum(n),this.base.init(t,e,r,i,!0,n,s)}async sync(){return this.base.sync()}async destroy(){return this.base.destroy()}async save(){return this.base.save()}checkSave(){return this.base.checkSave()}publishSelected(t,e){this.base.publishSelected(t,e)}uploadBlob(t,e){let r=$D(e),i={filename:t,content:e};return{success:!0,ticket:this.localChange({id:r,data:JSON.stringify(i),dataType:"BLOB"},"BLOB","BLOB"),hash:r}}deleteBlob(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"BLOB"},"BLOB","BLOB")}}uploadFont(t){let{text:e,fontFamily:r,fontSize:i,thickness:n,bold:s,italic:a,reverse:o,expansion:l,width:c,height:u,path:d}=t,A={width:c,height:u,path:d},h=w4(e,r,i,n,s,a,o,l);return{success:!0,ticket:this.localChange({id:h,data:JSON.stringify(A),dataType:"FONT"},"FONT","FONT")}}deleteFont(t){let{text:e,fontFamily:r,fontSize:i,thickness:n,bold:s,italic:a,reverse:o,expansion:l}=t,c=w4(e,r,i,n,s,a,o,l);return{success:!0,ticket:this.localChange({id:c,data:"",dataType:"FONT"},"FONT","FONT")}}localChange(t,e=this.base.uuid,r){var n,s;let i=this.getOrderNum(t.id);return(s=(n=this.needOrderType)==null?void 0:n.includes)!=null&&s.call(n,t.dataType)&&i===void 0&&(i=this.getMaxNum(t.dataType),this.setOrderNum(t.id,i,t.dataType),this.onOrderNum(t.id,t.dataType,i)),this.base.localChange(t.id,t.data,t.dataType,e,r,i)}uploadString(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeString(t,e))}}deleteString(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"STRING"})}}uploadAttr(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeAttr(t,e))}}deleteAttr(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"ATTR"})}}uploadPanelize(t){return{success:!0,ticket:this.localChange(this.encode.encodePanelize(t))}}deletePanelize(){return{success:!0,ticket:this.localChange({id:"PANELIZE",data:"",dataType:"PANELIZE"})}}uploadRuleSelector(t){return{success:!0,ticket:this.localChange(this.encode.encodeRuleSelector(t))}}deleteRuleSelector(t){return{success:!0,ticket:this.localChange({id:JSON.stringify(["RULE_SELECTOR",t]),data:"",dataType:"RULE_SELECTOR"})}}uploadRule(t){return{success:!0,ticket:this.localChange(this.encode.encodeRule(t))}}deleteRule(t,e){return{success:!0,ticket:this.localChange({id:JSON.stringify(["RULE",t,e]),data:"",dataType:"RULE"})}}uploadRuleTemplate(t){return{success:!0,ticket:this.localChange(this.encode.encodeRuleTemplate(t))}}uploadDimension(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeDimension(t,e))}}deleteDimension(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"DIMENSION"})}}uploadBoss(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeBoss(t,e))}}deleteBoss(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"BOSS"})}}uploadShellEntity(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeShellEntity(t,e))}}deleteShellEntity(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"SHELL_ENTITY"})}}uploadShellCut(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeShellCut(t,e))}}deleteShellCut(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"SHELLCUT"})}}uploadCrease(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeCrease(t,e))}}deleteCrease(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"CREASE"})}}uploadShell(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeShell(t,e))}}deleteShell(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"SHELL"})}}uploadFpcFill(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeFpcFill(t,e))}}deleteFpcFill(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"FPC_FILL"})}}uploadTeardrop(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeTeardrop(t,e))}}deleteTeardrop(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"TEARDROP"})}}uploadImage(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeImage(t,e))}}deleteImage(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"IMAGE"})}}uploadPoured(t,e){return{success:!0,ticket:this.localChange(this.encode.encodePoured(t,e))}}deletePoured(t){return{success:!0,ticket:this.localChange({id:Wh(t,"POURED"),data:"",dataType:"POURED"})}}uploadPour(t,e){return{success:!0,ticket:this.localChange(this.encode.encodePour(t,e))}}deletePour(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"POUR"})}}uploadRegion(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeRegion(t,e))}}deleteRegion(t){let e=this.localChange({id:t,data:"",dataType:"REGION"});return this.onDelRegion(t,this.consistencyManager.getClient(),e,!0),{success:!0,ticket:e}}uploadFill(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeFill(t,e))}}deleteFill(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"FILL"})}}uploadLayerFill(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeLayerFill(t,e))}}deleteLayerFill(t){return{success:!0,ticket:this.localChange({id:Wh(t,"LAYER_FILL"),data:"",dataType:"LAYER_FILL"})}}uploadPoly(t,e){return{success:!0,ticket:this.localChange(this.encode.encodePoly(t,e))}}deletePoly(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"POLY"})}}uploadEQLenGrp(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeEQLenGrp(t,e))}}deleteEQLenGrp(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"EQLEN_GRP"})}}uploadObj(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeObj(t,e))}}deleteObj(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"OBJ"})}}uploadArc(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeArc(t,e))}}deleteArc(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"ARC"})}}uploadLine(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeLine(t,e))}}deleteLine(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"LINE"})}}uploadPad(t,e){return{success:!0,ticket:this.localChange(this.encode.encodePad(t,e))}}deletePad(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"PAD"})}}uploadVia(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeVia(t,e))}}deleteVia(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"VIA"})}}uploadPreference(t){return{success:!0,ticket:this.localChange(this.encode.encodePreference(t))}}uploadSilkOpts(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeSilkOpts(t,e))}}deleteSilkOpts(t){return{success:!0,ticket:this.localChange({id:Wh(t,"SILK_OPTS"),data:"",dataType:"SILK_OPTS"})}}uploadGroup(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeGroup(t,e))}}deleteGroup(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"GROUP"})}}uploadPrimitive(t,e){return{success:!0,ticket:this.localChange(this.encode.encodePrimitive(t,e))}}deletePrimitive(t){return{success:!0,ticket:this.localChange({id:Wh(t,"PRIMITIVE"),data:"",dataType:"PRIMITIVE"})}}uploadNet(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeNet(t,e))}}deleteNet(t){return{success:!0,ticket:this.localChange({id:Wh(t,"NET"),data:"",dataType:"NET"})}}uploadActiveLayer(t){return{success:!0,ticket:this.localChange(this.encode.encodeActiveLayer(t))}}uploadLayerPhys(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeLayerPhys(t,e))}}deleteLayerPhys(t){return{success:!0,ticket:this.localChange({id:Wh(t,"LAYER_PHYS"),data:"",dataType:"LAYER_PHYS"})}}uploadLayer(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeLayer(t,e))}}deleteLayer(t){return{success:!0,ticket:this.localChange({id:Wh(t,"LAYER"),data:"",dataType:"LAYER"})}}uploadCanvas(t){return{success:!0,ticket:this.localChange(this.encode.encodeCanvas(t))}}uploadBoard(t){return{success:!0,ticket:this.localChange({id:"BOARD",data:JSON.stringify(t),dataType:"BOARD"})}}deleteBoard(){return{success:!0,ticket:this.localChange({id:"BOARD",data:"",dataType:"BOARD"})}}};var _V=class extends j0e{constructor(t,e,r,i,n=(s=>(s=cC())==null?void 0:s._TAB_ID_)()){super(t,e,r,i,"FOOTPRINT",new BV,{getSelect:()=>{var a;return(a=this.canvasSelected)==null?void 0:a.call(this)},onSelect:(...a)=>{var o;return(o=this.onSelectChange)==null?void 0:o.call(this,a[0],a[1],a[2])},onQuit:(...a)=>{var o;return(o=this.onSelectQuit)==null?void 0:o.call(this,a[0],a[1])}},n),this.uuid=t,this.path=e,this.isProject=r,this.windowId=n}onComponent(){}onComponentNum(){}onDelComponent(){}onPadNet(){}onDelPadNet(){}};var Q0e=class extends V0e{constructor(){super(...arguments),this.data={}}onBoard(t,e,r,i){}onDelBoard(t,e,r){}onLayerFill(t,e,r,i,n){}onDelLayerFill(t,e,r,i){}onBlob(t,e,r,i,n){}onDelBlob(t,e,r,i){}onFont(t,e,r,i){}onDelFont(t,e,r,i){}onString(t,e,r,i,n,s){this.data[t]=n}onDelString(t,e,r,i){delete this.data[t]}onStringNum(t,e){}onAttr(t,e,r,i,n,s){this.data[t]=n}onDelAttr(t,e,r,i){delete this.data[t]}onAttrNum(t,e){}onPanelizeSide(t,e,r,i){}onDelPanelizeSide(t,e,r,i){}onPanelizeStamp(t,e,r,i){}onDelPanelizeStamp(t,e,r,i){}onPanelize(t,e,r,i){}onDelPanelize(t,e,r){}onRuleSelector(t,e,r,i){}onDelRuleSelector(t,e,r,i){}onRule(t,e,r,i){}onDelRule(t,e,r,i,n){}onRuleTemplate(t,e,r,i){}onDimension(t,e,r,i,n,s){this.data[t]=n}onDelDimension(t,e,r,i){delete this.data[t]}onDimensionNum(t,e){}onBoss(t,e,r,i,n,s){this.data[t]=n}onDelBoss(t,e,r,i){delete this.data[t]}onBossNum(t,e){}onShellEntity(t,e,r,i,n,s){this.data[t]=n}onDelShellEntity(t,e,r,i){}onShellEntityNum(t,e){}onShellCut(t,e,r,i,n,s){this.data[t]=n}onDelShellCut(t,e,r,i){delete this.data[t]}onShellCutNum(t,e){}onCrease(t,e,r,i,n,s){this.data[t]=n}onDelCrease(t,e,r,i){delete this.data[t]}onCreaseNum(t,e){}onShell(t,e,r,i,n,s){this.data[t]=n}onDelShell(t,e,r,i){delete this.data[t]}onShellNum(t,e){}onFpcFill(t,e,r,i,n,s){this.data[t]=n}onDelFpcFill(t,e,r,i){delete this.data[t]}onFpcFillNum(t,e){}onTeardrop(t,e,r,i,n,s){this.data[t]=n}onDelTeardrop(t,e,r,i){delete this.data[t]}onTeardropNum(t,e){}onImage(t,e,r,i,n,s){this.data[t]=n}onDelImage(t,e,r,i){delete this.data[t]}onImageNum(t,e){}onPoured(t,e,r,i,n,s){this.data[t]=n}onDelPoured(t,e,r,i){delete this.data[t]}onPouredNum(t,e){}onPour(t,e,r,i,n,s){this.data[t]=n}onDelPour(t,e,r,i){delete this.data[t]}onPourNum(t,e){}onRegion(t,e,r,i,n,s){this.data[t]=n}onDelRegion(t,e,r,i){delete this.data[t]}onRegionNum(t,e){}onFill(t,e,r,i,n,s){this.data[t]=n}onDelFill(t,e,r,i){delete this.data[t]}onFillNum(t,e){}onPoly(t,e,r,i,n,s){this.data[t]=n}onDelPoly(t,e,r,i){delete this.data[t]}onPolyNum(t,e){}onEQLenGrp(t,e,r,i,n){this.data[t]=i}onDelEQLenGrp(t,e,r,i){delete this.data[t]}onDelProp(t,e,r,i){delete this.data[t]}onObj(t,e,r,i,n,s){this.data[t]=n}onDelObj(t,e,r,i){delete this.data[t]}onObjNum(t,e){}onArc(t,e,r,i,n,s){this.data[t]=n}onDelArc(t,e,r,i){delete this.data[t]}onArcNum(t,e){}onCArc(t,e,r,i,n,s){this.data[t]=n}onDelCArc(t,e,r,i){delete this.data[t]}onCArcNum(t,e){}onLine(t,e,r,i,n,s){this.data[t]=n}onDelLine(t,e,r,i){delete this.data[t]}onLineNum(t,e){}onPad(t,e,r,i,n,s){this.data[t]=n}onDelPad(t,e,r,i){delete this.data[t]}onPadNum(t,e){}onVia(t,e,r,i,n,s){this.data[t]=n}onDelVia(t,e,r,i){delete this.data[t]}onViaNum(t,e){}onDelConnect(t,e,r,i){}onPreference(t,e,r,i){}onSilkOpts(t,e,r,i,n){this.data[t]=i}onDelSilkOpts(t,e,r,i){delete this.data[t]}onGroup(t,e,r,i,n){this.data[t]=i}onDelGroup(t,e,r,i){delete this.data[t]}onPrimitive(t,e,r,i,n){}onDelPrimitive(t,e,r,i){}onNet(t,e,r,i,n){}onDelNet(t,e,r,i){}onPartition(t,e,r,i,n,s){this.data[t]=n}onDelPartition(t,e,r,i){delete this.data[t]}onPartitionNum(t,e){}onEditorMeta(t,e,r,i){}onDocDetail(t,e,r,i){}onActiveLayer(t,e,r,i){}onLayerPhys(t,e,r,i,n){this.data[t]=i}onDelLayerPhys(t,e,r,i){delete this.data[t]}onLayer(t,e,r,i,n){this.data[t]=i}onDelLayer(t,e,r,i){}onCanvas(t,e,r,i){}},z0e=class extends _V{onBoard(t,e,r,i){}onDelBoard(t,e,r){}onLayerFill(t,e,r,i,n){}onDelLayerFill(t,e,r,i){}constructor(t,e,r,i){super(t,e,r,new oM,i)}canvasSelected(){return""}onSelectChange(t,e,r){}onSelectQuit(t,e){}async getByDataType(t){let e="";if(this.isProject?(this.dataBus=this.dataBus||f2(`/${this.windowId}/project/${this.path}`),e=await this.dataBus.rpcCall("/mgr/projectWorker/getDataByType",{doc:this.uuid,dataType:t})):(this.dataBus=this.dataBus||f2(`/${this.windowId}/libWorker`),e=await this.dataBus.rpcCall("/mgr/libWorker/getDataByType",{uuid:this.uuid,path:this.path,dataType:t,docType:"FOOTPRINT"})),!e)return{};let r=new Q0e;return r.consistencyManager.parseFull(e,this.uuid,"FOOTPRINT"),r.data}async getPads(){return this.getByDataType("PAD")}onBlob(t,e,r,i,n){}onDelBlob(t,e,r,i){}onFont(t,e,r,i){}onDelFont(t,e,r,i){}onString(t,e,r,i,n,s){}onDelString(t,e,r,i){}onStringNum(t,e){}onAttr(t,e,r,i,n,s){}onDelAttr(t,e,r,i){}onAttrNum(t,e){}onPanelizeSide(t,e,r,i){}onDelPanelizeSide(t,e,r,i){}onPanelizeStamp(t,e,r,i){}onDelPanelizeStamp(t,e,r,i){}onPanelize(t,e,r,i){}onDelPanelize(t,e,r){}onRuleSelector(t,e,r,i){}onDelRuleSelector(t,e,r,i){}onRule(t,e,r,i){}onDelRule(t,e,r,i,n){}onRuleTemplate(t,e,r,i){}onDimension(t,e,r,i,n,s){}onDelDimension(t,e,r,i){}onDimensionNum(t,e){}onBoss(t,e,r,i,n,s){}onDelBoss(t,e,r,i){}onBossNum(t,e){}onShellEntity(t,e,r,i,n,s){}onDelShellEntity(t,e,r,i){}onShellEntityNum(t,e){}onShellCut(t,e,r,i,n,s){}onDelShellCut(t,e,r,i){}onShellCutNum(t,e){}onCrease(t,e,r,i,n,s){}onDelCrease(t,e,r,i){}onCreaseNum(t,e){}onShell(t,e,r,i,n,s){}onDelShell(t,e,r,i){}onShellNum(t,e){}onFpcFill(t,e,r,i,n,s){}onDelFpcFill(t,e,r,i){}onFpcFillNum(t,e){}onTeardrop(t,e,r,i,n,s){}onDelTeardrop(t,e,r,i){}onTeardropNum(t,e){}onImage(t,e,r,i,n,s){}onDelImage(t,e,r,i){}onImageNum(t,e){}onPoured(t,e,r,i,n,s){}onDelPoured(t,e,r,i){}onPouredNum(t,e){}onPour(t,e,r,i,n,s){}onDelPour(t,e,r,i){}onPourNum(t,e){}onRegion(t,e,r,i,n,s){}onDelRegion(t,e,r,i){}onRegionNum(t,e){}onFill(t,e,r,i,n,s){}onDelFill(t,e,r,i){}onFillNum(t,e){}onPoly(t,e,r,i,n,s){}onDelPoly(t,e,r,i){}onPolyNum(t,e){}onEQLenGrp(t,e,r,i,n){}onDelEQLenGrp(t,e,r,i){}onDelProp(t,e,r,i){}onObj(t,e,r,i,n,s){}onDelObj(t,e,r,i){}onObjNum(t,e){}onArc(t,e,r,i,n,s){}onDelArc(t,e,r,i){}onArcNum(t,e){}onCArc(t,e,r,i,n,s){}onDelCArc(t,e,r,i){}onCArcNum(t,e){}onLine(t,e,r,i,n,s){}onDelLine(t,e,r,i){}onLineNum(t,e){}onPad(t,e,r,i,n,s){}onDelPad(t,e,r,i){}onPadNum(t,e){}onVia(t,e,r,i,n,s){}onDelVia(t,e,r,i){}onViaNum(t,e){}onDelConnect(t,e,r,i){}onPreference(t,e,r,i){}onSilkOpts(t,e,r,i,n){}onDelSilkOpts(t,e,r,i){}onGroup(t,e,r,i,n){}onDelGroup(t,e,r,i){}onPrimitive(t,e,r,i,n){}onDelPrimitive(t,e,r,i){}onNet(t,e,r,i,n){}onDelNet(t,e,r,i){}onPartition(t,e,r,i,n,s){}onDelPartition(t,e,r,i){}onPartitionNum(t,e){}onEditorMeta(t,e,r,i){}onDocDetail(t,e,r,i){}onActiveLayer(t,e,r,i){}onLayerPhys(t,e,r,i,n){}onDelLayerPhys(t,e,r,i){}onLayer(t,e,r,i,n){}onDelLayer(t,e,r,i){}onCanvas(t,e,r,i){}},PV=(t=>(t.LIST="/pro-mgr/api/project/list",t.CREATE="/pro-mgr/api/project/create",t.GET="/pro-mgr/api/project/get",t.UPDATE="/pro-mgr/api/project/update",t.DELETE="/pro-mgr/api/project/delete",t.TICKET="/pro-mgr/api/project/ticket",t.TICKET1="/pro-mgr/api/project/ticket1",t.BACKUP_LIST="/pro-mgr/api/project/backupList",t.BACKUP="/pro-mgr/api/project/backup",t.GET_BACKUP="/pro-mgr/api/project/getBackup",t.DELETE_BACKUP="/pro-mgr/api/project/deleteBackup",t.ARCHIVE="/pro-mgr/api/project/archive",t.CREATE_BOARD="/pro-mgr/api/project/createBoards",t.STAR="/pro-mgr/api/project/star",t.UNSTAR="/pro-mgr/api/project/unstar",t.GET_PROFILE="/pro-mgr/api/project/getProfile",t))(PV||{}),LV=(t=>(t.LIST="/pro-mgr/api/schematic/list",t.CREATE="/pro-mgr/api/schematic/create",t.UPLOAD="/pro-mgr/api/schematic/upload",t.DELETE="/pro-mgr/api/schematic/delete",t.UPDATE="/pro-mgr/api/schematic/update",t))(LV||{}),OV=(t=>(t.LIST="/pro-mgr/api/document/list",t.SEARCH_LIST="/pro-mgr/api/document/searchList",t.CREATE="/pro-mgr/api/document/create",t.UPLOAD="/pro-mgr/api/document/upload",t.UPDATE="/pro-mgr/api/document/update",t.BATCH_UPDATE="/pro-mgr/api/document/batchUpdate",t.DELETE="/pro-mgr/api/document/delete",t.GET="/pro-mgr/api/document/get",t.GET_BY_SID="/pro-mgr/api/document/getBySid",t.MOVE="/pro-mgr/api/document/move",t.CHECK_IN="/pro-mgr/api/document/checkIn",t.CHECK_OUT="/pro-mgr/api/document/checkOut",t.GET_CHECK="/pro-mgr/api/document/getCheck",t.DELETE_PCB_RELATED="/pro-mgr/api/document/deletePcbRelated",t))(OV||{}),NV=(t=>(t.LIST="/pro-mgr/api/device/list",t.SEARCH_LIST="/pro-mgr/api/device/searchList",t.CREATE="/pro-mgr/api/device/create",t.UPLOAD="/pro-mgr/api/device/upload",t.UPDATE="/pro-mgr/api/device/update",t.BATCH_UPDATE="/pro-mgr/api/device/batchUpdate",t.GET="/pro-mgr/api/device/get",t.SEARCH_BY_USERS_AND_TITLES="/pro-mgr/api/device/searchByUsersAndTitles",t.GET_ATTR_VALUES="/pro-mgr/api/device/getAttributeValues",t.GET_ATTR_KEYS="/pro-mgr/api/device/getAttrKeys",t.DELETE="/pro-mgr/api/device/delete",t.STAR="/pro-mgr/api/device/star",t.UNSTAR="/pro-mgr/api/device/unstar",t.PLACE="/pro-mgr/api/device/place",t))(NV||{}),RV=(t=>(t.LIST="/pro-mgr/api/component/list",t.SEARCH_LIST="/pro-mgr/api/component/searchList",t.CREATE="/pro-mgr/api/component/create",t.UPLOAD="/pro-mgr/api/component/upload",t.UPDATE="/pro-mgr/api/component/update",t.BATCH_UPDATE="/pro-mgr/api/component/batchUpdate",t.DELETE="/pro-mgr/api/component/delete",t.GET="/pro-mgr/api/component/get",t.SEARCH_BY_USERS_AND_TITLES="/pro-mgr/api/component/searchByUsersAndTitles",t.STAR="/pro-mgr/api/component/star",t.UNSTAR="/pro-mgr/api/component/unstar",t.GET_HISTORY="/pro-mgr/api/component/getHistory",t.SET_HISTORY="/pro-mgr/api/component/setHistory",t.GET_HISTORY_DATA="/pro-mgr/api/component/getHistoryData",t))(RV||{}),MV=(t=>(t.LIST="/pro-mgr/api/tag/list",t.CREATE="/pro-mgr/api/tag/create",t.UPDATE="/pro-mgr/api/tag/update",t.DELETE="/pro-mgr/api/tag/delete",t))(MV||{}),kV=(t=>(t.SEARCH_LIST="/pro-mgr/api/copper/searchList",t.SET="/pro-mgr/api/copper/set",t.DELETE="/pro-mgr/api/copper/delete",t))(kV||{}),FV=(t=>(t.SEARCH_LIST="/pro-mgr/api/font/searchList",t.SET="/pro-mgr/api/font/set",t.DELETE="/pro-mgr/api/font/delete",t))(FV||{}),UV=(t=>(t.SEARCH_LIST="/pro-mgr/api/blob/searchList",t.SET="/pro-mgr/api/blob/set",t))(UV||{}),HV=(t=>(t.LIST="/pro-mgr/api/attr/list",t.SEARCH_LIST="/pro-mgr/api/attr/searchList",t.CREATE="/pro-mgr/api/attr/create",t.UPLOAD="/pro-mgr/api/attr/upload",t.DELETE="/pro-mgr/api/attr/delete",t.TICKET="/pro-mgr/api/attr/ticket",t))(HV||{}),GV=(t=>(t.GET_BACKUP="/pro-mgr/api/client/getBackup",t.GET_LIBS="/pro-mgr/api/client/getLibs",t.CREATE_LIB="/pro-mgr/api/client/createLib",t.CREATE_PROJECT="/pro-mgr/api/client/createProject",t.OPEN_PROJECT="/pro-mgr/api/client/openProject",t.CLOSE_PROJECT="/pro-mgr/api/client/closeProject",t.GET_PROJECT_PATHS="/pro-mgr/api/client/getProjectPaths",t.SELECT_PATH="/pro-mgr/api/client/selectPath",t.OPEN_DIALOG="/pro-mgr/api/client/openDialog",t.SELECT_DIR="/pro-mgr/api/client/selectDir",t.SELECT_FILE="/pro-mgr/api/client/selectFile",t.EXPORT_FILE="/pro-mgr/api/client/exportFile",t.CACHE_LIST="/pro-mgr/api/client/cacheList",t.GET_CACHE="/pro-mgr/api/client/getCache",t.SET_CACHE="/pro-mgr/api/client/setCache",t.DELETE_CACHE="/pro-mgr/api/client/deleteCache",t.PROJECT_HISTORY="/pro-mgr/api/client/projectHistory",t.DELETE_HISTORY="/pro-mgr/api/client/deletHistory",t.SET_KV_CACHE="/pro-mgr/api/client/setKVCache",t.GET_KV_CACHE="/pro-mgr/api/client/getKVCache",t.IS_EXIST_KV_CACHE="/pro-mgr/api/client/isExistKVCache",t.OPEN_URL="/pro-mgr/api/client/openURL",t))(GV||{}),YV=(t=>(t.LOG="/pro-mgr/api/other/log",t.COMPONENT_LOG="/pro-mgr/api/other/componentLog",t.TEAMS="/pro-mgr/api/other/teams",t.GET_EDITOR_VERSION="/pro-mgr/api/other/getEditorVersion",t.SET_EDITOR_VERSION="/pro-mgr/api/other/setEditorVersion",t))(YV||{}),hg={PROJECT:PV,SCHEMATIC:LV,DOCUMENT:OV,DEVICE:NV,COMPONENT:RV,TAG:MV,COPPER:kV,FONT:FV,BLOB:UV,ATTR:HV,CLIENT:GV,OTHER:YV},X0e=(t=>(t.GET_DATA_STR="/pro-mgr/public/getDataStr",t))(X0e||{}),hD=AC(fC()),Zv={bus:void 0,get messageBus(){if(Zv.bus===void 0)if(typeof window<"u"){let t=ur();t._MSG_BUS_=t._MSG_BUS_||new hD.MessageBus,Zv.bus=t._MSG_BUS_}else self._WORKER_BUS_=self._WORKER_BUS_||new hD.WorkerMessageBridge(new hD.MessageBus,self),Zv.bus=self._WORKER_BUS_;return Zv.bus},get messageBus2(){return self._MSG_BUS2_=self._MSG_BUS2_||new hD.MessageBus2},loginedUserUuid:void 0},Dr=Zv,q0e=(t=>(t.BOTTOM_COMPONENT_LIB="BOTTOM_COMPONENT_LIB",t.DIALOG="DIALOG",t))(q0e||{}),W0e=["S","F","P","3D"],K0e=["F","3D"],J0e=(t=>(t.ZIP=".zip",t.PRJ=".epro",t.PRJ2=".epro2",t.EPRU=".epru",t.SCH=".esch",t.PCB=".epcb",t.PANEL=".epan",t.PANEL_LIB=".epanl",t.SYMBOL=".esym",t.FOOTPRINT=".efoo",t.INSTANCE=".eins",t.COPPER=".ecop",t.BLOB=".eblob",t.FONT=".efon",t.ELIBZ=".elibz",t.ELIBZ2=".elibz2",t.ELIBU=".elibu",t.IMAGE=".webp",t))(J0e||{}),E2="|",$0e=/^[^|]+(\|[^|]+)?$/,Z0e=(t=>(t.Board="Board",t.Schematic="Schematic",t.Sheet="Sheet",t.Pcb="Pcb",t.Panel="Panel",t.SchCanvas="SchCanvas",t.PcbCanvas="PcbCanvas",t.PanelCanvas="PanelCanvas",t))(Z0e||{}),eye=(t=>(t.Device="Device",t.Symbol="Symbol",t.Footprint="Footprint",t))(eye||{}),SY=[{value:"",text:"All"},{value:2,text:"Component"},{value:20,text:{content:"symbolType",value:"Drawing",options:null}},{value:18,text:"Net Flag"},{value:19,text:"Net Port"},{value:25,text:"Off Page Connector"},{value:31,text:"Differential Pairs Flag"},{value:21,text:{content:"symbolType",value:"Non-Electronic Flag",options:null}},{value:22,text:"Short Flag"}],TY=[{value:"",text:"All"},{value:2,text:"Component Symbol"},{value:20,text:"Drawing Symbol"},{value:18,text:"Netflag Symbol"},{value:19,text:"Netport Symbol"},{value:25,text:"Off Page Connector Symbol"},{value:31,text:"Differential Pairs Flag Symbol"},{value:21,text:"Non-Electronic Symbol"},{value:22,text:"Short Flag"}],tye=["S"],rye=["S"],iye=["S"],nye=["3D"],sye={footprint:K0e,device:W0e,symbol:tye,model3D:nye,panelLib:rye,cbb:iye,modelSimLib:[]};async function aye(t){let e=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(r)).map(i=>i.toString(16).padStart(2,"0")).join("")}var VV=[2,20,18,19,21,22,17,25,31];function HD(t){return t&&VV.indexOf(t)>=0}function jV(t){return VV.indexOf(t)>=0&&t!==17}function oye(t){return t===""?!1:!!(t&&$0e.test(t))}var lye=async t=>{let{keys:e,values:r}=QV(t);return await aye([...e,...r].sort().join(""))},QV=t=>{let e=new Set,r=new Set;for(let i in t){let n=t[i];if(e.add(i),Array.isArray(n))r.add(JSON.stringify(n.sort()));else if(Object.prototype.toString.call(n)==="[object Object]"){let{keys:s,values:a}=QV(n);e=new Set([...e,...s]),r=new Set([...r,...a])}else r.add(JSON.stringify(n))}return{keys:e,values:r}};function IY(t){let{uuid:e,path:r}=t;return e?e+(r?`${E2}${r}`:""):void 0}function cye(t){let{source:e,path:r}=t;return e+(r?`${E2}${r}`:"")}async function g4(t,e){if(e)return e;let{updateTime:r}=t;return r?String(r):await lye(t)}async function uye(t){let{data:e,force:r=!0,defalut:i}=t,{source:n,version:s}=e;n?(oye(n)||(e.source=IY(e)),n.includes(E2)||(e.source=cye(e)),s?s==="1"&&(e.version=await g4(e)):e.version=await g4(e,i)):r&&(e.source=IY(e),e.version=await g4(e,i))}function zV(){let t=navigator.userLanguage||navigator.language;return t&&t.includes("zh")?"zh-cn":"en"}function y4(t){let{tags:e,custom_tags:r="[]"}=t;if((!r||r==="[]")&&e){if(Array.isArray(e)&&e.length)r=JSON.stringify(e);else if(Object.prototype.toString.call(e)==="[object Object]"){let i=zV()==="en",n=[];if(e.parent_tag){let{name:s,name_cn:a}=e.parent_tag;if(i&&s?n.push(s):!i&&a?n.push(a):s&&n.push(s),e.child_tag){let{name:o,name_cn:l}=e.child_tag;i&&o?n.push(o):!i&&l?n.push(l):o&&n.push(o)}}r=JSON.stringify(n)}}return t.custom_tags=r,t.custom_tags}function Ur(t){return String(t).length===13?Number(t):String(t).length===10?Number(t)*1e3:Number(t)}var XV=(t=>t)(XV||{}),qV=(t=>(t.GET="/PrjDB/project/getData",t.UPDATE="/PrjDB/project/updateData",t.COUNT_DOC="/PrjDB/project/countDoc",t.GET_HISTORY_NODE="/PrjDB/project/getHistoricalNodes",t.GET_HISTORY_UPDATETIME="/PrjDB/project/getHistoryUpdatetime",t.GET_HISTORY_PROJECT="/PrjDB/project/getHistoricalProject",t.START_BATCH_UPLOAD="/PrjDB/project/startBatchUpload",t.END_BATCH_UPLOAD="/PrjDB/project/endBatchUpload",t.AWAIT_UPLOAD_END="/PrjDB/project/awaitUploadEnd",t.GET_MAX_TICKET="/PrjDB/project/getMaxTicket",t.SAVE_PEND_DATA="/PrjDB/project/savePendData",t.REVOKE_PEND_DATA="/PrjDB/project/revokePendData",t.GET_CLIENT="/PrjDB/project/getClient",t.HISTORIES="/PrjDB/project/histories",t.COMPRESS="/PrjDB/project/compress",t.FLOW_WRITE="/PrjDB/project/flowWrite",t.GET_RELATED="/PrjDB/project/getRelated",t))(qV||{}),WV=(t=>(t.GET="/PrjDB/config/getData",t.UPDATE="/PrjDB/config/updateData",t))(WV||{}),KV=(t=>(t.GET="/PrjDB/board/getData",t.ADD="/PrjDB/board/addData",t.UPDATE="/PrjDB/board/updateData",t.DELETE="/PrjDB/board/deleteData",t.GET_ALL_KV="/PrjDB/board/getAllKVData",t.GET_ALL_ARR="/PrjDB/board/getAllArrData",t.TRY_RENAME="/PrjDB/board/tryRename",t.IS_RENAME="/PrjDB/board/isRename",t.BATCH_DELETE="/PrjDB/board/batchDelete",t.GET_BIND_KEYS="/PrjDB/board/getBindKeys",t))(KV||{}),JV=(t=>(t.GET="/PrjDB/schematic/getData",t.GET_BY_NAME="/PrjDB/schematic/getDataByName",t.TRY_RENAME="/PrjDB/schematic/tryRename",t.UPDATE_IN_LOCAL="/PrjDB/schematic/updateDataInLocal",t.ADD="/PrjDB/schematic/addData",t.UPDATE="/PrjDB/schematic/updateData",t.DEL="/PrjDB/schematic/delData",t.GET_ALL_KV="/PrjDB/schematic/getAllKVDatas",t.GET_UUID_BY_NAME="/PrjDB/schematic/getIdByName",t.GET_NAME_BY_UUID="/PrjDB/schematic/getNameById",t.GET_DISPLAY_NAME_BY_UUID="/PrjDB/schematic/getDisplayNameById",t.GET_ALL_ARR="/PrjDB/schematic/getAllArrDatas",t.GET_BY_SOURCE_VERSION="/PrjDB/schematic/getDataBySourceAndVersion",t.GET_LAST="/PrjDB/schematic/getLastData",t.GET_ALL_ARR_BY_SOURCE="/PrjDB/schematic/getAllArrDatasBySource",t.IS_RENAME="/PrjDB/schematic/isRename",t.BATCH_DELETE="/PrjDB/schematic/batchDelete",t))(JV||{}),$V=(t=>(t.ADD="/PrjDB/sheet/addData",t.DEL="/PrjDB/sheet/delData",t.UPDATE="/PrjDB/sheet/updateData",t.UPDATE_LOTS="/PrjDB/sheet/updateLotDatas",t.GET_ALL_KV="/PrjDB/sheet/getAllKVDatas",t.GET="/PrjDB/sheet/getData",t.GET_ALL_ARR="/PrjDB/sheet/getAllArrDatas",t.GET_LOTS_ARR="/PrjDB/sheet/getLotsArrDatas",t.GET_CANVAS="/PrjDB/sheet/getCanvas",t.SET_CANVAS="/PrjDB/sheet/setCanvas",t.COVER_CANVAS="/PrjDB/sheet/coverCanvas",t.WATCH_CANVAS_UPDATE="/PrjDB/sheet/watchCanvas",t.UNWATCH_CANVAS_UPDATE="/PrjDB/sheet/unwatchCanvas",t.GET_BY_SOURCE_VERSION="/PrjDB/sheet/getDataBySourceAndVersion",t.GET_LAST="/PrjDB/sheet/getLastData",t.GET_ALL_ARR_BY_SOURCE="/PrjDB/sheet/getAllArrDatasBySource",t.TRY_RENAME="/PrjDB/sheet/tryRename",t.IS_RENAME="/PrjDB/sheet/isRename",t.BATCH_DELETE="/PrjDB/sheet/batchDelete",t.GET_ALL_KEYS="/PrjDB/sheet/getAllPrimaryKeys",t))($V||{}),ZV=(t=>(t.ADD="/PrjDB/simulation/addData",t.DEL="/PrjDB/simulation/delData",t.UPDATE="/PrjDB/simulation/updateData",t.UPDATE_LOTS="/PrjDB/simulation/updateLotDatas",t.GET_ALL_KV="/PrjDB/simulation/getAllKVDatas",t.GET="/PrjDB/simulation/getData",t.GET_ALL_ARR="/PrjDB/simulation/getAllArrDatas",t.GET_LOTS_ARR="/PrjDB/simulation/getLotsArrDatas",t.GET_CANVAS="/PrjDB/simulation/getCanvas",t.SET_CANVAS="/PrjDB/simulation/setCanvas",t.COVER_CANVAS="/PrjDB/simulation/coverCanvas",t.WATCH_CANVAS_UPDATE="/PrjDB/simulation/watchCanvas",t.UNWATCH_CANVAS_UPDATE="/PrjDB/simulation/unwatchCanvas",t.GET_BY_SOURCE_VERSION="/PrjDB/simulation/getDataBySourceAndVersion",t.GET_LAST="/PrjDB/simulation/getLastData",t.GET_ALL_ARR_BY_SOURCE="/PrjDB/simulation/getAllArrDatasBySource",t.TRY_RENAME="/PrjDB/simulation/tryRename",t.IS_RENAME="/PrjDB/simulation/isRename",t.BATCH_DELETE="/PrjDB/simulation/batchDelete",t.GET_ALL_KEYS="/PrjDB/simulation/getAllPrimaryKeys",t))(ZV||{}),ej=(t=>(t.GET="/PrjDB/pcb/getData",t.GET_BY_TITLE="/PrjDB/pcb/getDataByTitle",t.GET_UUID_BY_TITLE="/PrjDB/pcb/getIdByTitle",t.ADD="/PrjDB/pcb/addData",t.DEL="/PrjDB/pcb/delData",t.CREATE_SUB="/PrjDB/pcb/createSub",t.UPDATE_SUB="/PrjDB/pcb/updateSubInherit",t.UPDATE="/PrjDB/pcb/updateData",t.UPDATE_LOTS="/PrjDB/pcb/updateLotDatas",t.GET_ALL_KV="/PrjDB/pcb/getAllKVDatas",t.GET_ALL_ARR="/PrjDB/pcb/getAllArrDatas",t.GET_CANVAS="/PrjDB/pcb/getCanvas",t.SET_CANVAS="/PrjDB/pcb/setCanvas",t.COVER_CANVAS="/PrjDB/pcb/coverCanvas",t.WATCH_CANVAS_UPDATE="/PrjDB/pcb/watchCanvas",t.UNWATCH_CANVAS_UPDATE="/PrjDB/pcb/unwatchCanvas",t.GET_BY_SOURCE_VERSION="/PrjDB/pcb/getDataBySourceAndVersion",t.GET_LAST="/PrjDB/pcb/getLastData",t.GET_ALL_ARR_BY_SOURCE="/PrjDB/pcb/getAllArrDatasBySource",t.TRY_RENAME="/PrjDB/pcb/tryRename",t.IS_RENAME="/PrjDB/pcb/isRename",t.BATCH_DELETE="/PrjDB/pcb/batchDelete",t.GET_ALL_KEYS="/PrjDB/pcb/getAllPrimaryKeys",t))(ej||{}),tj=(t=>(t.GET="/PrjDB/panel/getData",t.ADD="/PrjDB/panel/addData",t.DEL="/PrjDB/panel/delData",t.UPDATE="/PrjDB/panel/updateData",t.UPDATE_LOTS="/PrjDB/panel/updateLotDatas",t.GET_ALL_KV="/PrjDB/panel/getAllKVDatas",t.GET_ALL_ARR="/PrjDB/panel/getAllArrDatas",t.GET_CANVAS="/PrjDB/panel/getCanvas",t.SET_CANVAS="/PrjDB/panel/setCanvas",t.COVER_CANVAS="/PrjDB/panel/coverCanvas",t.WATCH_CANVAS_UPDATE="/PrjDB/panel/watchCanvas",t.UNWATCH_CANVAS_UPDATE="/PrjDB/panel/unwatchCanvas",t.TRY_RENAME="/PrjDB/panel/tryRename",t.IS_RENAME="/PrjDB/panel/isRename",t.BATCH_DELETE="/PrjDB/panel/batchDelete",t.GET_ALL_KEYS="/PrjDB/panel/getAllPrimaryKeys",t))(tj||{}),rj=(t=>(t.GET_BY_TITLE="/PrjDB/symbol/getDataByTitle",t.GET="/PrjDB/symbol/getData",t.ADD="/PrjDB/symbol/addData",t.CLONE="/PrjDB/symbol/cloneData",t.DEL="/PrjDB/symbol/delData",t.UPDATE="/PrjDB/symbol/updateData",t.GET_UUID_BY_TITLE="/PrjDB/symbol/getIdByTitle",t.GET_TITLE_BY_UUID="/PrjDB/symbol/getTitleById",t.GET_ALL_KV="/PrjDB/symbol/getAllKVDatas",t.GET_BY_SOURCE_VERSION="/PrjDB/symbol/getDataBySourceAndVersion",t.GET_COMPARE_TICKET="/PrjDB/symbol/getDataCompareTicket",t.GET_LAST="/PrjDB/symbol/getLastData",t.IS_EXIST="/PrjDB/symbol/isExist",t.GET_ALL_KEYS="/PrjDB/symbol/getAllPrimaryKeys",t.GET_ALL_ARR="/PrjDB/symbol/getAllArrDatas",t.GET_ALL_ARR_BY_SOURCE="/PrjDB/symbol/getAllArrDatasBySource",t.GET_KEYS_BY_SOURCE="/PrjDB/symbol/getKeysBySource",t.GET_ALL_ARR_BY_TYPE="/PrjDB/symbol/getTypeDatas",t.GET_STR="/PrjDB/symbol/getStr",t.GET_CANVAS="/PrjDB/symbol/getCanvas",t.SET_CANVAS="/PrjDB/symbol/setCanvas",t.COVER_CANVAS="/PrjDB/symbol/coverCanvas",t.WATCH_CANVAS_UPDATE="/PrjDB/symbol/watchCanvas",t.UNWATCH_CANVAS_UPDATE="/PrjDB/symbol/unwatchCanvas",t.TRY_RENAME="/PrjDB/symbol/tryRename",t.WITH_ORIGINS="/PrjDB/symbol/withOrigins",t.IS_RENAME="/PrjDB/symbol/isRename",t.IS_CHANGE="/PrjDB/symbol/isChange",t.BATCH_DELETE="/PrjDB/symbol/batchDelete",t.GET_LIST="/PrjDB/symbol/getList",t))(rj||{}),ij=(t=>(t.GET_BY_TITLE="/PrjDB/footprint/getDataByTitle",t.GET="/PrjDB/footprint/getData",t.IS_EXIST="/PrjDB/footprint/isExist",t.ADD="/PrjDB/footprint/addData",t.CLONE="/PrjDB/footprint/cloneData",t.DEL="/PrjDB/footprint/delData",t.GET_ALL_KV="/PrjDB/footprint/getAllKVDatas",t.UPDATE="/PrjDB/footprint/updateData",t.UPDATE_IN_LOCAL="/PrjDB/footprint/updateDataInLocal",t.GET_TITLE_BY_UUID="/PrjDB/footprint/getTitleById",t.GET_BY_SOURCE_VERSION="/PrjDB/footprint/getDataBySourceAndVersion",t.GET_COMPARE_TICKET="/PrjDB/footprint/getDataCompareTicket",t.GET_LAST="/PrjDB/footprint/getLastData",t.GET_ALL_KEYS="/PrjDB/footprint/getAllPrimaryKeys",t.GET_ALL_ARR="/PrjDB/footprint/getAllArrDatas",t.GET_ALL_ARR_BY_SOURCE="/PrjDB/footprint/getAllArrDatasBySource",t.GET_KEYS_BY_SOURCE="/PrjDB/footprint/getKeysBySource",t.GET_ALL_ARR_BY_PCB_UUID="/PrjDB/footprint/getAllArrDatasByPcbId",t.GET_KEYS_BY_PCB_UUID="/PrjDB/footprint/getKeysByPcbId",t.GET_STR="/PrjDB/footprint/getStr",t.GET_CANVAS="/PrjDB/footprint/getCanvas",t.SET_CANVAS="/PrjDB/footprint/setCanvas",t.COVER_CANVAS="/PrjDB/footprint/coverCanvas",t.WATCH_CANVAS_UPDATE="/PrjDB/footprint/watchCanvas",t.UNWATCH_CANVAS_UPDATE="/PrjDB/footprint/unwatchCanvas",t.TRY_RENAME="/PrjDB/footprint/tryRename",t.WITH_ORIGINS="/PrjDB/footprint/withOrigins",t.IS_CHANGE="/PrjDB/footprint/isChange",t.IS_RENAME="/PrjDB/footprint/isRename",t.BATCH_DELETE="/PrjDB/footprint/batchDelete",t.GET_LIST="/PrjDB/footprint/getList",t))(ij||{}),nj=(t=>(t.GET="/PrjDB/device/getData",t.GET_BY_TITLE="/PrjDB/device/getDataByTitle",t.ADD="/PrjDB/device/addData",t.DEL="/PrjDB/device/delData",t.GET_ALL_KV="/PrjDB/device/getAllKVDatas",t.UPDATE="/PrjDB/device/updateData",t.GET_TITLE_BY_UUID="/PrjDB/device/getTitleById",t.GET_SYMBOL_UUID="/PrjDB/device/getSymbolIdById",t.GET_BY_SOURCE_VERSION="/PrjDB/device/getDataBySourceAndVersion",t.GET_LAST="/PrjDB/device/getLastData",t.GET_ALL_ARR_BY_SOURCE="/PrjDB/device/getAllArrDatasBySource",t.GET_KEYS_BY_SOURCE="/PrjDB/device/getKeysBySource",t.GET_COMPARE_TICKET="/PrjDB/device/getDataCompareTicket",t.IS_EXIST="/PrjDB/device/isExist",t.GET_ALL_KEYS="/PrjDB/device/getAllPrimaryKeys",t.GET_ALL_ARR="/PrjDB/device/getAllArrDatas",t.GET_ALL_ARR_BY_SYMBOL_UUID="/PrjDB/device/getAllArrDatasBySymbolId",t.GET_ALL_ARR_BY_FOOTPRINT_UUID="/PrjDB/device/getAllArrDatasByfootprintId",t.TRY_RENAME="/PrjDB/device/tryRename",t.BIND_SYMBOL="/PrjDB/device/bindSymbol",t.BIND_fOOTPRINT="/PrjDB/device/bindFootprint",t.WITH_ORIGINS="/PrjDB/device/withOrigins",t.IS_CHANGE="/PrjDB/device/isChange",t.IS_RENAME="/PrjDB/device/isRename",t.PLACE="/PrjDB/device/place",t.BATCH_DELETE="/PrjDB/device/batchDelete",t.GET_LIST="/PrjDB/device/getList",t))(nj||{}),sj=(t=>(t.GET="/PrjDB/attr/getData",t.UPDATE="/PrjDB/attr/updateData",t.BATCH_UPDATE="/PrjDB/attr/batchUpdateData",t.ADD="/PrjDB/attr/addData",t.DEL="/PrjDB/attr/delData",t.GET_ALL_KV="/PrjDB/attr/getAllKVDatas",t.GET_ALL_ARR="/PrjDB/attr/getAllArrDatas",t.GET_ALL_ARR_BY_HASH="/PrjDB/attr/getAllArrDatasByHash",t.BATCH_DELETE="/PrjDB/attr/batchDelete",t))(sj||{}),aj=(t=>(t.GET="/PrjDB/blob/getData",t.ADD="/PrjDB/blob/addData",t.DEL="/PrjDB/blob/delData",t.GET_ALL_ARR="/PrjDB/blob/getAllArrDatas",t.BATCH_DELETE="/PrjDB/blob/batchDelete",t))(aj||{}),oj=(t=>(t.GET="/PrjDB/copper/getData",t.ADD="/PrjDB/copper/addData",t.DEL_LOTS="/PrjDB/copper/delLotDatas",t.DEL="/PrjDB/copper/delData",t.GET_ALL_KEYS="/PrjDB/copper/getAllPrimaryKeys",t.UPDATE="/PrjDB/copper/updateData",t.GET_ALL_ARR="/PrjDB/copper/getAllArrDatas",t.GET_ALL_ARR_BY_PCB_UUID="/PrjDB/copper/getAllArrDatasByPcbId",t.GET_ALL_KEYS_BY_PCB_UUID="/PrjDB/copper/getAllArrKeysByPcbId",t))(oj||{}),lj=(t=>(t.GET="/PrjDB/font/getData",t.ADD="/PrjDB/font/addData",t.DEL_LOTS="/PrjDB/font/delLotDatas",t.DEL="/PrjDB/font/delData",t.GET_ALL_KEYS="/PrjDB/font/getAllPrimaryKeys",t.UPDATE="/PrjDB/font/updateData",t.GET_ALL_ARR="/PrjDB/font/getAllArrDatas",t.GET_ALL_ARR_BY_PCB_UUID="/PrjDB/font/getAllArrDatasByPcbId",t.GET_ALL_KEYS_BY_PCB_UUID="/PrjDB/font/getAllArrKeysByPcbId",t))(lj||{}),cj=(t=>(t.BATCH_ADD="/PrjDB/variant/batchAddVariant",t.ADD="/PrjDB/variant/addData",t.DELETE="/PrjDB/variant/deleteData",t.BATCH_DELETE="/PrjDB/variant/batchDeleteData",t.BATCH_RESTORE="/PrjDB/variant/batchRestoreData",t.GET="/PrjDB/variant/getData",t.GET_ALL_ARR_BY_SID="/PrjDB/variant/getAllArrDatasBySid",t.UPDATE_TITLE="/PrjDB/variant/updateTitle",t.UPDATE_NOT_GROUPED="/PrjDB/variant/updateNotGrouped",t.BATCH_UPDATE_SORT="/PrjDB/variant/batchUpdateZIndex",t))(cj||{}),uj=(t=>(t.BATCH_ADD="/PrjDB/componentGroup/batchAddData",t.ADD="/PrjDB/componentGroup/addData",t.DELETE="/PrjDB/componentGroup/deleteData",t.BATCH_DELETE="/PrjDB/componentGroup/batchDeleteData",t.BATCH_RESTORE="/PrjDB/componentGroup/batchRestoreData",t.GET="/PrjDB/componentGroup/getData",t.GET_ALL_ARR_BY_SID="/PrjDB/componentGroup/getAllArrDatasBySid",t.GET_ATTR_DATA="/PrjDB/componentGroup/getComponentGroupData",t.UPDATE_TITLE="/PrjDB/componentGroup/updateTitle",t.BATCH_UPDATE_SORT="/PrjDB/componentGroup/batchUpdateZIndex",t.BATCH_UPLOAD_VARIANT_INDEX="/PrjDB/componentGroup/batchUploadGroupSortInVariant",t.BATCH_DELETE_VARIANT_INDEX="/PrjDB/componentGroup/batchDeleteGroupSortInVariant",t.UPLOAD_ATTR_DATA="/PrjDB/componentGroup/uploadComponentGroupData",t.BATCH_DELETE_ATTR_DATA="/PrjDB/componentGroup/batchDeleteComponentGroupData",t))(uj||{}),Yi={VARIANT:cj,COMPONENT_GROUP:uj,COMMON:XV,PROJECT:qV,CONFIG:WV,BOARD:KV,SCHEMATIC:JV,SHEET:$V,SIMULATION:ZV,PCB:ej,PANEL:tj,SYMBOL:rj,FOOTPRINT:ij,DEVICE:nj,ATTR:sj,BLOB:aj,COPPER:oj,FONT:lj},hye=AC(fC());function w2(t){return!t.data}function dye(t){return!!(t.path&&t.uuid&&t.docType&&t.isProject!==void 0&&Object.keys(t).length===4)}async function $p(t){let{origin:e,target:r}=t,i=await UY.getProLibSource(e);if(i.success===!1)return{success:!1,code:i.code,message:i.message};let n=i.result;if(r.isProject)if(r.docType===4){let s=[r.uuid,n,r.version,r.path];return{success:!!(await Dr.messageBus.rpcCall(Yi.FOOTPRINT.COVER_CANVAS,s)).message}}else if(HD(r.docType)){let s=[r.uuid,n,r.version,r.path];return{success:!!(await Dr.messageBus.rpcCall(Yi.SYMBOL.COVER_CANVAS,s)).message}}else throw new Error("Api call error!");else{let s=await UY.getProLibSource(r);if(s.success===!1)return{success:!1,code:s.code,message:s.message};let a=s.result,o=Vu(),l;if(r.docType===4)l=JR(a,n,{docType:tC.FOOTPRINT,uuid:r.uuid,client:o});else if(r.docType===29)l=JR(a,n,{docType:tC.PANEL_LIB,uuid:r.uuid,client:o});else if(HD(r.docType))l=JR(a,n,{docType:tC.SYMBOL,uuid:r.uuid,client:o});else throw new Error("Api call error!");let c={uuid:r.uuid,dataStr:l},{message:u}=await Dr.messageBus.rpcCall(hg.COMPONENT.SET_HISTORY,c);return u.success===!1?{success:!1,code:u.code,message:u.message}:{success:!0}}}function Aye(t){return self[t]=self[t]||new hye.BroadcastChannelMessageBus(t)}var t_=(t=>(t.OPEN="/pro-mgr/project/open",t.CLOSE="/pro-mgr/project/close",t.TEMP_OPEN="/pro-mgr/project/tempOpen",t.TEMP_OPEN_BY_STRING="/pro-mgr/project/tempOpenByString",t.TEMP_CLOSE="/pro-mgr/project/tempClose",t.ON_OPENED="/pro-mgr/project/onOpened",t.ON_TEMP_OPENED="/pro-mgr/project/onTempOpened",t.BEFORE_CLOSE="/pro-mgr/project/beforeClose",t.ON_CLOSED="/pro-mgr/project/onClosed",t.ON_TEMP_CLOSED="/pro-mgr/project/onTempClosed",t.ON_FAILED="/pro-mgr/project/onFailed",t.GET_RECENT_PROJECT_LIST="/pro-mgr/getRecentPrjList",t.UPDATE_PROJECT="/pro-mgr/updateProject",t.DEL_PROJECT="/pro-mgr/deleteProject",t.HAS="/pro-mgr/hasProject",t))(t_||{}),fye=(t=>(t.SYSTEM="system",t.INTERNAL="Internal",t.PERSONAL="personal",t.PROJECT="project",t.STAR="star",t.TEAMS="teams",t.USER="user",t.CLIENT="client",t.PUBLIC="public",t.OSHWHUB="oshwhub",t.EXTEND="extend",t))(fye||{}),pye=(t=>(t.DEVICE="device",t.SYMBOL="symbol",t.FOOTPRINT="footprint",t.CBB="cbb",t.MODEL3D="model3D",t.PANEL_LIB="panelLib",t.MODEL_SIM_LIB="modelSimLib",t))(pye||{}),lM={D3Model:{client3DModelList:"api/client/steps"}},ln,wi=(ln=class{},ln.CANVAS_UNIT_MM="mm",ln.CANVAS_UNIT_MIL="mil",ln.HEX_BLACK_COLOR="#000000",ln.HEX_WHITE_COLOR="#FFFFFF",ln.HEX_RED_COLOR="#FF0000",ln.HEX_GREEN_COLOR="#00FF00",ln.HEX_BLUE_COLOR="#0000FF",ln.HEX_GRAY_COLOR1="#F1F1F1",ln.HEX_GRAY_COLOR2="#EFEFEF",ln.HEX_GRAY_COLOR3="#999999",ln.HEX_GRAY_COLOR4="#666666",ln.HEX_GRAY_COLOR5="#333333",ln.HEX_GRAY_COLOR6="#CCCCCC",ln.DEFAULT_PAGESIZE=50,ln.SYMBOLTYPE_ITEM_ALL_VALUE="@all",ln.SYMBOLTYPE_ITEM_ALL_TITLE="All",ln.D3MVIEW_DEFAULT_TRANSFORM="0, 0, 0, 0, 0, 0, 0, 0, 0",ln.DEVICE_INDEX_TAG="$_",ln.DEVICE_SPLIT_TAG="@_",ln.LIB_SPLIT_TAG="#_",ln.CATEGORY_ITEM_ALL_VALUE="@all",ln.CATEGORY_ITEM_ALL_TITLE="All",ln.FAVORITELIB_UUID="star",ln.SYSTEMLIB_UUID="0819f05c4eef4c71ace90d822a990e87",ln.SYSTEMLIB_UUID_ALIAS="lcsc",ln.USERLIB_ALIAS="mine",ln.PUBLICLIB_ALIAS="user",ln.STD_PUBLIC_LIB_UUID="stdPublic",ln.INTERNAL_LIB_ALIAS="Internal",ln.PERSIONAL_WORKSPACE="Personal",ln.EDU_WORKSPACE="6d84b27f18f540b6a31c4d657314ab13",ln.EDA_TEST_WORKSPACE="407ec92f2a2f4275bf08cbebf64f5e08",ln.LIB_SYSTEM_KEY="system",ln.LIB_PROJECT_KEY="project",ln.LIB_PERSONAL_KEY="personal",ln.LIB_PUBLIC_KEY="public",ln.LIB_INTERNAL_KEY="Internal",ln.LIB_FAVORITE_KEY="favorite",ln.LIB_TEMAS_KEY="teams",ln.API=lM,ln.ERR_CODE={NORMAL:-1,DUP_NAME:-9001},ln),BY={},mye=function(t,e,r,i,n){var s=new Worker(BY[e]||(BY[e]=URL.createObjectURL(new Blob([t+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return s.onmessage=function(a){var o=a.data,l=o.$e$;if(l){var c=new Error(l[0]);c.code=l[1],c.stack=l[2],n(c,null)}else n(null,o)},s.postMessage(r,i),s},os=Uint8Array,wh=Uint16Array,vC=Int32Array,v2=new os([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),C2=new os([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),uC=new os([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),hj=function(t,e){for(var r=new wh(31),i=0;i<31;++i)r[i]=e+=1<<t[i-1];for(var n=new vC(r[30]),i=1;i<30;++i)for(var s=r[i];s<r[i+1];++s)n[s]=s-r[i]<<5|i;return{b:r,r:n}},dj=hj(v2,2),cM=dj.b,GD=dj.r;cM[28]=258,GD[258]=28;var Aj=hj(C2,0),fj=Aj.b,R4=Aj.r,hC=new wh(32768);for(Ka=0;Ka<32768;++Ka)Zm=(Ka&43690)>>1|(Ka&21845)<<1,Zm=(Zm&52428)>>2|(Zm&13107)<<2,Zm=(Zm&61680)>>4|(Zm&3855)<<4,hC[Ka]=((Zm&65280)>>8|(Zm&255)<<8)>>1;var BA=function(t,e,r){for(var i=t.length,n=0,s=new wh(e);n<i;++n)t[n]&&++s[t[n]-1];var a=new wh(e);for(n=1;n<e;++n)a[n]=a[n-1]+s[n-1]<<1;var o;if(r){o=new wh(1<<e);var l=15-e;for(n=0;n<i;++n)if(t[n])for(var c=n<<4|t[n],u=e-t[n],d=a[t[n]-1]++<<u,A=d|(1<<u)-1;d<=A;++d)o[hC[d]>>l]=c}else for(o=new wh(i),n=0;n<i;++n)t[n]&&(o[n]=hC[a[t[n]-1]++]>>15-t[n]);return o},dg=new os(288);for(Ka=0;Ka<144;++Ka)dg[Ka]=8;for(Ka=144;Ka<256;++Ka)dg[Ka]=9;for(Ka=256;Ka<280;++Ka)dg[Ka]=7;for(Ka=280;Ka<288;++Ka)dg[Ka]=8;var b2=new os(32);for(Ka=0;Ka<32;++Ka)b2[Ka]=5;var pj=BA(dg,9,0),mj=BA(dg,9,1),gj=BA(b2,5,0),yj=BA(b2,5,1),wD=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},SA=function(t,e,r){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(e&7)&r},vD=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},S2=function(t){return(t+7)/8|0},Kp=function(t,e,r){return(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length),new os(t.subarray(e,r))};var bj=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],wn=function(t,e,r){var i=new Error(e||bj[t]);if(i.code=t,Error.captureStackTrace&&Error.captureStackTrace(i,wn),!r)throw i;return i},r_=function(t,e,r,i){var n=t.length,s=i?i.length:0;if(!n||e.f&&!e.l)return r||new os(0);var a=!r,o=a||e.i!=2,l=e.i;a&&(r=new os(n*3));var c=function(rt){var qe=r.length;if(rt>qe){var xt=new os(Math.max(qe*2,rt));xt.set(r),r=xt}},u=e.f||0,d=e.p||0,A=e.b||0,h=e.l,f=e.d,p=e.m,m=e.n,y=n*8;do{if(!h){u=SA(t,d,1);var g=SA(t,d+1,3);if(d+=3,g)if(g==1)h=mj,f=yj,p=9,m=5;else if(g==2){var b=SA(t,d,31)+257,E=SA(t,d+10,15)+4,w=b+SA(t,d+5,31)+1;d+=14;for(var x=new os(w),I=new os(19),C=0;C<E;++C)I[uC[C]]=SA(t,d+C*3,7);d+=E*3;for(var G=wD(I),U=(1<<G)-1,_=BA(I,G,1),C=0;C<w;){var H=_[SA(t,d,U)];d+=H&15;var Q=H>>4;if(Q<16)x[C++]=Q;else{var j=0,$=0;for(Q==16?($=3+SA(t,d,3),d+=2,j=x[C-1]):Q==17?($=3+SA(t,d,7),d+=3):Q==18&&($=11+SA(t,d,127),d+=7);$--;)x[C++]=j}}var B=x.subarray(0,b),M=x.subarray(b);p=wD(B),m=wD(M),h=BA(B,p,1),f=BA(M,m,1)}else wn(1);else{var Q=S2(d)+4,v=t[Q-4]|t[Q-3]<<8,N=Q+v;if(N>n){l&&wn(0);break}o&&c(A+v),r.set(t.subarray(Q,N),A),e.b=A+=v,e.p=d=N*8,e.f=u;continue}if(d>y){l&&wn(0);break}}o&&c(A+131072);for(var R=(1<<p)-1,q=(1<<m)-1,P=d;;P=d){var j=h[vD(t,d)&R],z=j>>4;if(d+=j&15,d>y){l&&wn(0);break}if(j||wn(2),z<256)r[A++]=z;else if(z==256){P=d,h=null;break}else{var W=z-254;if(z>264){var C=z-257,oe=v2[C];W=SA(t,d,(1<<oe)-1)+cM[C],d+=oe}var Ae=f[vD(t,d)&q],me=Ae>>4;Ae||wn(3),d+=Ae&15;var M=fj[me];if(me>3){var oe=C2[me];M+=vD(t,d)&(1<<oe)-1,d+=oe}if(d>y){l&&wn(0);break}o&&c(A+131072);var ve=A+W;if(A<M){var Le=s-M,He=Math.min(M,ve);for(Le+A<0&&wn(3);A<He;++A)r[A]=i[Le+A]}for(;A<ve;++A)r[A]=r[A-M]}}e.l=h,e.p=P,e.b=A,e.f=u,h&&(u=1,e.m=p,e.d=f,e.n=m)}while(!u);return A!=r.length&&a?Kp(r,0,A):r.subarray(0,A)},Vp=function(t,e,r){r<<=e&7;var i=e/8|0;t[i]|=r,t[i+1]|=r>>8},n2=function(t,e,r){r<<=e&7;var i=e/8|0;t[i]|=r,t[i+1]|=r>>8,t[i+2]|=r>>16},CD=function(t,e){for(var r=[],i=0;i<t.length;++i)t[i]&&r.push({s:i,f:t[i]});var n=r.length,s=r.slice();if(!n)return{t:L0,l:0};if(n==1){var a=new os(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort(function(w,x){return w.f-x.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],c=0,u=1,d=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=n-1;)o=r[r[c].f<r[d].f?c++:d++],l=r[c!=u&&r[c].f<r[d].f?c++:d++],r[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var A=s[0].s,i=1;i<n;++i)s[i].s>A&&(A=s[i].s);var h=new wh(A+1),f=YD(r[u-1],h,0);if(f>e){var i=0,p=0,m=f-e,y=1<<m;for(s.sort(function(x,I){return h[I.s]-h[x.s]||x.f-I.f});i<n;++i){var g=s[i].s;if(h[g]>e)p+=y-(1<<f-h[g]),h[g]=e;else break}for(p>>=m;p>0;){var b=s[i].s;h[b]<e?p-=1<<e-h[b]++-1:++i}for(;i>=0&&p;--i){var E=s[i].s;h[E]==e&&(--h[E],++p)}f=e}return{t:new os(h),l:f}},YD=function(t,e,r){return t.s==-1?Math.max(YD(t.l,e,r+1),YD(t.r,e,r+1)):e[t.s]=r},M4=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new wh(++e),i=0,n=t[0],s=1,a=function(l){r[i++]=l},o=1;o<=e;++o)if(t[o]==n&&o!=e)++s;else{if(!n&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(n),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(n);s=1,n=t[o]}return{c:r.subarray(0,i),n:e}},s2=function(t,e){for(var r=0,i=0;i<e.length;++i)r+=t[i]*e[i];return r},uM=function(t,e,r){var i=r.length,n=S2(e+2);t[n]=i&255,t[n+1]=i>>8,t[n+2]=t[n]^255,t[n+3]=t[n+1]^255;for(var s=0;s<i;++s)t[n+s+4]=r[s];return(n+4+i)*8},k4=function(t,e,r,i,n,s,a,o,l,c,u){Vp(e,u++,r),++n[256];for(var d=CD(n,15),A=d.t,h=d.l,f=CD(s,15),p=f.t,m=f.l,y=M4(A),g=y.c,b=y.n,E=M4(p),w=E.c,x=E.n,I=new wh(19),C=0;C<g.length;++C)++I[g[C]&31];for(var C=0;C<w.length;++C)++I[w[C]&31];for(var G=CD(I,7),U=G.t,_=G.l,H=19;H>4&&!U[uC[H-1]];--H);var Q=c+5<<3,j=s2(n,dg)+s2(s,b2)+a,$=s2(n,A)+s2(s,p)+a+14+3*H+s2(I,U)+2*I[16]+3*I[17]+7*I[18];if(l>=0&&Q<=j&&Q<=$)return uM(e,u,t.subarray(l,l+c));var B,M,v,N;if(Vp(e,u,1+($<j)),u+=2,$<j){B=BA(A,h,0),M=A,v=BA(p,m,0),N=p;var R=BA(U,_,0);Vp(e,u,b-257),Vp(e,u+5,x-1),Vp(e,u+10,H-4),u+=14;for(var C=0;C<H;++C)Vp(e,u+3*C,U[uC[C]]);u+=3*H;for(var q=[g,w],P=0;P<2;++P)for(var z=q[P],C=0;C<z.length;++C){var W=z[C]&31;Vp(e,u,R[W]),u+=U[W],W>15&&(Vp(e,u,z[C]>>5&127),u+=z[C]>>12)}}else B=pj,M=dg,v=gj,N=b2;for(var C=0;C<o;++C){var oe=i[C];if(oe>255){var W=oe>>18&31;n2(e,u,B[W+257]),u+=M[W+257],W>7&&(Vp(e,u,oe>>23&31),u+=v2[W]);var Ae=oe&31;n2(e,u,v[Ae]),u+=N[Ae],Ae>3&&(n2(e,u,oe>>5&8191),u+=C2[Ae])}else n2(e,u,B[oe]),u+=M[oe]}return n2(e,u,B[256]),u+M[256]},xj=new vC([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),L0=new os(0),Ej=function(t,e,r,i,n,s){var a=s.z||t.length,o=new os(i+a+5*(1+Math.ceil(a/7e3))+n),l=o.subarray(i,o.length-n),c=s.l,u=(s.r||0)&7;if(e){u&&(l[0]=s.r>>3);for(var d=xj[e-1],A=d>>13,h=d&8191,f=(1<<r)-1,p=s.p||new wh(32768),m=s.h||new wh(f+1),y=Math.ceil(r/3),g=2*y,b=function(Gt){return(t[Gt]^t[Gt+1]<<y^t[Gt+2]<<g)&f},E=new vC(25e3),w=new wh(288),x=new wh(32),I=0,C=0,G=s.i||0,U=0,_=s.w||0,H=0;G+2<a;++G){var Q=b(G),j=G&32767,$=m[Q];if(p[j]=$,m[Q]=j,_<=G){var B=a-G;if((I>7e3||U>24576)&&(B>423||!c)){u=k4(t,l,0,E,w,x,C,U,H,G-H,u),U=I=C=0,H=G;for(var M=0;M<286;++M)w[M]=0;for(var M=0;M<30;++M)x[M]=0}var v=2,N=0,R=h,q=j-$&32767;if(B>2&&Q==b(G-q))for(var P=Math.min(A,B)-1,z=Math.min(32767,G),W=Math.min(258,B);q<=z&&--R&&j!=$;){if(t[G+v]==t[G+v-q]){for(var oe=0;oe<W&&t[G+oe]==t[G+oe-q];++oe);if(oe>v){if(v=oe,N=q,oe>P)break;for(var Ae=Math.min(q,oe-2),me=0,M=0;M<Ae;++M){var ve=G-q+M&32767,Le=p[ve],He=ve-Le&32767;He>me&&(me=He,$=ve)}}}j=$,$=p[j],q+=j-$&32767}if(N){E[U++]=268435456|GD[v]<<18|R4[N];var rt=GD[v]&31,qe=R4[N]&31;C+=v2[rt]+C2[qe],++w[257+rt],++x[qe],_=G+v,++I}else E[U++]=t[G],++w[t[G]]}}for(G=Math.max(G,_);G<a;++G)E[U++]=t[G],++w[t[G]];u=k4(t,l,c,E,w,x,C,U,H,G-H,u),c||(s.r=u&7|l[u/8|0]<<3,u-=7,s.h=m,s.p=p,s.i=G,s.w=_)}else{for(var G=s.w||0;G<a+c;G+=65535){var xt=G+65535;xt>=a&&(l[u/8|0]=c,xt=a),u=uM(l,u+1,t.subarray(G,xt))}s.i=a}return Kp(o,0,i+S2(u)+n)},gye=(function(){for(var t=new Int32Array(256),e=0;e<256;++e){for(var r=e,i=9;--i;)r=(r&1&&-306674912)^r>>>1;t[e]=r}return t})(),hM=function(){var t=-1;return{p:function(e){for(var r=t,i=0;i<e.length;++i)r=gye[r&255^e[i]]^r>>>8;t=r},d:function(){return~t}}},wj=function(){var t=1,e=0;return{p:function(r){for(var i=t,n=e,s=r.length|0,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)n+=i+=r[a];i=(i&65535)+15*(i>>16),n=(n&65535)+15*(n>>16)}t=i,e=n},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},T2=function(t,e,r,i,n){if(!n&&(n={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),a=new os(s.length+t.length);a.set(s),a.set(t,s.length),t=a,n.w=s.length}return Ej(t,e.level==null?6:e.level,e.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,i,n)},vj=function(t,e){var r={};for(var i in t)r[i]=t[i];for(var i in e)r[i]=e[i];return r},DY=function(t,e,r){for(var i=t(),n=t.toString(),s=n.slice(n.indexOf("[")+1,n.lastIndexOf("]")).replace(/\s+/g,"").split(","),a=0;a<i.length;++a){var o=i[a],l=s[a];if(typeof o=="function"){e+=";"+l+"=";var c=o.toString();if(o.prototype)if(c.indexOf("[native code]")!=-1){var u=c.indexOf(" ",8)+1;e+=c.slice(u,c.indexOf("(",u))}else{e+=c;for(var d in o.prototype)e+=";"+l+".prototype."+d+"="+o.prototype[d].toString()}else e+=c}else r[l]=o}return e},dD=[],yye=function(t){var e=[];for(var r in t)t[r].buffer&&e.push((t[r]=new t[r].constructor(t[r])).buffer);return e},bye=function(t,e,r,i){if(!dD[r]){for(var n="",s={},a=t.length-1,o=0;o<a;++o)n=DY(t[o],n,s);dD[r]={c:DY(t[a],n,s),e:s}}var l=vj({},dD[r].e);return mye(dD[r].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",r,l,yye(l),i)},dM=function(){return[os,wh,vC,v2,C2,uC,cM,fj,mj,yj,hC,bj,BA,wD,SA,vD,S2,Kp,wn,r_,Iye,Cj,vye]},xye=function(){return[os,wh,vC,v2,C2,uC,GD,R4,pj,dg,gj,b2,hC,xj,L0,BA,Vp,n2,CD,YD,M4,s2,uM,k4,S2,Kp,Ej,T2,Tye,Cj]};var Eye=function(){return[AM,Tj]};var wye=function(){return[Bj]},Cj=function(t){return postMessage(t,[t.buffer])},vye=function(t){return t&&{out:t.size&&new os(t.size),dictionary:t.dictionary}};var F0=function(t){return t.ondata=function(e,r){return postMessage([e,r],[e.buffer])},function(e){e.data.length?(t.push(e.data[0],e.data[1]),postMessage([e.data[0].length])):t.flush()}},i_=function(t,e,r,i,n,s,a){var o,l=bye(t,i,n,function(c,u){c?(l.terminate(),e.ondata.call(e,c)):Array.isArray(u)?u.length==1?(e.queuedSize-=u[0],e.ondrain&&e.ondrain(u[0])):(u[1]&&l.terminate(),e.ondata.call(e,c,u[0],u[1])):a(u)});l.postMessage(r),e.queuedSize=0,e.push=function(c,u){e.ondata||wn(5),o&&e.ondata(wn(4,0,1),null,!!u),e.queuedSize+=c.length,l.postMessage([c,o=u],[c.buffer])},e.terminate=function(){l.terminate()},s&&(e.flush=function(){l.postMessage([])})},c2=function(t,e){return t[e]|t[e+1]<<8},u2=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},b4=function(t,e){return u2(t,e)+u2(t,e+4)*4294967296},Ra=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},Sj=function(t,e){var r=e.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=e.level<2?4:e.level==9?2:0,t[9]=3,e.mtime!=0&&Ra(t,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),r){t[3]=8;for(var i=0;i<=r.length;++i)t[i+10]=r.charCodeAt(i)}},AM=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&wn(6,"invalid gzip data");var e=t[3],r=10;e&4&&(r+=(t[10]|t[11]<<8)+2);for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!t[r++]);return r+(e&2)},Tj=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},Ij=function(t){return 10+(t.filename?t.filename.length+1:0)},Cye=function(t,e){var r=e.level,i=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=i<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var n=wj();n.p(e.dictionary),Ra(t,2,n.d())}},Bj=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&wn(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&wn(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function CC(t,e){return typeof t=="function"&&(e=t,t={}),this.ondata=e,t}var cg=(function(){function t(e,r){if(typeof e=="function"&&(r=e,e={}),this.ondata=r,this.o=e||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new os(98304),this.o.dictionary){var i=this.o.dictionary.subarray(-32768);this.b.set(i,32768-i.length),this.s.i=32768-i.length}}return t.prototype.p=function(e,r){this.ondata(T2(e,this.o,0,0,this.s),r)},t.prototype.push=function(e,r){this.ondata||wn(5),this.s.l&&wn(4);var i=e.length+this.s.z;if(i>this.b.length){if(i>2*this.b.length-32768){var n=new os(i&-32768);n.set(this.b.subarray(0,this.s.z)),this.b=n}var s=this.b.length-this.s.z;this.b.set(e.subarray(0,s),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(e.subarray(s),32768),this.s.z=e.length-s+32768,this.s.i=32766,this.s.w=32768}else this.b.set(e,this.s.z),this.s.z+=e.length;this.s.l=r&1,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},t.prototype.flush=function(){this.ondata||wn(5),this.s.l&&wn(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},t})(),Sye=(function(){function t(e,r){i_([xye,function(){return[F0,cg]}],this,CC.call(this,e,r),function(i){var n=new cg(i.data);onmessage=F0(n)},6,1)}return t})();function Tye(t,e){return T2(t,e||{},0,0)}var Gd=(function(){function t(e,r){typeof e=="function"&&(r=e,e={}),this.ondata=r;var i=e&&e.dictionary&&e.dictionary.subarray(-32768);this.s={i:0,b:i?i.length:0},this.o=new os(32768),this.p=new os(0),i&&this.o.set(i)}return t.prototype.e=function(e){if(this.ondata||wn(5),this.d&&wn(4),!this.p.length)this.p=e;else if(e.length){var r=new os(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length),this.p=r}},t.prototype.c=function(e){this.s.i=+(this.d=e||!1);var r=this.s.b,i=r_(this.p,this.s,this.o);this.ondata(Kp(i,r,this.s.b),this.d),this.o=Kp(i,this.s.b-32768),this.s.b=this.o.length,this.p=Kp(this.p,this.s.p/8|0),this.s.p&=7},t.prototype.push=function(e,r){this.e(e),this.c(r)},t})(),Dj=(function(){function t(e,r){i_([dM,function(){return[F0,Gd]}],this,CC.call(this,e,r),function(i){var n=new Gd(i.data);onmessage=F0(n)},7,0)}return t})();function Iye(t,e){return r_(t,{i:2},e&&e.out,e&&e.dictionary)}var R8e=(function(){function t(e,r){this.c=hM(),this.l=0,this.v=1,cg.call(this,e,r)}return t.prototype.push=function(e,r){this.c.p(e),this.l+=e.length,cg.prototype.push.call(this,e,r)},t.prototype.p=function(e,r){var i=T2(e,this.o,this.v&&Ij(this.o),r&&8,this.s);this.v&&(Sj(i,this.o),this.v=0),r&&(Ra(i,i.length-8,this.c.d()),Ra(i,i.length-4,this.l)),this.ondata(i,r)},t.prototype.flush=function(){cg.prototype.flush.call(this)},t})();function Bye(t,e){e||(e={});var r=hM(),i=t.length;r.p(t);var n=T2(t,e,Ij(e),8),s=n.length;return Sj(n,e),Ra(n,s-8,r.d()),Ra(n,s-4,i),n}var F4=(function(){function t(e,r){this.v=1,this.r=0,Gd.call(this,e,r)}return t.prototype.push=function(e,r){if(Gd.prototype.e.call(this,e),this.r+=e.length,this.v){var i=this.p.subarray(this.v-1),n=i.length>3?AM(i):4;if(n>i.length){if(!r)return}else this.v>1&&this.onmember&&this.onmember(this.r-i.length);this.p=i.subarray(n),this.v=0}Gd.prototype.c.call(this,r),this.s.f&&!this.s.l&&!r&&(this.v=S2(this.s.p)+9,this.s={i:0},this.o=new os(0),this.push(new os(0),r))},t})(),Dye=(function(){function t(e,r){var i=this;i_([dM,Eye,function(){return[F0,Gd,F4]}],this,CC.call(this,e,r),function(n){var s=new F4(n.data);s.onmember=function(a){return postMessage(a)},onmessage=F0(s)},9,0,function(n){return i.onmember&&i.onmember(n)})}return t})();function _ye(t,e){var r=AM(t);return r+8>t.length&&wn(6,"invalid gzip data"),r_(t.subarray(r,-8),{i:2},e&&e.out||new os(Tj(t)),e&&e.dictionary)}var M8e=(function(){function t(e,r){this.c=wj(),this.v=1,cg.call(this,e,r)}return t.prototype.push=function(e,r){this.c.p(e),cg.prototype.push.call(this,e,r)},t.prototype.p=function(e,r){var i=T2(e,this.o,this.v&&(this.o.dictionary?6:2),r&&4,this.s);this.v&&(Cye(i,this.o),this.v=0),r&&Ra(i,i.length-4,this.c.d()),this.ondata(i,r)},t.prototype.flush=function(){cg.prototype.flush.call(this)},t})();var U4=(function(){function t(e,r){Gd.call(this,e,r),this.v=e&&e.dictionary?2:1}return t.prototype.push=function(e,r){if(Gd.prototype.e.call(this,e),this.v){if(this.p.length<6&&!r)return;this.p=this.p.subarray(Bj(this.p,this.v-1)),this.v=0}r&&(this.p.length<4&&wn(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),Gd.prototype.c.call(this,r)},t})(),Pye=(function(){function t(e,r){i_([dM,wye,function(){return[F0,Gd,U4]}],this,CC.call(this,e,r),function(i){var n=new U4(i.data);onmessage=F0(n)},11,0)}return t})();var _Y=(function(){function t(e,r){this.o=CC.call(this,e,r)||{},this.G=F4,this.I=Gd,this.Z=U4}return t.prototype.i=function(){var e=this;this.s.ondata=function(r,i){e.ondata(r,i)}},t.prototype.push=function(e,r){if(this.ondata||wn(5),this.s)this.s.push(e,r);else{if(this.p&&this.p.length){var i=new os(this.p.length+e.length);i.set(this.p),i.set(e,this.p.length)}else this.p=e;this.p.length>2&&(this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(this.o):(this.p[0]&15)!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(this.o):new this.Z(this.o),this.i(),this.s.push(this.p,r),this.p=null)}},t})(),k8e=(function(){function t(e,r){_Y.call(this,e,r),this.queuedSize=0,this.G=Dye,this.I=Dj,this.Z=Pye}return t.prototype.i=function(){var e=this;this.s.ondata=function(r,i,n){e.ondata(r,i,n)},this.s.ondrain=function(r){e.queuedSize-=r,e.ondrain&&e.ondrain(r)}},t.prototype.push=function(e,r){this.queuedSize+=e.length,_Y.prototype.push.call(this,e,r)},t})();var PY=typeof TextEncoder<"u"&&new TextEncoder,H4=typeof TextDecoder<"u"&&new TextDecoder,_j=0;try{H4.decode(L0,{stream:!0}),_j=1}catch{}var Pj=function(t){for(var e="",r=0;;){var i=t[r++],n=(i>127)+(i>223)+(i>239);if(r+n>t.length)return{s:e,r:Kp(t,r-1)};n?n==3?(i=((i&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|i>>10,56320|i&1023)):n&1?e+=String.fromCharCode((i&31)<<6|t[r++]&63):e+=String.fromCharCode((i&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(i)}},F8e=(function(){function t(e){this.ondata=e,_j?this.t=new TextDecoder:this.p=L0}return t.prototype.push=function(e,r){if(this.ondata||wn(5),r=!!r,this.t){this.ondata(this.t.decode(e,{stream:!0}),r),r&&(this.t.decode().length&&wn(8),this.t=null);return}this.p||wn(4);var i=new os(this.p.length+e.length);i.set(this.p),i.set(e,this.p.length);var n=Pj(i),s=n.s,a=n.r;r?(a.length&&wn(8),this.p=null):this.p=a,this.ondata(s,r)},t})(),U8e=(function(){function t(e){this.ondata=e}return t.prototype.push=function(e,r){this.ondata||wn(5),this.d&&wn(4),this.ondata(G4(e),this.d=r||!1)},t})();function G4(t,e){if(e){for(var r=new os(t.length),i=0;i<t.length;++i)r[i]=t.charCodeAt(i);return r}if(PY)return PY.encode(t);for(var n=t.length,s=new os(t.length+(t.length>>1)),a=0,o=function(d){s[a++]=d},i=0;i<n;++i){if(a+5>s.length){var l=new os(a+8+(n-i<<1));l.set(s),s=l}var c=t.charCodeAt(i);c<128||e?o(c):c<2048?(o(192|c>>6),o(128|c&63)):c>55295&&c<57344?(c=65536+(c&1047552)|t.charCodeAt(++i)&1023,o(240|c>>18),o(128|c>>12&63),o(128|c>>6&63),o(128|c&63)):(o(224|c>>12),o(128|c>>6&63),o(128|c&63))}return Kp(s,0,a)}function Lye(t,e){if(e){for(var r="",i=0;i<t.length;i+=16384)r+=String.fromCharCode.apply(null,t.subarray(i,i+16384));return r}else{if(H4)return H4.decode(t);var n=Pj(t),s=n.s,r=n.r;return r.length&&wn(8),s}}var Lj=function(t){return t==1?3:t<6?2:t==9?1:0};var Oye=function(t,e){for(;c2(t,e)!=1;e+=4+c2(t,e+2));return[b4(t,e+12),b4(t,e+4),b4(t,e+20)]},SD=function(t){var e=0;if(t)for(var r in t){var i=t[r].length;i>65535&&wn(9),e+=i+4}return e},LY=function(t,e,r,i,n,s,a,o){var l=i.length,c=r.extra,u=o&&o.length,d=SD(c);Ra(t,e,a!=null?33639248:67324752),e+=4,a!=null&&(t[e++]=20,t[e++]=r.os),t[e]=20,e+=2,t[e++]=r.flag<<1|(s<0&&8),t[e++]=n&&8,t[e++]=r.compression&255,t[e++]=r.compression>>8;var A=new Date(r.mtime==null?Date.now():r.mtime),h=A.getFullYear()-1980;if((h<0||h>119)&&wn(10),Ra(t,e,h<<25|A.getMonth()+1<<21|A.getDate()<<16|A.getHours()<<11|A.getMinutes()<<5|A.getSeconds()>>1),e+=4,s!=-1&&(Ra(t,e,r.crc),Ra(t,e+4,s<0?-s-2:s),Ra(t,e+8,r.size)),Ra(t,e+12,l),Ra(t,e+14,d),e+=16,a!=null&&(Ra(t,e,u),Ra(t,e+6,r.attrs),Ra(t,e+10,a),e+=14),t.set(i,e),e+=l,d)for(var f in c){var p=c[f],m=p.length;Ra(t,e,+f),Ra(t,e+2,m),t.set(p,e+4),e+=4+m}return u&&(t.set(o,e),e+=u),e},Nye=function(t,e,r,i,n){Ra(t,e,101010256),Ra(t,e+8,r),Ra(t,e+10,r),Ra(t,e+12,i),Ra(t,e+16,n)},VD=(function(){function t(e){this.filename=e,this.c=hM(),this.size=0,this.compression=0}return t.prototype.process=function(e,r){this.ondata(null,e,r)},t.prototype.push=function(e,r){this.ondata||wn(5),this.c.p(e),this.size+=e.length,r&&(this.crc=this.c.d()),this.process(e,r||!1)},t})(),H8e=(function(){function t(e,r){var i=this;r||(r={}),VD.call(this,e),this.d=new cg(r,function(n,s){i.ondata(null,n,s)}),this.compression=8,this.flag=Lj(r.level)}return t.prototype.process=function(e,r){try{this.d.push(e,r)}catch(i){this.ondata(i,null,r)}},t.prototype.push=function(e,r){VD.prototype.push.call(this,e,r)},t})(),G8e=(function(){function t(e,r){var i=this;r||(r={}),VD.call(this,e),this.d=new Sye(r,function(n,s,a){i.ondata(n,s,a)}),this.compression=8,this.flag=Lj(r.level),this.terminate=this.d.terminate}return t.prototype.process=function(e,r){this.d.push(e,r)},t.prototype.push=function(e,r){VD.prototype.push.call(this,e,r)},t})(),Y8e=(function(){function t(e){this.ondata=e,this.u=[],this.d=1}return t.prototype.add=function(e){var r=this;if(this.ondata||wn(5),this.d&2)this.ondata(wn(4+(this.d&1)*8,0,1),null,!1);else{var i=G4(e.filename),n=i.length,s=e.comment,a=s&&G4(s),o=n!=e.filename.length||a&&s.length!=a.length,l=n+SD(e.extra)+30;n>65535&&this.ondata(wn(11,0,1),null,!1);var c=new os(l);LY(c,0,e,i,o,-1);var u=[c],d=function(){for(var m=0,y=u;m<y.length;m++){var g=y[m];r.ondata(null,g,!1)}u=[]},A=this.d;this.d=0;var h=this.u.length,f=vj(e,{f:i,u:o,o:a,t:function(){e.terminate&&e.terminate()},r:function(){if(d(),A){var m=r.u[h+1];m?m.r():r.d=1}A=1}}),p=0;e.ondata=function(m,y,g){if(m)r.ondata(m,y,g),r.terminate();else if(p+=y.length,u.push(y),g){var b=new os(16);Ra(b,0,134695760),Ra(b,4,e.crc),Ra(b,8,p),Ra(b,12,e.size),u.push(b),f.c=p,f.b=l+p+16,f.crc=e.crc,f.size=e.size,A&&f.r(),A=1}else A&&d()},this.u.push(f)}},t.prototype.end=function(){var e=this;if(this.d&2){this.ondata(wn(4+(this.d&1)*8,0,1),null,!0);return}this.d?this.e():this.u.push({r:function(){e.d&1&&(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3},t.prototype.e=function(){for(var e=0,r=0,i=0,n=0,s=this.u;n<s.length;n++){var a=s[n];i+=46+a.f.length+SD(a.extra)+(a.o?a.o.length:0)}for(var o=new os(i+22),l=0,c=this.u;l<c.length;l++){var a=c[l];LY(o,e,a,a.f,a.u,-a.c-2,r,a.o),e+=46+a.f.length+SD(a.extra)+(a.o?a.o.length:0),r+=a.b}Nye(o,e,this.u.length,i,r),this.ondata(null,o,!0),this.d=2},t.prototype.terminate=function(){for(var e=0,r=this.u;e<r.length;e++){var i=r[e];i.t()}this.d=2},t})();var Rye=(function(){function t(){}return t.prototype.push=function(e,r){this.ondata(null,e,r)},t.compression=0,t})(),V8e=(function(){function t(){var e=this;this.i=new Gd(function(r,i){e.ondata(null,r,i)})}return t.prototype.push=function(e,r){try{this.i.push(e,r)}catch(i){this.ondata(i,null,r)}},t.compression=8,t})(),j8e=(function(){function t(e,r){var i=this;r<32e4?this.i=new Gd(function(n,s){i.ondata(null,n,s)}):(this.i=new Dj(function(n,s,a){i.ondata(n,s,a)}),this.terminate=this.i.terminate)}return t.prototype.push=function(e,r){this.i.terminate&&(e=Kp(e,0)),this.i.push(e,r)},t.compression=8,t})(),Q8e=(function(){function t(e){this.onfile=e,this.k=[],this.o={0:Rye},this.p=L0}return t.prototype.push=function(e,r){var i=this;if(this.onfile||wn(5),this.p||wn(4),this.c>0){var n=Math.min(this.c,e.length),s=e.subarray(0,n);if(this.c-=n,this.d?this.d.push(s,!this.c):this.k[0].push(s),e=e.subarray(n),e.length)return this.push(e,r)}else{var a=0,o=0,l=void 0,c=void 0;this.p.length?e.length?(c=new os(this.p.length+e.length),c.set(this.p),c.set(e,this.p.length)):c=this.p:c=e;for(var u=c.length,d=this.c,A=d&&this.d,h=function(){var y,g=u2(c,o);if(g==67324752){a=1,l=o,f.d=null,f.c=0;var b=c2(c,o+6),E=c2(c,o+8),w=b&2048,x=b&8,I=c2(c,o+26),C=c2(c,o+28);if(u>o+30+I+C){var G=[];f.k.unshift(G),a=2;var U=u2(c,o+18),_=u2(c,o+22),H=Lye(c.subarray(o+30,o+=30+I),!w);U==4294967295?(y=x?[-2]:Oye(c,o),U=y[0],_=y[1]):x&&(U=-1),o+=C,f.c=U;var Q,j={name:H,compression:E,start:function(){if(j.ondata||wn(5),!U)j.ondata(null,L0,!0);else{var $=i.o[E];$||j.ondata(wn(14,"unknown compression type "+E,1),null,!1),Q=U<0?new $(H):new $(H,U,_),Q.ondata=function(N,R,q){j.ondata(N,R,q)};for(var B=0,M=G;B<M.length;B++){var v=M[B];Q.push(v,!1)}i.k[0]==G&&i.c?i.d=Q:Q.push(L0,!0)}},terminate:function(){Q&&Q.terminate&&Q.terminate()}};U>=0&&(j.size=U,j.originalSize=_),f.onfile(j)}return"break"}else if(d){if(g==134695760)return l=o+=12+(d==-2&&8),a=3,f.c=0,"break";if(g==33639248)return l=o-=4,a=3,f.c=0,"break"}},f=this;o<u-4;++o){var p=h();if(p==="break")break}if(this.p=L0,d<0){var m=a?c.subarray(0,l-12-(d==-2&&8)-(u2(c,l-16)==134695760&&4)):c.subarray(0,o);A?A.push(m,!!a):this.k[+(a==2)].push(m)}if(a&2)return this.push(c.subarray(o),r);this.p=c.subarray(o)}r&&(this.c&&wn(13),this.p=null)},t.prototype.register=function(e){this.o[e.compression]=e},t})();var Zm,Ka,SC=(t=>(t[t.UNAUTHORIZED=401]="UNAUTHORIZED",t[t.LOGIN_FAIL=402]="LOGIN_FAIL",t[t.PERMISSION_DENIED=422]="PERMISSION_DENIED",t[t.PERMISSION_DENIED1=1111111]="PERMISSION_DENIED1",t[t.PERMISSION_DENIED_PARAMS=1111112]="PERMISSION_DENIED_PARAMS",t[t.DATA_NOT_FOUND=1111113]="DATA_NOT_FOUND",t[t.PARAMS_DATA_NOT_FOUND=1111114]="PARAMS_DATA_NOT_FOUND",t[t.REQUEST_PARAM_ILLEGAL=42222]="REQUEST_PARAM_ILLEGAL",t[t.REQUEST_PARAM_ILLEGAL1=1111115]="REQUEST_PARAM_ILLEGAL1",t[t.REQUEST_PARAMS_ILLEGAL2=1111116]="REQUEST_PARAMS_ILLEGAL2",t[t.REQUEST_PARAMS_NOT_NULL=1111117]="REQUEST_PARAMS_NOT_NULL",t[t.REQUEST_PARAMS_NOT_ALL_NULL=1111118]="REQUEST_PARAMS_NOT_ALL_NULL",t[t.REQUEST_PARAMS_MUST_ARRAY=1111119]="REQUEST_PARAMS_MUST_ARRAY",t[t.REQUEST_PARAMS_MUST_STRING=1111120]="REQUEST_PARAMS_MUST_STRING",t[t.REQUEST_PARAMS_MUST_NUMBER=1111121]="REQUEST_PARAMS_MUST_NUMBER",t[t.REQUEST_PARAMS_MUST_NUMBER_ARRAY=1111122]="REQUEST_PARAMS_MUST_NUMBER_ARRAY",t[t.REQUEST_PARAMS_MUST_STRING_ARRAY=1111123]="REQUEST_PARAMS_MUST_STRING_ARRAY",t[t.REQUEST_PARAMS_LENGTH_ERROR=1111124]="REQUEST_PARAMS_LENGTH_ERROR",t[t.REQUEST_PARAMS_TYPE_ERROR=1111125]="REQUEST_PARAMS_TYPE_ERROR",t[t.ILLEGAL_NAME=2001]="ILLEGAL_NAME",t[t.ILLEGAL_NAME1=1111126]="ILLEGAL_NAME1",t[t.ILLEGAL_NAME_ZH=1111128]="ILLEGAL_NAME_ZH",t[t.UUID_ERROR=1111127]="UUID_ERROR",t[t.DUPLICATE_DATA=1000001]="DUPLICATE_DATA",t[t.DUPLICATE_DATA1=11e3]="DUPLICATE_DATA1",t[t.DUPLICATE_DATA_PARAMS=1000017]="DUPLICATE_DATA_PARAMS",t[t.UPLOAD_LIMIT=10034]="UPLOAD_LIMIT",t[t.MORE_THAN_LIMIT=1000003]="MORE_THAN_LIMIT",t[t.FILE_MORE_THAN_LIMIT=1000004]="FILE_MORE_THAN_LIMIT",t[t.PARAMS_MORE_THAN_LIMIT=1000005]="PARAMS_MORE_THAN_LIMIT",t[t.IMAGE_MORE_THAN_LIMIT_PARAMS=1000006]="IMAGE_MORE_THAN_LIMIT_PARAMS",t[t.FILE_MORE_THAN_LIMIT_PARAMS=1000007]="FILE_MORE_THAN_LIMIT_PARAMS",t[t.END_MUST_AFTER_START=1000019]="END_MUST_AFTER_START",t[t.REQUEST_PARAMS_TIME_ERROR=1000009]="REQUEST_PARAMS_TIME_ERROR",t[t.FILES_PATH_NOT_FOUND=1000018]="FILES_PATH_NOT_FOUND",t[t.FILES_DATA_NOT_FOUND=1000011]="FILES_DATA_NOT_FOUND",t[t.FILES_TYPE_ERROR=1000012]="FILES_TYPE_ERROR",t[t.FILES_TYPE_MUST_BE_ONE=1000013]="FILES_TYPE_MUST_BE_ONE",t[t.SET_WATERMARK_FAIL=1000014]="SET_WATERMARK_FAIL",t[t.MYSQL_CRUD_ERROR=1000015]="MYSQL_CRUD_ERROR",t[t.PARAMS_JSON_FAILED=1000016]="PARAMS_JSON_FAILED",t[t.MYSQL_ERROR=3000001]="MYSQL_ERROR",t[t.NOT_FOUND=404]="NOT_FOUND",t[t.PRJ_NAME_EXISTS=2002]="PRJ_NAME_EXISTS",t[t.BACKUP_NAME_EXISTS=3002]="BACKUP_NAME_EXISTS",t[t.PRJ_NOT_EXIST=2000001]="PRJ_NOT_EXIST",t[t.ERROR_PATH=4000002]="ERROR_PATH",t[t.PROJECT_NOT_FOUND=6000001]="PROJECT_NOT_FOUND",t[t.TITLE_ILLEGAL_LEN=2003]="TITLE_ILLEGAL_LEN",t[t.FILE_READ_ONLY=1000002]="FILE_READ_ONLY",t[t.FILE_READ_ONLY1=1000008]="FILE_READ_ONLY1",t[t.DATA_NOT_EXIST=1000010]="DATA_NOT_EXIST",t[t.LIB_NOT_EXIST=2000001]="LIB_NOT_EXIST",t[t.CONFIG_API_URLS_ERROR=3001001]="CONFIG_API_URLS_ERROR",t[t.ONE_CLICK_ORDER_NOT_OPEN=3001002]="ONE_CLICK_ORDER_NOT_OPEN",t[t.MATERIAL_NOT_OPEN=3001003]="MATERIAL_NOT_OPEN",t[t.SNAPSHOT_DEPTH_LIMIT=3001004]="SNAPSHOT_DEPTH_LIMIT",t[t.OCR_SYMBOL_URL_ERROR=3001005]="OCR_SYMBOL_URL_ERROR",t[t.USER_DATA_NOT_FOUND=4000001]="USER_DATA_NOT_FOUND",t[t.USER_DISABLE_ERROR=4000012]="USER_DISABLE_ERROR",t[t.USER_EXISTS_LOGIN_ERROR=4000003]="USER_EXISTS_LOGIN_ERROR",t[t.USER_UNAUTHORIZED_MODULES_ERROR=4000004]="USER_UNAUTHORIZED_MODULES_ERROR",t[t.USER_UNAUTHORIZED_ACCESS_ERROR=4000005]="USER_UNAUTHORIZED_ACCESS_ERROR",t[t.ADMIN_NOT_CHANGE_PASSWORD=4000006]="ADMIN_NOT_CHANGE_PASSWORD",t[t.SAME_PASSWORD_NEW_PASSWORD=4000007]="SAME_PASSWORD_NEW_PASSWORD",t[t.USER_ONLINE_REGISTRATION_FAILED=4000008]="USER_ONLINE_REGISTRATION_FAILED",t[t.USER_PASSWORD_CAN_NOT_DEFAULT=4000009]="USER_PASSWORD_CAN_NOT_DEFAULT",t[t.USER_BEFORE_PASSWORD_ERROR=4000010]="USER_BEFORE_PASSWORD_ERROR",t[t.USER_PASSWORD_LENGTH_ERROR=4000011]="USER_PASSWORD_LENGTH_ERROR",t[t.ORG_ROLE_NOT_CREATE=5000001]="ORG_ROLE_NOT_CREATE",t[t.ORG_ROLE_NAME_DUPLICATE=5000002]="ORG_ROLE_NAME_DUPLICATE",t[t.ORG_ROLE_ORIGIN_ERROR=5000003]="ORG_ROLE_ORIGIN_ERROR",t[t.ORG_ROLE_NOT_DEFAULT=5000004]="ORG_ROLE_NOT_DEFAULT",t[t.ADMIN_ROLE_NOT_CHANGE=5000005]="ADMIN_ROLE_NOT_CHANGE",t[t.ADMIN_NOT_CHANGE_STATUS=5000006]="ADMIN_NOT_CHANGE_STATUS",t[t.PROJECT_ARCHIVED=6000002]="PROJECT_ARCHIVED",t[t.PROJECT_UUID_NULL=6000003]="PROJECT_UUID_NULL",t[t.PROJECT_UUID_ERROR=6000004]="PROJECT_UUID_ERROR",t[t.PROJECT_OR_TEAM_UUID_ERROR=6000005]="PROJECT_OR_TEAM_UUID_ERROR",t[t.PROJECT_NOT_PERSON_ERROR=6000006]="PROJECT_NOT_PERSON_ERROR",t[t.PROJECT_DUPLICATE_NAME=6000007]="PROJECT_DUPLICATE_NAME",t[t.ANNOTATION_HAS_BE_FOUND=6000008]="ANNOTATION_HAS_BE_FOUND",t[t.ANNOTATION_NOT_FOUND=6000009]="ANNOTATION_NOT_FOUND",t[t.ANNOTATION_CREATE_ERROR=6000010]="ANNOTATION_CREATE_ERROR",t[t.ANNOTATION_UPDATE_ERROR=6000011]="ANNOTATION_UPDATE_ERROR",t[t.ANNOTATION_DELETE_ERROR=6000012]="ANNOTATION_DELETE_ERROR",t[t.PROJECT_DUPLICATE_PATH=6000013]="PROJECT_DUPLICATE_PATH",t[t.TEAM_NOT_FOUND=7000001]="TEAM_NOT_FOUND",t[t.TEAM_UUID_NULL=7000002]="TEAM_UUID_NULL",t[t.TEAM_FOLDER_ERROR=7000003]="TEAM_FOLDER_ERROR",t[t.TEAM_FOLDER_DEEP_ERROR=7000004]="TEAM_FOLDER_DEEP_ERROR",t[t.TEAM_FOLDER_UUID_ERROR=7000005]="TEAM_FOLDER_UUID_ERROR",t[t.TEAM_URL_DUPLICATE=7000006]="TEAM_URL_DUPLICATE",t[t.TEAM_CAN_NOT_DELETE=7000007]="TEAM_CAN_NOT_DELETE",t[t.COMPONENT_UUID_NULL=8000001]="COMPONENT_UUID_NULL",t[t.COMPONENT_DATA_NOT_FOUND=8000002]="COMPONENT_DATA_NOT_FOUND",t[t.COMPONENT_NAME_DUPLICATE=8000003]="COMPONENT_NAME_DUPLICATE",t[t.COMPONENT_TYPE_ERROR=8000004]="COMPONENT_TYPE_ERROR",t[t.DELETE_SON_CATEGORY=8001001]="DELETE_SON_CATEGORY",t[t.LICENSE=9000001]="LICENSE",t[t.START_TIME=9000002]="START_TIME",t[t.END_TIME=9000003]="END_TIME",t[t.PROJECT_LIMIT=9000004]="PROJECT_LIMIT",t[t.USER_LIMIT=9000005]="USER_LIMIT",t[t.ONLINE_NUMBER_LIMIT=9000006]="ONLINE_NUMBER_LIMIT",t[t.COMPANY_CODE=9000007]="COMPANY_CODE",t[t.LIMIT_PCB=9000008]="LIMIT_PCB",t[t.LIMIT_SCH=9000009]="LIMIT_SCH",t[t.LIMIT_PANEL=9000011]="LIMIT_PANEL",t[t.TIME_ERROR=9000010]="TIME_ERROR",t[t.LICENSE_ERROR=9000012]="LICENSE_ERROR",t[t.LICENSE_TYPE_ERROR=9000013]="LICENSE_TYPE_ERROR",t[t.LICENSE_ORIGIN_ERROR=9000014]="LICENSE_ORIGIN_ERROR",t[t.BRANCH_DATA_NOT_FOUND=11000001]="BRANCH_DATA_NOT_FOUND",t[t.PARENT_UUID_ERROR=11000002]="PARENT_UUID_ERROR",t[t.BRANCH_MUST_AFTER_NODE=11000003]="BRANCH_MUST_AFTER_NODE",t[t.BRANCH_NAME_ERROR=11000004]="BRANCH_NAME_ERROR",t[t.BRANCH_NAME_DUPLICATE=11000005]="BRANCH_NAME_DUPLICATE",t[t.BRANCH_UUID_ERROR=11000006]="BRANCH_UUID_ERROR",t[t.BRANCH_NODE_SET_ERROR=11000007]="BRANCH_NODE_SET_ERROR",t[t.BRANCH_DELETE_MAIN_ERROR=11000008]="BRANCH_DELETE_MAIN_ERROR",t[t.BRANCH_CHECK_OUT_ERROR=11000009]="BRANCH_CHECK_OUT_ERROR",t[t.DOCUMENT_UUID_ERROR=12000001]="DOCUMENT_UUID_ERROR",t[t.UPDATE_FAILED=12000002]="UPDATE_FAILED",t[t.INNER_API_KEY_ERROR=1000020]="INNER_API_KEY_ERROR",t[t.BRANCH_MORE_THAN_LIMIT=11000010]="BRANCH_MORE_THAN_LIMIT",t[t.WORKSPACE_API_ERROR=1000021]="WORKSPACE_API_ERROR",t))(SC||{}),Mye=(t=>(t.UNAUTHORIZED="UNAUTHORIZED",t.LOGIN_FAIL="LOGIN_FAIL",t.PERMISSION_DENIED="PERMISSION_DENIED",t.PERMISSION_DENIED1="PERMISSION_DENIED1",t.PERMISSION_DENIED_PARAMS="PERMISSION_DENIED_PARAMS",t.DATA_NOT_FOUND="DATA_NOT_FOUND",t.PARAMS_DATA_NOT_FOUND="PARAMS_DATA_NOT_FOUND",t.REQUEST_PARAM_ILLEGAL="REQUEST_PARAM_ILLEGAL",t.REQUEST_PARAM_ILLEGAL1="REQUEST_PARAM_ILLEGAL1",t.REQUEST_PARAMS_ILLEGAL2="REQUEST_PARAMS_ILLEGAL2",t.REQUEST_PARAMS_NOT_NULL="REQUEST_PARAMS_NOT_NULL",t.REQUEST_PARAMS_NOT_ALL_NULL="REQUEST_PARAMS_NOT_ALL_NULL",t.REQUEST_PARAMS_MUST_ARRAY="REQUEST_PARAMS_MUST_ARRAY",t.REQUEST_PARAMS_MUST_STRING="REQUEST_PARAMS_MUST_STRING",t.REQUEST_PARAMS_MUST_NUMBER="REQUEST_PARAMS_MUST_NUMBER",t.REQUEST_PARAMS_MUST_NUMBER_ARRAY="REQUEST_PARAMS_MUST_NUMBER_ARRAY",t.REQUEST_PARAMS_MUST_STRING_ARRAY="REQUEST_PARAMS_MUST_STRING_ARRAY",t.REQUEST_PARAMS_LENGTH_ERROR="REQUEST_PARAMS_LENGTH_ERROR",t.REQUEST_PARAMS_TYPE_ERROR="REQUEST_PARAMS_TYPE_ERROR",t.ILLEGAL_NAME="ILLEGAL_NAME",t.ILLEGAL_NAME1="ILLEGAL_NAME1",t.ILLEGAL_NAME_ZH="ILLEGAL_NAME_ZH",t.UUID_ERROR="UUID_ERROR",t.DUPLICATE_DATA="DUPLICATE_DATA",t.DUPLICATE_DATA1="DUPLICATE_DATA1",t.DUPLICATE_DATA_PARAMS="DUPLICATE_DATA_PARAMS",t.UPLOAD_LIMIT="UPLOAD_LIMIT",t.MORE_THAN_LIMIT="MORE_THAN_LIMIT",t.FILE_MORE_THAN_LIMIT="FILE_MORE_THAN_LIMIT",t.PARAMS_MORE_THAN_LIMIT="PARAMS_MORE_THAN_LIMIT",t.IMAGE_MORE_THAN_LIMIT_PARAMS="IMAGE_MORE_THAN_LIMIT_PARAMS",t.FILE_MORE_THAN_LIMIT_PARAMS="FILE_MORE_THAN_LIMIT_PARAMS",t.END_MUST_AFTER_START="END_MUST_AFTER_START",t.REQUEST_PARAMS_TIME_ERROR="REQUEST_PARAMS_TIME_ERROR",t.FILES_PATH_NOT_FOUND="FILES_PATH_NOT_FOUND",t.FILES_DATA_NOT_FOUND="FILES_DATA_NOT_FOUND",t.FILES_TYPE_ERROR="FILES_TYPE_ERROR",t.FILES_TYPE_MUST_BE_ONE="FILES_TYPE_MUST_BE_ONE",t.SET_WATERMARK_FAIL="SET_WATERMARK_FAIL",t.MYSQL_CRUD_ERROR="MYSQL_CRUD_ERROR",t.PARAMS_JSON_FAILED="PARAMS_JSON_FAILED",t.MYSQL_ERROR="MYSQL_ERROR",t.NOT_FOUND="NOT_FOUND",t.PRJ_NAME_EXISTS="PRJ_NAME_EXISTS",t.BACKUP_NAME_EXISTS="BACKUP_NAME_EXISTS",t.PRJ_NOT_EXIST="PRJ_NOT_EXIST",t.ERROR_PATH="ERROR_PATH",t.PROJECT_NOT_FOUND="PROJECT_NOT_FOUND",t.TITLE_ILLEGAL_LEN="TITLE_ILLEGAL_LEN",t.FILE_READ_ONLY="FILE_READ_ONLY",t.FILE_READ_ONLY1="FILE_READ_ONLY1",t.DATA_NOT_EXIST="DATA_NOT_EXIST",t.LIB_NOT_EXIST="LIB_NOT_EXIST",t.CONFIG_API_URLS_ERROR="CONFIG_API_URLS_ERROR",t.ONE_CLICK_ORDER_NOT_OPEN="ONE_CLICK_ORDER_NOT_OPEN",t.MATERIAL_NOT_OPEN="MATERIAL_NOT_OPEN",t.SNAPSHOT_DEPTH_LIMIT="SNAPSHOT_DEPTH_LIMIT",t.OCR_SYMBOL_URL_ERROR="OCR_SYMBOL_URL_ERROR",t.USER_DATA_NOT_FOUND="USER_DATA_NOT_FOUND",t.USER_DISABLE_ERROR="USER_DISABLE_ERROR",t.USER_EXISTS_LOGIN_ERROR="USER_EXISTS_LOGIN_ERROR",t.USER_UNAUTHORIZED_MODULES_ERROR="USER_UNAUTHORIZED_MODULES_ERROR",t.USER_UNAUTHORIZED_ACCESS_ERROR="USER_UNAUTHORIZED_ACCESS_ERROR",t.ADMIN_NOT_CHANGE_PASSWORD="ADMIN_NOT_CHANGE_PASSWORD",t.SAME_PASSWORD_NEW_PASSWORD="SAME_PASSWORD_NEW_PASSWORD",t.USER_ONLINE_REGISTRATION_FAILED="USER_ONLINE_REGISTRATION_FAILED",t.USER_PASSWORD_CAN_NOT_DEFAULT="USER_PASSWORD_CAN_NOT_DEFAULT",t.USER_BEFORE_PASSWORD_ERROR="USER_BEFORE_PASSWORD_ERROR",t.USER_PASSWORD_LENGTH_ERROR="USER_PASSWORD_LENGTH_ERROR",t.ORG_ROLE_NOT_CREATE="ORG_ROLE_NOT_CREATE",t.ORG_ROLE_NAME_DUPLICATE="ORG_ROLE_NAME_DUPLICATE",t.ORG_ROLE_ORIGIN_ERROR="ORG_ROLE_ORIGIN_ERROR",t.ORG_ROLE_NOT_DEFAULT="ORG_ROLE_NOT_DEFAULT",t.ADMIN_ROLE_NOT_CHANGE="ADMIN_ROLE_NOT_CHANGE",t.ADMIN_NOT_CHANGE_STATUS="ADMIN_NOT_CHANGE_STATUS",t.PROJECT_ARCHIVED="PROJECT_ARCHIVED",t.PROJECT_UUID_NULL="PROJECT_UUID_NULL",t.PROJECT_UUID_ERROR="PROJECT_UUID_ERROR",t.PROJECT_OR_TEAM_UUID_ERROR="PROJECT_OR_TEAM_UUID_ERROR",t.PROJECT_NOT_PERSON_ERROR="PROJECT_NOT_PERSON_ERROR",t.PROJECT_DUPLICATE_NAME="PROJECT_DUPLICATE_NAME",t.ANNOTATION_HAS_BE_FOUND="ANNOTATION_HAS_BE_FOUND",t.ANNOTATION_NOT_FOUND="ANNOTATION_NOT_FOUND",t.ANNOTATION_CREATE_ERROR="ANNOTATION_CREATE_ERROR",t.ANNOTATION_UPDATE_ERROR="ANNOTATION_UPDATE_ERROR",t.ANNOTATION_DELETE_ERROR="ANNOTATION_DELETE_ERROR",t.PROJECT_DUPLICATE_PATH="PROJECT_DUPLICATE_PATH",t.TEAM_NOT_FOUND="TEAM_NOT_FOUND",t.TEAM_UUID_NULL="TEAM_UUID_NULL",t.TEAM_FOLDER_ERROR="TEAM_FOLDER_ERROR",t.TEAM_FOLDER_DEEP_ERROR="TEAM_FOLDER_DEEP_ERROR",t.TEAM_FOLDER_UUID_ERROR="TEAM_FOLDER_UUID_ERROR",t.TEAM_URL_DUPLICATE="TEAM_URL_DUPLICATE",t.TEAM_CAN_NOT_DELETE="TEAM_CAN_NOT_DELETE",t.COMPONENT_UUID_NULL="COMPONENT_UUID_NULL",t.COMPONENT_DATA_NOT_FOUND="COMPONENT_DATA_NOT_FOUND",t.COMPONENT_NAME_DUPLICATE="COMPONENT_NAME_DUPLICATE",t.COMPONENT_TYPE_ERROR="COMPONENT_TYPE_ERROR",t.DELETE_SON_CATEGORY="DELETE_SON_CATEGORY",t.LICENSE="LICENSE",t.START_TIME="START_TIME",t.END_TIME="END_TIME",t.PROJECT_LIMIT="PROJECT_LIMIT",t.USER_LIMIT="USER_LIMIT",t.ONLINE_NUMBER_LIMIT="ONLINE_NUMBER_LIMIT",t.COMPANY_CODE="COMPANY_CODE",t.LIMIT_PCB="LIMIT_PCB",t.LIMIT_SCH="LIMIT_SCH",t.LIMIT_PANEL="LIMIT_PANEL",t.TIME_ERROR="TIME_ERROR",t.LICENSE_ERROR="LICENSE_ERROR",t.LICENSE_TYPE_ERROR="LICENSE_TYPE_ERROR",t.LICENSE_ORIGIN_ERROR="LICENSE_ORIGIN_ERROR",t.BRANCH_DATA_NOT_FOUND="BRANCH_DATA_NOT_FOUND",t.PARENT_UUID_ERROR="PARENT_UUID_ERROR",t.BRANCH_MUST_AFTER_NODE="BRANCH_MUST_AFTER_NODE",t.BRANCH_NAME_ERROR="BRANCH_NAME_ERROR",t.BRANCH_NAME_DUPLICATE="BRANCH_NAME_DUPLICATE",t.BRANCH_UUID_ERROR="BRANCH_UUID_ERROR",t.BRANCH_NODE_SET_ERROR="BRANCH_NODE_SET_ERROR",t.BRANCH_DELETE_MAIN_ERROR="BRANCH_DELETE_MAIN_ERROR",t.BRANCH_CHECK_OUT_ERROR="BRANCH_CHECK_OUT_ERROR",t.DOCUMENT_UUID_ERROR="DOCUMENT_UUID_ERROR",t.UPDATE_FAILED="UPDATE_FAILED",t.INNER_API_KEY_ERROR="INNER_API_KEY_ERROR",t.BRANCH_MORE_THAN_LIMIT="BRANCH_MORE_THAN_LIMIT",t.WORKSPACE_API_ERROR="WORKSPACE_API_ERROR",t))(Mye||{}),kye=(t=>(t[t.DB_INIT_ERROR=0]="DB_INIT_ERROR",t[t.PRJ_NOT_EXIST=1]="PRJ_NOT_EXIST",t[t.NET_ERROR=2]="NET_ERROR",t[t.IS_OPENING=3]="IS_OPENING",t[t.NOT_LOGGED_IN=4]="NOT_LOGGED_IN",t[t.HAS_UNSAVED=5]="HAS_UNSAVED",t[t.DIFF_TICKET=6]="DIFF_TICKET",t))(kye||{});function TD(t,e={}){if(!t)return"";let{code:r,message:i}=t;switch(r){case 401:return jt("UNAUTHORIZED");case 402:return jt("LOGIN_FAIL");case 422:return jt("PERMISSION_DENIED");case 1111111:return jt("PERMISSION_DENIED1");case 2000001:return jt("PRJ_NOT_EXIST");case 4000002:return jt("ERROR_PATH");case 6000001:return jt("PROJECT_NOT_FOUND");case 1111112:return jt("PERMISSION_DENIED_PARAMS",{type:i});case 1111113:return jt("DATA_NOT_FOUND");case 1111114:return jt("PARAMS_DATA_NOT_FOUND",{type:i});case 42222:return jt("REQUEST_PARAM_ILLEGAL");case 1111115:return jt("REQUEST_PARAM_ILLEGAL1");case 1111116:return jt("REQUEST_PARAMS_ILLEGAL2",{type:i});case 1111117:return jt("REQUEST_PARAMS_NOT_NULL",{type:i});case 1111118:return jt("REQUEST_PARAMS_NOT_ALL_NULL",{type:i});case 1111119:return jt("REQUEST_PARAMS_MUST_ARRAY",{type:i});case 1111120:return jt("REQUEST_PARAMS_MUST_STRING",{type:i});case 1111121:return jt("REQUEST_PARAMS_MUST_NUMBER",{type:i});case 1111122:return jt("REQUEST_PARAMS_MUST_NUMBER_ARRAY",{type:i});case 1111123:return jt("REQUEST_PARAMS_MUST_STRING_ARRAY",{type:i});case 1111124:return jt("REQUEST_PARAMS_LENGTH_ERROR",{type:i});case 1111125:return jt("REQUEST_PARAMS_TYPE_ERROR",{type:i});case 2001:return jt("ILLEGAL_NAME");case 1111126:return jt("ILLEGAL_NAME1");case 1111128:return jt("ILLEGAL_NAME_ZH");case 1111127:return jt("UUID_ERROR");case 1000001:return jt("DUPLICATE_DATA");case 11e3:return jt("DUPLICATE_DATA1");case 1000017:return jt("DUPLICATE_DATA_PARAMS",{type:i});case 10034:return jt("UPLOAD_LIMIT");case 1000003:return jt("MORE_THAN_LIMIT");case 1000004:return jt("FILE_MORE_THAN_LIMIT",{type:i});case 1000005:return jt("PARAMS_MORE_THAN_LIMIT",{type:i});case 1000006:return jt("IMAGE_MORE_THAN_LIMIT_PARAMS");case 1000007:return jt("FILE_MORE_THAN_LIMIT_PARAMS");case 1000019:return jt("END_MUST_AFTER_START");case 1000002:return jt("FILE_READ_ONLY");case 1000008:return jt("FILE_READ_ONLY1");case 1000010:return jt("DATA_NOT_EXIST",{documentName:e.documentName});case 1000009:return jt("REQUEST_PARAMS_TIME_ERROR");case 1000018:return jt("FILES_PATH_NOT_FOUND");case 1000011:return jt("FILES_DATA_NOT_FOUND");case 1000012:return jt("FILES_TYPE_ERROR");case 1000013:return jt("FILES_TYPE_MUST_BE_ONE",{type:i});case 1000014:return jt("SET_WATERMARK_FAIL");case 1000015:return jt("MYSQL_CRUD_ERROR",{type:i});case 1000016:return jt("PARAMS_JSON_FAILED",{type:i});case 3000001:return jt("MYSQL_ERROR");case 404:return jt("NOT_FOUND");case 2002:return jt("PRJ_NAME_EXISTS");case 3002:return jt("BACKUP_NAME_EXISTS");case 2003:return jt("TITLE_ILLEGAL_LEN",{documentName:e.documentName});case 2000001:return jt("LIB_NOT_EXIST");case 3001001:return jt("CONFIG_API_URLS_ERROR");case 3001002:return jt("ONE_CLICK_ORDER_NOT_OPEN");case 3001003:return jt("MATERIAL_NOT_OPEN");case 3001004:return jt("SNAPSHOT_DEPTH_LIMIT");case 3001005:return jt("OCR_SYMBOL_URL_ERROR");case 4000001:return jt("USER_DATA_NOT_FOUND");case 4000012:return jt("USER_DISABLE_ERROR");case 4000003:return jt("USER_EXISTS_LOGIN_ERROR");case 4000004:return jt("USER_UNAUTHORIZED_MODULES_ERROR");case 4000005:return jt("USER_UNAUTHORIZED_ACCESS_ERROR");case 4000006:return jt("ADMIN_NOT_CHANGE_PASSWORD");case 4000007:return jt("SAME_PASSWORD_NEW_PASSWORD");case 4000008:return jt("USER_ONLINE_REGISTRATION_FAILED");case 4000009:return jt("USER_PASSWORD_CAN_NOT_DEFAULT");case 4000010:return jt("USER_BEFORE_PASSWORD_ERROR");case 4000011:return jt("USER_PASSWORD_LENGTH_ERROR");case 5000001:return jt("ORG_ROLE_NOT_CREATE");case 5000002:return jt("ORG_ROLE_NAME_DUPLICATE");case 5000003:return jt("ORG_ROLE_ORIGIN_ERROR",{message:i});case 5000004:return jt("ORG_ROLE_NOT_DEFAULT");case 5000005:return jt("ADMIN_ROLE_NOT_CHANGE");case 5000006:return jt("ADMIN_NOT_CHANGE_STATUS");case 6000002:return jt("PROJECT_ARCHIVED");case 6000003:return jt("PROJECT_UUID_NULL");case 6000004:return jt("PROJECT_UUID_ERROR");case 6000005:return jt("PROJECT_OR_TEAM_UUID_ERROR");case 6000006:return jt("PROJECT_NOT_PERSON_ERROR");case 6000007:return jt("PROJECT_DUPLICATE_NAME");case 6000008:return jt("ANNOTATION_HAS_BE_FOUND");case 6000009:return jt("ANNOTATION_NOT_FOUND");case 6000010:return jt("ANNOTATION_CREATE_ERROR");case 6000011:return jt("ANNOTATION_UPDATE_ERROR");case 6000012:return jt("ANNOTATION_DELETE_ERROR");case 6000013:return jt("PROJECT_DUPLICATE_PATH");case 7000001:return jt("TEAM_NOT_FOUND");case 7000002:return jt("TEAM_UUID_NULL");case 7000003:return jt("TEAM_FOLDER_ERROR");case 7000004:return jt("TEAM_FOLDER_DEEP_ERROR");case 7000005:return jt("TEAM_FOLDER_UUID_ERROR");case 7000006:return jt("TEAM_URL_DUPLICATE");case 7000007:return jt("TEAM_CAN_NOT_DELETE");case 8000001:return jt("COMPONENT_UUID_NULL");case 8000002:return jt("COMPONENT_DATA_NOT_FOUND");case 8000003:return jt("COMPONENT_NAME_DUPLICATE");case 8000004:return jt("COMPONENT_TYPE_ERROR");case 8001001:return jt("DELETE_SON_CATEGORY");case 9000001:return jt("LICENSE");case 9000002:return jt("START_TIME");case 9000003:return jt("END_TIME");case 9000004:return jt("PROJECT_LIMIT");case 9000005:return jt("USER_LIMIT");case 9000006:return jt("ONLINE_NUMBER_LIMIT");case 9000007:return jt("COMPANY_CODE");case 9000008:return jt("LIMIT_PCB");case 9000009:return jt("LIMIT_SCH");case 9000011:return jt("LIMIT_PANEL");case 9000010:return jt("TIME_ERROR");case 9000012:return jt("LICENSE_ERROR");case 9000013:return jt("LICENSE_TYPE_ERROR");case 9000014:return jt("LICENSE_ORIGIN_ERROR",{type:i});case 11000001:return jt("BRANCH_DATA_NOT_FOUND");case 11000002:return jt("PARENT_UUID_ERROR");case 11000003:return jt("BRANCH_MUST_AFTER_NODE");case 11000004:return jt("BRANCH_NAME_ERROR");case 11000005:return jt("BRANCH_NAME_DUPLICATE");case 11000006:return jt("BRANCH_UUID_ERROR");case 11000007:return jt("BRANCH_NODE_SET_ERROR");case 11000008:return jt("BRANCH_DELETE_MAIN_ERROR");case 11000009:return jt("BRANCH_CHECK_OUT_ERROR");case 12000001:return jt("DOCUMENT_UUID_ERROR");case 12000002:return jt("UPDATE_FAILED");case 1000020:return jt("INNER_API_KEY_ERROR");case 11000010:return jt("BRANCH_MORE_THAN_LIMIT");case 1000021:return jt("WORKSPACE_API_ERROR");default:return""}}function jt(t,e){return zV()==="zh-cn"?x4.match("codeCN",t,e)||"":x4.match("codeEN",t,e)||""}var Fye=(t=>(t.Text="text/plain;charset=UTF-8",t.Json="application/json",t.Form="application/x-www-form-urlencoded;charset=UTF-8",t.FormData="multipart/form-data",t))(Fye||{}),Uye=(t=>(t.ContentType="Content-type",t.Editorversion="Editor-Version",t))(Uye||{}),Hye=(t=>(t[t.Success=200]="Success",t[t.NotFound=404]="NotFound",t[t.NetError=500]="NetError",t))(Hye||{}),Gye=(t=>(t.Json="json",t.Blob="blob",t))(Gye||{}),Yye=0;function yn(t,e,r={},i={},n){return new Promise((s,a)=>{try{let l=Yye++;var o;t=t||"GET",Vye(t,r,i);let c=jye(e,r,i,n);o=(c==null?void 0:c.params)||r,i=(c==null?void 0:c.options)||i;let u=Qye(t,e,o,i);o=u.params,e=u.url;let d=new XMLHttpRequest;if(i.withCredentials!==void 0&&(d.withCredentials=i.withCredentials),i.responseType!==void 0&&(d.responseType=i.responseType),d.open(t,e,!0),zye(d,t,r,i),o=qye(d,t,e,o,i),d.onreadystatechange=function(){if(d.readyState===4&&d.status===200)try{if(i.responseType==="blob")s(d.response);else{let A=JSON.parse(d.responseText);A.success===!1&&(A.message=TD(A)||A.message),s(A)}}catch(A){console.warn("catch ajax error...",A),s({success:!1,message:"Network Error!"})}else d.status===404?(console.warn("catch ajax error...",d.status),s({success:!1,code:d.status,message:"Network Error!"})):d.status===500&&(console.warn("catch ajax error...",d.status),s({success:!1,code:d.status,message:"Network Error!"}))},d.onerror=function(A){console.warn("catch ajax error...",A),s({success:!1,message:"Network Error!"})},o instanceof Uint8Array){let A=new Blob([o]);d.send(A)}else d.send(o)}catch(l){console.warn("catch ajax error...",l),s({success:!1,message:"Network Error!"})}})}function Vye(t,e,r={}){if(t.toLowerCase()!=="get"&&!(e instanceof FormData)&&typeof e!="string"&&(r==null?void 0:r.contentType)!==!1&&(r=r||{},r.headers=Object.assign(r.headers||{},{"Content-type":"application/json"})),r.headers){let i={};for(let n in r.headers){let s=r.headers[n];i[n]=s}r.headers=i}}function jye(t,e,r={},i){var n;if(!(e.path||(n=r==null?void 0:r.headers)!=null&&n.path)){if(t.includes("component")&&i)e.path=i;else if(i){let s=r.headers||{};s=Object.assign(s,{path:i}),r.headers=s}return{params:e,options:r}}}function OY(t,e=50){return typeof t!="string"?!1:t.length*2>e*1024*1024}function Qye(t,e,r,i={}){var A;let n,s,a,o=[],l=i.headers,c=!1;if(r instanceof FormData)n=r;else if(typeof r=="string")n=r;else if((A=l==null?void 0:l["Content-type"])!=null&&A.includes("application/json")){if(typeof r=="object"&&r!==null){for(let h in r)if(OY(r[h])){c=!0;break}}if(c){let h=new FormData;for(let f in r){let p=r[f];OY(p)?h.append(f,new Blob([p],{type:"text/plain"})):h.append(f,typeof p=="object"?JSON.stringify(p):p)}n=h,i.headers&&(i.headers["Content-type"]="multipart/form-data")}else n=JSON.stringify(r)}else{for(s in r)if(a=r[s],a instanceof Array)for(let h=0;h<a.length;h++){let f=a[h];o.push(encodeURIComponent(`${s}[]`)+"="+encodeURIComponent(f))}else if(Object.prototype.toString.call(a)==="[object Object]")for(let h in a){let f=a[h];o.push(encodeURIComponent(`${s}[${h}]`)+"="+(f?encodeURIComponent(f):""))}else o.push(encodeURIComponent(s)+"="+encodeURIComponent(a));n=o.join("&"),t==="GET"&&n&&typeof n=="string"&&i.searchParams===!0&&(e=e+"?"+n,n={})}let u=/{[a-zA-Z]+}/gim,d=[...new Set(e.match(u))];for(let h of d){let f=h.substring(1,h.length-1);e=e.replace(h,r[f]||"")}return{params:n,url:e}}function zye(t,e,r,i={}){let n=i.headers;if(n){for(let s in n){let a=n[s];t.setRequestHeader(encodeURI(s),encodeURI(a))}i.contentType!==!1&&!n["Content-type"]&&t.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8")}else i.contentType!==!1&&t.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8");if(t.setRequestHeader("Editor-Version",self.PRO_EDITOR_VERSION||""),self.document){let s=e.toUpperCase();if(s!=="GET"&&s!=="HEAD"){let a=/XSRF-TOKEN=(\S+);?/.exec(document.cookie);a&&t.setRequestHeader("X-XSRF-TOKEN",decodeURIComponent(a[1]))}}}var Xye=1e4;function qye(t,e,r,i,n={}){return e.match(/post/i)&&r.startsWith("/")&&!r.startsWith("/servicecenter/")&&typeof i=="string"&&i.length>=Xye&&(i=Bye(new TextEncoder().encode(i),{level:1}),t.setRequestHeader("Content-Encoding","gzip")),i}async function Oj(t,e,r,i){if(!i||!r){let a=`invalid parameters ${i}|${r}.`;return{code:wi.ERR_CODE.NORMAL,success:!1,msg:a,message:a,result:null}}let n=await yn("POST",e?`/api/v4/devices/${i}/delete`:`/api/v4/components/${i}/delete`,{},{headers:{"Content-type":"application/json","content-type":"application/json",path:r}});if(n.code===0&&n.success)return{code:0,success:!0,msg:"",message:"",result:{componentId:i}};let s=n.message||n.msg||"Request Error.";return{...n,msg:s,message:s,result:{componentId:i}}}async function Wye(t,e,r){if(t){let u="operations not currently supported.";return{code:wi.ERR_CODE.NORMAL,success:!1,msg:u,message:u,result:null}}let i={code:0,success:!0,result:{devices:{succeed:[],failed:[]},symbols:{succeed:[],failed:[]},footprints:{succeed:[],failed:[]},d3models:{succeed:[],failed:[]},cbbs:{succeed:[],failed:[]},panels:{succeed:[],failed:[]}},msg:"",message:""},n=await Zx(t,!0,e,r.devices||[]);i.result.devices={...n.result};let s=await Zx(t,!1,e,r.symbols||[]);i.result.symbols={...s.result};let a=await Zx(t,!1,e,r.footprints||[]);i.result.footprints={...a.result};let o=await Zx(t,!1,e,r.d3models||[]);i.result.d3models={...o.result};let l=await Zx(t,!1,e,r.cbbs||[]);i.result.cbbs={...l.result};let c=await Zx(t,!1,e,r.panels||[]);return i.result.panels={...c.result},i}async function Zx(t,e,r,i){let n=[],s=[];for(let a=0;a<i.length;a++){let o=await Oj(t,e,r,i[a]);if(o.code===0&&o.success){n.push(i[a]);continue}n.push(i[a])}return{code:0,success:!0,result:{succeed:n,failed:s},msg:"",message:""}}function Nj(t){if(!t)return[];if(t instanceof Array)return t;let e=[];return t!=null&&t.parent_tag&&(t!=null&&t.parent_tag.uuid)&&e.push(t==null?void 0:t.parent_tag.uuid),t!=null&&t.child_tag&&(t!=null&&t.child_tag.uuid)&&e.push(t==null?void 0:t.child_tag.uuid),e}function M1(t){if(!t)return[];if(t instanceof Array)return t;let e=[];return t!=null&&t.parent_tag&&(t!=null&&t.parent_tag.name)&&e.push(t==null?void 0:t.parent_tag.name),t!=null&&t.child_tag&&(t!=null&&t.child_tag.name)&&e.push(t==null?void 0:t.child_tag.name),e}function TC(t,e=!1){return t?e?NY(t):t.indexOf("_")>=0?Jye(t):t.indexOf("@")>=0?Kye(t):NY(t):{componentTitleOrId:void 0,path:void 0,isLocaleFilenameMode:!1}}function NY(t){let e={componentTitleOrId:void 0,path:void 0,isLocaleFilenameMode:!1};if(!/\|/i.test(t))return e.isLocaleFilenameMode=!1,e.componentTitleOrId=t,e;let r=t.split("|");return e.componentTitleOrId=r[0],e.path=r[1],/\./.test(r[0])?(e.isLocaleFilenameMode=!0,e):(e.isLocaleFilenameMode=!1,e)}function Kye(t){let e={componentTitleOrId:void 0,path:void 0,isLocaleFilenameMode:!1};if(!/\@/i.test(t))return e.isLocaleFilenameMode=!1,e.componentTitleOrId=t,e;let r=t.split("@");return e.componentTitleOrId=r[0],e.path=r[1],/\./.test(r[0])?(e.isLocaleFilenameMode=!0,e):(e.isLocaleFilenameMode=!1,e)}function Jye(t){let e={componentTitleOrId:void 0,path:void 0,isLocaleFilenameMode:!1};if(!/_/i.test(t))return e.isLocaleFilenameMode=!1,e.componentTitleOrId=t,e;let r=t.split("_");return e.componentTitleOrId=r[0],e.path=r[1],/\./.test(r[0])?(e.isLocaleFilenameMode=!0,e):(e.isLocaleFilenameMode=!1,e)}async function fM(t,e){let r=TC(t,!0),i=r.path||e,n={code:wi.ERR_CODE.NORMAL,success:!0,result:null,msg:""};return n.result={createTime:0,created_at:"",creator:null,dataStr:JSON.stringify({model:`${r.componentTitleOrId}|${i}`,unit:"mm"}),display_title:r.componentTitleOrId||"-",uuid:`${r.componentTitleOrId}|${i}`||"",path:i,description:"",docType:16,modifier:null,owner:null,source:"",tags:{child_tag:[],parent_tag:[]},title:r.componentTitleOrId||"",updateTime:0,updated_at:"",version:"",public:void 0},n}var $ye=class{constructor(){if(!crypto||!crypto.subtle)throw new Error("\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301crypto api");this.tool=crypto.subtle}},Zye=class extends $ye{constructor(){super(),this.keyBuffer=null,this.key=null,this.iv=null}async init(t){try{return this.keyBuffer=t.key,this.key=await this.setKey(this.keyBuffer),this.iv=await this.setIV(t.iv),this}catch{throw new Error(`invalid key or iv! ${t}`)}}setKey(t){if(t instanceof ArrayBuffer)return this.tool.importKey("raw",t,"AES-GCM",!0,["encrypt","decrypt"]);throw new Error(`invalid key! ${t}`)}setIV(t){if(t instanceof ArrayBuffer)return t;throw new Error(`invalid iv! ${t}`)}encrypt(t){return this.tool.encrypt({name:"AES-GCM",iv:this.iv},this.key,t)}decrypt(t){return this.tool.decrypt({name:"AES-GCM",iv:this.iv},this.key,t)}decrypt2(t){return this.tool.decrypt({name:"AES-GCM",iv:this.iv,tagLength:128},this.key,t)}getKey(){return this.keyBuffer}getIV(){return this.iv}};function RY(t){let e=t.match(/[\da-f]{2}/gi);return e?new Uint8Array(e.map(function(r){return parseInt(r,16)})).buffer:null}function e1e(t,e="utf-8"){var r=new TextDecoder(e);return r.decode(t)}async function Hf(t){try{if(!t.dataStrId)return null;let e=new Headers;e.append("Content-Type","text/plain;charset=UTF-8");let r=await(await fetch(t.dataStrId,{method:"GET",redirect:"error",headers:e})).arrayBuffer();if(r){let i=await t1e(t,r);return e1e(i)}return null}catch(e){throw new Error("fetch\u5931\u8D25!!!"+e)}}async function t1e(t,e){let r=new Zye;try{let{key:i,iv:n}=t;if(e&&n&&i){let s=RY(i),a=RY(n);await r.init({key:s,iv:a});let o=await r.decrypt(e);return _ye(new Uint8Array(o))}else throw new Error(`\u6570\u636E\u89E3\u5BC6\u5931\u8D25!!!\u6570\u636E\u4E0D\u6B63\u786E:data:${e},key:${i},iv:${n}`)}catch(i){throw new Error("\u6570\u636E\u89E3\u5BC6\u5931\u8D25!!!"+i)}}async function IC(t,e=wi.SYSTEMLIB_UUID){if(!t)return null;let r=null,i=TC(t,!0);if(i.isLocaleFilenameMode)return r=(await fM(i.componentTitleOrId,i.path||wi.SYSTEMLIB_UUID)).result,r;let n=await yn("GET",`/api/v2/components/${i.componentTitleOrId}`,{},{headers:{"Content-type":"application/json","content-type":"application/json",path:i.path||wi.SYSTEMLIB_UUID}});if(n.code===0&&n.success&&typeof n.result=="object"&&(r=n.result),r&&!r.dataStr)try{let s=await Hf(r);r.dataStr=s}catch(s){console.error(s)}return r}function U0(t=new Date,e="yyyy-MM-dd HH:ii:ss"){if(Number.isNaN(t.getTime()))return"-";let r={"M+":t.getMonth()+1,"d+":t.getDate(),"H+":t.getHours(),"h+":t.getHours(),"i+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(let i in r)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,RegExp.$1.length==1?r[i]:("00"+r[i]).substr((""+r[i]).length)));return e}function r1e(t,e){function r(u){return u>=10?String(u):"0"+u}t instanceof Date?t.getTime().toString().length>13&&(t=new Date(t.getTime()/1e3)):Number.isNaN(Number(t))||t.toString().length>13&&(t=new Date(Number(t)/1e3));let i=new Date(t);if(Number.isNaN(i.getTime()))return"-";let n=i.getFullYear(),s=r(i.getMonth()+1),a=r(i.getDate()),o=r(i.getHours()),l=r(i.getMinutes()),c=r(i.getSeconds());return e==="downProject"?n+"-"+s+"-"+a:e==="migrateStandardProject"?n+"-"+s+"-"+a+"_"+o+"-"+l+"-"+c:e==="y-m-d"||e==="yyyy-MM-dd"?n+"-"+s+"-"+a:e==="y-m-d_h-m-s"?`${n}-${s}-${a}_${o}-${l}-${c}`:n+"-"+s+"-"+a+" "+o+":"+l+":"+c}function Rj(t,e,r){let i=new Date().getTime(),n=U0(new Date(i)),s={avatar:"",nickname:"",username:"",uuid:""},a=t+(r?`|${r}`:"");return{createTime:i,created_at:n,creator:{...s},dataStr:JSON.stringify({model:a,unit:"mm"}),description:"",display_title:e,docType:16,modifier:{...s},owner:{...s},path:r,public:!1,source:"",std_uuid:"",tags:{child_tag:[],parent_tag:[]},ticket:0,title:e,type:0,updateTime:i,updated_at:n,uuid:t,version:""}}async function i1e(t){return t?new Promise((e,r)=>{window.fetch(`https://modules.lceda.cn/3dmodel/${t}`,{method:"GET"}).then(async i=>{let n=await i.blob();e({code:0,success:!0,result:n,message:""})}).catch(async i=>{e({code:i?i.code:-9,success:!1,result:null,message:"fetch 3D model file failed."})})}):{code:-1,success:!1,result:null,message:"missing uuid or path or detail data."}}var pM=class{},n1e=(t=>(t.PROJECT_DOCUMENT_LOCKED="PROJECT_DOCUMENT_LOCKED",t.PROJECT_DOCUMENT_UPDATE_REJECT="PROJECT_DOCUMENT_UPDATE_REJECT",t.NOSYMBOL_ON_TARGETPATH_BY_DEVICE_BOUND="NOSYMBOL_ON_TARGETPATH_BY_DEVICE_BOUND",t.NOFOOTPRINT_ON_TARGETPATH_BY_DEVICE_BOUND="NOFOOTPRINT_ON_TARGETPATH_BY_DEVICE_BOUND",t.DEVICE_ATTRIBUTES_ERROR="DEVICE_ATTRIBUTES_ERROR",t.DEVICE_DESCRIPTION_ERROR="DEVICE_DESCRIPTION_ERROR",t.SYMBOL_DESCRIPTION_ERROR="SYMBOL_DESCRIPTION_ERROR",t.FOOTPRINT_DESCRIPTION_ERROR="FOOTPRINT_DESCRIPTION_ERROR",t.D3MODEL_DESCRIPTION_ERROR="D3MODEL_DESCRIPTION_ERROR",t.DEVICE_NAMA_ERROR="DEVICE_NAMA_ERROR",t.SYMBOL_NAMA_ERROR="SYMBOL_NAMA_ERROR",t.FOOTPRINT_NAMA_ERROR="FOOTPRINT_NAMA_ERROR",t.PANEL_LIB_NAMA_ERROR="PANEL_LIB_NAMA_ERROR",t.D3MODEL_NAMA_ERROR="D3MODEL_NAMA_ERROR",t.SIM_MODEL_NAMA_ERROR="SIM_MODEL_NAMA_ERROR",t.DEVICE_SAME_NAMA_EXISTS="DEVICE_SAME_NAMA_EXISTS",t.SYMBOL_SAME_NAMA_EXISTS="SYMBOL_SAME_NAMA_EXISTS",t.FOOTPRINT_SAME_NAMA_EXISTS="FOOTPRINT_SAME_NAMA_EXISTS",t.D3MODEL_SAME_NAMA_EXISTS="D3MODEL_SAME_NAMA_EXISTS",t.SIM_MODEL_SAME_NAMA_EXISTS="SIM_MODEL_SAME_NAMA_EXISTS",t.PANELLIB_SAME_NAMA_EXISTS="PANELLIB_SAME_NAMA_EXISTS",t.PARAMETER_VERIFICATION="PARAMETER_VERIFICATION",t.RESULT_VERIFICATION="RESULT_VERIFICATION",t.GET_DEVICE="GET_DEVICE",t.GET_DEVICE_NOT_FOUND="GET_DEVICE_NOT_FOUND",t.GET_DEVICE_LIST="GET_DEVICE_LIST",t.GET_DEVICE_SEARCH_LIST="GET_DEVICE_SEARCH_LIST",t.GET_SYMBOL="GET_SYMBOL",t.GET_SYMBOL_NOT_FOUND="GET_SYMBOL_NOT_FOUND",t.GET_SYMBOL_LIST="GET_SYMBOL_LIST",t.GET_SYMBOL_SEARCH_LIST="GET_SYMBOL_SEARCH_LIST",t.GET_FOOTPRINT="GET_FOOTPRINT",t.GET_FOOTPRINT_NOT_FOUND="GET_FOOTPRINT_NOT_FOUND",t.GET_FOOTPRINT_LIST="GET_FOOTPRINT_LIST",t.GET_FOOTPRINT_SEARCH_LIST="GET_FOOTPRINT_SEARCH_LIST",t.GET_PANEL_LIB_SEARCH_LIST="GET_PANEL_LIB_SEARCH_LIST",t.GET_D3MODEL="GET_D3MODEL",t.GET_D3MODEL_NOT_FOUND="GET_D3MODEL_NOT_FOUND",t.GET_D3MODEL_LIST="GET_D3MODEL_LIST",t.GET_D3MODEL_SEARCH_LIST="GET_D3MODEL_SEARCH_LIST",t.GET_SIM_MODEL="GET_SIM_MODEL",t.GET_SIM_NOT_FOUND="GET_SIM_NOT_FOUND",t.GET_SIM_MODEL_LIST="GET_SIM_MODEL_LIST",t.GET_SIM_MODEL_SEARCH_LIST="GET_SIM_MODEL_SEARCH_LIST",t.CROSS_BIND="CROSS_BIND",t.CROSS_BIND_EXIT="CROSS_BIND_EXIT",t.IMPORT_EXIST_PROJECT="IMPORT_EXIST_PROJECT",t.CREATE_PROJECT="CREATE_PROJECT",t.CREATE_DEVICE="CREATE_DEVICE",t.CREATE_DEVICE_DUP_TITLE="CREATE_DEVICE_DUP_TITLE",t.CREATE_DEVICE_PERMISSIONS="CREATE_DEVICE_PERMISSIONS",t.CREATE_SYMBOL="CREATE_SYMBOL",t.CREATE_SYMBOL_DUP_TITLE="CREATE_SYMBOL_DUP_TITLE",t.CREATE_SYMBOL_PERMISSIONS="CREATE_SYMBOL_PERMISSIONS",t.CREATE_SYMBOL_MIGRATE_CANVAS_ERROR="CREATE_SYMBOL_MIGRATE_CANVAS_ERROR",t.CREATE_FOOTPRINT="CREATE_FOOTPRINT",t.CREATE_FOOTPRINT_DUP_TITLE="CREATE_FOOTPRINT_DUP_TITLE",t.CREATE_FOOTPRINT_PERMISSIONS="CREATE_FOOTPRINT_PERMISSIONS",t.CREATE_FOOTPRINT_MIGRATE_CANVAS_ERROR="CREATE_FOOTPRINT_MIGRATE_CANVAS_ERROR",t.CREATE_D3MODEL="CREATE_D3MODEL",t.CREATE_D3MODEL_DUP_TITLE="CREATE_D3MODEL_DUP_TITLE",t.CREATE_D3MODEL_PERMISSIONS="CREATE_D3MODEL_PERMISSIONS",t.CREATE_PANEL_LIB="CREATE_PANEL_LIB",t.CREATE_PANEL_DUP_TITLE="CREATE_PANEL_DUP_TITLE",t.CREATE_PANEL_PERMISSIONS="CREATE_PANEL_PERMISSIONS",t.CREATE_SIM_MODEL="CREATE_SIM_MODEL",t.CREATE_SIM_MODEL_DUP_TITLE="CREATE_SIM_MODEL_DUP_TITLE",t.CREATE_SIM_MODEL_PERMISSIONS="CREATE_SIM_MODEL_PERMISSIONS",t.CREATE_SIM_MODEL_MIGRATE_CANVAS_ERROR="CREATE_SIM_MODEL_MIGRATE_CANVAS_ERROR",t.UPDATE_DEVICE="UPDATE_DEVICE",t.UPDATE_DEVICE_ATTRIBUTES="UPDATE_DEVICE_ATTRIBUTES",t.UPDATE_DEVICE_PERMISSIONS="CREATE_DEVICE_PERMISSIONS",t.UPDATE_SYMBOL="UPDATE_SYMBOL",t.UPDATE_SYMBOL_MIGRATE_CANVAS_ERROR="UPDATE_SYMBOL_MIGRATE_CANVAS_ERROR",t.UPDATE_SYMBOL_PERMISSIONS="UPDATE_SYMBOL_PERMISSIONS",t.UPDATE_FOOTPRINT="UPDATE_FOOTPRINT",t.UPDATE_FOOTPRINT_MIGRATE_CANVAS_ERROR="UPDATE_FOOTPRINT_MIGRATE_CANVAS_ERROR",t.UPDATE_FOOTPRINT_PERMISSIONS="UPDATE_FOOTPRINT_PERMISSIONS",t.UPDATE_D3MODEL_PERMISSIONS="UPDATE_D3MODEL_PERMISSIONS",t.UPDATE_SIM_MODEL="UPDATE_SIM_MODEL",t.UPDATE_SIM_MODEL_MIGRATE_CANVAS_ERROR="UPDATE_SIM_MODEL_MIGRATE_CANVAS_ERROR",t.UPDATE_SIM_MODEL_PERMISSIONS="UPDATE_SIM_MODEL_PERMISSIONS",t.DELETE_DEVICE="DELETE_DEVICE",t.DELETE_SYMBOL="DELETE_SYMBOL",t.DELETE_FOOTPRINT="DELETE_FOOTPRINT",t.DELETE_SIM_MODEL="DELETE_SIM_MODEL",t.DELETE_3DMODEL="DELETE_3DMODEL",t.GET_SOURCE="GET_SOURCE",t))(n1e||{}),Dt=class{constructor(t,e=""){this._message=e,this._action=t}get message(){return this._message}set message(t){this._message=t}get action(){return this._action}set action(t){this._action=t}toJSON(){return{message:this.message,action:this.action}}};function ea(t){if(!t){let e="missing creator data.";throw new Dt("RESULT_VERIFICATION",e)}return{uuid:t.uuid,nickname:t.nickname,username:t.username}}function ta(t){if(!t){let e="missing modifier data.";throw new Dt("RESULT_VERIFICATION",e)}return{uuid:t.uuid,nickname:t.nickname,username:t.username}}function ra(t){if(!t){let e="missing owner data.";throw new Dt("RESULT_VERIFICATION",e)}return{uuid:t.uuid,nickname:t.nickname,username:t.username}}function Ch(t,e){let r=Object.keys(e);for(let i=0;i<r.length;i++)Mbe.indexOf(r[i])<=-1||(r[i]==="title"&&"display_title"in t&&e.title&&(t.display_title=String(e.title),t.title=String(e.title).toLocaleLowerCase()),t[r[i]]=e[r[i]])}function n_(t,e){return t[e]}function Mj(t){if(!t||t.length<=0||t.length>128){let e="The title length must be between 1~128 characters!";throw new Dt("DEVICE_NAMA_ERROR",e)}}function kj(t){if(!t||t.length<=0||t.length>128){let e="The title length must be between 1~128 characters!";throw new Dt("SYMBOL_NAMA_ERROR",e)}}function Fj(t){if(!t||t.length<=0||t.length>128){let e="The title length must be between 1~128 characters!";throw new Dt("FOOTPRINT_NAMA_ERROR",e)}}function s1e(t){if(!t||t.length<=0||t.length>128){let e="The title length must be between 1~128 characters!";throw new Dt("D3MODEL_NAMA_ERROR",e)}}function Uj(t){if(!t||t.length<=0||t.length>128){let e="The title length must be between 1~128 characters!";throw new Dt("SIM_MODEL_NAMA_ERROR",e)}}async function p2(t,e){let r=[],i=[],n=async o=>{let{message:l}=await Dr.messageBus.rpcCall(hg.TAG.CREATE,o);return l},s=null;try{for(let o=0;o<t.length;o++){let l=await n({...t[o],path:t[o].user_uuid});if(l.code===0&&l.success){let u={...l,message:"",result:{...t[o],path:t[o].user_uuid,...l.result[0]}};r.push(u),e&&e(u,o);continue}let c={...l,result:{...t[o]}};i.push(c)}return{code:0,success:!0,result:{successList:r,failList:i},message:""}}catch(o){s=o}let a=s?s.msg||s.message:"Add Categories Batch Error";return{code:s?s.code:wi.ERR_CODE.NORMAL,success:!1,result:null,message:a}}function Yu(t=[],e,r){if(!t||!t.length||!e)return{index:-1,data:null};let i={index:-1,data:null};for(let n=0;n<t.length;n++)if(typeof t[n]=="object"&&t[n][e]===r){i.data=t[n],i.index=n;break}return i}function a1e(t=[],e,r){if(!t||!t.length||!e)return{indexs:[],datas:[]};let i={indexs:[],datas:[]};for(let n=0;n<t.length;n++)typeof t[n]=="object"&&t[n][e]===r&&(i.datas.push(t[n]),i.indexs.push(n));return i}function jv(t=0,e=Number.MAX_SAFE_INTEGER){return Math.floor(Math.random()*(e-t+1))+t}function dC(t=36){let e=[],r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<t;i++)e[i]=r.substr(Math.floor(Math.random()*16),1);return e[14]&&(e[14]=String(jv(1,9))),e[19]&&(e[19]=r.substr(+e[19]&3|8,1)),e[8]&&(e[8]=String(jv(1,9))),e[13]&&(e[13]=String(jv(1,9))),e[18]&&(e[18]=String(jv(1,9))),e[23]&&(e[23]=String(jv(1,9))),e.join("")}function MY(t,e=!0){return(r,i)=>{let n=r[t],s=i[t];return typeof n<"u"&&typeof s<"u"?e?n-s:s-n:0}}var o1e=class{constructor(t,e){this.extendLib=e,this.getList=t.getList,this.getSupportedPreviewTypes=t.getSupportedPreviewTypes,this.getDetail=t.getDetail,this.getClassificationTree=t.getClassificationTree,this.getFile=t.getDetail}async getTransformedList(t){let e=await this.getList(t),{count:r,page:i,pageSize:n,lists:s,totalPage:a}=e;return{count:r,page:i,pageSize:n,totalPage:a,lists:s.map(o=>this.extendLib.transformer.transformCbbListItem(o))}}async getTransformedDetail(t){return await this.getDetail(t)}async getTransformedClassificationTree(){var t,e;return(e=(t=await this.getClassificationTree())==null?void 0:t.map(r=>this.extendLib.transformer.transformCategory(r)))!=null?e:[]}},l1e=class{constructor(t,e){this.extendLib=e,this.getList=t.getList,this.getSupportedPreviewTypes=t.getSupportedPreviewTypes,this.getSupportedSymbolTypes=t.getSupportedSymbolTypes,this.getDetail=t.getDetail,this.getClassificationTree=t.getClassificationTree}async getTransformedList(t){let e=await this.getList(t),{count:r,page:i,pageSize:n,lists:s,totalPage:a}=e;return{count:r,page:i,pageSize:n,totalPage:a,lists:s.map(o=>this.extendLib.transformer.transformDeviceListItem(o))}}async getTransformedDetail(t){let e=await this.getDetail(t);return this.extendLib.transformer.transformDeviceListItem(e)}async getTransformedClassificationTree(){var t,e;return(e=(t=await this.getClassificationTree())==null?void 0:t.map(r=>this.extendLib.transformer.transformCategory(r)))!=null?e:[]}},c1e=class{constructor(t,e){this.extendLib=e,this.getList=t.getList,this.getSupportedPreviewTypes=t.getSupportedPreviewTypes,this.getDetail=t.getDetail,this.getClassificationTree=t.getClassificationTree}async getTransformedList(t){let e=await this.getList(t),{count:r,page:i,pageSize:n,lists:s=[],totalPage:a}=e,o=[];for(let l of s)o.push(await this.extendLib.transformer.transformFootprintListItem(l));return{count:r,page:i,pageSize:n,totalPage:a,lists:o}}async getTransformedDetail(t){let e=await this.getDetail(t);return await this.extendLib.transformer.transformFootprintListItem(e)}async getTransformedClassificationTree(){var t,e;return(e=(t=await this.getClassificationTree())==null?void 0:t.map(r=>this.extendLib.transformer.transformCategory(r)))!=null?e:[]}},u1e=class{constructor(t,e){this.extendLib=e,this.getList=t.getList,this.getSupportedPreviewTypes=t.getSupportedPreviewTypes,this.getSupportedSymbolTypes=t.getSupportedSymbolTypes,this.getDetail=t.getDetail,this.getClassificationTree=t.getClassificationTree}async getTransformedList(t){let e=await this.getList(t),{count:r,page:i,pageSize:n,lists:s,totalPage:a}=e,o=[];for(let l of s)o.push(await this.extendLib.transformer.transformSymbolListItem(l));return{count:r,page:i,pageSize:n,totalPage:a,lists:o}}async getTransformedDetail(t){let e=await this.getDetail(t);return await this.extendLib.transformer.transformSymbolListItem(e)}async getTransformedClassificationTree(){var t,e;return(e=(t=await this.getClassificationTree())==null?void 0:t.map(r=>this.extendLib.transformer.transformCategory(r)))!=null?e:[]}},h1e=class{constructor(t){this.extendLib=t}transformTime(t=Date.now()){return t.toString().length>13?t/1e3:t}transformTimeStr(t=Date.now()){let e=this.transformTime(t);return U0(new Date(e*1e3))}transformTags(t){let{primaryClassificationName:e,primaryClassificationUuid:r,secondaryClassificationName:i,secondaryClassificationUuid:n}=t||{};return{parent_tag:e?{uuid:r,name:e}:void 0,child_tag:i?{uuid:n,name:i}:void 0}}transformCategory(t,e){var i,n;let r=(i=t.uuid)!=null?i:crypto.randomUUID();return{id:r,title:t.name,children:(n=t.children)==null?void 0:n.map(s=>this.transformCategory(s,r)),parentId:e}}transformDeviceListItem(t){var e,r,i,n,s,a,o,l;return{title:t.name||"",description:t.description||"",images:[],uuid:t.uuid||this.extendLib.getDefaultItemId(),path:this.extendLib.id,source:"",version:"",ticket:0,updateTime:this.transformTime(t.updateTime),createTime:this.transformTime(t.createTime||t.updateTime),display_title:t.name||"",creator:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},modifier:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},owner:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},attributes:{...(e=t.attributes)!=null?e:{},Footprint:((r=t.footprint)==null?void 0:r.uuid)||"",Symbol:((i=t.symbol)==null?void 0:i.uuid)||"",value:t.value||((n=t.attributes)==null?void 0:n.value)||"",supplierPart:t.supplierPart||((s=t.attributes)==null?void 0:s.supplierPart)||"",manufacturer:t.manufacturer||((a=t.attributes)==null?void 0:a.manufacturer)||"",description:t.description||((o=t.attributes)==null?void 0:o.description)||""},symbol:t.symbol?{display_title:t.symbol.name||""}:void 0,footprint:t.footprint?{display_title:t.footprint.name||""}:void 0,tags:this.transformTags(t.classification),symbol_type:(l=t.symbol)==null?void 0:l.symbolType}}async transformSymbolListItem(t){var e,r,i,n,s,a,o,l,c,u;return{docType:t.symbolType,uuid:t.uuid||this.extendLib.getDefaultItemId(),title:t.name||"",description:t.description||"",path:this.extendLib.id,source:"",version:(e=t.version)!=null?e:"",ticket:0,updateTime:this.transformTime(t.updateTime),createTime:this.transformTime(t.createTime||t.updateTime),display_title:t.name||"",creator:t.creator?{nickname:(r=t.creator.name)!=null?r:"",username:(i=t.creator.name)!=null?i:"",uuid:(n=t.creator.uuid)!=null?n:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},modifier:t.modifier?{nickname:(s=t.modifier.name)!=null?s:"",username:(a=t.modifier.name)!=null?a:"",uuid:(o=t.modifier.uuid)!=null?o:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},owner:t.owner?{nickname:(l=t.owner.name)!=null?l:"",username:(c=t.owner.name)!=null?c:"",uuid:(u=t.owner.uuid)!=null?u:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},dataStr:t.data instanceof Blob?await t.data.text():t.data,tags:this.transformTags(t.classification)}}async transformFootprintListItem(t){var e,r,i,n,s,a,o,l,c,u;return{docType:4,uuid:t.uuid||this.extendLib.getDefaultItemId(),title:t.name||"",description:t.description||"",path:this.extendLib.id,source:"",version:(e=t.version)!=null?e:"",ticket:0,updateTime:this.transformTime(t.updateTime),createTime:this.transformTime(t.createTime||t.updateTime),display_title:t.name||"",creator:t.creator?{nickname:(r=t.creator.name)!=null?r:"",username:(i=t.creator.name)!=null?i:"",uuid:(n=t.creator.uuid)!=null?n:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},modifier:t.modifier?{nickname:(s=t.modifier.name)!=null?s:"",username:(a=t.modifier.name)!=null?a:"",uuid:(o=t.modifier.uuid)!=null?o:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},owner:t.owner?{nickname:(l=t.owner.name)!=null?l:"",username:(c=t.owner.name)!=null?c:"",uuid:(u=t.owner.uuid)!=null?u:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},dataStr:t.data instanceof Blob?await t.data.text():t.data,tags:this.transformTags(t.classification)}}transformCbbListItem(t){var e,r,i,n,s,a,o,l,c,u,d,A,h,f,p,m,y,g,b,E,w,x,I,C,G,U,_,H,Q,j,$,B,M,v,N,R,q;return{cbb_project:!0,content:(e=t.description)!=null?e:"",creator:t.creator?{avatar:"",nickname:(r=t.creator.name)!=null?r:"",username:(i=t.creator.name)!=null?i:"",uuid:(n=t.creator.uuid)!=null?n:""}:{avatar:"",nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},modifier:t.modifier?{nickname:(s=t.modifier.name)!=null?s:"",username:(a=t.modifier.name)!=null?a:"",uuid:(o=t.modifier.uuid)!=null?o:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},owner:t.owner?{avatar:"",team:!1,nickname:(l=t.owner.name)!=null?l:"",username:(c=t.owner.name)!=null?c:"",uuid:(u=t.owner.uuid)!=null?u:""}:{avatar:"",team:!1,nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},name:t.name,path:this.extendLib.id,block_symbol:(A=(d=t.blockSymbols)==null?void 0:d.map(P=>{var z;return{uuid:P.uuid,display_title:P.name,docType:17,project_uuid:(z=t.uuid)!=null?z:t.name,title:P.name.toLocaleLowerCase()}}))!=null?A:[],schematics:(f=(h=t.schematics)==null?void 0:h.map(P=>{var W,oe;let z=(oe=(W=t.sheets)==null?void 0:W.filter(Ae=>Ae.belongSchematicUuid===P.uuid).map(Ae=>({uuid:Ae.uuid,ticket:0})))!=null?oe:[];return{create_at:this.transformTimeStr(P.createTime||P.updateTime),createtime:this.transformTime(P.createTime||P.updateTime),display_name:P.name,name:P.name.toLocaleLowerCase(),project_uuid:t.uuid,sheet_count:z.length,sort:z,ticket:0,update_at:this.transformTimeStr(P.updateTime),uuid:P.uuid,updateTime:this.transformTime(P.updateTime)}}))!=null?f:[],pcb:(m=(p=t.pcbs)==null?void 0:p.map(P=>{var z,W,oe,Ae,me,ve,Le,He,rt,qe,xt;return{description:(z=P.description)!=null?z:"",display_title:P.name,docType:3,project_uuid:(W=t.uuid)!=null?W:"",thumb:P.thumb,title:P.name.toLocaleLowerCase(),updateTime:this.transformTime(P.updateTime),uuid:P.uuid,creator:P.creator?{avatar:"",nickname:(Ae=(oe=P.creator)==null?void 0:oe.name)!=null?Ae:"",username:(ve=(me=P.creator)==null?void 0:me.name)!=null?ve:"",uuid:(He=(Le=P.creator)==null?void 0:Le.uuid)!=null?He:""}:{avatar:"",nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},modifier:P.modifier?{nickname:(rt=P==null?void 0:P.modifier.name)!=null?rt:"",username:(qe=P==null?void 0:P.modifier.name)!=null?qe:"",uuid:(xt=P==null?void 0:P.modifier.uuid)!=null?xt:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id}}}))!=null?m:[],schs:(g=(y=t.sheets)==null?void 0:y.map(P=>{var z,W,oe,Ae,me,ve,Le,He;return{description:(z=P.description)!=null?z:"",display_title:P.name,docType:1,project_uuid:(W=t.uuid)!=null?W:"",schematic_uuid:P.belongSchematicUuid,thumb:P.thumb,title:P.name.toLocaleLowerCase(),updateTime:this.transformTime(P.updateTime),uuid:P.uuid,creator:P.creator?{avatar:"",nickname:(oe=P==null?void 0:P.creator.name)!=null?oe:"",username:(Ae=P==null?void 0:P.creator.name)!=null?Ae:"",uuid:(me=P==null?void 0:P.creator.uuid)!=null?me:""}:{avatar:"",nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},modifier:P!=null&&P.modifier?{nickname:(ve=P==null?void 0:P.modifier.name)!=null?ve:"",username:(Le=P==null?void 0:P.modifier.name)!=null?Le:"",uuid:(He=P==null?void 0:P.modifier.uuid)!=null?He:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id}}}))!=null?g:[],tags:{parent_tag:{name:(E=(b=t.classification)==null?void 0:b.primaryClassificationName)!=null?E:"",name_cn:(x=(w=t.classification)==null?void 0:w.primaryClassificationName)!=null?x:"",title:(C=(I=t.classification)==null?void 0:I.primaryClassificationName)!=null?C:"",uuid:(U=(G=t.classification)==null?void 0:G.primaryClassificationUuid)!=null?U:""},child_tag:{name:(H=(_=t.classification)==null?void 0:_.secondaryClassificationName)!=null?H:"",name_cn:(j=(Q=t.classification)==null?void 0:Q.secondaryClassificationName)!=null?j:"",title:(B=($=t.classification)==null?void 0:$.secondaryClassificationName)!=null?B:"",uuid:(v=(M=t.classification)==null?void 0:M.secondaryClassificationUuid)!=null?v:""}},updated_at:this.transformTimeStr(t.updateTime),uuid:(N=t.uuid)!=null?N:t.name,boards:(q=(R=t.boards)==null?void 0:R.map(P=>({name:P.name,pcb:P.pcbUuid,sch:P.schUuid})))!=null?q:[]}}},d1e=class Hj{constructor(e){this.transformer=new h1e(this),this.id=e.id,this.isVisible=r=>e.isVisible?e.isVisible(r)&&this.isInTab(r.tabName):this.isInTab(r.tabName),this.title=e.title,this.position=e.position,e.device&&(this.device=new l1e(e.device,this)),e.symbol&&(this.symbol=new u1e(e.symbol,this)),e.footprint&&(this.footprint=new c1e(e.footprint,this)),e.cbb&&(this.cbb=new o1e(e.cbb,this))}static async set(e){var i,n,s,a,o,l,c,u;let r=new Hj(e);return r._deviceSupportedSymbolTypes=await((n=(i=e.device)==null?void 0:i.getSupportedSymbolTypes)==null?void 0:n.call(i)),r._symbolSupportedSymbolTypes=await((a=(s=e.symbol)==null?void 0:s.getSupportedSymbolTypes)==null?void 0:a.call(s)),r._deviceSupportedPreviewTypes=await((l=(o=e.device)==null?void 0:o.getSupportedPriviewTypes)==null?void 0:l.call(o)),r._footprintSupportedPreviewTypes=await((u=(c=e.footprint)==null?void 0:c.getSupportedPriviewTypes)==null?void 0:u.call(c)),r}getDefaultItemId(){return crypto.randomUUID().replace("-","")}getLibraryFunctionsClassInTab(e){switch(e){case"cbb":return this==null?void 0:this.cbb;case"device":return this==null?void 0:this.device;case"symbol":return this==null?void 0:this.symbol;case"footprint":return this==null?void 0:this.footprint;default:return null}}isInTab(e){return!!this.getLibraryFunctionsClassInTab(e)}isHasCategoryTreeInTab(e){var r;return!!((r=this.getLibraryFunctionsClassInTab(e))!=null&&r.getClassificationTree)}async getAmountByWd(e,r){var i,n,s;return(s=(n=await((i=this.getLibraryFunctionsClassInTab(e))==null?void 0:i.getList({page:1,pageSize:1,query:{wd:r}})))==null?void 0:n.count)!=null?s:0}getTabByCategoryType(e){switch(e){case 1:return"cbb";case 3:return"device";case 2:return"symbol";case 4:return"footprint";default:return null}}async getClassificationTreeInTab(e){var r;return this.isHasCategoryTreeInTab(e)?await((r=this.getLibraryFunctionsClassInTab(e))==null?void 0:r.getClassificationTree()):null}async getCategoryTreeDataItemsInTab(e){var r;return(r=await this.getClassificationTreeInTab(e))==null?void 0:r.map(i=>this.transformer.transformCategory(i))}async getClassificationTreeByCategoryType(e){let r=this.getTabByCategoryType(e);return r&&this.getClassificationTreeInTab(r)}async getCategoryTreeDataItemsByCategoryType(e){let r=this.getTabByCategoryType(e);return r&&this.getCategoryTreeDataItemsInTab(r)}getSelectTypeListInTab(e){let r=[];if(e==="device"){let i=this._deviceSupportedSymbolTypes;r=i?SY.filter(n=>i.includes(Number(n.value))||!n.value):SY}else if(e==="symbol"){let i=this._symbolSupportedSymbolTypes;r=i?TY.filter(n=>i.includes(Number(n.value))||!n.value):TY}return r.length>2?r:[]}getPreviewTypesInTab(e){let r=sye[e];return e==="device"&&this._deviceSupportedPreviewTypes?r=r.filter(i=>{var n;return(n=this._deviceSupportedPreviewTypes)==null?void 0:n.includes(i)}):e==="footprint"&&this._footprintSupportedPreviewTypes&&(r=r.filter(i=>{var n;return(n=this._footprintSupportedPreviewTypes)==null?void 0:n.includes(i)})),r}async getListInTab(e,r){var i;return await((i=this.getLibraryFunctionsClassInTab(e))==null?void 0:i.getList(r))}async getTransformedListInTab(e,r){var i;return await((i=this.getLibraryFunctionsClassInTab(e))==null?void 0:i.getTransformedList(r))}async getDetailInTab(e,r){var i;return await((i=this.getLibraryFunctionsClassInTab(e))==null?void 0:i.getDetail(r))}async getTransformedDetailInTab(e,r){var i;return await((i=this.getLibraryFunctionsClassInTab(e))==null?void 0:i.getTransformedDetail(r))}},A1e=class{constructor(t=10){this._runingCount=0,this._handleCount=0,this._queue=[],this._results=[],this._windowSize=t,this._finishCallback=null,this._taskStartCallback=null,this._taskEndCallback=null}pushTask(t){this._queue.push(t)}setFinishCallback(t){this._finishCallback=t}setTaskStartCallback(t){this._taskStartCallback=t}setTaskEndCallback(t){this._taskEndCallback=t}next(){for(;this._runingCount<this._windowSize&&this._queue.length>0;){this._runingCount+=1,this._handleCount+=1;let t=this._handleCount-1,e=this._queue.shift();this._taskStartCallback&&this._taskStartCallback(t),e(t).then(r=>{this._results.push(r)}).catch(r=>{this._results.push(r)}).finally(()=>{this._runingCount-=1,this._taskEndCallback&&this._taskEndCallback(this._results[this._results.length-1]),this.next()})}this._runingCount<=0&&this._finishCallback&&this._finishCallback(this._results)}},mM=class{onString(t,e,r){}onAttr(t,e,r){}onGroup(t,e,r,i,n){}onDelGroup(t,e,r,i){}onDelString(t,e,r,i){}onDelAttr(t,e,r,i){}onPanelizeSide(t,e,r,i){}onDelPanelizeSide(t,e,r,i){}onPanelizeStamp(t,e,r,i){}onDelPanelizeStamp(t,e,r,i){}onPanelize(t,e,r,i){}onDelPanelize(t,e,r){}onRuleSelector(t,e,r,i){}onDelRuleSelector(t,e,r,i){}onRule(t,e,r,i){}onDelRule(t,e,r,i,n){}onRuleTemplate(t,e,r,i){}onDimension(t,e,r,i,n,s){}onDelDimension(t,e,r,i){}onBoss(t,e,r,i,n,s){}onDelBoss(t,e,r,i){}onShellEntity(t,e,r,i,n,s){}onDelShellEntity(t,e,r,i){}onShellCut(t,e,r,i,n,s){}onDelShellCut(t,e,r,i){}onCrease(t,e,r,i,n,s){}onDelCrease(t,e,r,i){}onShell(t,e,r,i,n,s){}onDelShell(t,e,r,i){}onFpcFill(t,e,r,i,n,s){}onDelFpcFill(t,e,r,i){}onTeardrop(t,e,r,i,n,s){}onDelTeardrop(t,e,r,i){}onImage(t,e,r,i,n,s){}onDelImage(t,e,r,i){}onPoured(t,e,r,i,n,s){}onDelPoured(t,e,r,i){}onPour(t,e,r,i,n,s){}onDelPour(t,e,r,i){}onRegion(t,e,r,i,n,s){}onDelRegion(t,e,r,i){}onFill(t,e,r,i,n,s){}onDelFill(t,e,r,i){}onPoly(t,e,r,i,n,s){}onDelPoly(t,e,r,i){}onEQLenGrp(t,e,r,i,n){}onDelEQLenGrp(t,e,r,i){}onDelProp(t,e,r,i){}onObj(t,e,r,i,n,s){}onDelObj(t,e,r,i){}onArc(t,e,r,i,n,s){}onDelArc(t,e,r,i){}onCArc(t,e,r,i,n,s){}onDelCArc(t,e,r,i){}onLine(t,e,r,i,n,s){}onDelLine(t,e,r,i){}onPad(t,e,r,i,n,s){}onDelPad(t,e,r,i){}onVia(t,e,r,i,n,s){}onDelVia(t,e,r,i){}onDelConnect(t,e,r,i){}onPreference(t,e,r,i){}onSilkOpts(t,e,r,i,n){}onDelSilkOpts(t,e,r,i){}onPrimitive(t,e,r,i,n){}onDelPrimitive(t,e,r,i){}onNet(t,e,r,i,n){}onDelNet(t,e,r,i){}onPartition(t,e,r,i,n,s){}onDelPartition(t,e,r,i){}onActiveLayer(t,e,r,i){}onLayerPhys(t,e,r,i,n){}onDelLayerPhys(t,e,r,i){}onLayer(t,e,r,i,n){}onDelLayer(t,e,r,i){}onCanvas(t,e,r,i){}onDocDetail(t,e,r,i){}onStringNum(t,e){}onAttrNum(t,e){}onDimensionNum(t,e){}onBossNum(t,e){}onShellEntityNum(t,e){}onShellCutNum(t,e){}onCreaseNum(t,e){}onShellNum(t,e){}onFpcFillNum(t,e){}onTeardropNum(t,e){}onImageNum(t,e){}onPouredNum(t,e){}onPourNum(t,e){}onRegionNum(t,e){}onFillNum(t,e){}onPolyNum(t,e){}onObjNum(t,e){}onArcNum(t,e){}onCArcNum(t,e){}onLineNum(t,e){}onPadNum(t,e){}onViaNum(t,e){}onPartitionNum(t,e){}},f1e=class extends mM{constructor(t){super(),this.source={},this._action=t}get action(){return this._action}getSource(){return this.source}onString(t,e,r){this.source[t]=e}onAttr(t,e,r){r||(this.action&&this.action(t,e),this.source[t]=e)}onDimension(t,e,r,i,n,s){this.source[t]=n}onBoss(t,e,r,i,n,s){this.source[t]=n}onShellEntity(t,e,r,i,n,s){this.source[t]=n}onShellCut(t,e,r,i,n,s){this.source[t]=n}onCrease(t,e,r,i,n,s){this.source[t]=n}onShell(t,e,r,i,n,s){this.source[t]=n}onFpcFill(t,e,r,i,n,s){this.source[t]=n}onTeardrop(t,e,r,i,n,s){this.source[t]=n}onImage(t,e,r,i,n,s){this.source[t]=n}onPoured(t,e,r,i,n,s){this.source[t]=n}onPour(t,e,r,i,n,s){this.source[t]=n}onRegion(t,e,r,i,n,s){this.source[t]=n}onFill(t,e,r,i,n,s){this.source[t]=n}onPoly(t,e,r,i,n,s){this.source[t]=n}onObj(t,e,r,i,n,s){this.source[t]=n}onArc(t,e,r,i,n,s){this.source[t]=n}onCArc(t,e,r,i,n,s){this.source[t]=n}onLine(t,e,r,i,n,s){this.source[t]=n}onPad(t,e,r,i,n,s){this.source[t]=n}onVia(t,e,r,i,n,s){this.source[t]=n}},Gj=class extends _V{onBoard(t,e,r,i){}onDelBoard(t,e,r){}constructor(t,e,r){super(t,e,r,new oM(!1)),this._compilerHandler=null}async init(t=!1,e=!1,r=!1,i=!1){return super.init(t,e,r,i)}onBlob(t,e,r,i,n){}onDelBlob(t,e,r,i){}onFont(t,e,r,i){}onDelFont(t,e,r,i){}canvasSelected(){return""}onSelectChange(t,e,r){}onSelectQuit(t,e){}onLayerFill(t,e,r,i,n){}onDelLayerFill(t,e,r,i){}setHandler(t){this._compilerHandler=t}onGroup(t,e,r,i,n){this._compilerHandler&&this._compilerHandler.onGroup(t,e,r,i,n)}onDelGroup(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelGroup(t,e,r,i)}onString(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onString(t,n,s)}onDelString(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelString(t,e,r,i)}onAttr(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onAttr(t,n,s)}onDelAttr(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelAttr(t,e,r,i)}onPanelizeSide(t,e,r,i){this._compilerHandler&&this._compilerHandler.onPanelizeSide(t,e,r,i)}onDelPanelizeSide(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelPanelizeSide(t,e,r,i)}onPanelizeStamp(t,e,r,i){this._compilerHandler&&this._compilerHandler.onPanelizeStamp(t,e,r,i)}onDelPanelizeStamp(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelPanelizeStamp(t,e,r,i)}onPanelize(t,e,r,i){this._compilerHandler&&this._compilerHandler.onPanelize(t,e,r,i)}onDelPanelize(t,e,r){this._compilerHandler&&this._compilerHandler.onDelPanelize(t,e,r)}onRuleSelector(t,e,r,i){this._compilerHandler&&this._compilerHandler.onRuleSelector(t,e,r,i)}onDelRuleSelector(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelRuleSelector(t,e,r,i)}onRule(t,e,r,i){this._compilerHandler&&this._compilerHandler.onRule(t,e,r,i)}onDelRule(t,e,r,i,n){this._compilerHandler&&this._compilerHandler.onDelRule(t,e,r,i,n)}onRuleTemplate(t,e,r,i){this._compilerHandler&&this._compilerHandler.onRuleTemplate(t,e,r,i)}onDimension(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onDimension(t,e,r,i,n,s)}onDelDimension(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelDimension(t,e,r,i)}onBoss(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onBoss(t,e,r,i,n,s)}onDelBoss(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelBoss(t,e,r,i)}onShellEntity(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onShellEntity(t,e,r,i,n,s)}onDelShellEntity(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelShellEntity(t,e,r,i)}onShellCut(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onShellCut(t,e,r,i,n,s)}onDelShellCut(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelShellCut(t,e,r,i)}onCrease(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onCrease(t,e,r,i,n,s)}onDelCrease(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelCrease(t,e,r,i)}onShell(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onShell(t,e,r,i,n,s)}onDelShell(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelShell(t,e,r,i)}onFpcFill(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onFpcFill(t,e,r,i,n,s)}onDelFpcFill(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelFpcFill(t,e,r,i)}onTeardrop(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onTeardrop(t,e,r,i,n,s)}onDelTeardrop(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelTeardrop(t,e,r,i)}onImage(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onImage(t,e,r,i,n,s)}onDelImage(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelImage(t,e,r,i)}onPoured(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onPoured(t,e,r,i,n,s)}onDelPoured(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelPoured(t,e,r,i)}onPour(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onPour(t,e,r,i,n,s)}onDelPour(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelPour(t,e,r,i)}onRegion(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onRegion(t,e,r,i,n,s)}onDelRegion(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelRegion(t,e,r,i)}onFill(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onFill(t,e,r,i,n,s)}onDelFill(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelFill(t,e,r,i)}onPoly(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onPoly(t,e,r,i,n,s)}onDelPoly(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelPoly(t,e,r,i)}onEQLenGrp(t,e,r,i,n){this._compilerHandler&&this._compilerHandler.onEQLenGrp(t,e,r,i,n)}onDelEQLenGrp(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelEQLenGrp(t,e,r,i)}onDelProp(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelProp(t,e,r,i)}onObj(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onObj(t,e,r,i,n,s)}onDelObj(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelObj(t,e,r,i)}onArc(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onArc(t,e,r,i,n,s)}onDelArc(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelArc(t,e,r,i)}onCArc(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onCArc(t,e,r,i,n,s)}onDelCArc(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelCArc(t,e,r,i)}onLine(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onLine(t,e,r,i,n,s)}onDelLine(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelLine(t,e,r,i)}onPad(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onPad(t,e,r,i,n,s)}onDelPad(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelPad(t,e,r,i)}onVia(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onVia(t,e,r,i,n,s)}onDelVia(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelVia(t,e,r,i)}onDelConnect(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelConnect(t,e,r,i)}onPreference(t,e,r,i){this._compilerHandler&&this._compilerHandler.onPreference(t,e,r,i)}onSilkOpts(t,e,r,i,n){this._compilerHandler&&this._compilerHandler.onSilkOpts(t,e,r,i,n)}onDelSilkOpts(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelSilkOpts(t,e,r,i)}onPrimitive(t,e,r,i,n){this._compilerHandler&&this._compilerHandler.onPrimitive(t,e,r,i,n)}onDelPrimitive(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelPrimitive(t,e,r,i)}onNet(t,e,r,i,n){this._compilerHandler&&this._compilerHandler.onNet(t,e,r,i,n)}onDelNet(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelNet(t,e,r,i)}onPartition(t,e,r,i,n,s){this._compilerHandler&&this._compilerHandler.onPartition(t,e,r,i,n,s)}onDelPartition(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelPartition(t,e,r,i)}onActiveLayer(t,e,r,i){this._compilerHandler&&this._compilerHandler.onActiveLayer(t,e,r,i)}onLayerPhys(t,e,r,i,n){this._compilerHandler&&this._compilerHandler.onLayerPhys(t,e,r,i,n)}onDelLayerPhys(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelLayerPhys(t,e,r,i)}onLayer(t,e,r,i,n){this._compilerHandler&&this._compilerHandler.onLayer(t,e,r,i,n)}onDelLayer(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDelLayer(t,e,r,i)}onCanvas(t,e,r,i){this._compilerHandler&&this._compilerHandler.onCanvas(t,e,r,i)}onDocDetail(t,e,r,i){this._compilerHandler&&this._compilerHandler.onDocDetail(t,e,r,i)}onStringNum(t,e){this._compilerHandler&&this._compilerHandler.onStringNum(t,e)}onAttrNum(t,e){this._compilerHandler&&this._compilerHandler.onAttrNum(t,e)}onDimensionNum(t,e){this._compilerHandler&&this._compilerHandler.onDimensionNum(t,e)}onBossNum(t,e){this._compilerHandler&&this._compilerHandler.onBossNum(t,e)}onShellEntityNum(t,e){this._compilerHandler&&this._compilerHandler.onShellEntityNum(t,e)}onShellCutNum(t,e){this._compilerHandler&&this._compilerHandler.onShellCutNum(t,e)}onCreaseNum(t,e){this._compilerHandler&&this._compilerHandler.onCreaseNum(t,e)}onShellNum(t,e){this._compilerHandler&&this._compilerHandler.onShellNum(t,e)}onFpcFillNum(t,e){this._compilerHandler&&this._compilerHandler.onFpcFillNum(t,e)}onTeardropNum(t,e){this._compilerHandler&&this._compilerHandler.onTeardropNum(t,e)}onImageNum(t,e){this._compilerHandler&&this._compilerHandler.onImageNum(t,e)}onPouredNum(t,e){this._compilerHandler&&this._compilerHandler.onPouredNum(t,e)}onPourNum(t,e){this._compilerHandler&&this._compilerHandler.onPourNum(t,e)}onRegionNum(t,e){this._compilerHandler&&this._compilerHandler.onRegionNum(t,e)}onFillNum(t,e){this._compilerHandler&&this._compilerHandler.onFillNum(t,e)}onPolyNum(t,e){this._compilerHandler&&this._compilerHandler.onPolyNum(t,e)}onObjNum(t,e){this._compilerHandler&&this._compilerHandler.onObjNum(t,e)}onArcNum(t,e){this._compilerHandler&&this._compilerHandler.onArcNum(t,e)}onCArcNum(t,e){this._compilerHandler&&this._compilerHandler.onCArcNum(t,e)}onLineNum(t,e){this._compilerHandler&&this._compilerHandler.onLineNum(t,e)}onPadNum(t,e){this._compilerHandler&&this._compilerHandler.onPadNum(t,e)}onViaNum(t,e){this._compilerHandler&&this._compilerHandler.onViaNum(t,e)}onPartitionNum(t,e){this._compilerHandler&&this._compilerHandler.onPartitionNum(t,e)}},Yj=(t=>(t.CREATE="/pro-mgr/library/lib/create",t.UPDATE="/pro-mgr/library/lib/update",t.CANCEL_ASSOCIATE="/pro-mgr/library/lib/cancelAssociate",t.DELETE="/pro-mgr/library/lib/delete",t.BATCH_GET="/pro-mgr/library/lib/batchGet",t.GET="/pro-mgr/library/lib/get",t.GET1="/pro-mgr/library/lib/get1",t.CREATE1="/pro-mgr/library/lib/create1",t.UPDATE1="/pro-mgr/library/lib/update1",t.UPDATE_DEVICES="/pro-mgr/library/lib/updateDevices",t.STAR="/pro-mgr/library/lib/star",t.UNSTAR="/pro-mgr/library/lib/unstar",t.FORCE="/pro-mgr/library/lib/force",t.UPLOAD="/pro-mgr/library/lib/upload",t.DEVICE_LIST="/pro-mgr/library/lib/device/list",t.DEVICE_SEARCH_LIST="/pro-mgr/library/lib/device/searchList",t.DEVICE_SEARCH_BY_USERS_AND_TITLES="/pro-mgr/library/lib/device/searchByUsersAndTitles",t.DEVICE_GET_ATTR_VALUES="/pro-mgr/library/lib/device/getAttributeValues",t.DEVICE_GET_ATTR_KEYS="/pro-mgr/library/lib/device/getAttrKeys",t.COMPONENT_LIST="/pro-mgr/library/lib/component/list",t.COMPONENT_SEARCH_LIST="/pro-mgr/library/lib/component/searchList",t.COMPONENT_SEARCH_BY_USERS_AND_TITLES="/pro-mgr/library/lib/component/searchByUsersAndTitles",t))(Yj||{}),Vj=(t=>(t.GET_DEVICE="/pro-mgr/library/sheetSymbol/getDevice",t.GET_SYMBOL="/pro-mgr/library/sheetSymbol/getSymbol",t.FORCE="/pro-mgr/library/sheetSymbol/force",t.GET="/pro-mgr/library/sheetSymbol/get",t.CREATE="/pro-mgr/library/sheetSymbol/create",t.UPDATE="/pro-mgr/library/sheetSymbol/update",t.SET_CUSTOM="/pro-mgr/library/sheetSymbol/setCustom",t))(Vj||{}),p1e={LIB:Yj,SHEET_SYMBOL:Vj};async function jj(t,e,r,i){let{message:n}=await Dr.messageBus.rpcCall(p1e.LIB.COMPONENT_SEARCH_LIST,{titles:JSON.stringify([t]),docType:[+e],type:r,user_uuid:i,path:i});return n&&n.success?n:{...n}}async function m1e(t,e,r,i,n=!1){let s=await jj(t,e,r,i);if(!s.success||s.result===null)return{isExist:!1,component:null};if(q4)return n===!0?{isExist:!1,component:null}:{isExist:s&&s.result?s.result.length>0:!1,component:s.result};let a=[];s&&s.success&&s.result&&(s.result instanceof Array?a=s.result:a=s.result[t]||[]);let o=a.filter(l=>l.owner.uuid==i);return{isExist:o.length>0,component:o||null}}function g1e(t,e){let r=0;return function(...i){let n=new Date().getTime();n-r>e&&(t.apply(this,i),r=n)}}function y1e(t,e,r){let i,n,s,a,o,l,c=0,u=!1,d=!1,A=!0;if(typeof t!="function")throw new TypeError("Expected a function");e=Number(e)||0,typeof r=="object"&&(u=!!r.leading,d="maxWait"in r,s=d?Math.max(Number(r.maxWait)||0,e):s,A="trailing"in r?!!r.trailing:A);function h(x){let I=i,C=n;return i=n=void 0,c=x,a=t.apply(C,I),a}function f(x){return c=x,o=window.setTimeout(y,e),u?h(x):a}function p(x){let I=x-l,C=x-c,G=e-I;return d?Math.min(G,s-C):G}function m(x){let I=x-l,C=x-c;return l===void 0||I>=e||I<0||d&&C>=s}function y(){let x=Date.now();if(m(x))return g(x);o=window.setTimeout(y,p(x))}function g(x){return o=void 0,A&&i?h(x):(i=n=void 0,a)}function b(){o!==void 0&&clearTimeout(o),c=0,i=l=n=o=void 0}function E(){return o===void 0?a:g(Date.now())}function w(){let x=Date.now(),I=m(x);if(i=arguments,n=this,l=x,I){if(o===void 0)return f(l);if(d)return o=window.setTimeout(y,e),h(l)}return o===void 0&&(o=window.setTimeout(y,e)),a}return w.cancel=b,w.flush=E,w}var S1=new Map;S1.set("<","&lt;"),S1.set(">","&gt;"),S1.set('"',"&quot;"),S1.set("'","&apos;"),S1.set("&","&amp;");function Qj(t){if(typeof t!="string")return t;if(t==null)return"";function e(r){return S1.get(r)}return t==null?"":zD(t,S1)?(t+"").replace(/[<>'"&]/g,e):t}var w1=new Map;w1.set("&lt;","<"),w1.set("&gt;",">"),w1.set("&quot;",'"'),w1.set("&apos;","'"),w1.set("&amp;","&"),w1.set("&#039;","'");function b1e(t){if(typeof t!="string")return t;if(t==null)return"";let e={"&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&amp;":"&","&#039;":"'"};function r(i){return w1.get(i)}return zD(t,e)?(t+"").replace(/&([^;]+);/g,r):t}var eC=new Map;eC.set("~","&#126;"),eC.set("^","&#94;"),eC.set("#@$","&#35;&#64;&#36;"),eC.set("`","&#96;");function x1e(t){if(typeof t!="string")return t;if(t==null)return"";let e={"~":"&#126;","^":"&#94;","#@$":"&#35;&#64;&#36;","`":"&#96;"};function r(i){return eC.get(i)}return zD(t,e)?t.replace(/(\~|\^|#@\$|\`)/g,r):t}function Y4(t){if(typeof t!="object"||t===null||t===void 0)return t;if(Array.isArray(t))return t.map(Y4);{let e={};for(let r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=Y4(t[r]));return e}}function V4(t){if(typeof t!="object"||t===null||t instanceof Date)return typeof t=="string"&&t.includes("<")&&(t=Qj(t)),t;if(Array.isArray(t))return t.map(V4);{let e={};for(let r in t)t.hasOwnProperty(r)&&(e[r]=V4(t[r]));return e}}function E1e(t,e){let r="",i="";for(let n=0;n<t.length;n++)String(t[n])&&(i+=t[n]+"	");i=i.slice(0,-1),r+=i+`\r
`;for(let n=0;n<e.length;n++){i="";for(let s=0;s<t.length;s++)i+='"'+(typeof e[n][s]<"u"?e[n][s]:"")+'"	';i=i.slice(0,i.length-1),r+=i+`\r
`}return r}function w1e(t,e={targetType:"blob"}){let{targetType:r,width:i,height:n}=e,s=new Image(i,n);return new Promise((a,o)=>{s.onload=function(){let l=document.createElement("canvas"),c=l.getContext("2d");switch(l.width=s.width,l.height=s.height,c.drawImage(s,0,0,s.width,s.height),r){case"dataURL":{a(l.toDataURL());break}case"blob":default:{l.toBlob(u=>{a(u)});break}}},s.onerror=l=>{o(l)},s.src=t})}async function v1e(t,e={}){return new Promise((r,i)=>{try{let{targetType:n="blob",imageType:s="image/png"}=e,a=document.createElement("canvas"),o=a.getContext("2d");switch(a.width=t.width,a.height=t.height,o.putImageData(t,0,0),n){case"dataURL":{r(a.toDataURL(s));break}case"blob":default:{a.toBlob(l=>{r(l)},s);break}}}catch(n){i(n)}})}var C1e=class extends mM{constructor(t){super(),this._action=t}get action(){return this._action}onAttr(t,e,r){r||this.action(e.key,e.value)}};async function S1e(t,e,r,i=!0){let n={initResponse:null,d3modelItem:null,d3modelItemName:void 0,d3modelItemTransform:void 0,d3modelItemPath:void 0,d3modelItemId:void 0,compiler:null},s=new Map;return new Promise(async a=>{let o=new Gj(t,e,r);n.compiler=o,o.setHandler(new C1e(async(l,c)=>{if(typeof c<"u"&&s.set(l,c),s.has("3D Model")&&s.has("3D Model Title")&&s.has("3D Model Transform")){n.d3modelItemId=s.get("3D Model"),n.d3modelItemName=s.get("3D Model Title"),n.d3modelItemTransform=s.get("3D Model Transform");let u=TC(n.d3modelItemId,!0);n.d3modelItemPath=u.path}})),n.initResponse=await o.init().catch(l=>({message:l.message,success:!1})),n.d3modelItemId&&i&&(n.d3modelItem=await IC(n.d3modelItemId)),n.compiler.destroy(),s.clear(),a(n)})}async function T1e(t,e){let r={padList:[]};return new Promise(async i=>{try{let n=new z0e(t,e,!0),s=await n.getPads()||{},a=Object.keys(s);for(let o=0;o<a.length;o++)r.padList.push({...s[a[o]]});n.destroy(),i(r)}catch{i(r)}})}function I1e(t,e,r){if(typeof t!="number"&&(t=+t),isNaN(t))return NaN;if(e=e|0,e<=0||!t&&!r)return Math.round(t);let i=[1,10,100,1e3][e]||Math.pow(10,e)||10;if(r){let n=t<0?"-":"";for(t=t<0?-t:t,t=Math.round(t*i)+"";t.length<=e;)t="0"+t;return t=t.slice(0,-e)+"."+t.slice(-e),n+t}else return Math.round(t*i+1e-10)/i}function B1e(t,e){typeof t=="string"&&(t=parseFloat(t));let r=Math.pow(10,e);return Math.round(t*r)/r}var D1e={conversion(t,e,r){let i=t+2+e;return this[i](r)},conversion1(t,e,r){let i=t+2+e,n=this[i](r);return e=="mil"?Math.round(n*10)/10:Math.round(n*1e3)/1e3},mil2mil(t){return t},mil2mm(t){return t*.0254},mil2cm(t){return t*.00254},mil2inch(t){return t/1e3},mm2mm(t){return t},mm2mil(t){let e=Math.pow(10,5);return Math.round(t*39.37007874015748*e)/e},mm2cm(t){return t/10},mm2inch(t){let e=Math.pow(10,8);return Math.round(t*.03937007874015748*e)/e},cm2mil(t){let e=Math.pow(10,6);return Math.round(t*3.937007874015748*e)/e},cm2mm(t){return t*10},cm2inch(t){let e=Math.pow(10,7);return Math.round(t*.3937007874015748*e)/e},inch2mil(t){return t*1e3},inch2mm(t){return t*25.4},inch2cm(t){return t*2.54}};function _1e(t,e,r){var i=t-e;return r||(r=1e-10),(i>0?i:-i)<r}function P1e(t){return t<0?(360+t%360)%360:t>=360?t%360:t}function zj(t,e,r,i){var n=t-r,s=e-i;return n*n+s*s}function L1e(t,e,r,i){return Math.sqrt(zj(t,e,r,i))}function O1e(t,e,r,i){var n=r-t,s=i-e,a=Math.atan2(s,n);return a=a<0?a+Math.PI+Math.PI:a,a}function N1e(t){return Xj(t)&&Object.keys(t).length===0}function Xj(t){return Object.prototype.toString.call(t).slice(8,-1)==="Object"}function R1e(t){return qj(t)||Wj(t)}function qj(t){return Object.prototype.toString.call(t).slice(8,-1)==="AsyncFunction"}function Wj(t){return Object.prototype.toString.call(t).slice(8,-1)==="Function"}var En,M1e=(En=class{},En.unitConversion=D1e,En.ConcurrencyTaskQueue=A1e,En.FootprintCompilerInstance=Gj,En.FootprintCompilerHandlerProxy=mM,En.FootprintCompilerAttr=f1e,En.createCSVString=E1e,En.svg2png=w1e,En.imageData2NewImage=v1e,En.htmlEncode=Qj,En.htmlDecode=b1e,En.strEncode=x1e,En.isEmptyObj=N1e,En.isPlainObject=Xj,En.isFn=R1e,En.isAsyncFunction=qj,En.isNormalFunction=Wj,En.formatDate=U0,En.formatDate2=r1e,En.deepClone=Y4,En.deepCloneWithHtmlEncode=V4,En.naturalSortComparator=GY,En.naturalSortSplitor=E4,En.naturalSort=xAe,En.naturalStrSort=EAe,En.naturalSort1=wAe,En.naturalCompare=vAe,En.isObjKeyInStr=zD,En.throttle=g1e,En.debounce=y1e,En.findList=Yu,En.findListAll=a1e,En.randomString=TAe,En.parseJSON=IAe,En.splitComponentId2FolderAndFilenameMixin=TC,En.queryExistSameNameDocDetail=jj,En.checkComponentNameDuplicate=m1e,En.getFootprintPadInfo=T1e,En.getFootprint3DInfo=S1e,En),TA,z8e=(TA=class{},TA.toFixed=I1e,TA.toFixed1=B1e,TA.floatEqual=_1e,TA.fixAngle=P1e,TA.getDistance=L1e,TA.getDistance2=zj,TA.getAngleByDot=O1e,TA),R0,Hl=(R0=class{constructor(){this._changeCbs=new Set,this._map=new Map,this._debounceNotify=M1e.debounce(()=>{this._notify()},50)}static get context(){return ur()}static getInstance(){var e;return(e=this.context.extendLibManager)!=null?e:this.context.extendLibManager=new R0}_notify(){for(let e of this._changeCbs)e()}onChange(e){this._changeCbs.add(e)}offChange(e){this._changeCbs.delete(e)}_getLibId(e){return`${R0.LIB_ID_PREFFIX}${e}`}async addLibWithId(e){this._map.set(e.id,await d1e.set(e)),this._debounceNotify()}async addLib(e){let r=this._getLibId(e.title);return await this.addLibWithId({...e,id:r}),r}deleteLib(e){return this._debounceNotify(),this._map.delete(e)}hasLib(e){return this._map.has(e)}getLib(e){return this._map.get(e)}getLibs(){return Array.from(this._map.values())}updateLibTitle(e,r){let i=this._map.get(e);i&&(i.title=r,this._debounceNotify())}updateLibPosition(e,r){let i=this._map.get(e);i&&(i.position=r,this._debounceNotify())}},R0.LIB_ID_PREFFIX="extend_lib_",R0),k1e=0;async function BC(t,e,r,i=!0,n,s){let a=null,o="requestid"+ ++k1e;n&&n(o);let l={user_uuid:t,path:e,type:r};s&&s(l);try{if(Hl.getInstance().hasLib(t))return await F1e(t,r,i);let u=await yn("GET","/api/categories",l,{headers:{path:e},searchParams:!0});if(u.success)return{...u,result:await gM(u.result,i)}}catch(u){a=u,console.error("Fetch Category List Error",u)}let c=a?a.msg||a.message:void 0;return{code:a?a.code:wi.ERR_CODE.NORMAL,success:!1,result:null,msg:c||"Fetch Category List Error"}}async function F1e(t,e,r){var n;let i=[];for(let s of e){let a=await((n=Hl.getInstance().getLib(t))==null?void 0:n.getCategoryTreeDataItemsByCategoryType(s));a&&i.push(a)}return{code:0,success:!0,result:await gM(i.flat().map(s=>({uuid:s.id,parent_uuid:s.parentId,user_uuid:t,type:void 0,order_no:void 0,name_cn:void 0,name:s.title,created_at:s.created_at,updated_at:s.updated_at,title:s.title})),r)}}async function U1e(t=!0){let e=null;try{let i=await yn("POST","/api/open/deviceCate");if(i.success)return{...i,result:await gM(i.result,t)}}catch(i){e=i,console.error("Fetch Category List Error",i)}let r=e?e.msg||e.message:void 0;return{code:e?e.code:wi.ERR_CODE.NORMAL,success:!1,result:null,msg:r||"Fetch Category List Error"}}async function gM(t,e=!0){let r=[],i=[],n=[],s={},a={};t.forEach(d=>{d.name&&(a[d.name]=d.name_cn||d.name)});let o=t.filter(d=>!d.parent_uuid),l=t.filter(d=>!!d.parent_uuid),c=[],u={};if(o.forEach((d,A)=>{c.push(d.uuid),n.push({name:d.name,name_cn:d.name_cn,title:d.name,titleAdditional:d.name_cn||d.name,disableTranslate:d.name_cn===""?!0:d.name_cn===d.name,id:d.uuid,children:[],order_no:+d.order_no||0,parentId:void 0,created_at:d.created_at,updated_at:d.updated_at}),s[d.uuid]=A}),l.forEach(d=>{c.push(d.uuid);let A=s[d.parent_uuid];if(typeof A<"u"&&n[A]){let h=n[A];h.children.push({name:d.name,name_cn:d.name_cn,title:d.name,titleAdditional:d.name_cn||d.name,disableTranslate:d.name_cn===""?!0:d.name_cn===d.name,id:d.uuid,order_no:+d.order_no||0,children:[],parentId:h.id,created_at:d.created_at,updated_at:d.updated_at})}u[d.uuid]=d.parent_uuid}),n.sort(MY("order_no")),n.forEach(d=>{d.children.length>1&&d.children.sort(MY("order_no"))}),n.forEach(d=>{r.push({...d})}),e){let d=(await Dr.messageBus.rpcCall("I18nTranslateService",{str:wi.CATEGORY_ITEM_ALL_TITLE})).message;r.unshift({title:wi.CATEGORY_ITEM_ALL_TITLE,titleAdditional:d||wi.CATEGORY_ITEM_ALL_TITLE,id:wi.CATEGORY_ITEM_ALL_VALUE,order_no:Number.MAX_SAFE_INTEGER,disableTranslate:!1,children:[],parentId:void 0}),i.push(wi.CATEGORY_ITEM_ALL_VALUE)}return{languageHashtable:a,treeData:r,selectedIds:i,categoryIds:c,childCategory2ParentCategoryMap:u,sourceCategoryList:t}}async function B1(t){let{categories:e,type:r,uuid:i}=t,n=await BC(i,i,r),s=n.result?n.result.treeData:[],a=[],o=[],l=[],c=[];for(let f=0;f<e.length;f++){let{parentName:p,childName:m,parent_order_no:y,child_order_no:g}=e[f];if(p){let b=Yu(s,"title",p);if(b.index>=0){if(a.push({name:b.data.title,type:r,user_uuid:i,order_no:b.data.order_no,parent_uuid:void 0,uuid:b.data.id}),m){let x=Yu(b.data.children,"title",m);if(x.index>=0){o.push({name:x.data.title,type:r,user_uuid:i,order_no:x.data.order_no,parent_uuid:b.data.id,uuid:x.data.id});continue}c.push({name:m,type:r,user_uuid:i,order_no:f+1,parent_uuid:b.data.id,uuid:void 0});continue}continue}let E=dC(),w=dC();l.push({name:p,type:r,user_uuid:i,order_no:typeof y<"u"?y:f+1,parent_uuid:void 0,uuid:E}),m&&c.push({name:m,type:r,user_uuid:i,order_no:typeof g<"u"?g:f+1,parent_uuid:E,uuid:w})}}let u=[];if(l.length){let f=await p2(l,(p,m)=>{l[m].__remoteId=p.result.uuid});u=f.result?f.result.successList.map(p=>p.result):[]}let d=[];if(c.length){for(let p=0;p<c.length;p++){let m=Yu(l,"uuid",c[p].parent_uuid);m.index>=0&&m.data.__remoteId&&(c[p].parent_uuid=m.data.__remoteId)}let f=await p2(c);d=f.result?f.result.successList.map(p=>p.result):[]}let A=u.concat(a),h=d.concat(o);return{allParentCreated:A,allChildCreated:h}}async function Kj(t){let{uuid:e,path:r,types:i,names:n}=t;return new Promise(async(s,a)=>{let o=await BC(e,r,i,!1);if(o.code!==0){s({...o,code:wi.ERR_CODE.NORMAL,success:!1,result:null});return}let l={detail:[],arguments:t},{treeData:c}=o.result;for(let u=0;u<n.length;u++){let d=n[u].primary,A=n[u].secondary,h={primary:{name:d,name_cn:"",uuid:"",exist:!1,undefine:!1},secondary:{name:A,name_cn:"",uuid:"",exist:!1,undefine:!1}};if(typeof d>"u"){h.primary.exist=!1,h.primary.undefine=!0;continue}let f=Yu(c,"title",d);if(f.index<=-1){h.primary.exist=!1,h.secondary.exist=!1,l.detail.push(h);continue}if(h.primary.exist=!0,h.primary.uuid=f.data.id,h.primary.name_cn=f.data.titleAdditional||d,typeof A>"u"){h.secondary.exist=!1,h.secondary.undefine=!0,l.detail.push(h);continue}let p=Yu(f.data.children,"title",A);if(p.index<=-1){h.secondary.exist=!1,l.detail.push(h);continue}h.secondary.exist=!0,h.secondary.uuid=p.data.id,h.secondary.name_cn=p.data.titleAdditional||A,l.detail.push(h)}s({code:0,success:!0,result:l})})}function H1e(t){let e=new Map,r=[];for(let i of t)(!e.has(i.primary)||e.get(i.primary)!==i.secondary)&&(e.set(i.primary,i.secondary),r.push(i));return r}async function G1e(t,e,r,i=!1){let n=await Kj(t),s=[],a=[],o=[],l=[],c=[];if(!i&&n.success&&n.result.detail.length){let d=new Map,A=new Map,h=new Map;n.result.detail.forEach((f,p)=>{(f.primary.name||f.primary.name_cn)&&!f.primary.exist&&!d.has(f.primary.name||f.primary.name_cn)&&(d.set(f.primary.name||f.primary.name_cn,!0),s.push({name:f.primary.name||f.primary.name_cn,type:e,user_uuid:r,order_no:0})),(f.primary.name||f.primary.name_cn)&&!f.primary.exist&&(f.secondary.name||f.secondary.name_cn)&&!f.secondary.exist&&A.get(f.secondary.name||f.secondary.name_cn)!==(f.primary.name||f.primary.name_cn)?(A.set(f.secondary.name||f.secondary.name_cn,f.primary.name||f.primary.name_cn),a.push({name:f.secondary.name||f.secondary.name_cn,type:e,user_uuid:r,uuid:f.secondary.uuid,order_no:0,parent_uuid:f.primary.uuid,parent_title:f.primary.name||f.primary.name_cn})):f.primary.exist&&(f.secondary.name||f.secondary.name_cn)&&!f.secondary.exist&&A.get(f.secondary.name||f.secondary.name_cn)!==(f.primary.name||f.primary.name_cn)&&(A.set(f.secondary.name||f.secondary.name_cn,f.primary.name||f.primary.name_cn),a.push({name:f.secondary.name||f.secondary.name_cn,type:e,user_uuid:r,uuid:f.secondary.uuid,order_no:0,parent_uuid:f.primary.uuid,parent_title:f.primary.name||f.primary.name_cn})),f.primary.exist&&!h.has(f.primary.uuid)&&(h.set(f.primary.uuid,f.primary.name||f.primary.name_cn),c.push({title:f.primary.name||f.primary.name_cn,uuid:f.primary.uuid,parent_uuid:""})),f.secondary.exist&&!h.has(f.secondary.uuid)&&(h.set(f.secondary.uuid,f.secondary.name||f.secondary.name_cn),c.push({title:f.secondary.name||f.secondary.name_cn,uuid:f.secondary.uuid,parent_uuid:f.primary.uuid}))})}if(!i&&s.length){let d=await p2(s);if(d.success&&d.result.successList.length&&(o=d.result.successList.map(A=>A.result),a.forEach(A=>{o.forEach(h=>{!A.parent_uuid&&A.parent_title===h.name&&(A.parent_uuid=h.uuid)})})),a.length){let A=await p2(a);A.success&&A.result.successList.length&&(l=A.result.successList.map(h=>h.result))}}else if(!i&&a.length){let d=await p2(a);d.success&&d.result.successList.length&&(l=d.result.successList.map(A=>A.result))}let u=[];return u=o.map(d=>({uuid:d.uuid,title:d.name,name:d.name,parent_uuid:d.parent_uuid})),u=u.concat(l.map(d=>({uuid:d.uuid,parent_uuid:d.parent_uuid,title:d.name,name:d.name}))),u=u.concat(c),u}async function Y1e(t,e){let r=[],i=[],n=async o=>{let{message:l}=await Dr.messageBus.rpcCall(hg.TAG.DELETE,o);return l},s=null;try{for(let o=0;o<t.length;o++){let l=await n({...t[o],path:t[o].user_uuid});if(l.code===0&&l.success){let u={...l,message:"",result:{...t[o],path:t[o].user_uuid,...l.result[0]}};r.push(u),e&&e(u,o);continue}let c={...l,result:{...t[o]}};i.push(c)}return{code:0,success:!0,result:{successList:r,failList:i},message:""}}catch(o){s=o}let a=s?s.msg||s.message:"Del Categories Batch Error";return{code:s?s.code:wi.ERR_CODE.NORMAL,success:!1,result:null,message:a}}async function V1e(t){let{uuid:e,path:r,types:i,ids:n}=t;return new Promise(async(s,a)=>{let o=await BC(e,r,i,!1);if(o.code!==0){s({...o,code:wi.ERR_CODE.NORMAL,success:!1,result:null});return}let l={detail:[],arguments:t},{treeData:c}=o.result;for(let u=0;u<n.length;u++){let d=n[u].primary,A=n[u].secondary,h={primary:{name:"",name_cn:"string",uuid:d,exist:!1,undefine:!1},secondary:{name:"",name_cn:"string",uuid:A,exist:!1,undefine:!1}};if(typeof d>"u"){h.primary.exist=!1,h.primary.undefine=!0;continue}let f=Yu(c,"id",d);if(f.index<=-1){h.primary.exist=!1,h.secondary.exist=!1,l.detail.push(h);continue}if(h.primary.exist=!0,h.primary.name=f.data.title,h.primary.name_cn=f.data.titleAdditional||h.primary.name,typeof A>"u"){h.secondary.exist=!1,h.secondary.undefine=!0;continue}let p=Yu(f.data.children,"id",A);if(p.index<=-1){h.secondary.exist=!1,l.detail.push(h);continue}h.secondary.exist=!0,h.secondary.name=p.data.title,h.secondary.name_cn=p.data.titleAdditional||h.secondary.name,l.detail.push(h)}s({code:0,success:!0,result:l})})}var j1e=class{constructor(){this._actuatorMap=new Map}clearAll(){this._actuatorMap.clear()}async addActuator(t,e,r,i){let n=t.filter(d=>!!d),s=`${n[0]}_${e[0]||0}_${r}_${i}`,a=`${n[0]}_${n[1]}_${e[1]||e[0]||0}_${r}_${i}`;if(!n[1]){if(this._actuatorMap.has(s))return this._actuatorMap.get(s);let d=new Promise(async(A,h)=>{let f=await B1({categories:[{parentName:n[0],parent_order_no:e[0]||0}],type:[i],uuid:r});A({uuids:f.allParentCreated.map(p=>p.uuid),titles:f.allParentCreated.map(p=>p.name)}),this._actuatorMap.delete(s)});return this._actuatorMap.set(s,d),d}let o=this._actuatorMap.get(s);o||(o=new Promise(async(d,A)=>{let h=await B1({categories:[{parentName:n[0],parent_order_no:e[0]||0}],type:[i],uuid:r});d({uuids:h.allParentCreated.map(f=>f.uuid),titles:h.allParentCreated.map(f=>f.name)}),this._actuatorMap.delete(s)}),this._actuatorMap.set(s,o));let l=await o,c=this._actuatorMap.get(a);c||(c=new Promise(async(d,A)=>{let h=await B1({categories:[{parentName:n[0],childName:n[1],parent_order_no:e[0]||0,child_order_no:e[1]||e[0]||0}],type:[i],uuid:r});d({uuids:h.allChildCreated.map(f=>f.uuid),titles:h.allChildCreated.map(f=>f.name)}),this._actuatorMap.delete(a)}),this._actuatorMap.set(a,c));let u=await c;return{uuids:[l.uuids[0],u.uuids[0]],titles:[l.titles[0],u.titles[0]]}}};async function Q1e(t,e){let r=[],i=[],n=async o=>{let{message:l}=await Dr.messageBus.rpcCall(hg.TAG.UPDATE,o);return l},s=null;try{for(let o=0;o<t.length;o++){let l=await n({...t[o],path:t[o].user_uuid});if(l.code===0&&l.success){let u={...l,message:"",result:{...t[o],path:t[o].user_uuid,...l.result[0]}};r.push(u),e&&e(u,o);continue}let c={...l,result:{...t[o]}};i.push(c)}return{code:0,success:!0,result:{successList:r,failList:i},message:""}}catch(o){s=o}let a=s?s.msg||s.message:"Update Categories Batch Error";return{code:s?s.code:wi.ERR_CODE.NORMAL,success:!1,result:null,message:a}}var ru,k1=(ru=class{},ru.categoryAddtition=new j1e,ru.fetchCategoryList=BC,ru.fetchInternalCategoryList=U1e,ru.addCategoriesBatch=p2,ru.deleteCategoriesBatch=Y1e,ru.updateCategoriesBatch=Q1e,ru.addCategoriesBatchByNameArray=B1,ru.queryCategoryBatchByNames=Kj,ru.queryCategoryBatchByIds=V1e,ru.formatRepeatCategoryArr=H1e,ru.bindAndCreateCategory=G1e,ru.getCategoryNamesByTags=G0,ru);async function G0(t,e,r){if(!t)return[];if(t instanceof Array)return t;let i=M1(t);if(i=i.filter(c=>!!c),!i.length)return[];let n=(await Dr.messageBus.rpcCall("LocaleCurrFetch",{})).message||"en",s=await BC(e,e,r),a=s.result?s.result.sourceCategoryList:[],o=typeof i[1]<"u",l=[];for(let c=0;c<a.length;c++)if(a[c].name===i[0]||a[c].name_cn===i[0]){l.push(n=="en"?a[c].name:a[c].name_cn||a[c].name);break}if(o){for(let c=0;c<a.length;c++)if(a[c].name===i[1]||a[c].name_cn===i[1]){l.push(n=="en"?a[c].name:a[c].name_cn||a[c].name);break}}return l}async function z1e(t,e,r){let i=null,n=null,s=[],a=[],o=!1,l,c;if(t)if("data"in t)i=t.data,i.tags&&(i.tags instanceof Array?a=i.tags:a=M1(i.tags));else{if(!t.uuid||!t.path)throw new Dt("PARAMETER_VERIFICATION","missing 3d-model uuid or path data.");l=t.uuid,c=t.path,n=await Ma.getD3Model({isProject:t.isProject,uuid:t.uuid,path:t.path}),n&&(n.title=n.display_title,a=await G0(n.tags,t.path,[5]))}if(!r){let u=await k1.categoryAddtition.addActuator(a,[0],e,5);s=u.uuids,a=u.titles}return{d3modelItemOriginUuid:l,d3modelItemOriginPath:c,d3modelItemIn:i,d3modelItemOut:n,d3modelTagIds:s,d3modelTagTitles:a}}async function X1e(t){let{d3modelItemIn:e,d3modelItemOut:r,d3modelTagIds:i,d3modelTagTitles:n}=await z1e(t.d3model,t.path,t.isProject),s=e||r;if(!s)throw new Dt("PARAMETER_VERIFICATION","missing 3d-model data.");s1e(s.title),"path"in t.d3model&&t.d3model.override&&Ch(s,t.d3model.override);let a=await yn("POST","/api/v2/components/add",JSON.stringify({...s,tags:i,owner:t.path}),{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(a.code===0&&a.success){let l=a.result,c=await Hf(l);return{title:l.title,description:l.description,path:l.path||t.path,docType:l.docType,uuid:l.uuid,version:l.version,ticket:l.ticket,updateTime:Ur(l.updateTime),createTime:Ur(l.createTime),display_title:l.display_title,creator:ea(l.creator),modifier:ta(l.modifier),owner:ra(l.owner),tags:l.tags,source:l.source,dataStrId:l.dataStrId,dataStr:c}}let o=a.message||a.msg||"Request Error.";throw a.code===1000001?new Dt("CREATE_D3MODEL_DUP_TITLE",o):a.code===422?new Dt("CREATE_D3MODEL_PERMISSIONS",o):new Dt("CREATE_D3MODEL",o)}async function jD(t=!1,e,r,i,n,s){let a=e.toLocaleLowerCase(),o=s?!!s.forceAsSymbol:!1,l=[];try{if(o||i&&[2,18,19,20,21,22,25,31,7,32,6].indexOf(i)>=0){let c={isProject:t,path:r,titles:[a],docType:i};l=(await Ma.getSymbolSearchList(c))[a]||[]}if(i===28){let c={isProject:t,path:r,titles:[a]};l=(await Ma.getDeviceSearchList(c))[a]||[]}if(i===4){let c={isProject:t,path:r,titles:[a]};l=(await Ma.getFootprintSearchList(c))[a]||[]}return i===16&&(l=(await Ma.getD3ModelSearchList({isProject:t,uid:r,path:r,page:1,pageSize:void 0,wd:a})).lists),{code:0,success:!0,result:l,message:""}}catch(c){return console.error(c),{code:-1,success:!1,result:[],message:c instanceof Dt?`${String(c.action)}|${String(c.message)}`:c.message||"QueryComponentsByTitle call error."}}}function kY(t,e){return t.path==e}function FY(t){try{let e=JSON.parse(t);return{parentName:e[0],childName:e[1]}}catch{return{parentName:"",childName:""}}}function q1e(t){let e={};return e["device-owner"]=t.userIdSelected,e["device-lib"]=t.userIdSelected,e["footprint-name"]=t.footprintItem?t.footprintItem.display_title:"",e["symbol-name"]=t.symbolItem?t.symbolItem.display_title:"",e["new-symbol"]=t.isNeedCreateSymbolAndAssocia,e}function Jj(t,e){typeof t.footprintItemId<"u"&&(e.Footprint=t.footprintItemId),typeof t.symbolItemId<"u"&&(e.Symbol=t.symbolItemId)}async function $j(t,e){let r=q1e(t),i=t.footprintItem,n=t.symbolItem,s={},a=async(b,E)=>{let w="",x="",I=!1,C=e==="zh-hans",G=b.parent_tag,U=b.child_tag;if(G&&G.uuid&&(I=!0,w=C&&G.name_cn||G.name),I&&U.uuid){let _=C&&U.name_cn||U.name;w+=`:${_}`}if(w){let _=w.split(":")[0],H=w.split(":")[1],Q=await B1({categories:H?[{parentName:_,childName:H}]:[{parentName:_}],type:[+E],uuid:r["device-owner"]}),j=Q.allParentCreated[0]?Q.allParentCreated[0].uuid:void 0,$=Q.allChildCreated[0]?Q.allChildCreated[0].uuid:void 0;j&&(x=$?[j,$]:[j])}return x},o={"file-owner":r["device-owner"],"file-name":r["footprint-name"],"file-describe":"","file-category":await a((i==null?void 0:i.tags)||{},4),"file-lib":r["device-lib"],"file-customTags":[]};if(i&&(i!=null&&i.custom_tags)&&!(o!=null&&o["file-category"])){let{parentName:b,childName:E}=FY(i.custom_tags);if(b){let w=await B1({categories:E?[{parentName:b,childName:E}]:[{parentName:b}],type:[4],uuid:r["device-owner"]}),x=w.allParentCreated[0]?w.allParentCreated[0].uuid:void 0,I=w.allChildCreated[0]?w.allChildCreated[0].uuid:void 0;x&&(o["file-customTags"]=I?[x,I]:[x])}}let l={"file-owner":r["device-owner"],"file-name":r["symbol-name"],"file-describe":"","file-category":await a((n==null?void 0:n.tags)||{},2),"file-lib":r["device-lib"],"file-customTags":[]};if(n&&(n!=null&&n.custom_tags)&&!l["file-category"]){let{parentName:b,childName:E}=FY(n.custom_tags);if(b){let w=await B1({categories:E?[{parentName:b,childName:E}]:[{parentName:b}],type:[4],uuid:r["device-owner"]}),x=w.allParentCreated[0]?w.allParentCreated[0].uuid:void 0,I=w.allChildCreated[0]?w.allChildCreated[0].uuid:void 0;x&&(l["file-customTags"]=I?[x,I]:[x])}}let c,u,d,A,h=!1,f=!1,p=!1;async function m(){if(r["footprint-name"])if(kY(i,r["device-owner"]||r["device-lib"]))d=i,c=null;else{let b=await jD(!1,o["file-name"],r["device-lib"],4);b.result.length<=0||(f=!0,d=i,c=b.result)}else d=null,c=null}async function y(){if(!r["new-symbol"]&&r["symbol-name"]&&n)if(kY(n,r["device-owner"]||r["device-lib"]))A=n,u=null;else{let b=await jD(!1,l["file-name"],r["device-lib"],n.docType);b.result.length<=0||(h=!0,u=b.result,A=n)}else A=null,u=null}await m(),await y();let g={isNeedConfirm:!1,updateCache:s,formData:r,newFootPrint:c,oldFootPrint:d,newSymbol:u,oldSymbol:A,confirmRes:t};return!h&&!f&&!p?(g.isNeedConfirm=!1,g):(g.isNeedConfirm=!0,g)}async function yM(t,e,r,i){let n=null,s=null,a=[],o=[],l=!1,c,u;if(t)if("data"in t)t.data&&(n=t.data,n.tags&&(n.tags instanceof Array?o=n.tags:o=M1(n.tags)));else{if(!t.uuid||!t.path)throw new Dt("PARAMETER_VERIFICATION","missing footprint uuid or path data.");c=t.uuid,u=t.path,s=await Ma.getFootprint({isProject:t.isProject,uuid:t.uuid,path:t.path}),s&&(s.title=s.display_title,i&&Array.isArray(i)?o=i:o=await G0(s.tags,t.path,[4]))}if(!r){let d=await k1.categoryAddtition.addActuator(o,[0],e,4);a=d.uuids,o=d.titles}return{footprintItemOriginUuid:c,footprintItemOriginPath:u,footprintItemIn:n,footprintItemOut:s,footprintTagIds:a,footprintTagTitles:o}}async function bM(t,e,r,i){let n=null,s=null,a=[],o=[],l=!1,c,u;if(t)if("data"in t)t.data&&(n=t.data,n.tags&&(n.tags instanceof Array?o=n.tags:o=M1(n.tags)));else{if(!t.uuid||!t.path)throw new Dt("PARAMETER_VERIFICATION","missing symbol uuid or path data.");c=t.uuid,u=t.path,s=await Ma.getSymbol({isProject:t.isProject,uuid:t.uuid,path:t.path}),s&&(s.title=s.display_title,i&&Array.isArray(i)?o=i:o=await G0(s.tags,t.path,[2])),l=t.isProject}if(!r){let d=await k1.categoryAddtition.addActuator(o,[0],e,2);a=d.uuids,o=d.titles}return{symbolItemOriginUuid:c,symbolItemOriginPath:u,symbolItemIn:n,symbolItemOut:s,symbolTagIds:a,symbolTagTitles:o}}async function Zj(t,e,r,i){let n=null,s=null,a=[],o=[],l=!1;if(t)if("data"in t)t.data&&(n=t.data,n.tags&&(n.tags instanceof Array?o=n.tags:o=M1(n.tags)));else{if(!t.uuid||!t.path)throw new Dt("PARAMETER_VERIFICATION","missing device uuid or path data.");s=await Ma.getDevice({isProject:t.isProject,uuid:t.uuid,path:t.path}),s&&(s.title=s.display_title,i&&Array.isArray(i)?o=i:o=await G0(s.tags,t.path,[3])),l=t.isProject}if(!r){let c=await k1.categoryAddtition.addActuator(o,[0],e,3);a=c.uuids,o=c.titles}return{deviceItemIn:n,deviceItemOut:s,deviceTagIds:a,deviceTagTitles:o,isDeviceFromProject:l}}async function eQ(t,e,r,i,n,s){let a=null,o=null,l=[],c=[],u,d;if(t){let{symbolItemIn:A,symbolItemOut:h,symbolTagIds:f,symbolTagTitles:p,symbolItemOriginUuid:m,symbolItemOriginPath:y}=await bM(t,r,i,"path"in t&&t.override&&Array.isArray(t.override.tags)?t.override.tags:void 0);a=A,o=h,l=f,c=p,u=m,d=y}else if(n)if(s){let A=await Ma.getSymbol({isProject:e,uuid:n,path:s});if(u=n,d=s,A){A.title=A.display_title,o=A,c=await G0(A.tags,s,[2]);let h=await k1.categoryAddtition.addActuator(c,[0],r,2);l=h.uuids,c=h.titles}}else{let A=null;try{A=await Ma.getSymbol({isProject:e,uuid:n,path:r}),u=n,d=r}catch(h){A=null,u=n,d=r,console.warn(h)}A||console.warn("[NOSYMBOL_ON_TARGETPATH_BY_DEVICE_BOUND]: the symbol bound to this device does not exist in the target library.")}return{symbolItemOriginUuid:u,symbolItemOriginPath:d,symbolItemIn:a,symbolItemOut:o,symbolTagIds:l,symbolTagTitles:c}}async function tQ(t,e,r,i,n,s){let a=null,o=null,l=[],c=[],u,d;if(t){let{footprintItemIn:A,footprintItemOut:h,footprintTagIds:f,footprintTagTitles:p,footprintItemOriginUuid:m,footprintItemOriginPath:y}=await yM(t,r,i,"path"in t&&t.override&&Array.isArray(t.override.tags)?t.override.tags:void 0);a=A,o=h,l=f,c=p,u=m,d=y}else if(n)if(s){let A=await Ma.getFootprint({isProject:e,uuid:n,path:s});if(u=n,d=s,A){A.title=A.display_title,o=A,c=await G0(A.tags,s,[4]);let h=await k1.categoryAddtition.addActuator(c,[0],r,4);l=h.uuids,c=h.titles}}else{let A=null;try{A=await Ma.getFootprint({isProject:e,uuid:n,path:r}),u=n,d=r}catch(h){A=null,u=n,d=r,console.warn(h)}A||console.warn("[NOFOOTPRINT_ON_TARGETPATH_BY_DEVICE_BOUND]: the footprint bound to this device does not exist in the target library.")}return{footprintItemOriginUuid:u,footprintItemOriginPath:d,footprintItemIn:a,footprintItemOut:o,footprintTagIds:l,footprintTagTitles:c}}async function F1(t=!1,e,r,i,n=[]){let s={isDuplicate:!1,path:i,uuids:[]},a=r.toLocaleLowerCase(),o=await jD(t,a,i,e,Dr.loginedUserUuid);if(o.success&&o.result&&o.result.length){let l=[];for(let c=0;c<o.result.length;c++){if(n.indexOf(o.result[c].uuid)>=0)continue;let u=(o.result[c].title||o.result[c].display_title).toLocaleLowerCase();if(a===u&&o.result[c].path===i){if(typeof e>"u"||e===28){l.push(o.result[c]);continue}if(typeof o.result[c].docType>"u"){l.push(o.result[c]);continue}if(o.result[c].docType===e){l.push(o.result[c]);continue}}}for(let c=0;c<l.length;c++)s.uuids.push(l[c].uuid);s.isDuplicate=!!s.uuids.length}return s}async function rQ(t,e,r,i,n,s){if(!i)return;let a=null;if("data"in i)n.title&&(a=await Ma.createSymbol({isProject:t,path:e,symbol:{data:{...n,tags:s},ignoreDuplicateNameCheck:i.ignoreDuplicateNameCheck}})),r.attributes&&a&&typeof a=="object"&&(r.attributes.Symbol=a.uuid);else{i.override&&Ch(n,i.override);try{a=await Ma.getSymbol({isProject:t,path:e,uuid:i.uuid})}catch{a=null}if(a&&typeof a=="object")r.attributes&&(r.attributes.Symbol=a.uuid);else if(n.title&&(a=await Ma.createSymbol({isProject:t,path:e,symbol:{data:{...n,tags:s},ignoreDuplicateNameCheck:i.ignoreDuplicateNameCheck}})),r.attributes&&a&&typeof a=="object"){r.attributes.Symbol=a.uuid;let o=await $p({origin:{docType:n.docType,isProject:i.isProject,uuid:i.uuid,path:i.path},target:{docType:a.docType,isProject:t,uuid:a.uuid,path:a.path}});if(!o.success)throw new Dt("CREATE_SYMBOL_MIGRATE_CANVAS_ERROR",o.message||"migrate canvas error.")}}}async function iQ(t,e,r,i,n,s){if(!i)return;let a=null;if("data"in i)n.title&&(a=await Ma.createFootprint({isProject:t,path:e,footprint:{data:{...n,tags:s}}})),r.attributes&&a&&typeof a=="object"&&(r.attributes.Footprint=a.uuid);else{i.override&&Ch(n,i.override);try{a=await Ma.getFootprint({isProject:t,path:e,uuid:i.uuid})}catch{a=null}if(a&&typeof a=="object")r.attributes&&(r.attributes.Footprint=a.uuid);else if(n.title&&(a=await Ma.createFootprint({isProject:t,path:e,footprint:{data:{...n,tags:s}}})),r.attributes&&a&&typeof a=="object"){r.attributes.Footprint=a.uuid;let o=await $p({origin:{docType:n.docType,isProject:i.isProject,uuid:i.uuid,path:i.path},target:{docType:a.docType,isProject:t,uuid:a.uuid,path:a.path}});if(!o.success)throw new Dt("CREATE_FOOTPRINT_MIGRATE_CANVAS_ERROR",o.message||"migrate canvas error.")}}}async function W1e(t){let{deviceItemIn:e,deviceItemOut:r,deviceTagIds:i,deviceTagTitles:n,isDeviceFromProject:s}=await Zj(t.device,t.path,t.isProject,"path"in t.device&&t.device.override&&Array.isArray(t.device.override.tags)?t.device.override.tags:void 0),a=e||r;if(!a)throw new Dt("PARAMETER_VERIFICATION","missing device data.");if(a.title=t.device&&"path"in t.device&&t.device.override&&n_(t.device.override,"title")||a.title,Mj(a.title),(await F1(t.isProject,28,a.title,t.path)).isDuplicate)throw new Dt("DEVICE_SAME_NAMA_EXISTS","{libName} duplicate name or illegal name: {componentName}");let{symbolItemIn:o,symbolItemOut:l,symbolTagIds:c,symbolTagTitles:u,symbolItemOriginUuid:d,symbolItemOriginPath:A}=await eQ(t.symbol,s,t.path,t.isProject,a.attributes?a.attributes.Symbol:void 0,"data"in t.device?void 0:t.device.path),h=o||l,f=!!(t.symbol&&"data"in t.symbol);a.attributes&&l&&typeof l=="object"&&(a.attributes.Symbol=l.uuid),t.symbol&&"path"in t.symbol&&t.symbol.override&&Ch(h,t.symbol.override);let{footprintItemIn:p,footprintItemOut:m,footprintTagIds:y,footprintTagTitles:g,footprintItemOriginUuid:b,footprintItemOriginPath:E}=await tQ(t.footprint,s,t.path,t.isProject,a.attributes?a.attributes.Footprint:void 0,"data"in t.device?void 0:t.device.path),w=p||m;t.footprint&&"path"in t.footprint&&t.footprint.override&&Ch(w,t.footprint.override),a.attributes&&m&&typeof m=="object"&&(a.attributes.Footprint=m.uuid);let x=!1,I=!1,C=await $j({symbolItem:h,footprintItem:w,userIdSelected:t.path,isNeedCreateSymbolAndAssocia:f},void 0);if(C.isNeedConfirm){let _=(await Dr.messageBus.rpcCall("OpenSameNameSaveAsDlgService",{...C},31536e8)).message;if(!_){let H="an exception occurred while executing the cross-bind program.";throw new Dt("CROSS_BIND",H)}if(_.action==="cancel"||_.action==="close"){let H="quit operate while executing the cross-bind program.";throw new Dt("CROSS_BIND_EXIT",H)}C.updateCache=_.data,a.attributes&&Object.keys(C.updateCache).length&&(C.updateCache.symbolItemId&&(x=!0),C.updateCache.footprintItemId&&(I=!0),Jj(C.updateCache,a.attributes))}!x&&h&&await rQ(t.isProject,t.path,a,t.symbol,h,u),!I&&w&&await iQ(t.isProject,t.path,a,t.footprint,w,g),"path"in t.device&&t.device.override&&(delete t.device.override.tags,Ch(a,t.device.override));let G=await yn("POST","/api/devices",{...a,tags:i,owner:t.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(G.code===0&&G.success){let _=G.result;return{path:_.path||t.path,title:_.title,description:_.description,attributes:_.attributes,images:_.images,uuid:_.uuid,version:_.version,ticket:_.ticket,updateTime:Ur(_.updateTime),createTime:Ur(_.createTime),display_title:_.display_title,creator:ea(_.creator),modifier:ta(_.modifier),owner:ra(_.owner),tags:_.tags,source:_.source,symbol_type:_.symbol_type}}let U=G.message||G.msg||"Request Error.";throw G.code===1000001?new Dt("CREATE_DEVICE_DUP_TITLE",U):G.code===422?new Dt("CREATE_DEVICE_PERMISSIONS",U):new Dt("CREATE_DEVICE",U)}async function K1e(t){let{footprintItemIn:e,footprintItemOut:r,footprintTagIds:i,footprintTagTitles:n}=await yM(t.footprint,t.path,t.isProject,"path"in t.footprint&&t.footprint.override&&Array.isArray(t.footprint.override.tags)?t.footprint.override.tags:void 0),s=e||r;if(!s)throw new Dt("PARAMETER_VERIFICATION","missing footprint data.");if(s.title="path"in t.footprint&&t.footprint.override&&n_(t.footprint.override,"title")||s.title,Fj(s.title),(await F1(t.isProject,4,s.title,t.path)).isDuplicate)throw new Dt("FOOTPRINT_SAME_NAMA_EXISTS","{libName} duplicate name or illegal name: {componentName}");"path"in t.footprint&&t.footprint.override&&(delete t.footprint.override.tags,Ch(s,t.footprint.override));let a=await yn("POST","/api/v2/components/add",{title:s.title,tags:i,docType:s.docType||4,description:s.description,owner:t.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(a.code===0&&a.success){let l=a.result;if(!("data"in t.footprint)&&t.footprint.uuid&&t.footprint.path){let c=await $p({origin:{docType:s.docType,isProject:!!t.footprint.isProject,uuid:t.footprint.uuid,path:t.footprint.path},target:{docType:l.docType,isProject:!1,uuid:l.uuid,path:l.path}});if(!c.success)throw new Dt("CREATE_FOOTPRINT_MIGRATE_CANVAS_ERROR",c.message||"migrate canvas error.")}return{title:l.title,description:l.description,path:l.path||t.path,docType:l.docType,uuid:l.uuid,version:l.version,ticket:l.ticket,updateTime:Ur(l.updateTime),createTime:Ur(l.createTime),display_title:l.display_title,creator:ea(l.creator),modifier:ta(l.modifier),owner:ra(l.owner),tags:l.tags,source:l.source}}let o=a.message||a.msg||"Request Error.";throw a.code===1000001?new Dt("CREATE_FOOTPRINT_DUP_TITLE",o):a.code===422?new Dt("CREATE_FOOTPRINT_PERMISSIONS",o):new Dt("CREATE_FOOTPRINT",o)}async function nQ(t,e,r,i){let n=null,s=null,a=[],o=[],l=!1,c,u;if(t)if("data"in t)n=t.data,n.tags&&(n.tags instanceof Array?o=n.tags:o=M1(n.tags));else{if(!t.uuid||!t.path)throw new Dt("PARAMETER_VERIFICATION","missing simModel uuid or path data.");c=t.uuid,u=t.path,s=await Ma.getSimModel({isProject:t.isProject,uuid:t.uuid,path:t.path}),s&&(s.title=s.display_title,i&&Array.isArray(i)?o=i:o=await G0(s.tags,t.path,[6]))}if(!r){let d=await k1.categoryAddtition.addActuator(o,[0],e,6);a=d.uuids,o=d.titles}return{simModelItemOriginUuid:c,simModelItemOriginPath:u,simModelItemIn:n,simModelItemOut:s,simModelTagIds:a,simModelTagTitles:o}}async function J1e(t){let{simModelItemIn:e,simModelItemOut:r,simModelTagIds:i,simModelTagTitles:n}=await nQ(t.simModel,t.path,t.isProject,"path"in t.simModel&&t.simModel.override&&Array.isArray(t.simModel.override.tags)?t.simModel.override.tags:void 0),s=e||r;if(!s)throw new Dt("PARAMETER_VERIFICATION","missing sim-model data.");if(s.title="path"in t.simModel&&t.simModel.override&&n_(t.simModel.override,"title")||s.title,Uj(s.title),(await F1(t.isProject,s.docType,s.title,t.path)).isDuplicate)throw new Dt("SIM_MODEL_SAME_NAMA_EXISTS","{libName} duplicate name or illegal name: {componentName}");"path"in t.simModel&&t.simModel.override&&(delete t.simModel.override.tags,Ch(s,t.simModel.override));let a=await yn("POST","/api/v2/components/add",{...s,tags:i,owner:t.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(a.code===0&&a.success){let l=a.result;return{title:l.title,path:l.path||t.path,docType:l.docType,uuid:l.uuid,version:l.version,ticket:l.ticket,updateTime:Ur(l.updateTime),createTime:Ur(l.createTime),display_title:l.display_title,creator:ea(l.creator),modifier:ta(l.modifier),owner:ra(l.owner),tags:l.tags,source:l.source,dataStr:await Hf(l),key:l.key,iv:l.iv,dataStrId:l.dataStrId}}let o=a.message||a.msg||"Request Error.";throw a.code===1000001?new Dt("CREATE_SIM_MODEL_DUP_TITLE",o):a.code===422?new Dt("CREATE_SIM_MODEL_PERMISSIONS",o):new Dt("CREATE_SIM_MODEL",o)}async function $1e(t){let{symbolItemIn:e,symbolItemOut:r,symbolTagIds:i,symbolTagTitles:n}=await bM(t.symbol,t.path,t.isProject,"path"in t.symbol&&t.symbol.override&&Array.isArray(t.symbol.override.tags)?t.symbol.override.tags:void 0),s=e||r;if(!s)throw new Dt("PARAMETER_VERIFICATION","missing symbol data.");if(s.title="path"in t.symbol&&t.symbol.override&&n_(t.symbol.override,"title")||s.title,kj(s.title),(await F1(t.isProject,s.docType,s.title,t.path)).isDuplicate)throw new Dt("SYMBOL_SAME_NAMA_EXISTS","{libName} duplicate name or illegal name: {componentName}");"path"in t.symbol&&t.symbol.override&&(delete t.symbol.override.tags,Ch(s,t.symbol.override));let a=await yn("POST","/api/v2/components/add",{title:s.title,tags:i,docType:s.docType,description:s.description,owner:t.path,ignoreDuplicateNameCheck:t.symbol.ignoreDuplicateNameCheck},{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(a.code===0&&a.success){let l=a.result;if(!("data"in t.symbol)&&t.symbol.uuid&&t.symbol.path){let c=await $p({origin:{docType:s.docType,isProject:!!t.symbol.isProject,uuid:t.symbol.uuid,path:t.symbol.path},target:{docType:l.docType,isProject:!1,uuid:l.uuid,path:l.path}});if(!c.success)throw new Dt("CREATE_SYMBOL_MIGRATE_CANVAS_ERROR",c.message||"migrate canvas error.")}return{title:l.title,description:l.description,docType:l.docType,path:l.path||t.path,uuid:l.uuid,version:l.version,ticket:l.ticket,updateTime:Ur(l.updateTime),createTime:Ur(l.createTime),display_title:l.display_title,creator:ea(l.creator),modifier:ta(l.modifier),owner:ra(l.owner),tags:l.tags,source:l.source}}let o=a.message||a.msg||"Request Error.";throw a.code===1000001?new Dt("CREATE_SYMBOL_DUP_TITLE",o):a.code===422?new Dt("CREATE_SYMBOL_PERMISSIONS",o):new Dt("CREATE_SYMBOL",o)}async function Z1e(t){let e=await yn("GET",`/api/v2/devices/${t.uuid}`,{uuid:t.uuid,path:t.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(e.code===0&&e.success&&typeof e.result=="object"){let i=e.result;if(typeof i.path<"u"&&i.path!==t.path)throw new Dt("GET_DEVICE_NOT_FOUND","data not found");return{path:i.path,title:i.title,description:i.description,attributes:i.attributes,images:i.images,uuid:i.uuid,version:i.version,ticket:i.ticket,updateTime:Ur(i.updateTime),createTime:Ur(i.createTime),display_title:i.display_title,creator:ea(i.creator),modifier:ta(i.modifier),owner:ra(i.owner),tags:i.tags,source:i.source,symbol_type:i.symbol_type,isFavorite:i.isFavorite}}let r=e.message||e.msg||"Request Error.";throw new Dt("GET_DEVICE",r)}async function ebe(t){let e=await yn("GET",`/api/v2/components/${t.uuid}`,{uuid:t.uuid,path:t.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(e.code===0&&e.success&&typeof e.result=="object"){let i=e.result;if(typeof i.path<"u"&&i.path!==t.path)throw new Dt("GET_FOOTPRINT_NOT_FOUND","data not found");return{title:i.title,description:i.description,path:i.path,docType:i.docType,uuid:i.uuid,version:i.version,ticket:i.ticket,updateTime:Ur(i.updateTime),createTime:Ur(i.createTime),display_title:i.display_title,creator:ea(i.creator),modifier:ta(i.modifier),owner:ra(i.owner),tags:i.tags,source:i.source,has_device:i.has_device,history_uuid:i.history_uuid,key:i.key,iv:i.iv,dataStr:await Hf(i),dataStrId:i.dataStrId}}let r=e.message||e.msg||"Request Error.";throw new Dt("GET_FOOTPRINT",r)}async function tbe(t){let e=await yn("GET",`/api/v2/components/${t.uuid}`,{uuid:t.uuid,path:t.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(e.code===0&&e.success&&typeof e.result=="object"){let i=e.result;return{title:i.title,path:i.path,docType:i.docType,uuid:i.uuid,version:i.version,ticket:i.ticket,updateTime:Ur(i.updateTime),createTime:Ur(i.createTime),display_title:i.display_title,creator:ea(i.creator),modifier:ta(i.modifier),owner:ra(i.owner),tags:i.tags,source:i.source,history_uuid:i.history_uuid,key:i.key,iv:i.iv,dataStr:await Hf(i),dataStrId:i.dataStrId}}let r=e.message||e.msg||"Request Error.";throw new Dt("GET_SIM_MODEL",r)}function Zp(t={}){let e={},r=Object.keys(t);for(let i=0;i<r.length;i++)r[i]===""||String(r[i])==="undefined"||typeof t[r[i]]>"u"||t[r[i]]==null||(e[r[i]]=t[r[i]]);return e}async function rbe(t){let e=await yn("GET","/api/v2/components",{...Zp(t.query||{}),path:t.path,uid:t.uid,page:t.page,pageSize:t.pageSize,docType:t.docType,tag:t.tags||[]},{headers:{path:t.path},searchParams:!0});if(e.code===0&&e.success&&typeof e.result=="object"){let i=e.result,n=[];for(let s of i.lists)n.push({title:s.title,path:s.path||t.path,docType:s.docType,uuid:s.uuid,version:s.version,ticket:s.ticket,updateTime:Ur(s.updateTime),createTime:Ur(s.createTime),display_title:s.display_title,creator:ea(s.creator),modifier:ta(s.modifier),owner:ra(s.owner),tags:s.tags,source:s.source,key:s.key,iv:s.iv,dataStr:await Hf(i),dataStrId:i.dataStrId});return{count:i.count,page:i.page,pageSize:i.pageSize,totalPage:i.totalPage,lists:n}}let r=e.message||e.msg||"Request Error.";throw new Dt("GET_SIM_MODEL_LIST",r)}async function ibe(t){let e=await yn("GET",`/api/v2/components/${t.uuid}`,{uuid:t.uuid,path:t.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(e.code===0&&e.success&&typeof e.result=="object"){let i=e.result;if(typeof i.path<"u"&&i.path!==t.path)throw new Dt("GET_SYMBOL_NOT_FOUND","data not found");return{title:i.title,description:i.description,docType:i.docType,path:i.path,uuid:i.uuid,version:i.version,ticket:i.ticket,updateTime:Ur(i.updateTime),createTime:Ur(i.createTime),display_title:i.display_title,creator:ea(i.creator),modifier:ta(i.modifier),owner:ra(i.owner),tags:i.tags,source:i.source,has_device:i.has_device,history_uuid:i.history_uuid,key:i.key,iv:i.iv,dataStr:await Hf(i),dataStrId:i.dataStrId}}let r=e.message||e.msg||"Request Error.";throw new Dt("GET_SYMBOL",r)}async function nbe(t){let{deviceItemIn:e,deviceItemOut:r,deviceTagIds:i,deviceTagTitles:n,isDeviceFromProject:s}=await Zj(t.device,t.path,t.isProject,"path"in t.device&&t.device.override&&Array.isArray(t.device.override.tags)?t.device.override.tags:void 0),a=e||r;if(!a)throw new Dt("PARAMETER_VERIFICATION","missing device data.");Mj(a.title);let{symbolItemIn:o,symbolItemOut:l,symbolTagIds:c,symbolTagTitles:u,symbolItemOriginUuid:d,symbolItemOriginPath:A}=await eQ(t.symbol,s,t.path,t.isProject,a.attributes?a.attributes.Symbol:void 0,"data"in t.device?void 0:t.device.path),h=o||l,f=!!(t.symbol&&"data"in t.symbol);t.symbol&&"path"in t.symbol&&t.symbol.override&&Ch(h,t.symbol.override),a.attributes&&l&&typeof l=="object"&&(a.attributes.Symbol=l.uuid);let{footprintItemIn:p,footprintItemOut:m,footprintTagIds:y,footprintTagTitles:g,footprintItemOriginUuid:b,footprintItemOriginPath:E}=await tQ(t.footprint,s,t.path,t.isProject,a.attributes?a.attributes.Footprint:void 0,"data"in t.device?void 0:t.device.path),w=p||m;t.footprint&&"path"in t.footprint&&t.footprint.override&&Ch(w,t.footprint.override),a.attributes&&m&&typeof m=="object"&&(a.attributes.Footprint=m.uuid);let x=!1,I=!1,C=await $j({symbolItem:h,footprintItem:w,userIdSelected:t.path,isNeedCreateSymbolAndAssocia:f},void 0);if(C.isNeedConfirm){let _=(await Dr.messageBus.rpcCall("OpenSameNameSaveAsDlgService",{...C},31536e8)).message;if(!_){let H="an exception occurred while executing the cross-bind program.";throw new Dt("CROSS_BIND",H)}if(_.action==="cancel"||_.action==="close"){let H="quit operate while executing the cross-bind program.";throw new Dt("CROSS_BIND_EXIT",H)}C.updateCache=_.data,a.attributes&&Object.keys(C.updateCache).length&&(C.updateCache.symbolItemId&&(x=!0),C.updateCache.footprintItemId&&(I=!0),Jj(C.updateCache,a.attributes))}!x&&h&&await rQ(t.isProject,t.path,a,t.symbol,h,u),!I&&w&&await iQ(t.isProject,t.path,a,t.footprint,w,g),"path"in t.device&&t.device.override&&(delete t.device.override.tags,Ch(a,t.device.override));let G=await yn("POST",`/api/v2/devices/${t.uuid}`,JSON.stringify({...a,tags:i,owner:t.path}),{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(G.code===0&&G.success&&G.result){let _=G.result;return{path:_.path||t.path,title:_.title,description:_.description,attributes:_.attributes,images:_.images,uuid:_.uuid,version:_.version,ticket:_.ticket,updateTime:Ur(_.updateTime),createTime:Ur(_.createTime),display_title:_.display_title,creator:ea(_.creator),modifier:ta(_.modifier),owner:ra(_.owner),tags:_.tags,source:_.source,symbol_type:_.symbol_type}}let U=G.message||G.msg||"Request Error.";throw G.code===422?new Dt("CREATE_DEVICE_PERMISSIONS",U):new Dt("UPDATE_DEVICE",U)}async function sbe(t){let{footprintItemIn:e,footprintItemOut:r,footprintTagIds:i,footprintTagTitles:n}=await yM(t.footprint,t.path,t.isProject,"path"in t.footprint&&t.footprint.override&&Array.isArray(t.footprint.override.tags)?t.footprint.override.tags:void 0),s=e||r;if(!s)throw new Dt("PARAMETER_VERIFICATION","missing footprint data.");if(Fj(s.title),(await F1(t.isProject,4,s.title,t.path,[t.uuid])).isDuplicate)throw new Dt("FOOTPRINT_SAME_NAMA_EXISTS","{libName} duplicate name or illegal name: {componentName}");"path"in t.footprint&&t.footprint.override&&(delete t.footprint.override.tags,Ch(s,t.footprint.override));let a=await yn("POST",`/api/v2/components/${t.uuid}/update`,JSON.stringify({title:s.title,tags:i,docType:s.docType||4,description:s.description,owner:t.path}),{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(a.code===0&&a.success&&typeof a.result=="object"){let l=a.result;if(!("data"in t.footprint)&&t.footprint.uuid&&t.footprint.path){let c=await $p({origin:{docType:s.docType,isProject:!!t.footprint.isProject,uuid:t.footprint.uuid,path:t.footprint.path},target:{docType:l.docType,isProject:!1,uuid:l.uuid,path:l.path}});if(!c.success)throw new Dt("UPDATE_FOOTPRINT_MIGRATE_CANVAS_ERROR",c.message||"migrate canvas error.")}return{title:l.title,description:l.description,path:l.path,docType:l.docType,uuid:l.uuid,version:l.version,ticket:l.ticket,updateTime:Ur(l.updateTime),createTime:Ur(l.createTime),display_title:l.display_title,creator:ea(l.creator),modifier:ta(l.modifier),owner:ra(l.owner),tags:l.tags,source:l.source}}let o=a.message||a.msg||"Request Error.";throw a.code===422?new Dt("UPDATE_FOOTPRINT_PERMISSIONS",o):new Dt("UPDATE_FOOTPRINT",o)}async function abe(t){let{simModelItemIn:e,simModelItemOut:r,simModelTagIds:i,simModelTagTitles:n}=await nQ(t.simModel,t.path,t.isProject,"path"in t.simModel&&t.simModel.override&&Array.isArray(t.simModel.override.tags)?t.simModel.override.tags:void 0),s=e||r;if(!s)throw new Dt("PARAMETER_VERIFICATION","missing simModel data.");Uj(s.title),"path"in t.simModel&&t.simModel.override&&(delete t.simModel.override.tags,Ch(s,t.simModel.override));let a=await yn("POST",`/api/v2/components/${t.uuid}/update`,JSON.stringify({...s,tags:i,owner:t.path}),{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(!a.success){let l=a.message||a.msg||"Request Error.";throw new Dt("UPDATE_SIM_MODEL",l)}if(s.dataStr){let l=await yn("POST",`/api/v2/components/${t.uuid}/update_canvas`,JSON.stringify({...s,tags:i,owner:t.path}),{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(!l.success){let c=l.message||l.msg||"Request Error.";throw new Dt("UPDATE_SIM_MODEL",c)}}if(a.code===0&&a.success&&typeof a.result=="object"){let l=a.result;return{title:l.title,path:l.path,docType:l.docType,uuid:l.uuid,version:l.version,ticket:l.ticket,updateTime:Ur(l.updateTime),createTime:Ur(l.createTime),display_title:l.display_title,creator:ea(l.creator),modifier:ta(l.modifier),owner:ra(l.owner),tags:l.tags,source:l.source,dataStr:await Hf(l),key:l.key,iv:l.iv,dataStrId:l.dataStrId}}let o=a.message||a.msg||"Request Error.";throw a.code===422?new Dt("UPDATE_SIM_MODEL_PERMISSIONS",o):new Dt("UPDATE_SYMBOL",o)}async function obe(t){let{symbolItemIn:e,symbolItemOut:r,symbolTagIds:i,symbolTagTitles:n}=await bM(t.symbol,t.path,t.isProject,"path"in t.symbol&&t.symbol.override&&Array.isArray(t.symbol.override.tags)?t.symbol.override.tags:void 0),s=e||r;if(!s)throw new Dt("PARAMETER_VERIFICATION","missing symbol data.");if(kj(s.title),(await F1(t.isProject,s.docType,s.title,t.path,[t.uuid])).isDuplicate)throw new Dt("SYMBOL_SAME_NAMA_EXISTS","{libName} duplicate name or illegal name: {componentName}");"path"in t.symbol&&t.symbol.override&&(delete t.symbol.override.tags,Ch(s,t.symbol.override));let a=await yn("POST",`/api/v2/components/${t.uuid}/update`,JSON.stringify({title:s.title,tags:i,docType:s.docType,description:s.description,owner:t.path}),{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(a.code===0&&a.success&&typeof a.result=="object"){let l=a.result;if(!("data"in t.symbol)&&t.symbol.uuid&&t.symbol.path){let c=await $p({origin:{docType:s.docType,isProject:!!t.symbol.isProject,uuid:t.symbol.uuid,path:t.symbol.path},target:{docType:l.docType,isProject:!1,uuid:l.uuid,path:l.path}});if(!c.success)throw new Dt("UPDATE_SYMBOL_MIGRATE_CANVAS_ERROR",c.message||"migrate canvas error.")}return{title:l.title,description:l.description,docType:l.docType,path:l.path,uuid:l.uuid,version:l.version,ticket:l.ticket,updateTime:Ur(l.updateTime),createTime:Ur(l.createTime),display_title:l.display_title,creator:ea(l.creator),modifier:ta(l.modifier),owner:ra(l.owner),tags:l.tags,source:l.source}}let o=a.message||a.msg||"Request Error.";throw a.code===422?new Dt("UPDATE_SYMBOL_PERMISSIONS",o):new Dt("UPDATE_SYMBOL",o)}async function lbe(t){let e=await yn("GET","/api/v2/components",{...t.query||{},path:t.path,uid:t.uid,page:t.page,pageSize:t.pageSize,docType:[16],tag:t.tags||[]},{headers:{path:t.path},searchParams:!0});if(e.code===0&&e.success&&typeof e.result=="object"){let i=e.result,n=[];for(let s of i.lists)n.push({title:s.title,path:s.path||t.path,docType:s.docType,uuid:s.uuid,version:s.version,ticket:s.ticket,updateTime:Ur(s.updateTime),createTime:Ur(s.createTime),display_title:s.display_title,creator:ea(s.creator),modifier:ta(s.modifier),owner:ra(s.owner),tags:s.tags,source:s.source,description:s.description,dataStr:await Hf(i),dataStrId:i.dataStrId});return{count:i.count,page:i.page,pageSize:i.pageSize,totalPage:i.totalPage,lists:n}}let r=e.message||e.msg||"Request Error.";throw new Dt("GET_D3MODEL_LIST",r)}async function cbe(t){let e=await yn("GET","/api/v2/components",{...Zp(t.query||{}),path:t.path,uid:t.uid,page:t.page,pageSize:t.pageSize,docType:[4],tag:t.tags||[]},{headers:{path:t.path},searchParams:!0});if(e.code===0&&e.success&&typeof e.result=="object"){let i=e.result,n=[];for(let s of i.lists)n.push({title:s.title,path:s.path||t.path,docType:s.docType,uuid:s.uuid,version:s.version,ticket:s.ticket,updateTime:Ur(s.updateTime),createTime:Ur(s.createTime),display_title:s.display_title,creator:ea(s.creator),modifier:ta(s.modifier),owner:ra(s.owner),tags:s.tags,source:s.source,description:s.description});return{count:i.count,page:i.page,pageSize:i.pageSize,totalPage:i.totalPage,lists:n}}let r=e.message||e.msg||"Request Error.";throw new Dt("GET_FOOTPRINT_LIST",r)}async function ube(t){let e=await yn("GET","/api/v2/components",{...Zp(t.query||{}),path:t.path,uid:t.uid,page:t.page,pageSize:t.pageSize,docType:t.docType,tag:t.tags||[]},{headers:{path:t.path},searchParams:!0});if(e.code===0&&e.success&&typeof e.result=="object"){let i=e.result,n=[];for(let s of i.lists)n.push({title:s.title,path:s.path||t.path,docType:s.docType,uuid:s.uuid,version:s.version,ticket:s.ticket,updateTime:Ur(s.updateTime),createTime:Ur(s.createTime),display_title:s.display_title,creator:ea(s.creator),modifier:ta(s.modifier),owner:ra(s.owner),tags:s.tags,source:s.source,description:s.description});return{count:i.count,page:i.page,pageSize:i.pageSize,totalPage:i.totalPage,lists:n}}let r=e.message||e.msg||"Request Error.";throw new Dt("GET_SYMBOL_LIST",r)}function hbe(t){return Array.isArray(t)?t:t?[t]:[]}async function dbe(t){let e=await yn("GET","/api/v2/devices",{...Zp(t.query||{}),path:t.path,uid:t.uid,page:t.page,pageSize:t.pageSize,tag:t.tags||[]},{headers:{path:t.path},searchParams:!0});if(e.code===0&&e.success&&typeof e.result=="object"){let i=e.result,n=[];for(let s of i.lists){let a={title:s.title,path:s.path||t.path,uuid:s.uuid,version:s.version,ticket:s.ticket,updateTime:Ur(s.updateTime),createTime:Ur(s.createTime),display_title:s.display_title,creator:ea(s.creator),modifier:ta(s.modifier),owner:ra(s.owner),tags:s.tags,source:s.source,description:s.description,images:hbe(s.images),attributes:s.attributes,symbol_type:s.symbol_type,isFavorite:s.isFavorite};t.withPackage&&s.symbol&&(a.symbol=Object.assign(s.symbol,{updateTime:Ur(s.symbol.updateTime)}),a.symbol_info=s.symbol_info),t.withPackage&&s.footprint&&(a.footprint=Object.assign(s.footprint,{updateTime:Ur(s.footprint.updateTime)}),a.footprint_info=s.footprint_info),n.push(a)}return{count:i.count,page:i.page,pageSize:i.pageSize,totalPage:i.totalPage,lists:n}}let r=e.message||e.msg||"Request Error.";throw new Dt("GET_DEVICE_LIST",r)}async function Abe(t,e=!1,r=!1){if(t.titles){let{path:A,titles:h}=t,f=await yn("POST","/api/v2/devices/searchByUserUuidAndTitle",{type:"device",titles:h,user_uuids:[A],path:A},{headers:{"Content-type":"application/json","content-type":"application/json",path:A}});if(f.code===0&&f.success&&f.result){let m={};for(let y in f.result){m[y]=[];let g=f.result[y];for(let b of g){let E=ra(b.owner),w={title:b.title,path:b.path||A,uuid:b.uuid,version:b.version,ticket:b.ticket,updateTime:Ur(b.updateTime),createTime:Ur(b.createTime),display_title:b.display_title,creator:e?{}:ea(b.creator),modifier:r?{}:ta(b.modifier),owner:E,tags:b.tags,source:b.source,description:b.description,images:b.images,attributes:b.attributes,symbol_type:b.symbol_type,isFavorite:b.isFavorite};t.withPackage&&b.symbol&&(w.symbol=Object.assign(b.symbol,{updateTime:Ur(b.symbol.updateTime)})),t.withPackage&&b.footprint&&(w.footprint=Object.assign(b.footprint,{updateTime:Ur(b.footprint.updateTime)})),m[y].push(w)}}return m}let p=f.message||f.msg||"Request Error.";throw new Dt("GET_DEVICE_SEARCH_LIST",p)}let{path:i,query:n={},uid:s,page:a,pageSize:o,tags:l=[],wd:c}=t,u=await yn("POST","/api/devices/search",{...Zp(n),path:i,uid:s,page:a,pageSize:o,tag:l,wd:c},{headers:{path:i},searchParams:!0});if(u.code===0&&u.success&&typeof u.result=="object"){let A=u.result,h=[],f=Object.keys(A.lists);for(let p=0;p<f.length;p++){let m=A.lists[f[p]];if(Array.isArray(m)&&m.length)for(let y=0;y<m.length;y++){let g=m[y],b={title:g.title,path:g.path||i,uuid:g.uuid,version:g.version,ticket:g.ticket,updateTime:Ur(g.updateTime),createTime:Ur(g.createTime),display_title:g.display_title,creator:e?{}:ea(g.creator),modifier:r?{}:ta(g.modifier),owner:ra(g.owner),tags:g.tags,source:g.source,description:g.description,images:g.images,attributes:g.attributes,symbol_type:g.symbol_type,isFavorite:g.isFavorite};t.withPackage&&g.symbol&&(b.symbol=Object.assign(g.symbol,{updateTime:g.symbol.updateTime}),b.symbol_info=g.symbol_info),t.withPackage&&g.footprint&&(b.footprint=Object.assign(g.footprint,{updateTime:g.footprint.updateTime}),b.footprint_info=g.footprint_info),h.push(b)}}return{count:A.count,page:A.page,pageSize:A.pageSize,totalPage:A.totalPage,lists:h,facets:A.facets}}let d=u.message||u.msg||"Request Error.";throw new Dt("GET_DEVICE_SEARCH_LIST",d)}async function fbe(t,e=!1,r=!1){if(t.titles){let{path:h,titles:f,docType:p}=t,m=await yn("POST","/api/v2/components/searchByUserUuidAndTitle",{docType:p,titles:f,user_uuids:[h],path:h},{headers:{"Content-type":"application/json","content-type":"application/json",path:h}});if(m.code===0&&m.success&&m.result){let g={};for(let b in m.result){g[b]=[];let E=m.result[b];for(let w of E){let x=ra(w.owner),I={title:w.title,path:w.path||h,docType:w.docType,uuid:w.uuid,version:w.version,ticket:w.ticket,updateTime:Ur(w.updateTime),createTime:Ur(w.createTime),display_title:w.display_title,creator:e?{}:ea(w.creator),modifier:r?{}:ta(w.modifier),owner:x,tags:w.tags,source:w.source,description:w.description};g[b].push(I)}}return g}let y=m.message||m.msg||"Request Error.";throw new Dt("GET_SYMBOL_SEARCH_LIST",y)}let{path:i,query:n,uid:s,page:a,pageSize:o,tags:l=[],wd:c,docType:u}=t,d=await yn("POST","/api/v2/components/search",{...Zp(n||{}),path:i,uid:s,page:a,pageSize:o,docType:u,tag:l,wd:c},{headers:{path:i},searchParams:!0});if(d.code===0&&d.success&&typeof d.result=="object"){let h=d.result,f=[],p=Object.keys(h.lists);for(let m=0;m<p.length;m++){let y=h.lists[p[m]];if(Array.isArray(y)&&y.length)for(let g=0;g<y.length;g++){let b=y[g];f.push({title:b.title,path:b.path||i,docType:b.docType,uuid:b.uuid,version:b.version,ticket:b.ticket,updateTime:Ur(b.updateTime),createTime:Ur(b.createTime),display_title:b.display_title,creator:e?{}:ea(b.creator),modifier:r?{}:ta(b.modifier),owner:ra(b.owner),tags:b.tags,source:b.source,description:b.description})}}return{count:h.count,page:h.page,pageSize:h.pageSize,totalPage:h.totalPage,lists:f,facets:h.facets}}let A=d.message||d.msg||"Request Error.";throw new Dt("GET_SYMBOL_SEARCH_LIST",A)}async function pbe(t,e=!1,r=!1){if(t.titles){let{path:A,titles:h}=t,f=await yn("POST","/api/v2/components/searchByUserUuidAndTitle",{docType:4,titles:h,user_uuids:[A],path:A},{headers:{"Content-type":"application/json","content-type":"application/json",path:A}});if(f.code===0&&f.success&&f.result){let m={};for(let y in f.result){m[y]=[];let g=f.result[y];for(let b of g){let E=ra(b.owner),w={title:b.title,path:b.path||A,docType:b.docType,uuid:b.uuid,version:b.version,ticket:b.ticket,updateTime:Ur(b.updateTime),createTime:Ur(b.createTime),display_title:b.display_title,creator:e?{}:ea(b.creator),modifier:r?{}:ta(b.modifier),owner:E,tags:b.tags,source:b.source,description:b.description};m[y].push(w)}}return m}let p=f.message||f.msg||"Request Error.";throw new Dt("GET_FOOTPRINT_SEARCH_LIST",p)}let{path:i,query:n={},uid:s,page:a,pageSize:o,tags:l=[],wd:c}=t,u=await yn("POST","/api/v2/components/search",{...Zp(n),path:i,uid:s,page:a,pageSize:o,docType:[4],tag:l,wd:c},{headers:{path:i},searchParams:!0});if(u.code===0&&u.success&&typeof u.result=="object"){let A=u.result,h=[],f=Object.keys(A.lists);for(let p=0;p<f.length;p++){let m=A.lists[f[p]];if(Array.isArray(m)&&m.length)for(let y=0;y<m.length;y++){let g=m[y];h.push({title:g.title,path:g.path||i,docType:g.docType,uuid:g.uuid,version:g.version,ticket:g.ticket,updateTime:Ur(g.updateTime),createTime:Ur(g.createTime),display_title:g.display_title,creator:e?{}:ea(g.creator),modifier:r?{}:ta(g.modifier),owner:ra(g.owner),tags:g.tags,source:g.source,description:g.description})}}return{count:A.count,page:A.page,pageSize:A.pageSize,totalPage:A.totalPage,lists:h,facets:A.facets}}let d=u.message||u.msg||"Request Error.";throw new Dt("GET_FOOTPRINT_SEARCH_LIST",d)}async function mbe(t,e=!1,r=!1){if(t.titles){let{path:h,docType:f,titles:p}=t,m=await yn("POST","/api/v2/components/searchByUserUuidAndTitle",{docType:f,titles:p,user_uuids:[h],path:h},{headers:{"Content-type":"application/json","content-type":"application/json",path:h}});if(m.code===0&&m.success&&m.result){let g={};for(let b in m.result){g[b]=[];let E=m.result[b];for(let w of E){let x=ra(w.owner),I={title:w.title,path:w.path||h,docType:w.docType,uuid:w.uuid,version:w.version,ticket:w.ticket,updateTime:Ur(w.updateTime),createTime:Ur(w.createTime),display_title:w.display_title,creator:e?{}:ea(w.creator),modifier:r?{}:ta(w.modifier),owner:x,tags:w.tags,source:w.source,key:w.key,iv:w.iv,dataStr:void 0,dataStrId:w.dataStrId};E.push(I)}}return g}let y=m.message||m.msg||"Request Error.";throw new Dt("GET_SIM_MODEL_SEARCH_LIST",y)}let{path:i,query:n={},uid:s,page:a,pageSize:o,docType:l,tags:c=[],wd:u}=t,d=await yn("POST","/api/v2/components/search",{...Zp(n),path:i,uid:s,page:a,pageSize:o,docType:l,tag:c,wd:u},{headers:{path:i},searchParams:!0});if(d.code===0&&d.success&&typeof d.result=="object"){let h=d.result,f=[],p=Object.keys(h.lists);for(let m=0;m<p.length;m++){let y=h.lists[p[m]];if(Array.isArray(y)&&y.length)for(let g=0;g<y.length;g++){let b=y[g];f.push({title:b.title,path:b.path||i,docType:b.docType,uuid:b.uuid,version:b.version,ticket:b.ticket,updateTime:Ur(b.updateTime),createTime:Ur(b.createTime),display_title:b.display_title,creator:e?{}:ea(b.creator),modifier:r?{}:ta(b.modifier),owner:ra(b.owner),tags:b.tags,source:b.source,key:b.key,iv:b.iv,dataStr:await Hf(h),dataStrId:h.dataStrId})}}return{count:h.count,page:h.page,pageSize:h.pageSize,totalPage:h.totalPage,lists:f,facets:h.facets}}let A=d.message||d.msg||"Request Error.";throw new Dt("GET_SIM_MODEL_SEARCH_LIST",A)}async function gbe(t){if(t.attributes.Symbol){let s=await Ma.getSymbol({isProject:t.isProject,uuid:t.attributes.Symbol,path:t.path})}if(t.attributes.Footprint){let s=await Ma.getFootprint({isProject:t.isProject,uuid:t.attributes.Footprint,path:t.path})}let e=await Ma.getDevice({isProject:t.isProject,uuid:t.uuid,path:t.path}),r=Object.keys(t.attributes||{});for(let s=0;s<r.length;s++)e.attributes[r[s]]=t.attributes[r[s]];let i=await yn("POST",`/api/v2/devices/${t.uuid}`,JSON.stringify({...e,title:e.display_title||e.title,tags:e.tags?Nj(e.tags):[],owner:t.path}),{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(i.code===0&&i.success&&i.result){let s=i.result;return{path:s.path||t.path,title:s.title,description:s.description,attributes:s.attributes,images:s.images,uuid:s.uuid,version:s.version,ticket:s.ticket,updateTime:Ur(s.updateTime),createTime:Ur(s.createTime),display_title:s.display_title,creator:ea(s.creator),modifier:ta(s.modifier),owner:ra(s.owner),tags:s.tags,source:s.source,symbol_type:s.symbol_type}}let n=i.message||i.msg||"Request Error.";throw i.code===422?new Dt("CREATE_DEVICE_PERMISSIONS",n):new Dt("UPDATE_DEVICE_ATTRIBUTES",n)}async function ybe(t,e=!1,r=!1){if(t.titles){let{path:A,titles:h}=t;if(q4){let f=await yn("POST","/api/client/model/find",{titles:h},{headers:{"Content-type":"application/json","content-type":"application/json",path:A}});if(f.code===0&&f.success&&f.result){let m={};for(let y in f.result){m[y]=[];let g=f.result[y];for(let b of g){let E={fileName:b.fileName,path:b.path,lib:b.lib};m[y].push(E)}}return m}let p=f.message||f.msg||"Request Error.";throw new Dt("GET_D3MODEL_SEARCH_LIST",p)}else{let f=await yn("POST","/api/v2/components/searchByUserUuidAndTitle",{docType:16,titles:h,user_uuids:[A],path:A},{headers:{"Content-type":"application/json","content-type":"application/json",path:A}});if(f.code===0&&f.success&&f.result){let m={};for(let y in f.result){m[y]=[];let g=f.result[y];for(let b of g){let E=ra(b.owner),w={title:b.title,path:b.path||A,docType:b.docType,uuid:b.uuid,version:b.version,ticket:b.ticket,updateTime:Ur(b.updateTime),createTime:Ur(b.createTime),display_title:b.display_title,creator:e?{}:ea(b.creator),modifier:r?{}:ta(b.modifier),owner:E,tags:b.tags,source:b.source,description:b.description,dataStr:b.dataStr};m[y].push(w)}}return m}let p=f.message||f.msg||"Request Error.";throw new Dt("GET_D3MODEL_SEARCH_LIST",p)}}let{path:i,query:n={},uid:s,page:a,pageSize:o,tags:l=[],wd:c}=t,u=await yn("POST","/api/v2/components/search",{...Zp(n),path:i,uid:s,page:a,pageSize:o,docType:[16],tag:l,wd:c},{headers:{path:i},searchParams:!0});if(u.code===0&&u.success&&typeof u.result=="object"){let A=u.result,h=[],f=Object.keys(A.lists);for(let p=0;p<f.length;p++){let m=A.lists[f[p]];if(Array.isArray(m)&&m.length)for(let y=0;y<m.length;y++){let g=m[y];h.push({title:g.title,path:g.path||i,docType:g.docType,uuid:g.uuid,version:g.version,ticket:g.ticket,updateTime:Ur(g.updateTime),createTime:Ur(g.createTime),display_title:g.display_title,creator:e?{}:ea(g.creator),modifier:r?{}:ta(g.modifier),owner:ra(g.owner),tags:g.tags,source:g.source,description:g.description,dataStr:g.dataStr})}}return{count:A.count,page:A.page,pageSize:A.pageSize,totalPage:A.totalPage,lists:h,facets:A.facets}}let d=u.message||u.msg||"Request Error.";throw new Dt("GET_D3MODEL_SEARCH_LIST",d)}async function bbe(t,e=!1,r=!1){if(t.titles){let{path:A,titles:h}=t,f=await yn("POST","/api/v2/components/searchByUserUuidAndTitle",{docType:29,titles:h,user_uuids:[A],path:A},{headers:{"Content-type":"application/json","content-type":"application/json",path:A}});if(f.code===0&&f.success&&f.result){let m={};for(let y in f.result){m[y]=[];let g=f.result[y];for(let b of g){let E=ra(b.owner),w={title:b.title,path:b.path||A,docType:b.docType,uuid:b.uuid,version:b.version,ticket:b.ticket,updateTime:Ur(b.updateTime),createTime:Ur(b.createTime),display_title:b.display_title,creator:e?{}:ea(b.creator),modifier:r?{}:ta(b.modifier),owner:E,tags:b.tags,source:b.source,description:b.description};m[y].push(w)}}return m}let p=f.message||f.msg||"Request Error.";throw new Dt("GET_PANEL_LIB_SEARCH_LIST",p)}let{path:i,query:n={},uid:s,page:a,pageSize:o,tags:l=[],wd:c}=t,u=await yn("POST","/api/v2/components/search",{...Zp(n),path:i,uid:s,page:a,pageSize:o,docType:[29],tag:l,wd:c},{headers:{path:i},searchParams:!0});if(u.code===0&&u.success&&typeof u.result=="object"){let A=u.result,h=[],f=Object.keys(A.lists);for(let p=0;p<f.length;p++){let m=A.lists[f[p]];if(Array.isArray(m)&&m.length)for(let y=0;y<m.length;y++){let g=m[y];h.push({title:g.title,path:g.path||i,docType:g.docType,uuid:g.uuid,version:g.version,ticket:g.ticket,updateTime:Ur(g.updateTime),createTime:Ur(g.createTime),display_title:g.display_title,creator:e?{}:ea(g.creator),modifier:r?{}:ta(g.modifier),owner:ra(g.owner),tags:g.tags,source:g.source,description:g.description})}}return{count:A.count,page:A.page,pageSize:A.pageSize,totalPage:A.totalPage,lists:h,facets:A.facets}}let d=u.message||u.msg||"Request Error.";throw new Dt("GET_PANEL_LIB_SEARCH_LIST",d)}var xbe=class extends pM{async getDevice(t){return await Z1e(t)}async getSymbol(t){return await ibe(t)}async getFootprint(t){return await ebe(t)}async getD3Model(t){return await IC(t.uuid,t.path)}async getSimModel(t){return await tbe(t)}async getDeviceList(t){return await dbe(t)}async getSymbolList(t){return await ube(t)}async getFootprintList(t){return await cbe(t)}async getD3ModelList(t){return await lbe(t)}async getSimModelList(t){return rbe(t)}async getDeviceSearchList(t){return await Abe(t,!0,!0)}async getSymbolSearchList(t){return await fbe(t,!0,!0)}async getFootprintSearchList(t){return await pbe(t,!0,!0)}async getPanelLibSearchList(t){return await bbe(t,!0,!0)}async getD3ModelSearchList(t){return await ybe(t,!0,!0)}async getSimModelSearchList(t){return mbe(t,!0,!0)}async createDevice(t){return await W1e(t)}async createSymbol(t){return await $1e(t)}async createFootprint(t){return await K1e(t)}async createD3Model(t){return await X1e(t)}async createSimModel(t){return await J1e(t)}async updateDevice(t){return await nbe(t)}async updateDeviceAttributes(t){return await gbe(t)}async updateSymbol(t){return await obe(t)}async updateFootprint(t){return await sbe(t)}async updatesimModel(t){return await abe(t)}async deleteDevice(t){let e=await yn("POST",`/api/v4/devices/${t.uuid}/delete`,{uuid:t.uuid,path:t.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(!(e.code===0&&e.success)){let r=e.message||e.msg||"Request Error.";throw new Dt("DELETE_DEVICE",r)}}async deleteSymbol(t){let e=await yn("POST",`/api/v4/components/${t.uuid}/delete`,{uuid:t.uuid,path:t.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(!(e.code===0&&e.success)){let r=e.message||e.msg||"Request Error.";throw new Dt("DELETE_SYMBOL",r)}}async deleteFootprint(t){let e=await yn("POST",`/api/v4/components/${t.uuid}/delete`,{uuid:t.uuid,path:t.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(!(e.code===0&&e.success)){let r=e.message||e.msg||"Request Error.";throw new Dt("DELETE_FOOTPRINT",r)}}async deleteSimModel(t){let e=await yn("POST",`/api/v4/components/${t.uuid}/delete`,{uuid:t.uuid,path:t.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(!(e.code===0&&e.success)){let r=e.message||e.msg||"Request Error.";throw new Dt("DELETE_SIM_MODEL",r)}}async delete3DModel(t){let e=await yn("POST",`/api/v4/components/${t.uuid}/delete`,{uuid:t.uuid,path:t.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:t.path}});if(!(e.code===0&&e.success)){let r=e.message||e.msg||"Request Error.";throw new Dt("DELETE_3DMODEL",r)}}},Ag=class{static diffVersionDevice(t){Dr.messageBus.publish("logI18nLogView",{type:"warn",msg:["Devices have not been added to the project library, project library has devices with different versions from the same source :",t.join("\u3001")]})}static diffVersionSymbol(t){Dr.messageBus.publish("logI18nLogView",{type:"warn",msg:["Symbols have not been added to the project library, project library has symbols with different versions from the same source :",t.join("\u3001")]})}static diffVersionFootprint(t){Dr.messageBus.publish("logI18nLogView",{type:"warn",msg:["Footprints have not been added to the project library, project library has footprints with different versions from the same source :",t.join("\u3001")]})}static sameVersionDevice(t){Dr.messageBus.publish("logI18nLogView",{type:"info",msg:["Devices have not been added to the project library, project library has devices with same versions from the same source :",t.join("\u3001")]})}static sameVersionSymbol(t){Dr.messageBus.publish("logI18nLogView",{type:"info",msg:["Symbols have not been added to the project library, project library has symbols with same versions from the same source :",t.join("\u3001")]})}static sameVersionFootprint(t){Dr.messageBus.publish("logI18nLogView",{type:"info",msg:["Footprints have not been added to the project library, project library has footprints with same versions from the same source :",t.join("\u3001")]})}static renamedDevice(t){Dr.messageBus.publish("logI18nLogView",{type:"warn",msg:["Devices are automatically renamed when they are added to the project library :",t.join("\u3001")]})}static renamedSymbol(t){Dr.messageBus.publish("logI18nLogView",{type:"warn",msg:["Symbols are automatically renamed when they are added to the project library :",t.join("\u3001")]})}static renamedFootprint(t){Dr.messageBus.publish("logI18nLogView",{type:"warn",msg:["Footprints are automatically renamed when they are added to the project library :",t.join("\u3001")]})}},Ebe=class{constructor(t){let{renameKey:e=!0}=t;this.renameKey=e}async rename(t,...e){let{message:r}=await Dr.messageBus.rpcCall("allowDuplicateNames");return this.renameKey||!r?this.renaming(t,...e):r?{success:!0}:this.isRename(t,...e)}},wbe=class extends Ebe{constructor(t){let{matchKey:e=!0,byUUID:r=!1,byVersion:i=!1,bySource:n=!1}=t;super(t),this.matchKey=e,this.byUUID=r,this.byVersion=i,this.bySource=n}async match(t){if(this.matchKey)return this.matching(t)}},xM=class extends wbe{constructor(t){let{path:e,data:r}=t;super(t),this.origin={},this.path=e,this.data=r}async onAdd(t){let e=JSON.parse(JSON.stringify(t));return e.path||(e.path=this.path),await uye({data:e}),y4(e),e.project_uuid=e.path=this.path,e}async onUpdate(t){let e=JSON.parse(JSON.stringify(t));return y4(e),e}async getTemplate(t,e={}){let{uuid:r,path:i,updateTime:n}=t,s=`${r}${E2}${i}`,a=n==null?void 0:n.toString(),o=Object.assign(t,{path:i,source:s,version:a},e);return y4(o),o}},sQ=class extends xM{async getOrigin(){var i,n;let{path:t,uuid:e,isProject:r}=this.data;if(w2(this.data)){let{override:s}=this.data;if(s&&s.attributes)return{success:!1,message:"Api call error!"};if(r){let{message:a}=await Dr.messageBus.rpcCall("/pro-mgr/hasProject",[t]);if(a){let o=[e,t],l=(await Dr.messageBus.rpcCall(Yi.DEVICE.GET,o)).message;if(l){let c=Object.assign(l,{uuid:e,path:t});this.origin=await this.getTemplate(c,s)}else return{success:!1,message:"Device details data does not exist"}}else return{success:!1,message:"Get project library data source Project is not open!"}}else if(Hl.getInstance().hasLib(t)){let a=await((n=(i=Hl.getInstance().getLib(t))==null?void 0:i.device)==null?void 0:n.getTransformedDetail(e));if(a){let o=Object.assign(a,{uuid:e,path:t});this.origin=await this.getTemplate(o,s)}else return{success:!1,message:"Device details data does not exist"}}else{let a={path:t,uuid:e},{message:o}=await Dr.messageBus.rpcCall(hg.DEVICE.GET,a);if(o.success){let l=o.result,c=Object.assign(l,{uuid:e,path:t});this.origin=await this.getTemplate(c,s)}else return{success:!1,code:o.code,message:o.message}}}else{let s=this.data.data;this.origin=await this.onHandle(s)}return{success:!0,result:this.origin}}async renaming(t){let e=t.display_title||t.title,r=[e,this.path],i=(await Dr.messageBus.rpcCall(Yi.DEVICE.TRY_RENAME,r)).message;return i&&(t.display_title=t.title=i),e!==i&&Ag.renamedDevice([e]),{success:!0}}},vbe=class extends sQ{onHandle(t){return this.onAdd(t)}async matching(t){if(this.byUUID){let e=[t.uuid,this.path],r=await(await Dr.messageBus.rpcCall(Yi.DEVICE.GET,e)).message;if(t.ticket&&(r!=null&&r.ticket)&&(r==null?void 0:r.ticket)===t.ticket)return r}if(t.source){if(this.byVersion){let e=[t.source,t.version,this.path],r=(await Dr.messageBus.rpcCall(Yi.DEVICE.GET_BY_SOURCE_VERSION,e)).message;if(r)return Ag.sameVersionDevice([t.display_title||t.title]),r}if(this.bySource){let e=[t.source,this.path],r=(await Dr.messageBus.rpcCall(Yi.DEVICE.GET_LAST,e)).message;if(r)return Ag.diffVersionDevice([t.display_title||t.title]),r}}}async isRename(t){let e=[t.display_title||t.title,this.path];return(await Dr.messageBus.rpcCall(Yi.DEVICE.IS_RENAME,e)).message?{success:!1,message:"Device duplicate name"}:{success:!0}}async start(){let t=await this.getOrigin();if(!t.success)return{success:!1,code:t.code,message:t.message};let e,r;if(this.origin){let i=await this.match(this.origin);if(i)e={success:!0,result:i};else{let n=await this.rename(this.origin);if(!n.success)return{success:!1,code:n.code,message:n.message};r=this.origin}}return{success:!0,result:{respond:e,addData:r}}}},aQ=class extends xM{async getOrigin(){var i,n;let{path:t,uuid:e,isProject:r}=this.data;if(w2(this.data)){let{override:s}=this.data;if(r){let{message:a}=await Dr.messageBus.rpcCall("/pro-mgr/hasProject",[t]);if(a){let o=[e,t],l=(await Dr.messageBus.rpcCall(Yi.FOOTPRINT.GET,o)).message;if(l){let c=Object.assign(l,{uuid:e,path:t});this.origin=await this.getTemplate(c,s)}else return{success:!1,message:"Footprint details data does not exist"}}else return{success:!1,message:"Get project library data source Project is not open!"}}else if(Hl.getInstance().hasLib(t)){let a=await((n=(i=Hl.getInstance().getLib(t))==null?void 0:i.footprint)==null?void 0:n.getTransformedDetail(e));if(a){let o=Object.assign(a,{uuid:e,path:t});this.origin=await this.getTemplate(o,s)}else return{success:!1,message:"Footprint details data does not exist"}}else{let a={path:t,uuid:e},{message:o}=await Dr.messageBus.rpcCall(hg.COMPONENT.GET,a);if(o.success){let l=o.result,c=Object.assign(l,{uuid:e,path:t});this.origin=await this.getTemplate(c,s)}else return{success:!1,code:o.code,message:o.message}}}else{let s=this.data.data;this.origin=await this.onHandle(s)}return{success:!0,result:this.origin}}async renaming(t){let e=t.display_title||t.title,r=[e,this.path],i=(await Dr.messageBus.rpcCall(Yi.FOOTPRINT.TRY_RENAME,r)).message;return i&&(t.display_title=t.title=i),e!==i&&Ag.renamedFootprint([e]),{success:!0}}},EM=class extends aQ{onHandle(t){return this.onAdd(t)}async matching(t){if(this.byUUID){let e=[t.uuid,this.path],r=(await Dr.messageBus.rpcCall(Yi.FOOTPRINT.GET,e)).message;if(t.ticket&&(r!=null&&r.ticket)&&(r==null?void 0:r.ticket)===t.ticket)return r}if(t.source){if(this.byVersion){let e=[t.source,t.version,this.path],r=(await Dr.messageBus.rpcCall(Yi.FOOTPRINT.GET_BY_SOURCE_VERSION,e)).message;if(r)return Ag.sameVersionFootprint([t.display_title||t.title]),r}if(this.bySource){let e=[t.source,this.path],r=(await Dr.messageBus.rpcCall(Yi.FOOTPRINT.GET_LAST,e)).message;if(r)return Ag.diffVersionFootprint([t.display_title||t.title]),r}}}async isRename(t){let e=[t.display_title||t.title,this.path];return(await Dr.messageBus.rpcCall(Yi.FOOTPRINT.IS_RENAME,e)).message?{success:!1,message:"Library duplicate name"}:{success:!0}}async start(){let t=await this.getOrigin();if(!t.success)return{success:!1,code:t.code,message:t.message};let e,r;if(this.origin){let i=await this.match(this.origin);if(i)e={success:!0,result:i};else{let n=await this.rename(this.origin);if(!n.success)return{success:!1,code:n.code,message:n.message};r=this.origin}}return{success:!0,result:{respond:e,addData:r}}}},oQ=class extends xM{async getOrigin(){var i,n;let{path:t,uuid:e,isProject:r}=this.data;if(w2(this.data)){let{override:s}=this.data;if(r){let{message:a}=await Dr.messageBus.rpcCall("/pro-mgr/hasProject",[t]);if(a){let o=[e,t],l=(await Dr.messageBus.rpcCall(Yi.SYMBOL.GET,o)).message;if(l){let c=Object.assign(l,{uuid:e,path:t});this.origin=await this.getTemplate(c,s)}else return{success:!1,message:"Symbol details data does not exist"}}else return{success:!1,message:"Get project library data source Project is not open!"}}else if(Hl.getInstance().hasLib(t)){let a=await((n=(i=Hl.getInstance().getLib(t))==null?void 0:i.symbol)==null?void 0:n.getTransformedDetail(e));if(a){let o=Object.assign(a,{uuid:e,path:t});this.origin=await this.getTemplate(o,s)}else return{success:!1,message:"Symbol details data does not exist"}}else{let a={path:t,uuid:e},{message:o}=await Dr.messageBus.rpcCall(hg.COMPONENT.GET,a);if(o.success){let l=o.result,c=Object.assign(l,{uuid:e,path:t});this.origin=await this.getTemplate(c,s)}else return{success:!1,code:o.code,message:o.message}}}else{let s=this.data.data;this.origin=await this.onHandle(s)}return{success:!0,result:this.origin}}async renaming(t){let e=t.display_title||t.title,r=[e,this.path],i=(await Dr.messageBus.rpcCall(Yi.SYMBOL.TRY_RENAME,r)).message;return i&&(t.display_title=t.title=i),e!==i&&Ag.renamedSymbol([e]),{success:!0}}},wM=class extends oQ{onHandle(t){return this.onAdd(t)}async matching(t){if(this.byUUID){let e=[t.uuid,this.path],r=(await Dr.messageBus.rpcCall(Yi.SYMBOL.GET,e)).message;if(t.ticket&&(r!=null&&r.ticket)&&(r==null?void 0:r.ticket)===t.ticket)return r}if(t.source){if(this.byVersion){let e=[t.source,t.version,this.path],r=(await Dr.messageBus.rpcCall(Yi.SYMBOL.GET_BY_SOURCE_VERSION,e)).message;if(r)return Ag.sameVersionSymbol([t.display_title||t.title]),r}if(this.bySource){let e=[t.source,this.path],r=(await Dr.messageBus.rpcCall(Yi.SYMBOL.GET_LAST,e)).message;if(r)return Ag.diffVersionSymbol([t.display_title||t.title]),r}}}async isRename(t){let e=[t.display_title||t.title,this.path];return(await Dr.messageBus.rpcCall(Yi.SYMBOL.IS_RENAME,e)).message?{success:!1,message:"Library duplicate name"}:{success:!0}}async start(){let t=await this.getOrigin();if(!t.success)return{success:!1,code:t.code,message:t.message};let e,r;if(this.origin){let i=await this.match(this.origin);if(i)e={success:!0,result:i};else{let n=await this.rename(this.origin);if(!n.success)return{success:!1,code:n.code,message:n.message};r=this.origin}}return{success:!0,result:{respond:e,addData:r}}}},vM=class{constructor(t){this.path=t}async check(){let{message:{hasPermission:t,errMsg:e}}=await Dr.messageBus.rpcCall("canAddLib",[this.path]);return t?{success:!0}:{success:!1,message:e||"You don't have permission!"}}},lQ=class extends vM{constructor(t){super(t)}async transform(t,e,r){let{device:i,symbol:n,footprint:s}=t,a={device:i,symbol:n,footprint:s};if(n!=null&&n.success&&(n!=null&&n.result)&&e.symbol&&r.symbol){let o=e.symbol,l=n.result,{uuid:c,docType:u,version:d}=l,A=r.symbol.isProject,h=Object.assign(o,{isProject:A}),f={uuid:c,path:this.path,isProject:!0,docType:u,version:d};if((await $p({origin:h,target:f})).success===!1)throw new Error("Library canvas content upload failed!")}if(s!=null&&s.success&&(s!=null&&s.result)&&e.footprint){let o=e.footprint,l=s.result,{uuid:c,docType:u,version:d}=l,A=r.footprint.isProject,h=!!(i!=null&&i.success&&i.result),f=Object.assign(o,{isConnectDevice:h,isProject:A}),p={uuid:c,path:this.path,isProject:!0,docType:u,version:d};if((await $p({origin:f,target:p})).success===!1)throw new Error("Library canvas content upload failed!")}return{success:!0,result:a}}async transformSymbol(){}async onsuccess(t){t.symbol&&!t.symbol.success&&(t.symbol.message=TD(t.symbol)||t.symbol.message),t.footprint&&!t.footprint.success&&(t.footprint.message=TD(t.footprint)||t.footprint.message),t.device&&!t.device.success&&(t.device.message=TD(t.device)||t.device.message)}},Cbe=class extends lQ{constructor(t){let{path:e,data:r,options:i={}}=t,{matchKey:n=!0,byUUID:s=!0,byVersion:a=!0,bySource:o=!0,renameKey:l=!1}=i;super(e),this.addData={},this.result={device:null,symbol:null,footprint:null},this.data=r,this.matchKey=n,this.byUUID=s,this.byVersion=a,this.bySource=o,this.renameKey=l}async start(){var t,e,r,i,n,s,a,o,l,c,u,d;try{let A=await this.check();if(!A.success)return{success:!1,message:A.message};await this.onbefore();let h={path:this.path,matchKey:this.matchKey,byUUID:this.byUUID,byVersion:this.byVersion,bySource:this.bySource,renameKey:this.renameKey};if(this.data.device){let m={...h,data:this.data.device},y=await new vbe(m).start();if(y.success===!1)return{success:!1,code:y.code,message:y.message};let{respond:g,addData:b}=y.result;if(this.result.device=g,b&&(this.addData.device=b),this.getBind(),!this.addData.device&&((t=this.result.device)==null?void 0:t.success)&&((e=this.result.device)==null?void 0:e.result)){let{attributes:E}=this.result.device.result,{Symbol:w,Footprint:x}=E,I=w&&(await Dr.messageBus.rpcCall(Yi.SYMBOL.GET,[w,this.path])).message,C=x&&(await Dr.messageBus.rpcCall(Yi.FOOTPRINT.GET,[x,this.path])).message;this.result.symbol={success:!0,result:I},this.result.footprint={success:!0,result:C}}}if(this.data.symbol){let m={...h,data:this.data.symbol},y=await new wM(m).start();if(y.success===!1&&y.code===404){if(this.addData.device){this.addData.device.attributes.Symbol="";let{display_title:g,title:b}=this.addData.device,E=g||b;Dr.messageBus.publish("logI18nLogView",{type:"warn",msg:["The following devices lose bound symbol data!",E]})}}else{if(y.success===!1)return{success:!1,code:y.code,message:y.message};{let{respond:g,addData:b}=y.result;if(this.result.symbol=g,b&&(this.addData.symbol=b),this.addData.device&&((r=this.result.symbol)==null?void 0:r.success)&&((i=this.result.symbol)==null?void 0:i.result))this.addData.device.attributes.Symbol=this.result.symbol.result.uuid;else if((n=this.addData.device)!=null&&n.attributes.Symbol&&((s=this.result.symbol)!=null&&s.success)&&!((a=this.result.symbol)!=null&&a.result)&&!this.addData.symbol){let E="The symbol associated with the device does not exist!";throw new Dt("CREATE_DEVICE",E)}}}}if(this.data.footprint){let m={...h,data:this.data.footprint},y=await new EM(m).start();if(y.success===!1&&y.code===404){if(this.addData.device){this.addData.device.attributes.Footprint="";let{display_title:g,title:b}=this.addData.device,E=g||b;Dr.messageBus.publish("logI18nLogView",{type:"warn",msg:["The following devices lose bound footprint data!",E]})}}else{if(y.success===!1)return{success:!1,code:y.code,message:y.message};{let{respond:g,addData:b}=y.result;if(this.result.footprint=g,b&&(this.addData.footprint=b),this.addData.device&&((o=this.result.footprint)==null?void 0:o.success)&&((l=this.result.footprint)==null?void 0:l.result))this.addData.device.attributes.Footprint=this.result.footprint.result.uuid;else if((c=this.addData.device)!=null&&c.attributes.Footprint&&((u=this.result.footprint)!=null&&u.success)&&!((d=this.result.footprint)!=null&&d.result)&&!this.addData.footprint){let E="The footprint associated with the device does not exist!";throw new Dt("CREATE_DEVICE",E)}}}}let f=await this.create();if(!f.success)return{success:!1,message:f.message};let p=await this.updateBind();if(!p.success)return{success:!1,message:p.message};if(!this.result)throw new Dt("CREATE_DEVICE","Project library device added failed!");return await this.onsuccess(this.result),{success:!0,result:this.result}}catch(A){return{success:!1,message:A.message}}}getBind(){if(this.addData.device){let{attributes:t}=this.addData.device,{Symbol:e,Footprint:r}=t,{isProject:i}=this.data.device;if(i===void 0)!this.data.symbol&&e&&(this.data.symbol={isProject:!0,path:this.path,uuid:e}),!this.data.footprint&&r&&(this.data.footprint={isProject:!0,path:this.path,uuid:r});else{let[n,s]=this.addData.device.source.split(E2);!this.data.symbol&&e&&(this.data.symbol={isProject:i,path:s,uuid:e}),!this.data.footprint&&r&&(this.data.footprint={isProject:i,path:s,uuid:r})}}}onbeforeCreate(){var t,e,r,i;return(t=this.addData.symbol)!=null&&t.docType&&!jV((e=this.addData.symbol)==null?void 0:e.docType)?{success:!1,message:"invalid symbol docType"}:(r=this.addData.footprint)!=null&&r.docType&&((i=this.addData.footprint)==null?void 0:i.docType)!==4?{success:!1,message:"invalid footprint docType"}:{success:!0}}async create(){var t;if(Object.keys(this.addData).length>0){let e=this.onbeforeCreate();if(!e.success)return{success:!1,message:e.message};let r=[[this.addData],this.path],{message:i}=await Dr.messageBus.rpcCall(Yi.DEVICE.PLACE,r);if(!i.success)return{success:!1,message:i.message};let{device:n,symbol:s,footprint:a}=(t=i.result)==null?void 0:t[0];n&&(this.result.device=n),s&&(this.result.symbol=s),a&&(this.result.footprint=a);let o=await this.transform(this.result,this.addData,this.data);if(!o.success)return{success:!1,message:o.message}}return{success:!0}}async updateBind(){let{device:t,symbol:e,footprint:r}=this.result,i=t!=null&&t.success?t==null?void 0:t.result:null,n=e!=null&&e.success?e==null?void 0:e.result:null,s=r!=null&&r.success?r==null?void 0:r.result:null;if(i){let a=!1;if(n!=null&&n.uuid&&i.attributes.Symbol&&n.uuid!==i.attributes.Symbol&&(i.attributes.Symbol=n.uuid,a=!0),s!=null&&s.uuid&&i.attributes.Footprint&&s.uuid!==i.attributes.Footprint&&(i.attributes.Footprint=s.uuid,a=!0),a){let o=(await Dr.messageBus.rpcCall(Yi.DEVICE.UPDATE,[i,this.path])).message;this.result.device={success:!!o,result:o}}}return{success:!0}}async onbefore(){}},Sbe=class extends sQ{constructor(t,e){super(e),this.uuid=t}onHandle(t){return this.onUpdate(t)}matching(t){throw new Error("Method not implemented.")}async isRename(t){return{success:!0}}async start(){let t=await this.getOrigin();if(!t.success)return{success:!1,code:t.code,message:t.message};if(!this.origin)return{success:!1,message:"Device details data does not exist"};let e=this.origin.display_title||this.origin.title,r=[{uuid:this.uuid,title:e},this.path];if((await Dr.messageBus.rpcCall(Yi.DEVICE.IS_CHANGE,r)).message){let i=await this.rename(this.origin);if(!i.success)return{success:!1,code:i.code,message:i.message}}return{success:!0,result:this.origin}}},Tbe=class extends lQ{constructor(t){let{path:e,uuid:r,data:i,options:n={}}=t,{matchKey:s=!0,byUUID:a=!0,bySource:o=!0,byVersion:l=!1,renameKey:c=!1}=n;super(e),this.addData={},this.map={},this.result={device:null,symbol:null,footprint:null,map:{}},this.uuid=r,this.data=i,this.matchKey=s,this.byUUID=a,this.bySource=o,this.byVersion=l,this.renameKey=c}async start(){var t,e,r,i,n,s,a,o,l,c;try{let u=await this.check();if(!u.success)return{success:!1,message:u.message};await this.onbefore();let d={path:this.path,matchKey:this.matchKey,byUUID:this.byUUID,bySource:this.bySource,byVersion:this.byVersion,renameKey:this.renameKey};if(this.data.device){let f={...d,data:this.data.device},p=await new Sbe(this.uuid,f).start();if(p.success){let m=p.result;m&&(this.updateData=m),this.getBind()}else return{success:!1,code:p.code,message:p.message}}if(this.data.symbol){let f={...d,data:this.data.symbol,renameKey:this.renameKey},p=await new wM(f).start();if(!p.success)return{success:!1,code:p.code,message:p.message};let{respond:m,addData:y}=p.result;if(this.result.symbol=m,y&&(this.addData.symbol=y),this.updateData&&this.addData.symbol)this.updateData.attributes.Symbol=this.addData.symbol.uuid;else if(this.updateData&&((t=this.result.symbol)!=null&&t.success)&&this.result.symbol.result)this.updateData.attributes.Symbol=this.result.symbol.result.uuid;else if((e=this.updateData)!=null&&e.attributes.Symbol&&((r=this.result.symbol)!=null&&r.success)&&!((i=this.result.symbol)!=null&&i.result)&&!this.addData.symbol){let g="The symbol associated with the device does not exist!";throw new Dt("UPDATE_DEVICE",g)}}if(this.data.footprint){let f={...d,data:this.data.footprint,renameKey:this.renameKey},p=await new EM(f).start();if(!p.success)return{success:!1,code:p.code,message:p.message};let{respond:m,addData:y}=p.result;if(this.result.footprint=m,y&&(this.addData.footprint=y),this.updateData&&this.addData.footprint)this.updateData.attributes.Footprint=this.addData.footprint.uuid;else if(this.updateData&&((n=this.result.footprint)!=null&&n.success)&&this.result.footprint.result)this.updateData.attributes.Footprint=this.result.footprint.result.uuid;else if((s=this.updateData)!=null&&s.attributes.Footprint&&((a=this.result.footprint)!=null&&a.success)&&!((o=this.result.footprint)!=null&&o.result)&&!this.addData.footprint){let g="The footprint associated with the device does not exist!";throw new Dt("UPDATE_DEVICE",g)}}let A=await this.create();if(!A.success)return{success:!1,code:A.code,message:A.message};let h=await this.update();if(!h.success)return{success:!1,message:h.message};if(!this.result){let f={text:"Failed to update project library device {title}!",args:{title:((l=this.updateData)==null?void 0:l.display_title)||((c=this.updateData)==null?void 0:c.title)||""}};throw new Dt("UPDATE_DEVICE",f)}return await this.onsuccess(this.result),{success:!0,result:Object.assign(this.result,{map:this.map})}}catch(u){return{success:!1,message:u.message}}}getBind(){if(this.updateData){let{attributes:t}=this.updateData,{Symbol:e,Footprint:r}=t||{},{isProject:i}=this.data.device;if(i===void 0)!this.data.symbol&&e&&(this.data.symbol={isProject:!0,path:this.path,uuid:e}),!this.data.footprint&&r&&(this.data.footprint={isProject:!0,path:this.path,uuid:r});else{let[n,s]=this.updateData.source.split(E2);!this.data.symbol&&e&&(this.data.symbol={isProject:i,path:s,uuid:e}),!this.data.footprint&&r&&(this.data.footprint={isProject:i,path:s,uuid:r})}}}onbeforeCreate(){var t,e,r,i;return(t=this.addData.symbol)!=null&&t.docType&&!jV((e=this.addData.symbol)==null?void 0:e.docType)?{success:!1,message:"invalid symbol docType"}:(r=this.addData.footprint)!=null&&r.docType&&((i=this.addData.footprint)==null?void 0:i.docType)!==4?{success:!1,message:"invalid footprint docType"}:{success:!0}}async create(){let{symbol:t,footprint:e}=this.addData,r=this.onbeforeCreate();if(!r.success)return{success:!1,message:r.message};if(t){let n=(await Dr.messageBus.rpcCall(Yi.SYMBOL.ADD,[t,this.path])).message;if(!n)return{success:!1,message:"Project library symbol added failed!"};this.result.symbol={success:!0,result:n},this.map[t.uuid]=n.uuid}if(e){let n=(await Dr.messageBus.rpcCall(Yi.FOOTPRINT.ADD,[e,this.path])).message;if(!n)return{success:!1,message:"Project library footprint added failed!"};this.result.footprint={success:!0,result:n},this.map[e.uuid]=n.uuid}let i=await this.transform(this.result,this.addData,this.data);return i.success?{success:!0}:{success:!1,message:i.message}}async update(){var e,r,i;let t=this.updateData;if(t){(e=this.result.symbol)!=null&&e.success&&this.result.symbol.result&&(t.attributes.Symbol=(r=this.result.symbol)==null?void 0:r.result.uuid),(i=this.result.footprint)!=null&&i.success&&this.result.footprint.result&&(t.attributes.Footprint=this.result.footprint.result.uuid);let n=[{...t,uuid:this.uuid,keepVersion:this.keepVersion},this.path],s=(await Dr.messageBus.rpcCall(Yi.DEVICE.UPDATE,n)).message;if(!s)return{success:!1,message:{text:"Failed to update project library device {title}!",args:{title:t.display_title||t.title||""}}};this.result.device={success:!0,result:s}}return{success:!0}}async onbefore(){w2(this.data.device)?(this.onlyIdentity=!0,this.keepVersion=!0):(this.onlyIdentity=!1,this.keepVersion=!1)}},cQ=class extends vM{constructor(t){let{path:e,data:r}=t;super(e),this.data=r}async cloneCanvas(t,e){let{uuid:r,version:i,docType:n}=e,s=Object.assign(t,{isProject:this.data.isProject}),a={uuid:r,path:this.path,isProject:!0,docType:n,version:i};if((await $p({origin:s,target:a})).success===!1)throw new Error("Library canvas content upload failed!");return{success:!0}}},Ibe=class extends cQ{constructor(t){let{path:e,data:r,options:i={}}=t,{byUUID:n=!0,byVersion:s=!0,bySource:a=!0,renameKey:o=!0,matchKey:l=!0}=i;super({path:e,data:r}),this.byUUID=n,this.byVersion=s,this.bySource=a,this.renameKey=o,this.matchKey=l}async start(){let t=await this.check();if(!t.success)return{success:!1,message:t.message};await this.onbefore();let e={path:this.path,byUUID:this.byUUID,byVersion:this.byVersion,bySource:this.bySource,renameKey:this.renameKey,matchKey:this.matchKey},r=await new wM({...e,data:this.data}).start();if(!r.success)return{success:!1,code:r.code,message:r.message};let{addData:i,respond:n}=r.result;if(n&&!n.success)return{success:!1,code:n.code,message:n.message};if(n&&n.success)this.result=n.result;else if(i){let s=(await Dr.messageBus.rpcCall(Yi.SYMBOL.ADD,[i,this.path])).message;if(!s)return{success:!1,message:"Project library symbol added failed!"};let a=await this.cloneCanvas(i,s);if(!a.success)return{success:!1,code:a.code,message:a.message};this.result=s}if(!this.result)throw new Dt("CREATE_SYMBOL","Project library symbol added failed!");return await this.onsuccess(this.result),{success:!0,result:this.result}}async onbefore(){}async onsuccess(t){}},uQ=class extends vM{constructor(t){let{path:e,data:r}=t;super(e),this.data=r}async cloneCanvas(t,e){let{uuid:r,version:i,docType:n}=e,s=Object.assign(t,{isProject:this.data.isProject}),a={uuid:r,path:this.path,isProject:!0,docType:n,version:i};if((await $p({origin:s,target:a})).success===!1)throw new Error("Library canvas content upload failed!");return{success:!0}}},Bbe=class extends uQ{constructor(t){let{path:e,data:r,options:i={}}=t,{byUUID:n=!0,byVersion:s=!0,bySource:a=!0,renameKey:o=!0,matchKey:l=!0}=i;super({path:e,data:r}),this.byUUID=n,this.byVersion=s,this.bySource=a,this.renameKey=o,this.matchKey=l}async start(){let t=await this.check();if(!t.success)return{success:!1,message:t.message};await this.onbefore();let e={path:this.path,byUUID:this.byUUID,byVersion:this.byVersion,bySource:this.bySource,renameKey:this.renameKey,matchKey:this.matchKey},r=await new EM({...e,data:this.data}).start();if(!r.success)return{success:!1,code:r.code,message:r.message};let{addData:i,respond:n}=r.result;if(n&&!n.success)return{success:!1,code:n.code,message:n.message};if(n&&n.success)this.result=n.result;else if(i){let s=(await Dr.messageBus.rpcCall(Yi.FOOTPRINT.ADD,[i,this.path])).message;if(!s)return{success:!1,message:"Project library footprint added failed!"};let a=await this.cloneCanvas(i,s);if(!a.success)return{success:!1,code:a.code,message:a.message};this.result=s}if(!this.result)throw new Dt("CREATE_FOOTPRINT","Project library footprint added failed!");return await this.onsuccess(this.result),{success:!0,result:this.result}}async onbefore(){}async onsuccess(t){}},Dbe=class extends oQ{constructor(t,e){super(e),this.uuid=t}onHandle(t){return this.onUpdate(t)}matching(t){throw new Error("Method not implemented.")}async isRename(t){return{success:!0}}async start(){let t=await this.getOrigin();if(!t.success)return{success:!1,code:t.code,message:t.message};if(!this.origin)return{success:!1,message:"Symbol details data does not exist"};let e=this.origin.display_title||this.origin.title,r=[{uuid:this.uuid,title:e},this.path];if((await Dr.messageBus.rpcCall(Yi.SYMBOL.IS_CHANGE,r)).message){let i=await this.rename(this.origin);if(!i.success)return{success:!1,code:i.code,message:i.message}}return{success:!0,result:this.origin}}},_be=class extends cQ{constructor(t){let{path:e,uuid:r,data:i,options:n={}}=t,{matchKey:s=!0,byUUID:a=!0,bySource:o=!0,byVersion:l=!1,renameKey:c=!1}=n;super({path:e,data:i}),this.uuid=r,this.matchKey=s,this.byUUID=a,this.bySource=o,this.byVersion=l,this.renameKey=c}async start(){var n,s;let t=await this.check();if(!t.success)return{success:!1,message:t.message};await this.onbefore();let e={path:this.path,matchKey:this.matchKey,byUUID:this.byUUID,bySource:this.bySource,byVersion:this.byVersion,renameKey:this.renameKey,data:this.data},r=await new Dbe(this.uuid,e).start();if(!r.success)return{success:!1,code:r.code,message:r.message};this.updateData=r.result;let i=[{...this.updateData,uuid:this.uuid,keepVersion:this.keepVersion},this.path];if(this.result=(await Dr.messageBus.rpcCall(Yi.SYMBOL.UPDATE,i)).message,this.result&&this.onlyIdentity){let a=await this.cloneCanvas(this.updateData,this.result);if(!a.success)return{success:!1,code:a.code,message:a.message}}if(!this.result){let a=((n=this.updateData)==null?void 0:n.display_title)||((s=this.updateData)==null?void 0:s.title)||"",o="Failed to update project library symbol {title}!";throw new Dt("UPDATE_SYMBOL",{text:o,args:{title:a}})}return await this.onsuccess(this.result),{success:!0,result:this.result}}async onbefore(){w2(this.data)?(this.onlyIdentity=!0,this.keepVersion=!0):(this.onlyIdentity=!1,this.keepVersion=!1)}async onsuccess(t){}},Pbe=class extends aQ{constructor(t,e){super(e),this.uuid=t}onHandle(t){return this.onUpdate(t)}matching(t){throw new Error("Method not implemented.")}async isRename(t){return{success:!0}}async start(){let t=await this.getOrigin();if(!t.success)return{success:!1,code:t.code,message:t.message};if(!this.origin)return{success:!1,message:"Footprint details data does not exist"};let e=this.origin.display_title||this.origin.title,r=[{uuid:this.uuid,title:e},this.path];if((await Dr.messageBus.rpcCall(Yi.FOOTPRINT.IS_CHANGE,r)).message){let i=await this.rename(this.origin);if(!i.success)return{success:!1,code:i.code,message:i.message}}return{success:!0,result:this.origin}}},Lbe=class extends uQ{constructor(t){let{path:e,uuid:r,data:i,options:n={}}=t,{matchKey:s=!0,byUUID:a=!0,bySource:o=!0,byVersion:l=!1,renameKey:c=!1}=n;super({path:e,data:i}),this.uuid=r,this.matchKey=s,this.byUUID=a,this.bySource=o,this.byVersion=l,this.renameKey=c}async start(){var n,s;let t=await this.check();if(!t.success)return{success:!1,message:t.message};await this.onbefore();let e={path:this.path,matchKey:this.matchKey,byUUID:this.byUUID,bySource:this.bySource,byVersion:this.byVersion,renameKey:this.renameKey,data:this.data},r=await new Pbe(this.uuid,e).start();if(!r.success)return{success:!1,code:r.code,message:r.message};this.updateData=r.result;let i=[{...this.updateData,uuid:this.uuid,keepVersion:this.keepVersion},this.path];if(this.result=(await Dr.messageBus.rpcCall(Yi.FOOTPRINT.UPDATE,i)).message,this.result&&this.onlyIdentity){let a=await this.cloneCanvas(this.updateData,this.result);if(!a.success)return{success:!1,code:a.code,message:a.message}}if(!this.result){let a={text:"Failed to update project library footprint {title}!",args:{title:((n=this.updateData)==null?void 0:n.display_title)||((s=this.updateData)==null?void 0:s.title)||""}};throw new Dt("UPDATE_FOOTPRINT",a)}return await this.onsuccess(this.result),{success:!0,result:this.result}}async onbefore(){w2(this.data)?(this.onlyIdentity=!0,this.keepVersion=!0):(this.onlyIdentity=!1,this.keepVersion=!1)}async onsuccess(t){}},Obe=class extends pM{async getDevice(t){let e=[t.uuid,t.path],{message:r}=await Dr.messageBus.rpcCall(Yi.DEVICE.GET,e);if(!r)throw new Dt("GET_DEVICE","Device details data does not exist");return this.getDeviceOut(Object.assign(r,{path:t.path}))}async getSymbol(t){let e=[t.uuid,t.path],{message:r}=await Dr.messageBus.rpcCall(Yi.SYMBOL.GET,e);if(!r)throw new Dt("GET_SYMBOL","Symbol details data does not exist");return this.getSymbolOut(Object.assign(r,{path:t.path}))}async getFootprint(t){let e=[t.uuid,t.path],{message:r}=await Dr.messageBus.rpcCall(Yi.FOOTPRINT.GET,e);if(!r)throw new Dt("GET_FOOTPRINT","Footprint details data does not exist");return this.getFootprintOut(Object.assign(r,{path:t.path}))}async createDevice(t){let{path:e,device:r,symbol:i,footprint:n}=t,s={path:e,data:{device:r,symbol:i,footprint:n}},a=await new Cbe(s).start();if(!a.success)throw new Dt("CREATE_DEVICE",a.message);let o=a.result.device;if(!(o!=null&&o.success))throw new Dt("CREATE_DEVICE",o==null?void 0:o.message);let l=o.result;return this.getDeviceOut(Object.assign(l,{path:t.path}))}async createSymbol(t){let{path:e,symbol:r}=t,i={path:e,data:r},n=await new Ibe(i).start();if(!n.success)throw new Dt("CREATE_SYMBOL",n.message);let s=n.result;return this.getSymbolOut(Object.assign(s,{path:t.path}))}async createFootprint(t){let{path:e,footprint:r}=t,i={path:e,data:r},n=await new Bbe(i).start();if(!n.success)throw new Dt("CREATE_FOOTPRINT",n.message);let s=n.result;return this.getFootprintOut(Object.assign(s,{path:t.path}))}async updateDevice(t){let{uuid:e,path:r,device:i,symbol:n,footprint:s}=t,a={path:r,uuid:e,data:{device:i,symbol:n,footprint:s}},o=await new Tbe(a).start();if(!o.success)throw new Dt("UPDATE_DEVICE",o.message);let l=o.result.device;if(!(l!=null&&l.success))throw new Dt("CREATE_DEVICE",l==null?void 0:l.message);let c=l.result;return this.getDeviceOut(Object.assign(c,{path:t.path}))}async updateDeviceAttributes(t){let e=(await Dr.messageBus.rpcCall(Yi.DEVICE.UPDATE,[t,t.path])).message;if(!e)throw new Dt("UPDATE_DEVICE_ATTRIBUTES",e.message);return this.getDeviceOut(Object.assign(e,{path:t.path}))}async updateSymbol(t){let{uuid:e,path:r,symbol:i}=t,n={path:r,uuid:e,data:i},s=await new _be(n).start();if(!s.success)throw new Dt("UPDATE_SYMBOL",s.message);let a=s.result;return this.getSymbolOut(Object.assign(a,{path:t.path}))}async updateFootprint(t){let{uuid:e,path:r,footprint:i}=t,n={path:r,uuid:e,data:i},s=await new Lbe(n).start();if(!s.success)throw new Dt("UPDATE_FOOTPRINT",s.message);let a=s.result;return this.getFootprintOut(Object.assign(a,{path:t.path}))}async deleteDevice(t){if(!(await Dr.messageBus.rpcCall(Yi.DEVICE.DEL,t)).message)throw new Dt("DELETE_DEVICE","delete failed!")}async deleteSymbol(t){if(!(await Dr.messageBus.rpcCall(Yi.SYMBOL.DEL,t)).message)throw new Dt("DELETE_SYMBOL","delete failed!")}async deleteFootprint(t){if(!(await Dr.messageBus.rpcCall(Yi.FOOTPRINT.DEL,t)).message)throw new Dt("DELETE_FOOTPRINT","delete failed!")}async getDeviceList(t){let e=(await Dr.messageBus.rpcCall(Yi.DEVICE.GET_LIST,t)).message;if(!e.success)throw new Dt("GET_DEVICE_LIST",e.message);let{count:r,totalPage:i,lists:n,page:s,pageSize:a}=e.result,o=n.map(l=>{let c=this.getDeviceOut(l);return l.symbol&&(c.symbol=this.getSymbolOut(l.symbol)),l.footprint&&(c.footprint=this.getFootprintOut(l.footprint)),c});return{count:r,lists:o,page:s,pageSize:a,totalPage:i}}async getDeviceSearchList(t){let e=(await Dr.messageBus.rpcCall(Yi.DEVICE.GET_LIST,t)).message;if(!e.success)throw new Dt("GET_DEVICE_LIST",e.message);if(t.titles){let r={};for(let i in e.result){let n=e.result[i].map(s=>{let a=this.getDeviceOut(s);return s.symbol&&(a.symbol=this.getSymbolOut(s.symbol)),s.footprint&&(a.footprint=this.getFootprintOut(s.footprint)),a});r[i]=n}return r}else{let{count:r,totalPage:i,lists:n,page:s,pageSize:a}=e.result,o=n.map(l=>{let c=this.getDeviceOut(l);return l.symbol&&(c.symbol=this.getSymbolOut(l.symbol)),l.footprint&&(c.footprint=this.getFootprintOut(l.footprint)),c});return{count:r,lists:o,page:s,pageSize:a,totalPage:i}}}async getSymbolList(t){let e=(await Dr.messageBus.rpcCall(Yi.SYMBOL.GET_LIST,t)).message;if(!e.success)throw new Dt("GET_SYMBOL_LIST",e.message);let{count:r,totalPage:i,lists:n,page:s,pageSize:a}=e.result,o=n.map(this.getSymbolOut);return{count:r,lists:o,page:s,pageSize:a,totalPage:i}}async getSymbolSearchList(t){let e=(await Dr.messageBus.rpcCall(Yi.SYMBOL.GET_LIST,t)).message;if(!e.success)throw new Dt("GET_SYMBOL_LIST",e.message);if(t.titles){let r={};for(let i in e.result)r[i]=e.result[i].map(this.getSymbolOut);return r}else{let{count:r,totalPage:i,lists:n,page:s,pageSize:a}=e.result,o=n.map(this.getSymbolOut);return{count:r,lists:o,page:s,pageSize:a,totalPage:i}}}async getFootprintList(t){let e=(await Dr.messageBus.rpcCall(Yi.FOOTPRINT.GET_LIST,t)).message;if(!e.success)throw new Dt("GET_FOOTPRINT_LIST",e.message);let{count:r,totalPage:i,lists:n,page:s,pageSize:a}=e.result,o=n.map(this.getFootprintOut);return{count:r,lists:o,page:s,pageSize:a,totalPage:i}}async getFootprintSearchList(t){let e=(await Dr.messageBus.rpcCall(Yi.FOOTPRINT.GET_LIST,t)).message;if(!e.success)throw new Dt("GET_FOOTPRINT_LIST",e.message);if(t.titles){let r={};for(let i in e.result)r[i]=e.result[i].map(this.getFootprintOut);return r}else{let{count:r,totalPage:i,lists:n,page:s,pageSize:a}=e.result,o=n.map(this.getFootprintOut);return{count:r,lists:o,page:s,pageSize:a,totalPage:i}}}getDeviceOut(t){return{uuid:t.uuid,path:t.path,title:t.title,display_title:t.display_title,attributes:t.attributes,description:t.description,images:t.images,source:t.source,version:t.version,ticket:t.ticket,creator:t.creator,modifier:t.modifier,createTime:Ur(t.createTime),updateTime:Ur(t.updateTime),owner:t.owner,custom_tags:t.custom_tags,symbol_type:t.symbol_type}}getSymbolOut(t){return{title:t.title,display_title:t.display_title,description:t.description,docType:t.docType,uuid:t.uuid,path:t.path,source:t.source,version:t.version,ticket:t.ticket,creator:t.creator,modifier:t.modifier,updateTime:Ur(t.updateTime),createTime:Ur(t.createTime),owner:t.owner,custom_tags:t.custom_tags}}getFootprintOut(t){return{title:t.title,display_title:t.display_title,description:t.description,docType:t.docType,uuid:t.uuid,path:t.path,source:t.source,version:t.version,ticket:t.ticket,creator:t.creator,modifier:t.modifier,updateTime:Ur(t.updateTime),createTime:Ur(t.createTime),owner:t.owner,custom_tags:t.custom_tags}}},Nbe=class extends pM{constructor(){super(...arguments),this._normalErrorMsg="Request Error.",this._extendLibManager=Hl.getInstance()}async getDevice(t){var r;let e=await((r=this._extendLibManager.getLib(t.path))==null?void 0:r.getTransformedDetailInTab("device",t.uuid));if(e)return e;throw new Dt("GET_DEVICE",this._normalErrorMsg)}async getSymbol(t){var r;let e=await((r=this._extendLibManager.getLib(t.path))==null?void 0:r.getTransformedDetailInTab("symbol",t.uuid));if(e)return e;throw new Dt("GET_SYMBOL",this._normalErrorMsg)}async getFootprint(t){var r;let e=await((r=this._extendLibManager.getLib(t.path))==null?void 0:r.getTransformedDetailInTab("footprint",t.uuid));if(e)return e;throw new Dt("GET_FOOTPRINT",this._normalErrorMsg)}async getDeviceList(t){var r,i,n,s,a,o,l,c;let e=await((c=this._extendLibManager.getLib(t.path))==null?void 0:c.getTransformedListInTab("device",{query:{attributes:(i=(r=t.query)==null?void 0:r.attributes)!=null?i:{},symbolType:(n=t.query)==null?void 0:n.symbol_type,classification:{primaryClassificationUuid:(a=(s=t.tags)==null?void 0:s[0])!=null?a:"",secondaryClassificationUuid:(l=(o=t.tags)==null?void 0:o[1])!=null?l:""}},page:t.page,pageSize:t.pageSize}));if(e)return e;throw new Dt("GET_DEVICE_LIST",this._normalErrorMsg)}async getSymbolList(t){var r,i,n,s,a,o,l;let e=await((l=this._extendLibManager.getLib(t.path))==null?void 0:l.getTransformedListInTab("symbol",{query:{symbolType:(i=(r=t.query)==null?void 0:r.docType)==null?void 0:i[0],classification:{primaryClassificationUuid:(s=(n=t.tags)==null?void 0:n[0])!=null?s:"",secondaryClassificationUuid:(o=(a=t.tags)==null?void 0:a[1])!=null?o:""}},page:t.page,pageSize:t.pageSize}));if(e)return e;throw new Dt("GET_SYMBOL_LIST",this._normalErrorMsg)}async getFootprintList(t){var r,i,n,s,a;let e=await((a=this._extendLibManager.getLib(t.path))==null?void 0:a.getTransformedListInTab("footprint",{query:{classification:{primaryClassificationUuid:(i=(r=t.tags)==null?void 0:r[0])!=null?i:"",secondaryClassificationUuid:(s=(n=t.tags)==null?void 0:n[1])!=null?s:""}},page:t.page,pageSize:t.pageSize}));if(e)return e;throw new Dt("GET_FOOTPRINT_LIST",this._normalErrorMsg)}async getDeviceSearchList(t){var l,c,u,d;let{path:e,wd:r,query:i,tags:n,page:s,pageSize:a}=t,o=await((d=this._extendLibManager.getLib(e))==null?void 0:d.getTransformedListInTab("device",{query:{wd:r,attributes:(l=i==null?void 0:i.attributes)!=null?l:{},symbolType:i==null?void 0:i.symbol_type,classification:{primaryClassificationUuid:(c=n==null?void 0:n[0])!=null?c:"",secondaryClassificationUuid:(u=n==null?void 0:n[1])!=null?u:""}},page:s,pageSize:a}));if(o)return o;throw new Dt("GET_DEVICE_LIST",this._normalErrorMsg)}async getSymbolSearchList(t){var l,c,u,d;let{path:e,wd:r,query:i,tags:n,page:s,pageSize:a}=t,o=await((d=this._extendLibManager.getLib(e))==null?void 0:d.getTransformedListInTab("symbol",{query:{wd:r,symbolType:(l=i==null?void 0:i.docType)==null?void 0:l[0],classification:{primaryClassificationUuid:(c=n==null?void 0:n[0])!=null?c:"",secondaryClassificationUuid:(u=n==null?void 0:n[1])!=null?u:""}},page:s,pageSize:a}));if(o)return o;throw new Dt("GET_SYMBOL_LIST",this._normalErrorMsg)}async getFootprintSearchList(t){var l,c,u;let{path:e,wd:r,query:i,tags:n,page:s,pageSize:a}=t,o=await((u=this._extendLibManager.getLib(e))==null?void 0:u.getTransformedListInTab("footprint",{query:{wd:r,classification:{primaryClassificationUuid:(l=n==null?void 0:n[0])!=null?l:"",secondaryClassificationUuid:(c=n==null?void 0:n[1])!=null?c:""}},page:s,pageSize:a}));if(o)return o;throw new Dt("GET_FOOTPRINT_LIST",this._normalErrorMsg)}createDevice(t){throw new Dt("CREATE_DEVICE","Not Supported.")}createSymbol(t){throw new Dt("GET_SYMBOL","Not Supported.")}createFootprint(t){throw new Dt("CREATE_FOOTPRINT","Not Supported.")}updateDevice(t){throw new Dt("UPDATE_DEVICE","Not Supported.")}updateSymbol(t){throw new Dt("GET_SYMBOL","Not Supported.")}updateFootprint(t){throw new Dt("GET_SYMBOL","Not Supported.")}deleteDevice(t){throw new Dt("GET_SYMBOL","Not Supported.")}deleteSymbol(t){throw new Dt("GET_SYMBOL","Not Supported.")}deleteFootprint(t){throw new Dt("GET_SYMBOL","Not Supported.")}},Rbe=(t=>(t[t.CBB=1]="CBB",t[t.SYMBOL=2]="SYMBOL",t[t.DEVICE=3]="DEVICE",t[t.FOOTPRINT=4]="FOOTPRINT",t[t.MODEL3D=5]="MODEL3D",t[t.MODELSIM=6]="MODELSIM",t[t.PANEL_LIB=29]="PANEL_LIB",t))(Rbe||{}),Mbe=["title","description","tags","images"],Ks=new xbe,cc=new Obe,eg=new Nbe,Ma=class{static getDevice(t){return Hl.getInstance().hasLib(t.path)?eg.getDevice(t):t.isProject?cc.getDevice(t):Ks.getDevice(t)}static getSymbol(t){return Hl.getInstance().hasLib(t.path)?eg.getSymbol(t):t.isProject?cc.getSymbol(t):Ks.getSymbol(t)}static getFootprint(t){return Hl.getInstance().hasLib(t.path)?eg.getFootprint(t):t.isProject?cc.getFootprint(t):Ks.getFootprint(t)}static getD3Model(t){return t.isProject?null:Ks.getD3Model(t)}static getSimModel(t){if(t.isProject)throw new Dt("GET_SIM_MODEL","Api call error!");return Ks.getSimModel(t)}static getDeviceList(t){return Hl.getInstance().hasLib(t.path)?eg.getDeviceList(t):t.isProject?cc.getDeviceList(t):Ks.getDeviceList(t)}static getSymbolList(t){return Hl.getInstance().hasLib(t.path)?eg.getSymbolList(t):t.isProject?cc.getSymbolList(t):Ks.getSymbolList(t)}static getFootprintList(t){return Hl.getInstance().hasLib(t.path)?eg.getFootprintList(t):t.isProject?cc.getFootprintList(t):Ks.getFootprintList(t)}static getD3ModelList(t){if(t.isProject)throw new Dt("GET_D3MODEL_LIST","Api call error!");return Ks.getD3ModelList(t)}static getSimModelList(t){if(t.isProject)throw new Dt("GET_SIM_MODEL_LIST","Api call error!");return Ks.getSimModelList(t)}static getDeviceSearchList(t){return Hl.getInstance().hasLib(t.path)?eg.getDeviceSearchList(t):t.isProject?cc.getDeviceSearchList(t):Ks.getDeviceSearchList(t)}static getSymbolSearchList(t){return Hl.getInstance().hasLib(t.path)?eg.getSymbolSearchList(t):t.isProject?cc.getSymbolSearchList(t):Ks.getSymbolSearchList(t)}static getFootprintSearchList(t){return Hl.getInstance().hasLib(t.path)?eg.getFootprintSearchList(t):t.isProject?cc.getFootprintSearchList(t):Ks.getFootprintSearchList(t)}static getPanelLibSearchList(t){if(t.isProject)throw new Dt("GET_PANEL_LIB_SEARCH_LIST","Api call error!");return Ks.getPanelLibSearchList(t)}static getD3ModelSearchList(t){if(t.isProject)throw new Dt("GET_D3MODEL_SEARCH_LIST","Api call error!");return Ks.getD3ModelSearchList(t)}static getSimModelSearchList(t){if(t.isProject)throw new Dt("GET_SIM_MODEL_SEARCH_LIST","Api call error!");return Ks.getSimModelSearchList(t)}static createDevice(t){return t.isProject?cc.createDevice(t):Ks.createDevice(t)}static createSymbol(t){return t.isProject?cc.createSymbol(t):Ks.createSymbol(t)}static createFootprint(t){return t.isProject?cc.createFootprint(t):Ks.createFootprint(t)}static createD3Model(t){return t.isProject?null:Ks.createD3Model(t)}static createSimModel(t){if(t.isProject)throw new Dt("CREATE_SIM_MODEL","Api call error!");return Ks.createSimModel(t)}static updateDevice(t){return t.isProject?cc.updateDevice(t):Ks.updateDevice(t)}static updateDeviceAttributes(t){return t.isProject?cc.updateDeviceAttributes(t):Ks.updateDeviceAttributes(t)}static updateSymbol(t){return t.isProject?cc.updateSymbol(t):Ks.updateSymbol(t)}static updateFootprint(t){return t.isProject?cc.updateFootprint(t):Ks.updateFootprint(t)}static updateSimModel(t){if(t.isProject)throw new Dt("UPDATE_SIM_MODEL","Api call error!");return Ks.updatesimModel(t)}static deleteDevice(t){return t.isProject?cc.deleteDevice(t):Ks.deleteDevice(t)}static deleteSymbol(t){return t.isProject?cc.deleteSymbol(t):Ks.deleteSymbol(t)}static deleteFootprint(t){return t.isProject?cc.deleteFootprint(t):Ks.deleteFootprint(t)}static deleteSimModel(t){if(t.isProject)throw new Dt("DELETE_SIM_MODEL","Api call error!");return Ks.deleteSimModel(t)}static deleteD3Model(t){if(t.isProject)throw new Dt("DELETE_3DMODEL","Api call error!");return Ks.delete3DModel(t)}};async function hQ(t,e,r,i={}){i.eachProcessHook&&i.eachProcessHook(.01);let n=r||wi.SYSTEMLIB_UUID,s=null;if(e)try{s=await Ma.getDevice({isProject:t,path:r,uuid:e})}catch(u){console.warn(u)}i.eachProcessHook&&i.eachProcessHook(.25);let a=null,o={Footprint:!1,symbol:!1,d3DModel:!1};if(s){let u=(s.attributes||{}).Symbol;if(u){try{a=await Ma.getSymbol({isProject:t,path:r,uuid:u})}catch(d){console.warn(d)}a||(o.symbol=!0)}}i.eachProcessHook&&i.eachProcessHook(.5);let l=null;if(s){let u=(s.attributes||{}).Footprint;if(u){try{l=await Ma.getFootprint({isProject:t,path:r,uuid:u})}catch(d){console.warn(d)}l||(o.Footprint=!0)}}i.eachProcessHook&&i.eachProcessHook(.75);let c=null;if(s){let u=s.attributes||{},d=u["3D Model"],A=u["3D Model Title"],h=TC(d,!0),f=h.path||wi.SYSTEMLIB_UUID||n;if(h.componentTitleOrId&&(h.isLocaleFilenameMode?c=(await fM(h.componentTitleOrId,f)).result:c=await IC(h.componentTitleOrId,f)),!c&&d&&A){if(i.isCheckD3ModelFileExist){let p=await i1e(d);p.success&&p.result instanceof Blob?o.d3DModel=!1:o.d3DModel=!0}else o.d3DModel=!0;c=Rj(d,A,h.path)}}return i.eachProcessHook&&i.eachProcessHook(1),{setPath:n,deviceItem:s,symbolItem:a,footprintItem:l,d3modelItem:c,hasIdButNotFound:o}}async function kbe(t=!1,e,r,i,n){let s=n?!!n.forceAsSymbol:!1,a=n?!!n.ignoreDoctypeCheck:!1,o=n?!!n.isDevice:!1,l=n?!!n.isCheckD3ModelFileExist:!1;if(!a){if(i===28){let d=n?!!n.attachedDeviceBindingExtra:!1,A=n?n.eachProcessHook:null;try{let h=null;return d?h=await hQ(t,e,r,{eachProcessHook:A,isCheckD3ModelFileExist:l}):h=await Ma.getDevice({isProject:t,path:r,uuid:e}),{code:0,success:!0,result:h,message:""}}catch(h){return{code:-1,success:!1,result:null,message:h.message.toString()}}}if(i===4)try{return{code:0,success:!0,result:await Ma.getFootprint({isProject:t,path:r,uuid:e}),message:""}}catch(d){return{code:-1,success:!1,result:null,message:d.message.toString()}}if(s||i&&[2,18,19,20,21,22,25,31,7,32,6].indexOf(i)>=0)try{return{code:0,success:!0,result:await Ma.getSymbol({isProject:t,path:r,uuid:e}),message:""}}catch(d){return{code:-1,success:!1,result:null,message:d.message.toString()}}if(i===16)try{return{code:0,success:!0,result:await IC(e,r),message:""}}catch(d){return{code:-1,success:!1,result:null,message:d.message.toString()}}}let c=await yn("GET",o?`/api/v2/devices/${e}`:`/api/v2/components/${e}`,{uuid:e,path:r},{headers:{"Content-type":"application/json","content-type":"application/json",path:r}});if(c.code===0&&c.success&&typeof c.result=="object")return{code:0,success:!0,result:c.result,message:""};let u=c.message||c.msg||"Request Error.";return{code:c.code||-1,success:!1,result:null,message:u}}function j4(t,e){let r=t.owner||{},i=typeof t.updated_at=="string"?t.updated_at:typeof t.updated_at=="number"?U0(new Date(t.updated_at)):"",n=typeof t.updateTime=="string"?t.updateTime:typeof t.updateTime=="number"?U0(new Date(Ur(t.updateTime))):"";return{...t,$id:String(e),numberIndex:e+1,ownerBelong:r.username,updateTimeString:i||n}}function Fbe(t,e,r){let i=[];for(let n=0;n<t.length;n++){let s=t[n][e]?t[n][e].toLocaleLowerCase():"",a=r?r.toLocaleLowerCase():"";s.indexOf(a)>=0&&i.push(t[n])}return i}async function Ube(t,e,r,i){let n=await new Promise(a=>{fetch(lM.D3Model.client3DModelList,{method:"GET",body:JSON.stringify({step_path:t})}).then(o=>{o.json().then(l=>{if(l){a(l);return}a(null)})})}),s={code:0,success:!0,result:{count:0,page:1,pageSize:i,totalPage:1,lists:[]},msg:""};return n&&n.success?(s.result.lists=(n.result||[]).map((a,o)=>{let l=U0(new Date(a.mtime*1e3)),c={uuid:`${a.fileName}|${e}`,rowFileTag:`${a.fileName}|${e}`,path:e,display_title:a.fileName,description:"",docType:16,isFavorite:!1,modifier:null,owner:null,tags:{child_tag:[],parent_tag:[]},title:a.fileName,updateTime:a.mtime/1e3,updated_at:l,createTime:a.mtime/1e3,created_at:l,creator:null,dataStr:"",public:void 0,type:16};return{...j4(c,o)}}),s.result.count=n.result.length):(s.code=wi.ERR_CODE.NORMAL,s.success=!1,s.msg=n.message||"Fetch local 3D model list error."),s}async function Hbe(t,e,r,i,n){let s={};for(let c=0;c<e.length;c++){let u=e[c].id,d=await new Promise(A=>{fetch(lM.D3Model.client3DModelList,{method:"GET",body:JSON.stringify({step_path:t})}).then(h=>{h.json().then(f=>{if(f){A(f);return}A(null)})})});if(d&&d.success){s[u]={list:d.result.map((A,h)=>j4(A,h))};continue}s[u]=null}let a={},o={},l={count:0};for(let c=0;c<e.length;c++){let u=e[c].id;if(s[u]){let d=Fbe(s[u].list,"fileName",i);if(!d.length){a[u]=0,o[u]=[];continue}a[u]=d.length,o[u]=d.map((A,h)=>{let f=U0(new Date(A.mtime*1e3)),p={uuid:`${A.fileName}|${A.path}`,path:A.path,rowFileTag:`${A.fileName}|${A.path}`,display_title:A.fileName,description:"",docType:16,isFavorite:!1,modifier:null,owner:null,tags:{child_tag:[],parent_tag:[]},title:A.fileName,updateTime:A.mtime/1e3,updated_at:f,createTime:A.mtime/1e3,created_at:f,creator:null,dataStr:"",public:void 0,source:void 0,std_uuid:void 0,ticket:0,type:16};return{...j4(p,h)}}),l.count++;continue}a[u]=0,o[u]=[]}return{code:0,success:!0,result:{count:l.count,facets:a,lists:o,uid:t,wd:i,page:1,pageSize:n,totalPage:1},msg:""}}var Gbe=(t=>(t.ERROR_DATA="Document data abnormality",t.COMPONENT_TITLE_OVER_SIZE="The title length must be between 1~128 characters!",t.COMPONENT_DESC_OVER_SIZE="Description should be no more than 255 letters",t))(Gbe||{});function dQ(t){let e=null;return e=AQ(t.title),!e.success||(e=fQ(t.description),!e.success)?e:{code:0,success:!0,message:"",key:"",result:null}}function AQ(t){let e={code:0,success:!0,message:"",key:"",result:null};return(!t||t.length<=0||t.length>128)&&(e.code=wi.ERR_CODE.NORMAL,e.success=!1,e.message="The title length must be between 1~128 characters!"),e}function fQ(t){let e={code:0,success:!0,message:"",key:"",result:null};return t&&t.length>255&&(e.code=wi.ERR_CODE.NORMAL,e.success=!1,e.message="Description should be no more than 255 letters"),e}async function Ybe(t,e,r,i){if(!e||!r||!i)return{code:-1,success:!1,result:null,message:"missing uuid or path or detail data."};let n=dQ({title:i.title,description:i.description});if(!n.success)return{code:n.code,success:!1,result:null,message:n.message};let s=await yn("POST",`/api/v2/components/${e}/update`,JSON.stringify({...i,owner:r}),{headers:{"Content-type":"application/json","content-type":"application/json",path:r}});if(s.code===0&&s.success&&typeof s.result=="object")return{code:0,success:!0,result:s.result,message:""};let a=s.message||s.msg||"Request Error.";return{code:s.code||-1,success:!1,result:null,message:a}}var Xh,Vbe=(Xh=class{},Xh.createDefaultD3modelItem=Rj,Xh.fetchD3ModelItemHandle=IC,Xh.updateD3ModelItem=Ybe,Xh.d3modelInfoVerify=dQ,Xh.d3modelInfoTitleVerify=AQ,Xh.d3modelInfoDescriptionVerify=fQ,Xh.fetchD3ModelListOnLocaleFolder=Ube,Xh.fetchD3ModelListBySearchOnLocaleFolder=Hbe,Xh.fetchD3ModelItemOnLocaleFolder=fM,Xh),jbe=(t=>(t.ERROR_DATA="Document data abnormality",t.COMPONENT_TITLE_OVER_SIZE="The title length must be between 1~128 characters!",t.COMPONENT_DESC_OVER_SIZE="Description should be no more than 255 letters",t.COMPONENT_ATTRIBUTES_OVER_SIZE="{0} should be no more than 255 letters",t))(jbe||{});function Qbe(t,e=void 0){let r=null;if(r=pQ(t.title),!r.success||(r=mQ(t.description),!r.success)||(r=gQ(t.attributes),!r.success))return r;let i={code:0,success:!0,message:"",key:"",result:null};return typeof e<"u"&&(e.length<=0||e.length>128)&&(i.code=wi.ERR_CODE.NORMAL,i.success=!1,i.message="The title length must be between 1~128 characters!"),i}function pQ(t){let e={code:0,success:!0,message:"",key:"",result:null};return(!t||t.length<=0||t.length>128)&&(e.code=wi.ERR_CODE.NORMAL,e.success=!1,e.message="The title length must be between 1~128 characters!"),e}function mQ(t){let e={code:0,success:!0,message:"",key:"",result:null};return t&&t.length>255&&(e.code=wi.ERR_CODE.NORMAL,e.success=!1,e.message="Description should be no more than 255 letters"),e}function gQ(t){let e={code:0,success:!0,message:"",key:"",result:null},r=Object.keys(t);for(let i=0;i<r.length;i++){let n=r[i],s=t[n];if(typeof s=="string"&&s.trim().length>255)return e.code=wi.ERR_CODE.NORMAL,e.message="{0} should be no more than 255 letters",e.key=n,e}return e}var Xp,zbe=(Xp=class{},Xp.deviceInfoVerify=Qbe,Xp.deviceInfoTitleVerify=pQ,Xp.deviceInfoDescriptionVerify=mQ,Xp.deviceInfoAttributesVerify=gQ,Xp.fetchDeviceItem=hQ,Xp);function Xbe(){return[["DOCTYPE","FOOTPRINT",""],["HEAD",{editorVersion:"dev",importFlag:0}],["CANVAS",0,0,"mm",5,5,5,5,5,5,2,2,5]].map(t=>JSON.stringify(t)).join(`
`)}function qbe(t="",e="",r=""){let i=e||"[Empty Footprint Component Item]",n=new Date().getTime(),s=U0(new Date(n)),a={avatar:"",nickname:"",username:"",uuid:""};return{$emptyItem:!0,createTime:n,created_at:s,creator:{...a},dataStr:t,description:"",display_title:i,docType:4,modifier:{...a},owner:{...a},path:wi.SYSTEMLIB_UUID,public:!1,source:"",std_uuid:"",tags:{child_tag:null,parent_tag:null},ticket:0,title:i,type:0,updateTime:n,updated_at:s,uuid:r||"",version:""}}var Wbe=(t=>(t.ERROR_DATA="Document data abnormality",t.COMPONENT_TITLE_OVER_SIZE="The title length must be between 1~128 characters!",t.COMPONENT_DESC_OVER_SIZE="Description should be no more than 255 letters",t))(Wbe||{});function Kbe(t){let e=null;return e=Jbe(t.title),e.success?{code:0,success:!0,message:"",key:void 0,result:null}:e}function Jbe(t){let e={code:0,success:!0,message:"",key:void 0,result:null};return(!t||t.length<=0||t.length>128)&&(e.code=wi.ERR_CODE.NORMAL,e.success=!1,e.message="The title length must be between 1~128 characters!"),e}var M0,$be=(M0=class{},M0.footprintInfoVerify=Kbe,M0.createEmptyFootprintItem=qbe,M0.createEmptyFootprintDataStr=Xbe,M0),Zbe=(t=>(t.ERROR_DATA="Document data abnormality",t.COMPONENT_TITLE_OVER_SIZE="The title length must be between 1~128 characters!",t.COMPONENT_DESC_OVER_SIZE="Description should be no more than 255 letters",t))(Zbe||{});function exe(t){let e=null;return e=txe(t.title),!e.success||(e=rxe(t.docType),!e.success)?e:{code:0,success:!0,message:"",key:void 0,result:null}}function txe(t){let e={code:0,success:!0,message:"",key:void 0,result:null};return(!t||t.length<=0||t.length>128)&&(e.code=wi.ERR_CODE.NORMAL,e.success=!1,e.message="The title length must be between 1~128 characters!"),e}function rxe(t){let e={code:0,success:!0,message:"",key:void 0,result:null};return(typeof t>"u"||!t)&&(e.code=wi.ERR_CODE.NORMAL,e.success=!1,e.message="Document data abnormality"),e}var m2,ixe=(m2=class{},m2.symbolInfoVerify=exe,m2),nxe=(t=>(t.UNZIP="/pro-mgr/unzip",t.EXTRACT="/pro-mgr/unzip/extract",t.FLOW="/pro-mgr/unzip/flow",t.PARSE="/pro-mgr/unzip/parse",t.CHECK="/pro-mgr/unzip/check",t.GET_PROJECT_IN_CLOUD="/pro-mgr/getProjectInCloud",t.GET_PROJECT_IN_LOCAL="/pro-mgr/getProjectInLocal",t.GET_PROJECT_BY_IN_LOCAL="/pro-mgr/getProjectByInLocal",t.EXPORT_ZIP="/pro-mgr/export/zip",t.EXPORT_DOCUMENT="/pro-mgr/export/document",t.EXPORT_DEVICE="/pro-mgr/export/lib/device",t.EXPORT_SYMBOL="/pro-mgr/export/lib/symbol",t.EXPORT_FOOTPRIN="/pro-mgr/export/lib/footprint",t.EXPORT_PANEL_LIB="/pro-mgr/export/lib/panelLib",t.DOWNLOAD_PROJECT="/pro-mgr/export/download/project",t.DOWNLOAD_CBB="/pro-mgr/export/download/cbb",t.DOWNLOAD_DOCUMENT="/pro-mgr/export/download/document",t.BACKUP="/pro-mgr/backup",t.ARCHIVE="/pro-mgr/archive",t.LOAD_FILE="/pro-mgr/loadFile",t.CONVERT_PROJECT="/pro-mgr/convertProject/start",t.CONVERT_PROJECT_FLOWWIRTE="/pro-mgr/convertProject/flowWrite",t.CONVERT_PROJECT_FLOWREAD="/pro-mgr/convertProject/flowRead",t.IMPORT_NEW_PROJECT="/pro-mgr/importNewProject",t.PROJECT_AS_CLOUD="/pro-mgr/projectAsCloud",t.CBB_AS_CLOUD="/pro-mgr/cbbAsCloud",t.DOCUMENT_AS_CLOUD="/pro-mgr/documentAsCloud",t.COMPONENT_AS_CLOUD="/pro-mgr/componentAsCloud",t.IMPORT_TARGET_PROJECT="/pro-mgr/importTargetProject",t.UPDATE_BLOCK_SYMBOL_CONNECT="/pro-mgr/updateBlockSymbolConnect",t.IMPORT_SYMBOLS="/pro-mgr/importSymbols",t.IMPORT_FOOTPRINTS="/pro-mgr/importFootprints",t.IMPORT_DEVICES="/pro-mgr/importDevices",t.COPY_BOARD="/pro-mgr/copyBoards",t.COPY_SCHEMATIC="/pro-mgr/copySchematics",t.COPY_PAGE="/pro-mgr/copyPages",t.COPY_SCH_CANVAS="/pro-mgr/copySchCanvas",t.COPY_PCB_CANVAS="/pro-mgr/copyPcbCanvas",t.COPY_PANEL_CANVAS="/pro-mgr/copyPanelCanvas",t.PASTE_BOARD="/pro-mgr/pasteBoards",t.PASTE_SCHEMATIC="/pro-mgr/pasteSchematics",t.PASTE_PAGE="/pro-mgr/pastePages",t.PASTE_SCH_TOP="/pro-mgr/pasteSchTop",t.PASTE_PCB="/pro-mgr/pastePcb",t.PASTE_PANEL="/pro-mgr/pastePanel",t.PASTE_SCH_BOTTOM="/pro-mgr/pasteSchBottom",t.BUILD_EXPORT="/pro-mgr/buildExport",t.BUILD_TARGET="/pro-mgr/buildTarget",t.PARSE_PROJECT="/pro-mgr/parseProject",t.COMPARE_LOCAL="/pro-mgr/compare/local",t.COMPARE_CLOUD="/pro-mgr/compare/cloud",t.COMPARE_DESTORY="/pro-mgr/compare/destory",t.UPDATE_REUSE_BLOCK="/pro-mgr/updateReuseBlock",t))(nxe||{});var X8e=AC(fC());var q8e=AC(fC());var sxe=(t=>(t[t.Free=1]="Free",t[t.Strict=3]="Strict",t))(sxe||{});var axe=(t=>(t.name="name",t.default_sheet="default_sheet",t.cbb_project="cbb_project",t))(axe||{}),oxe=(t=>(t.Export2_0="export2.0",t.Export3_0="export3.0",t.Target3_0="exist3.0",t))(oxe||{});var W8e=AC(fC()),lxe=(t=>(t[t.NONE=1]="NONE",t[t.CLIENT_BUT_UUID=2]="CLIENT_BUT_UUID",t[t.ONLINE_BUT_PATH=3]="ONLINE_BUT_PATH",t))(lxe||{});var iu,cxe=(iu=class{},iu.D3Model=Vbe,iu.Device=zbe,iu.Footprint=$be,iu.Symbol=ixe,iu.deleteComponentItem=Oj,iu.deleteComponents=Wye,iu.fetchComponentItem=kbe,iu.queryComponentsByTitle=jD,iu.pickUpComponentTags2Ids=Nj,iu.pickUpComponentTags2Names=M1,iu.getDataStrById=Hf,iu.duplicateNameDetection=F1,iu),UY=class v1{static async getOldLibByNet(e){try{let{dataStrId:r,dataStr:i}=e;return r||i?{success:!0,result:(await Dr.messageBus.rpcCall("/pro-mgr/public/getDataStr",e)).message||""}:{success:!1,message:"Failed to obtain the source code of the existing component library!"}}catch(r){return{success:!1,message:r.message}}}static transform(e,r){let{uuid:i,docType:n}=r,s="";if(n===4){let a=r.isConnectDevice;s=S0e(i,e,a)}else n===29?s=P0e(i,e,tC.PANEL_LIB):HD(n)&&(s=B0e(i,e).dataStr);return s}static async getOtherLibByNet(e){try{let{isProject:r,uuid:i,path:n,docType:s}=e;if(dye(e)){let c={ignoreDoctypeCheck:!0},u=(await cxe.fetchComponentItem(r,i,n,s,c)).result;e=Object.assign(e,u)}let{history_uuid:a,dataStrId:o,dataStr:l}=e;if(a){let c={uuid:i,historyUuid:a},u=(await Dr.messageBus.rpcCall(hg.COMPONENT.GET_HISTORY,c)).message;if(!u.success){let d=["Conversion component format failed!",u.message];return{success:!1,code:u.code,message:d}}return{success:!0,result:(await Dr.messageBus.rpcCall(hg.COMPONENT.GET_HISTORY_DATA,[u.result])).message}}else if(o||l){let c=await v1.getOldLibByNet(e);if(!c.success){let A=["Conversion component format failed!",c.message];return{success:!1,code:c.code,message:A}}let u=c.result,d=v1.transform(u,e);return d?{success:!0,result:d}:{success:!1,message:["Conversion component format failed!","Illegal docType!"]}}else return{success:!0,result:""}}catch(r){return{success:!1,message:r.message}}}static async getOtherLibByWorker(e){try{let r=ur();return{success:!0,result:await Aye(`/${r._TAB_ID_}/libWorker`).rpcCall("/mgr/libWorker/getDataByType",e)}}catch(r){return{success:!1,message:r.message}}}static async getProjectLibByWorker(e){try{let{path:r,uuid:i,docType:n}=e,{message:s}=await Dr.messageBus.rpcCall("/pro-mgr/hasProject",[r]);return s?n===4?{success:!0,result:(await Dr.messageBus.rpcCall(Yi.FOOTPRINT.GET_STR,[i,r])).message||""}:HD(n)?{success:!0,result:(await Dr.messageBus.rpcCall(Yi.SYMBOL.GET_STR,[i,r])).message||""}:{success:!1,message:"Api call error! The api does not exist!"}:{success:!1,message:"Get project library data source Project is not open!"}}catch(r){return{success:!1,message:r.message}}}static async getExtendLib(e){var a,o;let{path:r,uuid:i}=e,n=await((o=(a=Hl.getInstance().getLib(r))==null?void 0:a.footprint)==null?void 0:o.getTransformedDetail(i));if(!(n!=null&&n.dataStr))return{success:!1,message:["Conversion component format failed!","Failed to obtain the source code of the existing component library!"]};let s;return n.dataStr.trim().startsWith("[")?s=v1.transform(n.dataStr,e):s=n.dataStr,s?{success:!0,result:s}:{success:!1,message:["Conversion component format failed!","Illegal docType!"]}}static async getProLibSource(e){try{let{isProject:r,path:i}=e;return Hl.getInstance().hasLib(i)?v1.getExtendLib(e):r?v1.getProjectLibByWorker(e):v1.getOtherLibByWorker(e)}catch(r){return{success:!1,message:r.message}}}},yQ=(t=>(t.INIT_DB="/CommonDB/initDB",t))(yQ||{}),bQ=(t=>(t.GET="/CommonDB/project/getData",t.GET_ALL="/CommonDB/project/getAllArrData",t))(bQ||{}),xQ=(t=>(t.GET="/CommonDB/copyAndPaste/getData",t.SET="/CommonDB/copyAndPaste/setData",t.IS_EXIST="/CommonDB/copyAndPaste/isExist",t.GET_DATA_FROM_PCB_CANVAS="/CommonDB/copyAndPaste/getDataFromPcbCanvas",t))(xQ||{}),EQ=(t=>(t.GET="/CommonDB/copyAndPasteTableCell/getData",t.SET="/CommonDB/copyAndPasteTableCell/setData",t.IS_EXIST="/CommonDB/copyAndPasteTableCell/isExist",t))(EQ||{}),wQ=(t=>(t.SET="/CommonDB/log/setData",t.DEL="/CommonDB/log/delData",t.DEL_LOTS="/CommonDB/log/delLotsData",t.GET_ALL="/CommonDB/log/getAllArrData",t))(wQ||{}),vQ=(t=>(t.SET="/CommonDB/basicLibraryList/addData",t.GET="/CommonDB/basicLibraryList/getData",t.IS_EXIST="/CommonDB/basicLibraryList/isExist",t))(vQ||{}),CQ=(t=>(t.SET="/CommonDB/clipBoard/addData",t.GET="/CommonDB/clipBoard/getData",t.IS_EXIST="/CommonDB/clipBoard/isExist",t))(CQ||{}),SQ=(t=>(t.GET="/CommonDB/lockPrj/getData",t.READ_WRITE="/CommonDB/lockPrj/readwriteData",t))(SQ||{}),TQ=(t=>(t.GET="/CommonDB/prjCache/getData",t.SET="/CommonDB/prjCache/addData",t.DEL="/CommonDB/prjCache/delData",t.DEL_LOTS="/CommonDB/prjCache/delLotsData",t.GET_INDEXS="/CommonDB/prjCache/getAllIndexs",t.GET_COUNT="/CommonDB/prjCache/getCount",t.GET_EARLIEST="/CommonDB/prjCache/getEarliest",t))(TQ||{}),U1={COMMON:yQ,PROJECT:bQ,COPYANDPASTE:xQ,COPYANDPASTE_TABLE_CELL:EQ,LOG:wQ,LIB:vQ,CLIP_BOARD:CQ,LOCK_PROJECT:SQ,PROJECT_CACHE:TQ},uxe=(t=>(t.CREATE="/pro-mgr/library/cbb/create",t.GET_EXPORT="/pro-mgr/library/cbb/getExport",t.GET_TARGET="/pro-mgr/library/cbb/getTarget",t.LIST="/pro-mgr/library/cbb/list",t.PLACE="/pro-mgr/library/cbb/place",t))(uxe||{}),IQ=(t=>(t.CREATE="/pro-mgr/new/cloud/create",t.PROJECT="/pro-mgr/new/cloud/project",t.BOARD="/pro-mgr/new/cloud/board",t.SCHEMATIC="/pro-mgr/new/cloud/schematic",t.SHEET="/pro-mgr/new/cloud/sheet",t.SIMULATION="/pro-mgr/new/cloud/simulation",t.PCB="/pro-mgr/new/cloud/pcb",t.PANEL="/pro-mgr/new/cloud/panel",t))(IQ||{}),BQ=(t=>(t.BOARD="/pro-mgr/new/local/board",t.SCHEMATIC="/pro-mgr/new/local/schematic",t.SHEET="/pro-mgr/new/local/sheet",t.SIMULATION="/pro-mgr/new/local/simulation",t.PCB="/pro-mgr/new/local/pcb",t.PANEL="/pro-mgr/new/local/panel",t))(BQ||{}),DQ={CLOUD:IQ,LOCAL:BQ},hxe=(t=>(t.FORCE="/pro-mgr/project/updateData/force",t.SUSPEND="/pro-mgr/project/updateData/suspend",t.RESUME="/pro-mgr/project/updateData/resume",t.GET="/pro-mgr/project/updateData/getLastest",t.IS_PUBLIC="/pro-mgr/project/updateData/isPublic",t.UPDATE_TEAM="/pro-mgr/project/updateData/updateTeam",t))(hxe||{}),dxe=(t=>(t.UPDATE="/pro-mgr/project/updateData/schematic/update",t.GET="/pro-mgr/project/updateData/schematic/getData",t.MAP="/pro-mgr/project/updateData/schematic/map",t.NOTIFY="/pro-mgr/project/updateData/schematic/notify",t))(dxe||{}),Axe=(t=>(t.UPDATE="/pro-mgr/project/updateData/sheet/update",t.GET="/pro-mgr/project/updateData/sheet/getData",t.MAP="/pro-mgr/project/updateData/sheet/map",t.NOTIFY="/pro-mgr/project/updateData/sheet/notify",t))(Axe||{}),fxe=(t=>(t.UPDATE="/pro-mgr/project/updateData/pcb/update",t.GET="/pro-mgr/project/updateData/pcb/getData",t.MAP="/pro-mgr/project/updateData/pcb/map",t.NOTIFY="/pro-mgr/project/updateData/pcb/notify",t))(fxe||{}),pxe=(t=>(t.UPDATE="/pro-mgr/project/updateData/symbol/update",t.GET="/pro-mgr/project/updateData/symbol/getData",t.MAP="/pro-mgr/project/updateData/symbol/map",t.NOTIFY="/pro-mgr/project/updateData/symbol/notify",t))(pxe||{}),mxe=(t=>(t.UPDATE="/pro-mgr/project/updateData/footprint/update",t.GET="/pro-mgr/project/updateData/footprint/getData",t.MAP="/pro-mgr/project/updateData/footprint/map",t.NOTIFY="/pro-mgr/project/updateData/footprint/notify",t))(mxe||{}),gxe=(t=>(t.UPDATE="/pro-mgr/project/updateData/device/update",t.GET="/pro-mgr/project/updateData/device/getData",t.MAP="/pro-mgr/project/updateData/device/map",t.NOTIFY="/pro-mgr/project/updateData/device/notify",t))(gxe||{});var s_=(t=>(t.PROGRESS="/pro-ui/progressUpdate",t.OPENED_PROJECT="/pro-ui/project/openedProject",t.HAS_UNSAVED="/pro-ui/project/hasUnsaved",t.OPEN="/pro-ui/project/open",t.CLOSE="/pro-ui/project/close",t.ON_OPENED="/pro-ui/project/onOpened",t.ON_FAILED="/pro-mgr/project/onFailed",t.ON_CLOSED="/pro-ui/project/onClosed",t.ADD_HASH="/pro-ui/hash/add/id",t.REMOVE_HASH="/pro-ui/hash/remove/id",t))(s_||{}),_Q=(t=>(t.ON_UPDATE="/pro-mgr/project/project/onUpdate",t.UPLOAD_FAILED="/pro-mgr/project/upload/onfailed",t))(_Q||{}),PQ=(t=>(t.ON_UPDATE="/pro-mgr/project/config/onUpdate",t))(PQ||{}),LQ=(t=>(t.ON_ADD="/pro-mgr/project/board/onAdd",t.ON_DELETE="/pro-mgr/project/board/onDelete",t.ON_UPDATE="/pro-mgr/project/board/onUpdate",t))(LQ||{}),OQ=(t=>(t.ON_ADD="/pro-mgr/project/schematic/onAdd",t.ON_DELETE="/pro-mgr/project/schematic/onDelete",t.ON_UPDATE="/pro-mgr/project/schematic/onUpdate",t.ON_UPDATETIME="/pro-mgr/project/schematic/onUpdateTime",t))(OQ||{}),NQ=(t=>(t.ON_ADD="/pro-mgr/project/sheet/onAdd",t.ON_DELETE="/pro-mgr/project/sheet/onDelete",t.ON_UPDATE="/pro-mgr/project/sheet/onUpdate",t.ON_UPDATETIME="/pro-mgr/project/sheet/onUpdateTime",t))(NQ||{}),RQ=(t=>(t.ON_ADD="/pro-mgr/project/pcb/onAdd",t.ON_DELETE="/pro-mgr/project/pcb/onDelete",t.ON_UPDATE="/pro-mgr/project/pcb/onUpdate",t.ON_UPDATETIME="/pro-mgr/project/pcb/onUpdateTime",t))(RQ||{}),MQ=(t=>(t.ON_ADD="/pro-mgr/project/panel/onAdd",t.ON_DELETE="/pro-mgr/project/panel/onDelete",t.ON_UPDATE="/pro-mgr/project/panel/onUpdate",t.ON_UPDATETIME="/pro-mgr/project/panel/onUpdateTime",t))(MQ||{}),kQ=(t=>(t.ON_ADD="/pro-mgr/project/simulation/onAdd",t.ON_DELETE="/pro-mgr/project/simulation/onDelete",t.ON_UPDATE="/pro-mgr/project/simulation/onUpdate",t.ON_UPDATETIME="/pro-mgr/project/simulation/onUpdateTime",t))(kQ||{}),FQ=(t=>(t.ON_ADD="/pro-mgr/project/device/onAdd",t.ON_DELETE="/pro-mgr/project/device/onDelete",t.ON_UPDATE="/pro-mgr/project/device/onUpdate",t.ON_UPDATETIME="/pro-mgr/project/device/onUpdateTime",t))(FQ||{}),UQ=(t=>(t.ON_ADD="/pro-mgr/project/symbol/onAdd",t.ON_DELETE="/pro-mgr/project/symbol/onDelete",t.ON_UPDATE="/pro-mgr/project/symbol/onUpdate",t.ON_UPDATETIME="/pro-mgr/project/symbol/onUpdateTime",t))(UQ||{}),HQ=(t=>(t.ON_ADD="/pro-mgr/project/footprint/onAdd",t.ON_DELETE="/pro-mgr/project/footprint/onDelete",t.ON_UPDATE="/pro-mgr/project/footprint/onUpdate",t.ON_UPDATETIME="/pro-mgr/project/footprint/onUpdateTime",t))(HQ||{}),GQ=(t=>(t.ON_ADD="/pro-mgr/project/attr/onAdd",t.ON_DELETE="/pro-mgr/project/attr/onDelete",t.ON_UPDATE="/pro-mgr/project/attr/onUpdate",t))(GQ||{}),YQ=(t=>(t.ON_ADD="/pro-mgr/project/blob/onAdd",t.ON_DELETE="/pro-mgr/project/blob/onDelete",t.ON_UPDATE="/pro-mgr/project/blob/onUpdate",t))(YQ||{}),VQ=(t=>(t.ON_ADD="/pro-mgr/project/variant/onAdd",t.ON_DELETE="/pro-mgr/project/variant/onDelete",t.ON_UPDATE_TITLE="/pro-mgr/project/variant/onUpdatetitle",t.ON_UPDATE_NOT_GROUPED="/pro-mgr/project/variant/onUpdateNotGrouped",t.ON_UPDATE_ZINDEX="/pro-mgr/project/variant/onUpdateZIndex",t.ON_ADD_COMPONENT_GROUP="/pro-mgr/project/variant/onAddComponentGroup",t.ON_DELETE_COMPONENT_GROUP="/pro-mgr/project/variant/onDeleteComponentGroup",t.ON_UPDATE_COMPONENT_GROUP_TITLE="/pro-mgr/project/variant/onUpdateComponentGroupTitle",t.ON_UPDATE_COMPONENT_GROUP_ZINDEX="/pro-mgr/project/variant/onUpdateComponentGroupZIndex",t.ON_UPLOAD_COMPONENT_GROUP_INDEX_IN_VARIANT="/pro-mgr/project/variant/onUploadComponentGroupZIndexInVariant",t.ON_DELETE_COMPONENT_GROUP_INDEX_IN_VARIANT="/pro-mgr/project/variant/onDeleteComponentGroupZIndexInVariant",t.ON_UPLOAD_COMPONENT_GROUP_DATA="/pro-mgr/project/variant/onUploadComponentGroupData",t.ON_DELETE_COMPONENT_GROUP_DATA="/pro-mgr/project/variant/onDeleteComponentGroupData",t))(VQ||{}),jQ={PROJECT:_Q,CONFIG:PQ,BOARD:LQ,SCHEMATIC:OQ,SHEET:NQ,PCB:RQ,PANEL:MQ,SIMULATION:kQ,DEVICE:FQ,SYMBOL:UQ,FOOTPRINT:HQ,ATTR:GQ,BLOB:YQ,VARIANT:VQ};var K8e=new Error("list is empty");var yxe=(t=>(t.ALL_VALUE="@all",t.ALL_TITLE="All",t.ComponentSymbol="2",t.NetflagSymbol="18",t.NetportSymbol="19",t.DrawingSymbol="20",t.NonElectronicSymbol="21",t.OffPageConnectorSymbol="25",t.DiffPairsFlagSymbol="31",t))(yxe||{});async function QQ(){let t=await new Promise(e=>{fetch("/api/client/config",{method:"GET"}).then(r=>{r.json().then(i=>{e(i)})})});if(t&&t.success&&t.result){let e=t.result,r=e.projectDir instanceof Array?e.projectDir:[e.projectDir];return{basePath:e.appBaseDir,cbbPath:e.reuseBlock,libPath:e.systemLib,projectPath:r,onlinePrjBackupPath:e.appOnlineBackupDir,appBaseDir:e.appBaseDir,autoCheckVersionUpdate:!!e.checkUpdate,activation:e.activation,appTmpBackupDir:e.appTmpBackupDir,cacheDir:e.cacheDir,proxy:e.proxy,log:e.log}}else return null}function a_(t,e){let r=[],i=[];XD?i=t:e&&e.length?i=e:i=t;let n=null;return i.forEach(s=>{s.uuid===wi.SYSTEMLIB_UUID?n={title:s.nickname,id:s.uuid,key:wi.LIB_SYSTEM_KEY}:r.push({title:s.nickname,id:s.uuid,key:wi.LIB_PERSONAL_KEY})}),n&&r.unshift(n),r}async function o_(t,e){let r=a_(t,e)||[],i=[],n=null;return r.forEach((s,a)=>{s.id===wi.SYSTEMLIB_UUID?n=a:i.push({title:s.title,id:s.id,key:s.key})}),(n||n===0)&&i.splice(0,0,{title:r[n].title,id:r[n].id,key:r[n].key}),i.splice(1,0,{title:"Project",id:"",key:wi.LIB_PROJECT_KEY}),[...i]}async function bxe(t,e){let r=await QQ();if(!r)return await o_(t,e);let i=a_(t,e),n=Yu(i,"id",wi.SYSTEMLIB_UUID),s=[];n.index>=0&&s.splice(0,0,{...n.data});let{projectPath:a,cbbPath:o,libPath:l=[],onlinePrjBackupPath:c,autoCheckVersionUpdate:u}=r;return l.forEach(d=>{s.push({title:HY(d),id:d,key:d})}),s.splice(1,0,{title:"Project",id:"",key:wi.LIB_PROJECT_KEY}),[...s]}function xxe(t,e,r,i){let n=[],s=[],a={},o=[];return t.forEach(l=>{switch(l.titleAdditional=l.title,l.title){case"Project":{if(!i||!r||!r.uuid)return;l.id=r.uuid,o.push(r.uuid);break}default:}l.id||(l.id="@"+dC(new Date().getTime())),typeof a[l.id]<"u"?(a[l.id]+=1,l.id=l.id+wi.LIB_SPLIT_TAG+a[l.id]):a[l.id]=0,e&&e.indexOf(l.id)>=0&&s.push(l.id),n.push(l)}),{treeData:n,projectsIds:o,selectedIds:s}}async function zQ(t,e){let r=a_(t,e)||[],i=[],n=null;return r.forEach((s,a)=>{s.id===wi.SYSTEMLIB_UUID?n=a:i.push({title:s.title,id:s.id,key:s.key})}),(n||n===0)&&i.splice(0,0,{title:r[n].title,id:r[n].id,key:r[n].key}),i.splice(1,0,{title:"Project",id:"",key:wi.LIB_PROJECT_KEY}),[...i]}async function Exe(t,e){let r=await QQ();if(!r)return await o_(t,e);let i=[],{projectPath:n,cbbPath:s,libPath:a=[],onlinePrjBackupPath:o,autoCheckVersionUpdate:l}=r;return a.forEach(c=>{i.push({title:HY(c),id:c,key:c})}),i.splice(1,0,{title:"Project",id:"",key:wi.LIB_PROJECT_KEY}),[...i]}function wxe(t,e,r,i){let n=[],s=[],a={},o=[];return t.forEach(l=>{switch(l.titleAdditional=l.title,l.title){case"Project":{if(!i||!r||!r.uuid)return;l.id=r.uuid,o.push(r.uuid);break}default:}l.id||(l.id="@"+dC(new Date().getTime())),typeof a[l.id]<"u"?(a[l.id]+=1,l.id=l.id+wi.LIB_SPLIT_TAG+a[l.id]):a[l.id]=0,e&&e.indexOf(l.id)>=0&&s.push(l.id),n.push(l)}),{treeData:n,projectsIds:o,selectedIds:s}}function XQ(t,e){let r=[],i=[];return XD?i=t:e&&e.length?i=e:i=t,i.forEach(n=>{r.push({title:n.nickname,id:n.uuid,key:wi.LIB_TEMAS_KEY})}),r}async function QD(t,e){let r=XQ(t,e);return[{title:"System",id:wi.SYSTEMLIB_UUID,key:wi.LIB_SYSTEM_KEY},{title:"Project",id:"",key:wi.LIB_PROJECT_KEY},{title:"Personal",id:"",key:wi.LIB_PERSONAL_KEY},{title:"Favorite",id:wi.FAVORITELIB_UUID,key:wi.LIB_FAVORITE_KEY},...r]}function qQ(t,e,r,i,n){let s=[],a=[],o={},l=[];return t.forEach(c=>{switch(c.title){case"Project":{if(!n||!i||!i.uuid)return;c.id=i.uuid,l.push(i.uuid);break}case"Personal":{if(!r||!r.uuid)return;c.id=r.uuid;break}case"Public":{c.id=wi.PUBLICLIB_ALIAS;break}default:}c.id||(c.id="@"+dC(new Date().getTime())),typeof o[c.id]<"u"?(o[c.id]+=1,c.id=c.id+wi.LIB_SPLIT_TAG+o[c.id]):o[c.id]=0,e&&e.indexOf(c.id)>=0&&a.push(c.id),s.push(c)}),{treeData:s,projectsIds:l,selectedIds:a}}async function Q4(t,e){return await QD(t,e)}function vxe(t,e,r,i,n){return qQ(t,e,r,i,n)}async function WQ(t,e,r,i,n,s){let a=[];return t==="Normal"?kf?BD?(a=await Q4(e,r),s&&AD(a),a):ID?(a=await o_(e,r),s&&AD(a),a):(a=await zQ(e,r),s&&AD(a),a):(a=await QD(e,r),s&&AD(a),a):t==="D3Model"?kf?BD?(a=await Q4(e,r),a):ID?(a=await bxe(e,r),a):(a=await Exe(e,r),a):(a=await QD(e,r),a):[]}function AD(t){let e=Yu(t,"key",wi.LIB_PROJECT_KEY);e.index>=0&&t.splice(e.index,1)}function KQ(t,e,r,i,n,s,a){if(!kf){let l=qQ(t,r,i,n,typeof s<"u"?!!s:a);return fD(l,e),pD(l)}if(BD){let l=vxe(t,r,i,n,typeof s<"u"?!!s:a);return fD(l,e),pD(l)}if(ID){let l=xxe(t,r,n,typeof s<"u"?!!s:a);return fD(l,e),pD(l)}let o=wxe(t,r,n,typeof s<"u"?!!s:a);return fD(o,e),pD(o)}function fD(t,e){let r=Yu(t.treeData,"key",wi.LIB_SYSTEM_KEY);r.index>=0&&t.treeData.splice(r.index,1);let i=Yu(t.treeData,"key",wi.LIB_PERSONAL_KEY);i.index>=0&&t.treeData.splice(i.index,1);let n=Yu(t.treeData,"key","project");n.index>=0&&t.treeData.splice(n.index,1);let s=Yu(t.treeData,"key",wi.LIB_FAVORITE_KEY);s.index>=0&&t.treeData.splice(s.index,1);let a=Yu(t.treeData,"key","selected");a.index>=0&&t.treeData.splice(a.index,1);let o=Yu(t.treeData,"key","oshwhub");o.index>=0&&t.treeData.splice(o.index,1),t.treeData.sort((l,c)=>(l.title||"").localeCompare(c.title||"")),s.index>=0&&t.treeData.unshift(s.data),n.index>=0&&t.treeData.unshift(n.data),e==="Personal"?XD||i.index>=0&&t.treeData.unshift(i.data):t.selectedIds=t.selectedIds.filter(l=>{var c;return l!==((c=i==null?void 0:i.data)==null?void 0:c.id)}),o.index>=0&&t.treeData.unshift(o.data),r.index>=0&&t.treeData.unshift(r.data),a.index>=0&&t.treeData.push(a.data)}function pD(t){return t.selectedIds.length?t.selectedIds:t.selectedIds.push(t.treeData[0].id),t}async function Cxe(t,e,r,i,n,s,a,o,l=!0,c=!0,u=!0){let d={username:s.username,uuid:s.uuid},{projectId:A,title:h,isCBB:f}=n,p={uuid:A,title:h,isCBB:f},m=await WQ(e,a,o,t,r,l),y=KQ(m,i,[],d,p,!l),g=[];for(let b=0;b<y.treeData.length;b++){let E=y.treeData[b];E.id===wi.SYSTEMLIB_UUID&&c||E.id===wi.FAVORITELIB_UUID&&u||(WD||KD||E.key===wi.LIB_PERSONAL_KEY&&(E.title=E.titleAdditional=d.username),E.title&&g.push(E))}return g}var Sxe=(t=>(t.Normal="Normal",t.D3Model="D3Model",t.AssociateDeviceDialog="associateDeviceDialog",t.Cbb="Cbb",t))(Sxe||{}),qh,J8e=(qh=class{},qh.createInitLibList=WQ,qh.createFixLibList=Cxe,qh.filterInitLibList=KQ,qh.fetchTeamsLibsFromGVars=XQ,qh.fetchClientTeamsLibsFromGVars=a_,qh.createSourceLibListByWebMode=QD,qh.createSourceLibListByOnlineClientMode=Q4,qh.createSourceLibListByOfflineClientMode=zQ,qh.createSourceLibListByHalfofflineClientMode=o_,qh),g2,$8e=(g2=class{},g2.syncLoginedUserInfo=e=>{Dr.loginedUserUuid=e.uuid},g2);var Txe=(t=>(t.PROJECT="project.json",t.DEVICE="device.json",t.SYMBOL="symbol.json",t.FOOTPRINT="footprint.json",t.PANEL_LIB="panel-lib.json",t.PROJECT2="project2.json",t.DEVICE2="device2.json",t.SYMBOL2="symbol2.json",t.FOOTPRINT2="footprint2.json",t.PANEL_LIB2="panel-lib2.json",t))(Txe||{}),Ixe=(t=>(t.EXPORT_DEVICE="EXPORT_DEVICE",t.EXPORT_SYMBOL="EXPORT_SYMBOL",t.EXPORT_FOOTPRINT="EXPORT_FOOTPRINT",t.EXPORT_PANEL_LIB="EXPORT_PANEL_LIB",t))(Ixe||{});gAe();var Gf=typeof window>"u"?!1:/\bpanelBoolDebug\b/.test(ur().location.search),I2=class{onOriginSide(e){}onIntersect(e,r,i){}onSplitedSide(e){}getX(e,r){let i=e.getX(r);return Number.isNaN(i)?Math.abs(e.start.y-r)>Math.abs(e.end.y-r)?e.end.x:e.start.x:i}onSegment1(e,r,i){if(Gf){let n=new ne(this.getX(e,i),i),s=new ne(this.getX(r,i),i);this.onSegment(n,e,s,r)}else this.onSegment(e.start,e,r.end,r)}onSegment(e,r,i,n){}onSweep1(e,r,i){if(Gf){let n=new ne(this.getX(e,i),i),s=new ne(this.getX(r,i),i);this.onSweep(n,e,s,r)}else this.onSweep(e.start,e,r.end,r)}onSweep(e,r,i,n){}onScan(e,r,i,n,s,a){}onResultSide(e){}onDebugSide(e){}};var er=(g=>(g.text="text",g.group="group",g.cdot="cdot",g.arc="arc",g.rect="rect",g.circle="circle",g.ellipse="ellipse",g.dimension="dimension",g.dimensionLength="dimensionLength",g.dimensionAngle="dimensionAngle",g.dimensionRadius="dimensionRadius",g.auxiliaryLine="auxiliaryLine",g.auxiliaryPoint="auxiliaryPoint",g.combination="combination",g.obj="obj",g.canvas="canvas",g.unknown="",g.runtime="_runtime",g))(er||{}),Y0=["combination","group","arc","ellipse","rect","text","obj","dimension","auxiliaryLine","auxiliaryPoint","dimensionLength","dimensionAngle","dimensionRadius"];var Fn=class{};Fn.text="Text",Fn.arc="Elliptical Arc",Fn.rect="Rect",Fn.ellipse="Ellipse",Fn.obj="Image",Fn.group="Shape",Fn.auxiliaryLine="Auxiliary Line",Fn.auxiliaryPoint="Auxiliary Point",Fn.dimension="Smart Dimension",Fn.dimensionLength="Dimension Length",Fn.dimensionAngle="Dimension Angle",Fn.dimensionRadius="Dimension Radius",Fn.combination="Group";var l_=["reference-point","attr-name","attr-locked","attr-fill-color-display","attr-stroke-color-display","attr-stroke-fill-swap","attr-font-style","attr-font-weight","attr-font-underline"];var Tn={PANEL_OBJECT_ROOT_NODE:"201",PANEL_OBJECT_LAYER_NODE:"202",PANEL_OBJECT_NODE:"203",PANEL_COMBINATION_ROOT_NODE:"204",PANEL_COMBINATION_OBJECT_NODE:"205"};var c_={0:"\u5168\u90E8",3:"\u906E\u76D6\u5C42",2:"\u80CC\u80F6\u5C42",1:"\u5207\u5272\u5C42",4:"\u6253\u5370\u5C42",7:"\u9F13\u5305\u5C42"};var JQ={1:"Print Layer",2:"Opacity Control Layer",3:"Board Outline Layer",4:"Slot Hole Layer",5:"Glue Cutout Layer",6:"Lighting Simulation Layer"};var CM={3:"#ff0000",4:"#ff0000",5:"#009900",2:"#000000",7:"#000000"};var $Q={"Material Boarder Layer":-1,"Print Layer":1,"Opacity Control Layer":2,"Board Outline Layer":3,"Slot Hole Layer":4,"Glue Cutout Layer":5,"Lighting Simulation Layer":6,"Bun Layer":7,"Assist Drawing Layer":8,[-1]:"Material Boarder Layer",1:"Print Layer",2:"Opacity Control Layer",3:"Board Outline Layer",4:"Slot Hole Layer",5:"Glue Cutout Layer",6:"Lighting Simulation Layer",7:"Bun Layer",8:"Assist Drawing Layer"};function ZQ(t){return/^(pixel|mil|mm|inch)$/i.test(t)}function Yl(t){return ti(t,"pixel","mm")}function lu(t){return ti(t,"mm","pixel")}function ti(t,e,r){if(typeof t=="string"&&(console.error("Plz check code pass number, not string"),arguments.length==2?(r=e,e=t.replace(/^[-+.\d\s]+/,""),t=t.replace(/[^-+.\d\s]+$/,""),t=+t):t=parseFloat(t)),e==r)return t;switch((typeof t!="number"||!isFinite(t))&&console.error(arguments),e==="cm"&&(e="mm",t*=10),r=="cm"&&(r="mm",t*=.1),e+" > "+r){case"mil > pixel":return t*.1;case"mil > mm":return t*.0254;case"mil > inch":return t*.001;case"mm > pixel":return t/.254;case"mm > mil":return t/.0254;case"mm > inch":return t/25.4;case"pixel > mil":return t*10;case"pixel > mm":return t*.254;case"pixel > inch":return t*.01;case"inch > pixel":return t*100;case"inch > mil":return t*1e3;case"inch > mm":return t*25.4;default:throw new Error("err")}}var zt={adsorbGrid:{visible:!0,gridSize:lu(10),enabled:!0,distanceX:10,distanceY:10,altSnapSize:5,gridType:"not",gridColor:"",bgColor:""},canvas:{originX:0,originY:0,strokeWidth:1,unit:"mm",bgColor:"#FFFFFF",gridColor:"#000000"}};function V0(t,e,r){zt[t][e]=r}function DA(t){return navigator.userAgent.indexOf(t)}var DC=DA("Mac OS")>0,Bxe=DA("chromeframe")>0||DA("x-clock")>0,ez=(DA("MSIE")>0||DA("Trident")>=0)&&!Bxe,tz=DA("Edge/")>0,Yd=DA("Opera/")===0,j0=DA("Firefox/")>0,i9e=j0&&navigator.userAgent.match(/Firefox\/(\d+(\.\d+)?)/)[1],n9e=DA("AppleWebKit")>0,_C=DA("Chrome/")>0&&!ez&&!tz&&!Yd&&!j0,s9e=_C&&navigator.userAgent.match(/Chrome\/(\d+(\.\d+)?)/)[1],a9e=DA("Safari/")>-1&&!ez&&!tz&&!Yd&&!j0&&!_C,rz=DA("Electron/")>0;function $t(t={},e){return Object.hasOwnProperty.call(t,e)}function iz(t){return new Promise(e=>setTimeout(e,t))}function _A(...t){}function nz(t){if(t.indexOf("rgb")===-1)throw new Error("\u8BF7\u4EE5 rgb \u5F00\u5934");let e=t.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),r="#";for(let n=0;n<e.length;n++){var i=Number(e[n]).toString(16);i.length<2&&(i="0"+i),r+=i}return r.toUpperCase()}function u_(t){try{return JSON.parse(t)}catch{return console.error(`parseJSON failed:
`+t),null}}function Vd(t,e=0,r){let i,n,s,a,o,l,c=0,u=!1,d=!1,A=!0;if(typeof t!="function")throw new TypeError("Expected a function");e=Number(e)||0,typeof r=="object"&&(u=!!r.leading,d="maxWait"in r,s=d?Math.max(Number(r.maxWait)||0,e):s,A="trailing"in r?!!r.trailing:A);function h(x){let I=i,C=n;return i=n=void 0,c=x,a=t.apply(C,I),a}function f(x){return c=x,o=setTimeout(y,e),u?h(x):a}function p(x){let I=x-l,C=x-c,G=e-I;return d?Math.min(G,s-C):G}function m(x){let I=x-l,C=x-c;return l===void 0||I>=e||I<0||d&&C>=s}function y(){let x=Date.now();if(m(x))return g(x);o=setTimeout(y,p(x))}function g(x){return o=void 0,A&&i?h(x):(i=n=void 0,a)}function b(){o!==void 0&&clearTimeout(o),c=0,i=l=n=o=void 0}function E(){return o===void 0?a:g(Date.now())}function w(){let x=Date.now(),I=m(x);if(i=arguments,n=this,l=x,I){if(o===void 0)return f(l);if(d)return o=setTimeout(y,e),h(l)}return o===void 0&&(o=setTimeout(y,e)),a}return w.cancel=b,w.flush=E,w}function sz(t,e,r){var i=!0,n=!0;if(typeof t!="function")throw new TypeError("Expected a function");return typeof r=="object"&&r&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),Vd(t,e,{leading:i,maxWait:e,trailing:n})}function vi(t){if(typeof t!="object"||t===null||t instanceof Date||t instanceof ArrayBuffer)return t;if(Array.isArray(t))return t.map(vi);let e={};for(let r in t)$t(t,r)&&(e[r]=vi(t[r]));return e}var az={camelize(t){let e=/-(\w)/g;return t.replace(e,(r,i)=>i.toUpperCase())},hyphenate(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}},oz=Object.prototype.toString;function cu(t){return oz.call(t).slice(8,-1)==="Number"&&!Number.isNaN(t)}function Kr(t){return Jh(t)&&Object.keys(t).length===0}function LC(t){return Jh(t)&&Object.keys(t).length}function Jh(t){return oz.call(t)==="[object Object]"}function PC(t,e){if(Jh(t)){for(let r in t){let i=t[r];if(!PC(i,e==null?void 0:e[r]))return!1}return!0}if(!Array.isArray(t)||!Array.isArray(e))return Object.is(t,e);if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!PC(t[r],e[r]))return!1;return!0}function vo(t){return t.nextElementSibling?t.nextElementSibling.id:t.parentNode?"<"+t.parentNode.id:""}function lz(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function h_(...t){d_()&&console.log(...t)}function Zn(...t){if(console.error(...t),d_())throw new Error("Plz Check code")}function d_(){return!1}function OC(t){let e=new Image;return new Promise((r,i)=>{e.onload=function(){let n=document.createElement("canvas"),s=n.getContext("2d");n.width=e.width*4,n.height=e.height*4,s.drawImage(e,0,0,e.width*4,e.height*4);let a=n.toDataURL("image/png");r(a)},e.onerror=n=>{i(n)},e.src=t})}var H1={0:0,90:1,180:0,270:-1},SM={0:1,90:0,180:-1,270:0},A_=[1,10,100,1e3],cz="http://www.w3.org/2000/svg",uz="http://www.w3.org/1999/xlink",fg=(function(){var t={svg:cz,xlink:uz};return t[cz]="svg",t[uz]="xlink",t})(),f_=0,hz=1,TM=2,ju=10,PA=11,Ri=1,$h=6,LA=7,Zh=16,OA=17,ed=8,NA=9,td=18,RA=19,ka=4,rd=12,MA=13,kA=5,id=14,FA=15,Ds=2,ia=3,dz=0,si={SCH:1,PART:2,PRJ:5,BLOCK_SYMBOL:17,NETFLAG:18,NETPORT:19,SHEET_SYMBOL:20,NONEELEC_SYMBOL:21,PANEL:26,PANEL_LIB:29,PANEL3D:27},p_=200;var m_=1e4,Az=0,pg=4,Ya={drag:"DragTool",draw:"DrawTool",paste:"PasteTool",arrayCopy:"ArrayCopyTool",highlight:"HighlightTool",delete:"Delete",rotate:"Rotate",duplicateTo:"DuplicateTo",lock:"LockControl",eleVisable:"EleVisibleMgr",pasteInPlace:"PasteInPlace"},B2="<...>",g_="menu-sep",_c="stop-iterate",y_="can-not-select-flag",IM={acrylic:{thickness:["0.8mm","1.0mm","1.5mm","2.0mm","2.5mm","3.0mm"],craft:["Transparent","Black Translucent"],coverColor:["white","black"]},PVC:{thickness:["0.175mm","0.2mm","0.3mm","0.4mm"],craft:["Glossy Transparent","Frosted Translucent"],coverColor:["white","black"]}};function Sr(t,e=3,r){if(typeof t!="number"&&(t=+t),isNaN(t))return NaN;if(e=e|0,e<=0||!t&&!r)return Math.round(t);var i=A_[e]||Math.pow(10,e)||10;if(r){var n=t<0?"-":"";for(t=t<0?-t:t,t=Math.round(t*i)+"";t.length<=e;)t="0"+t;return t=t.slice(0,-e)+"."+t.slice(-e),parseFloat(n+t)}else return Math.round(t*i+1e-10)/i}function BM(t=""){return t.replace(/[ ,]{2,}| /g,",").split(",").map(Number)}function b_(t,e){for(let r in e)if($t(e,r)&&t.indexOf(r)!==-1)return!0;return!1}function mg(t){let e={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","&":"&amp;"};function r(i){return e[i]}return t==null?"":b_(t+"",e)?(t+"").replace(/[<>'"&]/g,r):t}function NC(t){if(!jd(t))return t;let e={"&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&amp;":"&","&#039;":"'"};function r(i){return e[i]}return b_(t,e)?(t+"").replace(/&([^;]+);/g,r):t}function fz(t){if(typeof t!="string")return t;var e={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"};function r(i){return e[i]}return b_(t,e)?(t+"").replace(/[<>'"]/g,r):t}function jd(t){return typeof t=="string"}function DM(t){return jd(t)&&t.length!==0}function Yf(t){return t?t.trim?t.trim():t.replace(/^\s+|\s+$/g,""):""}function _M(t){return t.indexOf(".")>0?t.replace(/\.?0*$/,""):t}function PM(t){return t.indexOf(".")<0?t+"0":t.replace(/\.(\d)/,"$1.").replace(/^0+(?!\.)/,"").replace(/\.$/,"")}function LM(t){return t.indexOf(".")<0?t.replace(/\d$/,".$&").replace(/^\./,"0."):t.replace(/(\d)\./,".$1").replace(/^\./,"0.")}function ge(t,e,r){if(!t)return null;var i=arguments.length,n,s,a,o;if(t.tagName){if(typeof e=="string")return i===2?t.getAttribute(e):(e.indexOf(":")>0?(s=e.substr(0,e.indexOf(":")),s in fg&&(a=e.substr(s.length+1),_C?t.setAttributeNS(fg[s],e,r):t.setAttributeNS(fg[s],a,r))):(t.setAttribute(e,r),(r===""||r===null||r===void 0)&&(e==="transform"&&t.setAttribute(e,""),t.removeAttribute(e))),t);for(n in e)$t(e,n)&&(n.indexOf(":")>0?(s=n.substr(0,n.indexOf(":")),s in fg&&(a=n.substr(s.length+1),e[n]===""?t.hasAttributeNS(fg[s],a)&&t.removeAttributeNS(fg[s],a):_C?t.setAttributeNS(fg[s],n,e[n]):t.setAttributeNS(fg[s],a,e[n]))):e[n]===""||e[n]==null?t.hasAttribute(n)&&(n==="transform"&&t.setAttribute(n,""),t.removeAttribute(n)):t.setAttribute(n,e[n]));return t}if(Array.isArray(t)||t instanceof NodeList||t instanceof HTMLCollection||Yd&&typeof t.length=="number"){if(typeof e=="string"&&i==2)return t[0]?ge(t[0],e):null;if(i==2)for(o=0;o<t.length;o++)ge(t[o],e);else if(i>=3)for(o=0;o<t.length;o++)ge(t[o],e,r);return t}}function uu(t,e){if(!t)return!1;if(t.classList)return t.classList.contains(e);let r=typeof t.className=="object"?t.className.baseVal:t.className;return e&&r&&r.split(/\s+/).indexOf(e)>=0}function Qu(t,e,r){if(!t||!e)return;let i=e?e.split(/\s+/):[],n=r?"add":r===!1?"remove":"toggle";if(t.classList&&t.classList.toggle){for(let l=0;l<i.length;l++)i[l]&&t.classList[n](i[l]);return}let s=typeof t.className=="object",a=s?t.className.baseVal:t.className,o=a?a.split(/\s+/):[];for(let l=0;l<i.length;l++)if(i[l]){let c=o.indexOf(i[l]);c<0?n!="remove"&&o.push(i[l]):n!="add"&&o.splice(c,1)}a=o.join(" "),s?t.className.baseVal=a:t.className=a}function em(t,e){if(!t||!e)return;let r=e?e.split(/\s+/):[],i;if(t.classList)for(i=0;i<r.length;i++)r[i]&&t.classList.add(r[i]);else{let n=typeof t.className=="object",s=n?t.className.baseVal:t.className,a=s?s.trim().split(/\s+/):[];for(i=0;i<r.length;i++)r[i]&&a.indexOf(r[i])<0&&a.push(r[i]);s=a.join(" "),n?t.className.baseVal=s:t.className=s}}function nd(t,e){let r=e?e.split(/\s+/):[];if(t.classList)for(let i=0;i<r.length;i++)r[i]&&t.classList.remove(r[i]);else{let i=typeof t.className=="object",n=i?t.className.baseVal:t.className,s=n?n.trim().split(/\s+/):[];for(let a=0;a<r.length;a++){let o=s.indexOf(r[a]);o>=0&&s.splice(o,1)}n=s.join(" "),i?t.className.baseVal=n:t.className=n}}function Fe(t){return!t||self.IN_WORKER?(console.error("no id",t,"Plz check code"),null):document.getElementById(t)}function Us(t,e){if(!t||t=="#")return[];try{return(e||document).querySelectorAll(t)}catch{return[]}}function Hs(t,e){if(!t||t=="#")return null;try{return(e||document).querySelector(t)}catch{return null}}function pz(t,e){var r=t&&t.cloneNode(e!==!1);return r}function x_(t,e){var r=+t;if(e=e!="-"?"+":"-",r<=0||isNaN(r))return"100";if(r<.1||r==.1&&e=="-")return"0.1";if(r>X.zoomRatio.max||r==X.zoomRatio.max&&e=="+")return X.zoomRatio.max+"";t=r<1?(10+r+"").substr(1):r+"",t=t.replace(/([1-9]\.?\d)(.*)/,function(l,c,u){return c+u.replace(/[1-9]/g,"0")}),t.match(/[1-9]$/)&&(t=t.indexOf(".")<0?t+".0":t+"0");var i=t.match(/([1-9])\.?(\d)/),n=i[1]+i[2],s="--,10,14,20,27,38,54,75,AA".split(","),a,o;for(DC&&(s="--,10,12,15,17,20,25,30,35,40,50,60,80,90,AA".split(",")),a=1;a<s.length;a++)if(n==s[a]){o=s[e=="+"?a+1:a-1];break}else if(n<s[a]){o=s[e=="+"?a:a-1];break}return o=="AA"?(o=s[1],t=t.replace(/([1-9])(\.?)(\d)/,o[0]+"$2"+o[1]),t=PM(t)):o=="--"?(o=s[s.length-2],t=t.replace(/([1-9])(\.?)(\d)/,o[0]+"$2"+o[1]),t=LM(t)):t=t.replace(/([1-9])(\.?)(\d)/,o[0]+"$2"+o[1]),_M(t)}function Hr(t,e){let r=document.createElementNS("http://www.w3.org/2000/svg",t);return e&&ge(r,e),r}var UA="ignore-me";function mz(){let t=[],e=X.gCanvas.children;for(let r=0,i=e.length;r<i;r++){let n=e[r];if(n.nodeType===Node.ELEMENT_NODE&&n.id){if(uu(n,UA))continue;t.push(n.id)}}return t}var D9e=Math.PI*2,_9e=Math.PI/2,P9e=Math.sin(Math.PI/180),E_=class{constructor(e,r){this.x=+e||0,this.y=+r||0}toString(){return Sr(this.x,4)+"_"+Sr(this.y,4)}};function w_(t,e){if(!t||typeof t!="string")return"";var r=/\d+\.\d{12,}/g,i=A_[e]||Math.pow(10,e)||10;return t.replace(r,function(n){return(Math.round(parseFloat(n)*i+1e-10)/i).toString()})}function Vf(t,e,r){return t>=r.x&&t<=r.x+r.width&&e>=r.y&&e<=r.y+r.height}function RC(t,e){return Vf(t.x,t.y,e)&&Vf(t.x+t.width,t.y,e)&&Vf(t.x,t.y+t.height,e)&&Vf(t.x+t.width,t.y+t.height,e)}function gz(t,e){var r=Math.max(t.x+t.width,e.x+e.width),i=Math.max(t.y+t.height,e.y+e.height),n=Math.min(t.x,e.x),s=Math.min(t.y,e.y);return{x:n,y:s,width:r-n,height:i-s}}function yz(t,e){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function bz(t,e){for(var r=t.points,i=r.length||r.numberOfItems,n=0;n<i;n++)if(Vf(r.getItem(n).x,r.getItem(n).y,e))return!0;var s={x1:e.x,y1:e.y,x2:e.x+e.width,y2:e.y+e.height},a,o,l,c,u,d,A,h;for(n=1;n<i;n++)if(a={x1:r.getItem(n-1).x,y1:r.getItem(n-1).y,x2:r.getItem(n).x,y2:r.getItem(n).y},o=a.x2-a.x1,l=a.y2-a.y1,c={},o>0?(c.x1=a.x1,c.x2=a.x2):(c.x1=a.x2,c.x2=a.x1),l>0?(c.y1=a.y1,c.y2=a.y2):(c.y1=a.y2,c.y2=a.y1),!(c.x1>s.x2||c.x2<s.x1||c.y1>s.y2||c.y2<s.y1)&&(u=l*(s.x1-a.x1)-o*(s.y1-a.y1),d=l*(s.x1-a.x1)-o*(s.y2-a.y1),A=l*(s.x2-a.x1)-o*(s.y1-a.y1),h=l*(s.x2-a.x1)-o*(s.y2-a.y1),!(u>0&&d>0&&A>0&&h>0)&&!(u<0&&d<0&&A<0&&h<0)))return!0;return!1}function D2(t,e,r){var i=t.x,n=t.y,s=e.x,a=e.y,o=r.x,l=r.y,c=s-i,u=a-n,d=c*c+u*u;if(d===0)return(o-i)*(o-i)+(l-n)*(l-n);var A=((o-i)*c+(l-n)*u)/d,h=i+A*c,f=n+A*u,p=h-o,m=f-l;return p*p+m*m}function v_(t,e,r,i){var n=t.x,s=t.y,a=e.x,o=e.y,l=r.x,c=r.y,u=i.x,d=i.y,A=a-n,h=o-s,f=l-u,p=c-d,m=h*f-A*p;if(!m)return null;var y=(A*f*(c-s)-l*A*p+n*h*f)/m,g=(h*p*(l-n)-c*h*f+s*A*p)/-m;return{x:y,y:g}}function Sh(t,e,r,i,n,s){return Math.pow(r-t,2)/Math.pow(n,2)+Math.pow(i-e,2)/Math.pow(s,2)}function Pc(t,e,r){var i,n=+e.x,s=+e.y,a=+r.x,o=+r.y,l=+t.x,c=+t.y,u=a-n,d=o-s,A=l-n,h=c-s,f,p,m,y,g,b;return u===0&&d===0?{d:Math.sqrt(A*A+h*h),point:{x:n,y:s}}:(i=(A*u+h*d)/(u*u+d*d),i<0?{d:Math.sqrt(A*A+h*h),point:{x:n,y:s}}:i>1?(f=l-a,p=c-o,{d:Math.sqrt(f*f+p*p),point:{x:a,y:o}}):(g=n+i*u,b=s+i*d,m=l-g,y=c-b,{d:Math.sqrt(m*m+y*y),point:{x:g,y:b}}))}function sd(t,e,r,i){let n=t-r,s=e-i;return n*n+s*s}function HA(t,e,r,i){return Math.sqrt(sd(t,e,r,i))}function MC(t,e){return HA(t.x,t.y,e.x,e.y)}function Lc(t,e,r,i){if(e=+e,r=+r,i=+i,e=Cs(e),e===0)return t.slice(0);let n=t.map(A=>+A),s=n.length;$t(H1,e)||(H1[e]=Math.sin(e*Math.PI/180),SM[e]=Math.cos(e*Math.PI/180));var a=H1[e],o=SM[e];for(let A=0;A<s;A+=2){var l=n[A],c=n[A+1],u=l-r,d=c-i;n[A]=r+o*u-a*d,n[A+1]=i+o*d+a*u}return n}function Q0(t,e,r){var i=Math.sin(r),n=Math.cos(r),s=t[0]-e[0],a=t[1]-e[1];return[s*n-a*i+e[0],a*n+s*i+e[1]]}function Cs(t){return t<0?(360+t%360)%360:t>=360?t%360:t}function _i(t,e,r=10**-3){let i=t-e;return(i>0?i:-i)<r}function xz(t){return _i(t,0)?0:t}function Oc(t,e){let r=t.x-e.x,i=t.y-e.y,n=.01;return Math.abs(r)<n&&Math.abs(i)<n}function C_(t,e,r){var i=t.x-e.x,n=t.y-e.y,s=r.x-e.x,a=r.y-e.y,o=i*a-n*s,l=i*s+n*a,c=Math.sqrt(i*i+n*n),u=Math.sqrt(s*s+a*a),d=l/(c*u);return d=d>1?1:d<-1?-1:d,Math.acos(d)}function Qd(t,e,r,i,n){return Math.pow(t-r,2)+Math.pow(e-i,2)<=Math.pow(n,2)}function gg(t,e){typeof t=="string"&&(t={x:+t.split(" ")[0],y:+t.split(" ")[1]});for(var r=t.x,i=t.y,n=!1,s=0,a=e.length,o=a-1;s<a;o=s,s++){typeof e[s]=="string"&&(e[s]={x:+e[s].split(" ")[0],y:+e[s].split(" ")[1]});var l=e[s].x,c=e[s].y,u=e[o].x,d=e[o].y;if(l==r&&c==i||u==r&&d==i)return!0;if(c<i&&d>=i||c>=i&&d<i){var A=l+(i-c)*(u-l)/(d-c);if(A==r)return!0;A>r&&(n=!n)}}return n}function Dxe(t,e,r){var i=u(t)&&u(e)&&u(r);if(!i)return console.warn("Bad arguments"),null;var n=e.x-r.x>0?e.x:r.x,s=e.y-r.y>0?e.y:r.y,a=e.x-r.x>0?r.x:e.x,o=e.y-r.y>0?r.y:e.y,l=t.x,c=t.y;return l<=n+.001&&l>=a-.001&&c<=s+.001&&c>=o-.001;function u(d){return d?(d.x=Number(d.x),d.y=Number(d.y),isNaN(d.x)||isNaN(d.y)?(console.warn("Can not convert to Number, NaN found"),!1):!0):(console.warn("Empty input!"),!1)}}function OM(t,e){var r=Math.cos(e),i=Math.sin(e);return{x:t.x*r+t.y*i,y:t.y*r-t.x*i}}function _xe(t,e){return{a:t.y-e.y,b:e.x-t.x,c:t.x*e.y-e.x*t.y}}function Ez(t,e,r,i,n,s){let{a,b:o,c:l}=_xe({x:r,y:i},{x:n,y:s});return{x:(o*o*t-a*o*e-a*l)/(a*a+o*o),y:(-a*o*t+a*a*e-o*l)/(a*a+o*o)}}function tm(t,e,r){for(var i=!1,n,s,a=0,o=e.length-1;a<e.length;o=a++){if(n=e[a],s=e[o],Pxe(t,n,s))return!r;n.y>t.y!=s.y>t.y&&t.x<(t.y-n.y)*(n.x-s.x)/(n.y-s.y)+n.x&&(i=!i)}return i}function Pxe(t,e,r){return Dxe(t,e,r)?_i((t.x-e.x)*(r.y-e.y),(r.x-e.x)*(t.y-e.y),.001):!1}function wz(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function vz(t,e,r,i,n,s,a,o,l){var c=Math.PI*2,u=Math.sin(n),d=Math.cos(n),A=(t-o)/2,h=(e-l)/2,f=(t+o)/2,p=(e+l)/2,m=d*A+u*h,y=d*h-u*A,g=m*m/(r*r)+y*y/(i*i);g>1&&(r=r*Math.sqrt(g),i=i*Math.sqrt(g));var b=r*i,E=r*y,w=i*m,x=E*E+w*w;x||Zn("start point can not be same as end point");var I=Math.sqrt(Math.abs((b*b-x)/x));s==a&&(I=-I);var C=I*E/i,G=-I*w/r;let U=d*C-u*G+f,_=u*C+d*G+p;var H=(m-C)/r,Q=(m+C)/r,j=(y-G)/i,$=(y+G)/i;let B=N(1,0,H,j),M=N(H,j,-Q,-$);for(;M>c;)M-=c;for(;M<0;)M+=c;(a==!1||a==0)&&(M-=c);let v=B+M;for(;v>c;)v-=c;for(;v<0;)v+=c;function N(R,q,P,z){var W=R*P+q*z,oe=Math.sqrt((R*R+q*q)*(P*P+z*z)),Ae=Math.acos(W/oe);return R*z-q*P<0&&(Ae=-Ae),Ae}return{cx:U,cy:_,startAngle:B,deltaAngle:M,endAngle:v}}function Cz(t){return t/180*Math.PI}function kC(t){if(t=t.trim(),t[0]!=="M")return null;let e=t.match(/[Ll]\s*(-?\d+(?:\.\d+)?(?:\s+|,)-?\d+(?:\.\d+)?)/);e&&(t=t.replace(e[0],"").replace("  "," ").replace("Z","").replace("z",""));var r=t.slice(1).split("A");if(r.length!==2)return console.warn("Cannot handle multi arc!"),null;var i=r[0].trim().split(",").reduce(function(a,o){return a.concat(o.trim().split(" "))},[]),n=r[1].trim().split(",").reduce(function(a,o){return a.concat(o.trim().split(" "))},[]);if(n.length!==7)return console.warn("Bad Arc arguments!"),null;let s={M:{x:Number(i[0]),y:Number(i[1])},A:{rx:Number(n[0]),ry:Number(n[1]),rotation:Number(n[2]),largeArc:Number(n[3]),clockwise:Number(n[4]),x:Number(n[5]),y:Number(n[6])}};if(e){let a=e[1].split(/[,\s]+/);s.L={x:Number(a[0]),y:Number(a[1])}}return s}function S_(t){typeof t=="string"&&(t=kC(t));var e=t.M,r=t.A,i=t.A.rx,n=Math.atan2(r.y-e.y,r.x-e.x),s=OM(e,n),a=OM(r,n),o=HA(s.x,s.y,a.x,a.y)/2;i<o&&(i=o);var l=Math.sqrt(i*i-o*o),c=t.A.largeArc===t.A.clockwise?1:-1,u={x:s.x+o,y:s.y-l*c};return OM(u,-n)}function Sz(t){for(var e=[],r=t.numberOfItems,i,n=0;n<r;n++)i=t.getItem(n),e[n]=new E_(i.x,i.y);return e}function FC(t){let e=[];if(!t)return e;let r=BM(t),i=r.length-1;for(let n=0;n<i;n+=2)e[n/2]=new E_(r[n],r[n+1]);return e}function Tz(t,e){return t^=e,e^=t,t^=e,[t,e]}var UC=Object.freeze({});function HC(t){return Object.prototype.toString.call(t).slice(8,-1)==="Set"}function Ir(t){return t==null}function zu(t){return t===void 0}function G1(t){return typeof t=="function"}function Vl(t,e){if(Array.isArray(t)){for(let r=0,i=t.length;r<i;r++)if(e(r,t[r],r)===!1)return}else if(typeof t=="object"&&t!==null){let r=0;for(let i in t)if(Object.prototype.hasOwnProperty.call(t,i)){let n=t[i];if(e(i,n,r)===!1)return;r++}}}function T_(t,e=1){return e>0?t.reduce((r,i)=>r.concat(Array.isArray(i)?T_(i,e-1):i),[]):t.slice()}var NM=Object.freeze([]);function RM(t){return Array.isArray(t)||t&&typeof t=="object"&&Object.prototype.toString.call(t)!="[object String]"&&typeof t.length=="number"&&t.length>=0&&t.length<4294967296&&t.length%1===0}function jf(t){return Array.isArray(t)}var Lxe=Object.create,pX=Object.defineProperty,Oxe=Object.getOwnPropertyDescriptor,Nxe=Object.getOwnPropertyNames,Rxe=Object.getPrototypeOf,Mxe=Object.prototype.hasOwnProperty,kxe=(t=>typeof jh<"u"?jh:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof jh<"u"?jh:e)[r]}):t)(function(t){if(typeof jh<"u")return jh.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')}),Kn=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Fxe=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Nxe(e))!Mxe.call(t,n)&&n!==r&&pX(t,n,{get:()=>e[n],enumerable:!(i=Oxe(e,n))||i.enumerable});return t},X2=(t,e,r)=>(r=t!=null?Lxe(Rxe(t)):{},Fxe(e||!t||!t.__esModule?pX(r,"default",{value:t,enumerable:!0}):r,t)),lS=Kn((t,e)=>{"use strict";var r=Object.defineProperty,i=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,a=(O,K)=>{for(var se in K)r(O,se,{get:K[se],enumerable:!0})},o=(O,K,se,ae)=>{if(K&&typeof K=="object"||typeof K=="function")for(let ue of n(K))!s.call(O,ue)&&ue!==se&&r(O,ue,{get:()=>K[ue],enumerable:!(ae=i(K,ue))||ae.enumerable});return O},l=O=>o(r({},"__esModule",{value:!0}),O),c={};a(c,{BroadcastChannelMessageBus:()=>Qt,MessageBus:()=>He,MessageBus2:()=>ft,MessageBusTask:()=>Le,MessageBusTask2:()=>ut,WindowMessageBridge:()=>ve,WorkerMessageBridge:()=>me,createBroadcastP2PStream:()=>_r,createBufferedByteBufferStream:()=>Pt,createBufferedStream:()=>kt,createBufferedStringStream:()=>sr,dropP2PStream:()=>Lt,flowRead:()=>Jt,flowWrite:()=>Zt}),e.exports=l(c);var u=class{constructor(O=1.5){this.growthFactor=O,this.capacity=10,this.buffer=new Array(this.capacity),this.head=0,this.tail=0,this.count=0}enqueue(O){if(this.count===this.capacity){let K=Math.floor(this.capacity*this.growthFactor);console.log("grow",this.capacity,K);let se=new Array(K);for(let ae=0;ae<this.count;ae++)se[ae]=this.buffer[(this.head+ae)%this.capacity];this.buffer=se,this.head=0,this.tail=this.count,this.capacity=K}this.buffer[this.tail]=O,this.tail=(this.tail+1)%this.capacity,this.count++}dequeue(){if(this.isEmpty())return;let O=this.buffer[this.head];return this.head=(this.head+1)%this.capacity,this.count--,O}peek(){return this.buffer[this.head]}isEmpty(){return this.count===0}clear(){this.buffer.length=0,this.head=0,this.tail=0,this.count=0}},d=new ArrayBuffer(8),A=new Float64Array(d),h=new Uint32Array(d),f=new Uint16Array(d),p=ArrayBuffer;try{p=self.HTMLImageElement||p}catch{}var m=typeof SharedArrayBuffer<"u";function y(O){if(typeof O!="object"||O===null||O instanceof Date||O instanceof ArrayBuffer||m&&O instanceof SharedArrayBuffer||O instanceof Blob||O instanceof FormData||O instanceof Function||O instanceof Uint8ClampedArray||O instanceof p)return O;if(Array.isArray(O))return O.map(y);{let K={};for(let se in O)Object.hasOwnProperty.call(O,se)&&(K[se]=y(O[se]));return K}}function g(O,K){return b(O,K,()=>[])}function b(O,K,se){let ae=O[K];return ae!==void 0||(ae=se(K),O[K]=ae),ae}function E(O,K){if(Array.isArray(O)){for(let se=0,ae=O.length;se<ae;se++)if(K(void 0,O[se],se)===!1)return}else{let se=0;for(let ae in O)if(O.hasOwnProperty(ae)){let ue=O[ae];if(K(ae,ue,se)===!1)return;se++}}}var w=Object.prototype.hasOwnProperty;async function x(O,K){if(Array.isArray(O)){for(let se=0,ae=O.length;se<ae;se++)if(await K(void 0,O[se],se)===!1)return}else{let se=0;for(let ae in O)if(w.call(O,ae)){let ue=O[ae];if(await K(ae,ue,se)===!1)return;se++}}}function I(O,K,se){return typeof O=="string"&&(/https?:/.test(O)||(O=location.origin+O)),Promise.race([fetch(O,K),new Promise((ae,ue)=>setTimeout(ue,se))])}function C(O,K){let se=0,ae=0;return(...ue)=>{let Ie=++se;setTimeout(()=>{let Ce=performance.now();if(Ie===se||Ce-ae>=O){try{K(...ue)}catch(st){console.log(st)}ae=Ce}},Math.max(0,O-(performance.now()-ae)))}}function G(O,K){let se=O.length,ae=0;for(;ae<se;){let ue=O.indexOf(`
`,ae);ue<0&&(ue=se);let Ie=O.substring(ae,ue);try{if(K(Ie)===!1)return}catch(Ce){console.error(Ce)}ae=ue+1}}function U(O){let K=null;return()=>(K===null&&(K=O()),K)}var _=0;function H(){_===0&&(_=Date.now()-performance.now());let O=new Array,K=_+performance.now();A[0]=K,O.push(h[1].toString(16)),A[0]=Math.random(),O.push(f[3].toString(16));let se=f[2].toString(16);O.push("4"+se.substr(0,3)),A[0]=K;let ae=h[0].toString(16)+h[1].toString(16);return O.push("0"+ae.substr(0,3)),O.push(ae.substr(3)),O.join("-")}var Q=class{constructor(O){this.maxResources=O,this.idle=new u,this.isClosed=!1,this.resources=O}acquire(O){this.isClosed?Promise.resolve(!1).then(O):this.resources>0?(this.resources--,Promise.resolve(!0).then(O)):this.idle.enqueue(O)}acquireSync(){return new Promise(O=>{this.acquire(O)})}release(){if(!this.isClosed){let O=this.idle.dequeue();O?Promise.resolve(!0).then(O):this.resources++}}close(){if(!this.isClosed)for(this.isClosed=!0;!this.idle.isEmpty();){let O=this.idle.dequeue();Promise.resolve(!1).then(O)}}};function j(){if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global}function $(O,K,se){let ae=O.length+K-1;for(let ue=0;ue<ae;ue++){let Ie=new Array;for(let Ce=ue-K+1;Ce<=ue;Ce++)Ie.push(O[Ce]);if(se(Ie)===!1)break}}function B(){let O=new Date,K=O.getFullYear(),se=O.getMonth()+1,ae=O.getDate(),ue=O.getHours(),Ie=O.getMinutes(),Ce=O.getSeconds(),st=O.getMilliseconds();return"["+K+"-"+(se<10?"0"+se:se)+"-"+(ae<10?"0"+ae:ae)+" "+(ue<10?"0"+ue:ue)+":"+(Ie<10?"0"+Ie:Ie)+":"+(Ce<10?"0"+Ce:Ce)+"."+(st<100?st<10?"00"+st:"0"+st:st)+"] "}function M(O){return new Promise(K=>setTimeout(K,O))}function v(O,K){let se=0,ae=O.length;for(let ue=0;ue<ae;ue++)O[ue]===K&&(O.splice(ue,1),ue--,ae--,se++);return se}var N=j(),R=N.WeakRef||(O=>O);function q(O){if(O!=null){if(typeof O=="object")return new R(O);console.error(O,O instanceof Object,typeof O);return}}function P(O){return O==null?void 0:O.deref()}var z="_MSG_BUS_RPC_",W=300*1e3,oe=(O=>(O.PUBLISH="publish",O.SUBSCRIBE="subscribe",O.PUSH="push",O.PULL="pull",O))(oe||{}),Ae=class{constructor(O){this.bus=O}processRemoteMessage(O,K){let se=q(K),ae=O.topic,ue=O.type,Ie=O.message;switch(ue){case"pull":this.bus.pull(ae,Ce=>{this.push(ae,Ce,P(se))});break;case"subscribe":this.bus.subscribe(ae,Ce=>{this.publish(ae,Ce,P(se))});break;case"publish":this.bus.publish(ae,Ie,this,P(se));break;case"push":this.bus.push(ae,Ie,this,P(se));break;default:console.debug("unknown message type "+ue)}}rpcCall(O,K,se,ae=W){let ue=q(se),Ie=new Promise(Ce=>{let st=this.bus.uniqueRpcTopic(O);this.publish(O,{message:K,reply:st},P(ue)),this.bus.pull(st,(it,Kt,ar)=>{Ce({message:it,bridge:Kt,source:q(ar)})})});return ae>0?Promise.race([Ie,new Promise((Ce,st)=>{setTimeout(st,ae)})]):Ie}},me=class extends Ae{constructor(O,K){super(O),this.worker=K,K.onmessage=se=>{this.processRemoteMessage(se.data,void 0)}}publish(O,K){this.postMessage(O,"publish",K)}subscribe(O){this.postMessage(O,"subscribe",null)}push(O,K){this.postMessage(O,"push",K)}pull(O){this.postMessage(O,"pull",null)}rpcCall(O,K,se=W){return super.rpcCall(O,K,void 0,se)}postMessage(O,K,se){let ae={topic:O,type:K,message:se};this.worker.postMessage(ae)}discard(){this.worker.terminate()}},ve=class extends Ae{constructor(O){super(O),window.addEventListener("message",K=>{this.processRemoteMessage(K.data,K.source)},!1)}publish(O,K,se){this.postMessage(O,"publish",K,se)}subscribe(O,K){if(K===window)throw new Error("regist remote subscribe from current window is not permitted");this.postMessage(O,"subscribe",null,K)}push(O,K,se){this.postMessage(O,"push",K,se)}pull(O,K){if(K===window)throw new Error("regist remote pull from current window is not permitted");this.postMessage(O,"pull",null,K)}postMessage(O,K,se,ae){let ue={topic:O,type:K,message:se};ae&&ae.postMessage(ue,"*")}},Le=class{constructor(O){this.isRunning=!0,this.callback=O}cancel(){this.callback=null,this.isRunning=!1}running(){return this.isRunning}execute(O,K,se,ae){try{O=ae?O:y(O),this.callback(O,K,se)}catch(ue){console.error(ue)}}},He=class{constructor(O=!1){this.subscribed={},this.pulled={},this.pushed={},this.uuid=crypto.randomUUID().replace(/-/g,""),this.rpcTicket=0,this.unsafe=O}uniqueRpcTopic(O){return`${z}-${O}-${this.uuid}-${this.rpcTicket++}`}publish(O,K,se,ae){let ue=this.subscribed[O];if(ue){let Ie;for(let Ce of ue)Ce.running()?Ce.execute(K,se,ae,this.unsafe):(Ie=Ie||new Array,Ie.push(Ce));if(Ie)for(let Ce of Ie)v(ue,Ce)}else console.debug("no sub on topic: "+O)}subscribe(O,K){let se=new Le(K);return g(this.subscribed,O).push(se),se}push(O,K,se,ae){let ue=!1,Ie=this.pulled[O];if(Ie){for(;Ie.length>0;){let Ce=Ie.shift();if(Ce.running()){Ce.execute(K,se,ae,this.unsafe),ue=!0;break}}Ie.length===0&&delete this.pulled[O]}ue||g(this.pushed,O).push({message:K,bridge:se,source:q(ae)})}pull(O,K){let se=new Le(K),ae=this.pushed[O];if(ae){let ue=ae.shift();se.execute(ue.message,ue.bridge,P(ue.source),this.unsafe),ae.length===0&&delete this.pushed[O]}else g(this.pulled,O).push(se);return se}pullA(O){return new Promise(K=>{this.pull(O,(se,ae,ue)=>{K({message:se,bridge:ae,source:q(ue)})})})}rpcService(O,K){this.subscribe(O,(se,ae,ue)=>{let{message:Ie,reply:Ce}=se;try{let st=K(Ie);if(st instanceof Promise){let it=q(ue);st.then(Kt=>{this.rpcReply(Kt,Ce,ae,P(it))},Kt=>{console.error(Kt),this.rpcReply(void 0,Ce,ae,P(it))})}else this.rpcReply(st,Ce,ae,ue)}catch(st){console.error(st),this.rpcReply(void 0,Ce,ae,ue)}})}rpcCall(O,K,se=W){let ae=new Promise(ue=>{let Ie=this.uniqueRpcTopic(O);this.publish(O,{message:K,reply:Ie}),this.pull(Ie,(Ce,st,it)=>{ue({message:Ce,bridge:st,source:q(it)})})});return se>0?Promise.race([ae,new Promise((ue,Ie)=>{setTimeout(Ie,se)})]):ae}rpcReply(O,K,se,ae){se?se.push(K,O,ae):this.push(K,O)}},rt="_MSG_BUS_RPC_";function qe(O,K){let se=0,ae=O.length;for(let ue=0;ue<ae;ue++)O[ue]===K&&(O.splice(ue,1),ue--,ae--,se++);return se}function xt(O,K){return Gt(O,K,()=>[])}function Gt(O,K,se){let ae=O[K];return ae!==void 0||(ae=se(K),O[K]=ae),ae}var ut=class{constructor(O,K){this.callback=O,this.unsafe=K,this.isRunning=!0}cancel(){this.callback=null,this.isRunning=!1}running(){return this.isRunning}async execute(O){try{O=this.unsafe?O:y(O),this.callback(O)}catch(K){console.error(K)}}},Pe=class{constructor(O=crypto.randomUUID()){this.uuid=O,this.rpcTicket=0}subscribeOnce(O,K){let se=this.subscribe(O,ae=>{se.cancel(),K(ae)});return se}pullA(O){return new Promise(K=>{this.pull(O,K)})}rpcService(O,K){let se=ae=>{try{let{message:ue,replyTopic:Ie}=ae;try{let Ce=K(ue);Ce instanceof Promise?Ce.then(st=>{this.publish(Ie,{success:!0,result:st})}).catch(st=>{console.error(st),this.publish(Ie,{success:!1,err:String(st)})}):this.publish(Ie,{success:!0,result:Ce})}catch(Ce){this.publish(Ie,{success:!1,err:String(Ce)})}}finally{this.pull(O,se)}};this.pull(O,se)}rpcCall(O,K,se=0){let ae=new Promise((ue,Ie)=>{let Ce=`${rt}-${O}-${this.uuid}-${this.rpcTicket++}`;this.subscribeOnce(Ce,st=>{st.success?ue(st.result):Ie(new Error(st.err))}),this.push(O,{message:K,replyTopic:Ce})});return se>0?Promise.race([ae,new Promise((ue,Ie)=>{setTimeout(Ie,se)})]):ae}},ft=class extends Pe{constructor(O=!1){super(),this.unsafe=O,this.subscribed={},this.pulled={},this.pushed={}}publish(O,K){let se=this.subscribed[O];if(se){let ae;for(let ue of se)ue.running()?ue.execute(K):(ae=ae||new Array,ae.push(ue));if(ae)for(let ue of ae)qe(se,ue)}}subscribe(O,K){let se=new ut(K,this.unsafe);return xt(this.subscribed,O).push(se),se}push(O,K){let se=!1,ae=this.pulled[O];if(ae){for(;ae.length>0;){let ue=ae.shift();if(ue&&ue.running()){ue.execute(K),se=!0;break}}ae.length===0&&delete this.pulled[O]}se||xt(this.pushed,O).push(K)}pull(O,K){let se=new ut(K,this.unsafe);return this.repull(O,se),se}repull(O,K){let se=this.pushed[O];if(se){let ae=se.shift();ae&&(K.execute(ae),se.length===0&&delete this.pushed[O])}else xt(this.pulled,O).push(K)}},ht=class extends Pe{constructor(O=crypto.randomUUID()){super(O),this.subscribed={},this.pushed={},this.pulled={},this.pushCnt=0}publish(O,K){console.debug("BC",this.uuid,"PUBLISH",O,K),this.broadcastPublish(O,K)}subscribe(O,K){console.debug("BC",this.uuid,"SUBSCRIBE",O);let se=new ut(K,!0);return xt(this.subscribed,O).push(se),se}push(O,K){let se=this.pushCnt++;console.debug("BC",this.uuid,"PUSH",O,`(${se})`,K),xt(this.pushed,O).push({id:se,message:K}),this.broadcastPushedHeadMessage(O)}pull(O,K){console.debug("BC",this.uuid,"PULL",O);let se=new ut(K,!0);return xt(this.pulled,O).push(se),this.broadcastWhoHas(O),se}broadcastPushedHeadMessage(O){let K=this.pushed[O];K&&K[0]&&this.broadcastIHave(O,K[0].id)}onReceivedPublish(O,K,se){console.debug("BCMSG(",this.uuid,")","from",O,"PUBLISH",K,"message",se);let ae=this.subscribed[K];if(ae){let ue;for(let Ie of ae)Ie.running()?Ie.execute(se):(ue=ue||new Array,ue.push(Ie));if(ue)for(let Ie of ue)qe(ae,Ie);ae.length===0&&delete this.subscribed[K]}}onReceivedWhoHas(O,K){console.debug("BCMSG(",this.uuid,")","from",O,"WHOHAS",K),this.broadcastPushedHeadMessage(K)}onReceivedIHave(O,K,se){console.debug("BCMSG(",this.uuid,")","from",O,"IHAVE",K,"id",se);let ae=this.pulled[K];if(ae){let ue;for(let Ie of ae)if(Ie.running()){this.broadcastINeed(K,O,se);break}else ue=ue||new Array,ue.push(Ie);if(ue)for(let Ie of ue)qe(ae,Ie);ae.length===0&&delete this.pulled[K]}}onReceivedINeed(O,K,se,ae){if(console.debug("BCMSG(",this.uuid,")","from",O,"INEED",K,"source",se,"id",ae),this.uuid===se){let ue=this.pushed[K];if(ue&&ue[0]&&ue[0].id===ae){let{message:Ie}=ue.shift();this.broadcastIGive(K,ae,O,Ie),this.broadcastPushedHeadMessage(K),ue.length===0&&delete this.pushed[K]}}}onReceivedIGive(O,K,se,ae,ue){console.debug("BCMSG(",this.uuid,")","from",O,"IGIVE",K,"id",se,"target",ae,"message",ue);let Ie=this.pulled[K];if(Ie&&this.uuid===ae){let Ce=!1;for(;Ie.length>0;){let st=Ie.shift();if(st.running()){st.execute(ue),Ce=!0;break}}Ce||this.push(K,ue),Ie.length===0&&delete this.pulled[K]}}},Qt=class extends ht{constructor(O,K=crypto.randomUUID()){super(K),this.bc=new BroadcastChannel(O),this.bc.onmessage=se=>{this.onMessage(se.data)}}onMessage(O){let{type:K,uuid:se,topic:ae}=O;switch(K){case"PUBLISH":{let{message:ue}=O;this.onReceivedPublish(se,ae,ue);break}case"WHOHAS":{this.onReceivedWhoHas(se,ae);break}case"IHAVE":{let{id:ue}=O;this.onReceivedIHave(se,ae,ue);break}case"INEED":{let{source:ue,id:Ie}=O;this.onReceivedINeed(se,ae,ue,Ie);break}case"IGIVE":{let{target:ue,id:Ie,message:Ce}=O;this.onReceivedIGive(se,ae,Ie,ue,Ce);break}default:console.warn("unsupported",O)}}broadcastPublish(O,K){this.post({type:"PUBLISH",uuid:this.uuid,topic:O,message:K})}broadcastWhoHas(O){this.post({type:"WHOHAS",uuid:this.uuid,topic:O})}broadcastIHave(O,K){this.post({type:"IHAVE",uuid:this.uuid,topic:O,id:K})}broadcastINeed(O,K,se){this.post({type:"INEED",uuid:this.uuid,topic:O,source:K,id:se})}broadcastIGive(O,K,se,ae){this.post({type:"IGIVE",uuid:this.uuid,topic:O,id:K,target:se,message:ae})}post(O){this.bc.postMessage(O),Promise.resolve().then(()=>{this.onMessage(O)})}},Yt=Symbol("BLOCKING_QUEUE_RESET"),Ft=class{constructor(O,K=()=>1){if(this.maxSize=O,this.itemSizeOf=K,this.queue=new u,this.waitingConsumers=new u,this.waitingProducers=new u,this.queueSize=0,this.closePromise=null,this.closeResolve=null,O<=0)throw new Error("Max size must be greater than 0")}enqueue(O){return this.closePromise?!1:this.isFull()?(async()=>{console.debug("queue is full",this.queueSize,this.maxSize);let K=await new Promise(se=>{this.waitingProducers.enqueue(se)});return console.debug("queue is not full",this.size(),K),K?(this.innerEnqueue(O),!0):!1})():(this.innerEnqueue(O),!0)}innerEnqueue(O){if(this.waitingConsumers.isEmpty())this.queue.enqueue(O),this.queueSize+=this.itemSizeOf(O),console.debug("queue pushed",O,"size",this.queueSize);else{let K=this.waitingConsumers.dequeue();Promise.resolve(O).then(K),console.debug("queue direct",O,"size",this.queueSize)}}dequeue(){if(this.queue.isEmpty())if(this.closePromise){for(;!this.waitingConsumers.isEmpty();){let O=this.waitingConsumers.dequeue();Promise.resolve(Yt).then(O)}return setTimeout(()=>this.closeResolve(),0),Yt}else return new Promise(O=>{this.waitingConsumers.enqueue(O)});else{let O=this.queue.dequeue();if(this.queueSize-=this.itemSizeOf(O),!this.waitingProducers.isEmpty()){let K=this.waitingProducers.dequeue();Promise.resolve(!0).then(K)}return O}}size(){return this.queueSize}isEmpty(){return this.queueSize===0}isFull(){return this.queueSize>=this.maxSize}close(){return this.closePromise||(this.closePromise=new Promise(O=>{for(this.closeResolve=O;!this.waitingProducers.isEmpty();){let K=this.waitingProducers.dequeue();Promise.resolve(!1).then(K)}if(this.queueSize===0){for(;!this.waitingConsumers.isEmpty();){let K=this.waitingConsumers.dequeue();Promise.resolve(Yt).then(K)}O()}})),this.closePromise}};function kt(O,K,se=Number.MAX_SAFE_INTEGER){let ae=new Ft(se,K),ue=new ReadableStream({pull(Ce){let st=!0,it=(async()=>{let Kt=new Array;do{let ar=ae.dequeue();if(ar instanceof Promise){st=!1;let lr=await ar;lr===Yt?Ce.close():Kt.push(lr)}else{let lr=ar;lr===Yt?Ce.close():Kt.push(lr)}}while(ae.size()>0);if(Kt.length>0){let ar=O(Kt);Ce.enqueue(ar)}})();if(!st)return console.debug("read stream stucked --------------------------------------"),it},async cancel(){console.debug("buffered readable cancel"),await ae.close()}}),Ie=new WritableStream({write(Ce,st){let it=!0,Kt=(async()=>{let ar=ae.enqueue(Ce);typeof ar=="boolean"?ar||st.error(new Error("Write stream closed")):(it=!1,await ar||st.error(new Error("Write stream closed")))})();if(!it)return console.debug("read stream stucked >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"),Kt},async close(){console.debug("buffered writable closing",ae.size()),await ae.close(),console.debug("buffered writable closed",ae.size())},async abort(){console.debug("buffered writable aborting",ae.size()),await ae.close(),console.debug("buffered writable aborted",ae.size())}});return{readable:ue,writable:Ie}}function sr(O=Number.MAX_SAFE_INTEGER){return kt(K=>K.join(""),K=>K.length,O)}function Pt(O=Number.MAX_SAFE_INTEGER){return kt(K=>{let se=new Uint8Array(K.reduce((ue,Ie)=>ue+Ie.byteLength,0)),ae=0;return K.forEach(ue=>{se.set(ue,ae),ae+=ue.byteLength}),se},K=>K.byteLength,O)}function _r(O){return new Promise((K,se)=>{let ae=new BroadcastChannel(O),ue=new Ft(1),Ie=new Q(1),Ce=null,st=!1,it=!1,Kt=!1;ae.onmessage=ar=>{let lr=ar.data,{type:yr}=lr;if(console.debug("p2p",O,"type",yr,"data",yr==="DATA"&&lr.data),yr==="DATA")ue.enqueue(lr.data);else if(yr==="HI"){if(!Ce){ae.postMessage({type:"HI"});let nn=0;Ce={rs:new ReadableStream({async pull(sn){let Dn=await ue.dequeue();Dn===Yt?(await Tr(),sn.close()):(sn.enqueue(Dn),ae.postMessage({type:"ACK"}))},cancel(){return Tr()}}),ws:new WritableStream({async write(sn,Dn){await Ie.acquireSync()?ae.postMessage({type:"DATA",id:nn++,data:sn}):(xi(),Dn.error(new Error("Write stream closed")))},close(){xi()},abort(){xi()}})},K(Ce)}}else yr==="REND"?Ce?Ie.close():ii("REND1"):yr==="WEND"?Ce?ue.close():ii("WEND1"):yr==="ACK"&&Ie.release();function xi(){st||(st=!0,console.debug(O,"p2p write stream closed"),Ie.close(),ae.postMessage({type:"WEND"}),it&&(console.debug(O,"p2p channel closed on ws"),ae.close()))}async function Tr(){it||(it=!0,console.debug(O,"p2p read stream closed"),ae.postMessage({type:"REND"}),await ue.close(),st&&(console.debug(O,"p2p channel closed on rs"),ae.close()))}async function ii(nn){Kt||(Kt=!0,console.debug(O,"p2p channel connection released on",nn),Ie.close(),ue.close(),Ce?(Ce.rs.locked||(console.debug(O,"p2p unlocked read stream direct cancel"),Ce.rs.cancel()),Ce.ws.locked||(console.debug(O,"p2p unlocked write stream direct close"),Ce.ws.close())):(ae.postMessage({type:"HI"}),ae.close()),se(new Error("p2p channel connection released")))}},ae.postMessage({type:"HI"})})}function Lt(O){return new Promise(K=>{let se=new BroadcastChannel(O);se.onmessage=ae=>{let ue=ae.data,{type:Ie}=ue;Ie==="HI"&&(se.postMessage({type:"REND"}),se.close(),K())},se.postMessage({type:"REND"})})}async function ct(O){try{return await _r(O)}catch(K){K.message!=="p2p channel connection released"&&console.error(K)}}async function Zt(O,K,se=10*1024*1024,ae=!0){let ue=await ct(O);if(!ue)return!1;let Ie=!1;try{let Ce,st=it=>{if(!Ce)if(!ae)Ce=ue.ws.getWriter();else if(typeof it=="string"){let Kt=sr(se);Kt.readable.pipeTo(ue.ws),Ce=Kt.writable.getWriter()}else{let Kt=Pt(se);Kt.readable.pipeTo(ue.ws),Ce=Kt.writable.getWriter()}return Ce.write(it)};if(Array.isArray(K))for(let it of K)await st(it);else await K({write:st,get desiredSize(){return((Ce==null?void 0:Ce.desiredSize)||0)+10}});Ce&&await Ce.close(),Ie=!0}catch(Ce){console.error(Ce)}finally{return ue.rs.cancel(),Ie}}async function Jt(O,K){var ae,ue;let se=await ct(O);if(se)try{let Ie=se.rs.getReader();for((ae=K.start)==null?void 0:ae.call(K);;){let{value:Ce,done:st}=await Ie.read();if(Ce!==void 0){let it;if(K.update instanceof Promise?it=await K.update(Ce):it=K.update(Ce),it){await Ie.cancel();break}}if(st){(ue=K.end)==null||ue.call(K);break}}}catch(Ie){console.error(Ie)}finally{se.ws.close()}}}),Uxe=Kn(()=>{}),fs=Kn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i():typeof define=="function"&&define.amd?define([],i):r.CryptoJS=i()})(t,function(){var r=r||(function(i,n){var s;if(typeof window<"u"&&window.crypto&&(s=window.crypto),typeof self<"u"&&self.crypto&&(s=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(s=globalThis.crypto),!s&&typeof window<"u"&&window.msCrypto&&(s=window.msCrypto),!s&&typeof global<"u"&&global.crypto&&(s=global.crypto),!s&&typeof kxe=="function")try{s=Uxe()}catch{}var a=function(){if(s){if(typeof s.getRandomValues=="function")try{return s.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof s.randomBytes=="function")try{return s.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||(function(){function b(){}return function(E){var w;return b.prototype=E,w=new b,b.prototype=null,w}})(),l={},c=l.lib={},u=c.Base=(function(){return{extend:function(b){var E=o(this);return b&&E.mixIn(b),(!E.hasOwnProperty("init")||this.init===E.init)&&(E.init=function(){E.$super.init.apply(this,arguments)}),E.init.prototype=E,E.$super=this,E},create:function(){var b=this.extend();return b.init.apply(b,arguments),b},init:function(){},mixIn:function(b){for(var E in b)b.hasOwnProperty(E)&&(this[E]=b[E]);b.hasOwnProperty("toString")&&(this.toString=b.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),d=c.WordArray=u.extend({init:function(b,E){b=this.words=b||[],E!=n?this.sigBytes=E:this.sigBytes=b.length*4},toString:function(b){return(b||h).stringify(this)},concat:function(b){var E=this.words,w=b.words,x=this.sigBytes,I=b.sigBytes;if(this.clamp(),x%4)for(var C=0;C<I;C++){var G=w[C>>>2]>>>24-C%4*8&255;E[x+C>>>2]|=G<<24-(x+C)%4*8}else for(var U=0;U<I;U+=4)E[x+U>>>2]=w[U>>>2];return this.sigBytes+=I,this},clamp:function(){var b=this.words,E=this.sigBytes;b[E>>>2]&=4294967295<<32-E%4*8,b.length=i.ceil(E/4)},clone:function(){var b=u.clone.call(this);return b.words=this.words.slice(0),b},random:function(b){for(var E=[],w=0;w<b;w+=4)E.push(a());return new d.init(E,b)}}),A=l.enc={},h=A.Hex={stringify:function(b){for(var E=b.words,w=b.sigBytes,x=[],I=0;I<w;I++){var C=E[I>>>2]>>>24-I%4*8&255;x.push((C>>>4).toString(16)),x.push((C&15).toString(16))}return x.join("")},parse:function(b){for(var E=b.length,w=[],x=0;x<E;x+=2)w[x>>>3]|=parseInt(b.substr(x,2),16)<<24-x%8*4;return new d.init(w,E/2)}},f=A.Latin1={stringify:function(b){for(var E=b.words,w=b.sigBytes,x=[],I=0;I<w;I++){var C=E[I>>>2]>>>24-I%4*8&255;x.push(String.fromCharCode(C))}return x.join("")},parse:function(b){for(var E=b.length,w=[],x=0;x<E;x++)w[x>>>2]|=(b.charCodeAt(x)&255)<<24-x%4*8;return new d.init(w,E)}},p=A.Utf8={stringify:function(b){try{return decodeURIComponent(escape(f.stringify(b)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(b){return f.parse(unescape(encodeURIComponent(b)))}},m=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(b){typeof b=="string"&&(b=p.parse(b)),this._data.concat(b),this._nDataBytes+=b.sigBytes},_process:function(b){var E,w=this._data,x=w.words,I=w.sigBytes,C=this.blockSize,G=C*4,U=I/G;b?U=i.ceil(U):U=i.max((U|0)-this._minBufferSize,0);var _=U*C,H=i.min(_*4,I);if(_){for(var Q=0;Q<_;Q+=C)this._doProcessBlock(x,Q);E=x.splice(0,_),w.sigBytes-=H}return new d.init(E,H)},clone:function(){var b=u.clone.call(this);return b._data=this._data.clone(),b},_minBufferSize:0}),y=c.Hasher=m.extend({cfg:u.extend(),init:function(b){this.cfg=this.cfg.extend(b),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(b){return this._append(b),this._process(),this},finalize:function(b){b&&this._append(b);var E=this._doFinalize();return E},blockSize:512/32,_createHelper:function(b){return function(E,w){return new b.init(w).finalize(E)}},_createHmacHelper:function(b){return function(E,w){return new g.HMAC.init(b,w).finalize(E)}}}),g=l.algo={};return l})(Math);return r})}),lP=Kn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(fs()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(i){var n=r,s=n.lib,a=s.Base,o=s.WordArray,l=n.x64={},c=l.Word=a.extend({init:function(d,A){this.high=d,this.low=A}}),u=l.WordArray=a.extend({init:function(d,A){d=this.words=d||[],A!=i?this.sigBytes=A:this.sigBytes=d.length*8},toX32:function(){for(var d=this.words,A=d.length,h=[],f=0;f<A;f++){var p=d[f];h.push(p.high),h.push(p.low)}return o.create(h,this.sigBytes)},clone:function(){for(var d=a.clone.call(this),A=d.words=this.words.slice(0),h=A.length,f=0;f<h;f++)A[f]=A[f].clone();return d}})})(),r})}),Hxe=Kn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(fs()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(){if(typeof ArrayBuffer=="function"){var i=r,n=i.lib,s=n.WordArray,a=s.init,o=s.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var c=l.byteLength,u=[],d=0;d<c;d++)u[d>>>2]|=l[d]<<24-d%4*8;a.call(this,u,c)}else a.apply(this,arguments)};o.prototype=s}})(),r.lib.WordArray})}),Gxe=Kn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(fs()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.WordArray,a=i.enc,o=a.Utf16=a.Utf16BE={stringify:function(c){for(var u=c.words,d=c.sigBytes,A=[],h=0;h<d;h+=2){var f=u[h>>>2]>>>16-h%4*8&65535;A.push(String.fromCharCode(f))}return A.join("")},parse:function(c){for(var u=c.length,d=[],A=0;A<u;A++)d[A>>>1]|=c.charCodeAt(A)<<16-A%2*16;return s.create(d,u*2)}};a.Utf16LE={stringify:function(c){for(var u=c.words,d=c.sigBytes,A=[],h=0;h<d;h+=2){var f=l(u[h>>>2]>>>16-h%4*8&65535);A.push(String.fromCharCode(f))}return A.join("")},parse:function(c){for(var u=c.length,d=[],A=0;A<u;A++)d[A>>>1]|=l(c.charCodeAt(A)<<16-A%2*16);return s.create(d,u*2)}};function l(c){return c<<8&4278255360|c>>>8&16711935}})(),r.enc.Utf16})}),$1=Kn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(fs()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.WordArray,a=i.enc,o=a.Base64={stringify:function(c){var u=c.words,d=c.sigBytes,A=this._map;c.clamp();for(var h=[],f=0;f<d;f+=3)for(var p=u[f>>>2]>>>24-f%4*8&255,m=u[f+1>>>2]>>>24-(f+1)%4*8&255,y=u[f+2>>>2]>>>24-(f+2)%4*8&255,g=p<<16|m<<8|y,b=0;b<4&&f+b*.75<d;b++)h.push(A.charAt(g>>>6*(3-b)&63));var E=A.charAt(64);if(E)for(;h.length%4;)h.push(E);return h.join("")},parse:function(c){var u=c.length,d=this._map,A=this._reverseMap;if(!A){A=this._reverseMap=[];for(var h=0;h<d.length;h++)A[d.charCodeAt(h)]=h}var f=d.charAt(64);if(f){var p=c.indexOf(f);p!==-1&&(u=p)}return l(c,u,A)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function l(c,u,d){for(var A=[],h=0,f=0;f<u;f++)if(f%4){var p=d[c.charCodeAt(f-1)]<<f%4*2,m=d[c.charCodeAt(f)]>>>6-f%4*2,y=p|m;A[h>>>2]|=y<<24-h%4*8,h++}return s.create(A,h)}})(),r.enc.Base64})}),Yxe=Kn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(fs()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.WordArray,a=i.enc,o=a.Base64url={stringify:function(c,u){u===void 0&&(u=!0);var d=c.words,A=c.sigBytes,h=u?this._safe_map:this._map;c.clamp();for(var f=[],p=0;p<A;p+=3)for(var m=d[p>>>2]>>>24-p%4*8&255,y=d[p+1>>>2]>>>24-(p+1)%4*8&255,g=d[p+2>>>2]>>>24-(p+2)%4*8&255,b=m<<16|y<<8|g,E=0;E<4&&p+E*.75<A;E++)f.push(h.charAt(b>>>6*(3-E)&63));var w=h.charAt(64);if(w)for(;f.length%4;)f.push(w);return f.join("")},parse:function(c,u){u===void 0&&(u=!0);var d=c.length,A=u?this._safe_map:this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var f=0;f<A.length;f++)h[A.charCodeAt(f)]=f}var p=A.charAt(64);if(p){var m=c.indexOf(p);m!==-1&&(d=m)}return l(c,d,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function l(c,u,d){for(var A=[],h=0,f=0;f<u;f++)if(f%4){var p=d[c.charCodeAt(f-1)]<<f%4*2,m=d[c.charCodeAt(f)]>>>6-f%4*2,y=p|m;A[h>>>2]|=y<<24-h%4*8,h++}return s.create(A,h)}})(),r.enc.Base64url})}),Z1=Kn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(fs()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(i){var n=r,s=n.lib,a=s.WordArray,o=s.Hasher,l=n.algo,c=[];(function(){for(var p=0;p<64;p++)c[p]=i.abs(i.sin(p+1))*4294967296|0})();var u=l.MD5=o.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(p,m){for(var y=0;y<16;y++){var g=m+y,b=p[g];p[g]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360}var E=this._hash.words,w=p[m+0],x=p[m+1],I=p[m+2],C=p[m+3],G=p[m+4],U=p[m+5],_=p[m+6],H=p[m+7],Q=p[m+8],j=p[m+9],$=p[m+10],B=p[m+11],M=p[m+12],v=p[m+13],N=p[m+14],R=p[m+15],q=E[0],P=E[1],z=E[2],W=E[3];q=d(q,P,z,W,w,7,c[0]),W=d(W,q,P,z,x,12,c[1]),z=d(z,W,q,P,I,17,c[2]),P=d(P,z,W,q,C,22,c[3]),q=d(q,P,z,W,G,7,c[4]),W=d(W,q,P,z,U,12,c[5]),z=d(z,W,q,P,_,17,c[6]),P=d(P,z,W,q,H,22,c[7]),q=d(q,P,z,W,Q,7,c[8]),W=d(W,q,P,z,j,12,c[9]),z=d(z,W,q,P,$,17,c[10]),P=d(P,z,W,q,B,22,c[11]),q=d(q,P,z,W,M,7,c[12]),W=d(W,q,P,z,v,12,c[13]),z=d(z,W,q,P,N,17,c[14]),P=d(P,z,W,q,R,22,c[15]),q=A(q,P,z,W,x,5,c[16]),W=A(W,q,P,z,_,9,c[17]),z=A(z,W,q,P,B,14,c[18]),P=A(P,z,W,q,w,20,c[19]),q=A(q,P,z,W,U,5,c[20]),W=A(W,q,P,z,$,9,c[21]),z=A(z,W,q,P,R,14,c[22]),P=A(P,z,W,q,G,20,c[23]),q=A(q,P,z,W,j,5,c[24]),W=A(W,q,P,z,N,9,c[25]),z=A(z,W,q,P,C,14,c[26]),P=A(P,z,W,q,Q,20,c[27]),q=A(q,P,z,W,v,5,c[28]),W=A(W,q,P,z,I,9,c[29]),z=A(z,W,q,P,H,14,c[30]),P=A(P,z,W,q,M,20,c[31]),q=h(q,P,z,W,U,4,c[32]),W=h(W,q,P,z,Q,11,c[33]),z=h(z,W,q,P,B,16,c[34]),P=h(P,z,W,q,N,23,c[35]),q=h(q,P,z,W,x,4,c[36]),W=h(W,q,P,z,G,11,c[37]),z=h(z,W,q,P,H,16,c[38]),P=h(P,z,W,q,$,23,c[39]),q=h(q,P,z,W,v,4,c[40]),W=h(W,q,P,z,w,11,c[41]),z=h(z,W,q,P,C,16,c[42]),P=h(P,z,W,q,_,23,c[43]),q=h(q,P,z,W,j,4,c[44]),W=h(W,q,P,z,M,11,c[45]),z=h(z,W,q,P,R,16,c[46]),P=h(P,z,W,q,I,23,c[47]),q=f(q,P,z,W,w,6,c[48]),W=f(W,q,P,z,H,10,c[49]),z=f(z,W,q,P,N,15,c[50]),P=f(P,z,W,q,U,21,c[51]),q=f(q,P,z,W,M,6,c[52]),W=f(W,q,P,z,C,10,c[53]),z=f(z,W,q,P,$,15,c[54]),P=f(P,z,W,q,x,21,c[55]),q=f(q,P,z,W,Q,6,c[56]),W=f(W,q,P,z,R,10,c[57]),z=f(z,W,q,P,_,15,c[58]),P=f(P,z,W,q,v,21,c[59]),q=f(q,P,z,W,G,6,c[60]),W=f(W,q,P,z,B,10,c[61]),z=f(z,W,q,P,I,15,c[62]),P=f(P,z,W,q,j,21,c[63]),E[0]=E[0]+q|0,E[1]=E[1]+P|0,E[2]=E[2]+z|0,E[3]=E[3]+W|0},_doFinalize:function(){var p=this._data,m=p.words,y=this._nDataBytes*8,g=p.sigBytes*8;m[g>>>5]|=128<<24-g%32;var b=i.floor(y/4294967296),E=y;m[(g+64>>>9<<4)+15]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,m[(g+64>>>9<<4)+14]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,p.sigBytes=(m.length+1)*4,this._process();for(var w=this._hash,x=w.words,I=0;I<4;I++){var C=x[I];x[I]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360}return w},clone:function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p}});function d(p,m,y,g,b,E,w){var x=p+(m&y|~m&g)+b+w;return(x<<E|x>>>32-E)+m}function A(p,m,y,g,b,E,w){var x=p+(m&g|y&~g)+b+w;return(x<<E|x>>>32-E)+m}function h(p,m,y,g,b,E,w){var x=p+(m^y^g)+b+w;return(x<<E|x>>>32-E)+m}function f(p,m,y,g,b,E,w){var x=p+(y^(m|~g))+b+w;return(x<<E|x>>>32-E)+m}n.MD5=o._createHelper(u),n.HmacMD5=o._createHmacHelper(u)})(Math),r.MD5})}),mX=Kn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(fs()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.WordArray,a=n.Hasher,o=i.algo,l=[],c=o.SHA1=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,d){for(var A=this._hash.words,h=A[0],f=A[1],p=A[2],m=A[3],y=A[4],g=0;g<80;g++){if(g<16)l[g]=u[d+g]|0;else{var b=l[g-3]^l[g-8]^l[g-14]^l[g-16];l[g]=b<<1|b>>>31}var E=(h<<5|h>>>27)+y+l[g];g<20?E+=(f&p|~f&m)+1518500249:g<40?E+=(f^p^m)+1859775393:g<60?E+=(f&p|f&m|p&m)-1894007588:E+=(f^p^m)-899497514,y=m,m=p,p=f<<30|f>>>2,f=h,h=E}A[0]=A[0]+h|0,A[1]=A[1]+f|0,A[2]=A[2]+p|0,A[3]=A[3]+m|0,A[4]=A[4]+y|0},_doFinalize:function(){var u=this._data,d=u.words,A=this._nDataBytes*8,h=u.sigBytes*8;return d[h>>>5]|=128<<24-h%32,d[(h+64>>>9<<4)+14]=Math.floor(A/4294967296),d[(h+64>>>9<<4)+15]=A,u.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var u=a.clone.call(this);return u._hash=this._hash.clone(),u}});i.SHA1=a._createHelper(c),i.HmacSHA1=a._createHmacHelper(c)})(),r.SHA1})}),f6=Kn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(fs()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(i){var n=r,s=n.lib,a=s.WordArray,o=s.Hasher,l=n.algo,c=[],u=[];(function(){function h(y){for(var g=i.sqrt(y),b=2;b<=g;b++)if(!(y%b))return!1;return!0}function f(y){return(y-(y|0))*4294967296|0}for(var p=2,m=0;m<64;)h(p)&&(m<8&&(c[m]=f(i.pow(p,1/2))),u[m]=f(i.pow(p,1/3)),m++),p++})();var d=[],A=l.SHA256=o.extend({_doReset:function(){this._hash=new a.init(c.slice(0))},_doProcessBlock:function(h,f){for(var p=this._hash.words,m=p[0],y=p[1],g=p[2],b=p[3],E=p[4],w=p[5],x=p[6],I=p[7],C=0;C<64;C++){if(C<16)d[C]=h[f+C]|0;else{var G=d[C-15],U=(G<<25|G>>>7)^(G<<14|G>>>18)^G>>>3,_=d[C-2],H=(_<<15|_>>>17)^(_<<13|_>>>19)^_>>>10;d[C]=U+d[C-7]+H+d[C-16]}var Q=E&w^~E&x,j=m&y^m&g^y&g,$=(m<<30|m>>>2)^(m<<19|m>>>13)^(m<<10|m>>>22),B=(E<<26|E>>>6)^(E<<21|E>>>11)^(E<<7|E>>>25),M=I+B+Q+u[C]+d[C],v=$+j;I=x,x=w,w=E,E=b+M|0,b=g,g=y,y=m,m=M+v|0}p[0]=p[0]+m|0,p[1]=p[1]+y|0,p[2]=p[2]+g|0,p[3]=p[3]+b|0,p[4]=p[4]+E|0,p[5]=p[5]+w|0,p[6]=p[6]+x|0,p[7]=p[7]+I|0},_doFinalize:function(){var h=this._data,f=h.words,p=this._nDataBytes*8,m=h.sigBytes*8;return f[m>>>5]|=128<<24-m%32,f[(m+64>>>9<<4)+14]=i.floor(p/4294967296),f[(m+64>>>9<<4)+15]=p,h.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var h=o.clone.call(this);return h._hash=this._hash.clone(),h}});n.SHA256=o._createHelper(A),n.HmacSHA256=o._createHmacHelper(A)})(Math),r.SHA256})}),Vxe=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),f6()):typeof define=="function"&&define.amd?define(["./core","./sha256"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.WordArray,a=i.algo,o=a.SHA256,l=a.SHA224=o.extend({_doReset:function(){this._hash=new s.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=o._doFinalize.call(this);return c.sigBytes-=4,c}});i.SHA224=o._createHelper(l),i.HmacSHA224=o._createHmacHelper(l)})(),r.SHA224})}),gX=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),lP()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.Hasher,a=i.x64,o=a.Word,l=a.WordArray,c=i.algo;function u(){return o.create.apply(o,arguments)}var d=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],A=[];(function(){for(var f=0;f<80;f++)A[f]=u()})();var h=c.SHA512=s.extend({_doReset:function(){this._hash=new l.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(f,p){for(var m=this._hash.words,y=m[0],g=m[1],b=m[2],E=m[3],w=m[4],x=m[5],I=m[6],C=m[7],G=y.high,U=y.low,_=g.high,H=g.low,Q=b.high,j=b.low,$=E.high,B=E.low,M=w.high,v=w.low,N=x.high,R=x.low,q=I.high,P=I.low,z=C.high,W=C.low,oe=G,Ae=U,me=_,ve=H,Le=Q,He=j,rt=$,qe=B,xt=M,Gt=v,ut=N,Pe=R,ft=q,ht=P,Qt=z,Yt=W,Ft=0;Ft<80;Ft++){var kt,sr,Pt=A[Ft];if(Ft<16)sr=Pt.high=f[p+Ft*2]|0,kt=Pt.low=f[p+Ft*2+1]|0;else{var _r=A[Ft-15],Lt=_r.high,ct=_r.low,Zt=(Lt>>>1|ct<<31)^(Lt>>>8|ct<<24)^Lt>>>7,Jt=(ct>>>1|Lt<<31)^(ct>>>8|Lt<<24)^(ct>>>7|Lt<<25),O=A[Ft-2],K=O.high,se=O.low,ae=(K>>>19|se<<13)^(K<<3|se>>>29)^K>>>6,ue=(se>>>19|K<<13)^(se<<3|K>>>29)^(se>>>6|K<<26),Ie=A[Ft-7],Ce=Ie.high,st=Ie.low,it=A[Ft-16],Kt=it.high,ar=it.low;kt=Jt+st,sr=Zt+Ce+(kt>>>0<Jt>>>0?1:0),kt=kt+ue,sr=sr+ae+(kt>>>0<ue>>>0?1:0),kt=kt+ar,sr=sr+Kt+(kt>>>0<ar>>>0?1:0),Pt.high=sr,Pt.low=kt}var lr=xt&ut^~xt&ft,yr=Gt&Pe^~Gt&ht,xi=oe&me^oe&Le^me&Le,Tr=Ae&ve^Ae&He^ve&He,ii=(oe>>>28|Ae<<4)^(oe<<30|Ae>>>2)^(oe<<25|Ae>>>7),nn=(Ae>>>28|oe<<4)^(Ae<<30|oe>>>2)^(Ae<<25|oe>>>7),sn=(xt>>>14|Gt<<18)^(xt>>>18|Gt<<14)^(xt<<23|Gt>>>9),Dn=(Gt>>>14|xt<<18)^(Gt>>>18|xt<<14)^(Gt<<23|xt>>>9),Za=d[Ft],ai=Za.high,xa=Za.low,Lr=Yt+Dn,mn=Qt+sn+(Lr>>>0<Yt>>>0?1:0),Lr=Lr+yr,mn=mn+lr+(Lr>>>0<yr>>>0?1:0),Lr=Lr+xa,mn=mn+ai+(Lr>>>0<xa>>>0?1:0),Lr=Lr+kt,mn=mn+sr+(Lr>>>0<kt>>>0?1:0),bs=nn+Tr,Zi=ii+xi+(bs>>>0<nn>>>0?1:0);Qt=ft,Yt=ht,ft=ut,ht=Pe,ut=xt,Pe=Gt,Gt=qe+Lr|0,xt=rt+mn+(Gt>>>0<qe>>>0?1:0)|0,rt=Le,qe=He,Le=me,He=ve,me=oe,ve=Ae,Ae=Lr+bs|0,oe=mn+Zi+(Ae>>>0<Lr>>>0?1:0)|0}U=y.low=U+Ae,y.high=G+oe+(U>>>0<Ae>>>0?1:0),H=g.low=H+ve,g.high=_+me+(H>>>0<ve>>>0?1:0),j=b.low=j+He,b.high=Q+Le+(j>>>0<He>>>0?1:0),B=E.low=B+qe,E.high=$+rt+(B>>>0<qe>>>0?1:0),v=w.low=v+Gt,w.high=M+xt+(v>>>0<Gt>>>0?1:0),R=x.low=R+Pe,x.high=N+ut+(R>>>0<Pe>>>0?1:0),P=I.low=P+ht,I.high=q+ft+(P>>>0<ht>>>0?1:0),W=C.low=W+Yt,C.high=z+Qt+(W>>>0<Yt>>>0?1:0)},_doFinalize:function(){var f=this._data,p=f.words,m=this._nDataBytes*8,y=f.sigBytes*8;p[y>>>5]|=128<<24-y%32,p[(y+128>>>10<<5)+30]=Math.floor(m/4294967296),p[(y+128>>>10<<5)+31]=m,f.sigBytes=p.length*4,this._process();var g=this._hash.toX32();return g},clone:function(){var f=s.clone.call(this);return f._hash=this._hash.clone(),f},blockSize:1024/32});i.SHA512=s._createHelper(h),i.HmacSHA512=s._createHmacHelper(h)})(),r.SHA512})}),jxe=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),lP(),gX()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./sha512"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.x64,s=n.Word,a=n.WordArray,o=i.algo,l=o.SHA512,c=o.SHA384=l.extend({_doReset:function(){this._hash=new a.init([new s.init(3418070365,3238371032),new s.init(1654270250,914150663),new s.init(2438529370,812702999),new s.init(355462360,4144912697),new s.init(1731405415,4290775857),new s.init(2394180231,1750603025),new s.init(3675008525,1694076839),new s.init(1203062813,3204075428)])},_doFinalize:function(){var u=l._doFinalize.call(this);return u.sigBytes-=16,u}});i.SHA384=l._createHelper(c),i.HmacSHA384=l._createHmacHelper(c)})(),r.SHA384})}),Qxe=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),lP()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],i):i(r.CryptoJS)})(t,function(r){return(function(i){var n=r,s=n.lib,a=s.WordArray,o=s.Hasher,l=n.x64,c=l.Word,u=n.algo,d=[],A=[],h=[];(function(){for(var m=1,y=0,g=0;g<24;g++){d[m+5*y]=(g+1)*(g+2)/2%64;var b=y%5,E=(2*m+3*y)%5;m=b,y=E}for(var m=0;m<5;m++)for(var y=0;y<5;y++)A[m+5*y]=y+(2*m+3*y)%5*5;for(var w=1,x=0;x<24;x++){for(var I=0,C=0,G=0;G<7;G++){if(w&1){var U=(1<<G)-1;U<32?C^=1<<U:I^=1<<U-32}w&128?w=w<<1^113:w<<=1}h[x]=c.create(I,C)}})();var f=[];(function(){for(var m=0;m<25;m++)f[m]=c.create()})();var p=u.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var m=this._state=[],y=0;y<25;y++)m[y]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(m,y){for(var g=this._state,b=this.blockSize/2,E=0;E<b;E++){var w=m[y+2*E],x=m[y+2*E+1];w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,x=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360;var I=g[E];I.high^=x,I.low^=w}for(var C=0;C<24;C++){for(var G=0;G<5;G++){for(var U=0,_=0,H=0;H<5;H++){var I=g[G+5*H];U^=I.high,_^=I.low}var Q=f[G];Q.high=U,Q.low=_}for(var G=0;G<5;G++)for(var j=f[(G+4)%5],$=f[(G+1)%5],B=$.high,M=$.low,U=j.high^(B<<1|M>>>31),_=j.low^(M<<1|B>>>31),H=0;H<5;H++){var I=g[G+5*H];I.high^=U,I.low^=_}for(var v=1;v<25;v++){var U,_,I=g[v],N=I.high,R=I.low,q=d[v];q<32?(U=N<<q|R>>>32-q,_=R<<q|N>>>32-q):(U=R<<q-32|N>>>64-q,_=N<<q-32|R>>>64-q);var P=f[A[v]];P.high=U,P.low=_}var z=f[0],W=g[0];z.high=W.high,z.low=W.low;for(var G=0;G<5;G++)for(var H=0;H<5;H++){var v=G+5*H,I=g[v],oe=f[v],Ae=f[(G+1)%5+5*H],me=f[(G+2)%5+5*H];I.high=oe.high^~Ae.high&me.high,I.low=oe.low^~Ae.low&me.low}var I=g[0],ve=h[C];I.high^=ve.high,I.low^=ve.low}},_doFinalize:function(){var m=this._data,y=m.words,g=this._nDataBytes*8,b=m.sigBytes*8,E=this.blockSize*32;y[b>>>5]|=1<<24-b%32,y[(i.ceil((b+1)/E)*E>>>5)-1]|=128,m.sigBytes=y.length*4,this._process();for(var w=this._state,x=this.cfg.outputLength/8,I=x/8,C=[],G=0;G<I;G++){var U=w[G],_=U.high,H=U.low;_=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,H=(H<<8|H>>>24)&16711935|(H<<24|H>>>8)&4278255360,C.push(H),C.push(_)}return new a.init(C,x)},clone:function(){for(var m=o.clone.call(this),y=m._state=this._state.slice(0),g=0;g<25;g++)y[g]=y[g].clone();return m}});n.SHA3=o._createHelper(p),n.HmacSHA3=o._createHmacHelper(p)})(Math),r.SHA3})}),zxe=Kn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(fs()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){return(function(i){var n=r,s=n.lib,a=s.WordArray,o=s.Hasher,l=n.algo,c=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),d=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),A=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),h=a.create([0,1518500249,1859775393,2400959708,2840853838]),f=a.create([1352829926,1548603684,1836072691,2053994217,0]),p=l.RIPEMD160=o.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(x,I){for(var C=0;C<16;C++){var G=I+C,U=x[G];x[G]=(U<<8|U>>>24)&16711935|(U<<24|U>>>8)&4278255360}var _=this._hash.words,H=h.words,Q=f.words,j=c.words,$=u.words,B=d.words,M=A.words,v,N,R,q,P,z,W,oe,Ae,me;z=v=_[0],W=N=_[1],oe=R=_[2],Ae=q=_[3],me=P=_[4];for(var ve,C=0;C<80;C+=1)ve=v+x[I+j[C]]|0,C<16?ve+=m(N,R,q)+H[0]:C<32?ve+=y(N,R,q)+H[1]:C<48?ve+=g(N,R,q)+H[2]:C<64?ve+=b(N,R,q)+H[3]:ve+=E(N,R,q)+H[4],ve=ve|0,ve=w(ve,B[C]),ve=ve+P|0,v=P,P=q,q=w(R,10),R=N,N=ve,ve=z+x[I+$[C]]|0,C<16?ve+=E(W,oe,Ae)+Q[0]:C<32?ve+=b(W,oe,Ae)+Q[1]:C<48?ve+=g(W,oe,Ae)+Q[2]:C<64?ve+=y(W,oe,Ae)+Q[3]:ve+=m(W,oe,Ae)+Q[4],ve=ve|0,ve=w(ve,M[C]),ve=ve+me|0,z=me,me=Ae,Ae=w(oe,10),oe=W,W=ve;ve=_[1]+R+Ae|0,_[1]=_[2]+q+me|0,_[2]=_[3]+P+z|0,_[3]=_[4]+v+W|0,_[4]=_[0]+N+oe|0,_[0]=ve},_doFinalize:function(){var x=this._data,I=x.words,C=this._nDataBytes*8,G=x.sigBytes*8;I[G>>>5]|=128<<24-G%32,I[(G+64>>>9<<4)+14]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,x.sigBytes=(I.length+1)*4,this._process();for(var U=this._hash,_=U.words,H=0;H<5;H++){var Q=_[H];_[H]=(Q<<8|Q>>>24)&16711935|(Q<<24|Q>>>8)&4278255360}return U},clone:function(){var x=o.clone.call(this);return x._hash=this._hash.clone(),x}});function m(x,I,C){return x^I^C}function y(x,I,C){return x&I|~x&C}function g(x,I,C){return(x|~I)^C}function b(x,I,C){return x&C|I&~C}function E(x,I,C){return x^(I|~C)}function w(x,I){return x<<I|x>>>32-I}n.RIPEMD160=o._createHelper(p),n.HmacRIPEMD160=o._createHmacHelper(p)})(Math),r.RIPEMD160})}),p6=Kn((t,e)=>{(function(r,i){typeof t=="object"?e.exports=t=i(fs()):typeof define=="function"&&define.amd?define(["./core"],i):i(r.CryptoJS)})(t,function(r){(function(){var i=r,n=i.lib,s=n.Base,a=i.enc,o=a.Utf8,l=i.algo,c=l.HMAC=s.extend({init:function(u,d){u=this._hasher=new u.init,typeof d=="string"&&(d=o.parse(d));var A=u.blockSize,h=A*4;d.sigBytes>h&&(d=u.finalize(d)),d.clamp();for(var f=this._oKey=d.clone(),p=this._iKey=d.clone(),m=f.words,y=p.words,g=0;g<A;g++)m[g]^=1549556828,y[g]^=909522486;f.sigBytes=p.sigBytes=h,this.reset()},reset:function(){var u=this._hasher;u.reset(),u.update(this._iKey)},update:function(u){return this._hasher.update(u),this},finalize:function(u){var d=this._hasher,A=d.finalize(u);d.reset();var h=d.finalize(this._oKey.clone().concat(A));return h}})})()})}),Xxe=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),f6(),p6()):typeof define=="function"&&define.amd?define(["./core","./sha256","./hmac"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.Base,a=n.WordArray,o=i.algo,l=o.SHA256,c=o.HMAC,u=o.PBKDF2=s.extend({cfg:s.extend({keySize:128/32,hasher:l,iterations:25e4}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,A){for(var h=this.cfg,f=c.create(h.hasher,d),p=a.create(),m=a.create([1]),y=p.words,g=m.words,b=h.keySize,E=h.iterations;y.length<b;){var w=f.update(A).finalize(m);f.reset();for(var x=w.words,I=x.length,C=w,G=1;G<E;G++){C=f.finalize(C),f.reset();for(var U=C.words,_=0;_<I;_++)x[_]^=U[_]}p.concat(w),g[0]++}return p.sigBytes=b*4,p}});i.PBKDF2=function(d,A,h){return u.create(h).compute(d,A)}})(),r.PBKDF2})}),ey=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),mX(),p6()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.Base,a=n.WordArray,o=i.algo,l=o.MD5,c=o.EvpKDF=s.extend({cfg:s.extend({keySize:128/32,hasher:l,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,d){for(var A,h=this.cfg,f=h.hasher.create(),p=a.create(),m=p.words,y=h.keySize,g=h.iterations;m.length<y;){A&&f.update(A),A=f.update(u).finalize(d),f.reset();for(var b=1;b<g;b++)A=f.finalize(A),f.reset();p.concat(A)}return p.sigBytes=y*4,p}});i.EvpKDF=function(u,d,A){return c.create(A).compute(u,d)}})(),r.EvpKDF})}),Mc=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),ey()):typeof define=="function"&&define.amd?define(["./core","./evpkdf"],i):i(r.CryptoJS)})(t,function(r){r.lib.Cipher||(function(i){var n=r,s=n.lib,a=s.Base,o=s.WordArray,l=s.BufferedBlockAlgorithm,c=n.enc,u=c.Utf8,d=c.Base64,A=n.algo,h=A.EvpKDF,f=s.Cipher=l.extend({cfg:a.extend(),createEncryptor:function(Q,j){return this.create(this._ENC_XFORM_MODE,Q,j)},createDecryptor:function(Q,j){return this.create(this._DEC_XFORM_MODE,Q,j)},init:function(Q,j,$){this.cfg=this.cfg.extend($),this._xformMode=Q,this._key=j,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(Q){return this._append(Q),this._process()},finalize:function(Q){Q&&this._append(Q);var j=this._doFinalize();return j},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function Q(j){return typeof j=="string"?H:G}return function(j){return{encrypt:function($,B,M){return Q(B).encrypt(j,$,B,M)},decrypt:function($,B,M){return Q(B).decrypt(j,$,B,M)}}}})()}),p=s.StreamCipher=f.extend({_doFinalize:function(){var Q=this._process(!0);return Q},blockSize:1}),m=n.mode={},y=s.BlockCipherMode=a.extend({createEncryptor:function(Q,j){return this.Encryptor.create(Q,j)},createDecryptor:function(Q,j){return this.Decryptor.create(Q,j)},init:function(Q,j){this._cipher=Q,this._iv=j}}),g=m.CBC=(function(){var Q=y.extend();Q.Encryptor=Q.extend({processBlock:function($,B){var M=this._cipher,v=M.blockSize;j.call(this,$,B,v),M.encryptBlock($,B),this._prevBlock=$.slice(B,B+v)}}),Q.Decryptor=Q.extend({processBlock:function($,B){var M=this._cipher,v=M.blockSize,N=$.slice(B,B+v);M.decryptBlock($,B),j.call(this,$,B,v),this._prevBlock=N}});function j($,B,M){var v,N=this._iv;N?(v=N,this._iv=i):v=this._prevBlock;for(var R=0;R<M;R++)$[B+R]^=v[R]}return Q})(),b=n.pad={},E=b.Pkcs7={pad:function(Q,j){for(var $=j*4,B=$-Q.sigBytes%$,M=B<<24|B<<16|B<<8|B,v=[],N=0;N<B;N+=4)v.push(M);var R=o.create(v,B);Q.concat(R)},unpad:function(Q){var j=Q.words[Q.sigBytes-1>>>2]&255;Q.sigBytes-=j}},w=s.BlockCipher=f.extend({cfg:f.cfg.extend({mode:g,padding:E}),reset:function(){var Q;f.reset.call(this);var j=this.cfg,$=j.iv,B=j.mode;this._xformMode==this._ENC_XFORM_MODE?Q=B.createEncryptor:(Q=B.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==Q?this._mode.init(this,$&&$.words):(this._mode=Q.call(B,this,$&&$.words),this._mode.__creator=Q)},_doProcessBlock:function(Q,j){this._mode.processBlock(Q,j)},_doFinalize:function(){var Q,j=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(j.pad(this._data,this.blockSize),Q=this._process(!0)):(Q=this._process(!0),j.unpad(Q)),Q},blockSize:128/32}),x=s.CipherParams=a.extend({init:function(Q){this.mixIn(Q)},toString:function(Q){return(Q||this.formatter).stringify(this)}}),I=n.format={},C=I.OpenSSL={stringify:function(Q){var j,$=Q.ciphertext,B=Q.salt;return B?j=o.create([1398893684,1701076831]).concat(B).concat($):j=$,j.toString(d)},parse:function(Q){var j,$=d.parse(Q),B=$.words;return B[0]==1398893684&&B[1]==1701076831&&(j=o.create(B.slice(2,4)),B.splice(0,4),$.sigBytes-=16),x.create({ciphertext:$,salt:j})}},G=s.SerializableCipher=a.extend({cfg:a.extend({format:C}),encrypt:function(Q,j,$,B){B=this.cfg.extend(B);var M=Q.createEncryptor($,B),v=M.finalize(j),N=M.cfg;return x.create({ciphertext:v,key:$,iv:N.iv,algorithm:Q,mode:N.mode,padding:N.padding,blockSize:Q.blockSize,formatter:B.format})},decrypt:function(Q,j,$,B){B=this.cfg.extend(B),j=this._parse(j,B.format);var M=Q.createDecryptor($,B).finalize(j.ciphertext);return M},_parse:function(Q,j){return typeof Q=="string"?j.parse(Q,this):Q}}),U=n.kdf={},_=U.OpenSSL={execute:function(Q,j,$,B,M){if(B||(B=o.random(64/8)),M)var v=h.create({keySize:j+$,hasher:M}).compute(Q,B);else var v=h.create({keySize:j+$}).compute(Q,B);var N=o.create(v.words.slice(j),$*4);return v.sigBytes=j*4,x.create({key:v,iv:N,salt:B})}},H=s.PasswordBasedCipher=G.extend({cfg:G.cfg.extend({kdf:_}),encrypt:function(Q,j,$,B){B=this.cfg.extend(B);var M=B.kdf.execute($,Q.keySize,Q.ivSize,B.salt,B.hasher);B.iv=M.iv;var v=G.encrypt.call(this,Q,j,M.key,B);return v.mixIn(M),v},decrypt:function(Q,j,$,B){B=this.cfg.extend(B),j=this._parse(j,B.format);var M=B.kdf.execute($,Q.keySize,Q.ivSize,j.salt,B.hasher);B.iv=M.iv;var v=G.decrypt.call(this,Q,j,M.key,B);return v}})})()})}),qxe=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),Mc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.mode.CFB=(function(){var i=r.lib.BlockCipherMode.extend();i.Encryptor=i.extend({processBlock:function(s,a){var o=this._cipher,l=o.blockSize;n.call(this,s,a,l,o),this._prevBlock=s.slice(a,a+l)}}),i.Decryptor=i.extend({processBlock:function(s,a){var o=this._cipher,l=o.blockSize,c=s.slice(a,a+l);n.call(this,s,a,l,o),this._prevBlock=c}});function n(s,a,o,l){var c,u=this._iv;u?(c=u.slice(0),this._iv=void 0):c=this._prevBlock,l.encryptBlock(c,0);for(var d=0;d<o;d++)s[a+d]^=c[d]}return i})(),r.mode.CFB})}),Wxe=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),Mc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.mode.CTR=(function(){var i=r.lib.BlockCipherMode.extend(),n=i.Encryptor=i.extend({processBlock:function(s,a){var o=this._cipher,l=o.blockSize,c=this._iv,u=this._counter;c&&(u=this._counter=c.slice(0),this._iv=void 0);var d=u.slice(0);o.encryptBlock(d,0),u[l-1]=u[l-1]+1|0;for(var A=0;A<l;A++)s[a+A]^=d[A]}});return i.Decryptor=n,i})(),r.mode.CTR})}),Kxe=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),Mc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.mode.CTRGladman=(function(){var i=r.lib.BlockCipherMode.extend();function n(o){if((o>>24&255)===255){var l=o>>16&255,c=o>>8&255,u=o&255;l===255?(l=0,c===255?(c=0,u===255?u=0:++u):++c):++l,o=0,o+=l<<16,o+=c<<8,o+=u}else o+=1<<24;return o}function s(o){return(o[0]=n(o[0]))===0&&(o[1]=n(o[1])),o}var a=i.Encryptor=i.extend({processBlock:function(o,l){var c=this._cipher,u=c.blockSize,d=this._iv,A=this._counter;d&&(A=this._counter=d.slice(0),this._iv=void 0),s(A);var h=A.slice(0);c.encryptBlock(h,0);for(var f=0;f<u;f++)o[l+f]^=h[f]}});return i.Decryptor=a,i})(),r.mode.CTRGladman})}),Jxe=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),Mc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.mode.OFB=(function(){var i=r.lib.BlockCipherMode.extend(),n=i.Encryptor=i.extend({processBlock:function(s,a){var o=this._cipher,l=o.blockSize,c=this._iv,u=this._keystream;c&&(u=this._keystream=c.slice(0),this._iv=void 0),o.encryptBlock(u,0);for(var d=0;d<l;d++)s[a+d]^=u[d]}});return i.Decryptor=n,i})(),r.mode.OFB})}),$xe=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),Mc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.mode.ECB=(function(){var i=r.lib.BlockCipherMode.extend();return i.Encryptor=i.extend({processBlock:function(n,s){this._cipher.encryptBlock(n,s)}}),i.Decryptor=i.extend({processBlock:function(n,s){this._cipher.decryptBlock(n,s)}}),i})(),r.mode.ECB})}),Zxe=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),Mc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.pad.AnsiX923={pad:function(i,n){var s=i.sigBytes,a=n*4,o=a-s%a,l=s+o-1;i.clamp(),i.words[l>>>2]|=o<<24-l%4*8,i.sigBytes+=o},unpad:function(i){var n=i.words[i.sigBytes-1>>>2]&255;i.sigBytes-=n}},r.pad.Ansix923})}),e2e=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),Mc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.pad.Iso10126={pad:function(i,n){var s=n*4,a=s-i.sigBytes%s;i.concat(r.lib.WordArray.random(a-1)).concat(r.lib.WordArray.create([a<<24],1))},unpad:function(i){var n=i.words[i.sigBytes-1>>>2]&255;i.sigBytes-=n}},r.pad.Iso10126})}),t2e=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),Mc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.pad.Iso97971={pad:function(i,n){i.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(i,n)},unpad:function(i){r.pad.ZeroPadding.unpad(i),i.sigBytes--}},r.pad.Iso97971})}),r2e=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),Mc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.pad.ZeroPadding={pad:function(i,n){var s=n*4;i.clamp(),i.sigBytes+=s-(i.sigBytes%s||s)},unpad:function(i){for(var n=i.words,s=i.sigBytes-1,s=i.sigBytes-1;s>=0;s--)if(n[s>>>2]>>>24-s%4*8&255){i.sigBytes=s+1;break}}},r.pad.ZeroPadding})}),i2e=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),Mc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding})}),n2e=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),Mc()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return(function(i){var n=r,s=n.lib,a=s.CipherParams,o=n.enc,l=o.Hex,c=n.format,u=c.Hex={stringify:function(d){return d.ciphertext.toString(l)},parse:function(d){var A=l.parse(d);return a.create({ciphertext:A})}}})(),r.format.Hex})}),s2e=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),$1(),Z1(),ey(),Mc()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.BlockCipher,a=i.algo,o=[],l=[],c=[],u=[],d=[],A=[],h=[],f=[],p=[],m=[];(function(){for(var b=[],E=0;E<256;E++)E<128?b[E]=E<<1:b[E]=E<<1^283;for(var w=0,x=0,E=0;E<256;E++){var I=x^x<<1^x<<2^x<<3^x<<4;I=I>>>8^I&255^99,o[w]=I,l[I]=w;var C=b[w],G=b[C],U=b[G],_=b[I]*257^I*16843008;c[w]=_<<24|_>>>8,u[w]=_<<16|_>>>16,d[w]=_<<8|_>>>24,A[w]=_;var _=U*16843009^G*65537^C*257^w*16843008;h[I]=_<<24|_>>>8,f[I]=_<<16|_>>>16,p[I]=_<<8|_>>>24,m[I]=_,w?(w=C^b[b[b[U^C]]],x^=b[b[x]]):w=x=1}})();var y=[0,1,2,4,8,16,32,64,128,27,54],g=a.AES=s.extend({_doReset:function(){var b;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var E=this._keyPriorReset=this._key,w=E.words,x=E.sigBytes/4,I=this._nRounds=x+6,C=(I+1)*4,G=this._keySchedule=[],U=0;U<C;U++)U<x?G[U]=w[U]:(b=G[U-1],U%x?x>6&&U%x==4&&(b=o[b>>>24]<<24|o[b>>>16&255]<<16|o[b>>>8&255]<<8|o[b&255]):(b=b<<8|b>>>24,b=o[b>>>24]<<24|o[b>>>16&255]<<16|o[b>>>8&255]<<8|o[b&255],b^=y[U/x|0]<<24),G[U]=G[U-x]^b);for(var _=this._invKeySchedule=[],H=0;H<C;H++){var U=C-H;if(H%4)var b=G[U];else var b=G[U-4];H<4||U<=4?_[H]=b:_[H]=h[o[b>>>24]]^f[o[b>>>16&255]]^p[o[b>>>8&255]]^m[o[b&255]]}}},encryptBlock:function(b,E){this._doCryptBlock(b,E,this._keySchedule,c,u,d,A,o)},decryptBlock:function(b,E){var w=b[E+1];b[E+1]=b[E+3],b[E+3]=w,this._doCryptBlock(b,E,this._invKeySchedule,h,f,p,m,l);var w=b[E+1];b[E+1]=b[E+3],b[E+3]=w},_doCryptBlock:function(b,E,w,x,I,C,G,U){for(var _=this._nRounds,H=b[E]^w[0],Q=b[E+1]^w[1],j=b[E+2]^w[2],$=b[E+3]^w[3],B=4,M=1;M<_;M++){var v=x[H>>>24]^I[Q>>>16&255]^C[j>>>8&255]^G[$&255]^w[B++],N=x[Q>>>24]^I[j>>>16&255]^C[$>>>8&255]^G[H&255]^w[B++],R=x[j>>>24]^I[$>>>16&255]^C[H>>>8&255]^G[Q&255]^w[B++],q=x[$>>>24]^I[H>>>16&255]^C[Q>>>8&255]^G[j&255]^w[B++];H=v,Q=N,j=R,$=q}var v=(U[H>>>24]<<24|U[Q>>>16&255]<<16|U[j>>>8&255]<<8|U[$&255])^w[B++],N=(U[Q>>>24]<<24|U[j>>>16&255]<<16|U[$>>>8&255]<<8|U[H&255])^w[B++],R=(U[j>>>24]<<24|U[$>>>16&255]<<16|U[H>>>8&255]<<8|U[Q&255])^w[B++],q=(U[$>>>24]<<24|U[H>>>16&255]<<16|U[Q>>>8&255]<<8|U[j&255])^w[B++];b[E]=v,b[E+1]=N,b[E+2]=R,b[E+3]=q},keySize:256/32});i.AES=s._createHelper(g)})(),r.AES})}),a2e=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),$1(),Z1(),ey(),Mc()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.WordArray,a=n.BlockCipher,o=i.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],d=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],A=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],h=o.DES=a.extend({_doReset:function(){for(var y=this._key,g=y.words,b=[],E=0;E<56;E++){var w=l[E]-1;b[E]=g[w>>>5]>>>31-w%32&1}for(var x=this._subKeys=[],I=0;I<16;I++){for(var C=x[I]=[],G=u[I],E=0;E<24;E++)C[E/6|0]|=b[(c[E]-1+G)%28]<<31-E%6,C[4+(E/6|0)]|=b[28+(c[E+24]-1+G)%28]<<31-E%6;C[0]=C[0]<<1|C[0]>>>31;for(var E=1;E<7;E++)C[E]=C[E]>>>(E-1)*4+3;C[7]=C[7]<<5|C[7]>>>27}for(var U=this._invSubKeys=[],E=0;E<16;E++)U[E]=x[15-E]},encryptBlock:function(y,g){this._doCryptBlock(y,g,this._subKeys)},decryptBlock:function(y,g){this._doCryptBlock(y,g,this._invSubKeys)},_doCryptBlock:function(y,g,b){this._lBlock=y[g],this._rBlock=y[g+1],f.call(this,4,252645135),f.call(this,16,65535),p.call(this,2,858993459),p.call(this,8,16711935),f.call(this,1,1431655765);for(var E=0;E<16;E++){for(var w=b[E],x=this._lBlock,I=this._rBlock,C=0,G=0;G<8;G++)C|=d[G][((I^w[G])&A[G])>>>0];this._lBlock=I,this._rBlock=x^C}var U=this._lBlock;this._lBlock=this._rBlock,this._rBlock=U,f.call(this,1,1431655765),p.call(this,8,16711935),p.call(this,2,858993459),f.call(this,16,65535),f.call(this,4,252645135),y[g]=this._lBlock,y[g+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function f(y,g){var b=(this._lBlock>>>y^this._rBlock)&g;this._rBlock^=b,this._lBlock^=b<<y}function p(y,g){var b=(this._rBlock>>>y^this._lBlock)&g;this._lBlock^=b,this._rBlock^=b<<y}i.DES=a._createHelper(h);var m=o.TripleDES=a.extend({_doReset:function(){var y=this._key,g=y.words;if(g.length!==2&&g.length!==4&&g.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var b=g.slice(0,2),E=g.length<4?g.slice(0,2):g.slice(2,4),w=g.length<6?g.slice(0,2):g.slice(4,6);this._des1=h.createEncryptor(s.create(b)),this._des2=h.createEncryptor(s.create(E)),this._des3=h.createEncryptor(s.create(w))},encryptBlock:function(y,g){this._des1.encryptBlock(y,g),this._des2.decryptBlock(y,g),this._des3.encryptBlock(y,g)},decryptBlock:function(y,g){this._des3.decryptBlock(y,g),this._des2.encryptBlock(y,g),this._des1.decryptBlock(y,g)},keySize:192/32,ivSize:64/32,blockSize:64/32});i.TripleDES=a._createHelper(m)})(),r.TripleDES})}),o2e=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),$1(),Z1(),ey(),Mc()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.StreamCipher,a=i.algo,o=a.RC4=s.extend({_doReset:function(){for(var u=this._key,d=u.words,A=u.sigBytes,h=this._S=[],f=0;f<256;f++)h[f]=f;for(var f=0,p=0;f<256;f++){var m=f%A,y=d[m>>>2]>>>24-m%4*8&255;p=(p+h[f]+y)%256;var g=h[f];h[f]=h[p],h[p]=g}this._i=this._j=0},_doProcessBlock:function(u,d){u[d]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var u=this._S,d=this._i,A=this._j,h=0,f=0;f<4;f++){d=(d+1)%256,A=(A+u[d])%256;var p=u[d];u[d]=u[A],u[A]=p,h|=u[(u[d]+u[A])%256]<<24-f*8}return this._i=d,this._j=A,h}i.RC4=s._createHelper(o);var c=a.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)l.call(this)}});i.RC4Drop=s._createHelper(c)})(),r.RC4})}),l2e=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),$1(),Z1(),ey(),Mc()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.StreamCipher,a=i.algo,o=[],l=[],c=[],u=a.Rabbit=s.extend({_doReset:function(){for(var A=this._key.words,h=this.cfg.iv,f=0;f<4;f++)A[f]=(A[f]<<8|A[f]>>>24)&16711935|(A[f]<<24|A[f]>>>8)&4278255360;var p=this._X=[A[0],A[3]<<16|A[2]>>>16,A[1],A[0]<<16|A[3]>>>16,A[2],A[1]<<16|A[0]>>>16,A[3],A[2]<<16|A[1]>>>16],m=this._C=[A[2]<<16|A[2]>>>16,A[0]&4294901760|A[1]&65535,A[3]<<16|A[3]>>>16,A[1]&4294901760|A[2]&65535,A[0]<<16|A[0]>>>16,A[2]&4294901760|A[3]&65535,A[1]<<16|A[1]>>>16,A[3]&4294901760|A[0]&65535];this._b=0;for(var f=0;f<4;f++)d.call(this);for(var f=0;f<8;f++)m[f]^=p[f+4&7];if(h){var y=h.words,g=y[0],b=y[1],E=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,w=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,x=E>>>16|w&4294901760,I=w<<16|E&65535;m[0]^=E,m[1]^=x,m[2]^=w,m[3]^=I,m[4]^=E,m[5]^=x,m[6]^=w,m[7]^=I;for(var f=0;f<4;f++)d.call(this)}},_doProcessBlock:function(A,h){var f=this._X;d.call(this),o[0]=f[0]^f[5]>>>16^f[3]<<16,o[1]=f[2]^f[7]>>>16^f[5]<<16,o[2]=f[4]^f[1]>>>16^f[7]<<16,o[3]=f[6]^f[3]>>>16^f[1]<<16;for(var p=0;p<4;p++)o[p]=(o[p]<<8|o[p]>>>24)&16711935|(o[p]<<24|o[p]>>>8)&4278255360,A[h+p]^=o[p]},blockSize:128/32,ivSize:64/32});function d(){for(var A=this._X,h=this._C,f=0;f<8;f++)l[f]=h[f];h[0]=h[0]+1295307597+this._b|0,h[1]=h[1]+3545052371+(h[0]>>>0<l[0]>>>0?1:0)|0,h[2]=h[2]+886263092+(h[1]>>>0<l[1]>>>0?1:0)|0,h[3]=h[3]+1295307597+(h[2]>>>0<l[2]>>>0?1:0)|0,h[4]=h[4]+3545052371+(h[3]>>>0<l[3]>>>0?1:0)|0,h[5]=h[5]+886263092+(h[4]>>>0<l[4]>>>0?1:0)|0,h[6]=h[6]+1295307597+(h[5]>>>0<l[5]>>>0?1:0)|0,h[7]=h[7]+3545052371+(h[6]>>>0<l[6]>>>0?1:0)|0,this._b=h[7]>>>0<l[7]>>>0?1:0;for(var f=0;f<8;f++){var p=A[f]+h[f],m=p&65535,y=p>>>16,g=((m*m>>>17)+m*y>>>15)+y*y,b=((p&4294901760)*p|0)+((p&65535)*p|0);c[f]=g^b}A[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,A[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,A[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,A[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,A[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,A[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,A[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,A[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}i.Rabbit=s._createHelper(u)})(),r.Rabbit})}),c2e=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),$1(),Z1(),ey(),Mc()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.StreamCipher,a=i.algo,o=[],l=[],c=[],u=a.RabbitLegacy=s.extend({_doReset:function(){var A=this._key.words,h=this.cfg.iv,f=this._X=[A[0],A[3]<<16|A[2]>>>16,A[1],A[0]<<16|A[3]>>>16,A[2],A[1]<<16|A[0]>>>16,A[3],A[2]<<16|A[1]>>>16],p=this._C=[A[2]<<16|A[2]>>>16,A[0]&4294901760|A[1]&65535,A[3]<<16|A[3]>>>16,A[1]&4294901760|A[2]&65535,A[0]<<16|A[0]>>>16,A[2]&4294901760|A[3]&65535,A[1]<<16|A[1]>>>16,A[3]&4294901760|A[0]&65535];this._b=0;for(var m=0;m<4;m++)d.call(this);for(var m=0;m<8;m++)p[m]^=f[m+4&7];if(h){var y=h.words,g=y[0],b=y[1],E=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,w=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,x=E>>>16|w&4294901760,I=w<<16|E&65535;p[0]^=E,p[1]^=x,p[2]^=w,p[3]^=I,p[4]^=E,p[5]^=x,p[6]^=w,p[7]^=I;for(var m=0;m<4;m++)d.call(this)}},_doProcessBlock:function(A,h){var f=this._X;d.call(this),o[0]=f[0]^f[5]>>>16^f[3]<<16,o[1]=f[2]^f[7]>>>16^f[5]<<16,o[2]=f[4]^f[1]>>>16^f[7]<<16,o[3]=f[6]^f[3]>>>16^f[1]<<16;for(var p=0;p<4;p++)o[p]=(o[p]<<8|o[p]>>>24)&16711935|(o[p]<<24|o[p]>>>8)&4278255360,A[h+p]^=o[p]},blockSize:128/32,ivSize:64/32});function d(){for(var A=this._X,h=this._C,f=0;f<8;f++)l[f]=h[f];h[0]=h[0]+1295307597+this._b|0,h[1]=h[1]+3545052371+(h[0]>>>0<l[0]>>>0?1:0)|0,h[2]=h[2]+886263092+(h[1]>>>0<l[1]>>>0?1:0)|0,h[3]=h[3]+1295307597+(h[2]>>>0<l[2]>>>0?1:0)|0,h[4]=h[4]+3545052371+(h[3]>>>0<l[3]>>>0?1:0)|0,h[5]=h[5]+886263092+(h[4]>>>0<l[4]>>>0?1:0)|0,h[6]=h[6]+1295307597+(h[5]>>>0<l[5]>>>0?1:0)|0,h[7]=h[7]+3545052371+(h[6]>>>0<l[6]>>>0?1:0)|0,this._b=h[7]>>>0<l[7]>>>0?1:0;for(var f=0;f<8;f++){var p=A[f]+h[f],m=p&65535,y=p>>>16,g=((m*m>>>17)+m*y>>>15)+y*y,b=((p&4294901760)*p|0)+((p&65535)*p|0);c[f]=g^b}A[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,A[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,A[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,A[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,A[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,A[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,A[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,A[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}i.RabbitLegacy=s._createHelper(u)})(),r.RabbitLegacy})}),u2e=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),$1(),Z1(),ey(),Mc()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],i):i(r.CryptoJS)})(t,function(r){return(function(){var i=r,n=i.lib,s=n.BlockCipher,a=i.algo;let o=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var u={pbox:[],sbox:[]};function d(m,y){let g=y>>24&255,b=y>>16&255,E=y>>8&255,w=y&255,x=m.sbox[0][g]+m.sbox[1][b];return x=x^m.sbox[2][E],x=x+m.sbox[3][w],x}function A(m,y,g){let b=y,E=g,w;for(let x=0;x<o;++x)b=b^m.pbox[x],E=d(m,b)^E,w=b,b=E,E=w;return w=b,b=E,E=w,E=E^m.pbox[o],b=b^m.pbox[o+1],{left:b,right:E}}function h(m,y,g){let b=y,E=g,w;for(let x=o+1;x>1;--x)b=b^m.pbox[x],E=d(m,b)^E,w=b,b=E,E=w;return w=b,b=E,E=w,E=E^m.pbox[1],b=b^m.pbox[0],{left:b,right:E}}function f(m,y,g){for(let I=0;I<4;I++){m.sbox[I]=[];for(let C=0;C<256;C++)m.sbox[I][C]=c[I][C]}let b=0;for(let I=0;I<o+2;I++)m.pbox[I]=l[I]^y[b],b++,b>=g&&(b=0);let E=0,w=0,x=0;for(let I=0;I<o+2;I+=2)x=A(m,E,w),E=x.left,w=x.right,m.pbox[I]=E,m.pbox[I+1]=w;for(let I=0;I<4;I++)for(let C=0;C<256;C+=2)x=A(m,E,w),E=x.left,w=x.right,m.sbox[I][C]=E,m.sbox[I][C+1]=w;return!0}var p=a.Blowfish=s.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var m=this._keyPriorReset=this._key,y=m.words,g=m.sigBytes/4;f(u,y,g)}},encryptBlock:function(m,y){var g=A(u,m[y],m[y+1]);m[y]=g.left,m[y+1]=g.right},decryptBlock:function(m,y){var g=h(u,m[y],m[y+1]);m[y]=g.left,m[y+1]=g.right},blockSize:64/32,keySize:128/32,ivSize:64/32});i.Blowfish=s._createHelper(p)})(),r.Blowfish})}),h2e=Kn((t,e)=>{(function(r,i,n){typeof t=="object"?e.exports=t=i(fs(),lP(),Hxe(),Gxe(),$1(),Yxe(),Z1(),mX(),f6(),Vxe(),gX(),jxe(),Qxe(),zxe(),p6(),Xxe(),ey(),Mc(),qxe(),Wxe(),Kxe(),Jxe(),$xe(),Zxe(),e2e(),t2e(),r2e(),i2e(),n2e(),s2e(),a2e(),o2e(),l2e(),c2e(),u2e()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./lib-typedarrays","./enc-utf16","./enc-base64","./enc-base64url","./md5","./sha1","./sha256","./sha224","./sha512","./sha384","./sha3","./ripemd160","./hmac","./pbkdf2","./evpkdf","./cipher-core","./mode-cfb","./mode-ctr","./mode-ctr-gladman","./mode-ofb","./mode-ecb","./pad-ansix923","./pad-iso10126","./pad-iso97971","./pad-zeropadding","./pad-nopadding","./format-hex","./aes","./tripledes","./rc4","./rabbit","./rabbit-legacy","./blowfish"],i):r.CryptoJS=i(r.CryptoJS)})(t,function(r){return r})}),d2e=(t=>(t.Device="Device",t.Symbol="Symbol",t.Footprint="Footprint",t.OBJ="OBJ",t.ModelID="3D Model",t.ModelName="3D Model Title",t.OriginModelName="Origin 3D Model Title",t.ModelTransform="3D Model Transform",t.OriginFootprint="Origin Footprint",t))(d2e||{}),A2e=(t=>(t.DOCHEAD="DOCHEAD",t.EDIT_HEAD="EDIT_HEAD",t.SCH="SCH",t.SCH_PAGE="SCH_PAGE",t.PCB="PCB",t.PANEL="PANEL",t.PANEL_LIB="PANEL_LIB",t.SYMBOL="SYMBOL",t.FOOTPRINT="FOOTPRINT",t.DEVICE="DEVICE",t.BLOB="BLOB",t.INSTANCE="INSTANCE",t.CONFIG="CONFIG",t.BOARD="BOARD",t.FONT="FONT",t.VARIANT="VARIANT",t.COMPONENT_GROUP="COMPONENT_GROUP",t.COMPONENT_GROUP_DATA="COMPONENT_GROUP_DATA",t.SIMULATION="SIMULATION",t))(A2e||{}),f2e=(t=>(t.META="META",t.META_SORT="META_SORT",t.META_CREATE="META_CREATE",t.META_MODIFY="META_MODIFY",t.FONT="FONT",t.BLOB="BLOB",t.MAX_NUM="MAX_NUM",t.INSTANCE_ATTR="INSTANCE_ATTR",t.DELETE_DOC="DELETE_DOC",t.META_Z_INDEX="META_Z_INDEX",t.VARIANT_GROUPED="VARIANT_GROUPED",t.GROUP_INDEX="GROUP_INDEX",t.GROUP_DATA="GROUP_DATA",t.RULE_TEMPLATE="RULE_TEMPLATE",t.RULE="RULE",t.RULE_SELECTOR="RULE_SELECTOR",t.ELE_PLACEHOLDER="ELE_PLACEHOLDER",t.META_PLACEHOLDER="META_PLACEHOLDER",t))(f2e||{}),K0="||",zd=`|
`;function tS(t,e,r){return t.slice(e,r)}function Iz(t,e,r){let i=t.length,n=0;for(;n<i;){let s=t.indexOf(zd,n);if(s<0){if(r)return t.substring(n);s=i}let a=tS(t,n,s);try{if(a){let o=a.indexOf(K0),l=o>-1,c=l?tS(a,0,o):a,u=l?tS(a,o+K0.length):"";if(e(c,u,a,l?n+o+K0.length:n)===!1){a=null;break}a=null}}catch(o){console.error(o)}n=s+zd.length}t=null}var p2e=["SYMBOL","FOOTPRINT","BLOB","FONT","PANEL_LIB","DEVICE","BOARD","INSTANCE","CONFIG","VARIANT","COMPONENT_GROUP","COMPONENT_GROUP_DATA"];function rS(t,e){return p2e.includes(e)?e:t}var m6=class{parseFull(t,e,r){let i=e,n=r,s,a=null;Iz(t,(o,l,c)=>{let u=JSON.parse(o);if(u.type==="EDIT_HEAD")a=JSON.parse(l),this.onEditHead&&this.onEditHead(a);else if(u.type==="DOCHEAD"){let d=JSON.parse(l);n=d.docType,i=d.uuid,s=d.client,d.ticket=u.ticket,this.onDocHead(d,a,c)}else this.onLine(u.id,u.ticket,l,u.type,u.client||s,n,i,u.firstTicket,u.pend,a,u.num,c)}),this.onEnd(),t=null}flowParseFull(t={}){let{cache:e,chunkLength:r=100*1024*1024,idsData:i,history:n}=t,s="",a=null,o,l=null,c=!0,u="",d=0,A=!1,h={},f=e?{}:void 0,p=g=>{f[g]===void 0&&(f[g]=-1),e(g,++f[g],h[g].data.join(zd)),h[g].data.length=0,h[g].size=0,h[g].data.push(h[g].head),h[g].size+=h[g].head.length},m=g=>{let b=rS(s,a);e&&(h[b].data.push(g),h[b].size+=(h[b].size?zd.length:0)+g.length,h[b].size+g.length>r&&p(b))},y=(g,b)=>Iz(g,(E,w,x,I)=>{var G,U,_,H,Q,j,$,B;let C=JSON.parse(E);if(C.type==="EDIT_HEAD")l=JSON.parse(w),(G=this.onEditHead)==null||G.call(this,l),(U=t.onEditHead)==null||U.call(t,l),A=!0;else if(C.type==="DOCHEAD"){let M=JSON.parse(w);a=M.docType,s=M.uuid,o=M.client,M.ticket=C.ticket,A||(l={uuid:M.uuid,username:(_=M==null?void 0:M.user)==null?void 0:_.username,nickname:(H=M==null?void 0:M.user)==null?void 0:H.nickname,updateTime:M==null?void 0:M.updateTime},(Q=t.onEditHead)==null||Q.call(t,l),A=!0),this.onDocHead(M,l,x);let v=rS(s,a);e&&!h[v]&&(h[v]={size:0,data:[],head:""}),e&&(h[v].head=x),m(x)}else{let M=C.num,v=C.client||o;if(i){let N=(B=($=(j=i.ids)==null?void 0:j[s])==null?void 0:$[v])==null?void 0:B[C.id];if(!N||N[0]!==C.ticket)return;M=N[1],i.size-=1,delete i.ids[s][v][C.id]}if(n){let N=rS(s,a);e&&(n.dNum=(f==null?void 0:f[N])===void 0?0:(f==null?void 0:f[N])+1),n.start=e?h[N].size+zd.length+E.length+K0.length:d+I}this.onLine(C.id,C.ticket,w,C.type,v,a,s,C.firstTicket,C.pend,l||(n==null?void 0:n.editHead),M,x,n),m(x)}},b);return{start:()=>{c=!0},end:()=>{if(u&&y(u,!1),e)for(let g in h)h[g].size&&h[g].data.length>1&&p(g),h[g]=null;c=!1,u="",s="",s=null,o="",l=null,this.onEnd()},update:g=>{if(!c)throw new Error("\u66F4\u65B0\u524D\u672A\u8C03\u7528 start \u65B9\u6CD5");let b=y(u+g,!0);d=d+u.length+g.length-((b==null?void 0:b.length)||0),u="",b&&(u=b)},docMap:f}}parseLine(t,e,r){let i=t.indexOf(K0),n=i!==-1,s=n?tS(t,0,i):t,a=n?tS(t,i+K0.length):"",o=JSON.parse(s);this.onLine(o.id,o.ticket,a,o.type,o.client,r,e,o.firstTicket,o.pend,void 0,o.num,t),t=null}onEditHead(t){}},MM=new Uint8Array(8);function Wd(){crypto.getRandomValues(MM);let t="";for(let e=0;e<MM.length;e++)t+=MM[e].toString(16).padStart(2,"0");return t}function kM(t,e,r,i,n,s,a){let o={docType:t,client:e,uuid:r};return(i||i===0)&&(o.updateTime=i),(n||o.updateTime||o.updateTime===0)&&(o.version=n||String(i)),s&&(o.user=s),`${JSON.stringify({type:"DOCHEAD",ticket:a})}${K0}${JSON.stringify(o)}`}function V1(t,e,r,i,n,s,a,o){let l={type:t,ticket:e,id:r};return s!==void 0&&(l.firstTicket=s),a!==void 0&&(l.pend=a),o!==void 0&&(l.num=o),n&&(l.client=n),`${JSON.stringify(l)}${K0}${i}`}var g6=class extends m6{constructor(t){super(),this.unique=Wd(),this.maxTicket=0,this.isPendChange=!0,this.isLocalChange=!0,this.cbArr=[],this.tempLocalIds={},this.client=t||Wd()}onLine(t,e,r,i,n,s,a,o,l,c,u){this.remoteChange(e,n,a,t,r,i,s,void 0,o,l,c,void 0,void 0,u)}getUnique(){return this.unique}setUnique(t){this.unique=t}onDocHead(t,e){}onEnd(){}setIsPendChange(t){this.isPendChange=t}getIsPendChange(){return this.isPendChange}getMaxTicket(){return this.maxTicket}setMaxTicket(t,e){t&&(e||this.maxTicket<t)&&(this.maxTicket=t)}setIsLocalChange(t){this.isLocalChange=t}getIsLocalChange(){return this.isLocalChange}revoke(t,e,r,i,n,s,a,o,l,c,u){var d;if(!((d=this.tempLocalIds[t])!=null&&d[e]))return u?u(e,n,r,a,`${i}-1`,t,s,void 0,void 0,!0,c):this.cbArr.forEach(A=>A(t,e,r,a,`${i}-1`,n,void 0,s,void 0,void 0,void 0,c)),!0}getRandomUuid(){return Wd()}getClient(){return this.client}onChange(t){this.cbArr.push(t)}localChange(t,e,r,i,n,s){let a=this.maxTicket+1;return this.tempLocalIds[t]||(this.tempLocalIds[t]={}),this.tempLocalIds[t][e]=[this.getClient(),a],this.remoteChange(a,this.client,t,e,r,i,n,!0,void 0,!0,void 0,this.unique,void 0,s),a}remoteChange(t,e,r,i,n,s,a,o,l,c,u,d,A,h){var g;this.setMaxTicket(t);let f=d===this.unique,p=o||f,m=(!p||p&&this.isLocalChange)&&(!A||A&&this.isPendChange),y=(g=this.tempLocalIds[r])==null?void 0:g[i];!o&&f?y?(m=!1,y[0]===e&&y[1]===t&&delete this.tempLocalIds[r][i]):m=!0:!o&&y&&(y[1]>t||y[1]===t&&y[0]>e?m=!1:delete this.tempLocalIds[r][i]),m&&this.cbArr.forEach(b=>b(r,i,n,s,e,t,l,c,void 0,A,d,h))}},m2e=class{constructor(t){this.item=t,this.parent=null,this.left=null,this.right=null,this.height=1}getParent(){return this.parent}getLeft(){return this.left}getRight(){return this.right}getHeight(){return this.height}setLeft(t){if(this.left!==null)throw new Error("insert exists left is not permitted");if(t!==null){if(t.parent!==null)throw new Error("insert left with node has parent is not permitted");this.left=t,t.parent=this,this.updateHeight()}}setRight(t){if(this.right!==null)throw new Error("insert exists right is not permitted");if(t!==null){if(t.parent!==null)throw new Error("insert right with node has parent is not permitted");this.right=t,t.parent=this,this.updateHeight()}}removeLeft(){if(this.left===null)return null;{let t=this.left;return t.parent=null,this.left=null,this.updateHeight(),t}}removeRight(){if(this.right===null)return null;{let t=this.right;return t.parent=null,this.right=null,this.updateHeight(),t}}rotateRight(t){let e=this.removeLeft();if(this.setLeft(e.removeRight()),this.parent){let r=this.parent;r.getLeft()===this?(r.removeLeft(),r.setLeft(e)):(r.removeRight(),r.setRight(e)),e.setRight(this)}else e.setRight(this),t(e)}rotateLeft(t){let e=this.removeRight();if(this.setRight(e.removeLeft()),this.parent){let r=this.parent;r.getLeft()===this?(r.removeLeft(),r.setLeft(e)):(r.removeRight(),r.setRight(e)),e.setLeft(this)}else e.setLeft(this),t(e)}updateHeight(){var e,r;let t=this;for(;t!==null;)t.height=Math.max(((e=t.left)==null?void 0:e.height)||0,((r=t.right)==null?void 0:r.height)||0)+1,t=t.parent}},Bz=class{constructor(t){this.comparator=t,this.root=null,this.minNode=null,this.maxNode=null,this.size=0}balance(t){var n,s;let e=((n=t.getLeft())==null?void 0:n.getHeight())||0,r=((s=t.getRight())==null?void 0:s.getHeight())||0,i=t.getParent();e>r?e-r>1?(t.rotateRight(a=>this.root=a),this.verify()):i!==null?i.getRight()===t&&(t.rotateRight(a=>this.root=a),this.verify()):(t.rotateRight(a=>this.root=a),this.verify()):r>e&&(r-e>1?(t.rotateLeft(a=>this.root=a),this.verify()):i!==null?i.getLeft()===t&&(t.rotateLeft(a=>this.root=a),this.verify()):(t.rotateLeft(a=>this.root=a),this.verify())),i&&this.balance(i)}forwardTraverse(t){let e=new Array(10),r=this.minNode;for(;r;)switch(e.pop()||2){case 1:r.getLeft()!==null?(e.push(2),e.push(1),r=r.getLeft()):e.push(2);break;case 2:if(!t(r.item))return;r.getRight()!==null?(e.push(3),e.push(1),r=r.getRight()):e.push(3);break;case 3:r=r.getParent();break;default:throw new Error("invalid status")}}backwardTraverse(t){let e=new Array(10),r=this.maxNode;for(;r;)switch(e.pop()||2){case 1:r.getRight()!==null?(e.push(2),e.push(1),r=r.getRight()):e.push(2);break;case 2:if(!t(r.item))return;r.getLeft()!==null?(e.push(3),e.push(1),r=r.getLeft()):e.push(3);break;case 3:r=r.getParent();break;default:throw new Error("invalid status")}}display(t=this.root,e=new Array,r=0){let i="| ".repeat(r);return e.push(i+`\u25CF(${t.item})
`),t.getLeft()?this.display(t.getLeft(),e,r+1):e.push(i+`| \u2609
`),t.getRight()?this.display(t.getRight(),e,r+1):e.push(i+`| \u2609
`),e}getHeight(){var t;return((t=this.root)==null?void 0:t.getHeight())||0}getSize(){return this.size}updateMinMax(t){this.minNode?this.comparator(t.item,this.minNode.item)<0&&(this.minNode=t):this.minNode=t,this.maxNode?this.comparator(t.item,this.maxNode.item)>0&&(this.maxNode=t):this.maxNode=t}insert(t){let e=new m2e(t);if(this.root===null)return this.root=e,this.size++,this.updateMinMax(e),!0;{let r=this.root;for(;;){let i=this.comparator(t,r.item);if(i<0){if(r.getLeft()===null)return r.setLeft(e),this.size++,this.updateMinMax(e),this.verify(),this.balance(r),!0;r=r.getLeft()}else if(i>0){if(r.getRight()===null)return r.setRight(e),this.size++,this.updateMinMax(e),this.verify(),this.balance(r),!0;r=r.getRight()}else return!1}}}verify(){}remove(t){let e=this.root;for(this.verify();;){if(e===null)return!1;let r=this.comparator(t,e.item);if(r<0)e=e.getLeft();else if(r>0)e=e.getRight();else return this.minNode===e&&(e.getRight()?this.minNode=this.findMinChild(e.getRight()):this.minNode=e.getParent()),this.maxNode===e&&(e.getLeft()?this.maxNode=this.findMaxChild(e.getLeft()):this.maxNode=e.getParent()),this.removeNode(e),this.size--,this.verify(),!0}}removeNode(t){var r,i;let e=t.getParent();if(e===null)t.getLeft()===null&&t.getRight()===null?(this.root=null,this.minNode=null,this.maxNode=null):((((r=t.getLeft())==null?void 0:r.getHeight())||0)>(((i=t.getRight())==null?void 0:i.getHeight())||0)?(t.rotateRight(n=>this.root=n),this.verify()):(t.rotateLeft(n=>this.root=n),this.verify()),this.removeNode(t));else if(e.getLeft()===t){e.removeLeft();let n=this.combineNodes(t.removeLeft(),t.removeRight());e.setLeft(n),this.verify(),this.balance(e)}else{e.removeRight();let n=this.combineNodes(t.removeLeft(),t.removeRight());e.setRight(n),this.verify(),this.balance(e)}}combineNodes(t,e){if(t&&e)if(t.getHeight()>e.getHeight()){let r=this.findMaxChild(t);if(r){let i=r.getParent();return i.removeRight(),i.setRight(r.removeLeft()),r.setLeft(t),r.setRight(e),r}else return t.setRight(e),t}else{let r=this.findMinChild(e);if(r){let i=r.getParent();return i.removeLeft(),i.setLeft(r.removeRight()),r.setLeft(t),r.setRight(e),r}else return e.setLeft(t),e}else return t||e||null}findMinChild(t){let e=t;for(;;){if(e.getLeft()===null)return e!==t?e:null;e=e.getLeft()}}findMaxChild(t){let e=t;for(;;){if(e.getRight()===null)return e!==t?e:null;e=e.getRight()}}};function I_(t,e,r){let i=t[e];return i!==void 0||(i=r(e),t[e]=i),i}var g2e=(t=>(t.META="META",t.CANVAS="CANVAS",t.GROUP="GROUP",t.POLY="POLY",t.STRING="STRING",t.AUX_LINE="AUXLINE",t.DIMENSION="DIMENSION",t.ELE_PLACEHOLDER="ELE_PLACEHOLDER",t))(g2e||{}),y2e=(t=>(t.META="META",t.CANVAS="CANVAS",t.LAYER="LAYER",t.LAYER_PHYS="LAYER_PHYS",t.ACTIVE_LAYER="ACTIVE_LAYER",t.PARTITION="PARTITION",t.NET="NET",t.PRIMITIVE="PRIMITIVE",t.GROUP="GROUP",t.SILK_OPTS="SILK_OPTS",t.PREFERENCE="PREFERENCE",t.VIA="VIA",t.PAD="PAD",t.LINE="LINE",t.ARC="ARC",t.OBJ="OBJ",t.EQLEN_GRP="EQLEN_GRP",t.POLY="POLY",t.FILL="FILL",t.LAYER_FILL="LAYER_FILL",t.REGION="REGION",t.POUR="POUR",t.POURED="POURED",t.IMAGE="IMAGE",t.TEARDROP="TEARDROP",t.FPC_FILL="FPC_FILL",t.SHELL="SHELL",t.CREASE="CREASE",t.SHELLCUT="SHELLCUT",t.SHELL_ENTITY="SHELL_ENTITY",t.BOSS="BOSS",t.STRING="STRING",t.ATTR="ATTR",t.DIMENSION="DIMENSION",t.COMPONENT="COMPONENT",t.PAD_NET="PAD_NET",t.RULE_TEMPLATE="RULE_TEMPLATE",t.RULE="RULE",t.RULE_SELECTOR="RULE_SELECTOR",t.PANELIZE="PANELIZE",t.BOARD="BOARD",t.ELE_PLACEHOLDER="ELE_PLACEHOLDER",t))(y2e||{}),b2e=(t=>(t.META="META",t.CANVAS="CANVAS",t.GROUP="GROUP",t.ATTR="ATTR",t.LINE="LINE",t.WIRE="WIRE",t.BUS="BUS",t.TEXT="TEXT",t.POLY="POLY",t.CIRCLE="CIRCLE",t.ARC="ARC",t.BUSENTRY="BUSENTRY",t.RECT="RECT",t.MASK_REGION="MASK_REGION",t.PIN="PIN",t.OBJ="OBJ",t.COMPONENT="COMPONENT",t.PART="PART",t.ELLIPSE="ELLIPSE",t.BEZIER="BEZIER",t.TABLE="TABLE",t.ELE_PLACEHOLDER="ELE_PLACEHOLDER",t.NG_SETTING="NG_SETTING",t))(b2e||{});function Dz(t,e){return t.ticket===e.ticket?t.client<e.client:t.ticket<e.ticket}var es=class yX{static find(e,r){return e.last&&r(e.last)?e.last:e.list?e.list.find(r):null}static getFirstTicket(e){var i;if(!e)return 0;let r=yX.getHead(e);return(i=r==null?void 0:r.firstTicket)!=null?i:r==null?void 0:r.ticket}static getHead(e){var r;return((r=e==null?void 0:e.list)==null?void 0:r[0])||e.last}static getPreNode(e,r){if(e.last===r)return e.list?e.list[e.list.length-1]:null;let i=e.list.findIndex(n=>n===r);return e.list[i-1]}static remove(e,r){var i;if(e.last===r)e.last=((i=e.list)==null?void 0:i.pop())||null;else if(e.list){let n=e.list.findIndex(s=>s===r);n>-1&&e.list.slice(n,1)}}static getLength(e){let r=0;return e&&(e.last&&(r+=1),e.list&&(r+=e.list.length)),r}static insert(e,r){if(!e.last){e.last=r;return}if(Dz(e.last,r)){let s=e.last;e.last=r,r=s}if(!e.list){e.list=[r];return}let i=0,n=e.list.length;for(;i<n;){let s=Math.floor((i+n)/2);Dz(e.list[s],r)?i=s+1:n=s}e.list.splice(i,0,r)}static preForEach(e,r){if(!(!e.last||r(e.last))&&e.list)for(let i=e.list.length-1;i>=0&&!r(e.list[i]);--i);}},bX=["GROUP","POLY","STRING","AUXLINE","DIMENSION"],x2e=["PARTITION","VIA","PAD","LINE","ARC","OBJ","POLY","FILL","REGION","POUR","POURED","IMAGE","TEARDROP","FPC_FILL","SHELL","CREASE","SHELLCUT","SHELL_ENTITY","BOSS","STRING","ATTR","DIMENSION","COMPONENT"],E2e=["ATTR","WIRE","BUS","TEXT","POLY","CIRCLE","ARC","BUSENTRY","RECT","PIN","OBJ","COMPONENT","PART","ELLIPSE","BEZIER","TABLE","MASK_REGION"],w2e=["SCH_PAGE","SIMULATION"],_z=t=>t==="PCB"||t==="FOOTPRINT"?0:1,xX=t=>t==="PCB"||t==="FOOTPRINT"?x2e:t==="PANEL"||t==="PANEL_LIB"?bX:t==="SCH_PAGE"||t==="SYMBOL"||t==="SIMULATION"?E2e:[];function Pz(t,e,r){var d,A;let i=t.get(e),n=t.get(r),s=es.getHead(i),a=es.getHead(n),o=(d=s.firstTicket)!=null?d:s.ticket,l=(A=a.firstTicket)!=null?A:a.ticket,c=s.client,u=a.client;return o===l?c===u?e===r?0:e<r?-1:1:c<u?-1:1:o<l?-1:1}var v2e=class{constructor(t){this.numSets={},this.orderCbArr=[],this.wDocData=t}orderChange(t){this.orderCbArr.push(t)}setOrderNum(t,e,r,i,n,s){var A,h;let a=i.last.dataType,o=1;if(a==="ELE_PLACEHOLDER"){let f=JSON.parse(i.last.data);a=f.dataType,o=f.max}else if(!((h=(A=xX(e))==null?void 0:A.includes)!=null&&h.call(A,a)))return;if(o<1)throw new Error("step must be greater than 0");let l=I_(this.numSets[t].orderLists,a,()=>new Bz((f,p)=>Pz(this.wDocData.get(t),f,p))),c=I_(this.numSets[t].maxNum,a,()=>_z(e)-1),u=this.wDocData.get(t).get(r);if(s&&(l.remove(r),c-=u.step||1),!es.getLength(u))return;u.num=0,o>1&&(u.step=o),l.insert(r),c+=o;let d=c;l.backwardTraverse(f=>{let p=this.wDocData.get(t).get(f);return p.num=d,n&&f!==r&&this.orderCbArr.forEach(m=>m(t,f,a,p.num)),d-=p.step||1,f!==r}),this.numSets[t].maxNum[a]=c}removeNode(t,e,r){let i=this.wDocData.get(t).get(r);if(i.num===void 0)return;let n=i.last.dataType,s=I_(this.numSets[t].orderLists,n,()=>new Bz((l,c)=>Pz(this.wDocData.get(t),l,c))),a=I_(this.numSets[t].maxNum,n,()=>_z(e)-1);a-=i.step||1;let o=a;s.backwardTraverse(l=>{if(l===r)return!0;let c=this.wDocData.get(t).get(l);return c.num=o,this.orderCbArr.forEach(u=>u(t,l,n,c.num)),o-=c.step||1,!1}),this.numSets[t].maxNum[n]=a,s.remove(r)}getOrderNum(t,e){var r,i,n;return(n=(i=(r=this.wDocData.get(t))==null?void 0:r.get)==null?void 0:i.call(r,e))==null?void 0:n.num}getMaxNum(t){var e;return((e=this.numSets[t])==null?void 0:e.maxNum)||{}}delete(t){this.numSets[t]&&delete this.numSets[t]}add(t){this.numSets[t]||(this.numSets[t]={orderLists:{},maxNum:{}})}has(t){return!!this.numSets[t]}},Jf=(t=>(t.SOLID="SOLID",t.SHORT_DASH="SHORT_DASH",t.DOT="DOT",t.DOT_DASH="DOT_DASH",t))(Jf||{}),Kd=(t=>(t.PRINT="PRINT",t.COVER="COVER",t.PRINT_AND_COVER="PRINT&COVER",t))(Kd||{}),C2e=(t=>(t.LEFT="LEFT",t.CENTER="CENTER",t.RIGHT="RIGHT",t))(C2e||{}),S2e=(t=>(t.TOP="TOP",t.MIDDLE="MIDDLE",t.BOTTOM="BOTTOM",t))(S2e||{}),yl=(t=>(t.LEFT_BOTTOM="LEFT_BOTTOM",t.CENTER_BOTTOM="CENTER_BOTTOM",t.RIGHT_BOTTOM="RIGHT_BOTTOM",t.LEFT_MIDDLE="LEFT_MIDDLE",t.CENTER_MIDDLE="CENTER_MIDDLE",t.RIGHT_MIDDLE="RIGHT_MIDDLE",t.LEFT_TOP="LEFT_TOP",t.CENTER_TOP="CENTER_TOP",t.RIGHT_TOP="RIGHT_TOP",t))(yl||{}),T2e=(t=>(t.NONE="NONE",t.SOLID="SOLID",t.GRID="GRID",t.HORIZONTAL_LINE="HORIZONTAL_LINE",t.VERTICAL_LINE="VERTICAL_LINE",t.RHOMBIC="RHOMBIC",t.LEFT_SLASH_LINE="LEFT_SLASH_LINE",t.RIGHT_SLASH_LINE="RIGHT_SLASH_LINE",t))(T2e||{}),I2e=(t=>(t.NONE="NONE",t.CLOCK="CLOCK",t.INVERTED="INVERTED",t.INVERTED_CLOCK="INVERTED_CLOCK",t))(I2e||{}),B2e=(t=>(t.NONE="NONE",t.GRID="GRID",t.OUTLETS="OUTLETS",t))(B2e||{}),D2e=(t=>(t.NONE="NONE",t.PUSH="PUSH",t.SURROUND="SURROUND",t.OBSTRUCT="OBSTRUCT",t.SURROUND_AND_PUSH="SURROUND&PUSH",t))(D2e||{}),_2e=(t=>(t.ELLIPSE="ELLIPSE",t.RECT="RECT",t.OVAL="OVAL",t.POLYGON="POLYGON",t))(_2e||{}),P2e=(t=>(t.ROUND="ROUND",t.RECT="RECT",t.SLOT="SLOT",t))(P2e||{}),L2e=(t=>(t.SOLID="SOLID",t.GRID_LINE="GRID_LINE",t.HORIZONTAL_LINE="HORIZONTAL_LINE",t.VERTICAL_LINE="VERTICAL_LINE",t))(L2e||{}),O2e=(t=>(t.ALL="ALL",t.PAD="PAD",t.VIA="VIA",t))(O2e||{}),N2e=(t=>(t.NONE="NONE",t.SINGLE="SINGLE",t.ALL="ALL",t))(N2e||{}),R2e=(t=>(t.OPTIMIZA_OPEN="OPTIMIZA_OPEN",t.OPTIMIZA_NONE="OPTIMIZA_NONE",t))(R2e||{}),M2e=(t=>(t.OPTIMIZA_STRONG="OPTIMIZA_STRONG",t.OPTIMIZA_WEAK="OPTIMIZA_WEAK",t.OPTIMIZA_NONE="OPTIMIZA_NONE",t))(M2e||{}),k2e=(t=>(t.L45="L45",t.L90="L90",t.L="L",t.R45="R45",t.R90="R90",t.R="R",t))(k2e||{}),F2e=(t=>(t.NORMAL="NORMAL",t.BLIND="BLIND",t.SUTURE="SUTURE",t))(F2e||{}),U2e=(t=>(t.NORMAL="NORMAL",t.TEST="TEST",t.MARKER="MARKER",t))(U2e||{}),H2e=(t=>(t.DIVERGENCE="DIVERGENCE",t.DIRECT="DIRECT",t.NON_CONNECT="NON_CONNECT",t))(H2e||{}),G2e=(t=>(t.DOT="DOT",t.CENTER="CENT",t))(G2e||{}),Y2e=(t=>(t.NORMAL="NORMAL",t.BOARD_OUTLINE="BOARD_OUTLINE",t))(Y2e||{}),V2e=(t=>(t.SOLID="SOLID",t.GRID="GRID",t.PLANE="PLANE",t))(V2e||{}),j2e=(t=>(t.PROHIBIT="PROHIBIT",t.CONSTRAINT="CONSTRAINT",t))(j2e||{}),Q2e=(t=>(t.COMPONENT="COMPONENT",t.VIA="VIA",t.TRACK="TRACK",t.FILL="FILL",t.COPPER="COPPER",t.PLANE="PLANE",t))(Q2e||{}),z2e=(t=>(t.PI="Polyimide",t.FR4="FR4",t.STEEL_SHEET="Stainless Steel",t.M3_DOUBLE_SIDED_TAPE="3M Tape",t.EMI_SHIELDING_FILM="EMI Shielding Film",t))(z2e||{}),X2e=(t=>(t.PUSH_COVER="DRAWER",t.UPPER_LOWER_SHELLS="T&B",t))(X2e||{}),q2e=(t=>(t.X_AXIS_POSITIVE="X_AXIS_POSITIVE",t.X_AXIS_NEGATIVE="X_AXIS_NEGATIVE",t.Y_AXIS_POSITIVE="Y_AXIS_POSITIVE",t.Y_AXIS_NEGATIVE="Y_AXIS_NEGATIVE",t))(q2e||{}),W2e=(t=>(t.SLOT="SLOT",t.ENTITY="ENTITY",t))(W2e||{}),K2e=(t=>(t.AUTO="AUTO",t.UPPER_SHELLS="UPPER_SHELLS",t.LOWER_SHELLS="LOWER_SHELLS",t))(K2e||{}),J2e=(t=>(t.OUTLINE="OUTLINE",t.SCREW_PILLAR="SCREW_PILLAR",t.ENTITY="ENTITY",t))(J2e||{}),$2e=(t=>(t.M2="M2",t.M3="M3",t.M4="M4",t.M5="M5",t.M6="M6",t))($2e||{}),Z2e=(t=>(t.LENGTH="LENGTH",t.RADIUS="RADIUS",t.ANGLE="ANGLE",t))(Z2e||{}),eEe=(t=>(t.MIL="mil",t.INCH="inch",t.CM="cm",t.MM="mm",t))(eEe||{}),tEe=(t=>(t.SAFE="SAFE",t.OTHER="OTHER",t.TRACK="TRACK",t.BLIND="BLIND",t.RADIUS="RADIUS",t.PLANE="PLANE",t.COPPER="COPPER",t.PASTE="PASTE",t.SOLDER="SOLDER",t.DIFFER_ENTAIL="DIFFER_ENTAIL",t.NET_LENGTH="NET_LENGTH",t.AUTO_ROUTER="AUTO_ROUTER",t.NET_LENGTH_TOLERANCE="NET_LENGTH_TOLERANCE",t))(tEe||{}),rEe=(t=>(t.NORMAL="NORMAL",t.DEFAULT="DEFAULT",t))(rEe||{}),iEe=(t=>(t.ALL="ALL",t.LAYERED="LAYERED",t))(iEe||{}),nEe=(t=>(t.DIRECT="DIRECT",t.NON_CONNECT="NON_CONNECT",t))(nEe||{}),sEe=(t=>(t.FORTY_FIVE="L45",t.NINETY="L90",t.NINETY_ARC="A90",t))(sEe||{}),aEe=(t=>(t.LESS="LESS",t.MID="MID",t.MORE="MORE",t))(aEe||{}),oEe=(t=>(t.SPEED_FIRST="SPEED_FIRST",t.COMPLETION_FIRST="COMPLETION_FIRST",t))(oEe||{}),lEe=(t=>(t.DesignRule="DesignRule",t.Board="Board",t.SlotRegion="SlotRegion",t.ProhibitedRegion="ProhibitedRegion",t.ConstraintRegion="ConstraintRegion",t.Component="Component",t.Track="Track",t.TestPoint="TestPoint",t.Pad="Pad",t.Via="Via",t.SutureHole="SutureHole",t.Text="Text",t.ColorfulImage="ColorfulImage",t.Image="Image",t.FPCStiffener="FPCStiffener",t.Dimension="Dimension",t.CopperRegion="CopperRegion",t.FillRegion="Fill Region",t.Line="Line",t.Teardrop="Teardrop",t.D3Shell="D3Shell",t))(lEe||{}),cEe=X2(h2e());function uEe(t,e){return t.fontFamily==e.fontFamily&&e.text==t.text&&Math.abs(t.fontSize-e.fontSize)<1e-5&&t.reverse==e.reverse&&t.expansion==e.expansion&&t.bold==e.bold&&t.italic==e.italic}function _2(t,e,r,i,n,s,a,o){return JSON.stringify([t||"",e||"",r,i,n?1:0,s?1:0,a?1:0,o])}function Lz(t){let e=JSON.parse(t);return{text:e[0],fontFamily:e[1],fontSize:e[2],thickness:e[3],bold:!!e[4],italic:!!e[5],reverse:!!e[6],expansion:e[7]}}function EX(t){return cEe.default.SHA256(t).toString()}function GC(t,e,r,i){let n="";return r?i?n=t+":"+e:n=t:i?n=e:n="",n}function hEe(t,e){if(!t||!t.startsWith("="))return t;t=t.slice(1);let r=/\{([^\}]+)\}/g,i=[],n=[];for(;i=r.exec(t);)n.push(i[1]);for(let s=0;s<n.length;s++){let a=n[s],o=`{${a}!}`;e.has(a)&&(o=e.get(a)),t=t.replace(`{${a}}`,o)}return t}var Qf=class{static getInitProps(){return{stringData:{},dData:{},oData:{},attrData:{},cData:{}}}static collectPcb(t,e,r,i,n){r==="STRING"&&(n.stringData[t]||(n.stringData[t]={}),n.stringData[t][e]=i),r==="DIMENSION"&&(n.dData[t]||(n.dData[t]={}),n.dData[t][e]=i),r==="ATTR"&&(n.attrData[t]||(n.attrData[t]={}),n.attrData[t][e]=i),r==="COMPONENT"&&(n.cData[t]||(n.cData[t]={}),n.cData[t][e]=i),r==="OBJ"&&(n.oData[t]||(n.oData[t]={}),n.oData[t][e]=i)}static collectFt(t,e,r,i,n){r==="STRING"&&(n.stringData[t]||(n.stringData[t]={}),n.stringData[t][e]=i),r==="DIMENSION"&&(n.dData[t]||(n.dData[t]={}),n.dData[t][e]=i),r==="ATTR"&&(n.attrData[t]||(n.attrData[t]={}),n.attrData[t][e]=i),r==="OBJ"&&(n.oData[t]||(n.oData[t]={}),n.oData[t][e]=i)}static collectPanel(t,e,r,i,n){r==="POLY"&&(n.oData[t]||(n.oData[t]={}),n.oData[t][e]=i)}static collectSheet(t,e,r,i,n){r==="OBJ"&&(n.oData[t]||(n.oData[t]={}),n.oData[t][e]=i),r==="ATTR"&&(n.attrData[t]||(n.attrData[t]={}),n.attrData[t][e]=i)}static collectSymbol(t,e,r,i,n){r==="OBJ"&&(n.oData[t]||(n.oData[t]={}),n.oData[t][e]=i)}static pcb(t={},e={},r={},i){var o,l,c,u;let n={devices:new Set,symbols:new Set,footprints:new Set,blobs:new Set,fonts:new Set},s={};for(let d in i.oData)for(let A in i.oData[d]){let h=i.oData[d][A];if(!h)continue;let f=JSON.parse(h);f.path&&f.path.startsWith("blob:")&&n.blobs.add(f.path.split("blob:").pop())}for(let d in i.stringData)for(let A in i.stringData[d]){let h=i.stringData[d][A];if(!h)continue;let f=JSON.parse(h);f.fontFamily==="default"||!f.text||n.fonts.add(_2(f.text,f.fontFamily,f.fontSize/10,f.strokeWidth,f.bold,f.italic,f.reverse,f.expansion))}for(let d in i.dData)for(let A in i.dData[d]){let h=i.dData[d][A];if(!h)continue;let f=JSON.parse(h).text;f.fontFamily==="default"||!f.text||n.fonts.add(_2(f.text,f.fontFamily,f.fontSize/10,f.strokeWidth,f.bold,f.italic,f.reverse,f.expansion))}let a={};for(let d in i.attrData)for(let A in i.attrData[d]){let h=i.attrData[d][A];if(!h)continue;let f=JSON.parse(h);a[d]||(a[d]={}),a[d][A]=f,f.key==="Device"&&(s[d]||(s[d]={}),s[d][f.parentId]=f.value)}for(let d in a)for(let A in a[d]){let h=a[d][A];if(!h)continue;let f=h;switch(f.key){case"Device":{f.value&&n.devices.add(f.value);break}case"Symbol":{f.value&&n.symbols.add(f.value);break}case"Footprint":{f.value&&n.footprints.add(f.value);break}}if(f.fontFamily==="default")continue;let p=f.value;if(f.key==="Device"){let m=t[p]||p;p=GC(f.key,m,f.keyVisible,f.valueVisible)}else if(f.key==="Footprint"){let m=e[p]||p;p=GC(f.key,m,f.keyVisible,f.valueVisible)}else if(f.key==="Name"){let m=new Map;if(f.parentId){m.set("ID",f.parentId);let y=(l=(o=i.cData)==null?void 0:o[d])==null?void 0:l[f.parentId];if(y){let g=JSON.parse(y);if(Object.entries(g.attrs).forEach(b=>m.set(b[0],b[1])),(c=s==null?void 0:s[d])==null?void 0:c[f.parentId]){let b=(u=s==null?void 0:s[d])==null?void 0:u[f.parentId],E=r[b];E&&Object.entries(E).forEach(w=>m.set(w[0],w[1]))}}}p=GC(f.key,hEe(p,m),f.keyVisible,f.valueVisible)}else p=GC(f.key,p,f.keyVisible,f.valueVisible);p&&n.fonts.add(_2(p,f.fontFamily,f.fontSize/10,f.strokeWidth,f.bold,f.italic,f.reverse,f.expansion))}return n}static footprint(t){let e={blobs:new Set,fonts:new Set};for(let r in t.oData)for(let i in t.oData[r]){let n=t.oData[r][i];if(!n)continue;let s=JSON.parse(n);s.path&&s.path.startsWith("blob:")&&e.blobs.add(s.path.split("blob:").pop())}for(let r in t.stringData)for(let i in t.stringData[r]){let n=t.stringData[r][i];if(!n)continue;let s=JSON.parse(n);s.fontFamily==="default"||!s.text||e.fonts.add(_2(s.text,s.fontFamily,s.fontSize/10,s.strokeWidth,s.bold,s.italic,s.reverse,s.expansion))}for(let r in t.dData)for(let i in t.dData[r]){let n=t.dData[r][i];if(!n)continue;let s=JSON.parse(n).text;s.fontFamily==="default"||!s.text||e.fonts.add(_2(s.text,s.fontFamily,s.fontSize/10,s.strokeWidth,s.bold,s.italic,s.reverse,s.expansion))}for(let r in t.attrData)for(let i in t.attrData[r]){let n=t.attrData[r][i];if(!n)continue;let s=JSON.parse(n);if(s.fontFamily==="default"||!s.value)continue;let a=GC(s.key,s.value,s.keyVisible,s.valueVisible);e.fonts.add(_2(a,s.fontFamily,s.fontSize/10,s.strokeWidth,s.bold,s.italic,s.reverse,s.expansion))}return e}static panel(t){let e={blobs:new Set};for(let r in t.oData)for(let i in t.oData[r]){let n=t.oData[r][i];if(!n)continue;let s=JSON.parse(n);s.fillColor&&s.fillColor.startsWith("blob:")&&e.blobs.add(s.fillColor.split("blob:").pop())}return e}static sheet(t,e){let r={devices:new Set,symbols:new Set,footprints:new Set,blobs:new Set};for(let i in t.oData)for(let n in t.oData[i]){let s=t.oData[i][n];if(!s)continue;let a=JSON.parse(s);a.content&&a.content.startsWith("blob:")&&r.blobs.add(a.content.split("blob:").pop())}for(let i in t.attrData)for(let n in t.attrData[i]){let s=t.attrData[i][n];if(!s)continue;let a=JSON.parse(s);if(a.value)switch(a.key){case"Device":{r.devices.add(a.value);break}case"Symbol":{r.symbols.add(a.value),e&&(e[a.value]=a.parentId);break}case"Footprint":{r.footprints.add(a.value),e&&(e[a.value]=a.parentId);break}}}return{dataSet:r,parentIds:e}}static symbol(t){let e={blobs:new Set};for(let r in t.oData)for(let i in t.oData[r]){let n=t.oData[r][i];if(!n)continue;let s=JSON.parse(n);s.content&&s.content.startsWith("blob:")&&e.blobs.add(s.content.split("blob:").pop())}return e}},dEe=X2(lS()),AEe=Object.create(null),fEe=class extends g6{constructor(t){super(t),this.creators={},this.headCbArr=[],this.docHead={},this.uniqueIds={},this.cacheType=["META","DELETE_DOC","ELE_PLACEHOLDER","VARIANT_GROUPED"],this.historyMap={},this.clearTime=null,this.currentTime=0,this.wDocData=new Map,this.orderTree=new v2e(this.wDocData)}onLine(t,e,r,i,n,s,a,o,l,c,u,d,A){this.remoteChange(e,n,a,t,r,i,s,void 0,o,l,c,void 0,void 0,void 0,A)}onDocHead(t,e){t.updateTime=t.updateTime||(e==null?void 0:e.updateTime),t.user=t.user||{uuid:e==null?void 0:e.uuid,username:e==null?void 0:e.username,nickname:e==null?void 0:e.nickname},this.setMaxTicket(t.ticket),this.docHead[t.uuid]?(!this.docHead[t.uuid].updateTime||this.docHead[t.uuid].updateTime<t.updateTime)&&(this.docHead[t.uuid].client=t.uuid,this.docHead[t.uuid].user=t.user,this.docHead[t.uuid].updateTime=t.updateTime,this.docHead[t.uuid].version=t.version,this.docHead[t.uuid].docType=t.docType,this.docHead[t.uuid].uuid=t.uuid,t.ticket&&t.ticket>this.docHead[t.uuid].ticket&&(this.docHead[t.uuid].ticket=t.ticket)):this.docHead[t.uuid]=t,this.creators[t.uuid]?this.creators[t.uuid].createTime>t.updateTime&&(this.creators[t.uuid].createTime=t.updateTime,this.creators[t.uuid].creator=t.user):this.creators[t.uuid]={createTime:t.updateTime,creator:t.user};for(let r of this.headCbArr)r(t,e)}onHeadChange(t){this.headCbArr.push(t)}setCacheData(t){this.getCache=t}setDoctype(t,e){this.docHead[t]?this.docHead[t].docType=e:this.docHead[t]={docType:e}}getDoctype(t){var e,r;return(r=(e=this.docHead)==null?void 0:e[t])==null?void 0:r.docType}getDataTicket(t,e){var r,i,n,s,a,o;return(o=(a=(s=(n=(i=(r=this.wDocData)==null?void 0:r.get)==null?void 0:i.call(r,t))==null?void 0:n.get)==null?void 0:s.call(n,e))==null?void 0:a.last)==null?void 0:o.ticket}getDataClient(t,e){var r,i,n,s,a,o;return(o=(a=(s=(n=(i=(r=this.wDocData)==null?void 0:r.get)==null?void 0:i.call(r,t))==null?void 0:n.get)==null?void 0:s.call(n,e))==null?void 0:a.last)==null?void 0:o.client}getAtomData(t,e){var r,i,n,s,a;return(a=(s=(n=(i=(r=this.wDocData)==null?void 0:r.get)==null?void 0:i.call(r,t))==null?void 0:n.get)==null?void 0:s.call(n,e))==null?void 0:a.last}getDataSize(t,e){var r,i,n,s;return es.getLength((s=(n=(i=(r=this.wDocData)==null?void 0:r.get)==null?void 0:i.call(r,t))==null?void 0:n.get)==null?void 0:s.call(n,e))}getFirst(t,e){var i,n,s,a,o;let r=(a=(s=(n=(i=this.wDocData)==null?void 0:i.get)==null?void 0:n.call(i,t))==null?void 0:s.get)==null?void 0:a.call(s,e);return((o=r==null?void 0:r.list)==null?void 0:o[0])||r.last}getFirstTicket(t,e){var r,i;return es.getFirstTicket((i=(r=this.wDocData.get(t))==null?void 0:r.get)==null?void 0:i.call(r,e))}getAllDataId(t){let e=[],r=t||this.wDocData.keys();for(let i of r){let n={doc:i,ids:[]},s=this.wDocData.get(i);if(s){for(let[a]of s)n.ids.push(a);n.ids.length&&e.push(n)}}return e}clear(){for(let[,t]of this.wDocData)t.clear();this.wDocData.clear(),this.creators={}}isHasData(t){if(t){if(this.uniqueIds[t]){for(let e in this.uniqueIds[t])if(this.uniqueIds[t][e].size)return!0}}else for(let[,e]of this.wDocData)for(let[,,]of e)return!0;return!1}delayClear(t=!0){this.clearTime||(this.clearTime=setTimeout(()=>{if(Date.now()-this.currentTime<5e3)this.clearTime=null,this.delayClear(!1);else{let e=!1;for(let r in this.historyMap)for(let i in this.historyMap[r])for(let n in this.historyMap[r][i])for(let s in this.historyMap[r][i][n])this.historyMap[r][i][n][s].promise?(this.clearTime=null,this.delayClear(!1),e=!0):(this.historyMap[r][i][n][s].cache.end(),this.historyMap[r][i][n][s].cache=null,delete this.historyMap[r][i][n][s]);!e&&(this.clearTime=null)}},5e3)),t&&(this.currentTime=Date.now())}getForeachKeys(t){let e=this.wDocData.keys(),r=[],i=[],n=[],s=[],a=[],o=[],l=[],c=[],u=[];for(let d of e)switch(this.getDoctype(d)){case"DEVICE":r.push(d);break;case"FOOTPRINT":n.push(d);break;case"SYMBOL":i.push(d);break;case"BOARD":s.push(d);break;case"SCH":a.push(d);break;case"SCH_PAGE":o.push(d);break;case"PCB":l.push(d);break;case"FONT":case"BLOB":u.push(d);break;default:c.push(d);break}return[...n,...i,...r,...s,...a,...o,...l,...c,...u]}getLastData(t,e,r){let i=this.wDocData.get(t);if(!i)return;let n=i.get(e);if(!n)return;let s=null;return es.preForEach(n,a=>!!a.pend==!!r?(s=a,!0):!1),s}revoke(){return!1}getPublishRevoke(t){let e={},r=(s,a,o,l,c,u,d)=>{var h,f,p;let A;d.length&&es.getLength(c)===d.length&&this.orderTree.has(s)&&(this.orderTree.removeNode(s,this.getDoctype(s),a),A=(p=(f=(h=this.orderTree.numSets)==null?void 0:h[s])==null?void 0:f.maxNum)==null?void 0:p[l.dataType],delete c.num),t&&t(s,a,u||"",o?o.client:l.client,o?o.ticket:l.ticket,l.client,l.ticket,o?o.pend:void 0,o?o.dataType:l.dataType,es.getFirstTicket(c),A),d.forEach(m=>es.remove(c,m))},i=(s,a,o,l,c,u)=>{var d;if(!this.getCache||!c||(d=c.data)!=null&&d.length||c.data===""||!c.hId)r(s,a,c,l,o,c==null?void 0:c.data,u);else{let A=c.dNum||0;e[c.hId]||(e[c.hId]={}),e[c.hId][c.hNum]||(e[c.hId][c.hNum]={}),e[c.hId][c.hNum][s]||(e[c.hId][c.hNum][s]=[]),e[c.hId][c.hNum][s][A]||(e[c.hId][c.hNum][s][A]=[]),e[c.hId][c.hNum][s][A].push([a,o,l,c,u])}},n=async(s,a,o,l,c)=>{let u=this.getCache(),d=rS(o,this.getDoctype(o));await u.init(s,a,d,l);for(let A of c){let[h,f,p,m,y]=A;if(f.last===p){let g=u.get(m.start);r(o,h,m,p,f,g,y)}else y.forEach(g=>es.remove(f,g))}};return{update:i,end:()=>{if(this.getCache){for(let s in e)for(let a in e[s])for(let o in e[s][a])for(let l in e[s][a][o])n(s,a,o,l,e[s][a][o][l]);e=null}}}}handleRevoke(t,e,r,i,n,s){let a=[];es.preForEach(r,o=>{if(o.pend&&(!n||o.client===n)){if(a.push(o),o===r.last){let l=es.getPreNode(r,o);if(s)for(;l&&l.pend;)a.push(l),l=es.getPreNode(r,l);i.update(t,e,r,o,l,a)}else a.forEach(l=>es.remove(r,l));return!0}return!1}),es.getLength(r)||this.wDocData.get(t).delete(e)}revokeOne(t,e,r){let i=this.wDocData.get(t);if(!i)return;let n=i.get(e);n&&this.handleRevoke(t,e,n,r)}foreachRevokeAll(t,e=this.getClient()){let r=this.getForeachKeys(),i=this.getPublishRevoke(t);for(let n of r){let s=this.wDocData.get(n);for(let[a,o]of s)this.handleRevoke(n,a,o,i,e,!0)}i.end()}revokeByUnique(t,e,r){let i=this.uniqueIds[t];if(i)for(let n in i)this.revokeAll(n,e,Array.from(i[n]),r),i[n].clear()}revokeAll(t,e,r,i){let n=this.wDocData.get(t);if(!n)return;let s=this.getPublishRevoke(i);for(let a of r){let o=n.get(a);o&&this.handleRevoke(t,a,o,s,e)}s.end()}findPreDataByTime(t,e,r,i,n){let s=this.wDocData.get(t);if(!s)return null;let a=s.get(e);if(!a)return null;let o=null,l=0;return es.preForEach(a,c=>{let u=n(c==null?void 0:c.hId,c==null?void 0:c.hNum);return u&&(u<r||u===r&&c.client<i)&&(o?(u>l||u===l&&c.client>o.client)&&(o=c,l=u):(o=c,l=u)),!1}),o}isFilterData(t,e,r){return!!(!t||e.ignoreType&&e.ignoreType.includes(t.dataType)||e.needType&&!e.needType.includes(t.dataType)||e.isPend&&!t.pend||r&&!e.needDelete&&e.needNum&&t.data==="")}getCanvasIds(t){var d;let e=0,r={},i={},n=[],s=[],a=10*1024*1024,o=0,l=(A,h,f)=>{var m;let p=f.last;if(p.pend||(m=p.data)!=null&&m.length){o+p.data.length>a&&(n.push(s),s=[]);let y=[A,h,p.ticket,p.client,p.dataType,p.data,p.pend];t.needNum&&y.push(f.num),s.push(y);return}r[A][p.client]||(r[A][p.client]={}),r[A][p.client][h]=[p.ticket],t.needNum&&r[A][p.client][h].push(f.num),e+=1},c=A=>{let h=A.last;return!!(t.ignoreType&&t.ignoreType.includes(h.dataType)||h.dataType==="ELE_PLACEHOLDER"||!t.needDelete&&h.data==="")};for(let A of t.doc){let h=(d=this.wDocData)==null?void 0:d.get(A);if(!h)continue;r[A]={};let f=this.getDoctype(A);if(t.needNum&&!["BLOB"].includes(f)&&!this.orderTree.has(A)){this.orderTree.add(A);let p=Array.from(h.keys()).sort((m,y)=>{let g=es.getHead(h.get(m)),b=es.getHead(h.get(y)),E=g.firstTicket||g.ticket,w=b.firstTicket||b.ticket;return E===w?g.client>b.client?1:-1:E-w});for(let m of p){let y=h.get(m);y&&(y.num&&(y.num=void 0),this.orderTree.setOrderNum(A,f,m,y,!1),!c(y)&&l(A,m,y))}}else for(let[p,m]of h)c(m)||l(A,p,m);i[A]=this.orderTree.getMaxNum(A)}s.length&&(n.push(s),s=null);let u;return n.length&&(u=Wd(),(0,dEe.flowWrite)(u,async A=>{for(let h of n)await A.write(JSON.stringify(h)),h.length=0;n.length=0},void 0,void 0)),{ids:r,maxNum:i,size:e,channel:u}}async compress(t,e,r){var x,I,C,G,U,_,H,Q,j,$,B,M,v,N,R,q,P,z,W,oe,Ae,me,ve,Le,He,rt,qe,xt,Gt,ut,Pe,ft,ht,Qt,Yt,Ft,kt,sr,Pt,_r,Lt;let{updateTime:i,versions:n,keepClient:s,keepFirst:a,notDocHead:o,isPend:l,user:c}=t,{headTicket:u,clearDelete:d,needNum:A,uniqueId:h,client:f,extractData:p}=t,{removeBoard:m,eIds:y}=t,g=t.docIds||(y?[]:void 0),b=d&&!!p;if(h&&this.uniqueIds[h]&&(g=Object.keys(this.uniqueIds[h]),t.docIds&&(g=g.filter(ct=>t.docIds.includes(ct)))),g||(g=this.getForeachKeys(b)),y)for(let ct in y)g.some(Zt=>Zt===ct)||g.push(ct);let E,w;b&&(E=new Set,w=new Set);for(let ct of g){let Zt=(x=this.wDocData)==null?void 0:x.get(ct);if(!Zt){A&&!["FONT","BLOB"].includes(ct)&&!this.orderTree.has(ct)&&this.orderTree.add(ct);continue}let Jt=i||((C=(I=this.docHead)==null?void 0:I[ct])==null?void 0:C.updateTime)||new Date().getTime(),O=(n==null?void 0:n[ct])||((U=(G=this.docHead)==null?void 0:G[ct])==null?void 0:U.version)||String(Jt),K=this.getDoctype(ct);if(d){let Ce=Zt.get("DELETE_DOC");if(Ce&&Ce.last.data&&((_=JSON.parse(Ce.last.data))!=null&&_.isDelete)){if(w2e.includes(K)){let st=Zt.get("META"),it=st?JSON.parse(st.last.data):null,Kt=!!it;if(K==="SCH_PAGE"&&Kt){let ar=(H=this.wDocData)==null?void 0:H.get(it.schematic),lr=(j=(Q=ar.get("DELETE_DOC"))==null?void 0:Q.last)==null?void 0:j.data;Kt=ar&&(!lr||lr&&!(($=JSON.parse(lr))!=null&&$.isDelete))}if(Kt){let ar=kM(((M=(B=this.docHead)==null?void 0:B[ct])==null?void 0:M.docType)||this.mainDocType,f||this.getClient(),ct,Jt,O,c||((N=(v=this.docHead)==null?void 0:v[ct])==null?void 0:N.user),u||((q=(R=this.docHead)==null?void 0:R[ct])==null?void 0:q.ticket));r(ar)?await e(ar,!0):e(ar,!0);let lr=V1("DELETE_DOC",es.getFirstTicket(Ce),"DELETE_DOC",Ce.last.data);if(r(lr)?await e(lr):e(lr),st){let yr=Zt.get(it.schematic);if(yr&&yr.last.dataType==="META_PLACEHOLDER"){let Tr=V1("META_PLACEHOLDER",es.getFirstTicket(yr),it.schematic,yr.last.data);r(Tr)?await e(Tr):e(Tr)}let xi=V1("META",es.getFirstTicket(st),"META",st.last.data);r(xi)?await e(xi):e(xi)}}}continue}}let se;if(ct==="FONT"&&E){se=[];for(let Ce of E)se.push(Lz(Ce))}if(!o){let Ce=kM(((z=(P=this.docHead)==null?void 0:P[ct])==null?void 0:z.docType)||this.mainDocType,f||this.getClient(),ct,Jt,O,c||((oe=(W=this.docHead)==null?void 0:W[ct])==null?void 0:oe.user),u||((me=(Ae=this.docHead)==null?void 0:Ae[ct])==null?void 0:me.ticket));h&&this.onDocHead({docType:((Le=(ve=this.docHead)==null?void 0:ve[ct])==null?void 0:Le.docType)||this.mainDocType,uuid:ct,client:f||this.getClient(),updateTime:Jt,version:O,user:c||((rt=(He=this.docHead)==null?void 0:He[ct])==null?void 0:rt.user),ticket:u||((xt=(qe=this.docHead)==null?void 0:qe[ct])==null?void 0:xt.ticket)}),r(Ce)?await e(Ce,!0):e(Ce,!0)}if(!o&&t.needCreator){let Ce=kM(((ut=(Gt=this.docHead)==null?void 0:Gt[ct])==null?void 0:ut.docType)||this.mainDocType,f||this.getClient(),ct,(ft=(Pe=this.creators)==null?void 0:Pe[ct])==null?void 0:ft.createTime,O,(Qt=(ht=this.creators)==null?void 0:ht[ct])==null?void 0:Qt.creator,u||((Ft=(Yt=this.docHead)==null?void 0:Yt[ct])==null?void 0:Ft.ticket));r(Ce)?await e(Ce):e(Ce)}let ae;if(h&&(ae=Array.from(this.uniqueIds[h][ct]),this.uniqueIds[h][ct].clear(),delete this.uniqueIds[h][ct]),y&&y[ct]&&(ae=y[ct]),ae||(ae=A||d?Array.from(Zt.keys()).sort((Ce,st)=>{let it=es.getHead(Zt.get(Ce)),Kt=es.getHead(Zt.get(st)),ar=it.firstTicket||it.ticket,lr=Kt.firstTicket||Kt.ticket;return ar===lr?it.client>Kt.client?1:-1:ar-lr}):Array.from(Zt.keys())),A&&!["FONT","BLOB"].includes(K)&&!this.orderTree.has(ct)){this.orderTree.add(ct);for(let Ce of ae){let st=Zt.get(Ce);st&&(this.isFilterData(st.last,t,!1)||(st.num&&(st.num=void 0),this.orderTree.setOrderNum(ct,K,Ce,st,!1)))}}let ue={},Ie=Qf.getInitProps();for(let Ce of ae){let st=Zt.get(Ce);if(!st)continue;let it;if(h?es.preForEach(st,lr=>lr.unique===h?(it=lr,delete lr.unique,delete lr.pend,lr===st.last&&this.cbArr.forEach(yr=>yr(ct,Ce,lr.data,lr.dataType,lr.client,lr.ticket,es.getFirstTicket(st),void 0,void 0,!0,void 0)),!0):!1):it=st.last,this.isFilterData(it,t,!0))continue;if(b&&ct==="FONT"&&se){let lr=Lz(Ce);if(!se.some(yr=>uEe(lr,yr)))continue}if(b&&ct==="BLOB"&&!w.has(Ce))continue;if(l&&it.pend&&(delete it.pend,this.cbArr.forEach(lr=>lr(ct,Ce,it.data,it.dataType,it.client,it.ticket,es.getFirstTicket(st),void 0,void 0,!0,void 0))),d){if(it.dataType==="ELE_PLACEHOLDER"){let yr=JSON.parse(it.data);ue[yr.dataType]===void 0?ue[yr.dataType]=yr.max:ue[yr.dataType]+=yr.max;continue}let lr=xX(K);if(lr&&lr.includes(it.dataType))if(it.data!==""){if(ue[it.dataType]){let yr={dataType:it.dataType,max:ue[it.dataType]},xi=V1("ELE_PLACEHOLDER",es.getFirstTicket(st)-1,Wd(),JSON.stringify(yr));r(xi)?await e(xi):e(xi),delete ue[it.dataType]}}else{ue[it.dataType]===void 0?ue[it.dataType]=1:++ue[it.dataType];continue}}let Kt=it.data;if(this.getCache&&it.hId&&it.data===void 0){let lr=it.dNum||0,yr=rS(ct,K);if(!((Lt=(_r=(Pt=(sr=(kt=this.historyMap)==null?void 0:kt[it.hId])==null?void 0:sr[it.hNum])==null?void 0:Pt[yr])==null?void 0:_r[lr])!=null&&Lt.cache)){this.historyMap[it.hId]||(this.historyMap[it.hId]={}),this.historyMap[it.hId][it.hNum]||(this.historyMap[it.hId][it.hNum]={}),this.historyMap[it.hId][it.hNum][yr]||(this.historyMap[it.hId][it.hNum][yr]={}),this.historyMap[it.hId][it.hNum][yr][lr]||(this.historyMap[it.hId][it.hNum][yr][lr]={cache:null,promise:null});let xi=this.getCache();this.historyMap[it.hId][it.hNum][yr][lr].cache=xi;let Tr=xi.init(it.hId,it.hNum,yr,lr);this.historyMap[it.hId][it.hNum][yr][lr].promise=Tr,await Tr,delete this.historyMap[it.hId][it.hNum][yr][lr].promise}this.historyMap[it.hId][it.hNum][yr][lr].promise&&await this.historyMap[it.hId][it.hNum][yr][lr].promise,Kt=this.historyMap[it.hId][it.hNum][yr][lr].cache.get(it.start)}if(it.dataType==="META"&&m&&m.includes(ct)&&Kt){let lr=JSON.parse(Kt);lr.board&&(lr.board="",Kt=JSON.stringify(lr))}let ar=V1(it.dataType,it.ticket,Ce,Kt,s?it.client:void 0,a&&it.ticket!==es.getFirstTicket(st)?es.getFirstTicket(st):void 0,void 0,A?st.num:void 0);if(b)switch(K){case"PCB":{Qf.collectPcb(ct,Ce,it.dataType,Kt,Ie);break}case"FOOTPRINT":{Qf.collectFt(ct,Ce,it.dataType,Kt,Ie);break}case"PANEL":{Qf.collectPanel(ct,Ce,it.dataType,Kt,Ie);break}case"SYMBOL":{Qf.collectSymbol(ct,Ce,it.dataType,Kt,Ie);break}case"SCH_PAGE":case"SIMULATION":{Qf.collectSymbol(ct,Ce,it.dataType,Kt,Ie);break}default:break}r(ar)?await e(ar):e(ar)}if(A){let Ce=V1("MAX_NUM",1,"MAX_NUM",JSON.stringify(this.orderTree.getMaxNum(ct)));r(Ce)?await e(Ce):e(Ce)}if(b){let Ce;switch(K){case"PCB":{Ce=Qf.pcb(p.deviceNames,p.footprintNames,p.deviceAttrs,Ie);break}case"FOOTPRINT":{Ce=Qf.footprint(Ie);break}case"PANEL":{Ce=Qf.panel(Ie);break}case"SYMBOL":{Ce=Qf.symbol(Ie);break}case"SCH_PAGE":case"SIMULATION":{Ce=Qf.sheet(Ie).dataSet;break}default:break}if(Ce!=null&&Ce.fonts)for(let st of Ce.fonts)E.add(st);if(Ce!=null&&Ce.blobs)for(let st of Ce.blobs)w.add(st)}}}compressFull(t={}){if(this.getCache)throw new Error("\u6570\u636E\u5DF2\u7F13\u5B58\u5230 cacheStorage, \u4E0D\u5141\u8BB8\u540C\u6B65\u83B7\u53D6");let e=[],r=i=>{e.push(i)};return this.compress(t,r,()=>!1),e.join(zd)}async chunkCompressFull(t={}){let{chunkLength:e=20*1024*1024}=t,r=new Array,i=[],n=0,s="",a=l=>this.getCache?n+l.length>e:!1,o=async(l,c)=>{n+l.length>e&&(i.push(r.join(zd)),r.length=0,!c&&r.push(s),n=0),c&&(s=l),r.push(l),n+=l.length+zd.length};return await this.compress(t,o,a),r.length>0&&(i.push(r.join(zd)),r.length=0,n=0),this.getCache&&this.delayClear(),i}async asyncCompressFull(t={}){let e=[],r=i=>{e.push(i)};return await this.compress(t,r,()=>!1),this.delayClear(),e.join(zd)}async flowCompressFull(t){let{writer:e,chunkLength:r=1e7}=t,i=new Array,n=0,s=o=>n+o.length>r,a=async o=>{n+o.length>r&&(await e(i.join(zd)),i.length=0,i.push(""),n=0),i.push(o),n+=o.length+zd.length};await this.compress(t,a,s),i.length>0&&(await e(i.join(zd)),i.length=0,n=0),this.delayClear()}removeCache(t){if(t)for(let e=0;e<t.length;e++)this.wDocData.delete(t[e]);else this.wDocData.clear()}setMainDoctype(t){this.mainDocType=t}onChange(t){this.cbArr.push(t)}localChange(t,e,r,i,n){let s=this.getMaxTicket()+1;return this.remoteChange(s,this.getClient(),t,e,r,i,n,!0,void 0,!0,void 0,this.getUnique()),s}safeString(t){return t&&(t in AEe,t)}remoteChange(t,e,r,i,n,s,a,o,l,c,u,d,A,h,f){var C,G,U,_,H;this.setMaxTicket(t),a&&this.setDoctype(r,a),o=o||d===this.getUnique();let p=(_=(U=(G=(C=this.wDocData)==null?void 0:C.get)==null?void 0:G.call(C,r))==null?void 0:U.get(i))==null?void 0:_.last;d&&(this.uniqueIds[d]||(this.uniqueIds[d]={}),this.uniqueIds[d][r]||(this.uniqueIds[d][r]=new Set),this.uniqueIds[d][r].add(i)),this.wDocData.get(r)||this.wDocData.set(r,new Map),this.wDocData.get(r).has(i)||this.wDocData.get(r).set(i,{last:null});let m=this.wDocData.get(r).get(i),y=p?es.getFirstTicket(m):null,g=p&&p.ticket===t&&p.client===e&&!!p.pend!=!!c,b=s!=="ELE_PLACEHOLDER"&&(!o||o&&this.getIsLocalChange())&&(!g||g&&this.getIsPendChange()),E=es.find(m,Q=>Q.client===e&&Q.ticket===t);if(E){f&&(E.hId=f.uuid,E.hNum=f.num,E.start=f.start,f.dNum&&(E.dNum=f.dNum)),this.getCache&&!this.cacheType.includes(s)&&((H=E.data)!=null&&H.length)&&(E!=null&&E.hId)&&delete E.data,E.pend&&!c&&(delete E.pend,b&&E===m.last&&this.cbArr.forEach(Q=>Q(r,i,n,s,e,t,es.getFirstTicket(m),c,void 0,g,d)));return}let w=t;if(c){let Q=[];es.preForEach(m,j=>j.client===e&&j.pend&&j.ticket<t?(Q.push(j),!0):!1),Q.length&&Q.length===es.getLength(m)&&(w=y||t),Q.forEach(j=>{es.remove(m,j)})}let x={client:e,ticket:w,dataType:s};f&&(x.hId=f.uuid,x.hNum=f.num,x.start=f.start,f.dNum&&(x.dNum=f.dNum)),(!this.getCache||!x.hId||!n||this.cacheType.includes(s)||c)&&(x.data=c?n:this.safeString(n)),l!==void 0&&(x.firstTicket=l),c!==void 0&&(x.pend=c),d!==void 0&&(x.unique=d);let I=!p||p.ticket<t||p.ticket===t&&p.client<e;if(es.insert(m,x),this.orderTree.has(r)&&(!p||y>t))try{this.orderTree.setOrderNum(r,this.getDoctype(r),i,m,!0,y&&y>t)}catch(Q){console.error(Q)}if(I){let Q=es.getFirstTicket(m);b&&this.cbArr.forEach(j=>j(r,i,n,s,e,t,Q,c,void 0,g,d))}}};var pEe=class{constructor(t,e=1,r=[]){this.consistencyManager=t,this.startNum=e,this.needOrderType=r,this.initIng=!1,this.allOrderNum={},this.maxNum={},this.consistencyManager.onChange((i,n,s,a,o,l,c,u,d,A,h,f)=>{try{this.onParseLine(n,a,s?JSON.parse(s):null,o,l,u,f)}catch(p){console.error(p)}})}setIsInit(t){this.initIng=t}setNeedNum(t){this.needNum=t}setOrderNum(t,e,r){this.needNum&&this.needOrderType&&this.needOrderType.includes(r)&&e!==void 0&&(this.allOrderNum[t]=e,this.setMaxNum(r,e))}deleteOrderNum(t){delete this.allOrderNum[t]}getOrderNum(t){return this.allOrderNum[t]}setMaxNum(t,e,r){(r||this.maxNum[t]===void 0||this.maxNum[t]<e)&&(this.maxNum[t]=e)}getMaxNum(t){return this.maxNum[t]===void 0&&(this.maxNum[t]=this.startNum-1),++this.maxNum[t]}};var mEe=(t=>(t[t.TRACK=0]="TRACK",t[t.SMDPad=1]="SMDPad",t[t.THPad=2]="THPad",t[t.SMD_Test_Point=3]="SMD_Test_Point",t[t.TH_Test_Point=4]="TH_Test_Point",t[t.VIA=5]="VIA",t[t.REGION=6]="REGION",t[t.PLANE=7]="PLANE",t[t.SLOT=8]="SLOT",t[t.LINE=9]="LINE",t[t.OTHER=10]="OTHER",t[t.SHEETFRAME=11]="SHEETFRAME",t[t.Hole=12]="Hole",t[t.Copper=13]="Copper",t[t.Inner=14]="Inner",t[t.PROHIBITAREA=15]="PROHIBITAREA",t[t.COMPONENT=16]="COMPONENT",t))(mEe||{});var gEe=(t=>(t[t.pro1=1]="pro1",t[t.pro2=1.1]="pro2",t[t.pro3=1.2]="pro3",t[t.pro4=1.3]="pro4",t[t.pro5=1.4]="pro5",t[t.pro6=1.5]="pro6",t[t.pro7=1.6]="pro7",t[t.pro8=1.7]="pro8",t[t.pro9=1.8]="pro9",t[t.pro=1.8]="pro",t))(gEe||{});var yEe=Object.create,wX=Object.defineProperty,bEe=Object.getOwnPropertyDescriptor,xEe=Object.getOwnPropertyNames,EEe=Object.getPrototypeOf,wEe=Object.prototype.hasOwnProperty,vEe=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),CEe=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of xEe(e))!wEe.call(t,n)&&n!==r&&wX(t,n,{get:()=>e[n],enumerable:!(i=bEe(e,n))||i.enumerable});return t},SEe=(t,e,r)=>(r=t!=null?yEe(EEe(t)):{},CEe(e||!t||!t.__esModule?wX(r,"default",{value:t,enumerable:!0}):r,t)),TEe=vEe((t,e)=>{"use strict";e.exports=r,e.exports.default=r;function r(v,N,R){R=R||2;var q=N&&N.length,P=q?N[0]*R:v.length,z=i(v,0,P,R,!0),W=[];if(!z||z.next===z.prev)return W;var oe,Ae,me,ve,Le,He,rt;if(q&&(z=u(v,N,z,R)),v.length>80*R){oe=me=v[0],Ae=ve=v[1];for(var qe=R;qe<P;qe+=R)Le=v[qe],He=v[qe+1],Le<oe&&(oe=Le),He<Ae&&(Ae=He),Le>me&&(me=Le),He>ve&&(ve=He);rt=Math.max(me-oe,ve-Ae),rt=rt!==0?32767/rt:0}return s(z,W,R,oe,Ae,rt,0),W}function i(v,N,R,q,P){var z,W;if(P===M(v,N,R,q)>0)for(z=N;z<R;z+=q)W=j(z,v[z],v[z+1],W);else for(z=R-q;z>=N;z-=q)W=j(z,v[z],v[z+1],W);return W&&x(W,W.next)&&($(W),W=W.next),W}function n(v,N){if(!v)return v;N||(N=v);var R=v,q;do if(q=!1,!R.steiner&&(x(R,R.next)||w(R.prev,R,R.next)===0)){if($(R),R=N=R.prev,R===R.next)break;q=!0}else R=R.next;while(q||R!==N);return N}function s(v,N,R,q,P,z,W){if(v){!W&&z&&p(v,q,P,z);for(var oe=v,Ae,me;v.prev!==v.next;){if(Ae=v.prev,me=v.next,z?o(v,q,P,z):a(v)){N.push(Ae.i/R|0),N.push(v.i/R|0),N.push(me.i/R|0),$(v),v=me.next,oe=me.next;continue}if(v=me,v===oe){W?W===1?(v=l(n(v),N,R),s(v,N,R,q,P,z,2)):W===2&&c(v,N,R,q,P,z):s(n(v),N,R,q,P,z,1);break}}}}function a(v){var N=v.prev,R=v,q=v.next;if(w(N,R,q)>=0)return!1;for(var P=N.x,z=R.x,W=q.x,oe=N.y,Ae=R.y,me=q.y,ve=P<z?P<W?P:W:z<W?z:W,Le=oe<Ae?oe<me?oe:me:Ae<me?Ae:me,He=P>z?P>W?P:W:z>W?z:W,rt=oe>Ae?oe>me?oe:me:Ae>me?Ae:me,qe=q.next;qe!==N;){if(qe.x>=ve&&qe.x<=He&&qe.y>=Le&&qe.y<=rt&&b(P,oe,z,Ae,W,me,qe.x,qe.y)&&w(qe.prev,qe,qe.next)>=0)return!1;qe=qe.next}return!0}function o(v,N,R,q){var P=v.prev,z=v,W=v.next;if(w(P,z,W)>=0)return!1;for(var oe=P.x,Ae=z.x,me=W.x,ve=P.y,Le=z.y,He=W.y,rt=oe<Ae?oe<me?oe:me:Ae<me?Ae:me,qe=ve<Le?ve<He?ve:He:Le<He?Le:He,xt=oe>Ae?oe>me?oe:me:Ae>me?Ae:me,Gt=ve>Le?ve>He?ve:He:Le>He?Le:He,ut=y(rt,qe,N,R,q),Pe=y(xt,Gt,N,R,q),ft=v.prevZ,ht=v.nextZ;ft&&ft.z>=ut&&ht&&ht.z<=Pe;){if(ft.x>=rt&&ft.x<=xt&&ft.y>=qe&&ft.y<=Gt&&ft!==P&&ft!==W&&b(oe,ve,Ae,Le,me,He,ft.x,ft.y)&&w(ft.prev,ft,ft.next)>=0||(ft=ft.prevZ,ht.x>=rt&&ht.x<=xt&&ht.y>=qe&&ht.y<=Gt&&ht!==P&&ht!==W&&b(oe,ve,Ae,Le,me,He,ht.x,ht.y)&&w(ht.prev,ht,ht.next)>=0))return!1;ht=ht.nextZ}for(;ft&&ft.z>=ut;){if(ft.x>=rt&&ft.x<=xt&&ft.y>=qe&&ft.y<=Gt&&ft!==P&&ft!==W&&b(oe,ve,Ae,Le,me,He,ft.x,ft.y)&&w(ft.prev,ft,ft.next)>=0)return!1;ft=ft.prevZ}for(;ht&&ht.z<=Pe;){if(ht.x>=rt&&ht.x<=xt&&ht.y>=qe&&ht.y<=Gt&&ht!==P&&ht!==W&&b(oe,ve,Ae,Le,me,He,ht.x,ht.y)&&w(ht.prev,ht,ht.next)>=0)return!1;ht=ht.nextZ}return!0}function l(v,N,R){var q=v;do{var P=q.prev,z=q.next.next;!x(P,z)&&I(P,q,q.next,z)&&_(P,z)&&_(z,P)&&(N.push(P.i/R|0),N.push(q.i/R|0),N.push(z.i/R|0),$(q),$(q.next),q=v=z),q=q.next}while(q!==v);return n(q)}function c(v,N,R,q,P,z){var W=v;do{for(var oe=W.next.next;oe!==W.prev;){if(W.i!==oe.i&&E(W,oe)){var Ae=Q(W,oe);W=n(W,W.next),Ae=n(Ae,Ae.next),s(W,N,R,q,P,z,0),s(Ae,N,R,q,P,z,0);return}oe=oe.next}W=W.next}while(W!==v)}function u(v,N,R,q){var P=[],z,W,oe,Ae,me;for(z=0,W=N.length;z<W;z++)oe=N[z]*q,Ae=z<W-1?N[z+1]*q:v.length,me=i(v,oe,Ae,q,!1),me===me.next&&(me.steiner=!0),P.push(g(me));for(P.sort(d),z=0;z<P.length;z++)R=A(P[z],R);return R}function d(v,N){return v.x-N.x}function A(v,N){var R=h(v,N);if(!R)return N;var q=Q(R,v);return n(q,q.next),n(R,R.next)}function h(v,N){var R=N,q=v.x,P=v.y,z=-1/0,W;do{if(P<=R.y&&P>=R.next.y&&R.next.y!==R.y){var oe=R.x+(P-R.y)*(R.next.x-R.x)/(R.next.y-R.y);if(oe<=q&&oe>z&&(z=oe,W=R.x<R.next.x?R:R.next,oe===q))return W}R=R.next}while(R!==N);if(!W)return null;var Ae=W,me=W.x,ve=W.y,Le=1/0,He;R=W;do q>=R.x&&R.x>=me&&q!==R.x&&b(P<ve?q:z,P,me,ve,P<ve?z:q,P,R.x,R.y)&&(He=Math.abs(P-R.y)/(q-R.x),_(R,v)&&(He<Le||He===Le&&(R.x>W.x||R.x===W.x&&f(W,R)))&&(W=R,Le=He)),R=R.next;while(R!==Ae);return W}function f(v,N){return w(v.prev,v,N.prev)<0&&w(N.next,v,v.next)<0}function p(v,N,R,q){var P=v;do P.z===0&&(P.z=y(P.x,P.y,N,R,q)),P.prevZ=P.prev,P.nextZ=P.next,P=P.next;while(P!==v);P.prevZ.nextZ=null,P.prevZ=null,m(P)}function m(v){var N,R,q,P,z,W,oe,Ae,me=1;do{for(R=v,v=null,z=null,W=0;R;){for(W++,q=R,oe=0,N=0;N<me&&(oe++,q=q.nextZ,!!q);N++);for(Ae=me;oe>0||Ae>0&&q;)oe!==0&&(Ae===0||!q||R.z<=q.z)?(P=R,R=R.nextZ,oe--):(P=q,q=q.nextZ,Ae--),z?z.nextZ=P:v=P,P.prevZ=z,z=P;R=q}z.nextZ=null,me*=2}while(W>1);return v}function y(v,N,R,q,P){return v=(v-R)*P|0,N=(N-q)*P|0,v=(v|v<<8)&16711935,v=(v|v<<4)&252645135,v=(v|v<<2)&858993459,v=(v|v<<1)&1431655765,N=(N|N<<8)&16711935,N=(N|N<<4)&252645135,N=(N|N<<2)&858993459,N=(N|N<<1)&1431655765,v|N<<1}function g(v){var N=v,R=v;do(N.x<R.x||N.x===R.x&&N.y<R.y)&&(R=N),N=N.next;while(N!==v);return R}function b(v,N,R,q,P,z,W,oe){return(P-W)*(N-oe)>=(v-W)*(z-oe)&&(v-W)*(q-oe)>=(R-W)*(N-oe)&&(R-W)*(z-oe)>=(P-W)*(q-oe)}function E(v,N){return v.next.i!==N.i&&v.prev.i!==N.i&&!U(v,N)&&(_(v,N)&&_(N,v)&&H(v,N)&&(w(v.prev,v,N.prev)||w(v,N.prev,N))||x(v,N)&&w(v.prev,v,v.next)>0&&w(N.prev,N,N.next)>0)}function w(v,N,R){return(N.y-v.y)*(R.x-N.x)-(N.x-v.x)*(R.y-N.y)}function x(v,N){return v.x===N.x&&v.y===N.y}function I(v,N,R,q){var P=G(w(v,N,R)),z=G(w(v,N,q)),W=G(w(R,q,v)),oe=G(w(R,q,N));return!!(P!==z&&W!==oe||P===0&&C(v,R,N)||z===0&&C(v,q,N)||W===0&&C(R,v,q)||oe===0&&C(R,N,q))}function C(v,N,R){return N.x<=Math.max(v.x,R.x)&&N.x>=Math.min(v.x,R.x)&&N.y<=Math.max(v.y,R.y)&&N.y>=Math.min(v.y,R.y)}function G(v){return v>0?1:v<0?-1:0}function U(v,N){var R=v;do{if(R.i!==v.i&&R.next.i!==v.i&&R.i!==N.i&&R.next.i!==N.i&&I(R,R.next,v,N))return!0;R=R.next}while(R!==v);return!1}function _(v,N){return w(v.prev,v,v.next)<0?w(v,N,v.next)>=0&&w(v,v.prev,N)>=0:w(v,N,v.prev)<0||w(v,v.next,N)<0}function H(v,N){var R=v,q=!1,P=(v.x+N.x)/2,z=(v.y+N.y)/2;do R.y>z!=R.next.y>z&&R.next.y!==R.y&&P<(R.next.x-R.x)*(z-R.y)/(R.next.y-R.y)+R.x&&(q=!q),R=R.next;while(R!==v);return q}function Q(v,N){var R=new B(v.i,v.x,v.y),q=new B(N.i,N.x,N.y),P=v.next,z=N.prev;return v.next=N,N.prev=v,R.next=P,P.prev=R,q.next=R,R.prev=q,z.next=q,q.prev=z,q}function j(v,N,R,q){var P=new B(v,N,R);return q?(P.next=q.next,P.prev=q,q.next.prev=P,q.next=P):(P.prev=P,P.next=P),P}function $(v){v.next.prev=v.prev,v.prev.next=v.next,v.prevZ&&(v.prevZ.nextZ=v.nextZ),v.nextZ&&(v.nextZ.prevZ=v.prevZ)}function B(v,N,R){this.i=v,this.x=N,this.y=R,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}r.deviation=function(v,N,R,q){var P=N&&N.length,z=P?N[0]*R:v.length,W=Math.abs(M(v,0,z,R));if(P)for(var oe=0,Ae=N.length;oe<Ae;oe++){var me=N[oe]*R,ve=oe<Ae-1?N[oe+1]*R:v.length;W-=Math.abs(M(v,me,ve,R))}var Le=0;for(oe=0;oe<q.length;oe+=3){var He=q[oe]*R,rt=q[oe+1]*R,qe=q[oe+2]*R;Le+=Math.abs((v[He]-v[qe])*(v[rt+1]-v[He+1])-(v[He]-v[rt])*(v[qe+1]-v[He+1]))}return W===0&&Le===0?0:Math.abs((Le-W)/W)};function M(v,N,R,q){for(var P=0,z=N,W=R-q;z<R;z+=q)P+=(v[W]-v[z])*(v[z+1]+v[W+1]),W=z;return P}r.flatten=function(v){for(var N=v[0][0].length,R={vertices:[],holes:[],dimensions:N},q=0,P=0;P<v.length;P++){for(var z=0;z<v[P].length;z++)for(var W=0;W<N;W++)R.vertices.push(v[P][z][W]);P>0&&(q+=v[P-1].length,R.holes.push(q))}return R}}),IEe=(t=>(t[t.MIL=1]="MIL",t[t.INCH=1e3]="INCH",t[t.FT=12e3]="FT",t[t.YARD=36e3]="YARD",t[t.MILE=6336e4]="MILE",t[t.KM=3937007874e-2]="KM",t[t.M=39370]="M",t[t.DM=3937]="DM",t[t.CM=393.7]="CM",t[t.MM=39.37]="MM",t[t.UM=.039]="UM",t[t.NM=394e-7]="NM",t[t.PT=13.88888888888889]="PT",t[t.PX72=13.88888888888889]="PX72",t[t.PX96=10.416666666666666]="PX96",t[t.PX100=10]="PX100",t[t.LTSPICE=6.25]="LTSPICE",t[t.PX1=.1]="PX1",t[t.PX001=.001]="PX001",t))(IEe||{}),BEe=(t=>(t.MIL="mil",t.INCH="inch",t.FT="ft",t.YARD="yard",t.MILE="mile",t.KM="km",t.M="m",t.DM="dm",t.CM="cm",t.MM="mm",t.UM="um",t.NM="nm",t.PT="pt",t.PX72="px(72)",t.PX96="px(96)",t.PX100="px(100)",t))(BEe||{}),Oz={mil:1,inch:1e3,ft:12e3,yard:36e3,mile:6336e4,km:3937007874e-2,dm:3937,mm:39.37,um:.039,nm:394e-7,pt:13.88888888888889,"px(72)":13.88888888888889,"px(96)":10.416666666666666,"px(100)":10},k9e=(()=>{let t={};for(let e in Oz)t[Oz[e]]=e;return t})();var q1,F9e=(q1=class{constructor(e,r){this.ratio=e/r}wrap(e){return e*this.ratio}static convert(e,r,i){return e*r/i}},q1.ASIS=new q1(1,1),q1),B_=class{conversion(t,e,r){if(t===e)return r;let i=t+2+e;return this[i](r)}conversion1(t,e,r){let i=t+2+e,n=this[i](r);return e=="mil"?Math.round(n*10)/10:Math.round(n*1e3)/1e3}mil2mil(t){return t}mil2mm(t){return t*.0254}mil2cm(t){return t*.00254}mil2inch(t){return t/1e3}mm2mm(t){return t}mm2mil(t){let e=Math.pow(10,5);return Math.round(t*39.37007874015748*e)/e}mm2cm(t){return t/10}mm2inch(t){let e=Math.pow(10,8);return Math.round(t*.03937007874015748*e)/e}cm2mil(t){let e=Math.pow(10,6);return Math.round(t*393.7007874015748*e)/e}cm2mm(t){return t*10}cm2inch(t){let e=Math.pow(10,7);return Math.round(t*.3937007874015748*e)/e}inch2mil(t){return t*1e3}inch2mm(t){return t*25.4}inch2cm(t){return t*2.54}};B_.prototype["px(100)2mil"]=t=>t*10,B_.prototype["px(100)2mm"]=t=>t*.254,B_.prototype["mil2px(100)"]=t=>t/10,B_.prototype["mm2px(100)"]=t=>{let e=Math.pow(10,5);return Math.round(t*3.937007874015748*e)/e};var D_=null,y6=new ArrayBuffer(8),FM=new Float64Array(y6),UM=new Uint32Array(y6),Nz=new Uint16Array(y6);var Rz=class{static repeat(t,e){let r=new Array(e);for(;e-- >0;)r[e]=t;return r.join("")}static lpad(t,e,r){let i=r-t.length;return i>0?this.repeat(e,i)+t:t}static rpad(t,e,r){let i=r-t.length;return i>0?t+this.repeat(e,i):t}static strHashcode(t){if(t.length>0){let e=0;for(let r=0;r<t.length;r++)e=31*e+t.charCodeAt(r)|0;return e}else return 0}static arraycopy(t,e,r,i,n){if(t.length>=e+n&&r.length>=i+n)for(;n-- >0;)r[i++]=t[e++];else throw new Error("arraycopy out of range")}static undefAsNull(t){return null}static reverse(t,e){for(let r=0,i=t.length-1;i>=0;r++,i--)e[r]=t[i];return e}static sortAsc(t,e){return t-e}static xmlDecode(t){let e=t.length,r=new Array,i=-1;for(let n=0;n<e;n++){let s=t.charAt(n);if(i>=0){if(s===";"){let a=t.substring(i+1,n);switch(a){case"lt":r.push("<");break;case"gt":r.push(">");break;case"quot":r.push('"');break;case"apos":r.push("'");break;case"amp":r.push("&");break;default:if(a.charAt(0)==="#"){let o=parseInt(a.substring(1));r.push(String.fromCharCode(o))}else r.push("&"+a+";")}i=-1}}else s==="&"?i=n:r.push(s)}return i>=0&&r.push(t.substring(i)),r.join("")}static addAll(t,e){for(let r of e)t.push(r)}static addAllSet(t,e){for(let r of e)t.add(r)}static contains(t,e){for(let r of t)if(r.equals(e))return!0;return!1}static equals(t,e){if(t.length==e.length){for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}else return!1}static remove(t,e){let r=0,i=t.length;for(let n=0;n<i;n++)t[n]===e&&(t.splice(n,1),n--,i--,r++);return r}static getUrlVars(){for(var t={},e=location.href.slice(location.href.indexOf("?")+1).split("&"),r=0;r<e.length;r++){var i=e[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}static prefix(){if(!D_){let t=this.getUrlVars().version;t?D_="/analyzer/v"+t:D_="/analyzer"}return D_}static add2objS(t,e,r){if(e in t)return t[e];{let i=r(e);return t[e]=i,i}}static downloadFile(t,e){let r=document.createElement("a"),i=URL.createObjectURL(e);r.download=t,r.href=i,r.click(),URL.revokeObjectURL(i)}static uuid(){let t=new Array;FM[0]=new Date().getTime(),t.push(UM[1].toString(16)),FM[0]=Math.random(),t.push(Nz[3].toString(16));let e=Nz[2].toString(16);t.push("4"+e.substr(0,3)),FM[0]=performance.now();let r=UM[0].toString(16)+UM[1].toString(16);return t.push("0"+r.substr(0,3)),t.push(r.substr(3)),t.join("-")}static funcCopy(t){return(0,eval)("("+t.toString()+")")}static NVL(...t){for(let e of t)if(e!==null)return e;return null}static isSingle(t){return Array.from(new Set(t)).length===t.length}};var vX=class{static rgb(t){if(0<=t&&t<=255)return t;throw new Error(H2.format("RGB should not nagative and not over 255(0xFF): %X",t))}static normal(t){if(isFinite(t))return t;throw new Error(H2.format("%f is not permitted",t))}static positiveOr0(t){if(t>=0)return t;throw new Error(H2.format("%f must >= 0",t))}static positive(t){if(t>0)return t;throw new Error(H2.format("%f must > 0",t))}static notnull(t){if(t!=null)return t;throw new Error("invalid null value")}static mustnull(t){if(t===null)return null;throw new Error("value must be null")}static notEmpty(t){if(t==null||t.length===0)throw new Error("invalid empty string");return t}static nullOrEmpty(t){return t==null||t.length===0}static notNullOrUndef(t){if(t!=null)return t;throw new Error("null or undefined is not permitted")}},DEe=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.PERCENT=1]="PERCENT",t[t.LEFT_PAD0=2]="LEFT_PAD0",t))(DEe||{}),_Ee=/(\.?0+)$/,H2=class{static format(t,...e){return this.format1(t,e)}static format1(t,e){let r=this._format(t,e);if(typeof r=="string")return r;throw new Error(this.format("Invalid state on (%d) %s",r,t))}static _format(t,e){let r=[],i=0,n=0,s,a=0,o=0;for(let l=0;l<t.length;l++){let c=t.charAt(l),u=c.charCodeAt(0);switch(i){case 0:u===37?i=1:r.push(c);break;case 1:switch(u){case 100:if(s=e[n++],typeof s=="number")r.push(s.toFixed(0)),i=0;else return l;break;case 102:if(s=e[n++],typeof s=="number")r.push(s.toString()),i=0;else return l;break;case 120:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16)),i=0;else return l;break;case 88:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16).toUpperCase()),i=0;else return l;break;case 115:case 99:s=e[n++],r.push(s===null?"null":s.toString()),i=0;break;case 48:a=l+1,o=-1,i=2;break;case 37:r.push("%"),i=0;break;default:return l}break;case 2:switch(u){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=l;break;case 120:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(Rz.lpad((s|0).toString(16),"0",d)),i=0;else return l}else return l;break;case 88:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(Rz.lpad((s|0).toString(16).toUpperCase(),"0",d)),i=0;else return l}else return l;break;default:return l}break;default:return l}}return r.join("")}static startsWith(t,e){return t.length>=e.length?t.substring(0,e.length)===e:!1}static endsWith(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}static split(t,e){let r=new Array,i=0;for(;;){let n=t.exec(e);if(n!==null){let s=t.lastIndex-n[0].length;r.push(e.substring(i,s)),i=t.lastIndex}else{let s=e.substring(i);vX.nullOrEmpty(s)||r.push(s);break}}return r}static fmtNumber(t){return t.toFixed(5).replace(_Ee,"")}},PEe=(t=>(t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARNING=2]="WARNING",t[t.ERROR=3]="ERROR",t[t.DUMMY=4]="DUMMY",t))(PEe||{});function LEe(t){switch(t){case 0:return"DEBUG";case 1:return"INFO";case 2:return"WARNING";case 3:return"ERROR";case 4:return"DUMMY"}}var OEe=(t,e)=>{t===3?console.error(e):console.log(e)},NEe=(t,e)=>H2.format("%s %s: %s",new Date,LEe(t),e),Cg,cP=(Cg=class{constructor(e,r=OEe,i=NEe){this.debug=!1,this.level=e,this.writer=r,this.fmt=i}static mix(...e){let r=4;for(let i of e)i.level<r&&(r=i.level);return new Cg(r,(i,n)=>{for(let s of e)s.write1(i,n)},(i,n)=>n)}wrap(e=null,r=null){let i=e===null?this.fmt:(s,a)=>(a=e(s,a),this.fmt(s,a)),n=r===null?this.writer:(s,a)=>{r(s,a),this.writer(s,a)};return new Cg(this.level,n,i)}chain(e){return e.wrap(this.fmt.bind(this),this.writer.bind(this))}include(e){return this.level<=e}write3(e,r,i){this.include(e)&&this.writer(e,this.fmt(e,H2.format(r,...i)))}write2(e,r){this.include(e)&&(r instanceof Error?this.writer(e,this.fmt(e,r.stack)):this.writer(e,this.fmt(e,r.toString())))}write1(e,r){this.include(e)&&this.writer(e,this.fmt(e,r))}debug3(e,...r){this.write3(0,e,r)}debug2(e){this.write2(0,e)}debug1(e){this.write1(0,e)}info3(e,...r){this.write3(1,e,r)}info2(e){this.write2(1,e)}info1(e){this.write1(1,e)}warning3(e,...r){this.write3(2,e,r)}warning2(e){this.write2(2,e)}warning1(e){this.write1(2,e)}error3(e,...r){this.write3(3,e,r)}error2(e){this.write2(3,e)}error1(e){this.write1(3,e)}},Cg.DUMMY=new Cg(4),Cg),b6=new ArrayBuffer(8),HM=new Float64Array(b6),GM=new Uint32Array(b6),Mz=new Uint16Array(b6),kz=ArrayBuffer;try{kz=self.HTMLImageElement||kz}catch{}var __=null;function K1(t,e,r=0,i=t.length){n(t,null,e,r,i);function n(a,o,l,c,u){let d,A,h,f;if(c<u-1){let p=u-c;if(p>50)o===null&&(o=new Array(p+1)),s(a,o,l,c,(c+u)/2|0,u);else{d=a[c],A=c,h=c,f=u;let m=A+1;for(;m<f;){if(h!=f){if(f=f+-1,l(d,a[f])<=0)continue;a[h]=a[f],h=f;continue}if(l(d,a[m])>=0){A=m,m=A+1;continue}a[h]=a[m],A=m,h=m,m=A+1}a[h]=d,n(a,o,l,c,h),n(a,o,l,h+1,u)}}}function s(a,o,l,c,u,d){n(a,o,l,c,u),n(a,o,l,u,d);for(var A=c,h=u,f=0,p=a[A],m=a[h];A<u&&h<d;){var y=l(p,m);isNaN(y)?(o[f++]=m,m=a[++h]):(y<=0&&(o[f++]=p,p=a[++A]),y>=0&&(o[f++]=m,m=a[++h]))}for(;A<u;A++)o[f++]=a[A];for(;h<d;h++)o[f++]=a[h];for(A=c,h=0;h<f;A++,h++)a[A]=o[h]}}var du=class{static repeat(t,e){let r=new Array(e);for(;e-- >0;)r[e]=t;return r.join("")}static lpad(t,e,r){let i=r-t.length;return i>0?this.repeat(e,i)+t:t}static rpad(t,e,r){let i=r-t.length;return i>0?t+this.repeat(e,i):t}static strHashcode(t){if(t.length>0){let e=0;for(let r=0;r<t.length;r++)e=31*e+t.charCodeAt(r)|0;return e}else return 0}static arraycopy(t,e,r,i,n){if(t.length>=e+n&&r.length>=i+n)for(;n-- >0;)r[i++]=t[e++];else throw new Error("arraycopy out of range")}static undefAsNull(t){return null}static reverse(t,e){for(let r=0,i=t.length-1;i>=0;r++,i--)e[r]=t[i];return e}static sortAsc(t,e){return t-e}static xmlDecode(t){let e=t.length,r=new Array,i=-1;for(let n=0;n<e;n++){let s=t.charAt(n);if(i>=0){if(s===";"){let a=t.substring(i+1,n);switch(a){case"lt":r.push("<");break;case"gt":r.push(">");break;case"quot":r.push('"');break;case"apos":r.push("'");break;case"amp":r.push("&");break;default:if(a.charAt(0)==="#"){let o=parseInt(a.substring(1));r.push(String.fromCharCode(o))}else r.push("&"+a+";")}i=-1}}else s==="&"?i=n:r.push(s)}return i>=0&&r.push(t.substring(i)),r.join("")}static addAll(t,e){for(let r of e)t.push(r)}static addAllSet(t,e){for(let r of e)t.add(r)}static contains(t,e){for(let r of t)if(r.equals(e))return!0;return!1}static equals(t,e){if(t.length==e.length){for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}else return!1}static remove(t,e){let r=0,i=t.length;for(let n=0;n<i;n++)t[n]===e&&(t.splice(n,1),n--,i--,r++);return r}static getUrlVars(){for(var t={},e=location.href.slice(location.href.indexOf("?")+1).split("&"),r=0;r<e.length;r++){var i=e[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}static prefix(){if(!__){let t=this.getUrlVars().version;t?__="/analyzer/v"+t:__="/analyzer"}return __}static add2objS(t,e,r){if(e in t)return t[e];{let i=r(e);return t[e]=i,i}}static downloadFile(t,e){let r=document.createElement("a"),i=URL.createObjectURL(e);r.download=t,r.href=i,r.click(),URL.revokeObjectURL(i)}static uuid(){let t=new Array;HM[0]=new Date().getTime(),t.push(GM[1].toString(16)),HM[0]=Math.random(),t.push(Mz[3].toString(16));let e=Mz[2].toString(16);t.push("4"+e.substr(0,3)),HM[0]=performance.now();let r=GM[0].toString(16)+GM[1].toString(16);return t.push("0"+r.substr(0,3)),t.push(r.substr(3)),t.join("-")}static funcCopy(t){return(0,eval)("("+t.toString()+")")}static NVL(...t){for(let e of t)if(e!==null)return e;return null}static isSingle(t){return Array.from(new Set(t)).length===t.length}},REe=[1,10,100,1e3];var P_=0,Y1=0;function Fz(t,e,r){return P_=Math.abs(t-e),r>=5&&P_>1e-5||isNaN(r)&&P_>1e-8?!1:P_<1e-13?!0:(Y1=Math.min(Uz(t),Uz(e)),Y1<10&&(Y1=10),isNaN(r)||(Y1=Math.min(Y1,r)),Hz(t,Y1)===Hz(e,Y1))}var L_=0,O_=0;function Uz(t){return L_=0,O_=0,t>0?L_=t-Math.floor(t):L_=t-Math.ceil(t),O_=(L_.toString()||"").length,O_>2?O_-2:0}function Hz(t,e,r){if(typeof t!="number"&&(t=+t),isNaN(t))return NaN;if(e=e|0,e<=0||!t&&!r)return Math.round(t);var i=REe[e]||Math.pow(10,e)||10;if(r){var n=t<0?"-":"";for(t=t<0?-t:t,t=Math.round(t*i)+"";t.length<=e;)t="0"+t;return t=t.slice(0,-e)+"."+t.slice(-e),parseFloat(n+t)}else return Math.round(t*i+1e-10)/i}var MEe=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.PERCENT=1]="PERCENT",t[t.LEFT_PAD0=2]="LEFT_PAD0",t))(MEe||{}),kEe=/(\.?0+)$/,G2=class{static format(t,...e){return this.format1(t,e)}static format1(t,e){let r=this._format(t,e);if(typeof r=="string")return r;throw new Error(this.format("Invalid state on (%d) %s",r,t))}static _format(t,e){let r=[],i=0,n=0,s,a=0,o=0;for(let l=0;l<t.length;l++){let c=t.charAt(l),u=c.charCodeAt(0);switch(i){case 0:u===37?i=1:r.push(c);break;case 1:switch(u){case 100:if(s=e[n++],typeof s=="number")r.push(s.toFixed(0)),i=0;else return l;break;case 102:if(s=e[n++],typeof s=="number")r.push(s.toString()),i=0;else return l;break;case 120:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16)),i=0;else return l;break;case 88:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16).toUpperCase()),i=0;else return l;break;case 115:case 99:s=e[n++],r.push(s===null?"null":s.toString()),i=0;break;case 48:a=l+1,o=-1,i=2;break;case 37:r.push("%"),i=0;break;default:return l}break;case 2:switch(u){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=l;break;case 120:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(du.lpad((s|0).toString(16),"0",d)),i=0;else return l}else return l;break;case 88:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(du.lpad((s|0).toString(16).toUpperCase(),"0",d)),i=0;else return l}else return l;break;default:return l}break;default:return l}}return r.join("")}static startsWith(t,e){return t.length>=e.length?t.substring(0,e.length)===e:!1}static endsWith(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}static split(t,e){let r=new Array,i=0;for(;;){let n=t.exec(e);if(n!==null){let s=t.lastIndex-n[0].length;r.push(e.substring(i,s)),i=t.lastIndex}else{let s=e.substring(i);Sa.nullOrEmpty(s)||r.push(s);break}}return r}static fmtNumber(t){return t.toFixed(5).replace(kEe,"")}},Sa=class{static rgb(t){if(0<=t&&t<=255)return t;throw new Error(G2.format("RGB should not nagative and not over 255(0xFF): %X",t))}static normal(t){if(isFinite(t))return t;throw new Error(G2.format("%f is not permitted",t))}static positiveOr0(t){if(t>=0)return t;throw new Error(G2.format("%f must >= 0",t))}static positive(t){if(t>0)return t;throw new Error(G2.format("%f must > 0",t))}static notnull(t){if(t!=null)return t;throw new Error("invalid null value")}static mustnull(t){if(t===null)return null;throw new Error("value must be null")}static notEmpty(t){if(t==null||t.length===0)throw new Error("invalid empty string");return t}static nullOrEmpty(t){return t==null||t.length===0}static notNullOrUndef(t){if(t!=null)return t;throw new Error("null or undefined is not permitted")}},W1,Ct=(W1=class{static regular(e){return Math.round(e*this.precision)/this.precision}static eq(e,r){return Math.abs(e-r)<=this.eps}static neq(e,r){return Math.abs(e-r)>this.eps}static less(e,r){return e-r<-this.eps}static lesseq(e,r){return e-r<=this.eps}static greater(e,r){return e-r>this.eps}static greatereq(e,r){return e-r>=-this.eps}static sqrt(e){return Math.abs(e)<=1e-10?0:Math.sqrt(e)}static sortAsc(e,r){return e-r}static sortDesc(e,r){return r-e}},W1.eps=1e-8,W1.precision=1e8,W1);function V2(t,e){$_(t.iterator(),e)}function $_(t,e){let r=0;for(;t.hasNext();){let i=t.next();e(r++,i)}}var FEe=class{constructor(t){this.idx=-1,this.lst=t}hasNext(){return this.idx<this.lst.length-1}next(){if(this.idx<this.lst.length-1)return this.idx++,this.lst[this.idx];throw new Error("bug")}};function r6(t){return new FEe(t)}var jl,Bi=(jl=class{static toDegrees(e){return e*180/Math.PI}static toRadians(e){return e/180*Math.PI}static regularD(e){return e=e%360,e=e<0?360+e:e,e===360?0:e}static regular(e){return e=e%jl.PIx2,e=e<0?jl.PIx2+e:e,e===jl.PIx2?0:e}static toQuarterBase(e){return jl.regular((e+jl.PI_4)/jl.PI_2*jl.PI_2)}static toQuarterBaseD(e){return jl.regularD(((e+45)/90|0)*90)}static transformD(e,r){return jl.toDegrees(jl.transform(jl.toRadians(e),r))}static transform(e,r){let i=Math.cos(e),n=Math.sin(e),s=new nt(r.data[6],r.data[7]),a=new nt(i,n).multiply3(r);return jl.regular(a.angle(s))}},jl.PIx2=Math.PI*2,jl.PI_2=Math.PI/2,jl.PI_4=Math.PI/4,jl),oo=class{static dotProd1(t,e,r,i){return t*r+e*i}static dotProd2(t,e,r,i,n,s){return this.dotProd1(r-t,i-e,n-r,s-i)}static dotProd3(t,e,r){return this.dotProd2(t.x,t.y,e.x,e.y,r.x,r.y)}static crossProd1(t,e,r,i){return t*i-e*r}static crossProd2(t,e,r,i,n,s){return this.crossProd1(r-t,i-e,n-r,s-i)}static crossProd3(t,e,r){return this.crossProd2(t.x,t.y,e.x,e.y,r.x,r.y)}static distance2(t,e,r,i){let n=r-t,s=i-e;return n*n+s*s}static distance1(t,e,r,i){return this.hypot(r-t,i-e)}static distance1p(t,e){return this.distance1(t.x,t.y,e.x,e.y)}static hypot(t,e){if(t=Math.abs(t),e=Math.abs(e),e>t){var r=e;e=t,t=r}if(t===0)return e;var i=e/t;return t*Math.sqrt(1+i*i)}},CX=new ArrayBuffer(16),Gz=new Float64Array(CX),N_=new Int32Array(CX),Un,nt=(Un=class{static sortByXAsc(e,r){return e.x-r.x}static sortByYAsc(e,r){return e.y-r.y}static sortByXYAsc(e,r){return e.x<r.x?-1:e.x>r.x?1:e.y-r.y}static caculateAngle(e,r){let i=Math.cos(e),n=Math.sin(e),s=i*r.data[0]+n*r.data[4],a=i*r.data[1]+n*r.data[5],o=new Un(s,a).normalize();return Math.atan2(o.y,o.x)}static normal(e,r,i){let n=r.sub(e),s=i.sub(r);return n.cross(s)}static getVector2(e){return new Un(Math.cos(e),Math.sin(e))}static getCrossPoint1(e,r,i,n){if(e.equals1(r)||i.equals1(n)||Ct.eq(1,Math.abs(r.sub(e).normalize().dot(n.sub(i).normalize()))))return null;let s=r.y-e.y,a=e.x-r.x,o=r.x*e.y-e.x*r.y,l=n.y-i.y,c=i.x-n.x,u=n.x*i.y-i.x*n.y,d=s*c-l*a;return new Un((u*a-o*c)/d,(o*l-u*s)/d)}static getCrossPoint2(e,r,i,n){return this.getCrossPoint1(e,e.add(r),i,i.add(n))}constructor(e,r){this.x=Sa.normal(e),this.y=Sa.normal(r)}get hashed(){return this._hashed==null&&(Gz[0]=this.x,Gz[1]=this.y,this._hashed=N_[0]^N_[1]^N_[2]^N_[3]),this._hashed}dot(e){return this.x*e.x+this.y*e.y}length(){return Math.sqrt(this.dot(this))}getCos(){return this.x/this.length()}sub(e){var r=this.x-e.x,i=this.y-e.y;return new Un(r,i)}add(e){var r=this.x+e.x,i=this.y+e.y;return new Un(r,i)}div(e){return new Un(this.x/e,this.y/e)}add1(e,r){return new Un(this.x+e,this.y+r)}mul(e){return new Un(this.x*e,this.y*e)}cross(e){return this.x*e.y-this.y*e.x}getSin(){return this.y/this.length()}angle2(e){let r=this.y-e.y,i=this.x-e.x;return r=Math.abs(r-0)<10**-4?0:r,i=Math.abs(i-0)<10**-4?0:i,Math.atan2(r,i)}angleD2(e){return Bi.toDegrees(this.angle2(e))}angle(e){return Math.atan2(this.y-e.y,this.x-e.x)}angleX(e=Un.ORIGIN){let r=this.angle(e);return r<0&&(r=Math.PI*2+r),r}angleD(e){return Bi.toDegrees(this.angle(e))}distance1(e){let r=e.x-this.x,i=e.y-this.y;return oo.hypot(r,i)}distance2(e){let r=e.x-this.x,i=e.y-this.y;return r*r+i*i}rotateD(e,r){return this.rotate(e,Bi.toRadians(r))}rotate(e,r){let i=Math.cos(r),n=Math.sin(r),s=this.x-e.x,a=this.y-e.y,o=s*i+a*-n,l=s*n+a*i;return e.add1(o,l)}multiply3(e){let r=this.x*e.data[0]+this.y*e.data[3]+e.data[6],i=this.x*e.data[1]+this.y*e.data[4]+e.data[7];return new Un(r,i)}multiply4(e){let r=this.x*e.data[0]+this.y*e.data[4]+e.data[12],i=this.x*e.data[1]+this.y*e.data[5]+e.data[13];return new Un(r,i)}hashCode(){return this.hashed}equals(e,r){return e instanceof Un?Fz(e.x,this.x,r)&&Fz(e.y,this.y,r):!1}equals1(e){return e?Ct.eq(this.x,e.x)&&Ct.eq(this.y,e.y):!1}equals2(e,r){return e instanceof Un?Math.abs(this.x-e.x)<=r&&Math.abs(this.y-e.y)<=r:!1}similarEquals(e,r=.5){return Math.abs(this.x*.1-e.x*.1)<=r&&Math.abs(this.y*.1-e.y*.1)<=r}toString(){return"Vector [X="+this.x+", Y="+this.y+"]"}bbox(){let e=this.x,r=this.y;return new hu(e,e,r,r)}normalize(){if(this.x===0&&this.y===0)return new Un(0,0);let e=this.x/this.length(),r=this.y/this.length();return new Un(e,r)}regular(e=1e-4){let r=Math.round(1/e);return new Un(Math.round(this.x*r)/r,Math.round(this.y*r)/r)}round(e=4){let r=10**(e|0);return new Un(Math.round(this.x*r)/r,Math.round(this.y*r)/r)}mirrorX(e=Un.ORIGIN){return new Un(this.x,2*e.y-this.y)}mirrorY(e=Un.ORIGIN){return new Un(2*e.x-this.x,this.y)}mirrorCenter(e=Un.ORIGIN){return new Un(2*e.x-this.x,2*e.y-this.y)}clone(){return new Un(this.x,this.y)}mirror(e=Un.ORIGIN){return new Un(2*e.x-this.x,2*e.y-this.y)}pointOnRays(e,r){let i=Bi.toRadians(e);return new Un(this.x+Math.cos(i)*r,this.y+Math.sin(i)*r)}pointOnRays2(e,r){let i=e.angle(this);return new Un(this.x+Math.cos(i)*r,this.y+Math.sin(i)*r)}scale(e){return new Un(this.x*e,this.y*e)}},Un.ORIGIN=new Un(0,0),Un.X_UNIT_VECTOR=new Un(1,0),Un.Y_UNIT_VECTOR=new Un(0,1),Un),UEe=(t=>(t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT",t))(UEe||{}),HEe=(t=>(t[t.TOP=0]="TOP",t[t.CENTER=1]="CENTER",t[t.BOTTOM=2]="BOTTOM",t))(HEe||{}),Mo,yg=(Mo=class{constructor(e,r){this.horizontal=e,this.vertical=r}},Mo.LT=new Mo(0,0),Mo.LC=new Mo(0,1),Mo.LB=new Mo(0,2),Mo.CT=new Mo(1,0),Mo.CC=new Mo(1,1),Mo.CB=new Mo(1,2),Mo.RT=new Mo(2,0),Mo.RC=new Mo(2,1),Mo.RB=new Mo(2,2),Mo),GEe=(t=>(t[t.INNER=0]="INNER",t[t.OUTER=1]="OUTER",t[t.SEPARATED=2]="SEPARATED",t[t.INTERSECTED=3]="INTERSECTED",t[t.EQ=4]="EQ",t[t.INSIDE_TOUCHED=5]="INSIDE_TOUCHED",t[t.OUTSIDE_TOUCHED=6]="OUTSIDE_TOUCHED",t))(GEe||{}),od=class{constructor(){this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY}ext1(t){return this.minX=Math.min(this.minX,t.minX),this.maxX=Math.max(this.maxX,t.maxX),this.minY=Math.min(this.minY,t.minY),this.maxY=Math.max(this.maxY,t.maxY),this}ext2(t){return this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y),this}ext3(t){for(let e=0;e<t.length;e++){let r=t[e];this.ext2(r)}return this}ext4(t){return V2(t,(e,r)=>(this.ext2(r),!0)),this}ext5(t,e,r,i){return this.minX=Math.min(this.minX,t),this.maxX=Math.max(this.maxX,e),this.minY=Math.min(this.minY,r),this.maxY=Math.max(this.maxY,i),this}ext6(t,e){return this.minX=Math.min(this.minX,t),this.maxX=Math.max(this.maxX,t),this.minY=Math.min(this.minY,e),this.maxY=Math.max(this.maxY,e),this}ext7(t){if(t<0){let e=t*2;if(e<this.minX-this.maxX||e<this.minY-this.maxY)throw new Error("")}return this.minX-=t,this.maxX+=t,this.minY-=t,this.maxY+=t,this}ext8(t){let e=[];for(let r=0;r<t.length;r+=2)e.push(new nt(t[r],t[r+1]));return this.ext3(e)}ext9(t,e,r,i){return this.minX=Math.min(this.minX,t),this.maxX=Math.max(this.maxX,t+r),this.minY=Math.min(this.minY,e),this.maxY=Math.max(this.maxY,e+i),this}ext10({x:t,y:e,width:r,height:i}){return this.ext9(t,e,r,i)}valid(){return isFinite(this.minX)&&isFinite(this.maxX)&&isFinite(this.minY)&&isFinite(this.maxY)}clear(){this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY}build(){return new hu(this.minX,this.maxX,this.minY,this.maxY)}build1(){return this.valid()?new hu(this.minX,this.maxX,this.minY,this.maxY):new hu(0,0,0,0)}},YC=new Float64Array(4),hu=class GA{static extendRect({x:e,y:r,width:i,height:n}){return new GA(e,e+i,r,r+n)}static extend1(e,r){if(e===null)return new GA(r.x,r.x,r.y,r.y);{let i=Math.min(e.minX,r.x),n=Math.max(e.maxX,r.x),s=Math.min(e.minY,r.y),a=Math.max(e.maxY,r.y);return new GA(i,n,s,a)}}static extend2(e,r){if(e){let i=Math.min(e.minX,r.minX),n=Math.max(e.maxX,r.maxX),s=Math.min(e.minY,r.minY),a=Math.max(e.maxY,r.maxY);return new GA(i,n,s,a)}else return r}static extend3(e,r){let i=Math.min(e.x,r.x),n=Math.max(e.x,r.x),s=Math.min(e.y,r.y),a=Math.max(e.y,r.y);return new GA(i,n,s,a)}static extend4(e,r,i){return new GA(e.x-r/2,e.x+r/2,e.y-i/2,e.y+i/2)}constructor(e,r,i,n){if(this.minX=Sa.normal(e),this.maxX=Sa.normal(r),this.minY=Sa.normal(i),this.maxY=Sa.normal(n),e>r||i>n)throw new Error(`min > max is not permitted: [${e}, ${r}, ${i}, ${n}]`)}get data(){return YC[0]=this.minX,YC[1]=this.maxX,YC[2]=this.minY,YC[3]=this.maxY,YC}isContains(e){return this.isContains1(e.x,e.y)}points(){return[this.LL(),this.LR(),this.UR(),this.UL(),this.LL()]}isContains1(e,r){return this.isContainsX(e)&&this.isContainsY(r)}isContains2(e,r){return this.isContainsX1(e)&&this.isContainsY1(r)}isContainsX(e){return e>=this.minX&&e<=this.maxX}isContainsX1(e){return Ct.greatereq(e,this.minX)&&Ct.lesseq(e,this.maxX)}isContainsY(e){return e>=this.minY&&e<=this.maxY}isContainsY1(e){return Ct.greatereq(e,this.minY)&&Ct.lesseq(e,this.maxY)}isIntersect(e){return!(this.maxX<e.minX||this.minX>e.maxX||this.maxY<e.minY||this.minY>e.maxY)}extendOfSize(e){return Sa.positiveOr0(this.maxX-this.minX+e*2),Sa.positiveOr0(this.maxY-this.minY+e*2),new GA(this.minX-e,this.maxX+e,this.minY-e,this.maxY+e)}isInside(e){return this.minX>=e.minX&&this.maxX<=e.maxX&&this.minY>=e.minY&&this.maxY<=e.maxY}isContainsBBox(e){return this.maxX>=e.maxX&&this.minX<=e.minX&&this.maxY>=e.maxY&&this.minY<=e.minY}isContainsBBox1(e){return Ct.greatereq(this.maxX,e.maxX)&&Ct.lesseq(this.minX,e.minX)&&Ct.greatereq(this.maxY,e.maxY)&&Ct.lesseq(this.minY,e.minY)}intersect(e){let r=Math.max(this.minX,e.minX),i=Math.min(this.maxX,e.maxX);if(r>i)return null;let n=Math.max(this.minY,e.minY),s=Math.min(this.maxY,e.maxY);return n>s?null:new GA(r,i,n,s)}intersection1(e){let r=Math.max(this.minX,e.minX),i=Math.min(this.maxX,e.maxX);if(Ct.greater(r,i))return null;r>i&&(i=r);let n=Math.max(this.minY,e.minY),s=Math.min(this.maxY,e.maxY);return Ct.greater(n,s)?null:(n>s&&(s=n),new GA(r,i,n,s))}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}UL(){return new nt(this.minX,this.maxY)}UR(){return new nt(this.maxX,this.maxY)}LL(){return new nt(this.minX,this.minY)}LR(){return new nt(this.maxX,this.minY)}center(){return new nt(this.maxX-(this.maxX-this.minX)/2,this.maxY-(this.maxY-this.minY)/2)}area(){return this.width()*this.height()}transform(e){let r=new od;return r.ext2(this.LL().multiply3(e)),r.ext2(this.LR().multiply3(e)),r.ext2(this.UR().multiply3(e)),r.ext2(this.UL().multiply3(e)),r.build()}transform4(e){let r=new od;return r.ext2(this.LL().multiply4(e)),r.ext2(this.LR().multiply4(e)),r.ext2(this.UR().multiply4(e)),r.ext2(this.UL().multiply4(e)),r.build()}isSeparated(e){if(e==null||e==null)return!1;let r;this.minX>=e.minX?r=this.minX:r=e.minX;let i;if(this.maxX<=e.maxX?i=this.maxX:i=e.maxX,r>i)return!0;{let n;this.minY>=e.minY?n=this.minY:n=e.minY;let s;return this.maxY<=e.maxY?s=this.maxY:s=e.maxY,n>s}}relation(e){let r=0,i=0,n;this.minX>e.minX?(r++,n=this.minX):this.minX===e.minX?n=this.minX:(i++,n=e.minX);let s;if(this.maxX<e.maxX?(r++,s=this.maxX):this.maxX===e.maxX?s=this.maxX:(i++,s=e.maxX),n>s)return 2;{let a;this.minY>e.minY?(r++,a=this.minY):this.minY===e.minY?a=this.minY:(i++,a=e.minY);let o;return this.maxY<e.maxY?(r++,o=this.maxY):this.maxY===e.maxY?o=this.maxY:(i++,o=e.maxY),a>o?2:r===4?0:i===4?1:r===0&&i===0?4:n===s||a===o?6:r!==i?5:3}}zoom(e){let r=this.width(),i=this.height(),n=this.center();return e!=0&&(r/=e/2,i/=e/2),new GA(n.x-r,n.x+r,n.y-r,n.y+r)}toString(){return"BBox [minX="+this.minX+", maxX="+this.maxX+", minY="+this.minY+", maxY="+this.maxY+"]"}equals(e){return this.minY==e.minY&&this.minX==e.minX&&this.maxX==e.maxX&&this.maxY==e.maxY}extendSize(e,r){return Object.is(void 0,r)&&(r=e),GA.extend4(this.center(),this.width()+e,this.height()+r)}positionOnBBox(e,r=0){let i=this.center(),n=this.width()*r/2,s=this.height()*r/2,a=e.x-i.x,o=e.y-i.y;return a>n?o>s?yg.RT:o<-s?yg.RB:yg.RC:a<-n?o>s?yg.LT:o<-s?yg.LB:yg.LC:o>s?yg.CT:o<-s?yg.CB:yg.CC}bbox(){return this}},Z_=class Vn{static mul(e,r,i,n,s,a){let o=0,l=0;for(let c=0;c<e;c++){for(let u=0;u<i;u++){let d=u,A=0;for(let h=0;h<r;h++)A+=n[l+h]*s[d],d+=i;a[o++]=A}l+=r}}constructor(e,r,i){this.m=Sa.normal(e),this.n=Sa.normal(r);let n=e*r;if(i.length===n){for(let s=0;s<i.length;s++)Sa.normal(i[s]);this.data=i}else throw new Error("invalid matrix size")}mul(e){if(this.n===e.m){let r=new Array(this.m*e.n);return Vn.mul(this.m,this.n,e.n,this.data,e.data,r),new Vn(this.m,e.n,r)}else throw new Error("m !== p")}toString(){let e=[];e.push("Matrix ("),e.push(this.m.toString()),e.push(" x "),e.push(this.n.toString()),e.push(")");let r=0;for(let i=0;i<this.m;i++)for(let n=0;n<this.n;n++){let s=this.data[r++].toString();n===0?(e.push(`
`),e.push("	"),e.push(s)):(e.push(", "),e.push(s))}return e.join("")}static on(e,r,i){return e*r+i}initExpandMatrix(e){let r=this.m,i=this.n,n=i*2,s=new Array(r*n);for(let a=0;a<r;a++)for(let o=0;o<n;o++)o<i?s[Vn.on(n,a,o)]=e[Vn.on(i,a,o)]:o===r+a?s[Vn.on(n,a,o)]=1:s[Vn.on(n,a,o)]=0;return s}inverseMatrix(e,r,i){for(let n=0;n<r;n++){let s=e[Vn.on(i,n,n)];for(let a=0;a<i;a++)e[Vn.on(i,n,a)]/=s}return e}getMatrixRank(e,r,i){let n=Math.min(r,i);for(let s=0;s<r;s++){if(e[Vn.on(i,s,s)]===0){let a=new Array(i),o;for(o=s;o<r;o++)if(e[Vn.on(i,o,s)]!==0){du.arraycopy(e,Vn.on(i,o,0),a,0,i),du.arraycopy(e,Vn.on(i,s,0),e,Vn.on(i,o,0),i),du.arraycopy(a,0,e,Vn.on(i,s,0),i);break}o>=r&&(n-=1)}if(!(n<r))for(let a=0;a<r;a++){if(a===s)continue;let o=e[Vn.on(i,a,s)]/e[Vn.on(i,s,s)];for(let l=0;l<i;l++)e[Vn.on(i,a,l)]-=e[Vn.on(i,s,l)]*o}}return n}getInverseMatrix(){if(this.m!==this.n)throw new Error("The matrix is an "+this.m+"x"+this.n+" order matrix, non-square matrix, please check!");function e(a){return Ct.lesseq(Math.abs(a),0)}let r=this.initExpandMatrix(this.data.slice(0)),i=this.n*2;function n(a,o){for(let l=0;l<i;l++){let c=r[Vn.on(i,a,l)];r[Vn.on(i,a,l)]=r[Vn.on(i,o,l)],r[Vn.on(i,o,l)]=c}}for(let a=0;a<this.m;a++){let o=Math.abs(r[Vn.on(i,a,a)]),l=a;if(e(r[Vn.on(i,a,a)]))for(let u=a+1;u<this.m;u++){if(e(r[Vn.on(i,u,a)])){Math.abs(r[Vn.on(i,u,a)])>o&&(o=Math.abs(r[Vn.on(i,u,a)]),l=u);continue}n(a,u);break}if(e(r[Vn.on(i,a,a)])){if(o===0)throw new Error("The matrix is a non-full rank matrix, please check!");console.warn("The matrix may be a non-full rank matrix, please check!"),l!==a&&n(a,l)}let c=1/r[Vn.on(i,a,a)];for(let u=0;u<i;u++)r[Vn.on(i,a,u)]*=c;for(let u=0;u<this.m;u++){if(a===u)continue;let d=r[Vn.on(i,u,a)];for(let A=a;A<i;A++)r[Vn.on(i,u,A)]-=r[Vn.on(i,a,A)]*d}}let s=[];for(let a=0;a<this.m;a++)for(let o=this.n;o<i;o++)s[Vn.on(this.n,a,o-this.n)]=r[Vn.on(i,a,o)];return new Vn(this.m,this.n,s)}getTransposeMatrix(){let e=new Array(this.data.length);for(let r=0;r<this.m;r++)for(let i=0;i<this.n;i++)e[i*this.n+r]=this.data[r*this.m+i];return new Vn(this.n,this.m,e)}hashCode(){let e=0;for(let r of this.data)e+=r;return e}equals(e){return this===e?!0:e===null?!1:e instanceof Vn?!(this.m!=e.m||this.n!=e.n||!du.equals(this.data,e.data)):!1}},YEe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],sa,SX=(sa=class extends Z_{static translate(e,r,i){return new sa([1,0,0,0,0,1,0,0,0,0,1,0,e,r,i,1])}static translate1(e){return new sa([1,0,0,0,0,1,0,0,0,0,1,0,e.x,e.y,e.z,1])}static rotateX(e){let r=Math.cos(e),i=Math.sin(e);return new sa([1,0,0,0,0,r,i,0,0,-i,r,0,0,0,0,1])}static rotateY(e){let r=Math.cos(e),i=Math.sin(e);return new sa([r,0,-i,0,0,1,0,0,i,0,r,0,0,0,0,1])}static rotateZ(e){let r=Math.cos(e),i=Math.sin(e);return new sa([r,i,0,0,-i,r,0,0,0,0,1,0,0,0,0,1])}static rotateAxis(e,r){e=e.normalize();let i=e.x,n=e.y,s=e.z,a=Math.sin(r),o=Math.cos(r);return new sa([i*i*(1-o)+o,i*n*(1-o)+s*a,i*s*(1-o)-n*a,0,i*n*(1-o)-s*a,n*n*(1-o)+o,n*s*(1-o)+i*a,0,i*s*(1-o)+n*a,n*s*(1-o)-i*a,s*s*(1-o)+o,0,0,0,0,1])}static scale(e,r=e,i=e){return new sa([e,0,0,0,0,r,0,0,0,0,i,0,0,0,0,1])}static flipX(){return new sa([1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])}static flipY(){return new sa([-1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}static rotateZForPoint(e,r){return e.equals1(nt.ORIGIN)?sa.rotateZ(r):sa.translate(-e.x,-e.y,0).rotateZ(r).translate1(e.x,e.y,0)}static getMatrix4(e,r,i,n){let s=Math.cos(r),a=Math.sin(r),o=i*(e.x*s-e.y*a)+n.x,l=e.x*a+e.y*s+n.y,c=[i*s,a,0,0,-a*i,s,0,0,0,0,1,0,o,l,0,1];return new sa(c)}constructor(e=YEe){super(4,4,e)}translate(e){return this.multiply4(sa.translate1(e))}translate1(e,r,i){return this.multiply4(sa.translate(e,r,i))}rotateX(e){return this.multiply4(sa.rotateX(e))}rotateY(e){return this.multiply4(sa.rotateY(e))}rotateZ(e){return this.multiply4(sa.rotateZ(e))}scale(e,r=e,i=e){return this.multiply4(sa.scale(e,r,i))}scale1(e){return this.multiply4(sa.scale(e.x,e.y,e.z))}setOrigin(e,r,i){return sa.translate(-e,-r,-i).multiply4(this).translate1(e,r,i)}setOrigin1(e){return this.setOrigin(e.x,e.y,e.z)}multiply4(e){let r=new Array(16);return Z_.mul(4,4,4,this.data,e.data,r),new sa(r)}getInverseMatrix(){let e=super.getInverseMatrix();return new sa(e.data)}getTransposeMatrix(){let e=super.getTransposeMatrix();return new sa(e.data)}inverse(){let e=this.getInverseMatrix();return new sa(e.data)}toMatrix3(){let e=this.data;return new ko([e[0],e[1],0,e[4],e[5],0,e[12],e[13],1])}},sa.ORIGIN=new sa,sa);function VC(t){return vX.normal(parseFloat(t))}var VEe=[1,0,0,0,1,0,0,0,1],_s,ko=(_s=class extends Z_{static translate(e,r){return new _s([1,0,0,0,1,0,e,r,1])}static translate1(e){return this.translate(e.x,e.y)}static rotate(e){let r=Math.cos(e),i=Math.sin(e);return new _s([r,i,0,-i,r,0,0,0,1])}static rotateD(e){return this.rotate(Bi.toRadians(e))}static scale(e,r=e){return new _s([e,0,0,0,r,0,0,0,1])}static scale1(e,r){return new _s([e,0,0,0,r,0,0,0,1])}static toDOMMatrix(e){let[r,i,,n,s,,a,o]=e.data;return`matrix(${[r,i,n,s,a,o].join(",")})`}static svgTrasform(e){let r=e.split(" "),i=null;return r.forEach(n=>{n=n.trim();let s=n.trim().replace(")","").split("("),a=s[0],o=s[1].split(",");switch(a){case"translate":let l=VC(o[0]),c=VC(o[1]);i=i?i.translate(l,c):_s.translate(l,c);break;case"rotate":let u=VC(o[0]),d=VC(o[1]),A=VC(o[2]);i=i?i.setOrigin(d,A):_s.translate(d,A),i=i.rotateD(u);break;default:return}}),i}constructor(e=VEe){super(3,3,e);let r=e[0],i=e[3],n=e[1],s=e[4];this.iScale=Math.sqrt(r*r+n*n),this.jScale=Math.sqrt(i*i+s*s)}isMirrored(){return this.det()<0}multiply3(e){let r=new Array(9);return Z_.mul(3,3,3,this.data,e.data,r),new _s(r)}translate(e,r){return this.multiply3(_s.translate(e,r))}translate1(e){return this.multiply3(_s.translate1(e))}scale(e,r=e){return this.multiply3(_s.scale(e,r))}scale1(e,r){return this.multiply3(_s.scale1(e,r))}det(){return this.data[0]*this.data[4]-this.data[3]*this.data[1]}invert(){let e=this.getInverseMatrix();return new _s(e.data)}rotateD(e){return this.multiply3(_s.rotateD(e))}rotate(e){return this.multiply3(_s.rotate(e))}resetOffset(){let e=this.data;return new _s([e[0],e[1],0,e[3],e[4],0,0,0,1])}setOrigin(e,r){return _s.translate(-e,-r).multiply3(this).translate(e,r)}setOrigin1(e){return this.setOrigin(e.x,e.y)}getInverseMatrix(){return new _s(super.getInverseMatrix().data)}getTransposeMatrix(){let e=super.getTransposeMatrix();return new _s(e.data)}toMatrix4(){let e=this.data;return new SX([e[0],e[1],0,e[2],e[3],e[4],0,e[5],0,0,1,0,e[6],e[7],0,e[8]])}scaleNum(e){return!e||isNaN(e)?e:e*this.iScale}},_s.ORIGIN=new _s,_s.MIRROR_Y=new _s([1,0,0,0,-1,0,0,0,1]),_s.MIRROR_X=new _s([-1,0,0,0,1,0,0,0,1]),_s.ROT_90=new _s([0,1,0,-1,0,0,0,0,1]),_s.ROT_N90=new _s([0,-1,0,1,0,0,0,0,1]),_s),jEe=(t=>(t[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE",t))(jEe||{}),QEe=(t=>(t[t.CW=0]="CW",t[t.CCW=1]="CCW",t))(QEe||{}),cS=class{},i6=class qC{constructor(e,r,i){this.p1=e,this.p2=r,this.p3=i}barycentre(){return qC.barycentre(this.p1,this.p2,this.p3)}incentre(){return qC.incentre(this.p1,this.p2,this.p3)}static barycentre(e,r,i){let n=e.x+r.x+i.x,s=e.y+r.y+i.y;return new nt(n/3,s/3)}static incentre(e,r,i){let n=r.sub(i).length(),s=e.sub(i).length(),a=e.sub(r).length(),o=n+s+a,l=n*e.x+s*r.x+a*i.x,c=n*e.y+s*r.y+a*i.y;return new nt(l/o,c/o)}area(){return qC.area(this.p1,this.p2,this.p3)}static area(e,r,i){return this.area2(e.x,e.y,r.x,r.y,i.x,i.y)/2}static area2(e,r,i,n,s,a){return Math.abs(oo.crossProd2(e,r,i,n,s,a))}scale(e,r){let i=ko.translate(-e.x,-e.y).scale(r).translate1(e),n=this.p1.multiply3(i),s=this.p2.multiply3(i),a=this.p3.multiply3(i);return new qC(n,s,a)}scaleOnBarycentre(e){return this.scale(this.barycentre(),e)}scaleOnIncentre(e){return this.scale(this.incentre(),e)}extend(e){let r=this.incentre(),i=this.p1.add(this.p2).sub(r).scale(1/2),n=i.length(),s=nt.ORIGIN.pointOnRays2(i,n+e).length()/n;return this.scaleOnIncentre(s)}container(e){let r=this.p3.sub(this.p1),i=this.p2.sub(this.p1),n=e.sub(this.p1),s=r.dot(r),a=r.dot(i),o=r.dot(n),l=i.dot(i),c=i.dot(n),u=1/(s*l-a*a),d=(l*o-a*c)*u;if(d<0||d>1)return!1;let A=(s*c-a*o)*u;return A<0||A>1?!1:d+A<=1}};function R_(){return{minDistance:Number.POSITIVE_INFINITY,start:null,end:null}}var Wf=class q0{static getMinDistanceWithoutCross(e,r){let i=R_();return q0.minLine(e,r,i),i.minDistance}static getMinDistance(e,r){return YA(e,r)?0:this.getMinDistanceWithoutCross(e,r)}static getMinLineWithCross(e,r){let i=R_();return q0.minLine(e,r,i),new je(i.start,i.end)}static getMinLine(e,r){return q0.intersection(e,r)||this.getMinLineWithCross(e,r)}static getMinDistanceFromPoint(e,r){let i=R_();if(r instanceof je)this.point2LineMinLine(i,r,e);else if(r instanceof bt)this.point2ArcMinDistance(e,r,i);else throw new Error("not support");return i.minDistance}constructor(e,r){if(this.pt1=e,this.pt2=r,this.minline=q0.intersection(e,r),this.minline)this.minDistance=0;else{let i=R_();q0.minLine(e,r,i),this.minline=new je(i.start,i.end),this.minDistance=i.minDistance}}getDistance(){return this.minDistance}getLine(){return this.minline}static intersection(e,r){let i=YA(e,r);if(i===0)return;let n=new Array;for(let s=0;s<i;s+=2){let a=new nt(_e[s],_e[s+1]);n.push(a)}return n.length>1?new je(n[0],n[1]):new je(n[0],n[0])}static minLine(e,r,i){if(e instanceof je&&r instanceof je)return this.minDistanceForLines(e,r,i);if(e instanceof bt&&r instanceof je)return this.minDistanceForLineAndArc(e,r,i);if(e instanceof je&&r instanceof bt)return this.minDistanceForLineAndArc(r,e,i);if(e instanceof bt&&r instanceof bt)return this.minDistanceForArcs(e,r,i);throw new Error("not support")}static minDistanceForLines(e,r,i){[e.start(),e.end(),r.start(),r.end()].forEach((n,s)=>{s<2?this.point2LineMinLine(i,r,n):this.point2LineMinLine(i,e,n)})}static minDistanceForLineAndArc(e,r,i){this.point2LineMinLine(i,r,e.start()),this.point2LineMinLine(i,r,e.svgEnd);let n=q0.foot(r,e.center);r.bbox().extendOfSize(1e-8).isContains(n)&&this.point2ArcMinLine(i,e,n),this.point2ArcMinLine(i,e,r.start()),this.point2ArcMinLine(i,e,r.end())}static minDistanceForArcs(e,r,i){this.concentricArc(e,r,i),this.point2ArcMinDistance(r.start(),e,i),this.point2ArcMinDistance(r.svgEnd,e,i),this.point2ArcMinDistance(e.start(),r,i),this.point2ArcMinDistance(e.svgEnd,r,i),(zf(e,r.center)||zf(r,e.center))&&this.shortestLineForArcs(e,r,i)}static minLineForArcAndLine(e,r,i){let n=e.pointOn(i.angleD(e.center)),s=e.pointOn(e.center.angleD(i));this.arcShortestLine(e,r,i,n),this.arcShortestLine(e,r,i,s)}static arcInnerLineFootSegment(e,r,i){let n=i.distance1(e.center);if(n!==0){let s=e.rx*(i.y-e.center.y)/n+e.center.y,a=e.rx*(i.x-e.center.x)/n+e.center.x;n=e.rx-n,n<r.minDistance&&(r.minDistance=n,r.start=new nt(a,s),r.end=i)}else n=e.rx-n,n<r.minDistance&&(r.minDistance=n,r.start=e.start(),r.end=i)}static shortestLineForArcs(e,r,i){let n=e.center.angleD(r.center),s=r.center.angleD(e.center),a=e.pointOn(n),o=e.pointOn(s),l=r.pointOn(n),c=r.pointOn(s);zf(e,a)&&(this.arcShortestLine(r,i,a,l),this.arcShortestLine(r,i,a,c)),zf(e,o)&&(this.arcShortestLine(r,i,o,l),this.arcShortestLine(r,i,o,c)),this.shortestLineForArcs1(e,r,i)}static shortestLineForArcs1(e,r,i){let n=r.start().sub(e.center).normalize(),s=r.end().sub(e.center).normalize(),a=e.start().sub(r.center).normalize(),o=e.end().sub(r.center).normalize(),l=e.center.add(n.mul(e.rx)),c=e.center.add(s.mul(e.rx)),u=r.center.add(a.mul(r.rx)),d=r.center.add(o.mul(r.rx));zf(e,l)&&Ct.greater(r.start().distance2(e.center),0)&&this.arcShortestLine(e,i,r.start(),l),zf(e,c)&&Ct.greater(r.end().distance2(e.center),0)&&this.arcShortestLine(e,i,r.end(),c),zf(r,u)&&Ct.greater(e.start().distance2(r.center),0)&&this.arcShortestLine(r,i,e.start(),u),zf(r,d)&&Ct.greater(e.end().distance2(r.center),0)&&this.arcShortestLine(r,i,e.end(),d)}static concentricArc(e,r,i){if(!(e.center.distance1(r.center)<1e-5&&e.rx===r.rx&&e.ry===r.ry))return;let n=e.start().distance1(r.svgEnd);n<i.minDistance&&(i.minDistance=n,i.start=e.start(),i.end=r.svgEnd),n=r.start().distance1(e.svgEnd),n<i.minDistance&&(i.minDistance=n,i.start=r.start(),i.end=e.svgEnd)}static point2ArcMinDistance(e,r,i){if(zf(r,e)){let n=r.pointOn(e.angleD(r.center)),s=r.pointOn(r.center.angleD(e));this.arcShortestLine(r,i,e,n),this.arcShortestLine(r,i,e,s)}else this.minLineSegment(i,r.start(),e),this.minLineSegment(i,r.svgEnd,e)}static point2ArcMinLine(e,r,i){if(zf(r,i)){let n=i.distance1(r.center);n>r.rx||n>r.ry?this.minLineForArcAndLine(r,e,i):this.arcInnerLineFootSegment(r,e,i)}}static point2LineMinLine(e,r,i){let n=q0.foot(r,i);r.bbox().extendOfSize(1e-8).isContains(n)?this.minLineSegment(e,n,i):(this.minLineSegment(e,r.start(),i),this.minLineSegment(e,r.end(),i))}static minLineSegment(e,r,i){let n=r.distance1(i);n<e.minDistance&&(e.minDistance=n,e.start=r,e.end=i)}static arcShortestLine(e,r,i,n){if(!zf(e,n))return;let s=i.distance1(n);s<r.minDistance&&(r.minDistance=s,r.start=i,r.end=n)}static foot(e,r){if(e.isPoint())return e.start();if(!Ct.eq(e.b,0)&&!Ct.eq(e.a,0)){let i=e.start(),n=e.direct,s=(r.x-i.x)*n.x+(r.y-i.y)*n.y;return new nt(i.x+n.x*s,i.y+n.y*s)}else return Ct.eq(e.b,0)&&!Ct.eq(e.a,0)?new nt(e.start().x,r.y):!Ct.eq(e.b,0)&&Ct.eq(e.a,0)?new nt(r.x,e.start().y):r}};function zf(t,e){if(Ct.eq(t.sweepAngle,360))return!0;let r=Bi.regularD(e.angleD(t.center));return t.sweepAngle>0?(Ct.less(r,t.startAngle)&&(r+=360),Ct.greatereq(t.endAngle(),r)):(Ct.greater(r,t.startAngle)&&(r-=360),Ct.lesseq(t.endAngle(),r))}var zEe=[1,10,100,1e3],Yz="http://www.w3.org/2000/svg",Vz="http://www.w3.org/1999/xlink",jz="http://www.w3.org/XML/1998/namespace",Qz="https://easyeda.com/",U9e=(function(){var t={svg:Yz,xlink:Vz,xml:jz,c:Qz};return t[Yz]="svg",t[Vz]="xlink",t[jz]="xml",t[Qz]="c",t})();var Ro=(function(){var t={RATLINES:9,MODEL3D:19,ALL:11,TOPSILKLAYER:3,TOPLAYER:1,TOPPASTERLAYER:5,TOPSOLDERLAYER:7,LIBBODY:99,PADSURFACE:100,BOARDOUTLINE:10,DOCUMENT:12,TOPASSEMBLY:13,MECHANICAL:15,TOPCOMPONENT:16,SUBSTRATE:18},e;for(e=21;e<53;e++)t["INNER"+(e-20)]=e;for(t.BOTTOMSILKLAYER=4,t.BOTTOMLAYER=2,t.BOTTOMPASTERLAYER=6,t.BOTTOMSOLDERLAYER=8,t.BOTTOMASSEMBLY=14,t.BOTTOMCOMPONENT=17,e=53;e<85;e++)t["BOARD"+(e-52)]=e;return t})(),H9e=(function(){var t={COPPERAREA:[1,2,21,22,23,24],PLANEZONE:[1,2,21,22,23,24],RECT:[1,2,3,4,5,6,7,8,12,13,14,15,21,22,23,24,99],TRACK:[1,2,3,4,5,6,7,8,10,12,13,14,15,21,22,23,24,99],PAD:[11,1,2],VIA:[11],HOLE:[11],TEXT:[3,4,1,2,7,8,12,13,14,15,21,22,23,24],ARC:[1,2,3,4,5,6,7,8,10,12,13,14,15,21,22,23,24,99],ELLIPSE:[3,4,12,13,14,15],CIRCLE:[1,2,3,4,5,6,7,8,10,12,13,14,15,21,22,23,24,99],DIMENSION:[3,4,12,13,14,15],FOOTPRINT:[1,2],SOLIDREGION:[1,2,3,4,5,6,7,8,12,13,14,15,21,22,23,24,11,99,100],SVGNODE:[1,2,3,4,7,8,12,13,14,15],PROTRACTOR:[3,4,12,13,14,15],SHEET:[12,13,14,15]};t["3D"]=(function(){for(var n=[16,19,3,7,5,1],s=21;s<52;s++)n.push(s+32,s);return n.push(2,6,8,4,17),n})();var e,r,i;for(e in t)if(t.hasOwnProperty(e)&&(i=t[e],i.indexOf(21)>0&&i.indexOf(25)===-1))for(r=25;r<=52;r++)i.push(r);return t})(),hc=(function(){var t={1:"TopLayer",2:"BottomLayer",3:"TopSilkLayer",4:"BottomSilkLayer",5:"TopPasteMaskLayer",6:"BottomPasteMaskLayer",7:"TopSolderMaskLayer",8:"BottomSolderMaskLayer",9:"Ratlines",10:"BoardOutLine",11:"Multi-Layer",12:"Document",13:"TopAssembly",14:"BottomAssembly",15:"Mechanical",16:"TopComponents",17:"BottomComponents",18:"Substrate",19:"3DModel",99:"ComponentShapeLayer",100:"LeadShapeLayer"},e;for(e=21;e<53;e++)t[e]="Inner"+(e-20);for(e=53;e<85;e++)t[e]="Substrate"+(e-52);return t})(),G9e=(function(){var t=[],e=[];for(var r in Ro)if(Ro.hasOwnProperty(r)){if(r.match(/^BOARD\d+/))continue;t.push(Ro[r])}t.sort(),e.sort();var i={},n,s={21:"#999966",22:"#008000",23:"#00FF00",24:"#BC8E00",25:"#70DBFA",26:"#00CC66",27:"#9966FF",28:"#800080",29:"#008080",30:"#15935F",31:"#000080",32:"#00B400",33:"#2E4756",34:"#99842F",35:"#FFFFAA",36:"#99842F",37:"#2E4756",38:"#3535FF",39:"#8000BC",40:"#43AE5F",41:"#C3ECCE",42:"#728978",43:"#39503F",44:"#0C715D",45:"#5A8A80",46:"#2B937E",47:"#23999D",48:"#45B4E3",49:"#215DA1",50:"#4564D7",51:"#6969E9",52:"#9069E9"};t.forEach(function(o){switch(o){case Ro.TOPLAYER:n={name:hc[o],color:"#FF0000",darkColor:"#CC0000",visible:!0,active:!0,config:!0};break;case Ro.BOTTOMLAYER:n={name:hc[o],color:"#0000FF",darkColor:"#000080",visible:!0,active:!1,config:!0};break;case Ro.TOPSILKLAYER:n={name:hc[o],color:"#FFCC00",darkColor:"#806600",visible:!0,active:!1,config:!0};break;case Ro.BOTTOMSILKLAYER:n={name:hc[o],color:"#66CC33",darkColor:"#33661A",visible:!0,active:!1,config:!0};break;case Ro.TOPPASTERLAYER:n={name:hc[o],color:"#808080",darkColor:"#666666",visible:!0,active:!1,config:!0};break;case Ro.BOTTOMPASTERLAYER:n={name:hc[o],color:"#800000",darkColor:"#660000",visible:!0,active:!1,config:!0};break;case Ro.TOPSOLDERLAYER:n={name:hc[o],color:"#800080",darkColor:"#660066",visible:!0,active:!1,transparency:.3,config:!0};break;case Ro.BOTTOMSOLDERLAYER:n={name:hc[o],color:"#AA00FF",darkColor:"#8800CC",visible:!0,active:!1,transparency:.3,config:!0};break;case Ro.RATLINES:n={name:hc[o],color:"#6464FF",darkColor:"#5050CC",visible:!1,active:!1,config:!0};break;case Ro.BOARDOUTLINE:n={name:hc[o],color:"#FF00FF",darkColor:"#CC00CC",visible:!0,active:!1,config:!0};break;case Ro.ALL:n={name:hc[o],color:"#C0C0C0",darkColor:"#999999",visible:!0,active:!1,config:!0};break;case Ro.DOCUMENT:n={name:hc[o],color:"#FFFFFF",darkColor:"#CCCCCC",visible:!0,active:!1,config:!0};break;case Ro.TOPASSEMBLY:n={name:hc[o],color:"#33CC99",darkColor:"#33AA99",visible:!1,active:!1,config:!1};break;case Ro.BOTTOMASSEMBLY:n={name:hc[o],color:"#5555FF",darkColor:"#8888FF",visible:!1,active:!1,config:!1};break;case Ro.MECHANICAL:n={name:hc[o],color:"#F022F0",darkColor:"#F088F0",visible:!1,active:!1,config:!1};break;case Ro.MODEL3D:n={name:hc[o],color:"#66CCFF",visible:!1,active:!1,config:!1};break;case Ro.LIBBODY:n={name:hc[o],color:"#00CCCC",visible:!1,active:!1,config:!1};break;case Ro.PADSURFACE:n={name:hc[o],color:"#CC9999",visible:!1,active:!1,config:!1};break;default:o>=Ro.INNER1&&o<=Ro.INNER32?n={name:hc[o],color:s[o],darkColor:a(s[o]),visible:!1,active:!1,config:!1}:n=null;break}n&&(i[o]=n)}),i.Hole={config:!0,name:"Hole",darkColor:"#222222",color:"#222222"},i.DRCError={config:!0,name:"DRCError",color:"#FAD609",darkColor:"#FAD609"};function a(o){if(typeof o!="string"||!o.match(/#?([\da-f]{6})/i))return o;var l=parseInt(RegExp.$1,16),c=.5,u=Math.min(255,Math.round((l>>16)*c)),d=Math.min(255,Math.round((l>>8&255)*c)),A=Math.min(255,Math.round((l&255)*c)),h=((u<<16)+(d<<8)+A).toString(16);return"#"+("00000"+h).substr(-6).toUpperCase()}return i})(),zz={BLANK:0,SCH:1,PART:2,PCB:3,FOOTPRINT:4,PRJ:5,SUBPART:6,SPICESYMBOL:7,SUBCKT:8,NETLIST:9,WAVEFORM:10,SCHLIB3D:11,PHOTOVIEW:12,SCHMODULE:13,PCBMODULE:14,VIEW3D:15,PCBLIB3D:16,BLOCK_SYMBOL:17,NETFLAG:18,NETPORT:19,SHEET_SYMBOL:20,NONEELEC_SYMBOL:21,SHORT_SYMBOL:22,FOOTPRINTVIEW:23,CNCPRINTVIEW:24,PCB2D:31,PCB3D:32},Y9e=(function(){var t={};for(let e in zz)t[zz[e]]=e;return t})();var uP=Math.PI*2,eP=Math.PI/2,V9e=Math.sin(Math.PI/180);function XEe(t,e,r){if(typeof t!="number"&&(t=+t),isNaN(t))return NaN;if(e=e|0,e<=0||!t&&!r)return Math.round(t);var i=zEe[e]||Math.pow(10,e)||10;if(r){var n=t<0?"-":"";for(t=t<0?-t:t,t=Math.round(t*i)+"";t.length<=e;)t="0"+t;return t=t.slice(0,-e)+"."+t.slice(-e),parseFloat(n+t)}else return Math.round(t*i+1e-10)/i}function TX(t,e,r){var i=t-e;return r||(r=1e-10),(i>0?i:-i)<r}function qEe(t,e,r){var i=u(t)&&u(e)&&u(r);if(!i)return console.warn("Bad arguments"),null;var n=e.x-r.x>0?e.x:r.x,s=e.y-r.y>0?e.y:r.y,a=e.x-r.x>0?r.x:e.x,o=e.y-r.y>0?r.y:e.y,l=t.x,c=t.y;return l<=n+.001&&l>=a-.001&&c<=s+.001&&c>=o-.001;function u(d){return d?(d.x=Number(d.x),d.y=Number(d.y),isNaN(d.x)||isNaN(d.y)?(console.warn("Can not convert to Number, NaN found"),!1):!0):(console.warn("Empty input!"),!1)}}function WEe(t,e,r,i,n,s){var a=(n-r)*(t-r)+(s-i)*(e-i),o=(n-r)*(n-r)+(s-i)*(s-i),l=a/o,c=r+(n-r)*l,u=i+(s-i)*l;return a<=0?Math.sqrt((t-r)*(t-r)+(e-i)*(e-i)):a>=o?Math.sqrt((t-n)*(t-n)+(e-s)*(e-s)):Math.sqrt((t-c)*(t-c)+(u-e)*(u-e))}function KEe(t,e,r){return qEe(t,e,r)?TX((t.x-e.x)*(r.y-e.y),(r.x-e.x)*(t.y-e.y),.001):!1}var WC=1e-4,_e=new Float64Array(100);function YA(t,e){if(t instanceof je&&e instanceof je)return om(t,e);if(t instanceof bt&&e instanceof je)return n6(t,e);if(t instanceof je&&e instanceof bt)return n6(e,t);if(t instanceof bt&&e instanceof bt)return BX(t,e);if(t instanceof vr&&e instanceof vr)return Q_(t,e);if(t instanceof vr&&e instanceof je)return Q_(t,new vr([e.start(),e.end()]));if(t instanceof je&&e instanceof vr)return Q_(new vr([t.start(),t.end()]),e);if(t instanceof vr&&e instanceof bt)return Zz(e,t);if(t instanceof bt&&e instanceof vr)return Zz(t,e);throw new Error("not supported operation")}function JEe(t,e){let r=t.bbox();if(r.isContainsY1(e)){let i=new je(new nt(r.minX-1,e),new nt(r.maxX+1,e));return om(i,t)>0?1:0}else return 0}function $Ee(t,e){if(t.rx===t.ry){let r=t.bbox();if(r.isContainsY1(e)){let i=new je(new nt(r.minX-1,e),new nt(r.maxX+1,e));return tP(t,i)>0?1:0}else return 0}else throw new Error("not supported operation")}function Xz(t,e){let r=t.bbox();return r.isContainsY1(e)&&Q_(new vr([new nt(r.minX-1,e),new nt(r.maxX+1,e)]),t)>0?1:0}function qz(t,e,r){return isFinite(e)&&isFinite(r)?t.isContains2(e,r):!1}function ZEe(t,e){let r=e.length(),i=oo.crossProd3(e.start(),e.end(),t.start())/r,n=oo.crossProd3(e.start(),e.end(),t.end())/r;return Math.abs(i)<1e-8||Math.abs(n)<1e-8||i*n<0}function om(t,e){let r=t.bbox().intersection1(e.bbox());if(!r)return 0;if(t.isPoint())if(e.isPoint()){let i=r.center();return _e[0]=i.x,_e[1]=i.y,2}else return Wz(e,t,r);else{if(e.isPoint())return Wz(t,e,r);{let i=function(b,E){r.isContains2(b,E)&&(_e[g++]=b,_e[g++]=E)};if(!ZEe(t,e))return 0;let n=t.start().x,s=t.start().y,a=t.end().x,o=t.end().y,l=e.start().x,c=e.start().y,u=e.end().x,d=e.end().y,A=e.length(),h=oo.crossProd2(n,s,l,c,u,d)/A,f=oo.crossProd2(a,o,l,c,u,d)/A;if(h*f>0&&!Ct.eq(h,0)&&!Ct.eq(f,0))return 0;let p=t.length(),m=oo.crossProd2(l,c,n,s,a,o)/p,y=oo.crossProd2(u,d,n,s,a,o)/p;if(m*y>0&&!Ct.eq(m,0)&&!Ct.eq(y,0))return 0;let g=0;if(Ct.eq(h,0)&&Ct.eq(f,0)){let b=r.UL(),E=r.UR(),w=r.LL(),x=r.LR();if(Ct.eq(r.width(),0))Ct.eq(r.height(),0)?(_e[g++]=b.x,_e[g++]=b.y):(_e[g++]=b.x,_e[g++]=b.y,_e[g++]=w.x,_e[g++]=w.y);else if(Ct.eq(r.height(),0))_e[g++]=b.x,_e[g++]=b.y,_e[g++]=E.x,_e[g++]=E.y;else{let I=i6.area2(b.x,b.y,l,c,u,d),C=i6.area2(E.x,E.y,l,c,u,d);I<C?(_e[g++]=b.x,_e[g++]=b.y,_e[g++]=x.x,_e[g++]=x.y):(_e[g++]=E.x,_e[g++]=E.y,_e[g++]=w.x,_e[g++]=w.y)}}else if(Ct.eq(h,0))i(n,s);else if(Ct.eq(f,0))i(a,o);else{let b=Math.abs(h/(h-f));i(n+(a-n)*b,s+(o-s)*b)}return g}}}function Wz(t,e,r){let i=e.start(),n=e.end(),s=oo.crossProd3(t.start(),t.end(),e.start()),a=oo.crossProd3(t.start(),t.end(),e.end());if(s*a<0){let o=r.center();return _e[0]=o.x,_e[1]=o.y,2}else if(Math.abs(s)<Math.abs(a)){if(Ct.eq(s/t.length(),0))return _e[0]=i.x,_e[1]=i.y,2}else if(Ct.eq(a/t.length(),0))return _e[0]=n.x,_e[1]=n.y,2;return 0}function tP(t,e){let r=t.bbox().intersection1(e.bbox());if(r!=null){r=r.extendOfSize(WC);let i=t.center.x,n=t.center.y,s=t.rx,a=t.rx2,o=e.start().x,l=e.start().y,c=e.end().x,u=e.end().y,d=t.center.distance1(e.start()),A=t.center.distance1(e.end()),h=Ct.eq(d,s)?0:d>s?1:-1,f=Ct.eq(A,s)?0:A>s?1:-1,p=0;if(h===-1&&f===-1)return 0;if(h===0&&f===0)_e[p++]=o,_e[p++]=l,_e[p++]=c,_e[p++]=u;else if(h===1&&f===1){let m=Wf.foot(e,t.center),y=m.distance1(t.center);if(Ct.greater(y,s))return 0;if(Ct.eq(y,s))Ct.eq(e.distance2(t.start()),0)?(_e[p++]=t.start().x,_e[p++]=t.start().y,_e[p++]=t.start().x,_e[p++]=t.start().y):Ct.eq(e.distance2(t.end()),0)?(_e[p++]=t.end().x,_e[p++]=t.end().y,_e[p++]=t.end().x,_e[p++]=t.end().y):(_e[p++]=m.x,_e[p++]=m.y,_e[p++]=m.x,_e[p++]=m.y);else{p=IX(i,n,o,l,c,u,p,m);let g=_e[p-2],b=_e[p-1];p-=2;let E=oo.distance1(i,n,g,b);if(Ct.eq(E,s))_e[p++]=g,_e[p++]=b,_e[p++]=g,_e[p++]=b;else if(E<s)p=Nc(a,i,n,o,l,g,b,p),p=Nc(a,i,n,g,b,c,u,p);else return 0}}else if(h===-1||f===-1)p=Nc(a,i,n,o,l,c,u,p);else{let m=Wf.foot(e,t.center),y=m.distance1(t.center);if(Ct.eq(y,s)){let g=function(w){return qz(r,w.x,w.y)&&So(t,w)},b=t.start(),E=t.end();if(h===0){let w=e.start();if(g(w))return _e[p++]=w.x,_e[p++]=w.y,_e[p++]=w.x,_e[p++]=w.y,p;if(g(m))return _e[p++]=m.x,_e[p++]=m.y,_e[p++]=m.x,_e[p++]=m.y,p;if(Ct.eq(e.distance2(b),0)&&g(b))return _e[p++]=b.x,_e[p++]=b.y,_e[p++]=b.x,_e[p++]=b.y,p;if(Ct.eq(e.distance2(E),0)&&g(E))return _e[p++]=E.x,_e[p++]=E.y,_e[p++]=E.x,_e[p++]=E.y,p;if(d<=s)p=Nc(a,i,n,m.x,m.y,c,u,p),p===2&&(_e[p++]=_e[0],_e[p++]=_e[1]);else if(y<s){if(p=Nc(a,i,n,m.x,m.y,c,u,p),p===2&&g(new nt(_e[0],_e[1])))return _e[p++]=_e[0],_e[p++]=_e[1],p;p=Nc(a,i,n,m.x,m.y,o,l,0),p===2&&(_e[p++]=_e[0],_e[p++]=_e[1])}}else{let w=e.end();if(g(w))return _e[p++]=w.x,_e[p++]=w.y,_e[p++]=w.x,_e[p++]=w.y,p;if(g(m))return _e[p++]=m.x,_e[p++]=m.y,_e[p++]=m.x,_e[p++]=m.y,p;if(Ct.eq(e.distance2(b),0)&&g(b))return _e[p++]=b.x,_e[p++]=b.y,_e[p++]=b.x,_e[p++]=b.y,p;if(Ct.eq(e.distance2(E),0)&&g(E))return _e[p++]=E.x,_e[p++]=E.y,_e[p++]=E.x,_e[p++]=E.y,p;if(A<=s)p=Nc(a,i,n,m.x,m.y,o,l,p),p===2&&(_e[p++]=_e[0],_e[p++]=_e[1]);else if(y<s){if(p=Nc(a,i,n,m.x,m.y,o,l,p),p===2&&g(new nt(_e[0],_e[1])))return _e[p++]=_e[0],_e[p++]=_e[1],p;p=Nc(a,i,n,m.x,m.y,c,u,0),p===2&&(_e[p++]=_e[0],_e[p++]=_e[1])}}}else if(h===0){let g=e.start();_e[p++]=g.x,_e[p++]=g.y,(o-m.x)*(c-m.x)+(l-m.y)*(u-m.y)<0&&(p=Nc(a,i,n,m.x,m.y,c,u,p))}else{let g=e.end();_e[p++]=g.x,_e[p++]=g.y,(o-m.x)*(c-m.x)+(l-m.y)*(u-m.y)<0&&(p=Nc(a,i,n,m.x,m.y,o,l,p))}}if(p>0){let m=0;for(let y=0;y<p;y+=2){let g=_e[y],b=_e[y+1];isFinite(g)&&isFinite(b)&&qz(r,g,b)&&So(t,new nt(g,b))&&(_e[m++]=g,_e[m++]=b)}return m}else return 0}else return 0}function ewe(t,e){if(t.bbox()){let r=t.center.x,i=t.center.y,n=t.rx2,s=e.start().x,a=e.start().y,o=e.end().x,l=e.end().y,c=t.center.distance2(e.start()),u=t.center.distance2(e.end()),d=Ct.eq(c,n)?0:c>n?1:-1,A=Ct.eq(u,n)?0:u>n?1:-1,h=0;if(d===-1&&A===-1)return 0;if(d===0&&A===0)_e[h++]=s,_e[h++]=a,_e[h++]=o,_e[h++]=l;else if(d===1&&A===1){let f=Wf.foot(e,t.center),p=f.distance2(t.center);if(Ct.greater(p,n))return 0;if(Ct.eq(p,n)){let m=f.distance2(t.start()),y=f.distance2(t.end());Ct.eq(m,0)?(_e[h++]=t.start().x,_e[h++]=t.start().y):Ct.eq(y,0)?(_e[h++]=t.end().x,_e[h++]=t.end().y):(_e[h++]=f.x,_e[h++]=f.y)}else{h=IX(r,i,s,a,o,l,h,f);let m=_e[h-2],y=_e[h-1],g=oo.distance2(r,i,m,y);if(h-=2,Ct.eq(g,n))_e[h++]=m,_e[h++]=y;else if(g<n)h=Nc(n,r,i,s,a,m,y,h),h=Nc(n,r,i,m,y,o,l,h);else return 0}}else if(d===-1||A===-1)h=Nc(n,r,i,s,a,o,l,h);else{let f=Wf.foot(e,t.center);d===0?(_e[h++]=e.start().x,_e[h++]=e.start().y,Ct.neq(f.distance2(e.start()),0)&&(s-f.x)*(o-f.x)+(a-f.y)*(l-f.y)<0&&(h=Nc(n,r,i,f.x,f.y,o,l,h))):(_e[h++]=e.end().x,_e[h++]=e.end().y,Ct.neq(f.distance2(e.end()),0)&&(s-f.x)*(o-f.x)+(a-f.y)*(l-f.y)<0&&(h=Nc(n,r,i,f.x,f.y,s,a,h)))}if(h>0){let f=0;for(let p=0;p<h;p+=2){let m=_e[p],y=_e[p+1];isFinite(m)&&isFinite(y)&&(_e[f++]=m,_e[f++]=y)}return f}else return 0}else return 0}function Nc(t,e,r,i,n,s,a,o){if(n==a){let b=t-(n-r)*(n-r);if(Ct.greater(b,0)){let E=Math.sqrt(b),w=e-E,x=e+E,I=Math.min(i,s),C=Math.max(i,s);return w>=I&&w<=C&&(_e[o++]=w,_e[o++]=n),x>=I&&x<=C&&(_e[o++]=x,_e[o++]=n),o}}let l=oo.distance2(i,n,e,r)-t;if(l===0)return _e[o++]=i,_e[o++]=n,o;let c=oo.distance2(s,a,e,r)-t;if(c===0)return _e[o++]=s,_e[o++]=a,o;let u=i,d=n,A=s,h=a,f=NaN,p=NaN,m=Number.POSITIVE_INFINITY,y=0;for(;m!==0;){y++;let b=Math.max(Math.min(Math.abs(l)/(Math.abs(l)+Math.abs(c)),.75),.25);if(f=u+(A-u)*b,p=d+(h-d)*b,u===f&&d===p||A===f&&h===p){Math.abs(l)>Math.abs(c)?(f=A,p=h,m=c):(f=u,p=d,m=l);break}else m=oo.distance2(f,p,e,r)-t,m<0&&l>c||m>0&&l<c?(A=f,h=p,c=m):(u=f,d=p,l=m)}let g=Math.sqrt(t)-oo.distance1(f,p,e,r);return(Ct.eq(0,m)||Ct.eq(0,g))&&(_e[o++]=f,_e[o++]=p),o}function IX(t,e,r,i,n,s,a,o){let l=oo.dotProd2(r,i,n,s,t,e),c=oo.dotProd2(n,s,r,i,t,e);if(l>=0)return _e[a++]=n,_e[a++]=s,a;if(c>=0)return _e[a++]=r,_e[a++]=i,a;if(oo.crossProd2(r,i,n,s,t,e)==0)return _e[a++]=t,_e[a++]=e,a;{let u=NaN,d=NaN,A=r,h=i,f=n,p=s,m=oo.distance2(r,i,t,e),y=oo.distance2(n,s,t,e),g=Number.POSITIVE_INFINITY,b=0;for(;g>0&&(b++,u=A+(f-A)*.5,d=h+(p-h)*.5,!(m==y||A==u&&h==d||f==u&&p==d));){g=oo.distance2(u,d,t,e);let E=oo.dotProd2(A,h,u,d,t,e);if(E==0)break;E<0?(f=u,p=d,y=g):(A=u,h=d,m=g)}return oo.distance2(u,d,t,e)<oo.distance2(o.x,o.y,t,e)?(_e[a++]=u,_e[a++]=d):(_e[a++]=o.x,_e[a++]=o.y),a}}function n6(t,e){if(t.rx===t.ry)return tP(t,e);throw new Error("not supported")}function twe(t,e){if(t.rx===t.ry)return ewe(t,e);throw new Error("not supported")}function BX(t,e){if(t.bbox().intersection1(e.bbox())!=null){if(t.rx===t.ry&&e.rx===e.ry)return rwe(t,e);throw new Error("not supported operation")}return 0}function rwe(t,e){let r=t.center.x,i=t.center.y,n=e.center.x,s=e.center.y,a=t.rx,o=e.rx,l=t.rx2,c=e.rx2,u=t.center.distance1(e.center),d=Math.abs(a-o),A=a+o;if(Ct.greater(u,A)||Ct.less(u,d))return 0;if(Ct.eq(d+u,0)){let h=0,f;return So(t,e.start())&&(_e[h]=e.start().x,_e[h+1]=e.start().y,h+=2,f=e.start()),So(t,e.end())&&(_e[h]=e.end().x,_e[h+1]=e.end().y,h+=2,f=e.end()),h===0?(So(e,t.start())&&(_e[h]=t.start().x,_e[h+1]=t.start().y,h+=2),So(e,t.end())&&(_e[h]=t.end().x,_e[h+1]=t.end().y,h+=2)):h===2&&(!f.equals1(t.start())&&So(e,t.start())&&(_e[h]=t.start().x,_e[h+1]=t.start().y,h+=2),!f.equals1(t.end())&&So(e,t.end())&&(_e[h]=t.end().x,_e[h+1]=t.end().y,h+=2)),h}else if(Ct.eq(u,A)){if(Kz(t,e))return 4;let h=new je(t.center,e.center),f=tP(e,h);return f=Jz(t,f),f!==0?f:(f=tP(t,h),Jz(e,f))}else if(Ct.eq(u,d)){if(Kz(t,e))return 4;if(a>o){let h=(a-o)/a;return _e[0]=r+(n-r)/h,_e[1]=i+(s-i)/h,$z(t,e,2)}else{let h=(o-a)/o;return _e[0]=n+(r-n)/h,_e[1]=s+(i-s)/h,$z(t,e,2)}}else{let h=(t.center.distance2(e.center)-c+l)/(u*2)/u,f=(n-r)*h+r,p=(s-i)*h+i,m=n-r,y=s-i,g=Math.max(a,o),b,E,w,x;if(Math.abs(m)<Math.abs(y)){let U=m/-y,_=p-U*f;b=f-g,E=U*b+_,w=f+g,x=U*w+_}else{let U=y/-m,_=f-U*p;E=p-g,b=U*E+_,x=p+g,w=U*x+_}let I=Nc(l,r,i,b,E,f,p,0);if(I=Nc(l,r,i,f,p,w,x,I),I!==4)throw new Error("cnt !== 4");let C=new nt(_e[0],_e[1]),G=new nt(_e[2],_e[3]);if(So(t,C)&&So(e,C))return So(t,G)&&So(e,G)?4:z0(t.start(),e,G,C)?(_e[2]=t.start().x,_e[3]=t.start().y,4):z0(t.end(),e,G,C)?(_e[2]=t.end().x,_e[3]=t.end().y,4):z0(e.start(),t,G,C)?(_e[2]=e.start().x,_e[3]=e.start().y,4):z0(e.end(),t,G,C)?(_e[2]=e.end().x,_e[3]=e.end().y,4):2;if(So(t,G)&&So(e,G))return z0(t.start(),e,C,G)?(_e[0]=t.start().x,_e[1]=t.start().y,4):z0(t.end(),e,C,G)?(_e[0]=t.end().x,_e[1]=t.end().y,4):z0(e.start(),t,C,G)?(_e[0]=e.start().x,_e[1]=e.start().y,4):z0(e.end(),t,C,G)?(_e[0]=e.end().x,_e[1]=e.end().y,4):(_e[0]=_e[2],_e[1]=_e[3],2);{let U=function(j,$){if(Ct.eq(j.distance1($.center),$.rx)&&So($,j)){if(j.distance2(C)<j.distance2(G)){if(_)return;_=!0}else{if(H)return;H=!0}_e[Q++]=j.x,_e[Q++]=j.y}},_=!1,H=!1,Q=0;return U(t.start(),e),U(t.end(),e),U(e.start(),t),U(e.end(),t),Q}}}function z0(t,e,r,i){return Ct.eq(t.distance1(e.center),e.rx)&&So(e,t)&&t.distance2(r)<t.distance2(i)}function Kz(t,e){return Ct.eq(e.start().distance1(t.center),t.rx)&&So(t,e.start())?(_e[0]=e.start().x,_e[1]=e.start().y,_e[2]=e.start().x,_e[3]=e.start().y,!0):Ct.eq(e.end().distance1(t.center),t.rx)&&So(t,e.end())?(_e[0]=e.end().x,_e[1]=e.end().y,_e[2]=e.end().x,_e[3]=e.end().y,!0):Ct.eq(t.start().distance1(e.center),e.rx)&&So(e,t.start())?(_e[0]=t.start().x,_e[1]=t.start().y,_e[2]=t.start().x,_e[3]=t.start().y,!0):Ct.eq(t.end().distance1(e.center),e.rx)&&So(e,t.end())?(_e[0]=t.end().x,_e[1]=t.end().y,_e[2]=t.end().x,_e[3]=t.end().y,!0):!1}function Jz(t,e){if(e===0)return 0;let r=_e[0],i=_e[1];return So(t,new nt(r,i))?(_e[0]=r,_e[1]=i,_e[2]=r,_e[3]=i,4):0}function $z(t,e,r){if(r===0)return 0;let i=_e[0],n=_e[1],s=new nt(i,n);return So(t,s)&&So(e,s)?(_e[0]=i,_e[1]=n,_e[2]=i,_e[3]=n,4):0}function P2(t,e){return Math.abs(t-e)<=1e-6}function So(t,e){let r=t.bbox();if(e.x-r.minX>-WC&&e.x-r.maxX<WC&&e.y-r.minY>-WC&&e.y-r.maxY<WC){let i=Bi.regularD(e.angleD(t.center));return P2(i,t.startAngle)||P2(i,t.startAngle+360)||P2(i,t.startAngle-360)||P2(i,t.endAngle())||P2(i,t.endAngle()+360)||P2(i,t.endAngle()-360)?!0:t.sweepAngle>0?(Ct.less(i,t.startAngle)&&(i+=360),Ct.greatereq(t.endAngle(),i)):(Ct.greater(i,t.startAngle)&&(i-=360),Ct.lesseq(t.endAngle(),i))}else return!1}function iwe(t,e){let r=t[1].x-t[0].x,i=t[1].y-t[0].y,n=e[1].x-e[0].x,s=e[1].y-e[0].y;if(r===0&&n!==0||r!==0&&n===0)return!1;if(r===0&&n===0)return!0;let a=i/r,o=s/n;return TX(a,o,Math.sin(Math.PI/180))}function nwe(t,e,r){var i,n=+e.x,s=+e.y,a=+r.x,o=+r.y,l=+t.x,c=+t.y,u=a-n,d=o-s,A=l-n,h=c-s,f,p,m,y,g,b;return u===0&&d===0?{d:Math.sqrt(A*A+h*h),point:new nt(n,s)}:(i=(A*u+h*d)/(u*u+d*d),i<0?{d:Math.sqrt(A*A+h*h),point:new nt(n,s)}:i>1?(f=l-a,p=c-o,{d:Math.sqrt(f*f+p*p),point:new nt(a,o)}):(g=n+i*u,b=s+i*d,m=l-g,y=c-b,{d:Math.sqrt(m*m+y*y),point:new nt(g,b)}))}function qf(t,e){if(!t||!e||t.length!=e.length)return!1;let r="equals1";return!t.some((i,n)=>{let s=e[n],a=!1;return i&&s&&typeof i=="object"&&typeof s=="object"?typeof i[r]=="function"&&awe(i,s)?a=!i[r].call(i,s):a=!(i===s||i.toString()===s.toString()):typeof i=="number"&&typeof s=="number"?a=!(swe(i,s)||Number.isNaN(i)&&Number.isNaN(s)):a=i!==s,a})}function swe(t,e,r=5){return Math.abs(t-e)*Math.pow(10,r)<1}function awe(t,e){return!t||!e||typeof t!="object"||typeof e!="object"?t===e:t.constructor===e.constructor}var Xi=new Float64Array(100);function Q_(t,e){if(t.bbox().extendOfSize(Ct.eps).isSeparated(e.bbox()))return 0;let r=[[t,e]],i=(t.controls.length-1)*(e.controls.length-1)*8,n=0,s=Number.POSITIVE_INFINITY;for(;r.length!==0;){let a=function(B){_=Math.min(_,B),H=Math.max(H,B)},o=function(B,M){let v=om(B,M);if(v===0)throw new Error("cnt === 0");for(let N=0;N<v;N+=2)a(_e[N])};if(n>i){for(let B=n-2;B>=2;B-=2)for(let M=B-2;M>=0;M-=2)if(Ct.eq(Xi[B],Xi[M])&&Ct.eq(Xi[B+1],Xi[M+1])){Xi[M]=(Xi[B]+Xi[M])/2,Xi[M+1]=(Xi[B+1]+Xi[M+1])/2;for(let v=n-3;v>=B;v--)Xi[v]=Xi[v+2];n-=2;break}if(n>i){n=0;let B=e.start(),M=new Float64Array(8);t.getPercent(B)!==null&&(M[n++]=B.x,M[n++]=B.y);let v=e.end();t.getPercent(v)!==null&&(M[n++]=v.x,M[n++]=v.y);let N=t.start();e.getPercent(N)!==null&&(M[n++]=N.x,M[n++]=N.y);let R=t.end();return e.getPercent(R)!==null&&(M[n++]=R.x,M[n++]=R.y),_e.set(M),n}}let[l,c]=r.pop(),u=l.controls,d=c.controls;if(u.length===2&&d.length===2){let B=om(new je(u[0],u[1]),new je(d[0],d[1]));for(let M=0;M<B;M++)Xi[n++]=_e[M];continue}let A=u[0],h=u[u.length-1];A.equals1(h)&&(h=A.add1(1,0));let f=h.y-A.y,p=A.x-h.x,m=-f*A.x-p*A.y,y=Math.sqrt(1/(f**2+p**2));f*=y,p*=y,m*=y;let g=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY;if(u.forEach(B=>{let M=f*B.x+p*B.y+m;M<g&&(g=M),M>b&&(b=M)}),Ct.eq(g,b)){if(c.controls.length===2){let B=om(new je(l.start(),l.end()),new je(c.start(),c.end()));for(let M=0;M<B;M++)Xi[n++]=_e[M];if(B!==0)continue}l=new vr([u[0],u[u.length-1]]),u=l.controls}let E=d.map(B=>{let M=f*B.x+p*B.y+m,v=Math.abs(M);return v<s&&(s=v),M}),w=0;for(let B of E){if(Ct.less(B,g))w=w|1;else if(Ct.greater(B,b))w=w|2;else{w=3;break}if(w===3)break}if(w!==3)continue;let x=0,I=0,C=h.x-A.x,G=h.y-A.y,U=Math.sqrt(1/(C**2+G**2));C*=U,G*=U;for(let B=1;B<u.length;B++){let M=u[B],v=(M.x-A.x)*C+(M.y-A.y)*G;v<x?x=v:v>I&&(I=v)}w=0;for(let B of d){let M=(B.x-A.x)*C+(B.y-A.y)*G;if(Ct.less(M,x))w=w|1;else if(Ct.greater(M,I))w=w|2;else{w=3;break}if(w===3)break}if(w!==3)continue;let _=Number.POSITIVE_INFINITY,H=Number.NEGATIVE_INFINITY;s/=2,s<=Ct.eps&&(s=Ct.eps),g-=s,b+=s,E.forEach((B,M)=>{B>=g&&B<=b&&a(M/(E.length-1))});let Q=new je(new nt(0,g),new nt(1,g)),j=new je(new nt(0,b),new nt(1,b));for(let B=0;B<E.length-1;B++){let M=new nt(B/(E.length-1),E[B]),v=M.y<g?1:M.y>b?2:3;for(let N=0;N<E.length;N++){let R=new nt(N/(E.length-1),E[N]),q=R.y<g?1:R.y>b?2:3;v!==q&&(v===1?q===2?(o(new je(M,R),Q),o(new je(M,R),j)):o(new je(M,R),Q):v===2?q===1?(o(new je(M,R),Q),o(new je(M,R),j)):o(new je(M,R),j):q===1?o(new je(M,R),Q):o(new je(M,R),j))}}_!==0&&(c=c.clip(_)[1]),H!==1&&(c=c.clip((H-_)/(1-_))[0]);let $=c.bbox();if(Ct.eq($.minX,$.maxX)&&Ct.eq($.minY,$.maxY)){w=0;for(let B of c.controls){let M=(B.x-A.x)*C+(B.y-A.y)*G;if(Ct.less(M,x))w=w|1;else if(Ct.greater(M,I))w=w|2;else{w=3;break}if(w===3)break}if(w===3){let B=new nt(($.minX+$.maxX)/2,($.minY+$.maxY)/2);l.getPercent(B)&&(Xi[n++]=B.x,Xi[n++]=B.y)}continue}if(H-_>.8){let[B,M]=c.clip(.5);r.push([B,l]),r.push([M,l])}else r.push([c,l])}for(let a=0;a<n;a++)_e[a]=Xi[a];return n}function owe(t,e){if(t.bbox().extendOfSize(Ct.eps).isSeparated(e.bbox()))return{cnt:0};let r=[[t,e]],i=(t.controls.length-1)*(e.controls.length-1)*8,n=0,s=Number.POSITIVE_INFINITY;for(;r.length!==0;){let a=function(B){_=Math.min(_,B),H=Math.max(H,B)},o=function(B,M){let v=om(B,M);if(v===0)throw new Error("cnt === 0");for(let N=0;N<v;N+=2)a(_e[N])};if(n>i){for(let B=n-2;B>=2;B-=2)for(let M=B-2;M>=0;M-=2)if(Ct.eq(Xi[B],Xi[M])&&Ct.eq(Xi[B+1],Xi[M+1])){Xi[M]=(Xi[B]+Xi[M])/2,Xi[M+1]=(Xi[B+1]+Xi[M+1])/2;for(let v=n-3;v>=B;v--)Xi[v]=Xi[v+2];n-=2;break}if(n>i){n=0;let B=new Float64Array(8),M=e.end(),v=0;t.getPercent(M)!==null&&(B[n++]=M.x,B[n++]=M.y,v=2);let N=t.end();return e.getPercent(N)!==null&&(B[n++]=N.x,B[n++]=N.y,v=v===0?1:3),_e.set(B),{havOverlap:v,cnt:n}}}let[l,c]=r.pop(),u=l.controls,d=c.controls;if(u.length===2&&d.length===2){let B=om(new je(u[0],u[1]),new je(d[0],d[1]));for(let M=0;M<B;M++)Xi[n++]=_e[M];continue}let A=u[0],h=u[u.length-1];A.equals1(h)&&(h=A.add1(1,0));let f=h.y-A.y,p=A.x-h.x,m=-f*A.x-p*A.y,y=Math.sqrt(1/(f**2+p**2));f*=y,p*=y,m*=y;let g=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY;if(u.forEach(B=>{let M=f*B.x+p*B.y+m;M<g&&(g=M),M>b&&(b=M)}),Ct.eq(g,b)){if(c.controls.length===2){let B=om(new je(l.start(),l.end()),new je(c.start(),c.end()));for(let M=0;M<B;M++)Xi[n++]=_e[M];if(B!==0)continue}l=new vr([u[0],u[u.length-1]]),u=l.controls}let E=d.map(B=>{let M=f*B.x+p*B.y+m,v=Math.abs(M);return v<s&&(s=v),M}),w=0;for(let B of E){if(Ct.less(B,g))w=w|1;else if(Ct.greater(B,b))w=w|2;else{w=3;break}if(w===3)break}if(w!==3)continue;let x=0,I=0,C=h.x-A.x,G=h.y-A.y,U=Math.sqrt(1/(C**2+G**2));C*=U,G*=U;for(let B=1;B<u.length;B++){let M=u[B],v=(M.x-A.x)*C+(M.y-A.y)*G;v<x?x=v:v>I&&(I=v)}w=0;for(let B of d){let M=(B.x-A.x)*C+(B.y-A.y)*G;if(Ct.less(M,x))w=w|1;else if(Ct.greater(M,I))w=w|2;else{w=3;break}if(w===3)break}if(w!==3)continue;let _=Number.POSITIVE_INFINITY,H=Number.NEGATIVE_INFINITY;s/=2,s<=Ct.eps&&(s=Ct.eps),g-=s,b+=s,E.forEach((B,M)=>{B>=g&&B<=b&&a(M/(E.length-1))});let Q=new je(new nt(0,g),new nt(1,g)),j=new je(new nt(0,b),new nt(1,b));for(let B=0;B<E.length-1;B++){let M=new nt(B/(E.length-1),E[B]),v=M.y<g?1:M.y>b?2:3;for(let N=0;N<E.length;N++){let R=new nt(N/(E.length-1),E[N]),q=R.y<g?1:R.y>b?2:3;v!==q&&(v===1?q===2?(o(new je(M,R),Q),o(new je(M,R),j)):o(new je(M,R),Q):v===2?q===1?(o(new je(M,R),Q),o(new je(M,R),j)):o(new je(M,R),j):q===1?o(new je(M,R),Q):o(new je(M,R),j))}}_!==0&&(c=c.clip(_)[1]),H!==1&&(c=c.clip((H-_)/(1-_))[0]);let $=c.bbox();if(Ct.eq($.minX,$.maxX)&&Ct.eq($.minY,$.maxY)){w=0;for(let B of c.controls){let M=(B.x-A.x)*C+(B.y-A.y)*G;if(Ct.less(M,x))w=w|1;else if(Ct.greater(M,I))w=w|2;else{w=3;break}if(w===3)break}if(w===3){let B=new nt(($.minX+$.maxX)/2,($.minY+$.maxY)/2);l.getPercent(B)&&(Xi[n++]=B.x,Xi[n++]=B.y)}continue}if(H-_>.8){let[B,M]=c.clip(.5);r.push([B,l]),r.push([M,l])}else r.push([c,l])}for(let a=0;a<n;a++)_e[a]=Xi[a];return{cnt:n}}var lwe=class{constructor(t=Ct.eps){this.eps=t}eq(t,e){return Math.abs(t-e)<=this.eps}setEps(t){this.eps=t}},jC=new lwe;function Zz(t,e){if(t.bbox().extendOfSize(Ct.eps).isSeparated(e.bbox()))return 0;let r=[[t,e]],i=(e.controls.length-1)*16,n=0;for(;r.length!==0;){if(n>i){let a=function(){for(let c=0;c<n;c+=2)for(let u=c+2;u<n;u+=2)if(!(jC.eq(Xi[c],Xi[u])&&jC.eq(Xi[c+1],Xi[u+1]))){l(Xi[u],Xi[u+1],o);break}function l(c,u,d){let A=!1;for(let h=0;h<d.length;h+=2)if(jC.eq(c,d[h])&&jC.eq(u,d[h+1])){A=!0;break}A||d.push(c,u)}},o=[Xi[0],Xi[1]];if(a(),o.length>=100&&(jC.setEps(.001),o=[Xi[0],Xi[1]],a(),o.length>=100))throw new Error("clearSamePoint()");n=o.length,o.forEach((l,c)=>Xi[c]=l)}let s=r.pop();if(s[0]instanceof bt){let a=function(j){G=Math.min(G,j),U=Math.max(U,j)},o=function(j,$){let B=om(j,$);if(B===0)throw new Error("cnt === 0");for(let M=0;M<B;M+=2)a(_e[M])},[l,c]=s,u=c.controls;if(u.length===2){let j=n6(l,new je(u[0],u[1]));for(let $=0;$<j;$++)Xi[n++]=_e[$];continue}let d=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,h,f,p,m,y;if(Math.abs(l.sweepAngle)>359){let j=l.rx;h=l.center.add1(j,0),f=l.center.add1(-j,0),d=-j,A=j,p=0,m=1,y=-l.center.y}else{h=l.start(),f=l.end(),p=f.y-h.y,m=h.x-f.x,y=-p*h.x-m*h.y;let j=Math.sqrt(1/(p**2+m**2));p*=j,m*=j,y*=j;let $=p*l.center.x+m*l.center.y+y;l.isCCW?(A=l.rx+$,d=0):(d=$-l.rx,A=0)}let g=u.map(j=>p*j.x+m*j.y+y),b=0;for(let j of g){if(Ct.less(j,d))b=b|1;else if(Ct.greater(j,A))b=b|2;else{b=3;break}if(b===3)break}if(b!==3)continue;let E=0,w=0,x=f.x-h.x,I=f.y-h.y,C=Math.sqrt(1/(x**2+I**2));if(x*=C,I*=C,Math.abs(l.sweepAngle)<=180)E=0,w=(f.x-h.x)*x+(f.y-h.y)*I;else throw new Error("not support");b=0;for(let j of u){let $=(j.x-h.x)*x+(j.y-h.y)*I;if(Ct.less($,E))b=b|1;else if(Ct.greater($,w))b=b|2;else{b=3;break}if(b===3)break}if(b!==3)continue;let G=Number.POSITIVE_INFINITY,U=Number.NEGATIVE_INFINITY;d-=Ct.eps,A+=Ct.eps,g.forEach((j,$)=>{j>=d&&j<=A&&a($/(g.length-1))});let _=new je(new nt(0,d),new nt(1,d)),H=new je(new nt(0,A),new nt(1,A));for(let j=0;j<g.length-1;j++){let $=new nt(j/(g.length-1),g[j]),B=$.y<d?1:$.y>A?2:3;for(let M=0;M<g.length;M++){let v=new nt(M/(g.length-1),g[M]),N=v.y<d?1:v.y>A?2:3;B!==N&&(B===1?N===2?(o(new je($,v),_),o(new je($,v),H)):o(new je($,v),_):B===2?N===1?(o(new je($,v),_),o(new je($,v),H)):o(new je($,v),H):N===1?o(new je($,v),_):o(new je($,v),H))}}G!==0&&(c=c.clip(G)[1]),U!==1&&(c=c.clip((U-G)/(1-G))[0]);let Q=c.bbox();if(Ct.eq(Q.minX,Q.maxX)&&Ct.eq(Q.minY,Q.maxY)){b=0;for(let j of c.controls){let $=(j.x-h.x)*x+(j.y-h.y)*I;if(Ct.less($,E))b=b|1;else if(Ct.greater($,w))b=b|2;else{b=3;break}if(b===3)break}b===3&&(Xi[n++]=(Q.minX+Q.maxX)/2,Xi[n++]=(Q.minY+Q.maxY)/2);continue}U-G>.8?c.clip(.5).forEach(j=>r.push([j,l])):r.push([c,l])}else{let[a,o]=s;r.push([bt.build3(o.center,o.startAngle,o.sweepAngle/2,o.rx,o.ry),a]),r.push([bt.build3(o.center,o.startAngle+o.sweepAngle/2,o.sweepAngle/2,o.rx,o.ry),a])}}for(let s=0;s<n;s++)_e[s]=Xi[s];return n}var cwe=class{static getSweep(t){if(t.length>2){let e=0,r=t.length;for(let s=0;s<r-1;s++){let a=t[s],o=t[s+1];e+=(o.x+a.x)*(o.y-a.y)}let i=t[0],n=t[r-1];return e+=(i.x+n.x)*(i.y-n.y),e>0}else throw new Error("Unable to determine the direction of rotation!")}static isClose(t){return!!(t.primitives.length>0&&t.primitives[0].start().equals1(t.primitives[t.primitives.length-1].end()))}};function uwe(t){let e=t.primitives,r=e[0],i=r instanceof bt?r.sweepAngle%360:null;if(e.length===1&&r instanceof bt&&(Ct.eq(i,0)||Ct.eq(Math.abs(i),360)))return!!r.isCCW;let n=new Array;return t.points(.1,s=>{n.push(s)}),cwe.getSweep(n)}var hwe=class{static zoomCorner(t,e){let r=new Array,i=new Array,n=new Array;return this.getPanPrimitive(t,r,n,e),this.rearrange(r,n),this.processStart(r,n),this.getResult(r,n,i,e),i.length>0?dn.build2(i):null}static zoomPolygon(t,e){let r=new Array,i=new Array,n=new Array;return uwe(t)&&(t=t.reverse().asClose()),this.getPanPrimitive(t,r,n,e),this.rearrange(r,n),this.processStart(r,n),this.getResult(r,n,i,e),i.length>0?dn.build2(i):null}static zoomLines(t,e){return this.zoomPolygon(dn.build2(t.primitives.concat(t.reverse().primitives)),e/2)}static getPanPrimitive(t,e,r,i){let n=t.primitives;for(let s of n){let a=this.panDistance(s,i);a!==void 0&&(e.push(a),r.push(s))}}static rearrange(t,e){let r=t.length,i=0;for(let a=0;a<r;a++){let o=e[a],l=t[a],c=a==r-1?t[0]:t[a+1];if(!(l instanceof bt&&c instanceof bt)&&!this.isCW(l.end(),c.start(),o.end())){if(YA(l,c)!=0){i=a==r-1?0:a+1;break}}else{i=a;break}}let n=this.start4Index(e,i),s=this.start4Index(t,i);e.length=0,t.length=0,n.forEach(a=>{e.push(a)}),s.forEach(a=>{t.push(a)})}static processStart(t,e){let r=t.length;if(r>2){let i=t[r-1],n=t[0],s=e[r-1];if(!(i instanceof bt&&n instanceof bt)&&!this.isCW(i.end(),n.start(),s.end())){let a=YA(i,n);for(let o=0;o<a;o+=2){let l=new nt(_e[o],_e[o+1]);t[r-1]=this.generatePrimitive(i,i.start(),l),t[0]=this.generatePrimitive(n,l,n.end())}}}}static getResult(t,e,r,i){let n=t.length;for(let s=0;s<n;s++){let a=e[s],o=s===n-1?e[0]:e[s+1],l=s==n-1?0:s+1,c=l==n-1?e[0]:e[l+1],u=t[s],d=s==n-1?t[0]:t[s+1],A=l==n-1?t[0]:t[l+1];if(!(u instanceof bt&&d instanceof bt)&&!this.isCW(u.end(),d.start(),a.end())){let f=this.add(t,r,s,u,d,0);f=this.update(t,r,s,d,f);let p=this.generateArc(o,c,d,A,i);if(f=this.add(t,r,s,u,p,f),f=this.update(t,r,s,p,f),f>0)continue}r.push(u);let h=this.generateArc(a,o,u,d,i);h!==void 0&&r.push(h)}}static generateArc(t,e,r,i,n){if(n>0){let s=t.end(),a=e.start(),o=r.end(),l=i.start();if(o.distance2(l)>1e-8)if(s.equals(a)){let c=o.angleD(s),u=l.angleD(s);return bt.build2(s,c,u,n,n,0)}else{let c=o.angleD(s),u=l.angleD(s),d=o.angleD(a),A=l.angleD(a),h=bt.build2(s,c,u,n,n,0),f=bt.build2(a,d,A,n,n,0);return h.pointOn(h.endAngle()).equals1(l)?h:f.pointOn(f.endAngle()).equals1(l)?f:h}}}static updateNews(t,e,r,i){let n=t.length,s=e==n-1?0:e+1;t[s]=this.generatePrimitive(r,i,r.end())}static add(t,e,r,i,n,s){if(s>0)return s;if(i!=null&&n!=null){let a=YA(i,n);for(let o=0;o<a;o+=2){let l=new nt(_e[o],_e[o+1]);e.push(this.generatePrimitive(i,i.start(),l)),this.updateNews(t,r,n,l);break}return a}else return 0}static update(t,e,r,i,n){if(n>0)return n;let s=e.length;if(s>0&&i!=null){let a=e[s-1],o=YA(a,i);for(let l=0;l<o;l+=2){let c=new nt(_e[l],_e[l+1]);e[s-1]=this.generatePrimitive(a,a.start(),c),this.updateNews(t,r,i,c)}return o}else return 0}static generatePrimitive(t,e,r){if(t instanceof je)return new je(e,r);if(t instanceof bt){let i=t,n=e.angleD(i.center),s=r.angleD(i.center);return bt.build2(i.center,n,s,i.rx,i.ry,i.sweep())}else throw new Error("not supported operation")}static start4Index(t,e){let r=t.length,i=new Array;for(let n=e;n<r;n++)i.push(t[n]);for(let n=0;n<e;n++)i.push(t[n]);return i}static isCW(t,e,r){let i=new je(r,t),n=new je(r,e),s=i.end().x-i.start().x,a=i.end().y-i.start().y,o=n.end().x-n.start().x,l=n.end().y-n.start().y;return!(s*l-a*o>0)}static panDistance(t,e){if(t instanceof je){if(t.isPoint())return;{let r=t.panDistance(e);return r.length()>1e-5?r:void 0}}else if(t instanceof bt){let r=t;if(r.sweepAngle>0){if(r.rx-e<=0||r.ry-e<=0)return}else if(r.sweepAngle<0&&(r.rx+e<=0||r.ry+e<=0))return;return r=r.panDistance(e),r.start().distance1(r.end())>1e-5||Ct.eq(Math.abs(r.sweepAngle),360)?r:void 0}else throw new Error("not supported operation")}},di=.001,fu=di**2;function Qr(t,e){return t.distance2(e)<fu}function lm(t,e){return Math.abs(t-e)<=1e-4}function dwe(t,e){if(t instanceof je)return new je(t.start(),e);if(t instanceof bt){let r=e.angleD(t.center);return lm(Bi.regularD(t.startAngle),Bi.regularD(r))?bt.build3(t.center,t.startAngle,0,t.rx,t.ry):bt.build2(t.center,t.startAngle,r,t.rx,t.ry,t.isCCW?1:0)}else{if(t instanceof vr)return t.clip(t.getPercent(e,di))[0];throw new Error("not supported operation")}}function Kf(t,e=Bi.toRadians(t.startAngle)){return t.isCCW?e+=eP:e-=eP,new nt(Math.cos(e),Math.sin(e))}function sS(t,e=0){let r=t.controls;if(e===0){let i=r[0],n=r.slice(1).find(s=>!(s.x===i.x&&s.y===i.y));if(!n)throw Error("getTangentBezier(bezier: Bezier, t: number = 0)");return n.sub(i)}else if(e===1){let i=r[r.length-1],n=r.slice(0,-1).reverse().find(s=>!(s.x===i.x&&s.y===i.y));if(!n)throw Error("getTangentBezier(bezier: Bezier, t: number = 0)");return i.sub(n)}if(r.length===3){let[i,n,s]=r;return n.sub(i).mul(2*(1-e)).add(s.sub(n).mul(2*e)).normalize()}else{let[i,n,s,a]=r;return n.sub(i).mul(3*(1-e)**2).add(s.sub(n).mul(6*(1-e)*e)).add(a.sub(s).mul(3*e**2)).normalize()}}function Y2(t,e,r){let i=t.slice(1).findIndex(s=>!(s.x===e.x&&s.y===e.y)),n=t[i+1];if(r&&(r.getPercent(n,di)!==null||new je(r.start(),r.end()).distance(n)<=di)&&(n=t[i+2]),!n)throw Error("getSecondPoint(controls: readonly Vector2[])");return n}function hi(t,e){if(t instanceof je)return t.end().sub(t.start()).normalize();if(t instanceof bt)return(e?Kf(t,e.angle(t.center)):Kf(t)).normalize();if(t instanceof vr)if(t.controls.length===2){let[r,i]=t.controls;if(Qr(r,i))throw Error("equalsPP(p0, p1)");return i.sub(r).normalize()}else return(e?sS(t,t.getPercent(e,di)):sS(t)).normalize();else throw new Error("not support")}function Awe(t,e,r){let i=[],n=e**2-4*t*r;if(n>=0){let s=-e/(2*t),a=Math.sqrt(n)/(2*t),o=s+a;if(i.push(o),n>0){let l=s-a;i.push(l)}}return i}function fwe(t,e,r,i,n=0,s=1){let a=[],o=t*Math.pow(n,3)+e*Math.pow(n,2)+r*n+i,l=t*Math.pow(s,3)+e*Math.pow(s,2)+r*s+i,c,u;if(o*l<0)for(;Math.abs(n-s)>di;)if(c=(n+s)/2,u=t*Math.pow(c,3)+e*Math.pow(c,2)+r*c+i,Math.abs(u)<di){a.push(c);break}else o*u<0?s=c:l*u<0&&(n=c);else o*l===0&&(o===0&&a.push(n),l===0&&a.push(s));return a}function YM(t,e,r){if(t instanceof je||e.distance2(r)<=fu)return new je(e,r);if(t instanceof bt)return bt.build2(t.center,e.angleD(t.center),r.angleD(t.center),t.rx,t.ry,t.isCCW?1:0);if(t instanceof vr){let i=t.getPercent(e,di),n=t.getPercent(r,di);return t.clip(i)[1].clip((n-i)/(1-i))[0]}else throw new Error("not supported operation")}function s6(t){return Ct.greater(t,0)&&Ct.less(t,1)}function rP(t,e,r,i){let n=t[i]-2*e[i]+r[i],s=e[i]-t[i];if(n===0)return[];let a=-s/n,o=[];return s6(a)&&o.push(a),o}function iP(t,e,r,i,n){let s,a,o=-t[n]+3*e[n]-3*r[n]+i[n],l=2*(t[n]-2*e[n]+r[n]),c=e[n]-t[n],u=l**2-4*o*c;if(Ct.lesseq(u,0))s=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY;else{let A=Math.sqrt(u);s=(-l-A)/(2*o),a=(-l+A)/(2*o);let h=o*2;if(Ct.lesseq(s,1)&&Ct.greatereq(s,0)){let f=Number.NEGATIVE_INFINITY;for(;Ct.neq(s,f);){f=s;let p=h*s+l;s=-(o*s**2+l*s+c-p*s)/p}}if(Ct.lesseq(a,1)&&Ct.greatereq(a,0)){let f=Number.NEGATIVE_INFINITY;for(;Ct.neq(a,f);){f=a;let p=h*a+l;a=-(o*a**2+l*a+c-p*a)/p}}}let d=[];return s6(a)&&d.push(a),s6(s)&&d.push(s),d}function DX(t,e){if(t.controls.length===2){let[o,l]=t.controls;Qr(o,l)||e.push(new je(o,l));return}let r,i;if(t.controls.length===3){let[o,l,c]=t.controls;r=rP(o,l,c,"x"),i=rP(o,l,c,"y")}else{let[o,l,c,u]=t.controls;r=iP(o,l,c,u,"x"),i=iP(o,l,c,u,"y")}r.sort((o,l)=>l-o),i.sort((o,l)=>l-o);let n=r.pop()||1,s=i.pop()||1,a=0;for(;n!==1||s!==1;)if(Ct.eq(n,s))n=r.pop()||1,s=i.pop()||1;else if(n<s){let[o,l]=t.clip((n-a)/(1-a));a=n,e.push(o),t=l,n=r.pop()||1}else{let[o,l]=t.clip((s-a)/(1-a));a=s,e.push(o),t=l,s=i.pop()||1}e.push(t)}var pwe=1e-5,x6=1,vr=class Xu extends cS{constructor(e){if(super(),this._startToEndL=null,e.length<2)throw new Error("Bezier needs at least 2 endpoints");this.controls=e.slice()}get startToEndL(){return this._startToEndL===null&&(this._startToEndL=new je(this.start(),this.end())),this._startToEndL}build1(e){let r=[];return V2(e,(i,n)=>(r.push(n),!0)),new Xu(r)}start(){return this.controls[0]}end(){return this.controls[this.controls.length-1]}static pointOn(e,r){if(r.length<1)throw new Error("bezier must have at least 1 point");if(r.length===1)return r[0];{let i=new Array(r.length-1);for(let n=1;n<r.length;n++){let s=r[n-1],a=r[n],o=(a.x-s.x)*e,l=(a.y-s.y)*e;i[n-1]=s.add1(o,l)}return Xu.pointOn(e,i)}}clip1(e,r,i,n){if(i.push(r[0]),n.push(r[r.length-1]),r.length<2)throw new Error("bezier clip must have at least 2 point");if(r.length===2){let s=r[0],a=r[1],o=(a.x-s.x)*e,l=(a.y-s.y)*e,c=s.add1(o,l);i.push(c),n.push(c)}else{let s=new Array(r.length-1);for(let a=1;a<r.length;a++){let o=r[a-1],l=r[a],c=(l.x-o.x)*e,u=(l.y-o.y)*e;s[a-1]=o.add1(c,u)}this.clip1(e,s,i,n)}}clip(e){let r=[],i=[];return this.clip1(e,this.controls,r,i),[new Xu(r),new Xu(i.reverse())]}greater(e,r,i){return e-r>i}less(e,r,i){return e-r<-i}eq(e,r,i){return Math.abs(e-r)<=i}eqPP(e,r,i){return!e||!r?!1:this.eq(e.x,r.x,i)&&this.eq(e.y,r.y,i)}isInRange(e,r=Ct.eps){let i=this.controls.map(s=>s.y-e.y),n=0;for(let s of i){if(this.less(s,0,r))n=n|1;else if(this.greater(s,0,r))n=n|2;else{n=3;break}if(n===3)break}if(n!==3)return!1;n=0;for(let s of this.controls){let a=s.x-e.x;if(this.less(a,0,r))n=n|1;else if(this.greater(a,0,r))n=n|2;else{n=3;break}if(n===3)break}return n===3}getPercent(e,r=Ct.eps){if(!this.isInRange(e,r))return null;let i=Number.POSITIVE_INFINITY,n=[[this,0,1]];for(;n.length!==0;){let s=function(m){u=Math.min(u,m),d=Math.max(d,m)},a=function(m,y){let g=om(m,y);if(g===0)throw new Error("cnt === 0");for(let b=0;b<g;b+=2)s(_e[b])},[o,l,c]=n.pop();if(this.eqPP(o.start(),e,r))return l;if(this.eqPP(o.end(),e,r))return c;let u=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,A=o.controls.map(m=>m.y-e.y);i=A.reduce((m,y)=>{let g=Math.abs(y);return g<m?g:m},i),i/=2,i<=r&&(i=r),A.forEach((m,y)=>{this.eq(m,0,r)&&s(y/(A.length-1))});let h=new je(new nt(0,-i),new nt(1,-i)),f=new je(new nt(0,i),new nt(1,i));for(let m=0;m<A.length-1;m++){let y=new nt(m/(A.length-1),A[m]),g=this.less(y.y,0,r)?1:this.greater(y.y,0,r)?2:3;for(let b=0;b<A.length;b++){let E=new nt(b/(A.length-1),A[b]),w=this.less(E.y,0,r)?1:this.greater(E.y,0,r)?2:3;g!==w&&(g===1?w===2?(a(new je(y,E),h),a(new je(y,E),f)):a(new je(y,E),h):g===2?w===1?(a(new je(y,E),h),a(new je(y,E),f)):a(new je(y,E),f):w===1?a(new je(y,E),h):a(new je(y,E),f))}}if(!isFinite(u)){if(Math.max(...A.map(m=>Math.abs(m)))<r*4)return(l+c)/2;continue}if(u!==0&&(o=o.clip(u)[1],l=(c-l)*u+l),d!==1){let m=(d-u)/(1-u);o=o.clip(m)[0],c=(c-l)*m+l}if(!o.isInRange(e,r))continue;let p=o.controls.reduce((m,y)=>m.ext2(y),new od).build1();if(this.eq(p.minX,p.maxX,r)&&this.eq(p.minY,p.maxY,r))return(l+c)/2;if(d-u>.8){let[m,y]=o.clip(.5);m.isInRange(e,r)?(n.push([m,l,(l+c)/2]),y.isInRange(e,r)&&n.push([y,(l+c)/2,c])):n.push([y,(l+c)/2,c])}else n.push([o,l,c])}return null}toBezier(){return this}toString(){return"Bezier ["+this.controls.join(" ")+"]"}bbox(){return this._bbox||(this._bbox=new od().ext3(this.points(.1)).build1()),this._bbox}bboxWithControls(){return this._bbox_controls||(this._bbox_controls=new od().ext3(this.controls).build()),this._bbox_controls}multiply3(e){let r=new Array(this.controls.length);for(let i=0;i<this.controls.length;i++){let n=this.controls[i];r[i]=n.multiply3(e)}return new Xu(r)}stroke(e,r,i,n=x6){let s=hwe.zoomLines(dn.build4(this.points(n)),e);return i===0?s:s.reverse()}points(e){let r=[];return this.getBezierPoints(e,i=>r.push(i)),r}getBezierPoints(e,r){if(this.controls.length===2){r(this.start()),r(this.end());return}let i=[this];for(r(this.start());i.length!==0;){let s=i.pop(),a=new je(s.start(),s.end());if(n(s.controls,a)<=e)r(s.end());else{let[o,l]=s.clip(.5);i.push(l,o)}}function n(s,a){let o=a.start(),l=a.end();o.equals1(l)&&(l=o.add1(1,0));let c=l.y-o.y,u=o.x-l.x,d=-c*o.x-u*o.y,A=Math.sqrt(1/(c**2+u**2));c*=A,u*=A,d*=A;let h=s.map(f=>Math.abs(c*f.x+u*f.y+d));return Math.max(...h)}}getBezierPoints3(e,r){if(this.controls.length===2){r(this.start()),r(this.end());return}let i=e*e,n=this.controls[0],s=.5;for(;s>pwe&&!(n.distance2(Xu.pointOn(s,this.controls))<=i);s*=.5);let a=Math.ceil(1/s);s=1/a,r(n);let o=0;for(let l=1;l<a;l++)o+=s,r(Xu.pointOn(o,this.controls));r(this.end())}getPointsBySlope(e){if(this.controls.length===4)return this.getPointsBySlope4(e);throw new Error("Currently, only 4 control points are supported!")}getPointsBySlope4(e){let[r,i,n,s]=this.controls,a=-3*r.x+9*i.x-9*n.x+3*s.x,o=6*r.x-12*i.x+6*n.x,l=-3*r.x+3*i.x,c=[];if(Number.isFinite(e)){let u=-3*r.y+9*i.y-9*n.y+3*s.y,d=6*r.y-12*i.y+6*n.y,A=-3*r.y+3*i.y,h=u-a*e,f=d-o*e,p=A-l*e,m=-f/(2*h),y=Math.sqrt(f**2-4*h*p)/(2*h),g=m+y;g>=0&&g<=1&&c.push(Xu.pointOn(g,this.controls));let b=m-y;b>=0&&b<=1&&c.push(Xu.pointOn(b,this.controls))}else{let u=-o/(2*a),d=Math.sqrt(o**2-4*a*l)/(2*a),A=u+d;A>=0&&A<=1&&c.push(Xu.pointOn(A,this.controls));let h=u-d;h>=0&&h<=1&&c.push(Xu.pointOn(h,this.controls))}return c}buildConverxHull(e=Ct.eps){let r=[...this.controls],i=[],n=r[0],s=1;do{let a=r[s%r.length];this.eqPP(n,a,e)||i.push(new je(n,a)),n=a,s++}while(n!==r[0]);if(i.length===0)throw Error("buildConverxHull(diff = DoubleKit.eps)");return dn.build7(i).asClose()}getExtremePoints(e){if(!e)return a(this.controls);let r=e.start(),i=e.end(),n=i.x-r.x,s=i.y-r.y;if(Math.abs(n)<=Ct.eps||Math.abs(s)<=Ct.eps)return a(this.controls);{let o=s/n;if(this.controls.length===3){r.equals1(i)&&(i=r.add1(1,0));let l=i.y-r.y,c=r.x-i.x,u=-l*r.x-c*r.y,d=Math.sqrt(1/(l**2+c**2));l*=d,c*=d,u*=d;let A=this.controls.map(p=>l*p.x+c*p.y+u),h=A[0]-2*A[1]+A[2],f=A[1]-A[0]-o/2;if(h!==0){let p=-f/h;if(Ct.greater(p,0)&&Ct.less(p,1))return[Xu.pointOn(p,this.controls)]}}else if(this.controls.length===4)return this.getPointsBySlope(o)}return[];function a(o){let l,c;if(o.length===3){let[h,f,p]=o;l=rP(h,f,p,"x"),c=rP(h,f,p,"y")}else if(o.length===4){let[h,f,p,m]=o;l=iP(h,f,p,m,"x"),c=iP(h,f,p,m,"y")}l.sort((h,f)=>f-h),c.sort((h,f)=>f-h);let u=l.pop()||1,d=c.pop()||1,A=[];for(;u!==1||d!==1;)Ct.eq(u,d)?(u=l.pop()||1,d=c.pop()||1):u<d?(A.push(Xu.pointOn(u,o)),u=l.pop()||1):(A.push(Xu.pointOn(d,o)),d=c.pop()||1);return A}}getToLineMaxDis2(e){let r=this.getExtremePoints(e),i=e.distance2(this.start()),n=e.distance2(this.end()),s=Math.max(i,n);return r.forEach(o=>a(e.distance2(o))),s;function a(o){s=Math.max(s,o)}}getToLineMinAndMaxDis_Controls(e){let r=e.start(),i=e.end();e.start().equals1(e.end())&&(i=r.add1(1,0));let n=i.y-r.y,s=r.x-i.x,a=-n*r.x-s*r.y,o=Math.sqrt(1/(n**2+s**2));n*=o,s*=o,a*=o;let l=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY;return this.controls.forEach(u=>{let d=n*u.x+s*u.y+a;d<l&&(l=d),d>c&&(c=d)}),{minDis:l,maxDis:c}}getPercentInLine(e){let r=[],i=[],n=this.controls,s=e.start(),a=e.end(),o=a.y-s.y,l=s.x-a.x,c=-o*s.x-l*s.y,u=Math.sqrt(1/(o**2+l**2));if(o*=u,l*=u,c*=u,o**2+l**2<=0)return r;if(n.length===3){let[d,A,h]=n,f=o*(d.x-2*A.x+h.x)+l*(d.y-2*A.y+h.y),p=2*(o*(A.x-d.x)+l*(A.y-d.y)),m=o*d.x+l*d.y+c;i=Awe(f,p,m)}else if(n.length===4){let[d,A,h,f]=n,p=f.sub(h.mul(3)).add(A.mul(3)).sub(d),m=d.sub(A.mul(2)).add(h).mul(3),y=A.sub(d).mul(3),g=d,b=o*p.x+l*p.y,E=o*m.x+l*m.y,w=o*y.x+l*y.y,x=o*g.x+l*g.y+c,I=Math.sqrt(1/(b**2+E**2));b*=I,E*=I,w*=I,x*=I,i=fwe(b,E,w,x)}else throw Error("not support getBeizerPointInLine");return i.forEach(d=>{d>=0&&d<=1&&r.push(d)}),r}reverse(){return new Xu(this.controls.slice().reverse())}},sm,_X=(sm=class{constructor(){this.textCache=new Map,this.numCache=new Array(20),this.boxCache=new Array(4),this.textOffsetCache=new Array(9),this.BuildLineCache=new Array(7),this.BuildTrackCache=new Array(7),this.BuildViaCache=new Array(11),this.BuildBoxCache=new Array(10),this.BuildArcCache=new Array(10),this.BuildArcTrackCache=new Array(10),this.BuildTextCache=new Array(7),this.BuildPadStyleCache=new Array(4),this.BuildPadCache=new Array(12),this.ARRAY1=new Array(1),this.ARRAY2=new Array(2),this.ARRAY3=new Array(3),this.ARRAY4=new Array(4),this.ARRAY5=new Array(5),this.ARRAY6=new Array(6),this.ARRAY7=new Array(7),this.ARRAY8=new Array(8),this.ARRAY9=new Array(9),this.ARRAY10=new Array(10),this.ARRAY11=new Array(11),this.ARRAY12=new Array(12),this.textOffsetCache[0]=nt.ORIGIN,this.textOffsetCache[1]=new nt(0,-.5),this.textOffsetCache[2]=new nt(0,-1),this.textOffsetCache[3]=new nt(-.5,0),this.textOffsetCache[4]=new nt(-.5,-.5),this.textOffsetCache[5]=new nt(-.5,-1),this.textOffsetCache[6]=new nt(-1,0),this.textOffsetCache[7]=new nt(-1,-.5),this.textOffsetCache[8]=new nt(-1,-1)}static getCache(){return sm.instance==null&&(sm.instance=new sm),sm.instance}},sm.instance=null,sm),je=class j1 extends cS{constructor(e,r){super(),this._a=null,this._b=null,this._c=null,this.__bbox=null,this._hashed=null,this._direct=null,this._start=e,this._end=r}get a(){return this._a===null&&(this._start.equals1(this._end)?(this._a=NaN,this._b=NaN,this._c=NaN):(this._a=this._end.y-this._start.y,this._b=this._start.x-this._end.x,this._c=this._end.x*this._start.y-this._start.x*this._end.y)),this._a}get b(){return this._b===null&&(this._start.equals1(this._end)?(this._a=NaN,this._b=NaN,this._c=NaN):(this._a=this._end.y-this._start.y,this._b=this._start.x-this._end.x,this._c=this._end.x*this._start.y-this._start.x*this._end.y)),this._b}get c(){return this._c===null&&(this._start.equals1(this._end)?(this._a=NaN,this._b=NaN,this._c=NaN):(this._a=this._end.y-this._start.y,this._b=this._start.x-this._end.x,this._c=this._end.x*this._start.y-this._start.x*this._end.y)),this._c}get hashed(){return this._hashed==null&&(this._hashed=this._hashCode()),this._hashed}get direct(){return this._direct==null&&(this._direct=this._end.sub(this._start).normalize()),this._direct}cutLine(e){if(Ct.eq(this.distance(e),0)){let r=new j1(this._start,e);return r._a=this._a,r._b=this._b,r._c=this._c,r}return new j1(this._start,e)}get midPoint(){return this._start.add(this._end).mul(.5)}toBezier(){return new vr([this._start,this._end])}_hashCode(){let e=31,r=1;return r=e*r+this._start.hashCode(),r=e*r+this._end.hashCode(),r}start(){return this._start}end(){return this._end}center(){let e=this.start(),r=this.end();return e.add(r).mul(.5)}panDistance(e){let r=this._end.x-this._start.x,i=this._end.y-this._start.y,n=this.length();r=r*e/n,i=-i*e/n;let s=new nt(this._start.x+i,this._start.y+r),a=new nt(this._end.x+i,this._end.y+r);return new j1(s,a)}isPoint(){return this._start.distance2(this._end)<=1e-8}length(){return this._start.distance1(this._end)}toString(){return"Line [start="+this._start+", end="+this._end+"]"}bbox(){if(this.__bbox==null){let e=_X.getCache().boxCache;e[0]=Math.min(this._start.x,this._end.x),e[1]=Math.max(this._start.x,this._end.x),e[2]=Math.min(this._start.y,this._end.y),e[3]=Math.max(this._start.y,this._end.y),this.__bbox=new hu(e[0],e[1],e[2],e[3])}return this.__bbox}multiply3(e){return new j1(this._start.multiply3(e),this._end.multiply3(e))}hashCode(){return this.hashed}equals(e){let r=e;return this.hashed===r.hashed&&this._start.equals(r._start)&&this._end.equals(r._end)}equals1(e){let r=e;return this.hashed===r.hashed&&this._start.equals1(r._start)&&this._end.equals1(r._end)}equals2(e){let r=[this.start(),this.end()],i=[e.start(),e.end()];return qf(r,i)||qf(r,i.reverse())}stroke(e,r,i){let n,s,a;this._end.x<this._start.x?(s=this._start.x-this._end.x,a=this._start.y-this._end.y,n=this._end):(s=this._end.x-this._start.x,a=this._end.y-this._start.y,n=this._start);let o=Math.sqrt(s*s+a*a),l=e/2,c,u,d;r===2?(u=-l,d=o+l):(u=0,d=o),r===0||r===2?i===0?c=dn.build5([u,-l,u,l,d,l,d,-l]):c=dn.build5([u,l,u,-l,d,-l,d,l]):i===0?c=dn.build2([bt.build3(new nt(u,0),-90,-180,l,l),bt.build3(new nt(d,0),90,-180,l,l)]):c=dn.build2([bt.build3(new nt(u,0),90,180,l,l),bt.build3(new nt(d,0),-90,180,l,l)]);let A=Math.atan2(a,s),h=ko.rotate(A).translate1(n);return c.asClose().multiply3(h)}points(e){return[this._start,this._end]}mirrorY(e){return new j1(this.start().mirrorY(e),this.end().mirrorY(e))}reverse(){return new j1(this._end,this._start)}inArea(e,r,i){let n=e.x,s=e.y,a=this._start,o=this._end,l=i==1,c=n-a.x,u=s-a.y,d=n-o.x,A=s-o.y,h=o.x-a.x,f=o.y-a.y,p=new nt(-f,h).normalize(),m=h+p.x*r/2,y=f+p.y*r/2,g=m*m+y*y,b=c*c+u*u,E=d*d+A*A,w=Math.abs(c*f-u*h)/2,x=Math.sqrt(h*h+f*f)*r/4;if(w<=x&&b<=g&&E<=g){if(l)return!0;{let I=new nt(n,s).sub(o).normalize(),C=new nt(n,s).sub(a).normalize(),G=new nt(p.x,p.y).cross(I),U=new nt(p.x,p.y).cross(C);return G>=0&&U<=0}}else if(l){let I=r/2;return b<=I*I?!0:E<=I*I}else return!1}isParallel(e,r=!1){let i=Ct.eq(Math.abs(this.direct.cross(e.direct)),0),n=!r||Ct.greatereq(this.direct.dot(e.direct),0);return i&&n}distance2(e){return(this.a*e.x+this.b*e.y+this.c)**2/(this.a**2+this.b**2)}distance2ForPP(e){let{x:r,y:i}=e,{x:n,y:s}=this.start(),{x:a,y:o}=this.end();return((r-n)*(o-s)-(i-s)*(a-n))**2/((o-s)**2+(a-n)**2)}distance(e){return Math.abs(this.a*e.x+this.b*e.y+this.c)/Math.sqrt(this.a**2+this.b**2)}};function mwe(t,e=.05){if(t.length<3)return t.slice();let r=t.slice(0,1),i=(s,a,o)=>WEe(s.x,s.y,a.x,a.y,o.x,o.y);for(;;){r=t.slice(0,1);for(let s=1;s<t.length-1;s+=2)i(t[s],t[s-1],t[s+1])>e&&r.push(t[s]),r.push(t[s+1]);if(r.at(-1).equals1(t.at(-1))||r.push(t.at(-1)),t.length==r.length)break;t=r}let n=t[t.length-1];return r.push(n),r}var gwe=SEe(TEe());var ywe=class{constructor(){this.fac=new od,this.length=0,this.box=null,this.pt=null,this.i=0}calcBBox(t){for(this.fac.clear(),this.length=t.length,this.box=null,this.pt=null,this.i=0;this.i<this.length;this.i++)this.pt=t[this.i],this.box=this.pt.bbox(),this.fac.ext1(this.box);return this.fac.build1()}},bwe=new ywe,dn=class Co{constructor(e,r){this.__bbox=null,this.primitives=e,this.__bbox=r}static calcBBox(e){return bwe.calcBBox(e)}static build1(e){let r=[],i=null;return $_(e,(n,s)=>{let a=s.start();return i!==null&&!a.equals(i)&&r.push(new je(i,a)),r.push(s),i=s.end(),!0}),r.length===0&&i!=null&&r.push(new je(i,i)),new Co(r)}static build2(e){return Co.build1(r6(e))}static build3(e){let r=[],i=null;return $_(e,(n,s)=>(i!==null&&r.push(new je(i,s)),i=s,!0)),new Co(r)}static build4(e){return this.build3(r6(e))}static build5(e){let r=[];for(let i=0;i<e.length;i+=2)r.push(new nt(e[i],e[i+1]));return this.build4(r)}static build6(e){return Co.build4([e.LL(),e.LR(),e.UR(),e.UL(),e.LL()])}static build7(e){return new Co(e)}static build8(e){let r=new nt(e[0],e[1]),i,n=[],s,a=(o,l)=>o.length==l&&o.every(c=>typeof c=="number");for(let o=2;o<e.length;)switch(typeof e[o]=="string"?s=e[o]:o-=1,s){case"ARC":{let l=e.slice(o+1,o+4);if(!a(l,3))throw new Error("invalid rawData");let c=l[0];i=new nt(l[1],l[2]),n.push(bt.build5(r,i,c)),r=i,o+=4;break}case"L":{let l=e.slice(o+1,o+3);if(!a(l,2))throw new Error("invalid rawData");i=new nt(l[0],l[1]),n.push(new je(r,i)),r=i,o+=3;break}case"C":{let l=e.slice(o+1,o+7);if(!a(l,7))throw new Error("invalid rawData");let c=new nt(l[0],l[1]),u=new nt(l[2],l[3]);i=new nt(l[4],l[5]),n.push(new vr([r,c,u,i])),r=i,o+=7;break}default:throw new Error("invalid rawData")}return Co.build2(n)}static buildBBox(e,r=0){return r===1?Co.build5([e.minX,e.minY,e.maxX,e.minY,e.maxX,e.maxY,e.minX,e.maxY,e.minX,e.minY]):Co.build5([e.minX,e.minY,e.minX,e.maxY,e.maxX,e.maxY,e.maxX,e.minY,e.minX,e.minY])}static triangulate(e,r,i=1){if(e.length===1){let l=new Array;e[0].asClose().points2(i,A=>l.push(A));let c,u=l[0],d=[];for(let A=0;A<l.length-2;A+=2){let h=l[A+1],f=l[A+2],p=h.sub(u).normalize().cross(f.sub(u).normalize());if(Ct.neq(p,0)){if(c===!0){if(p<0){d.length=0;break}}else if(c===!1){if(p>0){d.length=0;break}}else c=p>0;d.push(u),d.push(h),d.push(f)}l.push(u),u=f}if(d.length!==0){for(let A=0;A<d.length;A+=3)r(d[A],d[A+1],d[A+2]);return}}let n=[],s=[];e.forEach(l=>{n.length!==0&&s.push(n.length/2),l.asClose().points2(i,c=>n.push(c.x,c.y))});let a=gwe.default(n,s),o=[];for(let l=1;l<n.length;l+=2)o.push(new nt(n[l-1],n[l]));for(let l=0;l<a.length;l+=3)r(o[a[l]],o[a[l+1]],o[a[l+2]])}lines(e,r){let i=new Array;this.points(e,s=>i.push(s));let n=i[0];for(let s=1;s<i.length;s++){let a=i[s];r(n),r(a),n=a}}triangles(e,r){Co.triangulate([this],(...i)=>{i.forEach(n=>r(n))},e)}mirror(){let e=[];return this.primitives.forEach(r=>{if(r instanceof je)r=new je(r.start().mirror(),r.end().mirror());else if(r instanceof bt)r=r.mirror();else if(r instanceof vr){let i=r.controls.map(n=>n.mirror());r=new vr(i)}else throw new Error("bug");e.push(r)}),new Co(e,this.__bbox)}getPoints(e){let r=[];for(let i of this.primitives)for(let n of i.points(e))r.push(n);return r}round(e=4){let r=this.primitives.slice();for(let i=0;i<r.length;i++){let n=r[i];if(n instanceof je){let s=n.start().round(e),a=n.end().round(e);r[i]=new je(s,a)}else if(n instanceof vr){let s=n.controls.map(a=>a.round(e));r[i]=new vr(s)}else if(n instanceof bt){let s=n.start().round(e),a=n.end().round(e),o=n.sweepAngle;r[i]=bt.build5(s,a,o)}}return new Co(r,this.__bbox)}simplify(e=.05){let r=[],i=!1,n=[],s=this.closed();if(this.primitives.length<=1)return Co.build2(this.primitives);let a=()=>{if(n.length>2){let l=mwe(n,e);for(let c=1;c<l.length;c++)r.push(new je(l[c-1],l[c]))}else r.push(new je(n[0],n[1]));n.length=0,i=!1};for(let l=0;l<this.primitives.length;l++){let c=this.primitives[l];c instanceof je?(i?n.push(c.end()):(n.length=0,n.push(c.start(),c.end()),i=!0),l===this.primitives.length-1&&a()):(i&&a(),r.push(c))}let o=new Co(r,this.__bbox);return s&&!o.closed()&&(o=o.asClose()),o}hasBackLine(){let{primitives:e}=this,r;for(let i=0;i<e.length;i++){let n=e[i];if(n instanceof je){if(n.end().equals1(n.start()))continue;if(r&&(n.end().equals1(r.start())||KEe(n.end(),r.start(),r.end())))return!0;r=n}else r=null}return!1}area(e=.1){let r=0,i=this.end();return this.primitives.forEach(n=>{let s=n.start(),a=n.end();if(r+=(s.x+i.x)*(s.y-i.y),n instanceof je)r+=(a.x+s.x)*(a.y-s.y);else if(n instanceof bt)r+=(a.x+s.x)*(a.y-s.y),r+=Math.PI*n.rx2*n.sweepAngle/180-nt.normal(n.center,n.start(),n.end());else if(n instanceof vr){let o=s;n.points(e).forEach(l=>{r+=(l.x+o.x)*(l.y-o.y),o=l}),r+=(a.x+o.x)*(a.y-o.y)}i=a}),r/2}closed(e){return this.primitives.length===0?!1:this.start().equals(this.end(),e)}asClose(){let e=this.primitives[0],r=this.primitives[this.primitives.length-1],i=e.start(),n=r.end();if(i.equals(n))return this;{let s=new Array;return du.addAll(s,this.primitives),s.push(new je(n,i)),Co.build2(s)}}closeEndpoint(){let e=this.primitives[0],r=this.primitives[this.primitives.length-1],i=e.start(),n=r.end();if(i.equals1(n))return this;{let s=new Array;return du.addAll(s,this.primitives),s.push(new je(n,i)),new Co(s)}}reverse(){let e=new Array(this.primitives.length);for(let r=0,i=this.primitives.length-1;i>=0;r++,i--){let n=this.primitives[i];if(n instanceof je)n=new je(n.end(),n.start());else if(n instanceof bt)n=n.exchangeSweep();else if(n instanceof vr)n=new vr(n.controls.slice().reverse());else throw new Error("bug");e[r]=n}return new Co(e,this.__bbox)}reverse1(){let e=new Array(this.primitives.length);for(let r=0,i=this.primitives.length-1;i>=0;r++,i--){let n=this.primitives[i];if(n instanceof je)n=new je(n.end(),n.start());else if(n instanceof bt)n=n.exchangeSweep1();else if(n instanceof vr)n=new vr(n.controls.slice().reverse());else throw new Error("bug");e[r]=n}return new Co(e,this.__bbox)}mirrorY(e){let r=[];return this.primitives.forEach(i=>{if(i instanceof je)i=i.mirrorY(e);else if(i instanceof bt)i=i.mirrorY(e);else if(i instanceof vr){let n=i.controls.map(s=>s.mirrorY(e));i=new vr(n)}else throw new Error("bug");r.push(i)}),new Co(r,this.__bbox)}points(e,r){if(this.primitives.length!==0){for(let i=0;i<this.primitives.length-1;i++){let n=this.primitives[i].points(e);n.pop(),n.forEach(s=>r(s))}this.primitives[this.primitives.length-1].points(e).forEach(i=>r(i))}}points1(e,r){if(this.primitives.length===0)return;for(let n=0;n<this.primitives.length-1;n++){let s=this.primitives[n],a=s instanceof bt?s.points1(e):s.points(e);a.pop(),a.forEach(o=>r(o))}let i=this.primitives[this.primitives.length-1];(i instanceof bt?i.points1(e):i.points(e)).forEach(n=>r(n))}points2(e,r){if(this.primitives.length===0)return;for(let n=0;n<this.primitives.length-1;n++){let s=this.primitives[n],a=s instanceof bt?s.points2():s.points(e);a.pop(),a.forEach(o=>r(o))}let i=this.primitives[this.primitives.length-1];(i instanceof bt?i.points2():i.points(e)).forEach(n=>r(n))}multiply3(e){let r=new Array(this.primitives.length);for(let i=0;i<this.primitives.length;i++)r[i]=this.primitives[i].multiply3(e);return Co.build7(r)}bbox(){return this.__bbox==null&&(this.__bbox=Co.calcBBox(this.primitives)),this.__bbox}start(){return this.primitives.length!==0?this.primitives[0].start():null}end(){return this.primitives.length!==0?this.primitives[this.primitives.length-1].end():null}isClose(e){if(this.primitives.length<=1&&!(this.primitives[0]instanceof bt))return!1;{let r=this.primitives[0],i=this.primitives[this.primitives.length-1];return r.start().equals(i.end(),e)}}isEqual(e){if(e instanceof Co&&e.primitives.length==this.primitives.length){let r=e.primitives.length;for(let i=0;i<r;i++){let n=e.primitives[i],s=this.primitives[i];if(JSON.stringify(n)!=JSON.stringify(s))return!1}return!0}return!1}equals(e){if(!e)return!1;let r=this.primitives,i=e.primitives;if(r.length!=i.length)return!1;if(e.isClose()){let n=0;for(;n<r.length;){let s=r.slice(n).concat(r.slice(0,n));if(qf(s,i)||qf(s.reverse(),i))return!0;n++}return!1}else return qf(this.primitives,e.primitives)}clone(){return Co.build2(this.primitives)}putItem(e,r){if(!e)return!1;if(e instanceof Co)return this.mergePolyline(e,r);let i=this.start();if(!i){this.primitives.push(e),this.__bbox=e.bbox();return}let n=this.end();if(i.equals(n,r))return!1;let s=e.start(),a=e.end(),o=!1,l=!1;if(i.equals(s,r))o=!0,l=!1;else if(i.equals(a,r))o=!1,l=!1;else if(n.equals(s,r))o=!1,l=!0;else if(n.equals(a,r))o=!0,l=!0;else return!1;return l?this.primitives.push(o?e.reverse():e):this.primitives.unshift(o?e.reverse():e),this.__bbox=hu.extend2(this.__bbox,e.bbox()),!0}mergePolyline(e,r,i=0){if(!e)return!1;let n=this.start();if(!n){this.primitives.push(...e.primitives),this.__bbox=e.bbox();return}let s=this.end();if(n.equals(s,r))return!1;let a=e.start(),o=e.end(),l=!1,c=!1;if(n.equals(a,r))l=!0,c=!1;else if(n.equals(o,r))l=!1,c=!1;else if(s.equals(a,r))l=!1,c=!0;else if(s.equals(o,r))l=!0,c=!0;else return!1;let u=l?e.reverse():e;return c?this.primitives.push(...u.primitives):this.primitives.unshift(...u.primitives),this.__bbox=hu.extend2(this.__bbox,e.bbox()),!0}deDuplicationPoint(e){let r=this.primitives[this.primitives.length-1].start(),i=this.primitives[this.primitives.length-1].end(),n=e.primitives[0].start(),s=e.primitives[0].end();if(this.primitives[this.primitives.length-1]instanceof je&&e.primitives[0]instanceof je&&iwe([r,i],[n,s])){this.primitives.pop(),e.primitives.shift();let a=[];a.push(new je(r,s)),this.primitives.push(...a)}}getMaxBBoxHeightByVec(e){let r=e.normalize(),i=-1/0,n=1/0;if(this.primitives.forEach(a=>{let o=a.start().dot(r),l=a.end().dot(r);if(s(o),s(l),a instanceof bt){let c=e.angleD(nt.ORIGIN);if(a.angleIsInArc(c)){let u=a.pointOn(c).dot(r);s(u)}if(a.angleIsInArc(c+180)){let u=a.pointOn(c-180).dot(r);s(u)}}}),i-n<=0)throw new Error("getMaxBBoxHeightByVec");return i-n;function s(a){a>i&&(i=a),a<n&&(n=a)}}getWindingNum(e){let r=this.end(),i=0,{x:n,y:s}=e;for(let o of this.primitives){if(r.y>s?o.bbox().minY>s:o.bbox().maxY<=s){r=o.end();continue}if(o instanceof bt&&(o.isCCW?Math.floor(o.startAngle/90)+1!==Math.ceil(o.endAngle()/90):Math.ceil(o.startAngle/90)-1!==Math.floor(o.endAngle()/90))){let l=o.startAngle,c=o.endAngle();if(o.sweepAngle>0){let u=90;for(;u<=c;)u>l&&(a(bt.build3(o.center,l,u-l,o.rx,o.ry)),l=u),u+=90;l<c&&a(bt.build3(o.center,l,c-l,o.rx,o.ry))}else{let u=270;for(;u>=c;)u<l&&(a(bt.build3(o.center,l,u-l,o.rx,o.ry)),l=u),u-=90;l>c&&a(bt.build3(o.center,l,c-l,o.rx,o.ry))}}else if(o instanceof vr){let l=[];DX(o,l),l.forEach(c=>a(c))}else a(o)}return i;function a(o){let l=o.start(),c=o.end();if(r.y>s!=l.y>s&&(r.x>n?l.x>n?i+=l.y>r.y?1:-1:r.y>l.y?(r.x-n)*(l.y-s)-(r.y-s)*(l.x-n)<0&&i--:(r.x-n)*(l.y-s)-(r.y-s)*(l.x-n)>0&&i++:l.x>n&&(r.y>l.y?(r.x-n)*(l.y-s)-(r.y-s)*(l.x-n)<0&&i--:(r.x-n)*(l.y-s)-(r.y-s)*(l.x-n)>0&&i++)),l.y>s!=c.y>s){if(l.x>n)if(c.x>n)i+=c.y>l.y?1:-1;else if(o instanceof je)l.y>c.y?(l.x-n)*(c.y-s)-(l.y-s)*(c.x-n)<0&&i--:(l.x-n)*(c.y-s)-(l.y-s)*(c.x-n)>0&&i++;else if(o instanceof bt){let{center:u,isCCW:d,rx2:A}=o,h=(u.x-n)**2+(u.y-s)**2;l.y>c.y?(d?h>A:h<A)&&i--:(d?h<A:h>A)&&i++}else if(o instanceof vr){if(Xz(o,s)===0)throw new Error("no inters");_e[0]>n&&(i+=c.y>l.y?1:-1)}else throw new Error("not support!");else if(c.x>n)if(o instanceof je)l.y>c.y?(l.x-n)*(c.y-s)-(l.y-s)*(c.x-n)<0&&i--:(l.x-n)*(c.y-s)-(l.y-s)*(c.x-n)>0&&i++;else if(o instanceof bt){let{center:u,isCCW:d,rx2:A}=o,h=(u.x-n)**2+(u.y-s)**2;l.y>c.y?(d?h>A:h<A)&&i--:(d?h<A:h>A)&&i++}else if(o instanceof vr){if(Xz(o,s)===0)throw new Error("no inters");_e[0]>n&&(i+=c.y>l.y?1:-1)}else throw new Error("not support!")}r=c}}},M_=Math.PI*2;var j9e=Math.PI/2,Q9e=Math.sin(Math.PI/180);var xwe=4,bt=class na extends cS{constructor(e,r,i,n,s){super(),this._rx2=null,this._ry2=null,this._svgEnd=null,this._hashed=null,this.__bbox=null,this.rx=e,this.ry=r,this.center=i,this.startAngle=n,this.sweepAngle=s,this._start=nt.ORIGIN,this._end=nt.ORIGIN,this._start=this.pointOn(n),this._end=this.pointOn(n+s)}get hashed(){return this._hashed==null&&(this._hashed=this._hashCode()),this._hashed}hashCode(){return this.hashed}_hashCode(){let e=31,r=1;return r=e*r+new nt(this.rx,this.rx).hashCode(),r=e*r+this.center.hashCode(),r=e*r+new nt(this.startAngle,this.sweepAngle).hashCode(),r}get rx2(){return this._rx2==null&&(this._rx2=this.rx*this.rx),this._rx2}get ry2(){return this._ry2==null&&(this._ry2=this.ry*this.ry),this._ry2}get svgEnd(){return this._svgEnd==null&&(this._svgEnd=this.getSvgEnd(this.startAngle,this.sweepAngle,this._start,this._end)),this._svgEnd}getSvgEnd(e,r,i,n){let s=r>=0?-.01:.01,a=e+r;for(;(r>=0&&a>e||r<0&&a<e)&&i.distance2(n)<2e-4;)s*=2,a+=s,n=this.pointOn(a);return n}static build1(e,r,i,n,s,a){Sa.positive(i),Sa.positive(n);let o=e.equals(r);if(o)return new na(i,n,e,0,s?360:0);{let l=e.x,c=-e.y,u=r.x,d=-r.y,A=a===0,h=(l-u)/2,f=(c-d)/2,p=Math.cos(0),m=Math.sin(0),y=p*h+m*f,g=-m*h+p*f;i=Math.abs(i),n=Math.abs(n);let b=i*i,E=n*n,w=y*y,x=g*g,I=s===A?-1:1,C=(b*E-b*x-E*w)/(b*x+E*w);C=C<0?0:C;let G=I*Math.sqrt(C),U=G*(i*g/n),_=G*-(n*y/i),H=(l+u)/2,Q=(c+d)/2,j=H+(p*U-m*_),$=Q+(m*U+p*_),B=(y-U)/i,M=(g-_)/n,v=(-y-U)/i,N=(-g-_)/n,R,q;q=Math.sqrt(B*B+M*M),R=B,I=M<0?-1:1;let P=Bi.toDegrees(I*Math.acos(R/q));q=Math.sqrt((B*B+M*M)*(v*v+N*N)),R=B*v+M*N,I=B*N-M*v<0?-1:1;let z=R/q,W;z<-1?W=Math.acos(-1):z>1?W=Math.acos(1):W=Math.acos(z);let oe=Bi.toDegrees(I*W);!A&&oe>0?oe-=360:A&&oe<0&&(oe+=360),Sa.normal(P),Sa.normal(oe);let Ae=h*h/b+f*f/E,me=e.distance1(r)/2;i<me&&n<me&&(i*=Math.sqrt(Ae),n*=Math.sqrt(Ae));let ve=o?0:Bi.regularD(-P),Le=o?s?360:0:-oe;return new na(i,n,new nt(j,-$),ve,Le)}}static build2(e,r,i,n,s,a){Sa.positive(n),Sa.positive(s),Sa.normal(r),Sa.normal(i);let o;return r===i?(r=Bi.regularD(r),i=Bi.regularD(i),o=0):(r=Bi.regularD(r),i=Bi.regularD(i),a===1?i<=r&&(i+=360):i>=r&&(r+=360),o=i-r),new na(n,s,e,Bi.regularD(r),o)}static build3(e,r,i,n,s){return Sa.positive(n),Sa.positive(s),Sa.normal(i),new na(n,s,e,Bi.regularD(r),i)}static build4(e,r,i,n,s,a){let o=e.angleD(i),l=r.angleD(i);return na.build2(i,o,l,n,s,a)}static build5(e,r,i){i=Bi.toRadians(i);let n=r.sub(e),s=new nt(-n.y,n.x).normalize(),a=Math.abs(i)/2,o;if(a!=0)o=n.length()/2/Math.sin(a);else throw new Error("Can't represent circle!!!");let l=s.rotate(nt.ORIGIN,a),c,u;i>0?(c=1,u=r.add(l.scale(o))):(c=0,u=e.sub(l.scale(o)));let d=Bi.toDegrees(e.angle(u)),A=Bi.toDegrees(r.angle(u));return na.build2(u,d,A,o,o,c)}static buildCircle(e,r,i=0){return na.build2(e,0,360,r,r,i)}start(){return this._start}end(){return this._end}isLarge(){return Math.abs(this.sweepAngle)>180}sweep(){return this.sweepAngle>=0?1:0}get isCCW(){return this.sweepAngle>=0}endAngle(){return this.startAngle+this.sweepAngle}pointOn(e){e=Bi.regularD(e);let r=this.rx,i=this.ry;if(e===0)return this.center.add1(r,0);if(e===90)return this.center.add1(0,i);if(e===180)return this.center.add1(-r,0);if(e===270)return this.center.add1(0,-i);{let n=this.rx2,s=this.ry2,a=Math.tan(Bi.toRadians(e)),o=a*a,l=Math.sqrt(n*s/(n+s/o)),c=Math.sqrt(n*s/(s+n*o));return e>90&&e<270&&(c=-c),e>180&&e<360&&(l=-l),isNaN(c)&&(c=0),isNaN(l)&&(l=0),this.center.add1(c,l)}}exchangeSweep(){return na.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle,this.rx,this.ry)}exchangeSweepAndStart(){return na.build1(this.end(),this.start(),this.rx,this.ry,this.isLarge(),this.sweepAngle>=0?0:1)}exchangeSweep1(){return na.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle+.01,this.rx,this.ry)}mirrorY(e){let r=this.start(),i=this.end();return r.equals(i)?na.build3(this.center.mirrorY(),0,360,this.rx,this.ry):na.build1(r.mirrorY(e),i.mirrorY(e),this.rx,this.ry,this.isLarge(),this.sweepAngle>=0?0:1)}mirror(e=nt.ORIGIN){let r=this.start(),i=this.end();return r.equals(i)?na.build3(this.center.mirror(e),0,360,this.rx,this.ry):na.build1(r.mirror(e),i.mirror(e),this.rx,this.ry,this.isLarge(),this.sweep())}sectorArea(){return Math.abs(this.sweepAngle)/360*Math.PI*this.rx*this.ry}area(){let e=i6.area(this.center,this._start,this.pointOn(this.endAngle()));return this.sectorArea()-e}multiply3(e){let r;e.isMirrored()?r=-this.sweepAngle:r=this.sweepAngle;let i;return e.equals(ko.ROT_90)?i=Bi.regularD(this.startAngle+90):e.equals(ko.ROT_N90)?i=Bi.regularD(this.startAngle-90):i=Bi.transformD(this.startAngle,e),na.build3(this.center.multiply3(e),i,r,e.iScale*this.rx,e.iScale*this.ry)}angleIsInArc(e){return e=Bi.regularD(e),this.sweepAngle>0?(e<this.startAngle&&(e+=360),this.endAngle()>e):(e>this.startAngle&&(e-=360),this.endAngle()<e)}toBezier(){if(Math.abs(this.sweepAngle)>90)throw new Error("not support!");let e=this.start(),r=this.end(),i=Bi.toRadians(this.sweepAngle)/2,n=4/3*(1-Math.cos(i))/Math.sin(i)*this.rx;return new vr([e,e.add(new nt(n,0).multiply3(ko.rotateD(this.startAngle+90))),r.add(new nt(n,0).multiply3(ko.rotateD(this.endAngle()-90))),r])}toBezier2(){let e=[];i(this,90);let r=[];return e.forEach(n=>r.push(n.toBezier())),r;function i(n,s){if(Math.abs(n.sweepAngle)>s){let a=n.sweepAngle/2;i(na.build3(n.center,n.startAngle,a,n.rx,n.ry),s),i(na.build3(n.center,n.startAngle+a,a,n.rx,n.ry),s)}else e.push(n)}}buildBBox(){let e=_X.getCache().boxCache,r=this.startAngle+this.sweepAngle;if(e[0]=Math.min(this._start.x,this._end.x),e[1]=Math.max(this._start.x,this._end.x),e[2]=Math.min(this._start.y,this._end.y),e[3]=Math.max(this._start.y,this._end.y),this.sweepAngle>0){let i=0;for(;i<r;){if(i>this.startAngle){let n=this.pointOn(i);e[0]=Math.min(e[0],n.x),e[1]=Math.max(e[1],n.x),e[2]=Math.min(e[2],n.y),e[3]=Math.max(e[3],n.y)}i+=90}}else if(this.sweepAngle<0){let i=360;for(;i>r;){if(i<this.startAngle){let n=this.pointOn(i);e[0]=Math.min(e[0],n.x),e[1]=Math.max(e[1],n.x),e[2]=Math.min(e[2],n.y),e[3]=Math.max(e[3],n.y)}i-=90}}return new hu(e[0],e[1],e[2],e[3])}bbox(){return this.__bbox==null&&(this.__bbox=this.buildBBox()),this.__bbox}length(){return Math.abs(this.rx*this.sweepAngle*Math.PI/180)}toString(){return G2.format("Arc [start=%s, end=%s, rx=%s, ry=%s, center=%s, startAngle=%s, sweepAngle=%s]",this._start,this._end,this.rx,this.ry,this.center,this.startAngle,this.sweepAngle)}stroke(e,r,i){let n=e/2,s=this.rx+n,a=this.ry+n,o=this.rx-n,l=this.ry-n,c=new ko;o<0&&(o=-o,c=c.multiply3(ko.MIRROR_Y)),l<0&&(l=-l,c=c.multiply3(ko.MIRROR_X)),o===0&&(o=.001),l===0&&(l=.001),c=c.setOrigin1(this.center);let u,d;switch(i===this.sweep()?(u=na.build3(this.center,this.startAngle,this.sweepAngle,s,a),d=na.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle,o,l)):(u=na.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle,s,a),d=na.build3(this.center,this.startAngle,this.sweepAngle,o,l)),d=d.multiply3(c),r){case 1:{let A=i===1?180:-180,h=i===this.sweep()?this.pointOn(this.endAngle()):this.pointOn(this.startAngle),f=i===this.sweep()?this.pointOn(this.startAngle):this.pointOn(this.endAngle()),p=u.pointOn(u.endAngle()).angleD(h),m=d.pointOn(d.endAngle()).angleD(f);return dn.build2([u,na.build3(h,p,A,n,n),d,na.build3(f,m,A,n,n)])}default:return dn.build2([u,d])}}points2(){let e=Math.ceil(Math.abs(this.sweepAngle)/xwe),r=this.sweepAngle/e,i=[this._start];for(let n=1;n<e;n++)i.push(this.pointOn(this.startAngle+r*n));return i.push(this._end),i}points1(e){let r=Math.max(this.rx,this.ry);if(r<=e)return[this.start(),this.svgEnd];let i=(r-e)/r,n=Math.ceil(Math.abs(this.sweepAngle/Bi.toDegrees(Math.acos(i))/2)),s=new Array(n+1),a=this.sweepAngle/n,o=this.startAngle;for(let l=0;l<=n;l++,o+=a)s[l]=this.pointOn(o);return s}points(e){let r=Math.max(this.rx,this.ry);if(e=Math.abs(e),r<=e)return[this.start(),this.svgEnd];e=Math.max(e,r*1e-5),e=Math.min(e,r*(1-Math.SQRT1_2));let i=(r-e)/r,n=Math.ceil(Math.abs(this.sweepAngle/Bi.toDegrees(Math.acos(i))/2));n=Math.max(n,2);let s=new Array(n+1),a=this.sweepAngle/n,o=this.startAngle+a;s[0]=this.start();for(let l=1;l<n;l++,o+=a)s[l]=this.pointOn(o);return s[n]=this.end(),s}panDistance(e){return this.sweepAngle>0?new na(this.rx-e,this.ry-e,this.center,this.startAngle,this.sweepAngle):new na(this.rx+e,this.ry+e,this.center,this.startAngle,this.sweepAngle)}panDistance1(e){if(this.sweepAngle>0){let r=this.rx-e;return r<0?(r=Math.abs(r),na.build3(this.center,this.startAngle-180,this.sweepAngle,r,r)):new na(r,r,this.center,this.startAngle,this.sweepAngle)}else{let r=this.rx+e;return r<0?(r=Math.abs(r),na.build3(this.center,this.startAngle-180,this.sweepAngle,r,r)):new na(r,r,this.center,this.startAngle,this.sweepAngle)}}get bulge(){let e=Math.abs(XEe(this.sweepAngle,3))/180*Math.PI;return Math.tan(e/4)}get midPoint(){let e=Bi.toRadians(this.startAngle),r=Bi.toRadians(this.endAngle()),i=this.sweep(),n=this.center,s=this.rx;if(i==1)if(r>e){let a=(r-e)/2+e;return n.add(new nt(Math.cos(a),Math.sin(a)).mul(s))}else{if(r==e)return n.add(new nt(Math.cos(Math.PI*3/2),Math.sin(Math.PI*3/2)).mul(s));{let a=(r+M_-e)/2+e;return n.add(new nt(Math.cos(a),Math.sin(a)).mul(s))}}else if(r>e){let a=(e+M_-r)/2+r;return n.add(new nt(Math.cos(a),Math.sin(a)).mul(s))}else{if(r==e)return n.add(new nt(Math.cos(Math.PI*3/2),Math.sin(Math.PI*3/2)).mul(s));{let a=(e-r)/2+r;return n.add(new nt(Math.cos(a),Math.sin(a)).mul(s))}}}get svgPathData(){return[{type:"M",values:[this._start.x,this._start.y]},{type:"A",values:[this.rx,this.ry,0,this.isLarge()?1:0,this.isCCW,this._end.x,this._end.y]}]}equals(e){let r=Bi.regularD(this.startAngle),i=Bi.regularD(this.sweepAngle),n=Bi.regularD(e.startAngle),s=Bi.regularD(e.sweepAngle);return qf([this.rx,this.ry,this.center,Math.abs(i)],[e.rx,e.ry,e.center,Math.abs(s)])&&(qf([i,r],[s,n])||qf([Bi.regularD(r+i)],[n]))}equals1(e){let r=Bi.regularD(this.startAngle),i=Bi.regularD(this.sweepAngle),n=Bi.regularD(e.startAngle),s=Bi.regularD(e.sweepAngle);return qf([this.rx,this.ry,this.center,Math.abs(i)],[e.rx,e.ry,e.center,Math.abs(s)])&&(qf([i,r],[s,n])||qf([Bi.regularD(r+i)],[n]))}inArea(e,r){let i=e.x,n=e.y,s=this.center,a=this.rx,o=Bi.toRadians(this.startAngle);this.sweep()==0&&(o=Bi.toRadians(this.endAngle()));let l=Bi.toRadians(this.endAngle());this.sweep()==0&&(l=Bi.toRadians(this.startAngle));let c=a-r/2,u=a+r/2;var d=i-s.x,A=n-s.y,h=Math.atan2(A,d);if(h<0&&(h+=M_),o<=l&&h>=o&&h<=l||o>l&&(h>=o&&h<=M_||h>=0&&h<=l)||o==l){var f=Math.sqrt(d*d+A*A);return f<=u&&f>=c}else{var f=(u+c)/2,p=new nt(s.x+Math.cos(o)*f,s.y+Math.sin(o)*f),m=new nt(s.x+Math.cos(l)*f,s.y+Math.sin(l)*f),y=i-p.x,g=n-p.y,b=i-m.x,E=n-m.y;return y*y+g*g<=r*r/4?!0:b*b+E*E<=r*r/4}}isCircle(){return(Ct.eq(Math.abs(this.sweepAngle),360)||this._start.equals1(this._end))&&this.rx==this.ry}reverse(){return na.build3(this.center,this.endAngle(),-this.sweepAngle,this.rx,this.ry)}getAngle(){let e=Math.PI*2;return this.sweep()==1?(this.endAngle()-this.startAngle+e)%e:(this.startAngle-this.endAngle()+e)%e}isValid(){return this.rx>0&&this.ry>0}},PX=new ArrayBuffer(24),VM=new Float64Array(PX),L2=new Int32Array(PX),Jo,z9e=(Jo=class{static normal(e,r,i){let n=r.sub(e),s=i.sub(r);return n.cross(s)}constructor(e,r,i){this.x=Sa.normal(e),this.y=Sa.normal(r),this.z=Sa.normal(i),VM[0]=e,VM[1]=r,VM[2]=i,this.hashed=L2[0]^L2[1]^L2[2]^L2[3]^L2[4]^L2[5]}isZeroVector(){return this.x===0&&this.y===0&&this.z===0}hashCode(){return this.hashed}equals(e){return e instanceof Jo?e.x===this.x&&e.y===this.y&&e.z===this.z:!1}cross(e){return new Jo(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){var e=this.length();return new Jo(this.x/e,this.y/e,this.z/e)}sub(e){return new Jo(this.x-e.x,this.y-e.y,this.z-e.z)}add(e){return new Jo(this.x+e.x,this.y+e.y,this.z+e.z)}scale(e){return new Jo(this.x*e,this.y*e,this.z*e)}neg(){return new Jo(-this.x,-this.y,-this.z)}multiply4(e){var r=this.x*e.data[0]+this.y*e.data[4]+this.z*e.data[8]+e.data[12],i=this.x*e.data[1]+this.y*e.data[5]+this.z*e.data[9]+e.data[13],n=this.x*e.data[2]+this.y*e.data[6]+this.z*e.data[10]+e.data[14],s=this.x*e.data[3]+this.y*e.data[7]+this.z*e.data[11]+e.data[15];return s!=0?new Jo(r/s,i/s,n/s):new Jo(r,i,n)}rotate(e,r){return this.multiply4(SX.rotateAxis(e,r))}toVector2(){return new nt(this.x,this.y)}},Jo.ORIGIN=new Jo(0,0,0),Jo.X_UNIT_VECTOR=new Jo(1,0,0),Jo.Y_UNIT_VECTOR=new Jo(0,1,0),Jo.Z_UNIT_VECTOR=new Jo(0,0,1),Jo);var lo=class k2{static build(e){return e instanceof dn?new k2([new $o([e])]):e instanceof $o?new k2([e]):e}static buildByPolygon(e){return e?new k2([e]):new k2([])}static buildByStroke(e,r,i=1,n){return this.buildByPolygon($o.buildByStroke(e,r,i,x6,n))}static buildCircle(e,r){return this.buildByPolygon($o.buildCircle(e,r))}static buildRect(e){return this.buildByPolygon($o.buildRect(e))}static buildBBox(e){return this.buildByPolygon($o.buildBBox(e))}constructor(e){this.items=e.slice()}multiply3(e){return new k2(this.items.map(r=>r.multiply3(e)))}bbox(){return this._bbox||(this._bbox=this.items.reduce((e,r)=>e.ext1(r.bbox()),new od).build1()),this._bbox}toPolylineGroups(){return this.items.map(e=>e.toPolylineGroup())}},Ss,Wn=(Ss=class{static isHexFormate(e){return!e||typeof e!="string"?!1:/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)}static of1(e){return this.of2(e>>16&255,e>>8&255,e&255)}static of2(e,r,i,n=255){return new Ss(e/255,r/255,i/255,n/255)}static of3(e){e.startsWith("#")&&(e=e.substr(1));let r=e.length;if(r==3)return new Ss(parseInt(e[0],16)/15,parseInt(e[1],16)/15,parseInt(e[2],16)/15);if(r==6)return new Ss(parseInt(e.substr(0,2),16)/255,parseInt(e.substr(2,2),16)/255,parseInt(e.substr(4,2),16)/255);if(r==8)return new Ss(parseInt(e.substr(0,2),16)/255,parseInt(e.substr(2,2),16)/255,parseInt(e.substr(4,2),16)/255,parseInt(e.substr(6,2),16)/255);throw new Error("invalid color string")}static of4(e){let r=parseInt(e.r*255+"").toString(16),i=parseInt(e.g*255+"").toString(16),n=parseInt(e.b*255+"").toString(16);return r.length<2&&(r="0"+r),i.length<2&&(i="0"+i),n.length<2&&(n="0"+n),("#"+r+i+n).toUpperCase()}static of5(e,r){if(e.startsWith("#")&&(e=e.substr(1)),e.length==3)return new Ss(parseInt(e[0],16)/15,parseInt(e[1],16)/15,parseInt(e[2],16)/15,r);if(e.length==6)return new Ss(parseInt(e.substr(0,2),16)/255,parseInt(e.substr(2,2),16)/255,parseInt(e.substr(4,2),16)/255,r);throw new Error("invalid color string")}static of6(e,r){return new Ss(e.r,e.g,e.b,r)}static of7(e){return e==null?null:Ss.of3(e)}constructor(e,r,i,n=1){this.r=Sa.positiveOr0(e),this.g=Sa.positiveOr0(r),this.b=Sa.positiveOr0(i),this.alpha=n}hashCode(){return this.r+this.g+this.b+this.alpha}equals(e,r=!1){let i=this.r===e.r&&this.g===e.g&&this.b===e.b;return r?i:i&&this.alpha===e.alpha}add(e,r,i,n){return new Ss(Math.max(0,Math.min(1,this.r+e)),Math.max(0,Math.min(1,this.g+r)),Math.max(0,Math.min(1,this.b+i)),Math.max(0,Math.min(1,this.alpha+n)))}mul(e){return new Ss(Math.max(0,Math.min(1,this.r*e)),Math.max(0,Math.min(1,this.g*e)),Math.max(0,Math.min(1,this.b*e)),this.alpha)}mul1(e){return new Ss(Math.max(0,this.r*e),Math.max(0,this.g*e),Math.max(0,this.b*e),this.alpha)}getData(){return[this.r,this.g,this.b,this.alpha]}toString(){let e=(this.r*255).toString(16),r=(this.g*255).toString(16),i=(this.b*255).toString(16);return e.length<2&&(e="0"+e),r.length<2&&(r="0"+r),i.length<2&&(i="0"+i),"#"+e.substr(0,2)+r.substr(0,2)+i.substr(0,2)}toString1(){let e=(this.r*255).toString(16),r=(this.g*255).toString(16),i=(this.b*255).toString(16),n=(this.alpha*255).toString(16);return e.length<2&&(e="0"+e),r.length<2&&(r="0"+r),i.length<2&&(i="0"+i),n.length<2&&(n="0"+n),"#"+e.substr(0,2)+r.substr(0,2)+i.substr(0,2)+n.substr(0,2)}toRGBA(){let e=this.r*255,r=this.g*255,i=this.b*255;return[e,r,i,this.alpha]}toRGBAString(){let e=this.r*255,r=this.g*255,i=this.b*255;return`rgba(${e},${r},${i},${this.alpha})`}isWHITE(){return this.r===1&&this.g===1&&this.b===1&&this.alpha===1}},Ss.WHITE=new Ss(1,1,1,1),Ss.BLACK=new Ss(0,0,0,1),Ss.RED=new Ss(1,0,0,1),Ss.GREEN=new Ss(0,1,0,1),Ss.BLUE=new Ss(0,0,1,1),Ss.Gray=Ss.of3("#9966ff"),Ss.Silver=Ss.of3("#D2D2D2"),Ss.Golden=Ss.of3("#DCAA14"),Ss.Pink=Ss.of3("#ffaec9"),Ss),eX=!1,LX=class{onRTreeBBox(t){}onResultSide(t){}onOriginSide(t){}onSplitedSide(t){}onDebugSide(t){}onSweep(t,e,r,i,n,s){}onIntersect(t,e,r){}onSegment(t,e,r,i,n,s){}onSegment1(t,e,r){if(eX){let i=new nt(t.getX(r),r),n=new nt(e.getX(r),r);this.onSegment(i,t.weight,t,n,e.weight,e)}else this.onSegment(t.start,t.weight,t,e.end,e.weight,e)}onSweep1(t,e,r){if(eX){let i=new nt(t.getX(r),r),n=new nt(e.getX(r),r);this.onSweep(i,t.weight,t,n,e.weight,e)}else this.onSweep(t.start,t.weight,t,e.end,e.weight,e)}},iS=class extends LX{constructor(t){super(),this.plGrps=new Array,this.debug=t}onPolylineGroup(t,e){this.plGrps.push(t)}},uS=class{constructor(t){this.cache={},this.levels=t,this.result=new Array(t),this.weights=new Array(t),this.maxIdx=t-1,this.rule=this.decide.bind(this);let e=1;for(let r=0;r<t;r++)this.weights[r]=e,e*=50}weight(t){return this.weights[t]}decide(t){t=Math.abs(t);let e=this.cache[t];if(e===void 0){let r=t;for(let i=this.maxIdx;i>=0;i--){let n=this.weights[i],s=t/n|0,a=t%n;a>(n/2|0)?(t=n-a,s++):t=a,this.result[i]=s>0}e=this.decide1(this.result),this.cache[r]=e}return e}},Ewe=t=>t!==0;var wwe=new class extends uS{decide1(t){return t[0]||t[1]}}(2),z_=new class extends uS{decide1(t){return t[0]&&!t[1]}}(2),X_=new class extends uS{decide1(t){return t[0]&&t[1]}}(2),q_=new class extends uS{decide1(t){return t[0]&&!t[1]||!t[0]&&t[1]}}(2),vwe=(t=>(t[t.UNMARKED=0]="UNMARKED",t[t.INSIDE=1]="INSIDE",t[t.OUTSIDE=2]="OUTSIDE",t[t.INVALID=3]="INVALID",t))(vwe||{}),Q2=class F2{constructor(e,r,i,n,s,a,o){this.inters=[],this.connect=new Array,this.previous=null,this.next=null,this.finalGrp=-1,this.trans=NaN,this.outsideWeight=0,this.insideWeight=0,this.invalidWeight=0,this._confidence=0,this._confidence_y=NaN,this._x=NaN,this._x_y=NaN,this.status=0,this.bo=e,this.shape=r,this.baseWeight=i,n.y>s.y?this.weight=-i:n.y==s.y?this.weight=0:this.weight=i,this.start=n,this.end=s,this.polyGrp=a,this.polyIndex=o,this._bbox=new od().ext1(r.bbox()).ext2(n).ext2(s).build1(),this.inters.push(n),this.inters.push(s);let l=31,c=1;c=l*c+this.polyGrp,c=l*c+this.polyIndex,this._hashcode=c}static rebuild(e,r,i){if(e instanceof je||r.distance2(i)<1e-6)return new je(r,i);if(e instanceof bt){let n=e,s=e.bbox().center().x,a;r.y>i.y?a=s>n.center.x?0:1:a=s>n.center.x?1:0;let o=r.angleD(n.center),l=i.angleD(n.center);return bt.build2(n.center,o,l,n.rx,n.ry,a)}else throw new Error("not supported operation")}updateBbox(){this._bbox=new od().ext2(this.start).ext2(this.end).build1()}is(e,r){return e===this.polyGrp&&r===this.polyIndex}confidence(e){if(this._confidence_y!=e){let r=this._bbox.height();if(r!==0)if(Math.abs(e-this._bbox.maxY)>5e-4&&Math.abs(e-this._bbox.minY)>5e-4){let i=1-Math.abs(2*e-this._bbox.maxY-this._bbox.minY)/r;this._confidence=i*1e4|0}else this._confidence=0;else this._confidence=1;this._confidence_y=e}return this._confidence}needCountWeight(){return this.outsideWeight+this.insideWeight+this.invalidWeight<5e3}revokeOutside(e){let r=this.confidence(e);return this.outsideWeight-=r,this.invalidWeight+=r,r}revokeInside(e){let r=this.confidence(e);return this.insideWeight-=r,this.invalidWeight+=r,r}setOutside(e){let r=this.confidence(e);return this.outsideWeight+=r,r}setInside(e){let r=this.confidence(e);return this.insideWeight+=r,r}setInvalid(e){let r=this.confidence(e);return this.invalidWeight+=r,r}prevNot0(){let e=this.previous;for(;e!=null&&e!=this;){if(e.weight!=0)return e;e=e.previous}return null}nextNot0(){let e=this.next;for(;e!=null&&e!=this;){if(e.weight!=0)return e;e=e.next}return null}getX(e){if(this.bo!==null)return(this._x_y!=e||isNaN(this._x))&&(Pwe(this,e)>0?this._x=_e[0]:this._x=NaN,this._x_y=e),this._x;throw new Error("not supported operation")}voteStatus(){return this.outsideWeight>this.insideWeight&&this.outsideWeight>this.invalidWeight?2:this.insideWeight>this.outsideWeight&&this.insideWeight>this.invalidWeight?1:this.invalidWeight>this.outsideWeight&&this.invalidWeight>this.insideWeight?3:0}reverse(e){if(e===2)if(this.start.y>this.end.y){let r=F2.rebuild(this.shape,this.end,this.start),i=new F2(this.bo,r,this.baseWeight,this.end,this.start,this.polyGrp,this.polyIndex);return du.addAll(i.connect,this.connect),i}else return this;else if(e===1)if(this.start.y<this.end.y){let r=F2.rebuild(this.shape,this.end,this.start),i=new F2(this.bo,r,this.baseWeight,this.end,this.start,this.polyGrp,this.polyIndex);return du.addAll(i.connect,this.connect),i}else return this;return this}isNeedScan(e){return this.needCountWeight()&&this.confidence(e)>0}hashCode(){return this._hashcode}equals(e){return e instanceof F2?!(this.polyGrp!==e.polyGrp||this.polyIndex!==e.polyIndex):!1}bbox(){return this._bbox}toString(){return G2.format("(%d,%d,%d) (%d,%d,%d) %s %s",this.polyGrp,this.polyIndex,this.weight,this.outsideWeight,this.invalidWeight,this.insideWeight,this.start,this.end)}};function Cwe(t,e){let r=t.bbox(),i=e.bbox(),n=(r.minY+r.maxY)/2,s=(i.minY+i.maxY)/2;return n-s}function Swe(t,e){let r=t.bbox(),i=e.bbox(),n=(r.minX+r.maxX)/2,s=(i.minX+i.maxX)/2;return n-s}var O2=class{constructor(t){if(this.__bbox=null,typeof t<"u")if(t instanceof Array){this.__items=[];for(let e of t)this.add(e)}else this.__items=t,this.__bbox=t.bbox();else this.__items=[]}add(t){if(this.__items instanceof Array)this.__items.push(t),this.__bbox=hu.extend2(this.__bbox,t.bbox());else throw new Error("can't insert multiple item into leaf node")}items(){return this.__items}bbox(){if(this.__bbox!==null)return this.__bbox;throw new Error("bug")}},aS=class{constructor(t){this.changed=!1,this.root=new O2,this.capacity=t,this.capacity2=t*t,this.itemList=[]}size(){return this.itemList.length}items(){return this.flushWhenNeed(),this.itemList}add(t){this.itemList.push(t),this.changed=!0}remove(t){du.remove(this.itemList,t),this.changed=!0}clear(){this.changed=!1,this.root=new O2,this.itemList.length=0}flushWhenNeed(){if(this.changed){let t=new Array;for(let e of this.itemList)t.push(new O2(e));for(;;){let e=this.organize(t);if(e.length>1)t=e;else break}this.root=new O2(t),this.changed=!1}}organize(t){K1(t,Swe,0,t.length);let e=t.length,r=[];for(let i=0;i<e;)if(i+this.capacity2<=e){let n=i+this.capacity2;K1(t,Cwe,i,n);for(let s=i;s<n;s+=this.capacity){let a=new O2(t.slice(s,s+this.capacity));r.push(a)}i=i+this.capacity*this.capacity}else{let n=new O2(t.slice(i,i+this.capacity));r.push(n),i=i+this.capacity}return r}search(t){this.flushWhenNeed();let e=[],r=[];for(r.push(this.root);;){let i=r.shift();if(typeof i<"u"){let n=i.items();if(n instanceof Array){for(let s of n)if(!t.isSeparated(s.bbox())){let a=s.items();a instanceof Array?r.push(s):e.push(a)}}else t.isSeparated(i.bbox())||e.push(n)}else break}return e}walker(t){this.flushWhenNeed(),this._walker(this.root,0,t)}_walker(t,e,r){this.flushWhenNeed();let i=t.items();if(i instanceof Array)for(let n of i)this._walker(n,e+1,r);else r(i,e)}bbox(){return this.flushWhenNeed(),this.root.bbox()}};function jM(t,e){Twe(t.iterator(),e)}function Twe(t,e){let r=0;for(;t.hasNext();){let i=t.next();e(r++,i)}}var k_=new Error("list is empty"),F_=class{constructor(t,e){this.prev=null,this.next=null,this.parent=t,this.item=e}insertAfter(t){t.next=this.next,this.next=t,t.prev=this,t.next!==null&&(t.next.prev=t)}insertBefore(t){t.prev=this.prev,this.prev=t,t.next=this,t.prev!==null&&(t.prev.next=t)}remove(){this.prev!==null&&(this.prev.next=this.next),this.next!==null&&(this.next.prev=this.prev)}set(t){this.item=t}},Iwe=class{constructor(t){this._next=t}hasNext(){return this._next!==null}next(){let t=this._next;if(t!==null)return this._next=t.next,t.item;throw new Error("iterator is null")}},Bwe=class{constructor(t){this._next=t}hasNext(){return this._next!==null}next(){let t=this._next;if(t!==null)return this._next=t.next,t;throw new Error("iterator is null")}},z1=class{constructor(){this.first=null,this.last=null,this.cnt=0}add(t){return this.addLast(t)}push(t){return this.addLast(t)}pop(){return this.removeLast()}shift(){return this.removeFirst()}removeFirst(){let t=this.first;if(t===null)throw k_;return this.remove(t),t.item}removeLast(){let t=this.last;if(t===null)throw k_;return this.remove(t),t.item}addLast(t){return this.first===null||this.last===null?(this.first=new F_(this,t),this.last=this.first,this.cnt=1,this.first):this.insertAfter(this.last,t)}addFirst(t){if(this.first===null||this.last===null){let e=new F_(this,t);return this.first=e,this.last=e,this.cnt++,e}else return this.insertBefore(this.first,t)}getFirst(){if(this.first===null)throw k_;return this.first.item}getLast(){if(this.last===null)throw k_;return this.last.item}insertAfter(t,e){let r=new F_(this,e);return t.insertAfter(r),t===this.last&&(this.last=r),this.cnt++,r}insertBefore(t,e){let r=new F_(this,e);return t.insertBefore(r),t===this.first&&(this.first=r),this.cnt++,r}remove(t){t.remove(),t===this.first&&(this.first=t.next),t===this.last&&(this.last=t.prev),this.cnt--}size(){return this.cnt}clear(){this.first=null,this.last=null,this.cnt=0}iterator(){return new Iwe(this.first)}listIterator(){return new Bwe(this.first)}toArray(){let t=new Array(this.cnt),e=this.first,r=0;for(;e!=null;)t[r]=e.item,e=e.next,r++;return t}};function QM(t){throw new Error("")}var U_=class{constructor(t,e){this.node1=null,this.node2=null,this.key=t,this.value=e}},Dwe=class{constructor(t){this.itors=t}hasNext(){return this.itors.hasNext()}next(){return this.itors.next().key}},_we=class{constructor(t){this.itors=t}hasNext(){return this.itors.hasNext()}next(){return this.itors.next().value}},nP=class{constructor(){this.innerList=new z1,this.innerMap={}}replace(t,e){t.node1!==null&&(t.node1.set(e),e.node1=t.node1),t.node2!==null&&(t.node2.set(e),e.node2=t.node2)}clear(){this.innerList.clear();for(let t in this.innerMap)delete this.innerMap[t]}put(t,e){let r=t.hashCode(),i=new U_(t,e),n=this.innerMap[r];if(n===void 0)return i.node1=this.innerList.add(i),this.innerMap[r]=i,null;if(n instanceof U_){if(n.key.equals(t))return this.innerMap[r]=i,this.replace(n,i),n.value;{i.node1=this.innerList.add(i);let s=new z1;return n.node2=s.add(n),i.node2=s.add(i),this.innerMap[r]=s,null}}if(n instanceof z1){let s=null;return jM(n,(a,o)=>o.key.equals(t)?(this.replace(o,i),s=o.value,!1):!0),s===null?(i.node1=this.innerList.add(i),i.node2=n.push(i),null):s}return QM(n)}get(t){let e=t.hashCode(),r=this.innerMap[e];if(r===void 0)return null;if(r instanceof U_)return r.key.equals(t)?r.value:null;if(r instanceof z1){let i=null;return jM(r,(n,s)=>s.key.equals(t)?(i=s.value,!1):!0),i}return QM(r)}containsKey(t){return this.get(t)!==null}delete(t){t.node1!==null&&t.node1.parent.remove(t.node1),t.node2===null?delete this.innerMap[t.key.hashCode()]:t.node2.parent.remove(t.node2)}remove(t){let e=t.hashCode(),r=this.innerMap[e];if(r===void 0)return null;if(r instanceof U_)return r.key.equals(t)?(this.delete(r),r.value):null;if(r instanceof z1){let i=null;return jM(r,(n,s)=>s.key.equals(t)?(i=s.value,this.delete(s),!1):!0),i}return QM(r)}computeIfAbsent(t,e){let r=this.get(t);if(r===null){let i=e(t);return this.put(t,i),i}else return r}size(){return this.innerList.size()}isEmpty(){return this.innerList.size()===0}keys(){return new Dwe(this.innerList.iterator())}values(){return new _we(this.innerList.iterator())}entries(){return this.innerList.iterator()}},j2=class{constructor(){this.innerMap=new nP}add(t){return this.innerMap.put(t,!0)!==!0}remove(t){this.innerMap.remove(t)}contains(t){return this.innerMap.get(t)===!0}iterator(){return this.innerMap.keys()}addAll(t){let e=t.iterator();for(;e.hasNext();)this.add(e.next())}size(){return this.innerMap.size()}clear(){let t=this.iterator();for(;t.hasNext();){let e=t.next();this.remove(e)}}},tX=du.funcCopy(K1);function Pwe(t,e){let r=0;if(Math.abs(t.start.y-e)<=1e-4)_e[r++]=t.start.x;else if(Math.abs(t.end.y-e)<=1e-4)_e[r++]=t.end.x;else if(t.shape instanceof je)r=JEe(t.shape,e);else if(t.shape instanceof bt)r=$Ee(t.shape,e);else throw new Error("not supported operation");return r}var W_=class{constructor(t,e,r,i){this.sides=new Array,this.loader=t,this.loader.bo=this,this.logger=r,this.rule=e,this.event=i}static sortByBBoxMinY(t,e){return t.bbox().minY-e.bbox().minY}static sortByBBoxAreaDesc(t,e){return e.bbox().area()-t.bbox().area()}addPolyline(t,e=1,r=.01,i=!0){for(let n of this.loader.buildGroup(t,e,r,i))this.sides.push(n),this.event.onOriginSide(n)}buildRTree(){let t=new aS(10);for(let e of this.sides)t.add(e);return t}fillValidSides(t,e,r){for(let i of e)isFinite(i.getX(r))&&t.push(i)}getSortedEndpointsLineAsc(t){let e=new Array;for(let n of t)n.needCountWeight()&&(e.push(n.start),e.push(n.end));tX(e,nt.sortByYAsc,0,e.length);let r=new Array,i=Number.NEGATIVE_INFINITY;for(let n of e){let s=n.y;s>i&&(r.push(s),i=s)}return r}splitSides(t,e,r){let i=t.start,n=t.end,s=new nt(n.x+(i.x-n.x)*2,n.y+(i.y-n.y)*2);tX(t.inters,(o,l)=>o.distance2(s)-l.distance2(s),0,t.inters.length);let a=null;for(let o of t.inters)if(a==null)o.equals(i)&&(a=o);else if(!o.equals(a)){let l=Q2.rebuild(t.shape,a,o);l instanceof bt&&Math.abs(l.sweepAngle)>190&&(l=new je(a,o));let c=new Q2(this,l,t.baseWeight,a,o,t.polyGrp,r++);if(e.push(c),c.updateBbox(),o.equals(n))break;a=o}return r}splitSidesByInters(){let t=new Array;for(let e of this.sides)if(e.polyIndex==0){let r=0,i=null,n=null;do{let s=new Array;r=this.splitSides(e,s,r);for(let a of s)i!=null?(i.next=a,a.previous=i):n=a,i=a,this.event.onSplitedSide(a),t.push(a);if(e.next===null)throw new Error("not supported operation");e=e.next}while(e.polyIndex!==0);n!=null&&i!=null&&(n.previous=i,i.next=n)}this.sides.length=0;for(let e of t)this.sides.push(e)}seekIntersection(){if(this.sides.length>0){let t=this.buildRTree(),e=new j2;for(let r of this.sides){e.add(r);let i=r.bbox().extendOfSize(1e-5),n=r.shape instanceof je;for(let s of t.search(i))if(!e.contains(s)){let a=s.shape instanceof je;if(!(n&&a&&r.next!==null&&r.previous!==null&&(r.next.equals(s)||r.previous.equals(s)))){let o=YA(r.shape,s.shape);for(let l=0;l<o;l+=2){let c=new nt(_e[l],_e[l+1]);r.inters.push(c),s.inters.push(c),this.event.onIntersect(c,r,s)}}}}}}},Lwe=class OX{constructor(e){this.sides=new j2,this.others=new j2,this.id=e}add(e){this.sides.add(e),e.finalGrp=this.id;for(let r of e.connect)this.others.add(r)}polyline(){let e=new Array;return V2(this.sides,(r,i)=>(e.push(i.shape),!0)),dn.build2(e).asClose()}hashCode(){return this.id}equals(e){return e!=null&&e instanceof OX?this.id===e.id:!1}},NX=class{constructor(t){this.bo=null,this.sides=new Array,this.polyGrp=0,this.polyIndex=0,this.prevSide=null,this.firstSide=null,this.noWeight0=t}completeGroup(t){this.prevSide!=null&&this.firstSide!=null&&!this.prevSide.end.equals(this.firstSide.start)&&this.addSide(new je(this.prevSide.end,this.firstSide.start),t);let e=new Array,r=null,i=null;for(let n of this.sides)(!this.noWeight0||n.weight!==0)&&(r!=null?(r.next=n,n.previous=r):i=n,r=n,e.push(n));return r!=null&&i!=null&&(i.previous=r,r.next=i),this.polyGrp++,this.sides.length=0,this.prevSide=null,this.firstSide=null,this.polyIndex=0,e}buildGroup(t,e,r,i=!0){for(let n of t.primitives)if(n instanceof je)this.addSide(n,e);else if(i&&n instanceof bt&&n.rx===n.ry)this.addArc(n,e);else{let s=null;for(let a of n.points(r))s!=null&&this.addSide(new je(s,a),e),s=a}return this.completeGroup(e)}addArc(t,e){let r=t.sweepAngle,i=Bi.regularD(t.startAngle),n=i+r;if(r>0){let s=90;for(;s<=n;)s>i&&(this.addSide(bt.build3(t.center,i,s-i,t.rx,t.ry),e),i=s),s+=90;i<n&&this.addSide(bt.build3(t.center,i,n-i,t.rx,t.ry),e)}else if(r<0){let s=270;for(;s>=n;)s<i&&(this.addSide(bt.build3(t.center,i,s-i,t.rx,t.ry),e),i=s),s-=90;i>n&&this.addSide(bt.build3(t.center,i,n-i,t.rx,t.ry),e)}}addSide(t,e){if(t.start().equals(t.end()))return;let r=t.start(),i;this.prevSide!=null?(this.prevSide.end.equals(r)||this.addSide(new je(this.prevSide.end,r),e),i=new Q2(this.bo,t,e,t.start(),t.end(),this.polyGrp,this.polyIndex++)):(i=new Q2(this.bo,t,e,t.start(),t.end(),this.polyGrp,this.polyIndex++),this.firstSide=i),this.prevSide=i,this.sides.push(i)}},RX=class{constructor(t,e,r){this.eps=new Array,this.curWeight=0,this.start=null,this.last=null,this.prevStart=null,this.prevEnd=null,this.y=r,this.rule=t,this.bo=e,this.event=e.event}onEp(t){this.tuningWeight(t),this.start===null?this.rule(this.curWeight)?this.in(t):t.setInvalid(this.y):this.rule(this.curWeight)?t.setInvalid(this.y):this.out(t,this.start),this.last!==null&&this.event.onSweep1(this.last,t,this.y),this.last=t}in(t){this.prevEnd!=null&&this.onSameX(t,this.prevEnd)?(this.start=this.prevStart,this.prevStart=null,this.prevEnd.revokeInside(this.y),this.prevEnd=null):(this.start=t,this.start.setOutside(this.y))}out(t,e){if(this.onSameX(e,t))e.revokeOutside(this.y);else{if(t.setInside(this.y)>0&&e.confidence(this.y)>0){let r=e.voteStatus(),i=t.voteStatus();this.isValid(r)&&this.isValid(i)?r==2&&i==1&&(t.connect.push(e),e.connect.push(t)):(t.connect.push(e),e.connect.push(t))}this.event.onSegment1(e,t,this.y),this.eps.push(e),this.eps.push(t),this.prevStart=e,this.prevEnd=t}this.start=null}isValid(t){return t==1||t==2}onSameX(t,e){return t.bbox().isIntersect(e.bbox())&&Ct.eq(t.getX(this.y),e.getX(this.y))}tuningWeight(t){this.curWeight+=t.weight;let e=t.nextNot0(),r=t.prevNot0();e!=null&&t.weight===e.weight&&e.trans===this.y&&(this.curWeight-=t.weight),r!=null&&t.weight===r.weight&&r.trans===this.y&&(this.curWeight-=t.weight),t.trans=this.y}},sP=new Error,rX=new class extends uS{decide1(t){return t[0]&&t[1]}}(2),Owe=new class extends LX{onPolylineGroup(t,e){throw sP}onSegment(t,e,r,i,n,s){throw sP}},Nwe=class{constructor(t,e){this.rtree=t,this.level=e}},Rwe=class MX extends W_{static isIntersect(e,r,i=cP.DUMMY){let n=new MX(i),s=n.createGroup1(e.items),a=n.createGroup2(r.items);return s.rtree.itemList.length==0||a.rtree.itemList.length==0?!1:n.isIntersect(s,a)}constructor(e){super(new NX(!1),rX.rule,e,Owe)}createGroup1(e){return this.createGroup(e,0)}createGroup2(e){return this.createGroup(e,1)}createGroup(e,r){let i=rX.weight(r);for(let s of e)this.addPolyline(s,i);let n=this.buildRTree();return this.sides.length=0,new Nwe(n,r)}isIntersect(e,r){if(e.level!==r.level){let i=e.rtree.bbox().intersection1(r.rtree.bbox());if(i!==null){try{this.inters(e,r);let n=(i.minY+i.maxY)/2;this.sweep(e,r,n)}catch(n){if(n===sP)return!0;throw n}return!1}else return!1}else throw new Error("inersection detection should not in same group")}inters(e,r){if(e.rtree.size()>r.rtree.size()){let i=e;e=r,r=i}for(let i of e.rtree.items()){i.trans=NaN;let n=i.bbox().extendOfSize(1e-5);for(let s of r.rtree.search(n))if(s.trans=NaN,YA(i.shape,s.shape)>0)throw sP}}sweep(e,r,i){let n=hu.extend2(e.rtree.bbox(),r.rtree.bbox()).extendOfSize(1e-5),s=new Array;this.fillValidSides(s,e.rtree.search(n),i),this.fillValidSides(s,r.rtree.search(n),i),K1(s,(o,l)=>o.getX(i)-l.getX(i),0,s.length);let a=new RX(this.rule,this,i);for(let o of s)a.onEp(o)}},E6=class bg{constructor(e){this.items=new Array(e.length),du.arraycopy(e,0,this.items,0,e.length),this.__bbox=this.calcBBox()}static build1(e){let r=[];return $_(e,(i,n)=>(r.push(n),!0)),new bg(r)}static build2(e){let r=e.map(i=>dn.build8(i));return new bg(r)}static combinePolylineGroupArr(e){let r=[];for(let i of e)r=r.concat(i.items);return new bg(r)}calcBBox(){let e=new od;for(let r=0;r<this.items.length;r++)e.ext1(this.items[r].bbox());return e.build1()}multiply3(e){let r=new Array(this.items.length);for(let i=0;i<r.length;i++)r[i]=this.items[i].multiply3(e);return new bg(r)}bbox(){return this.__bbox}asClose(){return this.items.forEach(e=>e.asClose()),this}mirrorY(e){return this.items.forEach(r=>r.mirrorY(e)),this}closeEndpoint(){return this.items.forEach(e=>e.closeEndpoint()),this}get primitives(){return this.items.map(e=>e.primitives).flat(2)}isEqual(e){return e instanceof bg?this.items.every(r=>e.items.some(i=>i.isEqual(r))):!1}getOutMostPolyline(){return this.items.reduce((e,r)=>r.bbox().area()>e.bbox().area()?r:e,this.items[0])}getOutline(){let e=this.items;if(e.length===1)return{outline:e,hole:new Array};let r=new Set,i=new Set;for(let n=0,s=e.length;n<s;n++){let a=e[n];if(!r.has(a)&&!i.has(a)){n+1>=s&&r.add(a);for(let o=n+1;o<s;o++){let l=e[o];if(!r.has(l)&&!i.has(l)){if(!a.bbox().isInside(l.bbox().extendOfSize(1e-4))&&!l.bbox().isInside(a.bbox().extendOfSize(1e-4)))continue;Rwe.isIntersect(new bg([a]),new bg([l]))&&(a.bbox().area()>l.bbox().area()?(r.add(a),i.add(l)):(r.add(l),i.add(a)))}}!r.has(a)&&!i.has(a)&&r.add(a)}}return{outline:[...r],hole:[...i]}}round(e=4){let r=this.items.map(i=>i.round(e));return new bg(r)}},Mwe=du.funcCopy(K1),kwe=du.funcCopy(K1),Fwe=du.funcCopy(K1);function Uwe(t){return new Array}function Hwe(t,e){let r=new iS(!1),i=new nS(t,cP.DUMMY,r);for(let n of e)i.addPolyline(n);return i.simplify(),r.plGrps}var nS=class extends W_{constructor(t,e,r){super(new NX(!1),t,e,r),this.finalSides=new Array,this.sideGroups={},this.vecSides=new Array,this.scanY=NaN,this.curNetIndex=0,this.curIndex=-1,this.scanLines=0}sweep(t,e,r){this.scanY=NaN,this.scanLines=0,Mwe(e,W_.sortByBBoxMinY,0,e.length);let i=new z1;this.curNetIndex=0;let n=Number.POSITIVE_INFINITY;for(let s of t)s>n&&this.scan(i,(n+s)/2,e),n=s;this.getAllMarkPrimitive(r,e),this.logger.debug3("scan %s %d",r,this.scanLines)}simplify(){this.seekIntersection(),this.splitSidesByInters(),this.sweep(this.getSortedEndpointsLineAsc(this.sides),this.sides,!1),this.flipSides(),this.sweep(this.getSortedEndpointsLineAsc(this.vecSides),this.vecSides,!0),this.connectSides(),this.fillResult()}addPolyline(t,e=1,r=.01,i=!0){super.addPolyline(t,e,r,i)}scan(t,e,r){if(this.scanY==e)return;this.scanY=e;let i=!1,n=t.listIterator();for(;n.hasNext();){let s=n.next(),a=s.item;Ct.less(a.bbox().maxY,e)?t.remove(s):!i&&a.isNeedScan(e)&&(i=!0)}for(;this.curNetIndex<r.length;){let s=r[this.curNetIndex];if(Ct.less(s.bbox().minY,e))Ct.greatereq(s.bbox().maxY,e)&&(this.add2AET(t,s),!i&&s.isNeedScan(e)&&(i=!0)),this.curNetIndex++;else break}if(i){this.scanLines++;let s=new RX(this.rule,this,e),a=t.iterator();for(;a.hasNext();){let o=a.next();s.onEp(o)}}}add2AET(t,e){let r=e.bbox().minX,i=e.bbox().maxX,n=e.bbox().minY,s=e.bbox().maxY,a=t.listIterator(),o=null;for(;a.hasNext();){let l,c=a.next(),u=c.item,d=u.bbox().minX,A=u.bbox().maxX;if(i<=d)l=-1;else if(A<=r)l=1;else{let f=u.bbox().minY,p=u.bbox().maxY,m=Math.max(n,f),y=Math.min(s,p);l=this.compareBySweep(e,u,(m+y)/2)}let h=u.shape;if(h instanceof je&&h.length()<.001&&o==null&&l<0){o=c;continue}if(o!=null&&l<0){t.insertBefore(o,e);return}if(l<0){t.insertBefore(c,e);return}else o=null}t.add(e)}getLineAngle(t){let e=t.start().angle(t.end());return e<0&&(e+=Math.PI),e}getArcAngle(t,e){let r=Math.asin((e-t.center.y)/t.rx);return t.startAngle>90&&t.startAngle<270&&(r=-r),r<0&&(r+=Math.PI),(r+Math.PI/2)%Math.PI}compareArcLine(t,e,r){let i=this.getArcAngle(t,r),n=this.getLineAngle(e);return Ct.eq(i,n)?-t.sweepAngle:n-i}compareBySweep(t,e,r){let i=t.getX(r);if(!isFinite(i))return 0;let n=e.getX(r);if(!isFinite(n))return 0;if(!Ct.eq(i,n))return i-n;if(t.shape instanceof je)return e.shape instanceof je?this.getLineAngle(e.shape)-this.getLineAngle(t.shape):-this.compareArcLine(e.shape,t.shape,r);if(e.shape instanceof je)return this.compareArcLine(t.shape,e.shape,r);{let s=t.shape,a=e.shape,o=this.getArcAngle(s,r),l=this.getArcAngle(a,r);return Ct.eq(o,l)?s.sweepAngle*a.sweepAngle<=0?s.sweepAngle<=0?1:-1:s.sweepAngle>0?s.rx-a.rx:a.rx-s.rx:l-o}}getAllMarkPrimitive(t,e){for(let r of e)if(r.status===0&&r.bbox().height()!=0){let i=r.voteStatus();if(i===2||i===1){r.status=i;let n=r.reverse(i);if(t){this.event.onResultSide(n);let s=n.shape.multiply3(ko.ROT_N90),a=n.start.multiply3(ko.ROT_N90),o=n.end.multiply3(ko.ROT_N90);n=new Q2(this,s,n.baseWeight,a,o,n.polyGrp,n.polyIndex)}this.finalSides.push(n),this.event.onResultSide(n)}}}flipSides(){for(let t of this.sides)if(t.polyIndex==0){let e=null,r=null;do{let i=t.shape.multiply3(ko.ROT_90),n=t.start.multiply3(ko.ROT_90),s=t.end.multiply3(ko.ROT_90),a=new Q2(this,i,t.baseWeight,n,s,t.polyGrp,t.polyIndex);if(a.outsideWeight=t.outsideWeight,a.insideWeight=t.insideWeight,a.invalidWeight=t.invalidWeight,a.status=t.status,e!=null?(e.next=a,a.previous=e):r=a,this.vecSides.push(a),this.event.onSplitedSide(a),e=a,t.next!==null)t=t.next;else break}while(t.polyIndex!=0);r!=null&&(r.previous=e,e.next=r)}}canBeEnd(t,e){if(t.size()==1){let r=t.getFirst().shape;if(r instanceof bt){if(e&&r.rx<=e)return!1}else if(r instanceof je&&e&&r.length()<=e)return!1}return!0}connectSides(){let t=new nP,e=new aS(10);for(let s of this.finalSides)t.computeIfAbsent(s.start,Uwe).push(s),e.add(s.start);let r=0,i=new j2,n=new Array;for(let s of this.finalSides)if(!i.contains(s)){let a=new j2,o=s.start,l=new z1;l.add(s),i.add(s);let c=s.end;for(;l.size()>0;)if(this.isStart(o,c)&&this.canBeEnd(l,.01)){l.size()>1&&this.fillSideGroups(l,r++);break}else{let u=t.get(c),d=this.findNext(i,u);if(d==null&&(c=this.findNeigber(c,a,e,.01),c!==null&&(u=t.get(c),d=this.findNext(i,u))),d!=null)l.add(d),i.add(d),c=d.end;else if(c!=null?a.add(c):(n.length==0&&l.size()>1&&this.logger.warning3("unable to connect at %s",l.getLast()),n.push(l.removeLast())),l.size()>0)c=l.getLast().end;else break}}}fillSideGroups(t,e){let r=new Lwe(e);V2(t,(i,n)=>(r.add(n),!0)),this.sideGroups[r.id]=r}isStart(t,e){return t.distance2(e)<=1e-4}findNext(t,e){if(e!=null){for(let r of e)if(!t.contains(r))return r}return null}fillResult(){let t=0,e=new nP;for(let i in this.sideGroups){let n=this.sideGroups[i];V2(n.sides,(s,a)=>(a.polyGrp!=-2&&e.put(a,a),!0))}let r=new j2;for(let i in this.sideGroups){let n=this.sideGroups[i];if(r.add(n)){let s=0,a=new Array;for(a.push(n);s<a.length;){let l=a[s],c=new Array;V2(l.others,(d,A)=>{let h=e.get(A);return h!=null&&c.push(h.finalGrp),!0}),kwe(c,du.sortAsc,0,c.length);let u=l.id;for(let d of c)if(d!=u&&d!=l.id){let A=this.sideGroups[d];r.add(A)&&a.push(A),u=d}s++}let o=new Array;for(let l of a)o.push(l.polyline());Fwe(o,W_.sortByBBoxAreaDesc,0,o.length),this.event.onPolylineGroup(new E6(o),t++)}}}findNeigber(t,e,r,i){let n=i*i,s=Number.MAX_VALUE,a=null;for(let o of r.search(t.bbox().extendOfSize(i)))if(!e.contains(o)){let l=t.distance2(o);l<s&&(s=l,a=o)}return s<n?a:null}},Gwe=class{constructor(){this.points=[],this.lines=[],this.arcs=[],this.beziers=[],this.listText=[],this.fonts=[]}addPt(t,e=!0){if(t instanceof je)this.lines.push(t);else if(t instanceof bt)this.arcs.push(t);else if(t instanceof vr)this.beziers.push(t);else throw new Error("not support");e&&this.points.push(t.start())}addPoint(t){this.points.push(t)}addText(t,e,r=1,i=.1,n=!0){this.listText.push({pos:t,str:e,size:r,width:i}),n&&this.points.push(t)}addPly(t,e=!0){t.primitives.forEach(r=>this.addPt(r,e))}build(){let t=[],e=[],r=[],i=[],n=[],s=[];return this.points.forEach(a=>t.push(a.x,a.y)),this.lines.forEach(a=>e.push(a.start().x,a.start().y,a.end().x,a.end().y)),this.arcs.forEach(a=>r.push(a.center.x,a.center.y,a.rx,Bi.toRadians(a.startAngle),Bi.toRadians(a.endAngle()),a.sweep())),this.beziers.forEach(a=>{a.controls.forEach(o=>{i.push(o.x,o.y)}),i.push("end")}),this.listText.forEach(a=>n.push(a.pos.x,a.pos.y,a.str,a.width,a.size)),this.fonts.forEach(a=>s.push(a)),{points:t,lines:e,arcs:r,texts:n,beziers:i,fonts:s}}},$0,hS=($0=class{constructor(e){this.map=new nP,this.bus=e}initColor(e){return this.map.computeIfAbsent(e,()=>new Gwe)}draw(){let e={},r=this.map.entries();for(;r.hasNext();){let i=r.next();e[i.key.toString()]=i.value.build()}this.bus.publish("/debug/draw",e)}clear(){this.map.clear()}static init(e){if(!e)throw new Error("bus is undefined!");this.palette=new $0(e)}static initPalette(e){this.palette=e}static getDefaultColor(){for(let e of this.colorBuffersMap)if(e[0]!==null&&e[0])return e[0]=!1,e[1];return this.colorBuffersMap.forEach(e=>{if(e[0]===null){console.log(1);return}e[0]=!0}),this.getDefaultColor()}static clear(){this.palette.clear()}static auto(e,r=this.getDefaultColor()){if(Array.isArray(e))e.forEach(i=>{this.auto(i,r)});else if(e instanceof nt)this.point(e,r);else if(e instanceof hu)this.bbox(e,r);else if(e instanceof cS)this.primitive(e,r);else if(e instanceof dn)this.polyline(e,r);else if(e instanceof $o)this.polygon(e,r);else if(e instanceof lo)this.group(e,r);else if(e instanceof E6)this.auto(e.items,r);else{debugger;throw new Error("No incoming type!")}}static text(e,r,i=.5,n=this.getDefaultColor()){if(!this.palette)throw new Error("palette  is not initialised!");this.palette.initColor(n).addText(e,r,i,i/10),this.palette.draw()}static point(e,r=this.getDefaultColor()){if(!this.palette)throw new Error("palette  is not initialised!");let i=this.palette.initColor(r);Array.isArray(e)?e.forEach(n=>{this.point(n,r)}):i.addPoint(e),this.palette.draw()}static bbox(e,r=this.getDefaultColor()){Array.isArray(e)?e.forEach(i=>{this.bbox(i,r)}):(this.primitive(new je(new nt(e.maxX,e.maxY),new nt(e.maxX,e.minY)),r),this.primitive(new je(new nt(e.maxX,e.maxY),new nt(e.minX,e.maxY)),r),this.primitive(new je(new nt(e.minX,e.minY),new nt(e.maxX,e.minY)),r),this.primitive(new je(new nt(e.minX,e.minY),new nt(e.minX,e.maxY)),r))}static primitive(e,r=this.getDefaultColor()){if(!this.palette)throw new Error("palette  is not initialised!");let i=this.palette.initColor(r);Array.isArray(e)?e.forEach(n=>{this.primitive(n,r)}):i.addPt(e),this.palette.draw()}static polyline(e,r=this.getDefaultColor()){Array.isArray(e)?e.forEach(i=>{this.polyline(i,r)}):e.primitives.forEach(i=>{this.primitive(i,r)})}static polygon(e,r=this.getDefaultColor()){Array.isArray(e)?e.forEach(i=>{this.polygon(i,r)}):e.items.forEach(i=>{this.polyline(i,r)})}static group(e,r=this.getDefaultColor()){Array.isArray(e)?e.forEach(i=>{this.group(i,r)}):e.items.forEach(i=>{this.polygon(i,r)})}static async begin(){this.t1=performance.now()}static async end(e){console.log(e||"t1:",performance.now()-this.t1)}static async log(e){console.log(e||"==================")}},$0.colorBuffersMap=[[!0,Wn.BLUE],[!0,Wn.GREEN],[!0,Wn.WHITE],[!0,Wn.RED],[!0,Wn.Golden],[!0,Wn.Gray]],$0.t1=0,$0),Ywe=0,dS=class a6{constructor(e,r){this.inters=[],this.shape=e,this.start=e.start(),this.end=e.end(),this.judgeOverlapMap=new Map,r&&(this.id=Ywe++)}reverse(){this.shape=this.shape.reverse();let e=this.start;this.start=this.end,this.end=e}getCenterPoint(e=this.end){let{x:r,y:i}=this.start,{x:n,y:s}=e;if(this.shape instanceof bt){let a=this.shape.rx,o=new nt((r+n)/2,(i+s)/2),l=this.shape.center,c;return o.x!==l.x||o.y!==l.y?(c=o.angle(l),Math.abs(this.shape.sweepAngle)>180&&(c+=c>=0?-180:180)):c=(this.shape.startAngle+this.shape.endAngle())/2,new nt(l.x+Math.cos(c)*a,l.y+Math.sin(c)*a)}else{if(this.shape instanceof je)return new nt((r+n)/2,(i+s)/2);if(this.shape instanceof vr){let a=this.shape.getPercent(e,di);return vr.pointOn(a/2,this.shape.controls)}else throw Error("not support")}}static finalAngle(e,r,i){let n=e.cross(r)>0,s=Math.acos(Math.min(1,Math.max(-1,e.dot(r)/r.length())));return(i?!n:n)&&(s=uP-s),s}sortInters(){if(this.shape instanceof bt){let e=this.shape.center,r=this.shape.start().sub(e).normalize(),i=this.shape.isCCW;this.inters.sort((n,s)=>{let a=n.coord.sub(e),o=s.coord.sub(e);return a6.finalAngle(r,a,i)-a6.finalAngle(r,o,i)<=0?-1:1})}else if(this.shape instanceof je){let e=this.start,r=this.end,i=new nt(r.x+(e.x-r.x)*2,r.y+(e.y-r.y)*2);this.inters.sort((n,s)=>n.coord.distance2(i)-s.coord.distance2(i)<=0?-1:1)}else if(this.shape instanceof vr){let e=this.shape;this.inters.sort((r,i)=>e.getPercent(r.coord,di)-e.getPercent(i.coord,di)<=0?-1:1)}else throw Error("not support the primitive type");this.inters.forEach((e,r)=>e.setIndex(r))}getStart(){return this.start}getEnd(){return this.end}getShape(){return this.shape}connect(e){this.nextSide=e,e.prevSide=this}static returnPolygonList(e){let r=[];return e.forEach(i=>{let n=[];i.forEach((s,a)=>{let o=[];s.forEach(l=>{o.push(l.shape)}),n.push(dn.build7(o))}),r.push(new $o(n))}),r}addInter(e){this.inters.push(e)}static returnPolygonGroup(e){let r=[];return e.forEach(i=>{let n=[];i.forEach((s,a)=>{let o=[];s.forEach(l=>{o.push(l.shape)}),n.push(dn.build7(o))}),r.push(new $o(n))}),new lo(r)}static rebuild(e,r,i){let n;if(e instanceof je||r.distance2(i)<1e-6)n=new je(r,i);else if(e instanceof bt)n=bt.build2(e.center,r.angleD(e.center),i.angleD(e.center),e.rx,e.ry,e.isCCW?1:0);else if(e instanceof vr){let s=e.getPercent(r,di),a=e.clip(s)[1];n=a.clip(a.getPercent(i,di))[0]}else throw new Error("not supported operation");return hi(e,r).dot(hi(n,r))<0?null:n}static returnPolyline(e){return dn.build7(e.map(r=>r.shape))}bbox(){return this.shape.bbox()}},Vwe=(t=>(t[t.END1=0]="END1",t[t.END2=1]="END2",t[t.END12=2]="END12",t[t.LEFT1=3]="LEFT1",t[t.LEFT2=4]="LEFT2",t))(Vwe||{});function Au(t,e,r){if(t instanceof bt&&e instanceof bt)return zwe(t,e);if(t instanceof bt&&e instanceof je)return sX(t,e);if(t instanceof je&&e instanceof bt)return nX(t,e);if(t instanceof je&&e instanceof je)return X1(t,e);if(t instanceof vr&&e instanceof je)return t.controls.length===2||vg(t)?X1(new je(t.start(),t.end()),e):kX(t,e);if(t instanceof je&&e instanceof vr)return e.controls.length===2||vg(e)?X1(t,new je(e.start(),e.end())):o6(t,e);if(t instanceof bt&&e instanceof vr)return e.controls.length===2||vg(e)?sX(t,new je(e.start(),e.end())):jwe(t,e);if(t instanceof vr&&e instanceof bt)return t.controls.length===2||vg(t)?nX(new je(t.start(),t.end()),e):Qwe(t,e);if(t instanceof vr&&e instanceof vr)return w6(t,e);throw new Error("not support")}function N2(t,e){return hi(t,e.start()).dot(hi(e,e.start()))<=0?!1:Au(t,e).state<=2}function zM(t,e){let r=e.getPercent(t.end(),di);if(r===null)return!1;if(r===0)return!0;let i=e.clip(r)[0],n=t.buildConverxHull(di),s=i.buildConverxHull(di),a=c(n),o=c(s);return l(a,o);function l(u,d){let A=new Map([[0,1],[1,0],[2,2],[3,4],[4,3]]),h=u[0],f=d[0];if(!h||!f)throw Error("isAllOverlap(sides1: PackSide[], sides2: PackSide[])");let p=!0;do{let m=h.getShape(),y=f.getShape();if(m instanceof je&&y instanceof je){let g=p?X1(m,y).state:A.get(X1(y,m).state);if(g===0)h=h.nextSide,p=!1;else if(g===1)f=f.nextSide,p=!0;else if(g===2)h=h.nextSide,f=f.nextSide,p=!0;else return!1}else throw Error("not support")}while(h!==u[0].prevSide&&f!==d[0].prevSide);return!0}function c(u){let d=u.primitives.map(h=>new dS(h)),A=d[d.length-1];return d.forEach(h=>{A.connect(h),A=h}),d}}function iX(t,e){let r=t.end().distance2(e.center);if(r>(e.rx+di)**2||r<(e.rx-di)**2||!(Qr(t.end(),e.end())||v6(e,t.end())))return!1;if(t.center.equals1(e.center))return!0;let i=t.center.distance1(e.center),n=Math.abs(t.rx-e.rx);if(i>Math.min(t.rx,e.rx)){let s=t.center.angleD(e.center);return t.rx>e.rx?!(i+n>di&&im(t,s))&&!(i-n>di&&t.rx+e.rx-i>di&&im(t,s+180)):!(i-n>di&&im(t,s))&&!(t.rx+e.rx-i>di&&im(t,s+180))}else{if(i+n<=di)return!0;let s=t.rx>e.rx?t.center.angleD(e.center):e.center.angleD(t.center);return im(t,s)?!1:i-n<=di?!0:!im(t,s+180)}}function jwe(t,e){let r=C6(t,e.start()).toBezier2(),i,n=0;for(let s=r.length;n<s;n++){let a=r[n];if(i=w6(a,e).state,i!==0)break}return i===2&&n!==r.length-1?{state:1}:{state:i}}function Qwe(t,e){let r=e.toBezier2(),i,n=0;for(let s=r.length;n<s;n++){let a=r[n];if(i=w6(t,a).state,i!==1)break}return i===2&&n!==r.length-1?{state:0}:{state:i}}function w6(t,e){if(t.controls.length===2||vg(t))return e.controls.length===2||vg(e)?X1(new je(t.start(),e.end()),new je(e.start(),e.end())):o6(new je(e.start(),t.end()),e);if(e.controls.length===2||vg(e))return kX(l6(t,e.start()),new je(e.start(),e.end()));let r=l6(t,e.start());if(vg(r))return o6(new je(e.start(),t.end()),e);let i=zM(r,e),n=zM(e,r);if(!i&&!n){let s=owe(r,e);if(s.havOverlap){let a=s.havOverlap!==2,o=s.havOverlap!==1;return Ig(t,e,a,o)}else{let a=function(){for(let d=0;d<c;d+=2)_e[d]=u[d],_e[d+1]=u[d+1]},o,l,c=s.cnt,u=new Array(c).fill(0).map((d,A)=>_e[A]);for(let d=0;d<c;d+=2){let A=new nt(_e[d],_e[d+1]),h=r.getPercent(A,di),f=e.getPercent(A,di);if(h===0||f===0)continue;let p=h===1?r:r.clip(h)[0],m=f===1?e:e.clip(f)[0];if(zM(p,m)){let y=hi(t,A).cross(hi(e,A));if(y===0){o=r.end(),l=e.end();break}return{state:y<0?3:4}}a()}return(!o||!l)&&(o=Y2(r.controls,r.controls[0],e),l=Y2(e.controls,r.controls[0],r)),{state:o.sub(r.controls[0]).cross(l.sub(r.controls[0]))>0?4:3}}}return Ig(t,e,i,n)}function kX(t,e){let r=l6(t,e.start());if(vg(r))return X1(new je(r.start(),r.end()),e);let i=UX(r,e),{isIn:n,bezierIsInLeft:s}=FX(e,r);if(!i&&!n){if(s!==void 0)return{state:s?3:4};let a=null,o=t.getPercent(e.start(),di)+.01;for(let l=o>1?1:o;l<=1;){let c=vr.pointOn(l,t.controls);if(oS(e,c)>fu){a=c;break}l+=.01,l>1&&(l=1)}if(!a)throw Error("!end1 && !end2 not result");return{state:e.direct.cross(a.sub(e.start()))<0?4:3}}return Ig(r,e,i,n)}function o6(t,e){let{isIn:r,bezierIsInLeft:i}=FX(t,e),n=UX(e,t);if(!r&&!n){if(i!==void 0)return{state:i?4:3};let s=null;for(let a=.01;a<=1;){let o=vr.pointOn(a,e.controls);if(oS(t,o)>fu){s=o;break}a+=.01,a>1&&(a=1)}if(!s)throw Error("!end1 && !end2 not result");return{state:t.direct.cross(s.sub(t.start()))<0?3:4}}return Ig(e,t,r,n)}function zwe(t,e){let r=iX(C6(t,e.start()),e),i=iX(e,t);if(!r&&!i){let n=Kf(e);if(t.center.sub(e.start()).dot(e.center.sub(e.start()))>0){if(t.rx===e.rx)return t.isCCW?{state:n.dot(t.center.sub(e.center))<0?3:4,exitIsInvalid:!1}:{state:n.dot(t.center.sub(e.center))>0?3:4,exitIsInvalid:!1};let s,a;return t.rx>e.rx?(s=t,a=e):(s=e,a=t),n.dot(a.center.sub(s.center))>0&&a.rx+a.center.distance1(s.center)-s.rx>di?t.isCCW?{state:t.rx>e.rx?3:4,exitIsInvalid:!1}:{state:t.rx<e.rx?3:4,exitIsInvalid:!1}:t.isCCW?{state:t.rx<e.rx?3:4,exitIsInvalid:!0}:{state:t.rx>e.rx?3:4,exitIsInvalid:!0}}else return t.rx+e.rx-t.center.distance1(e.center)>di&&n.dot(t.center.sub(e.center))>0?{state:e.isCCW?3:4,exitIsInvalid:!1}:{state:t.isCCW?3:4,exitIsInvalid:!0}}return Ig(t,e,r,i)}function nX(t,e){let r=Wf.foot(t,e.center),i=t.end().distance2(e.center),n=t.end().sub(t.start()),s=(e.rx-di)**2,a=i<=(e.rx+di)**2&&i>=s&&(n.dot(r.sub(e.start()))<=0||t.start().distance2(t.end())<=t.start().distance2(r)||r.distance2(e.center)>=s)&&(Qr(t.end(),e.end())||v6(e,t.end())),o=HX(e,t);if(!a&&!o){let l=t.distance2(e.center);return l<=fu?{state:n.cross(Kf(e))>0?4:3}:n.dot(r.sub(e.start()))>=0&&(i<s||t.start().distance2(e.center)<s||l<s)?{state:n.cross(e.center.sub(t.start()))<0?4:3}:{state:n.cross(e.center.sub(t.start()))>0?4:3}}return Ig(e,t,a,o)}function im(t,e){return e=Bi.regularD(e),t.sweepAngle>0?(e<t.startAngle&&(e+=360),t.endAngle()>e):(e>t.startAngle&&(e-=360),t.endAngle()<e)}function v6(t,e){return Qr(t.end(),e)||Qr(t.start(),e)||im(t,e.angleD(t.center))}function FX(t,e){let r=t.panDistance(di),i=t.panDistance(-di),n=aX(e,r),s=aX(e,i);if(!n.length&&!s.length)return{isIn:e.getPercent(t.end(),di)!==null};let a=[...n,...s].sort((u,d)=>u.t-d.t),o=new je(i.start(),r.start()),l=[];for(let u=0,d=a.length;u<d;u++){let A=a[u];if(l.push(A),o.distance(A.interP)>t.length()+di)break;if(l.length===2){let h=(l[1].t*10+l.shift().t*10)/20,f=vr.pointOn(h,e.controls);if(t.distance2(f)>fu)return{isIn:!1,bezierIsInLeft:t.direct.cross(f.sub(t.start()))>0}}}let c=l.length?o.distance(l[0].interP)>=t.length()+di:!0;return{isIn:c,bezierIsInLeft:c?void 0:t.direct.cross(l[0].interP.sub(t.start()))>0}}function UX(t,e){if(oS(e,t.end())>fu||t.getToLineMaxDis2(e)>fu)return!1;let r=qwe(e,fu);return t.getToLineMaxDis2(r)<=(e.length()+di)**2}function HX(t,e){let r=e.end().angleD(e.start()),i=Xwe(e,t.end());if(i>fu)return!1;if(im(t,r+90)){if(Wf.foot(e,t.center).distance1(t.pointOn(r+90))>t.rx)return!1;i=Math.max(i,(t.rx-e.distance(t.center))**2)}if(im(t,r-90)){if(Wf.foot(e,t.center).distance1(t.pointOn(r-90))>t.rx)return!1;i=Math.max(i,(t.rx-e.distance(t.center))**2)}return i<=fu&&(Qr(t.end(),e.end())||c6(e,t.end()))}var GX=(di*2)**2;function C6(t,e){if(Qr(t.end(),e))return bt.build3(t.center,t.endAngle(),0,t.rx,t.ry);if(t.start().distance2(e)<GX)return t;let r=Bi.regularD(e.angleD(t.center));if(!im(t,r))throw new Error("!angleIsInArc(arc, angle)");return bt.build2(t.center,r,t.endAngle(),t.rx,t.ry,t.isCCW?1:0)}function l6(t,e){if(Qr(t.end(),e))return new vr([e,e]);if(t.start().distance2(e)<GX)return t;let r=t.getPercent(e,di);if(r===null)throw new Error("!cutBezier(bezier: Bezier, p: Vector2)");return t.clip(r)[1]}function sX(t,e){let r=HX(C6(t,e.start()),e),i=e.end().distance2(t.center),n=e.end().sub(e.start()),s=Wf.foot(e,t.center),a=(t.rx-di)**2,o=i<=(t.rx+di)**2&&i>=a&&(n.dot(s.sub(e.start()))<=0||e.start().distance2(e.end())<=e.start().distance2(s)||s.distance2(t.center)>=a)&&(Qr(t.end(),e.end())||v6(t,e.end()));if(!r&&!o){let l=e.distance2(t.center);return l<=fu?{state:n.cross(Kf(t,e.start().angle(t.center)))>0?3:4}:n.dot(s.sub(e.start()))>=0&&(i<a||e.start().distance2(t.center)<a||l<a)?{state:n.cross(t.center.sub(e.start()))>0?4:3}:{state:n.cross(t.center.sub(e.start()))<0?4:3}}return Ig(e,t,r,o)}function X1(t,e){if(Qr(t.end(),e.end()))return Ig(t,e,!0,!0);let r=oS(e,t.end())<=fu&&c6(e,t.end()),i=oS(t,e.end())<=fu&&c6(t,e.end());if(!r&&!i){let n=t.direct.x===0&&t.direct.y===0,s=e.direct.x===0&&e.direct.y===0;if(n&&s)throw Error("2LineAllIsPoint");return n?{state:e.direct.cross(t.end().sub(e.start()))>0?3:4}:{state:t.end().sub(t.start()).cross(e.end().sub(t.start()))>0?4:3}}return Ig(t,e,r,i)}function c6(t,e){return Wf.foot(t,e).distance2(t.start())<t.end().distance2(t.start())}function Ig(t,e,r,i){if(r)return i?Qr(t.end(),e.end())?{state:2}:{state:0}:{state:0};if(i)return{state:1};throw new Error("!end1 && !end2")}function oS(t,e){return(t.a*e.x+t.b*e.y+t.c)**2/(t.a**2+t.b**2)}function Xwe(t,e){return Math.min(t.distance2(e),Wf.foot(t,e).distance2(e))}function qwe(t,e){let r=t.panDistance(e),i=t.panDistance(-e);return new je(i.start(),r.start())}function vg(t){let e=t.start(),r=t.end();e.equals1(r)&&(r=e.add1(1,0));let i=r.y-e.y,n=e.x-r.x,s=-i*e.x-n*e.y,a=Math.sqrt(1/(i**2+n**2));i*=a,n*=a,s*=a;let o=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;return t.controls.forEach(c=>{let u=i*c.x+n*c.y+s;u<o&&(o=u),u>l&&(l=u)}),lm(o,l)}function aX(t,e){let r=YA(t,e),i=[],n=new Array(r).fill(0).map((a,o)=>_e[o]);for(let a=0;a<r;a+=2){let o=new nt(_e[a],_e[a+1]),l=t.getPercent(o);i.push({interP:o,t:l}),s()}function s(){for(let a=0;a<r;a+=2)_e[a]=n[a],_e[a+1]=n[a+1]}return i}var rm=.01,Wwe=270;function Z0(t){let e=rm**2,r=t.end(),i=[],n=[];for(let h=0,f=t.primitives.length;h<f;h++){let p=function(U,_){return U instanceof je&&_ instanceof je&&Math.abs(U.direct.cross(_.direct))<Ct.eps&&U.direct.dot(_.direct)>0||U instanceof bt&&_ instanceof bt&&Math.abs(U.rx-_.rx)<=Ct.eps&&U.center.distance2(_.center)<Ct.eps&&U.isCCW===_.isCCW},m=function(U){if(Xd(U,rm))n.push(null);else{if(U instanceof je)n.push(U);else if(U instanceof bt&&U.rx===U.ry)d(U,n);else if(U instanceof vr){let _=[];DX(U,_),_.forEach(H=>{let Q=H.start(),j=H.end();u(Q,j)||n.push(H)})}else throw new Error("not support!");r=E}},y=function(U){if(U instanceof je)return U.direct.x===0&&U.direct.y===0;if(U instanceof bt)return U.sweepAngle===0;if(U instanceof vr){let _=new Set(U.controls.map(Q=>Q.x)),H=new Set(U.controls.map(Q=>Q.y));return _.size===1&&H.size===1}else throw new Error("not support")},g=t.primitives[h],b=g.start(),E=g.end();if(y(g))continue;u(r,b)||(n.push(new je(r,b)),r=b);let w=(h+1)%f,x=t.primitives[w];for(;p(g,x)&&(w=(w+1)%f,x=t.primitives[w],x!==g););if(w===(h+1)%f){m(g);continue}if(x===g){if(!(g instanceof bt)){if(Math.abs(t.area(.1))<e)return null;throw new Error("simplifyPolyline not support")}let U=g instanceof bt?g.isCCW:t.area(.1)>0;n.length=0;let _=U?180:-180;n.push(bt.build3(g.center,g.startAngle,_,g.rx,g.ry),bt.build3(g.center,g.startAngle+_,_,g.rx,g.ry));break}let I=(()=>{if(g instanceof je)return(U,_)=>{let H=new je(U,_);return Xd(H,rm)?null:[H]};if(g instanceof bt)return(U,_)=>{let H;if(U.equals1(_)?H=bt.build3(g.center,g.startAngle,g.sweep()===1?360:-360,g.rx,g.ry):H=bt.build4(U,_,g.center,g.rx,g.ry,g.sweep()),Xd(H,rm))return null;let Q=H.pointOn(H.startAngle+H.sweepAngle/2),j=bt.build4(H.start(),Q,g.center,g.rx,g.ry,g.sweep()),$=bt.build4(Q,H.end(),g.center,g.rx,g.ry,g.sweep());return Xd(j,rm)||Xd($,rm)?[H]:[j,$]};throw new Error("not support")})(),C=w===0;if(w<h&&!C&&(C=!I(t.primitives[0].start(),t.primitives[w-1].end()),!C)){let U=I(g.start(),t.primitives[f-1].end());if(U)n.push(...U);else{let _=I(g.start(),n[0].end());if(_.length===1)n[0]=_[0];else if(_.length===2)n[0]=_[1],n.push(_[0]);else throw new Error("!!!generatorPt")}break}h=w===0?f-1:w-1,x=t.primitives[h];let G=I(g.start(),x.end());if(G?(G.forEach(U=>n.push(U)),r=x.end()):m(null),C)break}let s=n.length;if(n.forEach((h,f)=>{if(h)i.push(h);else{let p,m;f===s-1&&(p=i[0],m=i[i.length-1]);let y=(f+1)%s;if(p=p!=null?p:n[y],p){let g=f,b=!1;for(;m=m!=null?m:n[(--g+s)%s],m!==p;)if(m){b=!0;break}if(b){if(p.start().equals1(m.end()))return;if(hi(m,m.end()).dot(hi(p,p.start()))<0){if(!u(m.end(),p.start())){let I=new je(m.end(),p.start());i.push(I);return}let{rebuildPrevPt:E,rebuildNextPt:w,rebuildLinkLine:x}=oX(n[(g-1+s)%s],m,new je(m.end(),p.start()),p,n[(f+2)%s]);E&&w&&(E!==m?(n[(g+s)%s]=E,i[i.length-1]&&(i[i.length-1]=E)):w!==p&&(n[(f+1)%s]=w,i[0]===p&&(i[0]=w)),x&&i.push(x))}}}}}),i.length===0)return null;u(r,i[0].start())||i.push(new je(r,i[0].start()));let a=i[i.length-1];if(i.length===1)return a instanceof bt?dn.build7([bt.build2(a.center,0,180,a.rx,a.ry,a.sweep()),bt.build2(a.center,180,360,a.rx,a.ry,a.sweep())]):a instanceof vr?dn.build7(a.clip(.5)):null;let o=i.map(h=>new Kwe(h)),l=o[o.length-1];for(o.forEach(h=>{h.connect(l),l=h});!l.isVisited;){let h=function(){l.next.connect(p),l=l.next,l.isConnected=!1,l.isVisited=!1},f=function(){l.connect(p.prev),l.isConnected=!1},p=l.prev;if(l===p)break;let m=l.pt,y=p.pt,g=y.end();if(!l.isConnected&&!g.equals(m.start())){let b=function(w){l.isConnected=!0,l.pt=m=w,l.next.isVisited=!1},E=function(w){l.isConnected=!0,p.pt=w,p.isVisited=!1,l=p};if(m instanceof je)if(u(g,m.end())){h();continue}else b(new je(g,m.end()));else if(y instanceof je){u(y.start(),m.start())?f():E(new je(y.start(),m.start()));continue}else if(m instanceof vr)if(u(g,m.end())&&!(m.controls.length!==2&&m.getToLineMaxDis2(m.startToEndL)>=e)){h();continue}else b(new vr([g,...m.controls.slice(1)]));else if(y instanceof vr)u(y.start(),m.start())&&!(y.controls.length!==2&&y.getToLineMaxDis2(y.startToEndL)>=e)?f():E(new vr([...y.controls.slice(0,-1),m.start()]));else if(m instanceof bt&&y instanceof bt)if(Math.abs(Math.abs(m.sweepAngle)-180)<Math.abs(Math.abs(y.sweepAngle)-180)){let w=bt.build5(g,m.end(),m.sweepAngle);if(u(w.start(),w.end())&&!(w.rx>=rm&&Math.abs(w.sweepAngle)>180)){h();continue}else b(w)}else{let w=bt.build5(y.start(),m.start(),y.sweepAngle);u(w.start(),w.end())&&!(w.rx>=rm&&Math.abs(w.sweepAngle)>180)?f():E(w);continue}else throw new Error("not support")}if(hi(m,m.start()).dot(hi(y,y.end()))<0){let b=function(x,I,C,G,U,_){if(l.next===p){l=null;return}let{rebuildLinkLine:H,rebuildPrevPt:Q,rebuildNextPt:j}=oX(x,I,C,G,U);Q&&j&&(Q!==I&&(p.prev.pt=Q),j!==G&&(l.next.pt=j),H?_.pt=H:h())},E=function(){l.next===p?l=null:(l.next.connect(p.prev),l=l.next,l.isConnected=!1,l.isVisited=!1)},w=Au(y.reverse(),m).state;if(w===0){let x=lX(m,y.start(),m.end());if(A(x)){let I=p.prev.pt,C=l.next.pt;if(hi(C,C.start()).dot(hi(I,I.end()))>=0){if(E(),!l)break;continue}if(b(p.prev.prev.pt,I,x instanceof je?x:new je(x.start(),x.end()),C,l.next.next.pt,l),!l)break}else l.pt=x;f();continue}else if(w===1){let x=lX(y,y.start(),m.end());if(A(x)){let I=p.prev.pt,C=l.next.pt;if(hi(C,C.start()).dot(hi(I,I.end()))>=0){if(E(),!l)break;continue}if(b(p.prev.prev.pt,I,x instanceof je?x:new je(x.start(),x.end()),C,l.next.next.pt,p),!l)break}else p.pt=x;h();continue}else if(w===2){if(E(),!l)break;continue}}l.isVisited=!0,l=l.next}if(!l)return null;i.length=0;let c=l;for(i.push(l.pt),l=l.next;l!==c;)i.push(l.pt),l=l.next;if(i.length===1){let h=i[0];return h instanceof bt?(u(h.start(),h.end())?i[0]=bt.buildCircle(h.center,h.rx,h.sweep()):i.push(new je(h.end(),h.start())),dn.build7(i)):h instanceof vr?(u(h.start(),h.end())||i.push(new je(h.end(),h.start())),dn.build7(i)):null}if(t=dn.build7(i),Math.abs(t.area(.1))<e)return null;return t;function u(h,f){return h.distance2(f)<e}function d(h,f){if(Math.abs(h.sweepAngle)>Wwe){let p=h.sweepAngle/2;d(bt.build3(h.center,h.startAngle,p,h.rx,h.ry),f),d(bt.build3(h.center,h.startAngle+p,p,h.rx,h.ry),f)}else f.push(h)}function A(h){return h.start().distance2(h.end())<e&&!(h instanceof bt&&h.rx>=rm&&Math.abs(h.sweepAngle)>180||h instanceof vr&&h.controls.length!==2&&h.getToLineMaxDis2(new je(h.start().add1(1,0),h.end()))>=e)}}function Xd(t,e){if(!t)return!0;let r=t.start(),i=t.end();if(r.distance2(i)<e**2)if(t instanceof bt){if(!(t.rx>=e&&Math.abs(t.sweepAngle)>180))return!0}else if(t instanceof vr){if(!(t.controls.length!==2&&t.getToLineMaxDis2(new je(t.start().add1(1,0),t.end()))>=e))return!0}else return!0;return!1}function R2(t){if(t.direct.x===0&&t.direct.y===0)throw Error("getEndOfExtendLine(line: Line, distance: number)");let e=Math.abs(rm-t.length())+Ct.eps,r={x:t.direct.normalize().x*e,y:t.direct.normalize().y*e},i=t.end();return new nt(i.x+r.x,i.y+r.y)}function oX(t,e,r,i,n){if(!t)a();else if(!n)o();else{let l=hi(t,t.end()),c=hi(e,t.end()),u=l.dot(c);if(u>=0)a();else{let d=hi(i,i.end()),A=hi(n,i.end()),h=d.dot(A);if(h>=0)o();else if(lm(u,-1)&&lm(h,-1)){let f=r.center();s(f),r=null}else u>h?a():o()}}function s(l){let c;if(e instanceof je)c=new je(e.start(),l);else if(e instanceof vr)c=new vr([...e.controls.slice(0,-1),l]);else if(e instanceof bt)c=bt.build5(e.start(),l,e.sweepAngle);else throw new Error("not supported");e=Xd(c,di)?null:c;let u;if(i instanceof je)u=new je(l,i.end());else if(i instanceof vr)u=new vr([l,...i.controls.slice(1)]);else if(i instanceof bt)u=bt.build5(l,i.end(),i.sweepAngle);else throw new Error("supported");i=Xd(u,di)?null:u}function a(){if(e instanceof je){let l=R2(r.reverse());r=new je(l,r.end());let c=new je(e.start(),l);e=Xd(c,di)?null:c}else if(e instanceof vr){let l=R2(r.reverse());r=new je(l,r.end());let c=new vr([...e.controls.slice(0,-1),l]);e=Xd(c,di)?null:c}else if(e instanceof bt){let l=R2(r.reverse());r=new je(l,r.end());let c=bt.build5(e.start(),l,e.sweepAngle);e=Xd(c,di)?null:c}else throw new Error("not supported")}function o(){if(i instanceof je){let l=R2(r);r=new je(r.start(),l);let c=new je(l,i.end());i=Xd(c,di)?null:c}else if(i instanceof vr){let l=R2(r);r=new je(r.start(),l);let c=new vr([l,...i.controls.slice(1)]);i=Xd(c,di)?null:c}else if(i instanceof bt){let l=R2(r);r=new je(r.start(),l);let c=bt.build5(l,i.end(),i.sweepAngle);i=Xd(c,di)?null:c}else throw new Error("not supported")}return{rebuildPrevPt:e,rebuildNextPt:i,rebuildLinkLine:r}}function lX(t,e,r){if(t instanceof je||e.distance2(r)<=fu)return new je(e,r);if(t instanceof bt)return bt.build2(t.center,e.angleD(t.center),r.angleD(t.center),t.rx,t.ry,t.isCCW?1:0);if(t instanceof vr){let i=t.getPercent(e,di),n=t.getPercent(r,di);return t.clip(i)[1].clip((n-i)/(1-i))[0]}else throw new Error("not supported operation")}var Kwe=class{constructor(t){this.pt=t}connect(t){this.prev=t,t.next=this}};function aP(t){let e=AS(),r;if(t instanceof dn){let i=Z0(t);if(i===null)return null;r=i}else if(t instanceof $o){let i=t.items.map(n=>aP(n)).filter(n=>n!==null);if(i.length===0)return null;r=new $o(i)}else{let i=t.items.map(n=>aP(n)).filter(n=>n!==null);if(i.length===0)return null;r=new lo(i)}return am.preprocessPolyline+=W0(e),r}var am={addDocShapes2RTree:0,getPour:0,prepare:0,getSinglePourLayerPolyline:0,combindOutlines:0,mergeSameNet:0,run:0,end:0,deSelfIntersection:0,changeDirect:0,extend:0,preprocessPolyline:0,runBoolean:0,IntersectionSeeker:0,BooleanTools:0,totalBool:0};function AS(){return{timeIndex:Object.assign({},am),start:performance.now()}}function cX(t){return Object.values(t).reduce((e,r)=>e+r,0)}function W0(t){return performance.now()-t.start-(cX(am)-cX(t.timeIndex))}function Ql(t,e,r,i){let n=Wn.RED,s=Wn.Golden;function a(){if(!i)return;let A=i.initColor(Wn.Golden);A.addPt(o),A.addPoint(o.end()),i.initColor(Wn.RED).addPt(l),i.draw();debugger}let o=t.getShape(),l=r?e.getShape():e.getShape().reverse(),c=hi(o,l.start()),u=hi(l),d=c.cross(u);if(lm(d,0))if(o instanceof je)if(l instanceof je){if(Ct.eq(d,0)&&(c.dot(u)>0?!Qr(o.end(),l.start()):!Qr(o.start(),l.start())))throw a(),new Error("line and line");return d<0}else{if(l instanceof bt)return c.cross(l.center.sub(o.start()))<0;if(l instanceof vr){let A=l.getExtremePoints(o),h=A.length?A[0]:Y2(l.controls,o.start());return c.cross(h.sub(o.start()))<0}else throw new Error("not support")}else if(o instanceof bt){if(l instanceof je)return o.isCCW;if(l instanceof bt){if(l.center.equals1(o.center)&&(c.dot(u)>0?!Qr(o.end(),l.start())&&o.end().sub(l.start()).dot(u)>0:!Qr(o.start(),l.start())&&o.start().sub(l.start()).dot(u)>0))throw a(),new Error("arc and arc");return l.rx>=o.rx||l.center.distance2(o.center)>o.rx2?o.isCCW:!o.isCCW}else throw new Error("not support")}else if(o instanceof vr)if(l instanceof je){let A=o.getPercent(l.start(),di),h=o.clip(A)[1],f=h.getExtremePoints(l);return(f.length?f[0]:Y2(h.controls,l.start())).sub(l.start()).cross(u)<0}else if(l instanceof vr){let A=o.getPercent(l.start(),di),h=o.clip(A)[1],f=h.getExtremePoints(new je(l.start(),l.end())),p=l.getExtremePoints(new je(h.start(),h.end())),m=f.length?f[0]:Y2(h.controls,l.start()),y=p.length?p[0]:Y2(l.controls,l.start()),g=m.sub(l.start()),b=y.sub(l.start());return g.cross(b)<0}else throw Error("not support");else throw new Error("not support");else return d<0}function J1(t,e,r,i,n){let s=t.getShape(),a=e.getShape(),o=s instanceof bt?Kf(s,Bi.toRadians(s.endAngle())):s instanceof vr?sS(s,1):s.end().sub(s.start()).normalize(),l=hi(a),c=o.dot(l);if(lm(c,-1))return Ql(t,e,!0,n)?Ql(t,r,i,n)&&Ql(e,r,i,n):Ql(t,r,i,n)||Ql(e,r,i,n);{let u=o.scale(-1).angle(nt.ORIGIN),d=l.angle(nt.ORIGIN);u>d&&(u-=uP);let A=(u+d)/2,h=new nt(Math.cos(A),Math.sin(A)),f=i?r.getShape():r.getShape().reverse(),p=hi(f);return h.cross(p)<0?Ql(t,r,i,n):Ql(e,r,i,n)}}function XM(t,e,r,i,n){let s=t.getShape(),a=e.getShape(),o=s instanceof bt?Kf(s,Bi.toRadians(s.endAngle())):s instanceof vr?sS(s,1):s.end().sub(s.start()).normalize(),l=hi(a),c=o.dot(l);if(lm(c,-1))return Ql(t,e,!0,n)?Ql(t,r,i,n)&&Ql(e,r,i,n):Ql(t,r,i,n)||Ql(e,r,i,n);{let u=o.scale(-1).angle(nt.ORIGIN),d=l.angle(nt.ORIGIN);u>d&&(u-=uP);let A=(u+d)/2,h=new nt(Math.cos(A),Math.sin(A)),f=i?r.getShape():r.getShape().reverse(),p=hi(f);if(h.cross(p)<0){let m=o.dot(p)<0,y=Au(m?t.getShape().reverse():t.getShape(),f).state;return y!==3&&y!==4?Ql(t,r,i,n):y===(m?4:3)}else{let m=l.dot(p)<0,y=Au(m?e.getShape().reverse():e.getShape(),f).state;return y!==3&&y!==4?Ql(e,r,i,n):y===(m?4:3)}}}var Jwe=(t=>(t[t.NOT_IN=0]="NOT_IN",t[t.IS_IN=1]="IS_IN",t[t.IS_OVERLAP=2]="IS_OVERLAP",t))(Jwe||{}),$we=(t=>(t[t.AllClear=0]="AllClear",t[t.MapClear=1]="MapClear",t))($we||{}),nm,J0=!1;function qd(t,e,r,i,n,s,a,o=r.side===e,l=!0,c){return nm=n,J0=s,YX(VX(t,e,l,c,a,r,o,i),r,o,i,0)}function xg(t,e,r,i,n,s,a,o=i.side===r){nm=n,J0=s;let l=jX(t,e,r,new Map,i,o,a),c=l instanceof Array?-1:1;return YX(l,i,o,a,c)}function YX(t,e,r,i,n){for(;t instanceof Array;)n++,t.length===4?t=jX(...t,e,r,i):t=VX(...t,e,r,i);return{...t,existOverlap:n>0}}function VX(t,e,r,i,n,s,a,o){if(oP===-1){o.initColor(Wn.RED).addPt(t.getShape()),o.initColor(Wn.Golden).addPt(e.getShape()),o.draw();debugger}let l=t.getShape(),c=a?e.getShape().reverse():e.getShape(),u=(l instanceof bt?Kf(l,r?c.start().angle(l.center):i?Bi.toRadians(l.endAngle()):void 0):l instanceof vr?hi(l,r?c.start():i?l.end():l.start()):l.end().sub(l.start())).normalize(),d=(c instanceof bt?Kf(c,r?void 0:(i?l.end():l.start()).angle(c.center)):c instanceof vr?hi(c,r?void 0:i?l.end():l.start()):c.end().sub(c.start())).normalize();if(i===void 0){let f=u.dot(d);if(i=f<0,lm(f,0))return{state:Ql(t,e,!a,o)?1:0,inter:Eg(t,e,s,a,r,i,n)}}else if(i?u.dot(d)>0:u.dot(d)<0)if(r){let f,p=!0;if(l instanceof je&&Qr(Wf.foot(l,c.start()),i?l.end():l.start()))p=!1;else if(l instanceof bt||l instanceof vr){let m=i?l.reverse():l,y=Au(c,dwe(m,c.start()).reverse()).state;(y===1||y===2)&&(p=!1)}if(p){let m=!i;f=Au(m?l.reverse():l,c,o).state===(m?4:3)?1:0}else i?f=J1(t,t.nextSide,e,!a,o)?1:0:f=J1(t.prevSide,t,e,!a,o)?1:0;return{state:f,inter:Eg(t,e,s,a,r,i,n)}}else return i?{state:Ql(t,t.nextSide,!0,o)?0:1,inter:Eg(t,e,s,a,r,i,n),isReversed:!0}:{state:Ql(t.prevSide,t,!0,o)?0:1,inter:Eg(t,e,s,a,r,i,n),isReversed:!0};let A,h=new Map([[3,4],[4,3],[0,1],[1,0],[2,2]]);if(r)if(t.judgeOverlapMap.has(e)&&!J0){let f=t.judgeOverlapMap.get(e);A=i?h.get(f.state):f.state}else A=Au(i?l.reverse():l,c).state,(A===3||A===4)&&t.judgeOverlapMap.set(e,{state:i?h.get(A):A});else{if(e.judgeOverlapMap.has(t)&&!J0){let f=e.judgeOverlapMap.get(t);A=a?h.get(f.state):f.state}else A=Au(c,i?l.reverse():l).state,(A===3||A===4)&&e.judgeOverlapMap.set(t,{state:a?h.get(A):A});A=h.get(A)}if(A===1||A===2){let f=a?e.prevSide:e,p=f.inters,m=f.getEnd();for(let y=p.length-1;y>=0;y--){let g=p[y];if(!(f.getShape()instanceof vr)&&!Qr(m,g.coord))break;if(g===s)return{state:2,inter:Eg(t,e,s,a,r,i,n)}}}if(A===3||A===4)return{state:A===(i?4:3)?1:0,inter:Eg(t,e,s,a,r,i,n)};if(n.has(t)?n.get(t).mapSideList.push(e):n.set(t,{sideIsReversed:i,mapSideList:[e]}),n.has(e)?n.get(e).mapSideList.push(t):n.set(e,{sideIsReversed:a,mapSideList:[t]}),A===2)return i?[t.prevSide,t,a?e.prevSide:e.nextSide,n]:[t,t.nextSide,a?e.prevSide:e.nextSide,n];if(A===0)return[i?t.prevSide:t.nextSide,e,!1,i,n];if(A===1)return[t,a?e.prevSide:e.nextSide,!0,i,n];throw Error("not support")}function Eg(t,e,r,i,n,s,a){if(J0)return null;let o=t.getShape(),l=i?e.getShape().reverse():e.getShape(),c=i;if(!n){let h=e;e=t,t=h,i=s,r=r.getBindedInter()}let u=h=>!(n?s:c)&&Qr(h,t.prevSide.getEnd())?t.prevSide:t;if(i){let h=e.inters;for(let f=0;f<h.length;f++){let p=h[f];if(p.isInvalid&&s===void 0)continue;if(p===r&&Qr(l.start(),r.coord))return n?p:p.getBindedInter();let m=p.getBindedInter().side,y=u(p.coord);if(m===y&&d(p))return A(p)}for(;;){e=e.nextSide;let f=e.inters;for(let p=0;p<f.length;p++){let m=f[p];if(m===r)return n?m:m.getBindedInter();if(a.has(e)){let y=m.getBindedInter().side;if(a.get(e).mapSideList.includes(y)||Qr(m.coord,y.getEnd())&&a.get(e).mapSideList.includes(y.nextSide))return A(m);if(a.has(y)){let g=e.getShape().reverse(),b=hi(g,m.coord).dot(hi(y.getShape(),m.coord))<0,E=b?y.getShape().reverse():y.getShape(),w=Au(g,b?YM(E,m.coord,E.end()):YM(E,E.start(),m.coord)).state;if(w===1||w===2)return A(m)}else a.has(y.nextSide)}else if(m.side===r.side&&d(m))return A(m)}}}else{let h=e.inters;for(let f=h.length-1;f>=0;f--){let p=h[f];if(p.isInvalid&&s===void 0)continue;if(p===r&&Qr(l.start(),r.coord))return n?p:p.getBindedInter();let m=p.getBindedInter().side,y=u(p.coord);if(m===y&&d(p))return A(p)}for(;;){e=e.prevSide;let f=e.inters;for(let p=f.length-1;p>=0;p--){let m=f[p];if(m===r)return n?m:m.getBindedInter();if(a.has(e)){let y=m.getBindedInter().side;if(a.get(e).mapSideList.includes(y)||Qr(m.coord,m.getBindedInter().side.getEnd())&&a.get(e).mapSideList.includes(y.nextSide))return A(m);if(!a.has(y)&&a.has(y.prevSide)){let g=e.getShape().reverse(),b=hi(g,m.coord).dot(hi(y.getShape(),m.coord))<0;if(a.has(y.prevSide)){let E=b?y.getShape().reverse():y.getShape(),w=Au(e.getShape(),YM(E,m.coord,E.end())).state;if(w===1||w===2)return A(m)}}}else if(m.side===r.side&&d(m))return A(m)}}}function d(h){if(h.isInvalid||h.getBindedInter().side!==(Qr(h.coord,t.prevSide.getEnd())?t.prevSide:t))return!1;let f;if(n){if(Qr(h.coord,l.start()))return!0;f=Au(s?o.reverse():o,p(l)).state}else{if(Qr(h.coord,s?o.end():o.start()))return!0;f=Au(l,p(s?o.reverse():o)).state}return f===2||f===1;function p(m){if(m instanceof je)return Qr(h.coord,m.end())?m:m.cutLine(h.coord);if(m instanceof bt)return bt.build2(m.center,m.startAngle,h.coord.angleD(m.center),m.rx,m.ry,m.isCCW?1:0);if(m instanceof vr)return m.clip(m.getPercent(h.coord,di))[0];throw new Error("not supported operation")}}function A(h){let f=r.getBindedInter(),p=r.side,m=f.side,y=r===h,g=r;if(i){let b=r.getIndex()-1;for(;p;){let E=p.inters;for(;b>=0;b--)if(r=E[b],r===h){y||(r.setIsInvalid(),r.isDealed(),g=r),p=null;break}else if(nm===0)!r.isInvalid&&(!Qr(r.coord,h.coord)||r.side===h.side&&r.getBindedInter().side===h.getBindedInter().side)&&(r.setIsInvalid(),r.isDealed(),g=r);else if(nm===1){if(r.isInvalid)continue;let w=r.getBindedInter().side;a.has(p)&&a.get(p).mapSideList.includes(w)&&(r.setIsInvalid(),r.isDealed(),g=r)}p=p==null?void 0:p.prevSide,b=(p==null?void 0:p.inters.length)-1}}else{let b=r.getIndex()+1;for(;p;){let E=p.inters;for(;b<E.length;b++){r=E[b];let w=r.getBindedInter();if(r===h){y||(r.setIsInvalid(),r.isDealed(),g=r),p=null;break}else if(nm===0)!r.isInvalid&&(!Qr(r.coord,h.coord)||p===h.side&&(Qr(w.side.getEnd(),r.coord)?w.side.nextSide:w.side)===h.getBindedInter().side)&&(r.setIsInvalid(),r.isDealed(),g=r);else if(nm===1){let x=w.side;a.has(p)&&a.get(p).mapSideList.includes(x)&&(r.setIsInvalid(),r.isDealed(),g=r)}}p=p==null?void 0:p.nextSide,b=0}}if(nm===0&&!Qr(f.coord,h.coord))if(n?a.has(m)?a.get(m).sideIsReversed:s:c){let b=f.getIndex()-1;for(;m;){let E=a.has(m),w=m.inters;for(;b>=0;b--){if(f=w[b],f===h.getBindedInter()){m=null;break}f.isInvalid||!E||(!Qr(f.coord,h.getBindedInter().coord)||f.side===h.side&&f.getBindedInter().side===h.getBindedInter().side)&&(f.setIsInvalid(),f.isDealed())}m=m==null?void 0:m.prevSide,b=(m==null?void 0:m.inters.length)-1}}else{let b=f.getIndex()+1;for(;m;){let E=m.inters,w=a.has(m);for(;b<E.length;b++){if(f=E[b],f===h.getBindedInter()){m=null;break}let x=Qr(m.getEnd(),f.coord)?a.has(m.nextSide):!1;f.isInvalid||!(w||x)||(!Qr(f.coord,h.getBindedInter().coord)||f.side===h.side&&f.getBindedInter().side===h.getBindedInter().side)&&(f.setIsInvalid(),f.isDealed())}m=m==null?void 0:m.nextSide,b=0}}return n?g:g.getBindedInter()}}function jX(t,e,r,i,n,s,a){let o=t.getShape(),l=e.getShape(),c=s?r.getShape().reverse():r.getShape(),u=(o instanceof bt?Kf(o,c.start().angle(o.center)):o instanceof vr?hi(o,c.start()):o.end().sub(o.start())).normalize(),d=(l instanceof bt?Kf(l,c.start().angle(l.center)):l instanceof vr?hi(l,c.start()):l.end().sub(l.start())).normalize(),A=u.dot(d);if(lm(A,-1)){let h=s?r.getShape().reverse():r.getShape(),f=hi(h).normalize(),p=u.add(d.scale(-1)).normalize().dot(f),m=Au(o.reverse(),l,a).state;if(p>-.9&&(m===3||m===4))return{state:m===4?0:1,inter:Eg(e,r,n,s,!0,!1,i)};let y=qd(t,r,n,a,nm,J0,i.size===0?new Map:i,s);return y.state===2?y:m===4?y.state===0||y.inter!==n?y:qd(e,r,n,a,nm,J0,i.size===0?new Map:i,s):y.state===1||y.inter!==n?y:qd(e,r,n,a,nm,J0,i.size===0?new Map:i,s)}else{let h=u.scale(-1).angle(nt.ORIGIN),f=d.angle(nt.ORIGIN);h>f&&(h-=uP);let p=(h+f)/2,m=new nt(Math.cos(p),Math.sin(p)),y=hi(c).normalize(),g=y.angle(nt.ORIGIN),b=h<g&&g<f&&o instanceof je&&l instanceof je&&c instanceof je;if(m.cross(y)<=0){if(u.scale(-1).dot(y)<0){let E;return n.coord.equals1(c.start())?E=hi(o,n.coord).dot(hi(c,n.coord))<0:c instanceof je&&(E=hi(o,o.end()).dot(c.direct)<0),{state:J1(t,e,r,!s,a)?1:0,inter:Eg(t,r,n,s,!0,E,i)}}return b&&o.distance2(c.start())>fu?[e,r,!0,void 0,i]:[t,r,!0,void 0,i]}else return d.dot(y)<=0?{state:J1(t,e,r,!s,a)?1:0,inter:Eg(e,r,n,s,!0,void 0,i)}:b&&l.distance2(c.start())>fu?[t,r,!0,void 0,i]:[e,r,!0,void 0,i]}}var oP=0;function Zwe(t,e,r,i){let n=e.getBindedInter(),s=e.side,a=n.side,o=s.getShape(),l=a.getShape();if(i&&(oP++,oP===-1)){i.initColor(Wn.RED).addPt(o),i.initColor(Wn.Golden).addPt(l),i.draw();debugger}let c=0,u=!1;if(t===-1){let I=xg(s,s.nextSide,a,n,c,u,i),C=I.state!==0;if(I.state===2){let U=hi(o,e.coord).add(hi(s.nextSide.getShape(),e.coord)).normalize(),_=hi(l,e.coord).add(hi(a.nextSide.getShape(),e.coord)).normalize();return x(C,U.dot(_)>0)}let G=xg(s,s.nextSide,a.nextSide,n,c,u,i);return I.state!==G.state?(w(I,G),1):x(C,I.state!==xg(a,a.nextSide,s,e,c,!0,i).state,I.inter,G.inter)}if(t===1){let I=qd(s,a,n,i,c,u,new Map),C=I.state!==0;if(I.state===2)return x(C,hi(o,e.coord).dot(hi(l,e.coord))>0);let G;if(I.isReversed&&I.existOverlap&&Qr(I.inter.coord,a.getEnd())&&I.inter.getBindedInter().side!==s){let H=I.inter.getBindedInter().side;if(H===s.nextSide)G={state:J1(s,H,a.nextSide,!0,i)?1:0,inter:n};else if(H===s.prevSide){if(G={state:J1(H,s,a.nextSide,!0,i)?1:0,inter:I.inter},I.state===G.state&&e!==I.inter){let Q=hi(l,e.coord),j=hi(a.nextSide.getShape(),e.coord),$=hi(H.getShape(),e.coord);return x(C,Q.add(j).dot($)>0,I.inter,G.inter)}}else G=qd(s,a.nextSide,n,i,c,u,new Map)}else G=qd(s,a.nextSide,n,i,c,u,new Map);if(I.state!==G.state)return w(I,G),1;let U=hi(l,e.coord),_=hi(a.nextSide.getShape(),e.coord);if(lm(U.dot(_),-1)){let H=Ql(a,a.nextSide,!0,i);return x(C,I.state!==qd(a.nextSide,s,e,i,c,!0,new Map,H?!C:C,!1).state,I.inter,G.inter)}else{let H=hi(o,e.coord);return x(C,U.add(_).dot(H)>0,I.inter,G.inter)}}if(!(o instanceof vr||l instanceof vr))return 1;let d=hi(o,e.coord),A=hi(l,e.coord),h,f;if(l instanceof je)h=new je(e.coord,l.start()),f=new je(e.coord,l.end());else if(l instanceof bt){let I=e.coord.angleD(l.center);h=bt.build2(l.center,I,l.startAngle,l.rx,l.ry,l.isCCW?0:1),f=bt.build2(l.center,I,l.endAngle(),l.rx,l.ry,l.isCCW?1:0)}else if(l instanceof vr){let I=l.getPercent(e.coord,di);[h,f]=l.clip(I),h=h.reverse()}else throw new Error("not support");let p=d.dot(A)>0,m,y;p?(m=Au(o.reverse(),h).state,y=Au(o,f).state):(m=Au(o,h).state,y=Au(o.reverse(),f).state);let g;m===0?g=qd(p?s.prevSide:s.nextSide,a,n,i,c,u,new Map,!0,!1,p):m===1?g=qd(s,a.prevSide,n,i,c,u,new Map,!0,!0,p):m===2?p?g=xg(s.prevSide,s,a.prevSide,n,c,u,i,!0):g=xg(s,s.nextSide,a.prevSide,n,c,u,i,!0):p?m===3?g={inter:n,state:0}:g={inter:n,state:1}:m===3?g={inter:n,state:1}:g={inter:n,state:0};let b=g.state!==0;if(g.state===2)return x(b,p);let E;if(y===0?E=qd(p?s.nextSide:s.prevSide,a,n,i,c,u,new Map,!1,!1,!p):y===1?E=qd(s,a.nextSide,n,i,c,u,new Map,!1,!0,!p):y===2?p?E=xg(s,s.nextSide,a.nextSide,n,c,u,i,!1):E=xg(s.prevSide,s,a.nextSide,n,c,u,i,!1):p?y===3?E={inter:n,state:1}:E={inter:n,state:0}:y===3?E={inter:n,state:0}:E={inter:n,state:1},g.state===E.state)return g.inter===E.inter?(e.setIsInvalid(),0):x(b,p,g.inter,E.inter);return w(g,E),1;function w(I,C){let G=I.state!==0;if(I.inter===C.inter){e.setOutToIn(G);return}else M2(I.inter,C.inter,!0),M2(C.inter,I.inter,!1);let U=[];if(t===-1){let H=hi(o,e.coord),Q=hi(s.nextSide.getShape(),e.coord),j=hi(l,e.coord),$=hi(a.nextSide.getShape(),e.coord);U.push(H.dot(j)),U.push(H.dot($)),U.push(Q.dot(j)),U.push(Q.dot($))}else{let H=hi(o,e.coord);U.push(hi(l,e.coord).dot(H)),U.push(hi(a.nextSide.getShape(),e.coord).dot(H))}if(U.reduce((H,Q)=>Math.abs(H)>Math.abs(Q)?H:Q,0)>0)if(r===1||r===0||r===2||r===3)e.setOutToIn(G);else throw new Error("not support");else if(r===1)_(!G);else if(r===0||r===2||r===3)_(G);else throw new Error("not support");function _(H){e.setIsInvalid();let Q=(H?I:C).inter;delete Q.isInvalid,delete Q.getBindedInter().isInvalid,Q.setOutToIn(!G)}}function x(I,C,G,U){if(G===U){if(e.side.outline.inters.find(Q=>!Q.isInvalid&&Q!==e&&Qr(Q.coord,e.coord)))return e.setIsInvalid(),0;let _=new wg(e.coord,s,i),H=new wg(e.coord,a,i);return _.bind(H),C?s.inters.splice(e.getIndex(),0,_):s.inters.splice(e.getIndex()+1,0,_),a.inters.splice(e.getBindedInter().getIndex(),0,H),_.setOutToIn(I),e.setOutToIn(!I),_.isDealed(),s.inters.forEach((Q,j)=>Q.setIndex(j)),a.inters.forEach((Q,j)=>Q.setIndex(j)),2}else{let _=function(){let H=G.getBindedInter(),Q=U.getBindedInter();delete G.isInvalid,delete H.isInvalid,delete U.isInvalid,delete Q.isInvalid,G.setOutToIn(!I),U.setOutToIn(I),M2(G,U,!0),M2(U,G,!1),M2(H,Q,C),M2(Q,H,!C)};if(e.setIsInvalid(),C){if(r===1||r===0||r===2||r===3)return _(),2;throw new Error("not support")}else{if(r===1)return I?0:(_(),2);if(r===0||r===2||r===3)return I?(_(),2):0;throw new Error("not support")}}}}function M2(t,e,r){let{judge:i,changeNum:n}=a(),s=t.getIndex();for(let o=s+n,l=t.side.inters;i(o);o+=n){if(l[o].isInvalid)continue;if(!Qr(l[o].coord,t.coord))break;l[o].setIndex(s),l[s].setIndex(o);let c=l[o];l[o]=l[s],l[s]=c,s=o}function a(){let o=t.side===e.side;if(r){let l=o?e.getIndex():t.side.inters.length;return{judge:c=>c<l,changeNum:1}}else{let l=o?e.getIndex()+1:0;return{judge:c=>c>=l,changeNum:-1}}}}var uX=0,wg=class{constructor(t,e,r){this.id=uX++,this.coord=t,this.side=e,r&&(this.id=uX++,this.drawDebug=r);let i=new od;i.ext2(t),this._bbox=i.build1()}bbox(){return this._bbox}resetVisitStatus(){this.visited=!1,this.bindedInter.visited=!1}isDealed(){this.dealed=!0,this.getBindedInter().dealed=!0}setOutToIn(t){this.outToIn=t,this.bindedInter.outToIn=!t}setIsInvalid(){this.isInvalid=!0,this.getBindedInter().isInvalid=!0}getBindedInter(){return this.bindedInter}bind(t){this.bindedInter=t,t.bindedInter=this}setIndex(t){this.index=t}isSorted(){return this.index!==void 0}getIndex(){return this.index}getVisited(){return this.visited}visitSelf(){this.visited=!0}visit(){this.visited=!0,this.bindedInter.visited=!0}getPrevPoint(){let t=this.getIndex(),e=this.side.getStart();return t&&(e=this.side.inters[t-1].coord),e}getTangent(){let t=this.side.getShape();if(t instanceof je)return t.end().sub(t.start());if(t instanceof bt){let e=this.coord.angle(t.center);return t.isCCW?e+=eP:e-=eP,new nt(Math.cos(e),Math.sin(e))}else{if(t instanceof vr)return sS(t,t.getPercent(this.coord,di));throw new Error("not support")}}findStartInter(){return this.outToIn===void 0?this.getTangent().cross(this.bindedInter.getTangent())>0?this:this.bindedInter:this.outToIn?this:this.bindedInter}run(){let t=[],e=this,r;if(this.drawDebug){qM++;let i=qM===-1,n=this.drawDebug.initColor(Wn.RED);if(i){this.drawDebug.draw();debugger}r=s=>{if(t.push(s),i){n.addPt(t[t.length-1]),this.drawDebug.draw();debugger}}}else r=i=>t.push(i);for(;!e.visited;){let i=function(o,l){if(Ct.eq(o.distance2(l),0))return;let c=dS.rebuild(s.getShape(),o,l);if(!c)return!0;r(c)};e.visit();let n=e.getIndex(),s=e.side,a=s.inters[n+1];for(;a!=null&&a.isInvalid;)a=s.inters[a.getIndex()+1];if(a)i(e.coord,a.coord),e=a.bindedInter;else{let o=i(e.coord,s.getEnd()),l=e.coord;for(s=s.nextSide,e=null;;){for(let c of s.inters)if(!c.isInvalid){e=c.bindedInter;break}if(e)break;o?(i(l,s.getEnd()),o=!1):r(s.getShape()),s=s.nextSide}o?(Ct.eq(l.distance2(e.coord),0)?i(l,s.getEnd()):i(l,e.coord),o=!1):Ct.eq(s.getEnd().distance2(e.coord),0)?r(s.getShape()):i(s.getStart(),e.coord)}}if(e!==this)throw this.drawDebug&&console.log(JSON.stringify({runId:qM,handleId:oP,boolId:JC})),new Error("inter !== this");return Z0(dn.build7(t))}},qM=0,WM=class u6{constructor(e,r,i,n,s){this.inters=[],this.allInterIsInvalid=!0,this.isVisit=!1,this.sides=e,this.isGroup1=i,this.isOutside=n,this.finalIsOutside=n,this.polyline=r,s&&(this.polygon=s),e.forEach(a=>a.outline=this)}static build(e,r,i,n,s){let a=e.primitives.map(l=>new dS(l,n)),o=a[a.length-1];return a.forEach(l=>{o.connect(l),o=l}),s?new u6(a,e,r,i,s):new u6(a,e,r,i)}setFinalIsOutSide(e){this.finalIsOutside=e}startAndEndIsSameOutsideFlag(){return this.isOutside===this.finalIsOutside}get hasInter(){return!!this.interOutlines}isAllInterIsInvalid(){return this.allInterIsInvalid}setAllInterIsInvalidToFalse(){this.allInterIsInvalid=!1}resetVisited(){this.isVisit=!1}intersect(e,r){if(!(e.interOutlines&&e.interOutlines===this.interOutlines))if(e.interOutlines)if(this.interOutlines){let i,n;this.interOutlines.length>e.interOutlines.length?(i=this.interOutlines,n=e.interOutlines):(i=e.interOutlines,n=this.interOutlines),n.forEach(s=>{i.push(s),s.interOutlines=i}),r.delete(n)}else e.interOutlines.push(this),this.interOutlines=e.interOutlines;else this.interOutlines?(this.interOutlines.push(e),e.interOutlines=this.interOutlines):(e.interOutlines=this.interOutlines=[this,e],r.add(this.interOutlines))}isContain(e){if(!this.polyline.bbox().extendOfSize(di).isContainsBBox(e.polyline.bbox()))return!1;let r=e.polyline.primitives[0].start();if(e.hasInter&&e.isAllInterIsInvalid()){let i=e.inters[0];i.getBindedInter().side.outline!==this?r=i.side.getCenterPoint():r=i.side.getCenterPoint(i.coord)}return!!this.polyline.getWindingNum(r)}isInternally(e){return!!this.polyline.getWindingNum(e)}isEqual(e){return this.polyline===e.polyline}bbox(){return this.polyline.bbox()}reverse(){this.sides.reverse();let e=this.sides[this.sides.length-1];this.sides.forEach(r=>{r.reverse(),e.connect(r),e=r})}returnPolyline(){let e=this.sides.map(i=>i.getShape()),r=this.polyline.primitives;if(this.sides.length===r.length){let i=new Set(r);if(!e.some(n=>!i.has(n)))return this.polyline}return dn.build7(e)}};function hX(t,e,r){let i=[];return t.forEach(n=>n.forEach(s=>{if(s.hasInter&&!s.isAllInterIsInvalid())return;let a=s.bbox(),o=e.search(a.extendOfSize(di)).filter(l=>l.bbox().extendOfSize(di).isContainsBBox(a)).sort((l,c)=>l.bbox().area()-c.bbox().area());for(let l of o)if(l.isContain(s)){let c=r(!s.isOutside,l.isOutside),u=r(s.isOutside,l.isOutside);c!==u&&(i.push(s),s.setFinalIsOutSide(!c));return}r(s.isOutside,!1)!==r(!s.isOutside,!1)&&i.push(s)})),i}function eve(t,e,r){let i;switch(r){case 0:i=(o,l)=>o&&l;break;case 1:i=(o,l)=>o||l;break;case 2:i=(o,l)=>o&&!l;break;case 3:i=(o,l)=>o&&!l||!o&&l;break;default:throw Error("not support the rule")}let n=new aS(10),s=new aS(10);t.forEach(o=>o.forEach(l=>n.add(l))),e.forEach(o=>o.forEach(l=>s.add(l)));let a=hX(t,s,i);return hX(e,n,(o,l)=>i(l,o)).forEach(o=>a.push(o)),a}var tve=class{constructor(t){this.roots=[],this.nodes=t.sort((e,r)=>e.bbox().minX-r.bbox().minX).map(e=>new rve(e)),this.nodes.forEach((e,r)=>{e.visit()&&(this.roots.push(e),this.build(r))})}build(t){let e=this.nodes[t];for(let r=t+1,i=this.nodes.length;r<i;r++){let n=this.nodes[r];if(e.key.bbox().maxX<n.key.bbox().minX)break;n.getIsVisit()||e.isContain(n)&&(n.visit(),e.addChild(n),this.build(r))}}getPolygons(){let t=[];return this.roots.forEach(e=>e.getPolygons().forEach(r=>t.push(r))),t}},rve=class{constructor(t){this.children=[],this.isVisit=!1,this.key=t}getIsVisit(){return this.isVisit}isContain(t){return this.key.isContain(t.key)}addChild(t){this.children.push(t)}getPolygons(){let t=[];return this.getPolylineList(t),t.map(e=>{let r=e[0].polygon;if(r&&r.items.length===e.length){let i=e.map(s=>s.returnPolyline()),n=new Set(r.items);return i.some(s=>!n.has(s))?new $o(i):r}else return new $o(e.map(i=>i.returnPolyline()))})}getPolylineList(t,e){e?(e.push(this.key),e=null):(e=[this.key],t.push(e)),this.children.forEach(r=>r.getPolylineList(t,e))}visit(){return this.isVisit?!1:(this.isVisit=!0,!0)}};function dX(t){let e="";return t.items.forEach((r,i)=>{let n="$";if(r.items.forEach((s,a)=>{let o="[";if(s.primitives.forEach((l,c)=>{let u="";if(l instanceof je)u=`Line,${l.start().x},${l.start().y},${l.end().x},${l.end().y}`;else if(l instanceof bt)u=`Arc,${l.center.x},${l.center.y},${l.startAngle},${l.sweepAngle},${l.rx}`;else if(l instanceof vr)u=`Bezier,${l.controls.map(d=>`${d.x},${d.y}`).join(",")}`;else throw new Error("not supported");if(c===s.primitives.length-1){o+=`${u}]`;return}o+=`${u},`}),a===r.items.length-1){n+=`${o}$`;return}n+=`${o}_`}),i===t.items.length-1){e+=`${n}`;return}e+=`${n}^`}),console.log(e),e}function AX(t){let e=t.split("^"),r=[];return e.forEach(n=>{let s=/\$(.*?)\$/,a=n.match(s)[1].split("_"),o=[];a.forEach(c=>{let u=/\[(.*?)\]/,d=c.match(u)[1].split(","),A=[],h=[];for(let p=0;p<d.length;p++){let m=d[p];if(m==="Line"||m==="Arc"||m==="Bezier"){if(A.length){let y=i(A);h.push(y),A.length=0}A.push(m);continue}A.push(Number(m))}A.length&&(h.push(i(A)),A.length=0);let f=dn.build7(h);o.push(f)});let l=new $o(o);r.push(l)}),new lo(r);function i(n){let s=n[0];if(s==="Line")return new je(new nt(n[1],n[2]),new nt(n[3],n[4]));if(s==="Arc")return bt.build3(new nt(n[1],n[2]),n[3],n[4],n[5],n[5]);if(s==="Bezier"){let a=[];for(let o=1;o<n.length;o+=2)a.push(new nt(n[o],n[o+1]));return new vr(a)}else throw new Error("not support")}}var ive=class{constructor(t=1){this.group1Str="$[Line,20193.777980000017,4122.200439600661,20193.77082,4211.848760073709,Arc,20193.972672902382,4211.8487570980205,179.99915535323618,-89.99540000050294,0.2018529024026465,Line,20193.972659672283,4212.050609999989,20193.972660393258,4212.039610000013,Arc,20193.97217289501,4211.848257065248,89.85403133887164,89.99540000041924,0.19135355574930143,Line,20193.78082,4211.848759926291,20193.78897999998,4122.200440479205,Line,20193.78897999998,4122.200440479205,20193.777980000017,4122.200439600661]$",this.group2Str="$[Arc,20209.72784128151,4122.2007625157785,258.46768032837986,-75.66780748375947,4.138846238512183,Line,20205.593935808283,4121.998590004101,20193.97982992629,4121.998600000001,Arc,20193.97983290198,4122.2004529023825,269.9991553532362,-89.99540000050297,0.20185290240401074,Arc,20193.782979999996,4122.20044,180.00375535340328,-180.0000000000027,0.004999999999025513,Arc,20193.979332869207,4122.200952909754,180.15347936671733,89.99540000008247,0.19135355575111057,Line,20193.97983008845,4122.009599999999,20205.603694309226,4122.003828485546,Arc,20209.733142304296,4122.194577876843,182.64475341258483,75.73379999998886,4.133851239977064,Line,20208.900400396684,4118.145470939558,20208.902599535475,4118.156248870184,Arc,20206.972515961093,4108.700057667588,78.46393309088245,-78.46759999998636,9.65115405866796,Arc,20216.618669999996,4108.69944,359.99996825446135,-180,0.004999999999200412,Arc,20206.973015966745,4108.699445349495,359.99996822365375,78.46759999998409,9.640654033253735]$^$[Line,20193.997796883676,4095.399470032799,20205.596133314026,4095.4013992171836,Arc,20209.72470159858,4095.1923799234505,177.10172964919312,-75.64935037184974,4.133855965730166,Arc,20209.73000213952,4095.198565517174,101.5415133143569,75.7293000000185,4.128850963459707,Line,20205.605834328744,4095.395161923586,20193.997203529463,4095.389485743675,Arc,20193.994588809255,4095.197684525904,89.21896662213764,4.544099999999517,0.19181903946188483,Arc,20193.981499796217,4095.1977402038,89.85034659953621,89.9999999995926,0.19135044893494071,Arc,20193.78515,4095.19824,0,-180,0.005,Arc,20193.98200016982,4095.1982398301675,179.99995179248322,-89.99999999974185,0.20185016982129908,Arc,20193.981986624152,4095.198185381971,89.9961078637802,-4.487285276547311,0.2019046184835962]$",this.rule=t}getGroup1(){return AX(this.group1Str)}getGroup2(){return AX(this.group2Str)}},KM=new cP(2),KC=class{getUnion(t,e=!0){return e&&(t=t.map(r=>this.asSameSweep([r])[0])),Hwe(Ewe,t)}asSameSweep(t){let e=0;return t.forEach(r=>e+=r.area(.01)),e>0?t.map(r=>r.reverse()):t}getSubtraction(t,e){let r=new iS(!1),i=new nS(z_.rule,KM,r);for(let n of t){let s=z_.weight(0);i.addPolyline(n,s)}for(let n of e){let s=z_.weight(1);i.addPolyline(n,s)}return i.simplify(),r.plGrps}getIntersection(t,e){let r=new iS(!1),i=new nS(X_.rule,KM,r);for(let n of t){let s=X_.weight(0);i.addPolyline(n,s)}for(let n of e){let s=X_.weight(1);i.addPolyline(n,s)}return i.simplify(),r.plGrps}getMutuallyExclusive(t,e){let r=new iS(!1),i=new nS(q_.rule,KM,r);for(let n of t){let s=q_.weight(0);i.addPolyline(n,s)}for(let n of e){let s=q_.weight(1);i.addPolyline(n,s)}return i.simplify(),r.plGrps}},JC=0,JM=!1;function $C(t,e,r,i,n){let s=AS(),a=[],o=[],l=[],c=new Set,u;if(n){if(u=new hS(n),JC++,JM){debugger;JM=!1;let E=new ive;$C(E.rule,E.getGroup1(),E.getGroup2(),i,n)}if(JC===-1||JM){console.table({rule:t,group1:dX(e),group2:dX(r)}),u.clear();let E=u.initColor(Wn.GREEN),w=u.initColor(Wn.WHITE),x=u.initColor(Wn.BLUE),I=u.initColor(Wn.Gray);e.items.forEach(C=>C.items.forEach((G,U)=>{U>0?w.addPly(G):E.addPly(G)})),r.items.forEach(C=>C.items.forEach((G,U)=>{U>0?I.addPly(G):x.addPly(G)})),u.draw();debugger}}let d=e.items.length!==0&&r.items.length!==0?e.bbox().extendOfSize(di).intersection1(r.bbox().extendOfSize(di)):null;if(d){let E=[],w=[];switch(t){case 0:{for(let x of e.items)x.bbox().isIntersect(d)&&E.push(x);for(let x of r.items)x.bbox().isIntersect(d)&&w.push(x);break}case 1:case 3:{for(let x of e.items)x.bbox().isIntersect(d)?E.push(x):a.push(x);for(let x of r.items)x.bbox().isIntersect(d)?w.push(x):a.push(x);break}case 2:{for(let x of e.items)x.bbox().isIntersect(d)?E.push(x):a.push(x);for(let x of r.items)x.bbox().isIntersect(d)&&w.push(x);break}default:throw new Error("not support")}E.length!==e.items.length&&(e=new lo(E)),w.length!==r.items.length&&(r=new lo(w))}else{switch(t){case 0:break;case 1:case 3:{e.items.forEach(E=>a.push(E)),r.items.forEach(E=>a.push(E));break}case 2:{e.items.forEach(E=>a.push(E));break}default:throw new Error("not support")}e=new lo([]),r=new lo([])}g(e,o,!0),g(r,l,!1);let A=t===2||t===3?(E,w)=>Qr(E.getEnd(),w)?E.nextSide:E:(E,w)=>Qr(E.prevSide.getEnd(),w)?E.prevSide:E,h=(E,w,x)=>{if(Qr(E.getEnd(),x)){if(E.inters.findIndex(I=>I.getBindedInter().side===w&&Qr(I.coord,E.getEnd()))===-1)return new wg(x,E,u)}else return new wg(x,E,u)},f=t===2||t===3?(E,w,x)=>{if(Qr(E.getStart(),x)){if(E.inters.findIndex(I=>I.getBindedInter().side===w&&Qr(I.coord,E.getStart()))===-1)return new wg(x,E,u)}else return new wg(x,E,u)}:h;i.seek(e,r,(E,w,x,I,C,G)=>{let U=o[E][w],_=l[I][C],H=U.sides[x],Q=_.sides[G],j=YA(H.getShape(),Q.getShape());if((H.getShape()instanceof vr||Q.getShape()instanceof vr)&&j>=4){if(H.getShape()instanceof bt||Q.getShape()instanceof bt){let B=function(v,N){let R=!1;for(let q=0;q<N.length;q+=2)Qr(new nt(N[q],N[q+1]),v)&&(R=!0);R||N.push(v.x,v.y)},M=[_e[0],_e[1]];for(let v=0;v<j;v+=2){let N=new nt(_e[v],_e[v+1]);for(let R=v+2;R<j;R+=2){let q=new nt(_e[R],_e[R+1]);if(!Qr(N,q)){B(q,M);break}}}j=M.length,M.forEach((v,N)=>_e[N]=v)}else for(let B=j-2;B>=2;B-=2)for(let M=B-2;M>=0;M-=2)if(Qr(new nt(_e[B],_e[B+1]),new nt(_e[M],_e[M+1]))){_e[M]=(_e[B]+_e[M])/2,_e[M+1]=(_e[B+1]+_e[M+1])/2;for(let v=j-3;v>=B;v--)_e[v]=_e[v+2];j-=2;break}}let $=0;if(j===4){let B=function(N){return Qr(H.getEnd(),N)||Qr(H.prevSide.getEnd(),N)||Qr(Q.prevSide.getEnd(),N)||Qr(Q.getEnd(),N)},M=new nt(_e[0],_e[1]),v=()=>{let N=new wg(M,H,u),R=new wg(M,Q,u);N.bind(R),N.setIsInvalid(),N.isDealed(),U.inters.push(N),_.inters.push(R)};if(_e[0]===_e[2]&&_e[1]===_e[3])if(B(M))$=2;else{v();return}}for(;$<j;$+=2){let B=new nt(_e[$],_e[$+1]),M=H,v=Q;if(Qr(M.prevSide.getEnd(),B)&&(M=M.prevSide),v=A(v,B),H!==M&&Q!==v){let R=t===2||t===3?Q.getEnd():v.getEnd();M.getEnd().distance1(B)<R.distance1(B)?(B=M.getEnd(),Qr(R,B)||(v=Q)):(B=R,Qr(M.getEnd(),B)||(M=H))}let N=h(M,v,B);if(N){let R=f(v,M,B);R&&(M.addInter(N),U.inters.push(N),v.addInter(R),_.inters.push(R),N.bind(R),U.intersect(_,c))}}return j},n);let p=b(),m=eve(o,l,t);m.forEach(E=>!E.startAndEndIsSameOutsideFlag()&&E.reverse()),new tve(p.concat(m)).getPolygons().forEach(E=>a.push(E));let y=new lo(a);if(u){if(JC===-1){let E=u.initColor(Wn.RED),w=u.initColor(Wn.Golden);a.forEach(x=>{E.addPly(x.items[0]),x.items.slice(1).forEach(I=>w.addPly(I))}),u.draw();debugger;throw new Error}y.id=JC}return am.BooleanTools+=W0(s),y;function g(E,w,x){E.items.forEach(I=>{let C=[];C.push(WM.build(I.items[0],x,!0,u,I)),I.items.slice(1).forEach(G=>{C.push(WM.build(G,x,!1,u))}),w.push(C)})}function b(){let E=[];return c.forEach(x=>{t===2||t===3?x.forEach(C=>{C.isGroup1||C.reverse(),C.sides.forEach(G=>G.sortInters())}):x.forEach(C=>C.sides.forEach(G=>G.sortInters())),x.map(C=>C.sides.filter(G=>G.inters.length)).flat(2).sort((C,G)=>{let U=C.inters,_=G.inters,H=Qr(U[U.length-1].coord,C.getEnd()),Q=Qr(_[_.length-1].coord,G.getEnd());if(H&&Q){let j=0,$=0;for(let B=U.length-2;B>=0&&Qr(U[B].coord,C.getEnd());B--)j++;for(let B=_.length-2;B>=0&&Qr(_[B].coord,G.getEnd());B--)$++;return $-j}else return H?-1:1}).forEach(C=>{C.inters.forEach(G=>{if(G.dealed)return;let U=G.side,_=G.getBindedInter().side,H;Qr(U.getEnd(),G.coord)&&Qr(_.getEnd(),G.coord)?H=-1:Qr(U.getEnd(),G.coord)?(H=1,G=G.getBindedInter()):Qr(_.getEnd(),G.coord)&&(H=1);let Q=Zwe(H,G,t,u);G.isDealed(),Q&&(U.outline.setAllInterIsInvalidToFalse(),_.outline.setAllInterIsInvalidToFalse())})}),I(x),t===3&&(x.forEach(C=>{C.reverse(),C.sides.forEach(G=>{G.sortInters(),G.inters.forEach(U=>{U.resetVisitStatus()})})}),I(x));function I(C){C.forEach(G=>{G.inters.forEach(U=>{if(U.isInvalid||U.getVisited())return;let _=U.findStartInter(),H=w(t)?_.run():_.getBindedInter().run(),Q=G.polyline.primitives;if(H){if(Q.length===H.primitives.length){let j=new Set(Q);if(!H.primitives.some($=>!j.has($))){E.push(G);return}}E.push(WM.build(H,!0,!0,u))}})})}}),E;function w(x){switch(x){case 0:case 2:case 3:return!0;case 1:return!1;default:throw Error("not support the rule")}}}}var H_=/\bstablilizetion\b/.test(self.location.href)||!0,QC={intersect(t,e,r,i){try{return $C(0,t,e,r,i)}catch(n){if(H_){let s=new KC().getIntersection(t.items.map(a=>a.items.map(o=>o)).flat(2),e.items.map(a=>a.items.map(o=>o)).flat(2));return new lo(s.map(a=>new $o(a.items)))}throw n}},union(t,e,r,i){try{return $C(1,t,e,r,i)}catch(n){if(H_){let s=new KC,a=t.items.map(l=>l.items.map(c=>c)).flat(2);e.items.forEach(l=>l.items.forEach(c=>a.push(c)));let o=s.getUnion(a);return new lo(o.map(l=>new $o(l.items)))}throw n}},diff(t,e,r,i){try{return $C(2,t,e,r,i)}catch(n){if(H_){let s=new KC().getSubtraction(t.items.map(a=>a.items.map(o=>o)).flat(2),e.items.map(a=>a.items.map(o=>o)).flat(2));return new lo(s.map(a=>new $o(a.items)))}throw n}},xor(t,e,r,i){try{return $C(3,t,e,r,i)}catch(n){if(H_){let s=new KC().getMutuallyExclusive(t.items.map(a=>a.items.map(o=>o)).flat(2),e.items.map(a=>a.items.map(o=>o)).flat(2));return new lo(s.map(a=>new $o(a.items)))}throw n}}},nve=class extends nS{constructor(t,e,r,i,n,s){super(t.rule,cP.DUMMY,e),this.sideGroup1=[],this.sideGroup2=[],this.group1=r,this.group2=i,this.seeker=n,this.addGroup(r,t.weight(0),this.sideGroup1),this.addGroup(i,t.weight(1),this.sideGroup2),this.bus=s}addGroup(t,e,r){if(!t)debugger;t.items.forEach(i=>{let n=[];i.items.forEach(s=>{let a=this.sides.length;this.addPolyline(s,e),n.push(this.sides.slice(a))}),r.push(n)})}seekIntersection(){this.seeker.seek(this.group1,this.group2,(t,e,r,i,n,s)=>{let a=this.sideGroup1[t][e][r],o=this.sideGroup2[i][n][s],l=YA(a.shape,o.shape);for(let c=0;c<l;c+=2){let u=new nt(_e[c],_e[c+1]);a.inters.push(u),o.inters.push(u),this.event.onIntersect(u,a,o)}return l},this.bus)}},sve=class extends iS{constructor(t){super(!!t),t&&(this.drawDebug=new hS(t),this.blueDrawing=this.drawDebug.initColor(Wn.BLUE),this.greenDrawing=this.drawDebug.initColor(Wn.GREEN),this.redDrawing=this.drawDebug.initColor(Wn.RED))}onOriginSide(t){super.onOriginSide(t),this.debug&&this.blueDrawing.addPt(t.shape)}onPolylineGroup(t,e){super.onPolylineGroup(t,e),this.debug&&t.items.forEach(r=>this.greenDrawing.addPly(r))}draw(){this.drawDebug.draw()}};function G_(t,e,r,i,n){let s=AS(),a=new sve(n);new nve(t,a,e,r,i,n).simplify();let o=[];a.plGrps.forEach(c=>{let u=c.items.map(d=>aP(d));u[0]&&o.push(new $o(u.filter(d=>d)))});let l=new lo(o);return am.BooleanTools+=W0(s),l}var Y_=!0,zC={intersect(t,e,r,i){try{return QC.intersect(t,e,r,i)}catch(n){if(Y_)throw n;return console.error(n),G_(X_,t,e,r,i)}},union(t,e,r,i){try{return QC.union(t,e,r,i)}catch(n){if(Y_)throw n;return console.error(n),G_(wwe,t,e,r,i)}},diff(t,e,r,i){try{return QC.diff(t,e,r,i)}catch(n){if(Y_)throw n;return console.error(n),G_(z_,t,e,r,i)}},xor(t,e,r,i){return QC.xor(t,e,r,i)}};var ave=class{init(t){}seek(t,e,r,i){let n=t.bbox().extendOfSize(5e-6).intersection1(e.bbox().extendOfSize(5e-6));if(!n)return;let s=AS(),a=[];for(let A=0,h=t.items.length;A<h;A++){let f=t.items[A];if(n.isIntersect(f.bbox()))for(let p=0,m=f.items.length;p<m;p++){let y=f.items[p];if(n.isIntersect(y.bbox()))for(let g=0,b=y.primitives.length;g<b;g++){let E=y.primitives[g].bbox();n.isIntersect(E)&&a.push({bbox:E,polygonIndex:A,polylineIndex:p,ptIndex:g})}}}let o=a.length;if(o===0){am.IntersectionSeeker+=W0(s);return}let l=[];for(let A=0,h=e.items.length;A<h;A++){let f=e.items[A];if(n.isIntersect(f.bbox()))for(let p=0,m=f.items.length;p<m;p++){let y=f.items[p];if(n.isIntersect(y.bbox()))for(let g=0,b=y.primitives.length;g<b;g++){let E=y.primitives[g].bbox();n.isIntersect(E)&&l.push({bbox:E,polygonIndex:A,polylineIndex:p,ptIndex:g})}}}let c=l.length;if(c===0){am.IntersectionSeeker+=W0(s);return}if(o<5||c<5){for(let A=0,h=a.length;A<h;A++)for(let f=0,p=l.length;f<p;f++)if(a[A].bbox.isIntersect(l[f].bbox.extendOfSize(1e-5))){let m=a[A],y=l[f];r(m.polygonIndex,m.polylineIndex,m.ptIndex,y.polygonIndex,y.polylineIndex,y.ptIndex)}am.IntersectionSeeker+=W0(s);return}a.sort((A,h)=>A.bbox.minX-h.bbox.minX),l.sort((A,h)=>A.bbox.minX-h.bbox.minX);let u=0,d=0;for(;u<o&&d<c;)if(a[u].bbox.minX<l[d].bbox.minX){let A=a[u],h=A.bbox;for(let f=d;f<c;f++){let p=l[f],m=p.bbox;if(m.minX>h.maxX+1e-5)break;(h.minY<m.minY?m.minY:h.minY)<(h.maxY<m.maxY?h.maxY:m.maxY)+1e-5&&r(A.polygonIndex,A.polylineIndex,A.ptIndex,p.polygonIndex,p.polylineIndex,p.ptIndex)}u++}else{let A=l[d],h=A.bbox;for(let f=u;f<o;f++){let p=a[f],m=p.bbox;if(m.minX>h.maxX+1e-5)break;(m.minY<h.minY?h.minY:m.minY)<(m.maxY<h.maxY?m.maxY:h.maxY)+1e-5&&r(p.polygonIndex,p.polylineIndex,p.ptIndex,A.polygonIndex,A.polylineIndex,A.ptIndex)}d++}am.IntersectionSeeker+=W0(s)}},dc,Rc=(dc=class{static getDebug(){return dc.drawDebug||(dc.drawDebug=new hS(dc.curBus)),dc.drawDebug}static getDrawing(e=Wn.GREEN){return this.getDebug().initColor(e)}static clearDrawing(){dc.getDebug().clear()}static drawText(e,r,i=Wn.GREEN){dc.getDrawing(i).addText(e,r,1.5,.1,!0)}static drawBBox(e,r=Wn.GREEN){if(!e)return;let i=dc.getDrawing(r),n=new je(e.UL(),e.UR()),s=new je(e.UR(),e.LR()),a=new je(e.LR(),e.LL()),o=new je(e.LL(),e.UL());i.addPt(n),i.addPt(s),i.addPt(a),i.addPt(o)}static drawPolyType(e,r){let i=dc.getDrawing(r);if(e instanceof dn)i.addPly(e);else if(e instanceof $o)for(let n of e.items)n instanceof dn?i.addPly(n):this.drawPolyType(n,r);else if(e instanceof lo)for(let n of e.items)this.drawPolyType(n,r)}static translate(e){switch(e){case 0:return"\u2229";case 2:return"-";case 1:return"U";case 3:return"X";default:break}}},dc.UseRunArrange=!0,dc.UseOptimizeSplit=!0,dc.LocalBestThread=4,dc.HandleDiff=!0,dc.OcTreeSplitStep=4,dc.PrintStart=new nt(150,-200),dc),XC=class h6{static getPolyTypeLine(e){let r=[];if(e instanceof dn)for(let i of e.primitives)r.push(i);else if(e instanceof $o)for(let i of e.items)if(i instanceof dn)for(let n of i.primitives)r.push(n);else{let n=this.getPolyTypeLine(i);for(let s of n)r.push(s)}else if(e instanceof lo)for(let i of e.items){let n=this.getPolyTypeLine(i);for(let s of n)r.push(s)}return r}static getPolyTypePolyLine(e){let r=[];if(e instanceof dn)r.push(e);else if(e instanceof $o)for(let i of e.items)if(i instanceof dn)r.push(i);else{let n=this.getPolyTypePolyLine(i);for(let s of n)r.push(s)}else if(e instanceof lo)for(let i of e.items){let n=this.getPolyTypePolyLine(i);for(let s of n)r.push(s)}return r}static getListBBox(e){if(e.length<=0)return;let r=new od;for(let i of e){let n=h6.getSingleBBox(i);r.ext1(n)}return r.build1()}static getSingleBBox(e){if(e instanceof Array){let r=new od,i=h6.getListBBox(e.slice(1));return r.ext1(i),r.build1()}else return e.bbox()}static doDrawRule(e,r=Rc.PrintStart){if(e.length<2)return[r,r,r];let i=5,n=10,s=e[0],a=Rc.translate(s),o=[],l=r.y,c=r.x,u=r.x;r=r.add(new nt(0,-n));for(let h=1;h<e.length;h++){let f=e[h];if(f instanceof Array){r=r.add(new nt(i,0));let p=this.doDrawRule(f,r);o.push(p[0]),p[1].x<=c&&(c=p[1].x),p[2].x>=u&&(u=p[2].x),r=new nt(p[2].x+i,r.y)}else o.push(r.clone()),r.x<=c&&(c=r.x),r.x>=u&&(u=r.x),Rc.drawText(r,f.name),r=r.add(new nt(i,0))}let d=0;for(let h of o)d+=h.x;let A=new nt(d/o.length,r.y+n);Rc.drawText(A,"N:"+a);for(let h of o){let f=new je(h,A),p=new Array;p.push(f);let m=dn.build1(r6(p));Rc.drawPolyType(m,Wn.GREEN)}return[A,new nt(c,l),new nt(u,l)]}static drawRule(e,r=Rc.PrintStart,i=!1,n){Rc.clearDrawing(),this.doDrawRule(e,r),i&&this.doDrawRulePolygon(e,n),Rc.getDebug().draw()}static doDrawRulePolygon(e,r){let i=e[0];for(let n=1;n<e.length;n++){let s=e[n];if(s instanceof Array)this.doDrawRulePolygon(s,r);else{let a=r;i===2&&n===1&&(a=Wn.RED),s.name&&Rc.drawText(s.bbox().UL(),s.name,a),Rc.drawPolyType(s,a)}}}static IsCenterBBoxPointInPolygonType(e,r){let i=e.center();for(let n of r.items)if(n.getOutMostPolyline().getWindingNum(i))return!0;return!1}static KeepBBoxPolygonGroup(e,r){let i=r.bbox().intersection1(e);if(!i)return!1;for(let n of r.items)if(n.bbox().isIntersect(i)){for(let s of n.items)if(s.bbox().isIntersect(i)){for(let a of s.primitives)if(i.isIntersect(a.bbox()))return!0}}return!!this.IsCenterBBoxPointInPolygonType(e,r)}},ove=class U2{static createNode(e,r,i){let n=e.UL(),s=e.width()/r,a=e.height()/r,o=~~(i/r),l=i-o*r,c=n.x+l*s,u=n.y-(o+1)*a,d=c+s,A=u+a;return new hu(c,d,u,A)}static ocTreeSplitNode(e,r,i,n,s=2){if(e.length<=i)return e;let a=[],o=s**2,l=new Array(o),c=new Array(o);for(let h=0;h<o;h++)l[h]=new Array(e.length),c[h]=0;let u=r.UL(),d=r.width()/s,A=r.height()/s;for(let h of e){let f=n(h).center(),p=~~((f.x-u.x)/d),m=~~((u.y-f.y)/A)*s+p;try{l[m][c[m]]=h,c[m]+=1}catch{a.push(h)}}for(let h=0;h<l.length;h++){let f=c[h];if(f<=0)continue;let p=l[h].slice(0,f);if(p.length===e.length)return e;let m=U2.createNode(r,s,h),y=U2.ocTreeSplitNode(p,m,i,n,s);if(y.length===e.length)return e;a.push(y)}return a}static ocTreeSplitNodeMinIntersect(e,r,i,n){let s=[];if(e.length<=i)return e;let a=3,o=r.LL(),l=r.UR(),c=r.width()/(a+1),u=r.height()/(a+1),d=-(2**32),A=[],h=[];for(let f=1;f<=a;f++)for(let p=1;p<=a;p++){let m=o.x+c*f,y=o.y+u*p,g=[[],[],[],[]],b=new Array(4),E=new Array(4);E[0]=new hu(o.x,m,y,l.y),E[1]=new hu(m,l.x,y,l.y),E[2]=new hu(o.x,m,o.y,y),E[3]=new hu(m,l.x,o.y,y);for(let C of e){let G=n(C).center(),U=-1,_=-1;G.x===m?U=Math.random()>=.5?1:-1:G.x>m?U=1:G.x<m&&(U=-1),G.y===y?_=Math.random()>=.5?1:-1:G.y>y?_=1:G.y<y&&(_=-1),U===1&&_===1?g[1].push(C):U===1&&_===-1?g[3].push(C):U===-1&&_===-1?g[2].push(C):U===-1&&_===1&&g[0].push(C)}for(let C=0;C<4;C++){let G=g[C];if(G.length<=0)continue;let U=new od;for(let _ of G)U.ext1(n(_));b[C]=U.build1()}let w=0,x=0;for(let C of b)C&&(w+=C.area());x=w;let I=(C,G)=>{if(!b[C]||!b[G])return 0;let U=b[C].intersection1(b[G]);return U?U.area():0};x-=I(0,1),x-=I(0,2),x-=I(0,3),x-=I(1,2),x-=I(1,3),x-=I(2,3),x/w>=d&&(A=g,h=E)}for(let f=0;f<A.length;f++){let p=A[f];if(p.length<=0)continue;let m=h[f],y;if(p.length===e.length?y=U2.ocTreeSplitNode(p,m,i,n):y=U2.ocTreeSplitNodeMinIntersect(p,m,i,n),y.length===e.length)return e;s.push(y)}return s}static ocTreeSplit(e,r,i,n){return U2.ocTreeSplitNode(e,r,i,n,Rc.OcTreeSplitStep)}},lve=class QX{static simplifyRules(e,r){return Rc.UseOptimizeSplit&&(e=this.optimizeSplit(e,r)),e}static OcTreeOptimizeSplit(e){let r=e[0];if(r!==1||e.length<=Rc.LocalBestThread+1)return e;let i=e.slice(1),n=new Array(i.length);for(let c=1;c<e.length;c++)n[c-1]=c;let s=XC.getListBBox(i),a=ove.ocTreeSplit(n,s,Rc.LocalBestThread,c=>{let u=e[c];return XC.getSingleBBox(u)}),o=(c,u)=>{if(!(c.length<=0))for(let d of c)if(Array.isArray(d)){let A=[u[0]];o(d,A),u.push(A)}else{let A=e[d];u.push(A)}},l=[r];return o(a,l),l}static optimizeSplit(e,r){let i=e[0];if(i===2){if(Rc.HandleDiff){let s=e[1],a;if(Array.isArray(s)){let o=this.optimizeSplit(s,r);if(o.length<=1)return[2];a=d6(o,r)}else a=d6([2,s],r);if(e.length>3){let o;o=[1];for(let l=2;l<e.length;l++){let c=e[l];if(Array.isArray(c)){let u=XC.getListBBox([...c.slice(1)]);XC.KeepBBoxPolygonGroup(u,a)&&o.push(c)}else XC.KeepBBoxPolygonGroup(c.bbox(),a)&&o.push(c)}return o.length<=1?[2,a]:(o=this.optimizeSplit(o,r),o.length>1?[2,a,...o.slice(1)]:[2,a])}else{let o=e[2];if(Array.isArray(o)&&o[0]===1&&o.length>2){let l=o.slice(1);return this.optimizeSplit([2,a,...l],r)}}}else if(e.slice(1).length>2){let s=e[1],a=e.slice(2),o=this.optimizeSplit([1,...a],r);return o.length>1?[2,s,...o.slice(1)]:s}}else if(i===1){if(e.length-1>Rc.LocalBestThread){let s=!1;for(let a=1;a<e.length;a++){let o=e[a];if(!Array.isArray(o)){s=!0;break}}s&&(e=QX.OcTreeOptimizeSplit(e))}}else if(i===0&&e.length<=2)return[0];let n=[i];for(let s=1;s<e.length;s++){let a=e[s];if(Array.isArray(a)){let o=this.optimizeSplit(a,r);if(o.length<=1)continue;n.push(o)}else n.push(a)}return n}},cve=(t=>(t[t.INTERSECT=0]="INTERSECT",t[t.UNION=1]="UNION",t[t.DIFF=2]="DIFF",t[t.XOR=3]="XOR",t))(cve||{});function ZC(t){let e=t[0],r=[e];switch(e){case 0:for(let n=1;n<t.length;n++){let s=t[n];if(Array.isArray(s)&&(s=ZC(s),!s))return null;r.push(s)}break;case 1:case 3:for(let n=1;n<t.length;n++){let s=t[n];Array.isArray(s)&&(s=ZC(s),!s)||r.push(s)}break;case 2:let i=t[1];if(Array.isArray(i)&&(i=ZC(i)),!i)return null;r.push(i);for(let n=2;n<t.length;n++){let s=t[n];Array.isArray(s)&&(s=ZC(s),!s)||r.push(s)}break;default:throw new Error("not support boolean rule!")}return r.length===1?null:r}function $M(t,e,r){return Array.isArray(t)?zX(t,e,r):t}function ZM(t,e,r,i,n=!0){if(n)for(;t.length>1;){let s,a=[];for(t.length%2===1?(a.push(t[0]),s=1):s=0;s<t.length;s+=2)a.push(e(t[s],t[s+1],r,i));t=a}else for(;t.length>1;){if(t.length===2)return e(t[0],t[1],r,i);t=[e(t[0],t[1],r,i),...t.slice(2)]}return t[0]}function zX(t,e,r,i=!0){let n=new Array(t.length-1);for(let s=1;s<t.length;s++)n[s-1]=$M(t[s],e,r);switch(t[0]){case 0:return ZM(n,zC.intersect,e,r);case 1:return ZM(n,zC.union,e,r);case 2:let s=ZM(n.slice(1),zC.union,e,r);return s?zC.diff(n[0],s,e,r):n[0];case 3:let a=$M(t[1],e,r);for(let o=2;o<t.length;o++)a=zC.xor(a,$M(t[o],e,r),e,r);return a;default:throw new Error("not support boolean rule! "+t[0])}}function XX(t){let e=[t[0]];for(let r=1;r<t.length;r++){let i=t[r];if(Array.isArray(i)){let n=XX(i);Array.isArray(n)?n.length>1&&e.push(n):e.push(n)}else{let n=aP(i);n!==null&&e.push(lo.build(n))}}return e}function uve(t,e){Rc.curBus=e,t=XX(t);let r;return Rc.UseRunArrange?r=lve.simplifyRules(t,e):r=ZC(t),r.length<=1?new lo([]):d6(r,e)}function d6(t,e,r=!0){if(!t||t.length===1)return new lo([]);let i=t,n=new ave,s=[];function a(o){for(let l=1;l<o.length;l++){let c=o[l];Array.isArray(c)?a(c):s.push(c)}}return a(i),n.init(s),zX(i,n,e,r)}var V_=new Error("list is empty"),j_=class{constructor(t,e){this.prev=null,this.next=null,this.parent=t,this.item=e}insertAfter(t){t.next=this.next,this.next=t,t.prev=this,t.next!==null&&(t.next.prev=t)}insertBefore(t){t.prev=this.prev,this.prev=t,t.next=this,t.prev!==null&&(t.prev.next=t)}remove(){this.prev!==null&&(this.prev.next=this.next),this.next!==null&&(this.next.prev=this.prev)}set(t){this.item=t}},hve=class{constructor(t){this._next=t}hasNext(){return this._next!==null}next(){let t=this._next;if(t!==null)return this._next=t.next,t.item;throw new Error("iterator is null")}},dve=class{constructor(t){this._next=t}hasNext(){return this._next!==null}next(){let t=this._next;if(t!==null)return this._next=t.next,t;throw new Error("iterator is null")}},Ave=class{constructor(){this.first=null,this.last=null,this.cnt=0}add(t){return this.addLast(t)}push(t){return this.addLast(t)}pop(){return this.removeLast()}shift(){return this.removeFirst()}removeFirst(){let t=this.first;if(t===null)throw V_;return this.remove(t),t.item}removeLast(){let t=this.last;if(t===null)throw V_;return this.remove(t),t.item}addLast(t){if(this.first===null||this.last===null){let e=new j_(this,t);return this.first=e,this.last=e,this.cnt++,e}else return this.insertAfter(this.last,t)}addFirst(t){if(this.first===null||this.last===null){let e=new j_(this,t);return this.first=e,this.last=e,this.cnt++,e}else return this.insertBefore(this.first,t)}getFirst(){if(this.first===null)throw V_;return this.first.item}getLast(){if(this.last===null)throw V_;return this.last.item}insertAfter(t,e){let r=new j_(this,e);return t.insertAfter(r),t===this.last&&(this.last=r),this.cnt++,r}insertBefore(t,e){let r=new j_(this,e);return t.insertBefore(r),t===this.first&&(this.first=r),this.cnt++,r}remove(t){t.remove(),t===this.first&&(this.first=t.next),t===this.last&&(this.last=t.prev),this.cnt--}size(){return this.cnt}clear(){this.first=null,this.last=null,this.cnt=0}iterator(){return new hve(this.first)}listIterator(){return new dve(this.first)}toArray(){let t=new Array,e=this.first;for(;e!=null;)t.push(e.item),e=e.next;return t}},K_=class{constructor(t){this.inters=[],t&&(this.inters=t)}addInter(t){this.inters.push(t),t.group=this}findInter(t){let e=this.inters.find(r=>Qr(r.coord,t.coord));return e&&this.inters.find(r=>r.side===t.side)&&t.visitSelf(),e}getOutInter(t){let e=this.inters.filter(r=>!r.getVisited());if(e.length!==0)return e.length===1?e[0]:e.reduce((r,i)=>{if(!r||r.side.getShape()===t)return i;if(i.side.getShape()===t)return r;let n=r.coord,s=hi(t,n),a=hi(r.side.getShape(),n),o=hi(i.side.getShape(),n);return s.dot(a)>s.dot(o)?r:i},void 0)}getEntryInter(){}},e6=0;function qX(t,e){let r=t.primitives[0];if(t.primitives.length===1&&r instanceof bt&&Math.abs(r.sweepAngle)===360)return[t];let i=AS();e6++;let n,s=wve(t);if(s.length===0)return[];let a=mve(s);if(e6===-1){n=new hS(e);let u=n.initColor(Wn.BLUE);s.forEach(A=>u.addPt(A.getShape()));let d=n.initColor(Wn.GREEN);a.forEach(A=>d.addPoint(A.coord)),n.draw();debugger;throw new Error}if(a.length===0)return[dn.build7(s.map(u=>u.getShape()))];gve(a);let o=[],l=!1;try{xve(a,n)}catch(u){u.customType==="IS_OVERLAP"?(l=!0,o=new KC().getUnion([t]).map(d=>d.items).flat(2)):console.error(u)}if(l)return o;let c=bve(a);if(!c.length)return[dn.build7(s.map(u=>u.getShape()))];if(o=fve(c,n),o.length===0)return console.warn("=====deSelfIntersection=====",e6),[];if(n)throw o.forEach(u=>{n.initColor(Wn.WHITE).addPly(u),n.draw();debugger}),new Error;return am.deSelfIntersection+=W0(i),o}function fve(t,e){let r=[];return t.forEach(i=>{let n=i;i.inters.forEach(s=>{if(s.getVisited())return;let a=[],o=[],l;if(e){debugger;let u=e.initColor(Wn.RED);l=d=>{a.push(d),u.addPt(a[a.length-1]),e.draw();debugger}}else l=u=>a.push(u);do{let u=function(p,m){Ct.eq(p.distance2(m),0)||l(WX(h.getShape(),p,m))},d=o.findIndex(p=>p===s.group);if(d!==-1){let p=a.findIndex(g=>g===s.group),m=a.splice(p).filter(g=>!(g instanceof K_));if(m.length){let g=Z0(dn.build7(m));g&&r.push(g)}let y=a.filter(g=>!(g instanceof K_));if(s=o[d].getOutInter(y[y.length-1]),o.splice(d),!s)throw Error("interGroup not hav inter!!!2");continue}s.visitSelf(),o.push(s.group),a.push(s.group);let A=s.getIndex(),h=s.side,f=h.inters[A+1];for(;f!=null&&f.isInvalid||f&&f.group===s.group;)f=h.inters[f.getIndex()+1];if(f){u(s.coord,f.coord);let p=f.getBindedInter();if(s=p.getVisited()?p.group.getOutInter(p.side.getShape()):p,!s){if(f.group===n)break;throw new Error("interGroup not hav inter!!!3")}}else{for(u(s.coord,h.getEnd()),h=h.nextSide,s=null;;){for(let p of h.inters)if(!p.isInvalid){let m=p.group.getOutInter(h.getShape());if(!m){if(p.group===n){s=p;break}else if(p.getBindedInter().group===n){s=p.getBindedInter();break}continue}s=m;break}if(s)break;l(h.getShape()),h=h.nextSide}Ct.eq(h.getEnd().distance2(s.coord),0)?l(h.getShape()):u(h.getStart(),s.coord)}}while(s.group!==n);let c=Z0(dn.build7(a.filter(u=>!(u instanceof K_))));c&&r.push(c)})}),r}function pve(t){return{next(){return t.hasNext()?{value:t.next()}:{done:!0,value:void 0}},[Symbol.iterator](){return this}}}function mve(t){let e=[],r=new Ave;for(let i of t.slice().sort((n,s)=>n.bbox().minY-s.bbox().minY)){for(let n of pve(r.listIterator())){let s=n.item;if(s.bbox().maxY<i.bbox().minY)r.remove(n);else{let a=function(A,h){let f=new wg(h,A,null);return A.inters.push(f),e.push(f),f},o=function(A,h){let f=A.getEnd(),p=new nt(_e[0],_e[1]),m=new nt(_e[2],_e[3]),y=f.distance2(p)>f.distance2(m)?p:m,g=A.prevSide;a(Qr(g.getEnd(),y)?g:A,y).bind(a(h,y))},l=s.getShape(),c=i.getShape(),u=YA(l,c),d=u===4&&_e[0]===_e[2]&&_e[1]===_e[3];if(d&&(u-=2),s.nextSide===i)s.prevSide!==i&&u===4&&o(s,i);else if(s.prevSide===i)u===4&&o(i,s);else if(u!==0){let A=function(f,p){let m=f.prevSide;return a(Qr(m.getEnd(),p)?m:f,p)},h=new nt(_e[0],_e[1]);if(d&&!Qr(h,s.prevSide.getEnd())&&!Qr(h,i.prevSide.getEnd())&&hi(l,h).dot(hi(c,h))>0)continue;for(let f=0;f<u;f+=2){let p=new nt(_e[f],_e[f+1]);A(s,p).bind(A(i,p))}}}}r.add(i)}return e.forEach(i=>{i.getIndex()===void 0&&i.side.sortInters()}),e}function gve(t){t.forEach(e=>{let r=e.side.getEnd();if(e.isInvalid||!Qr(e.coord,r))return;let i=e.side.inters,n=e.getBindedInter().side;for(let s=i.length-1;s>=0;s--){let a=i[s];if(!Qr(a.coord,r))break;a!==e&&a.getBindedInter().side===n&&a.setIsInvalid()}})}function yve(t){let e=new aS(10);return t.forEach(r=>{r.isInvalid||e.add(r)}),e}function bve(t){let e=[],r=yve(t);return t.forEach(i=>{if(i.isInvalid||i.group)return;let n=r.search(i.bbox().extendOfSize(Ct.eps)).filter(s=>!s.group);if(n.length){let s=new Set,a=new K_(n);n.forEach(o=>{o.group=a,s.has(o.side)&&o.visitSelf(),s.add(o.side)}),e.push(a)}}),e}function xve(t,e){t.forEach(r=>{if(r.isInvalid||r.dealed)return;let i=r.side,n=r.getBindedInter().side,s;Qr(i.getEnd(),r.coord)&&Qr(n.getEnd(),r.coord)?s=-1:Qr(i.getEnd(),r.coord)?i.nextSide!==n&&(s=1,r=r.getBindedInter()):Qr(n.getEnd(),r.coord)&&n.nextSide!==i&&(s=1),Eve(s,r,e),r.isDealed()})}function Eve(t,e,r){let i=e.getBindedInter(),n=e.side,s=i.side,a=n.getShape(),o=s.getShape(),l=1,c=!1;if(t===-1){if(N2(a.reverse(),o.reverse())||N2(n.nextSide.getShape(),s.nextSide.getShape())){let d=xg(n,n.nextSide,s,i,l,c,r);if(d.state===2){let h=new Error("info1.state === InState.IS_OVERLAP");throw h.customType="IS_OVERLAP",h}let A=xg(n,n.nextSide,s.nextSide,i,l,c,r);d.state===A.state&&u(d,A)}else if(!(N2(a.reverse(),s.nextSide.getShape())||N2(n.nextSide.getShape(),o.reverse()))){let d=XM(n,n.nextSide,s,!1,r);d===XM(n,n.nextSide,s.nextSide,!0,r)&&d!==XM(s,s.nextSide,n.nextSide,!0,r)&&e.setIsInvalid()}}else if(t===1){let d=function(A,h){return hi(A,h.start()).dot(hi(h,h.start()))>0};if(N2(a.reverse(),o.reverse())||N2(a,s.nextSide.getShape())){let A=qd(n,s,i,r,l,c,new Map);if(A.state===2){let f=new Error("info1.state === InState.IS_OVERLAP");throw f.customType="IS_OVERLAP",f}let h=qd(n,s.nextSide,i,r,l,c,new Map);A.state===h.state&&u(A,h)}else if(d(a.reverse(),o.reverse())&&d(a,s.nextSide.getShape())){let A=Ql(n,s,!1,r);A===Ql(n,s.nextSide,!0,r)&&A!==J1(s,s.nextSide,new dS(WX(a,e.coord,a.end()),r),!0,r)&&e.setIsInvalid()}}function u(d,A){d.inter.setIsInvalid(),A.inter.setIsInvalid(),e.setIsInvalid()}}function WX(t,e,r){if(t instanceof je||e.distance2(r)<1e-6)return new je(e,r);if(t instanceof bt)return bt.build2(t.center,e.angleD(t.center),r.angleD(t.center),t.rx,t.ry,t.sweep());if(t instanceof vr){let i=t.getPercent(e,di),n=t.getPercent(r,di);return t.clip(i)[1].clip((n-i)/(1-i))[0]}else throw new Error("not supported operation")}function wve(t){let e=Z0(t);if(!e)return[];let r=e.primitives.map(n=>new dS(n,null)),i=r[r.length-1];return r.forEach(n=>{i.connect(n),i=n}),r}var Sg,vve=(Sg=class{static clearData(e){this.originalPrimitive=[],this.offsetPrimitive=[],this.rawOffsetPrimitive=[],this.offsetDistance=0,this.testI++,this.testI===0?this.drawDebug=new hS(e):delete this.drawDebug}static createRawOffsetEdge(){if(this.drawDebug){let e=this.drawDebug.initColor(Wn.WHITE);this.originalPrimitive.forEach(r=>e.addPt(r)),this.drawDebug.draw();debugger}for(let e=0;e<this.originalPrimitive.length;e+=1){let r=this.originalPrimitive[e];this.offsetPrimitive.push({index:e,offsetEdge:this.createOffsetEdge(r)})}if(this.drawDebug){let e=this.drawDebug.initColor(Wn.Golden);this.offsetPrimitive.forEach(r=>e.addPt(r.offsetEdge)),this.drawDebug.draw();debugger}if(this.offsetPrimitive.length>1)for(let e=0;e<this.offsetPrimitive.length;e+=1)if(e===this.offsetPrimitive.length-1){this.connectPrimitive(this.offsetPrimitive[e],this.offsetPrimitive[0]);let r=this.rawOffsetPrimitive[0],i;r instanceof bt?i=bt.build4(this.offsetPrimitive[0].offsetEdge.start(),r.end(),r.center,r.rx,r.ry,r.sweep()):i=new je(this.offsetPrimitive[0].offsetEdge.start(),r.end()),this.rawOffsetPrimitive.shift(),this.rawOffsetPrimitive.unshift(i)}else this.connectPrimitive(this.offsetPrimitive[e],this.offsetPrimitive[e+1]);else this.rawOffsetPrimitive=[]}static createCirclePrimitive(e,r){let i=e.width()*.5,n=e.height()*.5,s=Math.sqrt(i**2+n**2)+r;return[bt.buildCircle(e.center(),s)]}static getExtendPolyLine(e,r,i=!0,n){var o,l;if(!((o=e==null?void 0:e.primitives)!=null&&o.length))return[];let s=Z0(e);if(!((l=s==null?void 0:s.primitives)!=null&&l.length)){if(this.isExpansion){let c=[1],u=r*2;e.primitives.forEach(A=>c.push(A.stroke(u,1,0)));let d=uve(c,n);if(d.items.length!==1)throw new Error("group.items.length !== 1 ");return[d.items[0].items[0]]}return[]}if(e=s,this.clearData(n),this.originalPrimitive=e.primitives,this.isExpansion=r>0,this.offsetDistance=r,this.createRawOffsetEdge(),this.drawDebug){let c=this.drawDebug.initColor(Wn.BLUE);this.rawOffsetPrimitive.forEach(u=>c.addPt(u)),this.drawDebug.draw();debugger}let a=i?this.createClippingEdge(n):[dn.build2(this.rawOffsetPrimitive)];if(this.drawDebug){let c=this.drawDebug.initColor(Wn.RED);a.forEach(u=>c.addPly(u)),this.drawDebug.draw();debugger}if(a.length&&(!this.isExpansion||this.isExpansion&&a.length>1)&&(a=this.getValidityPrimitive(a)),this.drawDebug){let c=this.drawDebug.initColor(Wn.GREEN);a.forEach(u=>c.addPly(u)),this.drawDebug.draw();debugger;throw new Error}return a}static getValidityPrimitive(e){let r=[],i=Math.abs(this.offsetDistance);for(let n=0;n<e.length;n+=1){let s=!0,a=e[n].primitives;e:for(let o=0;o<a.length;o+=1){let l=a[o],c;if(l instanceof bt)c=l.midPoint;else if(l instanceof je)c=l.start();else throw new Error("not support!");for(let u=0;u<this.originalPrimitive.length;u+=1){let d=this.originalPrimitive[u],A;if(d instanceof bt?A=this.pointArcClosest(c,d):A=nwe(c,d.start(),d.end()).d,i-A>.01){s=!1;break e}}}s&&r.push(e[n])}return r}static getInters(e){let r=[];for(let i=0;i<e;i+=2)r.push(new nt(_e[i],_e[i+1]));return r}static pointArcClosest(e,r){let i=r.center;if(e.equals1(r.center))return r.rx;if(r.inArea(e,0)){let a=e.sub(i);return Math.abs(a.length()-r.rx)}let n=e.distance2(r.start()),s=e.distance2(r.end());return Ct.less(n,s)?Math.sqrt(n):Math.sqrt(s)}static createClippingEdge(e){let r=[],i=[],n=qX(dn.build2(this.rawOffsetPrimitive),e);n.forEach(a=>{let o=a.area(.01);r.push(o)});let s=Math.min(...r.filter(a=>a<0));for(let a=0;a<r.length;a+=1){let o=r[a];Ct.eq(o,0)||(!this.isExpansion&&o<0||this.isExpansion&&(o<0&&r[a]===s||o>0))&&i.push(n[a])}return i}static createOffsetEdge(e){if(e instanceof bt)return e.panDistance1(this.offsetDistance);if(e instanceof je)return e.panDistance(this.offsetDistance);throw new Error("not support!")}static connectPrimitive(e,r){e.offsetEdge instanceof je&&r.offsetEdge instanceof je?this.lineToLineConnect(e,r):e.offsetEdge instanceof bt&&r.offsetEdge instanceof bt?this.arcToArcConnect(e,r):e.offsetEdge instanceof je&&r.offsetEdge instanceof bt?this.lineToArcConnect(e,r):this.arcToLineConnect(e,r)}static isFalseIntersection(e){return e>1||e<0}static lineToLineConnect(e,r){let i=e.offsetEdge,n=r.offsetEdge,s=r.index,a=this.originalPrimitive[s].start();if(i.isParallel(n))i.bbox().intersection1(n.bbox())?this.rawOffsetPrimitive.push(i):this.lineToLineUseArcToConnect(a,i,n);else{let o=this.getLineToLineT(i,n),l=o[0],c=o[1];if(this.isFalseIntersection(l)||this.isFalseIntersection(c))l>1&&this.isFalseIntersection(c)?this.lineToLineUseArcToConnect(a,i,n):this.useLineToConnect(i,n);else if(!this.isFalseIntersection(l)&&!this.isFalseIntersection(c)){let u=i.end().sub(i.start()),d=i.start().add(u.mul(l)),A=new je(i.start(),d);this.rawOffsetPrimitive.push(A);let h=new je(d,n.end());this.updateNextOffsetPrimitive(s,h)}}}static updateNextOffsetPrimitive(e,r){this.offsetPrimitive[e].offsetEdge=r}static useLineToConnect(e,r){this.rawOffsetPrimitive.push(e);let i=new je(e.end(),r.start());this.rawOffsetPrimitive.push(i)}static lineToLineUseArcToConnect(e,r,i){let n=this.getSweep(e,r),s=this.getSweepAngel(r.end(),i.start(),e,n);if(s===0){this.useLineToConnect(r,i);return}this.rawOffsetPrimitive.push(r);let a=bt.build5(r.end(),i.start(),s);this.rawOffsetPrimitive.push(a)}static getSweep(e,r,i){let n=null,s=i||i===0?this.originalPrimitive[i]:r;if(s instanceof bt){let a=s.center.sub(s.end()).normalize();s.isCCW?n=new nt(a.y,-a.x):n=new nt(-a.y,a.x)}else n=r.end().sub(r.start()).normalize();return e.sub(r.end()).normalize().cross(n)>0?0:1}static getLineToLineT(e,r){let i=e.end().sub(e.start()),n=r.end().sub(r.start()),s=i.cross(n),a=r.start().sub(e.start()),o=e.start().sub(r.start()),l=a.cross(n)/s,c=o.cross(i)/-s;return[l,c]}static lineToArcConnect(e,r){let i=e.offsetEdge,n=r.offsetEdge,s=e.index,a=r.index,o=this.getLineJoinArcScalarAndIntersectionNum(i,n),l=this.originalPrimitive[a].start();if(o.intersectionNum===0)this.lineAndArcUseArcConnect(l,i,n,s);else if(o.intersectionNum===1){let c=o.points[0];this.lineAndArcConnectionDetail(i,n,o.t[0],c,l,s,a)}else if(o.intersectionNum===2){let c=o.points[0],u=o.points[1],d=c.distance2(l),A=u.distance2(l);this.lineAndArcConnectionDetail(i,n,d<A?o.t[0]:o.t[1],d<A?c:u,l,s,a)}}static lineAndArcConnectionDetail(e,r,i,n,s,a,o){let l=this.isTrueArcIntersection(r,n);if(!this.isFalseIntersection(i)&&l){let c=new je(e.start(),n);this.rawOffsetPrimitive.push(c);let u;!r.center.equals1(n)||r.sweepAngle>1e-4?(u=bt.build4(n,r.end(),r.center,r.rx,r.ry,r.sweep()),u instanceof bt&&u.sweepAngle===0&&(u=new je(u.start(),u.end()))):u=new je(r.center,n),this.updateNextOffsetPrimitive(o,u)}else l?this.useLineToConnect(e,r):this.lineAndArcUseArcConnect(s,e,r,a)}static lineAndArcUseArcConnect(e,r,i,n){let s=this.getSweep(e,r,n),a=this.getSweepAngel(r.end(),i.start(),e,s);if(a===0){this.useLineToConnect(r,i);return}let o=bt.build5(r.end(),i.start(),a);this.rawOffsetPrimitive.push(r),this.rawOffsetPrimitive.push(o)}static arcToLineConnectionDetail(e,r,i,n,s,a,o){let l=this.isTrueArcIntersection(e,n);if(!this.isFalseIntersection(i)&&l){let c;e.center.equals1(n)?c=new je(e.center,n):Math.abs(e.sweepAngle)<1e-4?c=new je(e.start(),n):(c=bt.build4(e.start(),n,e.center,e.rx,e.ry,e.sweep()),c instanceof bt&&c.sweepAngle===0&&(c=new je(c.start(),c.end()))),this.rawOffsetPrimitive.push(c);let u=new je(n,r.end());this.updateNextOffsetPrimitive(o,u)}else l?this.useLineToConnect(e,r):this.lineAndArcUseArcConnect(s,e,r,a)}static isTrueArcIntersection(e,r){return So(e,r)}static getSweepAngel(e,r,i,n){let s=e.angleD(i),a=r.angleD(i),o;return s===a?o=0:(s=Bi.regularD(s),a=Bi.regularD(a),n===1?a<=s&&(a+=360):a>=s&&(s+=360),o=a-s),o}static getLineJoinArcScalarAndIntersectionNum(e,r){let i={t:[],intersectionNum:0,points:[]},n=twe(r,e);if(n){i.intersectionNum=n/2;for(let s=0;s<n-1;s+=2){let a=new nt(_e[s],_e[s+1]);i.points.push(a),a.sub(e.start()).x<1e-4||a.sub(e.start()).y<1e-4?i.t.push(0):i.t.push(a.sub(e.start()).x/e.end().sub(e.start()).x)}}else i.intersectionNum=0;return i}static arcToLineConnect(e,r){let i=e.offsetEdge,n=r.offsetEdge,s=e.index,a=r.index,o=this.getLineJoinArcScalarAndIntersectionNum(n,i),l=this.originalPrimitive[a].start();if(o.intersectionNum===0)this.lineAndArcUseArcConnect(l,i,n,s);else if(o.intersectionNum===1){let c=o.points[0];this.arcToLineConnectionDetail(i,n,o.t[0],c,l,s,a)}else if(o.intersectionNum===2){let c=o.points[0],u=o.points[1],d=c.distance2(l),A=u.distance2(l);this.arcToLineConnectionDetail(i,n,d<A?o.t[0]:o.t[1],d<A?c:u,l,s,a)}}static rxChangeStatus(e){return e===1?!this.isExpansion:this.isExpansion}static arcToArcConnect(e,r){let i=e.offsetEdge,n=r.offsetEdge,s=BX(i,n);if(s){let a=this.getInters(s),o;if(a.length===2){let u=this.originalPrimitive[r.index].start(),d=a[0],A=a[1],h=d.distance2(u),f=A.distance2(u);h<f?o=d:o=A}else o=a[0];let l,c;o.equals1(i.center)?l=new je(i.center,o):Math.abs(i.sweepAngle)<1e-4?l=new je(i.start(),o):(l=bt.build4(i.start(),o,i.center,i.rx,i.ry,i.sweep()),l instanceof bt&&l.sweepAngle===0&&(l=new je(l.start(),l.end()))),this.rawOffsetPrimitive.push(l),o.equals1(n.center)?c=new je(o,n.center):Math.abs(n.sweepAngle)<1e-4?c=new je(o,n.end()):(c=bt.build4(o,n.end(),n.center,n.rx,n.ry,n.sweep()),c instanceof bt&&c.sweepAngle===0&&(c=new je(c.start(),c.end()))),this.updateNextOffsetPrimitive(r.index,c)}else{let a=this.originalPrimitive[e.index],o=this.originalPrimitive[r.index],l=this.rxChangeStatus(a.sweep()),c=this.rxChangeStatus(o.sweep()),u=this.originalPrimitive[r.index].start(),d=this.getSweep(u,i,e.index),A=Math.abs(this.offsetDistance),h=bt.build2(u,l?a.endAngle():a.endAngle()+180,c?o.startAngle:o.startAngle+180,A,A,d);this.rawOffsetPrimitive.push(i),this.rawOffsetPrimitive.push(h)}}},Sg.originalPrimitive=[],Sg.offsetPrimitive=[],Sg.rawOffsetPrimitive=[],Sg.testI=0,Sg),Cve=class eS extends cS{constructor(e,r,i,n,s,a){if(super(),r<0||i<0)throw new Error("The width and height of rect can't be less than 0!");this.leftUpPoint=e,this.width=r,this.height=i,this.angle=n,this.isCCW=s,this.radius=Math.min(Math.max(a,0),r/2,i/2)}get radiusRatio(){return this.radius/Math.min(this.width,this.height)}start(){return this.leftUpPoint.add(new nt(this.radius,0).multiply3(ko.rotateD(this.angle)))}end(){return this.start()}getLeftPoint(){return this.leftUpPoint.add(new nt(0,-this.height/2).multiply3(ko.rotateD(this.angle)))}getRightPoint(){return this.leftUpPoint.add(new nt(this.width,-this.height/2).multiply3(ko.rotateD(this.angle)))}extend(e){return new eS(this.leftUpPoint.add(new nt(-e,e).rotateD(nt.ORIGIN,this.angle)),this.width+e*2,this.height+e*2,this.angle,this.isCCW,this.radius+e)}bbox(){let e=ko.rotateD(this.angle),{leftUpPoint:r,width:i,height:n,radius:s}=this,a=r.add(new nt(s,-s).multiply3(e)),o=r.add(new nt(s,s-n).multiply3(e)),l=r.add(new nt(i-s,-s).multiply3(e)),c=r.add(new nt(i-s,s-n).multiply3(e));return new hu(Math.min(a.x,o.x,l.x,c.x)-s,Math.max(a.x,o.x,l.x,c.x)+s,Math.min(a.y,o.y,l.y,c.y)-s,Math.max(a.y,o.y,l.y,c.y)+s)}toPolyline(){let e=[],{leftUpPoint:r,width:i,height:n,radius:s}=this;if(s===0){let o=nt.ORIGIN,l=new nt(i,0),c=new nt(i,-n),u=new nt(0,-n);e.push(new je(o,l),new je(l,c),new je(c,u),new je(u,o))}else{let o=new nt(0,-s),l=new nt(s,0),c=new nt(i-s,0),u=new nt(i,-s),d=new nt(i,s-n),A=new nt(i-s,-n),h=new nt(s,-n),f=new nt(0,s-n);e.push(bt.build1(o,l,s,s,!1,0),new je(l,c),bt.build1(c,u,s,s,!1,0),new je(u,d),bt.build1(d,A,s,s,!1,0),new je(A,h),bt.build1(h,f,s,s,!1,0),new je(f,o))}e=e.filter(o=>!o.start().equals1(o.end())),this.isCCW&&(e.forEach((o,l)=>e[l]=o.reverse()),e.reverse());let a=ko.rotateD(this.angle).translate1(r);return dn.build2(e.map(o=>o.multiply3(a)))}center(){return this.leftUpPoint.add1(this.width/2,this.height/2).rotateD(this.leftUpPoint,this.angle)}multiply3(e){let r=this.leftUpPoint.multiply3(e),i=new nt(this.width,0).multiply3(ko.rotateD(this.angle)).multiply3(e),n=new nt(0,-this.height).multiply3(ko.rotateD(this.angle)).multiply3(e);return e.isMirrored()?new eS(r,n.length(),i.length(),n.angleD(nt.ORIGIN),this.isCCW===1?0:1,this.radius*i.length()/this.width):new eS(r,i.length(),n.length(),i.angleD(nt.ORIGIN),this.isCCW,this.radius*i.length()/this.width)}reverse(){return new eS(this.leftUpPoint,this.width,this.height,this.angle,this.isCCW===1?0:1,this.radius)}stroke(e,r,i){let n=this.stroke1(e,r,i);if(n.length===1)return n[0];{let[s,a]=n;return dn.build2(s.primitives.concat(new je(s.primitives[0].start(),a.primitives[0].start()),a.primitives,new je(a.primitives[0].start(),s.primitives[0].start())))}}stroke1(e,r,i){let n=i===this.isCCW?this:this.reverse(),s=e/2,a=Math.min(n.width,n.height)/2,o=n.extend(s).toPolyline();return a<=s?[o]:[o,n.extend(-s).toPolyline().reverse()]}points(e){let r=this.toPolyline(),i=[];return r.points(e,n=>i.push(n)),i}toBezier(){throw new Error("Method not implemented.")}},Sve=.01,$o=class Xf{static simplify(e){return e=Z0(e),e?new Xf([e]):null}static buildByStroke(e,r,i=1,n=x6,s){if(e instanceof bt&&(e.rx<r/2+Sve||Math.abs(e.sweepAngle)>180&&Ct.lesseq(e.start().distance1(e.end()),r))){let o=qX(e.stroke(r,i,0),s);if(o.length===0)return null;if(o.length===1)return new Xf(o);let l=[null],c=Number.POSITIVE_INFINITY;return o.forEach(u=>{let d=u.area(.1);d<0?d<c&&(l[0]=u,c=d):l.push(u)}),new Xf(l)}else if(e instanceof Cve){let o=e.stroke1(r,i,0).map(l=>Z0(l));return o[0]?o[1]?new Xf(o):new Xf([o[0]]):null}let a=e.stroke(r,i,0,n);return a?this.simplify(a):null}static buildCircle(e,r){return this.simplify(dn.build7([bt.buildCircle(e,r,0)]))}static buildRect(e){return this.simplify(e.toPolyline())}static buildBBox(e){return this.simplify(dn.buildBBox(e,0))}constructor(e){this.items=e.slice()}multiply3(e){return new Xf(this.items.map(r=>r.multiply3(e)))}bbox(){return this.items[0].bbox()}isEqual(e){return e instanceof Xf?this.items.every(r=>e.items.some(i=>i.isEqual(r))):!1}getOutMostPolyline(){return this.items[0]}extend(e,r){if(this.items.length!==1)throw new Error("this.items.length !== 1");if(e===0)return new lo([this]);let i=this.items[0],n=[];for(let u of i.primitives)if(u instanceof je)n.push(u);else if(u instanceof bt&&u.rx===u.ry)a(u);else if(u instanceof vr)s(u);else throw new Error("not support!");i=dn.build7(n);function s(u){let d=u.points(.1);for(let A=0;A<d.length-1;A++){let h=d[A],f=d[A+1];n.push(new je(h,f))}}function a(u){if(Math.abs(u.sweepAngle)>270){let d=u.sweepAngle/2;a(bt.build3(u.center,u.startAngle,d,u.rx,u.ry)),a(bt.build3(u.center,u.startAngle+d,d,u.rx,u.ry))}else n.push(u)}let o=[],l=[];vve.getExtendPolyLine(i,e,!0,r).forEach(u=>{(u.area(.1)>0?l:o).push(u)});let c;if(o.length===1)l.forEach(u=>o.push(u)),c=new lo([new Xf(o)]);else if(o.length===0)console.warn("outlines.length === 0"),c=new lo([]);else if(l.length===0)c=new lo(o.map(u=>new Xf([u])));else{let u=o.map(d=>[d]);l.forEach(d=>{let A=[],h=d.bbox();if(u.forEach(f=>{f[0].bbox().isContainsBBox1(h)&&A.push(f)}),A.length===1)A[0].push(d);else{if(A.length===0)throw new Error("inPlsArr.length === 0");for(let f of A.sort((p,m)=>p[0].bbox().area()-m[0].bbox().area()))if(f[0].getWindingNum(d.start())===-1){f.push(d);break}}}),c=new lo(u.map(d=>new Xf(d)))}return c}toPolylineGroup(){return new E6(this.items)}};var Tve=(t=>(t[t.POLYGON=1]="POLYGON",t[t.POLYLINE=2]="POLYLINE",t[t.LINE=3]="LINE",t[t.ARC=4]="ARC",t[t.BEZIER2=5]="BEZIER2",t[t.BEZIER3=6]="BEZIER3",t[t.BOOLEAN_OUTPUT=7]="BOOLEAN_OUTPUT",t[t.BOOLEAN_INTERSECTION=8]="BOOLEAN_INTERSECTION",t[t.BOOLEAN_UNION=9]="BOOLEAN_UNION",t[t.BOOLEAN_DIFF=10]="BOOLEAN_DIFF",t[t.BOOLEAN_RESULT=11]="BOOLEAN_RESULT",t[t.LINES=12]="LINES",t[t.ARCS=13]="ARCS",t[t.BEZIER2S=14]="BEZIER2S",t[t.BEZIER3S=15]="BEZIER3S",t[t.CIRCLE_CW=16]="CIRCLE_CW",t[t.CIRCLE_CCW=17]="CIRCLE_CCW",t[t.POLYGON_GROUP=18]="POLYGON_GROUP",t))(Tve||{});var t6=class{static repeat(t,e){let r=new Array(e);for(;e-- >0;)r[e]=t;return r.join("")}static lpad(t,e,r){let i=r-t.length;return i>0?this.repeat(e,i)+t:t}},Ive=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.PERCENT=1]="PERCENT",t[t.LEFT_PAD0=2]="LEFT_PAD0",t))(Ive||{}),Bve=/(\.?0+)$/,A6=class{static format(t,...e){return this.format1(t,e)}static format1(t,e){let r=this._format(t,e);if(typeof r=="string")return r;throw new Error(this.format("Invalid state on (%d) %s",r,t))}static _format(t,e){let r=[],i=0,n=0,s,a=0,o=0;for(let l=0;l<t.length;l++){let c=t.charAt(l),u=c.charCodeAt(0);switch(i){case 0:u===37?i=1:r.push(c);break;case 1:switch(u){case 100:if(s=e[n++],typeof s=="number")r.push(s.toFixed(0)),i=0;else return l;break;case 102:if(s=e[n++],typeof s=="number")r.push(s.toString()),i=0;else return l;break;case 120:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16)),i=0;else return l;break;case 88:if(s=e[n++],typeof s=="number")r.push((s|0).toString(16).toUpperCase()),i=0;else return l;break;case 115:case 99:s=e[n++],r.push(s===null?"null":s.toString()),i=0;break;case 48:a=l+1,o=-1,i=2;break;case 37:r.push("%"),i=0;break;default:return l}break;case 2:switch(u){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=l;break;case 100:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(t6.lpad((s|0).toString(10),"0",d)),i=0;else return l}else return l;break;case 120:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(t6.lpad((s|0).toString(16),"0",d)),i=0;else return l}else return l;break;case 88:if(o>=a){let d=parseInt(t.substring(a,o+1));if(s=e[n++],typeof s=="number")r.push(t6.lpad((s|0).toString(16).toUpperCase(),"0",d)),i=0;else return l}else return l;break;default:return l}break;default:return l}}return r.join("")}static startsWith(t,e){return t.length>=e.length?t.substring(0,e.length)===e:!1}static endsWith(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}static fmtNumber(t){return t.toFixed(5).replace(Bve,"")}},Dve=(t=>(t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARNING=2]="WARNING",t[t.ERROR=3]="ERROR",t[t.DUMMY=4]="DUMMY",t))(Dve||{});function _ve(t){switch(t){case 0:return"DEBUG";case 1:return"INFO";case 2:return"WARNING";case 3:return"ERROR";case 4:return"DUMMY"}}var Pve=(t,e)=>{t===3?console.error(...e):t===2?console.warn(...e):console.log(...e)},Lve=(t,e)=>[_ve(t)].concat(e),Tg,X9e=(Tg=class{static mix(...e){return new Tg(0,(r,i)=>{for(let n of e)n.write(r,i)},(r,i)=>i)}constructor(e,r=Pve,i=Lve){this.level=e,this.writer=r,this.fmt=i}setLevel(e){this.level=e}prepend(e=null,r=null){let i=e===null?this.fmt:(s,a)=>(a=e(s,a),this.fmt(s,a)),n=r===null?this.writer:(s,a)=>{r(s,a),this.writer(s,a)};return new Tg(this.level,n,i)}chain(e){return e.prepend(this.fmt.bind(this),this.writer.bind(this))}include(e){return this.level<=e}formatWrite(e,r,i){this.include(e)&&this.writer(e,this.fmt(e,[A6.format(r,...i)]))}write(e,r){this.include(e)&&this.writer(e,this.fmt(e,r))}write3(e,r,i){this.include(e)&&this.writer(e,this.fmt(e,[A6.format(r,...i)]))}debug3(e,...r){this.write3(0,e,r)}warning3(e,...r){this.write3(2,e,r)}debugFmt(e,...r){this.formatWrite(0,e,r)}debug(...e){this.write(0,e)}infoFmt(e,...r){this.formatWrite(1,e,r)}info(...e){this.write(1,e)}warningFmt(e,...r){this.formatWrite(2,e,r)}warning(...e){this.write(2,e)}errorFmt(e,...r){this.formatWrite(3,e,r)}error(...e){this.write(3,e)}},Tg.DUMMY=new Tg(4),Tg);var q9e=String.fromCharCode;var Ove=(t=>(t[t.UNKNOW=0]="UNKNOW",t[t.NUMBER_INTEGER=1]="NUMBER_INTEGER",t[t.NUMBER_DECIMAL=2]="NUMBER_DECIMAL",t[t.NUMBER_E=3]="NUMBER_E",t[t.NUMBER_E_SIGNED=4]="NUMBER_E_SIGNED",t))(Ove||{}),Nve=(t=>(t[t.UNKNOW=0]="UNKNOW",t[t.MOVE_X=1]="MOVE_X",t[t.MOVE_Y=2]="MOVE_Y",t[t.LINE_X=3]="LINE_X",t[t.LINE_Y=4]="LINE_Y",t[t.HORIZONTAL_X=5]="HORIZONTAL_X",t[t.VERTICAL_Y=6]="VERTICAL_Y",t[t.CUBIC_BEZIER_X1=7]="CUBIC_BEZIER_X1",t[t.CUBIC_BEZIER_Y1=8]="CUBIC_BEZIER_Y1",t[t.CUBIC_BEZIER_X2=9]="CUBIC_BEZIER_X2",t[t.CUBIC_BEZIER_Y2=10]="CUBIC_BEZIER_Y2",t[t.CUBIC_BEZIER_X=11]="CUBIC_BEZIER_X",t[t.CUBIC_BEZIER_Y=12]="CUBIC_BEZIER_Y",t[t.ARC_RX=13]="ARC_RX",t[t.ARC_RY=14]="ARC_RY",t[t.ARC_ROTATION=15]="ARC_ROTATION",t[t.ARC_LARGE=16]="ARC_LARGE",t[t.ARC_SWEEP=17]="ARC_SWEEP",t[t.ARC_X=18]="ARC_X",t[t.ARC_Y=19]="ARC_Y",t[t.SMOOTH_CUBIC_BEZIER_X2=20]="SMOOTH_CUBIC_BEZIER_X2",t[t.SMOOTH_CUBIC_BEZIER_Y2=21]="SMOOTH_CUBIC_BEZIER_Y2",t[t.SMOOTH_CUBIC_BEZIER_X=22]="SMOOTH_CUBIC_BEZIER_X",t[t.SMOOTH_CUBIC_BEZIER_Y=23]="SMOOTH_CUBIC_BEZIER_Y",t[t.QUADRATIC_BEZIER_X1=24]="QUADRATIC_BEZIER_X1",t[t.QUADRATIC_BEZIER_Y1=25]="QUADRATIC_BEZIER_Y1",t[t.QUADRATIC_BEZIER_X=26]="QUADRATIC_BEZIER_X",t[t.QUADRATIC_BEZIER_Y=27]="QUADRATIC_BEZIER_Y",t))(Nve||{});var Rve=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.ENC_LINE=1]="ENC_LINE",t[t.ENC_ARC=2]="ENC_ARC",t[t.ENC_CUBIC_BEZIER=3]="ENC_CUBIC_BEZIER",t[t.ENC_QUADRATIC_BEZIER=4]="ENC_QUADRATIC_BEZIER",t))(Rve||{}),W9e=A6.fmtNumber;var Mve=class{constructor(){}encodeCanvas(t){return{id:"CANVAS",dataType:"CANVAS",data:JSON.stringify(t)}}encodeGroup(t,e){return{id:t,dataType:"GROUP",data:JSON.stringify(e)}}encodeAuxLine(t,e){return{id:t,dataType:"AUXLINE",data:JSON.stringify(e)}}encodeDimension(t,e){return{id:t,dataType:"DIMENSION",data:JSON.stringify(e)}}encodeString(t,e){return{id:t,dataType:"STRING",data:JSON.stringify(e)}}encodePoly(t,e){return{id:t,dataType:"POLY",data:JSON.stringify(e)}}};var kve=(t=>(t.UNIVERSAL="UNIVERSAL",t))(kve||{}),Fve=(t=>(t.SINGLE="SINGLE",t.MULTIPLE="MULTIPLE",t))(Fve||{}),Uve=(t=>(t.NONE="NONE",t.NAME="NAME",t.NUMBER="NUMBER",t))(Uve||{}),Hve=(t=>(t.NONE="NONE",t.ZONE="ZONE",t))(Hve||{});var Gve=X2(lS());function z2(){return self.EDITOR_TOP||self}function J_(t){return self[t]=self[t]||new Gve.BroadcastChannelMessageBus(t)}var Q1=(t,e)=>{let r=/{([^}]*)}/gim,i=[...new Set(t.match(r))];for(let n=0;n<i.length;n++){let s=i[n],a=s.substring(1,s.length-1);e[a]&&(t=t.replace(s,e[a]))}return t};var aa={getTime:"/pro-mgr/serverTime/now",getUserL:"/pro-ui/loginUser/get",subMaxTick:"/pro-mgr/project/ticket",subBlob:"/pro-mgr/canvas/BLOB/update",subFont:"/pro-mgr/canvas/FONT/update",subRevoke:"/pro-mgr/{uuid}/revoke",pushPend:"/pro-mgr/worker/batchPendData",pushSync:"/pro-mgr/dataWorker/sync",pushRevoke:"/pro-mgr/worker/revoke",pullASync:"/pro-mgr/dataWorker/sync/{id}",personDestroy:"/mgr/libWorker/destroy",projectUpdate:"/pro-mgr/canvas/{uuid}/update",personUpdate:"/mgr/libWorker/component/{uuid}/update",personSave:"/mgr/libWorker/save",projectSave:"/mgr/projectWorker/setCanvas",canSavePend:"/mgr/projectWorker/canSavePend",hasSaveData:"/mgr/check/hasSaveData"},K9e={projectUpdate:aa.projectUpdate,personUpdate:aa.personUpdate,projectCanSave:aa.canSavePend,getProject:"/mgr/projectWorker/footprint/getCanvas",getPerson:"/mgr/libWorker/getFootprint",unwatch:"/mgr/projectWorker/footprint/unwatchCanvas"},J9e={projectUpdate:aa.projectUpdate,projectCanSave:aa.canSavePend,getProject:"/mgr/projectWorker/pcb/getCanvas",unwatch:"/mgr/projectWorker/pcb/unwatchCanvas"},$9e={projectUpdate:aa.projectUpdate,projectCanSave:aa.canSavePend,getProject:"/mgr/projectWorker/sheet/getCanvas",unwatch:"/mgr/projectWorker/sheet/unwatchCanvas"},Z9e={projectUpdate:aa.projectUpdate,getProject:"/mgr/projectWorker/schematic/getCanvas",unwatch:"/mgr/projectWorker/schematic/unwatchCanvas"},eHe={projectUpdate:aa.projectUpdate,projectCanSave:aa.canSavePend,getProject:"/mgr/projectWorker/simulation/getCanvas",unwatch:"/mgr/projectWorker/simulation/unwatchCanvas"},tHe={projectUpdate:aa.projectUpdate,personUpdate:aa.personUpdate,projectCanSave:aa.canSavePend,getProject:"/mgr/projectWorker/symbol/getCanvasOnCompiler",getPerson:"/mgr/libWorker/getSymbol",unwatch:"/mgr/projectWorker/symbol/unwatchCanvas"},Yve={projectUpdate:aa.projectUpdate,personUpdate:aa.personUpdate,projectCanSave:aa.canSavePend,getProject:"/mgr/projectWorker/panel/getCanvas",getPerson:"/mgr/libWorker/getPanelLib",unwatch:"/mgr/projectWorker/panel/unwatchCanvas"};var ad={send:"/pro-mgr/notify/send",sendMsg:"/document/sendMsg/cooperation",unwatch:"/document/unwatch/cooperation",watch:"/document/watch/cooperation",message:"/pro-mgr/notify/message/{path}/{uuid}/cooperation",established:"/pro-mgr/notify/message/ws/established",getWsId:"/pro-mgr/notify/getWsId",disconnect:"/pro-mgr/notify/message/ws/disconnect"},q2=class{constructor(t=!0){this._lockerTicket=0,this.isPull=!1,this.compiler={},this.order={SYMBOL:1,FOOTPRINT:2,DEVICE:3,SCH_PAGE:4,PCB:5},this._locker=t?++this._lockerTicket:0}getOrder(t){return this.order[t]||6}publish(){if(!this.isPull){this.isPull=!0,this._temporaryUnlock=this._locker;try{let t=Object.keys(this.compiler).sort((r,i)=>this.getOrder(r)-this.getOrder(i)),e=!1;for(let r of t){for(let[,i]of this.compiler[r])if(e=i.publish(),e)break;if(e)break}}finally{this._temporaryUnlock=0,this.isPull=!1}}}canPush(){return!this._locker||this._locker===this._temporaryUnlock}addCompiler(t){this.compiler[t.headType]||(this.compiler[t.headType]=new Map),this.compiler[t.headType].set(t.uniqueId,t)}removeCompiler(t){var e,r,i;(i=(r=(e=this.compiler)==null?void 0:e[t.headType])==null?void 0:r.delete)==null||i.call(r,t.uniqueId)}pull(){if(!this._locker)throw Error("\u4E0D\u5141\u8BB8\u5728\u975E pause \u72B6\u6001\u4E0B\u62C9\u53D6\u6570\u636E");this.publish()}resume(){this._locker=0,this.publish()}pause(){this._locker=++this._lockerTicket}dispose(){for(let t in this.compiler)this.compiler[t].clear();this.compiler=null}},X0={publish:"publish",destroy:"destroy",init:"init",selected:"selected"},Vve=class{constructor(t,e,r,i=(a=>(a=z2())==null?void 0:a._TAB_ID_)(),n,s){var o;this.uuid=t,this.path=e,this.user=r,this.windowId=i,this.initIds={},this.sub=[],this.wsBus=s||J_(`/${this.windowId}/notify`),this.dataBus=n||this.wsBus,this._client=(o=z2())==null?void 0:o._WS_ID_}get client(){return this._client}watch(){this.dataBus.publish(ad.send,{topic:ad.watch,uuid:this.uuid,path:this.path})}initPublish(){var t;this.dataBus.publish(ad.send,{topic:ad.sendMsg,uuid:this.uuid,path:this.path,msg:{type:X0.publish,user:this.user,client:this.client,data:((t=this.getSelect)==null?void 0:t.call(this))||""}})}async init(){if(!this.isInit){if(this.sub.push(this.wsBus.subscribe(ad.established,t=>{this._client=t,this.watch(),this.initPublish()})),!this.client){let t=await this.wsBus.rpcCall(ad.getWsId);if(!t||this.client)return;this._client=t}this.watch(),this.sub.push(this.wsBus.subscribe(ad.disconnect,t=>{this.initIds[t]&&this.onDestroy(this.initIds[t],t)})),this.sub.push(this.dataBus.subscribe(Q1(ad.message,{uuid:this.uuid,path:this.path}),t=>{if(t.type===1)t.connectId&&this.initIds[t.connectId]&&this.onDestroy(this.initIds[t.connectId],t.connectId);else if(t.msg){let e=t.msg;if(e.client===this.client)return;switch(e.type){case X0.destroy:this.onDestroy(e.userId,e.client),delete this.initIds[e.client];break;case X0.init:this.initIds[e.client]||(this.initIds[e.client]=e.user.uuid,this.onSelected(e.user,e.client,e.data||""));break;case X0.selected:this.onSelected(e.user,e.client,e.data||"");break;case X0.publish:this.dataBus.publish(ad.send,{topic:ad.sendMsg,uuid:this.uuid,path:this.path,msg:{type:X0.init,user:this.user,client:this.client,data:this.getSelect()||""}}),this.initIds[e.client]=e.user.uuid,this.onSelected(e.user,e.client,e.data||"");break;default:break}}})),this.initPublish(),this.isInit=!0}}publishSelected(t,e){this.dataBus.publish(ad.send,{topic:ad.sendMsg,uuid:this.uuid,path:this.path,msg:{type:X0.selected,user:this.user,client:this.client,data:t}}),e&&this.onSelected(this.user,this.client,t)}destroy(){if(this.isInit){this.isInit=!1,this.dataBus.publish(ad.send,{topic:ad.unwatch,uuid:this.uuid,path:this.path,msg:{type:X0.destroy,userId:this.user.uuid,client:this.client}});for(let t of this.sub)t.cancel();this.sub=[],this.initIds={}}}},fX=class extends Vve{constructor(t,e,r,i,n,s,a,o){super(t,e,o,r,n,s),this.channel=i,this.selectedProps=a,this.cache=new Map,this.deleteCache=new Map}rePublish(){var t,e,r,i;if(this.channel.canPush()){for(let[n,s]of this.cache)(e=(t=this.selectedProps)==null?void 0:t.onSelect)==null||e.call(t,s.user,n,s.data);for(let[n,s]of this.deleteCache)(i=(r=this.selectedProps)==null?void 0:r.onQuit)==null||i.call(r,s,n)}}getSelect(){var t,e;return((e=(t=this.selectedProps)==null?void 0:t.getSelect)==null?void 0:e.call(t))||""}onSelected(t,e,r){var i,n;this.channel.canPush()?!this.deleteCache.has(e)&&this.cache.set(e,{user:t,data:r}):(n=(i=this.selectedProps)==null?void 0:i.onSelect)==null||n.call(i,t,e,r)}onDestroy(t,e){var r,i;this.channel.canPush()?(this.deleteCache.set(e,t),this.cache.delete(e)):(i=(r=this.selectedProps)==null?void 0:r.onQuit)==null||i.call(r,t,e)}dispose(){this.destroy(),this.cache.clear(),this.deleteCache.clear()}publishSelected(t,e){super.publishSelected(t,e)}},jve=X2(lS()),Qve=class{constructor(t,e,r,i=(y=>(y=z2())==null?void 0:y._TAB_ID_)(),n=new q2,s=null,a,o,l,c,u,d,A,h,f,p,m){this.uuid=t,this.path=e,this.isProject=r,this.windowId=i,this.channel=n,this.consistencyManager=s,this.selectedProps=l,this.setInit=c,this.onDocDetail=u,this.onUpdate=d,this.handleInit=A,this.onDelete=h,this.publishCache=f,this.onOrderNm=p,this.setMaxNum=m,this.isInit=!1,this.canSave=!0,this.sub=[],this.isInitIng=!1,this.cache={},this.deleteCache=new Map,this.pendTimer=null,this.pendCache={},this.pendCacheLength=0,this.wsBus=J_(`/${i}/notify`),s||(this._unique=Wd()),this._headType=a,this.busTopic=o}get uniqueId(){return this._unique||this.consistencyManager.getUnique()}get headType(){return this._headType}setIsInitIng(t){var e;(e=this.setInit)==null||e.call(this,t),this.isInitIng=t}consoleDebug(...t){console.debug("[lc-protocol]",this._headType,this.uuid,...t)}publishLine(t,e,r,i,n,s=this.uuid,a,o,l,c,u){if(this.channel.canPush())return this.consistencyManager.remoteChange(e,n,s,t,r,i,void 0,void 0,void 0,a,void 0,o,l,u),!1;this.cache[s]||(this.cache[s]=new Map);let d=this.cache[s].get(t);return(c||!d||d.ticket<e||d.ticket===e&&(d.client<n||d.client===n&&!!d.pend!=!!a))&&this.cache[s].set(t,{client:n,ticket:e,dataType:i,data:r,pend:a,unique:o,pChange:d?void 0:l,num:u}),!0}onDocHead(){}onEnd(){}setDocType(t,e){t===this.uuid&&(this._headType=e)}setBusTopic(t){this.busTopic=t}publish(){var e,r,i;if(this.publishCache)return this.publishCache();let t=!1;for(let[n,s]of this.deleteCache){if(this.channel.canPush()){(e=this.onDelete)==null||e.call(this,s),delete this.cache[n];continue}t=!0;break}if(t)return t;for(let n in this.cache){let s=this.cache[n].keys();for(let a of s){let o=this.cache[n].get(a);if(t=this.publishLine(a,o.ticket,o.data,o.dataType,o.client,n,o.pend,o.unique,o.pChange,!1,o.num),t)break;this.cache[n].delete(a)}if(t)break}return(i=(r=this.selectManager)==null?void 0:r.rePublish)==null||i.call(r),t}publishSelected(t,e){this.selectManager.publishSelected(t,e)}clear(){var t,e;for(let r of this.sub)r.cancel();this.sub.length=0,this.cache={},this.deleteCache.clear(),this.setIsInitIng(!1),this.channel.removeCompiler(this),(e=(t=this.selectManager)==null?void 0:t.dispose)==null||e.call(t),this.selectManager=null,this.isInit=!1,this.setIsInitIng(!1)}async init(t=!0,e=!0,r=!0,i,n,s,a){try{if(this.isInit)return{success:!0};if(this.isInitIng)throw new Error("\u6B63\u5728\u521D\u59CB\u5316\u4E2D");return this.isProject?await this.initProject(t,e,r,i,s,a):await this.initLib(r,i,n,s,a)}catch(o){throw this.clear(),new Error(`${this._headType}+'Compiler' ${this.uuid} init false: ${(o==null?void 0:o.message)||o||""}`,{cause:o})}finally{this.isInitIng=!1}}async flowRead(t){let e=this.consistencyManager.flowParseFull(),r=e.update,i=this;e.update=n=>{if(i.isDestroy)return!0;r(n)},await(0,jve.flowRead)(t,e)}pushOnLine(t,e){if(this.consistencyManager)for(let r of t)this.publishLine(r[0],r[1],r[2],r[3],r[4],e,r[5],r[6],r[7],!1,r[8])}async initProject(t,e,r,i,n,s){if(this.setIsInitIng(!0),this.channel.addCompiler(this),this.dataBus=J_(`/${this.windowId}/project/${this.path}`),n&&this.sub.push(this.dataBus.subscribe(`/pro-mgr/${this.uuid}/number/update`,l=>{if(this.onOrderNm)for(let c of l)this.onOrderNm(c[0],c[1],c[2])})),r&&this.busTopic.projectUpdate&&this.sub.push(this.dataBus.subscribe(Q1(this.busTopic.projectUpdate,{uuid:this.uuid}),l=>{this.onUpdate?this.onUpdate(l):this.pushOnLine(l,this.uuid)})),r&&this.busTopic.projectCanSave&&this.sub.push(this.dataBus.subscribe(this.busTopic.projectCanSave,l=>{this.canSave=l})),r&&this.busTopic.subDelete&&this.sub.push(this.dataBus.subscribe(this.busTopic.subDelete,l=>{var c;this.channel.canPush()?(c=this.onDelete)==null||c.call(this,l):this.deleteCache.set(l[0],l)})),r&&this.consistencyManager&&this.sub.push(this.dataBus.subscribe(aa.subMaxTick,l=>{this.consistencyManager.setMaxTicket(l.ticket,l.force)})),r&&e&&this.sub.push(this.dataBus.subscribe(aa.subBlob,l=>{this.pushOnLine(l,"BLOB")})),r&&t&&this.sub.push(this.dataBus.subscribe(aa.subFont,l=>{this.pushOnLine(l,"FONT")})),r&&this.consistencyManager&&this.sub.push(this.dataBus.subscribe(Q1(aa.subRevoke,{uuid:this.uuid}),l=>this.revoke(l))),!this.busTopic.getProject)throw new Error("\u83B7\u53D6\u6570\u636E\u5931\u8D25\uFF01\uFF01\uFF01");this.isDestroy=!1;let a={doc:[this.uuid],watch:r,needNum:n,needDelete:s};e&&a.doc.push("BLOB"),t&&a.doc.push("FONT");let o=await this.dataBus.rpcCall(this.busTopic.getProject,a);if(this.isWatch=r,!this.isDestroy){if(!o.success)throw new Error("\u83B7\u53D6\u6570\u636E\u5931\u8D25\uFF01\uFF01\uFF01",o);if(this.canSave=!(o!=null&&o.readOnly),this.consoleDebug("init",o.result),o.maxTicket&&this.consistencyManager&&this.consistencyManager.setMaxTicket(o.maxTicket),o.data&&this.onDocDetail&&this.onDocDetail(o.client||Wd(),0,o.data,!1),o.channel&&await this.flowRead(o.channel),!this.isDestroy){if(this.handleInit?this.handleInit(o):o.result&&this.consistencyManager&&this.consistencyManager.parseFull(o.result,this.uuid,this._headType),i){let l=this.user=this.user||o.user||await this.wsBus.rpcCall(aa.getUserL);this.selectManager=new fX(this.uuid,this.path,this.windowId,this.channel,this.dataBus,this.wsBus,this.selectedProps,l),await this.selectManager.init()}return this.isInit=!0,this.setIsInitIng(!1),{success:!0}}}}async initLib(t,e,r,i,n){if(this.setIsInitIng(!0),this.channel.addCompiler(this),this.dataBus=J_(`/${this.windowId}/libWorker`),!this.busTopic.getPerson)throw new Error("\u83B7\u53D6\u6570\u636E\u5931\u8D25\uFF01\uFF01\uFF01");let s=r?Wd():"";this.isDestroy=!1;let a=await this.dataBus.rpcCall(this.busTopic.getPerson,{uuid:this.uuid,path:this.path,watch:t,channel:s,needNum:i,needDelete:n});if(this.isWatch=t,this.isDestroy)return;if(!a.success)throw new Error("\u83B7\u53D6\u6570\u636E\u5931\u8D25\uFF01\uFF01\uFF01",a);this.consoleDebug("init",a.dataStr);let o=a.data||a.result;if(o&&this.onDocDetail&&this.onDocDetail(a.client||Wd(),0,o,!1),i&&this.sub.push(this.dataBus.subscribe(`/pro-mgr/${this.uuid}/number/update`,l=>{if(this.onOrderNm)for(let c of l)this.onOrderNm(c[0],c[1],c[2])})),t&&this.busTopic.personUpdate&&this.sub.push(this.dataBus.subscribe(Q1(this.busTopic.personUpdate,{uuid:this.uuid}),l=>{this.pushOnLine(l,this.uuid)})),t&&this.sub.push(this.dataBus.subscribe(Q1(Q1(aa.subRevoke,{uuid:this.uuid}),{uuid:this.uuid}),l=>this.revoke(l))),s&&await this.flowRead(s),!this.isDestroy){if(a.dataStr&&this.consistencyManager&&this.consistencyManager.parseFull(a.dataStr),e){let l=this.user=this.user||a.user||await this.wsBus.rpcCall(aa.getUserL);this.selectManager=new fX(this.uuid,this.path,this.windowId,this.channel,this.wsBus,this.wsBus,this.selectedProps,l),await this.selectManager.init()}return this.isInit=!0,this.setIsInitIng(!1),{success:!0}}}revoke(t){for(let e of t)this.consistencyManager&&this.consistencyManager.revoke(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],(...r)=>this.publishLine(...r)),e[10]&&this.setMaxNum&&this.setMaxNum(e[6],e[10],e[1])}cachePendData(t,e,r,i,n,s){this.pendCache[t]||(this.pendCache[t]={type:s,pend:[]}),this.pendCache[t].pend.push([e,r,n,i]),this.pendCacheLength+=i.length+1,this.pendCacheLength>1e7&&this.publishPendData(),this.pendTimer||(this.pendTimer=setTimeout(()=>{this.publishPendData(),this.pendTimer=null},0))}publishPendData(){if(this.pendCacheLength){this.dataBus.publish(aa.pushPend,[this.pendCache,this.consistencyManager.getClient(),this.uniqueId,this.uuid]);for(let t in this.pendCache)this.pendCache[t].pend.length=0;this.pendCache={},this.pendCacheLength=0}}localChange(t,e,r,i=this.uuid,n,s){if(!this.isInit||!this.canSave||!this.consistencyManager)return 0;if(e&&!e.startsWith("{"))return console.error("\u4E0A\u4F20\u7684\u683C\u5F0F\u4E0D\u6B63\u786E",t,r,e),0;let a=this.consistencyManager.localChange(i,t,e,r,n,s);return this.cachePendData(i,t,a,e,r,n||this.headType),a}async sync(){if(!this.isInit)throw new Error("\u6570\u636E\u672A\u521D\u59CB\u5316\uFF0C\u65E0\u6CD5\u540C\u6B65");let t=Wd();this.dataBus.publish(aa.pushSync,t),await this.dataBus.pullA(Q1(aa.pullASync,{id:t}))}async destroy(){return this.isDestroy?{success:!1}:(this.consistencyManager&&this.dataBus&&this.dataBus.publish(aa.pushRevoke,[this.uuid,this.uniqueId,this.consistencyManager.getClient()]),this.clear(),this.isDestroy=!0,this.isWatch&&this.dataBus&&!this.isProject&&this.dataBus.publish(aa.personDestroy,{uuid:this.uuid,path:this.path}),this.isWatch&&this.dataBus&&this.busTopic.unwatch&&this.dataBus.publish(this.busTopic.unwatch,this.uuid),this.isWatch=!1,{success:!0})}async save(t=[this.uuid,"BLOB","FONT"]){try{if(!this.isInit)throw new Error("\u6570\u636E\u672A\u521D\u59CB\u5316\uFF0C\u65E0\u6CD5\u4FDD\u5B58");if(!this.consistencyManager)throw new Error("\u65E0\u6CD5\u652F\u6301\u4FDD\u5B58");let e=this.isProject?aa.projectSave:aa.personSave;if(!e)throw new Error("\u65E0\u6CD5\u652F\u6301\u4FDD\u5B58");let r=await this.dataBus.rpcCall(e,{uuid:this.uuid,path:this.path,docIds:t,uniqueId:this.uniqueId,client:this.consistencyManager.getClient()});return this.consoleDebug("save",r),r}catch(e){throw new Error(`${this._headType}+'Compiler' ${this.uuid} \u4FDD\u5B58\u5931\u8D25: ${(e==null?void 0:e.message)||e||""}`,{cause:e})}}async getBlob(t){return this.dataBus.rpcCall("/mgr/projectWorker/blob/getBlob",t)}async getFont(t,e,r,i,n,s,a,o){let l={text:t,fontFamily:e,fontSize:r,thickness:i,bold:n,italic:s,reverse:a,expansion:o},c=await this.dataBus.rpcCall("/mgr/projectWorker/font/get",l);return c.success?{success:!0,result:Object.assign(l,JSON.parse(c.result))}:c}async checkSave(){return await this.dataBus.rpcCall(aa.hasSaveData,{uuid:this.uuid,uniqueId:this.uniqueId})}};var zve=(t=>(t.DIFFERENTIAL_PAIR="DIFFERENTIAL_PAIR",t.NET_CLASS="NET_CLASS",t.EQL_NET_GRP="EQL_NET_GRP",t))(zve||{});var Xve=class extends pEe{constructor(t){let e=t||new g6;super(e,1,bX),this.cacheNum=null}onParseLine(t,e,r,i,n,s,a){switch(this.setOrderNum(t,a,e),this.cacheNum=a,e){case"MAX_NUM":if(r)for(let o in r)this.setMaxNum(o,r[o]);break;case"BLOB":r?this.onBlob(t,i,n,r,s):this.onDelBlob(t,i,n,s);case"DOCTYPE":r&&this.parseDocType(r,i,n,s);break;case"META":r&&this.parseDetail(r,i,n,s);break;case"ELE_PLACEHOLDER":break;case"CANVAS":r&&this.parseCanvas(r,i,n,s);break;case"GROUP":r?this.parseGroup(t,r,i,n,s):this.onDelGroup(t,i,n,s);break;case"POLY":r?this.parsePoly(t,r,i,n,s):this.onDelPoly(t,i,n,s);break;case"STRING":r?this.parseString(t,r,i,n,s):this.onDelString(t,i,n,s);break;case"AUXLINE":r?this.parseAuxLine(t,r,i,n,s):this.onDelAuxLine(t,i,n,s);break;case"DIMENSION":r?this.parseDimension(t,r,i,n,s):this.onDelDimension(t,i,n,s);break;default:console.warn("can not find hanlder with",r)}this.cacheNum=null}onOrderNum(t,e,r){switch(this.setOrderNum(t,r,e),e){case"GROUP":this.onPolyNum&&this.onPolyNum(t,r);break;case"POLY":this.onPolyNum&&this.onPolyNum(t,r);break;case"STRING":this.onStringNum&&this.onStringNum(t,r);break;case"AUXLINE":this.onAuxLineNum&&this.onAuxLineNum(t,r);break;case"DIMENSION":this.onDimensionNum&&this.onDimensionNum(t,r);break}}onParseEnd(){}parseDocType(t,e,r,i){let n=t.docType,s=t.version,a=t.meta}parseCanvas(t,e,r,i){this.onCanvas(e,r,t,i)}parseDetail(t,e,r,i){this.onDocDetail(e,r,t,i)}parseGroup(t,e,r,i,n){this.onGroup(t,this.cacheNum,r,i,e,n)}parsePoly(t,e,r,i,n){this.onPoly(t,this.cacheNum,r,i,e,n)}parseString(t,e,r,i,n){this.onString(t,this.cacheNum,r,i,e,n)}parseDimension(t,e,r,i,n){this.onDimension(t,this.cacheNum,r,i,e,n)}parseAuxLine(t,e,r,i,n){this.onAuxLine(t,this.cacheNum,r,i,e,n)}};var qve=class{constructor(t,e,r){this.uuid=t,this.maxTicket=0,this.encodeConsistency=new fEe(r),this.encodeConsistency.setDoctype(t,e),this.encodeConsistency.setDoctype("BLOB","BLOB"),this.encodeConsistency.setDoctype("FONT","FONT")}setFlowWriter(t){this.write=t}localChange(t,e,r,i=this.uuid){let n,s=typeof e=="string"?e:JSON.stringify(e);return this.write?(n=++this.maxTicket,this.write(i,this.encodeConsistency.getDoctype(i),V1(r,n,t,s))):n=this.encodeConsistency.localChange(i,t,s,r),n}getDataStr(t=!0){return this.encodeConsistency.compressFull({notDocHead:!t})}removeDataStr(){this.encodeConsistency.removeCache()}uploadBlob(t,e){let r=EX(e),i={filename:t,content:e};return{success:!0,ticket:this.localChange(r,JSON.stringify(i),"BLOB","BLOB"),hash:r}}deleteBlob(t){return{success:!0,ticket:this.localChange(t,"","BLOB","BLOB")}}},KX=class extends qve{constructor(t,e,r="PANEL"){super(t,r,e),this.uuid=t}uploadCanvas(t){return{success:!0,ticket:this.localChange("CANVAS",t,"CANVAS")}}uploadGroup(t,e){return{success:!0,ticket:this.localChange(t,e,"GROUP")}}deleteGroup(t){return{success:!0,ticket:this.localChange(t,"","GROUP")}}uploadAuxLine(t,e){return{success:!0,ticket:this.localChange(t,e,"AUXLINE")}}deleteAuxLine(t){return{success:!0,ticket:this.localChange(t,"","AUXLINE")}}uploadDimension(t,e){return{success:!0,ticket:this.localChange(t,e,"DIMENSION")}}deleteDimension(t){return{success:!0,ticket:this.localChange(t,"","DIMENSION")}}uploadString(t,e){return{success:!0,ticket:this.localChange(t,e,"STRING")}}deleteString(t){return{success:!0,ticket:this.localChange(t,"","STRING")}}uploadPoly(t,e){return{success:!0,ticket:this.localChange(t,e,"POLY")}}deletePoly(t){return{success:!0,ticket:this.localChange(t,"","POLY")}}};var rHe=X2(lS());var iHe=X2(lS());var hP=class extends Xve{constructor(t,e,r,i,n=(s=>(s=z2())==null?void 0:s._TAB_ID_)()){let a=new g6(Wd());super(a),this.uuid=t,this.path=e,this.isProject=r,this.windowId=n,this.encode=new Mve,this.base=new Qve(t,e,r,n,i,a,r?"PANEL":"PANEL_LIB",Yve,{getSelect:()=>{var o;return(o=this.canvasSelected)==null?void 0:o.call(this)},onSelect:(...o)=>{var l;return(l=this.onSelectChange)==null?void 0:l.call(this,o[0],o[1],o[2])},onQuit:(...o)=>{var l;return(l=this.onSelectQuit)==null?void 0:l.call(this,o[0],o[1])}},(...o)=>this.setIsInit(...o),(...o)=>this.onDocDetail(...o),void 0,void 0,void 0,void 0,(o,l,c)=>this.onOrderNum(o,l,c),(o,l,c)=>{this.setMaxNum(o,l,!0),this.deleteOrderNum(c)})}get dataBus(){return this.base.dataBus}set dataBus(t){this.base.dataBus=t}async init(t=!0,e=!0,r,i=!0,n){return this.setNeedNum(i),this.base.init(!1,t,e,r,!0,i,n)}publishSelected(t,e){this.base.publishSelected(t,e)}async sync(){return this.base.sync()}async destroy(){return this.base.destroy()}async save(){return this.base.save()}checkSave(){return this.base.checkSave()}localChange(t,e=this.uuid,r){var n,s;let i=this.getOrderNum(t.id);return(s=(n=this.needOrderType)==null?void 0:n.includes)!=null&&s.call(n,t.dataType)&&i===void 0&&(i=this.getMaxNum(t.dataType),this.setOrderNum(t.id,i,t.dataType),this.onOrderNum(t.id,t.dataType,i)),this.base.localChange(t.id,t.data,t.dataType,e,r,i)}uploadBlob(t,e){let r=EX(e),i={filename:t,content:e};return{success:!0,ticket:this.localChange({id:r,data:JSON.stringify(i),dataType:"BLOB"},"BLOB","BLOB"),hash:r}}deleteBlob(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"BLOB"},"BLOB","BLOB")}}uploadCanvas(t){return{success:!0,ticket:this.localChange(this.encode.encodeCanvas(t))}}uploadGroup(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeGroup(t,e))}}deleteGroup(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"GROUP"})}}uploadAuxLine(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeAuxLine(t,e))}}deleteAuxLine(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"AUXLINE"})}}uploadDimension(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeDimension(t,e))}}deleteDimension(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"DIMENSION"})}}uploadString(t,e){return{success:!0,ticket:this.localChange(this.encode.encodeString(t,e))}}deleteString(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"STRING"})}}uploadPoly(t,e){return{success:!0,ticket:this.localChange(this.encode.encodePoly(t,e))}}deletePoly(t){return{success:!0,ticket:this.localChange({id:t,data:"",dataType:"POLY"})}}};function ni(){return"e"+Wd()}var eb;function tb(t){if(eb)return $t(eb,String(t))?eb[t]:null;try{return localStorage.getItem(t)}catch{return null}}function JX(t,e){if(eb){eb[t]=String(e);return}try{localStorage.setItem(t,e)}catch{eb={},eb[t]=String(e)}}function kc(t,e){if(!t)return null;e=e===!0;try{let r=new DOMParser().parseFromString(t,"text/xml");return!r||r.querySelector("parsererror")?null:r}catch(r){return console.log("parseXML error",r),null}}function $X(t){let e,r=t;for(;r!=e;)e=r,r=e.replace(/~|\^\^|#@\$|`|#sheet#/gi,"");return r}function Cr(t){if(t){if(t.length)return[].forEach.call(t,Cr);if(t.parentNode)return t.parentNode.removeChild(t)}}function ZX(t){for(let e of t)Cr(Fe(e))}function fS(t,e){if(!t||!e)return t;if(t.removeAttribute)t.removeAttribute(e);else if(t.length)for(let r=0,i=t.length;r<i;r++)t[r]&&t[r].removeAttribute&&t[r].removeAttribute(e)}function dP(t){let[e,r]=t.split("|"),i=0;switch(e){case"start":i=0;break;case"middle":i=1;break;case"end":i=2;break;default:throw new Error("err")}return[i,+r]}function eq(t){let e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}function ty(t,e){function r(u){return u>=10?u:"0"+u}let i=new Date(t),n=i.getFullYear(),s=r(i.getMonth()+1),a=r(i.getDate()),o=r(i.getHours()),l=r(i.getMinutes()),c=r(i.getSeconds());return e==="downProject"?n+"-"+s+"-"+a+"_"+o+"-"+l+"-"+c:e==="y-m-d"?n+"-"+s+"-"+a:n+"-"+s+"-"+a+" "+o+":"+l+":"+c}function ry(t,e){return e=e||X,e.decimalPlacesShow=e.decimalPlacesShow!==void 0?e.decimalPlacesShow:2,Sr(t,e.decimalPlacesShow,e.fixedDecimal)}function rb(t,e){return e=e&&typeof e.decimalPlaces=="number"?e:X,Sr(t,e.decimalPlaces)}function S6(t,e,r){if(!e){console.error("\u4EE3\u7801\u51FA\u9519\uFF0C\u8BF7\u68C0\u67E5");return}t=t||X.gCanvas,typeof r=="string"&&(r=Fe(r)),r?t.insertBefore(e,r):t.appendChild(e)}function T6(t){if(!t)return"";let e=document.querySelectorAll(t),r=[].filter.call(e,function(i){return i.style.display!=="none"});return r&&r[0]||""}function tq(t,e,r){let i=t[e];return i!==void 0||(i=r(e),t[e]=i),i}function rq(t,e){return tq(t,e,()=>[])}function ts(t,e){return tq(t,e,()=>({}))}function I6(){var t=X.globalVariableCookieData.userInfo;return t?t||{}:{}}function iq(t){var e=I6(),r=e.username,i=!!(e&&r);return i}function qu(t,e={}){let r=document.createElement("span");r.classList.add("i18n"),r.innerText=t;let{context:i,attr:n,params:s}=e;return i&&r.setAttribute("data-i18n-context",i),n&&r.setAttribute("data-i18n-attr",n),s&&Vl(s,(a,o)=>{r.setAttribute(`i18n-params-${a}`,o+"")}),r.outerHTML}function B6(t){let e=!0,r=!0,i;return function(...n){if(i=n,!!e){if(r)return r=!1,t.apply(null,i);e=!1,requestAnimationFrame(()=>{e=!0,t.apply(null,i)})}}}function Th(){return 3/X.gZoom}function nq(t,e,r=!1){let i=[];for(let n=0;n<t.length;n++){let s=t[n],a=e(s);zu(a)||(i.push(a),r&&(t.splice(n,1),--n))}return i}function Wu(t){if(window.frameElement)return X.windowBridge.publish("showMessager",[t],ur());X.messageBus.publish("showMessager",[t])}function pS(t,e){let r=document.createElement("a");r.download=e,r.href=URL.createObjectURL(t),r.click(),r=null}function Pi(t){if(!t||!t.tagName||t==X.gCanvas||uu(t,VA)||t.contains(X.gCanvas))return"";let e=ge(t,"c_partid"),r=t.parentNode;return r&&r.id==="gControlDots"?"cdot":["ellipse","rect"].includes(t.tagName)?t.tagName:e==="part_text"?"text":e==="obj"?"obj":e==="group"?"group":e==="dimension"?"dimension":e==="auxiliaryLine"?"auxiliaryLine":e==="auxiliaryPoint"?"auxiliaryPoint":e||""}function sq(t){return t&&(/^(https?:)?\/\/[\w.-]+\/[^\s#?"]+\.(jpg|jpeg|png|gif|svg)$/i.test(t)||/^data:image\/(jpeg|png|gif|svg\+xml);base64,/.test(t)||/^\/assets\/static\/images\//.test(t))}function AP(t,e){return e=e||X,e.decimalPlacesShow=e.decimalPlacesShow!==void 0?e.decimalPlacesShow:2,Sr(t,e.decimalPlacesShow,e.fixedDecimal)}function Fa(t,e){return e=e&&typeof e.decimalPlaces=="number"?e:X,Sr(t,e.decimalPlaces)}var $f={altKeyEnabled:!1,getSanpSize:function(t){return $f.altKeyEnabled?+zt.adsorbGrid.altSnapSize||1:+zt.adsorbGrid["distance"+t]||1}};var Rt=class{static regular(e){return Math.round(e*this.precision)/this.precision}static eq(e,r){return Math.abs(e-r)<=this.eps}static neq(e,r){return Math.abs(e-r)>this.eps}static less(e,r){return e-r<-this.eps}static lesseq(e,r){return e-r<this.eps}static greater(e,r){return e-r>this.eps}static greatereq(e,r){return e-r>-this.eps}static sqrt(e){return Math.abs(e)<=1e-10?0:Math.sqrt(e)}static sortAsc(e,r){return e-r}static sortDesc(e,r){return r-e}};Rt.eps=1e-8,Rt.precision=1e8;function iy(t,e,r,i,n,s,a,o,l){var c=Math.PI*2;function u(P,z,W,oe){var Ae=P*W+z*oe,me=Math.sqrt((P*P+z*z)*(W*W+oe*oe)),ve=Math.acos(Ae/me);return P*oe-z*W<0&&(ve=-ve),ve}function d(P){for(;P>=c;)P-=c;for(;P<0;)P+=c;return P}function A(P){return P.rx=a,P.ry=o,P.startAngle=P.theta1,P.endAngle=d(P.theta1+P.delta_theta),P}var h,f,p,m,y=1e-5;a<0&&(a=-a),o<0&&(o=-o),a==o&&(l=0);var g=Math.sin(l),b=Math.cos(l),E=(t-r)/2,w=(e-i)/2,x=(t+r)/2,I=(e+i)/2;if(a<y||o<y)return p=u(1,0,r-t,i-e),A({cx:x,cy:I,theta1:p,delta_theta:Math.PI});var C=b*E+g*w,G=b*w-g*E,U=C*C/(a*a)+G*G/(o*o);U>1&&(a=a*Math.sqrt(U),o=o*Math.sqrt(U));var _=a*o,H=a*G,Q=o*C,j=H*H+Q*Q;if(!j)return A({cx:x,cy:I,theta1:0,delta_theta:0});var $=(_*_-j)/j;$=Math.sqrt(Math.abs($)),n===s&&($=-$);var B=$*H/o,M=-$*Q/a;h=b*B-g*M+x,f=g*B+b*M+I;var v=(C-B)/a,N=(C+B)/a,R=(G-M)/o,q=(G+M)/o;for(p=u(1,0,v,R),m=u(v,R,-N,-q);m>c;)m-=c;for(;m<0;)m+=c;return s===0&&(m-=c),A({cx:h,cy:f,theta1:p,delta_theta:m})}function fP(t,e,r,i,n,s){var a=r-t,o=n-t,l=i-e,c=s-e,u=t*t,d=r*r,A=n*n,h=e*e,f=i*i,p=s*s,m=(l*(p-h+A-u)-c*(f-h+d-u))/(2*o*l-2*a*c),y=(a*(A-u+p-h)-o*(d-u+f-h))/(2*c*a-2*l*o);if(!isFinite(m)||!isFinite(y))return;var g=Math.sqrt((t-m)*(t-m)+(e-y)*(e-y)),b=[t-n,e-s],E=[r-n,i-s],w=b[0]*E[0]+b[1]*E[1],x=w<0?0:1;function I(H,Q,j){var $=Math.acos(Sr(H/j,3));return Q>=0?$:Math.PI*2-$}var C=I(t-m,e-y,g),G=I(r-m,i-y,g),U=I(n-m,s-y,g),_=0;return U>C?(G>U||G<C)&&(_=1):G>U&&G<C&&(_=1),{angle:0,largeArcFlag:x,sweepFlag:_,x1:t,y1:e,x2:r,y2:i,cx:m,cy:y,r:g}}var nr=class{static getRectBBox(e){let r=this.createMatrixFrom6(e),i=0,n=1,s=0,a=1,o=[[i,s],[n,s],[n,a],[i,a]],l=new pr;for(let u of o){let d=new ne(u[0],u[1]).multiply3(r);l.ext2(d)}let c=l.build();return{x:c.minX,y:c.minY,width:c.width(),height:c.height()}}static expandRectMatrixByStrokeWidth(e,r,i=!0){let{width:n,height:s}=this.getRectShapeForAttr(e),a;if(i)a=Ue.scale((r+n)/n,(r+s)/s).setOrigin(.5,.5);else{if(n<r)throw new Error("Plz check code");if(s<r)throw new Error("Plz check code");a=Ue.scale((n-r)/n,(s-r)/s).setOrigin(.5,.5)}let o=a.multiply3(this.createMatrixFrom6(e));return this.getMatrix6FromMatrix(o)}static getRectShapeForAttr(e){let r=this.createMatrixFrom6(e),i=new ne(0,0).multiply3(r),n=i.x,s=i.y,a=new ne(1,0).multiply3(r),o=new ne(0,1).multiply3(r),l=a.distance1(i),c=o.distance1(i);return{x:n,y:s,width:l,height:c,bottomLeft:o}}static rectShapeNoRadius(e){let r=this.createMatrixFrom6(e),i=0,n=1,s=0,a=1,o=[[i,s],[n,s],[n,a],[i,a]],l=[];for(let c of o){let u=new ne(c[0],c[1]).multiply3(r);l.push(u)}return l}static calcuEllipse(e){let r=this.createMatrixFrom6(e),i=new Ue(r.getInverseMatrix().data),n=this.getMatrixabcdef(i),s=this.getEllABCDEF(n);return this.getElliShape(s)}static createMatrixFrom6([e,r,i,n,s,a]){return new Ue([e,r,0,i,n,0,s,a,1])}static getMatrix6FromMatrix(e){let[r,i,,n,s,,a,o]=e.data;return[r,i,n,s,a,o]}static getMatrixabcdef(e){let[r,i,,n,s,,a,o]=e.data;return{a:r,b:i,c:n,d:s,e:a,f:o}}static getEllABCDEF(e){let{a:r,b:i,c:n,d:s,e:a,f:o}=e,l=r**2+i**2,c=2*(i*s+r*n),u=s**2+n**2,d=2*(r*a+i*o),A=2*(s*o+n*a),h=a**2+o**2-1;return{A:l,B:c,C:u,D:d,E:A,F:h}}static getElliShape(e){let{A:r,B:i,C:n,D:s,E:a,F:o}=e,l=i**2-4*r*n,c=2*(r*a*a+n*s*s-i*s*a+(i*i-4*r*n)*o),u=r+n,d=Math.sqrt((r-n)**2+i**2),A=-Math.sqrt(c*(u+d))/l,h=-Math.sqrt(c*(u-d))/l,f=(2*n*s-i*a)/l,p=(2*r*a-i*s)/l,m=90;return i!==0?m=Math.atan((n-r-Math.sqrt((r-n)**2+i*i))/i)*180/Math.PI:r<n?m=0:m=90,Math.abs(A-h)<=.1**2&&(m=0),{a:A,b:h,cx:f,cy:p,degree:m}}};function D6(t,e=.05){if(t.length<3)return t.slice();let r=t[0],i=[r];for(let l=1;l<t.length;l++){let c=t[l];r.equals1(c)||i.push(c),r=c}if(r!==i[i.length-1]&&(i.length!==1&&i.pop(),i.push(r)),e<0)return i;let n=i[1],s=n.sub(i[0]).normalize(),a=0,o=[i[0]];for(let l=2;l<i.length;l++){let c=i[l],u=c.sub(n).normalize();a+=Math.acos(Math.min(1,Math.max(-1,s.dot(u)))),a>e&&(o.push(n),a=0),n=c,s=u}return o.push(n),o}var Wve=.99,Kve=50;function lq(t,e){let r=[],i=[],n=e**2;for(let s of t.primitives){if(s instanceof Ee&&s.length()<Kve){i.length===0?i.push(s.start(),s.end()):i.push(s.end());continue}i.length!==0&&(r.push(...oq(i,n).primitives),i.length=0),r.push(s)}return i.length!==0&&r.push(...oq(i,n).primitives),Fr.build2(r)}function _6(t,e,r){let i=t.sub(e),n=r.sub(e),s=i.length(),a=n.length(),o=i.scale(1/s).add(n.scale(1/a)).normalize(),c=Math.PI/2-Math.acos(Math.abs(o.dot(i.scale(1/s)))),u=i.angle(ne.ORIGIN);return i.cross(n)<0?ne.getVector2(u+c):ne.getVector2(u-c)}function aq(t,e,r,i){let n=t.controls[0],s=t.controls[1],a=e.controls[0],o=e.controls[1],l=e.controls[e.controls.length-2],c=e.controls[e.controls.length-1],u=s.sub(n).normalize(),d=o.sub(a).normalize(),A=c.sub(l).normalize(),h=u.cross(d);if(!(Rt.greater(h*d.cross(A),0)&&Rt.greater(h*u.cross(A),0)))return null;let f=c.sub(n),p=Number.NEGATIVE_INFINITY;for(let E of r){let w=Math.abs(f.cross(E[0].sub(n)));w>p&&(p=w)}let m=ne.getCrossPoint1(n,s,l,c)||n.add(c).scale(.5),y=Math.abs(m.sub(n).cross(f)),g=Math.min(1,p/y*4/3),b=new Nt([n,n.add(m.sub(n).scale(g)),c.add(m.sub(c).scale(g)),c]);for(let E of r){let[w,x]=E,I=b.getPointsBySlope(Rt.eq(x.x,0)?Number.POSITIVE_INFINITY:x.y/x.x);if(I.length!==1||w.distance2(I[0])>i)return null}return b}function oq(t,e){if(t.length<2)throw new Error("The length of outline can't be less than 2!");let r=D6(t,-1);if(r.length===2)return Fr.build2([new Ee(r[0],r[1])]);let i=r[0].equals1(r[r.length-1]),n=[],s=i?r[r.length-2]:null,a=r[0],o=r[1];i?(n.push(_6(s,a,o)),s=a,a=o):(n.push(o.sub(a).scale(-1).normalize()),s=a,a=o);let l=D6(r),c=1;for(let p=1;p<r.length-1;p++)o=r[p+1],r[p]===l[c]&&(n.push(_6(s,a,o)),c++),s=a,a=o;i?(o=r[1],n.push(_6(s,a,o))):n.push(s.sub(a));let u=[],d=[],A=l[0],h=n[0],f=null;for(let p=1;p<l.length;p++){let m=l[p],y=n[p],g=A.sub(m);if(g.cross(h)*g.cross(y)>0)f=new Ee(A,m),d.length=0,h=y;else if(Math.abs(y.dot(h))<Wve){if(f instanceof Nt){let b=aq(f,new Nt([A,A,m]),d,e);b?(u.pop(),f=b):f=new Ee(A,m)}else f=new Ee(A,m);p!==l.length-1&&(h=m.sub(l[p+1]).normalize()),d.length=0}else{let b=new Nt([A,ne.getCrossPoint2(A,h,m,y)||A.add(m).scale(.5),m]);if(f instanceof Nt){let E=aq(f,b,d,e);E?(u.pop(),b=E):d.length=0}f=b,d.push([m,y]),h=y}u.push(f),A=m}for(let p=0;p<u.length;p++){let m=u[p];if(m instanceof Nt)try{let y=m.controls,g=y[0],b=y[y.length-1].sub(g).normalize(),E=!0;for(let w=1;w<y.length-1;w++)if(!Rt.eq(1,y[w].sub(g).normalize().dot(b))){E=!1;break}E&&(u[p]=new Ee(y[0],y[y.length-1]))}catch{}}return Fr.build2(u)}function W2(t,e){Jve(t.iterator(),e)}function Jve(t,e){let r=0;for(;t.hasNext();){let i=t.next();e(r++,i)}}var P6=class{constructor(e){this.idx=-1;this.lst=e}hasNext(){return this.idx<this.lst.length-1}next(){if(this.idx<this.lst.length-1)return this.idx++,this.lst[this.idx];throw new Error("bug")}};function cq(t){return new P6(t)}function hq(t){return t===32||t===9||t===13||t===10}var pP=class{constructor(){this._line=1;this._col=0}line(){return this._line}col(){return this._col}_feed(e){return e===10?(this._col=0,this._line++):this._col++,this.feed(e)}parse(e){let r=e.length;for(let i=0;i<r;i++){let n=e.charCodeAt(i);if(!this._feed(n))return this}return this.finish(),this}};var dq=eval;var mP=null,N6=new ArrayBuffer(8),L6=new Float64Array(N6),O6=new Uint32Array(N6),Aq=new Uint16Array(N6),$ve=dq;function jA(t,e,r,i){n(t,null,e,r,i);function n(a,o,l,c,u){let d,A,h,f;if(c<u-1)if(u-c>50)o===null&&(o=new Array(u-c+1)),s(a,o,l,c,(c+u)/2|0,u);else{for(d=a[c],A=c,h=c,f=u;A+1<f;){if(h!=f){if(f=f+-1,l(d,a[f])<=0)continue;a[h]=a[f],h=f;continue}let p=A+1;if(l(d,a[p])>=0){A=p;continue}a[h]=a[p],A=p,h=p}a[h]=d,n(a,o,l,c,h),n(a,o,l,h+1,u)}}function s(a,o,l,c,u,d){n(a,o,l,c,u),n(a,o,l,u,d);for(var A=c,h=u,f=0,p=a[A],m=a[h];A<u&&h<d;){var y=l(p,m);isNaN(y)?(o[f++]=m,m=a[++h]):(y<=0&&(o[f++]=p,p=a[++A]),y>=0&&(o[f++]=m,m=a[++h]))}for(;A<u;A++)o[f++]=a[A];for(;h<d;h++)o[f++]=a[h];for(A=c,h=0;h<f;A++,h++)a[A]=o[h]}}var zl=class{static repeat(e,r){let i=new Array(r);for(;r-- >0;)i[r]=e;return i.join("")}static lpad(e,r,i){let n=i-e.length;return n>0?this.repeat(r,n)+e:e}static rpad(e,r,i){let n=i-e.length;return n>0?e+this.repeat(r,n):e}static strHashcode(e){if(e.length>0){let r=0;for(let i=0;i<e.length;i++)r=31*r+e.charCodeAt(i)|0;return r}else return 0}static arraycopy(e,r,i,n,s){if(e.length>=r+s&&i.length>=n+s)for(;s-- >0;)i[n++]=e[r++];else throw new Error("arraycopy out of range")}static undefAsNull(e){return null}static reverse(e,r){for(let i=0,n=e.length-1;n>=0;i++,n--)r[i]=e[n];return r}static sortAsc(e,r){return e-r}static xmlDecode(e){let r=e.length,i=new Array,n=-1;for(let s=0;s<r;s++){let a=e.charAt(s);if(n>=0){if(a===";"){let o=e.substring(n+1,s);switch(o){case"lt":i.push("<");break;case"gt":i.push(">");break;case"quot":i.push('"');break;case"apos":i.push("'");break;case"amp":i.push("&");break;default:if(o.charAt(0)==="#"){let l=parseInt(o.substring(1));i.push(String.fromCharCode(l))}else i.push("&"+o+";")}n=-1}}else a==="&"?n=s:i.push(a)}return n>=0&&i.push(e.substring(n)),i.join("")}static addAll(e,r){for(let i of r)e.push(i)}static contains(e,r){for(let i of e)if(i.equals(r))return!0;return!1}static equals(e,r){if(e.length==r.length){for(let i=0;i<e.length;i++)if(e[i]!==r[i])return!1;return!0}else return!1}static remove(e,r){let i=0,n=e.length;for(let s=0;s<n;s++)e[s]===r&&(e.splice(s,1),s--,n--,i++);return i}static getUrlVars(){for(var e={},r=location.href.slice(location.href.indexOf("?")+1).split("&"),i=0;i<r.length;i++){var n=r[i].split("=");e[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return e}static prefix(){if(!mP){let e=this.getUrlVars().version;e?mP="/analyzer/v"+e:mP="/analyzer"}return mP}static add2objS(e,r,i){if(r in e)return e[r];{let n=i(r);return e[r]=n,n}}static downloadFile(e,r){let i=document.createElement("a"),n=URL.createObjectURL(r);i.download=e,i.href=n,i.click(),URL.revokeObjectURL(n)}static uuid(){let e=new Array;L6[0]=new Date().getTime(),e.push(O6[1].toString(16)),L6[0]=Math.random(),e.push(Aq[3].toString(16));let r=Aq[2].toString(16);e.push("4"+r.substr(0,3)),L6[0]=performance.now();let i=O6[0].toString(16)+O6[1].toString(16);return e.push("0"+i.substr(0,3)),e.push(i.substr(3)),e.join("-")}static funcCopy(e){return $ve("("+e.toString()+")")}static NVL(...e){for(let r of e)if(r!==null)return r;return null}};var cm=class{static rgb(e){if(0<=e&&e<=255)return e;throw new Error(ld.format("RGB should not nagative and not over 255(0xFF): %X",e))}static normal(e){if(isFinite(e))return e;throw new Error(ld.format("%f is not permitted",e))}static positiveOr0(e){if(e>=0)return e;throw new Error(ld.format("%f must >= 0",e))}static positive(e){if(e>0)return e;throw new Error(ld.format("%f must > 0",e))}static notnull(e){if(e!=null)return e;throw new Error("invalid null value")}static mustnull(e){if(e===null)return null;throw new Error("value must be null")}static notEmpty(e){if(e==null||e.length===0)throw new Error("invalid empty string");return e}static nullOrEmpty(e){return e==null||e.length===0}static notNullOrUndef(e){if(e!=null)return e;throw new Error("null or undefined is not permitted")}static isNumber(e){cu(e)||Zn(e)}};var Zve=/(\.?0+)$/,ld=class{static format(e,...r){return this.format1(e,r)}static format1(e,r){let i=this._format(e,r);if(typeof i=="string")return i;throw new Error(this.format("Invalid state on (%d) %s",i,e))}static _format(e,r){let i=[],n=0,s=0,a,o=0,l=0;for(let c=0;c<e.length;c++){let u=e.charAt(c),d=u.charCodeAt(0);switch(n){case 0:d===37?n=1:i.push(u);break;case 1:switch(d){case 100:if(a=r[s++],typeof a=="number")i.push(a.toFixed(0)),n=0;else return c;break;case 102:if(a=r[s++],typeof a=="number")i.push(a.toString()),n=0;else return c;break;case 120:if(a=r[s++],typeof a=="number")i.push((a|0).toString(16)),n=0;else return c;break;case 88:if(a=r[s++],typeof a=="number")i.push((a|0).toString(16).toUpperCase()),n=0;else return c;break;case 115:case 99:a=r[s++],i.push(a===null?"null":a.toString()),n=0;break;case 48:o=c+1,l=-1,n=2;break;case 37:i.push("%"),n=0;break;default:return c}break;case 2:switch(d){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:l=c;break;case 100:if(l>=o){let A=parseInt(e.substring(o,l+1));if(a=r[s++],typeof a=="number")i.push(zl.lpad((a|0).toString(10),"0",A)),n=0;else return c}else return c;break;case 120:if(l>=o){let A=parseInt(e.substring(o,l+1));if(a=r[s++],typeof a=="number")i.push(zl.lpad((a|0).toString(16),"0",A)),n=0;else return c}else return c;break;case 88:if(l>=o){let A=parseInt(e.substring(o,l+1));if(a=r[s++],typeof a=="number")i.push(zl.lpad((a|0).toString(16).toUpperCase(),"0",A)),n=0;else return c}else return c;break;default:return c}break;default:return c}}return i.join("")}static startsWith(e,r){return e.length>=r.length?e.substring(0,r.length)===r:!1}static endsWith(e,r){return e.length>=r.length?e.substring(e.length-r.length)===r:!1}static split(e,r){let i=new Array,n=0;for(;;){let s=e.exec(r);if(s!==null){let a=e.lastIndex-s[0].length;i.push(r.substring(n,a)),n=e.lastIndex}else{let a=r.substring(n);cm.nullOrEmpty(a)||i.push(a);break}}return i}static fmtNumber(e){return e.toFixed(5).replace(Zve,"")}};function eCe(t){switch(t){case 0:return"DEBUG";case 1:return"INFO";case 2:return"WARNING";case 3:return"ERROR";case 4:return"DUMMY"}}var tCe=(t,e)=>{t===3?console.error(...e):t===2?console.warn(...e):console.log(...e)},rCe=(t,e)=>[eCe(t)].concat(e),K2=class K2{static mix(...e){return new K2(0,(r,i)=>{for(let n of e)n.write(r,i)},(r,i)=>i)}constructor(e,r=tCe,i=rCe){this.level=e,this.writer=r,this.fmt=i}setLevel(e){this.level=e}prepend(e=null,r=null){let i=e===null?this.fmt:(s,a)=>(a=e(s,a),this.fmt(s,a)),n=r===null?this.writer:(s,a)=>{r(s,a),this.writer(s,a)};return new K2(this.level,n,i)}chain(e){return e.prepend(this.fmt.bind(this),this.writer.bind(this))}include(e){return this.level<=e}formatWrite(e,r,i){this.include(e)&&this.writer(e,this.fmt(e,[ld.format(r,...i)]))}write(e,r){this.include(e)&&this.writer(e,this.fmt(e,r))}write3(e,r,i){this.include(e)&&this.writer(e,this.fmt(e,[ld.format(r,...i)]))}debug3(e,...r){this.write3(0,e,r)}warning3(e,...r){this.write3(2,e,r)}debugFmt(e,...r){this.formatWrite(0,e,r)}debug(...e){this.write(0,e)}infoFmt(e,...r){this.formatWrite(1,e,r)}info(...e){this.write(1,e)}warningFmt(e,...r){this.formatWrite(2,e,r)}warning(...e){this.write(2,e)}errorFmt(e,...r){this.formatWrite(3,e,r)}error(...e){this.write(3,e)}};K2.DUMMY=new K2(4);var Zf=K2;var R6=500,fq=String.fromCharCode,gP=class{constructor(){this.buffer=new Array}size(){return this.buffer.length}isEOF(){return!1}write(e){return this.buffer.push(e),1}writen1(e){return this.writen2(e,0,e.length)}writen2(e,r,i){let n=this.buffer;for(let s=0,a=r;s<i;s++,a++)n.push(e[a]);return i}writeAsync(e,r){r(this.write(e))}writenAsync1(e,r){r(this.writen1(e))}writenAsync2(e,r,i,n){n(this.writen2(e,r,i))}writeStr(e){let r=e.length,i=new Array(r);for(let n=0;n<r;n++)i[n]=e.charCodeAt(n);return this.writen1(i)}clear(){this.buffer.length=0}toString(){let e=this.buffer,r=e.length;if(r<=R6)return fq.apply(null,e);{let i=new Array;for(let n=0;n<e.length;n+=R6){let s=Math.min(r-n,R6),a=fq.apply(null,e.slice(n,n+s));i.push(a)}return i.join("")}}};var mq=(s=>(s[s.UNKNOW=0]="UNKNOW",s[s.NUMBER_INTEGER=1]="NUMBER_INTEGER",s[s.NUMBER_DECIMAL=2]="NUMBER_DECIMAL",s[s.NUMBER_E=3]="NUMBER_E",s[s.NUMBER_E_SIGNED=4]="NUMBER_E_SIGNED",s))(mq||{}),gq=(H=>(H[H.UNKNOW=0]="UNKNOW",H[H.MOVE_X=1]="MOVE_X",H[H.MOVE_Y=2]="MOVE_Y",H[H.LINE_X=3]="LINE_X",H[H.LINE_Y=4]="LINE_Y",H[H.HORIZONTAL_X=5]="HORIZONTAL_X",H[H.VERTICAL_Y=6]="VERTICAL_Y",H[H.CUBIC_BEZIER_X1=7]="CUBIC_BEZIER_X1",H[H.CUBIC_BEZIER_Y1=8]="CUBIC_BEZIER_Y1",H[H.CUBIC_BEZIER_X2=9]="CUBIC_BEZIER_X2",H[H.CUBIC_BEZIER_Y2=10]="CUBIC_BEZIER_Y2",H[H.CUBIC_BEZIER_X=11]="CUBIC_BEZIER_X",H[H.CUBIC_BEZIER_Y=12]="CUBIC_BEZIER_Y",H[H.ARC_RX=13]="ARC_RX",H[H.ARC_RY=14]="ARC_RY",H[H.ARC_ROTATION=15]="ARC_ROTATION",H[H.ARC_LARGE=16]="ARC_LARGE",H[H.ARC_SWEEP=17]="ARC_SWEEP",H[H.ARC_X=18]="ARC_X",H[H.ARC_Y=19]="ARC_Y",H[H.SMOOTH_CUBIC_BEZIER_X2=20]="SMOOTH_CUBIC_BEZIER_X2",H[H.SMOOTH_CUBIC_BEZIER_Y2=21]="SMOOTH_CUBIC_BEZIER_Y2",H[H.SMOOTH_CUBIC_BEZIER_X=22]="SMOOTH_CUBIC_BEZIER_X",H[H.SMOOTH_CUBIC_BEZIER_Y=23]="SMOOTH_CUBIC_BEZIER_Y",H[H.QUADRATIC_BEZIER_X1=24]="QUADRATIC_BEZIER_X1",H[H.QUADRATIC_BEZIER_Y1=25]="QUADRATIC_BEZIER_Y1",H[H.QUADRATIC_BEZIER_X=26]="QUADRATIC_BEZIER_X",H[H.QUADRATIC_BEZIER_Y=27]="QUADRATIC_BEZIER_Y",H))(gq||{});function iCe(t){return 97<=t&&t<=122||65<=t&&t<=90}function Xl(t){let e=parseFloat(t);if(isFinite(e))return e;throw new Error("expect number")}var pu=class extends pP{constructor(r,i=!0,n=Zf.DUMMY){super();this.buffer=new gP;this.group=new Array;this.subPartStart=ne.ORIGIN;this.curPoint=ne.ORIGIN;this.lexState=0;this.parseState=0;this.isAbsolute=!1;this.isLargeArc=!1;this.x1=Number.NaN;this.y1=Number.NaN;this.x2=Number.NaN;this.y2=Number.NaN;this.x=Number.NaN;this.y=Number.NaN;this.rx=Number.NaN;this.ry=Number.NaN;this.rotation=Number.NaN;this.sweep=kl.CCW;this.prevBezierCtrl2=null;this.logger=n,this.cb=r,this.yAxis=i?-1:1}on(r){return this.cb(r)}feed(r){switch(this.logger.include(0)&&this.logger.debug3("L: %c(%s)|%s",r,String.fromCharCode(r),mq[this.lexState]),this.lexState){case 0:return hq(r)?!0:48<=r&&r<=57||r===45||r===43?(this.pushBuffer(r),this.lexState=1,!0):r===46?(this.pushBuffer(r),this.lexState=2,!0):iCe(r)?this.feedS(String.fromCharCode(r)):(this.logger.warning3("unknow letter %c",r),!0);case 1:return 48<=r&&r<=57?(this.pushBuffer(r),!0):r===46?(this.pushBuffer(r),this.lexState=2,!0):r===101||r===69?(this.pushBuffer(r),this.lexState=3,!0):this.feedS(this.getCleanBuffer())?(this.lexState=0,this.feed(r)):!1;case 2:return 48<=r&&r<=57?(this.pushBuffer(r),!0):r===101||r===69?(this.pushBuffer(r),this.lexState=3,!0):this.feedS(this.getCleanBuffer())?(this.lexState=0,this.feed(r)):!1;case 3:return 48<=r&&r<=57?(this.pushBuffer(r),!0):r===45||r===43?(this.pushBuffer(r),this.lexState=4,!0):this.feedS(this.getCleanBuffer())?(this.lexState=0,this.feed(r)):!1;case 4:return 48<=r&&r<=57?(this.pushBuffer(r),!0):this.feedS(this.getCleanBuffer())?(this.lexState=0,this.feed(r)):!1;default:return!0}}finish(){this.feed(32),this.tryNotify()}feedS(r){switch(this.logger.include(0)&&this.logger.debug3("P: %s|%s|%s|%s",r,gq[this.parseState],this.curPoint,this.subPartStart),this.parseState){case 0:switch(r){case"M":this.isAbsolute=!0,this.parseState=1;break;case"m":this.isAbsolute=!1,this.parseState=1;break;case"L":this.isAbsolute=!0,this.parseState=3;break;case"l":this.isAbsolute=!1,this.parseState=3;break;case"H":this.isAbsolute=!0,this.parseState=5;break;case"h":this.isAbsolute=!1,this.parseState=5;break;case"V":this.isAbsolute=!0,this.parseState=6;break;case"v":this.isAbsolute=!1,this.parseState=6;break;case"z":case"Z":{this.group.push(new Ee(this.curPoint,this.subPartStart));let s=this.tryNotify();return this.curPoint=this.subPartStart,s}case"C":this.isAbsolute=!0,this.parseState=7;break;case"c":this.isAbsolute=!1,this.parseState=7;break;case"S":this.isAbsolute=!0,this.parseState=20;break;case"s":this.isAbsolute=!1,this.parseState=20;break;case"A":this.isAbsolute=!0,this.parseState=13;break;case"a":this.isAbsolute=!1,this.parseState=13;break;case"Q":this.isAbsolute=!0,this.parseState=24;break;case"q":this.isAbsolute=!1,this.parseState=24;break;default:this.logger.warning3("unknow %s",r)}return!0;case 1:let i=this.tryNotify();return this.x=Xl(r),this.parseState=2,i;case 2:{this.y=this.yAxis*Xl(r);let s;return this.isAbsolute?s=new ne(this.x,this.y):s=this.curPoint.add1(this.x,this.y),this.curPoint=s,this.subPartStart=s,this.parseState=3,!0}case 3:return this.x=parseFloat(r),isFinite(this.x)?(this.parseState=4,!0):(this.parseState=0,this.feedS(r));case 4:{this.y=this.yAxis*Xl(r);let s;return this.isAbsolute?s=new ne(this.x,this.y):s=this.curPoint.add1(this.x,this.y),this.group.push(new Ee(this.curPoint,s)),this.curPoint=s,this.parseState=3,!0}case 5:if(this.x=parseFloat(r),isFinite(this.x)){let s;return this.isAbsolute?s=new ne(this.x,this.curPoint.y):s=this.curPoint.add1(this.x,0),this.group.push(new Ee(this.curPoint,s)),this.curPoint=s,!0}else return this.parseState=0,this.feedS(r);case 6:if(this.y=parseFloat(r),isFinite(this.y)){this.y=this.yAxis*this.y;let s;return this.isAbsolute?s=new ne(this.curPoint.x,this.y):s=this.curPoint.add1(0,this.y),this.group.push(new Ee(this.curPoint,s)),this.curPoint=s,!0}else return this.parseState=0,this.feedS(r);case 7:let n=parseFloat(r);return isFinite(n)?(this.x1=n,this.parseState=8,!0):(r!=="s"&&r!=="S"&&(this.prevBezierCtrl2=null),this.parseState=0,this.feedS(r));case 8:return this.y1=this.yAxis*Xl(r),this.parseState=9,!0;case 9:return this.x2=Xl(r),this.parseState=10,!0;case 10:return this.y2=this.yAxis*Xl(r),this.parseState=11,!0;case 11:return this.x=Xl(r),this.parseState=12,!0;case 12:{this.y=this.yAxis*Xl(r);let s,a,o;return this.isAbsolute?(s=new ne(this.x1,this.y1),a=new ne(this.x2,this.y2),o=new ne(this.x,this.y)):(s=this.curPoint.add1(this.x1,this.y1),a=this.curPoint.add1(this.x2,this.y2),o=this.curPoint.add1(this.x,this.y)),this.prevBezierCtrl2=a,this.group.push(new Nt([this.curPoint,s,a,o])),this.curPoint=o,this.parseState=7,!0}case 13:return this.rx=parseFloat(r),isFinite(this.rx)?(this.parseState=14,!0):(this.parseState=0,this.feedS(r));case 14:return this.ry=Xl(r),this.parseState=15,!0;case 15:return this.rotation=Xl(r),this.parseState=16,!0;case 16:return this.isLargeArc=Xl(r)===1,this.parseState=17,!0;case 17:return this.sweep=Xl(r)===1?kl.CW:kl.CCW,this.parseState=18,!0;case 18:return this.x=Xl(r),this.parseState=19,!0;case 19:{this.y=this.yAxis*Xl(r);let s;return this.isAbsolute?s=new ne(this.x,this.y):s=this.curPoint.add1(this.x,this.y),this.rx&&this.ry&&this.group.push(ze.build1(this.curPoint,s,this.rx,this.ry,this.isLargeArc,this.sweep)),this.curPoint=s,this.parseState=13,!0}case 20:return this.x2=parseFloat(r),isFinite(this.x2)?(this.parseState=21,!0):(r!=="s"&&r!=="S"&&(this.prevBezierCtrl2=null),this.parseState=0,this.feedS(r));case 21:return this.y2=this.yAxis*Xl(r),this.parseState=22,!0;case 22:return this.x=Xl(r),this.parseState=23,!0;case 23:{this.y=this.yAxis*Xl(r);let s,a;this.isAbsolute?(s=new ne(this.x2,this.y2),a=new ne(this.x,this.y)):(s=this.curPoint.add1(this.x2,this.y2),a=this.curPoint.add1(this.x,this.y));let o;return this.prevBezierCtrl2?o=this.curPoint.add(this.curPoint.sub(this.prevBezierCtrl2)):o=this.curPoint,this.prevBezierCtrl2=s,this.group.push(new Nt([this.curPoint,o,s,a])),this.curPoint=a,this.parseState=20,!0}case 24:return this.x1=parseFloat(r),isFinite(this.x1)?(this.parseState=25,!0):(r!=="s"&&r!=="S"&&(this.prevBezierCtrl2=null),this.parseState=0,this.feedS(r));case 25:return this.y1=this.yAxis*Xl(r),this.parseState=26,!0;case 26:return this.x=Xl(r),this.parseState=27,!0;case 27:{this.y=this.yAxis*Xl(r);let s,a;return this.isAbsolute?(s=new ne(this.x1,this.y1),a=new ne(this.x,this.y)):(s=this.curPoint.add1(this.x1,this.y1),a=this.curPoint.add1(this.x,this.y)),this.prevBezierCtrl2=s,this.group.push(new Nt([this.curPoint,s,a])),this.curPoint=a,this.parseState=24,!0}default:return this.logger.warning3("unsupported parse state %s",this.parseState),!0}}pushBuffer(r){this.buffer.write(r)}getCleanBuffer(){let r=this.buffer.toString();return this.buffer.clear(),r}tryNotify(){if(this.group.length===0)return!0;{let r=Fr.build1(cq(this.group));return this.group.length=0,this.on(r)}}onException(r){throw r}};var gVe=ld.fmtNumber,Ku=class{constructor(e=!0){this.buffer=new Array;this.state=0;this.prev=null;this.yAxis=e?-1:1}encPl(e){for(let r of e.primitives)this.encPt(r);return this}encPt(e){if(e instanceof Ee)this.encLine1(e);else if(e instanceof ze)this.encArc(e);else if(e instanceof Nt)this.encBezier(e);else throw new Error("");return this}encBezier(e){if(e.controls.length===3){let r=e.controls[0],i=e.controls[1],n=e.controls[2];this.state===0?this.buffer.push("M",r.x,this.yAxis*r.y,"Q",i.x,this.yAxis*i.y,n.x,this.yAxis*n.y):r.equals1(this.prev)?this.state!==4?this.buffer.push("Q",i.x,this.yAxis*i.y,n.x,this.yAxis*n.y):this.buffer.push(i.x,this.yAxis*i.y,n.x,this.yAxis*n.y):this.buffer.push("L",r.x,this.yAxis*r.y,"Q",i.x,this.yAxis*i.y,n.x,this.yAxis*n.y),this.prev=n,this.state=4}else if(e.controls.length===4){let r=e.controls[0],i=e.controls[1],n=e.controls[2],s=e.controls[3];this.state===0?this.buffer.push("M",r.x,this.yAxis*r.y,"C",i.x,this.yAxis*i.y,n.x,this.yAxis*n.y,s.x,this.yAxis*s.y):r.equals1(this.prev)?this.state!==3?this.buffer.push("C",i.x,this.yAxis*i.y,n.x,this.yAxis*n.y,s.x,this.yAxis*s.y):this.buffer.push(i.x,this.yAxis*i.y,n.x,this.yAxis*n.y,s.x,this.yAxis*s.y):this.buffer.push("L",r.x,this.yAxis*r.y,"C",i.x,this.yAxis*i.y,n.x,this.yAxis*n.y,s.x,this.yAxis*s.y),this.prev=s,this.state=3}else throw new Error("only bezier has 3 or 4 control points supported");return this}encArc(e){let r=e.svgEnd;return this.state===0?this.buffer.push("M",e.start().x,this.yAxis*e.start().y,"A",e.rx,e.ry,0,e.isLarge()?1:0,e.sweep()===kl.CCW?0:1,r.x,this.yAxis*r.y):e.start().equals1(this.prev)?this.state!==2?this.buffer.push("A",e.rx,e.ry,0,e.isLarge()?1:0,e.sweep()===kl.CCW?0:1,r.x,this.yAxis*r.y):this.buffer.push(e.rx,e.ry,0,e.isLarge()?1:0,e.sweep()===kl.CCW?0:1,r.x,this.yAxis*r.y):this.buffer.push("L",e.start().x,this.yAxis*e.start().y,"A",e.rx,e.ry,0,e.isLarge()?1:0,e.sweep()===kl.CCW?0:1,r.x,this.yAxis*r.y),this.prev=r,this.state=2,this}encLine1(e){return this.encLine2(e.start(),e.end()),this}encLine2(e,r){return this.state===0?this.buffer.push("M",e.x,this.yAxis*e.y,"L",r.x,this.yAxis*r.y):(this.state!==1&&this.buffer.push("L"),e.equals1(this.prev)?this.buffer.push(r.x,this.yAxis*r.y):this.buffer.push(e.x,this.yAxis*e.y,r.x,this.yAxis*r.y)),this.prev=r,this.state=1,this}close(e){return this.state!==0&&(e&&this.buffer.push("Z"),this.state=0,this.prev=null),this}fixNumber(e=4){return this.buffer.forEach((r,i,n)=>{typeof r=="number"&&(r|0)!==r&&(n[i]=+r.toFixed(e))}),this}toString(){return this.buffer.join(" ")}toArray(){return this.buffer}};function yq(t,e){let r=[],i=new pu(s=>(r.push(s),!0),!1);i.parse(t),i.finish();let n=new Ku(!1);for(let s of r){let a=lq(s,e),o=Math.max(0,Math.log10(10/e)|0);a=a.round(o),n.encPl(a),n.close(!1)}return n.toString()}function Jn(t,e=!0){let r=new Array;return new pu(i=>(r.push(i),!0),e).parse(t),r}function ql(t,e=!1,r=.01,i){let n=!0;i&&(n=i.reverseY);let s=Array();for(let a of t){let o=new Ku(n);o.encPl(a);let l=o.fixNumber(4).toString();s.push(e?bq(l,r):l)}return s.join(" ")}function mS(t,e=!0,r=.01){let i=new Ku;t.forEach((s,a)=>{i.encPl(s),i.close(a===t.length-1)});let n=i.toString();return[e?bq(n,r):n]}function bq(t,e=.01){let r=nCe(t);try{let i=yq(t,e);return i=sCe(i,r),i}catch(i){return console.warn("\u4F7F\u7528\u8D1D\u585E\u5C14\u66F2\u7EBF\u62DF\u5408\u6298\u7EBF\u6BB5\u5931\u8D25\uFF0C\u4F7F\u7528\u8F6C\u5316\u524Dd",i),t}}function nCe(t){return t.split(/m/i).slice(1).map(r=>({isClose:/z\s*$/i.test(r)}))}function sCe(t,e){let r=t.match(/m/gi),i=t.split(/m/i).slice(1);return i.length&&e.length===i.length?i.reduce((n,s,a)=>(n+=`${r[a]}${s.replace(/z*\s*$/i,e[a].isClose?" Z":" ")}`,n),""):(console.warn("\u672A\u7EA0\u6B63\u8DEF\u5F84\u95ED\u5408\u60C5\u51B5\uFF0C\u53C2\u8003\u6570\u636E\u4E0E\u8F6C\u5316\u540E\u7684\u6570\u636E\u7EC4\u6570\u91CF\u4E0D\u4E00\u81F4\u3002"),t)}function J2(t,e){if(e<0||e>15)return t;let r=/[^\d.e]\d*\.\d+/gi,i=/\.?0+$/,n=a=>{let l=(+a.slice(1)).toFixed(e).replace(i,"");return a[0]+l};return t.replace(/[MLACQSTHV][^MLACQSTHVZ]+/gi,a=>a.replace(r,n))}var Ju=class Ju{static toDegrees(e){return e*180/Math.PI}static toRadians(e){return e/180*Math.PI}static regularD(e){return e=e%360,e<0?360+e:e}static regular(e){return e=e%Ju.PIx2,e<0?Ju.PIx2+e:e}static toQuarterBase(e){return Ju.regular((e+Ju.PI_4)/Ju.PI_2*Ju.PI_2)}static toQuarterBaseD(e){return Ju.regularD(((e+45)/90|0)*90)}static transformD(e,r){return Ju.toDegrees(Ju.transform(Ju.toRadians(e),r))}static transform(e,r){let i=Math.cos(e),n=Math.sin(e),s=new ne(r.data[6],r.data[7]),a=new ne(i,n).multiply3(r);return Ju.regular(a.angle(s))}};Ju.PIx2=Math.PI*2,Ju.PI_2=Math.PI/2,Ju.PI_4=Math.PI/4;var mu=Ju;var ny=class{constructor(e){this.data=e;let r=vz(this.data.x1,this.data.y1,this.data.rx,this.data.ry,mu.toRadians(this.data.angle),this.data.large,this.data.sweep,this.data.x2,this.data.y2);this.cx=r.cx,this.cy=r.cy}getMatrix(){return Ue.scale(this.data.rx,this.data.ry).rotateD(this.data.angle).translate(this.cx,this.cy)}getInverseMatrix(){let e=this.getMatrix();return new Ue(e.getInverseMatrix().data)}vectorStart(){return new ne(this.data.x1,this.data.y1)}vectorEnd(){return new ne(this.data.x2,this.data.y2)}vectorCenter(){return new ne(this.cx,this.cy)}startAngle(){return Cs(-this.vectorStart().angleD2(this.vectorCenter()))}endAngle(){return Cs(-this.vectorEnd().angleD2(this.vectorCenter()))}setAngle(e,r){let i=this.getMatrix(),n=mu.toRadians(e),s=this.vectorCenter(),a=Math.cos(n)*10,o=Math.sin(n)*10,l=this.getInverseMatrix(),u=new ne(s.x+a,s.y+o).multiply3(l).angle2(ne.ORIGIN),d=new ne(Math.cos(u),Math.sin(u)).multiply3(i);r==="start"?(this.data.x1=d.x,this.data.y1=d.y):(this.data.x2=d.x,this.data.y2=d.y);let A=new ne(this.data.x1,this.data.y1).sub(s),h=new ne(this.data.x2,this.data.y2).sub(s),f=A.cross(h);return this.data.sweep===1?this.data.large=f>0?0:1:this.data.large=f<0?0:1,this}points(e=1){let r=this.getMatrix(),i=new Ue(r.getInverseMatrix().data),n=this.vectorStart().multiply3(i),s=n.angleD2(ne.ORIGIN),a=this.vectorEnd().multiply3(i),o=this.data.sweep,l=[],c=0,u=C_(n,{x:0,y:0},a),d=mu.toDegrees(u);n.cross(a)>0?o===1?c=d:c=360-d:o===0?c=d:c=360-d,e||(e=.1);let{ceil:h,abs:f,round:p,max:m,min:y,cos:g,sin:b}=Math,E=h(f(c/e));E=m(2,y(p(c*10),E)),e=f(c/E)*(o===1?1:-1);let w=mu.toRadians(s),x=mu.toRadians(e);l.push(this.vectorStart());for(let I=1;I<E;I++)w+=x,l.push(new ne(g(w),b(w)).multiply3(r));return l.push(this.vectorEnd()),l}setArcType(e){return this.data.type=e,this}bbox(){let e=this.points(2),r=new pr;for(let s of e)r.ext2(s);let i=r.build();return{x:i.minX,y:i.minY,width:i.width(),height:i.height()}}bboxEllipse(){let e=this.getMatrix(),r=nr.getMatrix6FromMatrix(e);return un({...this.data,matrix:r},"ellipse")}};function aCe(t){let{matrix:e,tempMatrix:r}=t,[i,n,s,a,o,l]=r||e,c=Math.atan2(s,i),u=Math.atan2(a,n),d=Math.cos(c),A=Math.sin(c),h=Math.abs(i*d+s*A);d=Math.cos(u),A=Math.sin(u);let f=Math.abs(n*d+a*A);return{x:o-h,y:l-f,width:h*2,height:f*2}}function oCe(t){let e=new ny(t),r=e.getMatrix(),i=e.vectorStart(),n=e.vectorEnd(),[s,a,o,l,c,u]=nr.getMatrix6FromMatrix(r),d=Math.atan2(o,s),A=Math.atan2(l,a),h=[];for(let p of[d,d+Math.PI,A,A+Math.PI]){let m=Math.cos(p),y=Math.sin(p),g=s*m+o*y+c,b=a*m+l*y+u;h.push(new ne(g,b))}let f=new pr;f.ext2(i).ext2(n);for(let p of h){let m=i.sub(p).cross(n.sub(p));if(t.sweep===0){if(m<0)continue}else if(m>0)continue;f.ext2(p)}return ep(f.build())}function xq(t){let{matrix:e,tempMatrix:r}=t,i=nr.createMatrixFrom6(r||e),n=0,s=1,a=0,o=1,l=[[n,a],[s,a],[s,o],[n,o]],c=new pr;for(let d of l){let A=new ne(d[0],d[1]).multiply3(i);c.ext6(A.x,A.y)}let u=c.build();return ep(u)}function lCe(t){let e=Jn(t.tempD||t.d,!1),r=new pr;for(let n of e)for(let s of n.primitives)s instanceof Nt?r.ext1(s.bboxWithControls()):r.ext1(s.bbox());let i=r.build();return ep(i)}function yP(t){let e=Jn(t.tempD||t.d,!1),r=new pr;for(let n of e)for(let s of n.primitives)if(s instanceof Nt){let a=new pr;s.getBezierPoints(.5,l=>a.ext2(l));let o=a.build();r.ext1(o)}else r.ext1(s.bbox());let i=r.build();return{x:i.minX,y:i.minY,width:i.width(),height:i.height()}}function cCe(t){let e=nr.createMatrixFrom6(t.tempMatrix||t.matrix),r=new pr().ext6(0,0).ext6(t.cacheWidth,-t.cacheHeight).build().transform(e);return{x:r.minX,y:r.minY,width:r.width(),height:r.height()}}function uCe(t){let e=new pr;e.ext6(t.measureX1,t.measureY1),e.ext6(t.measureX2,t.measureY2),e.ext6(t.x1,t.y1),e.ext6(t.x2,t.y2);let r=e.build();return{x:r.minX,y:r.minY,width:r.width(),height:r.height()}}function hCe(t){let e=new pr;e.ext6(t.x1,t.y1),e.ext6(t.x2,t.y2),e.ext6(t.angleX,t.angleY);let r=e.build();return{x:r.minX,y:r.minY,width:r.width(),height:r.height()}}function dCe(t){let e=new pr;e.ext6(t.x1,t.y1),e.ext6(t.x2,t.y2);let r=e.build();return{x:r.minX,y:r.minY,width:r.width(),height:r.height()}}function ACe(t){let e=new pr;e.ext6(t.x1,t.y1),e.ext6(t.x2,t.y2);let r=e.build();return{x:r.minX,y:r.minY,width:r.width(),height:r.height()}}function fCe(t){let e=new pr;e.ext6(t.x,t.y);let r=e.build();return{x:r.minX,y:r.minY,width:0,height:0}}function pCe(t){let e=new pr;e.ext2(t.start.primitivePoint),e.ext2(t.start.otherPoint),e.ext2(t.end.primitivePoint),e.ext2(t.end.otherPoint);let r=e.build();return{x:r.minX,y:r.minY,width:r.width(),height:r.height()}}var wq={text:t=>cCe(t),obj:t=>xq(t),ellipse:t=>aCe(t),arc:t=>oCe(t),rect:t=>xq(t),group:t=>lCe(t),dimensionLength:t=>uCe(t),dimensionAngle:t=>hCe(t),dimensionRadius:t=>dCe(t),dimension:t=>pCe(t),auxiliaryLine:t=>ACe(t),auxiliaryPoint:t=>fCe(t),_runtime:t=>{switch(t.subCmdKey){case"select-box":return ep(Mr.extendRect(t));default:break}}},M6=["text","obj","ellipse","rect","group","arc"];function bP(t,e){return Mr.extendRect(un(t,e))}function un(t,e){return e=e||t.cmdKey,wq[e](t)}function vq(){let t=new Map;return e=>{if(t.has(e.gId))return t.get(e.gId);{let r=un(e);return t.set(e.gId,r),r}}}function xP(t){let e=new pr;for(let r of t)e.ext10(wq[r.cmdKey](r));return ep(e.build())}function ep(t){return{x:t.minX,y:t.minY,width:t.width(),height:t.height()}}async function Cq(t,e={},r=te.gJsonCache){jf(t)||(t=[t]),r||(r=te.gJsonCache);let i=r;if(!Array.isArray(t))return r;for(let n of t){let s=e;if((!s||!Object.keys(s).length)&&console.error("update param error: "+JSON.stringify(s)),n.cmdKey==="canvas"){await An.modify_json(s,r);continue}let a=i[n.cmdKey][n.id];if(!a){console.error("Not Found Json in JsonCache!",e,"\u2764\u8BF7\u68C0\u67E5\u4EE3\u7801\u2764");continue}mCe(n.cmdKey,a,s)}return r}function mCe(t,e,r){for(let i in r){if(!$t(r,i))continue;let n=r[i];switch(i){case"attr-transparency-print":case"attr-transparency-white":if(+e.layer===2){let s=i.substring(5);s=az.camelize(s),e[s]=+n;continue}break;case"attr-rotation":e.rotation=-n;break;default:break}i==="attr-name"?e.name=r[i]:i==="attr-locked"?e.locked=r[i]==="yes":i==="attr-hide"?e.hide=r[i]==="yes":i==="attr-transparency"?e.opacity=1-r[i]/100:i==="attr-cover"?e.cover=r[i]==="yes":i==="attr-scope"&&(e.scope=+r[i])}}var Bg=gCe("3.1.48");function gCe(t){return t.split(".").slice(0,3).join(".")}var nb=class{constructor(){this.detached=!1}detach(){this.detached=!0}isDetached(){return this.detached}onAnyEventStart(e){}onAnyEventEnd(e){}onKeyDown(e){}onKeyUp(e){}onMouseLeftDown(e){}onMouseMidDown(e){}onMouseRightDown(e){}onMouseLeftUp(e){}onMouseMidUp(e){}onMouseRightUp(e){}onMouseMove(e){}onMouseOver(e){}onMouseOut(e){}onMouseWheel(e){}onDoubleClick(e){}onResize(e){}onCustom(e){}};var Fc=class extends nb{},Ps={drag_anchor_tool:Symbol.for("drag_anchor_tool"),drag_control_dot_tool:Symbol.for("drag_control_dot_tool"),drag_control_dot_arc_tool:Symbol.for("drag_control_dot_arc_tool"),highlight:Symbol.for("highlight"),drag_tool:Symbol.for("drag_tool"),rotate_by_anchor_tool:Symbol.for("rotate_by_anchor_tool"),adapt_view_tool:Symbol.for("adapt_view_tool"),drag_select_area_tool:Symbol.for("drag_select_area_tool"),draw:Symbol.for("draw"),place_lib_tool:Symbol.for("place_lib_tool"),paste_tool:Symbol.for("paste_tool"),referencePoint_tool:Symbol.for("referencePoint_tool"),rect_select_tool:Symbol.for("rect_select_tool")};var bS=!1,xS,Uc=class Uc extends Fc{constructor(){super()}getSymbol(){return Ps.adapt_view_tool}static setAdaptAreaSelectionView(e){bS!==e&&(bS=e,e||this.hideSelectBox())}static isAdaptAreaSelectionView(){return bS}install(){console.log(this.getSymbol(),"installed"),xS=pz(X.selectBox1),X.svgRoot.appendChild(xS)}uninstall(){console.log(this.getSymbol(),"uninstalled"),Cr(xS)}onMouseLeftUp(e){if(!bS)return;Uc.leftClickTimes++;let{originalEvent:r}=e,{x:i,y:n}=Hn(r,!1);if(Uc.leftClickTimes%2===1&&(Uc.firstClickDot={x:i,y:n}),Uc.leftClickTimes%2===0){let s={x:Math.min(Uc.firstClickDot.x,i),y:Math.min(Uc.firstClickDot.y,n),width:Math.abs(Uc.firstClickDot.x-i),height:Math.abs(Uc.firstClickDot.y-n)};dm(s,1),Uc.hideSelectBox(),document.dispatchEvent(new MouseEvent("mousemove",{clientX:e.mouseX,clientY:e.mouseY}))}}onMouseRightUp(e){Uc.isAdaptAreaSelectionView()&&yCe(),e.toolFinished=!0}onMouseMove(e){if(!bS||Uc.leftClickTimes%2===0)return;let{x:r,y:i}=Uc.firstClickDot,{originalEvent:n}=e,{x:s,y:a}=Hn(n,!1),o=s-r,l=a-i;ES(Uc.firstClickDot.x,Uc.firstClickDot.y,o,l,{target:xS})}static hideSelectBox(){hm({target:xS}),Uc.leftClickTimes=0}};Uc.leftClickTimes=0;var um=Uc;function yCe(){X.windowBridge.publish("toggleLinkbuttonActive",[["adaptAreaSelectionView"],!1],ur()),Ls(),document.querySelector("#g1").classList.remove("none-events"),um.setAdaptAreaSelectionView(!1)}var Hi={renderer:null,history:null};var EP=class{constructor(e){this.id="selectBox1";this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height}render(){return Hi.renderer.attrs(this.id,{display:"",width:this.width,height:this.height,x:this.x,y:this.y,stroke:X.panelThemeCache.color.select,visible:"visible"}),this}updateData(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}unmount(){throw new Error("Method not implemented.")}toData(){let e={cmdKey:"_runtime",subCmdKey:"select-box",x:this.x,y:this.y,width:this.width,height:this.height},r=te.getRuntime(this.id)||{};return Object.assign(r,e)}setData(){te.setRuntime(this.id,this.toData())}multiply3(e){throw new Error("Method not implemented.")}rotateSelf(e,r){throw new Error("Method not implemented.")}};var Ja=(t,e={create8Dots:!1})=>{if(Array.isArray(t)&&t.length){if(t.length===1){let r=e.create8Dots&&Ac(t[0])||[],i=r.slice(0,8).concat(r[0],r[1]).join(" ");ge(X.selectBox1,{display:"none"}),Dg(i,"block"),["group"].includes(Pi(t[0]))&&pi.isAnchorMode(t[0].id)&&Dg("","none")}else{let r=la(t,!0);ES(r.x,r.y,r.width,r.height),new EP(r).render().setData(),Ac(X.selectBox1),Dg("","none")}return}else console.error(t)};function Dg(t,e=""){Hi.renderer.attrs("ctrl-polyline",{points:t,display:e})}var k6=class{constructor(){this.controlDotArr=[];this.controlLineArr=[];this.bezierHandleArr=[];this.circleArr=[];this.handleInfo=[];this.anchorInfo=[];this.dotsInfo=[];this.addListener=eq(()=>{document.addEventListener("click",e=>{if(!X.doctype)return;let{target:r,ctrlKey:i}=e,{x:n,y:s}=Hn(e);!i&&this.isClickedAnchor(r,n,s)&&this.clickHandler(e)})});window.frameElement&&(this.gControlDotsContainer=Fe("gControlDots"),this.gControlLinesContainer=Fe("gControlLines"),this.addListener())}isClickedAnchor(e,r,i){if(Pi(e)!=="cdot")return!1;let n=this.findControlDot(r,i);return n&&n.type==="anchor"?n:!1}findControlDot(e,r){let i=Number.MAX_SAFE_INTEGER,n;for(let s of[...this.anchorInfo,...this.handleInfo,...this.dotsInfo]){let a=sd(e,r,s.x,s.y);a<i&&a<s.size**2&&(i=a,n=s)}return n}findControlDotByIndex(e){for(let r of[...this.anchorInfo,...this.handleInfo])if(r.index===e)return r}findControlDotById(e){for(let r of[...this.anchorInfo,...this.handleInfo,...this.dotsInfo])if(r.id===e)return r;return null}findCanRotateControlDotInfo(e,r){var l,c,u,d;if((c=(l=this.gControlDotsContainer)==null?void 0:l.classList)!=null&&c.contains("hide")||!(((d=(u=this.anchorInfo)==null?void 0:u[0])==null?void 0:d.type)==="bbox"))return null;let n=new ne(e,r);if(gg(n,this.anchorInfo.slice(0,4)))return null;let a,o=(16/X.gZoom)**2;for(let A of this.anchorInfo){let h=sd(e,r,A.x,A.y);h<o&&(o=h,a=A)}return a}anchorOrHandleHasSelected(){for(let e of[...this.anchorInfo,...this.handleInfo])if(e.selected)return e;return!1}selectAnchorOrHandle(e){for(let r of[...this.anchorInfo,...this.handleInfo]){let{id:i,selected:n}=r;if(n){let s=Fe(i);s&&s.classList.remove("selected"),r.selected=!1}i===e&&(Fe(e).classList.add("selected"),r.selected=!0)}this.selectedCdotId=e}clickHandler(e){let{target:r,ctrlKey:i}=e;r=r;let n=r.dataset.index;r.classList.add("selected"),i?pi.addOrRemoveHandle(+n):(this.hideAllHandle(),this.hideAllLines(),this.showAroundHandleByIndex(+n),this.showHelperLine(+n))}removeAllAnchor(){let e=[];for(let r of this.controlDotArr)r.dataset.type==="anchor"?Hi.renderer.removeNode(r.id):e.push(r);return this.controlDotArr=e,this}hideAllHandle(){for(let e of this.bezierHandleArr)e.classList.add("hide");return this}hideAllLines(){for(let e of this.controlLineArr)e.classList.add("hide");return this}showHelperLine(e=0){let r=this.getNextDisplayAnchor(e);for(let i of this.controlLineArr){let n=+i.dataset.belong;r.includes(n)&&i.classList.remove("hide")}}getNextDisplayAnchor(e=0){let r=[e],i=this.anchorInfo.length,n=this.anchorInfo.findIndex(s=>e===s.index);return this.anchorInfo[n+1]?r.push(this.anchorInfo[n+1].index):r.push(this.anchorInfo[0].index),this.anchorInfo[n-1]?r.push(this.anchorInfo[n-1].index):r.push(this.anchorInfo[i-1].index),r}showAroundHandleByIndex(e){let r=this.getNextDisplayAnchor(e);for(let i of this.bezierHandleArr){let n=+i.dataset.belong||0;r.includes(n)&&nd(i,"hide")}}showHandleOfIndexes(e){this.hideAll();for(let r of this.bezierHandleArr){let i=+r.dataset.belong||0;e.includes(i)&&nd(r,"hide")}for(let r of this.controlLineArr){let i=+r.dataset.belong;e.includes(i)&&r.classList.remove("hide")}}emptyChildren(e,r){for(let i=e;i<r.length;i++){let n=r[i];Cr(n)}return r.length=e,this}dataset(e,r={}){for(let i in r)e.dataset[i]=r[i]}createBezierHandle(e){let r=e.filter(n=>n.display),i=r.length;for(let n=0;n<i;n++){let{id:s,x:a,y:o,size:l,index:c,belong:u,type:d,selected:A}=r[n],h=this.bezierHandleArr[n];h?(h.id=s,this.dataset(h,{x:a,y:o,size:l,belong:u,index:c}),this.updateDotPosition(h,r[n])):(h=this.createCircleEle(r[n]),this.bezierHandleArr.push(h),this.gControlDotsContainer.appendChild(h),this.dataset(h,{belong:u,index:c,type:d}),h.classList.add("hide")),A?h.classList.add("selected"):h.classList.remove("selected")}this.emptyChildren(i,this.bezierHandleArr)}createHoverAnchor(e,r,i){let n=this.createRhombus(e,r,i);return this.gControlDotsContainer.appendChild(n),n}createAnchorDots(e){let r=e.length;for(let i=0;i<r;i++){let{id:n,x:s,y:a,size:o,index:l,belong:c,type:u,selected:d}=e[i],A=this.createRect(n,s,a,o);u==="anchor"&&(A=this.createRhombus(s,a,n)),this.controlDotArr.push(A),this.gControlDotsContainer.appendChild(A),this.dataset(A,{belong:c,index:l,type:u}),d?A.classList.add("selected"):A.classList.remove("selected")}}before(){let e=Fe("gControlDots"),r=Fe("gControlRects"),i=Fe("gControlLines"),n=[e,r,i];for(let s of n)s.classList.remove("hide")}create(e){for(let r of e)switch(r.type){case"solid-circle":let i=this.createCircleEle(r,{fill:"var(--selectColor)"});this.circleArr.push(i),this.gControlDotsContainer.appendChild(i),this.dataset(i,{type:"solid-circle"});break;default:break}}mainV2(e){let r=e.cmdkey,i=4/X.gZoom*2,n=[];if(this.anchorInfo=n,e.bbox){let a=e.bbox,o=a.length/2;for(let l=0;l<o;l++){let c=a[l*2],u=a[l*2+1],d="cdot"+l,A={id:d,x:c,y:u,size:i,degree:0,index:l,type:"bbox",selected:d===this.selectedCdotId,belongCmdKey:r};n.push(A)}}if(e.anchor){let a=e.anchor,o=a.length/2;for(let l=0;l<o;l++){let c=a[l*2],u=a[l*2+1],d="cdot-anchor-"+l,A={id:d,x:c,y:u,size:i,degree:45,index:l,type:"anchor",selected:d===this.selectedCdotId,belongCmdKey:r};n.push(A)}}let s=[];if(this.dotsInfo=s,e["solid-circle"]){let a=e["solid-circle"],o=a.length;for(let l=0;l<o;l++){let{x:c,y:u,type:d}=a[l],A="cdot-handle-"+l,h={id:A,x:c,y:u,size:i/2,degree:0,index:l,type:d,selected:A===this.selectedCdotId,belongCmdKey:r};s.push(h)}}this.emptyChildren(0,this.circleArr).create(s),this.emptyChildren(0,this.controlDotArr).createAnchorDots(n)}main(e){if(this.before(),Jh(e))return this.mainV2(e);let r=e.length/2,i=e.isModifyAnchor,n=e.handleIndexes||new Map,s=4/X.gZoom*2,a=[],o=[];for(let l=0;l<r;l++){let c=e[l*2],u=e[l*2+1],d="cdot"+l,A={id:d,x:c,y:u,size:s,degree:i?45:0,index:l,type:i?"anchor":"bbox",selected:d===this.selectedCdotId};if(n.get(l)){A.belong=n.get(l).belong,A.display=n.get(l).display,A.type="handle",A.size/=2,a.push(A);continue}o.push(A)}(!this.compareInfo(this.handleInfo,a)||!this.compareInfo(this.anchorInfo,o))&&(this.emptyChildren(0,this.controlDotArr),this.emptyChildren(0,this.circleArr),this.createAnchorDots(o),this.createBezierHandle(a),this.createLine(e),this.handleInfo=a,this.anchorInfo=o)}compareInfo(e,r){return e.length===r.length?e.every((i,n)=>{let s=r[n];for(let a in i)if(i[a]!==s[a])return!1;return!0}):!1}isNearBBoxEdge(e){let r=this.anchorInfo.filter(o=>o.type==="bbox").filter((o,l)=>l<4),i=r.length;if(i!==4)return-1;let n=new pr;for(let o of r)n.ext6(o.x,o.y);let s=n.build();if(_i(0,s.area()))return-1;let a=Th();for(let o=0;o<i;o++){let l=o,c=o+1;l===i-1&&(c=0);let u=r[l],d=r[c],A=new pr;if(A.ext6(u.x,u.y).ext6(d.x,d.y).ext7(a),!A.build().isContains1(e.x,e.y))continue;if(Pc(e,u,d).d<a){if(u.index===0&&d.index===1)return 4;if(u.index===1&&d.index===2)return 5;if(u.index===2&&d.index===3)return 6;if(u.index===3&&d.index===0)return 7}}return-1}createLine(e){let r=e.c_helper_lines;if(!r){this.gControlLinesContainer.classList.add("hide");return}let i=r.length;for(let n=0;n<i;n++){let{from:s,to:a,belong:o}=r[n],l={x:e[s*2],y:e[s*2+1]},c={x:e[a*2],y:e[a*2+1]},u=this.controlLineArr[n];Ir(o)&&console.error("check code"),u?ge(u,{x1:l.x,y1:l.y,x2:c.x,y2:c.y,"data-belong":o}):(u=this.createLineEle(l,c),u.dataset.belong=o,this.gControlLinesContainer.appendChild(u),this.controlLineArr.push(u))}this.emptyChildren(i,this.controlLineArr)}createLineEle(e,r){return Hr("line",{class:"hide",x1:e.x,y1:e.y,x2:r.x,y2:r.y,"stroke-width":1,stroke:"var(--highlight)","stroke-dasharray":"3,3"})}createCircleEle(e,r={}){let{x:i,y:n,size:s}=e,a=Ue.scale(s,s).translate(i,n),o=nr.getMatrix6FromMatrix(a);return Hr("circle",{id:e.id,cx:0,cy:0,r:1,fill:"transparent",stroke:"var(--selectColor)",transform:`matrix(${o})`,c_partid:"cdot",class:"handle-dot","vector-effect":"non-scaling-stroke","data-cx":i,"data-cy":n,"data-size":s,...r})}createRhombus(e,r,i){let n=4/X.gZoom*2;return this.createRect(i,e,r,n,45)}createRect(e,r,i,n,s=0){let a=Ue.scale(n,n).rotateD(s).translate(r,i),o=nr.getMatrix6FromMatrix(a);return Hr("rect",{id:e,class:"control-dot",x:-.5,y:-.5,width:1,height:1,c_partid:"cdot","strok-width":1,stroke:"var(--selectColor)",fill:"transparent",transform:`matrix(${o})`,"vector-effect":"non-scaling-stroke","data-x":r,"data-y":i,"data-degree":s})}zoom(e){let r=this.gControlDotsContainer.children;for(let i of r){if(i.id=="insert-anchor"){let s={x:+ge(i,"data-x"),y:+ge(i,"data-y"),size:e,degree:+ge(i,"data-degree")};this.updateDotPosition(i,s);continue}let n=this.findControlDotById(i.id);if(!n)return;n.size=i.nodeName.toLocaleLowerCase()==="circle"?e/2:e,this.updateDotPosition(i,n)}}updateDotPosition(e,r){let{x:i,y:n,size:s,degree:a}=r,o=Ue.scale(s,s).rotateD(a).translate(i,n),l=nr.getMatrix6FromMatrix(o);xr.updateTransform(l,e)}hideAll(){return this.hideAllLines().hideAllHandle(),this.selectedCdotId=null,this}emptyData(){return this.anchorInfo=[],this}},Zo=new k6;var Jd=class Jd{static invoke(e,r){if(Jd.hooks[e])return r?Jd.hooks[e].apply(null,r):Jd.hooks[e].apply();if(e.indexOf("draw(")===0||e.indexOf("place_")===0)return sy(e),!0;{let i=Jd.wildcardHooks;for(let n in i)if(new RegExp(n).test(e))return i[n](e,r);console.error(arguments,"Plz check code")}return!1}};Jd.hooks={},Jd.wildcardHooks={},Jd.registerHook=function(e,r){if(typeof e=="string")if(e.indexOf("*")>=0){let i="^"+e.replace(/\*/g,".*")+"$";Jd.wildcardHooks[i]=r}else Jd.hooks[e]=r;else if(e instanceof RegExp)Jd.wildcardHooks[e]=r;else for(let i of Object.keys(e))Jd.registerHook(i,e[i])};var wS=Jd;var wP=class wP{static add(e){this.stack.push(e),this.stack.length>100&&this.stack.shift()}static get useable(){if(!this.stack.length)return!1;switch(this.stack[this.stack.length-1].type){case 4:case 2:case 3:case 10:case 5:return!!wS.invoke("selectCount");case 1:case 9:return!1;default:return!0}}static get(){return this.stack.length?this.stack[this.stack.length-1]:null}static getJsonCacheByJsonSnapshot(e){let r=e.getPrimitiveHistory(),i=Object();r.forEach(o=>{let[,l,{cmdKey:c},,u]=o;ts(i,c)[l]=vi(u)});let s=e.getCombHistory().map(o=>o[1]),a=new gr().getAllCombinationData(s);for(let o of a)ts(i,"combination")[o.gId]=vi(o);return i}static record(e,r){switch(e){case 0:{r(),wP.add({type:0,data:vi(te.getJsonCacheByIds(mr.getLastRecordPrimitiveIds()))});break}}}};wP.stack=[];var ma=wP,F6={[Ya.draw]:xCe,[Ya.drag]:ECe,[Ya.delete]:wCe,[Ya.rotate]:vCe,[Ya.paste]:SCe,[Ya.duplicateTo]:ICe,[Ya.lock]:TCe,[Ya.eleVisable]:CCe,[Ya.pasteInPlace]:BCe};function gu(t){return function(e){var r;return(r=F6[t])==null||r.call(F6,e),e}}function xCe(t){let{next:e}=t;t.next=function(...r){if(!["draw(origin)"].includes(X.cmdToken)){if(["draw(polygon)","draw(polyline)"].includes(X.cmdToken))return e.call(this,...r);ma.record(0,e.bind(this,...r))}}}function ECe(t){let{onMouseLeftUp:e}=t.prototype;return t.prototype.onMouseLeftUp=function(...r){e.call(this,...r),(this.accumulateX||this.accumulateY)&&ma.add({type:2,movement:new ne(this.accumulateX,this.accumulateY)})},t}function wCe(t){let{do:e}=t.prototype;t.prototype.do=function(...r){let i=e.call(this,...r);return ma.add({type:4}),i}}function vCe(t){let{do:e}=t.prototype;t.prototype.do=function(...r){e.call(this,...r),this.success&&ma.add({type:3,degree:this.degree})}}function CCe(t){let{toggleElementsDisplay:e,toggleVisible:r}=t;t.toggleElementsDisplay=function(...i){e.call(this,...i);let n=i[1];ma.add({type:10,isVisable:n})},t.toggleVisible=function(...i){r.call(this,...i);let n=i[1];ma.add({type:10,isVisable:n})}}function SCe(t){let{onMouseLeftDown:e}=t.prototype;t.prototype.onMouseLeftDown=function(...r){e.call(this,...r),["ctrl_drag_copy","ctrl_drag_copy2"].includes(this.type)?ma.add({type:8,data:ma.getJsonCacheByJsonSnapshot(this.jsonSnapshot),movement:this.accmulate}):ma.add({type:6,data:ma.getJsonCacheByJsonSnapshot(this.jsonSnapshot)})}}function TCe(t){let{unlockAll:e,setCombinationLockStatus:r,setLockStatus:i,setElementsLockStatus:n}=t.prototype;t.prototype.unlockAll=function(...s){e.call(this,...s),ma.add({type:5,locked:!1})},t.prototype.setCombinationLockStatus=function(...s){let a=s[1];r.call(this,...s),ma.add({type:5,locked:a})},t.prototype.setLockStatus=function(...s){let a=s[1];i.call(this,...s),ma.add({type:5,locked:a})},t.prototype.setElementsLockStatus=function(...s){let a=s[1];n.call(this,...s),ma.add({type:5,locked:a})}}function ICe(t){let{do:e}=t;t.do=async function(...r){let i=await e.call(this,...r);return ma.add({type:7,data:vi(ma.getJsonCacheByJsonSnapshot(t.snap)),movement:i.movement}),i}}function BCe(){ma.add({type:11})}var Am=class{constructor(){}renderLine(e,r,i){let n=this.extendLineAttr({id:i,x1:e.x,y1:e.y,x2:r.x,y2:r.y}),s=this.container?this.container.querySelector("#"+i):Hr("line");if(!s)throw new Error("err");return ge(s,n),s}getTextBBox(e){let r=Hr("text",{x:0,y:0});r.textContent=e,parent.document.getElementById("svg-work-space").appendChild(r);let i=r.getBBox();return Cr(r),i}getCircleCommonAttrs(){return{fill:"var(--selectColor)",stroke:"none",class:"key-point"}}renderCircle(e,r,i=this.getCircleCommonAttrs()){let n=this.extendLineAttr({id:r,cx:e.x,cy:e.y,r:4/X.gZoom,fill:"black",...i}),s=this.container?this.container.querySelector("#"+r):Hr("circle");if(!s)throw new Error("err");return ge(s,n),s}extendPoint(e,r,i){let n=new ne(e.x,e.y),s=new ne(r.x,r.y),a=s.angleD(n),o=s.rotateD(n,-a),l=new ne(o.x+i,o.y).rotateD(n,a);return{x:l.x,y:l.y}}createTriangle(e,r,i,n){let s=e.map(o=>new ne(o[0],o[1])).map(o=>o.rotateD(new ne(0,0),r)).map(o=>o.add(i)).map(o=>[o.x,o.y]).flat().join(" "),a=this.container?this.container.querySelector("#"+n):Hr("polyline");return ge(a,this.extendLineAttr({points:s,id:n})),a}extendLineAttr(e){return Object.assign({"stroke-width":1,stroke:"black","vector-effect":"non-scaling-stroke",fill:"none",...e})}};var Ua=class extends Am{constructor(r){super();this.startNextXMove=void 0;this.startNextYMove=void 0;this.endNextXMove=void 0;this.endNextYMove=void 0;this.visible=!0;this.nextTickTasks=[];this.gId=r.gId,this.direction=r.direction,this.category=r.category,this.start=r.start,this.end=r.end,this.staticStart=structuredClone(this.start),this.staticEnd=structuredClone(this.end),this.container=Fe(r.gId);let i=this.start.otherPoint,n=this.end.otherPoint;this.visible=r.visible;let s=new ne(i.x,i.y).distance1(new ne(n.x,n.y));this.distancePixel=s,this.distance=Yl(s)}getId(){return this.gId}getDistance(r=!1){return r?this.distancePixel:this.distance}getCategory(){return this.category}isSelfDimension(){return this.start.id===this.end.id}categoryIsConstraint(){return this.category==="Constraint"}categoryIsAnnotation(){return this.category==="Annotation"}getDirection(){return this.direction}getPrimitiveType(){let{cmdKey:r}=this.end,{cmdKey:i}=this.start;return{primitiveTypeEnd:Fn[r],primitiveTypeStart:Fn[i]}}toJSON(){let r=te.getDimension(this.gId),i={name:"",gId:this.gId,layer:8,cmdKey:"dimension",direction:this.direction,category:this.category,start:structuredClone(this.start),end:structuredClone(this.end)};return Kr(r)?{...i,locked:!1,visible:!0}:(Object.assign(r,i),r)}canMoveX(){return this.direction==="x"||this.direction==="xy"}canMoveY(){return this.direction==="y"||this.direction==="xy"}getPath(){let r=this.renderNodeLine(this.start,this.gId+"-start-line",!0),i=this.renderNodeLine(this.end,this.gId+"-end-line",!0),n=this.renderTextLine(!0),s=this.createStartTriangle(),a=this.createEndTriangle(),o=this.renderText(!0);return{line:r+i+n+["M",ge(s,"points")].join(" ")+["M",ge(a,"points")].join(" "),text:o}}render(r=!1){let i=this.container,n=this.renderNodeLine(this.start,this.gId+"-start-line"),s=this.renderNodeLine(this.end,this.gId+"-end-line"),a=this.renderTextLine(),o=this.renderText(),l=this.createStartTriangle(),c=this.createEndTriangle();if(this.container||(i=Hr("g",{id:this.gId,c_partid:"dimension",layer:8,category:this.category,display:this.visible?"":"none"}),this.container=i,!r&&Ar.appendTargetLayer(i,8),i.appendChild(n),i.appendChild(s),i.appendChild(a),i.appendChild(o),i.appendChild(l),i.appendChild(c)),this.nextTick(),r||Hi.renderer.attr(this.gId,"category",this.category),r)return this.container.outerHTML}makeOtherPointStatic(){this.addNextTickTasks([()=>{this.start.otherPoint=structuredClone(this.staticStart.otherPoint),this.end.otherPoint=structuredClone(this.staticEnd.otherPoint)}])}addNextTickTasks(r){this.nextTickTasks.push(...r)}nextTick(){Promise.resolve().then(()=>{for(let r of this.nextTickTasks)r()})}getSvg(){return this.render(!0)}unmount(){return Hi.renderer.removeNode(this.gId),this}translate(r,i){return this.incrementEndNode(r,i),this.incrementStartNode(r,i),this.start.otherPoint.x+=r,this.start.otherPoint.y+=i,this.end.otherPoint.x+=r,this.end.otherPoint.y+=i,this}updateOtherP(r,i){if(this.direction==="x")this.start.otherPoint.y+=i,this.start.otherPoint.x=this.start.primitivePoint.x,this.end.otherPoint.y+=i,this.end.otherPoint.x=this.end.primitivePoint.x;else if(this.direction==="y")this.start.otherPoint.x+=r,this.start.otherPoint.y=this.start.primitivePoint.y,this.end.otherPoint.x+=r,this.end.otherPoint.y=this.end.primitivePoint.y;else{let n=this.start.otherPoint.x+r,s=this.start.otherPoint.y+i,a=el.calcuPerpendicular(this.start.primitivePoint,this.end.primitivePoint,{x:n,y:s});this.start.otherPoint=a.start,this.end.otherPoint=a.end}this.render()}incrementStartNode(r,i){return this.start.primitivePoint.x+=r,this.start.primitivePoint.y+=i,this}incrementEndNode(r,i){return this.end.primitivePoint.x+=r,this.end.primitivePoint.y+=i,this}updateStartNode(r){return this.start=r,this}updateEndNode(r){return this.end=r,this}updateType(r){return this.direction=r,this}renderNodeLine(r,i,n=!1){i=i!=null?i:r.id;let s=this.extendPoint(r.primitivePoint,r.otherPoint,10);return n?["M",s.x,s.y,r.primitivePoint.x,r.primitivePoint.y].join(" "):this.renderLine(s,r.primitivePoint,i)}renderTextLine(r=!1){let i=this.start.otherPoint,n=this.end.otherPoint;return r?["M",i.x,i.y,n.x,n.y].join(" "):this.renderLine(i,n,this.gId+"-text-line")}createEndTriangle(){let r=new ne(this.start.otherPoint.x,this.start.otherPoint.y),i=new ne(this.end.otherPoint.x,this.end.otherPoint.y),n=i.angleD(r);return this.createTriangle([[-5,-5],[0,0],[-5,5]],n,i,this.gId+"-end-triangle")}createStartTriangle(){let r=new ne(this.start.otherPoint.x,this.start.otherPoint.y),n=new ne(this.end.otherPoint.x,this.end.otherPoint.y).angleD(r);return this.createTriangle([[5,-5],[0,0],[5,5]],n,r,this.gId+"-start-triangle")}getTextMatrix(){let r=this.container?this.container.querySelector("text"):Hr("text",{x:0,y:0}),i=this.start.otherPoint,n=this.end.otherPoint,s=new ne(i.x,i.y).distance1(new ne(n.x,n.y)),a=Sr(Yl(s),2);this.distance=a,r.textContent=a+"mm";let o=r.getBBox();!o.width&&!o.height&&(o=this.getTextBBox(r.textContent));let l={x:(i.x+n.x)/2,y:(i.y+n.y)/2},c=new ne(i.x,i.y),u=new ne(n.x,n.y).angleD(c);n.x<i.x&&(c=new ne(n.x,n.y),u=new ne(i.x,i.y).angleD(c));let d=Ue.translate(l.x-o.width/2,l.y-o.height/2).rotateD(u).setOrigin(l.x,l.y);return d=d.multiply3(Ue.scale(.5,.5).setOrigin(l.x,l.y)),{bbox:o,matrix:d,text:r}}getTextBBoxOutline(){let{matrix:r,bbox:i}=this.getTextMatrix(),n=Mr.extendRect(i),s=[];for(let a of[n.LL(),n.UL(),n.UR(),n.LR()])s.push(a.multiply3(r));return s}renderText(r=!1){let{matrix:i,text:n}=this.getTextMatrix();if(r)return{textContent:n.textContent,m3:i};let s=nr.getMatrix6FromMatrix(i);return xr.updateTransform(s,n),n}updateDistance(r){let i=new ne(this.start.otherPoint.x,this.start.otherPoint.y),n=new ne(this.end.otherPoint.x,this.end.otherPoint.y),s=this.end.id,a=this.start.id;if(this.end.otherPoint.x<this.start.otherPoint.x){let u=i;i=n,n=u,s=this.start.id,a=this.end.id}if(this.direction==="y"&&this.end.otherPoint.y>this.start.otherPoint.y){let u=i;i=n,n=u,s=this.start.id,a=this.end.id}let o=n.angleD2(i);this.direction==="xy"&&o===0&&(o=new ne(this.start.primitivePoint.x,this.start.primitivePoint.y).angleD2(i)+90);let l=new ne(r+i.x,i.y).rotateD(i,o);return{offset:{dx:l.x-n.x,dy:l.y-n.y},moveElementId:s,staticElementId:a}}};var fm=class{async getPath(e,r){r=r||{},r.fontFamily=r.fontFamily||"Arial",r.fontSize=+r.fontSize||12,r.fontWeight=r.fontWeight||"normal",r.fontStyle=r.fontStyle||"normal",r.underline=r.underline||"none";let i=e.split(`
`),n=new Array,s=0,a=0,o=0,l=new Array,c=r.fontSize;for(let f=0,p=i.length;f<p;f++){let m=i[f];if(m.length==0){a+=c;continue}if(Gf){let y=(await X.windowBridge.rpcCall("/engine/extractFontBezier",[m,{"font-family":r.fontFamily,"font-size":r.fontSize,"font-weight":r.fontWeight,"font-style":r.fontStyle,"text-decoration":r.underline}],ur())).message,g=y[0],b=y[1],E=y[2];s=Math.max(s,b),o=a;let w=new pu(x=>(l.push(x),!0),!1);g.forEach(x=>x.forEach(I=>w.parse(I))),a+=E}else{let y=(await X.windowBridge.rpcCall("/engine/extractFont",[m,{"font-family":r.fontFamily,"font-size":r.fontSize,"font-weight":r.fontWeight,"font-style":r.fontStyle,"text-decoration":r.underline}],ur())).message,g=y[0],b=y[1],E=y[2];c=E,s=Math.max(s,b),o=a,g.forEach(w=>{for(let x of w)for(let I=0,C=x.ys.length;I<C;I++)x.ys[I]-=o,r.x&&(x.xs[I]+=+r.x),r.y&&(x.ys[I]-=+r.y);n.push(w)}),a+=E}}let u=n.length;for(let f=0;f<u;f++)n[f].forEach(m=>{let y=m.xs.length,g=[];for(let E=0;E<y;E++){let w=new ne(this.toFix(m.xs[E],5),this.toFix(m.ys[E],5));g.push(w)}let b=Fr.build4(g);l.push(b)});let d=Ue.translate(0,o);l=l.map(f=>f.multiply3(d));let A=ql(l,!1),h=new Mr(0,s,0,a);return{d:A,bbox:h}}toFix(e,r=1){let i=Math.pow(10,r);return Math.round(e*i)/i}};function Sq(t={}){let e={title:"State",allKey:"all-state",lists:[{key:"all-state",title:"All"},{key:"visible",title:"Valid(Valid = Yes)",checked:!0,visible:!0},{key:"hide",title:"Not Valid(Valid = No)",checked:!0,visible:!0},{key:"lock",title:"Lock(Lock = Yes)",checked:!0,visible:!0},{key:"unlock",title:"Unlocked(Lock = No)",checked:!0,visible:!0}]};for(let r of e.lists)$t(t,r.key)&&Object.assign(r,t[r.key]);return e}function Tq(){return{title:"The element type",allKey:"all-element-type",lists:[{key:"all-element-type",title:"All"},{key:"group",title:"Shape",checked:!0,visible:!0},{key:"rect",title:"Rect",checked:!0,visible:!0},{key:"ellipse",title:"Ellipse",checked:!0,visible:!0},{key:"arc",title:"Elliptical Arc",checked:!0,visible:!0},{key:"text",title:"Text",checked:!0,visible:!0},{key:"obj",title:"Image",checked:!0,visible:!0},{key:"auxiliaryLine",title:"Auxiliary",checked:!0,visible:!0},{key:"dimension",title:"Smart Dimension",checked:!0,visible:!0},{key:"dimensionLength",title:"Dimension",checked:!0,visible:!0}]}}var CS={Common:[Sq({lock:{checked:!1}}),Tq()],"Hide inactive elements":[Sq({hide:{visible:!1}}),Tq()]},QA={checked:!0,visible:!0},ZQe={"all-state":{visible:{...QA},hide:{...QA},lock:{visible:!0,checked:!1},unlock:{...QA}},"all-element-type":{obj:{...QA},group:{...QA},rect:{...QA},ellipse:{...QA},text:{...QA},arc:{...QA},auxiliaryLine:{...QA},dimension:{...QA},dimensionLength:{...QA}}},SP={};for(let t of CS.Common){let e=SP[t.allKey]={};for(let r of t.lists)e[r.key]={...r}}function $u(){return SP}function SS(t){return{auxiliaryPoint:"auxiliaryLine",dimensionAngle:"dimensionLength",dimensionRadius:"dimensionLength"}[t]||t}function $d(t){if(typeof t=="number")switch(Sr(Cs(t))){case 0:case 180:case 360:return"horizontal";case 90:case 270:return"vertical";default:return null}else switch(t){case"place_auxiliary(horizontalLine)":return"horizontal";case"place_auxiliary(verticalLine)":return"vertical";case"place_auxiliary(crossLine)":return"cross";default:return null}}function sb(t,e,r,i=m_){let n=new ne(t,e),s=n.add1(1,0).rotateD(n,r),a=n.add1(-1,0).rotateD(n,r),o=a.sub(s).normalize();return s=n.sub(o.mul(i)),a=n.add(o.mul(i)),new Ee(s,a)}function TP(t,e){if(t.length!==0)for(let r of t){let{data:i,view:n}=r;_Ce(i,e),PCe(n,{x:i.x1,y:i.y1},{x:i.x2,y:i.y2})}}function _Ce(t,e){let r={x:t.x1,y:t.y1},i={x:t.x2,y:t.y2},n=[[{x:e.minX,y:e.minY},{x:e.maxX,y:e.minY}],[{x:e.maxX,y:e.minY},{x:e.maxX,y:e.maxY}],[{x:e.minX,y:e.maxY},{x:e.maxX,y:e.maxY}],[{x:e.minX,y:e.minY},{x:e.minX,y:e.maxY}]],s=[];for(let a of n){let o=v_(r,i,a[0],a[1]);if(o&&s.push(o),s.length===2){t.x1=s[0].x,t.x2=s[1].x,t.y1=s[0].y,t.y2=s[1].y;return}}}function PCe(t,e,r){t==null||t.setAttribute("x1",String(e.x)),t==null||t.setAttribute("x2",String(r.x)),t==null||t.setAttribute("y1",String(e.y)),t==null||t.setAttribute("y2",String(r.y))}function IP(t){switch($d(t)){case"horizontal":return"Horizontal Auxiliary Line";case"vertical":return"Vertical Auxiliary Line";default:return"Auxiliary Line"}}function Z2(t,e){t.setAttribute("r",String(e))}var ga=class t extends Am{constructor(r){super();this.layer=8;this.locked=!1;this.visible=!0;this.rotation=0;this.startDotSelected=!1;this.endDotSelected=!1;this.textDotSelected=!1;this.angleDotSelected=!1;this.arcOffsetX=20;this.name=r.name,this.gId=r.gId,this.x1=r.x1,this.y1=r.y1,this.x2=r.x2,this.y2=r.y2,this.textX=r.textX,this.textY=r.textY,this.angleX=r.angleX,this.angleY=r.angleY,zu(r.visible)&&(r.visible=!0),this.visible=r.visible,zu(r.rotation)&&(r.rotation=0),this.rotation=r.rotation,this.container=r.gId&&document.getElementById(r.gId)}getContainer(){return this.render(),this.container}setAngle(r,i){return this.angleX=r,this.angleY=i,this.calcuTextDot(),this}vectorAngle(){return new ne(this.angleX,this.angleY)}setStart(r,i){return this.x1=r,this.y1=i,this}vectorStart(){return new ne(this.x1,this.y1)}getStartAngle(){let r=this.vectorStart().angleD2(this.vectorAngle());return Cs(r)}getEndAngle(){let r=this.vectorEnd().angleD2(this.vectorAngle());return Cs(r)}setEnd(r,i){return this.x2=r,this.y2=i,this}vectorEnd(){return new ne(this.x2,this.y2)}setTextPosition(r,i){this.textX=r,this.textY=i}toData(){let r={gId:this.gId,cmdKey:"dimensionAngle",layer:this.layer,name:this.name,locked:this.locked,x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2,textX:this.textX,textY:this.textY,angleX:this.angleX,angleY:this.angleY,visible:this.visible,rotation:this.rotation},i=te.getDimensionAngle(this.gId);return Kr(i)?r:(Object.assign(i,r),i)}setData(){let r=this.toData();return te.setDimension(r.gId,r,"dimensionAngle"),this}translate(r,i){return this.x1+=r,this.y1+=i,this.x2+=r,this.y2+=i,this.angleX+=r,this.angleY+=i,this.calcuTextDot(),this}getBBox(){let r=new pr;r.ext2(this.vectorStart()),r.ext2(this.vectorEnd()),r.ext2(this.vectorAngle());let i=r.build();return{x:i.minX,y:i.minY,width:i.width(),height:i.height()}}rotateSelf(r,i){if(!i){let l=this.getBBox();i=new ne(l.x+l.width/2,l.y+l.height/2)}let n=r-this.rotation;if(n===0)return;let s=this.vectorAngle().rotateD(i,n);this.setAngle(s.x,s.y);let a=this.vectorStart().rotateD(i,n);this.setStart(a.x,a.y);let o=this.vectorEnd().rotateD(i,n);return this.setEnd(o.x,o.y),this.rotation=r,this.calcuTextDot().setData().render(),this}flipH(r){if(Ir(r)){let o=this.getBBox();r=new ne(o.x+o.width/2,o.y+o.height/2)}let i=Ue.MIRROR_X.setOrigin(r.x,0),n=this.vectorAngle().multiply3(i);this.setAngle(n.x,n.y);let s=this.vectorStart().multiply3(i);this.setStart(s.x,s.y);let a=this.vectorEnd().multiply3(i);return this.setEnd(a.x,a.y),this.calcuTextDot().setData().render(),this}flipV(r){if(Ir(r)){let o=this.getBBox();r=new ne(o.x+o.width/2,o.y+o.height/2)}let i=Ue.MIRROR_Y.setOrigin(0,r.y),n=this.vectorAngle().multiply3(i);this.setAngle(n.x,n.y);let s=this.vectorStart().multiply3(i);this.setStart(s.x,s.y);let a=this.vectorEnd().multiply3(i);return this.setEnd(a.x,a.y),this.calcuTextDot().setData().render(),this}getPath(){let r=this.renderText(!0),i=this.renderStartLine(!0),n=this.renderEndLine(!0),s=this.renderArc(!0);return{line:i+n+s,text:r}}render(r=!1){let i=this.renderText(),n=this.renderStartLine(),s=this.renderEndLine(),a=this.renderArc(),o=this.renderAngleCircle(),l=this.renderStartCircle(),c=this.renderEndCircle(),u=this.renderTextCircle();if(!this.container){let d=Hr("g",{id:this.gId,c_partid:"dimensionAngle",class:"dimensionAngle",layer:8,display:this.visible?"":"none"});this.container=d,r===!1&&Ar.appendTargetLayer(d,8,!0,{cmdKey:"dimensionAngle"}),d.appendChild(n),d.appendChild(s),d.appendChild(i),d.appendChild(a),d.appendChild(o),d.appendChild(l),d.appendChild(c),d.appendChild(u)}return this.container.outerHTML}nextTick(r){return Promise.resolve().then(()=>{r(this.container)}),this}getSvg(){return this.render(!0)}getCircleId(r){return{start:this.gId+"-start-circle",end:this.gId+"-end-circle",text:this.gId+"-text-circle",angle:this.gId+"-angle-circle"}[r]}renderStartCircle(){let r=this.getCircleId("start");return this.renderCircle(this.vectorStart(),r)}renderEndCircle(){let r=this.getCircleId("end");return this.renderCircle(this.vectorEnd(),r)}renderTextCircle(){let r=this.getCircleId("text");return this.renderCircle(this.vectorTextDot(),r)}renderAngleCircle(){let r=this.getCircleId("angle");return this.renderCircle(this.vectorAngle(),r)}unmount(){Cr(this.container)}calcuAngle(){let r=C_(this.vectorStart(),this.vectorAngle(),this.vectorEnd())||0,i=mu.toDegrees(r);return Sr(i,2)}setAngleDeg(r){let i=this.vectorEnd().rotateD(this.vectorAngle(),-this.getEndAngle()).rotateD(this.vectorAngle(),this.getStartAngle()+ +r);return this.setEnd(i.x,i.y),this.calcuTextDot(),this}calcuTextDot(){let r=this.arcOffsetX+10,i={x:this.angleX+r,y:this.angleY},n=(this.getEndAngle()+this.getStartAngle())/2;return Math.abs(this.getEndAngle()-this.getStartAngle())>180&&(n=n+180),i=new ne(i.x,i.y).rotateD(this.vectorAngle(),n),this.textX=i.x,this.textY=i.y,this}getTextMatrix(){let r=this.calcuAngle(),i=this.container?this.container.querySelector("text"):Hr("text",{x:0,y:0}),n=i.getBBox();return!n.width&&!n.height&&(n=this.getTextBBox(i.textContent)),i.textContent=r+"\xB0",{matrix:Ue.scale(.5,.5).translate(this.textX,this.textY),text:i,bbox:n}}getTextBBoxOutline(){let{matrix:r,bbox:i}=this.getTextMatrix(),n=Mr.extendRect(i),s=[];for(let a of[n.LL(),n.UL(),n.UR(),n.LR()])s.push(a.multiply3(r));return s}renderText(r=!1){let{text:i,matrix:n}=this.getTextMatrix(),s=nr.getMatrix6FromMatrix(n);return r?{m3:n,textContent:i.textContent}:(xr.updateTransform(s,i),i)}renderStartLine(r=!1){let i=this.vectorStart(),n=this.vectorAngle();return r?["M",i.x,i.y,n.x,n.y].join(" "):this.renderLine(i,n,this.gId+"-start-line")}renderEndLine(r=!1){let i=this.vectorEnd(),n=this.vectorAngle();return r?["M",i.x,i.y,n.x,n.y].join(" "):this.renderLine(i,n,this.gId+"-end-line")}vectorTextDot(){return new ne(this.textX,this.textY)}renderArc(r=!1){let i=this.arcOffsetX,n=["M"],s=new ne(this.angleX+i,this.angleY),a=s.rotateD(this.vectorAngle(),this.getStartAngle()),o=s.rotateD(this.vectorAngle(),this.getEndAngle()),l=this.getEndAngle()-this.getStartAngle();l=Cs(l);let c=0,u=l>0&&l<=180?1:0;if(n.push(a.x,a.y,"A",i,i,0,c,u,o.x,o.y),r)return n.join(" ");let d=this.extendLineAttr({id:this.gId+"-arc",d:n.join(" ")}),A=this.container?this.container.querySelector("path"):Hr("path");return ge(A,d),A}findContainsControlPoint(r,i){let n=5/X.gZoom;return Qd(r,i,this.x1,this.y1,n)?this.getCircleId("start"):Qd(r,i,this.x2,this.y2,n)?this.getCircleId("end"):Qd(r,i,this.textX,this.textY,n)?this.getCircleId("text"):Qd(r,i,this.angleX,this.angleY,n)?this.getCircleId("angle"):!1}setControlDotSelected(r){switch(r){case this.getCircleId("start"):this.startDotSelected=!0;break;case this.getCircleId("end"):this.endDotSelected=!0;break;case this.getCircleId("text"):this.textDotSelected=!0;break;case this.getCircleId("angle"):this.angleDotSelected=!0;break;default:break}return this}moveControlPoint(r,i){return this.startDotSelected&&(this.x1+=r,this.y1+=i,this.calcuTextDot()),this.endDotSelected&&(this.x2+=r,this.y2+=i,this.calcuTextDot()),this.textDotSelected&&(this.textX+=r,this.textY+=i),this.angleDotSelected&&(this.angleX+=r,this.angleY+=i,this.calcuTextDot()),this.setData(),this}static zoom(){te.iteratorDimensionAngle(r=>{let i=new t(r).render();i=null})}};var ya=class t extends Am{constructor(r){super();this.startSelected=!1;this.endSelected=!1;this.textSelected=!1;this.layer=8;this.name="";this.locked=!1;this.visible=!0;this.rotation=0;this.measureStart={x:0,y:0};this.measureEnd={x:0,y:0};this.name=r.name,this.gId=r.gId,this.x1=r.x1,this.y1=r.y1,this.measureStart.x=r.measureX1,this.measureStart.y=r.measureY1,this.x2=r.x2,this.y2=r.y2,this.measureEnd.x=r.measureX2,this.measureEnd.y=r.measureY2,Ir(r.measureX1)||this.initTextPosition(),this.direction=r.direction,this.container=r.gId&&document.getElementById(r.gId),zu(r.visible)&&(r.visible=!0),this.visible=r.visible,zu(r.rotation)&&(r.rotation=0),this.rotation=r.rotation}updateDirection(){this.measureStart.x==this.x1?this.direction="x":this.measureStart.y==this.y1?this.direction="y":this.direction="xy"}calcuDirection(){let r="xy",i=(this.textX-this.x1)*(this.textX-this.x2)<0,n=(this.textY-this.y1)*(this.textY-this.y2)<0;return i&&n?r="xy":i?r="x":n&&(r="y"),this.direction=r,this.calcuMeasurePoint(),this}calcuMeasurePoint(){let r=this.direction;if(r==="x")this.measureStart={x:this.x1,y:this.textY},this.measureEnd={x:this.x2,y:this.textY};else if(r==="y")this.measureStart={x:this.textX,y:this.y1},this.measureEnd={x:this.textX,y:this.y2};else if(r==="xy"){let{start:i,end:n}=el.calcuPerpendicular(this.vectorStart(),this.vectorEnd(),{x:this.textX,y:this.textY});this.measureStart=i,this.measureEnd=n}return this.initTextPosition(),this}initTextPosition(){let{x:r,y:i}=this.getMidTextPoint();return this.textX=r,this.textY=i,this}toData(){let r={x1:this.x1,y1:this.y1,measureX1:this.measureStart.x,measureY1:this.measureStart.y,x2:this.x2,y2:this.y2,measureX2:this.measureEnd.x,measureY2:this.measureEnd.y,direction:this.direction,gId:this.gId,cmdKey:"dimensionLength",name:this.name,locked:this.locked,layer:this.layer,visible:this.visible,rotation:this.rotation},i=te.getDimensionLength(this.gId);return Kr(i)?r:(Object.assign(i,r),i)}setData(){return te.setDimension(this.gId,this.toData(),"dimensionLength"),this}setStart(r,i){return this.x1=r,this.y1=i,this}vectorStart(){return new ne(this.x1,this.y1)}setEnd(r,i){return this.x2=r,this.y2=i,this}vectorEnd(){return new ne(this.x2,this.y2)}setTextPosition(r,i){return this.textX=r,this.textY=i,this}unmount(){Cr(this.container)}getContainer(){return this.render(),this.container}translate(r,i){return this.x1+=r,this.y1+=i,this.measureStart.x+=r,this.measureStart.y+=i,this.x2+=r,this.y2+=i,this.measureEnd.x+=r,this.measureEnd.y+=i,this}rotateSelf(r,i){let n=r-this.rotation;if(n===0)return;let s=Lc([this.x1,this.y1,this.x2,this.y2,this.measureStart.x,this.measureStart.y,this.measureEnd.x,this.measureEnd.y],n,i.x,i.y);return this.setStart(s[0],s[1]),this.setEnd(s[2],s[3]),this.measureStart={x:s[4],y:s[5]},this.measureEnd={x:s[6],y:s[7]},this.initTextPosition(),this.rotation=r,this.updateDirection(),this.setData().render(),this}multiply3(r){let i=this.vectorStart().multiply3(r);this.setStart(i.x,i.y);let n=this.vectorEnd().multiply3(r);this.setEnd(n.x,n.y);let s=new ne(this.textX,this.textY).multiply3(r);return this.setTextPosition(s.x,s.y),this.calcuMeasurePoint(),this.setData().render(),this}updateMeasurePoint(r,i){if(this.direction==="y")this.measureStart.y=this.y1,this.measureEnd.y=this.y2,this.textSelected&&(this.measureStart.x+=r,this.measureEnd.x+=r);else if(this.direction==="x")this.measureStart.x=this.x1,this.measureEnd.x=this.x2,this.textSelected&&(this.measureStart.y+=i,this.measureEnd.y+=i);else if(this.direction==="xy"){let n=this.textX,s=this.textY,{start:a,end:o}=el.calcuPerpendicular(this.vectorStart(),this.vectorEnd(),{x:n,y:s});this.measureStart=a,this.measureEnd=o}}moveControlPoint(r,i){return this.startSelected&&(this.x1+=r,this.y1+=i),this.endSelected&&(this.x2+=r,this.y2+=i),this.textSelected&&(this.textX+=r,this.textY+=i),this.updateMeasurePoint(r,i),this.setData(),this}getPath(){let r=this.renderTextLine(!0),i=this.renderStartLine(!0),n=this.renderEndLine(!0),s=this.createStartTriangle(!0),a=this.createEndTriangle(!0);return{line:r+i+n+s+a,text:this.renderText(!0)}}render(r=!1){let i=this.renderText(),n=this.renderTextLine(),s=this.renderStartLine(),a=this.renderEndLine(),o=this.createStartTriangle(),l=this.createEndTriangle(),c=this.createStartCircle(),u=this.createEndCircle(),d=this.createTextCircle();if(!this.container){let A=Hr("g",{id:this.gId,class:"dimensionLength",c_partid:"dimensionLength",layer:8,display:this.visible?"":"none"});this.container=A,!r&&Ar.appendTargetLayer(A,8,!0,{cmdKey:"dimensionLength"}),A.appendChild(n),A.appendChild(s),A.appendChild(a),A.appendChild(i),A.appendChild(o),A.appendChild(l),A.appendChild(c),A.appendChild(u),A.appendChild(d)}if(r)return this.container.outerHTML}getSvg(){return this.render(!0)}getEndPoint(){return{x:this.x2,y:this.y2}}renderTextLine(r=!1){let i=this.measureStart,n=this.measureEnd;return r?["M",i.x,i.y,"L",n.x,n.y].join(" "):this.renderLine(i,n,this.gId+"-text-line")}createEndTriangle(r=!1){let i=new ne(this.measureStart.x,this.measureStart.y),n=new ne(this.measureEnd.x,this.measureEnd.y),s=n.angleD(i),a=this.createTriangle([[-5,-5],[0,0],[-5,5]],s,n,this.gId+"-end-triangle");return r?"M"+ge(a,"points"):a}getMidTextPoint(){return{x:(this.measureStart.x+this.measureEnd.x)/2,y:(this.measureStart.y+this.measureEnd.y)/2}}setControlDotSelected(r){switch(r){case this.getKeyDotId("start"):this.startSelected=!0;break;case this.getKeyDotId("end"):this.endSelected=!0;break;case this.getKeyDotId("text"):this.textSelected=!0;break}}findContainsControlPoint(r,i){let n=5/X.gZoom,s=this.getMidTextPoint();return Qd(r,i,s.x,s.y,n)?this.getKeyDotId("text"):Qd(r,i,this.x1,this.y1,n)?this.getKeyDotId("start"):Qd(r,i,this.x2,this.y2,n)?this.getKeyDotId("end"):!1}getKeyDotId(r){return{start:this.gId+"-start-circle",end:this.gId+"-end-circle",text:this.gId+"-text-circle"}[r]}createStartCircle(){return this.renderCircle(this.vectorStart(),this.getKeyDotId("start"))}createEndCircle(){return this.renderCircle(this.getEndPoint(),this.getKeyDotId("end"))}createTextCircle(){let r={x:(this.measureStart.x+this.measureEnd.x)/2,y:(this.measureStart.y+this.measureEnd.y)/2};return this.renderCircle(r,this.getKeyDotId("text"))}createStartTriangle(r=!1){let i=new ne(this.measureStart.x,this.measureStart.y),s=new ne(this.measureEnd.x,this.measureEnd.y).angleD(i),a=this.createTriangle([[5,-5],[0,0],[5,5]],s,i,this.gId+"-start-triangle");return r?"M"+ge(a,"points"):a}renderStartLine(r=!1){let i=this.vectorStart(),n=this.measureStart;return Oc(i,n)||(n=this.extendPoint(i,n,10)),r?["M",i.x,i.y,"L",n.x,n.y].join(" "):this.renderLine(i,n,this.gId+"-start-line")}renderEndLine(r=!1){let i=this.getEndPoint(),n=this.measureEnd;return Oc(i,n)||(n=this.extendPoint(i,n,10)),r?["M",i.x,i.y,"L",n.x,n.y].join(" "):this.renderLine(i,n,this.gId+"-end-line")}calcLengthPixel(){return MC(this.measureStart,this.measureEnd)}getTextMatrix(){let r=this.container?this.container.querySelector("text"):Hr("text",{x:0,y:0}),i=this.calcLengthPixel(),n=this.measureStart,s=this.measureEnd,a=Sr(Yl(i),2);r.textContent=a+"mm";let o=r.getBBox();!o.width&&!o.height&&(o=this.getTextBBox(r.textContent));let l={x:(n.x+s.x)/2,y:(n.y+s.y)/2},c=new ne(n.x,n.y),u=new ne(s.x,s.y).angleD(c);s.x<n.x&&(c=new ne(s.x,s.y),u=new ne(n.x,n.y).angleD(c));let d=Ue.translate(l.x-o.width/2,l.y-o.height/2).rotateD(u).setOrigin(l.x,l.y);return d=d.multiply3(Ue.scale(.5,.5).setOrigin(l.x,l.y)),{text:r,matrix:d,bbox:o}}getTextBBoxOutline(){let{matrix:r,bbox:i}=this.getTextMatrix(),n=Mr.extendRect(i),s=[];for(let a of[n.LL(),n.UL(),n.UR(),n.LR()])s.push(a.multiply3(r));return s}renderText(r=!1){let{text:i,matrix:n}=this.getTextMatrix();if(r)return{m3:n,textContent:i.textContent};let s=nr.getMatrix6FromMatrix(n);return xr.updateTransform(s,i),i}updateDistance(r){let i=new ne(this.measureStart.x,this.measureStart.y),n=new ne(this.measureEnd.x,this.measureEnd.y),s=n.angleD2(i);this.direction==="xy"&&s===0&&(s=new ne(this.x1,this.y1).angleD2(i)+90);let a=new ne(r+i.x,i.y).rotateD(i,s),o={dx:a.x-n.x,dy:a.y-n.y};return this.measureEnd.x+=o.dx,this.measureEnd.y+=o.dy,this.x2+=o.dx,this.y2+=o.dy,this}static zoom(){te.iteratorDimensionLength(r=>{let i=new t(r).render();i=null})}};var bl=class{static dotProd1(e,r,i,n){return e*i+r*n}static dotProd2(e,r,i,n,s,a){return this.dotProd1(i-e,n-r,s-i,a-n)}static dotProd3(e,r,i){return this.dotProd2(e.x,e.y,r.x,r.y,i.x,i.y)}static crossProd1(e,r,i,n){return e*n-r*i}static crossProd2(e,r,i,n,s,a){return this.crossProd1(i-e,n-r,s-i,a-n)}static crossProd3(e,r,i){return this.crossProd2(e.x,e.y,r.x,r.y,i.x,i.y)}static distance2(e,r,i,n){let s=i-e,a=n-r;return s*s+a*a}static distance1(e,r,i,n){return this.hypot(i-e,n-r)}static distance1p(e,r){return this.distance1(e.x,e.y,r.x,r.y)}static hypot(e,r){if(e=Math.abs(e),r=Math.abs(r),r>e){var i=r;r=e,e=i}if(e===0)return r;var n=r/e;return e*Math.sqrt(1+n*n)}};var IS=1e-4,Ye=new Float64Array(100);function ip(t,e){if(t instanceof Ee&&e instanceof Ee)return tE(t,e);if(t instanceof ze&&e instanceof Ee)return U6(t,e);if(t instanceof Ee&&e instanceof ze)return U6(e,t);if(t instanceof ze&&e instanceof ze)return NCe(t,e);if(t instanceof Nt&&e instanceof Nt)return BP(t,e);if(t instanceof Nt&&e instanceof Ee)return BP(t,new Nt([e.start(),e.end()]));if(t instanceof Ee&&e instanceof Nt)return BP(new Nt([t.start(),t.end()]),e);if(t instanceof Nt&&e instanceof ze)return Lq(e,t);if(t instanceof ze&&e instanceof Nt)return Lq(t,e);throw new Error("not supported operation")}function Oq(t,e){let r=t.primitives,i=e.primitives,n=r.length>i.length?i:r,s=r.length>i.length?r:i,a=!1;return n.some(o=>(s.some(l=>(a=ip(o,l)>0,a)),a)),a}function Nq(t,e){let r=t.bbox();if(r.isContainsY1(e)){let i=new Ee(new ne(r.minX-1,e),new ne(r.maxX+1,e));return tE(i,t)>0?1:0}else return 0}function Rq(t,e){if(t.rx===t.ry){let r=t.bbox();if(r.isContainsY1(e)){let i=new Ee(new ne(r.minX-1,e),new ne(r.maxX+1,e));return BS(t,i)>0?1:0}else return 0}else throw new Error("not supported operation")}function Mq(t,e){if(t.rx===t.ry){let r=t.bbox();if(r.isContainsY1(e)){let i=new Ee(new ne(r.minX-1,e),new ne(r.maxX+1,e)),n=BS(t,i);return n>0?n:0}else return 0}else throw new Error("not supported operation")}function DS(t,e){let r=t.bbox();return r.isContainsY1(e)&&BP(new Nt([new ne(r.minX-1,e),new ne(r.maxX+1,e)]),t)>0?1:0}function Iq(t,e,r){return isFinite(e)&&isFinite(r)?t.isContains2(e,r):!1}function LCe(t,e){let r=bl.crossProd3(e.start(),e.end(),t.start()),i=bl.crossProd3(e.start(),e.end(),t.end());return Math.abs(r)<1e-8||Math.abs(i)<1e-8||r*i<0}function tE(t,e){let r=t.bbox().intersection1(e.bbox());if(!r)return 0;if(t.isPoint())if(e.isPoint()){let i=r.center();return Ye[0]=i.x,Ye[1]=i.y,2}else return Bq(e,t,r);else{if(e.isPoint())return Bq(t,e,r);{let g=function(b,E){r.isContains2(b,E)&&(Ye[y++]=b,Ye[y++]=E)};if(!LCe(t,e))return 0;let i=t.start().x,n=t.start().y,s=t.end().x,a=t.end().y,o=e.start().x,l=e.start().y,c=e.end().x,u=e.end().y,d=e.length(),A=bl.crossProd2(i,n,o,l,c,u)/d,h=bl.crossProd2(s,a,o,l,c,u)/d;if(A*h>0&&!Rt.eq(A,0)&&!Rt.eq(h,0))return 0;let f=t.length(),p=bl.crossProd2(o,l,i,n,s,a)/f,m=bl.crossProd2(c,u,i,n,s,a)/f;if(p*m>0&&!Rt.eq(p,0)&&!Rt.eq(m,0))return 0;let y=0;if(Rt.eq(A,0)&&Rt.eq(h,0)){let b=r.UL(),E=r.UR(),w=r.LL(),x=r.LR();if(Rt.eq(r.width(),0))Rt.eq(r.height(),0)?(Ye[y++]=b.x,Ye[y++]=b.y):(Ye[y++]=b.x,Ye[y++]=b.y,Ye[y++]=w.x,Ye[y++]=w.y);else if(Rt.eq(r.height(),0))Ye[y++]=b.x,Ye[y++]=b.y,Ye[y++]=E.x,Ye[y++]=E.y;else{let I=jx.area2(b.x,b.y,o,l,c,u),C=jx.area2(E.x,E.y,o,l,c,u);I<C?(Ye[y++]=b.x,Ye[y++]=b.y,Ye[y++]=x.x,Ye[y++]=x.y):(Ye[y++]=E.x,Ye[y++]=E.y,Ye[y++]=w.x,Ye[y++]=w.y)}}else if(Rt.eq(A,0))g(i,n);else if(Rt.eq(h,0))g(s,a);else{let b=Math.abs(A/(A-h));g(i+(s-i)*b,n+(a-n)*b)}return y}}}function Bq(t,e,r){let i=e.start(),n=e.end(),s=t.a*i.x+t.b*i.y+t.c,a=t.a*n.x+t.b*n.y+t.c;if(s*a<0){let o=r.center();return Ye[0]=o.x,Ye[1]=o.y,2}else if(Math.abs(s)<Math.abs(a)){if(Rt.eq(s/Math.sqrt(t.a**2+t.b**2),0))return Ye[0]=i.x,Ye[1]=i.y,2}else if(Rt.eq(a/Math.sqrt(t.a**2+t.b**2),0))return Ye[0]=n.x,Ye[1]=n.y,2;return 0}function BS(t,e){let r=t.bbox().intersection1(e.bbox());if(r!=null){r=r.extendOfSize(IS);let i=t.center.x,n=t.center.y,s=t.rx,a=t.rx2,o=e.start().x,l=e.start().y,c=e.end().x,u=e.end().y,d=t.center.distance1(e.start()),A=t.center.distance1(e.end()),h=Rt.eq(d,s)?0:d>s?1:-1,f=Rt.eq(A,s)?0:A>s?1:-1,p=0;if(h===-1&&f===-1)return 0;if(h===0&&f===0)Ye[p++]=o,Ye[p++]=l,Ye[p++]=c,Ye[p++]=u;else if(h===1&&f===1){let m=pm.foot(e,t.center),y=m.distance1(t.center);if(Rt.greater(y,s))return 0;if(Rt.eq(y,s))Rt.eq(e.distance2(t.start()),0)?(Ye[p++]=t.start().x,Ye[p++]=t.start().y,Ye[p++]=t.start().x,Ye[p++]=t.start().y):Rt.eq(e.distance2(t.end()),0)?(Ye[p++]=t.end().x,Ye[p++]=t.end().y,Ye[p++]=t.end().x,Ye[p++]=t.end().y):(Ye[p++]=m.x,Ye[p++]=m.y,Ye[p++]=m.x,Ye[p++]=m.y);else{p=OCe(i,n,o,l,c,u,p);let g=Ye[p-2],b=Ye[p-1],E=bl.distance1(i,n,g,b);if(p-=2,Rt.eq(E,s))Ye[p++]=g,Ye[p++]=b;else if(E<s)p=Zd(a,i,n,o,l,g,b,p),p=Zd(a,i,n,g,b,c,u,p);else return 0}}else if(h===-1||f===-1)p=Zd(a,i,n,o,l,c,u,p);else{let m=pm.foot(e,t.center),y=m.distance1(t.center);if(Rt.eq(y,s)){let E=function(w){return Iq(r,w.x,w.y)&&Os(t,w)},g=t.start(),b=t.end();if(h===0){let w=e.start();if(E(w))return Ye[p++]=w.x,Ye[p++]=w.y,Ye[p++]=w.x,Ye[p++]=w.y,p;if(E(m))return Ye[p++]=m.x,Ye[p++]=m.y,Ye[p++]=m.x,Ye[p++]=m.y,p;if(Rt.eq(e.distance2(g),0)&&E(g))return Ye[p++]=g.x,Ye[p++]=g.y,Ye[p++]=g.x,Ye[p++]=g.y,p;if(Rt.eq(e.distance2(b),0)&&E(b))return Ye[p++]=b.x,Ye[p++]=b.y,Ye[p++]=b.x,Ye[p++]=b.y,p;if(d<=s)p=Zd(a,i,n,m.x,m.y,c,u,p),p===2&&(Ye[p++]=Ye[0],Ye[p++]=Ye[1]);else if(y<s){if(p=Zd(a,i,n,m.x,m.y,c,u,p),p===2&&E(new ne(Ye[0],Ye[1])))return Ye[p++]=Ye[0],Ye[p++]=Ye[1],p;p=Zd(a,i,n,m.x,m.y,o,l,0),p===2&&(Ye[p++]=Ye[0],Ye[p++]=Ye[1])}}else{let w=e.end();if(E(w))return Ye[p++]=w.x,Ye[p++]=w.y,Ye[p++]=w.x,Ye[p++]=w.y,p;if(E(m))return Ye[p++]=m.x,Ye[p++]=m.y,Ye[p++]=m.x,Ye[p++]=m.y,p;if(Rt.eq(e.distance2(g),0)&&E(g))return Ye[p++]=g.x,Ye[p++]=g.y,Ye[p++]=g.x,Ye[p++]=g.y,p;if(Rt.eq(e.distance2(b),0)&&E(b))return Ye[p++]=b.x,Ye[p++]=b.y,Ye[p++]=b.x,Ye[p++]=b.y,p;if(A<=s)p=Zd(a,i,n,m.x,m.y,o,l,p),p===2&&(Ye[p++]=Ye[0],Ye[p++]=Ye[1]);else if(y<s){if(p=Zd(a,i,n,m.x,m.y,o,l,p),p===2&&E(new ne(Ye[0],Ye[1])))return Ye[p++]=Ye[0],Ye[p++]=Ye[1],p;p=Zd(a,i,n,m.x,m.y,c,u,0),p===2&&(Ye[p++]=Ye[0],Ye[p++]=Ye[1])}}}else if(h===0){let g=e.start();Ye[p++]=g.x,Ye[p++]=g.y,(o-m.x)*(c-m.x)+(l-m.y)*(u-m.y)<0&&(p=Zd(a,i,n,m.x,m.y,c,u,p))}else{let g=e.end();Ye[p++]=g.x,Ye[p++]=g.y,(o-m.x)*(c-m.x)+(l-m.y)*(u-m.y)<0&&(p=Zd(a,i,n,m.x,m.y,o,l,p))}}if(p>0){let m=0;for(let y=0;y<p;y+=2){let g=Ye[y],b=Ye[y+1];isFinite(g)&&isFinite(b)&&Iq(r,g,b)&&Os(t,new ne(g,b))&&(Ye[m++]=g,Ye[m++]=b)}return m}else return 0}else return 0}function Zd(t,e,r,i,n,s,a,o){if(n==a){let b=t-(n-r)*(n-r);if(Rt.greater(b,0)){let E=Math.sqrt(b),w=e-E,x=e+E,I=Math.min(i,s),C=Math.max(i,s);return w>=I&&w<=C&&(Ye[o++]=w,Ye[o++]=n),x>=I&&x<=C&&(Ye[o++]=x,Ye[o++]=n),o}}let l=bl.distance2(i,n,e,r)-t,c=bl.distance2(s,a,e,r)-t,u=i,d=n,A=s,h=a,f=NaN,p=NaN,m=Number.POSITIVE_INFINITY,y=0;for(;m!==0;){y++;let b=Math.max(Math.min(Math.abs(l)/(Math.abs(l)+Math.abs(c)),.75),.25);if(f=u+(A-u)*b,p=d+(h-d)*b,u===f&&d===p||A===f&&h===p){Math.abs(l)>Math.abs(c)?(f=A,p=h,m=c):(f=u,p=d,m=l);break}else m=bl.distance2(f,p,e,r)-t,m<0&&l>c||m>0&&l<c?(A=f,h=p,c=m):(u=f,d=p,l=m)}let g=Math.sqrt(t)-bl.distance1(f,p,e,r);return(Rt.eq(0,m)||Rt.eq(0,g))&&(Ye[o++]=f,Ye[o++]=p),o}function OCe(t,e,r,i,n,s,a){if(bl.crossProd2(r,i,n,s,t,e)==0){let l=bl.dotProd2(r,i,n,s,t,e),c=bl.dotProd2(n,s,r,i,t,e);return l<0&&c<0?(Ye[a++]=t,Ye[a++]=e,a):l>=0?(Ye[a++]=n,Ye[a++]=s,a):(Ye[a++]=r,Ye[a++]=i,a)}else{let l=NaN,c=NaN,u=r,d=i,A=n,h=s,f=bl.distance2(r,i,t,e),p=bl.distance2(n,s,t,e),m=Number.POSITIVE_INFINITY,y=0;for(;m>0&&(y++,l=u+(A-u)*.5,c=d+(h-d)*.5,!(f==p||u==l&&d==c||A==l&&h==c));){m=bl.distance2(l,c,t,e);let g=bl.dotProd2(u,d,l,c,t,e);if(g==0)break;g<0?(A=l,h=c,p=m):(u=l,d=c,f=m)}return Ye[a++]=l,Ye[a++]=c,a}}function U6(t,e){if(t.rx===t.ry)return BS(t,e);throw new Error("not supported")}function NCe(t,e){if(t.bbox().intersection1(e.bbox())!=null){if(t.rx===t.ry&&e.rx===e.ry)return RCe(t,e);throw new Error("not supported operation")}return 0}function RCe(t,e){let r=t.center.x,i=t.center.y,n=e.center.x,s=e.center.y,a=t.rx,o=e.rx,l=t.rx2,c=e.rx2,u=t.center.distance1(e.center),d=Math.abs(a-o),A=a+o;if(Rt.greater(u,A)||Rt.less(u,d))return 0;if(Rt.eq(u,A)){if(Dq(t,e))return 4;let h=new Ee(t.center,e.center),f=BS(e,h);return f=_q(t,f),f!==0?f:(f=BS(t,h),_q(e,f))}else if(Rt.greater(d,0)&&Rt.greater(u,0)&&Rt.eq(u,d)){if(Dq(t,e))return 4;if(a>o){let h=(a-o)/a;return Ye[0]=r+(n-r)/h,Ye[1]=i+(s-i)/h,Pq(t,e,2)}else{let h=(o-a)/o;return Ye[0]=n+(r-n)/h,Ye[1]=s+(i-s)/h,Pq(t,e,2)}}else if(Rt.eq(d,0)&&Rt.eq(u,0)){let h=0,f;return Os(t,e.start())&&(Ye[h]=e.start().x,Ye[h+1]=e.start().y,h+=2,f=e.start()),Os(t,e.end())&&(Ye[h]=e.end().x,Ye[h+1]=e.end().y,h+=2,f=e.end()),h===0?(Os(e,t.start())&&(Ye[h]=t.start().x,Ye[h+1]=t.start().y,h+=2),Os(e,t.end())&&(Ye[h]=t.end().x,Ye[h+1]=t.end().y,h+=2)):h===2&&(!f.equals1(t.start())&&Os(e,t.start())&&(Ye[h]=t.start().x,Ye[h+1]=t.start().y,h+=2),!f.equals1(t.end())&&Os(e,t.end())&&(Ye[h]=t.end().x,Ye[h+1]=t.end().y,h+=2)),h}else{let f=(t.center.distance2(e.center)-c+l)/(u*2)/u,p=(n-r)*f+r,m=(s-i)*f+i,y=n-r,g=s-i,b=Math.max(a,o),E,w,x,I;if(Math.abs(y)<Math.abs(g)){let _=y/-g,H=m-_*p;E=p-b,w=_*E+H,x=p+b,I=_*x+H}else{let _=g/-y,H=p-_*m;w=m-b,E=_*w+H,I=m+b,x=_*I+H}let C=Zd(l,r,i,E,w,p,m,0);if(C=Zd(l,r,i,p,m,x,I,C),C!==4)throw new Error("cnt !== 4");let G=new ne(Ye[0],Ye[1]),U=new ne(Ye[2],Ye[3]);if(Os(t,G)&&Os(e,G))return Os(t,U)&&Os(e,U)?4:ay(t.start(),e,U,G)?(Ye[2]=t.start().x,Ye[3]=t.start().y,4):ay(t.end(),e,U,G)?(Ye[2]=t.end().x,Ye[3]=t.end().y,4):ay(e.start(),t,U,G)?(Ye[2]=e.start().x,Ye[3]=e.start().y,4):ay(e.end(),t,U,G)?(Ye[2]=e.end().x,Ye[3]=e.end().y,4):2;if(Os(t,U)&&Os(e,U))return ay(t.start(),e,G,U)?(Ye[0]=t.start().x,Ye[1]=t.start().y,4):ay(t.end(),e,G,U)?(Ye[0]=t.end().x,Ye[1]=t.end().y,4):ay(e.start(),t,G,U)?(Ye[0]=e.start().x,Ye[1]=e.start().y,4):ay(e.end(),t,G,U)?(Ye[0]=e.end().x,Ye[1]=e.end().y,4):(Ye[0]=Ye[2],Ye[1]=Ye[3],2);{let j=function($,B){if(Rt.eq($.distance1(B.center),B.rx)&&Os(B,$)){if($.distance2(G)<$.distance2(U)){if(_)return;_=!0}else{if(H)return;H=!0}Ye[Q++]=$.x,Ye[Q++]=$.y}},_=!1,H=!1,Q=0;return j(t.start(),e),j(t.end(),e),j(e.start(),t),j(e.end(),t),Q}}}function ay(t,e,r,i){return Rt.eq(t.distance1(e.center),e.rx)&&Os(e,t)&&t.distance2(r)<t.distance2(i)}function Dq(t,e){return Rt.eq(e.start().distance1(t.center),t.rx)&&Os(t,e.start())?(Ye[0]=e.start().x,Ye[1]=e.start().y,Ye[2]=e.start().x,Ye[3]=e.start().y,!0):Rt.eq(e.end().distance1(t.center),t.rx)&&Os(t,e.end())?(Ye[0]=e.end().x,Ye[1]=e.end().y,Ye[2]=e.end().x,Ye[3]=e.end().y,!0):Rt.eq(t.start().distance1(e.center),e.rx)&&Os(e,t.start())?(Ye[0]=t.start().x,Ye[1]=t.start().y,Ye[2]=t.start().x,Ye[3]=t.start().y,!0):Rt.eq(t.end().distance1(e.center),e.rx)&&Os(e,t.end())?(Ye[0]=t.end().x,Ye[1]=t.end().y,Ye[2]=t.end().x,Ye[3]=t.end().y,!0):!1}function _q(t,e){if(e===0)return 0;let r=Ye[0],i=Ye[1];return Os(t,new ne(r,i))?(Ye[0]=r,Ye[1]=i,Ye[2]=r,Ye[3]=i,4):0}function Pq(t,e,r){if(r===0)return 0;let i=Ye[0],n=Ye[1],s=new ne(i,n);return Os(t,s)&&Os(e,s)?(Ye[0]=i,Ye[1]=n,Ye[2]=i,Ye[3]=n,4):0}function eE(t,e){return Math.abs(t-e)<=1e-6}function Os(t,e){let r=t.bbox();if(e.x-r.minX>-IS&&e.x-r.maxX<IS&&e.y-r.minY>-IS&&e.y-r.maxY<IS){let i=mu.regularD(e.angleD(t.center));return eE(i,t.startAngle)||eE(i,t.startAngle+360)||eE(i,t.startAngle-360)||eE(i,t.endAngle())||eE(i,t.endAngle()+360)||eE(i,t.endAngle()-360)?!0:t.sweepAngle>0?(Rt.less(i,t.startAngle)&&(i+=360),Rt.greatereq(t.endAngle(),i)):(Rt.greater(i,t.startAngle)&&(i-=360),Rt.lesseq(t.endAngle(),i))}else return!1}var xl=new Float64Array(100);function BP(t,e){if(t.bbox().extendOfSize(Rt.eps).isSeparated(e.bbox()))return 0;let r=[[t,e]],i=(t.controls.length-1)*(e.controls.length-1)*8,n=0;for(;r.length!==0;){let U=function($){C=Math.min(C,$),G=Math.max(G,$)},Q=function($,B){let M=tE($,B);if(M===0)throw new Error("cnt === 0");for(let v=0;v<M;v+=2)U(Ye[v])};if(n>i){for(let $=n-2;$>=2;$-=2)for(let B=$-2;B>=0;B-=2)if(Rt.eq(xl[$],xl[B])&&Rt.eq(xl[$+1],xl[B+1])){xl[B]=(xl[$]+xl[B])/2,xl[B+1]=(xl[$+1]+xl[B+1])/2;for(let M=n-3;M>=$;M--)xl[M]=xl[M+2];n-=2;break}if(n>i){n=0;let $=e.start(),B=new Float64Array(8);t.getPercent($)!==null&&(B[n++]=$.x,B[n++]=$.y);let M=e.end();t.getPercent(M)!==null&&(B[n++]=M.x,B[n++]=M.y);let v=t.start();e.getPercent(v)!==null&&(B[n++]=v.x,B[n++]=v.y);let N=t.end();return e.getPercent(M)!==null&&(B[n++]=N.x,B[n++]=N.y),Ye.set(B),n}}let[s,a]=r.pop(),o=s.controls,l=a.controls;if(o.length===2&&l.length===2){let $=tE(new Ee(o[0],o[1]),new Ee(l[0],l[1]));for(let B=0;B<$;B++)xl[n++]=Ye[B];continue}let c=o[0],u=o[o.length-1];c.equals1(u)&&(u=c.add1(1,0));let d=u.y-c.y,A=c.x-u.x,h=-d*c.x-A*c.y,f=Math.sqrt(1/(d**2+A**2));d*=f,A*=f,h*=f;let p=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY;if(o.forEach($=>{let B=d*$.x+A*$.y+h;B<p&&(p=B),B>m&&(m=B)}),Rt.eq(p,m)){if(a.controls.length===2){let $=tE(new Ee(s.start(),s.end()),new Ee(a.start(),a.end()));for(let B=0;B<$;B++)xl[n++]=Ye[B];if($!==0)continue}s=new Nt([o[0],o[o.length-1]]),o=s.controls}let y=l.map($=>d*$.x+A*$.y+h),g=0;for(let $ of y){if(Rt.less($,p))g=g|1;else if(Rt.greater($,m))g=g|2;else{g=3;break}if(g===3)break}if(g!==3)continue;let b=0,E=0,w=u.x-c.x,x=u.y-c.y,I=Math.sqrt(1/(w**2+x**2));w*=I,x*=I;for(let $=1;$<o.length;$++){let B=o[$],M=(B.x-c.x)*w+(B.y-c.y)*x;M<b?b=M:M>E&&(E=M)}g=0;for(let $ of l){let B=($.x-c.x)*w+($.y-c.y)*x;if(Rt.less(B,b))g=g|1;else if(Rt.greater(B,E))g=g|2;else{g=3;break}if(g===3)break}if(g!==3)continue;let C=Number.POSITIVE_INFINITY,G=Number.NEGATIVE_INFINITY;p-=Rt.eps,m+=Rt.eps,y.forEach(($,B)=>{$>=p&&$<=m&&U(B/(y.length-1))});let _=new Ee(new ne(0,p),new ne(1,p)),H=new Ee(new ne(0,m),new ne(1,m));for(let $=0;$<y.length-1;$++){let B=new ne($/(y.length-1),y[$]),M=B.y<p?1:B.y>m?2:3;for(let v=0;v<y.length;v++){let N=new ne(v/(y.length-1),y[v]),R=N.y<p?1:N.y>m?2:3;M!==R&&(M===1?R===2?(Q(new Ee(B,N),_),Q(new Ee(B,N),H)):Q(new Ee(B,N),_):M===2?R===1?(Q(new Ee(B,N),_),Q(new Ee(B,N),H)):Q(new Ee(B,N),H):R===1?Q(new Ee(B,N),_):Q(new Ee(B,N),H))}}C!==0&&(a=a.clip(C)[1]),G!==1&&(a=a.clip((G-C)/(1-C))[0]);let j=a.bbox();if(Rt.eq(j.minX,j.maxX)&&Rt.eq(j.minY,j.maxY)){g=0;for(let $ of a.controls){let B=($.x-c.x)*w+($.y-c.y)*x;if(Rt.less(B,b))g=g|1;else if(Rt.greater(B,E))g=g|2;else{g=3;break}if(g===3)break}g===3&&(xl[n++]=(j.minX+j.maxX)/2,xl[n++]=(j.minY+j.maxY)/2);continue}if(G-C>.8){let[$,B]=a.clip(.5);r.push([$,s]),r.push([B,s])}else r.push([a,s])}for(let s=0;s<n;s++)Ye[s]=xl[s];return n}function Lq(t,e){if(t.bbox().extendOfSize(Rt.eps).isSeparated(e.bbox()))return 0;let r=[[t,e]],i=0;for(;r.length!==0;){let n=r.pop();if(n[0]instanceof ze){let C=function(Q){x=Math.min(x,Q),I=Math.max(I,Q)},_=function(Q,j){let $=tE(Q,j);if($===0)throw new Error("cnt === 0");for(let B=0;B<$;B+=2)C(Ye[B])},[s,a]=n,o=a.controls;if(o.length===2){let Q=U6(s,new Ee(o[0],o[1]));for(let j=0;j<Q;j++)xl[i++]=Ye[j];continue}let l=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,u,d,A,h,f;if(Math.abs(s.sweepAngle)>359){let Q=s.rx;u=s.center.add1(Q,0),d=s.center.add1(-Q,0),l=-Q,c=Q,A=0,h=1,f=-s.center.y}else{u=s.start(),d=s.end(),A=d.y-u.y,h=u.x-d.x,f=-A*u.x-h*u.y;let Q=Math.sqrt(1/(A**2+h**2));A*=Q,h*=Q,f*=Q;let j=A*s.center.x+h*s.center.y+f;s.isCCW?(c=s.rx+j,l=0):(l=j-s.rx,c=0)}let p=o.map(Q=>A*Q.x+h*Q.y+f),m=0;for(let Q of p){if(Rt.less(Q,l))m=m|1;else if(Rt.greater(Q,c))m=m|2;else{m=3;break}if(m===3)break}if(m!==3)continue;let y=0,g=0,b=d.x-u.x,E=d.y-u.y,w=Math.sqrt(1/(b**2+E**2));if(b*=w,E*=w,Math.abs(s.sweepAngle)<=180)y=0,g=(d.x-u.x)*b+(d.y-u.y)*E;else throw new Error("not support");m=0;for(let Q of o){let j=(Q.x-u.x)*b+(Q.y-u.y)*E;if(Rt.less(j,y))m=m|1;else if(Rt.greater(j,g))m=m|2;else{m=3;break}if(m===3)break}if(m!==3)continue;let x=Number.POSITIVE_INFINITY,I=Number.NEGATIVE_INFINITY;l-=Rt.eps,c+=Rt.eps,p.forEach((Q,j)=>{Q>=l&&Q<=c&&C(j/(p.length-1))});let G=new Ee(new ne(0,l),new ne(1,l)),U=new Ee(new ne(0,c),new ne(1,c));for(let Q=0;Q<p.length-1;Q++){let j=new ne(Q/(p.length-1),p[Q]),$=j.y<l?1:j.y>c?2:3;for(let B=0;B<p.length;B++){let M=new ne(B/(p.length-1),p[B]),v=M.y<l?1:M.y>c?2:3;$!==v&&($===1?v===2?(_(new Ee(j,M),G),_(new Ee(j,M),U)):_(new Ee(j,M),G):$===2?v===1?(_(new Ee(j,M),G),_(new Ee(j,M),U)):_(new Ee(j,M),U):v===1?_(new Ee(j,M),G):_(new Ee(j,M),U))}}x!==0&&(a=a.clip(x)[1]),I!==1&&(a=a.clip((I-x)/(1-x))[0]);let H=a.bbox();if(Rt.eq(H.minX,H.maxX)&&Rt.eq(H.minY,H.maxY)){m=0;for(let Q of a.controls){let j=(Q.x-u.x)*b+(Q.y-u.y)*E;if(Rt.less(j,y))m=m|1;else if(Rt.greater(j,g))m=m|2;else{m=3;break}if(m===3)break}m===3&&(xl[i++]=(H.minX+H.maxX)/2,xl[i++]=(H.minY+H.maxY)/2);continue}I-x>.8?a.clip(.5).forEach(Q=>r.push([Q,s])):r.push([a,s])}else{let[s,a]=n;r.push([ze.build3(a.center,a.startAngle,a.sweepAngle/2,a.rx,a.ry),s]),r.push([ze.build3(a.center,a.startAngle+a.sweepAngle/2,a.sweepAngle/2,a.rx,a.ry),s])}}for(let n=0;n<i;n++)Ye[n]=xl[n];return i}var pm=class t{constructor(e,r){this.minDistance=Number.MAX_VALUE;this.p=e,this.p1=r,this.intersection()?(this.minDistance=0,this.minline=new Ee(ne.ORIGIN,ne.ORIGIN)):this.minline=this.minLine()}getDistance(){return this.minDistance}getLine(){return this.minline}intersection(){return ip(this.p,this.p1)>0}minLine(){if(this.p instanceof Ee&&this.p1 instanceof Ee){let e=this.p,r=this.p1;return this.minDistanceForLines(e,r,this.minline)}else if(this.p instanceof ze&&this.p1 instanceof Ee){let e=this.p,r=this.p1;return this.minDistanceForLineAndArc(e,r,this.minline)}else if(this.p instanceof Ee&&this.p1 instanceof ze){let e=this.p1,r=this.p;return this.minDistanceForLineAndArc(e,r,this.minline)}else if(this.p instanceof ze&&this.p1 instanceof ze){let e=this.p,r=this.p1;return this.minDistanceForArcs(e,r,this.minline)}return this.minline}minDistanceForLines(e,r,i){let n=[e.start(),e.end(),r.start(),r.end()];for(let s=0;s<n.length;s++)s<2?i=this.point2LineMinLine(i,r,n[s]):i=this.point2LineMinLine(i,e,n[s]);return i}minDistanceForLineAndArc(e,r,i){i=this.point2LineMinLine(i,r,e.start()),i=this.point2LineMinLine(i,r,e.svgEnd);let n=t.foot(r,e.center);return r.bbox().isContains(n)&&(i=this.point2ArcMinLine(i,e,n)),i=this.point2ArcMinLine(i,e,r.start()),i=this.point2ArcMinLine(i,e,r.end()),i}minDistanceForArcs(e,r,i){return i=this.concentricArc(e,r,i),Os(e,r.center)&&Os(r,e.center)?i=this.shortestLineForArcs(e,r,i):(i=this.point2ArcMinDistance(r.start(),e,i),i=this.point2ArcMinDistance(r.svgEnd,e,i),i=this.point2ArcMinDistance(e.start(),r,i),i=this.point2ArcMinDistance(e.svgEnd,r,i)),i}minLineForArcAndLine(e,r,i){let n=e.pointOn(i.angleD(e.center)),s=e.pointOn(e.center.angleD(i));return r=this.arcShortestLine(e,r,i,n),r=this.arcShortestLine(e,r,i,s),r}arcInnerLineFootSegment(e,r,i){let n=i.distance1(e.center);if(n!==0){let s=e.rx*(i.y-e.center.y)/n+e.center.y,a=e.rx*(i.x-e.center.x)/n+e.center.x,o=new Ee(new ne(a,s),i);n=e.rx-n,n<this.minDistance&&(this.minDistance=n,r=o)}else{let s=new Ee(e.start(),i);n=e.rx-n,n<this.minDistance&&(this.minDistance=n,r=s)}return r}shortestLineForArcs(e,r,i){let n=e.center.angleD(r.center),s=r.center.angleD(e.center),a=e.pointOn(n),o=e.pointOn(s),l=r.pointOn(n),c=r.pointOn(s);return Os(e,a)&&(i=this.arcShortestLine(r,i,a,l),i=this.arcShortestLine(r,i,a,c)),Os(e,o)&&(i=this.arcShortestLine(r,i,o,l),i=this.arcShortestLine(r,i,o,c)),i}concentricArc(e,r,i){if(e.center.distance1(r.center)<1e-5&&e.rx===r.rx&&e.ry===r.ry){let n=new Ee(e.start(),r.svgEnd);n.length()<this.minDistance&&(this.minDistance=n.length(),i=n),n=new Ee(r.start(),e.svgEnd),n.length()<this.minDistance&&(this.minDistance=n.length(),i=n)}return i}point2ArcMinDistance(e,r,i){if(Os(r,e)){let n=r.pointOn(e.angleD(r.center)),s=r.pointOn(r.center.angleD(e));i=this.arcShortestLine(r,i,e,n),i=this.arcShortestLine(r,i,e,s)}else i=this.minLineSegment(i,r.start(),e),i=this.minLineSegment(i,r.svgEnd,e);return i}point2ArcMinLine(e,r,i){if(Os(r,i)){let n=i.distance1(r.center);n>r.rx||n>r.ry?e=this.minLineForArcAndLine(r,e,i):e=this.arcInnerLineFootSegment(r,e,i)}return e}point2LineMinLine(e,r,i){let n=t.foot(r,i);return r.bbox().isContains(n)?e=this.minLineSegment(e,n,i):(e=this.minLineSegment(e,r.start(),i),e=this.minLineSegment(e,r.end(),i)),e}minLineSegment(e,r,i){let n=r.distance1(i);return n<this.minDistance&&(this.minDistance=n,e=new Ee(r,i)),e}arcShortestLine(e,r,i,n){if(Os(e,n)){let s=new Ee(i,n),a=s.length();a<this.minDistance&&(this.minDistance=a,r=s)}return r}static foot(e,r){if(e.isPoint())return e.start();if(!Rt.eq(e.b,0)&&!Rt.eq(e.a,0)){let i=(e.b*e.b*r.x-e.a*e.b*r.y-e.a*e.c)/(e.b*e.b+e.a*e.a),n=(-e.a*e.b*r.x+e.a*e.a*r.y-e.b*e.c)/(e.b*e.b+e.a*e.a);return new ne(i,n)}else return Rt.eq(e.b,0)&&!Rt.eq(e.a,0)?new ne(e.start().x,r.y):!Rt.eq(e.b,0)&&Rt.eq(e.a,0)?new ne(r.x,e.start().y):r}};var H6=class{constructor(e,r,i){this._start=null;this._previous=null;this.next=null;this.interInStart=!1;this.intersInEnd=!1;this.othersIntersCount=0;this.shape=e,this.group=r,this.index=i,this._end=e.end()}set previous(e){this._previous=e,this.previous!=null&&(this._start=this.previous.shape.end())}get previous(){return this._previous}get start(){return this._start}get end(){return this._end}getNext(){let e=null,r=this.intersInEnd,i=this.next;for(;r&&i!=this;)if(i.interInStart){e=i;break}else i=i.next;return e}getStartDirect(){if(this.shape instanceof Ee)return this.shape.direct;if(this.shape instanceof ze){let e=this.start.sub(this.shape.center).normalize();return this.shape.sweep()==kl.CCW?new ne(-e.y,e.x):new ne(e.y,-e.x)}else return null}getEndDirect(){if(this.shape instanceof Ee)return this.shape.direct;if(this.shape instanceof ze){let e=this.end.sub(this.shape.center).normalize();return this.shape.sweep()==kl.CCW?new ne(-e.y,e.x):new ne(e.y,-e.x)}else return null}},G6=class{pointInPolyline(e,r){if(!r.bbox().isContains(e))return!1;for(let s of r.primitives)if(this.inEdge(e,s))return!0;if(!this.isClose(r))return!1;let n=[];return r.points(.1,s=>{n.push(s)}),this.isSelect(e.x,e.y,n)}inEdge(e,r){if(r instanceof Ee){let n=pm.foot(r,e).distance1(e);return Rt.eq(n,0)?r.bbox().isContains(e):!1}else if(r instanceof ze){let i=e.distance1(r.center);return Rt.eq(i,r.rx)?Os(r,e):!1}return!1}isSelect(e,r,i){let n=!1;for(let o=0,l=i.length-1;o<l;o++){let c=i[o],u=i[o+1];if(e==c.x&&r==c.y||e==u.x&&r==u.y)return!0;if(c.y<r&&u.y>=r||c.y>=r&&u.y<r){let d=c.x+(r-c.y)*(u.x-c.x)/(u.y-c.y);if(e==d)return!0;d>e&&(n=!n)}}let s=i[i.length-1],a=i[0];if(e==s.x&&r==s.y||e==a.x&&r==a.y)return!0;if(s.y<r&&a.y>=r||s.y>=r&&a.y<r){let o=s.x+(r-s.y)*(a.x-s.x)/(a.y-s.y);if(e==o)return!0;o>e&&(n=!n)}return n}isClose(e){return e.primitives.length>0&&e.primitives[0].start().distance2(e.primitives[e.primitives.length-1].end())<1e-8}map2Sides(e,r){let i=new Array,n=0,s=null;for(let a of e.primitives){let o=new H6(a,r,n);s!=null&&(s.next=o,o.previous=s),i.push(o),s=o,n++}return i[i.length-1].next=i[0],i[0].previous=i[i.length-1],i}inPolyline(e,r,i=0){if(!r.bbox().isContains1(e.x,e.y))return!1;let s=new ne(1,0),a=this.map2Sides(r,i),{x:o,y:l}=e;for(let u of a){let d=u.shape.bbox();if(d.isContainsY1(l)&&Rt.greater(d.maxX,o)){let A=u.shape;if(A instanceof Ee){let h=s.cross(A.direct);if(Rt.eq(h,0)){let f=!1;Rt.greatereq(u.start.x,o)&&(u.interInStart=!1,f=!f),Rt.greatereq(u.end.x,o)&&(u.intersInEnd=!1,f=!f),f&&(u.othersIntersCount=1);continue}else if(Rt.eq(u.start.y,l)&&Rt.greatereq(u.start.x,o))u.interInStart=!0;else if(Rt.eq(u.end.y,l)&&Rt.greatereq(u.end.x,o))u.intersInEnd=!0;else{let f=(u.end.x-u.start.x)/(u.end.y-u.start.y)*(l-u.start.y)+u.start.x;Rt.greatereq(f,o)&&(u.othersIntersCount=1)}}else if(A instanceof ze){let{center:h}=A,f=e.distance1(h);if(Rt.greatereq(Math.abs(A.sweepAngle),360)){Rt.lesseq(f,A.rx)&&(u.othersIntersCount=1);continue}let p=Math.abs(l-h.y);if(Rt.eq(p,A.rx)){Rt.greatereq(u.start.x,o)&&Rt.eq(u.start.y,l)&&(u.interInStart=!0),Rt.greatereq(u.end.x,o)&&Rt.eq(u.end.y,l)&&(u.intersInEnd=!0);continue}else{let m=Mq(A,l);if(m>0){for(let y=0;y<m;y+=2)if(Rt.greatereq(Ye[y],o)){let g=new ne(Ye[y],Ye[y+1]);g.equals1(u.start)?u.interInStart=!0:g.equals1(u.end)?u.intersInEnd=!0:u.othersIntersCount++}}}}else throw new Error("not supported!")}}let c=0;for(let u of a)if(u.intersInEnd){let d=u.getNext();if(d!=null){let A=u.getEndDirect(),h=d.getStartDirect();A!=null&&h!=null&&Rt.greater(A.y*h.y,0)&&c++}}else c+=u.othersIntersCount;return c%2==1}inPolygon(e,r){let i=!1;for(let n of r)this.inPolyline(e,n)&&(i=!i);return i}},kq=new G6;function MCe(t,e){let r=t.bbox(),i=e.bbox(),n=(r.minY+r.maxY)/2,s=(i.minY+i.maxY)/2;return n-s}function kCe(t,e){let r=t.bbox(),i=e.bbox(),n=(r.minX+r.maxX)/2,s=(i.minX+i.maxX)/2;return n-s}var oy=class{constructor(e){this.__bbox=null;if(typeof e<"u")if(e instanceof Array){this.__items=[];for(let r of e)this.add(r)}else this.__items=e,this.__bbox=e.bbox();else this.__items=[]}add(e){if(this.__items instanceof Array)this.__items.push(e),this.__bbox=Mr.extend2(this.__bbox,e.bbox());else throw new Error("can't insert multiple item into leaf node")}items(){return this.__items}bbox(){if(this.__bbox!==null)return this.__bbox;throw new Error("bug")}},ly=class{constructor(e){this.changed=!1;this.root=new oy,this.capacity=e,this.capacity2=e*e,this.itemList=[]}size(){return this.itemList.length}items(){return this.flushWhenNeed(),this.itemList}add(e){this.itemList.push(e),this.changed=!0}remove(e){zl.remove(this.itemList,e),this.changed=!0}clear(){this.changed=!1,this.root=new oy,this.itemList.length=0}flushWhenNeed(){if(this.changed){let e=new Array;for(let r of this.itemList)e.push(new oy(r));for(;;){let r=this.organize(e);if(r.length>1)e=r;else break}this.root=new oy(e),this.changed=!1}}organize(e){jA(e,kCe,0,e.length);let r=e.length,i=[];for(let n=0;n<r;)if(n+this.capacity2<=r){let s=n+this.capacity2;jA(e,MCe,n,s);for(let a=n;a<s;a+=this.capacity){let o=new oy(e.slice(a,a+this.capacity));i.push(o)}n=n+this.capacity*this.capacity}else{let s=new oy(e.slice(n,n+this.capacity));i.push(s),n=n+this.capacity}return i}search(e){this.flushWhenNeed();let r=[],i=[];for(i.push(this.root);;){let n=i.shift();if(typeof n<"u"){let s=n.items();if(s instanceof Array){for(let a of s)if(!e.isSeparated(a.bbox())){let o=a.items();o instanceof Array?i.push(a):r.push(o)}}else e.isSeparated(n.bbox())||r.push(s)}else break}return r}walker(e){this.flushWhenNeed(),this._walker(this.root,0,e)}_walker(e,r,i){this.flushWhenNeed();let n=e.items();if(n instanceof Array)for(let s of n)this._walker(s,r+1,i);else i(n,r)}bbox(){return this.flushWhenNeed(),this.root.bbox()}};var rE=class{constructor(e,r,i,n){this.sides=new Array;this.loader=e,this.logger=i,this.rule=r,this.event=n}addPolyline(e,r=1){let i=this.loader.buildGroup(e,r);for(let n of i)this.sides.push(n),this.event.onOriginSide(n);return i}buildRTree(){let e=new ly(10);for(let r of this.sides)e.add(r);return e}};var Pg=class{constructor(e){this._status=2;this.sides=[];this.connect=[];this.keepWeight=0;this.reverseWeight=0;this.invalidWeight=0;this.weight=e}get status(){return this._status}get start(){return this.sides[0].start}get end(){return this.sides[this.sides.length-1].end}mark(){if(this._status===2){if(this.invalidWeight>this.keepWeight&&this.invalidWeight>this.reverseWeight){this._status=1;return}if(this.keepWeight>this.reverseWeight&&this.keepWeight>this.invalidWeight){this._status=0;return}if(this.reverseWeight>this.keepWeight&&this.reverseWeight>this.invalidWeight){this._status=0,this.needReverse=!0;return}}}reverse(){let e=this.reverseWeight;this.reverseWeight=this.keepWeight,this.keepWeight=e;let r=[];for(;this.sides.length!==0;)r.push(this.sides.pop().reverse());for(let n of r)this.sides.push(n);this.startNode&&(this.startNode.outChainSet.delete(this),this.startNode.inChainSet.add(this),this.endNode.inChainSet.delete(this),this.endNode.outChainSet.add(this));let i=this.startNode;this.startNode=this.endNode,this.endNode=i}bbox(){return this.sides.reduce((e,r)=>e.ext1(r.bbox()),new pr).build()}getWindingNum(e){let r=this.end,i=0,{x:n,y:s}=e;for(let a of this.sides){let{start:o,end:l,shape:c}=a;if(r.y>s!=o.y>s&&(r.x>n?o.x>n?i+=o.y>r.y?1:-1:r.y>o.y?(r.x-n)*(o.y-s)-(r.y-s)*(o.x-n)<0&&i--:(r.x-n)*(o.y-s)-(r.y-s)*(o.x-n)>0&&i++:o.x>n&&(r.y>o.y?(r.x-n)*(o.y-s)-(r.y-s)*(o.x-n)<0&&i--:(r.x-n)*(o.y-s)-(r.y-s)*(o.x-n)>0&&i++)),o.y>s!=l.y>s){if(o.x>n)if(l.x>n)i+=l.y>o.y?1:-1;else if(c instanceof Ee)o.y>l.y?(o.x-n)*(l.y-s)-(o.y-s)*(l.x-n)<0&&i--:(o.x-n)*(l.y-s)-(o.y-s)*(l.x-n)>0&&i++;else if(c instanceof ze){let{center:u,isCCW:d,rx2:A}=c,h=(u.x-n)**2+(u.y-s)**2;o.y>l.y?(d?h>A:h<A)&&i--:(d?h<A:h>A)&&i++}else if(c instanceof Nt){if(DS(c,s)===0)throw new Error("no inters");Ye[0]>n&&(i+=l.y>o.y?1:-1)}else throw new Error("not support!");else if(l.x>n)if(c instanceof Ee)o.y>l.y?(o.x-n)*(l.y-s)-(o.y-s)*(l.x-n)<0&&i--:(o.x-n)*(l.y-s)-(o.y-s)*(l.x-n)>0&&i++;else if(c instanceof ze){let{center:u,isCCW:d,rx2:A}=c,h=(u.x-n)**2+(u.y-s)**2;o.y>l.y?(d?h>A:h<A)&&i--:(d?h<A:h>A)&&i++}else if(c instanceof Nt){if(DS(c,s)===0)throw new Error("no inters");Ye[0]>n&&(i+=l.y>o.y?1:-1)}else throw new Error("not support!")}r=l}return i}};function DP(t,e){let r=0;if(Math.abs(t.start.y-e)<=1e-4)Ye[r++]=t.start.x;else if(Math.abs(t.end.y-e)<=1e-4)Ye[r++]=t.end.x;else if(t.shape instanceof Ee)r=Nq(t.shape,e);else if(t.shape instanceof ze)r=Rq(t.shape,e);else if(t.shape instanceof Nt)r=DS(t.shape,e);else throw new Error("not supported operation");return r}var cy=class{constructor(e,r,i,n,s,a){this.inters=[];this._confidence=0;this._confidence_y=NaN;this._x=NaN;this._x_y=NaN;this.trans=NaN;this.previous=null;this.next=null;this.shape=e,r.y>i.y?this.weight=-a.weight:r.y==i.y?this.weight=0:this.weight=a.weight,this.start=r,this.end=i,this.polyGrp=n,this.polyIndex=s,this._bbox=new pr().ext1(e.bbox()).ext2(r).ext2(i).build(),this.inters.push([r,null]),this.inters.push([i,null]),this.chain=a}updateBbox(){this._bbox=new pr().ext2(this.start).ext2(this.end).build()}confidence(e){if(this._confidence_y!=e){let r=this._bbox.height();r!==0?Math.abs(e-this._bbox.maxY)>5e-4&&Math.abs(e-this._bbox.minY)>5e-4?this._confidence=(1-Math.abs(2*e-this._bbox.maxY-this._bbox.minY)/r)*1e4|0:this._confidence=0:this._confidence=1,this._confidence_y=e}return this._confidence}revokeOutside(e){let r=this.confidence(e);return this.start.y>this.end.y?this.chain.reverseWeight-=r:this.chain.keepWeight-=r,this.chain.invalidWeight+=r,r}revokeInside(e){let r=this.confidence(e);return this.start.y<this.end.y?this.chain.reverseWeight-=r:this.chain.keepWeight-=r,this.chain.invalidWeight+=r,r}setOutside(e){let r=this.confidence(e);return this.start.y>this.end.y?this.chain.reverseWeight+=r:this.chain.keepWeight+=r,r}setInside(e){let r=this.confidence(e);return this.start.y<this.end.y?this.chain.reverseWeight+=r:this.chain.keepWeight+=r,r}setInvalid(e){let r=this.confidence(e);return this.chain.invalidWeight+=r,r}prevNot0(){let e=this.previous;for(;e!=null&&e!=this;){if(e.weight!=0)return e;e=e.previous}return null}nextNot0(){let e=this.next;for(;e!=null&&e!=this;){if(e.weight!=0)return e;e=e.next}return null}getX(e){return(this._x_y!=e||isNaN(this._x))&&(DP(this,e)>0?this._x=Ye[0]:this._x=NaN,this._x_y=e),this._x}voteStatus(){let{keepWeight:e,reverseWeight:r,invalidWeight:i,status:n}=this.chain;return n===1?3:n===0?(this.chain.needReverse?!(this.end.y>this.start.y):this.end.y>this.start.y)?2:1:e>i&&e>r?this.end.y>this.start.y?2:1:i>e&&i>r?3:r>i&&r>e?this.end.y<this.start.y?2:1:0}reverse(){let e;if(this.shape instanceof Ee)e=new Ee(this.shape.end(),this.shape.start());else if(this.shape instanceof ze)e=ze.build3(this.shape.center,this.shape.endAngle(),-this.shape.sweepAngle,this.shape.rx,this.shape.ry);else if(this.shape instanceof Nt)e=new Nt(this.shape.controls.slice().reverse());else throw new Error("not supported operation");this.shape=e;let r=this.start;return this.start=this.end,this.end=r,this}isNeedScan(e){return this.chain.keepWeight+this.chain.reverseWeight+this.chain.invalidWeight<5e3&&this.confidence(e)>0&&this.chain.status===2}bbox(){return this._bbox}toString(){return ld.format("(%d,%d,%d) (%d,%d,%d) %s %s",this.polyGrp,this.polyIndex,this.weight,this.chain.keepWeight,this.chain.reverseWeight,this.chain.invalidWeight,this.start,this.end)}};var Zu=class{constructor(e){this.cache={};this.levels=e,this.result=new Array(e),this.weights=new Array(e),this.maxIdx=e-1,this.rule=this.decide.bind(this);let r=1;for(let i=0;i<e;i++)this.weights[i]=r,r*=50}weight(e){return this.weights[e]}decide(e){e=Math.abs(e);let r=this.cache[e];if(r===void 0){let i=e;for(let n=this.maxIdx;n>=0;n--){let s=this.weights[n],a=Math.floor(e/s),o=e%s;o>Math.floor(s/2)?(e=s-o,a++):e=o,this.result[n]=a>0}r=this.decide1(this.result),this.cache[i]=r}return r}};var Y6=new class extends Zu{decide1(e){return e[0]||e[1]}}(2),YXe=[Y6,new class extends Zu{decide1(e){return e[0]||e[1]||e[2]}}(3),new class extends Zu{decide1(e){return e[0]||e[1]||e[2]||e[3]}}(4),new class extends Zu{decide1(e){return e[0]||e[1]||e[2]||e[3]||e[4]}}(5),new class extends Zu{decide1(e){return e[0]||e[1]||e[2]||e[3]||e[4]||e[5]}}(6),new class extends Zu{decide1(e){return e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]}}(7),new class extends Zu{decide1(e){return e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7]}}(8),new class extends Zu{decide1(e){return e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7]||e[8]}}(9)],KXe=new class extends Zu{decide1(e){return e[0]&&!e[1]}}(2),$Xe=new class extends Zu{decide1(e){return e[0]&&e[1]}}(2),eqe=new class extends Zu{decide1(e){return e[0]&&!e[1]||!e[0]&&e[1]}}(2);var iE=class{constructor(e,r=!0){this.polyGrp=0;this.polyIndex=0;this.prevPoint=null;this.noWeight0=e,this.keepBezier=r}completeGroup(){this.prevPoint&&this.curSideChain.sides.length!==0&&!this.prevPoint.equals1(this.curSideChain.start)&&this.addSide(new Ee(this.prevPoint,this.curSideChain.start),!1);let e,r=null,i=null;return this.noWeight0?e=this.curSideChain.sides.filter(n=>n.weight===0?!1:(r!=null?(r.next=n,n.previous=r):i=n,r=n,!0)):(e=this.curSideChain.sides,e.forEach(n=>{r!=null?(r.next=n,n.previous=r):i=n,r=n})),r!=null&&i!=null&&(i.previous=r,r.next=i),this.polyGrp++,this.curSideChain=null,this.prevPoint=null,this.polyIndex=0,e}buildGroup(e,r){this.curSideChain=new Pg(r);for(let i of e.primitives)if(i instanceof Ee)this.addSide(i);else if(i instanceof ze&&i.rx===i.ry)this.addArc(i);else if(i instanceof Nt&&i.controls.length<=4&&this.keepBezier)this.addBezier(i);else{let n=null;for(let s of i.points(.01))n!=null&&this.addSide(new Ee(n,s)),n=s}return this.completeGroup()}addArc(e){let r=e.sweepAngle,i=mu.regularD(e.startAngle),n=i+r;if(r>0){let s=90;for(;s<=n;)s>i&&(this.addSide(ze.build3(e.center,i,s-i,e.rx,e.ry)),i=s),s+=90;i<n&&this.addSide(ze.build3(e.center,i,n-i,e.rx,e.ry))}else if(r<0){let s=270;for(;s>=n;)s<i&&(this.addSide(ze.build3(e.center,i,s-i,e.rx,e.ry)),i=s),s-=90;i>n&&this.addSide(ze.build3(e.center,i,n-i,e.rx,e.ry))}}isInRange(e){return Rt.greater(e,0)&&Rt.less(e,1)}getT0(e,r,i,n){let s=e[n]-2*r[n]+i[n],a=r[n]-e[n];if(s===0)return[];let o=-a/s,l=[];return this.isInRange(o)&&l.push(o),l}getT10(e,r,i,n,s){let a,o,l=-e[s]+3*r[s]-3*i[s]+n[s],c=2*(e[s]-2*r[s]+i[s]),u=r[s]-e[s],d=c**2-4*l*u;if(Rt.lesseq(d,0))a=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;else{let h=Math.sqrt(d);a=(-c-h)/(2*l),o=(-c+h)/(2*l);let f=l*2;if(Rt.lesseq(a,1)&&Rt.greatereq(a,0)){let p=Number.NEGATIVE_INFINITY;for(;Rt.neq(a,p);){p=a;let m=f*a+c;a=-(l*a**2+c*a+u-m*a)/m}}if(Rt.lesseq(o,1)&&Rt.greatereq(o,0)){let p=Number.NEGATIVE_INFINITY;for(;Rt.neq(o,p);){p=o;let m=f*o+c;o=-(l*o**2+c*o+u-m*o)/m}}}let A=[];return this.isInRange(o)&&A.push(o),this.isInRange(a)&&A.push(a),A}addBezier(e){if(e.controls.length===2){this.addSide(e);return}let r,i;if(e.controls.length===3){let[o,l,c]=e.controls;r=this.getT0(o,l,c,"x"),i=this.getT0(o,l,c,"y")}else{let[o,l,c,u]=e.controls;r=this.getT10(o,l,c,u,"x"),i=this.getT10(o,l,c,u,"y")}let n=r.pop()||1,s=i.pop()||1,a=0;for(;n!==1||s!==1;)if(Rt.eq(n,s))n=r.pop()||1,s=i.pop()||1;else if(n<s){let[o,l]=e.clip(n/(1-a));a=n,this.addSide(o),e=l,n=r.pop()||1}else{let[o,l]=e.clip(s/(1-a));a=s,this.addSide(o),e=l,s=i.pop()||1}this.addSide(e)}equals(e,r){return Math.abs(e.x-r.x)<=.1&&Math.abs(e.y-r.y)<=.1}addSide(e,r=!0){let i=e.start(),n=e.end();if(r){if(this.prevPoint){if(this.equals(this.prevPoint,n))return;this.prevPoint.equals1(i)||this.addSide(new Ee(this.prevPoint,i),!1)}else if(this.equals(i,n)){this.prevPoint=i;return}}let s=new cy(e,i,n,this.polyGrp,this.polyIndex++,this.curSideChain);this.curSideChain.sides.push(s),this.prevPoint=n}};var _P=new Error("list is empty"),nE=class{constructor(e,r){this.prev=null;this.next=null;this.parent=e,this.item=r}insertAfter(e){e.next=this.next,this.next=e,e.prev=this,e.next!==null&&(e.next.prev=e)}insertBefore(e){e.prev=this.prev,this.prev=e,e.next=this,e.prev!==null&&(e.prev.next=e)}remove(){this.prev!==null&&(this.prev.next=this.next),this.next!==null&&(this.next.prev=this.prev)}set(e){this.item=e}},V6=class{get value(){return this._next}constructor(e){this._next=e}hasNext(){return this._next!==null}next(){let e=this._next;if(e!==null)return this._next=e.next,e.item;throw new Error("iterator is null")}},j6=class{constructor(e){this._next=e}hasNext(){return this._next!==null}next(){let e=this._next;if(e!==null)return this._next=e.next,e;throw new Error("iterator is null")}},cd=class{constructor(){this.first=null;this.last=null;this.cnt=0}add(e){return this.addLast(e)}push(e){return this.addLast(e)}pop(){return this.removeLast()}shift(){return this.removeFirst()}removeFirst(){let e=this.first;if(e===null)throw _P;return this.remove(e),e.item}removeLast(){let e=this.last;if(e===null)throw _P;return this.remove(e),e.item}addLast(e){if(this.first===null||this.last===null){let r=new nE(this,e);return this.first=r,this.last=r,this.cnt++,r}else return this.insertAfter(this.last,e)}addFirst(e){if(this.first===null||this.last===null){let r=new nE(this,e);return this.first=r,this.last=r,this.cnt++,r}else return this.insertBefore(this.first,e)}getFirst(){if(this.first===null)throw _P;return this.first.item}getLast(){if(this.last===null)throw _P;return this.last.item}insertAfter(e,r){let i=new nE(this,r);return e.insertAfter(i),e===this.last&&(this.last=i),this.cnt++,i}insertBefore(e,r){let i=new nE(this,r);return e.insertBefore(i),e===this.first&&(this.first=i),this.cnt++,i}remove(e){e.remove(),e===this.first&&(this.first=e.next),e===this.last&&(this.last=e.prev),this.cnt--}size(){return this.cnt}clear(){this.first=null,this.last=null,this.cnt=0}iterator(){return new V6(this.first)}listIterator(){return new j6(this.first)}toArray(){let e=new Array,r=this.first;for(;r!=null;)e.push(r.item),r=r.next;return e}};var sE=class{constructor(e,r,i,n=0){this.start=null;this.prevStart=null;this.prevEnd=null;this.last=null;this.y=i,this.rule=e,this.event=r.event,this.curWeight=n,e(n)&&(this.start=void 0)}getCurWeight(){return this.curWeight}onEp(e){this.tuningWeight(e),this.start===null?this.rule(this.curWeight)?this.in(e):e.setInvalid(this.y):this.rule(this.curWeight)?e.setInvalid(this.y):this.out(e),this.last!==null&&this.event.onSweep1(this.last,e,this.y),this.last=e}in(e){this.prevEnd!=null&&this.onSameX(e,this.prevEnd)?(this.start=this.prevStart,this.prevStart=null,this.prevEnd.revokeInside(this.y),this.prevEnd=null):(this.start=e,this.start.setOutside(this.y))}connect(e){e.chain.connect.push(this.start.chain),this.start.chain.connect.push(e.chain)}out(e){if(this.start===void 0){e.setInside(this.y),this.start=null;return}if(this.onSameX(this.start,e))this.start.revokeOutside(this.y);else{if(e.setInside(this.y)>0&&this.start.confidence(this.y)>0){let r=this.start.voteStatus(),i=e.voteStatus();this.isValid(r)&&this.isValid(i)?r==2&&i==1&&this.connect(e):this.connect(e)}this.event.onSegment1(this.start,e,this.y),this.prevStart=this.start,this.prevEnd=e}this.start=null}isValid(e){return e==1||e==2}onSameX(e,r){return e.bbox().isIntersect(r.bbox())&&Rt.eq(e.getX(this.y),r.getX(this.y))}tuningWeight(e){this.curWeight+=e.weight;let r=e.nextNot0(),i=e.prevNot0();r!=null&&e.weight===r.weight&&r.trans===this.y&&(this.curWeight-=e.weight),i!=null&&e.weight===i.weight&&i.trans===this.y&&(this.curWeight-=e.weight),e.trans=this.y}};var FCe=!0,UCe=!1,HCe=!1,GCe=!0,YCe=!0,VCe=!0,jCe=!0,PP=class extends I2{constructor(e){super(),this.debug=e}display(){}onPolylineGroup(e,r){this.debug}onSegment(e,r,i,n){this.debug}onIntersect(e,r,i){this.debug}onResultSide(e){this.debug}onOriginSide(e){this.debug}onSplitedSide(e){this.debug}onDebugSide(e){this.debug}onSweep(e,r,i,n){this.debug}};function LP(t){throw new Error("")}var aE=class{constructor(e,r){this.node1=null;this.node2=null;this.key=e,this.value=r}},Q6=class{constructor(e){this.itors=e}hasNext(){return this.itors.hasNext()}next(){return this.itors.next().key}},z6=class{constructor(e){this.itors=e}hasNext(){return this.itors.hasNext()}next(){return this.itors.next().value}},OP=class{constructor(){this.innerList=new cd;this.innerMap={}}replace(e,r){e.node1!==null&&(e.node1.set(r),r.node1=e.node1),e.node2!==null&&(e.node2.set(r),r.node2=e.node2)}clear(){this.innerList.clear();for(let e in this.innerMap)delete this.innerMap[e]}put(e,r){let i=e.hashCode(),n=new aE(e,r),s=this.innerMap[i];if(s===void 0)return n.node1=this.innerList.add(n),this.innerMap[i]=n,null;if(s instanceof aE){if(s.key.equals(e))return this.innerMap[i]=n,this.replace(s,n),s.value;{n.node1=this.innerList.add(n);let a=new cd;return s.node2=a.add(s),n.node2=a.add(n),this.innerMap[i]=a,null}}if(s instanceof cd){let a=null;return W2(s,(o,l)=>l.key.equals(e)?(this.replace(l,n),a=l.value,!1):!0),a===null?(n.node1=this.innerList.add(n),n.node2=s.push(n),null):a}return LP(s)}get(e){let r=e.hashCode(),i=this.innerMap[r];if(i===void 0)return null;if(i instanceof aE)return i.key.equals(e)?i.value:null;if(i instanceof cd){let n=null;return W2(i,(s,a)=>a.key.equals(e)?(n=a.value,!1):!0),n}return LP(i)}containsKey(e){return this.get(e)!==null}delete(e){e.node1!==null&&e.node1.parent.remove(e.node1),e.node2===null?delete this.innerMap[e.key.hashCode()]:e.node2.parent.remove(e.node2)}remove(e){let r=e.hashCode(),i=this.innerMap[r];if(i===void 0)return null;if(i instanceof aE)return i.key.equals(e)?(this.delete(i),i.value):null;if(i instanceof cd){let n=null;return W2(i,(s,a)=>a.key.equals(e)?(n=a.value,this.delete(a),!1):!0),n}return LP(i)}computeIfAbsent(e,r){let i=this.get(e);if(i===null){let n=r(e);return this.put(e,n),n}else return i}size(){return this.innerList.size()}isEmpty(){return this.innerList.size()===0}keys(){return new Q6(this.innerList.iterator())}values(){return new z6(this.innerList.iterator())}entries(){return this.innerList.iterator()}};var X6=class{constructor(){this.points=[];this.lines=[];this.arcs=[];this.beziers=[];this.listText=[];this.fonts=[]}addPt(e,r=!0){if(e instanceof Ee)this.lines.push(e);else if(e instanceof ze)this.arcs.push(e);else if(e instanceof Nt)this.beziers.push(e);else throw new Error("not support");r&&this.points.push(e.start())}addPoint(e){this.points.push(e)}addText(e,r,i=1,n=.1,s=!0){this.listText.push({pos:e,str:r,size:i,width:n}),s&&this.points.push(e)}addPly(e,r=!0){e.primitives.forEach(i=>this.addPt(i,r))}build(){let e=[],r=[],i=[],n=[],s=[],a=[];return this.points.forEach(o=>e.push(o.x,o.y)),this.lines.forEach(o=>r.push(o.start().x,o.start().y,o.end().x,o.end().y)),this.arcs.forEach(o=>i.push(o.center.x,o.center.y,o.rx,mu.toRadians(o.startAngle),mu.toRadians(o.endAngle()),o.sweep())),this.beziers.forEach(o=>{o.controls.forEach(l=>{n.push(l.x,l.y)}),n.push("end")}),this.listText.forEach(o=>s.push(o.pos.x,o.pos.y,o.str,o.width,o.size)),this.fonts.forEach(o=>a.push(o)),{points:e,lines:r,arcs:i,texts:s,beziers:n,fonts:a}}},NP=class{constructor(e){this.map=new OP;this.bus=e}initColor(e){return this.map.computeIfAbsent(e,()=>new X6)}draw(){let e={},r=this.map.entries();for(;r.hasNext();){let i=r.next();e[i.key.toString()]=i.value.build()}this.bus.publish("/debug/draw",e)}clear(){this.map.clear()}},Ta=class Ta{static isHexFormate(e){return!e||typeof e!="string"?!1:/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)}static of1(e){return this.of2(e>>16&255,e>>8&255,e&255)}static of2(e,r,i,n=255){return new Ta(e/255,r/255,i/255,n/255)}static of3(e){e.startsWith("#")&&(e=e.substr(1));let r=e.length;if(r==3)return new Ta(parseInt(e[0],16)/15,parseInt(e[1],16)/15,parseInt(e[2],16)/15);if(r==6)return new Ta(parseInt(e.substr(0,2),16)/255,parseInt(e.substr(2,2),16)/255,parseInt(e.substr(4,2),16)/255);if(r==8)return new Ta(parseInt(e.substr(0,2),16)/255,parseInt(e.substr(2,2),16)/255,parseInt(e.substr(4,2),16)/255,parseInt(e.substr(6,2),16)/255);throw new Error("invalid color string")}static of4(e){let r=parseInt(e.r*255+"").toString(16),i=parseInt(e.g*255+"").toString(16),n=parseInt(e.b*255+"").toString(16);return r.length<2&&(r="0"+r),i.length<2&&(i="0"+i),n.length<2&&(n="0"+n),("#"+r+i+n).toUpperCase()}static of5(e,r){if(e.startsWith("#")&&(e=e.substr(1)),e.length==3)return new Ta(parseInt(e[0],16)/15,parseInt(e[1],16)/15,parseInt(e[2],16)/15,r);if(e.length==6)return new Ta(parseInt(e.substr(0,2),16)/255,parseInt(e.substr(2,2),16)/255,parseInt(e.substr(4,2),16)/255,r);throw new Error("invalid color string")}static of6(e,r){return new Ta(e.r,e.g,e.b,r)}static of7(e){return e==null?null:Ta.of3(e)}constructor(e,r,i,n=1){this.r=cm.positiveOr0(e),this.g=cm.positiveOr0(r),this.b=cm.positiveOr0(i),this.alpha=n}hashCode(){return this.r+this.g+this.b+this.alpha}equals(e,r=!1){let i=this.r===e.r&&this.g===e.g&&this.b===e.b;return r?i:i&&this.alpha===e.alpha}add(e,r,i,n){return new Ta(Math.max(0,Math.min(1,this.r+e)),Math.max(0,Math.min(1,this.g+r)),Math.max(0,Math.min(1,this.b+i)),Math.max(0,Math.min(1,this.alpha+n)))}mul(e){return new Ta(Math.max(0,Math.min(1,this.r*e)),Math.max(0,Math.min(1,this.g*e)),Math.max(0,Math.min(1,this.b*e)),this.alpha)}mul1(e){return new Ta(Math.max(0,this.r*e),Math.max(0,this.g*e),Math.max(0,this.b*e),this.alpha)}getData(){return[this.r,this.g,this.b,this.alpha]}toString(){let e=(this.r*255).toString(16),r=(this.g*255).toString(16),i=(this.b*255).toString(16);return e.length<2&&(e="0"+e),r.length<2&&(r="0"+r),i.length<2&&(i="0"+i),"#"+e.substr(0,2)+r.substr(0,2)+i.substr(0,2)}toString1(){let e=(this.r*255).toString(16),r=(this.g*255).toString(16),i=(this.b*255).toString(16),n=(this.alpha*255).toString(16);return e.length<2&&(e="0"+e),r.length<2&&(r="0"+r),i.length<2&&(i="0"+i),n.length<2&&(n="0"+n),"#"+e.substr(0,2)+r.substr(0,2)+i.substr(0,2)+n.substr(0,2)}toRGBA(){let e=this.r*255,r=this.g*255,i=this.b*255;return[e,r,i,this.alpha]}toRGBAString(){let e=this.r*255,r=this.g*255,i=this.b*255;return`rgba(${e},${r},${i},${this.alpha})`}isWHITE(){return this.r===1&&this.g===1&&this.b===1&&this.alpha===1}};Ta.WHITE=new Ta(1,1,1,1),Ta.BLACK=new Ta(0,0,0,1),Ta.RED=new Ta(1,0,0,1),Ta.GREEN=new Ta(0,1,0,1),Ta.BLUE=new Ta(0,0,1,1),Ta.Gray=Ta.of3("#9966ff"),Ta.Silver=Ta.of3("#D2D2D2"),Ta.Golden=Ta.of3("#DCAA14");var uy=Ta;var QCe=!0,zCe=!1,XCe=!1,qCe=!0,WCe=!0,Uq=uy.RED,KCe=uy.GREEN,Hq=uy.BLUE,q6=new uy(1,1,0),JCe=new uy(1,0,1),ab=class extends PP{constructor(r,i=null){super(r);this.plGrps=new Array;i&&(this.drawDebug=new NP(i))}onPolylineGroup(r,i){super.onPolylineGroup(r,i),this.plGrps.push(r),!(!this.drawDebug||!WCe)&&r.items.forEach((n,s)=>n.primitives.forEach(a=>{this.drawDebug.initColor(s===0?KCe:JCe).addPt(a)}))}onOriginSide(r){super.onOriginSide(r),!(!this.drawDebug||!QCe)&&this.drawDebug.initColor(Hq).addPt(r.shape)}onIntersect(r,i,n){super.onIntersect(r,i,n),!(!this.drawDebug||!zCe)&&this.drawDebug.initColor(Uq).addPoint(r)}onScan(r,i,n,s,a,o){if(super.onScan(r,i,n,s,a,o),!this.drawDebug||!XCe)return;let l=i.getX(n);isNaN(l)&&(l=Math.abs(i.start.y-n)>Math.abs(i.end.y-n)?i.end.x:i.start.x);let c=r?new ne(l,n).rotate(ne.ORIGIN,-Math.PI/2):new ne(l,n);this.drawDebug.initColor(Hq).addText(c,`${a}=${o}${r?"=V":""}`)}onResultSide(r){if(super.onResultSide(r),!(!this.drawDebug||!qCe)&&this.lastResultChain!==r.chain&&(this.lastResultChain=r.chain,r.chain.status===0)){for(let i of r.chain.sides)this.drawDebug.initColor(q6).addPt(i.shape,!1);r.chain.startNode&&(this.drawDebug.initColor(q6).addPoint(r.chain.start),this.drawDebug.initColor(q6).addPoint(r.chain.end))}}onDebugSide(r){var i;super.onDebugSide(r),(i=this.drawDebug)==null||i.initColor(Uq).addPt(r.shape)}onEnd(){var r;(r=this.drawDebug)==null||r.draw()}};var RP=class{constructor(){this._inChainSet=new Set;this._outChainSet=new Set;this._mergedNode=this}get mergedNode(){for(;!this._mergedNode._inChainSet;)this._mergedNode=this._mergedNode._mergedNode;return this._mergedNode}get inChainSet(){return this.mergedNode._inChainSet}get outChainSet(){return this.mergedNode._outChainSet}merge(e){if(!e)return this._mergedNode;let r=this.mergedNode,i=e.mergedNode;if(r===i)return r;for(let n of i._inChainSet)r._inChainSet.add(n);for(let n of i._outChainSet)r._outChainSet.add(n);return delete i._inChainSet,delete i._outChainSet,i._mergedNode=r,r}};var MP=class{constructor(){this.chain=new Pg(0);this.others=[]}add(e){this.chain.sides.push(...e.sides),e.finalRing=this;for(let r of e.connect)this.others.push(r)}get polyline(){if(!this._polyline){let e=new Array;for(let r of this.chain.sides)e.push(r.shape);this._polyline=Fr.build2(e).asClose()}return this._polyline}bbox(){return this.polyline.bbox()}};var kP=class{constructor(e,r){this.chains=e,this.originChains=r,e.forEach(i=>i.block=this),this._bbox=r.reduce((i,n)=>i.ext1(n.bbox()),new pr).build()}searchOriginChains(e){return this.originChainRTree||(this.originChainRTree=new ly(10),this.originChains.forEach(r=>this.originChainRTree.add(r))),this.originChainRTree.search(e)}bbox(){return this._bbox}};var FP=class t{constructor(e){this.childs=new Array;this._bbox=null;this.parent=null;this.capacity=e}bbox(){return cm.notnull(this._bbox)}itor(e,r){for(let i of this.childs)i instanceof t?i.itor(e+1,r):r(i,e)}debug(e){for(let r of this.childs)console.log(e,r.bbox(),r instanceof t?"+":"-"),r instanceof t&&r.debug(e+" |--")}insert(e){let r=this.childs,i=e.bbox();for(let n=0;n<r.length;n++){let s=r[n];if(s instanceof t&&i.isInside(s.bbox())){s.insert(e),this._bbox=Mr.extend2(this._bbox,i);return}}e instanceof t&&(e.parent=this),r.length<=this.capacity?r.push(e):(r.push(e),this.splitNode()),this._bbox=Mr.extend2(this._bbox,i)}remove(e){if(e instanceof t&&e.childs.length>0)throw new Error;let r=this.childs,i=e.bbox(),n=new Array;for(let s=0;s<r.length;s++){let a=r[s];if(a===e)return r.splice(s,1),r.length>0?(this.updateBBox(),this.parent!==null&&this.parent.childs.length>0&&this.parent.updateBBox()):this.parent!==null?(this.parent.remove(this),this.parent!==null&&this.parent.childs.length>0&&this.parent.updateBBox()):this._bbox=null,1;a instanceof t&&i.isInside(a.bbox())&&n.push(a)}if(e instanceof t)throw new Error;for(let s of n){let a=s.remove(e);if(a===1)return this.childs.length>0&&this.updateBBox(),this.parent!==null&&this.parent.childs.length>0&&this.parent.updateBBox(),1;if(a!==0)throw new Error}return 0}recycle(){this.childs.length=0}updateBBox(){let e=new pr;for(let r of this.childs)e.ext1(r.bbox());this._bbox=e.build()}splitNode(){let e=this.childs,r=e.length,i=-1,n=-1,s=Number.NEGATIVE_INFINITY;for(let c=0;c<r;c++){let u=e[c];for(let d=c+1;d<r;d++){let A=e[d],h=Mr.extend2(u.bbox(),A.bbox()).area();h>s&&(s=h,i=c,n=d)}}let a=this.asNode(e[i]),o=this.asNode(e[n]);for(let c=0;c<r;c++)if(c!==i&&c!==n){let u=e[c],d=u.bbox(),A=Mr.extend2(a._bbox,d).area(),h=Mr.extend2(o._bbox,d).area();A<h?a.insert(u):o.insert(u)}e.length=0;let l=this.parent;l!==null&&l.childs.length<this.capacity?(a.parent=l,o.parent=l,l.childs.push(a),l.childs.push(o),l.remove(this),l.updateBBox()):(a.parent=this,o.parent=this,e.push(a),e.push(o),this.updateBBox()),this.childs.length>0&&this.updateBBox(),a.updateBBox(),o.updateBBox()}asNode(e){if(e instanceof t)return e;{let r=new t(this.capacity);return r.insert(e),r}}},UP=class{constructor(e){this.items=new Set;this.root=new FP(e)}itor(e){this.root.itor(0,e)}search(e){let r=[],i=[];for(i.push(this.root);;){let n=i.shift();if(n!==void 0)for(let s of n.childs)e.isSeparated(s.bbox())||(s instanceof FP?i.push(s):r.push(s));else break}return r}insert(e){this.items.add(e),this.root.insert(e)}remove(e){return this.items.delete(e),this.root.remove(e)}bbox(){return this.root.bbox()}debug(){this.root.debug("")}recycle(){this.items.clear(),this.root.recycle()}};var $Ce=zl.funcCopy(jA),HP=class{constructor(e){this.parents=new Set;this.childrenRTree=new UP(10);this.marked=!1;this.markedChildNum=0;this.item=e}bbox(){return this.item.bbox()}};function Gq(t){let e=t.map(i=>new HP(i));$Ce(e,(i,n)=>n.bbox().area()-i.bbox().area(),0,e.length);let r=new HP(null);return e.forEach(i=>{let n=i.bbox(),s=[r],a=new Set;for(;s.length!==0;){let o=s.pop();if(a.has(o))continue;a.add(o);let l=o.childrenRTree.search(n),c=l.filter(u=>u.bbox().isContainsBBox(n));c.length===0?(l.filter(u=>n.isContainsBBox(u.bbox())).forEach(u=>{u.parents.delete(o),o.childrenRTree.remove(u),u.parents.add(i),i.childrenRTree.insert(u)}),o.childrenRTree.insert(i),i.parents.add(o)):s.push(...c)}}),r.childrenRTree.items.forEach(i=>i.parents.clear()),Array.from(r.childrenRTree.items)}var GP=.01,ZCe=zl.funcCopy(jA),eSe=zl.funcCopy(jA),tSe=zl.funcCopy(jA),rSe=zl.funcCopy(jA);function iSe(t,e){return t.bbox().minY-e.bbox().minY}function nSe(t,e){return t.bbox().area()-e.bbox().area()}function sSe(t,e,r){if(t instanceof Ee||e.distance2(r)<1e-6)return new Ee(e,r);if(t instanceof ze){let i=t.bbox().center().x,n;e.y>r.y?n=i>t.center.x?kl.CW:kl.CCW:n=i>t.center.x?kl.CCW:kl.CW;let s=e.angleD(t.center),a=r.angleD(t.center);return ze.build2(t.center,s,a,t.rx,t.ry,n)}else if(t instanceof Nt){let i=function(n){let s=t.getPercent(n);if(typeof s!="number")throw new Error("typeof percent !== 'number'");return t.clip(s)};return t=i(e)[1],i(r)[0]}else throw new Error("not supported operation")}var W6,Yq={};function Vq(){return typeof performance<"u"?performance.now():Date.now()}function _S(t){Yq[t]=(Yq[t]||0)-W6+(W6=Vq())}var aSe=0,oSe=0,lSe=0,cSe=0,uSe=0,hSe=0,dSe=0,YP=class t extends rE{constructor(r,i,n,s=!0){super(new iE(!1,s),r,i,n);this.outSideGroups=[];this.inSideGroups=[];this.scanY=NaN;this.curNetIndex=0;this.scanLines=0;this.blockOriginChainsIndex=[];this.blockChainsIndex=[];this.blocks=[];this.originPls=[];this.originWeights=[]}addPolyline(r,i=1){this.originPls.push(r),this.originWeights.push(i);let n=super.addPolyline(r,i);return n.length!==0&&(n[0].chain.blockIndex=this.blockOriginChainsIndex.length,this.blockOriginChainsIndex.push([n[0].chain])),n}sweep(r,i,n,s,a){this.scanY=NaN,this.scanLines=0,eSe(i,iSe,0,i.length);let o=new cd;this.curNetIndex=0;let l=Number.POSITIVE_INFINITY;for(let c of r)c>l&&this.scan(o,(l+c)/2,i,n,s),l=c;for(let c of a)c.mark();dSe+=this.scanLines}simplify0(){hSe++,aSe+=this.blockOriginChainsIndex.length,lSe+=this.sides.length,W6=Vq(),this.seekIntersection(),_S("seekIntersection"),this.splitSidesByInters(),this.blockChainsIndex.forEach(r=>{oSe+=r.length,r.forEach(i=>cSe+=i.sides.length)}),_S("splitSidesByInters"),this.sweepBlocks(),uSe+=this.blocks.length,_S("sweepBlocks"),this.connectSides(),_S("connectSides"),this.fillResult(),_S("fillResult"),this.event instanceof ab&&this.event.onEnd()}simplify(){try{this.simplify0()}catch{this.event instanceof ab&&(this.event.plGrps.length=0);let i=new t(this.rule,this.logger,this.event,!1);for(let n=0;n<this.originPls.length;n++)i.addPolyline(this.originPls[n],this.originWeights[n]),i.originPls.length=0,i.originWeights.length=0;this.originPls.length=0,this.originWeights.length=0,i.simplify0()}}sweepBlocks(){this.blockChainsIndex.forEach((n,s)=>{let a=new kP(n,this.blockOriginChainsIndex[s]),o=a.bbox();o.width()<=GP||o.height()<=GP||this.blocks.push(a)});let r=Gq(this.blocks),i=[];for(;r.length!==0;){let n=r.pop();n.childrenRTree.items.size===0?i.push(n):r.push(...n.childrenRTree.items)}for(;i.length!==0;){let n=i.pop();if(n.marked)continue;let s=new cd;n.parents.forEach(u=>s.push(u));let a=n.item.chains[0].start,o=a.bbox(),l,c=0;for(;s.size()!==0&&!l;){let u=s.shift();for(let d of u.item.searchOriginChains(o)){let A=d.getWindingNum(a);A!==0&&(l=u,c-=A*d.weight)}u.parents.forEach(d=>s.push(d))}for(let u of n.parents)u.childrenRTree.remove(n),u.childrenRTree.items.size===u.markedChildNum&&i.push(u);n.parents.clear(),n.marked=!0,l?(n.item.startWeight=c,n.parents.add(l),l.childrenRTree.insert(n),l.markedChildNum++):(n.item.startWeight=0,r.push(n))}for(;r.length!==0;){let n=r.pop(),s=n.item.startWeight;for(let a of n.childrenRTree.items)a.item.startWeight+=s,r.push(a)}this.blocks.forEach((n,s)=>{let a=[];n.chains.forEach(o=>a.push(...o.sides)),this.sweep(this.getSortedEndpointsLineAsc(!1,n.chains),a,!1,n.startWeight,n.chains),this.sweep(this.getSortedEndpointsLineAsc(!0,n.chains),this.flipSides(a),!0,n.startWeight,n.chains)})}scan(r,i,n,s,a){if(this.scanY===i)return;this.scanY=i;let o=!1,l=r.listIterator();for(;l.hasNext();){let A=l.next(),h=A.item;Rt.less(h.bbox().maxY,i)?r.remove(A):!o&&h.isNeedScan(i)&&(o=!0)}for(;this.curNetIndex<n.length;){let A=n[this.curNetIndex];if(Rt.less(A.bbox().minY,i))Rt.greatereq(A.bbox().maxY,i)&&(this.add2AET(r,A),!o&&A.isNeedScan(i)&&(o=!0)),this.curNetIndex++;else break}if(!o)return;this.scanLines++;let c=new sE(this.rule,this,i,a),u=r.iterator(),d=0;for(;u.hasNext();){let A=u.next(),h=c.getCurWeight();c.onEp(A),this.event.onScan(s,A,i,d++,h,c.getCurWeight())}}add2AET(r,i){let n=i.bbox().minX,s=i.bbox().maxX,a=i.bbox().minY,o=i.bbox().maxY,l=r.listIterator(),c=null;for(;l.hasNext();){let u,d=l.next(),A=d.item,h=A.bbox().minX,f=A.bbox().maxX;if(s<=h)u=-1;else if(f<=n)u=1;else{let m=A.bbox().minY,y=A.bbox().maxY,g=Math.max(a,m),b=Math.min(o,y);u=this.compareBySweep(i,A,(g+b)/2)}let p=A.shape;if(p instanceof Ee&&p.length()<.001&&c==null&&u<0){c=d;continue}if(c!=null&&u<0){r.insertBefore(c,i);return}if(u<0){r.insertBefore(d,i);return}else c=null}r.add(i)}angleToUp(r){return r<0?r+Math.PI:r}getLineAngle(r){return this.angleToUp(r.start().angle(r.end()))}getArcAngle(r,i){let n=Math.asin((i-r.center.y)/r.rx);return r.startAngle>90&&r.startAngle<270&&(n=-n),(this.angleToUp(n)+Math.PI/2)%Math.PI}compareArcLine(r,i,n){let s=this.getArcAngle(r,n),a=this.getLineAngle(i);return Rt.eq(s,a)?-r.sweepAngle:a-s}getAnotherP(r,i){let n=r.start,s=r.end;return Math.abs(n.y-i)<Math.abs(s.y-i)?s:n}compareSide(r,i,n,s,a){let o=this.getAnotherP(r,a),l=this.getAnotherP(i,a);if(o.y>a!=l.y>a)return n-s;if(a=o.equals1(l)?((Math.abs(a-o.y)<Math.abs(a-l.y)?o.y:l.y)+a)/2:Math.abs(a-o.y)<Math.abs(a-l.y)?o.y:l.y,DP(r,a)===0)throw new Error("intersY(s1, y) === 0");if(n=Ye[0],DP(i,a)===0)throw new Error("intersY(s2, y) === 0");return s=Ye[0],n-s}compareBySweep(r,i,n){let s=r.getX(n);if(!isFinite(s))return 0;let a=i.getX(n);if(!isFinite(a))return 0;if(!Rt.eq(s,a))return s-a;if(r.shape instanceof Ee){if(i.shape instanceof Ee)return this.getLineAngle(i.shape)-this.getLineAngle(r.shape);if(i.shape instanceof ze)return-this.compareArcLine(i.shape,r.shape,n);if(i.shape instanceof Nt)return this.compareSide(r,i,s,a,n);throw new Error("not support")}else if(r.shape instanceof ze){if(i.shape instanceof Ee)return this.compareArcLine(r.shape,i.shape,n);if(i.shape instanceof ze){let o=r.shape,l=i.shape,c=this.getArcAngle(o,n),u=this.getArcAngle(l,n);return Rt.eq(c,u)?o.sweepAngle*l.sweepAngle<=0?o.sweepAngle<=0?1:-1:o.sweepAngle>0?o.rx-l.rx:l.rx-o.rx:u-c}else{if(i.shape instanceof Nt)return this.compareSide(r,i,s,a,n);throw new Error("not support")}}else if(r.shape instanceof Nt){if(i.shape instanceof Ee)return this.compareSide(r,i,s,a,n);if(i.shape instanceof ze)return this.compareSide(r,i,s,a,n);if(i.shape instanceof Nt)return this.compareSide(r,i,s,a,n);throw new Error("not support")}else throw new Error("not support")}flipSides(r){let i=[];for(let n of r){if(n.polyIndex!==0)continue;let s=null,a=null;do{let o=n.shape.multiply3(Ue.ROT_90),l=n.start.multiply3(Ue.ROT_90),c=n.end.multiply3(Ue.ROT_90),u=new cy(o,l,c,n.polyGrp,n.polyIndex,n.chain);if(u.updateBbox(),s!=null?(s.next=u,u.previous=s):a=u,i.push(u),this.event.onSplitedSide(u),s=u,n.next!==null)n=n.next;else break}while(n.polyIndex!=0);a!=null&&(a.previous=s,s.next=a)}return i}connectSides(){let r=[];this.blocks.forEach(i=>i.chains.forEach(n=>{if(n.needReverse===!0&&n.reverse(),n.sides.forEach(o=>this.event.onResultSide(o)),n.status===0?r.push(n):n.status===1&&n.startNode&&(n.startNode.outChainSet.delete(n),n.endNode.inChainSet.delete(n)),!n.startNode)return;let s=new pr,a=!0;for(let o of n.sides){s.ext1(o.bbox());let l=s.build();if(l.width()>GP||l.height()>GP){a=!1;break}}a&&(n.startNode.outChainSet.delete(n),n.endNode.inChainSet.delete(n),n.startNode.merge(n.endNode),n.status===0&&r.pop())}));for(let i of r){let n=new cd;if(n.add(i),!i.startNode){this.fillSideGroups(n);continue}if(!i.startNode.outChainSet.has(i))continue;i.startNode.outChainSet.delete(i),i.endNode.inChainSet.delete(i);let s=i.startNode.outChainSet;for(;n.size()>0;){let a=n.getLast();if(a.endNode.outChainSet===s)break;let o=!1;for(let l of a.endNode.outChainSet)if(l.status===0){n.add(l),l.startNode.outChainSet.delete(l),l.endNode.inChainSet.delete(l),o=!0;break}o||n.removeLast()}n.size()>0&&this.fillSideGroups(n)}}fillSideGroups(r){let i=new MP;W2(r,(s,a)=>(i.add(a),!0));let n=i.polyline.area(.1);Math.abs(n)<1e-6||(n<0?this.outSideGroups.push(i):this.inSideGroups.push(i))}fillResult(){let r=0,i=new ly(10),n=this.outSideGroups.map((s,a)=>{s.outIndex=a,i.add(s);let o=[];o.push(s);for(let l of o)if(l.isUsed!==!0){l.isUsed=!0;for(let c of l.others)c.finalRing&&o.push(c.finalRing)}return o.filter(l=>l.isUsed===!0?(l.isUsed=!1,!0):!1).map(l=>(l.isUsed=!0,l.polyline))});this.inSideGroups.map(s=>{if(s.isUsed===!0)return;let a=i.search(s.chain.start.bbox());rSe(a,nSe,0,a.length);for(let o of a)if(o.chain.getWindingNum(s.chain.start)!==0){n[o.outIndex].push(s.polyline);break}});for(let s of n)this.event.onPolylineGroup(new Ws(s),r++)}getSortedEndpointsLineAsc(r,i){let n=r?"x":"y",s=new Set;for(let o of i){if(o.status!==2)continue;let l,c=Number.NEGATIVE_INFINITY;for(let u of o.sides)Math.abs(u.start[n]-u.end[n])>c&&(l=u,c=Math.abs(u.start[n]-u.end[n]));c!==0&&(s.add(l.start[n]),s.add(l.end[n]))}let a=Array.from(s);return tSe(a,zl.sortAsc,0,a.length),a}splitSides(r,i,n,s){if(r.inters.length===2){let u=new cy(r.shape,r.start,r.end,r.polyGrp,n++,this.curChain);return u.updateBbox(),i.push(u),this.curChain.sides.push(u),n}let{start:a,end:o}=r,l=new ne(o.x+(a.x-o.x)*2,o.y+(a.y-o.y)*2);ZCe(r.inters,(u,d)=>u[0].distance2(l)-d[0].distance2(l),0,r.inters.length);let c=null;for(let[u,d]of r.inters){if(!c)u.equals1(a)&&(c=u);else if(!u.equals1(c)){let A=sSe(r.shape,c,u);A instanceof ze&&Math.abs(A.sweepAngle)>190&&(A=new Ee(c,u));let h=new cy(A,c,u,r.polyGrp,n++,this.curChain);h.updateBbox(),i.push(h),this.curChain.sides.push(h),u.equals1(o)?c=null:c=u}d&&(this.curChain.sides.length===0?this.prevChain&&(d.inChainSet.add(this.prevChain),this.prevChain.endNode=d.merge(this.prevChain.endNode)):(this.prevChain=this.curChain,d.inChainSet.add(this.prevChain),this.prevChain.endNode=d.merge(this.prevChain.endNode),this.curChain=new Pg(r.chain.weight),s.push(this.curChain)),d.outChainSet.add(this.curChain),this.curChain.startNode=d.merge(this.curChain.startNode))}return n}splitSidesByInters(){this.blockOriginChainsIndex.forEach((r,i)=>{let n=[];this.blockChainsIndex[i]=n;for(let s of r){this.curChain=new Pg(s.weight),n.push(this.curChain);let a=this.curChain;this.prevChain=null;let o=0,l,c;for(let u of s.sides){let d=new Array;o=this.splitSides(u,d,o,n);for(let A of d)l!=null?(l.next=A,A.previous=l):c=A,l=A,this.event.onSplitedSide(A)}if(c.previous=l,l.next=c,a.startNode)this.curChain.sides.length===0?(n.pop(),this.curChain.startNode.outChainSet.delete(this.curChain),this.curChain.startNode.merge(a.startNode)):(a.startNode.inChainSet.add(this.curChain),this.curChain.endNode=a.startNode);else{if(a===this.curChain)continue;n.pop();for(let d of this.curChain.sides)d.chain=a;let u=this.curChain.sides.concat(a.sides);a.sides.length=0;for(let d of u)a.sides.push(d);this.curChain.startNode.outChainSet.delete(this.curChain),this.curChain.startNode.outChainSet.add(a),a.startNode=this.curChain.startNode}}})}seekIntersection(){let r=this.buildRTree();for(let i of this.sides){i.seekedIntersection=!0;for(let n of r.search(i.bbox().extendOfSize(1e-5))){if(n.seekedIntersection===!0||n===i.next&&n===i.previous)continue;let s=ip(i.shape,n.shape);if(s!==0){for(let a=s-2;a>=2;a-=2)for(let o=a-2;o>=0;o-=2)if(Rt.eq(Ye[a],Ye[o])&&Rt.eq(Ye[a+1],Ye[o+1])){Ye[o]=(Ye[a]+Ye[o])/2,Ye[o+1]=(Ye[a+1]+Ye[o+1])/2;for(let l=s-3;l>=a;l--)Ye[l]=Ye[l+2];s-=2;break}if(n===i.next){if(s<=2)continue;(Ye[0]-n.start.x)**2+(Ye[1]-n.start.y)**2<(Ye[2]-n.start.x)**2+(Ye[3]-n.start.y)**2&&(Ye[0]=Ye[2],Ye[1]=Ye[3]),s=2}else if(n===i.previous){if(s<=2)continue;(Ye[0]-n.end.x)**2+(Ye[1]-n.end.y)**2<(Ye[2]-n.end.x)**2+(Ye[3]-n.end.y)**2&&(Ye[0]=Ye[2],Ye[1]=Ye[3]),s=2}if(i.chain.blockIndex!==n.chain.blockIndex){let a,o;this.blockOriginChainsIndex[i.chain.blockIndex].length>this.blockOriginChainsIndex[n.chain.blockIndex].length?(a=i.chain.blockIndex,o=n.chain.blockIndex):(a=n.chain.blockIndex,o=i.chain.blockIndex);let l=this.blockOriginChainsIndex[a];for(let c of this.blockOriginChainsIndex[o])c.blockIndex=a,l.push(c);delete this.blockOriginChainsIndex[o]}for(let a=0;a<s;a+=2){let o=new ne(Ye[a],Ye[a+1]),l=new RP;i.inters.push([o,l]),n.inters.push([o,l]),this.event.onIntersect(o,i,n)}}}}}};var PS=pa(pv());var VP;Gf&&(typeof window<"u"?VP=window._MSG_BUS_=window._MSG_BUS_||new PS.MessageBus:VP=new PS.WorkerMessageBridge(new PS.MessageBus,self));var ob=class{extend(e,r){if(r===0)return e;{let i=Math.abs(r*2),n=new Array,s=new Array;for(let a of e){let o=[],l=[];a.points(.01,u=>{l.push(u)});let c=gG(l);c.length<l.length&&(a=Fr.build4(c));for(let u of a.primitives){let d=u.stroke(i,g1.ROUND,kl.CCW);n.push(d),o.push(d)}if(r>0){let u=this.getUnion([[a],o]);for(let d of u)s.push(d.items)}}if(r>0)return this.getUnion(s);if(r<0)return this.getSubtraction(e,n)}}getUnion(e){let r=e.map(i=>new Ws(i));return r.length<=1?r:this.runBoolean(Lf.UNION,e)}getUnion2(e){return this.run([Lf.UNION,...e])}_union_polyline(e){return this.run([Lf.UNION,...e])}_union_polygon(e){return this.run([Lf.UNION,...e])}getSubtraction(e,r){return this.run([Lf.DIFF,this.union(e),this.union(r)])}getSubtraction1(e){return this.runBoolean(Lf.DIFF,e)}getSubtraction2(e,r){return this.run([Lf.DIFF,e,r])}getIntersection(e){return this.runBoolean(Lf.INTERSECT,e)}getMutuallyExclusive(e){return this.runBoolean(Lf.XOR,e)}run(e){let r=y1(),i=XR(e,VP);return vA.runBoolean+=Up(r),i}runBoolean(e,r){let i=[e];return r.forEach(n=>i.push(this.union(n))),this.run(i).toPolylineGroups()}union(e){let r=new ab(!1,VP&&null),i=new YP(Y6.rule,new Zf(1),r);for(let s of e)i.addPolyline(s.asClose());i.simplify();let n=[];return r.plGrps.forEach(s=>{let a=[Pf(s.items[0])];if(a[0]){for(let o=1;o<s.items.length;o++){let l=Pf(s.items[o]);l&&a.push(l)}n.push(new va(a))}}),new Ga(n)}};var LS=Math.PI*2,K6=({x:t,y:e},r,i,n,s,a,o)=>{t*=r,e*=i;let l=n*t-s*e,c=s*t+n*e;return{x:l+a,y:c+o}},ASe=(t,e)=>{let r=e===1.5707963267948966?.551915024494:e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),i=Math.cos(t),n=Math.sin(t),s=Math.cos(t+e),a=Math.sin(t+e);return[{x:i-n*r,y:n+i*r},{x:s+a*r,y:a-s*r},{x:s,y:a}]},jq=(t,e,r,i)=>{let n=t*i-e*r<0?-1:1,s=t*r+e*i;return s>1&&(s=1),s<-1&&(s=-1),n*Math.acos(s)},fSe=(t,e,r,i,n,s,a,o,l,c,u,d)=>{cu(o)||Zn(o);let A=Math.pow(n,2),h=Math.pow(s,2),f=Math.pow(u,2),p=Math.pow(d,2),m=A*h-A*p-h*f;m<0&&(m=0),m/=A*p+h*f,m=Math.sqrt(m)*(a===o?-1:1);let y=m*n/s*d,g=m*-s/n*u,b=c*y-l*g+(t+r)/2,E=l*y+c*g+(e+i)/2,w=(u-y)/n,x=(d-g)/s,I=(-u-y)/n,C=(-d-g)/s,G=jq(1,0,w,x),U=jq(w,x,I,C);return o===0&&U>0&&(U-=LS),o===1&&U<0&&(U+=LS),[b,E,G,U]},pSe=({px:t,py:e,cx:r,cy:i,rx:n,ry:s,xAxisRotation:a=0,largeArcFlag:o=0,sweepFlag:l=0})=>{let c=[];if(n===0||s===0)return[];let u=Math.sin(a*LS/360),d=Math.cos(a*LS/360),A=d*(t-r)/2+u*(e-i)/2,h=-u*(t-r)/2+d*(e-i)/2;if(A===0&&h===0)return[];n=Math.abs(n),s=Math.abs(s);let f=Math.pow(A,2)/Math.pow(n,2)+Math.pow(h,2)/Math.pow(s,2);f>1&&(n*=Math.sqrt(f),s*=Math.sqrt(f));let[p,m,y,g]=fSe(t,e,r,i,n,s,o,l,u,d,A,h),b=Math.abs(g)/(LS/4);Math.abs(1-b)<1e-7&&(b=1);let E=Math.max(Math.ceil(b),1);g/=E;for(let w=0;w<E;w++)c.push(ASe(y,g)),y+=g;return c.map(w=>{let{x,y:I}=K6(w[0],n,s,d,u,p,m),{x:C,y:G}=K6(w[1],n,s,d,u,p,m),{x:U,y:_}=K6(w[2],n,s,d,u,p,m);return{x1:x,y1:I,x2:C,y2:G,x:U,y:_}})};function mm(t){let e=pSe({px:t.x1,py:t.y1,cx:t.x2,cy:t.y2,xAxisRotation:t.angle,sweepFlag:t.sweep,largeArcFlag:t.large,rx:t.rx,ry:t.ry}),r=["M",t.x1,t.y1];for(let i of e)r.push("C",i.x1,i.y1,i.x2,i.y2,i.x,i.y);return r.map(i=>cu(i)?xz(i):i).join(" ")}var OS=pa(pv());var jP;Gf&&(typeof window<"u"?jP=window._MSG_BUS_=window._MSG_BUS_||new OS.MessageBus:jP=new OS.WorkerMessageBridge(new OS.MessageBus,self));function mSe(t,e,r){if((r==null?void 0:r.fill)===!1){let s=!1,a=t.items.map(o=>o.hasBackLine()?(s=!0,o.primitives.map(c=>Fr.build2([c]))):[o]);s&&(t=new Ws(a.flat()))}let i=new ob;if(e===0)return t;let n=[];if(r!=null&&r.fill)i.union(t.items).items.forEach(a=>{let o=new va([a.items[0]]).extend(e),l=[];a.items.slice(1).forEach(d=>{let A=new va([d.reverse()]).extend(-e);l.push(A)});let c=i.getUnion2(l);i.getSubtraction2(o,c).toPolylineGroups().forEach(d=>{n.push(...d.items)})});else{let l=function(c){if(c instanceof Ee)return c.direct.x===0&&c.direct.y===0;if(c instanceof ze)return c.sweepAngle===0;if(c instanceof Nt){let u=new Set(c.controls.map(A=>A.x)),d=new Set(c.controls.map(A=>A.y));return u.size===1&&d.size===1}else throw new Error("not support")};if(e<0)throw Error("offsetPolylineGroup: config.fill === false && offsetDistance < 0");let s=Math.abs(e*2),a=[];t.items.forEach(c=>{c.primitives.forEach(u=>{if(l(u))return;if(u instanceof Nt){let A=[];XB(u,A),A.forEach(h=>{let f=va.buildByStroke(h,s,g1.ROUND,.1,jP);f&&a.push(f)});return}let d=va.buildByStroke(u,s,g1.ROUND,.1,jP);d&&a.push(d)})}),i._union_polygon(a).items.forEach(c=>{c.items.forEach(u=>{n.push(u)})})}return new Ws(n)}function Lg(t,e,r){return mSe(t,e,r)}function gSe(t,e){if(!(t!=null&&t.length))return[];let r=[],i=[],n=new ob;t.forEach(o=>{r.push(n.union(o.items))}),e.forEach(o=>{i.push(n.union(o.items))});let s=n.getUnion2(r),a=n.getUnion2(i);return n.getSubtraction2(s,a).toPolylineGroups()}function Qq(t,e){return gSe(t,e)}function ud(t,e={ccw:!1}){let r=(e==null?void 0:e.ccw)===!0,{x:i,y:n,endX:s,endY:a,rx:o,ry:l,rotation:c,isCCW:u,matrix:d}=t,A=j=>`${j.x} ${j.y}`;if(d){if(!o&&!l){let He=nr.rectShapeNoRadius(d);return r&&He.reverse(),`M ${He.map(qe=>qe.x+" "+qe.y).join(" L ")} Z`}let{width:j,height:$}=nr.getRectShapeForAttr(d);if(o>=j/2&&l>=$/2){let He=nr.createMatrixFrom6(d),rt=new ne(1,1).multiply3(He),qe=He.multiply3(Ue.scale(.5,.5).setOrigin1(rt));return d=nr.getMatrix6FromMatrix(qe),zA({matrix:d},e)}let B=.551915024494,M=0,v=0,N=1,R=1;o=Math.min(o/j,.5),l=Math.min(l/$,.5);let q=[M,M+o*(1-B),M+o,N-o,N-o+o*B,N],P=[v,v+l*(1-B),v+l,R-l,R-l+l*B,R],z=[0,0,1,2,3,4,5,5,5,5,4,3,2,1,0,0],W=[2,1,0,0,0,0,1,2,3,4,5,5,5,5,4,3],oe=z.map((He,rt)=>new ne(q[He],P[W[rt]])),Ae=nr.createMatrixFrom6(d),me=oe.map(He=>He.multiply3(Ae));r&&me.reverse();let ve=He=>`${A(me[He])} C ${A(me[He+1])} ${A(me[He+2])} ${A(me[He+3])}`;return`M ${ve(0)} L ${ve(4)} L ${ve(8)} L ${ve(12)} Z`}let h=u?-c:+c,f=new ne(i,a),p=j=>j.rotateD(f,h),m=j=>new ne(j[0],j[1]);if(!+o||!+l||+o<=0||+l<=0){let $=[[i,n],[s,n],[s,a],[i,a]].map(m);return r&&$.reverse(),`M ${(h?$.map(p):$).map(A).join(" L ")} Z`}let y=(i+s)/2,g=(n+a)/2,b=Math.abs(s-i),E=Math.abs(a-n);if(o=Math.min(o,b/2),l=Math.min(l,E/2),o>=b/2&&l>=E/2)return zA({cx:y,cy:g,rx:o,ry:l,rotation:c,isCCW:u},e);let w=.551915024494,x=[i,i+o*(1-w),i+o,s-o,s-o+o*w,s],I=[n,n+l*(1-w),n+l,a-l,a-l+l*w,a],C=[0,0,1,2,3,4,5,5,5,5,4,3,2,1,0,0],G=[2,1,0,0,0,0,1,2,3,4,5,5,5,5,4,3],U=C.map((j,$)=>m([x[j],I[G[$]]]));r&&U.reverse();let _=h?U.map(p):U,H=j=>`${A(_[j])} C ${A(_[j+1])} ${A(_[j+2])} ${A(_[j+3])}`;return`M ${H(0)} L ${H(4)} L ${H(8)} L ${H(12)} Z`}function zA(t,e={ccw:!1}){let r=(e==null?void 0:e.ccw)===!0,{rx:i,ry:n,cx:s,cy:a,rotation:o,isCCW:l,matrix:c}=t;if(c){let b=nr.calcuEllipse(c);i=b.a,n=b.b,s=b.cx,a=b.cy,o=b.degree}let u=.551915024494,d=[1,1,u,0,-u,-1,-1,-1,-u,0,u,1,1],A=[0,u,1,1,1,u,0,-u,-1,-1,-1,-u,0],h=l?-o:+o,f=new ne(0,0),p=b=>{let E=new ne(d[b]*i,A[b]*n);return h&&(E=E.rotateD(f,h)),`${E.x+s} ${E.y+a}`},m=b=>`M ${p(b)}`,y=b=>`C ${p(b)} ${p(b+1)} ${p(b+2)}`;return r&&A.reverse(),`${m(0)} ${y(1)} ${y(4)} ${y(7)} ${y(10)}`}function lb(t){switch(t.cmdKey){case"rect":return ud(t);case"ellipse":return zA(t);case"group":return t.d;case"obj":return J6(t);case"text":return ySe(t);case"arc":return mm(t);default:Zn(t);break}}function J6(t){let e=nr.rectShapeNoRadius(t.matrix);return`M ${e[0].x+" "+e[0].y} 
	L ${e.slice(1).map(i=>i.x+" "+i.y).join(" ")} Z`}function zq(t,e={ccw:!1}){let{cx:r,cy:i,r:n}=t;return zA({cx:r,cy:i,rx:n,ry:n},e)}function ySe(t){let e=In.convertJsonCache2PolyLines({d:t.d},"group"),r=Ue.MIRROR_Y.multiply3(nr.createMatrixFrom6(t.matrix).multiply3(Ue.MIRROR_Y)),i=e.multiply3(r).round(4);return ql(i.items,!1)}function Xq(t,e){if(!e||e<0||!t.items.length)return[];let r=Lg(t,e/2,{fill:!1});return r?[r]:[]}var QP=class{constructor(){}parser(e,r){let i=e.tagName,n,s=e.id;switch(i){case"ellipse":n=zA(r.ellipse[s]);break;case"rect":n=ud(r.rect[s]);break;case"polyline":n=this.transferPolylineToPath(e);break;case"path":n=e.getAttribute("d");break;case"g":n=this.transferText(e,r);break;case"image":n=this.transferImageObj(r.obj[s]);break;default:throw new Error(i)}return n}jsonCacheParser(e,r){let i;switch(r){case"ellipse":i=this.transferEllipseObj(e);break;case"rect":i=this.transferRectObj(e);break;case"group":i=e.d;break;case"arc":i=mm(e);break;case"text":{i=this.transferTextObj(e);break}case"obj":{i=this.transferImageObj(e);break}}return i}transferText(e,r){let i=Ue.MIRROR_Y.multiply3(nr.createMatrixFrom6(r.text[e.id].matrix).multiply3(Ue.MIRROR_Y)),n=e.querySelector("path").getAttribute("d"),a=Jn(n).map(l=>l.multiply3(i)),[o]=mS(a,!1);return o}transferPolylineToPath(e){let{points:r}=e,i=e.style.fill&&e.style.fill!="none",n=Array.from(r).reduce((a,o)=>(a+=` ${o.x} ${o.y}`,a),"");return`M ${r[0].x} ${r[0].y} L${n} ${i?"z":""}`}transferEllipseObj(e){return zA(e)}transferRectObj(e){return ud(e)}transferImageObj(e){return J6(e)}transferTextObj(e){let{cacheWidth:r,cacheHeight:i,hAlign:n,vAlign:s,rotation:a}=e,o=bSe(r,i,void 0,void 0,n,s,a,void 0,void 0,void 0),c=Jn(e.d).map(d=>d.multiply3(o)),[u]=mS(c,!1);return u}},$6=class{constructor(){this.bool=new ob}convertSvg2Polylines(e,r){let i=new QP,n=[];for(let s of e){let a=i.parser(s,r),o=Jn(a);n.push(o)}return n}convertData2PolylineCached(){let e=new Map;return r=>{let i=[];for(let n of r)if(e.has(n.gId))i.push(e.get(n.gId));else{let s=this.convertData2Polyline([n]);i.push(s[0]),e.set(n.gId,s[0])}return i}}convertData2Polyline(e){let r=[];for(let i of e){let n=lb(i),s=Jn(n);r.push(s)}return r}convertJsonCache2PolyLines(e,r){let n=new QP().jsonCacheParser(e,r),s=Jn(n);return new Ws(s)}convertPolylines2Svg(e,r=!1,i=!1,n=.01){let s=[];if(r)e.length&&s.push(...mS(T_(e.map(a=>a.items)),i,n));else for(let a of e)s.push(...mS(a.items,i,n));return s}boolExclusive(e){return this.bool.getMutuallyExclusive(e)}boolSubtraction(e,r){return e.length?Qq([new Ws(e)],r.length?[new Ws(r)]:[]):[]}boolSubtraction1(e){return this.bool.getSubtraction1(e)}boolIntersection(e){return this.bool.getIntersection(e)}boolAggregate(e){return e.length===1&&(e=e[0].map(i=>[i])),this.bool.getUnion(e)}extend(e,r){return r===0?[new Ws(e)]:this.bool.extend(e,r)}},In=new $6;function bSe(t,e,r,i,n,s,a,o,l,c){let u=0;switch(n){case 1:u=-t/2;break;case 2:u=-t;break}let d=0;switch(s){case 1:d=-e/2;break;case 2:d=-e;break}let A=new Ue;return A=A.scale(1,-1),A=A.rotateD(a),o&&(A=A.multiply3(Ue.MIRROR_X)),l<0&&(A=Ue.MIRROR_X.multiply3(A),l=-l),c<0&&(A=Ue.MIRROR_Y.multiply3(A),c=-c),A=A.translate(r,-i),A=Ue.scale(l,-c).translate(u,-d).multiply3(A),A}var Z6=class{showShapeControl(e,r){eA();let i=Fe(e);if(!i)throw new Error("");Ja([i],{create8Dots:!0}),r==="click"&&(pt.select(i),Et("panel_updateAttrPanel"))}getData(e){let r=[];for(let i of e){let n=Pi(i),s,a,o,l=i.id,c;switch(n){case"rect":{c=te.getRect(l);let f=nr.getRectShapeForAttr(c.matrix),[p,m]=te.translateByOrigin(f.x,f.y+f.height);s=p,a=m;break}case"ellipse":{c=te.getEllipse(l);let{cx:f,cy:p}=tn.getEllipseFromMatrix(c.matrix),[m,y]=te.translateByOrigin(f,p);s=m,a=y;break}case"obj":c=te.getObj(l);let u=Ns.getImageShapeForAttr(c.matrix),[d,A]=te.translateByOrigin(u.x,u.y+u.height);s=d,a=A;break;case"text":{c=te.getText(l);let{x:f,y:p}=ps.getTextForAttrs(c),[m,y]=te.translateByOrigin(f,p);s=m,a=y;break}case"arc":case"group":c=te.getById(l).json;let h=El(Fe(l));s=h.x,a=h.y+h.height;break;default:throw new Error(n)}o=JQ[c.layer],s=ti(s,"pixel","mm"),a=ti(-a.toFixed(2),"pixel","mm"),s=+Number(s).toFixed(2)+"mm",a=+Number(a).toFixed(2)+"mm",r.push({cmd:n,position:{x:s,y:a},layerName:o,eid:l})}return r}},ek=new Z6;function tk(t){let e=t.length,r=[];for(let i=0;i<e;i+=2)r.push({x:t[i],y:t[i+1]});return r}function qq(){let t=[],e=tl.data.event,{x:r,y:i}=Hn(e,!1),n=NS(r,i);t.push(...n);let s=Og(r,i);t.push(...s.map(d=>Fe(d)));let a=oE(r,i);t.push(...a);let o=RS(r,i);t.push(...o);let l=cb(r,i);t.push(...l);let c=np(r,i);t.push(...c.map(d=>Fe(d))),t=Array.from(new Set(t));let u=ek.getData(t);console.log(u),Et("panel/show-select-element",[{x:e.clientX,y:e.clientY},u])}function Fo(t){return["dimension","dimensionAngle","dimensionLength","dimensionRadius","auxiliaryLine","auxiliaryPoint"].includes(t)}var Va=document.getElementById.bind(document);function zP(t){let e=t.target;if(e==document||e==document.documentElement||e==document.body)return;let r=XA(e),i;lE.isShowContextMenu(t)?i=e:r&&te.getById(r.id).json.layer!=7&&(i=r);let{x:n,y:s}=Hn(t,!1);return i=i||ik(n,s)[0],i=i||rk(n,s)[0],i=i||NS(n,s).values().next().value,i=i||Va(Og(n,s)[0]),i=i||Va(np(n,s)[0]),i=i||cb(n,s)[0],i=i||nk(n,s)[0],i=i||sk(n,s)[0],i=i||ak(n,s)[0],i=i||ok(n,s)[0],i=i||RS(n,s)[0],i}function Og(t,e){let r=[];return te.iteratorEllipse(i=>{if(rn.eleIsHide(i))return;let n=nr.createMatrixFrom6(i.matrix),s=new Ue(n.getInverseMatrix().data),a=new ne(t,e).multiply3(s),o=HA(a.x,a.y,0,0);if(Math.abs(o-1)<.01){r.push(i.gId);return}if(i.layer===4&&o<1){r.push(i.gId);return}![3,7].includes(i.layer)&&i.fillColor!=="none"&&i.displayFill&&Sh(0,0,a.x,a.y,1,1)<=1&&r.push(i.gId)}),r}function np(t,e,r){let i=[];return te.iteratorArc(n=>{if(rn.eleIsHide(n)||n.x1===n.x2&&n.y1===n.y2)return;let s=n.strokeWidth/2;r!=null&&r.around&&(s=r.around);let a=new pr().ext6(t,e).ext7(s).build(),o=new Bn(n).points(1);for(let l of o)if(a.isContains(l)){i.push(n.gId);return}}),i}function NS(t,e){let r=new Set,i=$u();if(!i["all-element-type"].rect.checked||!i["all-element-type"].rect.visible)return r;let n=te.getRect(),s=Th();for(let a in n){let o=te.getRect(a);if(rn.eleIsHide(o))continue;let l=ud(o),c=Jn(l),u=[];for(let h of c)h.points(.5,f=>{u.push(new ne(f.x,-f.y))});let d=Fr.build4(u);if(o.displayFill&&o.fillColor!=="none"&&![3,7].includes(o.layer)){let h=XP(t,e),{minX:f,maxX:p,minY:m,maxY:y}=h,g=[{x:f,y:m},{x:p,y:m},{x:p,y},{x:f,y}];for(let b of g)if(kq.inPolyline(new ne(b.x,b.y),d)){r.add(Va(a));break}}else for(let h=1;h<u.length;h++){let f=u[h-1],p=u[h];if(Pc({x:t,y:e},f,p).d<s){r.add(Va(a));break}}}return r}function RS(t,e){let r=XP(t,e),i=new Set,n=$u();if(!n["all-element-type"].text.checked||!n["all-element-type"].text.visible)return Array.from(i);let s=te.getText();for(let a in s){if(rn.eleIsHide(te.getText(a)))continue;let o=Va(a),l=Ts.text.get(o,"multi").slice(0,8),c=new pr;for(let g=0;g<l.length;g+=2)c.ext6(l[g],l[g+1]);if(!c.build().intersection1(r))continue;let{minX:A,maxX:h,minY:f,maxY:p}=r,m=[{x:A,y:f},{x:h,y:f},{x:h,y:p},{x:A,y:p}],y=tk(l);for(let g of m)if(tm(g,y)){i.add(Va(a));continue}}return Array.from(i)}function rk(t,e){let r=te.getAuxiliaryLine(),i=[];for(let n in r){let s=r[n];switch($d(s.rotation)){case"horizontal":{Math.abs(e-s.y)<Th()&&i.push(Va(s.gId));break}case"vertical":{Math.abs(t-s.x)<Th()&&i.push(Va(s.gId));break}}}return i}function ik(t,e){let r=te.getAuxiliaryPoint(),i=[],n=new ne(t,e);for(let s in r){let a=r[s];new ne(a.x,a.y).distance1(n)<Th()&&i.push(Va(a.gId))}return i}function nk(t,e){let r=[],i=Th(),n={x:t,y:e};return te.iteratorDimension(s=>{let a=Pc(n,s.start.primitivePoint,s.start.otherPoint).d;if(a<i){r.push(Va(s.gId));return}if(a=Pc(n,s.end.primitivePoint,s.end.otherPoint).d,a<i){r.push(Va(s.gId));return}if(a=Pc(n,s.start.otherPoint,s.end.otherPoint).d,a<i){r.push(Va(s.gId));return}let o=new Ua(s).getTextBBoxOutline();if(gg(n,o)){r.push(Va(s.gId));return}}),r}function sk(t,e){let r=[],i={x:t,y:e},n=Th();return te.iteratorDimensionLength(s=>{let a={x:s.measureX1,y:s.measureY1},o={x:s.measureX2,y:s.measureY2},l={x:s.x1,y:s.y1},c={x:s.x2,y:s.y2},u=Pc(i,a,l).d;if(u<n){r.push(Va(s.gId));return}if(u=Pc(i,o,c).d,u<n){r.push(Va(s.gId));return}if(u=Pc(i,a,o).d,u<n){r.push(Va(s.gId));return}let d=new ya(s).getTextBBoxOutline();if(gg(i,d)){r.push(Va(s.gId));return}}),r}function ak(t,e){let r=[],i={x:t,y:e},n=Th();return te.iteratorDimensionAngle(s=>{let a={x:s.angleX,y:s.angleY},o={x:s.x1,y:s.y1},l={x:s.x2,y:s.y2},c=Pc(i,a,o).d;if(c<n){r.push(Va(s.gId));return}if(c=Pc(i,a,l).d,c<n){r.push(Va(s.gId));return}let u=new ga(s).getTextBBoxOutline();if(gg(i,u)){r.push(Va(s.gId));return}}),r}function ok(t,e){let r=[],i={x:t,y:e},n=Th();return te.iteratorDimensionRadius(s=>{if(Pc(i,{x:s.x1,y:s.y1},{x:s.x2,y:s.y2}).d<n){r.push(Va(s.gId));return}let o=new ca(s).getTextBBoxOutline();if(gg(i,o)){r.push(Va(s.gId));return}}),r}function cb(t,e){let r=XP(t,e),i=new Set,n=Th();return te.iteratorGroup(s=>{let a=s.gId;if(rn.eleIsHide(s))return;let o=El(Va(a));if(!new pr().ext6(o.x,o.y).ext6(o.x+o.width,o.y+o.height).build().intersection1(r))return;let u=s.fillColor!=="none"&&![3,7].includes(s.layer);s.layer===2&&(u=!0);let d=Jn(s.d),A=[];for(let h of d)h.points(.5,f=>{A.push({x:f.x,y:-f.y})});if(u){let{minX:h,maxX:f,minY:p,maxY:m}=r,b="M "+[{x:h,y:p},{x:f,y:p},{x:f,y:m},{x:h,y:m}].map(x=>x.x+" "+x.y).join(" L ")+" z",E=Jn(b);In.boolIntersection([E,d]).length&&i.add(Va(a))}else for(let h=1;h<A.length;h++){let f=A[h-1],p=A[h];if(Pc({x:t,y:e},f,p).d<n){i.add(Va(a));break}}}),Array.from(i)}function oE(t,e){let r=new Set;if(!$u()["all-element-type"].obj.checked)return[];let n=te.getObj(),s=XP(t,e);for(let a in n){if(rn.eleIsHide(te.getObj(a)))continue;let o=new pr,l=Ts.image.get(Va(a),"multi").slice(0,8);for(let y=0,g=l.length;y<g;y+=2)o.ext6(l[y],l[y+1]);if(!o.build().intersection1(s))continue;let{minX:d,maxX:A,minY:h,maxY:f}=s,p=[{x:d,y:h},{x:A,y:h},{x:A,y:f},{x:d,y:f}],m=tk(l);for(let y of p)if(tm(y,m)){r.add(Va(a));continue}}return Array.from(r)}function Wq(t,e){let r=[];return te.iteratorDimensionAngle(i=>{let n=new ga(i).findContainsControlPoint(t,e);n&&r.push({parentId:i.gId,id:n})}),te.iteratorDimensionLength(i=>{let n=new ya(i).findContainsControlPoint(t,e);n&&r.push({parentId:i.gId,id:n})}),te.iteratorDimensionRadius(i=>{let n=new ca(i).findContainsControlPoint(t,e);n&&r.push({parentId:i.gId,id:n})}),r}function ub(t,e,r){if(r=r||qP().filter(i=>!Fo(i.cmdKey)),r.length){let i=xP(r);if(Mr.extendRect(i).isContains2(t,e))return!0}return!1}function Kq(t,e){let r,i=Fr.build6(Mr.extendRect(t));switch(e.cmdKey){case"dimension":let{start:n,end:s}=e;r=Fr.build7([new Ee(new ne(n.primitivePoint.x,n.primitivePoint.y),new ne(n.otherPoint.x,n.otherPoint.y)),new Ee(new ne(s.primitivePoint.x,s.primitivePoint.y),new ne(s.otherPoint.x,s.otherPoint.y)),new Ee(new ne(n.otherPoint.x,n.otherPoint.y),new ne(s.otherPoint.x,s.otherPoint.y))]);break;case"dimensionLength":let{measureX1:a,measureY1:o,measureX2:l,measureY2:c}=e;r=Fr.build7([new Ee(new ne(a,o),new ne(e.x1,e.y1)),new Ee(new ne(l,c),new ne(e.x2,e.y2)),new Ee(new ne(a,o),new ne(l,c))]);break;case"dimensionAngle":let{angleX:u,angleY:d}=e;r=Fr.build7([new Ee(new ne(u,d),new ne(e.x1,e.y1)),new Ee(new ne(u,d),new ne(e.x2,e.y2))]);break;case"dimensionRadius":r=Fr.build7([new Ee(new ne(e.x1,e.y1),new ne(e.x2,e.y2))]);break;case"auxiliaryLine":case"auxiliaryPoint":let A=un(e,e.cmdKey);return yz(t,A);default:break}for(let n of i.primitives)for(let s of r.primitives)if(ip(n,s))return!0;return!1}function XP(t,e){let r=Th();return new pr().ext6(t,e).ext7(r).build()}var MS=class MS extends Am{constructor(r){super();this.headSelected=!1;this.tailSelected=!1;this.textSelected=!1;this.layer=8;this.name="";this.locked=!1;this.visible=!0;this.rotation=0;this.textOffsetX=10;this.rememberedLineLength=0;this.name=r.name,this.gId=r.gId,this.x1=r.x1,this.y1=r.y1,this.x2=r.x2,this.y2=r.y2,this.textX=r.textX,this.textY=r.textY,this.measureId=r.ellipseId,this.visible=r.visible,this.rotation=r.rotation,this.container=r.gId&&Fe(r.gId)}getRxRyPixel(){let r=Og(this.x1,this.y1),i=r[0];if(r.length===0){let n=np(this.x1,this.y1);if(n.length===0)return this.measureId=null,{rx:0,ry:0};i=n[0]}return this.setMeasureId(i),{rx:this.rx,ry:this.ry}}setMeasureId(r){this.measureId=r;let{json:i,cmdKey:n}=te.getById(r);if(Kr(i))return this;if(n==="ellipse"){let{cx:s,cy:a,rx:o,ry:l}=tn.getEllipseFromMatrix(i.matrix);this.cx=s,this.cy=a,this.rx=o,this.ry=l}else if(n==="arc"){let a=new Bn(i).vectorCenter();this.cx=a.x,this.cy=a.y,this.rx=i.rx,this.ry=i.ry}return this}setHeadFree(r,i){return this.x1=r,this.y1=i,this.measureId=null,this}setTailFree(r,i){return this.x2=r,this.y2=i,this}vectorEllipseCenter(){return new ne(this.cx,this.cy)}getContainer(){return this.measureId&&this.setMeasureId(this.measureId),this.render(),this.container}setHead(r,i){let{json:n,cmdKey:s}=te.getById(this.measureId),a;s==="arc"?a=new Bn(n).getMatrix():a=nr.createMatrixFrom6(n.matrix);let o=new Ue(a.getInverseMatrix().data),l=new ne(r,i).multiply3(o).angle(ne.ORIGIN),c=Math.sin(l),u=Math.cos(l),d=new ne(u,c).multiply3(a);if(s==="arc"){let A=new Bn(n),h=new ne(d.x,d.y),f=A.vectorStart().sub(h).cross(A.vectorEnd().sub(h));if(n.sweep===0){if(f<0)return this}else if(f>0)return this}return this.x1=d.x,this.y1=d.y,this}vectorHead(){return new ne(this.x1,this.y1)}calcTail(r,i){let n=new ne(r,i).angleD2(this.vectorEllipseCenter()),s=new ne(r,i).rotateD(this.vectorEllipseCenter(),this.getHeadAngle()-n);return this.setTail(s),this}setTail(r){this.x2=r.x,this.y2=r.y}vectorTail(){return new ne(this.x2,this.y2)}toData(){let r={gId:this.gId,cmdKey:"dimensionRadius",layer:this.layer,name:this.name,locked:this.locked,visible:this.visible,rotation:this.rotation,x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2,textX:this.textX,textY:this.textY,ellipseId:this.measureId},i=te.getDimensionRadius(this.gId);return Kr(i)?r:(Object.assign(i,r),i)}setData(){let r=this.toData();return te.setDimension(r.gId,r,"dimensionRadius"),this}getPath(){let r=this.renderTextLine(void 0,!0),i=this.renderText(!0),n=this.createStartTriangle();return{text:i,line:r+"M"+ge(n,"points")}}render(r=!1){let i=this.renderTextLine(),n=this.renderText(),s=this.createStartTriangle(),a=this.renderCircle(this.vectorHead(),this.getId("head")),o=this.renderCircle(this.vectorTail(),this.getId("tail")),l=this.renderCircle({x:this.textX,y:this.textY},this.getId("text"));if(!this.container){let c=Hr("g",{id:this.gId,class:"dimensionRadius",c_partid:"dimensionRadius",layer:this.layer,display:this.visible?"":"none"});!r&&Ar.appendTargetLayer(c,8,!0,{cmdKey:"dimensionRadius"}),this.container=c,c.appendChild(i),c.appendChild(n),c.appendChild(s),c.appendChild(a),c.appendChild(o),c.appendChild(l)}return this.container.outerHTML}getSvg(){return this.render(!0)}getId(r){return{head:this.gId+"-head-key-p",tail:this.gId+"-tail-key-p",text:this.gId+"-text-key-p"}[r]}createRect(r,i,n,s){let a=this.container?this.container.querySelector("#"+r):Hr("rect"),o=this.extendLineAttr({id:r,class:i,x:-.5,y:-.5,width:1,height:1,fill:"#00FFFF",stroke:"none"});ge(a,o);let l=4/X.gZoom*2,c=Ue.scale(l,l).translate(n,s),u=nr.getMatrix6FromMatrix(c);return xr.updateTransform(u,a),a}translate(r,i){return this.x1+=r,this.y1+=i,this.x2+=r,this.y2+=i,this.calcTextPoint(),this}rotateSelf(r,i){let n=r-this.rotation;if(n===0)return;let s=Lc([this.x1,this.y1,this.x2,this.y2,this.textX,this.textY],n,i.x,i.y);return this.x1=s[0],this.y1=s[1],this.x2=s[2],this.y2=s[3],this.textX=s[4],this.textY=s[5],this.rotation=r,this.setData().render(),this}multiply3(r){let i=this.vectorHead().multiply3(r);this.x1=i.x,this.y1=i.y;let n=this.vectorTail().multiply3(r);this.setTail(n);let s=new ne(this.textX,this.textY).multiply3(r);this.textX=s.x,this.textY=s.y,this.setData().render()}unmount(){Cr(this.container)}renderTextLine(r,i=!1){let n=this.vectorHead();return r=r||this.vectorTail(),i?["M",n.x,n.y,r.x,r.y].join(" "):this.renderLine(n,r,this.gId+"-text-line")}lineAlignText(){let{width:r}=this.getTextBBox(this.container.querySelector("text").textContent);r/=2;let i=this.vectorHead().distance1(this.vectorTail());if(r<i)return this;let n=this.getLineRotation(),s=this.vectorHead().add1(r+this.textOffsetX,0).rotateD(this.vectorHead(),n);return this.renderTextLine(s),this.setTail(s),this}getHeadAngle(){let r=this.vectorHead().angleD2(this.vectorEllipseCenter());return Cs(r)}getLineRotation(){return this.vectorTail().angleD2(this.vectorHead())}calcTextPoint(){let r=this.getLineRotation(),i=new ne(this.textOffsetX,-10).rotateD(new ne(0,0),r),n=this.vectorHead().add(i);return this.textX=n.x,this.textY=n.y,this}getTextMatrix(){let{rx:r,ry:i}=this.getRxRyPixel(),n=this.container?this.container.querySelector("text"):Hr("text",{x:0,y:0});r=Sr(Yl(r),2),i=Sr(Yl(i),2),n.textContent="Rx"+r+"mm,Ry"+i+"mm";let s=this.vectorTail().angleD2(this.vectorHead()),a=Ue.translate(this.textX,this.textY),o=n.getBBox();!o.width&&!o.height&&(o=this.getTextBBox(n.textContent));let l=.5;return a=Ue.scale(l,l).rotateD(s).multiply3(a),{text:n,m3:a,bbox:o}}getTextBBoxOutline(){let{m3:r,bbox:i}=this.getTextMatrix(),n=Mr.extendRect(i),s=[];for(let a of[n.LL(),n.UL(),n.UR(),n.LR()])s.push(a.multiply3(r));return s}renderText(r=!1){let{text:i,m3:n}=this.getTextMatrix();if(r)return{textContent:i.textContent,m3:n};let s=nr.getMatrix6FromMatrix(n);return xr.updateTransform(s,i),i}createStartTriangle(){let r=this.vectorHead(),i=this.vectorTail().angleD2(this.vectorHead());return this.createTriangle([[5,-5],[0,0],[5,5]],i,r,this.gId+"-start-triangle")}findContainsControlPoint(r,i){let n=5;if(Qd(r,i,this.x1,this.y1,n))return this.getId("head");if(Qd(r,i,this.x2,this.y2,n))return this.getId("tail");if(Qd(r,i,this.textX,this.textY,n))return this.getId("text")}setControlDotSelected(r){switch(r){case this.getId("head"):this.headSelected=!0,this.rememberedLineLength=this.vectorHead().distance1(this.vectorTail());break;case this.getId("tail"):this.tailSelected=!0;break;case this.getId("text"):this.textSelected=!0;break}}makeTailHeadPointCenter(){let r=this.rememberedLineLength,i=this.vectorHead().angleD2(this.vectorEllipseCenter()),n=this.vectorHead().add1(r,0).rotateD(this.vectorHead(),i);return this.setTail(n),this}moveControlPoint(r,i){if(this.headSelected){if(this.measureId){let n=this.x1+r,s=this.y1+i;this.setHead(n,s).makeTailHeadPointCenter()}else this.x1+=r,this.y1+=i;this.calcTextPoint()}if(this.tailSelected){let n=Ez(this.x2+r,this.y2+i,this.x1,this.y1,this.x2,this.y2);this.x2=n.x,this.y2=n.y,this.calcTextPoint()}return this.textSelected&&(this.textX+=r,this.textY+=i),this.setData(),this}static zoom(){te.iteratorDimensionRadius(r=>{let i=new MS(r).render();i=null})}};MS.updateMeasureValue=Vd(MS.zoom);var ca=MS;function Hc(t,e,r){switch(r=e.gId||r,t){case"rect":return kS(e,r);case"group":return qA(e,r);case"ellipse":return FS(e,r);case"text":return cE(e,r);case"obj":return US(e,r);case"dimension":return lk(e,r);case"auxiliaryLine":return HS(e,r);case"auxiliaryPoint":return hb(e,r);case"dimensionLength":return xSe(e,r);case"dimensionAngle":return ESe(e,r);case"dimensionRadius":return wSe(e,r);case"arc":return Ng(e,r);default:console.error(t);break}}function kS(t,e){if(!t||Kr(t)){Cr(Fe(e)),te.setRect(e);return}let r=Ba.rect(t),i=rl(r),n=Fe(e);return n?n.replaceWith(i):Ar.appendTargetLayer(i,t.layer),te.setRect(e,t),Fe(e)}function qA(t,e){if(e=e||t.gId,!t||Kr(t)){Cr(Fe(e)),te.setGroup(e);return}let r=Ba.group(t),i=rl(r),n=Fe(e);return n?n.replaceWith(i):Ar.appendTargetLayer(i,t.layer),te.setGroup(e,t),Fe(e)}function FS(t,e){if(!t||Kr(t)){Cr(Fe(e)),te.setEllipse(e);return}let r=Ba.ellipse(t),i=rl(r),n=Fe(e);return n?n.replaceWith(i):Ar.appendTargetLayer(i,t.layer),te.setEllipse(e,t),Fe(e)}function Ng(t,e){if(e=t.gId||e,!t||Kr(t)){Hi.renderer.removeNode(e),te.setArc(e);return}let r=Ba.arc(t),i=document.getElementById(e),n=rl(r);return i?i.replaceWith(n):Ar.appendTargetLayer(n,t.layer),te.setArc(e,t),Fe(e)}function cE(t,e){if(!t||Kr(t)){Cr(Fe(e)),te.setText(e);return}let r=Ba.text(t),i=rl(r),n=Fe(e);return n?n.replaceWith(i):Ar.appendTargetLayer(i,t.layer),te.setText(e,t),Fe(e)}function US(t,e){if(e=e||t.gId,!t||Kr(t)){Cr(Fe(e)),te.setObj(e);return}let r=Ba.obj(t),i=rl(r),n=Fe(e);return n?n.replaceWith(i):Ar.appendTargetLayer(i,t.layer),te.setObj(e,t),Fe(e)}function lk(t,e){if(e=e!=null?e:t.gId,!t||Kr(t)){Cr(Fe(e)),te.setDimension(e);return}let r=Ba.dimension(t),i=rl(r),n=Fe(e);n?n.replaceWith(i):Ar.appendTargetLayer(i,t.layer),te.setDimension(e,t);let s=new Ua(t).render();return s=null,Fe(e)}function xSe(t,e){if(e=e||t.gId,!t||Kr(t)){Cr(Fe(e)),te.setDimension(e,{},"dimensionLength");return}let r=Fe(e),i=new ya(t).getContainer();return r?r.replaceWith(i):Ar.appendTargetLayer(i,t.layer,!0,{cmdKey:"dimensionLength"}),new ya(t).render(),te.setDimension(e,t,"dimensionLength"),i}function ESe(t,e){if(e=e||t.gId,!t||Kr(t)){Cr(Fe(e)),te.setDimension(e,{},"dimensionAngle");return}let r=Fe(e),i=new ga(t).getContainer();return r?r.replaceWith(i):Ar.appendTargetLayer(i,t.layer,!0,{cmdKey:"dimensionAngle"}),te.setDimension(e,t,"dimensionAngle"),i}function wSe(t,e){if(e=e||t.gId,!t||Kr(t)){Cr(Fe(e)),te.setDimension(e,{},"dimensionRadius");return}let r=Fe(e),i=new ca(t).getContainer();return r?r.replaceWith(i):Ar.appendTargetLayer(i,t.layer,!0,{cmdKey:"dimensionRadius"}),te.setDimension(e,t,"dimensionRadius"),i}function HS(t,e){if(e=e!=null?e:t.gId,!t||Kr(t)){Cr(Fe(e)),te.setAuxiliaryLine(e);return}let r=Ba.auxiliaryLine(t),i=rl(r),n=Fe(e);if(!n)Ar.appendTargetLayer(i,t.layer);else{let s=pt.isSelected(n);n.replaceWith(i),s&&(pt.unselect(n),pt.select([i]))}return te.setAuxiliaryLine(e,t),TP([{data:t,view:Fe(e)}],Mr.extendRect(X.svgRoot.viewBox.animVal)),Fe(e)}function hb(t,e){if(e=e!=null?e:t.gId,!t||Kr(t)){Cr(Fe(e)),te.setAuxiliaryPoint(e);return}let r=Ba.auxiliaryPoint(t),i=rl(r),n=Fe(e);if(!n)Ar.appendTargetLayer(i,t.layer);else{let s=pt.isSelected(n);n.replaceWith(i),s&&(pt.unselect(n),pt.select([i]))}return te.setAuxiliaryPoint(e,t),Z2(Fe(e),pg/X.gZoom),Fe(e)}var ck=class{constructor(){this.id="highlight-ele";this.containerId="container-for-create-stroke";this.currentHoverEle=null;this.debouncedAppendSelectStroke=Vd(()=>{var r;let e=(r=te.selectedRepeater)==null?void 0:r.getSelfSelectMap();this.appendSelectStroke(e).emptyLastHoverEle().removeHighlightStroke()},0)}appendSelectStroke(e=te.selectedRepeater.getChangeMap(),r=!0){let i=Fe(this.containerId),n=document.createDocumentFragment(),s=this;return e.forEach((u,d)=>{let{cmdKey:A,color:h}=u,f=Fe(d);if(f)switch(h!=null&&h.startsWith("--")&&(h=`var(${h})`),A){case"text":let p=f.querySelector(".primitive-text");h||(h=te.getById(d).json.strokeColor),l(p,"fill",h);break;case"auxiliaryPoint":h||(h=te.getAuxiliaryPoint(d).fillColor),l(f,"fill",h);break;case"auxiliaryLine":h||(h=te.getAuxiliaryLine(d).strokeColor),l(f,"stroke",h);break;case"dimension":h!=null&&h.startsWith("var")&&(h=""),o(f,"--dimensionConstraintColor",h);break;case"dimensionLength":case"dimensionAngle":case"dimensionRadius":h!=null&&h.startsWith("var")&&(h=""),o(f,"--normalDimensionColor",h);break;case"arc":case"obj":case"rect":case"group":case"circle":case"ellipse":a(d,h);break}}),i.appendChild(n),this;function a(u,d){let A="select-for-"+u,h=Fe(A);if(r&&(c("#"+A),h=null),d&&h)h.setAttribute("stroke",d);else if(d){let f=Fe(u);if(!f)return;let p=s.createOneStroke(f,d);p.id=A,n.appendChild(p)}else h&&c("#"+A)}function o(u,d,A){u&&A?u.style.setProperty(d,A):u&&u.style.removeProperty(d)}function l(u,d,A){u&&A?u.setAttribute(d,A):u&&u.removeAttribute(d)}function c(u){Us(u).forEach(d=>d.remove())}}removeHighlightStroke(){return Cr(Hs(`[id^="${this.id}"]`)),this}removeCombinationElmsHighlightStroke(){return Cr(Us(`[id^="${this.id}"]`)),this}refreshHighlightStroke(){let e=Us(`[id^="${this.id}"]`);this.emptyLastHoverEle(),this.removeCombinationElmsHighlightStroke(),e.forEach(r=>{let i=r.id.replace(`${this.id}-`,""),n=Fe(i);n&&this.createHighlightStyle(n)})}emptyLastHoverEle(){return this.currentHoverEle=null,this}emptySelectContainer(){return Gs().forEach(e=>{var i;let{cmdKey:r}=te.getById(e.id);if(!["text","auxiliaryLine","auxiliaryPoint","dimension","dimensionLength","dimensionAngle","dimensionRadius"].includes(r)){let n="select-for-"+e.id;(i=Fe(n))==null||i.remove()}}),this}createOneStroke(e,r="--selectColor"){let{json:i,cmdKey:n}=te.getById(e.id),{matrix:s}=i;r.startsWith("--")&&(r=`var(${r})`),s=s||[1,0,0,1,0,0];let a={id:`${this.id}-${e.id}`,fill:"none","stroke-width":2,"pointer-events":"none",stroke:r,"vector-effect":"non-scaling-stroke",transform:`matrix(${s.join(",")})`},o;switch(n){case"ellipse":{o=Hr("ellipse",{cx:0,cy:0,rx:1,ry:1,...a});break}case"obj":{o=Hr("rect",{x:0,y:0,width:1,height:1,...a});break}case"rect":{let{width:l,height:c,matrixArr:u}=vn.getRectFromMatrix(s);o=Hr("rect",{x:0,y:0,width:l,height:c,rx:i.rx,ry:i.ry,...a,transform:`matrix(${u})`});break}case"group":{let l=i.d;delete a.transform,o=Hr("path",{d:l,...a});break}case"arc":{let l=Bn.getD(i);delete a.transform,o=Hr("path",{d:l,...a});break}default:return}return o.style.pointerEvents="none",o}createHighlightStyle(e,r=!1){if(e===this.currentHoverEle||(this.currentHoverEle=e,r||this.removeHighlightStroke(),!e))return;let i=this.createOneStroke(e,"--highlight");if(!i)return;Fe(this.containerId).appendChild(i),Hs}shouldRemoveHighlight(e){this.currentHoverEle&&this.currentHoverEle.id===e&&this.removeHighlightStroke().emptyLastHoverEle()}removeCombinationHighLight(){this.removeCombinationElmsHighlightStroke().emptyLastHoverEle()}},ms=new ck;var rn=class{static hasVisible(e){for(let r of e){let i=te.getById(r).json;if(!this.eleIsHide(i))return!0}return!1}static hasHidden(e){for(let r of e){let i=te.getById(r).json;if(this.eleIsHide(i))return!0}return!1}static eleIsHide(e){var c;if(!e)return!1;let r=e.cmdKey;if(!e.visible)return!0;let i=new gr,n=i.searchCombination(e.gId);if(n&&i.findFamily(n).getAllParents().some(A=>te.getCombination(A).visible===!1)||((c=Ar.getCurrentScheme())==null?void 0:c.options.some(u=>+u.id==+e.layer&&!u.visible)))return!0;let a=$u();if(a["all-element-type"][SS(r)].visible===!1)return!0;let{hide:o,locked:l}=e;return!!(a["all-state"].hide.visible===!1&&o||a["all-state"].visible.visible===!1&&!o||a["all-state"].lock.visible===!1&&l||a["all-state"].unlock.visible===!1&&!l)}static applyElementsVisible(e){let r=te.getById(e).json,i=this.eleIsHide(r);Hi.renderer.attr(e,"display",i?"none":"")}static toggleElementsDisplay(e,r){let{elements:i,combinations:n}=new gr().getSelectedCombinations(e),s=new qi;for(let o of i)s.addOne(te.getById(o).json),te.getById(o).json.visible=r,this.applyElementsVisible(o);let a=new gr;for(let o of n){s.addOneCombineByComId(o);let l=te.getCombination(o);l.visible=r;let c=a.getAllElesfromTop(o).elements;for(let u of c)s.addOne(te.getById(u).json),this.applyElementsVisible(u)}s.updateAndSave()}static showAll(){let e=new qi;te.iteratorCombination(n=>{n.visible===!1&&(e.addOneCombineByComId(n.gId),n.visible=!0)});let r=vi(Ar.currentScheme);r.options.forEach(n=>{n.visible=!0}),Ar.apply(r),Et("setFilterConfig"),Et("syncActivePanelLayerContent"),te.getItemOrder().forEach(n=>{let{json:s,cmdKey:a}=te.getById(n),{visible:o}=s;o===!1&&(e.addOne(s),s.visible=!0,Hc(a,s))}),e.updateAndSave()}static isEyeGray(e,r){var f;let{layer:i,gId:n,locked:s,hide:a}=e||{},o=new gr,l=o.searchCombination(n),c=!1,u=!1,d=!1,A=$u();l&&(c=o.findFamily(l).getAllParents().some(m=>te.getCombination(m).visible===!1)),(f=Ar.getCurrentScheme())==null||f.options.forEach(p=>{p.id===i&&!p.visible&&(u=!0)}),d=!A["all-element-type"][SS(r)].visible;let h=!1;return A["all-state"].hide.visible===!1&&a&&(h=!0),A["all-state"].visible.visible===!1&&!a&&(h=!0),A["all-state"].lock.visible===!1&&s&&(h=!0),A["all-state"].unlock.visible===!1&&!s&&(h=!0),{combination:c,filter:d||h,layer:u}}static isCombinaionEyeGray(e){let i=new gr().findFamily(e).getAllParents();return i.shift(),{combination:i.some(s=>te.getCombination(s).visible===!1)}}static toggleVisible(e,r){var n;let i=te.getById(e).json;i.visible=r!=null?r:!i.visible,((n=ms.currentHoverEle)==null?void 0:n.id)===e&&(i.visible?ms.createHighlightStyle(ms.currentHoverEle):ms.removeHighlightStroke()),this.applyElementsVisible(e)}};rn=Uu([gu(Ya.eleVisable)],rn);function Jq(t){let{layer:e=1,scope:r=1,opacity:i=1,fontSize:n=12,strokeColor:s="",fontFamily:a="",underline:o="none",italic:l="normal",fontWeight:c="normal",d:u,gId:d,hide:A,name:h,cover:f,locked:p,hAlign:m,vAlign:y,rotation:g,cacheWidth:b,cacheHeight:E,isWhiteBackground:w}=t,x={layer:e,opacity:i,locked:p,rotation:g,id:d,transform:xr.getTransformStr(t.matrix),scope:r,hide:A?1:0,cover:f?1:0,white:w?1:0,c_partid:"part_text","h-align":m,"v-align":y,"font-style":l,"font-size":n,"font-family":a,"font-weight":+c==1?"bold":"normal","text-decoration":o,display:rn.eleIsHide(t)?"none":""};return e==2&&(i=db(+t.transparencyPrint*100,+t.transparencyWhite*100),x.opacity=i),`<g ${Object.entries(x).map(([C,G])=>`${C}="${mg(String(G))}"`).join(" ")}>
        <rect class="hitbox" stroke="none" fill="transparent" x="0" y="${-E}" width="${b}" height="${E}"></rect>
        <path class="primitive-text" d="${u}" stroke-width="0" stroke="none" fill="${s}"/>
    </g>`}var uk=class{constructor(e){this.elm=e;this.rectElm=Hs("rect.hitbox",e),this.pathElm=Hs("path",e),this.data=te.getText(e.id)}async name(e){if(e=NC(e),e.length>4096)return X.windowBridge.publish("ui/toastMsg",{type:"error",msg:"Text cannot be more than 4096 characters!",timer:3},ur());await this.syncTextFont({name:e}),this.data.name=e,this.data.key=e,Ja([this.elm],{create8Dots:!0})}strokeColor(e){ge(this.pathElm,{fill:e,stroke:e})}async fontFamily(e){await this.syncTextFont({fontFamily:e}),this.data.fontFamily=e}async fontWeight(e){await this.syncTextFont({fontWeight:e}),this.data.fontWeight=e==="bold"}async italic(e){await this.syncTextFont({fontStyle:e}),this.data.italic=e==="italic"}async fontSize(e){await this.syncTextFont({fontSize:e}),this.data.fontSize=e}async underline(e){let r=e==="underline"?"underline":"normal";await this.syncTextFont({underline:r}),this.data.underline=r==="underline"}async getTextPathInfo(e){let{underline:r,fontFamily:i,key:n,fontWeight:s,fontSize:a,italic:o}=this.data,l=e.text||e.name||n,d=Object.assign({fontFamily:i,fontSize:a,fontStyle:o?"italic":"normal",fontWeight:s?"bold":"normal",underline:r?"underline":"normal",x:0,y:0},e);return await new fm().getPath(l,d)}async syncTextFont(e){let{d:r,bbox:i}=await this.getTextPathInfo(e),n=i.height(),s=i.width();ge(this.rectElm,{y:-n,width:s,height:n}),ge(this.pathElm,"d",r),this.data.cacheWidth=s,this.data.cacheHeight=n,this.data.d=r}},WP=uk,hk=class{getTextPostion(e){let{matrix:r}=e,i=e.cacheWidth,n=e.cacheHeight,s=xr.createMatrixFrom6(r),{x:a,y:o}=this.getTextOrigin(e.gId),l=new ne(-a,-o).multiply3(s),c=new ne(0,-n).multiply3(s),d=new ne(i,0).multiply3(s).distance1(l),A=c.distance1(l),h=Ab(e);return{x:l.x,y:l.y,width:h.width,height:h.height,initWidth:i,initHeight:n,currentWidth:d,currentHeight:A}}getTextOrigin(e,r,i,n){n=n||te.getText(e),Ir(r)&&(r=n.hAlign),Ir(i)&&(i=n.vAlign);let s=n.cacheWidth,a=n.cacheHeight,o=0;switch(r){case 1:o=-s/2;break;case 2:o=-s;break}let l=a;switch(i){case 1:l=a/2;break;case 2:l=0;break}return{x:o,y:l}}syncTextWithOrigin(e,r,i){let n=this.getTextOrigin(e.gId),s=this.getTextOrigin(e.gId,r,i),a=s.x-n.x,o=s.y-n.y;if(a===0&&o===0)return;let l=Ue.translate(a,o);this.syncText(e,l,{updateMatrix:!0,reverse:!0})}syncTextWithRotation(e,r,i){let n=this.getRotationMatrix(e,r,i);n&&this.syncText(e,n,{updateMatrix:!0,fn(){e.rotation=+r.toFixed(2)}})}getRotationMatrix(e,r,i){let n=xr.createMatrixFrom6(e.matrix),{x:s,y:a}=this.getTextOrigin(e.gId),o=i||new ne(-s,-a).multiply3(n),l=e.rotation||0,c=Math.round((r-l)*100)/100;if(c)return Ue.rotateD(c).setOrigin1(o)}sync(e,r,i){let n=xr.createMatrixFrom6(e.matrix),s=n.multiply3(r);i.reverse&&(s=r.multiply3(n));let a=nr.getMatrix6FromMatrix(s);i.updateMatrix&&(e.matrix=a),e.tempMatrix=a,xr.updateTransform(a,Fe(e.gId))}syncText(e,r,i){let n=$i.checkOne("text",e,r);n!==!1&&$i.addCallBack(()=>{var s;G1(n)&&n(),this.sync(e,r,i),(s=i==null?void 0:i.fn)==null||s.call(i)})}syncTextWidthScale(e,r,i){let n=e.id,s=te.getText(n),a=xr.createMatrixFrom6(s.matrix),o=this.getTextPostion(e),l=r*o.initWidth,c=i*o.initHeight,u=l/o.currentWidth,d=c/o.currentHeight;Ir(r)&&(u=1),Ir(i)&&(d=1);let A=this.getTextOrigin(n),h=new ne(-A.x,-A.y).multiply3(a),f=Ue.scale(u,d).setOrigin1(h);this.syncText(e,f,{updateMatrix:!0})}syncTextSize(e,r,i,n){let{width:s,height:a}=this.getTextPostion(e),o=1,l=1;if(cu(r)&&(o=r/s),cu(i)&&(l=i/a),o===1&&l===1)return;if(!n){let{x:u,y:d}=this.getTextOrigin(e.gId),A=xr.createMatrixFrom6(e.matrix);n=new ne(-u,-d).multiply3(A)}let c=Ue.scale(o,l).setOrigin1(n);this.syncText(e,c,{updateMatrix:!0})}resetText(e){let r=e.id,i=te.getText(r),{matrix:n,rotation:s}=i,a=nr.createMatrixFrom6(n),{x:o,y:l}=this.getTextOrigin(r),c=new ne(-o,-l).multiply3(a),u=Ue.translate(o,l).scale(1,1).rotateD(s).translate1(c),d=nr.getMatrix6FromMatrix(u);i.matrix=d,delete i.tempMatrix,xr.updateTransform(d,e)}syncTextPosition(e,r,i){let{x:n,y:s}=un(e,"text");r=cu(r)?r:n,i=cu(i)?i:s;let a=r-n,o=i-s;if(!a&&!o)return;let l=Ue.translate(a,o);this.syncText(e,l,{updateMatrix:!0})}getTextForAttrs(e){let{x:r,y:i,width:n,height:s}=this.getTextPostion(e);return{x:r,y:i,width:n,height:s}}},ps=new hk;function vSe(t){let e=n=>ge(t,n)||"",r=n=>n.map(e).map(Number),i=n=>n.replace(/,/g," ").trim().split(/\s+/);switch(t.tagName){case"path":return e("d");case"circle":{let[n,s,a]=r(["cx","cy","r"]);return zq({cx:n,cy:s,r:a})}case"ellipse":{let[n,s,a,o]=r(["cx","cy","rx","ry"]);return zA({cx:n,cy:s,rx:a,ry:o})}case"line":{let[n,s,a,o]=r(["x1","y1","x2","y2"]);return`M ${n} ${s} L ${a} ${o}`}case"polygon":{let n=e("points"),s=i(n);return s.length<6?"":(s.length%2&&(s.length-=1),`M ${s[0]} ${s[1]} L ${s.slice(2).join(" ")} Z`)}case"polyline":{let n=e("points"),s=i(n);return s.length<4?"":(s.length%2&&(s.length-=1),`M ${s[0]} ${s[1]} L ${s.slice(2).join(" ")}`)}case"rect":{let n=+ge(t,"x")||0,s=+ge(t,"y")||0,a=parseInt(window.getComputedStyle(t).height,10),o=parseInt(window.getComputedStyle(t).width,10),l=Ue.scale(o,a).translate(n,s),c=nr.getMatrix6FromMatrix(l);return ud({matrix:c})}default:break}return""}function $q(t){return/^#[\da-f]+$|^\w+$/i.test(t)}function CSe(t,e,r){for(;e.parentNode!==r;){if(t.includes(e.parentNode.tagName))return!0;e=e.parentNode}return!1}function Zq(t,e,r,i,n,s){let a=kc(t),o=[];if(!a)return console.error("Invalid Xml",t),o;let l=document.importNode(a.documentElement,!0),c=["defs","style","clipPath","mask","linearGradient","radialGradient","pattern","use","text"],u=E=>Array.from(l.querySelectorAll(E)),d=l.viewBox.baseVal,A=s.rotation||0,h=i/(d.width||i),f=n/(d.height||n),p=e-d.x,m=r-d.y,y=Ue.scale(h,f).setOrigin(e,r).translate(p*h,m*f),g=Ue.rotateD(A).setOrigin(e,r);X.gCanvas.appendChild(l);let b=u("path,circle,ellipse,line,polygon,polyline,rect");return o=Array.from(b).map(E=>{if(CSe([...c],E,l))return null;let x=vSe(E);if(!x)return null;let I=SSe(E,y,X.gCanvas),G=Jn(x,!1).map(N=>N.multiply3(I).multiply3(g)),U=ql(G,!1,.01,{reverseY:!1});if(!U)return null;let _=window.getComputedStyle(E).fill,H="";_.startsWith("rgb")&&(H=nz(_));let Q=H||ge(E,"fill")||_,j=ge(E,"stroke")||"none",$=ge(E,"stroke-width")||"1";Q=$q(Q)||Q=="none"?Q:"#000000",j=$q(j)?j:"none",$=Math.max(0,parseFloat($)||0);let B=Q!="none";!(j!="none"&&$>0)&&!B&&(j="#000000",$=1);let v=te.getInitialGroupData({gId:ni(),layer:Ar.getTargetPlaceLayer("group")});return v.d=U,v.fillColor=Q,v.strokeColor=j,v.strokeWidth=$,v}),X.gCanvas.removeChild(l),o.filter(Boolean)}function SSe(t,e,r){function i(a){let o=a.transform.baseVal,l=o.numberOfItems>0?o.consolidate().matrix:new DOMMatrixReadOnly,{a:c,b:u,c:d,d:A,e:h,f}=l,p=[c,u,d,A,h,f];return xr.createMatrixFrom6(p)}function n(a,o){let l=i(a);for(;a!=o&&o.contains(a);)a=a.parentElement,l=l.multiply3(i(a));return l}return n(t,r||X.svgRoot).multiply3(e)}var KP=class{constructor(e,r){this.position=e,this.angles=r}};var Wl=class{constructor(e,r,i,n){this.beLongId=n,this.position=e,this.type=i,this.angles=r}};var ap=class{constructor(e){this.bbox=e}};var hE=10,JP=7,GS=9,eW=3,YS=8,$P=1,tW="2 3 2",dE="#FF0000",gm="drawing",dk=["AuxiliaryPoint","AuxiliaryLineIntersect","BaseCross","Shape","AuxiliaryLine","ExtendLineIntersect","ExtendLine"];var Ak=class{getLines(e,r,i){let n=new ne(1,0),s=new ne(0,1),a=new Ee(e.sub(n.mul(i/2)),e.add(n.mul(i/2))),o=new Ee(e.sub(s.mul(i/2)),e.add(s.mul(i/2))),l=[a,o];if(r!=null&&r.size)for(let c of r){if(!c)continue;let u=new Ee(e.sub(e.add(n).rotate(e,c||0).sub(e).normalize().mul(i/2)),e.add(e.add(n).rotate(e,c||0).sub(e).normalize().mul(i/2))),d=new Ee(e.sub(e.add(s).rotate(e,c||0).sub(e).normalize().mul(i/2)),e.add(e.add(s).rotate(e,c||0).sub(e).normalize().mul(i/2)));l.push(u,d)}return l}getOneLine(e,r,i){let n=new ne(1,0);return new Ee(e.sub(e.add(n).rotateD(e,r||0).sub(e).normalize().mul(i/2)),e.add(e.add(n).rotateD(e,r||0).sub(e).normalize().mul(i/2)))}getLinesIntersectPointInfo(e){let r=[];for(let n=0;n<e.length;n++)for(let s=n+1;s<e.length;s++){if(e[n].a/e[n].b===e[s].a/e[s].b)continue;let a=ip(e[n],e[s]);for(let o=0;o<a;o+=2){let l=new ne(Ye[o],Ye[o+1]),c=i(l);c?(c.lines[n]=e[n],c.lines[s]=e[s]):r.push({point:l,lines:{[n]:e[n],[s]:e[s]}})}}return r;function i(n){for(let s of r)if(s.point.equals1(n))return s;return null}}targetIdSortHandler(e,r){let i=dk.indexOf(e),n=dk.indexOf(r);return i-n}},fb=new Ak;var ZP=class{constructor(e,r,i,n){this.baseCrossFlagMgr=n,this.baseDotMgr=r,this.baseShapeMgr=i,this.excludeShapeIdMap=e}deal(e,r,i=hE/X.gZoom,n){let s,a,o,l=[],c,u=new ne(e,r);if([i,s,c]=this.auxPoint(u,i,s,c),s!=null)return{distance:i,position:s,adsorptionCrossFlag:a,adsorptionExtendLine:o,target:c};if([i,s,c,a]=this.shapeDots(n,u,i,s,c,a),[i,s,c,a,l]=this.baseCross(u,i,s,c,a,l),s==null){if([i,s,c,a]=this.auxLine(u,i,s,c,a),s!=null)return{distance:i,position:s,adsorptionCrossFlag:a,adsorptionExtendLine:o,target:c};for(let A of l){let h=pm.foot(A,u),f=h.distance1(u);f<i&&(i=f,s=h,a=null,o=[A],c="ExtendLine")}let d=fb.getLinesIntersectPointInfo(l);for(let A of d){let h=A.point.distance1(u);h<JP/X.gZoom&&o&&(i=h,s=A.point,a=null,o=Object.values(A.lines),c="ExtendLineIntersect")}}return{distance:i,position:s,adsorptionCrossFlag:a,adsorptionExtendLine:o,target:c}}auxPoint(e,r,i,n){var a;let s=te.getAuxiliaryPoint();for(let o in s){if((a=this.excludeShapeIdMap)!=null&&a.get(o))continue;let l=Fe(o);if(o!==gm&&(!l||ge(l,"display")==="none"))continue;let c=s[o],u=new ne(c.x,c.y),d=u.distance1(e);d<r&&(r=d,i=u,n={id:o,type:"AuxiliaryPoint"})}return[r,i,n]}auxLine(e,r,i,n,s){var l;let a=te.getAuxiliaryLine(),o=[];for(let c in a){if((l=this.excludeShapeIdMap)!=null&&l.get(c))continue;let u=Fe(c);if(c!==gm&&(!u||ge(u,"display")==="none"))continue;let d=a[c],A=new ne(d.x,d.y),h=A.add1(1,0).rotateD(A,d.rotation),f=new Ee(A,h),p=pm.foot(f,e),m=p.distance1(e);m<r&&(r=m,i=p,s=null,n={id:c,type:"AuxiliaryLine"}),m<JP/X.gZoom&&o.push(fb.getOneLine(new ne(p.x,p.y),d.rotation,(X.svgRoot.width.baseVal.value+X.svgRoot.height.baseVal.value)/X.gZoom))}if(o.length>1){let c=fb.getLinesIntersectPointInfo(o);for(let u of c){let d=u.point.distance1(e);d<JP/X.gZoom&&(r=d,i=u.point,s=null,n={type:"AuxiliaryLineIntersect"})}}return[r,i,n,s]}shapeDots(e,r,i,n,s,a){var c;let o=new pr().ext6(r.x,r.y).ext7(hE/X.gZoom).build(),l=this.baseDotMgr.map;for(let u in l){if((c=this.excludeShapeIdMap)!=null&&c.get(u))continue;let d=Fe(u);if(u!==gm&&(!d||ge(d,"display")==="none")||!o.intersection1(this.baseShapeMgr.getShapeBBox(u).extendOfSize(hE/X.gZoom)))continue;let A=l[u];for(let h of A){if(e!=null&&e.includes(h.type))continue;let f=h.position.distance1(r);f<=i&&(i=f,n=h.position,s={id:u,type:"Shape"},f<i||!a?a=[{position:h.position,angles:h.angles}]:a.push({position:h.position,angles:h.angles}))}}return[i,n,s,a]}baseCross(e,r,i,n,s,a){for(let o of this.baseCrossFlagMgr.getAllItems()){let l=o.position.distance1(e);l<r&&(r=l,i=o.position,n={type:"BaseCross"},s=null),a.push(...fb.getLines(o.position,o.angles,(X.svgRoot.width.baseVal.value+X.svgRoot.height.baseVal.value)/X.gZoom))}return[r,i,n,s,a]}};var eL=class{constructor(){this.items=[]}getAllItems(){return this.items}add(e){let r=!1,i=this.getRepeatPositionFlag(e);if(i!=null)for(let n of e.angles)i.angles.add(n);else this.items.push(e),r=!0;return this.items.length>GS&&this.items.splice(0,1),r}clear(){this.items.length=0}getRepeatPositionFlag(e){for(let r of this.items)if(e.position.equals1(r.position))return r}};var tL=class{constructor(){this.belongIdMap={}}get map(){return this.belongIdMap}updateDots(e,r){this.belongIdMap[e]=r}removeDots(e){delete this.belongIdMap[e]}getDots(e){return this.belongIdMap[e]}clear(){this.belongIdMap={}}};var rL=class{constructor(){this.map={}}updateShape(e,r){this.map[e]=r}removeShape(e){delete this.map[e]}getShape(e){return this.map[e]}getShapeBBox(e){var r;return(r=this.map[e])==null?void 0:r.bbox}clear(){this.map={}}};var hy=class{};var iL=class extends hy{constructor(r,i){super();this.template=`<circle name="adsorption-point" class="adsorption"  cx="{x}" cy="{y}" r="${eW}" fill="${dE}" stroke-width="0" transform="scale(${1/X.gZoom})" transform-origin="{x} {y}"></circle>`;this.x=0;this.y=0;this.x=r,this.y=i}getTemplate(){return rl(this.template.replace(/\{\w+\}/g,r=>this[r.slice(1,r.length-1)]))}};var sL=class extends hy{constructor(r,i){super();this.template=`<path name="adsorption-cross-flag" class="adsorption" d="M {minX} {y} L {maxX} {y} M {x} {minY} L {x} {maxY}" stroke-width="${$P}" stroke="${dE}" transform="scale(${1/X.gZoom})" transform-origin="{x} {y}"></path>`;this.x=0;this.y=0;this.minX=0;this.minY=0;this.maxX=0;this.maxY=0;this.x=r,this.y=i,this.minX=r-YS,this.maxX=r+YS,this.minY=i-YS,this.maxY=i+YS}getTemplate(){return rl(this.template.replace(/\{\w+\}/g,r=>this[r.slice(1,r.length-1)]))}};var aL=class extends hy{constructor(r,i){super();this.template=`<path name="adsorption-extend-line" class="adsorption" d="M {startX} {startY} L {endX} {endY}" stroke-width="${$P}" stroke-dasharray="${tW}" stroke="${dE}" transform="scale(${1/X.gZoom})" transform-origin="{x} {y}"></path>`;this.startX=0;this.startY=0;this.endX=0;this.endY=0;this.x=0;this.y=0;let n=i.sub(r).normalize().mul(X.svgRoot.width.baseVal.value+X.svgRoot.height.baseVal.value);r=r.sub(n),i=i.add(n),this.startX=r.x,this.endX=i.x,this.startY=r.y,this.endY=i.y,this.x=(r.x+i.x)/2,this.y=(r.y+i.y)/2}parse(r,i){let n=(X.svgRoot.width.baseVal.value+X.svgRoot.height.baseVal.value)/X.gZoom,a=r.add(new ne(0,1)).rotate(r,i).sub(r).normalize(),o=r.sub(a.mul(n)),l=r.add(a.mul(n));this.startX=o.x,this.endX=l.x,this.startY=o.y,this.endY=l.y,this.x=(o.x+l.x)/2,this.y=(o.y+l.y)/2}getTemplate(){return rl(this.template.replace(/\{\w+\}/g,r=>this[r.slice(1,r.length-1)]))}};var fk=class{json2BaseCache(e,r,i){switch(e){case"ellipse":{let n=tn.getDotsForAdsorp(r),s=n.pop(),a=new pr;for(let u of n)a.ext2(u);let o=a.build(),l=new ap(o);return{baseDots:n.map(u=>new Wl(u,new Set,0,r)).concat(new Wl(s,new Set,2,r)),baseShape:l}}case"arc":{let n=new Bn(i),s=new pr;for(let c of n.points(1))s.ext2(c);let a=s.build(),o=new ap(a);return{baseDots:this.getBoxPoints(a).map(c=>new Wl(c,new Set,0,r)).concat(new Wl(n.vectorCenter(),new Set,2,r)).concat(new Wl(n.vectorStart(),new Set,1,r)).concat(new Wl(n.vectorEnd(),new Set,1,r)),baseShape:o}}case"group":{let{d:n}=i,s=new Ws(Jn(n)),{minX:a,maxX:o,minY:l,maxY:c}=s.bbox(),u=new Mr(a,o,Math.min(-l,-c),Math.max(-l,-c)),d=new ap(u),A=this.getBoxPoints(u),h=this.getGroupSelfPoints(r),f=u.center();return{baseDots:A.map(m=>new Wl(m,new Set,0,r)).concat(h.map(m=>new Wl(m.position,m.angles,1,r)),new Wl(f,new Set,2,r)),baseShape:d}}case"rect":{let n=Rg(Fe(r)),s=new ap(new Mr(n.x,n.x+n.width,n.y,n.y+n.height)),a=vn.getDotsForAdsorp(i),o=a.pop();return{baseDots:a.map(c=>new Wl(c,new Set,0,r)).concat(new Wl(o,new Set,2,r)),baseShape:s}}case"text":{let{rotation:n}=i,s=this.getSelfPoints(r),a=new pr().ext3(s.map(u=>u.position)).build(),o=new ap(a),l=a.center();return{baseDots:s.map(u=>new Wl(u.position,new Set([-((n||0)/180*Math.PI)]),0,r)).concat(new Wl(l,new Set([-((n||0)/180*Math.PI)]),2,r)),baseShape:o}}case"obj":{let{rotation:n}=i,s=this.getSelfPoints(r),a=s.length?new pr().ext3(s.map(u=>u.position)).build():new Mr(0,0,0,0),o=new ap(a),l=a.center();return{baseDots:s.map(u=>new Wl(u.position,new Set([-((n||0)/180*Math.PI)]),0,r)).concat(new Wl(l,new Set([-((n||0)/180*Math.PI)]),2,r)),baseShape:o}}default:throw new Error(`Adsorption: Does not support the conversion of json data of type [${e}] to BaseDot/BaseShape`)}}getBoxPoints(e){let r=e.LL(),i=e.LR(),n=e.UR(),s=e.UL(),a=r.add(i).mul(1/2),o=i.add(n).mul(1/2),l=n.add(s).mul(1/2),c=s.add(r).mul(1/2);return[r,a,i,o,n,l,s,c]}getGroupSelfPoints(e){let r=Fe(e);if(!r)return console.error(`Adsorption: does not exist ${e} shape, can not get self dots`),[];let i=[],n=r.getPathData();for(let a=0;a<n.length;a++){let o=n[a-1],l=n[a+1],{type:c,values:u}=n[a],d=new Set;switch(c){case"A":case"C":case"L":case"Q":case"M":{let A=s(u);if(A.equals1(s(o==null?void 0:o.values)))break;if(c==="L"){let h=A.angle(s(o.values));h&&d.add(h)}if((l==null?void 0:l.type)==="L"){let h=A.angle(s(l.values));h&&d.add(h)}i.push({position:A,angles:d});break}case"Z":break;default:{console.warn(`Adsorption: can not get path data type:${c} of shape:${e}`);break}}}return i;function s(a=[]){return a.length<2?null:new ne(a[a.length-2],a[a.length-1])}}getSelfPoints(e){let r=Fe(e);if(!r)return console.error(`Adsorption: does not exist ${e} shape, can not get self dots`),[];let i=[],n=Ts.get(r,"single"),s={};n.c_helper_lines&&n.c_helper_lines.forEach((a,o,l)=>{let c=l[o-1],{from:u,to:d}=a;!l[o+1]||u-(c==null?void 0:c.to)===1?(s[u*2]=!0,s[u*2+1]=!0):(s[d*2]=!0,s[d*2+1]=!0)});for(let a=0;a<n.length;a+=2){if(s[a])continue;let o=new ne(n[a],n[a+1]),l=a<n.length-3&&new ne(n[a+2],n[a+3]),c=a>1&&new ne(n[a-2],n[a-1]),u=c&&o.angle(c),d=l&&o.angle(l),A=new Set;u&&A.add(u),d&&A.add(d),i.push({position:o,angles:A})}return i}},pk=new fk;var rW={0:"ADSORPTION",1:"UPDATE SHAPE",2:"REMOVE SHAPE",3:"BUILD ALL SHAPE",4:"DRAG ADSORPTION"},oL=class{constructor(){this.RECORD_MAX_SIZE=1e3;this._warnTimes=0;this._adsorptionRecords=[];this._updateRecords=[];this._removeRecords=[];this._setRecords=[];this._dragAdsorptionRecords=[]}get warnTimes(){return this._warnTimes}get adsorptionRecords(){return this._adsorptionRecords.length>this.RECORD_MAX_SIZE&&this._adsorptionRecords.shift(),this._adsorptionRecords}get updateRecords(){return this._updateRecords.length>this.RECORD_MAX_SIZE&&this._updateRecords.shift(),this._updateRecords}get removeRecords(){return this._removeRecords.length>this.RECORD_MAX_SIZE&&this._removeRecords.shift(),this._removeRecords}get setRecords(){return this._setRecords.length>this.RECORD_MAX_SIZE&&this._setRecords.shift(),this._setRecords}get dragAdsorptionRecords(){return this._dragAdsorptionRecords.length>this.RECORD_MAX_SIZE&&this._dragAdsorptionRecords.shift(),this._dragAdsorptionRecords}getRecords(e){switch(e){case 0:return this.adsorptionRecords;case 1:return this.updateRecords;case 2:return this.removeRecords;case 3:return this.setRecords;case 4:return this.dragAdsorptionRecords}}getWarnTime(e){switch(e){case 0:return 16;case 4:return 16;case 1:return 100;case 2:return 100;case 3:return 1e3}}log(e=0){console.log(rW[e]),console.table(this.getRecords(e).map(r=>r+"ms"))}recordStart(e=0){this.getRecords(e).push(new Date)}recordEnd(e=0){let r=this.getRecords(e),i=Number(new Date)-Number(r[r.length-1]);r[r.length-1]=i,i>this.getWarnTime(e)&&this.warn(e,i)}warn(e,r){console.warn(`Adsorption: The ${rW[e]} operate time is too long and it takes ${r}ms`),this._warnTimes++}};var mk=class{constructor(){this.FILTER_SHAPE_KEYS=["ellipse","group","rect","text","obj","arc"];this.baseDotMgr=new tL;this.baseCrossFlagMgr=new eL;this.baseShapeMgr=new rL;this.performanceMonitor=new oL;this._enabled=!0;this.excludeShapeIdMap=new Map;this._coreTool=new ZP(this.excludeShapeIdMap,this.baseDotMgr,this.baseShapeMgr,this.baseCrossFlagMgr);this.adsorptionPoints=new Set}get enabled(){return this._enabled}set enabled(e){this._enabled=e,console.log(`PANEL Adsorption: ${e?"enable":"disable"}`)}get adsorptionPointInfo(){return this._adsorptionPointInfo?{...this._adsorptionPointInfo}:null}get currentAdsorptionShapeElement(){var r,i;let e=(i=(r=this._adsorptionPointInfo)==null?void 0:r.target)==null?void 0:i.id;return Fe(e)}addCrossFlag(e,r=new Set){let i=new KP(e,r);this.baseCrossFlagMgr.add(i)&&this.setCrossFlagHTML(e.x,e.y),this.removeExtraCrossFlagHTML()}updateShapeCache(e,r,i){if(!this.enabled||!this.FILTER_SHAPE_KEYS.includes(r))return;this.performanceMonitor.recordStart(1);let{baseShape:n,baseDots:s}=pk.json2BaseCache(r,e,i);this.baseDotMgr.updateDots(e,s),this.baseShapeMgr.updateShape(e,n),this.performanceMonitor.recordEnd(1)}updateDrawingShapeCache(e,r){if(this.enabled)if(e!=null&&e.length){let i=[];for(let n=0;n<e.length;n+=2){let s=new ne(e[n],e[n+1]),a=n<e.length-3&&new ne(e[n+2],e[n+3]),o=n>1&&new ne(e[n-2],e[n-1]),l=o&&s.angle(o),c=a&&s.angle(a),u=new Set;l&&u.add(l),c&&u.add(c),i.push(new Wl(s,u,r,gm))}this.baseDotMgr.updateDots(gm,i),this.baseShapeMgr.updateShape(gm,new ap(new pr().ext3(i.map(n=>n.position)).build()))}else this.baseDotMgr.removeDots(gm),this.baseShapeMgr.removeShape(gm)}removeShapeCache(e){this.enabled&&(this.performanceMonitor.recordStart(2),this.baseDotMgr.removeDots(e),this.baseShapeMgr.removeShape(e),this.performanceMonitor.recordEnd(2))}setShapeCache(){this.enabled&&(this.performanceMonitor.recordStart(3),Vl(te.gJsonCache,(e,r)=>{this.FILTER_SHAPE_KEYS.includes(e)&&Vl(r,(i,n)=>{let{baseShape:s,baseDots:a}=pk.json2BaseCache(e,i,n);this.baseDotMgr.updateDots(i,a),this.baseShapeMgr.updateShape(i,s)})}),this.performanceMonitor.recordEnd(3))}clearShapeCache(){this.baseShapeMgr.clear(),this.baseDotMgr.clear()}clearCrossFlagCache(e=!0){this.baseCrossFlagMgr.clear(),e&&this.clearCrossFlagHTML()}adsorption(e,r){if(!this.enabled)return;this.performanceMonitor.recordStart(0),this.clearExtendLineHTML(),this.clearAdsorptionPointHTML();let i=this._adsorptionPointInfo=this.core(e,r),{position:n,adsorptionCrossFlag:s,adsorptionExtendLine:a}=i;if(n!=null){if(s!=null)for(let o of s)this.addCrossFlag(o.position,o.angles);if(a!=null)for(let o of a)this.setExtendLineHTML(o);return this.setAdsorptionPointHTML(n.x,n.y),this.performanceMonitor.recordEnd(0),n}return this.performanceMonitor.recordEnd(0),null}dragAdsorption(e,r,i){var h,f;if(!this.enabled)return;this.performanceMonitor.recordStart(4),this.clearExtendLineHTML(),this.clearAdsorptionPointHTML();let n,s,a,o,l,c=new Map,u=new Map;for(let p of i){let m=this.core(p.x,p.y,s,[1]);m.position!=null&&(m.adsorptionExtendLine?u:c).set(p,m)}let d=Array.from(c.size?c:u).sort((p,m)=>{var y,g;return fb.targetIdSortHandler(p[1].target.type,m[1].target.type)||(((y=m[1].adsorptionExtendLine)==null?void 0:y.length)||0)-(((g=p[1].adsorptionExtendLine)==null?void 0:g.length)||0)||p[1].distance-m[1].distance}),A=d[0];if(((h=A==null?void 0:A[1])==null?void 0:h.position)!=null){s=A[1].distance,a=[A[1].position],o=A[1].adsorptionCrossFlag||[],l=A[1].adsorptionExtendLine||[],n=new ne(e,r).add(a[0].sub(A[0])),this._adsorptionPointInfo=A[1];let p=1;for(;((f=d[p])==null?void 0:f[1].distance)===s;)A[1].position.sub(A[0]).equals1(d[p][1].position.sub(d[p][0]))&&(a.push(d[p][1].position),o.push(...d[p][1].adsorptionCrossFlag||[]),l.push(...d[p][1].adsorptionExtendLine||[])),p++}if(a!=null){if(o!=null)for(let p of o)this.addCrossFlag(p.position,p.angles);if(l!=null)for(let p of l)this.setExtendLineHTML(p);for(let p of a)this.setAdsorptionPointHTML(p.x,p.y);return this.performanceMonitor.recordEnd(4),n}return this.performanceMonitor.recordEnd(4),null}core(e,r,i=hE/X.gZoom,n){return this._coreTool.deal(e,r,i,n)}setAdsorptionPointHTML(e,r){let i=new iL(e,r).getTemplate();X.svgRoot.appendChild(i),this.adsorptionPoints.add(i)}setExtendLineHTML(e){X.svgRoot.appendChild(new aL(e.start(),e.end()).getTemplate())}setCrossFlagHTML(e,r){X.svgRoot.appendChild(new sL(e,r).getTemplate())}clearAdsorptionPointHTML(){for(let e of this.adsorptionPoints)Cr(e)}clearExtendLineHTML(){for(let e of Us('[name="adsorption-extend-line"]',X.svgRoot))e.parentNode.removeChild(e)}clearCrossFlagHTML(){for(let e of Us('[name="adsorption-cross-flag"]',X.svgRoot))e.parentNode.removeChild(e)}clearAdsorptionHTML(){this.clearCrossFlagCache(),this.clearAdsorptionPointHTML(),this.clearExtendLineHTML()}removeExtraCrossFlagHTML(){let e=Us('[name="adsorption-cross-flag"]',X.svgRoot);if(e.length>GS){let r=e.length-GS;for(let i=0;i<r;i++)e[i].parentNode.removeChild(e[i])}}boxCenterAddCrossFlag(e){if(this.excludeShapeIdMap.get(e))return;let r=this.baseShapeMgr.getShapeBBox(e);r!=null&&this.addCrossFlag(r.center())}adsorptionHTMLZoom(){Us(".adsorption",X.svgRoot).forEach(e=>{ge(e,"transform",`scale(${1/X.gZoom})`)})}setExcludeShapeIds(e=[]){return Vl(e,(r,i)=>{this.excludeShapeIdMap.set(i,!0)}),this}clearExcludeShapeIds(){return this.excludeShapeIdMap.clear(),this}},iW,Jr=iW=iW||new mk;var AE=class{static ready(){tr.started=!0,this.rotation=0}static rotate(e){this.rotation+=e,this.draw(this.lastPosition.x,this.lastPosition.y,!1)}static draw(e,r,i){this.lastPosition={x:e,y:r};let n=tr,s=X.defaultImage.userW,a=X.defaultImage.userH,o=Ue.scale(s,a).rotateD(this.rotation).translate(e,r),l=nr.getMatrix6FromMatrix(o);if(i)this.data.matrix=l,n.next(e,r),Jr.clearExcludeShapeIds();else if(!i)if(n.target)xr.updateTransform(l,n.target);else{let c=ni();Jr.setExcludeShapeIds([c]);let u=te.getInitialImageData({gId:c,layer:Ar.getTargetPlaceLayer("obj")});u.content=X.defaultImage.src,this.data=u,this.data.gId=c,this.data.height=a,this.data.width=s,n.target=Hr("image",{id:c,class:UA,preserveAspectRatio:"none",c_partid:"obj","xlink:href":u.content,x:0,y:0,width:1,height:1}),Ar.appendTargetLayer(n.target,1)}}static next(e,r){let{target:i,started:n}=tr,s=tr;if(n&&i){let a=this.data;if(a.content.startsWith("data:image/svg+xml;base64,")&&X.defaultImage.insertSvgAsPath){let l=a.content.slice(26),c;try{c=decodeURIComponent(escape(atob(l)))}catch(d){console.error(d);return}let u=Zq(c,e,r,X.defaultImage.userW,X.defaultImage.userH,{rotation:this.rotation});if(u.length){Ci(),te.removeOne(i),s.target=null;let d=[];for(let h of u){let f=qA(h);Ar.appendTargetLayer(f),d.push(f.id)}let A=[];for(let h of d){let f=Fe(h),p=vo(f),m=Da(h,{cmdKey:"group",refId:p},Object.create(null),te.getById(f.id).json);A.push(m),pt.select([f])}mr.save(A)}else Et("ui/toastMsg",{type:"success",msg:"No svg shapes",timer:3}),Cr(s.target),s.target=null;return}i=US(this.data),eh([i]),Ar.appendTargetLayer(i),Ci(),pt.select([i]),Jr.updateShapeCache(i.id,"obj",this.data),Et("panel_updateAttrPanel"),Cr(s.target)}tr.started=!0}static end(e){var r=tr;r.target&&te.removeOne(r.target)}};AE.rotation=0;function nW(t){if(!t.startsWith("data:image/svg+xml;base64,"))return t;let e=t.substring(0,26),r=decodeURIComponent(escape(atob(t.substring(26)))),i=kc(r),n=document.importNode(i.documentElement,!0),s=Object.values(n.attributes),a=["http://www.w3.org/2000/svg","http://www.w3.org/1999/xlink"],o=[];for(let l of s){let c=l.nodeName,u=l.nodeValue,[d,A]=c.split(":");d==="xmlns"&&A&&!a.includes(u)&&o.push(A)}for(let l of o)sW(n,l+":");return r=new XMLSerializer().serializeToString(n),e+btoa(unescape(encodeURIComponent(r)))}function sW(t,e){let r=t.tagName.toLocaleLowerCase();if(e=e.toLocaleLowerCase(),r.startsWith(e)){Cr(t);return}let i=Object.values(t.attributes);for(let n of i)n.nodeName.startsWith(e)&&t.removeAttributeNode(n);for(let n of Array.from(t.children))sW(n,e)}var hd=class hd{static getJsonkeysArr(){return["rect","obj","ellipse","text","group","arc","auxiliaryLine","auxiliaryPoint","dimension","dimensionAngle","dimensionLength","dimensionRadius"]}static getLayerOrderContainer(){let e=dy(),r=new Map;for(let i of e)r.set(i,[]);return r}static toSVG(e,r){e.itemOrder=e.itemOrder||[];let n=['<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" '+(r!=null&&r.viewBox?['viewBox="',r.viewBox,'"'].join(""):"")+">"],s=Object.create(null),a=hd.getJsonkeysArr();r!=null&&r.before&&r.before(n);let o=hd.convertAll(a,e,s);n.push('<g xmlns="http://www.w3.org/2000/svg" id="g1">'),n.push(hd.joinJsonInOrderStr(s,e.itemOrder,o)),n.push("</g>"),n.push("</svg>");let l=n.join("").replace(/[^\x00-\x7f]/gu,function(c){return"&#x"+(c.codePointAt?c.codePointAt(0):c.charCodeAt(0)).toString(16)+";"});return l=l.replace(/&(?![a-z]+\d{0,2};|#\d+;|#x[\da-f]+;)/gi,"&amp;"),l}static joinJsonInOrderStr(e,r,i){let n=this.getLayerOrderContainer();for(let a of r)if($t(e,a)){let o=i.get(a),l=n.get(o);l.push(e[a]),n.set(o,l),delete e[a]}for(let a in e){let o=i.get(a),l=n.get(o);l.push(e[a]),n.set(o,l)}return Array.from(n.values()).flat(1).join(" ")}static convertAll(e,r,i){let n=new Map;for(let s of e)if(r[s]){for(let a in r[s])if($t(r[s],a))try{let o=r[s][a];i[a]=hd[s](o),n.set(a,o.layer)}catch(o){console.error(o,s)}}return n}static getLineStyleKeys(){return Object.keys(this.lineStyle).map(e=>+e)}static generateCustomizeStr(e,r=[]){if(!e)return" ";let i=[],n=[],s=e.strokeWidth;typeof s=="number"&&n.push(`stroke-width="${s}"`);let a=e.displayStroke===!1?"":e.strokeColor;a&&n.push(`stroke="${a}"`),this.getLineStyleKeys().includes(e.strokeStyle)&&n.push(`stroke-dasharray="${hd.lineStyle[e.strokeStyle]}"`);let o=e.displayFill===!1?"none":e.fillColor;o!==void 0&&(typeof o=="string"&&o.indexOf("#")!=-1?n.push(`fill="${o}"`):n.push('fill="none"'));let l=e.layer||1,c=e.cover?1:0,u=e.scope===void 0?"":e.scope,d=typeof e.opacity=="number"?e.opacity:1;l==2&&(d=db(+e.transparencyPrint*100,+e.transparencyWhite*100));let A=e.hide?1:0,h=e.locked?1:0,f=rn.eleIsHide(e)?"none":"",p=mg(e.name||"");return n.push(`layer="${l}" cover="${c}" scope="${u}" opacity="${d}" hide="${A}" locked="${h}" name="${p}" display="${f}"`),(n?n.join(" "):" ")+` style="${r.join(";")}" `+(i?` class="${i.join(" ")}" `:" ")}static rect(e){let{width:r,height:i,matrixArr:n}=vn.getRectFromMatrix(e.matrix),a=`transform="${xr.getTransformStr(n)}"`,o=hd.generateCustomizeStr(e);return`<rect id="${e.gId}" ${o} c_partid="rect" x="0" y="0" width="${r}" height="${i}" rx="${e.rx||0}" ry="${e.ry||0}"  ${a} />`}static obj(e){return BSe(e)}static dimension(e){return new Ua(e).getSvg()}static dimensionLength(e){return new ya(e).getSvg()}static dimensionAngle(e){return new ga(e).getSvg()}static dimensionRadius(e){return new ca(e).getSvg()}static auxiliaryLine(e){let r=hd.generateCustomizeStr(e);return`<line c_partid="auxiliaryLine" id="${e.gId}"  ${r} x1="${e.x1}" y1="${e.y1}" x2="${e.x2}" y2="${e.y2}" />`}static auxiliaryPoint(e){let r=hd.generateCustomizeStr(e);return`<circle c_partid="auxiliaryPoint" id="${e.gId}" cx="${e.x}" cy="${e.y}" r="${pg}" ${r}/>`}static ellipse(e){let{rx:r,ry:i,matrixArr:n}=tn.getEllipseFromMatrix(e.matrix),a=`transform="${xr.getTransformStr(n)}"`,o=hd.generateCustomizeStr(e);return`<ellipse id="${e.gId}" ${o}  c_partid="ellipse" cx="0" cy="0" rx="${r}" ry="${i}" ${a} />`}static arc(e){let r=Bn.getD(e);return`<path ${hd.generateCustomizeStr(e,["stroke-linecap: round"])} d="${r}" c_partid="arc" id="${e.gId}" />`}static group(e){let r=hd.generateCustomizeStr(e,["stroke-linecap: round"]);return`<path id="${e.gId}" ${r} c_partid="group" d="${e.d}"/>`}static text(e){return Jq(e)}};hd.lineStyle={0:"0",1:"6,6",2:"3,10",3:"4,2,1,2"};var Ba=hd;function BSe(t){let e=t.layer||"1",r=t.cover?1:0,i=t.scope===void 0?"":t.scope,n=typeof t.opacity=="number"?t.opacity:1,s=t.hide?1:0,a=t.locked?1:0,o=t.name||"",l=xr.getTransformStr(t.matrix);t.content=nW(t.content);let c={id:t.gId,layer:e,cover:r,scope:i,opacity:n,hide:s,locked:a,name:o,preserveAspectRatio:"none",c_partid:"obj","xlink:href":t.content,x:0,y:0,width:1,height:1,display:rn.eleIsHide(t)?"none":"",transform:l};return`<image ${Object.entries(c).map(([d,A])=>`${d}="${mg(String(A))}"`).join(" ")}></image>`}var Bn=class t extends ny{constructor(r){super(r);this.startAnchorSelected=!1;this.endAnchorSelected=!1;this.middleAnchorSelected=!1;this.centerSelected=!1}getMatrix(){return Ue.scale(this.data.rx,this.data.ry).rotateD(this.data.angle).translate(this.cx,this.cy)}getInverseMatrix(){let r=this.getMatrix();return new Ue(r.getInverseMatrix().data)}setControlDotSelected(r,i){return Oc({x:r,y:i},this.vectorStart())?(this.startAnchorSelected=!0,!0):Oc({x:r,y:i},this.vectorEnd())?(this.endAnchorSelected=!0,!0):Oc({x:r,y:i},this.vectorCenter())?(this.centerSelected=!0,!0):Oc({x:r,y:i},this.getMiddleAnchor())?(this.middleAnchorSelected=!0,!0):!1}getMiddleAnchor(){if(this.middleVector)return this.middleVector;let r=this.vectorStart(),n=this.vectorEnd().angleD2(r),s=Ue.rotateD(-n).setOrigin1(r),a=this.getMatrix().multiply3(s),{a:o,b:l,c,d:u,e:d,f:A}=nr.getMatrixabcdef(a),h=Math.atan2(u,l);if(this.data.sweep===1){let f=Math.cos(h+Math.PI),p=Math.sin(h+Math.PI),m=o*f+c*p+d,y=l*f+u*p+A,g=new ne(m,y).rotateD(r,n);return this.middleVector=g,g}else{let f=Math.cos(h),p=Math.sin(h),m=o*f+c*p+d,y=l*f+u*p+A,g=new ne(m,y).rotateD(r,n);return this.middleVector=g,g}}moveMiddleAnchor2(r,i,n){let s=this.vectorStart(),o=this.vectorEnd().angleD2(s),l=this.getMiddleAnchor(),c=l.add1(r,i),u=Ue.translate(-s.x,-s.y).rotateD(-o),d=c.multiply3(u).y/l.multiply3(u).y,A=1;n.keepRatio&&(A=d);let h=u.scale(A,d).rotateD(o).translate1(s);ls.syncArc(this.data,h,{updateD:!1})}moveMiddleAnchor(r,i,n){if(n.alt)return this.moveMiddleAnchor2(r,i,n);let s=this.vectorStart(),a=this.vectorEnd(),l=this.getMiddleAnchor().add1(r,i),c=[s.x,s.y,a.x,a.y,l.x,l.y],u=fP.apply(null,c);if(!u)return;let d={gId:this.data.gId,x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2,rx:u.r,ry:u.r,large:u.largeArcFlag,sweep:u.sweepFlag,angle:0,rotation:0};this.data.temp=d,this.render(d)}forTwoArc(r,i,n){let s=this.vectorStart(),a=this.vectorEnd();if(this.startAnchorSelected){let m=s;s=a,a=m}let o=a.angleD2(s),l=a.add1(r,i),c=l.angleD2(s),u=Ue.translate(-s.x,-s.y).rotateD(-o),d=l.distance1(s),A=a.distance1(s);Rt.eq(d,0)&&(d=1),Rt.eq(A,0)&&(A=1);let h=d/A,f=1;n.keepRatio&&(f=h);let p=u.scale(h,f).rotateD(c).translate1(s);ls.syncArc(this.data,p,{updateD:n.updateD||!1})}forCenterArc(r,i,n){let s=new ne(r,i),a=this.getMatrix(),o=new Ue(a.getInverseMatrix().data),l,c,u,d;if(this.startAnchorSelected){let f=this.vectorStart().add(s).multiply3(o).angle2(ne.ORIGIN);u=new ne(Math.cos(f),Math.sin(f)).multiply3(a),d={x1:u.x,y1:u.y},c=this.vectorEnd().sub(this.vectorCenter()),l=new ne(u.x,u.y).sub(this.vectorCenter())}else if(this.endAnchorSelected){let f=this.vectorEnd().add(s).multiply3(o).angle2(ne.ORIGIN);u=new ne(Math.cos(f),Math.sin(f)).multiply3(a),d={x2:u.x,y2:u.y},c=new ne(u.x,u.y).sub(this.vectorCenter()),l=this.vectorStart().sub(this.vectorCenter())}let h=l.cross(c)>0?0:1;delete this.data.temp,this.data.temp={...this.data,large:h,...d},this.render(this.data.temp)}moveControlPoint(r,i,n){let s=this.data.type;if(this.centerSelected){let a=Ue.translate(r,i);ls.syncArc(te.getArc(this.data.gId),a,{updateD:n.updateD||!1});return}if(this.middleAnchorSelected)return this.moveMiddleAnchor(r,i,n);if(n.ctrl){s===1?this.forTwoArc(r,i,n):this.forCenterArc(r,i,n);return}2===s?this.forTwoArc(r,i,n):this.forCenterArc(r,i,n)}vectorCenter(){return new ne(this.cx,this.cy)}startAngle(){return Cs(-this.vectorStart().angleD2(this.vectorCenter()))}endAngle(){return Cs(-this.vectorEnd().angleD2(this.vectorCenter()))}setArcType(r){return this.data.type=r,this}setStart(r,i){return this.startAnchorSelected=!0,this.forTwoArc(r-this.data.x1,i-this.data.y1,{updateD:!0}),this}setEnd(r,i){return this.endAnchorSelected=!0,this.forTwoArc(r-this.data.x2,i-this.data.y2,{updateD:!0}),this}setRadius(r,i,n){r=r||this.data.rx,i=i||this.data.ry;let s=Ue.rotateD(-this.data.angle).scale(r/this.data.rx,i/this.data.ry).rotateD(this.data.angle).setOrigin1(n||this.vectorCenter());return ls.syncArc(this.data,s,{updateD:!0}),this}setData(){return te.setArc(this.data.gId,this.data),this}render(r){r=r||this.data,Hi.renderer.attr(r.gId,"d",t.getD(r))}static getLoverArcId(r){return r+"-lover"}static removeHalfArc(r){r=this.getLoverArcId(r),ZX([r])}static createHalfArc(r){if(pi.isEditingPath()!==r)return;let{json:i,cmdKey:n}=te.getById(r);if(n!=="arc")return;let s=vi(i.temp||i);s={...i,...s},s.sweep=s.sweep===0?1:0,s.large=s.large===1?0:1,s.opacity=.3,s.gId=this.getLoverArcId(r);let a=Ba.arc(s);Hi.renderer.removeNode(s.gId);let o=rl(a);X.gCanvas.appendChild(o),Hi.renderer.attr(s.gId,"pointer-events","none"),o.classList.add(UA)}static getD(r){return["M",r.x1,r.y1,"A",r.rx,r.ry,r.angle,r.large,r.sweep,r.x2,r.y2].join(" ")}};var gk=class{sync(e,r,i){let n=new Bn(e),a=n.getMatrix().multiply3(r),o=nr.getMatrix6FromMatrix(a),l=n.getInverseMatrix(),c=new ne(e.x1,e.y1).multiply3(l).multiply3(a),u=new ne(e.x2,e.y2).multiply3(l).multiply3(a),d=a.isMirrored()?e.sweep===1?0:1:e.sweep,A=nr.calcuEllipse(o);e.temp={gId:e.gId,rx:A.a,ry:A.b,x1:c.x,y1:c.y,x2:u.x,y2:u.y,angle:A.degree,sweep:d,large:e.large,rotation:e.rotation},n.render(e.temp),i.updateD&&(Object.assign(e,e.temp),delete e.temp)}syncArc(e,r,i){let n=$i.checkOne("arc",e,r);n!==!1&&$i.addCallBack(()=>{var s;n(),this.sync(e,r,i),(s=i==null?void 0:i.fn)==null||s.call(i),Bn.createHalfArc(e.gId)})}syncArcSize(e,r,i,n){let{x:s,y:a,width:o,height:l}=un(e),c=1,u=1;if(Ir(i)||(c=i/o),Ir(n)||(u=n/l),c===0||u===0||c===1&&u===1)return;let d=Ue.scale(c,u).setOrigin1(r);this.syncArc(e,d,{updateD:!0})}get8Dots(e){let r=0,i=0,n=1,s=1,a=r-n,o=r+n,l=i-s,c=i+s,u=[[a,l],[o,l],[o,c],[a,c],[r,l],[o,i],[r,c],[a,i]],d=e.temp||e,{rotation:A,angle:h}=d,f=new Bn(d).vectorCenter(),p=Ue.scale(d.rx,d.ry).rotateD(h||A).translate(f.x,f.y),m=[];for(let y of u){let g=new ne(y[0],y[1]).multiply3(p);m.push(g.x,g.y)}return m}get8Dots2(e){let r=Ue.rotateD(-e.rotation).setOrigin(e.x1,e.y1),i=new Bn(e),s=i.getMatrix().multiply3(r),a=nr.getMatrix6FromMatrix(s),o=i.getInverseMatrix(),l=new ne(e.x1,e.y1).multiply3(o).multiply3(s),c=new ne(e.x2,e.y2).multiply3(o).multiply3(s),u=s.isMirrored()?e.sweep===1?0:1:e.sweep,d=nr.calcuEllipse(a),A={rx:d.a,ry:d.b,x1:l.x,y1:l.y,x2:c.x,y2:c.y,angle:d.degree,sweep:u,large:e.large,rotation:e.rotation},{x:h,y:f,width:p,height:m}=un(A,"arc"),y=[[h,f],[h+p,f],[h+p,f+m],[h,f+m],[h+p/2,f],[h+p,f+m/2],[h+p/2,f+m],[h,f+m/2]],g=[],b=Ue.rotateD(e.rotation).setOrigin(e.x1,e.y1);for(let[E,w]of y){let x=new ne(E,w).multiply3(b);g.push(x.x,x.y)}return g}rotate(e,r,i){let n=this.getRotationMatrix(e,r,i);n&&this.syncArc(e,n,{updateD:!0,fn(){e.rotation=+r.toFixed(2)}})}getRotationMatrix(e,r,i){if(!i){let{x:n,y:s,width:a,height:o}=un(e);i=new ne(n+a/2,s+o/2)}return Ue.rotateD(r-e.rotation).setOrigin1(i)}},ls=new gk;var yk=class{sync(e,r,i){let s=Jn(e.d,!1).map(o=>o.multiply3(r)),a=ql(s,!1,.01,{reverseY:!1});Hi.renderer.attr(e.gId,"d",a),e.tempD=a,i.updateD&&(e.d=a)}syncGroup(e,r,i){let n=$i.checkOne("group",e,r);n!==!1&&$i.addCallBack(()=>{var s;G1(n)&&n(),this.sync(e,r,i),(s=i==null?void 0:i.fn)==null||s.call(i)})}syncGroupWithRotation(e,r,i){let n=this.getRotationMatrix(e,r,i);n&&this.syncGroup(e,n,{updateD:!0,fn(){e.rotation=+r.toFixed(2)}})}getRotationMatrix(e,r,i){let{x:n,y:s,width:a,height:o}=un(e,"group"),l={x:n+a/2,y:s+o/2};i&&(l.x=i.x,l.y=i.y);let c=e.rotation||0;return Ue.rotateD(r-c).setOrigin(l.x,l.y)}syncGroupSize(e,r,i,n){let{x:s,y:a,width:o,height:l}=El(Fe(e.gId));r=r||o,i=i||l;let c=r/o||1,u=i/l||1;if(c===1&&u===1||!Number.isFinite(c)||!Number.isFinite(u))return;let d=Ue.scale(c,u).setOrigin1(n);this.syncGroup(e,d,{updateD:!0})}getGroupBBox(e){let r=this.getGroup8Dots(e),i=new pr;for(let s=0;s<r.length;s+=2){let a=r[s],o=r[s+1];i.ext6(a,o)}let n=i.build();return{x:n.minX,y:n.minY,width:n.width(),height:n.height()}}getGroup8Dots(e){let{rotation:r}=e;r=r||0;let i=e.d,{x:n,y:s,width:a,height:o}=aW(e),l={x:n+a/2,y:s+o/2},c=Ue.rotateD(-(0-r)).setOrigin(l.x,-l.y),d=Jn(i).map(g=>g.multiply3(c)),A=new pr;for(let g of d)for(let b of g.primitives)if(b instanceof Nt){let E=new pr;b.getBezierPoints(.5,x=>{E.ext2(x)});let w=E.build();A.ext1(w)}else A.ext1(b.bbox());let h=A.build(),f={x:h.minX,y:h.minY,width:h.width(),height:h.height()},p=Ue.rotateD(-r).setOrigin(l.x,-l.y),m=[[f.x,f.y+f.height],[f.x+f.width,f.y+f.height],[f.x+f.width,f.y],[f.x,f.y],[f.x+f.width/2,f.y+f.height],[f.x+f.width,f.y+f.height/2],[f.x+f.width/2,f.y],[f.x,f.y+f.height/2]],y=[];for(let g of m){let b=new ne(g[0],g[1]).multiply3(p);y.push(b.x,-b.y)}return y}},To=new yk;var dd=class{constructor(e){this.data=e}getAuxiliaryLinePrimitive(e,r,i,n=m_){let s=new ne(e,r),a=s.add1(1,0).rotateD(s,i),o=s.add1(-1,0).rotateD(s,i),l=o.sub(a).normalize();return a=s.sub(l.mul(n)),o=s.add(l.mul(n)),new Ee(a,o)}calcX1Y1X2Y2(e){let r=this.getAuxiliaryLinePrimitive(e.x,e.y,e.rotation,100);e.x1=r.start().x,e.y1=r.start().y,e.x2=r.end().x,e.y2=r.end().y}updateAuxiliaryLineDataXY(e){let r={x:this.data.x1,y:this.data.y1},i={x:this.data.x2,y:this.data.y2},n=[[{x:e.minX,y:e.minY},{x:e.maxX,y:e.minY}],[{x:e.maxX,y:e.minY},{x:e.maxX,y:e.maxY}],[{x:e.minX,y:e.maxY},{x:e.maxX,y:e.maxY}],[{x:e.minX,y:e.minY},{x:e.minX,y:e.maxY}]],s=[];for(let a of n){let o=v_(r,i,a[0],a[1]);if(o&&s.push(o),s.length===2)return this.data.x1=s[0].x,this.data.x2=s[1].x,this.data.y1=s[0].y,this.data.y2=s[1].y,this}return this}getPath(){return["M",this.data.x1,this.data.y1,this.data.x2,this.data.y2].join(" ")}render(){var l;this.calcX1Y1X2Y2(this.data),this.updateAuxiliaryLineDataXY(Mr.extendRect((l=X.svgRoot)==null?void 0:l.viewBox.animVal));let{gId:e,x1:r,y1:i,x2:n,y2:s,strokeColor:a,strokeStyle:o}=this.data;Hi.renderer.attrs(e,{x1:r,x2:n,y1:i,y2:s,stroke:a,"stroke-dasharray":Ba.lineStyle[o]})}toData(){}setData(){}unmount(){Cr(Fe(this.data.gId))}multiply3(e){let r=new ne(this.data.x1,this.data.y1),i=new ne(this.data.x2,this.data.y2),{x:n,y:s}=r.multiply3(e),{x:a,y:o}=i.multiply3(e),l=Sr(Math.abs(i.angleD(r)));if(![0,90,180,270].includes(l))return console.warn(`AuxiliaryLine: not support degree(${l}) line`);this.data.x=(n+a)/2,this.data.y=(s+o)/2,this.data.x1=n,this.data.y1=s,this.data.x2=a,this.data.y2=o,this.render()}rotateSelf(e,r){let i=Ue.rotateD(e).setOrigin1(r);this.multiply3(i)}flipH(e){let r=this.getMirror(e.x,void 0);this.multiply3(r)}flipV(e){let r=this.getMirror(void 0,e.y);this.multiply3(r)}getMirror(e,r){let i=new Ue;return zu(e)||(i=i.multiply3(Ue.MIRROR_X)),zu(r)||(i=i.multiply3(Ue.MIRROR_Y)),i.setOrigin(e||0,r||0)}};var Io={move(t,e,r){if(!e&&!r)return;let i=t.cmdKey;this[i]?this[i](t,e,r):Zn(i,t)},auxiliaryLine:(t,e,r)=>{t.x+=e,t.y+=r,new dd(t).render()},auxiliaryPoint:(t,e,r)=>{t.x+=e,t.y+=r;let i=Fe(t.gId);WA.circle1(i,e,r)},dimension(t,e,r){let i=new Ua(t).translate(e,r).render();i=null},dimensionLength(t,e,r){let i=new ya(t);i.translate(e,r).render(),i.setData()},dimensionAngle(t,e,r){let i=new ga(t);i.translate(e,r).render(),i.setData()},dimensionRadius(t,e,r){let i=new ca(t);i.translate(e,r).render(),i.setData()},obj(t,e,r){let i=Ue.translate(e,r);Ns.syncImage(t,i)},text(t,e,r){let i=Ue.translate(e,r);ps.syncText(t,i,{updateMatrix:!0})},group(t,e,r){let i=Ue.translate(e,r);To.syncGroup(t,i,{updateD:!0})},ellipse(t,e,r){let i=Ue.translate(e,r);tn.syncEllipse(t,i,{updateMatrix:!0})},arc(t,e,r){let i=Ue.translate(e,r);ls.syncArc(t,i,{updateD:!0})},rect(t,e,r){let i=Ue.translate(e,r);vn.syncRect(t,i,{updateMatrix:!0})}};var Ad=class{constructor(){this.allDimensions=[];this.ignoreDimension=new Set;this.xNode=new Set;this.yNode=new Set;this.reset()}reset(){return this.allDimensions.length=0,te.iteratorDimension(e=>{this.allDimensions.push(new Ua(e))}),this}prepareHistory(e,r){e=e||this.xNode,r=r||this.yNode;let i=new Set;for(let s of e){i.add(s.id);let a=new gr().findAllEleByOneEle(s.id);for(let o of a)mr.jsonSnap.addOne(te.getById(o).json);mr.jsonSnap.addOne(te.getById(s.id).json)}for(let s of r){i.add(s.id);let a=new gr().findAllEleByOneEle(s.id);for(let o of a)mr.jsonSnap.addOne(te.getById(o).json);mr.jsonSnap.addOne(te.getById(s.id).json)}let n=this.findDimensionByPrimitiveId(i);for(let s of n)mr.jsonSnap.addOne(te.getById(s).json);return this}removeXPrimitive(e=new Set([]),r){for(let i of e)r.delete(i);return r}removeYPrimitive(e=new Set([]),r){for(let i of e)r.delete(i);return r}movePrimitive(e,r,i,n){i=i||this.canMoveX,n=n||this.canMoveY;for(let s of i)Io.move(te.getById(s).json,e,0);for(let s of n)Io.move(te.getById(s).json,0,r);return this}moveDimension(e,r,i,n){if(i=i||this.xNode,n=n||this.yNode,!i.size&&!n.size)return this;for(let s of this.allDimensions)i.has(s.start)&&i.has(s.end)&&n.has(s.start)&&n.has(s.end)?s.translate(e,r).render():(i.has(s.start)&&s.incrementStartNode(e,0),i.has(s.end)&&s.incrementEndNode(e,0),n.has(s.start)&&s.incrementStartNode(0,r),n.has(s.end)&&s.incrementEndNode(0,r),i.has(s.start)&&i.has(s.end)&&s.updateOtherP(e,0),n.has(s.start)&&n.has(s.end)&&s.updateOtherP(0,r),s.updateOtherP(0,0)),te.setDimension(s.getId(),s.toJSON());return this}findDimensionByPrimitiveId(e){let r=new Set;for(let i of this.allDimensions){let n=i.start.id;e.has(n)&&r.add(i.getId());let s=i.end.id;e.has(s)&&r.add(i.getId())}return r}setIgnoreDimension(e){return this.ignoreDimension=e,this}getAllAffectedPrimitivesId(e,r,i=!0){e=e||this.xNode,r=r||this.yNode;let n=new Set,s=new Set,a=new gr;for(let l of e){n.add(l.id);let c=i?a.findAllEleByOneEle(l.id):[];for(let u of c)n.add(u)}for(let l of r){s.add(l.id);let c=i?a.findAllEleByOneEle(l.id):[];for(let u of c)s.add(u)}this.canMoveX=n,this.canMoveY=s;let o=new Set([...n,...s]);return{canMoveX:n,canMoveY:s,all:o,xNode:e,yNode:r}}getMoveIdsInCom(e,r,i){let{canMoveX:n,canMoveY:s}=this.getAllAffectedPrimitivesId(),a=new gr().getAllChildEles(i);for(let o of n)a.has(o)&&o!=r&&n.delete(o);for(let o of s)a.has(o)&&o!=r&&s.delete(o);return n.delete(e),s.delete(e),this.canMoveX=n,this.canMoveY=s,{canMoveX:n,canMoveY:s}}addNextTickTasks(e=[]){for(let r of this.allDimensions)r.makeOtherPointStatic(),r.addNextTickTasks(e)}setStillByEle(e){let r=[-1,0,1,2,3,4,5,6,7],i=new Set;for(let n of r){let s={dx:0,dy:0,id:e.id,index:n};i.add(s)}this.setNodeVisited(i)}setNodeVisited(e){for(let r of e){let{id:i,index:n,dx:s,dy:a}=r;for(let o of this.allDimensions)o.start.id===i&&n===o.start.index&&(o.startNextXMove=s,o.startNextYMove=a),o.end.id===i&&n===o.end.index&&(o.endNextXMove=s,o.endNextYMove=a)}return this}removeXNode(e,r){for(let i of e){let{id:n,index:s,dx:a,dy:o}=i;for(let l of r)l.id===n&&s===l.index&&r.delete(l)}return r}removeYNode(e,r){for(let i of e){let{id:n,index:s,dx:a,dy:o}=i;for(let l of r)l.id===n&&s===l.index&&r.delete(l)}return r}findDimensionNode(e){let r=[];for(let i of e){let{dx:n,dy:s,id:a}=i,o=this.findDimensionNodeByPrimitiveId(new Set([i.id]),n,s,new Set([i.index]));if(o===!1)return el.toastMsg(),!1;let{xNode:l,yNode:c}=o;(l.size||c.size)&&r.push({id:a,dx:n,dy:s,xNode:l,yNode:c})}return r}findDimensionNodeByPrimitiveId(e,r=1,i=1,n=new Set([-1,0,1,2,3,4,5,6,7])){let s=[],a=[];for(let o of e){let l=this.getXMoved(o,r,n);if(l===!1)return!1;s.push(...Array.from(l));let c=this.getYMoved(o,i,n);if(c===!1)return!1;a.push(...Array.from(c))}for(let o of s)this.xNode.add(o);for(let o of a)this.yNode.add(o);return{xNode:new Set(s),yNode:new Set(a)}}appendCombinationEle(e,r){let i=new gr().findAllEleByOneEle(e);for(let n of i)r.add(n)}checkAbandonedBySelfDimensionInX(e){return e.start.id===e.end.id&&!Ir(e.startNextXMove)&&!Ir(e.endNextXMove)&&!_i(e.startNextXMove,e.endNextXMove)&&e.categoryIsConstraint()?(console.warn(e,"\u667A\u80FD\u5C3A\u5BF8\u6807\u6CE8\u5728\u81EA\u8EAB\uFF0C\u5F00\u59CB/\u7ED3\u675F\u8282\u70B9\u79FB\u52A8\u7684 x \u8DDD\u79BB\u4E0D\u540C",e.startNextXMove,e.endNextXMove),!0):!1}checkAbandonedBySelfDimensionInY(e){return e.start.id===e.end.id&&!Ir(e.startNextYMove)&&!Ir(e.endNextYMove)&&!_i(e.startNextYMove,e.endNextYMove)&&e.categoryIsConstraint()?(console.warn(e,"\u667A\u80FD\u5C3A\u5BF8\u6807\u6CE8\u5728\u81EA\u8EAB\uFF0C\u5F00\u59CB\u7ED3\u675F\u8282\u70B9\u79FB\u52A8\u7684 y \u8DDD\u79BB\u4E0D\u540C",e.startNextYMove,e.endNextYMove),!0):!1}getXMoved(e,r=1,i){let n=new Set,s=new Set([e]),a=c=>!!(c.getCategory()==="Annotation"||c.direction==="y"||this.ignoreDimension.has(c.getId())),o=1,l=new Set;for(;s.size;){let c=s.values().next().value;s.delete(c);for(let u of this.allDimensions)if([u.start.id].includes(c)&&(o===1&&i.has(u.start.index)||o!==1)){if(!Ir(u.startNextXMove)&&u.startNextXMove!==r&&u.categoryIsConstraint())return console.warn(r,u.startNextXMove),!1;if(!Ir(u.startNextXMove))continue;if(u.startNextXMove=r,this.checkAbandonedBySelfDimensionInX(u))return!1;if(n.add(u.start),a(u))continue;let d=u.end.id+"_"+u.end.index;if(l.has(d))continue;l.add(u.start.id+"_"+u.start.index),s.add(u.end.id),this.appendCombinationEle(u.end.id,s)}for(let u of this.allDimensions)if([u.end.id].includes(c)&&(i.has(u.end.index)&&o===1||o!=1)){if(!Ir(u.endNextXMove)&&!_i(u.endNextXMove,r)&&u.getCategory()!=="Annotation")return console.warn(r,u.endNextXMove),!1;if(!Ir(u.endNextXMove))continue;if(u.endNextXMove=r,this.checkAbandonedBySelfDimensionInX(u))return!1;if(n.add(u.end),a(u))continue;let d=u.start.id+"_"+u.start.index;if(l.has(d))continue;l.add(u.end.id+"_"+u.end.index),s.add(u.start.id),this.appendCombinationEle(u.start.id,s)}o++}return n}getYMoved(e,r=1,i=new Set([-1,0,1,2,3,4,5,6,7])){let n=new Set,s=new Set([e]),a=c=>!!(c.getCategory()==="Annotation"||c.direction==="x"||this.ignoreDimension.has(c.getId())),o=1,l=new Set;for(;s.size;){let c=s.values().next().value;s.delete(c);for(let u of this.allDimensions)if([u.start.id].includes(c)&&(i.has(u.start.index)&&o===1||o!==1)){if(!Ir(u.startNextYMove)&&u.startNextYMove!==r&&u.categoryIsConstraint())return console.warn(r,u.startNextYMove),!1;if(!Ir(u.startNextYMove))continue;if(u.startNextYMove=r,this.checkAbandonedBySelfDimensionInY(u))return!1;if(n.add(u.start),a(u))continue;let d=u.end.id+"_"+u.end.index;if(l.has(d))continue;l.add(u.start.id+"_"+u.start.index),s.add(u.end.id),this.appendCombinationEle(u.end.id,s)}for(let u of this.allDimensions)if([u.end.id].includes(c)&&(i.has(u.end.index)&&o===1||o!==1)){if(!Ir(u.endNextYMove)&&u.endNextYMove!==r&&u.categoryIsConstraint())return console.warn(r,u.endNextYMove),!1;if(!Ir(u.endNextYMove))continue;if(u.endNextYMove=r,this.checkAbandonedBySelfDimensionInY(u))return!1;if(n.add(u.end),a(u))continue;let d=u.start.id+"_"+u.start.index;if(l.has(d))continue;l.add(u.end.id+"_"+u.end.index),s.add(u.start.id),this.appendCombinationEle(u.start.id,s)}o++}return n}overDefined(e,r,i){let n=[];for(let l of this.xNode)l.id===e&&n.push(e),l.id===r&&n.push(r);let s=[];for(let l of this.yNode)l.id===e&&s.push(e),l.id===r&&s.push(r);let a=n.includes(e)&&n.includes(r);if(i==="x")return a;let o=s.includes(e)&&s.includes(r);return i==="y"?o:i==="xy"?a&&o:!1}overDefinedSelf(e,r){let i=this.findDimensionByPrimitiveId(new Set([e]));for(let n of i){let s=te.getDimension(n),a=new Ua(s);if(a.categoryIsConstraint()&&a.isSelfDimension()&&s.direction===r||a.categoryIsConstraint()&&a.isSelfDimension()&&s.direction==="xy")return!0}return!1}};var lL={scale(t,e,r,i){let{json:n,cmdKey:s}=te.getById(t),a=Ue.scale(e,r).setOrigin1(i);this[s]?this[s](n,a):Zn(s)},obj(t,e){Ns.syncImage(t,e,{updateMatrix:!0})},text(t,e){ps.syncText(t,e,{updateMatrix:!0})},group(t,e){To.syncGroup(t,e,{updateD:!0})},ellipse(t,e){tn.syncEllipse(t,e,{updateMatrix:!0})},arc(t,e){ls.syncArc(t,e,{updateD:!0})},rect(t,e){vn.syncRect(t,e,{updateMatrix:!0})}};var bk=class{constructor(){}storeFollow(e,r){this.lastFollowHandleX=e,this.lastFollowHandleY=r}storeDriving(e,r){this.lastDrivingHandleX=e,this.lastDrivingHandleY=r}exchangeFollow(){Ir(this.lastFollowHandleX)||(this.followHandleX=this.lastFollowHandleX,this.followHandleY=this.lastFollowHandleY,this.lastFollowHandleX=null,this.lastFollowHandleY=null)}exchangeDriving(){Ir(this.lastDrivingHandleX)||(this.drivingHandleX=this.lastDrivingHandleX,this.drivingHandleY=this.lastDrivingHandleY,this.lastDrivingHandleX=null,this.lastDrivingHandleY=null)}getFollowHandle(){return{x:this.followHandleX,y:this.followHandleY}}getDrivingHandle(){return{x:this.drivingHandleX,y:this.drivingHandleY}}flush(){this.followHandleX=null,this.followHandleY=null,this.lastFollowHandleX=null,this.lastDrivingHandleY=null,this.drivingHandleX=null,this.drivingHandleY=null,this.lastDrivingHandleX=null,this.lastDrivingHandleY=null}setPrevHandlePosition(e,r,i,n,s){let a=n.pathSegTypeAsLetter,o=new ne(e.x1,e.y1),l=new ne(e.x1+r,e.y1+i);if(this.storeDriving(e.x1+r,e.y1+i),a==="C")if(s.ctrl){this.exchangeFollow(),this.exchangeDriving();let{x:c,y:u}=this.getFollowHandle();Ir(c)||(n.x2=c,n.y2=u)}else{let c=new ne(n.x2,n.y2),{x:u,y:d}=this.getFollowHandle(),{x:A,y:h}=yu.getDrivingHandle();Ir(u)||(c=new ne(u,d)),Ir(A)||(o=new ne(A,h));let f=pi.handleFollowHandle(new ne(n.x,n.y),{oldP:o,newP:l},c);n.x2=f.x,n.y2=f.y,this.storeFollow(f.x,f.y)}}setNextHandlePosition(e,r,i,n,s){let a=n.pathSegTypeAsLetter,o=new ne(e.x2,e.y2),l=new ne(e.x2+r,e.y2+i);if(a==="C"){if(s.ctrl){this.exchangeFollow(),this.exchangeDriving();let{x:c,y:u}=yu.getFollowHandle();Ir(c)||(n.x1=c,n.y1=u)}else{let c=new ne(n.x1,n.y1),{x:u,y:d}=this.getFollowHandle();Ir(u)||(c=new ne(u,d));let{x:A,y:h}=this.getDrivingHandle();Ir(A)||(o=new ne(A,h));let f=pi.handleFollowHandle(new ne(e.x,e.y),{oldP:o,newP:l},c);n.x1=f.x,n.y1=f.y,this.storeFollow(f.x,f.y)}this.storeDriving(e.x2+r,e.y2+i)}}},yu=new bk;var co={createPath8Dots:function(t){let e=la([t],!0),{x:r,y:i,width:n,height:s}=e;return[r,i,r+n,i,r+n,i+s,r,i+s,r+n/2,i,r+n,i+s/2,r+n/2,i+s,r,i+s/2]},get(t,e="multi"){switch(t.cmdKey){case"arc":return co.path_arc.get(t.gId);case"rect":return co.rect.get(t,e);case"obj":return co.image.get(t,e);case"ellipse":return co.ellipse.get(t);case"group":return co.path_group.get(t);case"text":return co.text.get(t,e);case"_runtime":{let r=t;switch(r.subCmdKey){case"select-box":return co.selectBox.get(r);default:break}break}default:break}},set:function(t,e,r,i,n,s,a,o,l=!1,c=!1,u={}){let d=t.tagName;if(d=ge(t,"id")=="selectBox1"?"selectbox":d,!co[d])throw new Error(d);co[d].set(t,e,r,i,n,s,a,o,l,c,u)},selectBox:{get:function(t){let{x:e,y:r,width:i,height:n}=t;return[e,r,e+i,r,e+i,r+n,e,r+n,(2*e+i)/2,r,e+i,(2*r+n)/2,(2*e+i)/2,r+n,e,(2*r+n)/2]},set:function(t,e,r,i,n,s,a,o){}},text:{get:function(t,e="multi"){let r=t.cacheWidth,i=t.cacheHeight,n=new Array,s=ne.ORIGIN;n.push(s.add1(0,-i)),n.push(s.add1(r,-i)),n.push(s.add1(r,0)),n.push(s),n.push(s.add1(r/2,-i)),n.push(s.add1(r,-i/2)),n.push(s.add1(r/2,0)),n.push(s.add1(0,-i/2));let a=xr.createMatrixFrom6(t.tempMatrix||t.matrix);if(e==="multi")return n.reduce((l,c)=>(c=c.multiply3(a),l.push(c.x,c.y),l),new Array);let o=[];for(let l=0;l<4;l++){let c=n[l];o.push([c.x,c.y])}return xr.getMaxOuterBoundingBox(o,t)},set:function(t,e,r,i,n,s,a,o,l=!1,c,u={}){let d=xr.getEightControlMatrix3(e,r,i,n,c,l,s,u),A=te.getText(t.id);ps.syncText(A,d,{updateMatrix:!1})}},g:{get:function(t){if(Pi(t)==="text")return co.text.get.apply(t,arguments);let r=t.getBBox(),i=r.x,n=r.y,s=r.width,a=r.height;return[i,n,i+s,n,i,n+a,i+s,n+a]},set:function(t,e,r,i,n){if(Pi(t)==="text")return co.text.set.apply(t,arguments);WA.g(t,i,n)}},image:{get:function(t,e="multi"){let r=1,i=1,n=[[0,0],[r,0],[r,i],[0,i],[r/2,0],[r,i/2],[r/2,i],[0,i/2]];if(e==="multi"){let a=xr.createMatrixFrom6(t.tempMatrix||t.matrix),o=[];for(let[l,c]of n){let u=new ne(l,c).multiply3(a);o.push(u.x,u.y)}return o}return xr.getMaxOuterBoundingBox(n.slice(0,4),t)},set:function(t,e,r,i,n,s,a,o,l=!1,c=!1,u={}){let d=te.gJsonCache.obj[t.id];if(!d)return;let A=xr.getEightControlMatrix3(e,r,i,n,c,l,s,u);Ns.syncImage(d,A,{updateMatrix:!1})}},rect:{get:function(t,e="multi"){let r=Jh(t)?t:te.getRect(t.id),{matrix:i,tempMatrix:n}=r,s=xr.createMatrixFrom6(n||i),a=0,o=1,l=0,c=1,u=[[a,l],[o,l],[o,c],[a,c],[.5,l],[o,.5],[.5,c],[a,.5]];if(e==="multi"){let d=[];for(let A of u){let h=new ne(A[0],A[1]).multiply3(s);d.push(h.x,h.y)}return d}return xr.getMaxOuterBoundingBox(u.slice(0,4),r)},set:function(t,e,r,i,n,s,a,o,l=!1,c=!1,u={}){let d=xr.getEightControlMatrix3(e,r,i,n,c,l,s,u),A=te.getRect(t.id);vn.syncRect(A,d,{updateMatrix:!1})}},circle:{get:function(t){let e=+ge(t,"cx"),r=+ge(t,"cy"),i=+ge(t,"r"),n=[e-i,r-i,e+i,r-i,e+i,r+i,e-i,r+i];return[e,r,e,r-i,e,r+i,e-i,r,e+i,r].concat(n)},set:function(t,e,r,i,n){e||(e=co.circle.get(t));let s={cx:e[0],cy:e[1],r:e[1]-e[3]};r===0&&(s.cx+=i,s.cy+=n),r==1&&(s.r-=n/2,s.cy+=n/2),r==2&&(s.r+=n/2,s.cy+=n/2),r==3&&(s.r-=i/2,s.cx+=i/2),r==4&&(s.cx+=i/2,s.r+=i/2),r==5&&(s.r-=i),r==6&&(s.r+=i),r==7&&(s.r+=i),r==8&&(s.r+=i),s.r!==0&&(s.r<0&&(s.r=-s.r),!(s.r<10)&&(s.cx=parseInt(String(s.cx*10))/10,s.cy=parseInt(String(s.cy*10))/10,ge(t,s)))}},ellipse:{get(t){let e=0,r=0,i=1,n=1,s=e-i,a=e+i,o=r-n,l=r+n,c=[[s,o],[a,o],[a,l],[s,l],[e,o],[a,r],[e,l],[s,r]],{tempMatrix:u,matrix:d,rotation:A}=t,h=nr.createMatrixFrom6(u||d),f=[];for(let p of c){let m=new ne(p[0],p[1]).multiply3(h);f.push(m.x,m.y)}return f},set:function(t,e,r,i,n,s,a,o,l=!1,c=!1,u={}){let d=xr.getEightControlMatrix3(e,r,i,n,c,l,s,u),A=te.getEllipse(t.id);tn.syncEllipse(A,d,{updateMatrix:!1})}},line:{get:function(t){return[+ge(t,"x1"),+ge(t,"y1"),+ge(t,"x2"),+ge(t,"y2")]},set:function(t,e,r,i,n){e||(e=co.line.get(t));let s={x1:e[0],y1:e[1],x2:e[2],y2:e[3]};r===0&&(s.x1+=i,s.y1+=n),r==1&&(s.x2+=i,s.y2+=n),ge(t,s)}},polygon:{get:function(t){let e=Yf(ge(t,"points")).split(/[\s\,]+/g),r;for(r=0;r<e.length;r++)e[r]=+e[r];for(r=e.length-2;r>=2;r-=2)e.splice(r,0,(e[r-2]+e[r])/2,(e[r-1]+e[r+1])/2);return r=e.length-2,e.push((e[0]+e[r])/2,(e[1]+e[r+1])/2),e.lightDots="odd",e},set:function(t,e,r,i,n){let s=e.slice(0),a,o=2*r;for(s[o]+=i,s[o+1]+=n,r==s.length/2-1?(!_i(s[o]*2,s[0]+s[o-2])||!_i(s[o+1]*2,s[1]+s[o-1]))&&s.splice(o,0,0,0):r%2&&(!_i(s[o]*2,s[o-2]+s[o+2])||!_i(s[o+1]*2,s[o-1]+s[o+3]))&&(s.splice(o+2,0,0,0),s.splice(o,0,0,0)),o=4,a=s.slice(0,2);o<s.length-1;o+=4)a.push(s[o],s[o+1]);let l={},c=[],u;for(let b=0;b<a.length-1&&c.length<4;b+=2)u=a[b]+"_"+a[b+1],l[u]||(l[u]=!0,c.push(b));if(c.length<=2)return;let d=!0,A,h,f,p,m,y;for(r=2;r<c.length;r++)if(A=a[c[0]],h=a[c[0]+1],f=a[c[1]],p=a[c[1]+1],m=a[c[r]],y=a[c[r]+1],!_i((A-f)*(y-p),(m-f)*(h-p))){d=!1;break}if(d)return;let g={points:w_(a.join(" "))};ge(t,g)}},path:{get:function(t){let e=pb(t);if(e){let w=t.tagName+"_"+e;if(co[w]&&co[w].get)return co[w].get.apply(t,arguments)}let r=t.pathSegList,i=r.numberOfItems,n=0,s=0,a=[],o=0,l=0,c=[],u,d,A,h,f,p,m,y,g,b,E;for(u=0;u<i;u++)switch(A=r.getItem(u),h=A.pathSegType,u===0&&h!=Ds&&h!=ia&&h!=Ri&&a.push(n,s),d=a.length/2-1,h){case Ri:n=o,s=l;break;case Ds:if(n=A.x,s=A.y,o=n,l=s,u+1==i||(m=r.getItem(u+1),p=m.pathSegType,p==Ds||p==ia||p==Ri))break;a.push(n,s),p==ka&&a.push((n+m.x)/2,(s+m.y)/2);break;case ka:if(a.push(n=A.x,s=A.y),u+1==i)break;m=r.getItem(u+1),p=m.pathSegType,p==Ri&&(m=r.getItem(0)),(p==ka||p==Ri)&&a.push((n+m.x)/2,(s+m.y)/2);break;case rd:a.push(n=A.x,s);break;case id:a.push(n,s=A.y);break;case $h:c.push({from:d,to:d+1},{from:d+2,to:d+3}),a.push(A.x1,A.y1,n=A.x2,s=A.y2,A.x,A.y);break;case Zh:c.push({from:d+1,to:d+2}),a.push(A.x2,A.y2,n=A.x,s=A.y);break;case ed:c.push({from:d,to:d+1},{from:d+1,to:d+2}),a.push(A.x1,A.y1,n=A.x,s=A.y);break;case td:case ju:if(f=r.getItem(u-1),y=iy(f.x,f.y,A.x,A.y,A.largeArcFlag?1:0,A.sweepFlag?1:0,A.r1,A.r2,A.angle),g=y.cx,E=y.cy,b=Q0([f.x,f.y],[g,E],y.delta_theta/2),a.push(b[0],b[1]),a.push(n=A.x,s=A.y),u+1==i)break;m=r.getItem(u+1),p=m.pathSegType,p==Ri&&(m=r.getItem(0)),(p==ka||p==Ri)&&a.push((n+m.x)/2,(s+m.y)/2);break;case ia:if(n+=A.x,s+=A.y,o=n,l=s,u+1==i||(p=r.getItem(u+1).pathSegType,p==Ds||p==ia||p==Ri))break;a.push(n,s);break;case kA:a.push(n+=A.x,s+=A.y);break;case MA:a.push(n+=A.x,s);break;case FA:a.push(n,s+=A.y);break;case LA:c.push({from:d,to:d+1},{from:d+2,to:d+3}),a.push(n+A.x1,s+A.y1,n+A.x2,s+A.y2,n+=A.x,s+=A.y);break;case OA:c.push({from:d+1,to:d+2}),a.push(n+A.x2,s+A.y2,n+=A.x,s+=A.y);break;case NA:c.push({from:d+1,to:d+2}),a.push(n+A.x1,s+A.y1,n+=A.x,s+=A.y);break;case RA:case PA:a.push(n+=A.x,s+=A.y);break;default:break}if(ge(t,"drag")!="self"){let w=co.createPath8Dots(t);return c.length?w.c_helper_lines=c:w.lightDots="odd",w}return c.length?a.c_helper_lines=c:a.lightDots="odd",a},set:function(t,e,r,i,n,s){if(i===0&&n===0){if(s)if(Pi(t)==="arc"&&ge(t,"third-point")){let _=FC(e.join(" "));ge(t,{d:s,"third-point":_[2].x+","+_[2].y})}else ge(t,{d:s});return}let a=pb(t);if(a){let _=t.tagName+"_"+a;if(co[_]&&co[_].set){co[_].set.apply(t,arguments);return}}let o,l,c;if(/[^ahvqtsc]/i.test(s)){for(o=!0,l=e.slice(0),2*r+1<l.length&&(l[2*r]+=i,l[2*r+1]+=n),c=2;c<l.length-1;c+=2)if(l[c]!=l[0]||l[c+1]!=l[1]){o=!1;break}if(o)return}let u=t.pathSegList,d=u.numberOfItems,A=-1,h=r,f,p,m,y,g,b,E,w,x,I,C,G,U;if(s&&ge(t,{d:s}),e.c_helper_lines||(r=r>>1),!e.c_helper_lines&&h%2){p=u.getItem(r+1),p.pathSegType==ju?(m=u.getItem(r),g=e[h*2],b=e[h*2+1],E=D2({x:m.x,y:m.y},{x:p.x,y:p.y},{x:g+i,y:b+n}),E<4&&(E=4),E=Math.sqrt(E),w=p.sweepFlag,x=p.r1,I=sd(m.x,m.y,p.x,p.y),C=(p.x-m.x)*(b-m.y)-(g-m.x)*(p.y-m.y),G=(p.x-m.x)*(b+n-m.y)-(g+i-m.x)*(p.y-m.y),C*G<0&&(w^=1),x=I/(8*E)+E/2,U=x>E?0:1,x=rb(x),p.r1=x,p.r2=x,p.largeArcFlag=U,p.sweepFlag=w):u.insertItemBefore(t.createSVGPathSegLinetoAbs(e[h*2]+i,e[h*2+1]+n),r+1);return}e:for(f=0;f<d;f++)switch(p=u.getItem(f),p.pathSegType){case Ri:break;case Ds:case ia:if(f+1==d||(y=u.getItem(f+1).pathSegType,y==Ds||y==ia||y==Ri))break;if(A++,A==r){p.x=Sr(p.x+i,3),p.y=Sr(p.y+n,3);break e}break;case ka:case kA:if(A++,A==r){p.x=Sr(p.x+i,3),p.y=Sr(p.y+n,3);break e}break;case rd:case MA:if(A++,A==r){p.x+=i;break e}break;case id:case FA:if(A++,A==r){p.y+=n;break e}break;case $h:case LA:if(A++,A==r){p.x1+=i,p.y1+=n;break e}if(A++,A==r){p.x2+=i,p.y2+=n;break e}if(A++,A==r){p.x+=i,p.y+=n;break e}break;case Zh:case OA:if(A++,A==r){p.x2+=i,p.y2+=n;break e}if(A++,A==r){p.x+=i,p.y+=n;break e}break;case ed:case NA:if(A++,A==r){p.x1+=i,p.y1+=n;break e}if(A++,A==r){p.x+=i,p.y+=n;break e}break;case td:case RA:case PA:if(A++,A==r){p.x+=i,p.y+=n;break e}break;case ju:if(A++,A==r){p.x+=i,p.y+=n;break e}break;default:break}}},path_group:{get:function(t){if(pi.is8DotsMode(t.gId))return To.getGroup8Dots({...t,d:t.tempD||t.d});let r=document.getElementById(t.gId).pathSegList,i=r.numberOfItems,n=0,s=0,a=[],o=0,l=0,c=[],u,d,A,h,f,p,m,y,g=new Map;for(let b=0;b<i;b++){u=r.getItem(b),d=u.pathSegType;let E=b-1>-1&&r.getItem(b-1);b===0&&d!=Ds&&d!=ia&&d!=Ri&&a.push(n,s);let w=a.length/2-1;switch(d){case Ri:n=o,s=l;break;case Ds:if(n=u.x,s=u.y,o=n,l=s,b+1==i||(h=r.getItem(b+1),A=h.pathSegType,A==Ds||A==ia||A==Ri))break;a.push(n,s),A==ka;break;case ka:if(a.push(n=u.x,s=u.y),b+1==i)break;h=r.getItem(b+1),A=h.pathSegType,A==Ri&&(h=r.getItem(0)),A==ka||A==Ri;break;case rd:a.push(n=u.x,s);break;case id:a.push(n,s=u.y);break;case $h:c.push({from:w,to:w+1,belong:w},{from:w+2,to:w+3,belong:w+3});let x=E.x===u.x1&&E.y===u.y1,I=u.x2===u.x&&u.y2===u.y;g.set(w+1,{belong:w,display:!x}),g.set(w+2,{belong:w+3,display:!I}),a.push(u.x1,u.y1,n=u.x2,s=u.y2,u.x,u.y);break;case Zh:c.push({from:w+1,to:w+2}),a.push(u.x2,u.y2,n=u.x,s=u.y);break;case ed:c.push({from:w,to:w+1,belong:w}),g.set(w+1,{belong:w,display:!0}),a.push(u.x1,u.y1,n=u.x,s=u.y);break;case td:case ju:if(E=r.getItem(b-1),f=iy(E.x,E.y,u.x,u.y,u.largeArcFlag?1:0,u.sweepFlag?1:0,u.r1,u.r2,u.angle),p=f.cx,y=f.cy,m=Q0([E.x,E.y],[p,y],f.delta_theta/2),a.push(n=u.x,s=u.y),b+1==i)break;h=r.getItem(b+1),A=h.pathSegType,A==Ri&&(h=r.getItem(0)),A==ka||A==Ri;break;case ia:if(n+=u.x,s+=u.y,o=n,l=s,b+1==i||(A=r.getItem(b+1).pathSegType,A==Ds||A==ia||A==Ri))break;a.push(n,s);break;case kA:a.push(n+=u.x,s+=u.y);break;case MA:a.push(n+=u.x,s);break;case FA:a.push(n,s+=u.y);break;case LA:c.push({from:w,to:w+1},{from:w+2,to:w+3}),a.push(n+u.x1,s+u.y1,n+u.x2,s+u.y2,n+=u.x,s+=u.y);break;case OA:c.push({from:w+1,to:w+2}),a.push(n+u.x2,s+u.y2,n+=u.x,s+=u.y);break;case NA:c.push({from:w+1,to:w+2}),a.push(n+u.x1,s+u.y1,n+=u.x,s+=u.y);break;case RA:case PA:a.push(n+=u.x,s+=u.y);break;default:break}}return c.length&&(a.c_helper_lines=c),a.isModifyAnchor=!0,a.handleIndexes=g,a},set:function(t,e,r,i,n,s,a,o,l=!1,c=!1,u){if(pi.isAnchorMode(t.id)&&!l){if(/[^ahvqtsc]/i.test(s)){let y=!0,g=e.slice(0);2*r+1<g.length&&(g[2*r]+=i,g[2*r+1]+=n);for(let b=2;b<g.length-1;b+=2)if(g[b]!==g[0]||g[b+1]!==g[1]){y=!1;break}if(y)return}let A=t.pathSegList,h=A.numberOfItems,f=-1,p,m;s&&ge(t,{d:s});e:for(let y=0;y<h;y++){let g=y-1>-1&&A.getItem(y-1),b=g.pathSegTypeAsLetter,E=A.getItem(y),w=y+1<h&&A.getItem(y+1),x=w.pathSegTypeAsLetter;switch(E.pathSegType){case Ri:break;case Ds:case ia:if(p=E,y+1==h||(m=w.pathSegType,m==Ds||m==ia||m==Ri))break;if(f++,f==r){let I=Sr(E.x+i,3),C=Sr(E.y+n,3);x==="C"&&w.x1===E.x&&w.y1===E.y&&(w.x1=I,w.y1=C),E.x=I,E.y=C;break e}break;case ka:case kA:if(f++,f==r){E.x=Sr(E.x+i,3),E.y=Sr(E.y+n,3);break e}break;case rd:case MA:if(f++,f==r){E.x+=i;break e}break;case id:case FA:if(f++,f==r){E.y+=n;break e}break;case $h:case LA:if(f++,f==r){yu.setPrevHandlePosition(E,i,n,g,u),E.x1+=i,E.y1+=n;break e}if(f++,f==r){yu.setNextHandlePosition(E,i,n,w,u),E.x2+=i,E.y2+=n;break e}if(f++,f==r){E.x=Sr(E.x+i,3),E.y=Sr(E.y+n,3),E.x2=Sr(E.x2+i),E.y2=Sr(E.y2+n),x==="C"&&(w.x1+=i,w.x1=Sr(w.x1),w.y1+=n,w.y1=Sr(w.y1)),y!==h-1&&A.getItem(y+1).pathSegType===Ri&&(p.x=E.x,p.y=E.y);break e}break;case Zh:case OA:if(f++,f==r){E.x2+=i,E.y2+=n;break e}if(f++,f==r){E.x+=i,E.y+=n;break e}break;case ed:case NA:if(f++,f==r){E.x1+=i,E.y1+=n;break e}if(f++,f==r){E.x+=i,E.y+=n;break e}break;case td:case RA:case PA:if(f++,f==r){E.x+=i,E.y+=n;break e}break;case ju:if(f++,f==r){E.x+=i,E.y+=n;break e}break;default:break}}return}let d=xr.getEightControlMatrix3(e,r,i,n,c,l,s,u);To.syncGroup(te.getById(t.id).json,d,{updateD:!1})}},path_arc2:{get:function(t){let e=[],r,i=t.getPathData();for(r=0;r<i.length;r++)if(i[r].type=="A"){let n=i[r-1].values,s=i[r].values,a=iy(n[0],n[1],s[5],s[6],s[3],s[4],s[0],s[1],s[2]),o=a.cx,l=a.cy,c=Q0([n[0],n[1]],[o,l],a.delta_theta/2),u=kC(ge(t,"d")),d=S_(u);e.push(n[0],n[1],s[5],s[6],c[0],c[1],d.x,d.y);break}return e},set:function(t,e,r,i,n,s){if(i===0&&n===0){s&&ge(t,{d:s});return}let a,o,l,c=e?e.slice(0):co.path_arc2.get(t);if(r===3&&(c[0]+=i,c[1]+=n,c[2]+=i,c[3]+=n),r===0&&_i(c[0]+i,c[2])&&_i(c[1]+n,c[3])||r===1&&_i(c[2]+i,c[0])&&_i(c[3]+n,c[1])||r===2&&_i((c[2]-c[0])*(c[5]+n-c[1]),(c[3]-c[1])*(c[4]+i-c[0])))return;if(r===2){if(a=D2({x:c[0],y:c[1]},{x:c[2],y:c[3]},{x:c[4]+i,y:c[5]+n}),a<4)return;a=Math.sqrt(a)}s&&ge(t,"d",s);let u=t.pathSegList.getItem(1),d=u.r1,A=+u.largeArcFlag,h=+u.sweepFlag,f=sd(c[0],c[1],c[2],c[3]),p=d*d-f/4;r==2?(o=(c[2]-c[0])*(c[5]-c[1])-(c[4]-c[0])*(c[3]-c[1]),c[r*2]+=i,c[r*2+1]+=n,l=(c[2]-c[0])*(c[5]-c[1])-(c[4]-c[0])*(c[3]-c[1]),o*l<0&&(h^=1)):(a=d+(A?1:-1)*(p>0?Math.sqrt(p):0),c[r*2]+=i,c[r*2+1]+=n,f=sd(c[0],c[1],c[2],c[3])),d=f/(8*a)+a/2,A=d>a?0:1,c[0]=rb(c[0]),c[1]=rb(c[1]),d=rb(d),c[2]=rb(c[2]),c[3]=rb(c[3]),ge(t,"d","M"+c[0]+","+c[1]+" A"+d+","+d+" 0 "+A+" "+h+" "+c[2]+","+c[3])}},path_arc:{get(t){let{json:e}=te.getById(t),r=e.temp||e,i=ls.get8Dots2(r),n=new Bn(r),s=n.vectorCenter();if(pi.isAnchorMode(e.gId)){let a=n.getMiddleAnchor();return{cmdkey:"arc",anchor:[r.x1,r.y1,r.x2,r.y2,a.x,a.y],"solid-circle":[{x:s.x,y:s.y,type:"solid-circle"}]}}return{cmdkey:"arc",bbox:i}},set:function(t,e,r,i,n,s,a,o,l=!1,c=!1,u={}){let d=xr.getEightControlMatrix3(e,r,i,n,c,l,s,u),A=te.getById(t.id).json;ls.syncArc(A,d,{updateD:!1})}}};var bu=class{constructor(e,r,i,n){this.clicked=!1;this.primitiveId=e,this.position=r,this.cmdKey=i,this.index=n}setClicked(e){return this.clicked=e,e&&Hi.renderer.attr(this.dom.id,"fill","var(--selectColor)"),this}getDistance(e){return new ne(this.position[0],this.position[1]).distance1(e)}getPrimitiveId(){return this.primitiveId}getX(){return this.position[0]}getY(){return this.position[1]}getIndex(){return this.index}getCmdkey(){return this.cmdKey}mount(){if(this.dom)return;let e=Hr("rect",{id:"label-point-"+this.primitiveId+"-"+this.index,x:-.5,y:-.5,width:1,height:1,c_partid:"cdot","strok-width":1,stroke:"var(--selectColor)",fill:"transparent","vector-effect":"non-scaling-stroke"});return X.svgRoot.appendChild(e),this.dom=e,this.zoom(),e}zoom(){let e=4/X.gZoom*2,r=Ue.scale(e,e).translate(this.position[0],this.position[1]),i=nr.getMatrix6FromMatrix(r);xr.updateTransform(i,this.dom)}unmount(){this.clicked||this.dom&&(this.dom.remove(),this.dom=null)}};var jS=class{constructor(){this.data=[];this.primitiveBBox=[]}loadPointsOfRect(e){let r=vn.getDotsForAdsorp(e),i=[],n=r.pop();i.push(new bu(e.gId,[n.x,n.y],"rect",-1));for(let s=0;s<4;s++)i.push(new bu(e.gId,[r[s].x,r[s].y],"rect",s));return i}loadPointsOfEllipse(e){let r=tn.getDotsForAdsorp(e.gId),i=[],n=r.pop();i.push(new bu(e.gId,[n.x,n.y],"ellipse",-1));let s=r.length;for(let a=4;a<s;a++)i.push(new bu(e.gId,[r[a].x,r[a].y],"ellipse",a));return i}loadPointsOfArc(e){let r=[],i=ls.get8Dots2(e),{x:n,y:s,width:a,height:o}=un(e);r.push(new bu(e.gId,[n+a/2,s+o/2],"arc",-1));let l=i.length/2;for(let c=0;c<l;c+=2)r.push(new bu(e.gId,[i[c],i[c+1]],"arc",c/2));return r}loadPointsOfText(e){let r=[],{x:i,y:n,width:s,height:a}=Ab(e);r.push(new bu(e.gId,[i+s/2,n+a/2],"text",-1));let o=Ts.text.get(e),l=o.length/2;for(let c=0;c<l;c+=2)r.push(new bu(e.gId,[o[c],o[c+1]],"text",c/2));return r}loadPointsOfImage(e){let r=[],i=Ts.image.get(e),n=new pr,s=i.length/2;for(let o=0;o<s;o+=2){let l=i[o],c=i[o+1];r.push(new bu(e.gId,[l,c],"obj",o/2)),n.ext6(l,c)}let a=n.build();return r.push(new bu(e.gId,[a.minX+a.width()/2,a.minY+a.height()/2],"obj",-1)),r}loadPointsOfGroup(e){let r=[],i=To.getGroup8Dots(e),n=i.length/2,s=new pr;for(let o=0;o<n;o+=2){let l=i[o],c=i[o+1];r.push(new bu(e.gId,[l,c],"group",o/2)),s.ext6(l,c)}let a=s.build();return r.push(new bu(e.gId,[a.minX+a.width()/2,a.minY+a.height()/2],"group",-1)),r}loadPointsByData(e){let r;switch(e.cmdKey){case"rect":{r=this.loadPointsOfRect(e);break}case"ellipse":{r=this.loadPointsOfEllipse(e);break}case"arc":{r=this.loadPointsOfArc(e);break}case"text":{r=this.loadPointsOfText(e);break}case"obj":{r=this.loadPointsOfImage(e);break}case"group":{r=this.loadPointsOfGroup(e);break}case"combination":break;case"dimension":break;case"_runtime":break;default:Zn(e);break}return r}load(){this.data.length=0,this.primitiveBBox.length=0,te.iterator(e=>{if(Fo(e.cmdKey))return;let r=this.loadPointsByData(e);if(!r)return;let i=new pr;for(let n of r)i.ext6(n.getX(),n.getY());i.ext7(this.getToleranceDistance()),this.primitiveBBox.push({eleId:r[0].getPrimitiveId(),bbox:i.build()}),this.data.push(...r)})}zoom(){for(let e of this.data)e.zoom()}getTopLabelPoints(e){let r=[],i=te.getItemOrderSortMap(),n=-1/0,s="";for(let a of e){let o=a.getPrimitiveId(),l=i.get(o);te.getById(o).json.layer===3&&(l=-(i.size-l)),l>n&&(n=l,s=o)}for(let a of e)a.getPrimitiveId()===s&&r.push(a);return r}findNearbyPrimitiveLabelPoint(e,r){let n=new pr().ext6(e,r).ext7(this.getToleranceDistance()).build(),s=[{x:e,y:r},n.LL(),n.LR(),n.UL(),n.UR()],a=new Set;for(let{bbox:l,eleId:c}of this.primitiveBBox){if(!l.isContains1(e,r))continue;let{json:u,cmdKey:d}=te.getById(c),A=co.get(u);d==="arc"&&(A=A.bbox),A=A.slice(0,8);let h=[];for(let f=0;f<8;f+=2)h.push({x:A[f],y:A[f+1]});for(let f of s)if(tm(f,h)){a.add(c);break}}let o=[];for(let l of this.data)l.unmount(),a.has(l.getPrimitiveId())&&o.push(l);return o}findNearestLabelPoint(e,r){let i=null,n=1/0,s=this.getToleranceDistance(),a=r.length?r:this.data;for(let o of a){let l=o.getDistance(e);l<n&&l<s&&(n=l,i=o)}return i}getToleranceDistance(){return 4/X.gZoom*2}},KA=new jS;var fE=class{constructor(e){this.map=new Map;this.lastMap=new Map;this.oldLabelPoints=e}transform(e){let r=[];for(let i of this.oldLabelPoints){let n=i.getPrimitiveId(),s=i.getCmdkey(),a=i.getIndex(),o=new ne(i.getX(),i.getY()).multiply3(e);r.push(new bu(n,[o.x,o.y],s,a))}return this.newLabelPoints=r,this.createMap(),this}getTransformedNode(){let e=new Set,r=new Set,i=[-1,0,1,2,3,4,5,6,7];for(let n of i){let{dx:s,dy:a,primitiveId:o}=this.getOffsetByIndex(n);if(Ir(s)&&Ir(a))continue;let l={dx:s,dy:a,id:o,index:n};(s||a)&&e.add(l),s===0&&a===0&&r.add(l)}return{moveNode:e,stillNode:r}}createMap(){let e=this.oldLabelPoints.length;for(let r=0;r<e;r++){let i=this.oldLabelPoints[r],n=this.newLabelPoints[r],s=n.getX()-i.getX(),a=n.getY()-i.getY();_i(s,0)&&(s=0),_i(a,0)&&(a=0),this.map.set(i.getIndex(),{dx:s,dy:a,primitiveId:i.getPrimitiveId()})}}getOffsetByIndex(e){let r=this.map.get(e);if(!r)return{};let i=this.lastMap.get(e);return i||(i={dx:0,dy:0}),this.lastMap.set(e,r),{dx:r.dx-i.dx,dy:r.dy-i.dy,primitiveId:r.primitiveId}}};var QS=class{calcuPerpendicular(e,r,i){let n=new ne(e.x,e.y),s=new ne(r.x,r.y).angle(n),a=new ne(r.x,r.y).rotate(n,-s),o=new ne(i.x,i.y).rotate(n,-s),l=new ne(e.x,o.y).rotate(n,s),c=new ne(a.x,o.y).rotate(n,s);return{start:{x:l.x,y:l.y},end:{x:c.x,y:c.y}}}findDimensionByPrimitiveIds(e){let r=new Set;return te.iteratorDimension(i=>{(e.has(i.start.id)||e.has(i.end.id))&&r.add(i)}),Array.from(r)}excludeDimension(e){return te.iteratorDimension(r=>{e.has(r.gId)&&e.delete(r.gId)}),e}changeSelfDimensionSize(e,r){let i=te.getDimension(e),n=new Ua(i),{offset:{dx:s,dy:a},moveElementId:o,staticElementId:l}=n.updateDistance(r),c=i.start.id,u=n.getDistance(!0),d=r/u,A=d,h=d,f=i.start.primitivePoint,p=i.end.primitivePoint;p.x<f.x&&([f,p]=[p,f]),n.direction==="y"&&f.y<p.y&&([f,p]=[p,f]),n.direction==="x"&&(h=1),n.direction==="y"&&(A=1);let m=KA.loadPointsByData(te.getById(c).json),y=new fE(m),g=Ue.scale(A,h).setOrigin1(new ne(f.x,f.y));y.transform(g);let{moveNode:b,stillNode:E}=y.getTransformedNode(),w=new Ad;w.setNodeVisited(new Set),w.setIgnoreDimension(new Set([e]));let x=w.findDimensionNode(b);if(x===!1)return!1;let I=$i.setSkipCheck(!0);for(let C of x){let{dx:G,dy:U,xNode:_,yNode:H}=C,{canMoveX:Q,canMoveY:j}=w.getAllAffectedPrimitivesId(_,H);w.prepareHistory(_,H),_=w.removeXNode(E,_),H=w.removeYNode(E,H),Q=w.removeXPrimitive(new Set([c]),Q),j=w.removeYPrimitive(new Set([c]),j),w.movePrimitive(G,U,Q,j).moveDimension(G,U,_,H)}lL.scale(c,A,h,new ne(f.x,f.y)),I()}changeDimensionSize(e,r){let i=te.getDimension(e);if(i.category!=="Constraint")throw new Error("err");let n=new Ua(i),{offset:{dx:s,dy:a},moveElementId:o,staticElementId:l}=n.updateDistance(r),c=new gr,u=c.searchCombination(i.start.id),d=c.searchCombination(i.end.id),A=!(u&&d&&u===d),h=this.getSideLockedElements(e,o,A),f=this.getSideLockedElements(e,l,A);if(h.length&&f.length){this.toastBothLockMsg(h[0],f[0]);return}if(i.start.id===i.end.id){this.changeSelfDimensionSize(e,r);return}h.length&&(o=l,s*=-1,a*=-1);let p=i.end.id===o?i.start.id:i.end.id,m=new Ad;m.setIgnoreDimension(new Set([e])),m.findDimensionNodeByPrimitiveId(new Set([o]));let{all:y,canMoveX:g,canMoveY:b}=m.getAllAffectedPrimitivesId();y.add(e);let E=i.direction,w=new gr,x=w.searchCombination(p),I=w.searchCombination(o);if(x&&I&&x==I&&(g=m.getMoveIdsInCom(p,o,x).canMoveX,b=m.getMoveIdsInCom(p,o,x).canMoveY),E==="y"&&b.has(p)){this.toastMsg();return}if(E==="x"&&g.has(p)){this.toastMsg();return}if(E==="xy"&&y.has(p)){this.toastMsg();return}let C=$i.setSkipCheck(!0);m.prepareHistory().movePrimitive(s,a).moveDimension(s,a),C()}toastMsg(){X.windowBridge.publish("ui/toastMsg",{type:"warn",msg:"This change will lead to over definition or no solution, modification failed.",timer:3},ur())}updateCategory(e,r){ge(Fe(e),"category",r)}getSideLockedElements(e,r,i=!0){let n=new Set([e]),s=new Ad;s.setIgnoreDimension(n).findDimensionNodeByPrimitiveId(new Set([r]));let{all:a}=s.getAllAffectedPrimitivesId(void 0,void 0,i),o=th(),l=new Map;for(let{elements:u,combinationId:d}of o)for(let A of u)if(d&&i){let h=te.getCombination(d).locked;l.set(A,{combinationId:d,id:A,cmdkey:"combination",locked:h})}else{let{cmdKey:h,json:f}=te.getById(A);l.set(A,{id:A,cmdkey:h,locked:f.locked})}let c=[];for(let u of a){let d=l.get(u);d.locked&&c.push(d)}return c}dimensionBothSideIsLocked(e){let r=this.dimensionInOneCombination(e),i=this.getSideLockedElements(e.gId,e.start.id,!r),n=this.getSideLockedElements(e.gId,e.end.id,!r);return{left:i,right:n}}dimensionInOneCombination(e){let r=te.getCombination(),{start:i,end:n}=e;return!!Object.values(r).find(({elements:s=[]})=>s.includes(i.id)&&s.includes(n.id))}toastBothLockMsg(e,r){let{json:i}=te.getById(e.id);if(e.cmdkey==="combination"&&r.cmdkey==="combination"&&e.id===r.id){il({value:"{0} {a} are currently locked.Please unlock first.",options:{a:i.name,0:Fn[e.cmdkey]},translateOptionKeys:[0]},"warn");return}if(e.id===r.id&&e.cmdkey!=="combination"){let s=i.name;s&&(s=":"+s),il({value:"{0} {a} are currently locked.Please unlock first.",options:{a:i.id.slice(1)+s,0:Fn[e.cmdkey]},translateOptionKeys:[0]},"warn");return}let n=te.getById(r.id).json;il({value:"Both {0} {a} and {1} {b} are currently locked.Please unlock them first.",options:{a:e.cmdkey==="combination"?i.name:i.id.slice(1),b:r.cmdkey==="combination"?n.name:n.id.slice(1),0:Fn[e.cmdkey],1:Fn[r.cmdkey]},translateOptionKeys:[0,1]},"warn")}isInSameCombination(e){let i=new cL().getPrimitiveMapComb(),n=i.get(e.start.id).combinationId,s=i.get(e.end.id).combinationId;return!!(n&&s&&n===s)}dblclickHandler(e){if(e.category==="Annotation")return;let r=this.dimensionBothSideIsLocked(e),i=new gr,n=i.searchCombination(e.start.id),s=i.searchCombination(e.end.id);if(r.left.length&&r.right.length)if(n&&s&&n===s){let{cmdKey:c,json:u}=te.getById(e.start.id),{cmdKey:d,json:A}=te.getById(e.end.id);if(u.locked&&A.locked){this.toastBothLockMsg({id:e.start.id,cmdkey:c,locked:!0},{id:e.end.id,cmdkey:d,locked:!0});return}}else{this.toastBothLockMsg(r.left[0],r.right[0]);return}let a=$u();if(a["all-element-type"].dimension.checked===!1||a["all-element-type"].dimension.visible===!1)return;let o=new Ua(e),l={name:"",object:{startId:e.start.id,endId:e.end.id},type:o.getCategory(),size:Sr(o.getDistance(),2),overed:!1,hide:["name","obj","category"],id:e.gId,created:!1};te.compilerManager.pauseDateMerge(),Et("panel/open-smart-dimension-dialog",[l])}updateDimensionData(e,r){$t(r,"attr-dimension")&&this.changeDimensionSize(e,r["attr-dimension"]);let i=te.getDimension(e);if($t(r,"attr-dimension-category")){let n=r["attr-dimension-category"];i.category=n,this.updateCategory(e,n)}$t(r,"attr-name")&&(i.name=r["attr-name"])}},el=new QS;var uL=class{constructor(e){this.objs=e;this.deleted=!1}do(e=!1){let r=Zo.anchorOrHandleHasSelected();if(r&&r.type!=="bbox"){let u=Fe(r.id);lE.deletePathNode(u,r),eA();return}let i=this.objs,n=el.findDimensionByPrimitiveIds(new Set(i.map(u=>u.id))).map(u=>Fe(u.gId));if(i.push(...n),!i.length)return;let s=i.map(u=>u.id),{combinations:a,elements:o}=new gr().getSelectedCombinations(s);if(Rs.hasCombinationLocked(a)||Rs.hasEleLocked(o)){JA();return}let l=new qi(i),c=[];for(let u=0;u<i.length;u++){let d=i[u];c.push(te.getById(d.id).json),d&&te.removeOne(d)}for(let u of a)c.push(te.getById(u).json),te.deleteCombInParent(u),this.deleteCombinationAndChild(u);return e?(l.update(),te.freshItemOrder()):l.updateAndSave(),this.deleted=!0,c}isDeletedSuccess(){return this.deleted}deleteCombinationAndChild(e){let{combinations:r}=te.getCombination(e);te.setCombination(e);for(let i of r)this.deleteCombinationAndChild(i)}},zS=class extends uL{};zS=Uu([gu(Ya.delete)],zS);function fd(t,e=!1){t=t||Gs();let r=t.map(u=>u.id),i=new gr,{combinations:n}=i.getSelectedCombinations(r),s=[],a=new Set(r);for(let u of n){let{elements:d,name:A,id:h}=te.getCombination(u);s.push(h+(A?":"+A:""));for(let f of d)a.add(f)}let o=Array.from(a).map(u=>Fe(u)),l=e?new uL(o):new zS(o),c=l.do(e);return l.isDeletedSuccess()&&i.deleteCombinationToast(s),c}var DSe=Vd(()=>{new rs().updateHole()}),hL=null,rs=class{constructor(){this.container=Fe("combination-container")}setMask(e){hL=e}getMask(){return hL}removeMask(){Cr(hL),hL=null,this.removeUseEle()}removeUseEle(){for(;this.container.firstChild;)Cr(this.container.firstChild)}zoom(){this.getMask()&&this.updateHole()}hoistPrimitives(e){for(let r of te.getItemOrder())if(e.includes(r)){let i="use-"+r;if(!Hs("#"+i,this.container)){let s=Hr("use",{href:"#"+r,id:i});this.container.appendChild(s)}}}updateHole(e=!1){let r=pi.isEditingPath();if(r)return this.updateHoleForPath(r);if(!Li.isEditing())return;let i=this.getMask()||this.createMask();this.setMask(i),e&&this.removeUseEle();let n=Li.getCurrentEditingComId(),s=new gr,a=Array.from(s.getAllElesfromTop(n).elements),o=te.getAllAssistPrimitive();this.hoistPrimitives([...a,...o]);let l=a.map(u=>Fe(u)),c={x:0,y:0,width:0,height:0};l.length&&(c=la(l)),this.innerUpdateHole(c,i)}updateHoleForPath(e){let{json:r,cmdKey:i}=te.getById(e);if(Kr(r))return pi.endEditingPath();let{x:n,y:s,width:a,height:o}=un(r,i);i==="arc"&&({x:n,y:s,width:a,height:o}=new ny(r).bboxEllipse());let l=new pr().ext5(n,n+a,s,s+o).ext7(Th()).build(),c=this.getMask()||this.createMask();this.setMask(c);let u=ep(l);this.innerUpdateHole(u,c),Bn.createHalfArc(e);let d=te.getAllAssistPrimitive();this.hoistPrimitives(d)}innerUpdateHole(e,r){let{x:i,y:n,width:s,height:a}=El(X.svgRoot),o=[i,n,i+s,n,i+s,n+a,i,n+a],{x:l,y:c,width:u,height:d}=e,A=[{x:l,y:c},{x:l+u,y:c},{x:l+u,y:c+d},{x:l,y:c+d}],h=["M",i,n,"L"].join(" ")+o.join(" ")+["M",l,c,"L"].join(" ")+A.reverse().map(f=>[f.x,f.y]).flat().join(" ");ge(r,"d",h)}createMask(){let e=Hr("path",{id:"panel-mask",d:"",fill:"black",opacity:.2});return X.svgRoot.insertBefore(e,this.container),e}};rs.updateHole=DSe;var dL=null,xk=class{constructor(){}getSelectDependMaskMode(e){if(!pi.isEleCanSelect(e))return Fo(te.getById(e).cmdKey)?[{id:e}]:[];let r=new gr,i=r.searchCombination(e);if(this.isEditing()){if(!i)return Fo(te.getById(e).cmdKey)?[{id:e}]:[];let s=this.getCurrentEditingComId();if(s===i)return[Fe(e)];if(!r.findFamily(i).getAllParents().includes(s))return[];let a=r.findFamily(i,s).peekParent();return[...r.getAllElesfromTop(a).elements].map(l=>Fe(l))}if(i){let s=r.findFamily(i).peekParent();if(!this.isCombCanSelect(s))return[]}return[...r.findAllEleByOneEle(e)].map(s=>Fe(s))}findCombinationElementsById(e){let r=new gr,i=r.searchCombination(e);if(!i)return[];let n=this.getCurrentEditingComId();if(i===n)return[];if(n&&!r.findFamily(i).getAllParents().includes(n))return[];let s=r.findFamily(i,n).peekParent();return this.isCombCanSelect(s)?r.getAllElesfromTop(s).elements:y_}isCombCanSelect(e){let r=te.getCombination(e);return!(!$u()["all-state"].lock.checked&&r.locked)}isEditing(){return!!dL}setEditing(e){return e?(dL=e,new rs().updateHole()):(dL=null,new rs().removeMask()),this}deleteCombinations(e){let r=this.selectCombinations(e);if(r.length===0){let i=new qi;for(let n of e)te.deleteCombInParent(n),i.addOneCombineByComId(n),te.setCombination(n);i.updateAndSave();return}fd(r)}selectCombinations(e){let r=new Set,i=new gr;for(let s of e){let a=i.getAllElesfromTop(s).elements;for(let o of a)r.add(o)}let n=Array.from(r).map(s=>Fe(s));return pt.select(n),Ja(n,{create8Dots:!0}),n}getCurrentEditingComId(){return dL}isEleCanSelect(e){if(!this.isEditing())return!0;let r=this.getCurrentEditingComId();return new gr().getAllElesfromTop(r).elements.has(e)}},Li=new xk;var Ek=class{constructor(){this.currentRecords=new Map;this.currentEditingPath=null;this.insertAnchorIndex=-1;this.insertAnchorId="insert-anchor"}toggleMode(e){let r=this.currentRecords.get(e);this.currentRecords.set(e,r==="self"?"box":"self"),this.currentRecords.get(e)==="box"&&Zo.hideAll()}startEditPath(e){this.toggleMode(e),this.currentRecords.get(e)==="box"?this.endEditingPath():(this.setCurrentEditingPath(e),Bn.createHalfArc(e))}setCurrentEditingPath(e){this.currentEditingPath=e,new rs().updateHoleForPath(e)}isEleCanSelect(e){let r=this.isEditingPath();return r?r===e:!0}isEditingPath(){return this.currentEditingPath}endEditingPath(){if(this.currentEditingPath&&this.currentRecords.set(this.currentEditingPath,"box"),Bn.removeHalfArc(this.currentEditingPath),this.currentEditingPath=null,new rs().removeMask(),Li.isEditing()){let e=Li.getCurrentEditingComId();Li.setEditing(e)}}isAnchorMode(e){return this.currentRecords.get(e)==="self"}is8DotsMode(e){let r=this.currentRecords.get(e);return r==="box"||!r}addOrRemoveHandle(e){let r=Gs()[0],i=this.getAnchorInfo(r),n=i.length,{json:s}=te.getById(r.id),a=vi(s),o=vo(r),l=!1;for(let c=1;c<n;c++){let u=i[c-1],d=i[c];if(e===u.index){if(u.type==="M")switch(d.type){case"C":{d.d="C "+u.x+" "+u.y+" "+d.x2+" "+d.y2+" "+d.x+" "+d.y;let A=this.getPathD(i);ge(r,"d",A),s.d=A,l=!0;break}default:console.error(d.type);break}else if(u.type==="C")switch(d.type){case"C":u.d="C "+u.x1+" "+u.y1+" "+u.x+" "+u.y+" "+u.x+" "+u.y,d.d="C "+u.x+" "+u.y+" "+d.x2+" "+d.y2+" "+d.x+" "+d.y;let A=this.getPathD(i);ge(r,"d",A),s.d=A,l=!0;break;default:console.error(u);break}else console.error(u.type);if(l){let A=Da(r.id,{cmdKey:"group",refId:o},a,s);Ac(r),mr.save(A);break}}}ms.removeHighlightStroke().emptyLastHoverEle().emptySelectContainer()}getPathSegment(e){function r(n){for(let s of n)if(Number.isNaN(s)||Ir(s)){console.error(s);debugger}return n}let i=[];switch(e.type){case"M":i.push("M",e.x,e.y);break;case"L":i.push("L",e.x,e.y);break;case"C":i.push("C",e.x1,e.y1,e.x2,e.y2,e.x,e.y);break;default:console.error(e);break}return r(i).join(" ")}getPathD(e,r,i){let n="";for(let s=0;s<e.length;s++){let a=e[s];n=n+" "+a.d,this.getPathSegment(a),s===r&&(n=n+" "+i.d)}return n}getPoints(e){let r=[];for(let i of e)switch(i.type){case"M":case"L":r.push(i.x,i.y);break;case"C":r.push(i.x1,i.y1,i.x2,i.y2,i.x,i.y);break;default:console.error(i);break}return r}removeMiddleAnchor(){return Cr(this.hoverCreatedAnchorEle),this.insertAnchorIndex=-1,this}updateD(){let e=this.lastHoverGroup;return ge(e,"d",this.hoveredD),Ac(e),this.insertAnchorIndex}createHoverAnchor(e,r,i){if(!e){this.insertAnchorIndex>-1&&this.removeMiddleAnchor();return}if(this.is8DotsMode(e.id)||te.getById(e.id).cmdKey!=="group")return;this.lastHoverGroup=e;let{start:n,end:s,anchorInfo:a}=this.findWhichSegment(e,r,i),o=a[n],l=a[s],c=l.type;switch(c){case"L":{if(o.index+1===this.insertAnchorIndex)return;this.removeMiddleAnchor();let u=(o.x+l.x)/2,d=(o.y+l.y)/2,A=Zo.createHoverAnchor(u,d,this.insertAnchorId);this.hoverCreatedAnchorEle=A;let h=this.getPathD(a,n,{x:u,y:d,type:"",d:`L ${u} ${d} `,index:-1});this.hoveredD=h,this.insertAnchorIndex=o.index+1;break}case"C":{if(o.index+3===this.insertAnchorIndex)return;this.removeMiddleAnchor();let u="M "+o.x+" "+o.y+" "+l.d,h=Jn(u)[0].primitives[0].clip(.5),f=h[0].controls,p=h[1].controls,m=Zo.createHoverAnchor(f[3].x,-f[3].y,this.insertAnchorId);this.hoverCreatedAnchorEle=m,this.insertAnchorIndex=o.index+3,l.d="C "+f[1].x+" "+-f[1].y+" "+f[2].x+" "+-f[2].y+" "+f[3].x+" "+-f[3].y,l.d+=" "+p[1].x+" "+-p[1].y+" "+p[2].x+" "+-p[2].y+" "+p[3].x+" "+-p[3].y;let y=this.getPathD(a);this.hoveredD=y;break}case"Q":{if(o.index+2===this.insertAnchorIndex)return;this.removeMiddleAnchor();let d=new Nt([new ne(o.x,o.y),new ne(l.x1,l.y1),new ne(l.x,l.y)]).clip(.5),A=d[0].controls,h=d[1].controls,f=Zo.createHoverAnchor(A[2].x,A[2].y,this.insertAnchorId);this.hoverCreatedAnchorEle=f,this.insertAnchorIndex=o.index+2,l.d=" Q  "+A[1].x+" "+A[1].y+" "+A[2].x+" "+A[2].y,l.d+=" Q "+h[1].x+" "+h[1].y+" "+h[2].x+" "+h[2].y;let p=this.getPathD(a);this.hoveredD=p;break}default:console.error(c,"check code");break}}findWhichSegment(e,r,i){let n=this.getAnchorInfo(e),s=n.length,a=Number.MAX_SAFE_INTEGER,o=1;for(let l=1;l<s;l++){let c=n[l-1],u=n[l],d;switch(u.type){case"L":d=Pc({x:r,y:i},c,u).d;break;case"M":break;case"C":case"Q":{let A="M "+c.x+" "+c.y+" "+u.d,f=Jn(A)[0].primitives[0],p=[];f.getBezierPoints(1,function(m){p.push(m)}),d=a;for(let m of p){let y=sd(r,i,m.x,-m.y);d=Math.min(d,y)}}break;default:console.error("plz check "+u.type);break}d<a&&(a=d,o=l)}return{start:o-1,end:o,anchorInfo:n}}clickShowSegmentHandle(e,r,i){if(!e||this.is8DotsMode(e.id)||te.getById(e.id).cmdKey!=="group")return;let{start:n,end:s,anchorInfo:a}=this.findWhichSegment(e,r,i),o=[a[n].index,a[s].index];Zo.showHandleOfIndexes(o)}getMirrorPoint(e,r){let i=r.x-e.x,n=r.y-e.y;return{x:e.x-i,y:e.y-n}}handleFollowHandle(e,r,i){let n=r.newP.distance1(e)/r.oldP.distance1(e),s=r.newP.angleD(e)-r.oldP.angleD(e),a=i.angleD(e),o=Ue.translate(-e.x,-e.y).rotateD(-a);return i.multiply3(o).multiply3(Ue.scale(n,1).rotateD(s+a).translate1(e))}getAnchorInfo(e){let r=e.pathSegList,i=r.numberOfItems,n=0,s=0,a=0,o=0,l=[],c,u,d=new Map,A=[],h=[],f=0;for(let p=0;p<i;p++){let m=r.getItem(p),y=m.pathSegType;p===0&&y!=Ds&&y!=ia&&y!=Ri&&(console.warn(m,y),A.push({x:n,y:s,index:f,type:""}));let g=A.length-1;switch(y){case Ri:n=a,s=o;break;case Ds:{if(n=m.x,s=m.y,a=n,o=s,p+1==i||(u=r.getItem(p+1),c=u.pathSegType,c==Ds||c==ia||c==Ri))break;let E=`M ${n} ${s} `;A.push({x:n,y:s,index:f++,type:"M",d:E});break}case ia:if(n+=m.x,s+=m.y,a=n,o=s,p+1==i||(c=r.getItem(p+1).pathSegType,c==Ds||c==ia||c==Ri))break;h.push(n,s);break;case ka:{if(A.push({x:m.x,y:m.y,index:f++,type:"L",d:` L ${m.x} ${m.y} `}),p+1==i)break;u=r.getItem(p+1),c=u.pathSegType,c==Ri&&(u=r.getItem(0)),c==ka||c==Ri;break}case rd:A.push({x:m.x,y:s,index:++f,type:""});break;case id:A.push({x:n,y:m.y,index:++f,type:""});break;case $h:l.push({from:g,to:g+1,belong:g},{from:g+2,to:g+3,belong:g+3}),d.set(g+1,{belong:g}),d.set(g+2,{belong:g+3}),++f,++f;let b=" C "+[m.x1,m.y1,m.x2,m.y2,m.x,m.y].join(" ");A.push({x:m.x,y:m.y,x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,index:f++,type:"C",d:b});break;case Zh:l.push({from:g+1,to:g+2}),h.push(m.x2,m.y2,n=m.x,s=m.y);break;case ed:{l.push({from:g,to:g+1,belong:g},{from:g+1,to:g+2,belong:g+2}),d.set(g+1,{belong:[g,g+2]}),h.push(m.x1,m.y1,n=m.x,s=m.y),++f;let E=" Q "+m.x1+" "+m.y1+" "+m.x+" "+m.y+" ";A.push({x:m.x,y:m.y,x1:m.x1,y1:m.y1,index:f++,type:"Q",d:E});break}case td:case ju:if(h.push(n=m.x,s=m.y),p+1==i)break;u=r.getItem(p+1),c=u.pathSegType,c==Ri&&(u=r.getItem(0)),c==ka||c==Ri;break;case kA:h.push(n+=m.x,s+=m.y);break;case MA:h.push(n+=m.x,s);break;case FA:h.push(n,s+=m.y);break;case LA:l.push({from:g,to:g+1},{from:g+2,to:g+3}),h.push(n+m.x1,s+m.y1,n+m.x2,s+m.y2,n+=m.x,s+=m.y);break;case OA:l.push({from:g+1,to:g+2}),h.push(n+m.x2,s+m.y2,n+=m.x,s+=m.y);break;case NA:l.push({from:g+1,to:g+2}),h.push(n+m.x1,s+m.y1,n+=m.x,s+=m.y);break;case RA:case PA:h.push(n+=m.x,s+=m.y);break;default:break}}return A}},pi=new Ek;var gr=class{constructor(){}modifyCombination(e){let r=new qi;for(let i of e){let n=i.combId;r.addOneCombineByComId(n);let s=te.getCombination(n);zu(i.parent)||(s.parent=i.parent);let a=new Set([...s.elements,...i.add||[]]);for(let l of i.remove||[])a.delete(l);s.elements=Array.from(a);let o=new Set([...s.combinations,...i.addComb||[]]);for(let l of i.removeComb||[])o.delete(l);s.combinations=Array.from(o);for(let l of s.combinations)r.addOneCombineByComId(l),te.getCombination(l).parent=n}r.updateAndSave()}removeFromGroup(e){let r="",i="";Array.isArray(e)||(e=pt.getIds());let n=new qi;for(let s of e){let a=this.searchCombination(s);if(!a)continue;n.addOneCombineByComId(a);let o=te.getCombination(a);i=o.id||o.gId,r=o.name;let l=o.elements.indexOf(s);o.elements.splice(l,1),pt.unselect(Fe(s))}n.updateAndSave(),Ci(),new rs().updateHole(),ba("updateAttrPanel"),il({value:"{0} element removed from the group:group{idWithName}",options:{0:e.length,idWithName:i.replace("e","")+(r?`:${r}`:"")}},"success")}getSelectedCombinations(e){let r=th(),i=new Map;for(let a of r)if(a.combinationId)for(let o of a.elements)i.set(o,a.combinationId);let n=new Set,s=new Set;for(let a of e)i.has(a)?s.add(i.get(a)):n.add(a);return{combinations:s,elements:n}}getSelectedCombinations2(e){let r=th(),i=new Map;for(let a of r)if(a.combinationId)for(let o of a.elements)i.set(o,a.combinationId);let n=new Set,s=new Set;for(let a of e)i.has(a)&&s.add(i.get(a)),n.add(a);return{combinations:s,elements:n}}combineWhenEditComb(e){let{combinations:r,elements:i}=this.getSelectedCombinations(e),n=ni(),s=Li.getCurrentEditingComId(),a=te.getInitialCombinationData({gId:n,elements:Array.from(i),combinations:Array.from(r),parent:s}),o=new qi;o.addOneCombineByComId(n,{}),o.addOneCombineByComId(s),te.setCombination(n,a);let l=te.getCombination(s);for(let c of i)l.elements.splice(l.elements.indexOf(c),1);for(let c of r){let u=te.getCombination(c);u.parent=n,l.combinations.splice(l.combinations.indexOf(c),1)}l.combinations.push(n);for(let c of i)o.addOneCombine(c);o.updateAndSave(),this.afterCombine(i.size+r.size)}combine(){let e=xu(Gs()).map(o=>o.id);if(!e.length)return;if(Li.isEditing())return this.combineWhenEditComb(e);let r=new Set,i=new Set;for(let o of e){let l=this.searchCombination(o);if(!l)r.add(o);else{let c=this.findFamily(l).peekParent();i.add(c)}}let n=ni(),s=te.getInitialCombinationData({gId:n,elements:Array.from(r),combinations:Array.from(i)});te.setCombination(n,s);let a=new qi;a.addOneCombineByComId(n,{});for(let o of i){a.addOneCombineByComId(o);let l=te.getCombination(o);l.parent=n}a.updateAndSave(),this.afterCombine(r.size+i.size)}afterCombine(e){e!==0&&(il({value:"{0} objects grouped successfully",options:{0:e}},"success"),Et("panel_updateAttrPanel"))}deleteCombinationToast(e){e.length!==0&&il({value:"Group {0} deleted grouped successfully",options:{0:e.join("\u3001")}},"success")}deleteEmptyCombination(e){let r=new qi;for(let i of e)r.addOneCombineByComId(i),te.setCombination(i);r.updateAndSave()}unCombine(){let e=new Set,r=pt.getIds(),i=new qi,n=new Set,s=[];for(let o of r){let l=this.searchCombination(o);if(l){let c=Li.getCurrentEditingComId(),u=this.findFamily(l,c).peekParent();if(u===c)continue;n.add(u),i.addOneCombineByComId(u)}}if(n.size===0)return;for(let o of n){let l=te.getCombination(o);e.add(o);let c=this.findParent(o);c&&(c.combinations.splice(c.combinations.indexOf(o),1),c.elements.push(...l.elements),c.combinations.push(...l.combinations));for(let d of l.combinations)te.getCombination(d).parent=c?c.id:null;let u=te.getCombination();delete u[o],s.push("Combination"+l.id.replace("e","")+(l.name?`:${l.name}`:""))}i.updateAndSave();let a=Array.from(e);il({value:"{num} Ungrouped successfully:{groupIdWithNames}",options:{num:a.length,groupIdWithNames:s},translateOptionKeys:["groupIdWithNames"],translateIndexOfArray:"all"},"success"),Et("panel_updateAttrPanel"),rs.updateHole()}unCombineAllEmpty(){let e=this.getAllEmptyCombinations();this.deleteEmptyCombination(e),il({value:"Successfully cancel all empty group"},"success")}unCombineAll(){let e=!1,r=new qi;te.iteratorCombination(i=>{e=!0,r.addOneCombineByComId(i.gId),te.setCombination(i.gId)}),e&&(r.updateAndSave(),il({value:"Successfully cancel all group"},"success"),Li.setEditing(null),pi.endEditingPath())}joinGroup(e){let r=te.getCombination(e).name,i=pt.getIds();i=xu(i.map(l=>Fe(l))).map(l=>l.id);let{elements:n,combinations:s}=this.getSelectedCombinations(i),a=[],o=te.getCombination(e).id||e;for(let l of n){let c=this.searchCombination(l);c!==e&&(c&&a.push({combId:c,remove:[l]}),a.push({combId:e,add:[l]}))}for(let l of s){let c=te.getCombination(l);e!==c.parent&&e!==l&&(this.findFamily(e).getAllParents().includes(l)||(c.parent&&a.push({combId:c.parent,removeComb:[l]}),a.push({combId:l,parent:e},{combId:e,addComb:[l]})))}a.length!==0&&(this.modifyCombination(a),il({value:"{0} objects join group successfully:group{idWithName}",options:{0:n.size+s.size,idWithName:o.replace("e","")+(r?`:${r}`:"")}},"success"),Li.isEditing()&&(new rs().updateHole(),Ci()))}peekParent(){return this.parent.at(-1)}findFamily(e,r=null){let i=te.getCombination(e),n=[e];for(;i.parent&&i.parent!==r;)i=te.getCombination(i.parent),n.push(i.gId);return this.parent=n.filter(s=>s),this}getAllParents(){return this.parent}findParent(e){let r=te.getCombination(e);return r.parent?te.getCombination(r.parent):null}searchCombination(e){let r;return te.iteratorCombination(i=>{if(i.elements.includes(e))return r=i.gId,_c}),r}findAllEleByOneEle(e){let r=new Set([e]),i=this.searchCombination(e);if(!i)return r;let n=this.findFamily(i).peekParent(),s=this.getAllElesfromTop(n).elements;for(let a of s)r.add(a);return r}getAllElesfromTop(e){let r=new Set,i=new Set,n=te.getCombination(e);if(Object.keys(n).length===0)throw new Error("Cannot find combinationData!");for(let s of n.elements)r.add(s);for(let s of n.combinations){i.add(s);let{elements:a,combinations:o}=this.getAllElesfromTop(s);for(let l of a)r.add(l);for(let l of o)i.add(l)}return{elements:r,combinations:i}}getAllChildEles(e,r=new Set){let{elements:i,combinations:n}=te.getCombination(e);for(let s of i)r.add(s);if(n.length>0)for(let s of n)this.getAllChildEles(s,r);return r}pasteCombination(e,r,i,n=[]){for(let a of r){e.addOneCombineByComId(a.gId,{});let o=[];for(let c of a.combinations)i.has(c)&&o.push(i.get(c));a.combinations=o;let l=[];for(let c of a.elements)i.has(c)&&l.push(i.get(c));a.elements=l,a.parent&&(a.parent=i.get(a.parent)||null),te.setCombination(a.gId,a)}let s=[];for(let a of n){e.addOne(te.getById(a.id).json,{});let o=Li.getCurrentEditingComId();if(o){let l=te.getCombination(o);e.addOneCombineByComId(o);let c=this.searchCombination(a.id);if(c){let u=this.findFamily(c).peekParent();l.combinations=[...new Set(l.combinations).add(u)],s.push([u,o])}else l.elements.push(a.id)}}for(let[a,o]of s)te.getCombination(a).parent=o}getAllCombinationData(e){let r=new Set,i=[];for(let n of e){let s=Li.getCurrentEditingComId(),a=this.findFamily(n,s).getAllParents();for(let o of a){if(r.has(o))continue;r.add(o);let l=te.getCombination(o);i.push(l)}}return i}getAffectedCombinations(e){let r=new Map,i=[],n=new Set;for(let a of e){let o=this.searchCombination(a);if(o){let l=Li.getCurrentEditingComId(),c=this.findFamily(o,l).getAllParents();for(let u of c)n.has(u)||(n.add(u),i.push(te.getCombination(u)))}}let s=[];for(let a of i){let o=structuredClone(a);o.gId=ni(),s.push(o),r.set(a.gId,o.gId)}return{oldIdMapNewId:r,copiedCombination:s}}getAllEmptyCombinations(){let e=[];return te.iteratorCombination(({gId:r})=>{!this.getAllChildEles(r).size&&e.push(r)}),[...e]}};var wk=class{constructor(){}getTree(e=null){let r=[];return te.iteratorCombination(i=>{i.parent===e&&r.push({id:i.gId,displayId:i.id,name:i.name,children:this.getTree(i.gId),elements:i.elements})}),r}};function AL(t=null){return new wk().getTree(t)}function th(){let t=new gr,e=Li.getCurrentEditingComId(),r=AL(e),i=new Set,n=[];for(let a of r){let o=t.getAllElesfromTop(a.id).elements;for(let c of o)i.add(c);let l=te.getCombination(a.id);n.push({elements:Array.from(o),combinationId:a.id,selectable:!l.locked})}let s=te.getItemOrder();for(let a of s)i.has(a)||n.push({elements:[a]});return n}var cL=class{constructor(){this.allCombLevelElements=th()}getAllCombLevelElements(){return this.allCombLevelElements}getPrimitiveMapComb(){let e=new Map;for(let{elements:r,combinationId:i}of this.allCombLevelElements)for(let n of r){let{cmdKey:s}=te.getById(n);e.set(n,{id:n,cmdKey:s,combinationId:i})}return e}};function hm(t){ge((t==null?void 0:t.target)||X.selectBox1,{display:"none"})}function ES(t,e,r,i,n){ge((n==null?void 0:n.target)||X.selectBox1,{display:"",width:Math.abs(r),height:Math.abs(i),x:Math.min(t,t+r),y:Math.min(e,e+i),stroke:X.panelThemeCache.color.select,visible:"visible"})}function vk(t,e=""){let r=Fe("selection-polygon");ge(r,{points:t,class:pt.unselectableClass,display:e,stroke:X.panelThemeCache.color.select})}function Ck(){let t=Kl.selectionMode;if(!["polygonInside","polygonOutside"].includes(t))return;let r=Fe("selection-polygon"),i=Sz(r.points);vk("","none");let n=t==="polygonOutside",s=th();for(let a of s){let o=!1;for(let l of a.elements){let c=sp(Fe(l)),{x:u,y:d,width:A,height:h}=c,f=[{x:u,y:d},{x:u,y:d+h},{x:u+A,y:d},{x:u+A,y:d+h}];if(o=_Se(f,i),o)break}o=n?!o:o;for(let l of a.elements)Kl.selectElement(Fe(l),o,!0)}}function _Se(t,e){let r=0;for(let i of t)gg(i,e)&&r++;return t.length===r}var tA=class tA extends Fc{constructor(){super();this.start=!1}getSymbol(){return Ps.drag_select_area_tool}static canSwitchMe(r){var u;let{canvasX:i,canvasY:n,originalEvent:s}=r,a=zP(s);!((u=X.profileSetting)!=null&&u.commSystemSetting.PANEL_CANVAS.is_ctrl_drag_to_drag)&&r.ctrlKeyDown&&(a=void 0);let l=!a;return ub(i,n)&&(l=!1),this.clickedCanvas=l,l}install(r){console.log(this.getSymbol(),"installed");let i=r.originalEvent;if(Pi(i.target)!=="cdot"&&!um.isAdaptAreaSelectionView()){var n=Hn(i,!1);tA.ready=!0,this.x0=n.x,this.y0=n.y,this.dx=0,this.dy=0,this.x1=this.x0,this.y1=this.y0,eA()}}uninstall(){console.log(this.getSymbol(),"uninstalled")}ondrag(r,i){if(i.dx===0||i.dy===0){hm();return}ES(i.x0,i.y0,i.dx,i.dy)}static handlePolylineSelection(){let r=tA.selectionMode;if(!["lineTouched"].includes(r))return;let n=Fe("selection-polyline");if(n.points.numberOfItems<2)return;let s=th();for(let a of s){let o;for(let l of a.elements){let c=sp(Fe(l));if(o=bz(n,c),o)break}for(let l of a.elements)tA.selectElement(Fe(l),o,!0)}tA.showSelectPolyline("","none")}static showSelectPolyline(r,i=""){let n=Fe("selection-polyline");return ge(n,{points:r,class:pt.unselectableClass,display:i}),n}static selectElement(r,i,n){pt.isSelected(r)!==i&&(n?i&&pt.select([r]):pt.toggle([r],i))}ondragend(r,i){if(hm(),!this.start)return;let n=tA.selectionMode==="rectangleOutside",s={x:Math.min(i.x0,i.x0+i.dx),y:Math.min(i.y0,i.y0+i.dy),width:Math.abs(i.dx),height:Math.abs(i.dy)},a=Jn(ud({matrix:[s.width,0,0,s.height,s.x,s.y]})),o=th();for(let l of o){if(l.combinationId&&te.getCombination(l.combinationId).visible===!1)continue;let c;for(let u of l.elements){let{cmdKey:d,json:A}=te.getById(u),h=un(A);if(i.dx>0)c=RC(h,s);else{if(Fo(d))c=Kq(s,A);else{let f;d==="text"?f=Jn(ud({matrix:[h.width,0,0,h.height,h.x,h.y]})):f=In.convertData2Polyline([A])[0],f.some(m=>a.some(y=>Oq(m,y)))&&(c=!0)}c=c||RC(h,s)}if(c)break}c=n?!c:c;for(let u of l.elements)tA.selectElement(Fe(u),c,r.ctrlKey)}}onMouseLeftUp(r){if(r.toolFinished=!0,tA.clickedCanvas=!1,!tA.ready)return;let i=r.originalEvent;this.ondragend(i,this),this.start=!1,setTimeout(()=>{tA.ready=!1}),Et("panel_updateAttrPanel"),Et("updateMenuByDocStatus"),Et("panel/updateTreeActiveElements")}onMouseMove(r){let i=r.originalEvent;var n=this;if(tA.ready){var s=Hn(i,!1),a=s.x,o=s.y,l=a-n.x0,c=o-n.y0;if(!n.start){if((l*l+c*c)*X.gZoom*X.gZoom<9)return;n.start=!0}n.x1=a,n.y1=o,n.dx=l,n.dy=c,this.ondrag(i,this)}}};tA.ready=!1;var Kl=tA;function XS(t="",e){if(Kl.selectionMode!==t){switch(Kl.selectionMode=t,t){case"polygonInside":case"polygonOutside":{sy("draw(polygon)");break}case"lineTouched":{sy("draw(polyline)",e);break}case"rectangleInside":case"rectangleOutside":return X.frameHelper.getToolProcessor().switchToRectSelectTool();case"continuousSelection":{Ls("cross-red"),fc();return}case"":{Ls(),fc();return}default:throw new Error(`DragSelectAreaTool: Unknown SelectionMode ${t}`)}Kl.selectionMode=t}}function qS(){return Kl.selectionMode}var fL=class{constructor(e){this.selectedObjs=[];this.selectedDimensionObjs=[];this.selectedIds=Object.create(null);this.drivingDimensions=new Set;this.affectedDimensions=new Set;this.horizontalAuxiliaryLines=new Set;this.verticalAuxiliaryLines=new Set;this.auxiliaryPoints=new Set;this.xMoveEles=new Set;this.yMoveEles=new Set;this.abandonMove=!1;this.dragDimensionDots=[];this.combinationMask=new rs;for(let a of e.selectItems){if(a.parentId){console.warn(a);let{json:c,cmdKey:u}=te.getById(a.parentId);switch(u){case"dimensionAngle":{let d=new ga(c);d.setControlDotSelected(a.id),this.dragDimensionDots.push(d)}break;case"dimensionLength":{let d=new ya(c);d.setControlDotSelected(a.id),this.dragDimensionDots.push(d)}break;case"dimensionRadius":{let d=new ca(c);d.setControlDotSelected(a.id),this.dragDimensionDots.push(d)}break}continue}let{json:o,cmdKey:l}=te.getById(a.id);if(l==="dimension"?(this.drivingDimensions.add(o),this.selectedDimensionObjs.push(Fe(a.id))):this.selectedObjs.push(Fe(a.id)),l==="auxiliaryPoint")this.auxiliaryPoints.add(o);else if(l==="auxiliaryLine")switch($d(o.rotation)){case"horizontal":this.horizontalAuxiliaryLines.add(o);break;case"vertical":this.verticalAuxiliaryLines.add(o);break}}let r=new Set(this.selectedObjs.map(a=>a.id)),i=this.dimensionMgr=new Ad,n=new Set(r);if(i.findDimensionNodeByPrimitiveId(r)===!1){this.abandonMove=!0;return}this.initXmoveYmoveEles(r,n),this.abandonedWhenIsLock(e),this.affectedDimensions=i.findDimensionByPrimitiveId(n),Jr.setExcludeShapeIds(Array.from(n));for(let a of this.drivingDimensions)this.affectedDimensions.has(a.gId)&&this.drivingDimensions.delete(a)}abandonedWhenIsLock(e){let r=new Set,{startX:i,startY:n,snapX:s,snapY:a}=e,o=s-i,l=a-n,{canMoveX:c,canMoveY:u}=this.dimensionMgr.getAllAffectedPrimitivesId(),d=th(),A=new Map;for(let{elements:h,combinationId:f,selectable:p}of d)for(let m of h)A.set(m,f?!p:Rs.isLockedById(m));if(o!==0){for(let h of new Set([...c]))if(A.get(h)){this.abandonMove=!0;let{cmdKey:f,json:p}=te.getById(h),m=Fn[f];r.add(m+p.id.slice(1))}}if(l!==0){for(let h of new Set([...u]))if(A.get(h)){this.abandonMove=!0;let{cmdKey:f,json:p}=te.getById(h),m=Fn[f];r.add(m+p.id.slice(1))}}this.abandonMove&&il({value:r.size>1?"Constraint associated object {0} are currently locked, please unlock them first.":"Constraint associated object {0} is currently locked, please unlock first.",options:{0:[...r]},translateOptionKeys:[0]})}initXmoveYmoveEles(e,r){let{canMoveX:i,canMoveY:n,all:s,xNode:a,yNode:o}=this.dimensionMgr.getAllAffectedPrimitivesId(),l=new gr;for(let c of e)i.delete(c),n.delete(c);for(let c of s)r.add(c);for(let c of i){let u=l.searchCombination(c);if(u&&u==Li.getCurrentEditingComId()){let d=l.getAllElesfromTop(u);for(let A of d.elements)[...a].find(h=>h.id==A)||i.delete(A)}}for(let c of n){let u=l.searchCombination(c);if(u&&u==Li.getCurrentEditingComId()){let d=l.getAllElesfromTop(u);for(let A of d.elements)[...o].find(h=>h.id==A)||n.delete(A)}}this.xMoveEles=new Set(Array.from(i).map(c=>Fe(c))),this.yMoveEles=new Set(Array.from(n).map(c=>Fe(c)))}};var WS=class{constructor(e){this.dragContext=e}onDrag(e,r){if(!this.dragContext.abandonMove){for(let i of this.dragContext.drivingDimensions){let n=new Ua(i).updateOtherP(e,r);n=null}for(let i of this.dragContext.selectedObjs)Io.move(te.getById(i.id).json,e,r);this.dragContext.dimensionMgr.moveDimension(e,r);for(let i of this.dragContext.xMoveEles)Io.move(te.getById(i.id).json,e,0);for(let i of this.dragContext.yMoveEles)Io.move(te.getById(i.id).json,0,r);for(let i of this.dragContext.dragDimensionDots)i.moveControlPoint(e,r).render()}}};var KS=PSe();function PSe(){var t={Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,Esc:27,Space:32,"Page Up":33,"Page Down":34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,"`":192,"-":j0?173:189,"+":j0?61:187,"[":219,"]":221,"\\":220,";":j0?59:186,"'":222,",":188,".":190,"/":191,"*":106};for(let n=1;n<=12;n++)t["F"+n]=111+n;var e=Object.keys(t);for(let n=0;n<e.length;n++){var r=t[e[n]];$t(t,r)||(t[r]=e[n])}DC&&(j0?t[224]="Cmd":(t[91]="Cmd",t[93]="Cmd"),delete t.Backspace,t[8]="Delete",t.Delete=8);var i={107:"+107",109:"-109"};return Object.assign({},t,i)}var LSe={0:"ns-resize",1:"ew-resize",2:"nesw-resize",3:"nwse-resize",5:"move",6:"rotate-left-top",9:"rotate-left-bottom",7:"rotate-right-top",8:"rotate-right-bottom"},Sk=class{getCursor(){return this._cursor}switch(e){if(e!=this._cursor){if(this._cursor=e,e===4){delete X.svgRoot.dataset.cursor;return}X.svgRoot.dataset.cursor=LSe[e]}}isBoxRotateCursor(){return[9,6,8,7].includes(this._cursor)}mouseMoveCursor(e,r,i,n=!0){if(X.cmdToken||op())return;let s=e.target;if(Pi(s)==="cdot")return this.cDotCursor(s);let a=Zo.isNearBBoxEdge(i);if(a>-1)return this.cDotCursor(Fe("cdot"+a));let o=XA(r||s);if(o&&pt.isSelected(o)&&n)return this.switch(5);let l=Zo.findCanRotateControlDotInfo(i.x,i.y);return l!=null?this.boxRotateCursor(l.index,this.getBoxCDotRotation()):ub(i.x,i.y)&&!pi.isEditingPath()?this.switch(5):this.switch(4)}cDotCursor(e){var a,o;let r=Gs(),i=r[0];if(!i)return;let n=(()=>{let l=0,c=e;for(;c=c.previousElementSibling;)l++;return l})(),s=360-((o=(a=te.gJsonCache[Pi(i)])==null?void 0:a[i.id])==null?void 0:o.rotation)||0;if(r.length>1)return this.boxCDotResizeCursor(n,0);switch(Pi(i)){case"rect":case"obj":return this.boxCDotResizeCursor(n,s);case"ellipse":{let l=_i(i.rx.animVal.value,i.ry.animVal.value),c=s;return l?c=0:c=this.getBoxCDotRotation(),this.boxCDotResizeCursor(n,c)}default:pi.is8DotsMode(i.id)&&this.boxCDotResizeCursor(n,s);return}}boxRotateCursor(e,r=this.getBoxCDotRotation()){let i=[6,9,8,7],n=Math.floor((r+45)%360/90%4);switch(e){case 0:return this.switch(i[n]);case 1:return this.switch(i[(n+3)%4]);case 2:return this.switch(i[(n+2)%4]);case 3:return this.switch(i[(n+1)%4])}}boxRotateCursor1(e,r){let i=e.angle(r);return i<0&&(i+=Math.PI*2),i<Math.PI/2?this.switch(8):i<Math.PI?this.switch(9):i<3*Math.PI/2?this.switch(6):this.switch(7)}boxCDotResizeCursor(e,r){let i=[3,1,2,0],n=Math.floor((r+22.5)%360/45%4);switch(e){case 0:case 2:return this.switch(i[n]);case 1:case 3:return this.switch(i[(n+2)%4]);case 4:case 6:return this.switch(i[(n+3)%4]);case 5:case 7:return this.switch(i[(n+1)%4])}}getBoxCDotRotation(){let e=Fe("cdot0"),r=new ne(Number(e.dataset.x),Number(e.dataset.y)),i=Fe("cdot1"),n=new ne(Number(i.dataset.x),Number(i.dataset.y));return Cs(-n.angleD(r))}},oW,kg=oW=oW||new Sk;function Tk(){var e,r,i,n;return((n=(i=(r=(e=X)==null?void 0:e.profileSetting)==null?void 0:r.commSystemSetting)==null?void 0:i.SYSTEM)==null?void 0:n.dragMiddleMouseButton)==="moveCanvas"}var pE=class pE extends nb{constructor(){super(...arguments);this.start=!1;this.lastX=0;this.lastY=0;this.lastMove=0;this.startX=0;this.startY=0;this.afterMidUp=_A}startGrabCanvas(r){return this.lastX=r.mouseX,this.lastY=r.mouseY,this.helperCursorBefore=X.helperCursor,Ls("grabbing"),()=>{Ls(),this.start=!1}}onMouseMidDown(r){r.originalEvent.preventDefault(),Tk()?this.afterMidUp=this.startGrabCanvas(r):(this.lastX=r.mouseX,this.lastY=r.mouseY,this.startX=r.mouseX,this.startY=r.mouseY)}onMouseMidUp(r){this.afterMidUp()}onMouseRightDown(r){this.startGrabCanvas(r)}onMouseRightUp(r){if(X.helperCursor=="grabbing"){let i=this.helperCursorBefore;i?this.rootcursor?Ls(i,!0):Ls(i):Ls()}if(this.start)return this.start=!1,pE.dragpanning=!0,setTimeout(function(){pE.dragpanning=!1},5),_c}onMouseMove(r){if(this.moveCanvasCore(r),this.start)return _c}moveCanvasCore(r){(r.mouseRightMoving||r.mouseMidMoving&&Tk())&&this.moveCanvas(r),r.mouseMidMoving&&!Tk()&&this.zoomCanvas(r)}moveCanvas(r){let i=performance.now();if(i-this.lastMove>30){this.start=!0;let n=r.mouseX-this.lastX,s=r.mouseY-this.lastY,a=X.gZoom,o=An.getViewBox();o[0]-=n/a,o[1]-=s/a,An.setViewBox(o),this.lastX=r.mouseX,this.lastY=r.mouseY,this.lastMove=i,new rs().updateHole()}}zoomCanvas(r){let i=performance.now();if(i-this.lastMove>8){let n=r.mouseY-this.lastY,a=X.currZoom,o=n/document.documentElement.offsetHeight;n>0?a=a*(1-o*3):a=a*(-o*3+1);let l={clientX:this.startX,clientY:this.startY};Ay(+a,l),this.lastMove=i,this.lastY=r.mouseY}}};pE.dragpanning=!1,pE.ready=!1;var Fg=pE;var mb=[],Ik=0,lW=_A;async function cW(){let t=Date.now();for(;mb.length&&Date.now()-t<100;)await mb.shift()();let e=mb.length&&Ik?1-mb.length/Ik:1;lW(e),mb.length&&setTimeout(cW,0)}var Ug={addTask(t){return mb.push(t),Ug},run(){Ik=mb.length,cW()},onProgress(t){return lW=t,Ug}};var Bk=new WeakMap,Bo={on:!1,firstMove:!0,hasMoved:!1,clonedElements:[],previewItems:[],selectedObjs:[],bbox:null,row:1,column:1,lastMouseRightDownPosition:null,followCursor:!1,ready(t,e,r){if(!t){this.end();return}this.followCursor=r,this.row=t,this.column=e,document.addEventListener("mousemove",Bo.onMouseMove,!1),this.on||(document.addEventListener("mousedown",Bo.onMouseDown,!1),document.addEventListener("mouseup",Bo.onMouseUp,!1),Bo.selectedObjs=Gs(),this.bbox=this.outerBBox(this.selectedObjs),Bo.on=!0)},onMouseDown(t){let e=Bo,r=Hn(t,!0),i=r.x,n=r.y;if(t.button==TM)e.lastMouseRightDownPosition={x:t.clientX,y:t.clientY},X.contextmenuDisableOnce=!0;else{let s=e.row<=1||!e.hasMoved?null:(n-e.bbox.y)/(e.row-1)+e.bbox.height,a=e.column<=1||!e.hasMoved?null:(i-e.bbox.x-e.bbox.width)/(e.column-1)-e.bbox.width;Et("editArray",[{rowSpacing:s,columnSpacing:a,row:Bo.row,column:Bo.column}]),document.removeEventListener("mousemove",Bo.onMouseMove,!1)}e.hasMoved=!1},onMouseUp(t){t.preventDefault(),t.stopPropagation();let e=Bo,r={x:t.clientX,y:t.clientY};t.button==TM&&e.lastMouseRightDownPosition&&Oc(r,e.lastMouseRightDownPosition)&&Et("editArray",[])},onMouseMove(t){if(!Bo.followCursor)return;X.helperCursor=!0,Bo.hasMoved=!0;let e=Hn(t,!1),r=e.x,i=e.y;Bo.moveByCursor(r,i)},end(){document.removeEventListener("mousedown",Bo.onMouseDown,!1),document.removeEventListener("mouseup",Bo.onMouseUp,!1),document.removeEventListener("mousemove",Bo.onMouseMove,!1),Eu(!1),this.clearPreviewItem(),Bo.on=!1,this.bbox=null,this.firstMove=!0,this.selectedObjs=[],this.hasMoved=!1,this.lastMouseRightDownPosition=null,this.followCursor=!1,X.helperCursor=null},async initPreviewItem(t,e,r){this.clearPreviewItem();for(let i=0;i<t;i++)for(let n=0;n<e;n++)await this.cloneAndMove(i,n,t,e,r)},cloneAndMove(t,e,r,i,n){return new Promise(s=>{this.previewItems[t]||(this.previewItems[t]=[]),t===0&&e===0?this.previewItems[t][e]=null:(this.previewItems[t][e]=this.simpleClone(this.selectedObjs),n&&ge(this.previewItems[t][e],"transform","translate("+n.columnOffset*e+","+n.rowOffset*t+")")),ba("progressUpdate",[((t+1)*i+e+1)/(r*i),"Array"]),s(!0)})},clearPreviewItem(){for(let t=0;t<this.previewItems.length;t++)for(let e=0;e<this.previewItems[0].length;e++)if(!(t===0&&e===0)&&this.previewItems[t]){let r=this.previewItems[t][e];r&&Cr(r);for(let i of r)Bk.delete(i)}this.previewItems=[]},async preview({row:t,column:e,rowSpacing:r,columnSpacing:i}){this.on||this.ready(t,e,!1),await this.initPreviewItem(t,e,{rowOffset:r-this.bbox.height,columnOffset:i+this.bbox.width});let n=Math.round((r-this.bbox.height)/zt.adsorbGrid.gridSize)*zt.adsorbGrid.gridSize,s=Math.round((i+this.bbox.width)/zt.adsorbGrid.gridSize)*zt.adsorbGrid.gridSize;this.move(n,s),this.adaptAll(this.selectedObjs,t,e,n,s)},async moveByCursor(t,e){(this.firstMove||this.row!=this.previewItems.length||this.column!=this.previewItems[0].length)&&(await this.initPreviewItem(this.row,this.column),this.firstMove=!1);let r=this.row,i=this.column,n=r==1?0:((e-this.bbox.y)/(r-1)).toFixed(2),s=i==1?0:((t-this.bbox.x-this.bbox.width)/(i-1)).toFixed(2);this.move(n,s),Eu(t,e)},move(t,e){for(let r=0;r<this.previewItems.length;r++)for(let i=0;i<this.previewItems[0].length;i++)if(!(r===0&&i===0))for(let n of this.previewItems[r][i]){let{json:{matrix:s},cmdKey:a}=te.getById(Bk.get(n).id),o;switch(a){case"rect":o=vn.getRectFromMatrix(s).matrixArr;break;case"ellipse":o=tn.getEllipseFromMatrix(s).matrixArr;break;case"arc":case"group":o=[1,0,0,1,0,0];break;case"obj":break;case"text":break;default:break}let l=o||s?xr.getTransformStr(o||s):"";ge(n,"transform"," translate("+e*i+","+t*r+") "+l)}},simpleClone(t){let e=[];return t.forEach(r=>{let i=r.cloneNode(!0);Bk.set(i,r),e.push(i),X.gCanvas.appendChild(i)}),e},outerBBox(t){return uW(t)},adaptAll(t,e,r,i,n){let s=la(t),a={x:s.x+(n<0?n*(r-1):0),y:s.y+(i<0?i*(e-1):0),width:Math.abs(n*(r-1))+s.width,height:Math.abs(i*(e-1))+s.height};dm(a,1)},execute(t){if(Bo.end(),!t)return;let e=Gs(),r=Bo.outerBBox(e),{row:i,column:n,rowSpacing:s,columnSpacing:a,saveHistory:o}=t,l=s-r.height,c=a+r.width;if(i==1&&n==1)return;let u=[],d=new gr,A=new qi,h=[];for(let f=0;f<i;f++)for(let p=0;p<n;p++){if(f===0&&p===0)continue;let m=new Set,y=new Map,g=[];e.forEach(b=>{Ug.addTask(()=>{let{json:E,cmdKey:w}=te.getById(b.id),x=c*p,I=l*f,C,G=vi(E),U=ni();G.gId=U,C=Hc(w,G),Io.move(G,x,I),u.push(C),y.set(b.id,U);let _=d.searchCombination(b.id);if(_&&!m.has(_)){m.add(_);let H=ni(),Q=vi(te.getCombination(_));Q.gId=H,g.push(Q),y.set(_,H)}})}),h.push({copiedCombination:g,oldIdMapNewId:y})}Ug.addTask(()=>{this.adaptAll(e,i,n,l,c),u.forEach(f=>nd(f,"selected")),h.forEach(f=>d.pasteCombination(A,f.copiedCombination,f.oldIdMapNewId)),this.clonedElements=u,pt.select(u),Et("panel_updateAttrPanel")}),o&&Ug.addTask(function(){let f=u.map(m=>{let y=te.getRefId(m.id);return Da(m.id,{cmdKey:Pi(m),refId:y},{},te.getById(m.id).json)});A.update();let p=A.getCombHistory();mr.save([...f,...p])}),Ug.onProgress(function(f){f=Math.min(1,Math.max(f,.01)),ba("progressUpdate",[f,"Array"])}),Ug.run()}};var pL=class{constructor(e){this.elms=e;this.polymer=new Map;this.updatePolymer()}updatePolymer(){let{polymer:e}=this;this.elms.forEach(r=>{let i=Pi(r);e.has(i)?e.get(i).add(r):e.set(i,new Set([r]))})}};var mL=class{constructor(e){this.elms=e;this.elmsClassified=new pL(new Set(e)).polymer}};function OSe(t){let{json:e,cmdKey:r}=te.getById(t.id),i=te.getShapeAttr(e,r);if($t(i,"attr-x"))return new ne(+i["attr-x"],+i["attr-y"]);if($t(i,"attr-start-x"))return new ne(+i["attr-start-x"],+i["attr-start-y"]);console.error(i,"Plz check code")}function Dk(t){let e=OSe(t),r=rA(e);return{moveX:Sr(r.x,2)-e.x,moveY:Sr(r.y,2)-e.y}}var gL=class t{constructor(e){this.elms=e;this.bboxMap=t.getAllBBox(this.elms)}static getByAlignCmd(e,r){let i=new t(e);return{bboxMap:i.bboxMap,...i[r]()}}static getAllBBox(e){let r=new WeakMap;for(let i of e){let n;HC(i)||Array.isArray(i)?n=la([...i],!0):n=Rg(i),r.set(i,n)}return r}get canEquidistantAlign(){return this.elms.size>2}get bboxs(){return nq([...this.elms],e=>this.bboxMap.get(e))}align_left(){return{edge:{left:this.bboxs.reduce((r,{x:i})=>Math.min(r,i),this.bboxs[0].x)}}}align_right(){return{edge:{right:this.bboxs.reduce((r,{x:i,width:n})=>Math.max(r,i+n),this.bboxs[0].x+this.bboxs[0].width)}}}align_top(){return{edge:{top:this.bboxs.reduce((r,{y:i})=>Math.min(r,i),this.bboxs[0].y)}}}align_bottom(){return{edge:{bottom:this.bboxs.reduce((r,{y:i,height:n})=>Math.max(r,i+n),this.bboxs[0].y+this.bboxs[0].height)}}}align_horizontal_center(){let e=this.bboxs.reduce((r,{x:i,width:n})=>(r.left=Math.min(r.left,i),r.right=Math.max(r.right,i+n),r),{left:this.bboxs[0].x,right:this.bboxs[0].x+this.bboxs[0].width});return{edge:{center:e.left+e.right>>1}}}align_vertical_center(){let e=this.bboxs.reduce((r,{y:i,height:n})=>(r.top=Math.min(r.top,i),r.bottom=Math.max(r.bottom,i+n),r),{top:this.bboxs[0].y,bottom:this.bboxs[0].y+this.bboxs[0].height});return{edge:{center:e.top+e.bottom>>1}}}align_horizontal_equidistant(){let e=this.bboxs.reduce((i,{x:n,width:s})=>(i.left=Math.min(i.left,n),i.right=Math.max(i.right,n+s),i),{left:this.bboxs[0].x,right:this.bboxs[0].x+this.bboxs[0].width}),r=0;return this.canEquidistantAlign&&(r=(e.right-e.left-this.bboxs.reduce((n,{width:s})=>n+s,0))/(this.bboxs.length-1)),{edge:e,spacing:r}}align_vertical_equidistant(){let e=this.bboxs.reduce((i,{y:n,height:s})=>(i.top=Math.min(i.top,n),i.bottom=Math.max(i.bottom,n+s),i),{top:this.bboxs[0].y,bottom:this.bboxs[0].y+this.bboxs[0].height}),r=0;return this.canEquidistantAlign&&(r=(e.bottom-e.top-this.bboxs.reduce((n,{height:s})=>n+s,0))/(this.bboxs.length-1)),{edge:e,spacing:r}}align_left_side_edge_equidistant(){let e=this.bboxs.reduce((r,{x:i})=>(r.left=Math.min(r.left,i),r.right=Math.max(r.right,i),r),{left:this.bboxs[0].x,right:this.bboxs[0].x});return{edge:e,spacing:Math.abs(e.right-e.left)/(this.elms.size-1)}}align_top_side_edge_equidistant(){let e=this.bboxs.reduce((r,{y:i})=>(r.top=Math.min(r.top,i),r.bottom=Math.max(r.bottom,i),r),{top:this.bboxs[0].y,bottom:this.bboxs[0].y});return{edge:e,spacing:Math.abs(e.bottom-e.top)/(this.elms.size-1)}}},yL=class t{constructor(e){this.params=e}static run(e,...r){return new t(...r)[e]()}align_left(){let{bbox:{x:e},edge:r}=this.params;return{moveX:r.left-e,moveY:0}}align_right(){let{bbox:{x:e,width:r},edge:i}=this.params;return{moveX:i.right-e-r,moveY:0}}align_top(){let{bbox:{y:e},edge:r}=this.params;return{moveX:0,moveY:r.top-e}}align_bottom(){let{bbox:{y:e,height:r},edge:i}=this.params;return{moveX:0,moveY:i.bottom-e-r}}align_horizontal_center(){let{bbox:{x:e,width:r},edge:i}=this.params;return{moveX:i.center-e-r/2,moveY:0}}align_vertical_center(){let{bbox:{y:e,height:r},edge:i}=this.params;return{moveX:0,moveY:i.center-e-r/2}}align_horizontal_equidistant(){let{bbox:{x:e,width:r},edge:i,spacing:n}=this.params,s={moveX:0,moveY:0};if(e+r===i.right)return s;let a=i.left-e;return s.moveX=a,i.left+=r+n,s}align_vertical_equidistant(){let{bbox:{x:e,y:r,height:i},edge:n,spacing:s}=this.params,a={moveX:0,moveY:0};if(e+i===n.bottom)return a;let o=n.top-r;return a.moveY=o,n.top+=i+s,a}align_left_side_edge_equidistant(){let{bbox:{x:e},edge:r,spacing:i}=this.params;try{return{moveX:Math.round(r.left-e),moveY:0}}finally{r.left+=i}}align_top_side_edge_equidistant(){let{bbox:{y:e},edge:r,spacing:i}=this.params;try{return{moveX:0,moveY:Math.round(r.top-e)}}finally{r.top+=i}}};function bL(...t){new Pk(...t).do().afterDo()}var Pk=class{constructor(e,r,i){this.elms=e;this.alignCmd=r;this.refObject=i;this.context=new mL(this.elms)}alignGrid(){let{context:e}=this,{elmsClassified:r}=e;for(let[,i]of r)for(let n of i)if(Array.isArray(n)){let s=Dk(n[0]);if(s.moveX||s.moveY)for(let a of n)mr.jsonSnap.addOne(te.getById(a.id).json),Io.move(te.getById(a.id).json,s.moveX,s.moveY)}else{let s=Dk(n);(s.moveX||s.moveY)&&(mr.jsonSnap.addOne(te.getById(n.id).json),Io.move(te.getById(n.id).json,s.moveX,s.moveY))}}rebuildAlignEdgeByCmdRefObject(e){if(!this.refObject)return;let r=Rg(this.refObject),i=Mr.extendRect(r);switch(this.alignCmd){case"align_left":e.left=i.minX;break;case"align_top":e.top=i.minY;break;case"align_right":e.right=i.maxX;break;case"align_bottom":e.bottom=i.maxY;break;case"align_vertical_center":e.center=i.center().y;break;case"align_horizontal_center":e.center=i.center().x;break}}alignCommon(){let e=this.alignCmd,r=this.elms,{bboxMap:i,edge:n,spacing:s}=gL.getByAlignCmd(new Set(r),e);this.rebuildAlignEdgeByCmdRefObject(n);let a=(()=>{if(e=="align_top_side_edge_equidistant"||e=="align_vertical_equidistant")return"y";if(e=="align_left_side_edge_equidistant"||e=="align_horizontal_equidistant")return"x"})(),o=a?[...r].sort((u,d)=>i.get(u)[a]-i.get(d)[a]):[...r],{gridSize:l}=zt.adsorbGrid,c=[];for(let u of o){let d=i.get(u),{moveX:A,moveY:h}=yL.run(e,{bbox:d,edge:n,spacing:s,gridSize:l});HC(u)||(u=new Set([u]));for(let f of u)A===0&&h===0&&$i.self.dimensionMgr.setStillByEle(f),(A||h)&&c.push({elm:f,moveX:A,moveY:h})}for(let{elm:u,moveX:d,moveY:A}of c){let h=u;Array.isArray(u)||(h=[u]);for(let f of h)mr.jsonSnap.addOne(te.getById(f.id).json),Io.move(te.getById(f.id).json,d,A)}}align(){this.alignCmd==="align_grid"?this.alignGrid():this.alignCommon()}do(){let e=$i.createContext(!0);return this.align(),e(),this}afterDo(){let e=xu(this.elms.flat(1/0));pt.select(e),e.length&&Ja(e,{create8Dots:!0}),ms.emptyLastHoverEle().emptySelectContainer().appendSelectStroke()}};var NSe={align_top:!0,align_left:!0,align_right:!0,align_bottom:!0,align_vertical_center:!1,align_horizontal_center:!1},RSe={align_top:!1,align_left:!1,align_right:!1,align_bottom:!1,align_vertical_center:!0,align_horizontal_center:!0},Hg=class Hg{constructor(e,r){this.cmd=e;this.elms=r;this.pointerUp=async e=>{if(e.button!==0||!e.target)return;let r=e.target;ge(r,"name")==="adsorption-point"&&(r=Jr.currentAdsorptionShapeElement);let i=XA(r);i&&(pt.select(i),bL(this.elms,this.cmd,i),this.cancel())};this.pointerMove=e=>{this.updateContent()};this.keyUp=e=>{e.key==="ESC"&&this.cancel()};new.target.instance=this,this.textElm=Fe(`${new.target.textElmId}`)}static isSelectRefObjectCmd(e){return NSe[e]}static async needSelectRefobject(e){return(await pd("isCheckedSelectAlignrefObject")).message&&this.isSelectRefObjectCmd(e)}static isSelectRefObjectCmdForCenters(e){return RSe[e]}static async needSelectRefobjectForCenters(e){return(await pd("isCheckedSelectAlignrefObjectForCenters")).message&&this.isSelectRefObjectCmdForCenters(e)}async startSelect(){await this.init(),document.addEventListener("pointermove",this.pointerMove),document.addEventListener("mouseup",this.pointerUp),document.addEventListener("keyup",this.keyUp)}async init(){gb(),Hg.running=!0,X.cmdToken=this.cmd,this.textElm.classList.remove("hide"),this.textElm.textContent=(await pd("i18n",Hg.textContent)).message;let e=(await X.windowBridge.rpcCall("getThemeCssVariable",["--common-bg-color","--common-font-color"],z2())).message;this.textElm.style.backgroundColor=e["--common-bg-color"],this.textElm.style.color=e["--common-font-color"],this.updateContent()}getCursorTextPosition(e,r,i){let n=1/X.gZoom,s=n/2,a=e%n,o=r%n;e+=s-a,r+=s-o,e=Math.round(e*1e6)/1e6,r=Math.round(r*1e6)/1e6;let l=this.textElm.offsetHeight,c=24,u=6,d=X.gZoom,A=(e-i[0])*d+c,h=(r-i[1])*d-l-u;return{left:A,top:h}}updateTipPosition(e){let r=An.getViewBox(),{top:i,left:n}=this.getCursorTextPosition(e.x,e.y,r);this.textElm.style.left=n+"px",this.textElm.style.top=i+"px"}updateContent(){let{currAbsX:e,clientX:r,clientY:i,currAbsY:n}=tl.data;Ls("cross-red",e,n);let s=Hn(new MouseEvent("mousemove",{clientX:r,clientY:i}));fc("",s),this.updateTipPosition(s)}clearContent(){Ls(),fc(),this.textElm.textContent="",this.textElm.classList.add("hide")}end(){}cancel(){document.removeEventListener("pointermove",this.pointerMove),document.removeEventListener("mouseup",this.pointerUp),document.removeEventListener("keyup",this.keyUp),Jr.clearAdsorptionHTML(),xL(),this.clearContent(),Hg.running=!1}};Hg.instance=null,Hg.running=!1,Hg.textElmId="cross-text",Hg.textContent="Please Select The Reference Object";var md=Hg;var EL=class{constructor(e){this.middleware=[];this.context=Object.assign(e,{tool:this}),Reflect.defineProperty(this.context,"tool",{writable:!1,configurable:!1,enumerable:!0})}use(e){let{middleware:r}=this;return!r.includes(e)&&r.push(e.bind(this)),this}do(){return MSe(this.middleware)(this.context)}handle(e){for(let r=0;r<e.length;r++)this.use(e[r]);return this.do()}};function MSe(t){return function(e,r){let i=-1;return n(0);function n(s){if(s<=i)return Promise.reject(new Error("next() called mutiple times"));i=s;let a=t[s];if(s===t.length&&(a=r),!a)return Promise.resolve();try{return Promise.resolve(a(e,n.bind(null,s+1)))}catch(o){return Promise.reject(o)}}}}var fy=kSe();function kSe(){let t={disable:!1,checkInHideFlag:!0,checkInDisableFlag:!0,checkOutHideFlag:!0,checkOutDisableFlag:!0};return{set(e){t=e},get(){return t},forbiddenDataChange(){let{disable:e}=t;return e}}}function hW(t,e){let{cmdKey:r,json:i}=t&&te.getById(t.id)||{};e.target.dataset.type=="handle"&&(t=e.target);let n=new EL({target:t,cmdKey:r,json:i,event:e});n.use(USe),n.use(HSe),n.use(FSe),n.use(GSe),n.use(YSe),n.use(VSe),n.do()}function FSe({target:t,cmdKey:e,json:r},i){if(e==="dimension"){new QS().dblclickHandler(r);return}i()}function USe({target:t,cmdKey:e},r){if(!t){if(pi.isEditingPath())return pi.endEditingPath();if(Li.isEditing()){let i=Li.getCurrentEditingComId();Li.setEditing(null).selectCombinations([i])}return}r()}function HSe({target:t,cmdKey:e},r){let i=new gr,n=i.searchCombination(t.id);if(!n){r();return}if(Li.isEditing()){let s=Li.getCurrentEditingComId(),a=i.getAllElesfromTop(s).combinations;if(a.size===0)return r();Ci();for(let o of i.findFamily(n,s).getAllParents().reverse())if(a.has(o))return Li.setEditing(o);r()}else{let s=i.findFamily(n).peekParent();Ci(),Li.setEditing(s)}}function GSe({target:t,cmdKey:e},r){if(Li.isEditing()){let i=new gr().findFamily(Li.getCurrentEditingComId()).peekParent();if(!new gr().getAllElesfromTop(i).elements.has(t.id))return r()}if(["arc","group"].includes(e)&&!pt.isUnselectAble(t.id)){pi.startEditPath(t.id),pt.unselectAll().select([t]);return}t.dataset.type!="handle"&&r()}async function YSe({target:t,cmdKey:e,event:r},i){let n,s;if(e==="text"){if(fy.forbiddenDataChange())return;s=(await X.windowBridge.rpcCall("i18n","Ctrl / Shift / Alt + Enter for new line",ur())).message,a(r);return}i();async function a(o){let l=!1,{locked:c,name:u}=te.getById(t.id).json,{checked:d}=SP["all-element-type"].text;if(c||!d)return;let A="text-input-box",h="textInputBox-container",f=Fe(A),p=Fe(h);if(te.compilerManager.pauseDateMerge(),!f){let U=function(){if(l)return;l=!0;let _=n,H=new qi([_]),Q=f.value.trim();if(Q==="")return fd([_]);Q=fz(Q),new WP(_).name(Q).then(function(){H.updateAndSave(),Et("panel_updateAttrPanel")})},I=["--bg-color-input","--border-color-input","--border-color-focus-input","--common-font-color","--bg-color-pop-up-content","--font-color-input"],C=(await X.windowBridge.rpcCall("getThemeCssVariable",I,ur())).message;p=document.createElement("div"),p.id=h,p.style.padding="0.2em",f=document.createElement("textarea"),f.id=A,f.style.width="300px",f.style.boxSizing="border-box",f.style.outline=C["--bg-color-input"],f.style.background=C["--bg-color-input"],f.style.color=C["--font-color-input"],f.onfocus=()=>{f.style.border=`1px solid ${C["--border-color-focus-input"]}`},p.appendChild(f);let G=document.createElement("div");G.setAttribute("class","i18n"),G.innerText=s,G.style.fontSize="12px",G.style.color=C["--common-font-color"],p.appendChild(G),document.body.appendChild(p),p.style.width="fit-content",p.style.position="absolute",p.style.boxShadow="0px 0px 20px 3px #333",p.style.background=C["--bg-color-pop-up-content"],f.addEventListener("change",U,!1),f.addEventListener("blur",function(){U(),setTimeout(()=>{Cr(p),te.compilerManager.resumeDataMerge()},0)},!1),f.addEventListener("keydown",function(H){H.keyCode==13&&(H.preventDefault(),H.stopPropagation())}),f.addEventListener("keyup",function(_){let H=13,Q=27,{keyCode:j}=_;if(_.keyCode==32&&_.stopPropagation(),j==Q&&(_.stopPropagation(),setTimeout(()=>{Cr(p)},0)),!_.ctrlKey&&!_.shiftKey&&!_.altKey&&j==H){if(f.value.trim().length>4096)return X.windowBridge.publish("ui/toastMsg",{type:"error",msg:"Text cannot be more than 4096 characters!",timer:3},ur());f.blur(),setTimeout(()=>{Cr(p)},0);return}if(j===H&&_.preventDefault(),(_.ctrlKey||_.shiftKey||_.altKey)&&j==H){let v=Fe(ge(f,"data-targetid"));if(!(Pi(v)=="text"&&v.parentNode==X.gCanvas))_.preventDefault(),_.stopPropagation();else{var $=_.currentTarget,B=$.selectionStart,M=$.selectionEnd;f.value=f.value.substring(0,B)+`
`+f.value.substring(M),$.selectionStart=B+1,$.selectionEnd=B+1}}},!1);var m=f.style.resize!==void 0;m||(function(_){var H=0,Q=0,j=0,$=0,B=!1;function M(R){R.button===f_&&(B&&N(),R.offsetX>_.offsetWidth-16&&R.offsetY>_.offsetHeight-16&&(R.preventDefault(),_.style.cursor="nwse-resize",document.addEventListener("mousemove",v,!1),document.addEventListener("mouseup",N,!1),B=!0,H=R.pageX,Q=R.pageY,j=parseInt(_.style.width,10),$=parseInt(_.style.height,10)))}function v(R){var q=j+R.pageX-H,P=$+R.pageY-Q;_.style.width=Math.min(Math.max(q,100),1200)+"px",_.style.height=Math.min(Math.max(P,100),1e3)+"px"}function N(){B&&(_.style.cursor="",document.removeEventListener("mousemove",v,!1),document.removeEventListener("mouseup",N,!1),B=!1)}_.addEventListener("mousedown",M,!1),_.addEventListener("blur",N,!1)})(f)}let y=o.pageX,g=o.pageY;f.style.display="",p.style.display="inline-block",f.value=u,f.select(),f.focus(),n=t,ge(f,"data-targetid",t.id),(function(I){let C=I.value.replace(/[^\x00-\xff]/g,"**").split(/\r\n|\r|\n/),G=C.length,U=0;for(let _=0;_<C.length;_++)U=Math.max(C[_].length,U);ge(f,"rows",G),ge(f,"cols",U),f.style.height="100px"})(f);let b=p.offsetWidth,E=p.offsetHeight,w=Math.max(g-5,5),x=Math.max(y-5,5);x+b>document.documentElement.offsetWidth&&(x-=b),w+E>document.documentElement.offsetHeight&&(w-=E),p.style.left=x+"px",p.style.top=w+"px"}}function VSe({target:t,cmdKey:e},r){let i=xu([t]);if(i.length&&Ja(i,{create8Dots:!0}),pi.isEditingPath())return pi.endEditingPath();if(Li.isEditing()){let n=Li.getCurrentEditingComId();Li.setEditing(null).selectCombinations([n])}r()}var wL=new Zf(0);async function jSe(t){return new Promise((e,r)=>{let i=new Image;i.onload=async()=>{e(i)},i.onerror=n=>{i=null,r(n)},i.src=t})}async function mE(t,e){t.startsWith("data:")&&wL.info("initial bytes \u2248 "+((t.length-30)*.75|0));let i=await jSe(t);return await QSe(i,e)}function Lk(t,e="image/png",r){if("convertToBlob"in t)return t.convertToBlob({type:e});if("toBlob"in t)return new Promise(i=>{t.toBlob(i,e,r)});throw"get blob failed"}async function QSe(t,e){let{bytesLimit:r=10<<20,maxWidth:i=1e3,maxHeight:n=1e3,minWidth:s=1,minHeight:a=1}=e,o=/^data:image\/jpeg;/.test(t.currentSrc||t.src),l=/^data:image\/svg\+xml;|\.svg$/i.test(t.currentSrc||t.src),{width:c,height:u,naturalWidth:d,naturalHeight:A}=t,h=d,f=A,p=1;l?h/f>i/n?(p=n/f,h=n*h/f,f=n):(p=i/h,f=i*f/h,h=i):h>i||f>n?(p=Math.min(i/h,n/f),h=Math.floor(h*p),f=Math.floor(f*p)):(h<s||f<a)&&(p=Math.max(s/h,a/f),h=Math.floor(h*p),f=Math.floor(f*p));let m=Math.max(h,s),y=Math.max(f,a),g=(_,H)=>{if(typeof OffscreenCanvas=="function")return new OffscreenCanvas(_,H);{let Q=document.createElement("canvas");return Q.width=_,Q.height=H,Q}},b=g(m,y),E=m<h?h-m>>1:0,w=y<f?f-y>>1:0;b.getContext("2d").drawImage(t,E,w,h,f),h=m,f=y;let I=await Lk(b),C=I.size;wL.info("scaled to bytes: "+C);let G=.8;for(;C>r&&h>64&&f>64;){p*=G,h=h*G|0,f=f*G|0;let _=g(h,f);_.getContext("2d").drawImage(b,0,0,h,f);let Q=await Lk(_,"image/png"),j=I.size;if(o){let $=await Lk(_,"image/jpeg",.8),B=$.size;I=j<=B?Q:$,C=j<=B?j:B}else I=Q,C=j;wL.info("scaled to bytes: "+C)}return wL.info("final bytes: ",{size:C,width:h,height:f}),{dataURL:await zSe(I,"DataURL"),width:h,height:f,bytes:C}}async function zSe(t,e,r){return new Promise((i,n)=>{var s=new FileReader;if(e=="DataURL")s.readAsDataURL(t);else if(e=="ArrayBuffer")s.readAsArrayBuffer(t);else if(e=="Text")s.readAsText(t,r);else{n(new Error("invalid type"));return}s.onload=a=>i(s.result),s.onerror=a=>n(a)})}async function dW(t){let e=t&&t.text;if(!e)return t;let r=new fm;for(let i in e){let n=e[i],{d:s,bbox:a}=await r.getPath(n.name,{fontFamily:n.fontFamily,fontSize:n.fontSize,fontWeight:n.fontWeight?"bold":"normal",fontStyle:n.italic?"italic":"normal",underline:n.fontUnderline?"underline":"none",value:n.name});n.d||(n.d=s),n.cacheHeight=a.height(),n.cacheWidth=a.width();let{x:o,y:l,rotation:c,mirror:u,widthPercent:d,heightPercent:A}=n;if(Ir(A))continue;let{x:h,y:f}=ps.getTextOrigin(void 0,void 0,void 0,n),p=Ue.translate(h,f).scale(d,A).rotateD(-c);u&&(p=p.multiply3(Ue.MIRROR_X)),p=p.translate(o,l),n.matrix=nr.getMatrix6FromMatrix(p),delete n.x,delete n.y,delete n.widthPercent,delete n.heightPercent,delete n.mirror}return t}var iA=function(t){this._pathElement=t,this._list=this._parsePath(this._pathElement.getAttribute("d")),this._mutationObserverConfig={attributes:!0,attributeFilter:["d"]},this._pathElementMutationObserver=new MutationObserver(this._updateListFromPathMutations.bind(this)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)};iA.prototype.classname="SVGPathSegList";Object.defineProperty(iA.prototype,"numberOfItems",{get:function(){return this._checkPathSynchronizedToList(),this._list.length},enumerable:!0});iA.prototype._checkPathSynchronizedToList=function(){this._updateListFromPathMutations(this._pathElementMutationObserver.takeRecords())};iA.prototype._updateListFromPathMutations=function(t){if(this._pathElement){var e=!1;t.forEach(function(r){r.attributeName=="d"&&(e=!0)}),e&&(this._list=this._parsePath(this._pathElement.getAttribute("d")))}};iA.prototype.segmentChanged=function(t){this._writeListToPath()};iA.prototype.clear=function(){this._checkPathSynchronizedToList(),this._list.forEach(function(t){t._owningPathSegList=null}),this._list=[],this._writeListToPath()};iA.prototype.initialize=function(t){return this._checkPathSynchronizedToList(),this._list=[t],t._owningPathSegList=this,this._writeListToPath(),t};iA.prototype._checkValidIndex=function(t){if(isNaN(t)||t<0||t>=this.numberOfItems)throw"INDEX_SIZE_ERR"};iA.prototype.getItem=function(t){return this._checkPathSynchronizedToList(),this._checkValidIndex(t),this._list[t]};iA.prototype.insertItemBefore=function(t,e){return this._checkPathSynchronizedToList(),e>this.numberOfItems&&(e=this.numberOfItems),t._owningPathSegList&&(t=t.clone()),this._list.splice(e,0,t),t._owningPathSegList=this,this._writeListToPath(),t};iA.prototype.replaceItem=function(t,e){return this._checkPathSynchronizedToList(),t._owningPathSegList&&(t=t.clone()),this._checkValidIndex(e),this._list[e]=t,t._owningPathSegList=this,this._writeListToPath(),t};iA.prototype.removeItem=function(t){this._checkPathSynchronizedToList(),this._checkValidIndex(t);var e=this._list[t];return this._list.splice(t,1),this._writeListToPath(),e};iA.prototype.appendItem=function(t){return this._checkPathSynchronizedToList(),t._owningPathSegList&&(t=t.clone()),this._list.push(t),t._owningPathSegList=this,this._writeListToPath(),t};var Xr={};Xr.PATHSEG_UNKNOWN=0;Xr.PATHSEG_CLOSEPATH=1;Xr.PATHSEG_MOVETO_ABS=2;Xr.PATHSEG_MOVETO_REL=3;Xr.PATHSEG_LINETO_ABS=4;Xr.PATHSEG_LINETO_REL=5;Xr.PATHSEG_CURVETO_CUBIC_ABS=6;Xr.PATHSEG_CURVETO_CUBIC_REL=7;Xr.PATHSEG_CURVETO_QUADRATIC_ABS=8;Xr.PATHSEG_CURVETO_QUADRATIC_REL=9;Xr.PATHSEG_ARC_ABS=10;Xr.PATHSEG_ARC_REL=11;Xr.PATHSEG_LINETO_HORIZONTAL_ABS=12;Xr.PATHSEG_LINETO_HORIZONTAL_REL=13;Xr.PATHSEG_LINETO_VERTICAL_ABS=14;Xr.PATHSEG_LINETO_VERTICAL_REL=15;Xr.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS=16;Xr.PATHSEG_CURVETO_CUBIC_SMOOTH_REL=17;Xr.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS=18;Xr.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL=19;var vL="not implement",$A=function(t){this._string=t,this._currentIndex=0,this._endIndex=this._string.length,this._previousCommand=Xr.PATHSEG_UNKNOWN,this._skipOptionalSpaces()};$A.prototype._isCurrentSpace=function(){var t=this._string[this._currentIndex];return t<=" "&&(t==" "||t==`
`||t=="	"||t=="\r"||t=="\f")};$A.prototype._skipOptionalSpaces=function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex++;return this._currentIndex<this._endIndex};$A.prototype._skipOptionalSpacesOrDelimiter=function(){return this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&this._string.charAt(this._currentIndex)!=","?!1:(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)==","&&(this._currentIndex++,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)};$A.prototype.hasMoreData=function(){return this._currentIndex<this._endIndex};$A.prototype.peekSegmentType=function(){var t=this._string[this._currentIndex];return this._pathSegTypeFromChar(t)};$A.prototype._pathSegTypeFromChar=function(t){switch(t){case"Z":case"z":return Xr.PATHSEG_CLOSEPATH;case"M":return Xr.PATHSEG_MOVETO_ABS;case"m":return Xr.PATHSEG_MOVETO_REL;case"L":return Xr.PATHSEG_LINETO_ABS;case"l":return Xr.PATHSEG_LINETO_REL;case"C":return Xr.PATHSEG_CURVETO_CUBIC_ABS;case"c":return Xr.PATHSEG_CURVETO_CUBIC_REL;case"Q":return Xr.PATHSEG_CURVETO_QUADRATIC_ABS;case"q":return Xr.PATHSEG_CURVETO_QUADRATIC_REL;case"A":return Xr.PATHSEG_ARC_ABS;case"a":return Xr.PATHSEG_ARC_REL;case"H":return Xr.PATHSEG_LINETO_HORIZONTAL_ABS;case"h":return Xr.PATHSEG_LINETO_HORIZONTAL_REL;case"V":return Xr.PATHSEG_LINETO_VERTICAL_ABS;case"v":return Xr.PATHSEG_LINETO_VERTICAL_REL;case"S":return Xr.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS;case"s":return Xr.PATHSEG_CURVETO_CUBIC_SMOOTH_REL;case"T":return Xr.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS;case"t":return Xr.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL;default:return Xr.PATHSEG_UNKNOWN}};$A.prototype._nextCommandHelper=function(t,e){return(t=="+"||t=="-"||t=="."||t>="0"&&t<="9")&&e!=Xr.PATHSEG_CLOSEPATH?e==Xr.PATHSEG_MOVETO_ABS?Xr.PATHSEG_LINETO_ABS:e==Xr.PATHSEG_MOVETO_REL?Xr.PATHSEG_LINETO_REL:e:Xr.PATHSEG_UNKNOWN};$A.prototype.initialCommandIsMoveTo=function(){if(!this.hasMoreData())return!0;var t=this.peekSegmentType();return t==Xr.PATHSEG_MOVETO_ABS||t==Xr.PATHSEG_MOVETO_REL};$A.prototype._parseNumber=function(){var t=0,e=0,r=1,i=0,n=1,s=1,a=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)=="+"?this._currentIndex++:this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)=="-"&&(this._currentIndex++,n=-1),!(this._currentIndex==this._endIndex||(this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")&&this._string.charAt(this._currentIndex)!=".")){for(var o=this._currentIndex;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)this._currentIndex++;if(this._currentIndex!=o)for(var l=this._currentIndex-1,c=1;l>=o;)e+=c*(this._string.charAt(l--)-"0"),c*=10;if(this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)=="."){if(this._currentIndex++,this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)r*=10,i+=(this._string.charAt(this._currentIndex)-"0")/r,this._currentIndex+=1}if(this._currentIndex!=a&&this._currentIndex+1<this._endIndex&&(this._string.charAt(this._currentIndex)=="e"||this._string.charAt(this._currentIndex)=="E")&&this._string.charAt(this._currentIndex+1)!="x"&&this._string.charAt(this._currentIndex+1)!="m"){if(this._currentIndex++,this._string.charAt(this._currentIndex)=="+"?this._currentIndex++:this._string.charAt(this._currentIndex)=="-"&&(this._currentIndex++,s=-1),this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)t*=10,t+=this._string.charAt(this._currentIndex)-"0",this._currentIndex++}var u=e+i;if(u*=n,t&&(u*=Math.pow(10,s*t)),a!=this._currentIndex)return this._skipOptionalSpacesOrDelimiter(),u}};$A.prototype._parseArcFlag=function(){if(!(this._currentIndex>=this._endIndex)){var t=!1,e=this._string.charAt(this._currentIndex++);if(e=="0")t=!1;else if(e=="1")t=!0;else return;return this._skipOptionalSpacesOrDelimiter(),t}};$A.prototype.parseSegment=function(){var t=this._string[this._currentIndex],e=this._pathSegTypeFromChar(t);if(e==Xr.PATHSEG_UNKNOWN){if(this._previousCommand==Xr.PATHSEG_UNKNOWN||(e=this._nextCommandHelper(t,this._previousCommand),e==Xr.PATHSEG_UNKNOWN))return null}else this._currentIndex++;switch(this._previousCommand=e,e){case Xr.PATHSEG_MOVETO_REL:return["m",this._parseNumber(),this._parseNumber()];case Xr.PATHSEG_MOVETO_ABS:return["M",this._parseNumber(),this._parseNumber()];case Xr.PATHSEG_LINETO_REL:return["l",this._parseNumber(),this._parseNumber()];case Xr.PATHSEG_LINETO_ABS:return["L",this._parseNumber(),this._parseNumber()];case Xr.PATHSEG_LINETO_HORIZONTAL_REL:return["h",this._parseNumber()];case Xr.PATHSEG_LINETO_HORIZONTAL_ABS:return["H",this._parseNumber()];case Xr.PATHSEG_LINETO_VERTICAL_REL:return["v",this._parseNumber()];case Xr.PATHSEG_LINETO_VERTICAL_ABS:return["V",this._parseNumber()];case Xr.PATHSEG_CLOSEPATH:return this._skipOptionalSpaces(),["Z"];case Xr.PATHSEG_CURVETO_CUBIC_REL:{let r={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return["c",r.x1,r.y1,r.x2,r.y2,r.x,r.y]}case Xr.PATHSEG_CURVETO_CUBIC_ABS:{let r={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return["C",r.x1,r.y1,r.x2,r.y2,r.x,r.y]}case Xr.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:{let r={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return["s",r.x2,r.y2,r.x,r.y]}case Xr.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:{let r={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return["S",r.x2,r.y2,r.x,r.y]}case Xr.PATHSEG_CURVETO_QUADRATIC_REL:{let r={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return[vL,r.x,r.y,r.x1,r.y1]}case Xr.PATHSEG_CURVETO_QUADRATIC_ABS:{let r={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return["Q",r.x,r.y,r.x1,r.y1]}case Xr.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:return[vL,this._parseNumber(),this._parseNumber()];case Xr.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:return[vL,this._parseNumber(),this._parseNumber()];case Xr.PATHSEG_ARC_REL:{let r={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return[vL,r.x,r.y,r.x1,r.y1,r.arcAngle,r.arcLarge,r.arcSweep]}case Xr.PATHSEG_ARC_ABS:{let r={rx:this._parseNumber(),ry:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return["A",r]}default:throw"Unknown path seg type."}};var ZA=function(t){if(!t||t.length==0)return[];let e=[],r=new $A(t);if(!r.initialCommandIsMoveTo())return[];for(;r.hasMoreData();){let i=r.parseSegment();if(!i)return[];e.push(i)}return e};function ym(t){let e=[],r=0,i=0,n;for(let s of t){let a=s[0];switch(a){case"m":{e.push({op:"m",c:[r+s[1],i+s[2]]}),r=r+s[1],i=i+s[2];break}case"M":e.push({op:"m",c:s.slice(1)}),r=s[1],i=s[2];break;case"L":e.push({op:"l",c:s.slice(1)}),r=s[1],i=s[2];break;case"l":e.push({op:"l",c:[s[1]+r,s[2]+i]}),r=r+s[1],i=i+s[2];break;case"h":e.push({op:"l",c:[s[1]+r,i]}),r=r+s[1];break;case"v":e.push({op:"l",c:[r,s[1]+i]}),i=i+s[1];break;case"C":e.push({op:"c",c:s.slice(1)}),r=s[5],i=s[6];break;case"c":e.push({op:"c",c:[r+s[1],i+s[2],r+s[3],i+s[4],r+s[5],i+s[6]]}),r=r+s[5],i=i+s[6];break;case"S":Zn(a,s);break;case"s":{let o=r,l=i;["C","S"].includes(n[0])?(o=r-n.at(-2)+r,l=i-n.at(-1)+i):["c","s"].includes(n[0])&&(o=r+n.at(-2),l=i+n.at(-1)),e.push({op:"c",c:[o,l,r+s[1],i+s[2],r+s[3],i+s[4]]}),r=r+s[3],i=i+s[4];break}case"Q":{e.push({op:"c",c:[r,i,s[1],s[2],s[3],s[4]]}),r=s[3],i=s[4];break}case"A":{let o=mm({x1:r,y1:i,x2:s[1].x,y2:s[1].y,rx:s[1].rx,ry:s[1].ry,angle:s[1].arcAngle,sweep:s[1].arcSweep?1:0,large:s[1].arcLarge?1:0}),l=ZA(o);l.shift(),e.push(...ym(l)),r=s[1].x,i=s[1].y;break}case"Z":e.push({op:"h",c:[]});break;default:Zn(a,s,"Plz check code");break}n=s}return e}function CL(t){if(!t.includes("A"))return t;let e=ZA(t),r=ym(e),i=[];for(let n of r)switch(n.op){case"m":i.push("M",...n.c);break;case"c":i.push("C",...n.c);break;case"l":i.push("L",...n.c);break;default:Zn(n);break}return i.join(" ")}function py(t){let e=typeof t=="string"?t.replace(/\s+/g,""):t;return e==="6,6"||+e==1?{key:1,text:"dashed",value:"6,6",i18nText:"dashed"}:e==="3,10"||+e==2?{key:2,text:"dotted",value:"3,10",i18nText:"dotted"}:e==="4,2,1,2"||+e==3?{key:3,text:"dotdashed",value:"4,2,1,2",i18nText:"dotdashed"}:{key:0,text:"solid",value:"0",i18nText:"solid"}}function AW(){let t=["0","6,6","3,10","4,2,1,2"],e=[];for(let r of t)e.push(py(r));return e}function SL(t){let{color:e,fillColor:r,shape:i}=t;return`:root {
		--highlight: ${e.highlight};
		--selectColor: ${e.select};
		--auxiliaryLineColor: ${e.auxiliaryLine};
		--auxiliaryLineDashArray: ${i.auxiliaryLine.dash};
		--auxiliaryPointFillColor: ${r.auxiliaryPoint};
		--dimensionLabelColor: ${e.dimensionLabel};
		--dimensionConstraintColor: ${e.dimensionConstraint};
		--gridColor: ${e.grid};
		--normalDimensionColor: ${e.normalDimension};
	}`}var $a=class{static decHead(e){return delete e.orderWidth,delete e.orderHeight,{...e}}static decDetail(e){let{title:r,docType:i=pC.PANEL,description:n,display_title:s}=e;return{title:r,display_title:s||r,docType:i,desc:n}}static decPoly(e,r){let i,{ploys:n}=r;if(n.length===1){let s=n[0];switch(s[0]){case"R":i=this.decRect(e,r);break;case"ELLIPSE":i=this.decEllipse(e,r);break;case"M":s[3]==="A"||s[3]==="CA"?i=this.decArc(e,r):i=this.decPolyGroup(e,r);break;default:i=this.decPolyGroup(e,r)}}else i=this.decPolyGroup(e,r);return i}static decEllipse(e,r){let{layer:i,rotation:n,strokeColor:s,strokeWidth:a,fillColor:o,opacity:l,displayFill:c,displayStroke:u,strokeStyle:d,groupId:A}=r,{locked:h,visible:f,name:p,valid:m,cover:y,transScope:g}=r,b=this.decTransform(r.matrix),{transparencyPrint:E,transparencyWhite:w}=this.getTransparencyPrintAndTransparencyWhite(r),x={gId:e,layer:i,rotation:n,strokeWidth:a,strokeStyle:this.getStrokeStyleNumber(d),strokeColor:s,fillColor:o,opacity:l,displayFill:c,displayStroke:u,matrix:b,zIndex:this.getZIndexOrDefault(r),cover:!!y,hide:!m,scope:this.getScope(g),isWhiteBackground:!1,transparencyPrint:E,transparencyWhite:w,cmdKey:"ellipse",name:p,locked:h,visible:f};return this.fixedShape(x,A),x}static getScope(e){let r=1;switch(e){case Kd.PRINT_AND_COVER:r=1;break;case Kd.PRINT:r=2;break;case Kd.COVER:r=3;break;default:}return r}static getTransparencyPrintAndTransparencyWhite(e){let r=0,i=0,{transScope:n,transPrint:s,transWhite:a,opacity:o}=e;switch(n){case Kd.PRINT_AND_COVER:r=1-(s!==void 0?s:o),i=1-(a!==void 0?a:1);break;case Kd.PRINT:r=1-(s!==void 0?s:1),i=1-(a!==void 0?a:o);break;case Kd.COVER:r=1-(s!==void 0?s:o),i=1-(a!==void 0?a:o);break;default:}return{transparencyPrint:r,transparencyWhite:i}}static decArc(e,r){let{layer:i,rotation:n,strokeColor:s,strokeWidth:a,fillColor:o,opacity:l,displayFill:c,displayStroke:u,strokeStyle:d,groupId:A,ploys:h}=r,{valid:f,locked:p,visible:m,name:y,cover:g,transScope:b}=r,[,E,w,x,I,C,G,U,_,H,Q]=h[0],j=this.decTransform(r.matrix),{transparencyPrint:$,transparencyWhite:B}=this.getTransparencyPrintAndTransparencyWhite(r),M={layer:i,rotation:-n,strokeWidth:a,strokeStyle:this.getStrokeStyleNumber(d),strokeColor:s,fillColor:o,opacity:l,displayFill:c,displayStroke:u,x1:E,y1:-w,rx:I,ry:C,angle:G,large:U,sweep:_,x2:H,y2:-Q,cover:!!g,type:x==="CA"?1:2,matrix:j,hide:!f,gId:e,locked:p,visible:m,zIndex:this.getZIndexOrDefault(r),scope:this.getScope(b),isWhiteBackground:!1,transparencyPrint:$,transparencyWhite:B,cmdKey:"arc",name:y};return this.fixedShape(M,A),M}static decRect(e,r){let{layer:i,rotation:n,strokeColor:s,strokeWidth:a,fillColor:o,opacity:l,displayFill:c,displayStroke:u,strokeStyle:d,groupId:A,ploys:h}=r,{cover:f,valid:p,visible:m,locked:y,transScope:g,name:b}=r;if(o.startsWith("data:")||o.startsWith("blob:")||o.length>20)return this.decObj(e,r);{let{transparencyPrint:E,transparencyWhite:w}=this.getTransparencyPrintAndTransparencyWhite(r),x=this.decTransform(r.matrix),I=h[0],C={gId:e,name:b,layer:i,rotation:-n,strokeWidth:a,strokeStyle:this.getStrokeStyleNumber(d),strokeColor:s,fillColor:o,opacity:l,rx:I[5],ry:I[6],displayFill:c,displayStroke:u,matrix:x,cover:!!f,hide:!p,locked:y,visible:m,transparencyPrint:E,transparencyWhite:w,zIndex:this.getZIndexOrDefault(r),scope:this.getScope(g),isWhiteBackground:!1,cmdKey:"rect"};return this.fixedShape(C,A),C}}static handleBlobUrl(e){return/^blob:(.+)$/.exec(e)}static decObj(e,r){var n;let{fillColor:i}=r;if(i){let s=(n=this.handleBlobUrl(i))==null?void 0:n[1];if(s)return(async()=>{var l;this.imageHashMap.set(e,s);let a=this.imageDataMap.get(s),o=a||((l=(await X.windowBridge.rpcCall(Yi.BLOB.GET,[s,X.currentProject.projectId],ur())).message)==null?void 0:l.content);return o&&!a&&(o=await this.resize(o),this.imageDataMap.set(s,o)),this.decodeObjSync(e,r,o)})();if(i.startsWith("data:"))return(async()=>{let a=await this.resize(i);return this.decodeObjSync(e,r,a)})();if(i.length>20){this.imageHashMap.set(e,i);let a=this.imageDataMap.get(i)||i;return this.decodeObjSync(e,r,a)}}}static decPolyGroup(e,r){let{layer:i,rotation:n,strokeColor:s,strokeWidth:a,fillColor:o,opacity:l,displayFill:c,displayStroke:u,strokeStyle:d,groupId:A,ploys:h}=r,{cover:f,valid:p,visible:m,locked:y,name:g,transScope:b}=r,E=this.decTransform(r.matrix),w=this.decMultiPoly(h).d,{transparencyPrint:x,transparencyWhite:I}=this.getTransparencyPrintAndTransparencyWhite(r),C={layer:i,rotation:-n,strokeWidth:a,strokeStyle:this.getStrokeStyleNumber(d),strokeColor:s,fillColor:o,opacity:l,d:CL(w),displayFill:c,displayStroke:u,matrix:E,hide:!p,gId:e,locked:y,visible:m,zIndex:this.getZIndexOrDefault(r),cover:!!f,scope:this.getScope(b),isWhiteBackground:!1,transparencyPrint:x,transparencyWhite:I,cmdKey:"group",name:g};return this.fixedShape(C,A),C}static decString(e,r){return(async()=>{let{layer:n,rotation:s,fontFamily:a,fontSize:o,fontWeight:l,italic:c,underline:u,strikeout:d,strokeColor:A,align:h,opacity:f,value:p,groupId:m,cover:y,transScope:g}=r,{valid:b,locked:E,visible:w,path:x}=r,I=this.decTransform(r.matrix),C=x?this.decFontCache(x):{},{vAlign:G,hAlign:U}=this.getAlign(h),{transparencyPrint:_,transparencyWhite:H}=this.getTransparencyPrintAndTransparencyWhite(r),Q={layer:n,rotation:-s,key:p,name:p,fontFamily:a,fontSize:o,fontWeight:!!l,italic:c,underline:u,vAlign:G,hAlign:U,strokeColor:A,opacity:f,d:"",cacheHeight:0,cacheWidth:0,matrix:I,cover:!!y,hide:!b,gId:e,locked:E,visible:w,...C,zIndex:this.getZIndexOrDefault(r),scope:this.getScope(g),isWhiteBackground:!1,transparencyPrint:_,transparencyWhite:H,cmdKey:"text"};return await this.fixStringPath(Q),this.fixedShape(Q,m),Q})()}static decDimension(e,r){let{layer:i,dimensionType:n,relationIds:s,controlDot:a,locked:o,visible:l,name:c,rotation:u}=r,d=new Array,A=a;for(let p=0;p<A.length-1;p+=2)d.push(new ne(A[p],A[p+1]));let h=s,f;switch(n){case"LENGTH-CONSTRAINT":case"LENGTH-MEASUREMENT":{let[p,m,y,g]=d,b=p.x===m.x?"x":p.y===m.y?"y":"xy",E=this.getDimCategory(n);f={name:c,gId:e,cmdKey:"dimension",layer:i,category:E,direction:b,start:{id:h[0],index:0,cmdKey:"",primitivePoint:{x:p.x,y:-p.y},otherPoint:{x:m.x,y:-m.y}},end:{id:h[1],index:0,cmdKey:"",otherPoint:{x:y.x,y:-y.y},primitivePoint:{x:g.x,y:-g.y}},visible:l,locked:o,rotation:u,zIndex:this.getZIndexOrDefault(r)};break}case"RADIUS-MEASUREMENT":{let[p,m,y]=d;f={name:c,gId:e,cmdKey:"dimensionRadius",layer:i,x1:p.x,y1:-p.y,x2:m.x,y2:-m.y,textX:y.x,textY:-y.y,locked:o,visible:l,ellipseId:h[0],rotation:u,zIndex:this.getZIndexOrDefault(r)};break}case"ANGLE":{let[p,m,y,g]=d;f={name:c,gId:e,cmdKey:"dimensionAngle",layer:i,x1:p.x,y1:-p.y,angleX:m.x,angleY:-m.y,x2:y.x,y2:-y.y,textX:g.x,textY:-g.y,locked:o,visible:l,rotation:u,zIndex:this.getZIndexOrDefault(r)};break}case"LENGTH":{let[p,m,y,g]=d,b=p.x===m.x?"x":p.y===m.y?"y":"xy";f={name:c,gId:e,cmdKey:"dimensionLength",layer:i,x1:p.x,y1:-p.y,measureX1:m.x,measureY1:-m.y,measureX2:y.x,measureY2:-y.y,x2:g.x,y2:-g.y,direction:b,locked:o,visible:l,rotation:u,zIndex:this.getZIndexOrDefault(r)};break}}return this.fixedShape(f),f}static decBlob(e,r){let{content:i}=r;this.imageDataMap.set(e,i)}static decAuxLine(e,r){let{layer:i,visible:n,locked:s,name:a,x:o,y:l,rotation:c,strokeStyle:u,strokeWidth:d,color:A,groupId:h,length:f}=r,p;return f===0?p={gId:e,cmdKey:"auxiliaryPoint",visible:n,name:a,layer:i,x:o,y:-l,fillColor:this.decAuxColor(A),locked:s,zIndex:this.getZIndexOrDefault(r)}:(p={gId:e,name:a,cmdKey:"auxiliaryLine",layer:i,x:o,y:-l,rotation:c,strokeStyle:this.getStrokeStyleNumber(u),strokeColor:this.decAuxColor(A),locked:s,visible:n,x1:0,x2:0,y1:0,y2:0,zIndex:this.getZIndexOrDefault(r)},this.prepareX1Y1ForAuxiliaryLine(p)),this.fixedShape(p,h),p}static decGroup(e,r){let{parentId:i,title:n,visible:s,locked:a}=r,o=e,l=i,c=n,u=i!="0"&&i,d={gId:o,name:c,locked:a,visible:s,cmdKey:"combination",parent:u?l:null,combinations:[],elements:[]};return this.fixedShape(d),d}static decAuxColor(e){if(e!==null)return e===""?null:e}static getDimCategory(e){switch(e){case"LENGTH-MEASUREMENT":return"Annotation";case"LENGTH-CONSTRAINT":return"Constraint";default:throw new Error(`unknown dimension type ${JSON.stringify(e)}`)}}static decFontCache(e){let{bbox:r,d:i}=this.decMultiPoly(e);return{d:i,cacheWidth:r.width(),cacheHeight:r.height()}}static decMultiPoly(e){let r=new pr,i=e.map(n=>{let s="";return new pu(a=>(r.ext1(a.bbox()),s=new Ku().encPl(a).toString(),!1),!0).parse("M"+n.join(" ")),s}).join(" ");return{bbox:r.build(),d:i}}static prepareX1Y1ForAuxiliaryLine(e){let r=sb(e.x,e.y,e.rotation);e.x1=r.start().x,e.y1=r.start().y,e.x2=r.end().x,e.y2=r.end().y}static async fixStringPath(e){let{d:r,bbox:i}=await this.lf.getPath(e.name,{fontFamily:e.fontFamily,fontSize:e.fontSize,fontWeight:e.fontWeight?"bold":"normal",fontStyle:e.italic?"italic":"normal",underline:e.underline?"underline":"none",value:e.name});e.d||(e.d=r),e.cacheHeight=i.height(),e.cacheWidth=i.width();let{x:n,y:s,rotation:a,mirror:o,widthPercent:l,heightPercent:c}=e;if(Ir(c))return;let{x:u,y:d}=ps.getTextOrigin(void 0,void 0,void 0,e),A=Ue.translate(u,d).scale(l,c).rotateD(-a);o&&(A=A.multiply3(Ue.MIRROR_X)),A=A.translate(n,s),e.matrix=nr.getMatrix6FromMatrix(A),delete e.x,delete e.y,delete e.widthPercent,delete e.heightPercent,delete e.mirror}static fixedShape(e,r){let{cmdKey:i,gId:n}=e;i!=="combination"&&(typeof e.hide!="boolean"&&(e.hide=!1),typeof e.visible!="boolean"&&(e.visible=!0),typeof e.locked!="boolean"&&(e.locked=!1),typeof e.layer!="number"&&(e.layer=1),typeof e.opacity!="number"&&(e.opacity=1),typeof e.cover!="boolean"&&(e.cover=!1),typeof e.scope!="number"&&(e.scope=1),typeof e.name!="string"&&(e.name=""),!e.matrix&&!["group","arc","dimensionLength","dimensionAngle"].includes(i)&&(e.matrix=[1,0,0,1,0,0]))}static decTransform(e){let[r,i,n,s,a,o]=e||[1,0,0,1,0,0],l=new Ue([r,s,0,i,a,0,n,o,1]);return l=Ue.MIRROR_Y.multiply3(l).multiply3(Ue.MIRROR_Y),this.matrix2svg(l)}static resize(e){let r=X.uploadSvgFileMaxMB*1048576;if(!(a=>(a.length-30)*.75>r)(e))return e;let n=!(typeof window=="object"&&typeof document=="object")&&typeof importScripts=="function",s={bytesLimit:r,maxWidth:2160,maxHeight:2160};return(async()=>n?(await X.messageBus.rpcCall("/panel/resizeImageFromURL",[e,s])).message.dataURL:(await mE(e,s)).dataURL)()}static decodeObjSync(e,r,i){let{layer:n,rotation:s,opacity:a,locked:o,valid:l,groupId:c,visible:u,name:d,cover:A}=r,h=this.decTransform(r.matrix),f={gId:e,layer:n,rotation:-s,content:i,opacity:a,locked:o,matrix:h,cover:!!A,hide:!l,cmdKey:"obj",name:d,visible:u,zIndex:this.getZIndexOrDefault(r)};return this.fixedShape(f,c),f}static matrix2svg(e){let[r,i,n,s,a,o,l,c,u]=e.data;return[r,i,s,a,l,c]}static getZIndexOrDefault(e){return e.zIndex||0}static getStrokeStyleNumber(e){switch(e){case Jf.SOLID:return 0;case Jf.SHORT_DASH:return 1;case Jf.DOT:return 2;case Jf.DOT_DASH:return 3}}static getAlign(e){let r={hAlign:0,vAlign:2};switch(e){case yl.LEFT_TOP:r.hAlign=0,r.vAlign=0;break;case yl.CENTER_TOP:r.hAlign=1,r.vAlign=0;break;case yl.RIGHT_TOP:r.hAlign=2,r.vAlign=0;break;case yl.LEFT_MIDDLE:r.hAlign=0,r.vAlign=1;break;case yl.CENTER_MIDDLE:r.hAlign=1,r.vAlign=1;break;case yl.RIGHT_MIDDLE:r.hAlign=2,r.vAlign=1;break;case yl.LEFT_BOTTOM:r.hAlign=0,r.vAlign=2;break;case yl.CENTER_BOTTOM:r.hAlign=1,r.vAlign=2;break;case yl.RIGHT_BOTTOM:r.hAlign=2,r.vAlign=2;break}return r}};$a.lf=new fm,$a.imageHashMap=new Map,$a.imageDataMap=new Map;var gd=class{static uploadDeleteById(e,r){switch(r||(r=te.getById(e).cmdKey),r){case"auxiliaryLine":case"auxiliaryPoint":{te.compilerManager.deleteAuxLine(e);break}case"arc":case"obj":case"rect":case"group":case"ellipse":{te.compilerManager.deletePoly(e);break}case"text":te.compilerManager.deleteString(e);break;case"combination":te.compilerManager.deleteGroup(e);break;case"dimension":case"dimensionAngle":case"dimensionLength":case"dimensionRadius":te.compilerManager.deleteDimension(e);break}}static applyRemoteDelete(e){e.forEach(n=>this.beUploadDeleteMap.set(n,te.getById(n).json));let r=e.map(n=>Fe(n)).filter(n=>n);if(!r.length)return;fd(r,!0).forEach(n=>{e.includes(n.gId)||this.uploadDeleteById(n.gId,n.cmdKey)})}static updateRecord(e,r){let i=e.at(-1),n=e.at(-2),s=te.getById(e[1]).json,a=this.beUploadDeleteMap.get(e[1]);return(Kr(s)||!s)&&!Kr(i)&&!Kr(n)&&a&&(e=[...e],r==="undo"?(e[e.length-1]={},e[e.length-2]={...a,...n}):(e[e.length-1]={...a,...i},e[e.length-2]={})),e}};gd.beUploadDeleteMap=new Map;var ef=class{static uploadData(e,r,i=te.compilerManager){switch(e==="canvas"?"canvas":(r==null?void 0:r.cmdKey)||te.getById(e).cmdKey){case"canvas":{let s=this.getCanvasData(r);s&&i.uploadCanvas(s);break}case"auxiliaryLine":case"auxiliaryPoint":{let s=this.getAuxLineData(e,r);s&&i.uploadAuxLine(e,s);break}case"obj":r=this.uploadObjContent(e,i,r);case"arc":case"rect":case"group":case"ellipse":{let s=this.getPolyData(e,r);s&&i.uploadPoly(e,s);break}case"text":{let s=this.getStringData(e,r);s&&i.uploadString(e,s);break}case"combination":{let s=this.getGroup(e,r);i.uploadGroup(e,s);break}case"dimension":case"dimensionAngle":case"dimensionLength":case"dimensionRadius":{let s=this.getDimensionData(e,r);s&&i.uploadDimension(e,s);break}}}static uploadJsonCache(e,r){let i=te.exchangeJsonCache(r);if(this.uploadData("canvas",r.head,e),te.iterator(n=>{let s=n.gId;this.uploadData(s,n,e)}),i(),e instanceof hP)return e.save()}static uploadJsonCache2(e){let r=te.gJsonCache,i=new Map;TL(r.head,e.head)||i.set("canvas",e.head),Y0.forEach(s=>{let a=[];Object.keys(r[s]).forEach(o=>{TL(e[s][o],r[s][o])?a.push(o):i.set(o,s)}),Object.keys(e[s]||{}).forEach(o=>{a.includes(o)||i.set(o,e[s][o])})});let n=te.exchangeJsonCache(e);i.forEach((s,a)=>{typeof s=="object"?this.uploadData(a,s):gd.uploadDeleteById(a,s)}),n()}static uploadObjContent(e,r,i){i||(i=vi(te.getById(e).json));let{content:n,gId:s}=i,a=$a.imageHashMap.get(e);if(a)i.content="blob:"+a;else if(n.startsWith("data:")){let o=r.uploadBlob("",n);o.success&&(i.content="blob:"+o.hash)}return i}static getAuxLineData(e,r){let{json:i}=te.getById(e);if(r&&(i=r),Kr(i))return;let{layer:n,x:s,y:a,rotation:o=0,strokeColor:l,fillColor:c,strokeStyle:u,locked:d,visible:A,name:h,zIndex:f}=i;return{groupId:this.getCombinationId(e),layer:n,x:s,y:-a,rotation:o,strokeWidth:0,strokeStyle:this.getStrokeStyle(u),color:XSe(l||c),length:i.cmdKey==="auxiliaryPoint"?0:100,locked:d,visible:A,cover:0,name:h,zIndex:f}}static uploadCombination(e,r){(e.name!==r.name||e.parent!==r.parent||e.locked!==r.locked||e.visible!==r.visible)&&this.uploadData(e.gId),this.getArrayDifference(e.elements,r.elements).forEach(s=>{this.uploadData(s)}),this.getArrayDifference(e.combinations,r.combinations).forEach(s=>this.uploadData(s))}static getArrayDifference(e=[],r=[]){return e.sort().join(",")!==r.sort().join(",")?[...new Set(e.concat(r))].filter(n=>!e.includes(n)||!r.includes(n)):[]}static getCanvasData(e){let r=e||te.gJsonCache.head,{name:i,material:n,thickness:s,print:a,craft:o,desc:l,coverColor:c,backgroundColor:u,width:d,height:A,originX:h,originY:f}=r,{width:p,height:m}=te.getProductWidthHeight();return{material:n,thickness:s,print:a,craft:o,desc:l,coverColor:c,backgroundColor:u,width:d,height:A,originX:h,originY:f,orderWidth:p,orderHeight:m}}static getPolyData(e,r){let i=te.getById(e).json;if(r&&(i=r),Kr(i))return;let{layer:n,rotation:s,strokeWidth:a,strokeColor:o,strokeStyle:l,opacity:c,locked:u,hide:d,cmdKey:A,zIndex:h}=i,{visible:f,cover:p,name:m,transparencyPrint:y,transparencyWhite:g,matrix:b,displayFill:E,displayStroke:w,scope:x}=i,{fillColor:I}=i,C;switch(A){case"rect":C=[["R",0,0,1,1,i.rx,i.ry,0,0]];break;case"arc":let{x1:U,y1:_,type:H,rx:Q,ry:j,angle:$,large:B,sweep:M,x2:v,y2:N}=i,R="A";H===1&&(R="CA"),C=[["M",U,-_,R,Q,j,$,B,M,v,-N]];break;case"ellipse":C=[["ELLIPSE",0,0,1,1,0,0]];break;case"group":C=fW(i.d);break;case"obj":let{content:q}=i;C=[["R",0,0,1,1,0,0,0,0]];let P=$a.imageHashMap.get(e);I=P?"blob:"+P:q}return{groupId:this.getCombinationId(e),layer:n,rotation:-s,strokeWidth:a,strokeStyle:this.getStrokeStyle(l),strokeColor:o,fillColor:I,opacity:c,autoClose:!1,ploys:C,displayFill:E,displayStroke:w,locked:u,zIndex:h,valid:!d,visible:f,cover:Number(p),name:m,transScope:this.getScope(x),transPrint:1-y,transWhite:1-g,matrix:pW(b)}}static getStringData(e,r){let i=te.getText(e);if(r&&(i=r),Kr(i))return;let{layer:n,rotation:s,fontFamily:a,fontSize:o,fontWeight:l,italic:c,underline:u,hAlign:d,vAlign:A,strokeColor:h,zIndex:f}=i,{opacity:p,locked:m,hide:y,visible:g,cover:b,transparencyPrint:E,transparencyWhite:w,matrix:x,name:I,d:C,scope:G}=i;return{groupId:this.getCombinationId(e),layer:n,rotation:-s,value:I,fontFamily:a,fontSize:o,fontWeight:Number(l),italic:c,underline:u,strikeout:!1,align:this.getAlign(d,A),strokeColor:h,opacity:p,locked:m,zIndex:f,valid:!y,visible:g,cover:Number(b),name:I,transScope:this.getScope(G),transPrint:1-E,transWhite:1-w,matrix:pW(x),strokes:!1,path:fW(C)}}static getGroup(e,r){let i=te.getCombination(e);if(r&&(i=r),Kr(i))return;let{parent:n,name:s,visible:a,locked:o}=i;return{parentId:n||"0",title:s,visible:a,locked:o}}static getDimensionData(e,r){let{json:i}=te.getById(e);r&&(i=r);let n,s,a;switch(i.cmdKey){case"dimension":{let{start:p,end:m}=i,y=p.primitivePoint,g=p.otherPoint,b=m.otherPoint,E=m.primitivePoint;s=[p.id,m.id],a=qSe(i),n=[y.x,-y.y,g.x,-g.y,b.x,-b.y,E.x,-E.y];break}case"dimensionAngle":{s=[],a="ANGLE",n=[i.x1,-i.y1,i.angleX,-i.angleY,i.x2,-i.y2,i.textX,-i.textY];break}case"dimensionLength":{s=[],a="LENGTH",n=[i.x1,-i.y1,i.measureX1,-i.measureY1,i.measureX2,-i.measureY2,i.x2,-i.y2];break}case"dimensionRadius":{s=[i.ellipseId],a="RADIUS-MEASUREMENT",n=[i.x1,-i.y1,i.x2,-i.y2,i.textX,-i.textY];break}}let{layer:o,locked:l,visible:c,name:u,zIndex:d,hide:A,rotation:h}=i;return Kr(i)?void 0:{layer:o,dimensionType:a,unit:"",strokeWidth:0,accuracy:0,controlDot:n,relationIds:s,locked:l,zIndex:d,visible:c,cover:0,name:u,valid:!A,rotation:h}}static getCombinationId(e){let r=Object.values(te.gJsonCache.combination).find(i=>i.elements.includes(e));return r?r.gId:"0"}static getStrokeStyle(e){switch(e){case 0:return Jf.SOLID;case 1:return Jf.SHORT_DASH;case 2:return Jf.DOT;case 3:return Jf.DOT_DASH}}static getAlign(e,r){switch(`${e}${r}`){case"00":return yl.LEFT_TOP;case"10":return yl.CENTER_TOP;case"20":return yl.RIGHT_TOP;case"01":return yl.LEFT_MIDDLE;case"11":return yl.CENTER_MIDDLE;case"21":return yl.RIGHT_MIDDLE;case"02":return yl.LEFT_BOTTOM;case"12":return yl.CENTER_BOTTOM;case"22":return yl.RIGHT_BOTTOM}}static getScope(e){let r=Kd.PRINT_AND_COVER;switch(e){case 1:r=Kd.PRINT_AND_COVER;break;case 2:r=Kd.PRINT;break;case 3:r=Kd.COVER;break;default:}return r}};function fW(t){let e=new Array;return new pu(r=>(e.push(new Ku(!0).encPl(r).toArray().slice(1)),!0),!0).parse(t),e}function pW(t){if(!t)return[1,0,0,1,0,0];let[e,r,i,n,s,a]=t,o=new Ue([e,r,0,i,n,0,s,a,1]);o=Ue.MIRROR_Y.multiply3(o).multiply3(Ue.MIRROR_Y);let[l,c,u,d,A,h,f,p,m]=o.data;return[l,d,f,c,A,p]}function XSe(t){return typeof t=="string"?String(t):t}function qSe(t){switch(t.category){case"Annotation":return"LENGTH-MEASUREMENT";case"Constraint":return"LENGTH-CONSTRAINT";default:throw new Error(`dimension category ${JSON.stringify(t.category)} not supported`)}}function TL(t,e){if(t===e||Number.isNaN(t)&&Number.isNaN(e))return!0;if(t===null||e===null||typeof t!="object"||typeof e!="object")return t===e;if(t.constructor!==e.constructor)return!1;if(t instanceof Date)return t.getTime()===e.getTime();if(t instanceof RegExp)return t.toString()===e.toString();if(Array.isArray(t)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!TL(t[n],e[n]))return!1;return!0}let r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(let n of r)if(!i.includes(n)||!TL(t[n],e[n]))return!1;return!0}var my=class{static getInitMetaData(e){let r={gId:"",cmdKey:e,visible:!0,name:"",layer:1,locked:!1,zIndex:this.getDefaultZIndex()};return e==="combination"&&delete r.layer,r}static getInitCommonData(){return{matrix:[1,0,0,1,0,0],cover:!0,hide:!1,opacity:1,rotation:0,scope:1,isWhiteBackground:!1,transparencyPrint:1,transparencyWhite:1}}static getDefaultZIndex(){return this.maxZIndex++,this.maxZIndex}static getInitStrokeStyle(){return{strokeColor:"#000000",strokeStyle:0,strokeWidth:0,fillColor:"none",displayStroke:!0,displayFill:!0}}static getInitialRectData(e){return{rx:0,ry:0,...this.getInitMetaData("rect"),...this.getInitCommonData(),...this.getInitStrokeStyle(),...e}}static getInitialTextData(e){return{cacheHeight:39.37007874015748,cacheWidth:137.79527559055117,d:"",fontSize:0,key:"",hAlign:0,vAlign:0,strokeColor:"#000000",underline:!1,italic:!1,fontWeight:!1,fontFamily:"\u9ED1\u4F53",...this.getInitMetaData("text"),...this.getInitCommonData(),...e}}static getInitialImageData(e){return{x:0,y:0,width:1,height:1,content:"",...this.getInitMetaData("obj"),...this.getInitCommonData(),...e}}static getInitialEllipseData(e){return{...this.getInitMetaData("ellipse"),...this.getInitCommonData(),...this.getInitStrokeStyle(),...e}}static getInitialGroupData(e){return{d:"",...this.getInitMetaData("group"),...this.getInitCommonData(),...this.getInitStrokeStyle(),...e}}static getInitialArcData(e){return{...this.getInitMetaData("arc"),...this.getInitCommonData(),...this.getInitStrokeStyle(),type:2,x1:0,y1:0,rx:0,ry:0,angle:0,large:1,sweep:1,x2:0,y2:0,...e}}static getInitialAuxiliaryLineData(e){return{...this.getInitMetaData("auxiliaryLine"),rotation:0,x1:0,x2:0,y1:0,y2:0,x:0,y:0,strokeColor:void 0,strokeStyle:null,layer:8,...e}}static getInitialAuxiliaryPointData(e){return{x:0,y:0,fillColor:void 0,visible:!0,...this.getInitMetaData("auxiliaryPoint"),layer:8,...e}}static getInitialCombinationData(e){return{...this.getInitMetaData("combination"),parent:null,combinations:[],elements:[],name:"",...e}}};my.maxZIndex=0;var gy=class{static ready(){tr.started=!0}static draw(e,r,i){let n=tr;i&&(this.setOrigin(e,r),n.dots.length=0,n.restart())}static setOrigin(e,r,i=!0){let n=e-zt.canvas.originX,s=r-zt.canvas.originY;ja().setOriginXY({x:n,y:s}),i&&mr.save(["originXY","set.origin",{offsetX:n,offsetY:s}])}static end(){fc()}};var JS={maxId:0,name:"name",material:"acrylic",thickness:"0.8mm",craft:"Transparent",desc:"",width:"393mm",height:"579mm",title:"",display_title:"",coverColor:"white",print:"Bottom Side"},IL=class{constructor(){this.canMergeData=!0;this.task=[];this.groupElementsMap=new Map;this.fixDimensionMap=new Map;this.groupCombinationMap=new Map;this.mergeDataMap=new Map;this.jsonCache=te.getDefaultGJsonCache()}addTask(e){this.task.push(e),this.task.length===1&&(this.decodeStatus=this.decoderTask())}async decoderTask(){try{for(await this.awaitTime();this.task.length>0;){let e=this.task[0],{data:r,id:i,number:n}=e;if(r)try{await this.onChange(e)}catch(s){console.error(e,s)}else n?this.onChangeNum(i,n):this.onDelete(i);this.task.shift()}this.mergeDataToJsonCache()}catch(e){console.log(e)}finally{return Promise.resolve()}}awaitTime(){return this.awaitTime=function(){return new Promise(e=>setTimeout(()=>e(void 0)))},new Promise(e=>e(void 0))}async onChange(e){let{type:r,id:i,data:n,client:s,number:a,hash:o}=e;if(r==="detail"){let l=$a.decDetail(n);this.addMergeData("detail",l)}else if(r==="canvas"){let l=$a.decHead(n);this.addMergeData("canvas",l)}else r==="group"?this.handleGroupData(e):await this.handleShapeData(e)}mergeDataToJsonCache(){if(!this.mergeDataMap.size||!this.canMergeData)return;let e=this.jsonCache===te.gJsonCache;this.exchangeMgrJsonCache(()=>{let r=[],i=[];this.mergeDataMap.forEach((n,s)=>{if(!this.verifyData(n))return;let a=this.getOldData(s);if(!n)r.push(s);else if(this.isDifferObject(n,a)){let o=n.cmdKey?n.cmdKey:s;i.push({cmdKey:o,data:n}),this.addDataToJsonCache(o,n)}}),this.mergeDataMap.clear(),this.setItemOrderArr(),e&&(i.forEach(({cmdKey:n,data:s})=>{this.renderData(n,s)}),this.handleDeleteStroke(r),gd.applyRemoteDelete(r),this.refreshSelected(i),Et("panel_updateAttrPanel"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)),this.deleteJsonCacheData(r)})}async handleShapeData(e){let{type:r,id:i,data:n,client:s,number:a,hash:o}=e,l;switch(r){case"dimension":l=$a.decDimension(i,n);break;case"string":l=await $a.decString(i,n);break;case"poly":l=await $a.decPoly(i,n);break;case"auxLine":l=$a.decAuxLine(i,n);break;case"blob":this.handleBlob(o,n);return}l.id=this.numberToId(a),my.maxZIndex=Math.max(l.zIndex,my.maxZIndex);let c=n.groupId=="0"?void 0:n.groupId,u=this.groupElementsMap.get(i);if(u!=c){n.groupId?this.groupElementsMap.set(i,c):this.groupElementsMap.delete(i);let d=this.getGroupData(c);d&&this.addMergeData(c,d);let A=this.getGroupData(u);A&&this.addMergeData(u,A)}this.addMergeData(i,l)}handleGroupData(e){let{type:r,id:i,data:n,client:s,number:a,hash:o}=e,l=$a.decGroup(i,n),{gId:c,cmdKey:u,parent:d}=l;this.groupCombinationMap.forEach((h,f)=>{h===i&&l.combinations.push(f)}),this.groupElementsMap.forEach((h,f)=>{h===i&&l.elements.push(f)}),l.id=this.numberToId(a);let A=this.groupCombinationMap.get(i);if(A!=d){parent?this.groupCombinationMap.set(i,d):this.groupCombinationMap.delete(i);let h=this.getGroupData(d);h&&this.addMergeData(d,h);let f=this.getGroupData(A);f&&this.addMergeData(f,f)}this.addMergeData(i,l)}quickSortItemOrder(e){let r=[],i=[],n=[];if(e.length<=1)return e;let s=Math.floor(e.length/2),a=e[s],{zIndex:o,layer:l}=te.getById(a).json;for(let c of e){let{zIndex:u,layer:d}=te.getById(c).json;l<d||u<o?r.push(c):l>d||u>o?i.push(c):n.push(c)}return[...this.quickSortItemOrder(r),...n,...this.quickSortItemOrder(i)]}addDataToJsonCache(e,r){if(["canvas","detail"].includes(e))Object.assign(this.jsonCache.head,r);else if(er[e]){let{gId:i}=r;if(this.isIllegal(r))return;if(ts(this.jsonCache,e)[i]=r,e!=="combination"&&Y0.includes(e)&&!this.jsonCache.itemOrder.includes(i)&&this.jsonCache.itemOrder.push(i),e==="dimension"){let n=te.getById(r.start.id).json;n?Gg(n.cmdKey,r.start,n):this.fixDimensionMap.set(r.start.id,r.start),n=te.getById(r.end.id).json,n?Gg(n.cmdKey,r.end,n):this.fixDimensionMap.set(r.end.id,r.end)}else{let n=this.fixDimensionMap.get(i);n&&(this.fixDimensionMap.delete(i),Gg(e,n,r))}}}renderData(e,r){if(e==="detail")X.windowBridge.publish("setTitle",[X.tabId,r.display_title],ur());else if(e==="canvas"){let i=An.getCanvasAttrs();gy.setOrigin(r.originX,r.originY,!1),An.setCanvasWidthHeight(r.width,r.height,i["attr-direction"],!1)}else if(e==="combination")r.elements.forEach(i=>rn.applyElementsVisible(i));else if(er[e]){let i=Hc(e,r),n=Ar.getNextEleById(r.gId);n?X.gCanvas.insertBefore(i,n):Ar.switchLayer(i,r.layer)}}setItemOrderArr(){let e=BL();this.jsonCache.itemOrder.sort((r,i)=>{let{zIndex:n,layer:s}=te.getById(r).json,{zIndex:a,layer:o}=te.getById(i).json;if(s!==o){let l=e.get(s),c=e.get(o);return l-c}return n-a})}refreshSelected(e){var s;pt.getIds().filter(a=>e.some(({data:o})=>o.gId===a)).forEach(a=>Fe(a).classList.add(gE));let i=new Map,n=((s=te.selectedRepeater)==null?void 0:s.getSelectMap())||new Map;e.forEach(({data:a})=>{let o=n.get(a.gId);o&&i.set(a.gId,o)}),ms.appendSelectStroke(i,!0),lp(void 0,yb())}deleteJsonCacheData(e){e.forEach(r=>{var n;let i=this.getJsonById(r);i&&((n=this.jsonCache[i.cmdKey])==null||delete n[i.gId])})}async getJsonCacheByMergeDataMap(){await this.decodeStatus;let e=te.getDefaultGJsonCache();return this.mergeDataMap.forEach((r,i)=>{if(r){let n=r.cmdKey?r.cmdKey:i;if(["canvas","detail"].includes(n))Object.assign(e.head,r);else if(er[n]){let{gId:s}=r;if(this.isIllegal(r))return;if(ts(e,n)[s]=r,n==="dimension"){let a=te.getById(r.start.id).json;a?Gg(a.cmdKey,r.start,a):this.fixDimensionMap.set(r.start.id,r.start),a=te.getById(r.end.id).json,a?Gg(a.cmdKey,r.end,a):this.fixDimensionMap.set(r.end.id,r.end)}else{let a=this.fixDimensionMap.get(s);a&&(this.fixDimensionMap.delete(s),Gg(n,a,r))}}}}),this.mergeDataMap.clear(),e}handleBlob(e,r){$a.decBlob(e,r),$a.imageHashMap.forEach((i,n)=>{if(i===e){let s=this.getJsonById(n);s&&(s.content=r.content,this.addMergeData(n,{...s}))}})}getJsonById(e){return this.mergeDataMap.get(e)||te.getById(e).json}onChangeNum(e,r){let i=this.mergeDataMap.get(e)||te.getById(e).json;i&&(i.id=this.numberToId(r))}numberToId(e){return"e"+e}onDelete(e){if($a.imageDataMap.get(e)){$a.imageDataMap.delete(e);for(let[i,n]of $a.imageHashMap.entries())if(n===e)return $a.imageHashMap.delete(i)}this.mergeDataMap.set(e,null),this.groupElementsMap.delete(e);let r=this.groupCombinationMap.get(e)||this.groupElementsMap.get(e);if(r){this.groupElementsMap.delete(e),this.groupCombinationMap.delete(e);let i=this.getGroupData(r);this.mergeDataMap.set(r,i)}}addMergeData(e,r){this.mergeDataMap.set(e,r)}getOldData(e){let r=this.mergeDataMap.get(e);"detail","canvas";{let n={};for(let s in r)n[s]=this.jsonCache.head[s];return n}}handleDeleteStroke(e){e.forEach(r=>{var n;let i="#select-for-"+r;(n=Us(i))==null||n.forEach(s=>s.remove())})}isDifferObject(e={},r={}){let i=JSON.stringify(e),n=JSON.stringify(r);return i!==n}getGroupData(e){var i;let r=this.mergeDataMap.get(e)||((i=this.jsonCache.combination)==null?void 0:i[e]);if(r){let n={...r};return n.elements=[],n.combinations=[],this.groupElementsMap.forEach((s,a)=>{e==s&&n.elements.push(a)}),this.groupCombinationMap.forEach((s,a)=>{e==s&&n.combinations.push(a)}),n}}getJsonCache(){return this.jsonCache}exchangeMgrJsonCache(e){let r=te.exchangeJsonCache(this.jsonCache);try{e()}finally{r()}}verifyData(e){return!((e==null?void 0:e.cmdKey)==="obj"&&!(e!=null&&e.content))}isIllegal(e){switch(e.cmdkey){case"group":{let{x:s,y:a,width:o,height:l}=un(e);if(_i(o,0)&&_i(l,0))return!0}break;case"rect":let r=e,{width:i,height:n}=vn.getRectFromMatrix(r.matrix);if(_i(i,0)||_i(n,0))return!0;break;case"arc":{let s=e;if(Oc({x:s.x1,y:s.y1},{x:s.x2,y:s.y2}))return!0}break;default:break}return!1}};var mW="--selectColor",DL=class{constructor(e){this.panelCompiler=e;this.canPublishSelect=!0;this._notPublishOnce=!1;this.userSelectMap=new Map;this.lastSelectMap=new Map}async init(){this.user=(await pd("getUserInfoFromCache")).message;let e=(await X.windowBridge.rpcCall("getActiveProject",null,ur())).message;this.canPublishSelect=(await X.windowBridge.rpcCall("ui/hasDocCreatePermission",{projectId:e,showMsg:!1},ur())).message}getSelect(){let e=pt.getIds().slice(0,1e3).map(r=>({cmdKey:te.getById(r).cmdKey,uuid:r}));return JSON.stringify({data:e,updateTime:+new Date})}onDestroy(e,r){this.userSelectMap.delete(e),ms.appendSelectStroke(this.getChangeMap(),!1)}async changeSelect(e,r,i){var l;if(e.uuid===this.user.uuid)return;let s=JSON.parse(i),a=s.updateTime,o=((l=this.userSelectMap.get(e.uuid))==null?void 0:l.selectColor)||(await X.windowBridge.rpcCall("getUserColor",e.uuid,ur())).message;this.userSelectMap.set(e.uuid,{user:e,selected:s.data,updateTime:a,selectColor:o}),ms.appendSelectStroke(this.getChangeMap(),!1)}getSelectMap(){let e=new Map;return[...this.userSelectMap.keys()].sort((i,n)=>{let s=this.userSelectMap.get(i).updateTime,a=this.userSelectMap.get(n).updateTime;return s-a}).forEach(i=>{let{selected:n,selectColor:s}=this.userSelectMap.get(i);n.forEach(a=>e.set(a.uuid,{...a,color:s}))}),pt.getIds().forEach(i=>{let n=te.getById(i).cmdKey;e.set(i,{cmdKey:n,color:mW,uuid:i})}),e}getSelfSelectMap(){let e=new Map;return pt.getIds().forEach(r=>{let i=te.getById(r).cmdKey;e.set(r,{cmdKey:i,color:mW,uuid:r})}),e}getChangeMap(){let e=new Map,r=this.getSelectMap();return this.lastSelectMap.forEach((i,n)=>{let s=r.get(n);i.color!==(s==null?void 0:s.color)&&e.set(n,{...i,color:s==null?void 0:s.color})}),r.forEach((i,n)=>{let s=this.lastSelectMap.get(n);(s==null?void 0:s.color)!==i.color&&e.set(n,i)}),this.lastSelectMap=r,e}notPublishOnce(){this._notPublishOnce=!0}updateChange(){let e=this.getSelect();!this.canPublishSelect||this._notPublishOnce?(this._notPublishOnce=!1,this.changeSelect(this.user,void 0,e)):this.panelCompiler.publishSelected(e,!0)}};var cp=class t extends hP{constructor(r,i,n,s=new q2(!1)){super(r,i,n,s);this.decoders=new IL;this.channel=s,this.selectRepeater=new DL(this)}static async getJsonCache(r,i){let n=(await X.windowBridge.rpcCall("getActiveProject",null,ur())).message,s=i===n,a=new t(r,i,s,new q2(!0));if(!(await a.init(!0,!0,!1,!1)).success)return{};let l=await a.getJsonCache();return a.destroy(),l}async init(r=!0,i=!0,n=!0,s=!0){await this.selectRepeater.init();let a=await super.init(r,i,n);return s&&this.resetZIndex(),a}async resetZIndex(){let r=await this.getJsonCache(),i=te.exchangeJsonCache(r),n=r.itemOrder.map(s=>{var a;return(a=te.getById(s).json)==null?void 0:a.zIndex});n.length!==new Set(n).size&&(r.itemOrder.forEach((s,a)=>{let o=te.getById(s).json;o&&(o.zIndex=a+1,this.uploadData(s,o))}),this.save()),i()}async getJsonCache(){try{await this.decoders.decodeStatus}catch{}finally{return this.decoders.getJsonCache()}}async save(){let r=await this.getJsonCache();return ef.uploadData("canvas",r.head,this),super.save()}async getMergeDataJsonCache(){return await this.decoders.getJsonCacheByMergeDataMap()}uploadData(r,i){ef.uploadData(r,i,this)}uploadHistoryData(r){jf(r[0])||(r=[r]),this.setHistoryDataDefaultZIndex(r),r.forEach(i=>{var l,c;let n=i[0];if(n==="elePosition")return;if(n==="originXY")return this.uploadData("canvas");let s=i[1],a=te.getById(s).cmdKey;if(a==="combination"?Kr(i[3]||{}):Kr(i[4]||{})){gd.uploadDeleteById(s,a);let u=$a.imageHashMap.get((l=i[3])==null?void 0:l.gId);((c=i[3])==null?void 0:c.cmdKey)==="obj"&&u&&te.compilerManager.deleteBlob(u)}else n==="combine-json"?ef.uploadCombination(i[3],i[2]):n==="json"&&this.uploadData(s)})}setHistoryDataDefaultZIndex(r){let i=new Map;r.filter(n=>{var s;return n[0]==="json"&&!Kr(n[4])&&((s=te.getById(n[1]).json)==null?void 0:s.zIndex)===void 0}).forEach(n=>i.set(n[1],n[4])),i.size&&te.getItemOrder().forEach(n=>{let s=i.get(n);if(s){let a=te.getById(n).json;a.zIndex=s.zIndex=++te.maxZIndex}})}pauseDateMerge(){this.channel.pause(),this.decoders.canMergeData=!1}async resumeDataMerge(){this.decoders.canMergeData=!0,this.channel.resume(),await this.getJsonCache(),this.decoders.mergeDataToJsonCache()}onDocDetail(r,i,n){this.decoders.addTask({type:"detail",client:r,ticket:i,data:n})}onDimension(r,i,n,s,a){this.decoders.addTask({type:"dimension",id:r,number:i,client:n,ticket:s,data:a})}onString(r,i,n,s,a){this.decoders.addTask({type:"string",id:r,number:i,client:n,ticket:s,data:a})}onPoly(r,i,n,s,a){this.decoders.addTask({type:"poly",id:r,number:i,client:n,ticket:s,data:a})}onGroup(r,i,n,s,a){this.decoders.addTask({type:"group",id:r,number:i,client:n,ticket:s,data:a})}onCanvas(r,i,n){this.decoders.addTask({type:"canvas",client:r,ticket:i,data:n})}onAuxLine(r,i,n,s,a){this.decoders.addTask({type:"auxLine",id:r,number:i,client:n,ticket:s,data:a})}onBlob(r,i,n,s,a){this.decoders.addTask({type:"blob",hash:r,client:i,ticket:n,data:s,pending:a})}onDelBlob(r,i,n,s){this.decoders.addTask({id:r})}onDelAuxLine(r){this.decoders.addTask({id:r})}onDelGroup(r){this.decoders.addTask({id:r})}onDelPoly(r){this.decoders.addTask({id:r})}onDelString(r){this.decoders.addTask({id:r})}onDelDimension(r){this.decoders.addTask({id:r})}onAuxLineNum(r,i){this.decoders.addTask({id:r,number:i})}onDimensionNum(r,i){this.decoders.addTask({id:r,number:i})}onStringNum(r,i){this.decoders.addTask({id:r,number:i})}onPolyNum(r,i){this.decoders.addTask({id:r,number:i})}onGroupNum(r,i){this.decoders.addTask({id:r,number:i})}canvasSelected(){return this.selectRepeater.getSelect()}onSelectChange(r,i,n){this.selectRepeater.changeSelect(r,i,n)}onSelectQuit(r,i){this.selectRepeater.onDestroy(r,i)}};async function SW(t){if(!t)throw new Error("no data");let e=await cp.getJsonCache(t.uuid,t.path);if(delete e.auxiliaryLine,!t.viewBox)return Ba.toSVG(e);let r=te.exchangeJsonCache(e),i=te.getBBox();r();let n=50,s=i.width(),a=i.height();s=(n/s+1)*s,a=(n/a+1)*a;let o=[i.minX-n/2,i.minY-n/2,s,a].join(" ");return Ba.toSVG(e,{viewBox:o,before(c){let u=EW(),d=CW(),A="getProfileSetting";X.messageBus.publish("getProfileSetting",{reply:A}),X.messageBus.pull(A,h=>{let f=h.commSystemSetting.PANEL_THEME,p=document.createElement("style");p.innerHTML=SL(f),c.push(p.outerHTML)}),c.push(u,d)}})}function LL(t){let e=te.exchangeJsonCache(t),r=new Map;te.iterator((i,n,s)=>{r.set(s,{...i,cmd:n,gId:s})}),te.iteratorDimension(i=>{let n=r.get(i.start.id);n&&Gg(n.cmd,i.start,n),n=r.get(i.end.id),n&&Gg(n.cmd,i.end,n)}),e()}function Gg(t,e,r){let i=new jS;switch(t){case"rect":{let n=i.loadPointsOfRect(r);yE(n,e);break}case"ellipse":{let n=i.loadPointsOfEllipse(r);yE(n,e);break}case"obj":{let n=i.loadPointsOfImage(r);yE(n,e);break}case"text":{let n=i.loadPointsOfText(r);yE(n,e);break}case"group":{let n=i.loadPointsOfGroup(r);yE(n,e);break}case"arc":{let n=i.loadPointsOfArc(r);yE(n,e);break}default:console.error(t,"Plz check code");break}}function yE(t,e){for(let r of t)if(Oc(e.primitivePoint,{x:r.getX(),y:r.getY()})){e.index=r.getIndex(),e.cmdKey=r.getCmdkey();return}console.error("not matched, check code")}async function TW(t){await dW(t),JSe(t),$Se(t),LL(t),KSe(t)}function KSe(t){let e=te.exchangeJsonCache(t),r=new Set([]);te.iterator((i,n,s)=>{switch(n){case"group":{let{x:c,y:u,width:d,height:A}=un(i);_i(d,0)&&_i(A,0)&&r.add(s)}break;case"rect":let a=i,{width:o,height:l}=vn.getRectFromMatrix(a.matrix);(_i(o,0)||_i(l,0))&&r.add(s);break;case"arc":{let c=i;Oc({x:c.x1,y:c.y1},{x:c.x2,y:c.y2})&&r.add(s)}break;default:break}});for(let i of r)te.removeOne({id:i});te.removeItemOrder(r),e()}function JSe(t){let e=t.auxiliaryLine||{};for(let r in e){let i=e[r],n=sb(i.x,i.y,i.rotation);i.x1=n.start().x,i.y1=n.start().y,i.x2=n.end().x,i.y2=n.end().y}}function $Se(t){let e=te.exchangeJsonCache(t);te.iterator((r,i,n)=>{r.cmdKey=i,r.gId=n,["dimensionAngle","dimensionLength","dimensionRadius"].includes(i)&&(r.rotation=0),r.cmdKey==="group"&&(r.d=CL(r.d))}),e()}function eTe(t){let e=t.length,r=0;return()=>{for(;r<e;){let i=t.indexOf(`
`,r);i<0&&(i=e);let n=t.substring(r,i);if(r=i+1,n)try{return JSON.parse(n)}catch(s){console.error(s)}}}}function $S(t){let[e,r,i,n,s,a,o,l,c]=t.data;return[e,r,n,s,o,l]}function OL(t){let e=X.uploadSvgFileMaxMB*1048576;if(!(s=>(s.length-30)*.75>e)(t))return t;let i=!(typeof window=="object"&&typeof document=="object")&&typeof importScripts=="function",n={bytesLimit:e,maxWidth:2160,maxHeight:2160};return(async()=>i?(await X.messageBus.rpcCall("/panel/resizeImageFromURL",[t,n])).message.dataURL:(await mE(t,n)).dataURL)()}async function bE(t,e=!1){console.debug("decompressing...",t);let{dataStr:r,json:i,docType:n,title:s,display_title:a}=t;if(n!==si.PANEL&&n!==si.PANEL_LIB)throw new Error(`invalid doctype(${JSON.stringify(n)}), need panel(${si.PANEL})`);n===si.PANEL_LIB&&(e=!0);let o={DOCTYPE:A},l={head:{title:s,display_title:a,docType:n,maxId:0,version:Bg,name:"name",material:"PVC",thickness:"0.2mm",craft:"Transparent",desc:"xxxxx",width:787,height:1181}},c=0,u=eTe(r||i);for(;;){let f=u();if(f)try{await d(f[0])(f)}catch(p){console.error(p)}else break}return o.__POST_PROCESS__&&o.__POST_PROCESS__(),h(),console.debug("decompressed",l),await TW(l),l;function d(f){let p=o[f];return p||(console.warn(`unsupported command ${f}`),()=>{})}function A(f){c=parseFloat(f[2]);let p={decoders:o,jsonCache:l,docVersion:c,sync:e};c>=2?rTe(p):iTe(p)}function h(){let f={decoders:o,jsonCache:l,docVersion:c,sync:e};c<=1&&tTe(f)}}function tTe(t){let{jsonCache:e}=t,r={group:i,text:n,obj:s,rect:a,ellipse:o};for(let l in e){let c=r[l];if(c){let u=e[l];for(let d in u)c(d,u[d])}}function i(l,c){c.rotation=0,c.displayFill=!0,c.displayStroke=!0,c.visible=!0}function n(l,c){let{x:u,y:d,rotation:A,mirror:h,widthPercent:f,heightPercent:p,cacheHeight:m,cacheWidth:y,hAlign:g,vAlign:b}=c;m=m||0,y=y||0;let E=0;switch(g){case 1:E=-y/2;break;case 2:E=-y;break}let w=0;switch(b){case 1:w=m/2;break;case 0:w=m;break}let x=Ue.translate(E,w).scale(f,p).rotateD(-A);h&&(x=x.multiply3(Ue.MIRROR_X)),x=x.translate(u,d),c.matrix=$S(x),c.visible=!0}function s(l,c){let{x:u,y:d,width:A,height:h,rotation:f,mirror:p}=c,m=Ue.scale(A,h).rotateD(-f);p&&(m=m.multiply3(Ue.MIRROR_X)),m=m.translate(u,-d),c.matrix=$S(m),c.visible=!0,delete c.x,delete c.y,delete c.width,delete c.height,delete c.mirror}function a(l,c){let{x:u,y:d,endX:A,endY:h,rotation:f,isCCW:p}=c,m=Ue.scale(A-u,h-d).rotateD(-f);p&&(m=m.multiply3(Ue.MIRROR_X)),m=m.translate(u,d),c.matrix=$S(m),c.displayFill=!0,c.displayStroke=!0,c.visible=!0,delete c.x,delete c.y,delete c.endX,delete c.endY,delete c.isCCW}function o(l,c){let{cx:u,cy:d,rx:A,ry:h,rotation:f,isCCW:p}=c,m=Ue.scale(A,h).rotateD(-f);p&&(m=m.multiply3(Ue.MIRROR_X)),m=m.translate(u,d),c.matrix=$S(m),c.displayFill=!0,c.displayStroke=!0,c.visible=!0,delete c.cx,delete c.cy,delete c.rx,delete c.ry,delete c.isCCW}}function rTe(t){let{decoders:e,jsonCache:r,sync:i}=t;Object.assign(e,{HEAD:a,LOCK:o,HIDE:u,INVISIBLE:c,COVER:l,TRN_CTRL:y,COMMENT:g,POLY:b,STRING:U,FONT_CACHE:H,TRANSFORM:d,AUXLINE:m,DIMENSION:h,GROUP:A,__POST_PROCESS__:j});let n={},s=new Array;r.itemOrder=s;function a(B){Object.assign(r.head,B[1]),r.head.originY=-(r.head.originY||0)}function o(B){let M=B[1];for(let v of M)v in n?n[v].locked=!0:console.warn(`LOCK ${v} not found`)}function l(B){let M=B[1],v=B[2];M in n?n[M].cover=!!v:console.warn(`COVER ${M} not found`)}function c(B){let M=B[1];for(let v of M)v in n?n[v].visible=!1:console.warn(`INVISIBLE ${v} not found`)}function u(B){let M=B[1];for(let v of M)v in n?n[v].hide=!0:console.warn(`HIDE ${v} not found`)}function d(B){let M=B[1];if(M in n){let[v,N,R,q,P,z]=B[2],W=new Ue([v,q,0,N,P,0,R,z,1]);W=Ue.MIRROR_Y.multiply3(W).multiply3(Ue.MIRROR_Y),n[M].matrix=$S(W)}else console.warn(`TRANSFORM ${M} not found`)}function A(B){let M=`e${B[1]}`,v=`e${B[2]}`,N=B[3],R=!!B[4],q=!!B[5],P={gId:M,name:N,locked:q,visible:R,cmdKey:"combination",parent:B[2]===0?null:v,combinations:[],elements:[]};n[M]=P,ts(r,"combination")[M]=P}function h(B){let M=new Array,v=B[7];for(let R=0;R<v.length-1;R+=2)M.push(new ne(v[R],v[R+1]));let N=B[8];switch(B[3]){case"LENGTH-CONSTRAINT":case"LENGTH-MEASUREMENT":{let[R,q,P,z]=M,W=R.x===q.x?"x":R.y===q.y?"y":"xy",oe=f(B[3]),Ae={name:"",gId:B[1],cmdKey:"dimension",layer:B[2],category:oe,direction:W,start:{id:N[0],index:0,cmdKey:"",primitivePoint:{x:R.x,y:-R.y},otherPoint:{x:q.x,y:-q.y}},end:{id:N[1],index:0,cmdKey:"",otherPoint:{x:P.x,y:-P.y},primitivePoint:{x:z.x,y:-z.y}},visible:!0,locked:!1};_("dimension",B[1],0,Ae);break}case"RADIUS-MEASUREMENT":{let[R,q,P]=M,z={name:"",gId:B[1],cmdKey:"dimensionRadius",layer:B[2],x1:R.x,y1:-R.y,x2:q.x,y2:-q.y,textX:P.x,textY:-P.y,locked:!1,visible:!0,ellipseId:N[0]};_("dimensionRadius",B[1],0,z);break}case"ANGLE":{let[R,q,P,z]=M,W={name:"",gId:B[1],cmdKey:"dimensionAngle",layer:B[2],x1:R.x,y1:-R.y,angleX:q.x,angleY:-q.y,x2:P.x,y2:-P.y,textX:z.x,textY:-z.y,locked:!1,visible:!0};_("dimensionAngle",B[1],0,W);break}case"LENGTH":{let[R,q,P,z]=M,W=R.x===q.x?"x":R.y===q.y?"y":"xy",oe={name:"",gId:B[1],cmdKey:"dimensionLength",layer:B[2],x1:R.x,y1:-R.y,measureX1:q.x,measureY1:-q.y,measureX2:P.x,measureY2:-P.y,x2:z.x,y2:-z.y,direction:W,locked:!1,visible:!0,rotation:0};_("dimensionLength",B[1],0,oe);break}}}function f(B){switch(B){case"LENGTH-MEASUREMENT":return"Annotation";case"LENGTH-CONSTRAINT":return"Constraint";default:throw new Error(`unknown dimension type ${JSON.stringify(B)}`)}}function p(B){if(B!==null)return B===""?null:B}function m(B){if(B[10]===0){let M={gId:B[1],cmdKey:"auxiliaryPoint",visible:!0,name:"",layer:B[3],x:B[4],y:-B[5],fillColor:p(B[9]),locked:!1};_("auxiliaryPoint",B[1],B[2],M)}else{let M={gId:B[1],name:"",layer:B[3],x:B[4],y:-B[5],rotation:B[6],strokeStyle:B[8],strokeColor:p(B[9]),locked:!1};_("auxiliaryLine",B[1],B[2],M)}}function y(B){let M=B[1],v=B[2],N=B[3],R=B[4];if(M in n){let q=n[M];switch(v){case 1:q.transparencyPrint=1-(N!==void 0?N:q.opacity),q.transparencyWhite=1-(R!==void 0?R:1);break;case 2:q.transparencyPrint=1-(N!==void 0?N:1),q.transparencyWhite=1-(R!==void 0?R:q.opacity);break;case 3:q.transparencyPrint=1-(N!==void 0?N:q.opacity),q.transparencyWhite=1-(R!==void 0?R:q.opacity);break;default:}}else console.warn(`TRN_CTRL ${M} not found`)}function g(B){let M=B[1],v=B[2];M in n?n[M].name=v:console.warn(`COMMENT ${M} not found`)}function b(B){let M=!!(B[12]||B[12]===void 0),v=!!(B[13]||B[13]===void 0);if(B[11].length===1){let N=B[11][0];switch(N[0]){case"R":return x(B,M,v);case"ELLIPSE":return E(B,M,v);case"M":return N[3]==="A"||N[3]==="CA"?w(B,M,v):G(B,M,v);default:return G(B,M,v)}}else return G(B,M,v)}function E(B,M,v){let N={layer:B[3],rotation:-B[4],strokeWidth:B[5],strokeStyle:B[6],strokeColor:B[7],fillColor:B[8],opacity:B[9],displayFill:M,displayStroke:v};_("ellipse",B[1],B[2],N)}function w(B,M,v){let[,N,R,q,P,z,W,oe,Ae,me,ve]=B[11][0],Le={layer:B[3],rotation:-B[4],strokeWidth:B[5],strokeStyle:B[6],strokeColor:B[7],fillColor:B[8],opacity:B[9],displayFill:M,displayStroke:v,x1:N,y1:-R,rx:P,ry:z,angle:W,large:oe,sweep:Ae,x2:me,y2:-ve,type:q==="CA"?1:2};_("arc",B[1],B[2],Le)}function x(B,M,v){let N=B[8];if(N.startsWith("data:")||N.startsWith("blob:"))return I(B,N);{let R=B[11][0],q={layer:B[3],rotation:-B[4],strokeWidth:B[5],strokeStyle:B[6],strokeColor:B[7],fillColor:N,opacity:B[9],rx:R[5],ry:R[6],displayFill:M,displayStroke:v};_("rect",B[1],B[2],q)}}function I(B,M){if(M){let v=/^blob:(.+)$/.exec(M);return v?(async()=>{let N=v[1],{dataUrl:R}=(await X.messageBus.rpcCall("/pro-mgr/getBlob",{hash:N})).message;R&&(R=await OL(R),C(B,R))})():(async()=>{let N=await OL(M);C(B,N)})()}}function C(B,M){let v={gId:B[1],layer:B[3],rotation:-B[4],content:M,opacity:B[9],locked:!1};_("obj",B[1],B[2],v)}function G(B,M,v){let N=Q(B[11]).d,R={layer:B[3],rotation:-B[4],strokeWidth:B[5],strokeStyle:B[6],strokeColor:B[7],fillColor:B[8],opacity:B[9],d:N,displayFill:M,displayStroke:v};_("group",B[1],B[2],R)}function U(B){let M={layer:B[3],rotation:-B[4],key:B[5],name:B[5],fontFamily:B[6],fontSize:B[7],fontWeight:B[8],italic:B[9]===1,underline:B[10]===1,strikeout:B[11]===1,vAlign:-(B[12]/3|0)+2,hAlign:B[12]%3,strokeColor:B[13],opacity:B[14]};_("text",B[1],B[2],M)}function _(B,M,v,N){var R;if(n[M]=N,s.push(M),N.zIndex=s.length+1,typeof N.hide!="boolean"&&(N.hide=!1),typeof N.visible!="boolean"&&(N.visible=!0),typeof N.locked!="boolean"&&(N.locked=!1),typeof N.layer!="number"&&(N.layer=1),typeof N.opacity!="number"&&(N.opacity=1),typeof N.cover!="boolean"&&(N.cover=!1),typeof N.scope!="number"&&(N.scope=1),typeof N.name!="string"&&(N.name=""),!N.matrix&&!["group","arc","dimensionLength","dimensionAngle"].includes(B)&&(N.matrix=[1,0,0,1,0,0]),ts(r,B)[M]=N,v>0){let q=`e${v}`,P=(R=r.combination)==null?void 0:R[q];P?P.elements.push(M):console.warn("GROUP",v,"not found")}}function H(B){let{bbox:M,d:v}=Q(B[2]),N=n[B[1]];N.d=v,N.cacheWidth=M.width(),N.cacheHeight=M.height()}function Q(B){let M=new pr,v=B.map(N=>{let R="";return new pu(q=>(M.ext1(q.bbox()),R=new Ku().encPl(q).toString(),!1),!0).parse("M"+N.join(" ")),R}).join(" ");return{bbox:M.build(),d:v}}function j(){$()}function $(){Vl(r.combination,(B,M)=>{if(M.parent){let v=n[M.parent];v?v.combinations.push(B):(console.warn("parent combination",M.parent,"not found"),M.parent=null)}})}}function iTe(t){let{decoders:e,jsonCache:r,sync:i}=t;Object.assign(e,{HEAD:a,LOCK:o,HIDE:l,COVER:c,TRN_CTRL:u,COMMENT:d,POLY:A,STRING:g,FONT_CACHE:E});let n={},s=new Array;r.itemOrder=s;function a(x){Object.assign(r.head,x[1]),r.head.originY=-(r.head.originY||0),r.head.print==="AHead Side"&&(r.head.print="Ahead Side")}function o(x){let I=x[1];for(let C of I)C in n?n[C].locked=!0:console.warn(`LOCK ${C} not found`)}function l(x){let I=x[1];for(let C of I)C in n?n[C].hide=!0:console.warn(`HIDE ${C} not found`)}function c(x){let I=x[1],C=x[2];I in n?n[I].cover=!!C:console.warn(`COVER ${I} not found`)}function u(x){let I=x[1],C=x[2],G=x[3],U=x[4];if(I in n){let _=n[I];switch(C){case 1:_.transparencyPrint=1-(G!==void 0?G:_.opacity),_.transparencyWhite=1-(U!==void 0?U:1);break;case 2:_.transparencyPrint=1-(G!==void 0?G:1),_.transparencyWhite=1-(U!==void 0?U:_.opacity);break;case 3:_.transparencyPrint=1-(G!==void 0?G:_.opacity),_.transparencyWhite=1-(U!==void 0?U:_.opacity);break;default:}}else console.warn(`TRN_CTRL ${I} not found`)}function d(x){let I=x[1],C=x[2];I in n?n[I].name=C:console.warn(`COMMENT ${I} not found`)}async function A(x){if(x[11].length===1)switch(x[11][0][0]){case"R":return await f(x);case"ELLIPSE":return h(x);default:return y(x)}else return y(x)}function h(x){let I=x[11][0],C={layer:x[3],strokeWidth:x[4],strokeStyle:x[5],strokeColor:x[6],fillColor:x[7],opacity:x[8],cx:I[1],cy:-I[2],rx:I[3],ry:I[4],rotation:+I[5],isCCW:+I[6],name:x[12]};b("ellipse",x[1],C)}async function f(x){let I=x[7];if(I.startsWith("data:")||I.startsWith("blob:"))await p(x,I);else{let C=x[11][0],G={layer:x[3],strokeWidth:x[4],strokeStyle:x[5],strokeColor:x[6],fillColor:I,opacity:x[8],x:C[1],y:-C[2],endX:C[1]+C[3],endY:-C[2]+C[4],rx:C[5],ry:C[6],rotation:+C[7],isCCW:+C[8],name:x[12]};b("rect",x[1],G)}}async function p(x,I){if(I){let C=/^blob:(.+)$/.exec(I);return C?(async()=>{let G=C[1],{dataUrl:U}=(await X.messageBus.rpcCall("/pro-mgr/getBlob",{hash:G})).message;U&&(U=await OL(U),m(x,U))})():(async()=>{let G=await OL(I);m(x,G)})()}}function m(x,I){let[C,G,U,_,H,Q,j,$,B]=x[11][0],M=Ue.rotateD($);B&&(M=M.multiply3(Ue.MIRROR_X));let v;B?v=new Ee(new ne(0,0),new ne(0,-H)).multiply3(M):v=new Ee(new ne(0,0),new ne(_,0)).multiply3(M);let N={gId:x[1],layer:x[3],content:I,opacity:x[8],mirror:B===1,width:B===1?H:_,height:B===1?_:H,rotation:v.end().angleD(v.start()),x:G,y:U,locked:!1,name:x[12]};b("obj",x[1],N)}function y(x){let I=w(x[11]).d,C={layer:x[3],strokeWidth:x[4],strokeStyle:x[5],strokeColor:x[6],fillColor:x[7],opacity:x[8],d:I,name:x[12]};b("group",x[1],C)}function g(x){let I={layer:x[3],x:x[4],y:-x[5],rotation:x[6],mirror:x[7]===1,key:x[8],name:x[8],fontFamily:x[9],fontSize:x[10],fontWeight:x[11],italic:x[12]===1,underline:x[13]===1,strikeout:x[14]===1,vAlign:-(x[15]/3|0)+2,hAlign:x[15]%3,strokeColor:x[16],opacity:x[17],widthPercent:x[18]||1,heightPercent:x[19]||1};b("text",x[1],I)}function b(x,I,C){n[I]=C,s.push(I),C.zIndex=s.length+1,typeof C.hide!="boolean"&&(C.hide=!1),typeof C.locked!="boolean"&&(C.locked=!1),typeof C.layer!="number"&&(C.layer=1),typeof C.opacity!="number"&&(C.opacity=1),typeof C.cover!="boolean"&&(C.cover=!1),typeof C.scope!="number"&&(C.scope=1),typeof C.name!="string"&&(C.name=""),ts(r,x)[I]=C}function E(x){let{bbox:I,d:C}=w(x[2]),G=n[x[1]];G.d=C,G.cacheWidth=I.width(),G.cacheHeight=I.height()}function w(x){let I=new pr,C=x.map(G=>{let U="";return new pu(_=>(I.ext1(_.bbox()),U=new Ku().encPl(_).toString(),!1),!1).parse("M"+G.join(" ")),U}).join(" ");return{bbox:I.build(),d:C}}}var{IS_CLIENT:Yg,IS_EASYEDA:fAt,IS_PRIVATE:pAt,IS_ONLINE:IW,IS_HALF_OFFLINE:mAt,IS_OFFLINE:gAt}=X4,NL=Yg&&!IW,BW=Yg&&IW;var xE=class{constructor(e,r=UC){this.options=r;this.hasLocked=!1;this.success=!1;this.degree=0;this.objs=e.filter(i=>{let n=Rs.isLockedById(i.id);return this.hasLocked=n,!n}).filter(i=>Pi(i)!=="dimension")}do(e){let{hasLocked:r}=this;if(r){JA();return}if(!this.objs.length)return;if(this.degree=Cs(this.degree+e),this.options.notSaveHistory){up(this.objs,e),Ja(this.objs,{create8Dots:!1});return}let i=$i.createContext(!0);this.objs=Bh(this.objs).filter(s=>te.getById(s.id).cmdKey!=="auxiliaryLine");for(let s of this.objs){let{cmdKey:a,json:o}=te.getById(s.id);Fo(a)&&mr.jsonSnap.addOne(o)}up(this.objs,e),i();let n=xu(this.objs);n.length&&Ja(n,{create8Dots:!0}),new rs().updateHole(),this.success=!0}};xE=Uu([gu(Ya.rotate)],xE);function EE(t,e=.01){return t.closed()?!1:t.primitives.length===1&&t.primitives[0]instanceof Ee?!0:!(t.end().distance2(t.start())<=e*e)}function wE(t,e=.01){let r=t.map((o,l)=>({polyline:o,index:l,op:0})),i={removedItems:[],updatedItems:[],noChangeItems:r},n=[],s=[];if(r.forEach(o=>{let{polyline:l}=o;EE(l)?s.push(o):n.push(o)}),s.length<2)return i;let a=s;for(let o=0;o<a.length;o++){let l=a[o],c=l.polyline,u,d=o+1;for(;d<a.length;d++){let A=a[d],h=A.polyline,f=[c.start(),c.end(),h.start(),h.end()],p=f[0].distance1(f[2]),m=f[0].distance1(f[3]),y=f[1].distance1(f[2]),g=f[1].distance1(f[3]),b=Math.min(p,m,y,g);if(!(b>=e)){if(m==b)[c,h]=[h,c];else if(p==b)c=c.reverse();else if(g==b)h=h.reverse();else if(y!=b)continue;if(u=Fr.build2(c.primitives.concat(h.primitives)),c=u,l.polylineNew=u,l.op=1,A.op=2,a.splice(d,1),d=o,!EE(u))break}}}return i={removedItems:r.filter(o=>o.op==2),updatedItems:r.filter(o=>o.op==1),noChangeItems:r.filter(o=>o.op==0)},i}function vE(t,e){return t.map(r=>{let i=r.id,{json:n,cmdKey:s}=te.getById(r.id);return e.includes(s)?{gId:i,jsonObj:n,element:r}:null}).filter(r=>r&&!!r.jsonObj)}function RL(t){let e=[];for(let r in t.ellipse||{}){let i=ni(),n=t.ellipse[r];n.gId=i;let s=FS(n,i);e.push(s)}for(let r in t.rect||{}){let i=t.rect[r],n=ni();i.gId=n;let s=kS(i,n);e.push(s)}for(let r in t.group||{}){let i=t.group[r],n=ni();i.gId=n;let s=qA(i,n);e.push(s)}for(let r in t.text||{}){let i=t.text[r],n=ni();i.gId=n;let s=cE(i,n);e.push(s)}for(let r in t.obj||{}){let i=t.obj[r],n=ni();i.gId=n;let s=US(i,n);e.push(s)}for(let r in t.arc||{}){let i=t.arc[r],n=ni();i.gId=n;let s=Ng(i,n);e.push(s)}for(let r in t.auxiliaryLine||{}){let i=t.auxiliaryLine[r],n=ni();i.gId=n;let s=HS(i,n);e.push(s)}for(let r in t.auxiliaryPoint||{}){let i=t.auxiliaryPoint[r],n=ni();i.gId=n;let s=hb(i,n);e.push(s)}return e}function nTe(t,e){if(t==e)return 0;let r=t.compareDocumentPosition(e);return r&Node.DOCUMENT_POSITION_DISCONNECTED?0:r&Node.DOCUMENT_POSITION_PRECEDING?1:-1}function sTe(t){let r=Jn(t).map(n=>n.reverse()).reverse();return ql(r,!1)}function aTe(t){let e=Jn(t),r=.05,i=e.map(s=>s.simplify(r));return ql(i,!1)}function oTe(t){let[e,r,i,n,s,a]=t,o=new Ue([e,r,0,i,n,0,s,a,1]),l=new ne(0,0).multiply3(o),{x:c,y:u}=l,d=new ne(1,0).multiply3(o),A=new ne(0,1).multiply3(o),h=d.distance1(l),f=A.distance1(l);return{cx:c,cy:u,rx:h,ry:f}}function DW(){let t=pt.get(),e=["rect","ellipse","text","arc"],r=vE(t,e);if(!r.length)return;let i=[],n=[];r.forEach(s=>{let{gId:a,jsonObj:o,element:l}=s,c=lb(o),u=ni(),d=te.getInitialGroupData({gId:u,layer:o.layer});d.d=c,d.cover=o.cover,d.scope=o.scope,d.opacity=o.opacity,d.fillColor=o.fillColor,d.strokeWidth=o.strokeWidth,d.strokeColor=o.strokeColor,o.cmdKey=="text"&&(d.fillColor=o.strokeColor,d.strokeColor="none",d.strokeWidth=0);let A=qA(d,u);X.gCanvas.insertBefore(A,l),i.push(Da(a,{cmdKey:o.cmdKey,refId:vo(l)},o,{})),te.removeOne(l),i.push(Da(u,{cmdKey:"group",refId:vo(A)},"",d)),n.push(A)}),i.length&&mr.save(i),Ci(),pt.unselectAll(),pt.select(n),n.length===1&&Ac(n[0]),Et("panel_updateAttrPanel")}function _W(){let t=pt.get(),e=["ellipse","group","rect","arc"],r=vE(t,e);if(!r.length)return;let i=[],n=[];r.map(s=>{let{gId:a,jsonObj:o,element:l}=s;if(!(o.strokeColor!="none"&&o.strokeWidth>0))return;let u;if(o.cmdKey==="rect"){let{matrix:y,strokeWidth:g,displayStroke:b,rx:E,ry:w}=o;if(!b)return;let x=nr.expandRectMatrixByStrokeWidth(y,g,!0);u=ud({...o,rx:E+g/2,ry:w+g/2,matrix:x});try{let C=nr.expandRectMatrixByStrokeWidth(y,g,!1),G=ud({...o,rx:Math.max(0,E-g/2),ry:Math.max(0,w-g/2),matrix:C},{ccw:!0});u+=G}catch(C){console.error(C)}}else if(o.cmdKey==="ellipse"){let{strokeWidth:y,matrix:g}=o,b=y/2,E=oTe(g),{cx:w,cy:x}=E,I=nr.calcuEllipse(g);if(u=zA({rotation:I.degree,cx:w,cy:x,rx:I.a+b,ry:I.b+b},{ccw:!1}),b<I.a&&b<I.b){let G=zA({rotation:I.degree,cx:w,cy:x,rx:I.a-b,ry:I.b-b},{ccw:!0});u+=G}}else{let y=In.convertJsonCache2PolyLines(o,o.cmdKey),g=Xq(y,o.strokeWidth);if(!g.length)return;u=g.map(b=>ql(b.items,!1)).join(" ")}let d=[o.strokeColor,o.fillColor,"#000000"].find(y=>y&&y!="none"),{json:A,cmdKey:h}=te.getById(l.id),f=te.getInitialGroupData({gId:ni(),layer:A.layer});f.d=u,f.fillColor=d,f.strokeColor="none",f.strokeWidth=0;let p=qA(f);if(X.gCanvas.insertBefore(p,l.nextSibling),i.push(Da(p.id,{cmdKey:"group",refId:vo(p)},"",f)),o.fillColor&&o.fillColor!=="none"){ge(l,"stroke-width",0),ge(l,"stroke","none");let y=vi(A);y.strokeWidth=0,y.strokeColor="none",i.push(Da(l.id,{cmdKey:h,refId:vo(l)},A,y)),o.strokeWidth=0,o.strokeColor="none"}else i.push(Da(l.id,{cmdKey:h,refId:vo(l)},A,"")),te.removeOne(l);n.push(p)}),i.length&&(i.length&&mr.save(i),Ci(),pt.unselectAll(),pt.select(n),n.length===1&&Ac(n[0]),Et("panel_updateAttrPanel"))}function PW(){let t=pt.get().sort(nTe),e=["rect","ellipse","group","arc"],r=vE(t,e);if(!r.length)return;let i=[],n=[],s=[];if(r.forEach(c=>{let{jsonObj:u,element:d}=c;if(u.cmdKey==="group"){n.push(d),s.push(u.d.trim());return}let A=lb(u);s.push(A.trim()),n.push(d)}),!s.length)return;Ci();let a=r.slice(-1)[0].element,{json:o}=te.getById(a.id),l=te.getInitialGroupData({gId:ni(),layer:o.layer,d:s.join(" "),strokeWidth:o.strokeWidth,strokeColor:o.strokeColor,strokeStyle:o.strokeStyle,fillColor:o.fillColor});Hi.renderer.insertBefore(l,a.id),i.push(Da(l.gId,{cmdKey:"group",refId:a.id},"",l));for(let c of n){let{cmdKey:u,json:d}=te.getById(c.id);i.push(Da(c.id,{cmdKey:u,refId:vo(c)},d,"")),te.removeOne(c)}mr.save(i),pt.select([{id:l.gId}])}function LW(){let t=pt.get(),e=["group"],r=vE(t,e);if(!r.length)return;Ci();let i=[],n=[];r.forEach(s=>{let{gId:a,jsonObj:o,element:l}=s,u=o.d.split(/(?=M)/i);for(let d of u){if(d=d.trim(),!d)continue;let A=Object.assign({},o,{d,gId:ni()}),h=qA(A);X.gCanvas.insertBefore(h,l),i.push(Da(h.id,{cmdKey:"group",refId:l.id},"",A)),n.push(h)}i.push(Da(a,{cmdKey:"group",refId:vo(l)},o,"")),te.removeOne(l)}),i.length&&mr.save(i),pt.select(n)}function OW(t){t=t||pt.get();let r=["group","arc"],i=vE(t,r);if(!i.length)return;let n=i.map(u=>{if(u.jsonObj.cmdKey=="arc"){let A=u.jsonObj.matrix&&nr.createMatrixFrom6(u.jsonObj.matrix),h=mm(u.jsonObj),f=Jn(h);return A&&(f=f.map(p=>p.multiply3(A))),{...u,polylines:f}}let d=Jn(u.jsonObj.d);return{...u,polylines:d}});n=n.filter(u=>u.polylines.some(d=>EE(d)));let s=[],a=[],o=[];n.forEach(u=>{let{gId:d,jsonObj:A,element:h,polylines:f}=u;if(f.length>1){let p=wE(f,.01);if(p.updatedItems.length){let m=p.updatedItems.map(g=>g.polylineNew),y=ql(m,!1);s.push(Da(d,{refId:vo(h),cmdKey:"group"},A,{...A,d:y})),ge(h,"d",y),A.d=y,a.push(h)}return}o.push(u)});let l=o.map(u=>u.polylines[0]),c=wE(l,.01);c.removedItems.forEach(u=>{let d=o[u.index],{gId:A,element:h}=d,{cmdKey:f,json:p}=te.getById(h.id);s.push(Da(A,{cmdKey:f,refId:vo(h)},p,"")),te.removeOne(h)}),c.updatedItems.forEach(u=>{let d=o[u.index],{gId:A,jsonObj:h,element:f}=d,p=ql([u.polylineNew],!1);s.push(Da(A,{refId:vo(f),cmdKey:"group"},h,{...h,d:p})),ge(f,"d",p),h.d=p,a.push(f)}),s.length&&(mr.save(s),Ci(),pt.select(a))}function NW(t,e){e=e||pt.get();let r=["group"],i=vE(e,r);if(!i.length)return;let n=[],s=[];i.forEach(a=>{let{gId:o,jsonObj:l,element:c}=a,u=l.d;if(!u)return;let d=t(u);d!=u&&(ge(c,"d",d),n.push(Da(o,{cmdKey:"group",refId:vo(c)},vi(l),vi(l).d=d)),l.d=d,s.push(c))}),n.length&&(mr.save(n),Ci(),pt.select(s))}function RW(t){NW(sTe,t)}function MW(t){NW(aTe,t)}var CE=pa(Um());var wl=class wl extends Fc{static exit(){this.ready=!1}static enterCutStart(e,r){this.tabId=e,this.ready=!0,this.cutStart=!0,this.clipboard=Gs(),this.objs=r,this.referencePosition=void 0,this.pasteFrom="cut",ba("setIsCutPasteFinish",[!1]),X.windowBridge.rpcCall("i18n",this.content,ur()).then(n=>{this.i18nText=n.message,this.showHelpCursor()})}static enterCopyStart(e){this.objs=e,this.ready=!0,this.cutStart=!1,this.referencePosition=void 0,this.pasteFrom="copy",X.windowBridge.rpcCall("i18n",this.content,ur()).then(i=>{this.i18nText=i.message,this.showHelpCursor()})}static showReferencePointAndText(e,r,i="",n=!1){if(!this.referenceIsSelectedReferencePoint){fc();return}this.setContent(i);let{top:s,left:a}=this.getCursorTextPosition(e,r);(n||this.ready||this.pasteFrom==="cut"&&!this.referencePosition)&&(0,CE.default)(`#${this.id}`).css({left:a+wl.offsetPosition.x,top:s+wl.offsetPosition.y}),this.updateReferencePointText(n)}static async showReferText(e){if(this.ready){this.setContent(this.content);let{currAbsX:r,currAbsY:i}=e||tl.data,{top:n,left:s}=this.getCursorTextPosition(r,i);(0,CE.default)(`#${this.id}`).css({left:s+wl.offsetPosition.x,top:n+wl.offsetPosition.y}),this.updateReferencePointText(!0)}else this.showOrHideText(!1)}static abortReferencePointMode(e=!0){this.ready&&fc(),this.ready=!1,this.cutStart=!1,Jr.clearAdsorptionHTML(),e?Ls(!1):this.showOrHideText(!1)}static setContent(e){if(!e)return!1;this.content=e}static showOrHideText(e=!0){let r=(0,CE.default)(`#${this.id}`);e?r.removeClass("hide"):r.addClass("hide")}static updateReferencePointText(e){let r=(0,CE.default)(`#${this.id}`);this.ready||e||this.pasteFrom==="cut"&&!this.referencePosition?(r.text(this.i18nText),this.showOrHideText()):this.showOrHideText(!1)}static getCursorTextPosition(e,r,i=An.getViewBox()){let s=(0,CE.default)(`#${this.id}`).height(),a=6,o=16,l=X.gZoom,c=(e-i[0])*l+a,u=(r-i[1])*l-s-o;return{left:c,top:u}}static async updateReferencePointPosition(e,r){if(!this.referencePosition){if(this.ready||this.cutStart){let i=kW({x:e,y:r}),n=i.x,s=i.y;this.referencePosition={offX:n,offY:s},X.windowBridge.publish("setReferencePosition",{offX:n,offY:s},ur()),this.ready=!1,Jr.clearAdsorptionHTML(),Ls(!1),fc(),this.cutStart?(this.cutStart=!1,!nA.isDragging&&yy()):by(this.objs,this.cutStart)}Et("updateMenuByDocStatus")}}static pasteAfterCut(){return this.pasteFrom==="cut"&&!this.ready&&!this.referencePosition}static getTabId(){return wl.tabId}static async showHelpCursor(){let{currAbsX:e,clientX:r,clientY:i,currAbsY:n}=tl.data;Ls(this.cursor,e,n),fc("",{x:e,y:n}),this.showReferText({currAbsX:e,currAbsY:n})}static endCutState(e){wl.getTabId()===e&&ba("getIsCutPasteFinish")&&(yy(!0),wl.abortReferencePointMode())}static async saveSelectObjs(){await by(this.objs)}install(){console.log(this.getSymbol(),"installed")}uninstall(){console.log(this.getSymbol(),"uninstalled")}getSymbol(){return Ps.referencePoint_tool}onMouseLeftDown(e){e.toolFinished=!0;let{canvasX:r,canvasY:i}=e;wl.updateReferencePointPosition(r,i),Ci()}onMouseRightUp(e){e.toolFinished=!0,wl.ready&&wl.abortReferencePointMode()}static canSwitchMe(){var r;let e=((r=X.profileSetting)==null?void 0:r.commSystemSetting.PANEL_CANVAS.referencePointPanelSelectMethod)==="select";return wl.referenceIsSelectedReferencePoint=e,!!wl.referenceIsSelectedReferencePoint}};wl.content="Please select a reference point",wl.id="cross-text",wl.ready=!1,wl.pasteFrom="copy",wl.cursor="cross-red",wl.referenceIsSelectedReferencePoint=!0,wl.offsetPosition={x:18,y:4};var Ys=wl;var lTe=["ellipse","group","polyline","rect","text","obj","canvas","arc","dimension","auxiliary"];function cTe(t){let e={};return lTe.forEach(r=>{Object.assign(e,t[r]?t[r]:{})}),e}var FW={"print-layer":1,"transparent-control":2,"plate-and-frame-layer":3,"plate-and-frame-hollowed-out":4,"glue-hollowed-out-back":5,"the-light-layer":6},ZS={visible:!1,hide:!0,lock:!0,unlock:!1},Ok={"fully-transparent":0,translucence:.5,opacification:1},Nk={"have-white-background":!0,"no-white-background":!1};function uTe(t){if(Array.isArray(t)||!t)return[];if(Object.keys(t).length===0)return[];let e=Object.keys(t)[0],r=t[e].checked,i=t[e].visible,n=r!==void 0,s=i!==void 0,a=te.gJsonCache,o=$u(),l=[],c=o[e]?Object.keys(o[e]):[e],u=cTe(a);for(let d=0;d<c.length;d+=1){let A=c[d],h=[];if($t(o["all-element-type"],A)&&(n&&(o["all-element-type"][A].checked=r),s&&(o["all-element-type"][A].visible=i)),$t(a,A)&&(h=Object.keys(a[A])),A==="dimension"&&(h=Object.keys(te.getDimension())),A==="dimensionLength"){let f=te.getDimensionAngle(),p=te.getDimensionLength(),m=te.getDimensionRadius();h=[...Object.keys(f),...Object.keys(p),...Object.keys(m)]}if(A==="auxiliaryLine"){let f=te.getAuxiliaryLine(),p=te.getAuxiliaryPoint();h=[...Object.keys(f),...Object.keys(p)]}if(FW[A]){$t(o["all-layer"],A)&&(n&&(o["all-layer"][A].checked=r),s&&(o["all-layer"][A].visible=i));for(let f in u)u[f].layer==FW[A]&&h.push(f)}if(ZS[A]!=null){$t(o["all-state"],A)&&(n&&(o["all-state"][A].checked=r),s&&(o["all-state"][A].visible=i));for(let f in u)switch(A){case"visible":u[f].hide==ZS[A]&&h.push(f);break;case"hide":u[f].hide==ZS[A]&&h.push(f);break;case"lock":u[f].locked==ZS[A]&&h.push(f);break;case"unlock":u[f].locked==ZS[A]&&h.push(f);break}}if(Ok[A]!==void 0){$t(o["all-pellucidity"],A)&&(n&&(o["all-pellucidity"][A].checked=r),s&&(o["all-pellucidity"][A].visible=i));for(let f in u)switch(A){case"fully-transparent":u[f].opacity==Ok[A]&&h.push(f);break;case"translucence":u[f].opacity>0&&u[f].opacity<1&&h.push(f);break;case"opacification":u[f].opacity==Ok[A]&&h.push(f);break}}if(Nk[A]!==void 0){$t(o["all-white-background"],A)&&(n&&(o["all-white-background"][A].checked=r),s&&(o["all-white-background"][A].visible=i));for(let f in u)switch(A){case"have-white-background":u[f].cover===Nk[A]&&h.push(f);break;case"no-white-background":u[f].cover==Nk[A]&&h.push(f);break}}if(A=="boundary"){let f=o["all-layer"][A];$t(o["all-layer"],A)&&(n&&(f.checked=r),s&&(f.visible=i)),Qu(Fe("panelFrameSheet"),"hide",f.visible)}l.push(...h)}for(let d of l)rn.applyElementsVisible(d)}function UW(t){let e={rectangle:"rect",circle:"ellipse"};for(let r in t){let i=e[r]||r;i!==r&&(t[i]=t[r],delete t[r])}uTe(t)}function yd(t){if(t){for(let r=0;r<t.length;r++){let i=t[r].lists;for(let n=0;n<i.length;n++){if(i[n].title=="All")continue;let s={};s[i[n].key]={checked:i[n].checked,visible:i[n].visible},UW(s)}}return}let e=$u();for(let r in e)for(let i in e[r]){let n=vi(e[r][i]),s={[i]:n};n.checked===!0&&delete n.checked,n.visible===!0&&delete n.visible,Object.keys(n).length!==0&&UW(s)}}var wu=class wu{static rotate(e,r,i,n){if(RM(e))if(bd){let s=+ge(bd,"c_rotate")||0;return ge(bd,{c_rotate:Cs(s+r)}),wu.rotateOne(bd,r,i,n)}else{let s;return e.forEach(function(a){s=wu.rotateOne(a,r,i,n)}),s}else return wu.rotateOne(e,r,i,n)}static rotateOne(e,r,i,n){if(i===void 0||n===void 0){let s=ge(e,"c_origin"),a=ge(e,"c_partid");if(a==="part_text")[i,n]=s.split(",").map(parseFloat);else if(a==="part"){let o=sp(e.querySelector(".hitbox"));i=o.x+o.width/2,n=o.y+o.height/2}else if(s){let o=s.split(",");i=+o[0],n=+o[1]}else{let o=sp(e);i=o.x+o.width/2,n=o.y+o.height/2}}return wu[e.tagName]&&wu[e.tagName](e,r,i,n),{rotateCenterX:i,rotateCenterY:n}}static groupRotate(e,r,i,n){let s,a=e.length,o,l,c;if(!a)return;if(a<2){wu.rotate(e[0],r,i,n);return}if(i!==void 0&&n!==void 0){for(s=0;s<a;s++)wu.rotate(e[s],r,i,n);return}function u(A){try{return A.getBBox()}catch{}}function d(A){if(A){let h=A.split(",");return{x:+h[0],y:+h[1]}}}for(s=0;s<a;s++)if(e[s].tagName!="text"&&!ge(e[s],"c_origin")){o=!0;break}if(o)for(s=0;s<a;s++)c=u(e[s]),c&&(l?(l.x=Math.min(l.x,c.x),l.y=Math.min(l.y,c.y),l.x2=Math.max(l.x2,c.x+c.width),l.y2=Math.max(l.y2,c.y+c.height)):l={x:c.x,y:c.y,x2:c.x+c.width,y2:c.y+c.height});else for(s=0;s<a;s++)c=d(ge(e[s],"c_origin")),!c&&e[s].tagName=="text"&&(c={x:+ge(e[s],"x"),y:+ge(e[s],"y")}),c&&(l?(l.x=Math.min(l.x,c.x),l.y=Math.min(l.y,c.y),l.x2=Math.max(l.x2,c.x),l.y2=Math.max(l.y2,c.y)):l={x:c.x,y:c.y,x2:c.x,y2:c.y});if(l)for(i=Sr((l.x+l.x2)/2,3),n=Sr((l.y+l.y2)/2,3),s=0;s<a;s++)wu.rotate(e[s],r,i,n)}static g(e,r,i,n){if(r===void 0&&(r=270),r%360===0)return;let s=ge(e,"c_origin"),a,o,l,c=s&&s.split(",");if(i===void 0||n===void 0?c?(i=+c[0],n=+c[1]):(a=e.getBBox(),i=a.x+a.width/2|0,n=a.y+a.height/2|0):c&&(o=[+c[0],+c[1]],o=Lc(o,r,i,n),ge(e,"c_origin",o.join(","))),s&&(l=Cs(+(ge(e,"rotation")||0)),l=Cs(l-r),ge(e,"rotation",l)),Pi(e)==="text"){let A=Ue.rotateD(r).setOrigin(i,n);console.error("err")}else{let A=e.children||e.childNodes,h=A.length,f;for(f=0;f<h;f++)wu.rotate(A[f],r,i,n)}}static svg(e,r,i,n){let s=ge(e,"x"),a=ge(e,"y");if(i===void 0||n===void 0)wu.rotate(e,r,+s,+a);else if(s===null||a===null){let o=e.children||e.childNodes,l=o.length;for(let c=0;c<l;c++)wu.hasOwnProperty(o[c].tagName)&&wu.rotate(o[c],r,i,n)}else s!==null&&a!==null&&wu.image(e,r,i,n)}static rect(e,r,i,n){let s=te.getById(e.id).json;vn.syncRectByRotation(r,s,new ne(i,n))}static image(e,r,i,n){if(r===0||!ge(e,"xlink:href"))return;if(i===void 0||n===void 0){let o=sp(e);i=Sr(o.x+o.width/2,3),n=Sr(o.y+o.height/2,3)}let a=Ue.rotateD(-r).setOrigin(i,-n);Ns.syncImage(te.gJsonCache.obj[e.id],a)}static circle(e,r,i,n){let s=[+ge(e,"cx"),+ge(e,"cy")];s=Lc(s,r,i,n),ge(e,{cx:s[0],cy:s[1]})}static ellipse(e,r,i,n){let s=[+ge(e,"cx"),+ge(e,"cy")];if(s=Lc(s,r,i,n),ge(e,{cx:s[0],cy:s[1]}),r%90){X.windowBridge.publish("message",{type:"error",message:"Rectangle and Ellipse do not support non-90 degree rotation. Please convert to path before rotating."},ur());return}if(r%180&&!(r%90)){let a=ge(e,"rx"),o=ge(e,"ry");ge(e,{rx:o,ry:a})}}static line(e,r,i,n){let s=[+ge(e,"x1"),+ge(e,"y1"),+ge(e,"x2"),+ge(e,"y2")];s=Lc(s,r,i,n),ge(e,{x1:s[0],y1:s[1],x2:s[2],y2:s[3]})}static polyline(e,r,i,n){r===void 0&&(r=270);let s=Yf(ge(e,"points")).split(/[\s\,]+/);s=Lc(s,r,i,n),ge(e,{points:s.join(" ")})}static polygon(e,r,i,n){wu.polyline(e,r,i,n)}static path(e,r,i,n){if(r%360===0)return;if(ge(e,"c_partid")==="arc"){let y=kL(e);y=Lc(y,r,i,n),ge(e,{"third-point":y[4]+","+y[5]})}r=Cs(r);let s=Yd,a=e.pathSegList,o=a.numberOfItems,l,c,u,d,A,h,f,p,m;for(let y=0;y<o;y++)if(l=null,c=a.getItem(y),u=c.pathSegType,m=u%2===0,!(u==dz||u==Ri)){switch(m?(d=u,A=i,h=n):(d=u-1,A=0,h=0),c._owningPathSegList=null,d){case Ds:l=Lc([c.x,c.y],r,A,h),c.x=l[0],c.y=l[1];break;case ka:l=Lc([c.x,c.y],r,A,h),c.x=l[0],c.y=l[1];break;case $h:l=Lc([c.x,c.y,c.x1,c.y1,c.x2,c.y2],r,A,h),c.x=l[0],c.y=l[1],c.x1=l[2],c.y1=l[3],c.x2=l[4],c.y2=l[5];break;case ed:l=Lc([c.x,c.y,c.x1,c.y1],r,A,h),c.x=l[0],c.y=l[1],c.x1=l[2],c.y1=l[3];break;case ju:l=Lc([c.x,c.y],r,A,h),c.x=l[0],c.y=l[1],c.r1!=c.r2?c.angle=Cs(c.angle+r):c.angle=0;break;case rd:r==180?c.x=m?i+i-c.x:-c.x:(f=H1[r],m?p=e.createSVGPathSegLinetoVerticalAbs((c.x-i)*f+n):p=e.createSVGPathSegLinetoVerticalRel(c.x*f),a.replaceItem(p,y));break;case id:r==180?c.y=m?n+n-c.y:-c.y:(f=H1[r],m?p=e.createSVGPathSegLinetoHorizontalAbs(i-(c.y-n)*f):p=e.createSVGPathSegLinetoHorizontalRel(-c.y*f),a.replaceItem(p,y));break;case Zh:l=Lc([c.x,c.y,c.x2,c.y2],r,A,h),c.x=l[0],c.y=l[1],c.x2=l[2],c.y2=l[3];break;case td:l=Lc([c.x,c.y],r,A,h),c.x=l[0],c.y=l[1];break;default:break}c._owningPathSegList=a}a.segmentChanged()}};wu.pinTextNeedInvert=!1;var ML=wu;var Dh={point:function(t,e,r){return e!==null&&(t.x=2*e-t.x),r!==null&&(t.y=2*r-t.y),t},element:function(t,e,r){t.tagName&&Dh[t.tagName](t,e,r)},elementsFlipH:function(t,e){if(t.length===0)return;let r,i;if(e==null){let n=Number.MAX_VALUE,s=-Number.MAX_VALUE;for(r=0,i=t.length;r<i;r++)try{let a=t[r].getBBox();a.x<n&&(n=a.x),a.x+a.width>s&&(s=a.x+a.width)}catch{let o=ge(t[r],"c_origin");if(o){let l=+o.split(",")[0];l<n?n=l:l>s&&(s=l)}}e=(n+s)/2}for(r=0,i=t.length;r<i;r++)Dh[t[r].tagName](t[r],e,null);return e},elementsFlipV:function(t,e){if(!t.length)return;let r,i;if(e==null){let n=Number.MAX_VALUE,s=-Number.MAX_VALUE;for(r=0,i=t.length;r<i;r++)try{let a=t[r].getBBox();a.y<n&&(n=a.y),a.y+a.height>s&&(s=a.y+a.height)}catch{let o=ge(t[r],"c_origin");if(o){let l=+o.split(",")[1];l<n?n=l:l>s&&(s=l)}}e=(n+s)/2}for(r=0,i=t.length;r<i;r++){let n=t[r].tagName;Dh[n](t[r],null,e)}return e},flipH:function(t,e){return t instanceof NodeList||Array.isArray(t)?Dh.elementsFlipH(t,e):Dh.elementsFlipH([t],e)},flipV:function(t,e){return t instanceof NodeList||Array.isArray(t)?Dh.elementsFlipV(t,e):Dh.elementsFlipV([t],e)},g:function(t,e,r){if(Pi(t)==="text"){let n;e!==null?n=Ue.MIRROR_X.setOrigin(e,0):n=Ue.MIRROR_Y.setOrigin(0,r),ps.syncText(te.getById(t.id).json,n,{updateMatrix:!0})}else{let n=ge(t,"c_origin"),s,a,o,l;n&&(s=n.split(","),l={x:+s[0],y:+s[1]},Dh.point(l,e,r),ge(t,"c_origin",l.x+","+l.y));let c=Cs(+(ge(t,"rotation")||0));e!==null&&c%180===0&&(c=Cs(c+180)),r!==null&&c%180!==0&&(c=Cs(c+180)),ge(t,"rotation",c);let u=t.children||t.childNodes;for(o=u.length,a=0;a<o;a++){let d=u[a].tagName;d&&$t(ML,d)&&Dh[d](u[a],e,r)}}},rect:function(t,e,r){let i=te.getRect(t.id);if(e!==null){let n=Ue.MIRROR_X.setOrigin(e,0);vn.syncRect(i,n,{updateMatrix:!0})}if(r!==null){let n=Ue.MIRROR_Y.setOrigin(0,r);vn.syncRect(i,n,{updateMatrix:!0})}},image(t,e,r){let i=te.gJsonCache.obj[t.id];if(!Ir(e)){let n=Ue.MIRROR_X.setOrigin(e,0);Ns.syncImage(i,n)}if(!Ir(r)){let n=Ue.MIRROR_Y.setOrigin(0,r);Ns.syncImage(i,n)}},obj:function(t,e,r){let i=te.gJsonCache.obj[t.id];if(e!==null){let n=Ue.MIRROR_X.setOrigin(e,0);Ns.syncImage(i,n)}if(r!==null){let n=Ue.MIRROR_Y.setOrigin(0,r);Ns.syncImage(i,n)}},circle:function(t,e,r){let i=te.getEllipse(t.id);if(e!==null){let n=Ue.MIRROR_X.setOrigin(e,0);tn.syncEllipse(i,n,{updateMatrix:!0})}if(r!==null){let n=Ue.MIRROR_Y.setOrigin(0,r);tn.syncEllipse(i,n,{updateMatrix:!0})}},ellipse:function(t,e,r){Dh.circle(t,e,r)},line:function(t,e,r){e!==null&&(ge(t,"x1",2*e-ge(t,"x1")),ge(t,"x2",2*e-ge(t,"x2"))),r!==null&&(ge(t,"y1",2*r-ge(t,"y1")),ge(t,"y2",2*r-ge(t,"y2")))},polyline:function(t,e,r){let i=Yf(ge(t,"points")).split(/[\s\,]+/),n,s;if(e!==null){let a=2*e;for(n=0,s=i.length-1;n<s;n+=2)i[n]=a-i[n]}if(r!==null){let a=2*r;for(n=0,s=i.length-1;n<s;n+=2)i[n+1]=a-i[n+1]}ge(t,{points:i.join(" ")})},polygon:function(t,e,r){Dh.polyline(t,e,r)},arc(t,e,r){let i=Ue.MIRROR_X.setOrigin(e,0);Ir(r)||(i=Ue.MIRROR_Y.setOrigin(0,r)),ls.syncArc(t,i,{updateD:!0})},path(t,e,r){let{cmdKey:i,json:n}=te.getById(t.id);if(i==="arc")return Dh.arc(n,e,r);let s;Yd&&(s=!0);let a=t.pathSegList,o=a.numberOfItems,l,c=2*e,u=2*r,d,A,h,f;if(e!==null){for(f=0;f<o;f++)switch(l=a.getItem(f),l.pathSegType){case SVGPathSeg.PATHSEG_MOVETO_ABS:case SVGPathSeg.PATHSEG_LINETO_ABS:case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:l.x=c-l.x;break;case SVGPathSeg.PATHSEG_MOVETO_REL:case SVGPathSeg.PATHSEG_LINETO_REL:case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:l.x=-l.x;break;case SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:case SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:l.x=c-l.x,l.x1=c-l.x1,l.x2=c-l.x2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:l.x=-l.x,l.x1=-l.x1,l.x2=-l.x2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:l.x=c-l.x,l.x2=c-l.x2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:l.x=-l.x,l.x2=-l.x2;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:l.x=c-l.x,l.x1=c-l.x1;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:l.x=-l.x,l.x1=-l.x1;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:l.x=c-l.x;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:l.x=-l.x;break;case SVGPathSeg.PATHSEG_ARC_ABS:l.x=c-l.x,l.sweepFlag=1-l.sweepFlag;break;case SVGPathSeg.PATHSEG_ARC_REL:l.x=-l.x,l.sweepFlag=1-l.sweepFlag;break;default:break}if(d=ge(t,"c_helper_dots"),d){for(A=d.split(/[\s\,]+/),f=0,o=A.length-1;f<o;f+=2)A[f]=c-A[f];h=A.splice(4,2),A.push(h[0],h[1]),ge(t,"c_helper_dots",A.join(","))}}if(r!==null){for(f=0;f<o;f++)switch(l=a.getItem(f),l.pathSegType){case SVGPathSeg.PATHSEG_MOVETO_ABS:case SVGPathSeg.PATHSEG_LINETO_ABS:case SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:l.y=u-l.y;break;case SVGPathSeg.PATHSEG_MOVETO_REL:case SVGPathSeg.PATHSEG_LINETO_REL:case SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:l.y=-l.y;break;case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:l.y=u-l.y,l.y1=u-l.y1,l.y2=u-l.y2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:l.y=-l.y,l.y1=-l.y1,l.y2=-l.y2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:l.y=u-l.y,l.y2=u-l.y2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:l.y=-l.y,l.y2=-l.y2;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:l.y=u-l.y,l.y1=u-l.y1;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:l.y=-l.y,l.y1=-l.y1;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:l.y=u-l.y;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:l.y=-l.y;break;case SVGPathSeg.PATHSEG_ARC_ABS:l.y=u-l.y,l.sweepFlag=1-l.sweepFlag;break;case SVGPathSeg.PATHSEG_ARC_REL:l.y=-l.y,l.sweepFlag=1-l.sweepFlag;break;default:break}if(d=ge(t,"c_helper_dots"),d){for(A=d.split(/[\s\,]+/),f=0,o=A.length-1;f<o;f+=2)A[f+1]=u-A[f+1];h=A.splice(4,2),A.push(h[0],h[1]),ge(t,"c_helper_dots",A.join(","))}}if(ge(t,"c_partid")==="arc"&&ge(t,"third-point")){let p=ge(t,"third-point").split(",");e!==null?ge(t,{"third-point":c-p[0]+","+p[1]}):r!==null&&ge(t,{"third-point":p[0]+","+(u-p[1])})}n.d=ge(t,"d"),te.changedJsoncache(n.gId,i)}};var SE=class{constructor(e){this.data=e}toData(){}setData(){}render(){let{gId:e,x:r,y:i}=this.data,n=Fe(e);n==null||n.setAttribute("cx",String(r)),n==null||n.setAttribute("cy",String(i))}unmount(){Cr(Fe(this.data.gId))}multiply3(e){let r=new ne(this.data.x,this.data.y),{x:i,y:n}=r.multiply3(e);this.data.x=i,this.data.y=n,this.render()}rotateSelf(e,r){let i=Ue.rotateD(e).setOrigin1(r);this.multiply3(i)}flipH(e){let r=(e.x-this.data.x)*2,i=Ue.translate(r,0);this.multiply3(i)}flipV(e){let r=(e.y-this.data.y)*2,i=Ue.translate(0,r);this.multiply3(i)}};var sA=class{constructor(e){this.eles=e}mirror(e,r){this.isH=e,this.center=r;for(let i of this.eles){let{json:n,cmdKey:s}=te.getById(i.id);switch(s){case"dimensionAngle":this.mirrorDimensionAngle(n,r,e);break;case"dimensionLength":this.mirrorDimensionLength(n);break;case"dimensionRadius":this.mirrorDimensionRadius(n);break;case"auxiliaryLine":this.mirrorAuxiliaryLine(n);break;case"auxiliaryPoint":this.mirrorAuxiliaryPoint(n);break;case"group":this.mirrorGroup(n);break;default:e?Dh.flipH([i],r.x):Dh.flipV([i],r.y);break}}}mirrorGroup(e,r=this.center,i=this.isH){let n=Ue.MIRROR_Y.setOrigin(0,r.y);i&&(n=Ue.MIRROR_X.setOrigin(r.x,0)),To.syncGroup(e,n,{updateD:!0,fn(){i?e.rotation=-Cs(360+e.rotation):e.rotation=-Cs(e.rotation+360)}})}mirrorDimensionRadius(e,r=this.center,i=this.isH){let n=new ca(e),s=Ue.MIRROR_Y.setOrigin(0,r.y);i&&(s=Ue.MIRROR_X.setOrigin(r.x,0)),n.multiply3(s)}mirrorDimensionLength(e,r=this.center,i=this.isH){let n=new ya(e),s=Ue.MIRROR_Y.setOrigin(0,r.y);i&&(s=Ue.MIRROR_X.setOrigin(r.x,0)),n.multiply3(s)}mirrorDimensionAngle(e,r,i){let n=new ga(e);i?n.flipH(r):n.flipV(r)}mirrorAuxiliaryLine(e,r=this.center,i=this.isH){let n=new dd(e);i?n.flipH(r):n.flipV(r)}mirrorAuxiliaryPoint(e,r=this.center,i=this.isH){let n=new SE(e);i?n.flipH(r):n.flipV(r)}};var FL=class extends Fc{constructor(r,i,n){super();this.prepareFinish=!1;this.accmulate=new ne(0,0);this.jsonSnapshot=new qi;this.copiedCombination=[];this.oldIdMapNewId=new Map;this.type=r,this.nodes=i,this.reference=n}static async canSwitchMe(r){if(op())return!1;if(!r){let i=await bb();if(!i)return!1;let n=kc(i),a=[...document.importNode(n.documentElement,!0).childNodes];return a.length?a.some(l=>{let c=UL(l);return!c.start&&!c.end}):!1}return!0}install(r){console.log(this.getSymbol(),"installed"),this.prepare(r)}uninstall(r){console.log(this.getSymbol()," uninstalled"),this.removeCopiedNodes()}getSymbol(){return Ps.paste_tool}async prepare(r){this.prepareFinish=!1,mr.startBatch();let i;this.type==="paste_dxf"?i=Rk(this.nodes,this.reference):i=await this.pasteFromGlobalClipboard(this.type)||{};let{targets:n,x:s,y:a}=i;this.nodes=n,this.lastX=s,this.lastY=a,this.prepareFinish=!0}rotate(r){$i.createContext();let i=Bh(this.nodes).filter(n=>te.getById(n.id).cmdKey!=="auxiliaryLine");up(i,r),$i.runTask()}flipH(){$i.createContext();let r=Bh(this.nodes),i=_h(r,!0,{ignoreSnap:!0});new sA(r).mirror(!0,i),$i.runTask()}flipV(){$i.createContext();let r=Bh(this.nodes),i=_h(r,!0,{ignoreSnap:!0});new sA(r).mirror(!1,i),$i.runTask()}onMouseMove(r){if(!this.prepareFinish)return;if(!this.nodes)return mr.cancelSaveBatch(),r.toolFinished=!0;let{originalEvent:i}=r;$f.altKeyEnabled=r.altKeyDown;let{x:n,y:s}=Hn(i,!0),a=n-this.lastX,o=s-this.lastY;(a||o)&&(Vg(this.nodes,a,o),this.lastX+=a,this.lastY+=o,this.accmulate=this.accmulate.add1(a,o))}onMouseLeftDown(r){if(!this.prepareFinish)return;r.toolFinished=!0,rh(this.nodes),pt.unselectAll().select(this.nodes);let i=this.jsonSnapshot;new gr().pasteCombination(i,this.copiedCombination,this.oldIdMapNewId,this.nodes),mr.saveBatch(),new rs().updateHole(),i.updateAndSave(),Ls(),this.nodes=[],Jr.clearAdsorptionHTML(),Jr.clearExcludeShapeIds(),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE),Et("panel/updateTreeActiveElements"),Et("panel_updateAttrPanel"),X.doctype===si.PANEL&&X.windowBridge.rpcCall(U1.LOG.SET,[{type:mC.PRIMITIVE_PASTE_ACROSS_PROJECT,content:[{"Panel Name":te.gJsonCache.head.display_title}],project_uuid:X.currentProject.projectId}],ur())}onMouseLeftUp(r){this.type==="ctrl_drag_copy2"&&this.onMouseLeftDown(r)}onMouseRightUp(r){this.prepareFinish&&(Fg.dragpanning||(r.toolFinished=!0,this.cancelPaste()))}onKeyUp(r){if(!this.prepareFinish)return;let{keyCode:i}=r;switch(i){case"Escape":r.toolFinished=!0,this.cancelPaste();break;default:break}}async pasteFromGlobalClipboard(r){var d;let i,n,s;if(r)s=[...pt.get()];else{((d=X.profileSetting)==null?void 0:d.commSystemSetting.PANEL_CANVAS.referencePointPanelSelectMethod)==="select"&&Ys.ready&&(X.windowBridge.publish("setReferencePosition",void 0,ur()),Ys.pasteAfterCut()?await yy():await by(Gs())),i={offX:0,offY:0};let h=await bb(),f=kc(h);n=document.importNode(f.documentElement,!0),s=[...n.childNodes];let p=ge(n,"projectId"),{message:m}=await X.windowBridge.rpcCall("getActiveProject",null,ur());m!==p?tb("referencePosition")&&tb("referencePosition")!=="undefined"?i=JSON.parse(tb("referencePosition")):i=void 0:i=(await X.windowBridge.rpcCall("getReferencePosition",null,ur())).message}let a=[],o=[],l=[],c=new Map;this.copiedCombination=l,this.oldIdMapNewId=c;for(let A=0,h=s.length;A<h;A++){let f=s[A],p=Pi(f),m=UL(f)||vi(te.gJsonCache[p][f.id]),y=ni();if(c.set(m.gId,y),m.gId=y,m.visible=!0,p==="combination")l.push(m);else if(p==="dimension")o.push(m);else{let g=Hc(p,m);a.push(g)}}for(let A of o){let h=A.start.id,f=A.end.id,p=c.get(h),m=c.get(f);if(p&&m){A.start.id=p,A.end.id=m;let y=Hc("dimension",A);a.push(y)}}let u=Rk(a,i);return ba("setIsCutPasteFinish",[!0]),Ys.abortReferencePointMode(!1),Ys.pasteAfterCut()&&yy(!0),u}removeCopiedNodes(){var r;(r=this.nodes)!=null&&r.length&&(te.removeMultiData(this.nodes),pt.unselect(this.nodes))}cancelPaste(){rh(this.nodes,"cancel"),this.removeCopiedNodes(),Ls(),Jr.clearExcludeShapeIds(),Jr.clearAdsorptionHTML(),mr.cancelSaveBatch()}};FL=Uu([gu(Ya.paste)],FL);function UL(t){return JSON.parse(ge(t,"jsonCache"))}var HW="panel-copy-json";async function yy(t=!1){let e=Gs();Ys.referenceIsSelectedReferencePoint&&Ys.clipboard&&(e=Ys.clipboard);let i=[...el.findDimensionByPrimitiveIds(new Set(e.map(o=>o.id))).map(o=>Fe(o.gId)),...e],{combinations:n,elements:s}=new gr().getSelectedCombinations(i.map(o=>o.id));if(Rs.hasEleLocked(s)||Rs.hasEleLocked(n)){JA();return}!t&&await by(i,!0);let a=new qi(i);for(let o of n)te.deleteCombInParent(o).setCombination(o);te.removeMultiData(i),ms.removeCombinationElmsHighlightStroke(),a.updateAndSave(),Et("panel_updateAttrPanel"),Et("updateMenuByDocStatus")}async function by(t,e){let r=t.length;if(!t||!r)return;let i=(await X.windowBridge.rpcCall("getActiveProject",null,ur())).message,n=Hr("g",{doctype:X.doctype,projectId:i}),s=te.getItemOrderSortMap();t.sort((u,d)=>s.get(u.id)-s.get(d.id));let a=new Set,o=new gr;for(let u of t){let{json:d,cmdKey:A}=te.getById(u.id),h=o.searchCombination(u.id);if(h){let p=Li.getCurrentEditingComId(),m=o.findFamily(h,p).getAllParents();for(let y of m){if(Li.getCurrentEditingComId()===y||a.has(y))continue;a.add(y);let g=te.getCombination(y),b=Hr("g",{c_partid:"combination",jsonCache:JSON.stringify(g)});n.appendChild(b)}}let f=Hr("g",{c_partid:A,jsonCache:JSON.stringify(d)});pt.unselect(f),pt.unhighlight(f),n.appendChild(f)}let l=new XMLSerializer().serializeToString(n),{message:c}=await pd(U1.CLIP_BOARD.SET,[HW,l]);Et("updateMenuByDocStatus"),c&&Et("ui/toastMsg",{type:"success",msg:e?"Cut Success!":"Copy Success!",timer:3})}async function bb(){return(await pd(U1.CLIP_BOARD.GET,[HW])).message}function Rk(t,e){if(!t||!t.length)return;let r=t.length;Ci();for(let A=-1;++A<r;){let h=+ge(t[A],"layer");Ar.appendTargetLayer(t[A],h),Jr.setExcludeShapeIds([t[A].id])}let i=la(t);if(!e||Object.keys(e).length===0||e==="center"){let A=i.x,h=i.y+i.height;if(e==="center"&&(A=i.x+i.width/2,h=i.y+i.height/2),r===1&&Pi(t[0])==="text"){let{x:f,y:p}=ps.getTextOrigin(t[0].id);A-=f,h-=p}e={offX:A,offY:h}}var n=eT(),s=tl.data.clientX||n.clientWidth/2,a=tl.data.clientY||n.clientHeight/2;let o=yS({x:s,y:a}),l={x:e.offX,y:e.offY},c=rA({x:o.x,y:o.y}),u=c.x-l.x,d=c.y-l.y;return Vg(t,u,d),l&&Ls("cross-red",l.x+u,l.y+d,{enforceEnterRefPoint:!0}),{targets:t,...c}}async function GW(){let t=new qi,e=[],r=new Map,i=[],n=await bb(),s=kc(n),o=[...document.importNode(s.documentElement,!0).childNodes],l=[];for(let c of o){let u=UL(c),d=u.gId,A=u.cmdKey;if(u.gId=ni(),r.set(d,u.gId),A==="combination")e.push(u);else if(A==="dimension")i.push(u);else{let h=Hc(A,u);t.addOne(u,{},A),l.push(h)}}for(let c of i){let u=c.start.id,d=c.end.id,A=r.get(u),h=r.get(d);if(A&&h){c.start.id=A,c.end.id=h;let f=Hc("dimension",c);l.push(f)}}new gr().pasteCombination(t,e,r),t.updateAndSave(),pt.unselectAll(),pt.select(l),gu(Ya.pasteInPlace)(null)}function YW(){let t=pt.get().slice();if(!t.length)return;Ci(),pt.unselectAll();let e=new qi,{oldIdMapNewId:r,copiedCombination:i}=new gr().getAffectedCombinations(t.map(n=>n.id));t.map(n=>{let{json:s,cmdKey:a}=te.getById(n.id),o=vi(s);o.gId=ni(),Hi.renderer.insertBefore(o,te.getRefId(n.id)),r.set(s.gId,o.gId),e.addOne(o,{},a),pt.select([{id:o.gId}])}),new gr().pasteCombination(e,i,r),e.updateAndSave(),yd()}var TE=class{static async do(e,r=null){let i=new Map,n=[],s=[],a=[];this.snap=new qi;for(let o in e)for(let l in e[o]){let c=vi(e[o][l]),u=ni();if(i.set(c.gId,u),c.gId=u,c.visible=!0,o==="combination")n.push(c);else if(o==="dimension")s.push(c);else{o==="text"&&/\d$/.test(c.key)&&(c.key=c.name=c.key.replace(/(\d$)/,A=>++A),c.d="",await $a.fixStringPath(c));let d=Hc(o,c);a.push(d),this.snap.addOne(c,{},o)}}return r=r||new ne(0,la(a).height||zt.adsorbGrid.gridSize),HL(a,r,{saveHistory:!1}),new gr().pasteCombination(this.snap,n,i),this.snap.updateAndSave(),Mk(),pt.select(a),{nodes:a,movement:r}}};TE=Uu([gu(Ya.duplicateTo)],TE);function VW(t){let e=t.style;for(let r=0;r<e.length;r++){let i=e[r],n=e[i];n=n.replace(/px/g,""),ge(t,i,n)}}function kk(){let e=kc(new XMLSerializer().serializeToString(X.gCanvas)).getElementById("g1"),r=e.children;for(let g of Array.from(r))ge(g,"hide")==1?e.removeChild(g):VW(g);let i;for(;i=Hs(".hitbox",e);)Cr(i);let n=Fe("panelFrameSheet").cloneNode(!0);e.insertBefore(n,e.firstElementChild);let s=X.gCanvas.parentNode.querySelectorAll("defs"),a=Array.from(s).map(g=>new XMLSerializer().serializeToString(g)).join(""),o=10,{x:l,y:c,width:u,height:d}=El(e),A=document.body.style.backgroundColor,h=Yl(u+2*o),f=Yl(d+2*o),p=`${l-o} ${c-o} ${u+2*o} ${d+2*o}`,m=new XMLSerializer().serializeToString(e),y=Array.from(document.styleSheets).reduce((g,b)=>{if(b instanceof CSSStyleSheet&&!b.href&&!b.disabled)try{g+=Array.from(b.cssRules).map(E=>mg(E.cssText)).join("")}catch(E){console.warn("ERROR",E)}return g},"");return`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="background-color:${A};stroke-linecap:round;stroke-linejoin:round;" width="${h}mm" height="${f}mm" viewBox="${p}"><style>${y}</style>${a}${m}</svg>`}var Fk={text:"Text",obj:"Image",rect:"Rect",ellipse:"Ellipse",group:"Shape",dimension:"Dimension",auxiliaryPoint:"Auxiliary Point",auxiliaryLine:"Auxiliary Line",dimensionLength:"Dimension Length",dimensionRadius:"Dimension Radius",dimensionAngle:"Dimension Angle",arc:"Elliptical Arc"};function hTe(t){return t.map(dTe).filter(fTe)}function dTe(t){let{cmdKey:e,json:r}=te.getById(t);if(!e)return;let i=Fk[e];if(!i||!r||!Object.keys(r).length)return;let s={id:r.gId,name:r.name||"",layer:+r.layer,type:i,text:r.id||r.gId,dataURL:"",visible:r.visible,eyeGrayType:rn.isEyeGray(r,e),lock:r.locked};if(i==="Dimension"){let a;r.direction==="x"?a="Horizontal Dimension":r.direction==="y"?a="Vertical Dimension":a="Dimension";let o={category:r.category,dimensionType:a};Object.assign(s,o)}return i==="Auxiliary Line"&&(s.type=IP(r.rotation)),s}function ATe(t){return!!t}function fTe(t){return ATe(t)}var IE=class{static set all(e){this._all=e;for(let r in this.layer)this.layer[r]=e}static get all(){return this._all}static setLayer(e,r){this.layer[e]=r,this._all=!Object.values(this.layer).some(i=>!i)}};IE.layer={4:!0,2:!0,1:!0,3:!0,5:!0,6:!0,7:!0,8:!0},IE._all=!0;function jW(){let t=hTe([...te.getItemOrder()].reverse()),e=[8,4,3,7,2,1,5,6].reduce((n,s)=>(n.set(s,[]),n),new Map);t.forEach(n=>e.get(n.layer).push(n));let r=[...e.keys()].map(n=>{let s=e.get(n);return{layer:n,i18n:!0,name:$Q[n],list:s,iconColor:"orange",type:"PanelLayer",visible:IE.layer[n]}});return[{name:ba("getActiveFileTitle"),type:"Panel",iconColor:X.doctype===si.PANEL_LIB?"":"primaryBlue",visible:IE.all,list:r}]}var ih=class{constructor(){this.id="panelFrameSheet"}init(e){let r=e.docType===si.PANEL_LIB?"none":"";this.isHidden()&&(r="none"),Hi.renderer.removeNode(this.id);let i=Hr("path",{id:this.id,fill:"none",stroke:"red","stroke-width":"1","pointer-events":"none","vector-effect":"non-scaling-stroke",display:r});return X.gCanvas.parentNode.insertBefore(i,X.gCanvas.nextElementSibling),this.update(),i}update(){Hi.renderer.attr(this.id,"d",this.getPanelMarkPathDForDesign())}getPanelMarkPathDForDesign(){let{w:e,h:r}=this.getMaterialFrameSize(),i=this.getMarkSize(),n={x:0,y:0},s={x:e,y:0},a={x:e,y:-r},o={x:0,y:-r},l=`M 0 0 H ${e} V ${-r} H 0 Z `;return l+=`M ${n.x} ${n.y} l ${i} ${-i} l ${-i} 0 l ${i} ${i} l 0 ${-i}`,l+=`M ${s.x} ${s.y} l ${-i} ${-i} l 0 ${i} l ${i} ${-i} l ${-i} 0`,l+=`M ${a.x} ${a.y} l ${-i} ${i} l 0 ${-i} l ${i} ${i} l ${-i} 0`,l+=`M ${o.x} ${o.y} l ${i} ${i} l 0 ${-i} l ${-i} ${i} l ${i} 0`,l.trim()}getBBox(){let e=new pr;for(let n of this.getMarksBBox())e.ext10(n);let r=e.build();return{x:r.minX,y:r.minY,width:r.width(),height:r.height()}}getAllInfo(){return{BBox:this.getBBox(),isHidden:this.isHidden(),path:this.getPanelMarkPathDForDesign()}}display(e){Hi.renderer.attr(this.id,"display",e?"":"none")}isHidden(){return Ar.getCurrentScheme().options.find(r=>r.id===-1).visible===!1}getMarkSize(){let e=ti(10,"mm","pixel"),r=ti(2.5,"mm","pixel"),i=ti(10,"mm","pixel");return e+r+i/2}getMarksBBox(){let e=[],{w:r,h:i}=this.getMaterialFrameSize(),n=this.getMarkSize();return e.push({x:0,y:-n,width:n,height:n}),e.push({x:0,y:-i,width:n,height:n}),e.push({x:r-n,y:-n,width:n,height:n}),e.push({x:r-n,y:-i,width:n,height:n}),e}getMaterialFrameSize(){let{width:e,height:r}=te.getHead(),i=ti(parseFloat(e),"mm","pixel"),n=ti(parseFloat(r),"mm","pixel");return{w:i,h:n}}};var BE=class BE{static refreshCanvas(e){let r={},i=!1,n=An.getCanvasAttrs();n["attr-canvas-bgcolor"]!==e.background&&(r["attr-canvas-bgcolor"]=e.background,i=!0),n["attr-canvas-grid-color"]!==e.grid&&(r["attr-canvas-grid-color"]=e.grid,i=!0),i&&An.modify_canvas(r)}static updateGlobalTheme(e){let i=document.getElementById("themeStyle").sheet,n=BE.getRootRuleIndex(i);n!=-1&&i.deleteRule(n);let s=SL(e);return i.insertRule(s),i}static getRootRuleIndex(e,r=":root"){let i=e.cssRules||e.rules,n=-1;for(let s=0,a=i.length;s<a;s++)if(i[s].selectorText===r){n=s;break}return n}static setTheme(e=X.profileSetting.commSystemSetting.PANEL_THEME){let r=e||X.panelThemeCache;this.rebuildPanelThemeCache(e);let{color:i}=r;this.refreshCanvas(i),this.updateGlobalTheme(r)}static rebuildPanelThemeCache(e){X.panelThemeCache=e}};BE.customizeKey="customize",BE.blackKey="black",BE.whiteKey="white";var xb=BE;function QW(t){let e={key:0,text:"No",value:"inherit"};return(t=="underline"||t=="1")&&(e={key:0,text:"Yes",value:"underline"}),(t=="inherit"||t=="0")&&(e={key:1,text:"No",value:"inherit"}),e}var Uk={text:"text",arc:"arc",rect:"rect",polyline:"line",group:"line",circle:"circle",line:"line",ellipse:"ellipse",auxiliaryPoint:"auxiliaryPoint",auxiliaryLine:"auxiliaryLine"};async function zW(){let t=(await X.windowBridge.rpcCall("getProfileSetting","",ur())).message,e=(await pd("getPanelFilterConfigDetail",[X.tabId])).message;yd(e);let r=+t.commSystemSetting.PANEL_CANVAS.panel_gridSize;r=lu(r);let i=+t.commSystemSetting.PANEL_CANVAS.panelAltSnapGridSize;i=lu(i),V0("adsorbGrid","distanceX",r),V0("adsorbGrid","distanceY",r),V0("adsorbGrid","gridSize",r),V0("adsorbGrid","altSnapSize",i),$t(t,"commSystemSetting")?X.profileSetting=t||{}:(X.profileSetting||(X.profileSetting={}),X.profileSetting.commSystemSetting=t);let n=X.profileSetting,s=n.commSystemSetting.OBJECT;if(s){let a=s.theme.activeTheme||"color";s.theme[a]&&(zt.canvas.bgColor=s.theme[a].color.background,zt.canvas.gridColor=s.theme[a].color.grid)}n.commSystemSetting.PANEL_CANVAS.gridStyle&&(n.commSystemSetting.PANEL_CANVAS.gridStyle==="not"?zt.adsorbGrid.visible=!1:(zt.adsorbGrid.visible=!0,zt.adsorbGrid.gridType=n.commSystemSetting.PANEL_CANVAS.gridStyle)),n.commSystemSetting.PANEL_CANVAS.gridSize&&(zt.adsorbGrid.gridSize=n.commSystemSetting.PANEL_CANVAS.gridSize),X.windowBridge.publish("tabChange",{tabId:X.tabId,docType:X.doctype},ur())}function DE(){return"rightClickEnd"}async function XW(t,e,r){var h,f;GL(0);let i=(await X.windowBridge.rpcCall("getActiveProject",null,ur())).message,n=e===i,s=te.compilerManager;if(!te.compilerManager){let p=pC.PANEL_LIB===r.docType,m=new q2(p);if(s=new cp(t,e,n,m),!(await s.init()).success)return}let a=await s.getJsonCache();if(!a){console.error("no jsonCache, Plz check code");return}let{width:o,height:l}=a.head;(Number(o)<=0||Number(l)<=0)&&(s.uploadData("canvas",JS),await s.save()),GL(.5),s.pauseDateMerge(),te.compilerManager=s,te.selectedRepeater=s.selectRepeater,An.clear(),qW(a),ja().setOriginXY(),An.initCanvasSize(r),await zW();let c=await Ba.toSVG(a);r.docType&&(X.doctype=r.docType,te.gJsonCache.head.docType=r.docType);let u=kc(c);if(!u){console.error("Invalid Xml",c);return}let d=document.importNode(u.documentElement,!0);if(!d){Wu({type:"error",message:"import node failure"});return}if(GL(.8),xb.setTheme(),Hk(),new ih().init(r),d=Hs("g",d),d){let p=document.createDocumentFragment();for(;d.firstChild;)p.appendChild(d.firstChild);X.gCanvas.appendChild(p),p=null}GL(1),Jr.setShapeCache(),mr.clear({saved:r.saved}),ja().fitview(),s.resumeDataMerge(),Et("switchGridSizeBtn",{value:Yl(zt.adsorbGrid.gridSize)}),Et("setTopMenuItemsChecked",{"unit(mm)":!0}),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE),Et("panel_updateAttrPanel");let A=(f=(h=X.profileSetting)==null?void 0:h.filterConfig)==null?void 0:f.panelConfigDefault;A&&X.windowBridge.publish("renderAttributeFilterPanel",{docType:X.doctype,tabId:X.tabId,currentSelected:A},ur())}function GL(t){ba("progressUpdate",[t,"Open Panel","OpenPanel"])}var YL=class{constructor(e){this.encoder=new KX(e)}uploadJsonCache(e){ef.uploadJsonCache(this.encoder,e)}getDataStr(){return this.encoder.getDataStr()}};var mTe={CANVAS:"onCanvas",POLY:"onPoly",GROUP:"onGroup",STRING:"onString",DIMENSION:"onDimension",AUXLINE:"onAuxLine",BLOB:"onBlob"},_E=class extends m6{constructor(r=te.compilerManager){super();this.compiler=r;this.success=!1}async decodeDataStr(r){let i=te.exchangeJsonCache(te.getDefaultGJsonCache());this.success=!0,this.compiler.pauseDateMerge(),this.parseFull(r);let n=await this.compiler.getMergeDataJsonCache();return i(),this.compiler.resumeDataMerge(),{jsonCache:n,success:this.success}}onLine(r,i,n,s,a,o,l,c,u,d){let A=JSON.parse(n),h=mTe[s];h?s==="CANVAS"?this.compiler.onCanvas(a,i,A):this.compiler[h](r,i,a,c,A):this.success=!1}onDocHead(r,i){this.compiler.onDocDetail("",0,r)}onEnd(){}};function gTe(){let t=X.profileSetting&&X.profileSetting.commSystemSetting&&X.profileSetting.commSystemSetting.PANEL_CANVAS.cursor;return(X.profileSetting&&X.profileSetting.commSystemSetting&&X.profileSetting.commSystemSetting.PANEL_CANVAS.schAlwaysDisplayCursor)===!0&&t!=="None"}function WW(){let t=gTe();X.helperCursor=t?"cross-red":X.cmdToken?X.helperCursor:""}function KW(){return X.profileSetting.commSystemSetting.PANEL_CANVAS.cursor==="Small"}function ja(){return{openDocComplete:()=>{X.openDocComplete=!0},getOpenDocComplete(){return X.openDocComplete},fitview:Vk,"color-exchange"(){tK()},duplicateToCursor(){if(pt.getIds().length==0){X.windowBridge.publish("panelMessage",{type:"show",timeout:3e3,title:"Information",msg:"Nothing selected",showType:"slide"},ur());return}Ys.exit(),X.frameHelper.getToolProcessor().switchToPasteTool("duplicate")},projectPermission(){return fy.forbiddenDataChange()},decodeNewJsonStr:async t=>{let e=new _E,{jsonCache:r,success:i}=await e.decodeDataStr(t);return i?r:!1},uploadJsonCache2:async(t,e)=>(ef.uploadJsonCache2(t),mr.clear({saved:e.saved}),await te.compilerManager.getJsonCache()),importDocEdit:XW,closeDoc(){var t;(t=te.compilerManager)==null||t.destroy()},duplicatePaste:async()=>{if(!pt.getIds().length){X.windowBridge.publish("panelMessage",{type:"show",timeout:3e3,title:"Information",msg:"\u672A\u9009\u4E2D\u5143\u7D20\uFF01",showType:"slide"},ur());return}YW(),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE),X.windowBridge.publish("panelMessage",{type:"show",timeout:3e3,title:"Information",msg:"\u91CD\u590D\u5230\u539F\u4F4D\u7F6E\uFF1A\u64CD\u4F5C\u6210\u529F\uFF01",showType:"slide"},ur())},"panel/save"(){return te.compilerManager.save()},"panel/resumeDataMerge"(){te.compilerManager.resumeDataMerge()},unlockAll(){Rs.unlockAll(),Et("panel_updateAttrPanel"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},showAll(){rn.showAll(),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},hide(){let t=pt.getIds();rn.toggleElementsDisplay(t,!1),Et("panel_updateAttrPanel"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},unhide(){let t=pt.getIds();rn.toggleElementsDisplay(t,!0),Et("panel_updateAttrPanel"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},showRuler(){Et("changeRulerVisible",[window.frameElement.classList.contains("un_ruler"),X.tabId])},modifyCanvas:An.modify_canvas,setTabId:function(t){console.warn("you may not have to setTabId, because tabId already exist",X.tabId),t&&(X.tabId=t)},updateSystemConfig:function(t){X.profileSetting=t,X.topMenuStatus.sync(),WW(),X.helperCursor||Eu(!1)},rotate(t){let r=op(),i,n,s=arguments[0];if(typeof s=="number")t=s;else if(typeof s=="string")isNaN(+s)||(t=+s);else if(typeof s=="object"&&s.ids&&(n=s.ids,t=s.degree,!Array.isArray(n)))return;if(t===void 0&&(t=270),n){if(i=n.map(function(c){return Fe(c)}),i=i.filter(function(c){return c&&uu(c.parentNode,VA)}),i.length){let c=new qi(i);up(i,t),Ja(i),!r&&c.updateAndSave(),Et("panel_updateAttrPanel")}return}let a=X.frameHelper.getToolProcessorCurrentTool(),o=a==null?void 0:a.getSymbol();if([Ps.drag_tool,Ps.paste_tool,Ps.place_lib_tool,Ps.draw].includes(o)){a.rotate(t),Et("panel_updateAttrPanel");return}if([Ps.rotate_by_anchor_tool,Ps.drag_control_dot_tool].includes(o))return;let l=new xE(Gs(),{notSaveHistory:r});return l.do(t),Et("panel_updateAttrPanel"),ms.debouncedAppendSelectStroke(),l.success},delete(){fd(),Et("panel_updateAttrPanel"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},"delete-all":function(){Qk(),fd(),Et("panel_updateAttrPanel"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},duplicateTo:function(...t){TE.do(...t)},storeImageData:function(t){X.defaultImage=t},forceReleaseToken:function(){gb()},getJsonCache(t={getPath:!1}){return te.getGJsonCache(t.getPath)},getActiveCompressStr(){let t=new YL(X.tabId.split("@")[0]);return t.uploadJsonCache(te.gJsonCache),t.getDataStr()},getProductWidthHeight:()=>te.getProductWidthHeight(),setToolbarCmd:function(){return sy.apply(null,arguments)},zoom:Ay,getViewStatus:function(){return eT()},getFrameInfo(){return new ih().getAllInfo()},updateSaveIndex:function(){mr.savedIndex=mr.index.value},getSG(){return{S:{value:X.gZoom},G:{value:zt.adsorbGrid.gridSize,unit:zt.canvas.unit}}},undo:function(){tr.started||tr.dots.length||tr.target||op()||mr.go(-1)},redo:function(){tr.started&&tr.dots.length||op()||mr.go(1)},cut:async function(){X.frameHelper.getToolProcessor().switchToReferencePointTool();let t=Gs();t.length&&(Ys.referenceIsSelectedReferencePoint?Ys.enterCutStart(X.tabId,t):(X.windowBridge.publish("setReferencePosition",void 0,ur()),yy()))},async copy(t,e=!0){X.frameHelper.getToolProcessor().switchToReferencePointTool();let r=Gs();return Array.isArray(t)&&(r=t),r.filter(n=>{let{cmdKey:s}=te.getById(n.id);return s!=="dimension"}).length?(e&&Ys.referenceIsSelectedReferencePoint?(Ls("cross-red",void 0,void 0,"\u8BF7\u9009\u62E9\u53C2\u8003\u70B9"),Ys.enterCopyStart(r||Gs())):(X.windowBridge.publish("setReferencePosition",void 0,ur()),await by(r)),e?Promise.resolve(Ys.referenceIsSelectedReferencePoint):!1):Promise.resolve(Ys.referenceIsSelectedReferencePoint)},paste(t){X.frameHelper.getToolProcessor().switchToPasteTool(jd(t)?t:"")},async pasteInPlace(){await GW(),Et("panel_updateAttrPanel"),Et("updateMenuByDocStatus"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},abortReferencePointMode:function(){Ys.abortReferencePointMode()},abortReferencePointModeAndCancelPaste(){Ys.abortReferencePointMode()},clone:function(){var t=arguments[0];if(typeof t=="object"&&t.ids){var e=t.ids;if(!Array.isArray(e))return;var r=e.map(function(i){return Fe(i)});r=r.filter(function(i){return i&&uu(i.parentNode,VA)})}},distribute_vertical_equidistant(t){VL("align_vertical_equidistant",t)},distribute_horizontal_equidistant(t){VL("align_horizontal_equidistant",t)},endEditingPath(){pi.endEditingPath()},select_none(){Ci()},selectById(t){let e=t.map(r=>Fe(r)).filter(r=>r);pt.select(e)},highlightById:function(t){let e=Fe(t);e&&(rn.eleIsHide(te.getById(t).json)||ms.createHighlightStyle(Fe(t)),pt.highlight(e))},unhighlightById:function(t){Fe(t)&&pt.unhighlight(Fe(t)),ms.shouldRemoveHighlight(t)},highlightCombination:function(t){let e=new gr,{elements:r}=e.getAllElesfromTop(t);[...r].forEach(i=>{let n=Fe(i);n&&(rn.eleIsHide(te.getById(i).json)||ms.createHighlightStyle(n,!0),pt.highlight(n))})},unhighlightCombination:function(t){let e=new gr,{elements:r}=e.getAllElesfromTop(t);[...r].forEach(i=>{rn.eleIsHide(te.getById(i).json)||ja().unhighlightById(i)}),ms.removeCombinationElmsHighlightStroke()},unSelectById:function(t){Array.isArray(t)||(t=[t]),t.forEach(e=>{Fe(e)&&pt.unselect(Fe(e))})},select:function(){var t=arguments[0];if(typeof t=="object"&&t.ids){var e=t.ids;if(!Array.isArray(e))return;var r=e.map(function(i){return Fe(i)});if(r=r.filter(function(i){return i&&uu(i.parentNode,VA)}),r.length)return pt.select(r)}else typeof t=="string"?pt.select(Fe(t)):pt.select(t)},bring_to_front:function(t){JW(t),new rs().updateHole(!0),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},send_to_back:function(t){$W(t),new rs().updateHole(!0),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},raise_one_level:function(t){ZW(t),new rs().updateHole(!0),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},lower_one_level:function(t){eK(t),new rs().updateHole(!0),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},rotate_left:function(){var t=arguments[0];typeof t=="object"&&t.ids||ja().rotate(270)},endCutState:function(t){Ys.endCutState(t)},rotate_right:function(){var t=arguments[0];typeof t=="object"&&t.ids||ja().rotate(90)},fliph(){let t=X.frameHelper.getToolProcessorCurrentTool(),e=t==null?void 0:t.getSymbol();[Ps.drag_tool,Ps.paste_tool,Ps.place_lib_tool].includes(e)?t.flipH():Gk(1),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE),Et("panel_updateAttrPanel")},flipv(){let t=X.frameHelper.getToolProcessorCurrentTool(),e=t==null?void 0:t.getSymbol();[Ps.drag_tool,Ps.paste_tool,Ps.place_lib_tool].includes(e)?t.flipV():Gk(0),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE),Et("panel_updateAttrPanel")},lock(t){t=t||pt.getIds(),Rs.setLockStatus(t,!0),yd(),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE),Et("panel_updateAttrPanel")},lockElements(t){t=t||pt.getIds(),Rs.setElementsLockStatus(t,!0),yd()},unlockElements(t){t=t||pt.getIds(),Rs.setElementsLockStatus(t,!1),yd()},unlock(t){t=t||pt.getIds(),Rs.setLockStatus(t,!1),yd(),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE),Et("panel_updateAttrPanel")},isLocked(t){let e=Fe(t);return e&&Rs.isLockedById(e.id)},lockCombination:t=>{Rs.setCombinationLockStatus(t,!0),Et("panel_updateAttrPanel")},unlockCombination:t=>{Rs.setCombinationLockStatus(t,!1),Et("panel_updateAttrPanel")},isEleInCombination:function(t){return{eleInCombination:new gr().searchCombination(t)}},canvas_config:function(){return vi(zt.canvas)},getEleAttrParams(){let t=pt.get();return t.length?Yk(t):[{cmdKey:"canvas"}]},attrGetData(t){return jL(t,X.tabId)},currZoom:function(){return X.currZoom},getSelected:function(){return Gs()},pasteFromDataStr:async function(t){let e=await bE(t);X.frameHelper.getToolProcessor().switchToPasteTool("paste_dxf",await RL(e),t.origin?void 0:"center")},releaseActive:function(t){return Ci(t)},setOrigin:function({originX:t,originY:e}){gy.setOrigin(t,e)},setOriginXY:function(t){t||(t={x:te.gJsonCache.head.originX||0,y:te.gJsonCache.head.originY||0}),t.x=isFinite(t.x)&&t.x!==null?+t.x:zt.canvas.originX,t.y=isFinite(t.y)&&t.y!==null?+t.y:zt.canvas.originY,t.x=Fa(t.x),t.y=Fa(t.y),zt.canvas.originX=t.x,zt.canvas.originY=t.y;var e=.5/X.gZoom;ge(Fe("gridOH"),{y1:t.y+e,y2:t.y+e}),ge(Fe("gridOV"),{x1:t.x+e,x2:t.x+e}),ge(Fe("gridPattern"),{x:t.x,y:t.y}),te.gJsonCache.head.originX=t.x,te.gJsonCache.head.originY=t.y,lp()},snap_grid:function(){zt.adsorbGrid.enabled=!zt.adsorbGrid.enabled},visible_grid:function(){var t=ge(Fe("gridBg"),"display")||"";t=t=="none"?"":"none",ge(Fe("gridBg"),{display:t}),zt.adsorbGrid.visible=!t},deleteObjs:function(t){if(typeof t=="string")t=Fe(t);else if(typeof t=="object"&&t.ids){let e=t.ids;if(!Array.isArray(e))return;t=e.map(function(r){return Fe(r)})}fd(t)},adaptAreaSelectionView(){gb(),Ls("cross-red"),X.contextmenuDisableOnce=!0,document.querySelector("#g1").classList.add("none-events"),um.setAdaptAreaSelectionView(!0)},adaptSelectionView:jk,highlightItems:function(t,e={scrollElementsIntoView:!0}){let r;function i(l,c=!0){c&&(PE(l.x,l.y),Eu(l.x,l.y,{strokeWidth:"2",strokeLinecap:"square"})),clearTimeout(r),r=setTimeout(()=>{ge(Fe("gMarkError"),"visibility","hidden"),Eu(!1),X.helperCursor=void 0},1e3)}let{scrollElementsIntoView:n}=e,s=[];for(let l of t)Fe(l)&&s.push(Fe(l));let a=la(s,!0),o=new ne(a.x+a.width/2,a.y+a.height/2);n?dm(a,1,!0):dm(a,0),i(o,!0),new rs().updateHole()},convertStrokeToShape(){return _W()},convertBaseShapeToPath:function(){return DW()},combineShapes:function(){PW(),Et("updateMenuByDocStatus"),Et("panel_updateAttrPanel"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE),Et("panel/updateTreeActiveElements")},breakShapeApart(){LW(),Et("updateMenuByDocStatus"),Et("panel_updateAttrPanel"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE),Et("panel/updateTreeActiveElements")},joinPath(){OW(),Et("updateMenuByDocStatus"),Et("panel_updateAttrPanel"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE),Et("panel/updateTreeActiveElements")},reversePath:function(){return RW()},simplifyPath:function(){return MW()},deleteEmptyCombination(t){new gr().deleteEmptyCombination(t)},groupSelected(){new gr().combine(),Et("updateMenuByDocStatus"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},ungroupSelected(){new gr().unCombine(),Et("updateMenuByDocStatus"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},ungroupAllEmpty(){new gr().unCombineAllEmpty(),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},ungroupAll(){new gr().unCombineAll(),Et("panel_updateAttrPanel"),Et("updateMenuByDocStatus"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},enterGroup(){let t=new gr,e=pt.getIds(),r=t.searchCombination(e[0]);if(!r)return;let i=t.findFamily(r).peekParent();Li.setEditing(i),Et("panel/updateTreeActiveElements"),Et("panel_updateAttrPanel")},removeFromGroup(t){new gr().removeFromGroup(t),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},joinGroup(t){if(!t)return;new gr().joinGroup(t),Et("panel_updateAttrPanel"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)},exportPanelSVG:function(t){let e=kk();if(Yg)return X.windowBridge.publish("exportFileClientWay",{data:{fileData:e,fileTitle:`${t}.svg`,extension:"svg"}},ur());pS(new Blob([e]),`${t}.svg`)},PanelLayerMaster:()=>Ar,getSelectedObjsInfoInTreeNode(){let t=pt.getIds(),e=[];if(t.length>0){let{combinations:r,elements:i}=new gr().getSelectedCombinations(t);r.forEach(n=>{e.push({type:"CombinationGroup",id:n})}),i.forEach(n=>{let s=Fe(n);switch(Pi(s)){case"auxiliaryLine":e.push({type:IP(te.getAuxiliaryLine(s.id).rotation),id:s.id});default:e.push({type:Fk[Pi(s)],id:s.id})}})}return e},selectCount:()=>pt.count(),repeat:()=>{var i;let{useable:t}=ma,e=ma.get();if(!t||!e)return;let r={4:n=>{ja().delete()},3:n=>{ja().rotate(n.degree)},2:n=>{HL(Gs(),n.movement)},0:async n=>{ja().duplicateTo(n.data)},7:async n=>{ja().duplicateTo(n.data,n.movement)},6:async n=>{ja().duplicateTo(n.data)},8:n=>{ja().duplicateTo(n.data,n.movement)},5:n=>{let s=pt.getIds();n.locked?ja().lock(s):ja().unlock(s)},10:n=>{n.isVisable?ja().unhide():ja().hide()},11:()=>{ja().pasteInPlace()}};Et("panel_updateAttrPanel"),(i=r[e.type])==null||i.call(r,e)}}}var yTe="clickedCanvas",xy=class xy extends Fc{constructor(){super();this.ctrl=!1;this.isDragCopy=!1;this.oldCanvansDot={x:0,y:0}}handleTarget(r){let i=r.originalEvent;this.event=i;let n=i.target,s=i.metaKey||i.ctrlKey,o=qS()==="continuousSelection";if(this.ctrl=s||o,this.eventTarget=n,[document,document.documentElement,document.body].includes(n))return;let l=X.svgRoot===n?void 0:zP(i);this.target=l}onMouseLeftDown(r){var a;xy.elementsForDrag=[];let{canvasX:i,canvasY:n}=r;if(this.oldCanvansDot.x=i,this.oldCanvansDot.y=n,this.hasMouseLeftDownBeforeUp=!0,X.windowBridge.publish(yTe,[{mouseButton:"left",mouseMotion:"down"}],ur()),this.handleTarget(r),!this.eventTarget)return;if(ub(i,n)&&!pi.isEditingPath()&&!this.ctrl){xy.elementsForDrag=pt.getIds().map(o=>({id:o}));return}if(!this.target&&!this.ctrl&&this.eventTarget&&this.eventTarget.tagName!="TEXTAREA"&&!Bo.on&&kg.getCursor()==4&&Ci(),this.ctrl)this.target&&((a=X.profileSetting)!=null&&a.commSystemSetting.PANEL_CANVAS.is_ctrl_drag_to_drag)&&(this.isDragCopy=!0,this.leftDownForDragCopyEle=this.target);else if(this.target){let o=Wq(i,n);if(o.length){xy.elementsForDrag=o;return}if(pt.getIds().includes(this.target.id)){xy.elementsForDrag=pt.getIds().map(c=>({id:c}));return}let l=Li.getSelectDependMaskMode(this.target.id);xy.elementsForDrag=l}}onMouseLeftUp(r){if(Bo.on||md.running)return;this.isDragCopy=!1;let{canvasX:i,canvasY:n}=r,{x:s,y:a}=this.oldCanvansDot,o=ub(i,n)&&!pi.isEditingPath();!this.target&&o&&i==s&&n==a&&(kg.switch(4),Ci()),this.ctrl?this.target&&pt.toggle([this.target]):this.loopSelect(r.originalEvent),this.hasMouseLeftDownBeforeUp&&Et("panel_updateAttrPanel"),this.hasMouseLeftDownBeforeUp=!1;let{x:l,y:c}=Hn(r.originalEvent,!1);pi.clickShowSegmentHandle(this.target,l,c),Et("panel/updateTreeActiveElements"),Et("updateMenuByDocStatus")}loopSelect(r){let i=bTe(r),n=te.getItemOrderSortMap();if(i.size<1){Ci(),this.target&&pt.select([this.target]);return}let s=[];for(let c of i){let u=n.get(c.id);s.push({index:u,ele:c})}s.sort((c,u)=>{let d=+ge(c.ele,"layer"),A=+ge(u.ele,"layer");return[d,A].includes(8)&&d!==A?A-d:u.index-c.index});let a=0;for(let c=0;c<s.length;c++){let u=s[c];if(pt.isSelected(u.ele)){a=c+1,!this.ctrl&&pt.unselect(u.ele);break}}a=a===s.length?0:a,!this.ctrl&&a===0&&Ci();let o=0,l;for(let c of s){if(o===a){l=c.ele;break}o++}pt.select([l])}onMouseRightDown(r){this.handleTarget(r)}isCtrlDargMove(r){return r.mouseLeftMoving&&r.originalEvent.ctrlKey&&this.isDragCopy}onMouseMove(r){var a;if(pt.unhighlight(this.hoverNearByTarget),this.handleTarget(r),pt.highlight(this.target),this.hoverNearByTarget=this.target,!r.originalEvent.altKey&&X.cmdToken){let o=XA(r.originalEvent.target);o&&o!==X.svgRoot&&Jr.boxCenterAddCrossFlag(o.id)}if(this.isCtrlDargMove(r)){let o="ctrl_drag_copy2";pt.getIds().includes(this.leftDownForDragCopyEle.id)||pt.unselectAll(),pt.select([this.leftDownForDragCopyEle]);let l=ja();l.copy(void 0,!1).then(c=>{!c&&l.paste(o)}),this.isDragCopy=!1,this.leftDownForDragCopyEle=null;return}ms.createHighlightStyle(this.hoverNearByTarget);let i=!0;!((a=X.profileSetting)!=null&&a.commSystemSetting.PANEL_CANVAS.is_ctrl_drag_to_drag)&&r.ctrlKeyDown&&(i=!1),kg.mouseMoveCursor(r.originalEvent,this.target,new ne(r.canvasX,r.canvasY),i);let{x:n,y:s}=Hn(r.originalEvent,!1);pi.createHoverAnchor(this.target,n,s)}onDoubleClick(r){var n;this.handleTarget(r);let i=te.getById((n=this.target)==null?void 0:n.id).json;i&&i.locked||(hW(this.target,r.originalEvent),Et("panel_updateAttrPanel"),Et("panel/updateTreeActiveElements"))}onMouseRightUp(r){if(!Fg.dragpanning&&md.running){md.instance.cancel();return}if(Bo.on||(this.handleTarget(r),this.ctrl))return;let i=this.eventTarget.classList.contains("hitbox");if(i&&!X.gCanvas.contains(this.eventTarget))return;let n=this.eventTarget==X.svgRoot,s=this.target==X.svgRoot;if(Pi(this.target)!=="cdot"){this.target&&!pt.isSelected(this.target)&&!s&&(Ci(),pt.select([this.target]));let o=XA(this.eventTarget);!i&&o&&!pt.isSelected(o)&&!n&&Ci()}iK(this.event,this.target),Et("panel_updateAttrPanel"),Et("panel/updateTreeActiveElements"),Et("updateMenuByDocStatus")}install(){console.log(this.getSymbol(),"installed")}uninstall(){console.log(this.getSymbol(),"uninstalled")}getSymbol(){return Ps.highlight}};xy.elementsForDrag=[];var LE=xy;function bTe(t){let e=Hn(t,!1),{x:r,y:i}=e,n=new Set,s=rk(r,i);if(s.length)for(let y of s)n.add(y);let a=ik(r,i);if(a.length)for(let y of a)n.add(y);let o=nk(r,i);for(let y of o)n.add(y);let l=sk(r,i);for(let y of l)n.add(y);let c=ak(r,i);for(let y of c)n.add(y);let u=ok(r,i);for(let y of u)n.add(y);let d=NS(r,i);if(d.size)for(let y of d)n.add(y);let A=Og(r,i);if(A.length)for(let y of A)n.add(Fe(y));let h=np(r,i);if(h.length)for(let y of h)n.add(Fe(y));let f=cb(r,i);if(f.length)for(let y of f)n.add(y);let p=oE(r,i);if(p.length)for(let y of p)n.add(y);let m=RS(r,i);for(let y of m)n.add(y);return n}var nA=class extends Fc{constructor(){super();this.lastX=void 0;this.lastY=void 0;this.accumulateX=0;this.accumulateY=0;this.dashedBoxForPerf=null;this.updateRightPanel=sz(()=>{this.dragContext.selectedObjs.length!==0&&Et("panel_updateAttrPanel")},100);this.auxiliaryLineId="drag-auxiliary-line";this.shiftKeyDown=!1}static canSwitchMe(r){if(!r.mouseLeftMoving)return!1;let i=LE.elementsForDrag.filter(o=>!pt.isUnselectAble(o.parentId||o.id));if(!i.length)return!1;let n=[];for(let o of i)n.push(o.parentId||o.id);let{combinations:s,elements:a}=new gr().getSelectedCombinations(n);for(let o of s)if(te.getCombination(o).locked)return JA(n),!1;for(let o of a)if(Rs.isLockedById(o))return JA(n),!1;return r.selectItems=i,!0}getSymbol(){return Ps.drag_tool}install(r){this.startX=r.startX,this.startY=r.startY,this.lastX=r.startX,this.lastY=r.startY,this.dragContext=new fL(r),this.dragElements=new WS(this.dragContext),this.onDragStart(),this.checkShouldCreateSelectionBox(),pt.unselectAll();for(let i of r.selectItems)pt.select([{id:i.parentId||i.id}]);console.log(this.getSymbol(),"installed")}uninstall(r){nA.isDragging=!1,console.log(this.getSymbol(),"uninstalled")}checkShouldCreateSelectionBox(){let{selectedObjs:r}=this.dragContext;if(r.length>p_){let n=la(r);this.dashedBoxForPerf=Xk(n,{"stroke-dasharray":"6, 6",class:UA,stroke:X.panelThemeCache.color.select});for(let s of r)em(s,"hidden")}}onDragStart(){mr.startBatch(),nA.isDragging=!0;let r=this.dragContext.selectedObjs.filter(o=>!["auxiliaryLine","auxiliaryPoint"].includes(Pi(o))),i=la(r);this.startBBox=Mr.extendRect(i),this._radian=0,eA(),hm(),Jr.setExcludeShapeIds(this.dragContext.selectedObjs.map(o=>o.id));let n=Array.from(this.dragContext.affectedDimensions).map(o=>Fe(o)).concat(Array.from(this.dragContext.drivingDimensions).map(o=>Fe(o.gId))).concat(Array.from(this.dragContext.xMoveEles)).concat(Array.from(this.dragContext.yMoveEles)),s=this.dragContext.dragDimensionDots.map(o=>o.getContainer());for(let o of[...this.dragContext.selectedObjs,...n,...s])mr.jsonSnap.addOne(te.getById(o.id).json);let a=()=>{ms.emptyLastHoverEle().emptySelectContainer().removeHighlightStroke(),pi.removeMiddleAnchor()};a(),setTimeout(a,0)}onDrag(r,i){if(this.dashedBoxForPerf)return WA.svg(this.dashedBoxForPerf,r,i);!this.dashedBoxForPerf&&this.dragElements.onDrag(r,i),kg.switch(5);let n=xu(this.dragContext.selectedObjs);n.length&&Ja(n,{create8Dots:!1}),this.dragContext.combinationMask.updateHole(),this.updateRightPanel(),Ey()}handleSelectionBox(){if(!this.dashedBoxForPerf)return;Cr(this.dashedBoxForPerf),this.dashedBoxForPerf=null;let{selectedObjs:r}=this.dragContext;for(let i of r)nd(i,"hidden");this.onDrag(this.accumulateX,this.accumulateY)}onComplete(){this.onEnd(),Et("panel_updateAttrPanel"),Et("updateMenuByDocStatus"),Et("panel/updateTreeActiveElements"),this.freshBoundingBox(),ms.debouncedAppendSelectStroke()}freshBoundingBox(){let r=xu(this.dragContext.selectedObjs);r.length&&Ja(r,{create8Dots:!0})}onEnd(){this._radian=0,this.handleSelectionBox(),this.removeAuxiliaryLine(),mr.saveBatch(),Jr.clearAdsorptionHTML(),Jr.clearExcludeShapeIds(),kg.switch(4)}onMouseMove(r){this.dragContext.abandonedWhenIsLock(r);let{mouseLeftMoving:i,originalEvent:n,canvasX:s,canvasY:a}=r;n=n;let{altKey:o,shiftKey:l,clientX:c,clientY:u}=n;if(this.lastClient={clientX:c,clientY:u},!i)return;let d=r.snapX-this.lastX,A=r.snapY-this.lastY;if(l){let h=Math.abs(r.snapX-this.startX),f=Math.abs(r.snapY-this.startY);h>f?A=-this.accumulateY:d=-this.accumulateX}else if(!o){let h={x:s,y:a},f=this.getAdsorbPoints(h),p=nK(h,f);d=p.x-this.lastX,A=p.y-this.lastY}(d!==0||A!==0)&&(this.onDrag(d,A),this.lastX+=d,this.lastY+=A,this.accumulateX+=d,this.accumulateY+=A,l&&this.createAuxiliaryLine({x:this.startX,y:this.startY},{x:this.lastX,y:this.lastY})),this.freshBoundingBox(),ms.emptySelectContainer()}createAuxiliaryLine(r,i){let n=this.auxiliaryLineId,s=document.getElementById(n),a=[r.x,r.y,i.x,i.y].join(" ");s?ge(s,{points:a}):(s=Hr("polyline",{id:n,points:a,"vector-effect":"non-scaling-stroke",stroke:X.panelThemeCache.color.select}),X.gCanvas.appendChild(s))}removeAuxiliaryLine(){Cr(document.getElementById(this.auxiliaryLineId)),this.shiftKeyDown=!1}onKeyDown(r){let{shiftKeyDown:i}=r;if(i&&!this.shiftKeyDown){let n=new MouseEvent("mousemove",this.lastClient);document.dispatchEvent(n),this.shiftKeyDown=!0}else r.keyCode==="Delete"&&(this.cancel(!1),r.toolFinished=!0);this.handleDirectionKeydown(r)}handleDirectionKeydown(r){let i=s();if(!i)return;let n={...this.lastClient};n.clientX+=zt.adsorbGrid.gridSize*i[0],n.clientY+=zt.adsorbGrid.gridSize*i[1],r.reactor.element.dispatchEvent(new MouseEvent("mousemove",n));function s(){switch(r.keyCode){case"ArrowLeft":return[-1,0];case"ArrowRight":return[1,0];case"ArrowDown":return[0,1];case"ArrowUp":return[0,-1]}}}cancel(r=!0){if(nA.isDragging){if(mr.jsonSnap.recovery(r),mr.cancelSaveBatch(),r){let i=LE.elementsForDrag.map(s=>Fe(s.parentId||s.id)),n=xu(i);n.length&&Ja(n,{create8Dots:!0})}LE.elementsForDrag.length=0,Jr.clearAdsorptionHTML()}}onKeyUp(r){let{originalEvent:i}=r;i=i;let{keyCode:n}=i;switch(n){case KS.Space:break;case KS.Shift:let s=new MouseEvent("mousemove",this.lastClient);document.dispatchEvent(s),this.removeAuxiliaryLine();break;case KS.Esc:{r.toolFinished=!0,this.cancel();break}default:break}}onMouseLeftUp(r){r.toolFinished=!0,this.onComplete()}onMouseRightUp(r){Fg.dragpanning||(r.toolFinished=!0,this.cancel())}rotate(r){$i.createContext();let i=(360-r)*Math.PI/180;this._radian+=i,this._radian%=Math.PI*2;let n=this.dragContext.selectedObjs.concat(this.dragContext.selectedDimensionObjs).filter(s=>te.getById(s.id).cmdKey!=="auxiliaryLine");up(Bh(n),r),$i.runTask()}flipH(){$i.createContext();let r=Bh(this.dragContext.selectedObjs.concat(this.dragContext.selectedDimensionObjs)),i=_h(r,!0,{ignoreSnap:!0});new sA(r).mirror(!0,i),$i.runTask(),this.freshBoundingBox()}flipV(){$i.createContext();let r=Bh(this.dragContext.selectedObjs.concat(this.dragContext.selectedDimensionObjs)),i=_h(r,!0,{ignoreSnap:!0});new sA(r).mirror(!1,i),$i.runTask(),this.freshBoundingBox()}getCurrentBBox(r){let i=this.startBBox.width(),n=this.startBBox.height(),s=this.startBBox.minX,a=this.startBBox.minY,o=Ue.translate(-s-i/2,-a-n/2).multiply3(Ue.rotate(this._radian)).translate(s+i/2,a+n/2).translate(r.x-this.startX,r.y-this.startY);return this.startBBox.transform(o)}getAdsorbPoints(r){let i={},n=this.getCurrentBBox(r);if(n.height()&&n.width()){let l=n.LL(),c=n.LR(),u=n.UR(),d=n.UL(),A=l.add(c).mul(1/2),h=c.add(u).mul(1/2),f=u.add(d).mul(1/2),p=d.add(l).mul(1/2),m=n.center();o(l,c,u,d,A,h,f,p,m)}let s=r.x-this.lastX||0,a=r.y-this.lastY||0;for(let l of this.dragContext.auxiliaryPoints)o(new ne(l.x+s,l.y+a));for(let l of this.dragContext.horizontalAuxiliaryLines)o(new ne(r.x,l.y+a));for(let l of this.dragContext.verticalAuxiliaryLines)o(new ne(l.x+s,r.y));return Object.values(i);function o(...l){for(let c of l)i[`${c.x}_${c.y}`]=c}}};nA.isDragging=!1,nA=Uu([gu(Ya.drag)],nA);var _a=10,tT=1,sK=.8,aK=.4,qk=class{getGridPointRadius(e){return tT/e}getGridPointSVGHTML(e=zt.adsorbGrid.gridSize||5,r=tT){return`<path type="dot" opacity="${aK}" d="${this.getGridPointPathDFor1(e,r)}"/><path type="dot" opacity="${sK}" d="${this.getGridPointPathDFor10(e,r)}"/>`}getGridLineSVGHTML(e=zt.adsorbGrid.gridSize||5){return`<path type="line" opacity="${aK}" d="${this.getGridLinePathDFor1(e)}"/><path type="line" opacity="${sK}" d="${this.getGridLinePathDFor10(e)}"/>`}getGridPointPathDFor10(e=zt.adsorbGrid.gridSize||5,r=tT){return[this.getGridPointDByXY(-r,-r,r),this.getGridPointDByXY(-r+e*_a,-r,r),this.getGridPointDByXY(-r,-r+e*_a,r),this.getGridPointDByXY(-r+e*_a,-r+e*_a,r)].join(" ")}getGridPointPathDFor1(e=zt.adsorbGrid.gridSize||5,r=tT){let i=[];for(let n=0;n<_a+1;n++)for(let s=0;s<_a+1;s++)(n===0||n===_a)&&(s===0||s===_a)||i.push(this.getGridPointDByXY(e*n-r,e*s-r,r));return i.join(" ")}getGridPointDByXY(e,r,i=tT){let n=2*i;return`M ${e} ${r} L ${e+n} ${r} ${e+n} ${r+n} ${e} ${r+n} ${e} ${r}`}getGridLinePathDFor10(e=zt.adsorbGrid.gridSize||5){return`M 0 0 L 0 ${e*_a} M 0 0 L ${e*_a} 0 M 0 ${e*_a} L ${e*_a} ${e*_a} M ${e*_a} 0 L ${e*_a} ${e*_a}`}getGridLinePathDFor1(e=zt.adsorbGrid.gridSize||5){let r=[];for(let i=1;i<_a;i++)r.push(`M 0 ${e*i} L ${_a*e} ${e*i} M ${e*i} 0 L ${e*i} ${e*_a}`);return r.join(" ")}},xd=new qk;var Wk=(r=>(r.Portrait="Portrait",r.Landscape="Landscape",r))(Wk||{}),xTe=["393mmx579mm"],OE=class{static getBBoxAttr(){return{title:"Overall Transformation",attr:this.selectBBox}}static checkSelectBBoxAttr(e){for(let r in this.selectBBox)if(e[r])return!0;return!1}};OE.selectBBox={"attr-bbox-x":{componentType:"text-input",title:"X Location"},"attr-bbox-y":{componentType:"text-input",title:"Y Location"},"attr-bbox-width-height-pair":{componentType:"width-height-pair",widthTitle:"Width",heightTitle:"Height"},"attr-bbox-rotation":{componentType:"text-input",title:"Rotation",calcu:!0}};var ETe={"attr-x-y":{componentType:"point",title:"X/Y",calcu:!0}},wTe={"reference-point":{componentType:"nine-grid",title:"Reference Point"}},bm={"attr-rotation":{componentType:"text-input",title:"Rotate",calcu:!0}},wy={"attr-conceal":{componentType:"select",title:"Hide",options:[{text:"Yes",value:"yes"},{text:"No",value:"no"}]}},Eb={"attr-locked":{componentType:"select",title:"Locked",options:[{text:"Yes",value:"yes"},{text:"No",value:"no"}]}},vy=(t={})=>({"attr-name":{componentType:"text-input",type:"text-input",title:"Name",...t}}),Cy={"attr-id":{componentType:"text-input",type:"text-input",title:"ID"}},oK={"attr-hide":{componentType:"select",title:"Valid",options:[{text:"Yes",value:"no"},{text:"No (The production file is not output)",value:"yes"}]}},QL={"attr-start":{componentType:"point",type:"number-input-xy-row",title:"StartPosition X/Y",calcu:!0}},zL={"attr-end":{componentType:"point",title:"EndPosition X/Y",calcu:!0}},vTe={"attr-dimension-object":{componentType:"text-area",type:"text-area-dimension",title:"Object"}},CTe={"attr-length":{componentType:"text-input",type:"text-input",title:"Length"}},STe={"attr-radius":{componentType:"text-input",calcu:!0,type:"number-input",title:"Round Angle"}},TTe={"attr-width-height-pair":{componentType:"width-height-pair",widthTitle:"Width",heightTitle:"Height"}},NE={"attr-obb-width-height-pair":{componentType:"width-height-pair",widthTitle:"Width",heightTitle:"Height"}},wb={...wTe,...ETe,...TTe},Sy=(t={})=>({"attr-layer":{componentType:"select",type:"layer",title:"Layer",...t}}),lK={"attr-scope":{type:"scope",title:"Scope",options:["Print and White Background","Print Layer","White Background"]}},rT={...vy(),...Cy,...Sy(),"attr-cover":{componentType:"select",type:"yes-no",title:"Cover",options:[{text:"Yes",value:"yes"},{text:"No",value:"no"}]},...lK,"attr-transparency":{componentType:"text-input",type:"text-input",title:"Transparency(Print,White)"},...oK,...wy,...Eb},cK={...vy(),...Cy,...Sy(),...wy,...Eb},ITe={...vy(),...Cy,...Sy(),...wy,...Eb},BTe={"attr-fill-stroke-pair":{componentType:"fill-stroke-pair",fillTitle:"Fill Color",strokeTitle:"Stroke Color"}},DTe={"attr-stroke-width":{componentType:"text-input",type:"number-input",title:"Line Width",calcu:!0}},XL={...BTe,...DTe},_Te=[{title:"Basic Info",attr:rT},{title:"Transformation",attr:wb},{title:"Style",attr:{...NE,...bm,...XL}}],PTe=[{title:"Basic Info",attr:rT},{title:"Transformation",attr:wb},{title:"Style",attr:{...NE,"attr-short-long-radius":{componentType:"width-height-pair",widthTitle:"ShortRadius",heightTitle:"LongRadius"},...bm,...XL}}],LTe=[{title:"Basic Info",attr:rT},{title:"Transformation",attr:wb},{title:"Style",attr:{...NE,...STe,...bm,...XL}}],OTe=[{title:"Basic Info",attr:{...vy(),...Cy,...Sy({disabled:!1}),...wy,"attr-dimension-category":{componentType:"select",title:"Types",options:["Annotation","Constraint"]}}},{title:"Style",attr:{...vTe,"attr-dimension":{componentType:"text-input",calcu:!0,title:"Length"}}}],NTe=[{title:"Basic Info",attr:ITe},{title:"Style",attr:{...QL,...zL,...bm,...CTe}}],RTe={"attr-angle":{componentType:"text-input",title:"Angle"}},MTe={"attr-dimension-angle":{componentType:"point",title:"AnglePoint X/Y",calcu:!0}},kTe=[{title:"Basic Info",attr:cK},{title:"Style",attr:{...MTe,...QL,...zL,...bm,...RTe}}],FTe=[{title:"Basic Info",attr:cK},{title:"Style",attr:{...QL,...zL,"attr-short-radius":{type:"text-input",title:"ShortRadius",disabled:!0},"attr-long-radius":{type:"text-input",title:"LongRadius",disabled:!0},...bm}}],UTe={"attr-arc-type":{type:"select",title:"Arc Type",options:["Center Arc","Two Points Arc"]}},HTe={"attr-circle-center":{componentType:"point",title:"CircleCenter X/Y",calcu:!0},...QL,...zL,...NE,"attr-short-long-radius":{componentType:"width-height-pair",widthTitle:"ShortRadius",heightTitle:"LongRadius"},"attr-start-angle":{componentType:"text-input",title:"Start Arc Angle"},"attr-end-angle":{componentType:"text-input",title:"End Arc Angle"},...bm},GTe=[{title:"Basic Info",attr:{...rT,...UTe}},{title:"Transformation",attr:wb},{title:"Style",attr:{...HTe,...XL}}],uK={"attr-x":{componentType:"text-input",type:"number-input",title:"X Location"}},hK={"attr-y":{componentType:"text-input",type:"number-input",title:"Y Location"}},dK={"attr-stroke-style":{componentType:"select",title:"Line Style",options:AW()}},AK={"attr-color":{componentType:"color",resetColor:!0,title:"Color"}},YTe=[{title:"Basic Info",attr:{...vy(),...Cy,...Sy(),...wy,...Eb}},{title:"Style",attr:{...uK,...hK,...AK,...dK}}],VTe=[{title:"Basic Info",attr:{...vy(),...Cy,...Sy(),...wy,...Eb}},{title:"Style",attr:{...uK,...hK,...AK,...dK}}],jTe=[{title:"Basic Info",attr:{"attr-textarea":{type:"text-area",title:"Text"},...Cy,...Sy(),...lK,"attr-transparency":{type:"text-input",title:"Transparency(Print,White)"},...oK,...wy,...Eb}},{title:"Transformation",attr:wb},{title:"Style",attr:{...NE,...bm,"attr-font-color":{componentType:"color",title:"Font Color"},"attr-font-family":{componentType:"select",type:"font-family",title:"Font"},"attr-font-size":{componentType:"text-input",type:"number-input",title:"Font Size"},"attr-font-style":{type:"style",title:"Style"},"attr-origin":{componentType:"nine-grid",title:"Origin"}}}],QTe=[{title:"Basic Info",attr:rT},{title:"Transformation",attr:wb},{title:"Style",attr:{...NE,...bm}}],zTe=[{title:"Basic Info",attr:{...vy(),...Cy,...wy,...Eb}},{title:"Transformation",attr:wb},{title:"Style",attr:{...bm}}],fK={canvas:[{title:"Page",attr:{...vy({disabled:!0}),"attr-background-color":{type:"color",title:"Background Color"},"attr-material":{type:"select",title:"Material",options:["acrylic","PVC"]},"attr-thickness":{type:"select",title:"Thickness",options:["0.8mm","1.0mm","1.5mm","2.0mm","2.5mm","3.0mm"]},"attr-craft":{type:"select",title:"Surface Technology",options:["Transparent","Black Translucent"]},"attr-print":{type:"select",title:"Print Type",options:["Bottom Side","Ahead Side"]},"attr-cover-color":{type:"select",title:"Cover",options:["white","black"]},...Sy({disabled:!0}),"attr-direction":{type:"select",title:"Direction",options:Object.values(Wk)},"attr-widthxheight":{type:"select",title:"Width X Height",options:xTe},"attr-remark":{type:"text-input",title:"Remark"}}}],obj:QTe,group:_Te,text:jTe,arc:GTe,rect:LTe,ellipse:PTe,auxiliaryLine:YTe,auxiliaryPoint:VTe,combination:zTe,dimension:OTe,dimensionLength:NTe,dimensionAngle:kTe,dimensionRadius:FTe};var pK={line:{modifyProp:"stroke"},dot:{modifyProp:"fill"}};function qL(t,e,r){if(!Ir(e)){e=e%360;for(let i of t)switch(i.cmdKey){case"rect":vn.syncRectByRotation(e,i,r);break;case"ellipse":tn.syncEllipseByRotation(e,i,r);break;case"arc":ls.rotate(i,e,r);break;case"group":To.syncGroupWithRotation(i,e,r);break;case"text":ps.syncTextWithRotation(i,e,r);break;case"obj":Ns.syncImageByRotation(e,i,r);break;case"dimensionAngle":new ga(i).rotateSelf(e,r);break;case"dimensionLength":new ya(i).rotateSelf(e,r);break;case"dimensionRadius":new ca(i).rotateSelf(e,r);break;case"auxiliaryPoint":new SE(i).rotateSelf(e,r);break;default:console.error(i);break}}}function xu(t){return t.filter(e=>{let{cmdKey:r}=te.getById(e.id);return!Fo(r)})}function op(){return nA.isDragging||Kl.ready}function Ay(t,e,r){let i=r?.1:X.zoomRatio.min;if(t=Math.max(t,i),t=Math.min(t,X.zoomRatio.max),X.currZoom===t)return;let n=X.gZoom;X.currZoom=t,X.gZoom=t/100;var s=An.getViewBox(),a=+ge(X.svgRoot,"width"),o=+ge(X.svgRoot,"height");if(e=e||{},!$t(e,"clientX")){var l=El(X.gCanvas);let d={x:l.width?l.x+l.width/2:l.x||s[0]+s[2]/2,y:l.height?l.y+l.height/2:l.y||s[1]+s[3]/2};e.clientX=(d.x-s[0])*a/s[2],e.clientY=d.y*o/s[1]}let c=1/n-1/X.gZoom,u=[s[0]+e.clientX*c,s[1]+e.clientY*c,a/X.gZoom,o/X.gZoom];return An.setViewBox(u),qTe(t,u),KL(u)}function KL(t){let[e,r,i,n]=t;return Mr.extendRect({x:e,y:r,width:i,height:n})}var qTe=Vd(function(t,e){lp(),X.windowBridge.publish("ui/canvasInfo",{tabId:X.tabId,scaleValue:+(X.gZoom*100).toFixed(2),unitValue:"unit(mm)"},ur()),new rs().zoom();var r=X.gZoom===1?1:Sr(100/t+1e-5,5),i=.5/X.gZoom,n=function(A){return A/X.gZoom};let s=JL(),a=Fe("gridCell");if(ge(a,{transform:Ue.toDOMMatrix(Ue.scale(s/zt.adsorbGrid.gridSize))}),ge(Fe("gridPattern"),{width:s*_a,height:s*_a,x:zt.canvas.originX,y:zt.canvas.originY}),zt.adsorbGrid.gridType==="dot"){let A=s/zt.adsorbGrid.gridSize*X.gZoom,h=xd.getGridPointRadius(A),[f,p]=Us("path",a);ge(f,{d:xd.getGridPointPathDFor1(void 0,h)}),ge(p,{d:xd.getGridPointPathDFor10(void 0,h)})}ge(Fe("gridOH"),{"stroke-width":r,y1:zt.canvas.originY+i,y2:zt.canvas.originY+i}),ge(Fe("gridOV"),{"stroke-width":r,x1:zt.canvas.originX+i,x2:zt.canvas.originX+i});var o=Math.max(r*4,1);o=Math.min(o,2);var l;for(l=0;l<mK.length;l++)ge(mK[l],{r:4*r});Zo.zoom(4*r*2),KA.zoom(),ya.zoom(),ga.zoom(),ca.zoom(),(function(A,h){if(A){var f=A.sheet.cssRules[0];f&&(f.style.strokeWidth=h)}})(Fe("px1Style"),r);let c=Us("#gCursors>image");for(l=0;l<c.length;l++){var u=X.helperCursorConfig[c[l].id];if(u&&u.trs){var d=X.gZoom==1?u.trs:u.trs.replace(/-?[\d.]+/g,n);ge(c[l],{width:u.width/X.gZoom,height:u.height/X.gZoom,transform:d})}}window.frameElement&&window.frameElement.setAttribute("winzoom",String(t)),Jr.clearCrossFlagCache(),Jr.adsorptionHTMLZoom(),Us('[c_partid="auxiliaryPoint"]',X.gCanvas).forEach(A=>Z2(A,pg/X.gZoom))}),WL=-1;function JL(t){let e=t||+zt.adsorbGrid.gridSize;for(;e*X.gZoom<10;)e*X.gZoom*2>=10?e*=2:e*X.gZoom*5>=10?e*=5:e*=10;if(X.gZoom<1){let r=zt.adsorbGrid.gridSize;WL===15/.254?WL=20/.254:WL=15/.254,e=Math.max(1,Math.floor(WL/X.gZoom/r))*r}return e}function XA(t){if(t==document)return null;for(;t&&t.parentNode!=X.gCanvas;)t=t.parentNode;return t}function JA(t){X.windowBridge.publish("openPanelDialog",{ids:t,whichDialog:"drag-warn"},ur())}function HL(t,e,{saveHistory:r=!0}=UC){if(op())return;let i=Rs.hasEleLocked(t.map(a=>a.id));if(i){JA([i]);return}t=t.filter(function(a){let{cmdKey:o}=te.getById(a.id);return!(Rs.isLockedById(a.id)||o==="dimension")});let n=()=>{Vg(t,e.x,e.y),rh(t)};r?$i.wrapDo(n):n();let s=xu(t);return s.length&&Ja(s,{create8Dots:!0}),ms.appendSelectStroke(),!0}function Gk(t){let e=Bh(Gs());if(e.length===0)return;let r=$i.createContext(!0);for(let n of e)mr.jsonSnap.addOne(te.getById(n.id).json);let i=_h(e,!0,{ignoreSnap:!0});new sA(e).mirror(!!+t,i),r(),e=xu(e),e.length&&Ja(e,{create8Dots:!0}),ms.appendSelectStroke()}function up(t,e){if(!t.length){console.error(t,e);return}let r=e||-90;r=r>0?r-360:r,ms.emptyLastHoverEle().emptySelectContainer().removeHighlightStroke();let i=t.filter(s=>{let{cmdKey:a}=te.getById(s.id);return a!=="dimension"}),n=_h(i,!1,{ignoreSnap:!0});for(let s of t){let{json:a}=te.getById(s.id);qL([a],r+(a.rotation||0),new ne(n.x,n.y))}}function JW(t){let e;t[0]instanceof Element?e=t:e=RE({ids:t});let r=e.length;if(!r)return;let i=[];for(let n=r-1;n>=0;n--){let s=e[n],a=s.parentNode;if(s!=a.lastChild){let o=te.getRefId(s.id),l=Ar.getLastEleByLayerId(ge(s,"layer"));if(!l||l===s)continue;let c=l.nextSibling,u=te.getById(s.id).json,d=u.zIndex,A=te.getById(l.id).json;u.zIndex=A.zIndex+1,a.insertBefore(s,c);let h=c==null?void 0:c.id;i.push(["elePosition",s.id,o,h]),i.push(["json",s.id,{cmdKey:u.cmdKey,refId:h},{zIndex:d},{zIndex:u.zIndex}])}}i.length&&mr.save(i)}function $W(t){let e=RE({ids:t}),r=e.length;if(!r)return;let i=[];for(let n=r-1;n>=0;n--){let s=e[n],a=s.parentNode;if(s!=a.firstChild){let o=te.getRefId(s.id),l=Ar.getFirstEleByLayerId(ge(s,"layer"));if(!l||l===s)continue;let c=te.getById(s.id).json,u=c.zIndex,d=te.getById(l.id).json;c.zIndex=d.zIndex-1,a.insertBefore(s,l);let A=l.id;i.push(["elePosition",s.id,o,l.id]),i.push(["json",s.id,{cmdKey:c.cmdKey,refId:A},{zIndex:u},{zIndex:c.zIndex}])}}i.length&&mr.save(i)}function WTe(t,e){if(t==e)return 0;let r=t.compareDocumentPosition(e);return r&Node.DOCUMENT_POSITION_DISCONNECTED?0:r&Node.DOCUMENT_POSITION_PRECEDING?1:-1}function RE(t){let{ids:e,includeLocked:r,reverse:i}=t||{};e&&typeof e!="string"&&!Array.isArray(e)&&(e=void 0);let n=Array.isArray(e)?e:e?[e]:[],a=e?(o=>Array.from(Us("#"+o.join(",#"),X.gCanvas)))(n):Gs();return a=a.filter(o=>!!o),r||(a=a.filter(function(o){return!Rs.isLockedById(o.id)})),e||a.sort(WTe),i&&a.reverse(),a}function ZW(t){let e=RE({ids:t,reverse:!0}),r=[];for(let i of e){let n=Ar.getNextSameLayerNode(i);if(n&&!e.includes(n)){let s=n.id||"",a=n.nextElementSibling,o=(a==null?void 0:a.id)||"",l=te.getById(i.id).json,c=l.zIndex,{zIndex:u}=te.getById(s).json||{},{zIndex:d=u+2}=te.getById(o).json||{};l.zIndex=(u+d)/2,c===l.zIndex?gK(l,i,r,"raise"):r.push(["json",i.id,{cmdKey:l.cmdKey,refId:o},{zIndex:c},{zIndex:l.zIndex}]);let A=te.getItemOrder().find(f=>{let p=te.getById(f).json;return f!==l.gId&&l.zIndex<p.zIndex}),h=Hs(`#${A}`);i.parentNode.insertBefore(i,h||a),r.push(["elePosition",i.id,s,o])}}r.length&&mr.save(r)}function eK(t){let e=RE({ids:t}),r=[];for(let i of e){let n=Ar.getPrevSameLayerNode(i);if(n&&!e.includes(n)){let s=i.nextElementSibling,a=(s==null?void 0:s.id)||"",o=n.id||"",l=Ar.getPrevSameLayerNode(n),c=te.getById(i.id).json,u=c.zIndex,{zIndex:d}=te.getById(o).json||{},{zIndex:A=d-2}=te.getById(l==null?void 0:l.id).json||{};c.zIndex=(d+A)/2,u===c.zIndex?gK(c,i,r,"lower"):r.push(["json",i.id,{cmdKey:c.cmdKey,refId:o},{zIndex:u},{zIndex:c.zIndex}]),i.parentNode.insertBefore(i,n),r.push(["elePosition",i.id,a,o])}}r.length&&mr.save(r)}function gK(t,e,r,i){let n=i==="raise"?1:-1,{zIndex:s}=t,a=Ar.getZIndexMap(),o=a.get(s),l=o.findIndex(h=>h===t.gId);o.splice(l+n,0,o.splice(l,1)[0]);let c=[...a.keys()].sort((h,f)=>h-f),u=c.find((h,f)=>c[f+1]===s)||s-1,A=((c.find(h=>h>s)||s+1)-u)/(o.length+1);o.forEach((h,f)=>{var y;let p=te.getById(h).json;p.zIndex=u+A*(f+1);let m=o[f+1]||((y=Ar.getNextSameLayerNode(Hs(`#${h}`)))==null?void 0:y.id);r.push(["json",h,{cmdKey:p.cmdKey,refId:m||""},{zIndex:s},{zIndex:p.zIndex}])})}var mK=[];function qW(t){t.head.version=Bg,te.gJsonCache=t,ge(window.frameElement,"jsonCacheReady",!0)}var lE=class{static isShowContextMenu({target:e,type:r,button:i}){return this.canDeleteDot(e)&&Pi(e)==="cdot"&&r==="mouseup"&&i===2}static canDeleteDot(e){return ge(e,"class")!=="light"}static deletePathNode(e,r){let i=e.id;if(!i)return;let n=pt.get()[0],s,a;if(Rs.isLockedById(n.id)||!n||!uu(n.parentNode,VA)||!e||e.parentNode!=X.gControlDots||ge(e,"class")=="light"||n.tagName!="path"&&n.tagName!="polyline"&&n.tagName!="polygon")return;let o=+i.substr(4);if(s=X.gControlDots.children[1],s&&(ge(s,"class")=="light"||ge(s,"visibility")=="hidden")&&(o=o>>1),(A=>A.tagName==="path")(n)){if(r&&r.type==="anchor"&&n.pathSegList.numberOfItems<=2)return;let A=vo(n),h=Da(n.id,{cmdKey:"group",refId:A},te.getById(n.id).json);if(yK(n,o),n.getTotalLength()<.01)fd([n]);else{Ac(n);let f=te.getById(n.id).json;f.d=ge(n,"d"),h[4]=vi(f),mr.save(h)}return}var c=n,u=c.points,d=u.numberOfItems;d<=2||o>=0&&o<d&&(a=["attr",c.id,{points:ge(c,"points")}],u.removeItem(o),Ac(c),a[3]={points:ge(c,"points")},mr.save(a))}};function Bh(t){let e=[];for(let r of t){let i=te.getById(r.id).cmdKey;if(i=="dimension"&&te.getDimension(r.id).category=="Constraint")return el.toastMsg(),[];["dimension","auxiliaryLine","auxiliaryPoint"].includes(i)||e.push(r)}if(!e.length)return[];if(t.length>1){let r=new Ad().findDimensionByPrimitiveId(new Set(t.map(i=>i.id)));for(let i of r)if(te.getDimension(i).category=="Constraint")return el.toastMsg(),[]}return t}var jg=class jg{static bringObjsToFront(e){let r;e[0]instanceof Element?r=e:r=RE({ids:e});let i=r.length,n=[],s=this.getFirstEleByLayerId(8);if(i)for(let a=i-1;a>=0;a--){let o=r[a],l=o.parentNode;if(o!=l.lastChild){let c=o.nextElementSibling?o.nextElementSibling.id:"";l.insertBefore(o,s),n.push(["elePosition",o.id,c,""])}}return n}static getCurrentScheme(){return this.currentScheme}static async init({docType:e,tabId:r}){let i=(await pd("getActiveLayerSetting",[{docType:e,tabId:r}])).message;this.apply(i)}static switch(e){this.currentScheme=e}static get activeLayer(){return this._activeLayer}static setActiveLayer(e){this._activeLayer=e}static apply(e,r){this.patch(e),this.switch(e),this.applyActive(r),this.applyLocked(),this.applyVisible()}static resetDefaultScheme(){this.removeActived()}static getLayerPreviousLayer(e){var s;let r=new cd;dy().reverse().forEach(a=>{r.addLast(a)});let n=r.iterator();do{let{value:a}=n;if(a.item===e)return(s=a.prev)==null?void 0:s.item;n.next()}while(n.hasNext())}static makeLayerHoming(e){let r=this._activeLayer?this._activeLayer:8;if(e===r)return NM;let i=this,n=[],s=new DocumentFragment;Us(`[layer="${e}"]`,X.gCanvas).forEach(d=>{var h;let A=((h=d.nextSibling)==null?void 0:h.id)||"";n.push(["elePosition",d.id,A,""]),s.append(d)});let o,l;c(e);function c(d){o=i.getLayerPreviousLayer(d),o&&(o===r||!(l=Hs(`[layer="${o}"]`,X.gCanvas)))&&c(o)}l||(l=Hs(`[layer="${r}"]`,X.gCanvas));let u=l?d=>{l.before(d)}:d=>{X.gCanvas.append(d)};return[...s.children].forEach(u),n}static applyActive(e){let{actived:r}=this.recorder,i=this.activeLayer;for(let n in r){if(r[n]){this.setActiveLayer(+n),this.removeActived();let s=this.getFirstEleByLayerId(8);te.getItemOrder().forEach(a=>{var l;if(((l=te.getById(a).json)==null?void 0:l.layer)===this._activeLayer){let c=Hs(`#${a}`);X.gCanvas.insertBefore(c,s)}});break}if(Object.keys(r).length===1&&!r[n]){this.setActiveLayer(null);break}}}static removeActived(){let e=te.getItemOrder(),r=null;for(let i=e.length-1;i>=0;i--){let n=Hs(`#${e[i]}`);n&&(X.gCanvas.insertBefore(n,r),r=n)}}static applyLocked(){let{locked:e}=this.recorder;for(let r in e){let i=[...Us(`[layer="${r}"]`,X.gCanvas)],n=e[r];i.forEach(s=>Qu(s,pt.unselectableClass,n))}}static applyVisible(){let{visible:e}=this.recorder;for(let r in e)+r===-1&&new ih().display(e[r]);te.iterator(r=>{Ir(r.layer)||rn.applyElementsVisible(r.gId)})}static patch(e){let{recorder:r}=this;r.actived=Object.create(null),r.locked=Object.create(null),r.visible=Object.create(null);let{options:i}=e;for(let{visible:n,locked:s,actived:a,id:o}of i)r.visible[o]=n,r.locked[o]=s,a&&(r.actived[o]=a)}static appendTargetLayer(e,r=jg.activeLayer,i=!0,n={}){var l;let s=n.cmdKey||Pi(e);Ty[s].includes(+r)||(i&&X.windowBridge.publish("ui/toastMsg",{type:"warn",msg:KTe[s],timer:3},ur()),r=1),this.switchLayer(e,r);let{visible:a,locked:o}=((l=this.currentScheme)==null?void 0:l.options.find(({id:c})=>+r==+c))||{};Qu(e,pt.unselectableClass,o)}static getTargetPlaceLayer(e){return Ty[e].includes(jg.activeLayer)?jg.activeLayer:1}static switchLayer(e,r){var l,c;let i=[],n=((l=e==null?void 0:e.nextElementSibling)==null?void 0:l.id)||"",s="",a=dy(),o=jg.getLastEleByLayerId(r);if(o)s=(c=o.nextElementSibling)==null?void 0:c.id,X.gCanvas.insertBefore(e,o.nextElementSibling);else{let u=a.indexOf(r);for(let d=u+1;d<a.length;d++){let A=this.getFirstEleByLayerId(a[d]);if(A){o=A,s=A.id;break}}r===8&&!o||o||(o=jg.getFirstEleByLayerId(this.activeLayer),s=o==null?void 0:o.id),X.gCanvas.insertBefore(e,o)}return i.push(mr.createElePosition(e.id,n,s)),i}static getZIndexMap(){let e=te.getItemOrder(),r={};e.forEach(n=>{let{zIndex:s}=te.getById(n).json;rq(r,s).push(n)});let i=new Map;return Object.keys(r).forEach(n=>i.set(Number(n),r[n])),i}static getFirstEleByLayerId(e){let i=X.gCanvas.firstChild;for(;;){if(!i)return null;if(+ge(i,"layer")==+e)return i;i=i.nextSibling}}static getLastEleByLayerId(e){let i=X.gCanvas.lastChild;if(!i)return null;for(;;){if(+ge(i,"layer")==+e)return i;if(i=i.previousSibling,!i)return null}}static getNextEleById(e){let r=te.getItemOrder(),i=BL(),{layer:n,zIndex:s}=te.getById(e).json,a=this._activeLayer===n,o=r.find(l=>{let{layer:c,zIndex:u}=te.getById(l).json;if(c===n)return u>s&&Hs(`#${l}`);if(!a&&n!==8){let d=i.get(c),A=i.get(n);return d>A&&Hs(`#${l}`)}});return o?Hs(`#${o}`):null}static getNodeLayer(e){return+ge(e,"layer")}static getNextSameLayerNode(e){let r=this.getNodeLayer(e),i=e.nextSibling;if(!i)return null;for(;;){if(this.getNodeLayer(i)===+r)return i;if(i=i.nextSibling,!i)return null}}static getPrevSameLayerNode(e){let r=this.getNodeLayer(e),i=e.previousSibling;if(!i)return null;for(;;){if(this.getNodeLayer(i)===+r)return i;if(i=i.previousSibling,!i)return null}}};jg._activeLayer=null,jg.recorder=Object.create(null);var Ar=jg,KTe={obj:"Images can only be placed on the print layer",text:"Texts can only be placed on the print layer or the opacity layer"};var gE="selected",Kk="highlight",bK="object-unselectable",xK=Vd(()=>{var t;(t=te.selectedRepeater)==null||t.updateChange(),ms.appendSelectStroke(),lp(void 0,yb())},0);function JTe(t){let e=t.id;if(!pt.isUnselectAble(e))return Ph.select(e),Qu(Fe(e),gE,!0),xK(),!0}function $L(t){Ph.unselect(t.id),Qu(t,gE,!1),xK()}function ZL(t){uu(t,bK)||Qu(t,Kk,!0)}function eO(t){Qu(t,Kk,!1)}var pt=class{static isUnselectAble(e){let r=$u(),{json:i,cmdKey:n}=te.getById(e);if(!i)return!0;let s=pi.isEditingPath();if(s&&e!==s&&!Fo(n))return!0;let{layer:a,hide:o,gId:l,locked:c}=i;if(r["all-element-type"][SS(n)].checked===!1||rn.eleIsHide(i)||r["all-state"].hide.checked===!1&&o||r["all-state"].visible.checked===!1&&!o||r["all-state"].lock.checked===!1&&c||r["all-state"].unlock.checked===!1&&!c)return!0;let{options:u}=Ar.getCurrentScheme();for(let d of u)if(+d.id==+a&&d.locked)return!0;return!1}static count(){return Ph.get().size}static select(e){for(let r=0,i=e.length;r<i;r++){let n=e[r];this.isSelected(n)||this.combinationSelectById(n.id)}}static combinationSelectById(e){if(!Li.isEleCanSelect(e)&&!Fo(te.getById(e).cmdKey)||!pi.isEleCanSelect(e)&&!Fo(te.getById(e).cmdKey))return;let r=Li.findCombinationElementsById(e);if(r!==y_){for(let i of r)Qu(Fe(i),gE,!0),Ph.select(i);JTe({id:e})}}static unselect(e){if(e){if(e.nodeType==1)$L(e);else if(e.length)for(var r=0,i=e.length;r<i;r++)$L(e[r])}}static unSelectById(e){Ph.unselect(e)}static highlight(e){if(e){if(e.nodeType==1)ZL(e);else if(e.length)for(var r=0,i=e.length;r<i;r++)ZL(e[r])}}static unhighlight(e){if(e){if(e.nodeType==1)eO(e);else if(e.length)for(var r=0,i=e.length;r<i;r++)eO(e[r])}}static toggleHighlight(e,r){if(e){if(e.nodeType==1)r===!0?ZL(e):r===!1&&eO(e);else if(e.length)for(var i=0,n=e.length;i<n;i++)r===!0?ZL(e[i]):r===!1&&eO(e[i])}}static isSelected(e){return rn.eleIsHide(te.getById(e.id).json)?!1:Ph.isSelect(e.id)}static toggle(e,r){for(let i=0,n=e.length;i<n;i++)r===!0?this.select([e[i]]):r===!1?$L(e[i]):r===void 0&&(Ph.isSelect(e[i].id)?$L(e[i]):this.select([e[i]]))}static unselectAll(){return Ph.get().clear(),this}static get(){let e=Ph.get(),r=[];for(let i of e){let n=Hs("#"+i,X.gCanvas);n?r.push(n):(console.error("no dom, Plz check code",i),Ph.unselect(i))}return r}static getIds(){return[...Ph.get()]}};pt.highlightClass=Kk,pt.selectClass=gE,pt.unselectableClass=bK;var tO=class{constructor(){this.selectIds=new Set}select(e){if(!jd(e))throw new Error(e);this.selectIds.add(e)}unselect(e){if(!jd(e))throw new Error(e);this.selectIds.delete(e)}isSelect(e){if(!jd(e))throw new Error(e);return this.selectIds.has(e)}get(){return this.selectIds}getIds(){return[...this.selectIds]}clear(){this.selectIds.clear()}},Ph=new tO,ME=new tO;function EK(t,e){let r=new Bn(t),i=r.vectorCenter(),n=un(t,"arc"),s=Wi.transferXYByReference(n),a=new ne(s[0],s[1]);for(let[o,l]of Object.entries(e))switch(o){case"attr-width":ls.syncArcSize(t,a,l,null);break;case"attr-height":ls.syncArcSize(t,a,null,l);break;case"attr-arc-type":r.setArcType(l==="Two Points Arc"?2:1).render();break;case"attr-start-x":r.setStart(l,t.y1);break;case"attr-start-y":r.setStart(t.x1,l);break;case"attr-end-x":r.setEnd(l,t.y2);break;case"attr-end-y":r.setEnd(t.x2,l);break;case"attr-short-radius":r.setRadius(void 0,l,a).render();break;case"attr-long-radius":r.setRadius(l,void 0,a).render();break;case"attr-circle-center-x":{let c=Ue.translate(l-i.x,0);ls.syncArc(t,c,{updateD:!0})}break;case"attr-circle-center-y":{let c=Ue.translate(0,l-i.y);ls.syncArc(t,c,{updateD:!0})}break;case"attr-start-angle":r.setAngle(-l,"start").render();break;case"attr-end-angle":r.setAngle(-l,"end").render();break;case"attr-rotation":{ls.rotate(t,-l,a);break}case"attr-x":{let c=Ue.translate(l-s[0],0);ls.syncArc(t,c,{updateD:!0})}break;case"attr-y":{let c=Ue.translate(0,l-s[1]);ls.syncArc(t,c,{updateD:!0})}break;default:console.error(o,"Plz check code");break}}function wK(t,e){let r=new ca(t),i=_h([Fe(t.gId)],!0,{ignoreSnap:!0});for(let[n,s]of Object.entries(e))switch(n){case"attr-start-x":r.setHeadFree(s,t.y1);break;case"attr-start-y":r.setHeadFree(t.x1,s);break;case"attr-end-x":r.setTailFree(s,t.y2);break;case"attr-end-y":r.setTailFree(t.x2,s);break;case"attr-rotation":r.rotateSelf(-e[n],new ne(i.x,i.y));break}r.setData().render()}function vK(t,e){let r=new ga(t);Object.keys(e).forEach(i=>{let n=e[i];switch(i){case"attr-start-x":r.setStart(n,t.y1);break;case"attr-start-y":r.setStart(t.x1,n);break;case"attr-end-x":r.setEnd(n,t.y2);break;case"attr-end-y":r.setEnd(t.x2,n);break;case"attr-dimension-angle-x":r.setAngle(n,t.angleY);break;case"attr-dimension-angle-y":r.setAngle(t.angleX,n);break;case"attr-angle":r.setAngleDeg(n);break;case"attr-rotation":r.rotateSelf(-e[i],null);break;default:break}}),r.setData().render()}function CK(t,e){let r=new ya(t),i=_h([Fe(t.gId)],!0,{ignoreSnap:!0});for(let n of Object.keys(e))switch(n){case"attr-start-x":r.setStart(e[n],t.y1);break;case"attr-start-y":r.setStart(t.x1,e[n]);break;case"attr-end-x":r.setEnd(e[n],t.y2);break;case"attr-end-y":r.setEnd(t.x2,e[n]);break;case"attr-length":r.updateDistance(e[n]);break;case"attr-rotation":r.rotateSelf(-e[n],new ne(i.x,i.y));return}r.calcuMeasurePoint().setData().render()}function SK(t,e){let r=un(e,"ellipse"),i=Wi.transferXYByReference({...r,x:t["attr-x"]||r.x,y:t["attr-y"]||r.y}),n=new ne(i[0],i[1]);if($t(t,"attr-x")||$t(t,"attr-y")){let s=Wi.transferXYByReference({...r,x:t["attr-x"],y:t["attr-y"]},!0);tn.syncEllipsePosition(e,s[0],s[1])}if(($t(t,"attr-width")||$t(t,"attr-height"))&&tn.syncEllipseSize(e,t["attr-width"],t["attr-height"],n),$t(t,"attr-rotation")){let s=Wi.transferXYByReference(r),a=new ne(s[0],s[1]),o=t["attr-rotation"];tn.syncEllipseByRotation(-o,e,a,{beautify:!0})}($t(t,"attr-short-radius")||$t(t,"attr-long-radius"))&&tn.syncEllipseRadius(e,t["attr-short-radius"],t["attr-long-radius"],n)}async function TK(t,e){let r=Fe(e.gId),i=new WP(r),n=Ab(e),s=Wi.transferXYByReference({...n,x:t["attr-x"],y:t["attr-y"]},!0);ps.syncTextPosition(e,s[0],s[1]);let a=Wi.transferXYByReference({...n}),o=new ne(a[0],a[1]);($t(t,"attr-width")||$t(t,"attr-height"))&&ps.syncTextSize(e,t["attr-width"],t["attr-height"],o);for(let l in t){let c=t[l];switch(l){case"attr-textarea":if(c)await i.name(c);else{fd([r]);return}break;case"attr-font-color":e.strokeColor=c,i.strokeColor(c);break;case"attr-font-family":await i.fontFamily(c);break;case"attr-origin":let[u,d]=dP(c);ps.syncTextWithOrigin(e,u,d),e.hAlign=u,e.vAlign=d;break;case"attr-font-weight":await i.fontWeight(c);break;case"attr-font-style":await i.italic(c);break;case"attr-font-underline":await i.underline(c);break;case"attr-font-size":await i.fontSize(c);break;case"attr-reset-text":ps.resetText(r);break;case"attr-rotation":ps.syncTextWithRotation(e,-c,o);break;case"attr-width":case"attr-height":case"attr-obb-width":case"attr-obb-height":break;default:break}}}function IK(t,e){for(let r in e)switch(r){case"attr-name":{t.name=e[r];break}case"attr-layer":{t.layer=e[r];break}case"attr-locked":{t.locked=e[r];break}case"attr-x":{t.x=e[r];break}case"attr-y":{t.y=e[r];break}case"attr-color":{t.fillColor=e[r];break}case"attr-reset-color":t.fillColor=X.panelThemeCache.fillColor.auxiliaryPoint;case"attr-conceal":{t.visible=e[r]!=="yes";break}default:console.error(`AuxiliaryLine: can not update attr(${r}) on auxiliaryLine`)}}function BK(t,e){for(let r in e){let i=e[r];switch(r){case"attr-name":{t.name=i;break}case"attr-layer":{t.layer=i;break}case"attr-locked":{t.locked=i;break}case"attr-x":{t.x=i;break}case"attr-y":{t.y=i;break}case"attr-color":{t.strokeColor=i;break}case"attr-reset-color":{t.strokeColor=X.panelThemeCache.color.auxiliaryLine;break}case"attr-stroke-style":{t.strokeStyle=py(i).key;break}default:console.warn(`AuxiliaryLine: can not update attr(${r}) on auxiliaryLine`)}}new dd(t).render()}var vb=class{static getCacheObj(e){var r,i=u_(tb("preferences")||tb("preferences")||"{}");return i?i[e]:r}static getValueFromCacheUser(e){var r=I6();return r&&$t(r,e)?r[e]:""}};function DK(t,e){let{x:r,y:i,width:n,height:s}=la(e),a=[],o=1,l=1,c=Wi.transferXYByReference({x:r,y:i,width:n,height:s}),u=new ne(c[0],c[1]),d=0,A=0,h=0;for(let f in t){let p=+t[f];switch(f){case"attr-width":case"attr-bbox-width":o=(t["attr-bbox-width"]||t["attr-width"])/n;break;case"attr-height":case"attr-bbox-height":l=(t["attr-bbox-height"]||t["attr-height"])/s;break;case"attr-x":case"attr-bbox-x":A=Wi.transferXYByReference({x:p,y:i,width:n,height:s},!0)[0]-r;break;case"attr-y":case"attr-bbox-y":h=Wi.transferXYByReference({x:r,y:p,width:n,height:s},!0)[1]-i;break;case"attr-rotation":case"attr-bbox-rotation":d=p;break}}for(let f of e){let{cmdKey:p,json:m}=te.getById(f.id);qL([m],-d+m.rotation,u),Io.move(m,A,h);let y=un(m);$Te(p,m,o*y.width,l*y.height,u),a.push(()=>{Array.isArray(m.tempMatrix)&&te.updatePrimitiveJson(m.gId,"matrix",m.tempMatrix)})}return a}function $Te(t,e,r,i,n){switch(t){case"group":To.syncGroupSize(e,r,i,n);break;case"obj":Ns.syncImageSize(e,n,r,i);break;case"text":ps.syncTextSize(e,r,i,n);break;case"ellipse":tn.syncEllipseSize(e,r,i,n);break;case"arc":ls.syncArcSize(e,n,r,i);break;case"rect":vn.syncRectSize(e,n,r,i);break;default:console.error(t)}}function ZTe(t,e){console.warn(t,e);let r=[],i=t.id,s=new gr().getAllElesfromTop(i).elements;for(let c of s)r.push(Fe(c));let a=jL([t],X.tabId);e=Wi.widthHeightKeepSameRatio(e,a);for(let c of r)mr.jsonSnap.addOne(te.getById(c.id).json);mr.jsonSnap.addOneCombineByComId(i);let o=[],l=te.getCombination(i);e:for(let c in e)switch(c){case"attr-name":{let u=e[c];l.name=u}break;case"attr-locked":{let u=e[c]!=="no";l.locked=u}break;case"attr-conceal":{let u=e[c]==="no";l.visible=u}break;case"attr-width":case"attr-height":{o.push(...DK(e,r));break e}default:o.push(...DK(e,r));break}return o}async function LK(t,e){var p,m,y;e=vi(e);let r=[];if(t.cmdKey==="canvas")return An.modify_canvas(e);let{cmdKey:i,id:n}=t,s=Fe(n);if("combination"===i)return ZTe(t,e);let a=Yk([s]),o=jL(a,X.tabId,{notCreate8Dots:!0});e=Wi.widthHeightKeepSameRatio(e,o);let l=(m=(p=te.gJsonCache[i])==null?void 0:p[s.id])==null?void 0:m.layer,c=+e["attr-layer"],u=te.getById(n).json;if(aIe(u,e),$t(e,"attr-layer")&&(c==l?delete e["attr-layer"]:(e["attr-transparency-print"]=1,e["attr-transparency-white"]=1,ge(s,"opacity",1),u.transparencyPrint=1,u.transparencyWhite=1)),e=Wi.filterModifyAttrs(e,o),$t(e,"attr-rotation")&&!eIe(e["attr-rotation"],u,i)&&delete e["attr-rotation"],Object.keys(e).length===0)return;if(mr.jsonSnap.addOne(u),console.log(t,e),$t(e,"attr-rotation")){let g=Cs(e["attr-rotation"]);e["attr-rotation"]=g}switch(($t(e,"attr-obb-width")||$t(e,"attr-obb-height"))&&new Iy().syncSelfObbSize(u,e["attr-obb-width"],e["attr-obb-height"]),i){case"obj":let g=e["attr-href"];if(g!==void 0&&!sq(g)||g!==void 0&&$X(g)!=g||c&&c!==1)return;iIe(e,u);break;case"rect":tIe(e,u);break;case"ellipse":SK(e,u);break;case"group":rIe(e,u);break;case"text":await TK(e,u);break;case"auxiliaryLine":{BK(u,e);break}case"auxiliaryPoint":{IK(u,e),hb(u,s.id);break}case"dimension":{el.updateDimensionData(t.id,e);break}case"dimensionLength":{CK(u,e);break}case"dimensionAngle":{vK(u,e);break}case"dimensionRadius":{wK(u,e);break}case"arc":{EK(u,e);break}default:console.error(i);break}if($t(e,"attr-locked")&&(u.locked=e["attr-locked"]==="yes"),$t(e,"attr-conceal")&&(u.visible=e["attr-conceal"]!=="yes",rn.applyElementsVisible(n)),$t(e,"attr-layer")){let g=((y=te.gJsonCache[i])==null?void 0:y[s.id])||{},b={layer:g.layer,cover:"cover"in g?g.cover:ge(s,"cover")=="1",scope:g.scope},E={layer:c,cover:b.cover,scope:b.scope},w=Ty[i];if(!w||w.includes(E.layer)){E.layer==1&&(E.cover=b.cover,g.cover=!0),E.layer==2&&(E.scope=b.scope||1,ge(s,"scope",E.scope),g.scope=E.scope);let x=Ar.switchLayer(s,c);r.push(...x),ge(s,"layer",c),g.layer=c;let I=vi(Ar.getCurrentScheme());for(let C of I.options)C.actived===!0&&(C.actived=!1),+C.id==+c&&(C.actived=!0);Ar.apply(I),Et("panel/active-layer",[c,X.tabId,{updateUI:!0}])}}if($t(e,"attr-cover")&&ge(s,"cover",e["attr-cover"]==="yes"?1:0),$t(e,"attr-scope")&&ge(s,"scope",e["attr-scope"]),$t(e,"attr-name")&&ge(s,"name",e["attr-name"]),$t(e,"attr-hide")&&ge(s,"hide",e["attr-hide"]==="yes"?"1":"0"),$t(e,"attr-transparency-print")&&[+c,+l].includes(2)){let g=db(+e["attr-transparency-print"]*100,+e["attr-transparency-white"]*100);ge(s,"opacity",g),ge(s,"transparency-print",e["attr-transparency-print"]),ge(s,"transparency-white",e["attr-transparency-white"])}let d=i==="text",A=["auxiliaryLine","auxiliaryPoint","dimension","dimensionAngle","dimensionLength","dimensionRadius"].includes(i),h=$t(e,"attr-stroke-color"),f=$t(e,"attr-stroke-width");if(!d&&!A&&h!==f){let g=e["attr-stroke-color"],b=e["attr-stroke-width"];if(b<0)return;let E=u.strokeColor,w=u.strokeWidth;h?g==="none"?e["attr-stroke-width"]=0:w||(e["attr-stroke-width"]=3.937):b===0?e["attr-stroke-color"]="none":E==="none"&&(e["attr-stroke-color"]="#000000")}if("attr-stroke-fill-swap"in e&&(e["attr-stroke-color"]=u.fillColor,e["attr-fill-color"]=u.strokeColor,u.fillColor=e["attr-fill-color"],u.strokeColor=e["attr-stroke-color"]),"attr-stroke-color-display"in e){let g=e["attr-stroke-color-display"];u.displayStroke=g,iT(s,i,u)}if("attr-fill-color-display"in e){let g=e["attr-fill-color-display"];u.displayFill=g,nT(u)}if($t(e,"attr-stroke-width")){let g=e["attr-stroke-width"];u.strokeWidth=g,$k(s,i,g)}if(!Ir(u.displayStroke)&&$t(e,"attr-stroke-color")){let g=e["attr-stroke-color"];u.strokeColor=g,iT(s,i,u)}if(!Ir(u.displayFill)&&$t(e,"attr-fill-color")){let g=e["attr-fill-color"];u.fillColor=g,nT(u)}r.length&&mr.save(r),e&&Reflect.ownKeys(e).length&&Cq(t,e)}function eIe(t,e,r){if(!["obj","rect","ellipse","group","text","arc"].includes(r))return!0;let i=sT(e),n=Wi.transferXYByReference(i),s=new ne(n[0],n[1]),a;switch(r){case"obj":a=Ns.getRotationMatrix(t,e,s);break;case"rect":a=vn.getRotationMatrix(-t,e,s);break;case"ellipse":a=tn.getRotationMatrix(-t,e,s,{beautify:!0});break;case"group":a=To.getRotationMatrix(e,-t,s);break;case"text":a=ps.getRotationMatrix(e,-t,s);break;case"arc":{a=ls.getRotationMatrix(e,-t,s);break}default:return!0}return $i.checkOne(r,e,a)}function iT(t,e,r){let i=r.strokeColor||"none";e==="text"&&ge(Hs("path",t),{stroke:i,fill:i}),r.displayStroke===!1&&(i="none"),ge(t,{stroke:i})}function nT(t){let e=t.fillColor||"none";t.displayFill===!1&&(e="none"),Hi.renderer.attr(t.gId,"fill",e)}function $k(t,e,r){switch(e){case"text":ge(Hs("path",t),{"stroke-width":r});break;default:ge(t,{"stroke-width":r});break}}function Yk(t){let e=new Map,r=th();for(let s of r)if(s.combinationId)for(let a of s.elements)e.set(a,s.combinationId);let i=[],n=new Set;for(let s of t){if(e.has(s.id)){let o=e.get(s.id);if(n.has(o))continue;n.add(o),i.push({id:o,cmdKey:"combination"});continue}let{cmdKey:a}=te.getById(s.id);i.push({id:s.id,cmdKey:a})}return i}function _K(t){let e=Hr("image",{"xlink:href":t.content});X.gCanvas.appendChild(e);let r=e.getBBox();return Cr(e),r}function db(t,e){let{point:r}=Pc({x:t,y:e},{x:0,y:0},{x:100,y:100}),i=MC({x:0,y:0},{x:100,y:100});return 1-MC({x:r.x,y:r.y},{x:100,y:100})/i}var OK=(c=>(c[c.top_left=0]="top_left",c[c.top_middle=1]="top_middle",c[c.top_right=2]="top_right",c[c.middle_left=3]="middle_left",c[c.middle_middle=4]="middle_middle",c[c.middle_right=5]="middle_right",c[c.bottom_left=6]="bottom_left",c[c.bottom_middle=7]="bottom_middle",c[c.bottom_right=8]="bottom_right",c))(OK||{}),Jk=class{constructor(){this.referencePointKey="reference-point";this.getReferencePoint()}getReferencePoint(){let e=localStorage.getItem(this.referencePointKey),r=Ir(e)?6:+e;return Object.values(OK).filter(i=>isFinite(i)).includes(r)||(r=6),this.referencePoint=r}setReferencePoint(e){this.referencePoint=e,localStorage.setItem(this.referencePointKey,e+"")}transferXYByReference(e,r=!1){let i=~~(this.referencePoint/3),n=this.referencePoint%3,{x:s,y:a,height:o,width:l}=e,c=l/2*n,u=o/2*i;return r&&(c*=-1,u*=-1),[s+c,a+u]}getReference(){let e=~~(this.referencePoint/3),r=this.referencePoint%3;return[e,r]}shouldHideAttrStyle(e){return!![3,4,5,2,7].includes(+e)}filterAttrByLayer(e,r){this.shouldHideAttrStyle(r)&&(Reflect.deleteProperty(e,"attr-stroke-color"),Reflect.deleteProperty(e,"attr-fill-color"),Reflect.deleteProperty(e,"attr-stroke-width"))}filterModifyAttrs(e,r){let i=vi(e);return r["attr-stroke-color"]||delete i["attr-stroke-color"],r["attr-fill-color"]||delete i["attr-fill-color"],r["attr-stroke-width"]||delete i["attr-stroke-width"],i["attr-radius"]<0&&delete i["attr-radius"],i["attr-obb-width"]<0&&delete i["attr-obb-width"],i["attr-obb-height"]<0&&delete i["attr-obb-height"],i["attr-width"]<=0&&delete i["attr-width"],i["attr-height"]<=0&&delete i["attr-height"],i["attr-short-radius"]<0&&delete i["attr-short-radius"],i["attr-long-radius"]<0&&delete i["attr-long-radius"],r.cmdKey==="dimension"&&i["attr-locked"]==="yes"&&delete i["attr-locked"],i}widthHeightKeepSameRatio(e,r){if(!e["ratio-height-weight"])return e;let i="attr-width",n="attr-height",s="attr-bbox-width",a="attr-bbox-height";return $t(e,i)&&$t(e,n)?e:$t(e,i)?(e[n]=+(+e[i]/r[i]*r[n]).toFixed(2),e):$t(e,n)?(e[i]=+(e[n]/r[n]*r[i]).toFixed(2),e):$t(e,s)&&$t(e,a)?e:$t(e,s)?(e[a]=+(+e[s]/r[s]*r[a]).toFixed(2),e):($t(e,a)&&(e[s]=+(e[a]/r[a]*r[s]).toFixed(2)),e)}},Wi=new Jk;function tIe(t,e){let r=sT(e),i=Wi.transferXYByReference(r),n=new ne(i[0],i[1]);if($t(t,"attr-x")||$t(t,"attr-y")){let s=Wi.transferXYByReference({x:t["attr-x"],y:t["attr-y"],width:r.width,height:r.height},!0);vn.syncRectPosition(e,s[0],s[1])}if(($t(t,"attr-width")||$t(t,"attr-height"))&&vn.syncRectSize(e,n,t["attr-width"],t["attr-height"]),"attr-rotation"in t){let s=+t["attr-rotation"];vn.syncRectByRotation(-s,e,n)}if($t(t,"attr-radius")){let s=t["attr-radius"];ge(Fe(e.gId),{rx:s,ry:s}),e.rx=s,e.ry=s}}function rIe(t,e){let r=To.getGroupBBox(e),i=Wi.transferXYByReference(r),n=new ne(i[0],i[1]);if($t(t,"attr-rotation")){let s=t["attr-rotation"];To.syncGroupWithRotation(e,-s,n)}if("attr-x"in t){let s=Wi.transferXYByReference({...r,x:t["attr-x"]},!0);Io.move(e,s[0]-r.x,0)}if("attr-y"in t){let s=Wi.transferXYByReference({...r,y:t["attr-y"]},!0);Io.move(e,0,s[1]-r.y)}To.syncGroupSize(e,t["attr-width"],t["attr-height"],n)}function iIe(t,e){let r=Fe(e.gId),i=sT(e),n=Wi.transferXYByReference(i),s=new ne(n[0],n[1]);if(("attr-width"in t||"attr-height"in t)&&Ns.syncImageSize(e,s,t["attr-width"],t["attr-height"]),"attr-x"in t||"attr-y"in t){let a=Wi.transferXYByReference({x:t["attr-x"],y:t["attr-y"],width:i.width,height:i.height},!0);Ns.syncImagePosition(r,a[0],a[1])}for(let a in t){let o=t[a];switch(a){case"attr-href":e.content=o,ge(r,{"xlink:href":o});break;case"attr-transparency":o=Math.min(Math.max(+o,0),100),e.opacity=1-o/100;let l=$t(t,"attr-layer")?+t["attr-layer"]:e.layer;ge(r,"opacity",l==2?1-e.opacity:e.opacity);break;case"attr-rotation":Ns.syncImageByRotation(-o,e,s);break;case"attr-reset-image-width":{let{width:c,height:u}=_K(e),d=Ns.getImageShapeForAttr(e.matrix),A=nr.createMatrixFrom6(e.matrix).getInverseMatrix(),h=Ue.scale(c/u*d.height,d.height).rotateD(e.rotation).translate(d.x,d.y),f=new Ue(A.data);Ns.syncImage(e,f.multiply3(h));break}case"attr-reset-image-height":{let{width:c,height:u}=_K(e),d=Ns.getImageShapeForAttr(e.matrix),A=nr.createMatrixFrom6(e.matrix).getInverseMatrix(),h=Ue.scale(d.width,u/c*d.width).rotateD(e.rotation).translate(d.x,d.y),f=new Ue(A.data);Ns.syncImage(e,f.multiply3(h));break}default:console.error("image attr",a);break}}}function tK(){let t=pt.get(),e=new qi(t);for(let r of t){let{json:i,cmdKey:n}=te.getById(r.id);if(!i.fillColor||!i.strokeColor)continue;let s=i.strokeColor;i.strokeColor=i.fillColor,i.fillColor=s,iT(r,n,i),nT(i)}e.updateAndSave(),Et("panel_updateAttrPanel")}function jL(t,e,r={}){let i=te.gJsonCache,n=t.every(o=>o.cmdKey===t[0].cmdKey)?t[0].cmdKey:"",s={"attr-selected-count":0,docType:i.head.docType,target:{[e]:{}},cmdKey:n,"filter-object":""},a=new Set;for(let o of t)if(!["dimension","dimensionLength","dimensionAngle","dimensionRadius","auxiliaryLine","auxiliaryPoint"].includes(o.cmdKey)){if("combination"===o.cmdKey){let l=new gr().getAllElesfromTop(o.id).elements;for(let c of l)a.add(Fe(c));continue}o.id&&a.add(Fe(o.id))}!r.notCreate8Dots&&a.size&&Ja([...a],{create8Dots:!0}),a.size===0&&(eA(),hm(),Dg("","none"));for(let o of t){let l=o.cmdKey;if(l==="canvas"){s.target[e].canvas=o,s=PK(s,An.getCanvasAttrs());continue}s.target[e][o.id]=o;let c=i[l];if(!c)throw new Error(l);if(!c[o.id])throw new Error(o.id);c[o.id].gId||(c[o.id].gId=o.id,c[o.id]._addGId=!0),o.cmdKey==="text"&&(c[o.id].type=c[o.id].key||"Text"),o.cmdKey==="obj"&&(c[o.id].type="image");let u=te.getShapeAttr(c[o.id],o.cmdKey);s=PK(s,u),c[o.id]._addGId&&(c[o.id].head?delete c[o.id].head.gId:delete c[o.id].gId,delete c[o.id]._addGId)}return s=nIe(t.filter(o=>!Fo(o.cmdKey)),s),s}function nIe(t,e){if(t.length<2)return e;let r=[];for(let i of t)i.cmdKey==="combination"?te.getCombination(i.id).elements.forEach(n=>{r.push(Fe(n))}):r.push(Fe(i.id));return sIe(r,e)}function sIe(t,e){let r=la(t),i=Wi.transferXYByReference(r),[n,s]=te.translateByOrigin(i[0],i[1]);return{"attr-bbox-x":n,"attr-bbox-y":s,"attr-bbox-width":r.width,"attr-bbox-height":r.height,"attr-bbox-rotation":0,...e}}function PK(t,e){let r="attr-selected-count";e.cmdKey!=="canvas"&&t[r]++;for(let n in e){if(!$t(e,n)||n===r||n==="docType"){e.docType&&!t.docType&&(t.docType=e.docType);continue}if(!$t(t,n)){t[n]=e[n];continue}if(n==="target"){t.target||(t.target={}),e.target||(e.target={});for(let s in e[n])$t(e[n],s)&&(t[n][s]?t[n][s]=Object.assign(t[n][s],e[n][s]):t[n][s]=e[n][s])}else{if(n==="type"&&Fo(t.type)&&Fo(e.type))continue;t[n]!==e[n]&&n!=="cmdKeys"&&n!=="attr-topic"&&n!=="attr-text-key"&&n!="attr-dimension-object"&&n!=="attr-primitive-type"&&(t[n]=B2),i(n)}}function i(n){n==="attr-dimension-object"&&t[r]>0&&(t["attr-dimension-object"]=t["attr-dimension-object"].concat(e["attr-dimension-object"])),n==="attr-primitive-type"&&t[r]>0&&(t["attr-primitive-type"]=t["attr-primitive-type"].concat(e["attr-primitive-type"]))}return t}function aIe(t,e){if(t.locked)for(let r in e)l_.includes(r)||delete e[r];return e}var Zk=class{constructor(){this.polyline=[]}async run(e){this.type=e;let r=qP().filter(i=>!Fo(i.cmdKey));if(!r.length){Zn("\u5F53\u524D\u753B\u5E03\u4E2D\u6CA1\u6709\u9009\u4E2D\u7684\u5143\u7D20");return}if(e=="boolSubtraction"){let i=te.getItemOrderMap();r.sort((n,s)=>i.get(n.gId)-i.get(s.gId))}this.selectedObjs=r,Hi.history.startBatch(),r=await Promise.all(r.map(async i=>{let n=un(i),{x:s,y:a,height:o,width:l}=n,c=Wi.getReferencePoint();Wi.setReferencePoint(0);let u=a,d=s,A=s+l,h=a+o,f=Yl(u),p=Yl(d),m=Yl(A),y=Yl(h),g=lu(ry(f)),b=lu(ry(p)),E=lu(ry(m)),w=lu(ry(y)),x=u-g,I=d-b,C=E-b,G=w-g;return Io.move(i,-I,-x),await LK({id:i.gId,cmdKey:i.cmdKey},{"attr-width":C,"attr-height":G}),Wi.setReferencePoint(c),i})),this.polyline=In.convertData2Polyline(r),this.operate(),Hi.history.saveBatch()}operate(){let e;switch(this.type){case"boolAggregate":e=In.boolAggregate(this.polyline);break;case"boolIntersection":e=In.boolIntersection(this.polyline);break;case"boolSubtraction":if(e=In.boolSubtraction1(this.polyline),!e.length&&this.polyline.length==2){let n=[this.polyline[1],this.polyline[0]];e=In.boolSubtraction1(n)}break;case"boolExclusive":e=In.boolExclusive(this.polyline);break}e=e.map(n=>n.round(4));let r=["boolAggregate","boolSubtraction"].includes(this.type),i=In.convertPolylines2Svg(e,r,!1);i.length&&(Ci(),this.removeSelectedObjs(),this.createNewShape(i))}removeSelectedObjs(){let e=[...this.selectedObjs],r=el.findDimensionByPrimitiveIds(new Set(e.map(i=>i.gId)));for(let i of r)Hi.history.jsonSnap.addOne(te.getById(i.gId).json),te.removeOne({id:i.gId});for(let i of e)Hi.history.jsonSnap.addOne(i),te.removeOne({id:i.gId})}createNewShape(e){let r=this.selectedObjs.at(0);r.cmdKey==="text"&&(r.fillColor=r.strokeColor,r.strokeColor="none");for(let i of e){if(!i)continue;let n=ni(),s=te.getInitialGroupData({gId:n,layer:r.layer,d:i,fillColor:r.fillColor,strokeColor:r.strokeColor,strokeWidth:r.strokeWidth});qA(s),pt.select([{id:s.gId}]),Hi.history.jsonSnap.addOne(s,{},"group")}}};async function NK(t){let e=new Zk;await e.run(t),e=null,Et("panel_updateAttrPanel")}var rO=new Error,RK=new class extends Zu{decide1(e){return e[0]&&e[1]}}(2),oIe=new class extends I2{onPolylineGroup(){throw rO}onSegment(){throw rO}},e8=class{constructor(e,r){this.rtree=e,this.level=r}},iO=class t extends rE{static isIntersect(e,r,i=Zf.DUMMY){let n=new t(i),s=n.createGroup1(e.items),a=n.createGroup2(r.items);if(s.rtree.itemList.length==0||a.rtree.itemList.length==0)return!1;let o=[];return zl.addAll(o,t.getInterY(e.items)),zl.addAll(o,t.getInterY(r.items)),n.isIntersect(s,a,o)}static getInterY(e){let r=[];for(let i of e){let n=i.bbox(),s=(n.minY+n.maxY)/2;r.push(s)}return r}constructor(e){super(new iE(!1),RK.rule,e,oIe)}createGroup1(e){return this.createGroup(e,0)}createGroup2(e){return this.createGroup(e,1)}createGroup(e,r){let i=RK.weight(r);for(let s of e)this.addPolyline(s,i);let n=this.buildRTree();return this.sides.length=0,new e8(n,r)}isIntersect(e,r,i){if(e.level!==r.level){let n=e.rtree.bbox().intersection1(r.rtree.bbox());if(n!==null){try{this.inters(e,r);let s=(n.minY+n.maxY)/2;this.sweep(e,r,s);for(let a of i)this.sweep(e,r,a)}catch(s){if(s===rO)return!0;throw s}return!1}else return!1}else throw new Error("inersection detection should not in same group")}inters(e,r){if(e.rtree.size()>r.rtree.size()){let i=e;e=r,r=i}for(let i of e.rtree.items()){i.trans=NaN;let n=i.bbox().extendOfSize(1e-5);for(let s of r.rtree.search(n))if(s.trans=NaN,ip(i.shape,s.shape)>0)throw rO}}fillValidSides(e,r,i){for(let n of r)isFinite(n.getX(i))&&e.push(n)}sweep(e,r,i){let n=Mr.extend2(e.rtree.bbox(),r.rtree.bbox()).extendOfSize(1e-5),s=new Array;this.fillValidSides(s,e.rtree.search(n),i),this.fillValidSides(s,r.rtree.search(n),i),jA(s,(o,l)=>o.getX(i)-l.getX(i),0,s.length);let a=new sE(this.rule,this,i);for(let o of s)a.onEp(o)}};function MK(t){let e=["substrate_transparent_acrylic","substrate_black_transparent_acrylic","substrate_glossy_transparent_pvc","substrate_frosted_transparent_pvc","substrate_glossy_transparent_pet","substrate_frosted_transparent_pet"],{material:r,craft:i}=t,n={acrylic:["Transparent","Black Translucent"],PVC:["Glossy Transparent","Frosted Translucent"],PET:["Glossy Transparent","Frosted Translucent"]},s="";if($t(n,r)){let a=n[r],o=a.indexOf(i);o>=0&&(s="substrate_"+a[o]+"_"+r,s=s.toLocaleLowerCase())}return e.includes(s)?s:e[0]}function aT(t){var r;return(r=/url\(#(.*)\)/.exec(t))==null?void 0:r[1]}function kK(t){let e=t.style.display;return e?e!=="none":ge(t,"display")!=="none"}function t8(t,e){let r=t.transform.baseVal[0];if(r){let i=r.matrix;return e.Matrix(i.a,i.b,i.c,i.d,i.e,i.f)}return e.unitMatrix}var r8=47,lIe=47,nO="three-m",i8=` 
<pattern id="${nO}" patternUnits="userSpaceOnUse" x="0" y="0" width="${r8}" height="${lIe}">
    <rect x="0" y="0" width="${r8}" height="${r8}" fill="white" />

    <path d="m16.4 9.9 l 0.3-2.3s3.53-0.379 5.05 2.09c1.37 2.25 0.98 4.36-0.2 5.33-2.01 1.64-3.85 0.68-3.85 0.68s1.13 2.05-0.23 3.97c-1.16 1.65-3.43 2.82-6.27 0.74-3.13-2.3-2.5-5.41-2.5-5.41l2.2-0.4s0.1 2.4 1.1 3.4 2.66 1.56 3.72-0.34c0.69-1.24-1.52-3.76-1.52-3.76l1.5-1.5s1.31 1.75 2.3 1.6c2.41-0.37 2.09-2.28 1.09-3.28-1-1-2.69-0.82-2.69-0.82z M16 25 l 10.3-10.3 2.1 2.2-4.3 9 8.8-4.5 2.1 2.2-10.1 10.4-1.8-1.8 7.8-7.6-9 4.5-1.1-1.1 4.4-9.2-7.5 8z" fill="#a54949"/>
</pattern>
`;function cIe(t){let r={[nO]:i8}[t];return r||Zn("Not exists exact pattern: ",t),r}function FK(t,e,r,i,n,s){return`<svg xmlns="http://www.w3.org/2000/svg" width="${r}" height="${i}" viewBox="${t} ${e} ${r} ${i}">
        <defs>
            ${cIe(s)}
        </defs>

        ${n}
        </svg>
    `}var hIe=4,YK=0,VK=0;async function jK(t,e){let{width:r,height:i,coverColor:n,material:s,craft:a,print:o,thickness:l}=e,c=[],u=['["DOCTYPE", "BLOB", "1.0"]'],d=[],A={},h=10,f=3.937;YK=0,VK=0,C(["DOCTYPE","PREVIEW","1.0"]),C(["HEAD",{scale:h}]);let p=o=="Bottom Side"?2:1;C(["PRINT_METHOD",p]);let m=3;C(["LAYER",7,"BUN_LAYER","Bun Layer",m,"",.5,"",.3]),C(["LAYER",1,"PRINT_LAYER","Print Layer",m,"",.5,"",.3]),C(["LAYER",2,"WHITE_COVER_LAYER","White Cover Layer",m,"",.5,"",.3]),C(["LAYER",3,"BLACK_COVER_LAYER","Black Cover Layer",m,"",.5,"",.3]),C(["LAYER",4,"BOARD_LAYER","Board Outline Layer",m,"",.5,"",.3]),C(["LAYER",5,"GLUE_LAYER","Glue Cutout Layer",1,"",.5,"",.3]),C(["LAYER",6,"LIGHT_LAYER","Lighting Simulation Layer",m,"",.5,"",.3]);let y=MK({material:s,craft:a}),g=(parseFloat(l)||1)*f;C(["LAYER_PHYS",4,y,g,0,0]),C(["SILK_OPTS",7,"#000000","#ffffff"]),C(["SILK_OPTS",1,"#000000","#ffffff"]),C(["SILK_OPTS",2,"#000000","#ffffff"]),C(["SILK_OPTS",3,"#000000","#ffffff"]),C(["SILK_OPTS",5,"#000000","#ffffff"]),C(["SILK_OPTS",6,"#000000","#ffffff"]),C(["ITEM_ORDER",[]]);let b=c.length-1;await x(7),await x(1),await x(2),await x(3),await x(4),await x(8),await x(6),c[b]=UK(["ITEM_ORDER",d]);let E=c.join(`
`);return{blobStr:u.join(`
`),dataStr:E};async function x(U){let _=t[U];for(let H=_.length-1;H>=0;H--){let Q=_[H];await I(Q,U)}}async function I(U,_){let{polylineGroup:H,fillColor:Q,strokeColor:j,strokeWidth:$,strokeStyle:B,opacity:M,content:v,data:N}=U,R=AIe(H);if(!(M<=0)){if(Q.startsWith("url(#")){let q=aT(Q),P=H.bbox(),z=[P.LL(),P.UL(),P.UR(),P.LR()].map(He=>[He.x,He.y]).flat(1),W=ql(H.multiply3(Ue.MIRROR_Y.setOrigin1(P.center())).items,!1,.01,{reverseY:!1}),oe=`<path d="M ${z} Z"
			 fill="url(#${q})" stroke-width="1" stroke="none" opacity="1"></path>`,Ae=FK(P.minX,P.minY,P.width(),P.height(),oe,q),me="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(Ae))),ve=G(me),Le=sO();C(["TEXTURE",Le,0,ve,5,z,0,R,M]),d.push(Le);return}if(v&&N){let q=G(v),P=nr.createMatrixFrom6(N.matrix),z=0,W=1,oe=0,Ae=1,me=[[z,Ae],[z,oe],[W,oe],[W,Ae]],ve=[];for(let rt of me){let qe=new ne(rt[0],rt[1]).multiply3(P);ve.push(qe.x,-qe.y)}let Le=R,He=sO();C(["TEXTURE",He,0,q,_,ve,0,Le,M]),d.push(He)}else{let q=_==4;if(q&&(Q="#ffffff",j="none"),Q&&Q!="none"){let P=sO();C(["FILL",P,0,"",_,0,0,R,0]),q||C(["PROP",P,Q,M]),d.push(P)}if(j&&j!="none"&&$>0)for(let P of R){let z=sO();C(["POLY",z,0,"",_,$,P,0]),C(["PROP",z,j,M]),d.push(z)}}}}function C(U){c.push(UK(U))}function G(U){if(A[U])return"blob:"+A[U];let _=dIe();return u.push(JSON.stringify(["BLOB",_,"",U])),A[U]=_,"blob:"+_}}function sO(){return"e"+ ++YK}function dIe(){return"b"+ ++VK}function UK(t){return t=t.map(e=>typeof e=="boolean"?e?1:0:e),JSON.stringify(t)}function AIe(t){return t.items.map(fIe)}function fIe(t){return mIe(t).map(pIe)}function pIe(t){return typeof t=="number"&&t&&(t|0)!==t?+t.toFixed(hIe):t}function mIe(t){let e=0;return t.primitives.reduce((r,i)=>(i instanceof Ee||i instanceof ze&&i.rx===i.ry?r.push(i):i.points(.1).reduce((n,s)=>(s.equals1(n)||r.push(new Ee(n,s)),s)),r),[]).reduce((r,i)=>{if(i instanceof Ee){switch(e){case 0:r.push(i.start().x,i.start().y,"L",i.end().x,i.end().y);break;case 1:r.push(i.end().x,i.end().y);break;default:r.push("L",i.end().x,i.end().y)}e=1}else if(i instanceof ze){if(t.primitives.length>1||Math.abs(i.sweepAngle)<360)switch(e){case 0:r.push(i.start().x,i.start().y,"ARC",i.sweepAngle,i.end().x,i.end().y);break;case 2:r.push(i.sweepAngle,i.end().x,i.end().y);break;default:r.push("ARC",i.sweepAngle,i.end().x,i.end().y)}else r.push("CIRCLE",i.center.x,i.center.y,i.rx);e=2}return r},[])}function gIe(t,e){let r=t-1;for(let i=0;i<r;i++)e.markRemove(i);r=e.size-1;for(let i=t-1;i<r;i+=t)e.markRemove(i);r=e.size-t;for(let i=e.size-1;i>r;i--)e.markRemove(i);r=0;for(let i=e.size-t;i>r;i-=t)e.markRemove(i)}function yIe(t,e,r){let i=e[0]%t,n=e[0]/t|0,s=i,a=n,o=[new ne(s,a)],l=0,c=0,u=new Set;for(let d=1;d<e.length;d++){let A=e[d]%t,h=e[d]/t|0;if(A===i&&h===n)continue;A>s?u.add("R"):A<s&&u.add("L"),h>a?u.add("U"):h<a&&u.add("D");let f=A-i,p=h-n,m=u.size===4;if(!m){let y=Math.sqrt(f**2+p**2),g=f/y,b=p/y;m=Math.abs(g*c-b*l)>r}if(m){if(u.clear(),o.length>1){let y=o[o.length-1],g=o[o.length-2];(y.x-s)*(g.y-a)+(y.y-a)*(g.x-s)===0&&o.pop()}o.push(new ne(s,a)),i=s,n=a,l=c=0,f=A-i,p=h-n}l+=f,c+=p,s=A,a=h}if(o.length>1){let d=o[o.length-1],A=o[o.length-2];(d.x-s)*(A.y-a)+(d.y-a)*(A.x-s)===0&&o.pop()}if(o.length>2){let d=new ne(s,a);return o[o.length-1].sub(d).cross(o[1].sub(d))===0?o[0]=o[o.length-1]:o.push(d),o}return[]}function zK(t,e){gIe(t,e);let r=xIe(e,t),i=new Array;r.forEach(s=>{let a=new Array;s.forEach(o=>{let l=yIe(t,o,2);l.length!==0&&a.push(l)}),i.push(a)});let n=[];for(let s of i){let a=[];n.push(a);for(let o of s)a.push(bIe(o,2))}return n}function bIe(t,e){if(t.length<2)throw new Error("The length of outline can't be less than 2!");if(!t[0].equals1(t[t.length-1]))throw new Error("The outline isn't closed!");let r=[],i=t[0];for(let s=1;s<t.length;s++){let a=t[s];r.push(a.add(i).scale(.5)),i=a}i=r[r.length-1];let n=[];for(let s=0;s<r.length;s++){let a=r[s],o=t[s],l=a.sub(i);if(Math.abs(l.cross(o.sub(i)))/l.length()>e){if(n[n.length-1]instanceof Ee){let u=n.pop();n.push(new Ee(u.start(),o))}else n.push(new Ee(i,o));n.push(new Ee(o,a))}else n.push(new Nt([i,o,a]));i=a}return Fr.build2(n)}function QK(t,e,r,i,n,s,a){let o=n===1?f=>{i[f]===0&&(i[f]=n)}:f=>i[f]=n,l=[e],c=e;i[t]=n,o(c);let u=!0,d=t;for(let f=0;f<7;f++)if(d=s(d,c),r.isUsed(d)){u=!1;break}if(u){d=t;for(let f=0;f<7;f++)d=s(d,c),i[d]=n;return l}let A=t,h=s(t,c);for(;h!==e;)r.isUsed(h)?(a(c,h,l),c=h,o(c),l.push(c)):(i[h]=n,A=h),h=s(A,c);return l.push(e),l}function xIe(t,e){let r=new Uint16Array(t.size),i=new Map;i.set(-e,-e+1),i.set(-e+1,1),i.set(1,e+1),i.set(e+1,e),i.set(e,e-1),i.set(e-1,-1),i.set(-1,-e-1),i.set(-e-1,-e);let n=(l,c)=>{let u=c+i.get(l-c);if(isFinite(u))return u;throw new Error("is not finit")},s=(l,c,u)=>{let d=l%e,A=c%e;if(d===A)return;let h=l/e|0,f=c/e|0;h!==f&&(t.isUsed(h*e+A)?u.push(h*e+A):t.isUsed(f*e+d)&&u.push(f*e+d))},a=[],o=t.size/e-1;for(let l=1;l<o;l++){let c=!0,u=new Array,d=(l+1)*e;for(let A=l*e;A<d;A++){if(A%32===0){let f=t.getChunk(A/32);if(c){if(f===0){A+=31;continue}}else if(f===2**32-1){A+=31;continue}}let h=t.isUsed(A);c?h&&(c=!1,r[A]===0&&a.push([QK(A-1,A,t,r,a.length+2,n,s)]),r[A]!==1&&u.push(r[A])):h||(c=!0,r[A]===0&&a[u[u.length-1]-2].push(QK(A,A-1,t,r,1,n,s)),r[A-1]===u[u.length-1]&&r[A]!==1&&u.pop())}}return a}function EIe(t){let e=t.toString(2),r=32-e.length;return r>0?"0".repeat(r)+e:e}var aO=class{constructor(e,r=null,i=!0){this.marked=0;if(this.size=e,r)this.index=r;else{if(this.index=new Uint32Array(Math.ceil(e/32)),!i)return;for(let n=0;n<e;n++)this.isUsed(n)&&this.marked++}}isEmpty(){return this.marked===0}getMarked(){return this.marked}getChunk(e){return this.index[e]}isUsed(e){let r=e/32|0,i=this.index[r];return i===4294967295?!0:i===0?!1:(i>>31-e&1)===1}markUsed(e){let r=e/32|0,i=this.index[r],n=1<<31-e;(i&n)===0&&(this.index[r]=i|n,this.marked++)}markRemove(e){let r=e/32|0,i=this.index[r],n=1<<31-e;(i&n)!==0&&(this.index[r]=i&(4294967295^n),this.marked--)}reset(){let e=this.index;for(let r=0;r<e.length;r++)e[r]=0;this.marked=0}findEmpty(e=1){if(this.size-this.marked<e)return-1;let r=this.index,i=-1;for(let n=0;n<r.length;n++){let s=r[n];if(s===0){if(i===-1){if(i=n*32,e<=32)return i}else if((n+1)*32-i>=e)return i}else if(s!==4294967295)for(let a=31;a>=0;a--)if((s>>a&1)===0){let o=n*32+31-a;if(i===-1&&(i=o),o-i+1>=e)return i}else i=-1;else i=-1}return-1}hasNEmpty(e=1){return!(this.size-this.marked<e)}findNEmpty(e=1){let r=[];if(this.size-this.marked<e)return r;let i=this.index;for(let n=0;n<i.length;n++){let s=i[n];if(s===0){let a=n*32;if(r.indexOf(a)==-1){if(r.push(a),r.length>=e)return r;{let o=e-r.length;if(o<32){for(let l=0;l<o;l++)r.push(a+l+1);return r}else for(let l=0;l<31;l++)r.push(a+l+1)}}}else if(s!==4294967295){for(let a=31;a>=0;a--)if((s>>a&1)===0){let o=n*32+31-a;if(r.indexOf(o)==-1&&(r.push(o),r.length==e))return r}}}return[]}debug(){let e=[],r=this.index;for(let i=0;i<r.length;i++)e.push(EIe(r[i]));console.log(e.join(" "))}};function wIe(t,e,r,i){switch(e){case"ImageBitmap":case"OffscreenCanvas":case"FileBlob":return t;case"PixelDataBuffer":return new ImageData(new Uint8ClampedArray(t),r,i);case"FileBuffer":return new Blob([t]);case"DataURL":return vIe(t);default:return null}}function vIe(t){var e=t.split(","),r=e[0].match(/:(.*?);/)[1],i=SIe(e[1]);return new Blob([i],{type:r})}function CIe(t){return t>64&&t<91?t-65:t>96&&t<123?t-71:t>47&&t<58?t+4:t===43?62:t===47?63:0}function SIe(t,e=1){for(var r=t.replace(/[^A-Za-z0-9\+\/]/g,""),i=r.length,n=i&3,s=(i>>>2)*3+(n==2?1:n==3?2:0),a=new Uint8Array(s),o,l,c=0,u=0,d=0;d<i;d++)if(l=d&3,c|=CIe(r.charCodeAt(d))<<18-6*l,l===3||i-d===1){for(o=0;o<3&&u<s;o++,u++)a[u]=c>>>(16>>>o&24)&255;c=0}return a}async function XK(t){let{source:e,type:r,width:i=100,height:n=100,alphaLimit:s=15}=t,a=wIe(e,r,i,n);if(!a)throw new Error("Image source is required");let o=1e3,l=1e3,c=100,u=100,d=1;(i>o||n>l)&&(d=Math.min(o/i,l/n)),(i<c||n<u)&&(d=d*Math.max(c/i,u/n)),i=Math.round(i*d),n=Math.round(n*d);let A,f=new OffscreenCanvas(i+3,n+3).getContext("2d");try{let g=await createImageBitmap(a,{resizeWidth:i,resizeHeight:n});f.drawImage(g,1,1,i+1,n+1),A=f.getImageData(0,0,i+3,n+3),g.close()}catch(g){throw console.error(g),new Error("Load image failed")}i+=3,n+=3;let p=new aO(i*n);for(let g=0;g<n;g++)for(let b=0;b<i;b++)A.data[((n-g-1)*i+b)*4+3]>s&&p.markUsed(g*i+b);let m=zK(i,p);return m=m.map(g=>g.map(b=>b.multiply3(Ue.translate(-1,-1)))),d!==1&&(m=m.map(g=>g.map(b=>b.multiply3(Ue.scale(1/d))))),new Ws(m.flat())}var oT=class oT extends Worker{constructor(e,r){e.startsWith("//")&&(e=self.location.protocol+e);let i=e;if(/^[\w-]+:/.test(e)&&self.location.origin!=new URL(e).origin&&(i=oT.proxyMap[e],!i)){let n=`importScripts('${e}');`;i=URL.createObjectURL(new Blob([n],{type:"application/javascript"})),oT.proxyMap[e]=i}super(i,r)}};oT.proxyMap={};var oO=oT;var lO=class{constructor(){this._workers=[];this._workerTaskId=[];this._tasks={};this._queueIds=[];this._runningIds=[];this._completedIds=[];this._promises=[];this._started=!1}init({url:e,workersCount:r=16,name:i="worker-pool"}){this._workers.length&&this.destroy();let n=(s,a,o)=>{if(!this._workers.length)return;let l=this._workerTaskId[s],c=this._tasks[l],u=this._runningIds.indexOf(l);u>=0&&this._runningIds.splice(u,1),c&&(c.endAt=new Date),this._completedIds.push(l),this._queueIds.length&&this.runNext(s),o?c.reject(o):c.resolve(a)};for(let s=0;s<r;s++){let a=this.createWorker(e,s,n,i);this._workers.push(a)}}addTask(e){let r=("_"+Math.random()).replace(/\W+/g,""),i={id:r,data:e,state:{started:!1,completed:!1,startAt:null,endAt:null},resolve:null,reject:null};this._tasks[r]=i,this._queueIds.push(r);let n=new Promise((s,a)=>{Object.assign(i,{resolve:s,reject:a})});return this._promises.push(n),n}all(){return Promise.all(this._promises)}get isStarted(){return this._started}start(){if(!this._started){this._started=!0;for(let e=0,r=Math.min(this._queueIds.length,this._workers.length);e<r;e++)this.runNext(e)}}createWorker(e,r,i,n){let s=new oO(e,{name:n}),a=!0;return s.onmessage=o=>{a=!0,i(r,o.data,null)},s.onerror=o=>{a=!0,i(r,null,o.message||"worker onerror")},s.onmessageerror=o=>{console.error("worker onmessageerror")},{index:r,isIdle:()=>a,postMessage:(...o)=>{a=!1,s.postMessage.apply(s,o)},terminate:()=>s.terminate()}}runNext(e){let r=this._queueIds.shift();if(r===void 0)return;let i=this._tasks[r],{state:n,data:s}=i,{started:a,completed:o}=n;a||o||this._workers[e].isIdle()&&(this._workers[e].postMessage(s),this._workerTaskId[e]=r,this._runningIds.push(r),Object.assign(n,{started:!0,startAt:new Date}))}destroy(){this._workers.forEach(e=>e.terminate()),this._workers.length=0,this._workerTaskId.length=0,this._tasks={},this._queueIds.length=0,this._runningIds.length=0,this._completedIds.length=0,this._promises.length=0,this._started=!1}};function cO(){return"_r"+(Math.random()*1e6|0)}function TIe(t){let e=t.indexOf("{"),r=t.lastIndexOf("}"),i=t.substring(0,e).trim(),s=t.substring(e+1,r).match(/\b[\w\-]+:[^;]+/g)||[],a={selector:i,properties:{}};for(let o of s){let[l,c]=o.split(":");l=l.trim(),c=c.trim(),a.properties[l]=c}return a}function IIe(t){let e={},r=[],i=[],n=[];t=t.replace(/(\s(?:class="))([^"]+)(?=")/g,(a,o,l)=>{l=l.trim().split(/\s+/);let c=[];for(let u of l){let d;r.includes(u)?d=e[u]:(d=cO(),e[u]=d,r.push(u),i.push(d)),c.push(d)}return o+c.join(" ")}),t=t.replace(/<style(?:\s|>).+?<\/style>/gs,a=>{let o=a.replace(/<style\b.*?>|<\/style>/gs,""),l=Array.from(o.match(/\.[\w$-]+\s*\{.*?\}/gs)||[]);for(let u of l){let d=TIe(u),{selector:A,properties:h}=d,f=A.replace(".","");r.includes(f)&&(A="."+e[f],n.push({selector:A,properties:h}))}return`<style>
${o.replace(/(\.)([\w$-]+)(?=[^{}]*\{)/gs,(u,d,A)=>r.includes(A)?d+e[A]:u).trim()}
</style>`});let s=["fill","stroke","stroke-width","opacity","fill-opacity","stroke-opacity","visibility"];for(let a of n){let{selector:o,properties:l}=a,c=o.replace(".","");if(!i.includes(c))continue;let u=new RegExp(`<[\\w-]+\\s+([^\\s>]+\\s+)*?(?:class="${c}").*?>`,"gs");t=t.replace(u,d=>{for(let A of s){let h=l[A];if(!h)break;if(!d.includes(` ${A}="`))d=d.replace(/\/?>/,` ${A}="${h}"$&`);else{let f=new RegExp(` ${A}=".*?"`);d=d.replace(f,` ${A}="${h}"`)}}return d})}return t}function BIe(t){let e={},r=[];return t=t.replace(/(\s(?:id="))([^"]+)/g,(i,n,s)=>(r.includes(s)||(r.push(s),e[s]=cO()),n+e[s])),t=t.replace(/\b(url\("?#)([^")?#]+)/g,(i,n,s)=>r.includes(s)?n+e[s]:i),t=t.replace(/\b((?:xlink:)?href="#)([^"]+)/g,(i,n,s)=>r.includes(s)?n+e[s]:i),t=t.replace(/<style(?:\s|>).+?<\/style>/gs,i=>t.includes("#")?i.replace(/(#)([\w$-]+)(?=[^{}]*\{)/g,(s,a,o)=>r.includes(o)?a+e[o]:s):i),t}function n8(t){t=BIe(t),t=IIe(t),t=t.replace(/\s(href=")/g," xlink:$1");let e=/<image [^>]*?(?:xlink:)?href="data:image\/svg\+xml;base64,([^"]+)"(?:[^>]*\/>|<\/image>)/g;return e.test(t)&&(t=t.replace(e,(r,i)=>{let n=Array.from(r.match(/\s([\w:]+)="([^"]+)/g)||[]),s={};for(let b of n){let[E,w]=b.trim().split('="');s[E]=w}let{x:a,y:o,width:l,height:c,transform:u,opacity:d,visibility:A,preserveAspectRatio:h}=s;a=a||0,o=o||0,l=l||1,c=c||1,u=u||"",A=A||"",h=h||"";let f=decodeURIComponent(escape(atob(i)));(f.includes("<script")||f.includes("<foreignObject"))&&(f=f.replace(/<(script|foreignObject)(?=>|\s).*?(\/>|<\/\1>)/gs,"")),f=f.substring(f.indexOf("<svg"));let p=f.indexOf(">"),m=f.substring(0,p+1),y=f.substring(p+1);return m=m.replace(/\s(x|y|width|height|transform|xmlns|xmlns:xlink|xml:space|version|style|id)=".*?"/g,""),m=m.replace(/<svg\s/,`<svg x="${a}" y="${o}" width="${l}" height="${c}" preserveAspectRatio="none" `),m.match(/\s+viewBox=".*?"/)||(m=m.replace(/<svg\s/,`<svg viewBox="0 0 ${l} ${c}" `)),f=m+y,f=n8(f),`<g transform="${u||""}" opacity="${d||1}">
${f}
</g>`})),t}var lT=4,s8=class t{constructor(){this.borderSpace=2.5;this.FILTER_LAYER_KEYS=["ellipse","group","rect","text","obj","arc"];this._head=null;this._docBBox=null;this._autoSizeEnabled=!1;this._outlineEnabled=!0;this._markerEnabled=!1;this._layerJsonArr={};this._layerSvgJsonArr={};this._transparency={};this._boardGroup={};this._jsonCacheList=null}setImageLoader(e){this._imageLoader=e}async getImageOutline(e){let{content:r,data:i,polylineGroup:n}=e,s=/^data:image\/(?:png|gif|jpeg)/.test(r);if(!s&&!this._imageLoader)return n;let{matrix:a}=i,{width:o,height:l}=nr.getRectBBox(a);try{let c,u=1;/^data:image\/svg\+xml/.test(r)&&((o>1e3||l>1e3)&&(u=Math.min(1e3/o,1e3/l)),(o<100||l<100)&&(u=u*Math.max(100/o,100/l)),o*=u,l*=u),s?c={source:r,type:"DataURL",width:o,height:l}:(c=await this._imageLoader.load(r,Math.round(o),Math.round(l)),c.width=o,c.height=l),c.alphaLimit=15;let A=await XK(c);if(A){let h=nr.createMatrixFrom6(a),f=Ue.translate(0,l).scale(1/o,1/l).multiply3(h);return A=A.multiply3(Ue.MIRROR_Y).multiply3(f).multiply3(Ue.MIRROR_Y),A}else return console.error("getImageOutline failed"),n}catch(c){return console.error("getImageOutline failed",{dataURL:r,error:c}),n}}makeProgressPercent(e,r,i){return n=>e(r+(i-r)*n)}makeProgressForward(e,r,i,n){if(typeof e!="function")return()=>{};let s=(i-r)/n,a=r;return()=>e(a+=s)}svgSpecifications(){let{width:e,height:r}=this._head,i=parseFloat(e),n=parseFloat(r);return{outlineWidth:i,outlineHeight:n,inlineWidth:i-this.borderSpace*2,inlineHeight:n-this.borderSpace*2,realWidth:i+this.borderSpace*2,realHeight:n+this.borderSpace*2,borderSpace:this.borderSpace}}getOutlineInnerSVG(e){if(!this._outlineEnabled)return"";let{width:r,height:i}=this.getOutlineSize(!0),{width:n,height:s}=this.getInlineSize(!0),a=`<rect id="outline-1" width="${r}" height="${i}" x="0" y="${-i}" fill="none" stroke="#000000" stroke-width="1"/>`,o=(r-n)/2,l=(i-s)/2,c=`<rect id="outline-2" width="${n}" height="${s}" x="${o}" y="${-l-s}" fill="none" stroke="#000000" stroke-width="1"/>`,u=`${a}
${c}`;return e&&(u=`<g id="${e}">
${u}
</g>`),u}getOutlineSize(e=!1){let{outlineWidth:r,outlineHeight:i}=this.svgSpecifications(),n=ti(r,"mm","pixel"),s=ti(i,"mm","pixel");return e===!0&&(n=Math.round(n),s=Math.round(s)),{width:n,height:s}}getInlineSize(e=!1){let{inlineWidth:r,inlineHeight:i}=this.svgSpecifications(),n=ti(r,"mm","pixel"),s=ti(i,"mm","pixel");return e===!0&&(n=Math.round(n),s=Math.round(s)),{width:n,height:s}}async json2InnerSVG(e,r="",i="",n=!1,s=""){let{outlineHeight:a,outlineWidth:o,realWidth:l,realHeight:c}=this.svgSpecifications(),u=ti((o-l)/2,"mm","pixel"),d=ti(-a-(c-a)/2,"mm","pixel"),A="";for(let h of e){let{polylineGroup:f,fillColor:p,strokeColor:m,strokeWidth:y,opacity:g,content:b,data:E}=h,w=ql(f.items,!1);if(w=J2(w,lT),b&&E){let x=`matrix(${E.matrix})`,I=b.startsWith("data:image/svg+xml;base64,"),C;if(I){let Q=b.slice(b.indexOf(",")+1),j=decodeURIComponent(escape(atob(Q)));if(j.includes("<script")||j.includes("<foreignObject"))continue;j=j.slice(j.indexOf("<svg"));let $=j.indexOf(">"),B=j.slice(0,$+1),M=j.slice($+1),v=(q,P)=>{var oe;let z=new RegExp(`\\s+${P}="([^"]*)"`);return((oe=q.match(z))==null?void 0:oe[1])||""},N=q=>{var W;q=q.toLowerCase(),q=q.replace(/px/,"").trim();let P=(W=q.match(/[a-z]+$/i))==null?void 0:W[0],z=parseFloat(q);return z&&ZQ(P)&&(z=ti(z,P,"pixel")),z||0},R=v(B,"viewBox");if(!R){let q=v(B,"width"),P=v(B,"height");if(q&&P){let z=N(q),W=N(P);R=`0 0 ${z} ${W}`}else R=`0 0 ${E.width} ${E.height}`}B=B.replace(/\s(x|y|width|height|transform|xmlns|xmlns:xlink|xml:space|version|style|id|preserveAspectRatio|opacity|viewBox)=".*?"/g,""),B=B.replace(/<svg(\s|>)/,`<svg x="0" y="0" width="1" height="1" preserveAspectRatio="none" opacity="${g}" viewBox="${R}"$1`),j=B+M,j=n8(j),C=`<g data-origin-id="${E.gId}" transform="${x}">
${j}
</g>`}else C=`<image x="0" y="0" width="1" height="1" opacity="${g}" transform="${x}" preserveAspectRatio="none" xlink:href="${b}"/>`;let G=`<path d="${w}" fill="#ffffff" stroke="none"/>`,U=cO(),_=`<defs><mask id="${U}" maskUnits="userSpaceOnUse" x="${u}" y="${d}">${G}</mask></defs>`,H=`mask="url(#${U})"`;A+=`
${_}
<g ${H}>
${C}
</g>
`}else{p===void 0&&(p="none"),y===void 0&&(y=0),m===void 0&&(m="none"),g===void 0&&(g=1);let x=`<path d="${w}" fill="${p}" stroke-width="${y}" stroke="${m}" opacity="${g}" ${s}/>`;A+=n?`
<g>${x}</g>`:`
${x}`}}return i&&(A+=`
`+i),r?`<g id="${r}">
${A}
</g>`:A}async json2PrintInnerSVG(e,r,i=!1){let n=[],s=[];if(i){let d=`<pattern id="gridPattern" patternUnits="userSpaceOnUse" x="0" y="0" width="20" height="20">
<rect width="10" height="10" x="0" y="0" stroke-width="0" stroke="none" fill="#ddd"></rect>
<rect width="10" height="10" x="10" y="10" stroke-width="0" stroke="none" fill="#ddd"></rect>
</pattern>`,{width:A,height:h}=this.getOutlineSize(!0),f=`<rect width="${A}" height="${h}" x="0" y="${-h}" stroke="none" fill="url(#gridPattern)"/>`;n.unshift(d),s.unshift(f)}let a=this._markerEnabled?this.getMarkSvg(2):"",o=n.length?`<defs>
${n.join(`
`)}
</defs>`:"",l=s.join(`
`),c=await this.json2InnerSVG(e,""),u=`
${o}
${l}
${c}
${a}
`;return r?`<g id="${r}">
${u}
</g>`:u}inner2OuterSVG(e){let{realWidth:r,realHeight:i,borderSpace:n}=this.svgSpecifications(),s=ti(r,"mm","pixel"),a=ti(i,"mm","pixel"),o=ti(-n,"mm","pixel"),l=ti(-i+n,"mm","pixel"),c=J2(`M${o} ${l} ${s} ${a}`,lT).slice(1);if(e=`<defs><style>#\u9F13\u5305\u5C42 > path {vector-effect: non-scaling-stroke;}</style>
			${i8}
		</defs>`+e,this._autoSizeEnabled){let{width:A,height:h}=this.getOutlineSize(),{x:f,y:p,width:m,height:y}=this._docBBox,g=50,b=Math.max(m+g*2,A),E=Math.max(y+g*2,h),w=f+m/2-b/2,x=p+y/2-E/2;r=ti(b,"pixel","mm"),i=ti(E,"pixel","mm"),c=J2(`M${w} ${x} ${b} ${E}`,lT).slice(1)}return`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="stroke-linecap:round;stroke-linejoin:round;" width="${r}mm" height="${i}mm" viewBox="${c}">${e}</svg>`}getMarkSvg(e){if(!this._markerEnabled)return"";let r=LIe(e,this._head);return r=J2(r,lT),`<path layer="99" fill="#000000" stroke="none" d="${r}"/>`}getDefaultBoardLayerSvgJson(){let{width:e,height:r}=this.getOutlineSize(),i=`M 0 0 L ${e} 0 L ${e} ${-r} L 0 ${-r} Z`;if(this._autoSizeEnabled){let{x:s,y:a,width:o,height:l}=this._docBBox,c=50,u=Math.max(o+c*2,e),d=Math.max(l+c*2,r),A=s+o/2-u/2,h=a+l/2-d/2,f=A+u,p=h+d;i=`M ${A} ${h} L ${f} ${h} L ${f} ${p} L ${A} ${p} Z`}return i=J2(i,lT),[{polylineGroup:new Ws(Jn(i)),layer:3,opacity:1,hide:!1,cover:!1,scope:void 0,strokeColor:"#000000",strokeWidth:1,strokeStyle:0,fillColor:"none"}]}getOpacityMergeValue(e,r,i){return i==2?1-(1-e)*(1-r):e*r}mergeOpacitySvgJson(e,r){if(e.length<2)return e;let i=[],n=[];for(let c of e){let{opacity:u}=c,d=i.indexOf(u);d<0?(i.push(u),n.push([c])):n[d].push(c)}let s=n.map(c=>this.mergeSvgJson(c)).flat(),a=[],o=c=>c.length>0&&Ws.combinePolylineGroupArr(c);for(let c of s){let u=c.polylineGroup,d=c.opacity,A=u.items,h=[],f=!1;for(let p of a){if(!A.length)break;if(!p.polylineGroup.items.length)continue;let m=p.polylineGroup,y=p.opacity;if(!iO.isIntersect(m,u))continue;let g=m.items,b=In.boolIntersection([g,A]);if(!b.length)continue;f=!0;let E=this.getOpacityMergeValue(d,y,r);if(E==d&&E==y){let w=In.boolAggregate([g,A]),x=o(w);m.items.length=0,x?A=x.items:A.length=0;continue}else if(E==d){let w=In.boolSubtraction(g,A),x=o(w);x?p.polylineGroup=x:m.items.length=0;continue}else if(E==y){let w=In.boolSubtraction(A,g),x=o(w);x?A=x.items:A.length=0;continue}else{let w=In.boolSubtraction(g,A),x=In.boolSubtraction(A,g),I=o(w),C=o(x),G=o(b),U={...p,polylineGroup:G,opacity:E};I?(p.polylineGroup=I,a.push(U)):(p.polylineGroup=G,p.opacity=E),C?A=C.items:A.length=0;continue}}h.length&&a.push(...h),A.length&&(f&&(c.polylineGroup=new Ws(A)),a.push(c))}return a.filter(c=>c.polylineGroup.items.length>0)}mergeSvgJson(e,r=!0){if(!e.length)return[];let i=e.map(s=>s.polylineGroup),n=this.unionPolylineGroup(i);if(n.length){let s=o=>({...e[0],content:"",data:null,polylineGroup:o});return(r?[Ws.combinePolylineGroupArr(n)]:n).map(s)}else return[]}unionPolylineGroup(e){if(!e.length)return[];let r=[],i=e.slice(),n=!0;for(;i.length;){let o=i.shift(),l=o.bbox();for(let c=0;c<r.length;c++)if(!r[c].bbox().isSeparated(l)){n=!1;break}if(n)r.push(o);else break}if(n)return r;let s=e.map(o=>o.items);return In.boolAggregate(s)}subSvgJson(e,r,i=!1){let n=[],s=r.map(a=>a.polylineGroup.items);for(let a=0;a<e.length;a++){let o=e[a],l=In.boolSubtraction1([o.polylineGroup.items].concat(s));if(l.length){let u=(i?[Ws.combinePolylineGroupArr(l)]:l).map(d=>({...o,polylineGroup:d}));n.push(...u)}}return n}intersectSvgJson(e,r,i){let n=[],s=o=>o.polylineGroup.items.reduce((l,c)=>l+c.primitives.length,0),a=o=>o.polylineGroup.items.length>1&&s(o)>50;for(let o=0;o<e.length;o++){let l=e[o],c=l.polylineGroup,u=c.items,d=c.bbox(),A=a(l);for(let h=0;h<r.length;h++){let f=r[h],p=f.polylineGroup,m=p.items,y=p.bbox(),g=a(f);if(d.isSeparated(y))continue;let b=i?this.getOpacityMergeValue(l.opacity,f.opacity,i):l.opacity;if(d.isInside(y)&&!g){let w=qK(d);if(!In.boolSubtraction([w],m).length){n.push({...l,opacity:b});continue}}if(y.isInside(d)&&!A){let w=qK(y);if(!In.boolSubtraction([w],u).length){n.push({...l,polylineGroup:p,opacity:b});continue}}let E=In.boolIntersection([u,m]);if(E.length){let w=Ws.combinePolylineGroupArr(E);n.push({...l,polylineGroup:w,opacity:b})}}}return n}extendSvgJson(e,r){var n,s;let i=[];for(let a of e){let{polylineGroup:o}=a,l=((s=(n=o==null?void 0:o.items)==null?void 0:n[0])==null?void 0:s.closed())||!1,c=Lg(o,r,{fill:l});c&&i.push({...a,polylineGroup:c})}return i}jsonObjToPolylineGroup(e,r){if(r=="text"){if(!e.d)return null;let s=In.convertJsonCache2PolyLines({d:e.d},"group"),a=Ue.MIRROR_Y.multiply3(nr.createMatrixFrom6(e.matrix).multiply3(Ue.MIRROR_Y));return s.multiply3(a).round(4)}return In.convertJsonCache2PolyLines(e,r)}getCloseSvgJson(e,r=.01){let i=[],n=[];if(e.forEach(o=>{let{polylineGroup:l}=o,c=l.items;if(c.length===1)EE(c[0],r)?i.push(c[0]):(c[0].closed()||(c[0]=c[0].asClose()),n.push(o));else if(c.length>1){let u=wE(c,r);u.updatedItems.concat(u.noChangeItems).map(A=>A.polylineNew||A.polyline).forEach(A=>{n.push({...e[0],polylineGroup:new Ws([A])})})}}),i.length<1)return n;if(i.length===1)return i[0]=i[0].asClose(),n.push({...e[0],polylineGroup:new Ws(i)}),n;let s=wE(i,r);s.noChangeItems.forEach(o=>o.polyline=o.polyline.asClose());let a=s.updatedItems.concat(s.noChangeItems).map(o=>({...e[0],polylineGroup:new Ws([o.polylineNew||o.polyline])}));return n=n.concat(a),n}init(e,r=!0){let i=e.head.docType==si.PANEL_LIB;this._head=null,this._autoSizeEnabled=i,this._outlineEnabled=!i,this._markerEnabled=!1,this._layerJsonArr={},this._layerSvgJsonArr={},this._transparency={},this._boardGroup={},this._jsonCacheList=null;let n=vi(e);e=null,this._head=n.head,this._docBBox=n.BBox,r&&this.sortOriginJson(n)}sortOriginJson(e){let r={},i={},n=(o,l,c)=>{o[c]?o[c].push(l):o[c]=[l]},s=e.itemOrder,a={};for(let o=0;o<s.length;o++)a[s[o]]=o;for(let o of this.FILTER_LAYER_KEYS){let l=e[o];l&&Vl(l,(c,u)=>{let{layer:d,hide:A,transparencyWhite:h,transparencyPrint:f}=u;if(A)return;let p=a[c];n(r,p,d),n(i,u,d),d===2&&(this._transparency[c]=[h||0,f||0]),zu(p)&&Zn(u,"\u6CE8\u610F\uFF1A\u5B58\u5728\u65E0\u6392\u5E8F\u4FE1\u606F\u5F97\u56FE\u5143")})}Vl(r,(o,l)=>{let c=l.map((u,d)=>[d,u]);c.sort((u,d)=>{let A=u[1],h=d[1];return A==h?0:A>=0&&A<h?-1:1}),i[o]=c.map(([u])=>i[o][u])}),this._layerJsonArr=i}allToSvgJson(){let e=this._layerJsonArr;Object.keys(e).reduce((i,n)=>i+e[n].length,0)&&Vl(e,(i,n)=>{if(!this._layerSvgJsonArr[i]){let s=n.map(a=>this.toSvgJson(a,!1)).flat();this._layerSvgJsonArr[i]=s}})}toSvgJson(e,r=!1){let{layer:i,opacity:n,hide:s,cover:a,scope:o,strokeColor:l,strokeWidth:c,strokeStyle:u,fillColor:d,displayFill:A,displayStroke:h,content:f,cmdKey:p}=e,m=1,y=1,g=i==1,b=i==6,E=i==5,w=i==2,x=i==7,I=i==3||i==4,C=p=="obj"&&!!f&&f.startsWith("data:image/"),G=p=="text";if((g||b)&&n<.001)return[];if(p==="obj"&&!C)return[];c=c||0,A===!1&&(d="none"),h===!1&&(l="none"),G&&(d=d||l||"#000000",l="none"),d=d||"none",l=l||"none",E&&(d="none",l=CM[i],c=1,n=1),I&&(d="none",l="#000000",c=1,n=1),r&&g&&(d!="none"&&(d="#000000"),l!="none"&&(l="#000000")),w&&(d="#000000",l="none",c=0,m=1-e.transparencyPrint||0,y=1-e.transparencyWhite||0,n=r?y:m),i==7&&(d="none",l="#ff00ff",c=1,n=1),Object.assign(e,{fillColor:d,strokeColor:l,strokeWidth:c,opacity:n});let U={jsonKey:p,gId:e.gId,polylineGroup:this.jsonObjToPolylineGroup(e,p),layer:i,opacity:n,opacityCover:y,hide:s,cover:a,scope:o,strokeColor:l,strokeWidth:c,strokeStyle:u,fillColor:d,content:C?f:void 0,data:C?e:void 0};if((E||w||x)&&p==="group"){let{polylineGroup:_}=U;return PIe(_),In.boolSubtraction(_.items,[]).map(j=>({...U,polylineGroup:j}))}return g&&!C||b?this.buildSvgJsonFillStroke(U):[U]}getLayerSvgJson(e,r=!1){let i=this._layerSvgJsonArr[e]||[];if(i.length&&e==2)for(let n of i){let{gId:s}=n,[a,o]=this._transparency[s],l=1-o||0,c=1-a||0;Object.assign(n,{fillColor:"#000000",strokeColor:"none",strokeWidth:0,opacity:r?c:l,opacityCover:c})}return i}async buildBoardGroup({forPreview:e=!1,forcedSingleGroup:r=!1,progressCallback:i=n=>{}}={}){let n=[],s=[],a=[],o=[],l=[],c=[],u=[],d=[],A=.01;console.time("build"),n=this.getLayerSvgJson(3),n=this.getCloseSvgJson(n,A),n=this.mergeSvgJson(n,!1),a=this.getLayerSvgJson(4),a=this.getCloseSvgJson(a,A),a=this.mergeSvgJson(a,!1);let h=this.getDefaultBoardLayerSvgJson();n.length?n=this.intersectSvgJson(n,h):n=h,n.length||(n=h),i(0);let f=(E,w)=>E.filter(x=>w.includes(x.scope)),p=async E=>{let w=[];for(let x of E){let{content:I,data:C}=x;if(!!(I&&C)){let{polylineGroup:U}=x,_=await this.getImageOutline({polylineGroup:U,content:I,data:C}),H={...x,polylineGroup:_,content:"",data:null};w.push(H)}else w.push(x)}return w},m=this.makeProgressForward(i,0,1,n.length+1),y={4:a,5:this.getLayerSvgJson(5),2:this.getLayerSvgJson(2),1:this.getLayerSvgJson(1),6:this.getLayerSvgJson(6),7:this.getLayerSvgJson(7)};m();let g=[4,5,2,1,6,7],b=r||n.length<=1;for(let E=0,w=b?1:n.length;E<w;E++){console.time("build 1.2 "+(E+1)+"/"+w);let x=b?null:n[E].polylineGroup.bbox(),I={};for(let U of g){if(b){I[U]=y[U];continue}I[U]=[];let _=y[U];for(let H of _)H.polylineGroup.bbox().isIntersect(x)&&I[U].push(H)}let C=b?n:[n[E]],G=I[4]||[];{let U=I[1]||[];U=this.intersectSvgJson(U,C);let _=U.slice(),H=I[2]||[],Q=H;Q=f(Q,[2,1]),Q=Q.filter($=>$.opacity<1),Q=this.getOpacitySvgJson(C,Q),console.time("build 2.3"),U=this.intersectSvgJson(U,Q,1),console.timeEnd("build 2.3"),e&&(U=this.subSvgJson(U,G,!1)),U=U.filter($=>$.opacity>=.001),o=o.concat(U);let j=H.map($=>({...$,opacity:$.opacityCover}));j=f(j,[3,1]),j=j.filter($=>$.opacity<1),j=this.getOpacitySvgJson(C,j),_=_.map($=>{let{fillColor:B,strokeColor:M,content:v,data:N,jsonKey:R}=$;return B!="none"&&(B="#ffffff"),M!="none"&&(M="#ffffff"),(!!(v&&N)||R=="obj")&&(B="#ffffff",M="none"),{...$,fillColor:B,strokeColor:M}}),_=await p(_),_=this.purifyCoverData(_),_=this.intersectSvgJson(_,j,1),e&&(_=this.subSvgJson(_,G,!1)),_=_.filter($=>$.opacity>=.001),d=d.concat(_)}{let U=I[2]||[];U=this.applyGlueStroke(U,2),U=this.mergeSvgJson(U,!1),U=this.extendSvgJson(U,ti(0,"mm","pixel")),U=this.intersectSvgJson(U,C);let _=I[7]||[];_=this.applyGlueStroke(_,7),_=this.mergeSvgJson(_,!1),_=this.extendSvgJson(_,ti(0,"mm","pixel")),_=this.intersectSvgJson(_,C);let H=I[5]||[];H=this.mergeSvgJson(H,!1),H=this.applyGlueStroke(H,5),H=this.extendSvgJson(H,ti(0,"mm","pixel")),H=this.intersectSvgJson(H,C);let Q=this.subSvgJson(C,G,!1);Q=this.applyGlueStroke(Q,3);for(let M of Q)M.polylineGroup.items.shift();let j=ti(0,"mm","pixel");Q=this.extendSvgJson(Q,j);let $=this.mergeSvgJson([...Q,...H,...U,..._]),B=this.createEntireGlue(C,$);this._boardGroup[8]=B,l=l.concat(Q,H,U,_)}{let U=this.subSvgJson(C,G,!1);s=s.concat(U)}{let U=I[7]||[];U=this.intersectSvgJson(U,C),U=this.subSvgJson(U,G,!1),u=u.concat(U)}{let U=I[6]||[];c=c.concat(U)}m(),console.timeEnd("build 1.2 "+(E+1)+"/"+w)}return console.timeEnd("build"),i(1),this._boardGroup={...this._boardGroup,7:u,4:o,3:d,1:s,2:l,6:c},this._boardGroup}createEntireGlue(e,r){let i=this.subSvgJson(e,r);for(let n of i)n.fillColor="url(#"+nO+")",n.strokeColor="none";return i}applyGlueStroke(e,r){return e.map(i=>({...i,opacity:1,fillColor:"none",strokeColor:CM[r],strokeWidth:1}))}createJsonCache(e){let r={...e};for(let i of M6)r[i]={};return r.itemOrder=[],r}createBoardId(e,r){let i=`b${r}`,n=i,s=0,a="jabcdefghi";for(;e[n]===!0;)n=i+s.toString(10).replace(/\d/g,o=>a[o]),s++;return n}createBoardJsonItem(e,r){let i={gId:r,cmdKey:"group",matrix:void 0,tempMatrix:void 0,cover:!0,hide:!1,layer:3,locked:!1,name:"",opacity:1,rotation:0,scope:2,isWhiteBackground:!1,transparencyPrint:1,transparencyWhite:1,visible:!0},n={strokeColor:"#000000",strokeStyle:0,strokeWidth:1,fillColor:"none",displayStroke:!0,displayFill:!1};return{d:ql(e.polylineGroup.items,!1),...i,...n}}async buildJsonCacheGroup(e,r){let i=[],n=[],s=e.itemOrder,a=0,o={},l={},c=[3,4,5,2,1,6,7];for(let g of this.FILTER_LAYER_KEYS){let b=e[g];Vl(b,(E,w)=>{let{layer:x,hide:I}=w;I||c.includes(+x)&&(x==3?i.push(w):x==4&&n.push(w),M6.includes(g)&&(o[E]=bP(w,g),l[E]=w),s.includes(E)||a++)})}a>0&&console.warn("\u6CE8\u610F\uFF1A\u5B58\u5728\u65E0\u6392\u5E8F\u4FE1\u606F\u5F97\u56FE\u5143: "+a),r(.2);let u=i.map(g=>this.toSvgJson(g,!1)).flat();u=this.getCloseSvgJson(u,.01),u=this.mergeSvgJson(u,!1);let d=this.getDefaultBoardLayerSvgJson();u.length?(u=this.intersectSvgJson(u,d),u.length||(u=d)):u=d,r(.3);let A=u.map((g,b)=>b),h=u.map(g=>g.polylineGroup.bbox().transform(Ue.MIRROR_Y));A.sort((g,b)=>{let E=h[g].minY-h[b].minY,w=h[g].minX-h[b].minX;return Math.abs(E)<5&&Math.abs(w)>5?w:Math.abs(E)>5&&Math.abs(w)<5?E:E||w});let f=u.length,p=Array(f),m=.3,y=.7/f;for(let g of A){let b=h[g],E=this.createJsonCache(e),{minX:w,minY:x,maxX:I,maxY:C}=b;E.BBox={x:w,y:x,width:I-w,height:C-x},p[g]=E;let G={};Vl(o,(H,Q)=>{let j=l[H],{layer:$,cmdKey:B}=j;$!=3&&Q.isIntersect(b)&&(E[B][H]=j,G[H]=!0)}),E.itemOrder=s.filter(H=>G[H]===!0);let U=this.createBoardId(G,g);E.itemOrder.unshift(U);let _=this.createBoardJsonItem(u[g],U);E.group[U]=_,r(m+=y)}return p}getMergeCloseBoardSvgJson(e,r){this.init(e,!0),this.allToSvgJson();let i=this.getLayerSvgJson(r);return i=this.getCloseSvgJson(i,.01),i=this.mergeSvgJson(i,!1),i}purifyCoverData(e){let r=e.filter(u=>u.polylineGroup.items.length>1),i=e.filter(u=>u.polylineGroup.items.length<2),n=i.filter(u=>u.opacity===1),s=i.filter(u=>u.opacity<1).concat(r);n=this.mergeSvgJson(n,!1);let a=u=>Fr.build4([u.UL(),u.UR(),u.LR(),u.LL(),u.UL()]),o=u=>{let d=u.polylineGroup.bbox(),A=a(d);for(let h of n){let f=h.polylineGroup,p=f.bbox();if(d.isInside(p)&&!In.boolSubtraction([A],f.items).length)return!1}return!0},l=s.filter(o);return n.concat(l)}getOpacitySvgJson(e,r){let i=e,n=[];if(r.length){i=this.subSvgJson(e,r,!1),n=this.intersectSvgJson(r,e);let s=1;n=this.mergeOpacitySvgJson(n,s)}return i.concat(n)}buildSvgJsonFillStroke(e){let{polylineGroup:r,strokeColor:i,strokeWidth:n,fillColor:s}=e,a=!!s&&s!="none",o=n>0&&i!="none",l={strokeColor:"none",strokeWidth:0},c=o&&Lg(r,n/2,{fill:!1}),u=c&&{...e,...l,polylineGroup:c,fillColor:i},d=a&&{...e,...l};if(d&&u){if(s==i)return this.mergeSvgJson([d,u],!0);{let A=this.subSvgJson([d],[u],!0);return[u,...A]}}else{if(d)return[d];if(u)return[u]}return[]}getPreviewSVG(e){let r=this.getMarkSvg(1),i=this.getMarkSvg(2),n=[];return n.push(this.wrapIdAndMark(e[8],"\u80CC\u80F6\u5C42","",'display="none"')),this._head.coverColor=="black"&&n.push(this.wrapIdAndMark(e[3],"\u9ED1\u8272\u906E\u76D6\u5C42",r)),n.push(this.wrapIdAndMark(e[2],"\u767D\u8272\u906E\u76D6\u5C42",r)),n.push(this.wrapIdAndMark(e[1],"\u6253\u5370\u5C42","")),n.push(this.wrapIdAndMark(e[7],"\u9F13\u5305\u5C42","")),n.push(this.wrapIdAndMark(e[4],"\u677F\u6846\u5C42",i)),n.push(this.getOutlineInnerSVG("\u8FB9\u7EBF")),this.inner2OuterSVG(n.join(`
`))}getProductionSVG(e){let r=this.getMarkSvg(1),i=this.getMarkSvg(2),n=[];return n.push(this.wrapIdAndMark(e[5],"\u80CC\u80F6\u5C42","")),this._head.coverColor=="black"&&n.push(this.wrapIdAndMark(e[3],"\u9ED1\u8272\u906E\u76D6\u5C42",r)),n.push(this.wrapIdAndMark(e[2],"\u767D\u8272\u906E\u76D6\u5C42",r)),n.push(this.wrapIdAndMark(e[1],"\u6253\u5370\u5C42","")),n.push(this.wrapIdAndMark(e[7],"\u9F13\u5305\u5C42","")),n.push(this.wrapIdAndMark(e[4],"\u677F\u6846\u5C42",i)),n.push(this.getOutlineInnerSVG("\u8FB9\u7EBF")),this.inner2OuterSVG(n.join(`
`))}mergedSvgDataFactory(){let e=[7,1,3,2,4,5,8,6],r={};for(let i of e)r[i]=[];return{get(){return r},set(i){for(let n of e)r[n].push(i[n]||"")}}}async productionSvgNew(e,{forPreview:r=!1,progressCallback:i=_A}={}){i(0),this.init(e,!1);let n=this.makeProgressPercent(i,.3,.5),s=await this.buildJsonCacheGroup(e,n);if(this._jsonCacheList=s,!s.length)throw new Error("empty JsonCache Group");this._boardGroup={};let o=s.map(h=>Mr.extendRect(h.BBox)).reduce((h,f)=>Mr.extend2(h,f)),l={x:o.minX,y:o.minY,width:o.maxX-o.minX,height:o.maxY-o.minY};s.forEach(h=>h.BBox=l);let c=this.mergedSvgDataFactory(),u=s.length;if(u>=3){let h=this.makeProgressForward(i,.5,.85,u),f=new lO;f.init({url:`editor?entry=panel-sub-worker.js&cll=${self.PRO_LOG_LEVEL||""}`,workersCount:Math.min(16,u),name:"panel-sub-worker"});let p=0,m=y=>{let g=y.result;c.set(g),h(),console.log(`task complete: ${++p} / ${u}`)};for(let y of s)f.addTask({op:"generateSvgData",args:[{jsonCache:y,forPreview:r}]}).then(m);f.start(),await f.all().finally(()=>f.destroy()),await iz(100)}else for(let h of s){let p=await new t().generateSvgData(h,{forPreview:r,progressCallback:i,boardGroupCallback:m=>{for(let y of[7,4,3,1,2,8,6])this._boardGroup[y]=m[y].concat(this._boardGroup[y]||[])}});c.set(p)}return i(.9),{mergedSvgData:c.get()}}wrapIdAndMark(e,r,i="",n=""){return i&&e.push(i),r&&(e.unshift(`<g id="${r}" ${n}>`),e.push("</g>")),e.join(`
`)}async generateSvgData(e,{forPreview:r=!1,progressCallback:i=_A,boardGroupCallback:n=_A}={}){i(0),this.init(e),this.allToSvgJson();let s=this.makeProgressPercent(i,.3,.8),a=await this.buildBoardGroup({forPreview:r,progressCallback:s,forcedSingleGroup:!0}),o=a[7],l=a[4],c=a[3],u=a[1],d=a[2],A=a[8],h={};h[8]=await this.json2InnerSVG(A,"","",!1),h[5]=await this.json2InnerSVG(d,"","",!1),i(.81),this._head.coverColor=="black"&&(c=c.map(p=>({...p,fillColor:"#000000"})),h[3]=await this.json2InnerSVG(c,"","",!0),i(.83)),c=c.map(p=>({...p,fillColor:"#ffffff"})),h[2]=await this.json2InnerSVG(c,"","",!0),i(.85),h[1]=await this.json2PrintInnerSVG(l,""),i(.9);let f=r?' stroke-dasharray="12 4 2 4"':"";return h[7]=await this.json2InnerSVG(o,"","",!1,f),i(.95),h[4]=await this.json2InnerSVG(u,"","",!1,'vector-effect="non-scaling-stroke"'),i(1),n(a),h}async generate3d(e,{progressCallback:r}={}){let n=this.makeProgressPercent(r,0,.6),{mergedSvgData:s}=await this.productionSvgNew(e,{forPreview:!0,progressCallback:n}),a=this._boardGroup;if(!a[4]&&this._jsonCacheList){let u=A=>{[7,4,3,1,2,6,8].forEach(h=>{this._boardGroup[h]=A[h].concat(this._boardGroup[h]||[])})},d=this.makeProgressPercent(r,.6,.9);for(let A of this._jsonCacheList){let h=new t;h.init(A),h.allToSvgJson();let f=await h.buildBoardGroup({forPreview:!0,forcedSingleGroup:!0,progressCallback:d});u(f)}}r(.9);let o={7:a[7],1:a[4],2:a[3],3:[],4:a[1],5:a[2],8:a[8],6:a[6]};o[3]=o[2].map(u=>({...u,fillColor:"#000000"}));let{blobStr:l,dataStr:c}=await jK(o,this._head);return r(1),{blobStr:l,dataStr:c,productionSvg:this.getProductionSVG(s)}}};function qK(t){return Fr.build4([t.UL(),t.UR(),t.LR(),t.LL(),t.UL()])}function PIe(t){t.items.map((e,r)=>(e.closed()||(t.items[r]=e.asClose()),e))}var WK=new s8;function LIe(t,{width:e,height:r}){let i=ti(10,"mm","pixel"),n=ti(2.5,"mm","pixel"),s=ti(e,"mm","pixel"),a=ti(r,"mm","pixel"),o=ti(10,"mm","pixel")/2,l=[{x:i+n,y:-i-n},{x:s-i-n,y:-i-n},{x:s-i-n,y:-a+i+n},{x:i+n,y:-a+i+n}],c="";for(let u=0;u<l.length;u++){let{x:d,y:A}=l[u];t==2?c+=`M ${d-n} ${A} A ${n} ${n} 0 1 1 ${d+n} ${A} A ${n} ${n} 0 1 1 ${d-n} ${A} `:t==1&&(c+=`M ${d-o} ${A+o} L ${d-o} ${A-o} ${d+o} ${A-o} ${d+o} ${A+o} Z `)}return c.trim()}var uO=class{constructor(){this.BBoxCached=vq();this.PolylineCached=In.convertData2PolylineCached()}hasObjOutBoard(){let e=[],r=[];if(te.iterator((a,o,l)=>{if(!a.hide){if(a.layer===3){e.push(l);return}+a.layer!=8&&o!=="combination"&&o!=="_runtime"&&r.push({cmd:o,id:l})}}),!e.length)return[];let i=new Map,n=WK.getMergeCloseBoardSvgJson(te.gJsonCache,3);n.forEach(a=>{let l=a.polylineGroup.multiply3(Ue.MIRROR_Y).bbox();i.set(a,l)});let s=[];for(let a of r){let{cmd:o,id:l}=a,{json:c}=te.getById(l),u=0,d=this.BBoxCached(c);for(let A of n){let h=i.get(A);if(Mr.extendRect(d).isSeparated(h)){u++;continue}if(h.isContainsBBox1(Mr.extendRect(d)))break;let f=this.PolylineCached([c]);if(In.boolIntersection([f[0],A.polylineGroup.items]).length)break;u++}u===n.length&&s.push({id:l,cmd:Fn[o]})}return s}boardGapCheck(e,r){let i=[],n=[],s=new ih,a=te.getInitialGroupData({d:s.getPanelMarkPathDForDesign(),gId:"frame-sheet",cmdKey:"group",matrix:nr.getMatrix6FromMatrix(Ue.ORIGIN)});te.iterator((o,l,c)=>{if(!o.hide&&l!=="combination"&&o.layer===e){let u=this.PolylineCached([te.getById(c).json,a]);In.boolIntersection(u).length&&i.push({data:o,cmd:l,id:c})}});for(let o=0;o<i.length-1;o++){let l=vi(te.gJsonCache),c=i[o],{data:u,cmd:d,id:A}=c,h=this.BBoxCached(u),f=h.x+h.width/2,p=h.y+h.height/2,m=ep(Mr.extendRect(h).extendOfSize(r)),y=m.width/h.width,g=m.height/h.height,b,E,w;for(let x=o+1;x<i.length;x++){let I=i[x],C=I.data,G=I.cmd,U=I.id,_=this.BBoxCached(C);if(Mr.extendRect(m).isSeparated(Mr.extendRect(_)))continue;switch(d){case"rect":w=nr.createMatrixFrom6(u.matrix).multiply3(Ue.scale(y,g).setOrigin(f,p)),l[d][A].matrix=nr.getMatrix6FromMatrix(w);break;case"ellipse":w=nr.createMatrixFrom6(u.matrix).multiply3(Ue.scale(y,g).setOrigin(f,p)),l[d][A].matrix=nr.getMatrix6FromMatrix(w);break;case"arc":u.displayFill=!0,u.fillColor="#000000",b=In.convertJsonCache2PolyLines(u,"arc"),E=Lg(b,r);break;case"group":b=In.convertJsonCache2PolyLines(u,"group"),E=Lg(b,r);break}let H=this.PolylineCached([te.getById(A).json,te.getById(U).json]),Q=Lg(new Ws(H[0]),r),j=["group","arc"].includes(d)?In.boolIntersection([E.items,H[1]]):In.boolIntersection([Q.items,H[1]]);if(j.length){let $=[{id:A,cmd:Fn[d]},{id:U,cmd:Fn[G]}],B=new pr().ext1(j[0].__bbox).build();B.width()>.13&&B.height()>.13&&n.push($)}}}return n}hasObjInMark(){let e=[],r=[],i=KK();return te.iterator((n,s,a)=>{n.hide||n.layer===4&&s!="combination"&&r.push({data:n,cmd:s,id:a})}),te.iterator((n,s,a)=>{if(n.hide||n.layer===8||n.layer===4||s==="combination"||rn.eleIsHide(n))return;let o=this.BBoxCached(n);if(n.strokeWidth&&n.displayStroke){let l=n.strokeWidth;s==="group"?i=KK(l):(o.x-=l/2,o.y-=l/2,o.width+=l,o.height+=l)}for(let l of i){let c=Object.values(l).length/8,u={x:l.x0,y:l.y0,width:l[`x${c*3}`]-l.x0,height:l[`y${c}`]-l.y0};if(!Mr.extendRect(o).isSeparated(Mr.extendRect(u))){for(let d of r){let A=this.PolylineCached([te.getById(a).json,te.getById(d.id).json]),h=A[1];if(In.boolIntersection(A).length){let f=[];for(let p of h)p.points(.5,m=>{f.push({x:m.x,y:-m.y})});if(tm({x:l.x0,y:l.y0},f)&&tm({x:l.x100,y:l.y100},f)&&tm({x:l.x200,y:l.y200},f)&&tm({x:l.x300,y:l.y300},f))return}}RC(o,u)&&e.push(a);for(let d=0;d<400;d++){let A=l[`x${d}`],h=l[`y${d}`];switch(s){case"rect":(Vf(A,h,o)||OIe(A,h,n))&&e.push(a);break;case"ellipse":let{cx:f,cy:p,rx:m,ry:y}=tn.getEllipseFromMatrix(n.matrix);(Sh(f,p,A,h,m,y)<=1||NIe(A,h,n))&&e.push(a);break;case"arc":let g=np(A,h);g.length&&g.forEach(w=>{e.push(w)}),RIe(A,h,n)&&e.push(a);break;case"text":MIe(u,n)&&e.push(a);break;case"group":let b=cb(A,h);b.length&&b.forEach(w=>{e.push(w.id)});break;case"obj":let E=oE(A,h);E.length&&E.forEach(w=>{e.push(w.id)});break}}}}}),[...new Set(e)]}hasObjOutMaterialFrame(){let e=[],{w:r,h:i}=new ih().getMaterialFrameSize();return te.iterator((n,s,a)=>{if(n.layer!==3)return;let{x:o,y:l,width:c,height:u}=s==="group"?yP(n):un(n);(o<0||-l>i||o+c>r||-l-u<0)&&e.push({displayId:n.id,gId:n.gId})}),e}};function KK(t=0){let e=[];return new ih().getMarksBBox().forEach(i=>{let{x:n,y:s,width:a,height:o}=i,l={};n-=t/2,s-=t/2,a+=t,o+=t;let c=a/100;for(let u=0;u<400;u++)switch(Math.floor(u/100)){case 0:l[`x${u}`]=n,l[`y${u}`]=s+c*(u%100);break;case 1:l[`x${u}`]=n+c*(u%100),l[`y${u}`]=s+o;break;case 2:l[`x${u}`]=n+a,l[`y${u}`]=s+o-c*(u%100);break;case 3:l[`x${u}`]=n+a-c*(u%100),l[`y${u}`]=s;break}e.push(l)}),e}function OIe(t,e,r){if(r.strokeWidth&&r.displayStroke){let i=r.strokeWidth/2,n=un(r,"rect"),s=vi(n);s.x+=i,s.y+=i,s.width-=i*2,s.height-=i*2;let a=vi(n),o=vi(n);a.x-=i,a.width+=i*2,o.y-=i,o.height+=i*2;let l=n.x,c=n.y,u=n.x+n.width,d=n.y,A=n.x,h=n.y+n.height,f=n.x+n.width,p=n.y+n.height,m=Sh(l,c,t,e,i,i)<=1||Sh(u,d,t,e,i,i)<=1||Sh(A,h,t,e,i,i)<=1||Sh(f,p,t,e,i,i)<=1;if(!Vf(t,e,s)&&(Vf(t,e,a)||Vf(t,e,o)||m))return!0}return!1}function NIe(t,e,r){if(r.strokeWidth&&r.displayStroke){let{cx:i,cy:n,rx:s,ry:a}=tn.getEllipseFromMatrix(r.matrix),o=s-r.strokeWidth/2,l=a-r.strokeWidth/2,c=s+r.strokeWidth/2,u=a+r.strokeWidth/2,d=Sh(i,n,t,e,o,l),A=Sh(i,n,t,e,c,u);if(d>=1&&A<=1)return!0}return!1}function RIe(t,e,r){let i=(r.x1+r.x2)/2,n=(r.y1+r.y2)/2,s=new ne(r.x1-r.x2,r.y1-r.y2),a=new ne(r.x1-t,r.y1-e),o=s.cross(a);if(r.strokeWidth&&r.displayStroke){let l=r.rx-r.strokeWidth,c=r.ry-r.strokeWidth,u=r.rx+r.strokeWidth,d=r.ry+r.strokeWidth,A=Sh(i,n,t,e,l,c),h=Sh(i,n,t,e,u,d),f=Sh(r.x1,r.y1,t,e,r.strokeWidth/2,r.strokeWidth),p=Sh(r.x2,r.y2,t,e,r.strokeWidth/2,r.strokeWidth);if(A>=1&&h<=1&&o<=0||f<=1||p<=1)return!0}return!!(r.displayFill&&r.fillColor!=="none"&&Sh(i,n,t,e,r.rx,r.ry)<=1&&o<=0)}function MIe(t,e){let r=xr.createMatrixFrom6(e.matrix),i=Jn(e.d,!1),n=[];for(let s of i)s.points(.5,a=>{n.push(a.multiply3(r))});for(let s of n)if(Vf(s.x,s.y,t))return!0;return!1}var cT={3:["No Board Outline Layer, that used to define the shape of the panel.","Draw it"],1:["No Print Layer, that used to define the need to display the contents of the panel.","Draw it"],4:["No Slot Hole Layer, that used to define the need hollow out part of the panel.","Draw it"],2:["No Opacity Control Layer, that used to define needs transparent area of the panel.","Draw it"],5:["No Glue Cutout Layer, that used to define the area within the board layer that does not need to be glued except for the board hole.","Draw it"],6:["No Lighting Simulation Layer, that used for simulating panel lights.","Draw it"],outBoard:["Objects that only in assist drawing layer or board outline layer are allowed to exist independently outside the board outline. If you need a note, please fill it in on the order page. Please check: "],inMark:["To avoid the overall cutting offset caused by inaccurate positioning, do not draw objects within the four vertex rectangles of the material bounding box: "],inGap:["A certain distance should be maintained between the board outline layer objects, and the recommended minimum spacing is 2mm. To adjust: "],start:["Start Design Rule Checking."],finish:["Finish Design Rule Checking.Fatal Error: {1}, Error: {2}, Waring: {3}, Info: {4}."],outMaterial:["Objects in the board outline layer should be drawn within the material boarder box. To adjust:"]},a8=class{constructor(){this.busTopic="panel/design-check";this.logTopic="panel/design-check-show-log"}check(){this.drc=new uO;let e=this.getExistsLayer(),r=this.generateInfoMsg(e);this.startCheck(r),this.checkIfEleNotInAnyBoard(r),this.checkGapOfBoards(r),this.checkIfEleInAnyMark(r),this.checkBorderObjectInMaterialBorder(r);let i=this.analysisMsg(r);return this.finishCheck(r,i),this.showMsg(r),i}startCheck(e){let r={type:"info",tabType:"panelDrcLog",openTab:!0,msg:[qu(cT.start[0])]};e.unshift(r)}finishCheck(e,r){let{fatalErrorCount:i,errorCount:n,warnCount:s,infoCount:a}=r,o={type:"info",tabType:"panelDrcLog",openTab:!0,msg:[qu(cT.finish[0],{params:{1:i,2:n,3:s,4:a}})]};e.push(o)}showExportMsg(e){let{type:r,fileName:i,errorCount:n,fatalErrorCount:s,warnCount:a,infoCount:o}=e;if(r==="fail"){let l=[qu("Generate {0} fabrication file failed! Fatal Error: {1}, Error: {2}, Warning: {3}, Info: {4}.",{params:{0:i,1:s,2:n,3:a,4:o}})];X.windowBridge.publish("bottomBarLog",{type:"info",tabType:"panelDrcLog",openTab:!0,msg:l},ur())}else{let l=[qu("Generate {0} fabrication file successfully! Error: {1}, Warning: {2}, Info: {3}.",{params:{0:i,1:n,2:a,3:o}})];X.windowBridge.publish("bottomBarLog",{type:"info",tabType:"panelDrcLog",openTab:!0,msg:l},ur())}Et("bottomBarLogGroupEnd","panelDrcLog")}analysisMsg(e){let r=0,i=0,n=0,s=0;for(let a of e)switch(a.type){case"error":r++;break;case"fatalError":i++;break;case"warn":n++;break;case"info":s++;break}return{errorCount:r,fatalErrorCount:i,warnCount:n,infoCount:s}}getBottomInfo(e,r,i="panelDrcLog"){return{type:e,tabType:i,openTab:!0,msg:[qu(cT[r][0]),{text:qu(cT[r][1]),call:{topic:"panel/active-layer",args:[r,X.tabId]}}]}}getBottomWarn(e,r,i,n="panelDrcLog"){return{type:e,tabType:n,openTab:!0,msg:[qu(cT[r][0]),...i]}}generateInfoMsg(e){let r=[];return e.has(3)||r.push(this.getBottomInfo("fatalError",3)),e.has(1)||r.push(this.getBottomInfo("error",1)),e.has(4)||r.push(this.getBottomInfo("info",4)),e.has(2)||r.push(this.getBottomInfo("info",2)),e.has(5)||r.push(this.getBottomInfo("info",5)),e.has(6)||r.push(this.getBottomInfo("info",6)),r}getExistsLayer(){let e=new Set;return te.iterator(r=>{r.layer&&e.add(+r.layer)}),e}checkIfEleNotInAnyBoard(e){let r=this.drc.hasObjOutBoard();if(r.length){let i=[],n=new gr;r.forEach((s,a)=>{let o=n.searchCombination(s.id)||"",{id:l}=te.getById(s.id).json;i.push({text:qu(s.cmd)+l.replace(/^e/,"")+(a==r.length-1?"":","),attr:{panelid:X.tabId,id:s.id,comId:o}})}),e.push(this.getBottomWarn("warn","outBoard",i))}}checkGapOfBoards(e){let r=lu(2),i=this.drc.boardGapCheck(3,r);if(i.length){let n=[],s=new gr;i.forEach((a,o)=>{let l=s.searchCombination(a[0].id)||"",c=s.searchCombination(a[1].id)||"",{id:u}=te.getById(a[0].id).json,{id:d}=te.getById(a[1].id).json;n.push({text:qu(a[0].cmd)+u.replace(/^e/,""),attr:{panelid:X.tabId,id:a[0].id,comId:l}},qu("And"),{text:qu(a[1].cmd)+d.replace(/^e/,""),attr:{panelid:X.tabId,id:a[1].id,comId:c}},o==i.length-1?"":"\uFF0C")}),e.push(this.getBottomWarn("warn","inGap",n))}}checkIfEleInAnyMark(e){let r=this.drc.hasObjInMark();if(r.length){let i=[],n=new gr;r.forEach((s,a)=>{let o=te.getById(s).json,l=o.id,c=n.searchCombination(s)||"",u=Fn[o.cmdKey];i.push({text:qu(u)+l.replace(/^e/,""),attr:{panelid:X.tabId,id:s,comId:c}},a===r.length-1?"":"\uFF0C")}),e.push(this.getBottomWarn("warn","inMark",i))}}checkBorderObjectInMaterialBorder(e){let r=this.drc.hasObjOutMaterialFrame();if(r.length){let i=[],n=new gr;r.forEach(({displayId:s,gId:a},o)=>{let l=n.searchCombination(a)||"",c=Fn[te.getById(a).cmdKey];i.push({text:qu(c)+s.replace(/^e/,""),attr:{panelid:X.tabId,id:a,comId:l}},o===r.length-1?"":",")}),e.push(this.getBottomWarn("error","outMaterial",i))}}showMsg(e){Et("logClear","panelDrcLog"),Et("bottomBarLogGroupStart","panelDrcLog");for(let r of e)Et("bottomBarLog",r)}},Cb=new a8;var Sb=class Sb extends Fc{constructor(){super(...arguments);this.nodes=[]}getSymbol(){return Ps.place_lib_tool}static canSwitchMe(){return!!this.data}install(r){console.log(this.getSymbol()," installed"),this.lastX=r.canvasX,this.lastY=r.canvasY,this.prepareNodes(r),Ls("cross-red",this.lastX,this.lastY,{enforceEnterRefPoint:!0})}prepareNodes(r){let i=te.gJsonCache,n=vi(Sb.data.jsonCache),s=te.exchangeJsonCache(n),a=new Map,o=new Map,l=new Set;this.copiedCombination=[],this.oldIdMapNewId=new Map,te.iterator((d,A,h)=>{a.set(h,d),o.set(h,A),this.oldIdMapNewId.set(h,""),A==="dimension"&&l.add(h)}),te.iteratorCombination((d,A,h)=>{a.set(h,d),o.set(h,A);let f=ni();d.gId=f,this.oldIdMapNewId.set(h,f),this.copiedCombination.push(d)}),s();let c=[],{itemOrder:u}=n;for(let d of u){if(l.has(d))continue;let A=a.get(d);if(!A)continue;let h=o.get(d),f=ni();A.gId=f,this.oldIdMapNewId.set(d,f),h==="dimensionRadius"&&(A.ellipseId=this.oldIdMapNewId.get(A.ellipseId));let p=Hc(h,A,f);c.push(p)}this.prepareDimensions(l,a,this.oldIdMapNewId,c),Jr.clearExcludeShapeIds().setExcludeShapeIds(c.map(d=>d.id)),this.nodes=c;for(let d of c)em(d,UA);if(c.length){let{x:d,y:A,width:h,height:f}=JK(c);Vg(c,r.canvasX-d,r.canvasY-(A+f))}return c}prepareDimensions(r,i,n,s){for(let a of r){let o=i.get(a),l=o.start.id,c=o.end.id,u=n.get(l),d=n.get(c);if(u&&d){o.start.id=u,o.end.id=d;let A=ni();o.gId=A,n.set(a,A);let h=Hc("dimension",o);s.push(h)}}}uninstall(r){console.log(this.getSymbol()," uninstalled")}rotate(r){let i=Bh(this.nodes).filter(n=>te.getById(n.id).cmdKey!=="auxiliaryLine");up(i,r)}flipH(){let r=Bh(this.nodes),i=_h(r,!0,{ignoreSnap:!0});new sA(r).mirror(!0,i)}flipV(){let r=Bh(this.nodes),i=_h(r,!0,{ignoreSnap:!0});new sA(r).mirror(!1,i)}onMouseLeftUp(r){Ci(),pt.select(this.nodes),rh(this.nodes);let i=new qi;new gr().pasteCombination(i,this.copiedCombination,this.oldIdMapNewId,this.nodes);for(let n of this.nodes){nd(n,UA);let{json:s,cmdKey:a}=te.getById(n.id);i.addOne(s,{},a),Jr.updateShapeCache(s.gId,a,s)}i.updateAndSave(),this.prepareNodes(r),Et("panel_updateAttrPanel"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE),this.uploadPlacePanelLibLog()}onMouseRightUp(r){rh(this.nodes,"cancel"),r.toolFinished=!0,Sb.data=null,te.removeMultiData(this.nodes),Ls(!1),Jr.clearAdsorptionHTML(),Et("openPlaceClosedBottomBar")}onMouseMove(r){let{originalEvent:i}=r,{x:n,y:s}=Hn(i,!i.altKey),a=n-this.lastX,o=s-this.lastY;Vg(this.nodes,a,o),this.lastX=n,this.lastY=s}static async setPlacingStatus(r){if(r.jsonCache=await cp.getJsonCache(r.uuid,r.path),this.resetPanelLibItemOrder(r.jsonCache),r.jsonCache.itemOrder.length===0){il("Placement failed, panel library has no content","warn"),Et("openPlaceClosedBottomBar");return}let i=X.frameHelper.getToolProcessor();if(i.currentToolIs(Ps.place_lib_tool)){let n=i.getCtx();i.currentTool.onMouseRightUp(n),i.switchToHighlightTool()}else if(i.currentToolIs(Ps.draw)){let n=i.getCtx();i.currentTool.uninstall(n),i.switchToHighlightTool()}r.svgStr=Ba.toSVG(r.jsonCache),this.isPlacing=!0,this.data=r}static resetPanelLibItemOrder(r){let i=te.exchangeJsonCache(r);r.itemOrder.forEach(n=>{let s=te.getById(n).json;s&&(s.zIndex=void 0)}),i()}uploadPlacePanelLibLog(){var r;X.windowBridge.publish("addUploadPlaceLibLog",{uuid:Sb.data.uuid,lib_type:6,path:(r=Sb.data.owner)==null?void 0:r.uuid},ur())}};Sb.isPlacing=!1;var uT=Sb;var By=class By{static ready(){let e=X.cmdToken.includes("xy")?"xy":X.cmdToken.includes("x")?"x":"y";this.addingRuler=!0,this.currentDirection=e,KA.load(),Jr.enabled=!1,Ci(),tr.started=!0,window.focus()}static placeDimension(e){tr.dots.length=0;let{name:r,size:i,type:n,cancel:s,id:a,created:o}=e;if(!o){if(s)return;let A=te.getDimension(a);this.currentDimension=new Ua(A)}let l=this.currentDimension.toJSON();if(s){this.currentDimension.unmount(),this.currentDimension=null;return}let c=this.currentDimension.getDistance(),u=!_i(c,+i);i=lu(+i),l.category=n,l.name=r;let d=lk(l);mr.startBatch(),o&&mr.jsonSnap.addOne(l,{}),n==="Constraint"&&u&&(el.changeDimensionSize(this.currentDimension.getId(),i),KA.load()),mr.saveBatch(),pt.select([d]),Et("panel_updateAttrPanel"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE),this.currentDimension=null,te.compilerManager.resumeDataMerge()}static getCurrentDirection(){return By.currentDirection}static lockCurrentDirection(){this.lockedDirection=!this.lockedDirection}static unLockCurrentDirection(){this.lockedDirection=!1}static mousedownLeft(e){let{canvasX:r,canvasY:i}=e;if(te.compilerManager.pauseDateMerge(),this.clickedLabelDots.length===2){for(let d of this.clickedLabelDots)d.setClicked(!1).unmount();this.clickedLabelDots.length=0,this.unLockCurrentDirection();let s=this.currentDimension.start.id,a=this.currentDimension.end.id,o=this.currentDimension.getDirection(),l=new Ad,c=!1;s===a?c=l.overDefinedSelf(s,o):(l.findDimensionNodeByPrimitiveId(new Set([s])),c=l.overDefined(s,a,o));let u={name:"",object:{start:te.getById(s).json,end:te.getById(a).json,...this.currentDimension.getPrimitiveType()},type:this.currentDimension.getCategory(),size:this.currentDimension.getDistance(),overed:c,created:!0};Et("panel/open-smart-dimension-dialog",[u]);return}let n=KA.findNearestLabelPoint(new ne(r,i),this.hoveLabelDots);n&&(this.clickedLabelDots.length===1&&n===this.clickedLabelDots[0]||(n.setClicked(!0).mount(),this.clickedLabelDots.push(n),this.clickedLabelDots.length===2&&this.draw(tr.lastX,tr.lastY)))}static draw(e,r){if(this.clickedLabelDots.length<2){let f=KA.findNearbyPrimitiveLabelPoint(e,r);this.hoveLabelDots=this.lockTargetLabelDots.get()||KA.getTopLabelPoints(f);for(let p of this.hoveLabelDots)p.mount()}if(this.clickedLabelDots.length!==2)return;for(let f of this.hoveLabelDots)f.unmount();let[i,n]=this.clickedLabelDots,s=i.getX(),a=i.getY(),o=n.getX(),l=n.getY(),c=this.getCurrentDirection(),u=(e-s)*(e-o)<0,d=(r-a)*(r-l)<0;this.lockedDirection&&(c=this.dynamicDirection),!this.lockedDirection&&c==="xy"&&(u&&d?c="xy":u?c="x":d&&(c="y"),this.dynamicDirection=c);let A={id:i.getPrimitiveId(),index:i.getIndex(),cmdKey:i.getCmdkey(),primitivePoint:{x:s,y:a},otherPoint:{x:s,y:r}},h={id:n.getPrimitiveId(),index:n.getIndex(),cmdKey:n.getCmdkey(),primitivePoint:{x:o,y:l},otherPoint:{x:o,y:r}};if(c==="y"&&(A.otherPoint.x=e,A.otherPoint.y=a,h.otherPoint.x=e,h.otherPoint.y=l),c==="xy"){let f=el.calcuPerpendicular({x:s,y:a},{x:o,y:l},{x:e,y:r});A.otherPoint=f.start,h.otherPoint=f.end}if(this.currentDimension)this.currentDimension.updateStartNode(A).updateEndNode(h).updateType(c).render();else{let f=ni();this.currentDimension=new Ua({name:"",layer:8,gId:f,start:A,end:h,category:"Constraint",direction:"x",visible:!0})}}static next(){for(let e of this.hoveLabelDots)e.setClicked(!1).unmount();for(let e of this.clickedLabelDots)e.setClicked(!1).unmount();this.clickedLabelDots.length=0,this.unLockCurrentDirection(),this.currentDimension&&(this.currentDimension.unmount(),this.currentDimension=null),this.lockTargetLabelDots.lockToggle([]),te.compilerManager.resumeDataMerge()}static onKeyUp(e){let{keyCode:r}=e;switch(r){case"Backspace":if(this.clickedLabelDots.length===0)return;this.clickedLabelDots.pop().setClicked(!1).unmount(),this.currentDimension&&(this.currentDimension.unmount(),this.currentDimension=null);break;case"Space":this.clickedLabelDots.length===2?this.lockCurrentDirection():this.lockTargetLabelDots.lockToggle(this.hoveLabelDots);break;default:break}}static end(){this.clickedLabelDots.length||(Jr.enabled=!0),this.next()}};By.addingRuler=!1,By.lockedDirection=!1,By.clickedLabelDots=[],By.hoveLabelDots=[],By.lockTargetLabelDots=(()=>{let e=[];return{lockToggle(r){e.length?e=[]:e=r},get(){return e.length?e:void 0}}})();var kE=By;function hO(t){return t?t.split("@"):[t,""]}var FIe={["-"+Cb.busTopic]:Cb.check.bind(Cb),"-panel/get-combine-data":AL,"-panel/edit-combination"(t){Li.setEditing(t)},"-panel/get-edit-combination-id"(){return Li.getCurrentEditingComId()},"-panel/get-editingPath"(){return pi.isEditingPath()},"-panel/select-combination"(t){Li.selectCombinations(t)},"-panel/modify-combination"(t){new gr().modifyCombination(t)},"-panel/get-allCombinationAndElesFromTop"(t){let{elements:e,combinations:r}=new gr().getAllElesfromTop(t);return{elements:[...e],combinations:[...r]}},"-/panel/getObjectTreeData":jW,"-getPanelInfo":async()=>{let t=X.doctype,[e,r]=(window.frameElement.id||"").replace("frame_","").split("@");return{docType:t,path:r,uuid:e}},changeSelectionMode:XS,applyFilter:yd,"panel/BoolOperation":NK,"panel/select-overlap":qq,"panel/show-element-control":ek.showShapeControl,"main2iframe/trigger-event":$K,[Cb.logTopic]:Cb.showExportMsg.bind(Cb),"/panel/place_lib":uT.setPlacingStatus.bind(uT),"panel/place-dimension":t=>{kE.placeDimension(t)},"panel/delete-combination"(t){Li.deleteCombinations(t)},"-panel/update-reference-point"(t){Wi.setReferencePoint(t)},"panel/set-project-permission":fy.set};var dO=class{static async createJsonCache(e){let i=await new _E().decodeDataStr(e);i.success&&i.jsonCache&&(this.jsonCache=i.jsonCache)}static panelChangeUpdateJsonCache(e){let r=te.exchangeJsonCache(this.jsonCache);e.forEach(i=>{let{shapeIds:n,layerId:s,isVisible:a}=i;n.forEach(o=>{var c;let l=(c=te.getById(o))==null?void 0:c.json;if(l){let{layer:u,visible:d}=l;u!==s&&(l.layer=s),d!==a&&(l.visible=a)}})}),r()}static createSvg(){let e=te.exchangeJsonCache(this.jsonCache),r=te.getBBox(),i=50,n=r.width(),s=r.height();n=(i/n+1)*n,s=(i/s+1)*s;let a=[r.minX-i/2,r.minY-i/2,n,s].join(" ");return e(),Ba.toSVG(this.jsonCache,{viewBox:a,before:()=>{}})}static updateStrokeWidth(e){if(!this.jsonCache)return;let r=te.exchangeJsonCache(this.jsonCache);te.iterator(i=>{Reflect.has(i,"strokeWidth")&&i.strokeWidth!==e&&(i.strokeWidth=e)}),r()}static updateScale(e){if(!this.jsonCache||!(e>0))return;let r=te.exchangeJsonCache(this.jsonCache),i=Ue.scale(e);te.iterator(n=>{let{cmdKey:s}=n;lL[s](n,i)}),r()}static async import(e){if(!this.jsonCache)return;let r=te.exchangeJsonCache(this.jsonCache);if(te.iterator(n=>{if(!n.visible){let{gId:s,cmdKey:a}=n,o=te.gJsonCache[a];o&&o[s]&&delete o[s]}}),te.getBBox().area()===0){r(),il("No Data!","warn");return}r();let i=await RL(this.jsonCache);X.frameHelper.getToolProcessor().switchToPasteTool("paste_dxf",i,e?void 0:"center")}static dispose(){this.jsonCache=null}};dO.jsonCache=null;function Et(t,e=""){X.windowBridge.publish(t,e,ur())}function il(t,e="warn"){Et("ui/toastMsg",{type:e,msg:t,timer:3})}var $i=class{constructor(){this.tasks=[];this.noSolution=!1;this.isRunningTask=!1;this.ignorePrimitiveIds=new Set;this.labelPointTransformMap=new Map;this.dimensionMgr=new Ad}static setSkipCheck(e){return this.skipCheck=e,()=>{this.skipCheck=!e}}static createContext(e=!1){return this.self=new this,e&&mr.startBatch(),()=>{this.runTask(),e&&mr.saveBatch(),LL(te.getGJsonCache())}}static wrapDo(e){let r=this.createContext(!0);try{return e()}finally{r()}}static checkOne(e,r,i){return!this.self||this.self.isRunningTask||this.skipCheck?_A:this.self.beforeMatrixChange(r,i)}static runTask(e=!1){this.self.isRunningTask=!0;let r=this.self.noSolution;if(r===!1)for(;this.self.tasks.length;)this.self.tasks.pop()();return e?(this.self.dimensionMgr.reset(),this.self.isRunningTask=!1):this.emptyContext(),r}static emptyContext(){this.self=null}static addCallBack(e){this.self?this.self.tasks.push(e):e()}getDotsTransform(e){let r=this.labelPointTransformMap.get(e.gId);if(r)return r;let i=KA.loadPointsByData(e);return r=new fE(i),this.labelPointTransformMap.set(e.gId,r),r}beforeMatrixChange(e,r){if(this.noSolution||this.isRunningTask)return!1;let i=this.getDotsTransform(e);i.transform(r);let{moveNode:n,stillNode:s}=i.getTransformedNode(),a=this.dimensionMgr.setNodeVisited(s).findDimensionNode(n);if(a===!1)return this.noSolution=!0,!1;let o=!1,l=new Set;for(let c of a){let{dx:u,dy:d,xNode:A,yNode:h}=c,{canMoveX:f,canMoveY:p}=this.dimensionMgr.getAllAffectedPrimitivesId(A,h);if(u!==0){for(let m of new Set([...f]))if(Rs.isLockedById(m)){let y=Fn[te.getById(m).cmdKey];o=!0;let g=te.getById(m).json;l.add(y+(g==null?void 0:g.id.slice(1)))}}if(d!==0){for(let m of new Set([...p]))if(Rs.isLockedById(m)){let y=Fn[te.getById(m).cmdKey];o=!0;let g=te.getById(m).json;l.add(y+(g==null?void 0:g.id.slice(1)))}}}return o&&(il({value:l.size>1?"Constraint associated object {0} are currently locked, please unlock them first.":"Constraint associated object {0} is currently locked, please unlock first.",options:{0:[...l]},translateOptionKeys:[0]}),this.noSolution=!0),this.noSolution?!1:(this.ignorePrimitiveIds.add(e.gId),mr.jsonSnap.addOne(e),()=>{for(let c of a){let{dx:u,dy:d,xNode:A,yNode:h}=c,{canMoveX:f,canMoveY:p}=this.dimensionMgr.getAllAffectedPrimitivesId(A,h);for(let m of f)this.ignorePrimitiveIds.has(m)&&f.delete(m);for(let m of p)this.ignorePrimitiveIds.has(m)&&p.delete(m);this.dimensionMgr.prepareHistory(A,h).movePrimitive(u,d,f,p).moveDimension(u,d,A,h)}})}};$i.skipCheck=!1;var o8=class{constructor(){this.center={x:0,y:0};this.unitRx={x:1,y:0};this.unitRy={x:0,y:1}}getDotsForAdsorp(e){let r=0,i=0,n=1,s=1,a=r-n,o=r+n,l=i-s,c=i+s,u=[[a,l],[o,l],[o,c],[a,c],[r,l],[o,i],[r,c],[a,i],[r,i]],{tempMatrix:d,matrix:A}=te.getEllipse(e),h=xr.createMatrixFrom6(d||A),f=[];for(let p of u){let m=new ne(p[0],p[1]).multiply3(h);f.push(m)}return f}sync(e,r,i){let s=xr.createMatrixFrom6(e.matrix).multiply3(r),a=nr.getMatrix6FromMatrix(s);i.updateMatrix&&(e.matrix=a),e.tempMatrix=a,this.updateEllipseShape(Fe(e.gId),e)}syncEllipse(e,r,i){let n=$i.checkOne("ellipse",e,r);n!==!1&&$i.addCallBack(()=>{var s;n(),this.sync(e,r,i),(s=i==null?void 0:i.fn)==null||s.call(i)})}syncEllipseByRotation(e,r,i,n){let s=this.getRotationMatrix(e,r,i,n);s&&this.syncEllipse(r,s,{updateMatrix:!0,fn(){r.rotation=+e.toFixed(2)}})}getRotationMatrix(e,r,i,n){if(!cu(e))return;let{matrix:s,rotation:a}=r,o=a||0,l=xr.createMatrixFrom6(s),c=i||new ne(this.center.x,this.center.y).multiply3(l);return Ue.rotateD(e-o).setOrigin1(c)}syncEllipseRadius(e,r,i,n){let{cx:s,cy:a,rx:o,ry:l}=this.getEllipseFromMatrix(e.matrix);r=r||l,i=i||o;let[c,u]=Wi.getReference(),d=new ne(1-u,1-c),A=nr.createMatrixFrom6(e.matrix).getInverseMatrix(),h=Ue.translate1(d).scale(i,r).rotateD(e.rotation).translate1(n);this.syncEllipse(e,A.multiply3(h),{updateMatrix:!0})}syncEllipsePosition(e,r,i){let{x:n,y:s}=un(e,"ellipse");r=cu(r)?r:n,i=cu(i)?i:s;let a=r-n,o=i-s;if(!a&&!o)return;let l=Ue.translate(a,o);this.syncEllipse(e,l,{updateMatrix:!0})}syncEllipseSize(e,r,i,n){if(!n){let{cx:d,cy:A}=this.getEllipseFromMatrix(e.matrix);n=new ne(d,A)}let s=l8(e),a=s.width,o=s.height,l=1,c=1;if(Ir(r)||(l=r/a),Ir(i)||(c=i/o),l===0||c===0||l===1&&c===1)return;let u=Ue.scale(l,c).setOrigin(n.x,n.y);this.syncEllipse(e,u,{updateMatrix:!0})}updateEllipseShape(e,r){let{rx:i,ry:n,matrixArr:s}=this.getEllipseFromMatrix(r.tempMatrix||r.matrix);ge(e,{rx:i,ry:n}),xr.updateTransform(s,e)}getEllipseFromMatrix(e){let r=xr.createMatrixFrom6(e),i=new ne(this.center.x,this.center.y).multiply3(r),n=new ne(this.unitRx.x,this.unitRx.y).multiply3(r),s=new ne(this.unitRy.x,this.unitRy.y).multiply3(r),a=n.distance1(i),o=s.distance1(i),c=Ue.scale(1/a,1/o).multiply3(r),u=nr.getMatrix6FromMatrix(c);return{cx:i.x,cy:i.y,rx:a,ry:o,matrixArr:u}}},tn=new o8;function Qg(t){let e=t.cmdKey=="arc"?ls.get8Dots2(t):Ts.get(Fe(t.gId),"single"),r=HA(e[0],e[1],e[2],e[3]),i=HA(e[0],e[1],e[6],e[7]);return{obbWidth:r,obbHeight:i}}function ZK(t){let e=new Bn(t),r=un(t,"arc"),i=e.vectorCenter(),[n,s]=te.translateByOrigin(i.x,i.y),[a,o]=te.translateByOrigin(t.x1,t.y1),[l,c]=te.translateByOrigin(t.x2,t.y2),u=Wi.transferXYByReference(r),[d,A]=te.translateByOrigin(u[0],u[1]),{obbWidth:h,obbHeight:f}=Qg(t);return{"attr-width":r.width,"attr-height":r.height,"attr-obb-width":h,"attr-obb-height":f,"attr-x":+d.toFixed(2),"attr-y":+A.toFixed(2),"reference-point":Wi.getReferencePoint(),"attr-circle-center-x":n,"attr-circle-center-y":s,"attr-start-x":a,"attr-start-y":o,"attr-end-x":l,"attr-end-y":c,"attr-long-radius":t.rx,"attr-short-radius":t.ry,"attr-start-angle":ry(e.startAngle()),"attr-end-angle":ry(e.endAngle()),"attr-arc-type":t.type===1?"Center Arc":"Two Points Arc","attr-rotation":Math.abs(t.rotation||0)}}function eJ(t){let e=un(t),{obbWidth:r,obbHeight:i}=Qg(t),n=Wi.transferXYByReference(e),[s,a]=te.translateByOrigin(n[0],n[1]),{rx:o,ry:l}=tn.getEllipseFromMatrix(t.matrix);return{"reference-point":Wi.getReferencePoint(),"attr-width":e.width,"attr-height":e.height,"attr-obb-width":r,"attr-obb-height":i,"attr-long-radius":o,"attr-short-radius":l,"attr-x":_i(s,0)?0:s,"attr-y":_i(a,0)?0:a,"attr-rotation":Math.abs(t.rotation||0)}}function tJ(t){let e=new Ua(t);return{"attr-dimension-object":[{start:te.getById(t.start.id).json,end:te.getById(t.end.id).json}],"attr-dimension-category":t.category,"attr-dimension":e.getDistance(!0),"attr-dimension-direction":t.direction,"attr-primitive-type":[e.getPrimitiveType()]}}function rJ(t){let e=Ns.getRectBBox(t.matrix),{obbWidth:r,obbHeight:i}=Qg(t),n=Wi.transferXYByReference(e),[s,a]=te.translateByOrigin(n[0],n[1]);return{"reference-point":Wi.getReferencePoint(),"attr-x":+s.toFixed(2),"attr-y":+a.toFixed(2),"attr-width":+e.width.toFixed(2),"attr-height":+e.height.toFixed(2),"attr-obb-width":+r.toFixed(2),"attr-obb-height":+i.toFixed(2),"attr-rotation":Math.abs(t.rotation||0)}}function iJ(t){let e=un(t,"text"),r=Wi.transferXYByReference(e),[i,n]=te.translateByOrigin(r[0],r[1]),{obbWidth:s,obbHeight:a}=Qg(t);return{"reference-point":Wi.getReferencePoint(),"attr-textarea":t.name||"","attr-x":_i(i,0)?0:i,"attr-y":_i(n,0)?0:n,"attr-width":e.width,"attr-height":e.height,"attr-obb-width":s,"attr-obb-height":a,"attr-rotation":Math.abs(t.rotation||0)}}function nJ(t){let[e,r]=te.translateByOrigin(t.x1,t.y1),[i,n]=te.translateByOrigin(t.x2,t.y2),[s,a]=te.translateByOrigin(t.angleX,t.angleY);return{"attr-angle":new ga(t).calcuAngle(),"attr-dimension-angle-x":s,"attr-dimension-angle-y":a,"attr-start-x":e,"attr-start-y":r,"attr-end-x":i,"attr-end-y":n,"attr-rotation":Math.abs(t.rotation||0)}}function sJ(t){let[e,r]=te.translateByOrigin(t.x1,t.y1),[i,n]=te.translateByOrigin(t.x2,t.y2);return{"attr-start-x":e,"attr-start-y":r,"attr-end-x":i,"attr-end-y":n,"attr-rotation":Math.abs(t.rotation||0),"attr-length":new ya(t).calcLengthPixel()}}function aJ(t,e,r){let[i,n]=te.translateByOrigin(t.x,t.y),s=Ir(t.strokeStyle)?e.auxiliaryLine.dash:t.strokeStyle,a={"attr-color":t.strokeColor||`${r.auxiliaryLine}`,"attr-stroke-style":py(s).value};switch($d(t.rotation)){case"horizontal":a["attr-y"]=+n.toFixed(2);break;case"vertical":a["attr-x"]=+i.toFixed(2);break}return a}var Iy=class{getRectBBox(e){return nr.getRectBBox(e)}syncSelfObbSize(e,r,i){let n=Fe(e.gId),s=1,a=1,o=Math.round(e.rotation*100)/100*(Math.PI/180),{obbWidth:l,obbHeight:c}=Qg(e),u=Rg(n),d=Wi.transferXYByReference(u),A=new ne(d[0],d[1]);if(Ir(r)||(s=r/l),Ir(i)||(a=i/c),s===0||a===0||s===1&&a===1)return;let h=nr.createMatrixFrom6(e.tempMatrix||e.matrix),p=h.getInverseMatrix().scale(s,a).multiply3(h);switch(e.cmdKey){case"rect":vn.syncRect(e,p,{updateMatrix:!0});break;case"ellipse":tn.syncEllipse(e,p,{updateMatrix:!0});break;case"arc":ls.syncArc(e,p,{updateD:!0});break;case"obj":Ns.syncImage(e,p,{updateMatrix:!0});break;case"text":ps.syncText(e,p,{updateMatrix:!0});break;case"group":To.syncGroup(e,p,{updateD:!0});break}}};var hT=class extends Iy{constructor(){super();this.start={x:0,y:0};this.unitWidth={x:1,y:0};this.unitHeight={x:0,y:1}}getDotsForAdsorp(r){let{matrix:i,tempMatrix:n}=r,s=xr.createMatrixFrom6(n||i),a=0,o=1,l=0,c=1,u=[[a,l],[o,l],[o,c],[a,c],[.5,l],[o,.5],[.5,c],[a,.5],[.5,.5]],d=[];for(let A of u){let h=new ne(A[0],A[1]).multiply3(s);d.push(h)}return d}sync(r,i,n){let a=xr.createMatrixFrom6(r.matrix).multiply3(i),o=nr.getMatrix6FromMatrix(a);n.updateMatrix&&(r.matrix=o),r.tempMatrix=o,this.updateRectShape(Fe(r.gId),r)}syncRect(r,i,n){let s=$i.checkOne("rect",r,i);s!==!1&&$i.addCallBack(()=>{var a;s(),this.sync(r,i,n),(a=n==null?void 0:n.fn)==null||a.call(n)})}updateRectShape(r,i){let{width:n,height:s,matrixArr:a}=this.getRectFromMatrix(i.tempMatrix||i.matrix);Hi.renderer.attrs(i.gId,{width:n,height:s}),xr.updateTransform(a,r)}syncRectByRotation(r,i,n){let s=this.getRotationMatrix(r,i,n);s&&this.syncRect(i,s,{updateMatrix:!0,fn(){i.rotation=+r.toFixed(2)}})}getRotationMatrix(r,i,n){let s=i.rotation,a=Math.round((r-s)*100)/100;if(a!==0)return Ue.rotateD(a).setOrigin1(n)}getRectFromMatrix(r){let i=xr.createMatrixFrom6(r),n=new ne(this.start.x,this.start.y).multiply3(i),s=new ne(this.unitWidth.x,this.unitWidth.y).multiply3(i),a=new ne(this.unitHeight.x,this.unitHeight.y).multiply3(i),o=s.distance1(n),l=a.distance1(n),u=Ue.scale(o?1/o:1,l?1/l:1).multiply3(i),d=nr.getMatrix6FromMatrix(u);return{x:n.x,y:n.y,width:o,height:l,matrixArr:d}}syncRectPosition(r,i,n){let{x:s,y:a,width:o,height:l}=this.getRectBBox(r.matrix);i=Ir(i)||Number.isNaN(i)?s:i,n=Ir(n)||Number.isNaN(n)?a:n;let c=i-s,u=n-a;if(!c&&!u)return;let d=Ue.translate(c,u);this.syncRect(r,d,{updateMatrix:!0})}syncRectSize(r,i,n,s){let{x:a,y:o,width:l,height:c}=this.getRectBBox(r.matrix),u=1,d=1;if(Ir(n)||(u=n/l),Ir(s)||(d=s/c),u===0||d===0||u===1&&d===1)return;let A=Ue.scale(u,d).setOrigin1(i);this.syncRect(r,A,{updateMatrix:!0})}},vn=new hT;var Ts={createPath8Dots:function(t){let e=la([t],!0),{x:r,y:i,width:n,height:s}=e;return[r,i,r+n,i,r+n,i+s,r,i+s,r+n/2,i,r+n,i+s/2,r+n/2,i+s,r,i+s/2]},get(t,e="multi"){if(!t)throw new Error("err");let r=t.tagName,i=t.id;if(i==="selectBox1")return Ts.selectbox.get(t);switch(Pi(t)){case"arc":return Ts.path_arc.get(i);default:break}return Ts[r]?Ts[r].get(t,e):[]},set:function(t,e,r,i,n,s,a,o,l=!1,c=!1,u={}){let d=t.tagName;if(d=ge(t,"id")=="selectBox1"?"selectbox":d,!Ts[d])throw new Error(d);Ts[d].set(t,e,r,i,n,s,a,o,l,c,u)},selectbox:{get:function(t){let e=+ge(t,"x"),r=+ge(t,"y"),i=+ge(t,"width"),n=+ge(t,"height");return[e,r,e+i,r,e+i,r+n,e,r+n,(2*e+i)/2,r,e+i,(2*r+n)/2,(2*e+i)/2,r+n,e,(2*r+n)/2]},set:function(t,e,r,i,n,s,a,o){}},text:{get:function(t,e="multi"){let r=Jh(t)?t:te.getText(t.id),i=r.cacheWidth,n=r.cacheHeight,s=new Array,a=ne.ORIGIN;s.push(a.add1(0,-n)),s.push(a.add1(i,-n)),s.push(a.add1(i,0)),s.push(a),s.push(a.add1(i/2,-n)),s.push(a.add1(i,-n/2)),s.push(a.add1(i/2,0)),s.push(a.add1(0,-n/2));let o=xr.createMatrixFrom6(r.tempMatrix||r.matrix);if(e==="multi")return s.reduce((c,u)=>(u=u.multiply3(o),c.push(u.x,u.y),c),new Array);let l=[];for(let c=0;c<4;c++){let u=s[c];l.push([u.x,u.y])}return xr.getMaxOuterBoundingBox(l,r)},set:function(t,e,r,i,n,s,a,o,l=!1,c,u={}){let d=xr.getEightControlMatrix3(e,r,i,n,c,l,s,u),A=te.getText(t.id);ps.syncText(A,d,{updateMatrix:!1})}},g:{get:function(t){if(Pi(t)==="text")return Ts.text.get.apply(t,arguments);let r=t.getBBox(),i=r.x,n=r.y,s=r.width,a=r.height;return[i,n,i+s,n,i,n+a,i+s,n+a]},set:function(t,e,r,i,n){if(Pi(t)==="text")return Ts.text.set.apply(t,arguments);WA.g(t,i,n)}},svg:{get:function(t){return Ts.rect.get(t)},set:function(t,e,r,i,n){return Ts.rect.set(t,e,r,i,n)}},image:{get:function(t,e="multi"){let r=Jh(t)?t:te.gJsonCache.obj[t.id],i=1,n=1,s=[[0,0],[i,0],[i,n],[0,n],[i/2,0],[i,n/2],[i/2,n],[0,n/2]];if(e==="multi"){let o=xr.createMatrixFrom6(r.tempMatrix||r.matrix),l=[];for(let[c,u]of s){let d=new ne(c,u).multiply3(o);l.push(d.x,d.y)}return l}return xr.getMaxOuterBoundingBox(s.slice(0,4),r)},set:function(t,e,r,i,n,s,a,o,l=!1,c=!1,u={}){let d=te.gJsonCache.obj[t.id];if(!d)return;let A=xr.getEightControlMatrix3(e,r,i,n,c,l,s,u);Ns.syncImage(d,A,{updateMatrix:!1})}},rect:{get:function(t,e="multi"){let r=Jh(t)?t:te.getRect(t.id),{matrix:i,tempMatrix:n}=r,s=xr.createMatrixFrom6(n||i),a=0,o=1,l=0,c=1,u=[[a,l],[o,l],[o,c],[a,c],[.5,l],[o,.5],[.5,c],[a,.5]];if(e==="multi"){let d=[];for(let A of u){let h=new ne(A[0],A[1]).multiply3(s);d.push(h.x,h.y)}return d}return xr.getMaxOuterBoundingBox(u.slice(0,4),r)},set:function(t,e,r,i,n,s,a,o,l=!1,c=!1,u={}){let d=xr.getEightControlMatrix3(e,r,i,n,c,l,s,u),A=te.getRect(t.id);vn.syncRect(A,d,{updateMatrix:!1})}},circle:{get:function(t){let e=+ge(t,"cx"),r=+ge(t,"cy"),i=+ge(t,"r"),n=[e-i,r-i,e+i,r-i,e+i,r+i,e-i,r+i];return[e,r,e,r-i,e,r+i,e-i,r,e+i,r].concat(n)},set:function(t,e,r,i,n){e||(e=Ts.circle.get(t));let s={cx:e[0],cy:e[1],r:e[1]-e[3]};r===0&&(s.cx+=i,s.cy+=n),r==1&&(s.r-=n/2,s.cy+=n/2),r==2&&(s.r+=n/2,s.cy+=n/2),r==3&&(s.r-=i/2,s.cx+=i/2),r==4&&(s.cx+=i/2,s.r+=i/2),r==5&&(s.r-=i),r==6&&(s.r+=i),r==7&&(s.r+=i),r==8&&(s.r+=i),s.r!==0&&(s.r<0&&(s.r=-s.r),!(s.r<10)&&(s.cx=parseInt(String(s.cx*10))/10,s.cy=parseInt(String(s.cy*10))/10,ge(t,s)))}},ellipse:{get(t,e){let r=0,i=0,n=1,s=1,a=r-n,o=r+n,l=i-s,c=i+s,u=[[a,l],[o,l],[o,c],[a,c],[r,l],[o,i],[r,c],[a,i]],d=Jh(t)?t:te.getEllipse(t.id),{tempMatrix:A,matrix:h,rotation:f}=d,p=nr.createMatrixFrom6(A||h),m=[];for(let y of u){let g=new ne(y[0],y[1]).multiply3(p);m.push(g.x,g.y)}return m},set:function(t,e,r,i,n,s,a,o,l=!1,c=!1,u={}){let d=xr.getEightControlMatrix3(e,r,i,n,c,l,s,u),A=te.getEllipse(t.id);tn.syncEllipse(A,d,{updateMatrix:!1})}},line:{get:function(t){return[+ge(t,"x1"),+ge(t,"y1"),+ge(t,"x2"),+ge(t,"y2")]},set:function(t,e,r,i,n){e||(e=Ts.line.get(t));let s={x1:e[0],y1:e[1],x2:e[2],y2:e[3]};r===0&&(s.x1+=i,s.y1+=n),r==1&&(s.x2+=i,s.y2+=n),ge(t,s)}},polygon:{get:function(t){let e=Yf(ge(t,"points")).split(/[\s\,]+/g),r;for(r=0;r<e.length;r++)e[r]=+e[r];for(r=e.length-2;r>=2;r-=2)e.splice(r,0,(e[r-2]+e[r])/2,(e[r-1]+e[r+1])/2);return r=e.length-2,e.push((e[0]+e[r])/2,(e[1]+e[r+1])/2),e.lightDots="odd",e},set:function(t,e,r,i,n){let s=e.slice(0),a,o=2*r;for(s[o]+=i,s[o+1]+=n,r==s.length/2-1?(!_i(s[o]*2,s[0]+s[o-2])||!_i(s[o+1]*2,s[1]+s[o-1]))&&s.splice(o,0,0,0):r%2&&(!_i(s[o]*2,s[o-2]+s[o+2])||!_i(s[o+1]*2,s[o-1]+s[o+3]))&&(s.splice(o+2,0,0,0),s.splice(o,0,0,0)),o=4,a=s.slice(0,2);o<s.length-1;o+=4)a.push(s[o],s[o+1]);let l={},c=[],u;for(let b=0;b<a.length-1&&c.length<4;b+=2)u=a[b]+"_"+a[b+1],l[u]||(l[u]=!0,c.push(b));if(c.length<=2)return;let d=!0,A,h,f,p,m,y;for(r=2;r<c.length;r++)if(A=a[c[0]],h=a[c[0]+1],f=a[c[1]],p=a[c[1]+1],m=a[c[r]],y=a[c[r]+1],!_i((A-f)*(y-p),(m-f)*(h-p))){d=!1;break}if(d)return;let g={points:w_(a.join(" "))};ge(t,g)}},path:{get:function(t){let e=pb(t);if(e){let w=t.tagName+"_"+e;if(Ts[w]&&Ts[w].get)return Ts[w].get.apply(t,arguments)}let r=t.pathSegList,i=r.numberOfItems,n=0,s=0,a=[],o=0,l=0,c=[],u,d,A,h,f,p,m,y,g,b,E;for(u=0;u<i;u++)switch(A=r.getItem(u),h=A.pathSegType,u===0&&h!=Ds&&h!=ia&&h!=Ri&&a.push(n,s),d=a.length/2-1,h){case Ri:n=o,s=l;break;case Ds:if(n=A.x,s=A.y,o=n,l=s,u+1==i||(m=r.getItem(u+1),p=m.pathSegType,p==Ds||p==ia||p==Ri))break;a.push(n,s),p==ka&&a.push((n+m.x)/2,(s+m.y)/2);break;case ka:if(a.push(n=A.x,s=A.y),u+1==i)break;m=r.getItem(u+1),p=m.pathSegType,p==Ri&&(m=r.getItem(0)),(p==ka||p==Ri)&&a.push((n+m.x)/2,(s+m.y)/2);break;case rd:a.push(n=A.x,s);break;case id:a.push(n,s=A.y);break;case $h:c.push({from:d,to:d+1},{from:d+2,to:d+3}),a.push(A.x1,A.y1,n=A.x2,s=A.y2,A.x,A.y);break;case Zh:c.push({from:d+1,to:d+2}),a.push(A.x2,A.y2,n=A.x,s=A.y);break;case ed:c.push({from:d,to:d+1},{from:d+1,to:d+2}),a.push(A.x1,A.y1,n=A.x,s=A.y);break;case td:case ju:if(f=r.getItem(u-1),y=iy(f.x,f.y,A.x,A.y,A.largeArcFlag?1:0,A.sweepFlag?1:0,A.r1,A.r2,A.angle),g=y.cx,E=y.cy,b=Q0([f.x,f.y],[g,E],y.delta_theta/2),a.push(b[0],b[1]),a.push(n=A.x,s=A.y),u+1==i)break;m=r.getItem(u+1),p=m.pathSegType,p==Ri&&(m=r.getItem(0)),(p==ka||p==Ri)&&a.push((n+m.x)/2,(s+m.y)/2);break;case ia:if(n+=A.x,s+=A.y,o=n,l=s,u+1==i||(p=r.getItem(u+1).pathSegType,p==Ds||p==ia||p==Ri))break;a.push(n,s);break;case kA:a.push(n+=A.x,s+=A.y);break;case MA:a.push(n+=A.x,s);break;case FA:a.push(n,s+=A.y);break;case LA:c.push({from:d,to:d+1},{from:d+2,to:d+3}),a.push(n+A.x1,s+A.y1,n+A.x2,s+A.y2,n+=A.x,s+=A.y);break;case OA:c.push({from:d+1,to:d+2}),a.push(n+A.x2,s+A.y2,n+=A.x,s+=A.y);break;case NA:c.push({from:d+1,to:d+2}),a.push(n+A.x1,s+A.y1,n+=A.x,s+=A.y);break;case RA:case PA:a.push(n+=A.x,s+=A.y);break;default:break}if(ge(t,"drag")!="self"){let w=Ts.createPath8Dots(t);return c.length?w.c_helper_lines=c:w.lightDots="odd",w}return c.length?a.c_helper_lines=c:a.lightDots="odd",a},set:function(t,e,r,i,n,s){if(i===0&&n===0){if(s)if(Pi(t)==="arc"&&ge(t,"third-point")){let _=FC(e.join(" "));ge(t,{d:s,"third-point":_[2].x+","+_[2].y})}else ge(t,{d:s});return}let a=pb(t);if(a){let _=t.tagName+"_"+a;if(Ts[_]&&Ts[_].set){Ts[_].set.apply(t,arguments);return}}let o,l,c;if(/[^ahvqtsc]/i.test(s)){for(o=!0,l=e.slice(0),2*r+1<l.length&&(l[2*r]+=i,l[2*r+1]+=n),c=2;c<l.length-1;c+=2)if(l[c]!=l[0]||l[c+1]!=l[1]){o=!1;break}if(o)return}let u=t.pathSegList,d=u.numberOfItems,A=-1,h=r,f,p,m,y,g,b,E,w,x,I,C,G,U;if(s&&ge(t,{d:s}),e.c_helper_lines||(r=r>>1),!e.c_helper_lines&&h%2){p=u.getItem(r+1),p.pathSegType==ju?(m=u.getItem(r),g=e[h*2],b=e[h*2+1],E=D2({x:m.x,y:m.y},{x:p.x,y:p.y},{x:g+i,y:b+n}),E<4&&(E=4),E=Math.sqrt(E),w=p.sweepFlag,x=p.r1,I=sd(m.x,m.y,p.x,p.y),C=(p.x-m.x)*(b-m.y)-(g-m.x)*(p.y-m.y),G=(p.x-m.x)*(b+n-m.y)-(g+i-m.x)*(p.y-m.y),C*G<0&&(w^=1),x=I/(8*E)+E/2,U=x>E?0:1,x=Fa(x),p.r1=x,p.r2=x,p.largeArcFlag=U,p.sweepFlag=w):u.insertItemBefore(t.createSVGPathSegLinetoAbs(e[h*2]+i,e[h*2+1]+n),r+1);return}e:for(f=0;f<d;f++)switch(p=u.getItem(f),p.pathSegType){case Ri:break;case Ds:case ia:if(f+1==d||(y=u.getItem(f+1).pathSegType,y==Ds||y==ia||y==Ri))break;if(A++,A==r){p.x=Sr(p.x+i,3),p.y=Sr(p.y+n,3);break e}break;case ka:case kA:if(A++,A==r){p.x=Sr(p.x+i,3),p.y=Sr(p.y+n,3);break e}break;case rd:case MA:if(A++,A==r){p.x+=i;break e}break;case id:case FA:if(A++,A==r){p.y+=n;break e}break;case $h:case LA:if(A++,A==r){p.x1+=i,p.y1+=n;break e}if(A++,A==r){p.x2+=i,p.y2+=n;break e}if(A++,A==r){p.x+=i,p.y+=n;break e}break;case Zh:case OA:if(A++,A==r){p.x2+=i,p.y2+=n;break e}if(A++,A==r){p.x+=i,p.y+=n;break e}break;case ed:case NA:if(A++,A==r){p.x1+=i,p.y1+=n;break e}if(A++,A==r){p.x+=i,p.y+=n;break e}break;case td:case RA:case PA:if(A++,A==r){p.x+=i,p.y+=n;break e}break;case ju:if(A++,A==r){p.x+=i,p.y+=n;break e}break;default:break}}},path_group:{get:function(t,e){if(pi.is8DotsMode(t.id)){let{json:b}=te.getById(t.id);return To.getGroup8Dots({...b,d:ge(t,"d")})}let r=t.pathSegList,i=r.numberOfItems,n=0,s=0,a=[],o=0,l=0,c=[],u,d,A,h,f,p,m,y,g=new Map;for(let b=0;b<i;b++){u=r.getItem(b),d=u.pathSegType;let E=b-1>-1&&r.getItem(b-1);b===0&&d!=Ds&&d!=ia&&d!=Ri&&a.push(n,s);let w=a.length/2-1;switch(d){case Ri:n=o,s=l;break;case Ds:if(n=u.x,s=u.y,o=n,l=s,b+1==i||(h=r.getItem(b+1),A=h.pathSegType,A==Ds||A==ia||A==Ri))break;a.push(n,s),A==ka;break;case ka:if(a.push(n=u.x,s=u.y),b+1==i)break;h=r.getItem(b+1),A=h.pathSegType,A==Ri&&(h=r.getItem(0)),A==ka||A==Ri;break;case rd:a.push(n=u.x,s);break;case id:a.push(n,s=u.y);break;case $h:c.push({from:w,to:w+1,belong:w},{from:w+2,to:w+3,belong:w+3});let x=E.x===u.x1&&E.y===u.y1,I=u.x2===u.x&&u.y2===u.y;g.set(w+1,{belong:w,display:!x}),g.set(w+2,{belong:w+3,display:!I}),a.push(u.x1,u.y1,n=u.x2,s=u.y2,u.x,u.y);break;case Zh:c.push({from:w+1,to:w+2}),a.push(u.x2,u.y2,n=u.x,s=u.y);break;case ed:c.push({from:w,to:w+1,belong:w}),g.set(w+1,{belong:w,display:!0}),a.push(u.x1,u.y1,n=u.x,s=u.y);break;case td:case ju:if(E=r.getItem(b-1),f=iy(E.x,E.y,u.x,u.y,u.largeArcFlag?1:0,u.sweepFlag?1:0,u.r1,u.r2,u.angle),p=f.cx,y=f.cy,m=Q0([E.x,E.y],[p,y],f.delta_theta/2),a.push(n=u.x,s=u.y),b+1==i)break;h=r.getItem(b+1),A=h.pathSegType,A==Ri&&(h=r.getItem(0)),A==ka||A==Ri;break;case ia:if(n+=u.x,s+=u.y,o=n,l=s,b+1==i||(A=r.getItem(b+1).pathSegType,A==Ds||A==ia||A==Ri))break;a.push(n,s);break;case kA:a.push(n+=u.x,s+=u.y);break;case MA:a.push(n+=u.x,s);break;case FA:a.push(n,s+=u.y);break;case LA:c.push({from:w,to:w+1},{from:w+2,to:w+3}),a.push(n+u.x1,s+u.y1,n+u.x2,s+u.y2,n+=u.x,s+=u.y);break;case OA:c.push({from:w+1,to:w+2}),a.push(n+u.x2,s+u.y2,n+=u.x,s+=u.y);break;case NA:c.push({from:w+1,to:w+2}),a.push(n+u.x1,s+u.y1,n+=u.x,s+=u.y);break;case RA:case PA:a.push(n+=u.x,s+=u.y);break;default:break}}return c.length&&(a.c_helper_lines=c),a.isModifyAnchor=!0,a.handleIndexes=g,a},set:function(t,e,r,i,n,s,a,o,l=!1,c=!1,u){if(pi.isAnchorMode(t.id)&&!l){if(/[^ahvqtsc]/i.test(s)){let y=!0,g=e.slice(0);2*r+1<g.length&&(g[2*r]+=i,g[2*r+1]+=n);for(let b=2;b<g.length-1;b+=2)if(g[b]!==g[0]||g[b+1]!==g[1]){y=!1;break}if(y)return}let A=t.pathSegList,h=A.numberOfItems,f=-1,p,m;s&&ge(t,{d:s});e:for(let y=0;y<h;y++){let g=y-1>-1&&A.getItem(y-1),b=g.pathSegTypeAsLetter,E=A.getItem(y),w=y+1<h&&A.getItem(y+1),x=w.pathSegTypeAsLetter;switch(E.pathSegType){case Ri:break;case Ds:case ia:if(p=E,y+1==h||(m=w.pathSegType,m==Ds||m==ia||m==Ri))break;if(f++,f==r){let I=Sr(E.x+i,3),C=Sr(E.y+n,3);x==="C"&&w.x1===E.x&&w.y1===E.y&&(w.x1=I,w.y1=C),E.x=I,E.y=C;break e}break;case ka:case kA:if(f++,f==r){E.x=Sr(E.x+i,3),E.y=Sr(E.y+n,3);break e}break;case rd:case MA:if(f++,f==r){E.x+=i;break e}break;case id:case FA:if(f++,f==r){E.y+=n;break e}break;case $h:case LA:if(f++,f==r){yu.setPrevHandlePosition(E,i,n,g,u),E.x1+=i,E.y1+=n;break e}if(f++,f==r){yu.setNextHandlePosition(E,i,n,w,u),E.x2+=i,E.y2+=n;break e}if(f++,f==r){E.x=Sr(E.x+i,3),E.y=Sr(E.y+n,3),E.x2=Sr(E.x2+i),E.y2=Sr(E.y2+n),x==="C"&&(w.x1+=i,w.x1=Sr(w.x1),w.y1+=n,w.y1=Sr(w.y1)),y!==h-1&&A.getItem(y+1).pathSegType===Ri&&(p.x=E.x,p.y=E.y);break e}break;case Zh:case OA:if(f++,f==r){E.x2+=i,E.y2+=n;break e}if(f++,f==r){E.x+=i,E.y+=n;break e}break;case ed:case NA:if(f++,f==r){E.x1+=i,E.y1+=n;break e}if(f++,f==r){E.x+=i,E.y+=n;break e}break;case td:case RA:case PA:if(f++,f==r){E.x+=i,E.y+=n;break e}break;case ju:if(f++,f==r){E.x+=i,E.y+=n;break e}break;default:break}}return}let d=xr.getEightControlMatrix3(e,r,i,n,c,l,s,u);To.syncGroup(te.getById(t.id).json,d,{updateD:!1})}},path_arc2:{get:function(t){let e=[],r,i=t.getPathData();for(r=0;r<i.length;r++)if(i[r].type=="A"){let n=i[r-1].values,s=i[r].values,a=iy(n[0],n[1],s[5],s[6],s[3],s[4],s[0],s[1],s[2]),o=a.cx,l=a.cy,c=Q0([n[0],n[1]],[o,l],a.delta_theta/2),u=kC(ge(t,"d")),d=S_(u);e.push(n[0],n[1],s[5],s[6],c[0],c[1],d.x,d.y);break}return e},set:function(t,e,r,i,n,s){if(i===0&&n===0){s&&ge(t,{d:s});return}let a,o,l,c=e?e.slice(0):Ts.path_arc2.get(t);if(r===3&&(c[0]+=i,c[1]+=n,c[2]+=i,c[3]+=n),r===0&&_i(c[0]+i,c[2])&&_i(c[1]+n,c[3])||r===1&&_i(c[2]+i,c[0])&&_i(c[3]+n,c[1])||r===2&&_i((c[2]-c[0])*(c[5]+n-c[1]),(c[3]-c[1])*(c[4]+i-c[0])))return;if(r===2){if(a=D2({x:c[0],y:c[1]},{x:c[2],y:c[3]},{x:c[4]+i,y:c[5]+n}),a<4)return;a=Math.sqrt(a)}s&&ge(t,"d",s);let u=t.pathSegList.getItem(1),d=u.r1,A=+u.largeArcFlag,h=+u.sweepFlag,f=sd(c[0],c[1],c[2],c[3]),p=d*d-f/4;r==2?(o=(c[2]-c[0])*(c[5]-c[1])-(c[4]-c[0])*(c[3]-c[1]),c[r*2]+=i,c[r*2+1]+=n,l=(c[2]-c[0])*(c[5]-c[1])-(c[4]-c[0])*(c[3]-c[1]),o*l<0&&(h^=1)):(a=d+(A?1:-1)*(p>0?Math.sqrt(p):0),c[r*2]+=i,c[r*2+1]+=n,f=sd(c[0],c[1],c[2],c[3])),d=f/(8*a)+a/2,A=d>a?0:1,c[0]=Fa(c[0]),c[1]=Fa(c[1]),d=Fa(d),c[2]=Fa(c[2]),c[3]=Fa(c[3]),ge(t,"d","M"+c[0]+","+c[1]+" A"+d+","+d+" 0 "+A+" "+h+" "+c[2]+","+c[3])}},path_arc:{get(t){let{json:e}=te.getById(t),r=e.temp||e,i=ls.get8Dots2(r),n=new Bn(r),s=n.vectorCenter();if(pi.isAnchorMode(e.gId)){let a=n.getMiddleAnchor();return{cmdkey:"arc",anchor:[r.x1,r.y1,r.x2,r.y2,a.x,a.y],"solid-circle":[{x:s.x,y:s.y,type:"solid-circle"}]}}return{cmdkey:"arc",bbox:i}},set:function(t,e,r,i,n,s,a,o,l=!1,c=!1,u={}){let d=xr.getEightControlMatrix3(e,r,i,n,c,l,s,u),A=te.getById(t.id).json;ls.syncArc(A,d,{updateD:!1})}}};function oJ(t,e,r){let i=Math.abs(t),n=Math.abs(e),s=t/i,a=e/n;return[4,6].includes(r)?[s*n,a*n]:[s*i,a*i]}function HIe(t,e,r,i,n,s={}){let a=i[0],o=i[1],l=i[4],c=i[5],u=(a+l)/2,d=(o+c)/2,A=l-a,h=c-o;[1,5,2].includes(r)&&(t=-t),[2,6,3].includes(r)&&(e=-e);let f=s.ctrl?Math.abs(t)*2/A:Math.abs(t)/A,p=s.ctrl?Math.abs(e)*2/h:Math.abs(e)/h;if(f=t>0?1-f:1+f,p=e>0?1-p:1+p,A===0&&(f=1),h===0&&(p=1),n){let[b,E]=oJ(f,p,r);p=E,f=b}let m=0,y=0;switch(r){case 0:m=l,y=c;break;case 1:m=a,y=c;break;case 2:m=a,y=o;break;case 3:m=l,y=o;break;case 4:m=(a+l)/2,y=c;break;case 5:m=a,y=(o+c)/2;break;case 6:m=(a+l)/2,y=o;break;case 7:m=l,y=(o+c)/2;break}let g=Ue.scale(f,p);return g=s.ctrl?g.setOrigin(u,d):g.setOrigin(m,y),g}var xr=class t{static createMatrixFrom6([e,r,i,n,s,a]){return new Ue([e,r,0,i,n,0,s,a,1])}static createMatrix3FromDOMMatrix(e){let{a:r,b:i,c:n,d:s,e:a,f:o}=e;return new Ue([r,-i,0,-n,s,0,a,-o,1])}static getMatrixFromDOMMatrix(e){if(e.transform.baseVal.length){let r=e.transform.baseVal.getItem(0).matrix,{a:i,b:n,c:s,d:a,e:o,f:l}=r;return[i,n,s,a,o,l]}return nr.getMatrix6FromMatrix(new Ue)}static getTransformStr(e){return`matrix(${e.join(",")})`}static updateTransform(e,r){let i=this.getTransformStr(e);ge(r,"transform",i)}static getEightControlMatrix3(e,r,i,n,s=!1,a=!1,o,l={}){if(a)return[7,5].includes(r)&&(n=0),[4,6].includes(r)&&(i=0),HIe(i,n,r,o,s,l);let c={0:2,1:3,2:0,3:1,4:6,5:7,6:4,7:5},u=e[r*2],d=e[r*2+1],A=c[r],h=e[A*2],f=e[A*2+1],p=(h+u)/2,m=(f+d)/2,y=l.ctrl?new ne(p,m):new ne(h,f),g=Math.atan2(e[1]-e[3],e[0]-e[2]),b=new ne(u,d),E=new ne(i,n),w=Ue.translate(-y.x,-y.y).rotate(-g),x=b.multiply3(w),I=b.add(E).multiply3(w),C=1,G=1;if(Rt.neq(x.x,0)&&Rt.neq(I.x,0)&&(C=I.x/x.x),Rt.neq(x.y,0)&&Rt.neq(I.y,0)&&(G=I.y/x.y),s){let _=oJ(C,G,r);C=_[0],G=_[1]}return w.scale(C,G).rotate(g).translate(y.x,y.y)}static rotateDots(e,r,i,n){let s=Cz(r),a=Ue.rotate(s).setOrigin(i,n),o=[];for(let l of e){let c=new ne(l[0],l[1]).multiply3(a);o.push(c.x,c.y)}return o}static getMaxOuterBoundingBox(e,r){let i=[],n=t.createMatrixFrom6(r.tempMatrix||r.matrix);for(let m of e){let y=new ne(m[0],m[1]).multiply3(n);i.push(y)}let s=i[0].distance1(i[2]),a=i[1].distance1(i[3]),o=i[1],l=r.rotation;Rt.greatereq(s,a)&&(o=i[0]);let c=Ue.rotateD(-l).setOrigin1(o),u=new pr;for(let m of i)u=u.ext2(m.multiply3(c));let d=u.build(),A={x:d.minX,y:d.minY,width:d.width(),height:d.height()},h=[[A.x,A.y],[A.x+A.width,A.y],[A.x+A.width,A.y+A.height],[A.x,A.y+A.height],[A.x+A.width/2,A.y],[A.x+A.width,A.y+A.height/2],[A.x+A.width/2,A.y+A.height],[A.x,A.y+A.height/2]],f=[],p=Ue.rotateD(l).setOrigin1(o);for(let m of h){let y=new ne(m[0],m[1]).multiply3(p);f.push(y.x,y.y)}return f}};function u8(t,e,r={updateMatrix:!0}){let i=xr.createMatrixFrom6(t.matrix);e&&(i=i.multiply3(e));let n=nr.getMatrix6FromMatrix(i);r.updateMatrix&&(t.matrix=n),t.tempMatrix=n,xr.updateTransform(n,Fe(t.gId)),GIe(t)}var c8=class extends Iy{constructor(){super();this.start={x:0,y:0};this.center={x:.5,y:.5};this.unitWidth={x:1,y:0};this.unitHeight={x:0,y:1}}syncImage(r,i,n={updateMatrix:!0}){let s=$i.checkOne("obj",r,i);s!==!1&&$i.addCallBack(()=>{var a;s(),u8(r,i,n),(a=n.fn)==null||a.call(n)})}syncImageByRotation(r,i,n,s){let a=this.getRotationMatrix(r,i,n,s);a&&this.syncImage(i,a,{updateMatrix:!0,fn(){i.rotation=+r.toFixed(2)}})}getRotationMatrix(r,i,n,s){let{matrix:a}=i;Ir(s)&&(s=i.rotation);let o=xr.createMatrixFrom6(a),l=n||new ne(this.center.x,this.center.y).multiply3(o),c=Math.round((r-s)*100)/100;if(c)return Ue.rotateD(c).setOrigin1(l)}getImageShapeForAttr(r){let i=xr.createMatrixFrom6(r),n=new ne(this.start.x,this.start.y).multiply3(i),s=n.x,a=n.y,o=new ne(this.unitWidth.x,this.unitWidth.y).multiply3(i),l=new ne(this.unitHeight.x,this.unitHeight.y).multiply3(i),c=o.distance1(n),u=l.distance1(n);return{x:s,y:a,width:c,height:u}}syncImagePosition(r,i,n){let s=te.getObj(r.id),{x:a,y:o,width:l,height:c}=this.getRectBBox(s.matrix);i=cu(i)?i:a,n=cu(n)?n:o;let u=i-a,d=n-o;if(!u&&!d)return;let A=Ue.translate(u,d);this.syncImage(s,A,{updateMatrix:!0})}syncImageSize(r,i,n,s){let{x:a,y:o,width:l,height:c}=this.getRectBBox(r.matrix),u=1,d=1;if(Ir(n)||(u=n/l),Ir(s)||(d=s/c),u===0||d===0||u===1&&d===1)return;let A=Ue.scale(u,d).setOrigin1(i);this.syncImage(r,A,{updateMatrix:!0})}},Ns=new c8,GIe=Vd(t=>{X.messageBus.publish("panel/adsorption/updateShapeCache",[t.gId,"obj",t])},100);var WA=class t{static g(e,r,i){if(isFinite(r)||(r=0),isFinite(i)||(i=0),!e||r===0&&i===0)return;if(Pi(e)==="text"){let o=Ue.translate(r,i);ps.syncText(te.getById(e.id).json,o,{updateMatrix:!0});return}let s=e.children,a=s.length;for(let o=0;o<a;o++)$t(t,s[o].tagName)&&t[s[o].tagName](s[o],r,i)}static svg(e,r,i){isFinite(r)||(r=0),isFinite(i)||(i=0),!(!e||r===0&&i===0)&&(r!==0&&ge(e,{x:+(ge(e,"x")||0)+r}),i!==0&&ge(e,{y:+(ge(e,"y")||0)+i}))}static rect(e,r,i){if(isFinite(r)||(r=0),isFinite(i)||(i=0),!e||r===0&&i===0)return;let n=Ue.translate(r,i),s=new hT,a=te.getRect(e.id);s.sync(a,n,{updateMatrix:!0})}static text(e,r,i){isFinite(r)||(r=0),isFinite(i)||(i=0)}static image(e,r,i){if(isFinite(r)||(r=0),isFinite(i)||(i=0),!e||r===0&&i===0)return;let n=Ue.translate(r,i);u8(te.gJsonCache.obj[e.id],n)}static circle1(e,r,i){isFinite(r)||(r=0),isFinite(i)||(i=0),!(!e||r===0&&i===0)&&ge(e,{cx:+ge(e,"cx")+r,cy:+ge(e,"cy")+i})}static circle(e,r,i){if(isFinite(r)||(r=0),isFinite(i)||(i=0),!e||r===0&&i===0)return;let n=Ue.translate(r,i),s=te.getEllipse(e.id);tn.syncEllipse(s,n,{updateMatrix:!0})}static ellipse(e,r,i){t.circle(e,r,i)}static line(e,r,i){isFinite(r)||(r=0),isFinite(i)||(i=0),!(!e||r===0&&i===0)&&ge(e,{x1:+ge(e,"x1")+r,x2:+ge(e,"x2")+r,y1:+ge(e,"y1")+i,y2:+ge(e,"y2")+i})}static polyline(e,r,i){if(isFinite(r)||(r=0),isFinite(i)||(i=0),!e||r===0&&i===0)return;let n=Yf(ge(e,"points")).split(/[\s\,]+/g);for(let s=0;s<n.length-1;s+=2)n[s]=Sr(+n[s]+r,4),n[s+1]=Sr(+n[s+1]+i,4);ge(e,{points:n.join(" ")})}static polygon(e,r,i){t.polyline(e,r,i)}static path(e,r,i){if(isFinite(r)||(r=0),isFinite(i)||(i=0),!e||r===0&&i===0)return;(function(a,o){function l(d,A,h){d[A]=Sr(d[A]+h,4)}if(ge(e,"c_partid")==="arc"){let d=kL(e);d=d.map((A,h)=>h%2===0?+A+a:+A+o),ge(e,{"third-point":d[4]+","+d[5]})}let c=e.getPathData(),u=c.length;for(let d=0;d<u;d++){let A=c[d],h=A.type,f=A.values;switch(h){case"M":case"L":case"T":l(f,0,a),l(f,1,o);break;case"H":l(f,0,a);break;case"V":l(f,0,o);break;case"C":l(f,0,a),l(f,1,o),l(f,2,a),l(f,3,o),l(f,4,a),l(f,5,o);break;case"S":case"Q":l(f,0,a),l(f,1,o),l(f,2,a),l(f,3,o);break;case"A":l(f,5,a),l(f,6,o);break;default:break}}e.setPathData(c)})(r,i);let n=ge(e,"d"),s=te.getGroup(e.id);s.d=n}};function rl(t){if(t){t='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+t.trim()+"</svg>";let e=kc(t);if(e){let r=document.importNode(e.documentElement,!0);return r.removeChild(r.childNodes[0])}}console.warn(`parse fail. invalid svg.
`+t)}function Xk(t,e){let r=+t.x+t.width/2+","+(+t.y+t.height/2);return X.gCanvas.insertBefore(Hr("rect",{x:t.x,y:t.y,c_start:r,width:t.width,height:t.height,"stroke-width":1,fill:"none",stroke:"red","stroke-dasharray":"4 1","vector-effect":"non-scaling-stroke",id:"selectionBox",...e}),X.gCanvas.firstChild)}function rA(t){let e=zt.canvas.originX,r=zt.canvas.originY,i=$f.getSanpSize("X"),n=$f.getSanpSize("Y"),s=Math.round((t.x-e)/i)*i+e,a=Math.round((t.y-r)/n)*n+r;return{x:Fa(s),y:Fa(a)}}var bd;function Vg(t,e,r){if(t.length>=p_){if(!bd){let i=la(t);bd=Xk(i),rh.x=0,rh.y=0;for(let n of t)em(n,"hidden")}WA.svg(bd,e,r)}else for(let i=0;i<t.length;i++)Io.move(te.getById(t[i].id).json,e,r);return rh.x+=e,rh.y+=r,!0}function YIe(){Cr(bd),bd=null}rh.x=0;rh.y=0;function rh(t,e){if(!(!t||!t.length||!bd)){if(YIe(),e!="cancel"){t.forEach(function(n){nd(n,"hidden")});let r=rh.x,i=rh.y;for(let n=0;n<t.length;n++){let s=te.getById(t[n].id||t[n].gId).json;Io.move(s,r,i)}}eA()}}function Vk(){let t=new ih,e=te.getBBox(),r=new pr;if(r.ext1(e),!t.isHidden()){let n=t.getBBox();r.ext10(n)}let i=r.build();if(i.area()===0)return PE(zt.canvas.originX,zt.canvas.originY);{let n=ep(i);return dm(n)}}function jk(t=1){let e=pt.get()||[],[r,i]=e.reduce((s,a)=>(Pi(a)==="auxiliaryLine"?s[0].push(a):s[1].push(a),s),[[],[]]);if(r.length===e.length)return cJ(r);let n=la(i,!0);return dm(n,t)}function dm(t,e=1,r=!1,i=20){if(!t||!t.x&&!t.y&&!t.width&&!t.height)return;let n=X.gZoom;e&&!t.width&&!t.height&&(e=void 0);let s=t.x+t.width/2,a=t.y+t.height/2,o=document.body.clientWidth||9,l=document.body.clientHeight||9,c=e?Math.min((o-i)/t.width,(l-i)/t.height):n,u=e&&isFinite(c)?c*100:n*100,d=u/100;u<.1?(u=.1,d=u/100):u>X.zoomRatio.max&&(u=X.zoomRatio.max,d=u/100);let A=d!=n,h=An.getViewBox();if(h[0]=s-h[2]/2,h[1]=a-h[3]/2,An.setViewBox(h),A){let f={clientX:(s-h[0])*n,clientY:(a-h[1])*n};return r&&(u=u>180?180:u),Ay(u,f,!0)}return KL(h)}function PE(t,e){let r=An.getViewBox();return r[0]+=t-(r[0]+r[2]/2),r[1]+=e-(r[1]+r[3]/2),An.setViewBox(r),KL(r)}function yS(t){let e=An.getViewBox(),r=X.gZoom;return{x:e[0]+t.x/r,y:e[1]+t.y/r}}function FE(t){let e=An.getViewBox(),r=X.gZoom,i=(t.x-e[0])*r,n=(t.y-e[1])*r;return{clientX:i,clientY:n}}function kW(t,e=zt.adsorbGrid.gridSize,r){r=r||{x:zt.canvas.originX,y:zt.canvas.originY};let i={x:+t.x,y:+t.y},n=e,s=e,a=(t.x-r.x)%n,o=(t.y-r.y)%s;return a&&(a<0&&(a+=n),i.x+=-a+(a<n/2?0:n)),o&&(o<0&&(o+=s),i.y+=-o+(o<s/2?0:s)),i.x=Sr(i.x,2),i.y=Sr(i.y,2),i}function VIe(t,e){return{x:t.x*e.a+t.y*e.c+e.e,y:t.x*e.b+t.y*e.d+e.f}}function jIe(t,e){let r=[t.x,t.x+t.width,t.x,t.x+t.width],i=[t.y,t.y,t.y+t.height,t.y+t.height];for(let l=0,c;l<4;l++)c=VIe({x:r[l],y:i[l]},e),r[l]=c.x,i[l]=c.y;let n=Math.min.apply(0,r),s=Math.min.apply(0,i),a=Math.max.apply(0,r),o=Math.max.apply(0,i);return{x:n,y:s,width:a-n,height:o-s}}function uW(t){let e=[],r=new Map;t.forEach(n=>{e.push(...Us('[c_partid="auxiliaryLine"]',n)),e.forEach(function(s){s.style.display!=="none"&&(r.set(s,s.style.display),s.style.display="none")})});let i=la(t);return r.size&&r.forEach((n,s)=>{s.style.display=n,r.delete(s)}),i}function lJ(t){let e=Us('[c_partid="auxiliaryLine"]',t),r=new Map;e.forEach(function(n){n.style.display!=="none"&&(r.set(n,n.style.display),n.style.display="none")});let i=El(t);return r.size&&r.forEach((n,s)=>{s.style.display=n,r.delete(s)}),i}function uJ(t){let e,r;try{r=t.cloneNode(!0),X.gCanvas.appendChild(r),r.style.display="inline";let i=r.getBBox();r.style.display="",e={x:i.x,y:i.y,width:i.width,height:i.height},Cr(r)}catch{r&&(r.style.display="",Cr(r)),e={x:0,y:0,width:0,height:0}}return e}function El(t){let e,r;try{r=t.getBBox(),e={x:r.x,y:r.y,width:r.width,height:r.height}}catch{e=uJ(t)}try{!e.x&&!e.y&&!e.width&&!e.height&&Fe("root").compareDocumentPosition(t)!=20&&(e=uJ(t))}catch(i){console.log(i)}return e}function la(t,e){let r={x:0,y:0,width:0,height:0};if(!t||!t.length)return console.error(t),r;let i;for(let n=0;n<t.length;n++){if(!t[n])continue;let s=sp(t[n],e);(s.x||s.y||s.width||s.height)&&(i?(i.width=Math.max(s.x+s.width,i.x+i.width)-Math.min(s.x,i.x),i.height=Math.max(s.y+s.height,i.y+i.height)-Math.min(s.y,i.y),i.x=Math.min(s.x,i.x),i.y=Math.min(s.y,i.y)):i=s)}return i||r}function JK(t,e){let r={x:0,y:0,width:0,height:0};if(!t||!t.length)return console.error(t),r;let i=t.filter(a=>ge(a,"c_partid")!=="auxiliaryLine"),n=t.filter(a=>ge(a,"c_partid")==="auxiliaryLine"),s;for(let a=0;a<i.length;a++){if(!i[a])continue;let o=sp(i[a],e);ge(i[a],"c_partid")==="auxiliaryLine"&&(o.width=0,o.height=0),(o.x||o.y||o.width||o.height)&&(s?(s.width=Math.max(o.x+o.width,s.x+s.width)-Math.min(o.x,s.x),s.height=Math.max(o.y+o.height,s.y+s.height)-Math.min(o.y,s.y),s.x=Math.min(o.x,s.x),s.y=Math.min(o.y,s.y)):s=o)}for(let a=0;a<n.length;a++){if(!n[a])continue;let{rotation:o}=te.getAuxiliaryLine(n[a].id),l=sp(n[a],e);l.width=0,l.height=0,(l.x||l.y||l.width||l.height)&&(s?o?(s.width=Math.max(l.x+l.width,s.x+s.width)-Math.min(l.x,s.x),s.x=Math.min(l.x,s.x)):(s.height=Math.max(l.y+l.height,s.y+s.height)-Math.min(l.y,s.y),s.y=Math.min(l.y,s.y)):s=l)}return s||r}function _h(t,e,r){if(!t||!t[0])return{x:0,y:0};if(bd){let s=bd.getBBox();return{x:s.x+s.width/2,y:s.y+s.height/2}}let i=la(t,e),n={x:Fa(i.x+i.width/2),y:Fa(i.y+i.height/2)};return(!r||!r.ignoreSnap)&&(n=rA(n)),n}function l8(t){let{matrix:e,tempMatrix:r}=t,[i,n,s,a,o,l]=r||e,c=Math.atan2(s,i),u=Math.atan2(a,n),d=Math.cos(c),A=Math.sin(c),h=Math.abs(i*d+s*A);d=Math.cos(u),A=Math.sin(u);let f=Math.abs(n*d+a*A);return{x:o-h,y:l-f,width:h*2,height:f*2}}function sT(t){let{matrix:e,tempMatrix:r}=t,i=xr.createMatrixFrom6(r||e),n=0,s=1,a=0,o=1,l=[[n,a],[s,a],[s,o],[n,o]],c=new pr;for(let d of l){let A=new ne(d[0],d[1]).multiply3(i);c.ext6(A.x,A.y)}let u=c.build();return{x:u.minX,y:u.minY,width:u.width(),height:u.height()}}function aW(t){let e=Jn(t.d),r=new pr;for(let n of e)r.ext1(n.multiply3(Ue.MIRROR_Y).bbox());let i=r.build();return{x:i.minX,y:i.minY,width:i.width(),height:i.height()}}function Ab(t){let e=xr.createMatrixFrom6(t.tempMatrix||t.matrix),r=new pr().ext6(0,0).ext6(t.cacheWidth,-t.cacheHeight).build().transform(e);return{x:r.minX,y:r.minY,width:r.width(),height:r.height()}}function Rg(t){let e,{cmdKey:r,json:i}=te.getById(t.id);switch(r){case"ellipse":return l8(i);case"arc":return new Bn(i.temp||i).bbox();case"obj":case"rect":return sT(i);case"group":return El(t)||yP(i);case"text":return Ab(i);case"dimensionLength":case"dimensionAngle":case"dimensionRadius":case"auxiliaryPoint":case"auxiliaryLine":return un(i,r)}if(t.tagName!="g"){let a=t.style.display;return t.style.display="inline !important",t.tagName=="path"?e=hJ(t):e=El(t),t.style.display=a,e}else e=El(t);if(!e.width&&!e.height||e.x||e.y)return e;function n(a){let o=window.getComputedStyle&&getComputedStyle(a);return!o||o.display=="none"}function s(a){let o=a.children||[].filter.call(a.childNodes,function(c){return c.nodeType===1}),l;for(let c=0,u,d=o.length,A;c<d;c++)if(A=o[c],!(ge(A,"display")=="none"||A.style.display=="none"||n(A))){try{if(u=A.getBBox(),!u.width&&!u.height&&!u.x&&!u.y)continue}catch{continue}if(A.tagName=="g"?u=s(A):A.tagName=="path"&&(u=hJ(A)),u&&(u.width||u.height)){if(ge(A,"transform"))try{let h=A.getTransformToElement(a);u=jIe(u,h)}catch{}l=l?gz(l,u):u}}return l||{x:0,y:0,width:0,height:0}}return e=s(t),!e.width&&!e.height&&(e=lJ(t)),e}function hJ(t,e){let r=El(t),i,n;return!r.width&&!r.height&&!r.x&&!r.y?ge(t,"d")?(i=t.getPointAtLength(0),{x:i.x,y:i.y,width:0,height:0}):{x:0,y:0,width:0,height:0}:r}function sp(t,e){let r=Rg(t);return r.x=Fa(r.x),r.y=Fa(r.y),r.width=Fa(r.width),r.height=Fa(r.height),r}function pb(t){if(!t||t.tagName!="path")return;if(ge(t,"c_partid")==="group")return"group";let e=t.pathSegList,r=e.numberOfItems,i="";for(let n=0;n<r&&n<5;n++)i+=e.getItem(n).pathSegTypeAsLetter;if(i=="MA"){if(ge(t,"c_partid")==="arc")return"arc";if(ge(t,"c_partid")==="earc")return"earc"}else if(/^(?:MALZ|MLAZ|MLLAZ?)$/.test(i))return"pie"}function kL(t){if(ge(t,"c_partid")==="arc"&&ge(t,"third-point")){let e=t.getPathData(),r=ge(t,"third-point").split(",");return[].concat(e[0].values,e[1].values.slice(-2),+r[0],+r[1])}console.error("Invalid input, e needs to be arc!")}function h8(t){return t.pathSegTypeAsLetter}function dJ(t){return{M:1,L:1,H:1,V:1,A:1,T:1,S:2,Q:2,C:3,Z:0}[t.toUpperCase()]||0}function QIe(t,e,r){let i=t.numberOfItems;for(let n=r;n<i;n++){let s=h8(t.getItem(n));if(s=="M"||s=="m")return n>r?-1:n;if(s==e)return n}return-1}function yK(t,e){if(!t||t.tagName!="path"||isNaN(e)||e<0||!pb(t))return;let i=Ts.get(t),n=t.pathSegList,s=n.numberOfItems,a=-1;for(let o=0;o<s;o++){let l=o-1>-1?n.getItem(o-1):"",c=n.getItem(o),u=h8(c),d,A=o+1<s?n.getItem(o+1):"",h=o+1<s?h8(A):"",f,p=dJ(u),m=h?dJ(h):0;if(!(u.toUpperCase()=="M"&&(!h||h.toUpperCase()=="M"||h=="Z"))&&(a+=p,!(a<e)))switch(u.toUpperCase()){case"M":f=a+m,u=="M"?(c.x=i[f*2],c.y=i[f*2+1]):(c.x+=i[f*2]-i[a*2],c.y+=i[f*2+1]-i[a*2+1]);let y=QIe(n,"Z",o+1);y>=0&&(d=t.createSVGPathSegLinetoAbs(i[a*2],i[a*2+1]),n.replaceItem(d,y)),n.removeItem(o+1);return;case"L":case"H":case"V":case"T":case"A":n.removeItem(o);return;case"S":case"Q":n.removeItem(o);return;case"C":switch(u+h){case"C":{if(a===e){n.removeItem(o);return}if(a-1===e){c.x2=c.x,c.y2=c.y;return}if(a-2===e){c.x1=l.x,c.y1=l.y;return}break}case"CC":{if(a===e){A.x1=l.x,A.y1=l.y,n.removeItem(o);return}if(a-1===e){c.x2=c.x,c.y2=c.y;return}if(a-2===e){c.x1=l.x,c.y1=l.y;return}break}case"CL":{if(a-2===e){c.x1=l.x,c.y1=l.y;return}if(a-1===e){c.x2=c.x,c.y2=c.y;return}if(a===e){n.removeItem(o);return}break}case"CS":c.x2=i[(a+1)*2],c.y2=i[(a+1)*2+1],n.removeItem(o+1);return;case"Cc":A=n.getItem(o+1),A.x1=i[(a-2)*2]-i[(a-3)*2],A.y1=i[(a-2)*2+1]-i[(a-3)*2+1],A.x2=i[(a+2)*2]-i[(a-3)*2],A.y2=i[(a+2)*2+1]-i[(a-3)*2+1],A.x=i[(a+3)*2]-i[(a-3)*2],A.y=i[(a+3)*2+1]-i[(a-3)*2+1],n.removeItem(o);return;case"Cs":d=t.createSVGPathSegCurvetoCubicRel(i[f*2-2],i[f*2-1],void 0,void 0,void 0,void 0),d.x1=i[(a-2)*2]-i[(a-3)*2],d.y1=i[(a-2)*2+1]-i[(a-3)*2+1],d.x2=i[(a+2)*2]-i[(a-3)*2],d.y2=i[(a+2)*2+1]-i[(a-3)*2+1],d.x=i[(a+3)*2]-i[(a-3)*2],d.y=i[(a+3)*2+1]-i[(a-3)*2+1],n.replaceItem(d,o),n.removeItem(o+1);return;case"cC":case"cS":case"cc":case"cs":n.removeItem(o);break;default:n.removeItem(o);break}return;default:return}}}var ri=class ri extends my{static getDefaultGJsonCache(){return{head:{originX:0,originY:0,title:"",display_title:"",name:"",docType:si.PANEL,layer:1,width:"",height:"",desc:"",maxId:0,material:"PVC"},itemOrder:[],BBox:{x:0,y:0,width:0,height:0},group:{},obj:{},rect:{},text:{},ellipse:{},arc:{},auxiliaryLine:{},auxiliaryPoint:{},combination:{},_runtime:{}}}static getBBox(){let e=new pr;return ri.iterator((r,i,n)=>{if(!["combination","auxiliaryLine","_runtime"].includes(i))try{let s=un(r,i);e.ext1(Mr.extendRect(s))}catch(s){console.log(s,i)}}),e.valid()||e.ext1(new Mr(0,0,0,0)),ri.iteratorAuxiliaryLine(r=>{let i=e.build();r.rotation===90&&!i.isContainsX(r.x)&&e.ext6(r.x,i.maxY),r.rotation===0&&!i.isContainsY(r.y)&&e.ext6(i.minX,r.y)}),e.build()}static getGJsonCache(e=!1){e&&this.iterator((i,n)=>{if(n!=="combination")switch(i.displayVisible=!rn.eleIsHide(i),i.cmdKey){case"text":break;default:i.d=lb(i);break}});let r=this.getBBox();return this.gJsonCache.BBox={x:r.minX,y:r.minY,width:r.width(),height:r.height()},this.gJsonCache}static getHead(){return this.gJsonCache.head}static setHead({width:e,height:r}){return this.gJsonCache.head.width=e,this.gJsonCache.head.height=r,this}static exchangeJsonCache(e){let r=this.gJsonCache;this.gJsonCache=e,this.id2cmd.clear();let i=setTimeout(()=>{Zn("you need exchange back")},1e3);return()=>{this.gJsonCache=r,clearTimeout(i)}}static buildId2CmdData(){this.iterator((e,r,i)=>{this.id2cmd.set(e.gId||i,r)})}static getById(e){let r=this.id2cmd.get(e);return!r&&(this.buildId2CmdData(),r=this.id2cmd.get(e),!r)?(console.error(e,r,"Plz check code."),{json:null,cmdKey:""}):{json:this.CmdKeyMethodMap[r](e),cmdKey:r}}static getJsonCacheByIds(e){let r=new Set,i=new gr,n=Object();for(let a of e){let o=i.searchCombination(a);o&&r.add(o)}let s=new gr().getAllCombinationData([...r]);for(let a of s)ts(n,"combination")[a.gId]=a;return e.forEach(a=>{let{json:o,cmdKey:l}=ri.getById(a);ts(n,l)[a]=o}),n}static updatePrimitiveJson(e,r,i){let{json:n,cmdKey:s}=this.getById(e);n[r]=i,this.changedJsoncache(e,s)}static getDimension(e){let r=ts(ri.gJsonCache,"dimension");return e?r[e]||{}:r}static getDimensionLength(e){let r=ts(ri.gJsonCache,"dimensionLength");return e?r[e]||{}:r}static getDimensionRadius(e){let r=ts(ri.gJsonCache,"dimensionRadius");return e?r[e]||{}:r}static getDimensionAngle(e){let r=ts(ri.gJsonCache,"dimensionAngle");return e?r[e]||{}:r}static getRect(e){let r=ts(ri.gJsonCache,"rect");return e?r[e]||{}:r}static insertOneData(e,r,i){switch(r){case"obj":ri.setObj(e,i);break;case"group":ri.setGroup(e,i);break;case"ellipse":ri.setEllipse(e,i);break;case"rect":ri.setRect(e,i);break;case"text":ri.setText(e,i);break;case"auxiliaryLine":ri.setAuxiliaryLine(e,i);break;case"auxiliaryPoint":ri.setAuxiliaryPoint(e,i);break;case"arc":this.setArc(e,i);break;case"dimensionLength":case"dimensionRadius":case"dimensionAngle":this.setDimension(e,i,r);break;default:console.error(r,"check code");break}return this}static setRect(e,r){let i=ts(ri.gJsonCache,"rect");if(!r||Kr(r)){Reflect.deleteProperty(i,e),this.changedJsoncache(e,"rect");return}return i[e]=r,this.changedJsoncache(e,"rect"),r}static getArc(e){let r=ts(ri.gJsonCache,"arc");return e?r[e]||Object.create(null):r}static setArc(e,r){let i=ts(ri.gJsonCache,"arc");return!r||Kr(r)?delete i[e]:i[e]=r,this.changedJsoncache(e,"arc"),this}static getEllipse(e){let r=ts(ri.gJsonCache,"ellipse");return e?r[e]||Object.create(null):r}static setEllipse(e,r){let i=ts(ri.gJsonCache,"ellipse");if(!r||Kr(r)){Reflect.deleteProperty(i,e),this.changedJsoncache(e,"ellipse");return}return i[e]=r,this.changedJsoncache(e,"ellipse"),r}static setDimension(e,r,i="dimension"){let n=ts(ri.gJsonCache,i);return!r||Kr(r)?Reflect.deleteProperty(n,e):n[e]=r,this.changedJsoncache(e,i),this}static getCombination(e){let r=ts(ri.gJsonCache,"combination");return e?r[e]||Object.create(null):r}static deleteCombInParent(e){let i=new gr().findParent(e);return i&&i.combinations.splice(i.combinations.indexOf(e),1),this}static setCombination(e,r){let i=ts(ri.gJsonCache,"combination");if(!r||Kr(r)){Reflect.deleteProperty(i,e);return}i[e]=r}static getAuxiliaryLine(e){let r=ts(ri.gJsonCache,"auxiliaryLine");return e?r[e]||Object.create(null):r}static setAuxiliaryLine(e,r){let i=ts(ri.gJsonCache,"auxiliaryLine");if(!r||Kr(r)){Reflect.deleteProperty(i,e),this.changedJsoncache(e,"auxiliaryLine");return}return i[e]=r,this.changedJsoncache(e,"auxiliaryLine"),r}static getAuxiliaryPoint(e){let r=ts(ri.gJsonCache,"auxiliaryPoint");return e?r[e]||Object.create(null):r}static setAuxiliaryPoint(e,r){let i=ts(ri.gJsonCache,"auxiliaryPoint");if(!r||Kr(r)){Reflect.deleteProperty(i,e),this.changedJsoncache(e,"auxiliaryPoint");return}return i[e]=r,this.changedJsoncache(e,"auxiliaryPoint"),r}static getRuntime(e){let r=ts(ri.gJsonCache,"_runtime");return e?r[e]||{}:r}static setRuntime(e,r){let i=ts(ri.gJsonCache,"_runtime");if(!r||Kr(r)){Reflect.deleteProperty(i,e);return}return i[e]=r,r}static getText(e){let r=ts(ri.gJsonCache,"text");return e?r[e]||{}:r}static setText(e,r){let i=ts(ri.gJsonCache,"text");if(!r||Kr(r)){Reflect.deleteProperty(i,e),this.changedJsoncache(e,"text");return}return i[e]=r,this.changedJsoncache(e,"text"),r}static getObj(e){let r=ts(ri.gJsonCache,"obj");return e?r[e]||{}:r}static setObj(e,r){let i=ts(ri.gJsonCache,"obj");if(!r||Kr(r)){Reflect.deleteProperty(i,e),this.changedJsoncache(e,"obj");return}return this.changedJsoncache(e,"obj"),i[e]=r,r}static getGroup(e){let{group:r={}}=ri.gJsonCache;return e?r[e]||{}:r}static setGroup(e,r){let i=ts(ri.gJsonCache,"group");if(!r||Kr(r)){Reflect.deleteProperty(i,e),this.changedJsoncache(e,"group");return}return i[e]=r,this.changedJsoncache(e,"group"),r}static removeMultiData(e){let r=new Set;for(let i of e){let n=i.id;r.add(n),this.removeOne({id:n})}this.removeItemOrder(r)}static removeOne(e){var o;if(!e){console.error("Plz check code");return}let r=e.id,i=this.getById(r).cmdKey,s=new gr().searchCombination(r);if(s){let l=ri.getCombination(s);l.elements.splice(l.elements.indexOf(r),1)}let a=ri.gJsonCache[i];a&&a[r]&&(delete a[r],this.changedJsoncache(r,i)),(o=Hi.renderer)==null||o.removeNode(r),Jr.removeShapeCache(r)}static freshItemOrder(){let e=mz().filter(r=>ri.getById(r).json);return ri.gJsonCache.itemOrder=e,this}static removeItemOrder(e){let r=[];for(let i of this.getItemOrder())e.has(i)||r.push(i);this.gJsonCache.itemOrder=r}static getItemOrder(){let e=ri.gJsonCache.itemOrder;return vi(e)}static getItemOrderMap(){let e=0,r=new Map;for(let i of this.gJsonCache.itemOrder)r.set(i,e++);return r}static getItemOrderSortMap(){let e=this.getItemOrder(),r=new Map;for(let i=0;i<e.length;i++)r.set(e[i],i);return r}static changedJsoncache(e,r){let i=ri.gJsonCache[r][e];!i||Kr(i)?Jr.removeShapeCache(e):Jr.updateShapeCache(e,r,i),rs.updateHole(),ca.updateMeasureValue()}static iterator(e){this.iteratorEllipse(e),this.iteratorArc(e),this.iteratorRect(e),this.iteratorGroup(e),this.iteratorObj(e),this.iteratorText(e),this.iteratorAuxiliaryLine(e),this.iteratorAuxiliaryPoint(e),this.iteratorDimension(e),this.iteratorDimensionLength(e),this.iteratorDimensionAngle(e),this.iteratorDimensionRadius(e),this.iteratorCombination(e),this.iteratorRuntime(e)}static iteratorRuntime(e){let r=this.getRuntime();for(let i in r)e(r[i],"_runtime",i)}static iteratorText(e){let r=this.getText();for(let i in r)e(r[i],"text",i)}static iteratorObj(e){let r=this.getObj();for(let i in r)e(r[i],"obj",i)}static iteratorRect(e){let r=this.getRect();for(let i in r)e(r[i],"rect",i)}static iteratorArc(e){let r=this.getArc();for(let i in r)e(r[i],"arc",i)}static iteratorEllipse(e){let r=this.getEllipse();for(let i in r)e(r[i],"ellipse",i)}static iteratorAuxiliaryPoint(e){let r=this.getAuxiliaryPoint();for(let i in r)e(r[i],"auxiliaryPoint",i)}static iteratorGroup(e){let r=this.getGroup();for(let i in r)e(r[i],"group",i)}static iteratorAuxiliaryLine(e){let r=this.getAuxiliaryLine();for(let i in r)e(r[i],"auxiliaryLine",i)}static iteratorDimension(e){let r=this.getDimension();for(let i in r)e(r[i],"dimension",i)}static iteratorDimensionLength(e){let r=this.getDimensionLength();for(let i in r)e(r[i],"dimensionLength",i)}static iteratorDimensionRadius(e){let r=this.getDimensionRadius();for(let i in r)e(r[i],"dimensionRadius",i)}static iteratorDimensionAngle(e){let r=this.getDimensionAngle();for(let i in r)e(r[i],"dimensionAngle",i)}static iteratorCombination(e){let r=this.getCombination();for(let i in r)if(e(r[i],"combination",i)===_c)break}static getAllAssistPrimitive(){let e={};for(let i of["auxiliaryLine","auxiliaryPoint","dimension","dimensionAngle","dimensionLength","dimensionRadius"])e[i]=!0;let r=[];return ri.iterator(i=>{e[i.cmdKey]&&r.push(i.gId)}),r}static getRefId(e){let r=this.freshItemOrder().getItemOrder(),i=r.length;for(let n=0;n<i;n++)if(e===r[n])return r[n+1]||""}static translateByOrigin(e,r){let{originX:i,originY:n}=ri.gJsonCache.head,[s,a]=[+e-(i||0),+r-(n||0)];return[_i(s,0)?0:+s,_i(a,0)?0:+a]}static getShapeAttr(e,r){let i=X.panelThemeCache.color,n=X.panelThemeCache.shape,s=X.panelThemeCache.fontStyle,a=X.panelThemeCache.fillColor,o={type:r,"attr-topic":Fn[r],"attr-id":"$"+e.id,"attr-name":e.name||"","attr-layer":e.layer};if($t(e,"locked")&&(o["attr-locked"]=e.locked===!0?"yes":"no"),$t(e,"hide")&&(o["attr-hide"]=e.hide===!0?"yes":"no"),$t(e,"visible")&&(o["attr-conceal"]=e.visible===!0?"no":"yes"),+e.layer===2){let d=Math.round(e.transparencyPrint*100),A=Math.round(e.transparencyWhite*100);o["attr-transparency"]=d+"%,"+A+"%"}let l={};switch(r){case"text":{e.type="text";let d=iJ(e);delete o["attr-name"],Object.assign(o,d,c(e)),+e.layer===2&&delete o["attr-font-color"];break}case"rect":{let{x:d,y:A,width:h,height:f}=vn.getRectBBox(e.matrix),{obbWidth:p,obbHeight:m}=Qg(e),y=Wi.transferXYByReference({x:d,y:A,width:h,height:f}),[g,b]=this.translateByOrigin(y[0],y[1]),E=AO(e,n,r);Object.assign(o,{"reference-point":Wi.getReferencePoint(),"attr-width":h,"attr-height":f,"attr-obb-width":p,"attr-obb-height":m,"attr-x":g,"attr-y":b,"attr-radius":e.rx||0,"attr-rotation":Math.abs(e.rotation||0)},E)}break;case"ellipse":{Object.assign(o,eJ(e),AO(e,n,r));break}case"group":{let d=El(Fe(e.gId)),{obbWidth:A,obbHeight:h}=Qg(e),f=Wi.transferXYByReference(d),[p,m]=ri.translateByOrigin(f[0],f[1]);Object.assign(o,{"reference-point":Wi.getReferencePoint(),"attr-width":d.width,"attr-height":d.height,"attr-obb-width":A,"attr-obb-height":h,"attr-x":+p.toFixed(2),"attr-y":+m.toFixed(2),"attr-rotation":Math.abs(e.rotation||0)},AO(e,n,r));break}case"obj":{l=rJ(e);break}case"dimension":l=tJ(e);break;case"auxiliaryLine":{l=aJ(e,n,i);break}case"auxiliaryPoint":{let[d,A]=ri.translateByOrigin(e.x,e.y),h=Uk[r];l={"attr-color":e.fillColor||`${a[h]}`,"attr-x":+d.toFixed(2),"attr-y":+A.toFixed(2)};break}case"combination":{let d=e,A=new gr().getAllElesfromTop(d.gId).elements,h=Array.from(A).map(g=>Fe(g)),f=la(h),p=Wi.transferXYByReference(f),[m,y]=ri.translateByOrigin(p[0],p[1]);l={"reference-point":Wi.getReferencePoint(),"attr-name":d.name,"attr-x":m,"attr-y":y,"attr-width":f.width,"attr-height":f.height,"attr-rotation":0};break}case"dimensionLength":{l=sJ(e);break}case"dimensionAngle":{l=nJ(e);break}case"dimensionRadius":{let d=e,[A,h]=ri.translateByOrigin(d.x1,d.y1),[f,p]=ri.translateByOrigin(d.x2,d.y2),{rx:m,ry:y}=new ca(d).getRxRyPixel();l={"attr-start-x":A,"attr-start-y":h,"attr-end-x":f,"attr-end-y":p,"attr-long-radius":m,"attr-short-radius":y,"attr-rotation":Math.abs(d.rotation||0)};break}case"arc":{l=ZK(e),Object.assign(l,AO(e,n,r));break}default:console.error(r);break}function c(d){let A=d.type,h=s[A];return{"attr-font-color":d.strokeColor||d.fillColor,"attr-font-family":d.fontFamily,"attr-font-weight":d.fontWeight?"bold":"normal","attr-font-size":d.fontSize,"attr-font-style":d.italic==null?`${py(h.fontItalic).text}`:d.italic?"italic":"normal","attr-font-underline":d.underline==null?`${QW(h.fontUnderline).text}`:d.underline?"underline":"inherit","attr-origin":u(d)}}function u(d){let A=!1;$t(d,"hAlign")||(d.hAlign=0),$t(d,"vAlign")||(d.vAlign=2),$t(d,"vAlign")&&d.vAlign===null&&(A=!0);let h=d.hAlign+""+(A?0:d.vAlign),f="";switch(h){case"00":f="start|0";break;case"01":f="start|1";break;case"02":f="start|2";break;case"10":f="middle|0";break;case"11":f="middle|1";break;case"12":f="middle|2";break;case"20":f="end|0";break;case"21":f="end|1";break;case"22":f="end|2";break}return A&&f==="start|0"&&f||f}return Object.assign(o,l)}static getProductWidthHeight(){let{width:e,height:r,originX:i,originY:n}=this.gJsonCache.head;e||(e=JS.width),r||(e=JS.height);try{let a=[],o=ti(e,"pixel"),l=ti(r,"pixel"),c=Mr.extendRect({x:0,y:-l,width:o,height:l});ri.iterator((p,m)=>{p.layer===3&&c.isIntersect(bP(p,m))&&a.push(p)});let u=xP(a),d=Mr.extendRect(u),A=c.intersection1(d),h=ti(A.width(),"pixel","mm"),f=ti(A.height(),"pixel","mm");return{width:s(h),height:s(f)}}catch{return{width:e,height:r}}function s(a){return Math.round(a*100)/100+"mm"}}};ri.gJsonCache={head:{originX:0,originY:0,title:"",display_title:"",name:"",docType:si.PANEL,layer:1,width:"",height:"",desc:"",maxId:0,material:"PVC"},itemOrder:[],BBox:{x:0,y:0,width:0,height:0},group:{},obj:{},rect:{},text:{},ellipse:{},arc:{},auxiliaryLine:{},auxiliaryPoint:{},combination:{},_runtime:{}},ri.id2cmd=new Map,ri.CmdKeyMethodMap={text:e=>ri.getText(e),obj:e=>ri.getObj(e),rect:e=>ri.getRect(e),group:e=>ri.getGroup(e),ellipse:e=>ri.getEllipse(e),arc:e=>ri.getArc(e),combination:e=>ri.getCombination(e),dimension:e=>ri.getDimension(e),dimensionLength:e=>ri.getDimensionLength(e),dimensionRadius:e=>ri.getDimensionRadius(e),dimensionAngle:e=>ri.getDimensionAngle(e),auxiliaryLine:e=>ri.getAuxiliaryLine(e),auxiliaryPoint:e=>ri.getAuxiliaryPoint(e),_runtime:e=>ri.getRuntime(e)};var te=ri;function AO(t,e,r){let i=Uk[r];i="ellipse"===i||"group"===i?"circle":i;let n=t.strokeStyle==null?e[i].dash:t.strokeStyle,s=t.strokeWidth==null?e[i].width:t.strokeWidth,a={"attr-stroke-color":t.strokeColor||"none","attr-fill-color":t.fillColor||"none","attr-stroke-width":`${s||0}`,"attr-stroke-style":py(n).value,type:i,"attr-fill-color-display":t.displayFill,"attr-stroke-color-display":t.displayStroke};return Wi.filterAttrByLayer(a,t.layer),a}window.frameElement&&window.addEventListener("unload",()=>{var t;(t=te.compilerManager)==null||t.destroy()});var d8=class{constructor(){this.taskQueue=[];this.timeId=null}run(e,r,i){this.taskQueue.push(this.createTask(e,r,i)),clearTimeout(this.timeId),this.timeId=setTimeout(()=>{this.walker()},0)}createTask(e,r,i){return()=>{let n=Fe(r),s=te.getById(r).json;for(let a in e){let o=e[a];switch(te.updatePrimitiveJson(r,a,o),a){case"matrix":this.updateMatrix(n,i,o);break;case"cacheHeight":case"cacheWidth":case"name":case"key":case"tempMatrix":case"rotation":break;case"d":this.updateD(n,i,o);break;case"start":case"end":{let l=te.getDimension(r),c=new Ua(l).render();c=null}break;case"x":{this.updateX(n,i,o);break}case"y":{this.updateY(n,i,o);break}case"rx":ge(n,"rx",o);break;case"ry":ge(n,"ry",o);break;case"layer":ge(n,"layer",o);break;case"category":this.updateCategory(n,i,o);break;case"cover":break;case"hide":ge(n,"hide",o?"1":"0");break;case"locked":break;case"opacity":break;case"scope":break;case"fillColor":case"displayFill":nT(s);break;case"displayStroke":case"strokeColor":iT(n,i,s);break;case"strokeWidth":$k(n,i,o);break;case"transparencyWhite":case"transparencyPrint":{let l=te.getById(n.id).json,c=+e["attr-transparency-print"]||l.transparencyPrint,u=+e["attr-transparency-white"]||l.transparencyWhite,d=db(c*100,u*100);ge(n,"opacity",d);break}case"x1":case"y1":case"x2":case"y2":case"measureX1":case"measureX2":case"measureY1":case"measureY2":this.updateX1(n.id);break;case"textX":case"textY":case"angleX":case"angleY":this.updateTextX(n.id);break;case"visible":rn.applyElementsVisible(r);break;case"tempD":break;case"strokeStyle":this.updateStrokeStyle(s);break;default:console.error(a);break}}i==="auxiliaryLine"?new dd(s).render():i==="arc"&&new Bn(s).render(),te.compilerManager.uploadData(r)}}updateStrokeStyle(e){switch(e.cmdKey){case"auxiliaryLine":Hi.renderer.attr(e.gId,"stroke-dasharray",Ba.lineStyle[e.strokeStyle]);break;default:console.error(e.cmdKey,e);break}}updateMatrix(e,r,i){switch(r){case"ellipse":{let{rx:o,ry:l,matrixArr:c}=tn.getEllipseFromMatrix(i);ge(e,{rx:o,ry:l}),xr.updateTransform(c,e)}break;case"rect":let{width:n,height:s,matrixArr:a}=vn.getRectFromMatrix(i);ge(e,{width:n,height:s}),xr.updateTransform(a,e);break;case"obj":case"text":xr.updateTransform(i,e);break;case"dimension":case"group":case"dimensionRadius":break;default:throw console.error(e,r),new Error(e);break}}updateD(e,r,i){switch(r){case"text":e=e.querySelector("path"),ge(e,"d",i);break;case"group":ge(e,"d",i);break;default:console.error("err");break}}updateX1(e){let{json:r,cmdKey:i}=te.getById(e);switch(i){case"dimensionLength":new ya(r).render();break;case"dimensionAngle":new ga(r).render();break;case"dimensionRadius":new ca(r).render();break;case"arc":new Bn(r).render();break;default:console.error(i,"not handle x1");break}}updateTextX(e){let{json:r,cmdKey:i}=te.getById(e);switch(i){case"dimensionAngle":new ga(r).render();break;case"dimensionRadius":new ca(r).render();break;default:throw new Error(i)}}updateX(e,r,i){switch(r){case"auxiliaryLine":{let n=e.x1.animVal.value,s=e.x2.animVal.value,a=i-(n+s)/2;e.setAttribute("x1",String(n+a)),e.setAttribute("x2",String(s+a));break}case"auxiliaryPoint":{e.setAttribute("cx",String(i));break}default:console.error(e,r,i)}}updateY(e,r,i){switch(r){case"auxiliaryLine":{let n=e.y1.animVal.value,s=e.y2.animVal.value,a=i-(n+s)/2;e.setAttribute("y1",String(n+a)),e.setAttribute("y2",String(s+a));break}case"auxiliaryPoint":{e.setAttribute("cy",String(i));break}default:throw new Error("err")}}updateCategory(e,r,i){switch(r){case"dimension":ge(e,"category",i);break;default:throw new Error("err")}}diff(e,r){let i=Object.create(null);for(let n in r){let s=r[n];PC(s,e[n])||(i[n]=s)}for(let n in e){let s=r[n];PC(s,e[n])||(i[n]=s)}return i}walker(){let e=500;for(;this.taskQueue.length&&e;)this.taskQueue.shift()(),e--,e===0&&setTimeout(this.walker.bind(this),17)}},UE=new d8;var A8=0,bi=class bi{static checkBatchStateIsCorrect(){this.batchState!==A8&&Zn(A8,this.batchState)}static save(e){if(!Array.isArray(e)||e.length===0)throw Et("reportError",[new Error("History.save :: first argument is not an array")]),console.error(e),new Error("err");if(bi.batchState){Array.isArray(e)&&Array.isArray(e[0])?[].push.apply(bi.queueBatchRecords,e):bi.queueBatchRecords.push(e);return}bi.index.value>=bi.maxLength-1?(bi.records.shift(),bi.savedIndex>-1&&(bi.savedIndex-=1)):bi.index.value++,bi.timestamps[bi.index.value]=Date.now(),te.freshItemOrder(),this.handleSelected("redo",e),te.compilerManager.resumeDataMerge(),te.compilerManager.uploadHistoryData(e),bi.records[bi.index.value]=e,bi.records.length=bi.index.value+1,ba("triggerEvent",["history_change",{tabId:X.tabId},bi.records.length,bi.index.value,!0])}static startBatch(){return this.checkBatchStateIsCorrect(),this.batchState++,this.jsonSnap=new qi,this.cancelSaveBatch.bind(this)}static cancelSaveBatch(){this.batchState--}static saveBatch(){this.jsonSnap.updateAndSave(),this.cancelSaveBatch(),this.checkBatchStateIsCorrect(),this.queueBatchRecords.length&&(this.save(structuredClone(this.queueBatchRecords)),this.queueBatchRecords.length=0)}static clear(e){var r=e&&e.saved===!1;bi.timestamps.length=0,bi.records.length=0,bi.index.value=-1,bi.savedIndex=r?-2:bi.index.value,bi.batchState=0,ba("triggerEvent",["history_change",{tabId:X.tabId},bi.records.length,bi.index.value,r])}static goTo(e){if(e>=-1&&e!==bi.index.value&&e<bi.records.length){if(e>bi.index.value)for(let r=bi.index.value+1;r<=e;r++)bi.doCmdBatch("redo",bi.records[r]);else for(let r=bi.index.value;r>e;r--)bi.doCmdBatch("undo",bi.records[r]);bi.index.value=e,ba("triggerEvent",["history_change",{tabId:X.tabId},bi.records.length,bi.index.value,!0]),te.freshItemOrder(),Et("panel_updateAttrPanel"),Et("updateMenuByDocStatus"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE),Et("panel/updateTreeActiveElements");return}console.log("history.goTo("+e+") not available")}static go(e){bi.goTo(bi.index.value+e)}static doCmdBatch(e,r){f8(),e=="redo"?bi.redoOne(r):bi.undoOne(r),this.handleSelected(e,r),this.upLoadBatch(r,e)}static handleSelected(e,r){var s;let i=Ph.getIds(),n=ME.getIds();r.forEach(a=>{var u;if(!Y0.includes((u=a[2])==null?void 0:u.cmdKey))return;let o=a[1],l=!1,c=!1;e==="redo"?(l=Kr(a[4]),c=Kr(a[3])):(l=Kr(a[3]),c=Kr(a[4])),l&&i.includes(o)?(ME.select(o),Ph.unselect(o)):c&&n.includes(o)&&(Ph.select(o),ME.unselect(o))}),(s=te.selectedRepeater)==null||s.updateChange()}static upLoadBatch(e,r){jf(e[0])||(e=[e]),e.forEach(i=>{let n=i[0];["json","combine-json"].includes(n)?this.uploadDeleteOrCreate(i,r):n==="originXY"&&te.compilerManager.uploadData("canvas")})}static defineUndoRedo(e,r){bi.undoRedoHandlers[e]=r}static undoOne(e){if(Array.isArray(e[0])){let i=e.length;for(let n=i-1;n>=0;n--)bi.undoOne(e[n]);return}let r=bi.undoRedoHandlers[e[0]];e=gd.updateRecord(e,"undo"),r.undo&&r.undo(e)}static redoOne(e){if(jf(e[0])){let i=e.length;for(let n=i-1;n>=0;n--)bi.redoOne(e[n]);return}let r=bi.undoRedoHandlers[e[0]];e=gd.updateRecord(e,"redo"),r&&r.redo&&r.redo(e)}static uploadDeleteOrCreate(e,r){let i=e.at(-1),n=e.at(-2);if(Kr(i)||Kr(n)||!i||!n){let s=e.at(1),a=(i==null?void 0:i.cmdKey)||(n==null?void 0:n.cmdKey);r==="redo"?Kr(i)||!i?gd.uploadDeleteById(s,a):te.compilerManager.uploadData(s,i):Kr(n)||!n?gd.uploadDeleteById(s,a):te.compilerManager.uploadData(s,n)}}static canRedo(){return bi.index.value<bi.records.length-1}static canUndo(){return bi.index.value>=0}static createElePosition(e,r,i){return["elePosition",e,r,i]}static getLastRecordPrimitiveIds(){let e=bi.records[bi.records.length-1];return e?(Array.isArray(e[0])?e:[e]).reduce((i,[n,s])=>(n==="json"&&i.push(s),i),[]):[]}};bi.records=[],bi.timestamps=[],bi.queueBatchRecords=[],bi.maxLength=50,bi.index={value:-1},bi.savedIndex=-1,bi.batchState=A8,bi.undoRedoHandlers=[];var mr=bi;mr.defineUndoRedo("originXY",{undo:function(t){var e=t[2];if(!(!e.offsetX&&e.offsetX!=0||!e.offsetY&&e.offsetY!=0)){var r={};r.x=zt.canvas.originX-e.offsetX,r.y=zt.canvas.originY-e.offsetY,ja().setOriginXY({x:r.x,y:r.y})}},redo:function(t){var e=t[2];if(!(!e.offsetX&&e.offsetX!=0||!e.offsetY&&e.offsetY!=0)){var r={};r.x=zt.canvas.originX+e.offsetX,r.y=zt.canvas.originY+e.offsetY,ja().setOriginXY({x:r.x,y:r.y})}}});mr.defineUndoRedo("elePosition",{undo:function(t){let e=t[0],r=t[1].split(","),i=t[2].split(",");for(let n=r.length;--n>=0;){let s=Fe(r[n]);s&&S6(s.parentNode,s,i[n])}},redo:function(t){var e=t[0];let r=t[1].split(","),n=(t[3]||"").split(",");for(let s=r.length;--s>=0;){let a=Fe(r[s]);a&&S6(a.parentNode,a,n[s])}}});mr.defineUndoRedo("combine-json",{undo(t){let[,e,r,i]=t;te.setCombination(e,r),new rs().updateHole()},redo(t){let[,e,r,i]=t;te.setCombination(e,i),new rs().updateHole()}});mr.defineUndoRedo("json",{undo(t){let[e,r,i,n,s]=t,{cmdKey:a,refId:o}=i;if(LC(n)&&LC(s))return UE.run(n,r,a)},redo(t){let[e,r,i,n,s]=t,{cmdKey:a,refId:o}=i;if(LC(n)&&LC(s))return UE.run(s,r,a)}});function Da(t,{cmdKey:e,refId:r},i,n){return["json",t,{cmdKey:e,refId:r},vi(i),vi(n)]}var qi=class{constructor(e=[]){this.hist=[];this.histCombine=[];this.nodes=[];this.uniqueIds=new Set;this.uniqueCombineIds=new Set;for(let r of e)this.addOne(te.getById(r.gId||r.id).json)}createCombineJsonHistory(e,r,i){return r=r||te.getCombination(e),["combine-json",e,vi(r),vi(i)]}addOneCombine(e,r){let n=new gr().searchCombination(e);this.addOneCombineByComId(n,r)}addOneCombineByComId(e,r){if(!e||this.uniqueCombineIds.has(e))return;this.uniqueCombineIds.add(e);let n=new gr().findParent(e);n&&(this.uniqueCombineIds.add(n.gId),this.histCombine.push(this.createCombineJsonHistory(n.gId,n))),r=r||te.getCombination(e);for(let s of r.combinations||[])this.uniqueCombineIds.add(s),this.histCombine.push(this.createCombineJsonHistory(s));this.histCombine.push(this.createCombineJsonHistory(e,r))}addOne(e,r,i){if(this.uniqueIds.has(e.gId))return this;let n=i||e.cmdKey,s=te.getRefId(e.gId),a=r||e,o=Da(e.gId,{cmdKey:n,refId:s},a);return this.hist.push(o),this.nodes.push(e),this.uniqueIds.add(e.gId),this.addOneCombine(e.gId),te.compilerManager.pauseDateMerge(),this}add(e){for(let r of e)this.addOne(r)}update(){let e=this.hist,r=this.nodes,i=[];for(let n=0,s=r.length;n<s;n++){let a=te.getById(r[n].gId).json,o=e[n][3];delete a.tempMatrix,delete a.tempD;let l=UE.diff(o,a);if(Kr(l))continue;te.changedJsoncache(o.gId||a.gId,o.cmdKey||a.cmdKey);let c=Kr(o),u=Kr(a);e[n][3]=UE.diff(a,o),e[n][4]=l,c&&(e[n][3]={}),u&&(e[n][4]={}),i.push(e[n])}this.hist=i,this.updateCombine(),te.compilerManager.resumeDataMerge()}updateCombine(){let e=[];for(let r of this.histCombine){let[,i,n]=r,s=te.getCombination(i),a=UE.diff(n,s);Kr(a)||(r.pop(),r.push(vi(s)),e.push(r))}this.histCombine=e}out(){return this.update(),this.getHistory()}getHistory(){return[...this.histCombine,...this.hist]}getPrimitiveHistory(){return[...this.hist]}getCombHistory(){return this.histCombine}updateAndSave(){this.update(),this.getHistory().length&&mr.save(this.getHistory()),this.nodes.length=0}recovery(e=!0){let r=this.getPrimitiveHistory();for(let i of r){let[,,{cmdKey:n},s]=i;e?Hc(n,s):te.insertOneData(s.gId,n,s)}return this}};var dT=class{constructor(){}isLockedById(e){let{locked:r}=te.getById(e).json;return r}hasEleLocked(e){for(let r of e)if(this.isLockedById(r))return r;return!1}hasUnLockedObjs(e=[]){for(let r of e)if(!this.isLockedById(r.id))return!0;return!1}unlockAll(){let e=new qi;te.iteratorCombination(i=>{i.locked===!0&&(e.addOneCombineByComId(i.gId),i.locked=!1)}),te.getItemOrder().forEach(i=>{let{json:n,cmdKey:s}=te.getById(i),{locked:a}=n;a===!0&&(e.addOne(n),n.locked=!1)}),e.updateAndSave()}setLockStatus(e,r){let i=new gr,{elements:n,combinations:s}=i.getSelectedCombinations2(e),a=new qi(e.map(o=>({id:o})));for(let o of s){a.addOneCombineByComId(o);let l=te.getCombination(o);l.locked=r}for(let o of n){let{json:l,cmdKey:c}=te.getById(o);c!=="dimension"&&(l.locked=r)}a.updateAndSave()}setCombinationLockStatus(e,r){let i=new qi;i.addOneCombineByComId(e);let n=te.getCombination(e);n.locked=r,i.updateAndSave()}hasCombinationLocked(e){for(let r of e)if(this.isCombinationLocked(r))return!0;return!1}isCombinationLocked(e){return te.getCombination(e).locked}setElementsLockStatus(e,r){let i=new qi(e.map(n=>({id:n})));for(let n of e){let{json:s}=te.getById(n);s.locked=r}i.updateAndSave(),Et("panel_updateAttrPanel")}toggleLockStatus(e){mr.startBatch(),e.forEach(r=>{let i=te.getCombination(r);if(!Kr(i))this.setCombinationLockStatus(r,!i.locked);else{let{json:s}=te.getById(r);this.setLockStatus([r],!s.locked)}}),mr.saveBatch()}};dT=Uu([gu(Ya.lock)],dT);var Rs=new dT;var Tb=class{static ready(e=$d(X.cmdToken)){tr.started=!0,this.buildLine(e),this._type=e,X.helperCursor=""}static buildLine(e){switch(e){case"cross":{this.lines=[new HE(te.getInitialAuxiliaryLineData({gId:ni()})),new HE(te.getInitialAuxiliaryLineData({gId:ni(),rotation:90}))];break}case"horizontal":{this.lines=[new HE(te.getInitialAuxiliaryLineData({gId:ni()}))];break}case"vertical":{this.lines=[new HE(te.getInitialAuxiliaryLineData({gId:ni(),rotation:90}))];break}default:throw tr.end(),new Error(`PlaceAuxiliaryLine: invalid type(${e}) auxiliary line`)}}static draw(e,r,i){for(let n of this.lines)n.x=e,n.y=r,Fe(n.gId)?new dd(n.toJSON()).render():Ar.appendTargetLayer(n.svg,8);Ey(),i&&ma.record(0,()=>{tr.next()})}static next(){let e=[];for(let r of this.lines){let i=HS(r.toJSON());Ar.appendTargetLayer(i,8);let n=vo(i);e.push(Da(r.gId,{cmdKey:"auxiliaryLine",refId:n},{},r.toJSON())),pt.select([i])}this.buildLine(this._type),e.length&&mr.save(e)}static end(){for(let e of this.lines)Cr(Fe(e.gId));this.lines.length=0,this._type=null,Ey()}static getRulerAuxiliaryXY(){let e={x:[],y:[]},{x:r,y:i}=this.lines[0]||{};if(r==null&&i==null)return e;let n=["cross","vertical"].includes(this._type)?Sr(ti(r,"pixel",zt.canvas.unit),2):null,s=["cross","horizontal"].includes(this._type)?Sr(ti(-i,"pixel",zt.canvas.unit),2):null,a=FE({x:r,y:i});return n!=null&&e.x.push({position:a.clientX,content:String(n)}),s!=null&&e.y.push({position:a.clientY,content:String(s)}),e}static mouseWheel(e){for(let r of this.lines)r.updateSVG()}};Tb.lines=[];var HE=class{constructor(e){this.svg=Hr("line",{c_partid:"auxiliaryLine"});for(let r in e)this[r]=e[r]}get gId(){return this._gId}set gId(e){this._gId=e,this.svg.id=e}get x(){return this._x}set x(e){this._x=e,this.updateSVG()}get y(){return this._y}set y(e){this._y=e,this.updateSVG()}get rotation(){return this._rotation}set rotation(e){this._rotation=e,this.updateSVG()}get type(){return $d(this.rotation)}updateSVG(){if(this.x==null||this.y==null||this.rotation==null)return;let e=X.svgRoot.viewBox.animVal,r=Math.max(e.width,e.height),i=sb(this.x,this.y,this.rotation,r);this.svg.setAttribute("x1",String(i.start().x)),this.svg.setAttribute("y1",String(i.start().y)),this.svg.setAttribute("x2",String(i.end().x)),this.svg.setAttribute("y2",String(i.end().y))}toJSON(){let e=sb(this.x,this.y,this.rotation),{x:r,y:i}=e.start(),{x:n,y:s}=e.end();return{gId:this.gId,x:this.x,y:this.y,strokeColor:this.strokeColor,strokeStyle:this.strokeStyle,layer:this.layer,locked:this.locked,rotation:this.rotation,name:this.name,visible:!0,cmdKey:"auxiliaryLine",x1:r,y1:i,x2:n,y2:s}}};function pd(t,e="",r=ur()){return X.windowBridge.rpcCall(t,e,r)}function ba(t,e,r){var i=parent;if(i!=window){var n=e||[],s=[{args:n,uuid:r,func:t}];return i.panelCallByEditor.apply(window,s)}}function tl(t){tl.data.event=t;var e=6;if([2,4].includes(t.buttons)||[1,2].includes(t.button))return;var r=Hn(t,!1),i=t.target,n=zt.canvas,s=tl.data;let{clientX:a,clientY:o}=t;s.clientX=a,s.clientY=o,s.lastUpX===null&&(s.lastUpX=n.originX,s.lastUpY=n.originY);var l=r.x,c=r.y;t.type=="mousedown"&&(i==X.svgRoot||uu(i,VA)||X.gCanvas.contains(i))&&(s.lastUpX=l,s.lastUpY=c);var u=l-s.lastUpX,d=c-s.lastUpY;t.type=="mouseup"&&(i==X.svgRoot||uu(i,VA)||X.gCanvas.contains(i))&&(s.lastUpX=l,s.lastUpY=c,s.uplock=!(s.clientX>0&&s.clientY>0&&s.clientX<t.view.innerWidth&&s.clientY<t.view.innerHeight));let A=n.unit!="pixel"&&n.unit||"",f={...rA(r)};f.x-=n.originX,f.y-=n.originY,f.x=p(f.x),f.y=p(f.y),s.uplock&&t.type=="mousemove"&&(Math.abs(u)*X.gZoom>e||Math.abs(d)*X.gZoom>e)&&(s.uplock=!1),s.uplock||(f.dx=p(u),f.dy=p(d)),s.currAbsX=f.absX=r.x,s.currAbsY=f.absY=r.y,ba("updateMouseXY",[f]),Fe("mouse-x-for-test").value=r.x,Fe("mouse-y-for-test").value=-r.y;function p(m){return m=A?ti(+m,"pixel",A):+m,m=AP(m),A?m+A:m}}tl.data={clientX:null,clientY:null,lastUpX:null,lastUpY:null,uplock:!1,currAbsX:0,currAbsY:0,event:null};function Hn(t,e){let r=yS({x:t.clientX,y:t.clientY}),{x:i,y:n}=r;return e===!0&&!t.altKey?zIe(r):e!==!1&&zt.adsorbGrid.enabled?rA(r):{x:Fa(i),y:Fa(n)}}function zIe(t){let e=Jr.adsorption(t.x,t.y);return e!=null?e:zt.adsorbGrid.enabled?rA(t):t}function nK(t,e){let r=Jr.dragAdsorption(t.x,t.y,e);return r!=null?{x:Fa(r.x),y:Fa(r.y)}:zt.adsorbGrid.enabled?rA(t):{x:Fa(t.x),y:Fa(t.y)}}function eA(){let t=Fe("gControlDots"),e=Fe("gControlRects"),r=Fe("gControlLines"),i=[t,e,r];for(let n of i)n.classList.add("hide");Zo.hideAll().emptyData()}function Ac(t,e="single"){let r=te.getById(t.id||t.gId).json||Object(),i=co.get(r,e)||Ts.get(t);return Zo.main(i),Jh(i)?i.bbox:i}async function iK(t,e){let r=e||t.target,i=r==X.svgRoot,n=Pi(r);r.parentNode===X.gControlDots?n="cdot":r=XA(r);let s=n==="cdot",a=Gs();(!s&&!i&&r&&r.tagName!="TEXTAREA"&&(!r||!pt.isSelected(r))||i)&&!a&&Ci(),!s&&r&&(pt.select([r]),["auxiliaryLine","auxiliaryPoint","dimension"].includes(n)||Ja([r]));let o=[n],{x:l,y:c}=Hn(t,!1),u=Zo.findControlDot(l,c);u&&u.belongCmdKey==="arc"&&(o=[u.belongCmdKey]),(u||s)&&Zo.selectAnchorOrHandle((u==null?void 0:u.id)||(r==null?void 0:r.id)),(i||(u==null?void 0:u.type)==="bbox"||pt.getIds().length===0)&&(o="canvas");let d=r==null?void 0:r.id,A=pt.getIds(),{combinations:h}=new gr().getSelectedCombinations(A);if(!pi.isEditingPath())for(let w of A){let{cmdKey:x,json:I}=te.getById(w),C=un(I,x);Mr.extendRect(C).isContains1(l,c)&&(o=[x])}let f=(await pd("getPanelFilterConfig",[X.tabId])).message,{checkInDisableFlag:p,checkInHideFlag:m,checkOutDisableFlag:y,checkOutHideFlag:g}=fy.get(),b=!await bb(),E={filterConfig:f,tabId:X.tabId,target:o,targetId:d,docType:X.doctype,cmdKey:n,clientX:t.clientX,clientY:t.clientY,x:l,y:c,hasLocked:Rs.hasEleLocked(A),hasUnLocked:Rs.hasUnLockedObjs(a),hasVisible:rn.hasVisible(A),hasHidden:rn.hasHidden(A),selectsCount:a.length,combinationCount:Object.keys(te.getCombination()).length,isEditCombine:Li.isEditing(),isClipboardEmpty:b,aboveCombination:Array.from(h),checkInDisableFlag:p,checkInHideFlag:m,checkOutDisableFlag:y,checkOutHideFlag:g};X.contextmenuDisableOnce||X.windowBridge.publish("showEditorContextMenu",[E],ur())}function Gs(){return pt.get()}function qP(){let t=pt.getIds(),e=[];for(let r of t)e.push(te.getById(r).json);return e}function Ci(t){f8(),Mk(t),hm()}function f8(){let t=Us("#g1 ."+pt.highlightClass);for(var e=t.length-1;e>=0;e--)pt.unhighlight(t[e])}function Mk(t){var e=t||Gs(),r=e.length;if(r>0)for(var i=r;--i>=0;)pt.unselect(e[i]);ME.clear(),eA(),Dg("","none");var n=Us("."+pt.selectClass,X.gCanvas);return pt.unselect(n),r}function Qk(){var r;let t=th(),e=new gr;(r=te.selectedRepeater)==null||r.notPublishOnce();for(let i of t)if(i.combinationId){let n=e.getAllElesfromTop(i.combinationId).elements,s=Array.from(n).map(a=>Fe(a)).filter(a=>a);pt.select(s)}else pt.select([Fe(i.elements[0])]);Et("panel_updateAttrPanel"),Et("updateMenuByDocStatus")}function lp(t=An.getViewBox(),e={}){ba("updateRuler",[{zoom:X.gZoom,unit:zt.canvas.unit,vbX:t[0],vbY:t[1],originX:zt.canvas.originX,originY:zt.canvas.originY,...e}],X.tabId)}function Ey(){ba("updateRuler",[yb()],X.tabId)}function yb(t=An.getViewBox(),e=X.gZoom){let r=[],i=[];switch(X.cmdToken){case"place_auxiliary(crossLine)":case"place_auxiliary(verticalLine)":case"place_auxiliary(horizontalLine)":{let n=Tb.getRulerAuxiliaryXY();r.push(...n.x),i.push(...n.y);break}case"place_auxiliary(point)":{let n=tr.activeDrawer.getRulerAuxiliaryXY();r.push(...n.x),i.push(...n.y);break}}return pt.getIds().forEach(n=>{let s=te.getAuxiliaryLine(n);if(s!=null)switch($d(s.rotation)){case"vertical":{r.push({position:(s.x-t[0])*e,content:String(Sr(ti(s.x,"pixel",zt.canvas.unit),2))});break}case"horizontal":{i.push({position:(s.y-t[1])*e,content:String(Sr(ti(-s.y,"pixel",zt.canvas.unit),2))});break}}}),{auxiliaryX:r,auxiliaryY:i}}function eT(){var t=document.body,e=document.documentElement;return{zoom:X.currZoom,scrollLeft:Math.max(t.scrollLeft,e.scrollLeft),scrollTop:Math.max(t.scrollTop,e.scrollTop),scrollWidth:Math.max(t.scrollWidth,e.scrollWidth),scrollHeight:Math.max(t.scrollHeight,e.scrollHeight),clientWidth:e.clientWidth,clientHeight:e.clientHeight,width:Math.max(t.scrollWidth,e.scrollWidth),height:Math.max(t.scrollHeight,e.scrollHeight),canvasWidth:+ge(X.svgRoot,"width"),canvasHeight:+ge(X.svgRoot,"height"),viewBox:ge(X.svgRoot,"viewBox"),unit:zt.canvas.unit}}function Ls(t,e,r,i){let n=/^(grab|grabbing|row-resize|col-resize|crosshair)$/;if(X.helperCursor&&t!=="grabbing"&&(X.helperCursor=="cross-red"?Eu(!1):n.test(X.helperCursor)?nd(X.svgRoot,"cursor-"+X.helperCursor):ge(Fe(X.helperCursor),{display:"none"})),t&&n.test(t)){em(X.svgRoot,"cursor-"+t),X.helperCursor=t;return}let s=!1;t&&X.helperCursorConfig[t]?t=="cross-red"?ba("panel/getCrossCursor")===!1?(Eu(!1),s=!0):arguments.length>=3?(Eu(e,r),s=!0):X.helperCursor&&e===!0?Eu(!1):(i!==void 0?Eu(!1,void 0,{content:i}):Eu(!1),s=!0):arguments.length>=3&&e!==void 0&&r!==void 0?ge(Fe(t),{x:e,y:r,display:""}):X.helperCursor&&e===!0?ge(Fe(t),{display:""}):(ge(Fe(t),{x:-1e5,y:-1e5,display:""}),s=!0):s=!0,Qu(X.svgRoot,"cursor-none",!s),X.helperCursor=t||"",!t&&Eu(!1)}function Eu(t,e,r){let i=ba("panel/getCrossCursor");if(i==="None"&&(t=!1),t!==!1&&(!isFinite(t)||!isFinite(e)))return;var n=Fe("cross-x"),s=Fe("cross-y"),a=Fe("cross-text");!Ys.ready&&!md.running&&em(a,"hide");let o=An.getViewBox();if(o=[o[0]-o[2],o[1]-o[3],o[2]*3,o[3]*3],t===!1||i===!1){ge(n,"d","M0 0"),ge(s,"d","M0 0"),X.cmdToken!==""?Ys.exit():(t||!t&&i==="None")&&Ys.showReferText();return}if(KW()){let u=60;u=u/X.gZoom,o=[t-u/2,e-u/2,u,u]}ge(n,"d","M"+t+" "+o[1]+" v"+o[3]),ge(s,"d","M"+o[0]+" "+e+" h"+o[2]),n.classList.remove("hide"),s.classList.remove("hide");let l=r&&r.content||"",c=r&&r.enforceEnterRefPoint||!1;Ys.ready&&Ys.showReferencePointAndText(t,e,l,c),r&&r.stroke?(ge(n,"stroke",r.stroke),ge(s,"stroke",r.stroke)):(ge(n,"stroke","red"),ge(s,"stroke","red")),r&&r.strokeWidth?(ge(n,"stroke-width",r.strokeWidth),ge(s,"stroke-width",r.strokeWidth),ge(n,"stroke-dasharray",r.strokeWidth*2+","+r.strokeWidth*2),ge(s,"stroke-dasharray",r.strokeWidth*2+","+r.strokeWidth*2),r.strokeLinecap&&(n.style.strokeLinecap=r.strokeLinecap,s.style.strokeLinecap=r.strokeLinecap)):(ge(n,"stroke-width","1"),ge(s,"stroke-width","1"),ge(n,"stroke-dasharray","2, 2"),ge(s,"stroke-dasharray","2, 2"),n.style.strokeLinecap="round",s.style.strokeLinecap="round")}async function VL(t,e){if(e=(e==null?void 0:e.ids)||e,jf(e)||(e=pt.get()),e.some(s=>Rs.isLockedById(s.id)))return JA();let i=e.map(s=>jd(s)?Fe(s):s.gId?Fe(s.gId):s);i=i.filter(s=>{let a=Pi(s);return"dimension"!==a});let n=XIe(i);if(await md.needSelectRefobject(t)||await md.needSelectRefobjectForCenters(t)){await new md(t,n).startSelect();return}bL(n,t),Et("panel_updateAttrPanel")}function XIe(t){let e=t.map(a=>a.id),{combinations:r,elements:i}=new gr().getSelectedCombinations(e),n=[];for(let a of i)n.push(Fe(a));let s=new gr;for(let a of r){let o=s.getAllElesfromTop(a).elements,l=[];for(let c of o)l.push(Fe(c));n.push(l)}return n}function cJ(t,e=20){let r=[],i=[];for(let A of t){let h=te.getAuxiliaryLine(A.id),f=$d(h.rotation);f==="horizontal"?i.push(h.y):f==="vertical"?r.push(h.x):(r.push(A.x1.animVal.value,A.x2.animVal.value),i.push(A.y1.animVal.value,A.y2.animVal.value))}r.sort((A,h)=>A-h),i.sort((A,h)=>A-h);let[n,s,a,o]=[r[0],r[r.length-1],i[0],i[i.length-1]],l=An.getViewBox(),c=r.length?(n+s)/2:l[0]+l[2]/2,u=i.length?(a+o)/2:l[1]+l[3]/2;PE(c,u);let d=Mr.extendRect(X.svgRoot.viewBox.animVal);if(d.minX>n-e||d.maxX<s+e||d.minY>a-e||d.maxY<o+e){let A=An.getViewBox(),h=document.body.clientWidth,f=document.body.clientHeight,p=Math.min((h-e)/(s-n)||1/0,(f-e)/(o-a)||1/0),m=p*100;m<.1?(m=.1,p=m/100):m>X.zoomRatio.max&&(m=X.zoomRatio.max,p=m/100);let y={clientX:(c-A[0])*X.gZoom,clientY:(u-A[1])*X.gZoom};ba("zoom",[m,window.frameElement,y,!0])}}var fO=class{static ready(){}static onKeyUp(e){let r=tr,{keyCode:i}=e;switch(i){case"Enter":if(!r.dots.length)return;let n={clientX:tl.data.clientX,clientY:tl.data.clientY,button:f_,ctrlKey:!0},s=new MouseEvent("mousedown",n);document.dispatchEvent(s),s=new MouseEvent("mouseup",n),document.dispatchEvent(s);break}}static mouseupLeft(e,r,i){let n=DE()==="rightClickEnd",{ctrlKey:s}=e;s&&(n=!1);let a=tr;if(Ir(r)&&Ir(i)){let l=Hn(e,!0);r=l.x,i=l.y}switch(a.dots.length){case 0:a.draw(r,i,!0);break;default:n?a.draw(r,i,!0):(a.next(r,i),Kl.handlePolylineSelection());break}return a.STATUSEXIT}static mouseupRight(e){let r=DE()==="rightClickEnd",i=tr,{x:n,y:s}=Hn(e,!0);return i.dots.length===0?(tr.restart(),i.STATUSEXIT):(r?(["lineTouched"].includes(Kl.selectionMode)&&i.next(n,s,!0),Kl.handlePolylineSelection(),Et("panel_updateAttrPanel"),Et("panel/updateTreeActiveElements")):i.draw(n,s,!0),i.STATUSEXIT)}static draw(e,r,i){let n=tr,s=n.dots.slice();if(s.length<2)return;if(!i&&!Oc({x:e,y:r},{x:s[s.length-2],y:s[s.length-1]})&&s.push(e,r),Kl.selectionMode==="lineTouched"){Kl.showSelectPolyline(s.join(" "));return}let o=s.slice(2).join(" "),l=`M ${s[0]} ${s[1]} ${o?"L "+o:""}`;n.target?(ge(n.target,{d:l}),n.dots.length>=4&&Jr.updateDrawingShapeCache(n.dots)):(n.target=Hr("path",{d:l,fill:"none",c_partid:"group",locked:0,layer:Ar.getTargetPlaceLayer("group"),opacity:1,hide:0,scope:1,cover:1,rotation:0,name:""}),Ar.appendTargetLayer(n.target))}static next(e,r){var i=tr,n=i.dots,s=e!==void 0&&r!==void 0;s&&n.length>1&&e==n[n.length-2]&&r==n[n.length-1]&&(s=!1),s&&i.draw(e,r,!0);let a=i.target;if(i.started&&a)if(n.length<4)Cr(i.target);else if(i.target.getPathData().length<2)Cr(i.target);else{Ar.appendTargetLayer(i.target);let o=vo(a);mr.save(Da(a.id,{cmdKey:"group",refId:o},{},te.getById(a.id).json))}i.started=!1}static end(e){var r=tr;te.removeOne(r.target),Cr(r.target)}};var AT=class{static ready(){this.data=null,tr.dots.length=0}static draw(e,r,i){var n=tr,s=i?n.dots.length-2>0?n.dots.slice(0,n.dots.length-2):[]:n.dots;let a=s.length;if(s.length>=2){let o=Math.min(e,s[a-2]),l=Math.min(r,s[a-1]),c=Math.max(e,s[a-2])-o,u=Math.max(r,s[a-1])-l;(c===0||u===0)&&(c=u=Math.max(c,u));let d=!1;if(c===0&&u===0)return;if(!this.data){let y=ni();this.data=te.getInitialRectData({gId:y,layer:Ar.getTargetPlaceLayer("rect")});let g=X.panelThemeCache.fillColor.rect,b=X.panelThemeCache.shape.rect.width;b=ti(b,"mm","pixel");let E=X.panelThemeCache.color.rect;this.data.fillColor=g,this.data.strokeWidth=b,this.data.strokeColor=E,n.target=Hr("rect",{id:y,x:0,y:0,width:1,height:1,"stroke-width":b,"stroke-color":E,c_partid:"rect",fill:g,opacity:.3,rx:0,ry:0}),d=!0}let A=Ue.scale(c,u).translate(o,l),h=nr.getMatrix6FromMatrix(A);this.data.matrix=h;let{width:f,height:p,matrixArr:m}=vn.getRectFromMatrix(h);ge(n.target,{width:f,height:p}),xr.updateTransform(m,n.target),d&&Ar.appendTargetLayer(n.target),i&&n.next()}}static mouseupRight(e){let r=tr,i=r.dots;if(i.length<4&&i.length>0)return setTimeout(()=>{r.restart(),r.dots.length=0}),r.STATUSEXIT}static next(e,r){var i=tr,n=i.dots,s=e!==void 0&&r!==void 0;s&&n.length>1&&e==n[n.length-2]&&r==n[n.length-1]&&(s=!1),s&&i.draw(e,r,!0);let a=i.target;i.started&&a&&(n.length<4?Cr(a):(a=kS(this.data,a.id),eh([a]),Ar.appendTargetLayer(a),Ci(),pt.select(a),Ac(a),this.ready())),i.started=!1}static end(){var r;let e=(r=this.data)==null?void 0:r.gId;e&&te.removeMultiData([{id:e}]),this.ready()}};AT.data=null;var pO=class{static ready(){}static mouseupLeft(e){let r=DE()==="rightClickEnd",i=tr,{x:n,y:s}=Hn(e,!0);switch(i.dots.length){case 0:i.draw(n,s,!0);break;default:r?i.draw(n,s,!0):(i.next(n,s),Ck());break}return i.STATUSEXIT}static mouseupRight(e){let r=DE()==="rightClickEnd",i=tr,{x:n,y:s}=Hn(e,!0);return i.dots.length===0?(tr.restart(),i.STATUSEXIT):(r?(i.next(n,s,!0),Ck(),Et("panel_updateAttrPanel"),Et("panel/updateTreeActiveElements")):i.draw(n,s,!0),i.STATUSEXIT)}static draw(e,r,i){var n=tr;let s=n.dots.slice();if(s.length<2)return;i||s.push(e,r);let a=s.join(" "),o=Kl.selectionMode;if(["polygonInside","polygonOutside"].includes(o)){vk(a);return}n.target?ge(n.target,{points:a}):(n.target=Hr("polygon",{points:a,fill:"none",c_partid:"line",class:pt.unselectableClass,"stroke-dasharray":"3, 3","vector-effect":"non-scaling-stroke","stroke-width":"1px",locked:0,layerid:Ar.getTargetPlaceLayer("group")}),Ar.appendTargetLayer(n.target))}static next(e,r){var i=tr,n=i.dots,s=e!==void 0&&r!==void 0;s&&n.length>1&&e==n[n.length-2]&&r==n[n.length-1]&&(s=!1),s&&i.draw(e,r,!0),i.started&&i.target&&(n.length<4?Cr(i.target):i.target.points.numberOfItems<2&&Cr(i.target)),i.started=!1}static end(e){var r=tr;r.target&&(te.removeOne(r.target),Cr(r.target))}};var AJ="drag-auxiliary-line",xm=class{constructor(e,r){this.auxiliaryLineId=AJ;this.update(e,r)}static update(e,r){let i=new this(e,r);i=null}update(e,r){if(!e||!r)return;let i=this.auxiliaryLineId,n=document.getElementById(i),s=[e.x,e.y,r.x,r.y].join(" ");n?ge(n,{points:s}):(n=Hr("polyline",{id:i,points:s,"vector-effect":"non-scaling-stroke",stroke:X.panelThemeCache.color.select}),X.gCanvas.appendChild(n))}static removeAuxiliaryLine(){Cr(document.getElementById(this.auxiliaryLineId))}static overrideXY(e,r,i,n){if(e&&r){let s=new ne(r.x,r.y),a=new ne(i,n),o=a.angleD(s);o=o<0?o+360:o;let l=Math.floor(o/45)*45,c=o-l>22.5?l+45:l,u=a.multiply3(Ue.rotateD(c-o).setOrigin1(s));i=u.x,n=u.y,this.update(r,{x:i,y:n})}else this.removeAuxiliaryLine();return{x:i,y:n}}};xm.auxiliaryLineId=AJ;var fT=class{static ready(){this.data=null,tr.dots.length=0}static draw(e,r,i){let n=tr,s=i?n.dots.length-2>0?n.dots.slice(0,n.dots.length-2):[]:n.dots,a=s.length;if(a>=2){let o=s[a-2],l=s[a-1],c=Sr(HA(e,r,o,l));if(c===0)return;let u=!1;if(!this.data){let m=ni();this.data=te.getInitialEllipseData({gId:m,layer:Ar.getTargetPlaceLayer("ellipse")});let y=X.panelThemeCache.fillColor.circle,g=X.panelThemeCache.shape.circle.width;g=ti(g,"mm","pixel");let b=X.panelThemeCache.color.circle;this.data.fillColor=y,this.data.strokeWidth=g,this.data.strokeColor=b,n.target=Hr("ellipse",{id:m,cx:0,cy:0,rx:1,ry:1,fill:y,"stroke-color":b,"stroke-width":g,c_partid:"ellipse",opacity:.3}),u=!0}let d=Ue.scale(c,c).translate(o,l),A=nr.getMatrix6FromMatrix(d);this.data.matrix=A;let{rx:h,ry:f,matrixArr:p}=tn.getEllipseFromMatrix(A);ge(n.target,{rx:h,ry:f}),xr.updateTransform(p,n.target),u&&Ar.appendTargetLayer(n.target),i&&n.next()}}static mouseupRight(e){let r=tr;if(r.target)return setTimeout(()=>{r.restart(),this.ready()}),r.STATUSEXIT}static next(e,r){let i=tr,n=i.dots,s=e!==void 0&&r!==void 0;s&&n.length>1&&e==n[n.length-2]&&r==n[n.length-1]&&(s=!1),s&&i.draw(e,r,!0);let a=i.target;i.started&&this.data&&(n.length<4?Cr(i.target):(a=FS(this.data,a.id),eh([a]),Ar.appendTargetLayer(a),this.ready())),i.started=!1,Ci(),pt.select(a),Ac(a)}static end(e){var i;let r=(i=this.data)==null?void 0:i.gId;r&&te.removeMultiData([{id:r}]),this.ready()}};var mO=class{};var GE=class extends mO{static getTextNode(){return rl(`
	<g id="" visibility="hidden" name="Text" c_partid="part_text"  opacity="1"  transform="translate(0,0)">
		
	</g>`)}static async ready({value:e,attrs:r}){this.rotation=0,this.text=NC(e),this.attrs=r||{},await this.cloneTemplate(),tr.started=!0}static rotate(e){this.rotation+=e,this.draw(this.lastPosition.x,this.lastPosition.y,!1)}static async cloneTemplate(){this.template=this.getTextNode();let e=this.template.cloneNode(!0),r=ni();e.id=r,this.data=te.getInitialTextData({gId:r});let i=X.panelThemeCache.fontStyle.text,n=this.attrs["attr-font-color"]||X.panelThemeCache.color.text,s=this.attrs["attr-font-weight"]||(Number(i.fontWeight)?"bold":"normal"),a=this.attrs["attr-font-style"]||(Number(i.fontItalic)?"italic":"normal"),o=this.attrs["attr-font-underline"]||(Number(i.fontUnderline)?"underline":"inherit"),l=ti(this.attrs["attr-font-size"]||i.fontSize,"mm","pixel"),c=this.attrs["attr-font-family"]||i.fontFamily,[u,d]=dP(this.attrs["attr-origin"]);this.data.vAlign=+d,this.data.hAlign=u;let A=new fm,{d:h,bbox:f}=await A.getPath(this.text,{fontFamily:c,fontSize:l,fontWeight:s,fontStyle:a,underline:o,value:this.text}),p=f.height(),m=f.width();this.data.cacheHeight=p,this.data.cacheWidth=m,this.data.fontSize=l,this.data.underline=o!=="inherit",this.data.fontFamily=c,this.data.strokeColor=n,this.data.italic=a!=="normal",this.data.fontWeight=s!=="normal",this.data.d=h,this.data.key=this.data.name=this.text;let y=Hr("path",{d:h,fill:n}),g=Hr("rect",{width:m,height:p,x:0,class:"hitbox",y:-p,stroke:"none",fill:"transparent"});e.appendChild(g),e.appendChild(y),e=cE(this.data,this.data.gId),e.classList.add(UA),Io.text(this.data,tl.data.currAbsX,tl.data.currAbsY),Ar.appendTargetLayer(e),tr.target=e,Jr.setExcludeShapeIds([e.id])}static next(e,r,i){this.cloneTemplate()}static draw(e,r,i){this.lastPosition={x:e,y:r};let{target:n}=tr;if(!n)return;let s=n;fS(s,"visibility"),s.classList.remove("hide");let{x:a,y:o}=ps.getTextOrigin("",this.data.hAlign,this.data.vAlign,this.data),l=Ue.translate(e+a,r+o).rotateD(this.rotation).setOrigin(e,r),c=nr.getMatrix6FromMatrix(l);return xr.updateTransform(c,s),i&&(Jr.clearExcludeShapeIds(),fS(s,"pointer-events"),this.data.matrix=c,s=cE(this.data,this.data.gId),ma.record(0,()=>{eh([s])}),Ar.appendTargetLayer(s),tr.next()),s}static end(e){tr.target&&tr.target.parentNode&&!e&&te.removeOne(tr.target),this.template=null,X.windowBridge.publish("openForceClosedBottomBar",null,ur())}};GE.rotation=0;var gO=class{constructor(e={}){this.path=Hr("path",{...e}),Ar.appendTargetLayer(this.path)}render(e){return ge(this.path,"d",e),this}remove(){Cr(this.path)}getPath(){return this.path}},yO=class{constructor(e){this.anchorInfo=[];this.isPressingMouseLeftDown=!1;this.handlePoints=[];this.lastLeftMouseDownTime=Date.now();this.hasMoved=!1;this.panelDraw=e}ready(){this.anchorInfo=[],this.handlePoints=[],this.data=null,this.panelDraw.dots.length=0}beforeStepBack(){let e=tr;if(this.anchorInfo.length>1){let r=this.anchorInfo.pop();switch(r.type){case"C":this.handlePoints.length>1&&(this.handlePoints.pop(),this.handlePoints.pop(),this.handlePoints.push(r.x1,r.y1));break;case"L":break;default:console.error(r);break}this.draw(e.mockX,e.mockY)}}createNewAnchor(e,r,i){let n={};switch(e.type){case"M":n.type="C",n.x1=this.handlePoints[0],n.y1=this.handlePoints[1],n.x2=r,n.y2=i,n.x=r,n.y=i,n.d=["C",n.x1,n.y1,n.x2,n.y2,n.x,n.y].join(" "),n.index=e.index+3;break;case"C":n.type="C",n.x1=this.handlePoints[0],n.y1=this.handlePoints[1],n.x2=r,n.y2=i,n.x=r,n.y=i,n.d=["C",n.x1,n.y1,n.x2,n.y2,n.x,n.y].join(" "),n.index=e.index+3;break;case"L":n.type="C",n.x1=e.x,n.y1=e.y,n.x2=this.handlePoints[0],n.y2=this.handlePoints[1],n.d=["C",n.x1,n.y1,n.x2,n.y2,r,i].join(" "),n.index=e.index+3;break;default:console.error(e);break}return n}mousedownLeft(e,{x:r,y:i}){this.lastLeftMouseDownTime=Date.now(),this.hasMoved=!1;let n=this.anchorInfo.length,s=this.anchorInfo[n-1],a={x:r,y:i,type:"M",d:["M",r,i].join(" "),index:0};n&&(this.handlePoints.length?(a=this.createNewAnchor(s,r,i),this.handlePoints=[]):(a.type="L",a.d=["L",r,i].join(" "),a.index=s.index+1)),this.anchorInfo.push(a),this.draw(r,i),this.isPressingMouseLeftDown=!0,yu.flush()}mouseupLeft(e,r,i){this.isPressingMouseLeftDown&&this.hasMoved&&this.handlePoints.push(r,i),this.isPressingMouseLeftDown=!1}getFollowHandle(e,r,i,n,s){if(yu.storeDriving(e,r),s!=null&&s.ctrl){yu.exchangeFollow(),yu.exchangeDriving();let{x:a,y:o}=yu.getFollowHandle();Ir(a)||(n.x=a,n.y=o)}else{let a=new ne(n.x,n.y),{x:o,y:l}=yu.getFollowHandle(),{x:c,y:u}=yu.getDrivingHandle();Ir(o)||(a=new ne(o,l));let d=new ne(e,r);Ir(c)||(d=new ne(c,u));let A=pi.handleFollowHandle(new ne(i.x,i.y),{oldP:d,newP:new ne(e,r)},a);n.x=A.x,n.y=A.y,yu.storeFollow(A.x,A.y)}return n}draw(e,r,i,n){let s=tr,a=this.anchorInfo.length;if(a===0)return;let o=a-2>-1&&this.anchorInfo[a-2],l=this.anchorInfo[a-1],c=wz(l,{x:e,y:r});if(Date.now()-this.lastLeftMouseDownTime<100||c<.02)return;this.isPressingMouseLeftDown&&(this.hasMoved=!0);let d={type:"L",index:this.anchorInfo.length,x:e,y:r,d:["L",e,r].join(" ")};if(this.handlePoints.length&&(d.d=["C",this.handlePoints[0],this.handlePoints[1],e,r,e,r].join(" ")),this.isPressingMouseLeftDown){let p=pi.getMirrorPoint(l,{x:e,y:r});if(p=this.getFollowHandle(e,r,l,p,n),a===1)d={x:e,y:r,index:l.index+2,type:"C",x1:l.x,y1:l.y,x2:e,y2:r,d:["C",l.x,l.y,e,r,e,r].join(" ")};else{switch(l.type){case"C":l.d=["C",l.x1,l.y1,p.x,p.y,l.x,l.y].join(" "),l.x2=p.x,l.y2=p.y;break;case"L":l.type="C",l.x1=o.x,l.y1=o.y,l.x2=p.x,l.y2=p.y,l.index=o.index+3,l.d=["C",l.x1,l.y1,l.x2,l.y2,l.x,l.y].join(" ");break;default:console.error(l);break}d.d=["C",l.x,l.y,e,r,e,r].join(" ")}}let A=[...this.anchorInfo,d],h=pi.getPathD(A);if(this.data){ge(s.target,{d:h});let p=this.anchorInfo.length,m=this.anchorInfo[p-1],y={type:"M",x:m.x,y:m.y,d:["M",m.x,m.y].join(" "),index:0},g=pi.getPathD([y,d]);this.virtualLine.render(g);let b="";p>1&&(b=pi.getPathD(this.anchorInfo)),this.realityLine.render(b),A.pop(),Jr.updateDrawingShapeCache(pi.getPoints(A))}else{let p=Ar.getTargetPlaceLayer("group"),m=ni();this.data=te.getInitialGroupData({gId:m,layer:p});let y=X.panelThemeCache.shape.line.width,g=X.panelThemeCache.color.line;y=ti(y,"mm","pixel"),this.data.strokeWidth=y,this.data.strokeColor=g;let b=X.panelThemeCache.fillColor.line||"none";this.data.fillColor=b;let E={opacity:1,"stroke-width":y,stroke:g,fill:b,c_partid:"group"};this.realityLine=new gO(E),E.opacity=.3,this.virtualLine=new gO(E).render(h),s.target=Hr("path",{id:m,d:h,opacity:1,strokeWidth:y,strokeColor:g,fill:"none",c_partid:"group"}),Ar.appendTargetLayer(s.target),ge(s.target,{display:"none"}),pi.toggleMode(s.target.id)}Dg("","none"),Ac(s.target);let f=o?[o.index,l.index]:[l.index];Zo.showHandleOfIndexes(f)}next(){var i,n;let r=tr.target;if(this.anchorInfo.length>1&&r){let s=pi.getPathD(this.anchorInfo);this.data.d=s,r=qA(this.data,r.id),eh([r]),Ar.appendTargetLayer(r)}this.anchorInfo.length<2?(Cr(r),Zo.hideAll().removeAllAnchor(),r=null):(pi.toggleMode(r.id),pt.select(r),Ac(r)),(i=this.realityLine)==null||i.remove(),(n=this.virtualLine)==null||n.remove(),this.ready()}end(){this.data&&te.removeMultiData([{id:this.data.gId}]),this.ready(),Zo.hideAll().removeAllAnchor(),this.realityLine&&(this.realityLine.remove(),this.virtualLine.remove())}};var bO=class{constructor(e){this.panelDraw=e}ready(){tr.started=!0,this.point=new xO(te.getInitialAuxiliaryPointData({gId:ni()}))}draw(e,r,i){this.point.x=e,this.point.y=r,Fe(this.point.gId)||Ar.appendTargetLayer(this.point.svg,8),Ey(),i&&ma.record(0,()=>{this.panelDraw.next()})}next(){mr.startBatch();let e=hb(this.point.toJSON());Ar.appendTargetLayer(e,8);let r=vo(e);mr.save(Da(this.point.gId,{cmdKey:"auxiliaryPoint",refId:r},{},this.point.toJSON())),this.point.destroy(),pt.select([e]),mr.saveBatch(),this.point=new xO(te.getInitialAuxiliaryPointData({gId:ni()}))}end(){var e,r;Cr(Fe((e=this.point)==null?void 0:e.gId)),(r=this.point)==null||r.destroy(),this.point=null,Ey()}getRulerAuxiliaryXY(){let e={x:[],y:[]},{x:r,y:i}=this.point||{};if(r==null&&i==null)return e;let n=Sr(ti(r,"pixel",zt.canvas.unit),2),s=Sr(ti(-i,"pixel",zt.canvas.unit),2),a=FE({x:r,y:i});return e.x.push({position:a.clientX,content:String(n)}),e.y.push({position:a.clientY,content:String(s)}),e}},xO=class{constructor(e){this.cmdKey="auxiliaryPoint";this.svg=Hr("circle",{c_partid:"auxiliaryPoint",r:pg});for(let r in e)this[r]=e[r];Z2(this.svg,pg/X.gZoom)}get gId(){return this._gId}set gId(e){this._gId=e,this.svg.id=e}get x(){return this._x}set x(e){this._x=e,this.svg.setAttribute("cx",String(e))}get y(){return this._y}set y(e){this._y=e,this.svg.setAttribute("cy",String(e))}toJSON(){return{gId:this.gId,x:this.x,y:this.y,fillColor:this.fillColor,layer:this.layer,locked:this.locked,name:this.name,visible:!0,cmdKey:"auxiliaryPoint"}}destroy(){for(let e in this)this[e]=void 0}};var EO=class{constructor(e){this.clickedTwice=!1;this.draw=(e,r,i)=>{if(!this.current&&i){this.current=this.createDimensionLength(),this.current.setStart(e,r).setEnd(e,r).setTextPosition(e,r).calcuDirection().render();return}this.current&&(this.clickedTwice?(this.current.setTextPosition(e,r).calcuDirection().render(),i&&this.panelDraw.next()):(this.current.setEnd(e,r).setTextPosition(e,r).calcuDirection().render(),i&&(this.clickedTwice=!0)))};this.panelDraw=e}createDimensionLength(){let e=ni();return new ya({gId:e})}ready(){Ci(),this.panelDraw.dots.length=0}beforeStepBack(){this.clickedTwice=!1}next(){if(this.current){let e=this.current.getContainer(),r=new qi,i=this.current.toData();te.setDimension(i.gId,i,"dimensionLength"),r.addOne(te.getById(e.id).json,{},"dimensionLength"),r.updateAndSave(),this.panelDraw.target=e}this.current=null,this.clickedTwice=!1}end(){this.current&&(this.current.unmount(),this.current=null),this.clickedTwice=!1,this.ready()}mouseupRight(){return tr.restart(),tr.STATUSEXIT}};var wO=class{constructor(e){this.clickedTwice=!1;this.panelDraw=e}ready(){this.current=null,this.clickedTwice=!1,this.panelDraw.dots.length=0}draw(e,r,i){if(i&&!this.current){let n=ni();this.current=new ga({gId:n}),this.current.setStart(e,r).setEnd(e,r).setAngle(e,r).nextTick(s=>{s.querySelector("text").classList.add("hide")}).render();return}this.current&&(this.clickedTwice?(this.current.setEnd(e,r).calcuTextDot().nextTick(n=>{n.querySelector("text").classList.remove("hide")}).render(),i&&tr.next()):(this.current.setStart(e,r).setEnd(e,r).calcuTextDot().render(),i&&(this.clickedTwice=!0)))}next(){if(this.current&&this.clickedTwice){let e=new qi,r=this.current.getContainer();this.current.setData(),e.addOne(te.getById(r.id).json,{},"dimensionAngle"),e.updateAndSave(),pt.select([r]),Et("panel_updateAttrPanel")}else this.current&&this.current.unmount();this.ready()}end(){this.current&&this.current.unmount(),this.ready()}beforeStepBack(){this.clickedTwice=!1}mouseupRight(){return tr.restart(),tr.STATUSEXIT}};var vO=class{constructor(e){this.panelDraw=e}ready(){this.current=null,tr.dots.length=0}draw(e,r,i){if(!this.current&&i){let n=Og(e,r),s=n[0];if(n.length===0){let o=np(e,r);if(o.length===0)return;s=o[0]}let a=ni();this.current=new ca({gId:a,visible:!0,rotation:0}),this.current.setMeasureId(s).setHead(e,r).calcTail(e,r).calcTextPoint().render(),this.current.lineAlignText();return}if(this.current&&(this.current.setHead(e,r).calcTail(e,r).calcTextPoint().render(),this.current.lineAlignText(),i)){let n=this.panelDraw.dots;n.length===2&&n.push(e,r),tr.next(e,r)}}next(){let e=this.panelDraw.dots;if(this.current&&e.length>2){Ci();let r=this.current.toData(),{x1:i,y1:n,x2:s,y2:a}=r;if(i===s&&n===a)return e.splice(2,2);let o=new qi,l=this.current.getContainer();o.addOne(r,{},"dimensionRadius"),te.setDimension(r.gId,r,"dimensionRadius"),o.updateAndSave(),this.panelDraw.target=l}else this.restart();this.ready()}restart(){this.panelDraw.restart(),this.panelDraw.dots.length=0}end(){this.current&&this.current.unmount(),this.ready()}};var CO=class{constructor(e){this.panelDraw=e}createLine(e,r){this.helpLine=Hr("line",{fill:X.panelThemeCache.fillColor.arc,stroke:X.panelThemeCache.color.arc,"stroke-width":ti(X.panelThemeCache.shape.arc.width||1,"mm","pixel"),opacity:.5,x1:e,y1:r,x2:e,y2:r}),X.svgRoot.appendChild(this.helpLine)}ready(){this.data=null,Cr(this.helpLine)}draw(e,r,i){let n=this.panelDraw.dots,s=this.panelDraw.dots.length;if(!(s<2)&&(s===2&&(this.ready(),this.createLine(n[0],n[1])),!(e==n[0]&&r==n[1]))){if(s===4&&i&&Cr(this.helpLine),s===2)ge(this.helpLine,{x1:n[0],y1:n[1],x2:e,y2:r});else if(s>=4){if(n[3]===e&&n[4]===r)return;let a=[n[0],n[1],n[2],n[3],e,r],o=fP.apply(null,a);if(!o)return;if(!this.data){let l=ni();this.data=te.getInitialArcData({gId:l,layer:Ar.activeLayer||1,type:2,fillColor:X.panelThemeCache.fillColor.arc,strokeColor:X.panelThemeCache.color.arc,strokeWidth:ti(X.panelThemeCache.shape.arc.width||1,"mm","pixel")}),Jr.enabled=!1,this.panelDraw.target=Ng(this.data),Jr.enabled=!0}this.data.x1=o.x1,this.data.y1=o.y1,this.data.x2=o.x2,this.data.y2=o.y2,this.data.rx=this.data.ry=o.r,this.data.large=o.largeArcFlag,this.data.sweep=o.sweepFlag,ge(this.panelDraw.target,"d",Bn.getD(this.data)),i&&this.panelDraw.next()}}}next(e,r){let i=tr,n=i.dots,s=i.target;i.started&&s&&(n.length<6?te.removeOne(s):(eh([s]),Ci(),pt.select([s]))),i.started=!1,this.ready()}beforeStepBack(){let e=tr;this.ready(),te.removeOne(e.target),e.target=null}end(){let e=this.panelDraw.target;e&&te.removeOne(e),this.panelDraw.dots.length=0,this.ready()}};var SO=class{constructor(e){this.panelDraw=e}ready(){this.panelDraw.dots.length=0,this.data=null}draw(e,r,i){let n=tr;if(!n.dots.length)return;let s=n.dots[0],a=n.dots[1],o=new ne(s,a).distance1(new ne(e,r))/2,l=["M"+s+","+a,"A"+o+","+o,0,1,1,e+","+r].join(" ");if(!this.data){let c=ni();this.data=te.getInitialArcData({gId:c,layer:Ar.activeLayer||1,type:2,x1:s,y1:a,fillColor:X.panelThemeCache.fillColor.arc,strokeColor:X.panelThemeCache.color.arc,strokeWidth:ti(X.panelThemeCache.shape.arc.width||1,"mm","pixel")}),Jr.enabled=!1,n.target=Ng(this.data),Jr.enabled=!0}this.data.x2=e,this.data.y2=r,this.data.rx=this.data.ry=o,Hi.renderer.attr(this.data.gId,"d",l),i&&n.dots.length===4&&n.next()}next(e,r,i){let n=this.panelDraw.target;this.data&&(this.panelDraw.dots.length===4?(eh([n]),Ci(),pt.select(n),this.ready()):this.end())}end(){this.data&&te.removeMultiData([{id:this.data.gId}]),this.ready()}};var TO=class{constructor(e){this.opacityCircleId="opacityCircleId";this.panelDraw=e}createCircle(e,r){this.opacityCircle=Hr("circle",{cx:e,cy:r,r:0,id:this.opacityCircleId,fill:X.panelThemeCache.fillColor.arc||"none",stroke:X.panelThemeCache.color.arc||"black",opacity:.5,"stroke-width":ti(X.panelThemeCache.shape.arc.width||1,"mm","pixel")}),X.svgRoot.appendChild(this.opacityCircle)}ready(){this.panelDraw.dots.length=0}draw(e,r,i){let n=this.panelDraw.dots,s=n.length;if(s===0)return;let a=new ne(n[0],n[1]);s===2&&i&&this.createCircle(a.x,a.y);let o=HA(n[0],n[1],e,r);if(s===4){o=HA(n[0],n[1],n[2],n[3]),i&&(Hi.renderer.removeNode(this.opacityCircleId),this.data=te.getInitialArcData({gId:ni(),layer:Ar.activeLayer||1,type:1,rx:o,ry:o,x1:n[2],y1:n[3],x2:n[2],y2:n[3],fillColor:X.panelThemeCache.fillColor.arc,strokeColor:X.panelThemeCache.color.arc,strokeWidth:ti(X.panelThemeCache.shape.arc.width||1,"mm","pixel")}),Jr.enabled=!1,this.panelDraw.target=Ng(this.data),Jr.enabled=!0);let l=new ne(e,r).angle2(a);this.data.x2=a.x+Math.cos(l)*o,this.data.y2=a.y+Math.sin(l)*o;let c=new ne(this.data.x1,this.data.y1).sub(a),u=new ne(this.data.x2,this.data.y2).sub(a),d=c.cross(u);this.data.large=d>0?0:1,ge(this.panelDraw.target,{d:Bn.getD(this.data)});return}if(s===6){this.panelDraw.next();return}ge(this.opacityCircle,{r:o})}next(e,r,i){let n=this.panelDraw.dots.length,s=this.panelDraw.target;n===6?(eh([s]),Ci(),pt.select([s])):n>2&&(Hi.renderer.removeNode(this.data.gId),te.removeMultiData([{id:this.data.gId}])),Hi.renderer.removeNode(this.opacityCircleId)}beforeStepBack(){let e=this.panelDraw.target;te.removeOne(e);let[r,i]=this.panelDraw.dots;this.createCircle(r,i)}end(){let e=this.panelDraw.target;e&&te.removeOne(e),Hi.renderer.removeNode(this.opacityCircleId),this.ready()}};var tr=class extends Fc{constructor(e,r){super(),X.cmdToken=e,tr.ready(r),e!=="place_part(text)"&&Et("setTopBarItemChecked",[e])}getSymbol(){return Ps.draw}uninstall(){console.log(this.getSymbol(),"uninstalled"),tr.end(),XS(),fc()}install(){console.log(this.getSymbol(),"installed"),Ci(),kg.switch(4)}static canSwitchMe(e){return X.cmdToken==="place_part(text)"?!0:X.cmdToken!==e}static ready(e){if(this.readyed)return;this.readyed=!0,Qu(X.gCanvas,"events-none",!0);let{currAbsX:r,currAbsY:i}=tl.data;["place_auxiliary(crossLine)","place_auxiliary(horizontalLine)","place_auxiliary(verticalLine)"].includes(X.cmdToken)||Ls("cross-red",r,i),fc(void 0,{x:r,y:i}),this.drawers(X.cmdToken).ready(e),pi.endEditingPath()}static drawers(e=X.cmdToken){if(this.activeDrawer)return this.activeDrawer;switch(e){case"draw(measure-length)":return this.activeDrawer=new EO(this);case"draw(measure-angle)":return this.activeDrawer=new wO(this);case"draw(measure-radius)":return this.activeDrawer=new vO(this);case"draw(arc)":return this.activeDrawer=new CO(this);case"draw(arcCenter)":return this.activeDrawer=new TO(this);case"draw(arc2)":return this.activeDrawer=new SO(this);case"draw(pen)":return this.activeDrawer=new yO(this);case"draw(dimension-xy)":case"draw(dimension-x)":case"draw(dimension-y)":return kE;case"draw(circle)":return fT;case"place_part(text)":return GE;case"draw(ellipse)":return fT;case"draw(image)":return AE;case"draw(polyline)":return fO;case"draw(polygon)":return pO;case"draw(rect)":return AT;case"draw(origin)":return gy;case"place_auxiliary(point)":return this.activeDrawer=new bO(this),this.activeDrawer;case"place_auxiliary(crossLine)":case"place_auxiliary(verticalLine)":case"place_auxiliary(horizontalLine)":return Tb;default:break}}onKeyDown(e){let r=tr,{key:i}=e;switch(i){case"Shift":r.lastToolContext.shiftKeyDown||(r.lastToolContext.shiftKeyDown=!0,this.onMouseMove(r.lastToolContext,!0));break}if(!r.readyed)return;let n=X.cmdToken,s=r.drawers(n);s&&s.onKeyDown&&s.onKeyDown(e)}onKeyUp(e){let{key:r}=e,i=tr;switch(r){case"Shift":xm.removeAuxiliaryLine(),i.lastToolContext.shiftKeyDown=!1,this.onMouseMove(i.lastToolContext,!1);break}if(!i.readyed)return;let n=X.cmdToken,s=i.drawers(n);s&&typeof s.onKeyUp=="function"&&s.onKeyUp(e)}onMouseLeftDown(e){let r=tr;if(!r.readyed)return;let{shiftKey:i}=e.originalEvent,n=X.cmdToken,s=r.drawers(n),{lastClickPoint:a}=r,{x:o,y:l}=Hn(e.originalEvent,!0),c=xm.overrideXY(i,a,o,l);o=c.x,l=c.y,s&&typeof s.mousedownLeft=="function"&&s.mousedownLeft(e,{x:o,y:l}),r.started=!0}onMouseLeftUp(e){if(!tr.readyed)return;let{originalEvent:r}=e,i=r.shiftKey,n=tr,{lastClickPoint:s}=n;if(!Yd&&(r.target==document.documentElement||r.target==document.body))return;var a=n.dots;let o=Hn(r,!0),l=o.x,c=o.y,u=xm.overrideXY(i,s,l,c);if(l=u.x,c=u.y,n.started||(n.started=!0,a.length=0),n.drawers(X.cmdToken)&&typeof n.drawers(X.cmdToken).mouseupLeft=="function"){var d=n.drawers(X.cmdToken).mouseupLeft(r,l,c);if(d===n.STATUSEXIT)return}n.draw(l,c,!0)}onMouseRightUp(e){if(!tr.readyed)return;let r=e.originalEvent,i=tr;if(X.contextmenuDisableOnce=!0,setTimeout(function(){X.contextmenuDisableOnce=!1},5),!Yd&&(r.target==document.documentElement||r.target==document.body))return;let n=Hn(r,!0),s=n.x,a=n.y,o=i.drawers(X.cmdToken),l=o==null?void 0:o.mouseupRight;G1(l)&&l.call(o,r,e)===i.STATUSEXIT||(!X.cmdToken||!i.started||X.cmdToken.indexOf("place_part")===0||X.cmdToken==="draw(image)"||X.cmdToken.startsWith("place_auxiliary")||i.dots.length===0?e.toolFinished=!0:i.next(s,a))}onMouseMove(e,r){let{altKeyDown:i,originalEvent:n,ctrlKeyDown:s}=e,a=r!==void 0?r:n.shiftKey,o=tr,l=tr;l.lastToolContext=e;let{lastClickPoint:c}=l;l.readyed||(e.toolFinished=!0),n.altKey!==i&&(e.altKeyDown=i=n.altKey),$f.altKeyEnabled=i;var u,d;if(zt.adsorbGrid.enabled||(u=Object.assign({},zt.adsorbGrid),Object.assign(zt.adsorbGrid,{distanceX:1,distanceY:1,enabled:!0}),d=function(){Object.assign(zt.adsorbGrid,u)}),!Yd&&(n.target==document.documentElement||n.target==document.body)){d&&d();return}if(l.drawers(X.cmdToken)&&typeof l.drawers(X.cmdToken).mousemove=="function"){var A=l.drawers(X.cmdToken).mousemove(n);if(A===l.STATUSEXIT){d&&d();return}}var h=o.dots;let{x:f,y:p}=Hn(n,!0),{cmdToken:m}=X;["draw(dimension-xy)"].includes(m)&&(a=!1);let y=xm.overrideXY(a,c,f,p);if(f=y.x,p=y.y,a&&!["draw(polyline)","draw(polygon)"].includes(m)&&xm.update(c,{x:f,y:p}),h.length>0&&o.mockX==f&&o.mockY==p){d&&d();return}["place_auxiliary(crossLine)","place_auxiliary(horizontalLine)","place_auxiliary(verticalLine)"].includes(m)||Eu(f,p),fc("",{x:f,y:p}),o.draw(f,p,!1,{ctrl:s}),o.mockX=f,o.mockY=p,o.mouseX=e.mouseX,o.mouseY=e.mouseY,d&&d()}onMouseWheel(e){this.onMouseMove(e);let r=tr.drawers(X.cmdToken);typeof(r==null?void 0:r.mouseWheel)=="function"&&r.mouseWheel(e)}rotate(e){let r=tr;switch(X.cmdToken){case"draw(image)":AE.rotate(e);break;case"place_part(text)":GE.rotate(e);break;default:console.trace(X.cmdToken,e);break}}static draw(e,r,i,n){var l;let s=this.dots,a=s.length;this.lastX=e,this.lastY=r,(e!==s[a-2]||r!==s[a-1])&&i&&this.dots.push(e,r);let o=X.cmdToken;typeof((l=this.drawers(o))==null?void 0:l.draw)=="function"&&this.drawers(o).draw(e,r,i,n),i&&(this.lastClickPoint={x:e,y:r})}static next(e,r,i){!i&&Ci(),this.drawers(X.cmdToken).next(e,r),this.target&&pt.select([this.target]),this.target=null,this.dots.length=0,this.mockX=null,this.mockY=null,WIe(X.cmdToken),Et("panel_updateAttrPanel"),Et("panel/updateTreeActiveElements"),Et("forceRenderTree",Tn.PANEL_OBJECT_ROOT_NODE)}static end(e){var r;(r=this.drawers(X.cmdToken))==null||r.end(e),this.mockX=null,this.mockY=null,this.target=null,this.started=!1,this.dots.length=0,this.readyed=!1,Et("setTopBarItemChecked"),Et("updateMenuByDocStatus"),Ls(),xm.removeAuxiliaryLine(),Jr.clearAdsorptionHTML(),Jr.updateDrawingShapeCache(null),yd(),this.activeDrawer=null,xL(),fc()}static restart(){var r;!this.started||!this.dots.length?this.end(27):X.cmdToken==="draw(pen)"?this.next():(r=this.drawers(X.cmdToken))==null||r.end()}static canBackStep(){return this.started&&this.dots.length>=4}static stepBack(){var e;this.canBackStep()&&((e=this.activeDrawer)==null||e.beforeStepBack(),this.dots.length-=2,this.draw(this.lastX,this.lastY))}};tr.readyed=!1,tr.dots=[],tr.line=null,tr.mockX=null,tr.mockY=null,tr.STATUSEXIT=1,tr.lastClickPoint=null,tr=Uu([gu(Ya.draw)],tr);function WIe(t){let e=Ar.currentScheme.options.some(i=>i.actived===!0),r=!1;t==="place_part(text)"?Ar.activeLayer!==1&&Ar.activeLayer!==2&&(r=!0):t==="draw(image)"&&(r=!0),(!e||r)&&X.windowBridge.rpcCall("switchActiveLayer",[1,{notSaveHistory:!0}],ur())}function eh(t){let e=new qi;if(Li.isEditing()){let r=Li.getCurrentEditingComId();e.addOneCombineByComId(r),te.getCombination(r).elements.push(...t.map(n=>n.id)),new rs().updateHole()}t.forEach(r=>{e.addOne(te.getById(r.id).json,{})}),e.updateAndSave()}function sy(t,e=Object()){t||Zn(t),!Kl.ready&&(Jr.clearAdsorptionHTML(),Jr.updateDrawingShapeCache(null),X.frameHelper.getToolProcessor().switchToDrawTool(t,e))}function xL(){X.cmdToken=""}function gb(){md.running?md.instance.cancel():X.cmdToken&&tr.end()}var fc=B6((t,e)=>{var l,c,u;let r;t&&(r=Hn(t,!1)),!e&&r&&(e=rA(r));let i=e?FE(e):{clientX:0,clientY:0},n=window.frameElement.getBoundingClientRect(),s={left:n.left,top:n.top},a=X.cmdToken==="draw(arc)"?"draw(arc3)":X.cmdToken,o={left:i.clientX+s.left,top:i.clientY+s.top,cmdToken:a,selectionMode:qS(),color:(u=(c=(l=X)==null?void 0:l.panelThemeCache)==null?void 0:c.color)==null?void 0:u.select,copyType:Ys.ready?Ys.pasteFrom:void 0};Et("updateCursorIcon",[o])});var fJ,pJ,mJ,An=class t{static init(){fJ=Fe("gridBg"),pJ=Fe("gridOH"),mJ=Fe("gridOV"),X.selectBox1=Fe("selectBox1"),X.gControlDots=Fe("gControlDots"),X.gControlRects=Fe("gControlRects"),X.gControlLines=Fe("gControlLines"),X.gCanvas=Fe("g1")}static clear(){gb(),Ci(),lz(X.gCanvas)}static initCanvasSize(e){let r=document.documentElement.clientWidth,i=document.documentElement.clientHeight,n=zt.canvas.originX,s=zt.canvas.originY;ge(X.svgRoot,{width:r,height:i,viewBox:[n-r/2,s-i/2,r,i].join(" ")}),e.tabId&&(X.tabId=e.tabId)}static getCanvasAttrs(){let e=te.gJsonCache,{display_title:r,layer:i="",width:n="",height:s="",desc:a=""}=e.head;return{cmdKey:"canvas","attr-topic":"Page","attr-name":r,"attr-layer":i,get"attr-direction"(){return parseFloat(n)>=parseFloat(s)?"Landscape":"Portrait"},get"attr-widthxheight"(){let l=parseFloat(n),c=parseFloat(s);return`${Math.min(l,c)}mmx${Math.max(l,c)}mm`}}}static modify_canvas(e={}){var o;let r=te.gJsonCache,i=!1,n=t.getCanvasAttrs(),{gridType:s}=zt.adsorbGrid,{head:a}=r;for(let[l,c]of Object.entries(e)){if(l==="attr-topic")return;switch(l){case"attr-name":a.name=c,i=!0;break;case"attr-material":a.material=c,a.thickness=IM[c].thickness[0],a.craft=IM[c].craft[0],i=!0;break;case"attr-background-color":a.backgroundColor=c,i=!0;break;case"attr-thickness":a.thickness=c,i=!0;break;case"attr-craft":a.craft=c,i=!0;break;case"attr-print":a.print=c,i=!0;break;case"attr-cover-color":a.coverColor=c,i=!0;break;case"attr-layer":a.layer=c,i=!0;break;case"attr-widthxheight":{let[d,A]=String(c).split("x");t.setCanvasWidthHeight(d,A,n["attr-direction"]),i=!0;break}case"attr-canvas-bgcolor":if(DM(c)){c=c.toUpperCase();let d="url(data:image/gif;base64,R0lGODlhEAAQAIAAAP///9/f3yH5BAAHAP8ALAAAAAAQABAAAAIfjG+gq4jM3IFLJgpswNly/XkcBpIiVaInlLJr9FZWAQA7)";c!=="NONE"?(document.body.style.backgroundColor=c,document.body.style.backgroundImage="unset"):document.body.style.backgroundImage=d,zt.canvas.bgColor=c}break;case"attr-canvas-grid-visible":let u=c&&c!=="none";zt.adsorbGrid.visible=u,ge(Fe("gridBg"),"display",u?"":"none");break;case"attr-canvas-grid-color":{let d=Fe("gridCell"),A=Fe("gridOH"),h=Fe("gridOV"),f=(o=pK[s])==null?void 0:o.modifyProp;f&&ge(d,{[f]:c}),ge(A,"stroke",c),ge(h,"stroke",c),zt.canvas.gridColor=c;break}case"attr-canvas-grid-size":{let d=Fe("gridPattern"),A=Fe("gridCell"),h=JL(+c),f={width:h*_a,height:h*_a};ge(d,f),ge(A,{transform:Ue.toDOMMatrix(Ue.scale(h/+c))});let[p,m]=Us("path",A);if(s==="line")ge(p,{d:xd.getGridLinePathDFor1(+c)}),ge(m,{d:xd.getGridLinePathDFor10(+c)});else{let y=h/+c*X.gZoom;ge(p,{d:xd.getGridPointPathDFor1(+c,xd.getGridPointRadius(y))}),ge(m,{d:xd.getGridPointPathDFor10(+c,xd.getGridPointRadius(y))})}zt.adsorbGrid.gridSize=+c;break}case"attr-canvas-snap-size":V0("adsorbGrid","distanceX",+c),V0("adsorbGrid","distanceY",+c),$t(e,"attr-canvas-snap")||(zt.adsorbGrid.enabled=+c>1e-4);break;case"attr-canvas-snap":zt.adsorbGrid.enabled=c=="yes";break;case"attr-canvas-alt-snap-size":zt.adsorbGrid.altSnapSize=+c||1;break;case"attr-canvas-grid-style":{let d={gridColor:"#FFFFFF"};if(zt.adsorbGrid.gridType=c,c==="not")break;let A=Fe("gridCell"),h=zt.canvas.gridColor||d.gridColor,f=JL();if(ge(A,{transform:Ue.toDOMMatrix(Ue.scale(f/zt.adsorbGrid.gridSize)),width:f*_a,height:f*_a,fill:h,type:"dot"}),c==="dot"){let p=f/zt.adsorbGrid.gridSize*X.gZoom;A.innerHTML=xd.getGridPointSVGHTML(void 0,xd.getGridPointRadius(p))}else A.innerHTML=xd.getGridLineSVGHTML();ge(Fe("gridPattern"),{width:f*_a,height:f*_a}),ge(Fe("gridBg"),"fill","url(#gridPattern)");break}case"attr-direction":{t.setCanvasWidthHeight(a.width,a.height,c);break}default:break}}i&&(te.compilerManager.uploadData("canvas"),ba("triggerEvent",["history_change",{tabId:X.tabId},mr.records.length,mr.index.value,!0])),X.windowBridge.publish("ui/canvasInfo",{tabId:X.tabId,scaleValue:+(X.gZoom*100).toFixed(2),unitValue:"unit(mm)"},ur())}static setCanvasWidthHeight(e,r,i,n=!0){let s=parseFloat(e),a=parseFloat(r),o=s>a?"Landscape":"Portrait";if(i!==o){let l=Tz(s,a);[s,a]=l,[e,r]=l.map(c=>`${c}mm`)}te.setHead({width:e,height:r}),new ih().update(),n&&ja().fitview()}static async modify_json(e,r){for(let i in e){if(!$t(e,i))continue;let n=e[i];switch(i){case"attr-canvas-name":r.head.title=n;break;default:break}}}static getViewBox(){return ge(X.svgRoot,"viewBox").split(" ").map(parseFloat)}static setViewBox([e,r,i,n]){ge(X.svgRoot,"viewBox",[e,r,i,n].join(" ")),ge(fJ,{x:e,y:r,width:i,height:n}),ge(pJ,{x1:e,x2:e+i}),ge(mJ,{y1:r,y2:r+n}),lp([e,r,i,n],yb()),TP(Object.values(te.getAuxiliaryLine()).map(s=>({data:s,view:Fe(s.gId)})),new Mr(e,e+i,r,r+n).extendOfSize(Az))}};function Hk(){let t={"attr-canvas-width":1e3,"attr-canvas-height":1e3,"attr-canvas-bgcolor":X.panelThemeCache.color.background,"attr-canvas-grid-visible":zt.adsorbGrid.visible,"attr-canvas-grid-color":X.panelThemeCache.color.grid,"attr-canvas-grid-size":zt.adsorbGrid.gridSize||lu(10),"attr-canvas-grid-style":zt.adsorbGrid.gridType,"attr-canvas-snap-size":zt.adsorbGrid.distanceX,"attr-canvas-alt-snap-size":zt.adsorbGrid.altSnapSize};An.modify_canvas(t)}function $K({type:t,button:e}){if(e!==hz)return;let r=new MouseEvent(t,{button:e});document.dispatchEvent(r)}var IO=class{get gridType(){return zt.adsorbGrid.gridType||X.profileSetting.commSystemSetting.PANEL_CANVAS.gridStyle||"not"}sync(){let e={};this.gridType==="not"?(e["attr-canvas-grid-style"]="not",e["attr-canvas-grid-visible"]="none"):this.gridType==="dot"?(e["attr-canvas-grid-style"]="dot",e["attr-canvas-grid-visible"]="yes"):this.gridType==="line"&&(e["attr-canvas-grid-style"]="line",e["attr-canvas-grid-visible"]="yes"),An.modify_canvas(e)}};var X={openDocComplete:!1,topMenuStatus:new IO,profileSetting:void 0,worker:void 0,messageBus:void 0,windowBridge:void 0,containerId:void 0,tabId:void 0,selectBox1:void 0,gControlDots:void 0,gControlRects:void 0,gControlLines:void 0,gCanvas:void 0,doctype:void 0,cmdToken:"",gZoom:1,zoomRatio:{min:Gf?Number.NEGATIVE_INFINITY:5,max:Gf?Number.POSITIVE_INFINITY:1e5},currZoom:100,svgRoot:void 0,helperCursor:void 0,defaultImage:{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA1MCA0MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB4PSIxIiB5PSIxIiB3aWR0aD0iNDgiIGhlaWdodD0iMzgiIGZpbGw9IiNGRkYiIHN0cm9rZT0iI0NDQyIgc3Ryb2tlLXdpZHRoPSIyIi8+PHBvbHlsaW5lIHBvaW50cz0iMS41LDIzLDE2LDEzLDM0LDI2LDQ4LjUsMjAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0NDQyIgc3Ryb2tlLXdpZHRoPSIyIi8+PGNpcmNsZSBjeD0iMzUiIGN5PSIxMiIgcj0iNCIgZmlsbD0iI0NDQyIgc3Ryb2tlPSJub25lIi8+PC9zdmc+",width:50,height:40,insertSvgAsPath:!1,userW:0,userH:0},emojiReg:/[^\u0020-\u007E\u00A0-\u00BE\u2E80-\uA4CF\uF900-\uFAFF\uFE30-\uFE4F\uFF00-\uFFEF\u0080-\u009F\u2000-\u201f\u2026\u2022\u20ac\r\n]/g,normalCodeReg:/[\u4e00-\u9fa50-9A-Za-z]/,loading:void 0,isMouseOnEditFrame:!1,contextmenuDisableOnce:void 0,helperCursorConfig:{"cross-red":{},"cursor-hand":{},"cursor-grab":{}},autoGzipAjaxPostSize:1e4,globalVariableCookieData:{},isCutPasteFinish:!1,referencePosition:{},apis:{others:{panelOrder:"/api/panel_order"}},currentProject:{projectId:void 0,title:void 0},panelThemeCache:void 0,uploadSvgFileMaxMB:1,frameHelper:void 0,isProjectReadOnly:!1},VA="shapeBox",BO=[1,2,3,4,5,6,7],Ty={text:[1,2],rect:BO,ellipse:BO,group:BO,arc:BO,obj:[1],dimension:[8],dimensionLength:[8],dimensionAngle:[8],dimensionRadius:[8],auxiliaryLine:[8],auxiliaryPoint:[8]};function dy(){return[6,5,1,2,7,3,4,8,-1]}function BL(){let t=new Map;return dy().forEach((r,i)=>{t.set(r,i)}),t}var gJ;Object.defineProperty(X,"helperCursor",{set(t){return console.warn("helperCursor",t),gJ=t,!0},get(){return gJ}});var dae=pa(Um());var OJ=pa(Um());function Ib(t,e,r=!1){if(![si.PANEL,si.PANEL_LIB].includes(t))throw new Error(`invalid doctype(${JSON.stringify(t)}), need panel(${si.PANEL})`);t===si.PANEL_LIB&&(r=!0);let i=new Array,n=new Array,s=new Array,a=new Array,o=new Array,l={},c={text:$,rect:j,ellipse:H,arc:Q,group:_,obj:x,auxiliaryLine:E,auxiliaryPoint:w,dimension:f,dimensionAngle:p,dimensionLength:m,dimensionRadius:y};B(["DOCTYPE","PANEL","2.0"]);let u=e.head||{};B(["HEAD",{version:Bg,maxId:u.maxId||0,name:u.name||"",material:u.material||"",thickness:u.thickness||"",print:u.print||"",craft:u.craft||"",desc:u.desc||"",coverColor:u.coverColor||"",backgroundColor:u.backgroundColor||"",width:u.width||0,height:u.height||0,originX:u.originX||0,originY:-(u.originY||0)}]),Vl(e.combination,C),Vl(e,(M,v)=>{M in c&&Vl(v,(N,R)=>{n.push({id:N,type:M,shape:R})})});let d=new Map;if(Vl(e==null?void 0:e.itemOrder,(M,v,N)=>{d.set(v,N+1)}),n.sort((M,v)=>{let N=d.get(M.id)||Number.MAX_SAFE_INTEGER,R=d.get(v.id)||Number.MAX_SAFE_INTEGER;return N-R}),r){for(let{id:M,type:v,shape:N}of n)c[v](M,N),A(M,v,N);return B(["LOCK",s]),B(["HIDE",a]),B(["INVISIBLE",o]),i.join(`
`)}else return(async()=>{for(let{id:M,type:v,shape:N}of n)await c[v](M,N),A(M,v,N);return B(["LOCK",s]),B(["HIDE",a]),B(["INVISIBLE",o]),i.join(`
`)})();function A(M,v,N){let R=N.layer|0;N.locked===!0&&s.push(M),N.hide===!0&&a.push(M),N.visible===!1&&o.push(M),R===2&&B(["TRN_CTRL",M,3,1-N.transparencyPrint,1-N.transparencyWhite]),R===1&&B(["COVER",M,1])}function h(M,v){let[N,R,q,P,z,W]=v,oe=new Ue([N,R,0,q,P,0,z,W,1]);oe=Ue.MIRROR_Y.multiply3(oe).multiply3(Ue.MIRROR_Y);let[Ae,me,ve,Le,He,rt,qe,xt,Gt]=oe.data;B(["TRANSFORM",M,[Ae,Le,qe,me,He,xt],1])}function f(M,v){let{start:N,end:R}=v,q=N.primitivePoint,P=N.otherPoint,z=R.otherPoint,W=R.primitivePoint;B(["DIMENSION",M,v.layer,g(v),null,1,2,[q.x,-q.y,P.x,-P.y,z.x,-z.y,W.x,-W.y],[N.id,R.id]]),v.name&&B(["COMMENT",M,v.name])}function p(M,v){B(["DIMENSION",M,v.layer,"ANGLE",null,1,2,[v.x1,-v.y1,v.angleX,-v.angleY,v.x2,-v.y2,v.textX,-v.textY],[]]),v.name&&B(["COMMENT",M,v.name])}function m(M,v){B(["DIMENSION",M,v.layer,"LENGTH",null,1,2,[v.x1,-v.y1,v.measureX1,-v.measureY1,v.measureX2,-v.measureY2,v.x2,-v.y2],[]]),v.name&&B(["COMMENT",M,v.name])}function y(M,v){B(["DIMENSION",M,v.layer,"RADIUS-MEASUREMENT",null,1,2,[v.x1,-v.y1,v.x2,-v.y2,v.textX,-v.textY],[v.ellipseId]]),v.name&&B(["COMMENT",M,v.name])}function g(M){switch(M.category){case"Annotation":return"LENGTH-MEASUREMENT";case"Constraint":return"LENGTH-CONSTRAINT";default:throw new Error(`dimension category ${JSON.stringify(M.category)} not supported`)}}function b(M){return typeof M>"u"?null:M===null?"":String(M)}function E(M,v){B(["AUXLINE",M,G(M),v.layer,v.x,-v.y,v.rotation,1,v.strokeStyle,b(v.strokeColor),100])}function w(M,v){B(["AUXLINE",M,G(M),v.layer,v.x,-v.y,0,5,0,b(v.fillColor),0])}function x(M,v){if(v.content){if(!r&&!v.content.startsWith("blob:"))return(async()=>{let{message:N}=await X.messageBus.rpcCall("/pro-mgr/setBlob",{dataUrl:v.content,fileName:""});N!=null&&N.success&&I(M,v,`blob:${N.hash}`)})();I(M,v,v.content)}}function I(M,v,N){B(["POLY",M,G(M),v.layer,-v.rotation,0,0,"",N,v.opacity,!0,[["R",0,0,1,1,0,0,0,0]]]),v.matrix&&h(M,v.matrix),v.name&&B(["COMMENT",M,v.name])}function C(M,v){for(let N of v.elements)if(N in l){let R=l[N];throw new Error(`id ${N} in duplicate combinations: ${R} ${M}`)}else l[N]=M;B(["GROUP",U(M),v.parent?U(v.parent):0,v.name,v.visible?1:0,v.locked?1:0])}function G(M){let v=l[M];return v?U(v):0}function U(M){let v=/^e(\w+)$/.exec(M);if(v)return parseInt(v[1]);throw new Error(`invalid combination id ${M}`)}function _(M,v){B(["POLY",M,G(M),v.layer,-v.rotation,v.strokeWidth,v.strokeStyle,v.strokeColor,v.fillColor,v.opacity,!0,yJ(v.d),v.displayFill?1:0,v.displayStroke?1:0]),v.name&&B(["COMMENT",M,v.name])}function H(M,v){B(["POLY",M,G(M),v.layer,-v.rotation,v.strokeWidth,v.strokeStyle,v.strokeColor,v.fillColor,v.opacity,!0,[["ELLIPSE",0,0,1,1,0,0]],v.displayFill?1:0,v.displayStroke?1:0]),v.matrix&&h(M,v.matrix),v.name&&B(["COMMENT",M,v.name])}function Q(M,v){let N="A";v.type===1&&(N="CA"),B(["POLY",M,G(M),v.layer,-v.rotation,v.strokeWidth,v.strokeStyle,v.strokeColor,v.fillColor,v.opacity,!0,[["M",v.x1,-v.y1,N,v.rx,v.ry,v.angle,v.large,v.sweep,v.x2,-v.y2]],v.displayFill?1:0,v.displayStroke?1:0]),v.name&&B(["COMMENT",M,v.name])}function j(M,v){B(["POLY",M,G(M),v.layer,-v.rotation,v.strokeWidth,v.strokeStyle,v.strokeColor,v.fillColor,v.opacity,!0,[["R",0,0,1,1,v.rx,v.ry,0,0]],v.displayFill?1:0,v.displayStroke?1:0]),v.matrix&&h(M,v.matrix),v.name&&B(["COMMENT",M,v.name])}function $(M,v){v.d&&(B(["STRING",M,G(M),v.layer|0,-v.rotation,v.name,v.fontFamily,v.fontSize,v.fontWeight,v.italic,v.underline,v.strikeout,((-v.vAlign||0)+2)*3+(v.hAlign||0),v.strokeColor,v.opacity]),B(["FONT_CACHE",M,yJ(v.d)]),v.matrix&&h(M,v.matrix))}function B(M){M=M.map(v=>typeof v=="boolean"?v?1:0:v),i.push(JSON.stringify(M))}}function yJ(t){let e=new Array;return new pu(r=>(e.push(new Ku(!0).encPl(r).toArray().slice(1)),!0),!0).parse(t),e}var Gc=class{static getTabIFrame(e){return Fe("frame_"+e)}static getTabDocType(e){var r;return(r=ur().UI)==null?void 0:r.tabBar.getTabDocType(e)}static getTabText(e){var r;return(r=ur().UI)==null?void 0:r.tabBar.getTabText(e)}};function vu(){var t;return((t=ur().UI)==null?void 0:t.tabBar.getActiveTab())||""}function p8(){var t;return((t=ur().UI)==null?void 0:t.tabBar.getActiveTabData())||{}}function bJ(t){var e;return(e=ur().UI)==null?void 0:e.tabBar.getTabContainer(t)}function YE(t){return(t.id||"").replace("frame_","")}function fn(){let t=vu();return Gc.getTabIFrame(t)}function Em(t){return Fe("frame_"+t)}function xJ(){let t=fn();return t&&t.contentWindow}function pT(t){var e;return(e=ur().UI)==null?void 0:e.tabBar.getTabDocType(t)}function zg(){return pT(vu())}function EJ(t){t&&KIe(vu(),t)}function KIe(t,e){var r;(r=ur().UI)==null||r.tabBar.setTabDocType(t,e)}function VE(){let e=Ei("getJsonCache").head.title;return e.charAt(0).toUpperCase()+e.slice(1)}function wJ(t){let r=Ei("getJsonCache",void 0,t).head.title;return r.charAt(0).toUpperCase()+r.slice(1)}var vJ=pa(Um());var JIe="\xB0",uo={cmdKeys:[],target:{},unitReg:new RegExp("(-width|-height|-size|-radius|-x|-y|-length|-dx|-dy|-r|-distance|-dimension)$"),panelId:"panel-attr-main",cmdIds:[],get rightPanelContainer(){return(0,vJ.default)("#panel-attribute .panel-attribute-manager")},isNeedUnitConvert(t){return uo.unitReg.test(t)&&![uo.cmdKeys,uo.cmdIds].some(e=>e.includes("canvas"))},getPanelId:function(){return window.frameElement?ba("attrFnOptions",["panelId"]):uo.panelId},getConfigAttr:function(t){return vi(fK[t])},solveData:function(t){delete t.docType,uo.target=t.target;let e=[],r=Object.create(null),i={},n=[];for(let l in uo.target)for(let c in uo.target[l]){i[c]=!0;let u=uo.target[l][c],{cmdKey:d}=u;if(n.push(d),r[d])continue;let A=uo.getConfigAttr(d);if(e.length===0){e=A;continue}for(let h of e)for(let f of A)h.title===f.title&&(h.attr=Object.assign(h.attr,f.attr));r[u.cmdKey]=!0}if(uo.cmdKeys=Object.keys(r),uo.cmdIds=Object.keys(i),!Array.isArray(e))throw new Error("error");t.type===B2&&(t["attr-topic"]="Multiple Objects");for(let l of e)s(l);function s(l){for(let c in l.attr){if("attr-fill-stroke-pair"===c){$t(t,"attr-fill-color")||delete l.attr[c];continue}!$t(t,c)&&!a(c)&&delete l.attr[c]}}function a(l){let c=["attr-x-y","attr-width-height-pair","attr-obb-width-height-pair","attr-short-long-radius"];return o(n,["arc","dimensionLength","dimensionRadius","dimensionAngle"])&&c.push("attr-start","attr-end"),n.includes("arc")&&c.push("attr-circle-center"),n.includes("dimensionAngle")&&c.push("attr-dimension-angle"),!!c.includes(l)}function o(l,c){return c.some(u=>l.includes(u))}return{htmlItem:e,contentItem:t}},updatePanelValue(t){let e=Fe(uo.getPanelId());for(let r in t){let i=t[r],n=Us('[name="'+r+'"]',e);if(n.length===1)switch(r){case"attr-rotation":case"attr-bbox-rotation":case"attr-angle":case"attr-start-angle":case"attr-end-angle":n[0].value=i+JIe;break;case"attr-y":case"attr-bbox-y":n[0].value=-ti(i,"pixel","mm").toFixed(2)+"mm";break;default:n.length===1&&(n[0].value=+ti(i,"pixel","mm").toFixed(2)+"mm");break}}},pickData4UI(t={}){let e=Ei("getEleAttrParams"),r=[];if(e)for(let c of e){let u=c.cmdKey;r.push(u)}if(r=[...new Set(r)],r.sort((c,u)=>c.localeCompare(u)),t.keepFilter&&t.keepFilter!=="All"){let c=e.filter(u=>u.cmdKey===t.keepFilter);c.length!==e.length&&(e=c)}let i=Ei("attrGetData",[e]);if(!i||Kr(i))return;let{htmlItem:n,contentItem:s}=uo.solveData(i),a=vb.getCacheObj("Coordinates")!=="SVG";for(let c in s)if(/-y$/.test(c)&&a&&s[c]!==B2&&(s[c]=-s[c]),B2!==s[c]&&uo.isNeedUnitConvert(c)){let u=Yl(+s[c]);s[c]=AP(u)}let o=Ty[s.type]||Ty.rect;if(n[0].attr["attr-layer"]&&(n[0].attr["attr-layer"].options=["dimension","auxiliaryLine","auxiliaryPoint"].includes(s.type)?m8([8]):s.type==="canvas"?m8([-1]):m8(o)),s["attr-locked"]==="yes")for(let c of n)for(let u of Object.keys(c.attr))l_.includes(u)||(c.attr[u].disabled=!0);let l=[];if(r.length>1){let c=[],u=[{value:"All",text:"All"}];for(let d of Y0)r.forEach(A=>{A==d&&c.push(A)});for(let d of c)u.push({text:Fn[d],value:d});l.push({title:"Select Object",attr:{"attr-cmdKey-list":{type:"radio-list",options:u}}}),s["attr-cmdKey-list"]=t.keepFilter||u[0].value}return OE.checkSelectBBoxAttr(s)&&l.push(OE.getBBoxAttr()),l.push(...n),{htmlItem:$Ie(l),contentItem:s}},updateMouseXY:function(t){var n;if(!t||!$t(t,"x"))return;let e=!0,r,i;e?typeof t.y=="string"?(t.y.indexOf("-")>=0?r=t.y.split("-")[1]:Number(t.y.replace(/[^\d]*$/,""))===0?r=t.y:r="-"+t.y,t.dy&&(t.dy.indexOf("-")>=0?i=t.dy.split("-")[1]:Number(t.dy.replace(/[^\d]*$/,""))===0?i=t.dy:i="-"+t.dy)):(r=-t.y,i=-t.dy):(r=t.y,i=t.dy),X.messageBus.publish("ui/canvasMousePosition",{x:t.x.replace(/[^\d]*$/,""),y:r.toString().replace(/[^\d]*$/,""),dx:(n=t.dx)==null?void 0:n.replace(/[^\d]*$/,""),dy:i==null?void 0:i.toString().replace(/[^\d]*$/,""),absX:t.absX,absY:t.absY})},updateSG(t){let e=Ei("getSG");if(!e||!e.S||!e.G)return;let r=+(e.S.value*100).toFixed(2);X.messageBus.publish("ui/canvasInfo",{tabId:t,scaleValue:r!=null?r:0,unitValue:"unit(mm)"})},updateSheetByUuid:async function(t,e,r,i={}){let n=Gc.getTabIFrame(t);await X.windowBridge.rpcCall("panel/panel_attrpanel_apply",[e,r,i],n.contentWindow)},updateAttr:async function(t,e,r={}){e=e||uo.target;for(let i in e){if(!$t(e,i))continue;let n=[];e[i]instanceof Array?n=e[i]:n=Object.values(e[i]),await uo.updateSheetByUuid(i,n,t,r)}}},CJ={pickData(){let t=Ei("attrGetData",[[]]),e=uo.solveData(t);return e.htmlItem=[Object.assign(e.htmlItem[0],{title:"Basic Info"}),{title:"Layer Stacking",attr:{"attr-layer-distance":{type:"text-input",title:"Layer Expose"}}}],e}};function m8(t){let e=dy();e.reverse();let r={1:{text:"Print Layer",value:1},7:{text:"Bun Layer",value:7},2:{text:"Opacity Control Layer",value:2},3:{text:"Board Outline Layer",value:3},4:{text:"Slot Hole Layer",value:4},5:{text:"Glue Cutout Layer",value:5},6:{text:"Lighting Simulation Layer",value:6},8:{text:"Assist Drawing Layer",value:8},[-1]:{text:"Material Boarder Layer",value:-1}},i=[];for(let n of e)t.includes(n)&&i.push(r[n]);return i}function $Ie(t){if(Ei("projectPermission"))for(let r of t)for(let i of Object.keys(r.attr))r.attr[i].disabled=!0;return t}var nl=pa(Um());function jE(t){return t===si.PANEL||t===si.PANEL_LIB||t===si.PANEL3D}var DO=pa(Um());function mT(t){(0,DO.default)('a[iconcls="icon-eda-scale"] .l-btn-text span.m-btn-downarrow').text(t)}function tf(t,e=void 0,r=void 0,i){var n,s;e&&typeof e=="string"&&(e=Em(e)),e=e||fn(),e&&(t&&/[\d\.eE]+/.test(t)?n=+t:n=Ei("currZoom",[],(0,DO.default)(e).attr("c_dbid"))||+ge(e,"winzoom")||100,n=n>0?n:100,n<.1?n=.1:n>X.zoomRatio.max&&(n=X.zoomRatio.max),t=="in"?s=x_(n,"+"):t=="out"?s=x_(n,"-"):s=n<1?(10+n+"").substr(1):n+"",(!e||e==fn())&&(mT(s+"%"),X.currZoom=s),Ei("zoom",[+s,r,i],(0,DO.default)(e).attr("c_dbid")))}var S4t=[si.PANEL,si.PANEL_LIB],SJ="You don't have permission to save!";var Bb=class{constructor(e,r={checkTicket:!0}){this.tabid=e;this.options=r;if(!e)throw new Error("invalid tabid");let[i,n]=hO(e);if(this.uuid=i,!this.uuid)throw new Error("invalid uuid");if(this.path=this.options.path||n,!this.path||this.path==="undefined")throw new Error("invalid path");this.docType=this.options.docType||Gc.getTabDocType(e),this.title=this.options.title||Gc.getTabText(e),this.isProjectData=this.path===X.currentProject.projectId}profile(...e){let r=["[SAVE] [PANEL]",`[${this.tabid}]`].concat(e).join(" ");console.profile(r)}async todo(){try{let e;if(this.docType===si.PANEL)e=await this.panel();else if(this.docType===si.PANEL_LIB)e=await this.panelLib();else throw new Error("invalid docType");return e.success||!this.isProjectData&&e.code===SC.PERMISSION_DENIED&&await X.messageBus.rpcCall("/pro-ui/openSaveAsDialog",[this.tabid]),Promise.resolve(e)}catch(e){return console.error(e),Promise.resolve({success:!1,message:e})}}async checkPanel(){let{message:e}=await X.messageBus.rpcCall("isArchive");if(e)return{success:!1};let{hasPermission:r,isExamProjectAndEnd:i}=(await X.windowBridge.rpcCall("/pro-ui/judgePermission",{projectId:X.currentProject.projectId,type:"project_document_update",showErrorMsg:!0},ur())).message;if((BW||!Yg)&&!r)return{success:!1,message:SJ,code:i?0:SC.PERMISSION_DENIED};if(this.options.checkTicket){let{message:n}=await X.messageBus.rpcCall("checkDocs",[!0,[this.tabid]]);if(!n)return{success:!1,message:`Document ${this.title} version is inconsistent!`}}return{success:!0}}async check(){return!NL&&!iq()?(X.messageBus.publish("login"),{success:!1,message:"Not logged in yet, please log in and try again"}):this.tabid&&!Gc.getTabIFrame(this.tabid)?{success:!1,message:"The file hadn't opened which you expected to save!"}:!this.title||this.title.length<1||this.title.length>128?{success:!1,message:"The title length must be between 1~128 characters!"}:this.docType===si.PANEL?this.checkPanel():{success:!0}}async panel(){try{if(this.profile("checking panel owner"),!this.isProjectData){let s=qu("The document {title} you want to save does not belong to the current project!!",{params:{title:this.title}});return Promise.resolve({success:!1,message:s})}this.profile("recheck");let{success:e,message:r,code:i}=await this.check();if(!e)return Promise.resolve({success:e,message:r,code:i});if(this.profile("send 2 indexedDB"),(await Ei("panel/save",[],this.tabid)).success)return g8(this.tabid),X.messageBus.publish("removeUpdateTabHighLight",{tabids:[this.tabid]}),this.profile("save success"),await X.messageBus.rpcCall(U1.LOG.SET,[{type:mC.SAVE,content:[{"Panel Name":this.title}],project_uuid:X.currentProject.projectId}]),setTimeout(()=>{X.messageBus.rpcCall("/pro-ui/generatePreviewImage",[this.tabid,X.currentProject.projectId,"panel"])},50),Promise.resolve({success:!0});{let s="Save failed!";return this.profile("save failed"),Promise.resolve({success:!1,message:s,code:i})}}catch(e){return console.error(e),Promise.resolve({success:!1,message:e})}}async panelLib(){try{this.profile("recheck panelLib");let{success:e,message:r,code:i}=await this.check();if(!e)return Promise.resolve({success:e,message:r,code:i});this.profile("fetching dataStr");let n=await hp.getPanelCompressStr(this.tabid);if(!n||n.length<10||!n.replaceAll('"',"'").startsWith("['DOCTYPE','PANEL'"))throw console.error("failed to fetch dataStr",this.tabid),new Error(`Invalid dataStr ${JSON.stringify(n)}`);this.profile("sending panelLib 2 cloud");let s=this.options.path,a=await Ei("panel/save",[],this.tabid);if(a.success)return g8(this.tabid),this.profile("save success"),Promise.resolve({success:!0});{let o;return a.code===SC.PERMISSION_DENIED?(X.messageBus.publish("projectSaveAsCloud","saveProjectFile"),o=`Panel Lib ${this.title} failed to update title! ${SJ}`):o=`Panel Lib ${this.title} failed to update title! ${a.message}`,this.profile("save failed",o),Promise.resolve({success:!1,message:o,code:a.code})}}catch(e){return console.error(e),Promise.resolve({success:!1,message:e})}}};var TJ=pa(Um());function ZIe(t){Wu({type:"confirm",title:"Notice",icon:"question",message:'Panel ordering data have been generated, please click "OK" button and continue.',onConfirm:()=>{t&&t.startsWith("http")?(open(t,"_blank"),X.messageBus.publish("closeDialog",[["panelProductionOrderDlg-new"]]),X.messageBus.publish("panelOrderingGeneratedAndWillOpenOrderPage",null)):console.error("Invalid URL",t)}})}function IJ(t,e,r,i){let n=0,s=.75,a=!1,o=Date.now(),l=o+3e3,c=1e3;function u(y=0){X.messageBus.publish("progressUpdate",[y,"Posting panel ordering data...",i,null,!1])}let d=()=>u(n),A=()=>{let y=Date.now();if(a){let g=y-o;n=Math.min(1,s+(1-s)*g/c)}else y>=l?n=s:n=Math.min(s,s*(l-y)/(l-o));d(),n<1&&setTimeout(A,100)},h=()=>{a=!0,o=Date.now(),A()};d(),setTimeout(A,100);let f=new FormData;f.append("panel",e,t);for(let y of Object.keys(r))f.append(y,r[y]);console.log(f,e.size);let p=X.apis.others.panelOrder;TJ.default.ajax({url:p,data:f,cache:!1,contentType:!1,processData:!1,type:"POST",dataType:"json",xhrFields:{withCredentials:!1}}).then(function(y){if(h(),!y||!y.success||!y.result){Wu({type:"error",message:y&&y.message||"Load failed!"});return}let{url:g}=y.result;g&&ZIe(g),g&&X.messageBus.publish("sensorsEventsReport",{eventName:"export_panel",eventData:{is_success:!0,file_name:t,is_order:!0}})},function(){h(),Wu({type:"error",message:"Load failed!"})})}function ho(t,e=void 0){var n,s,a,o,l,c;let r=vu(),i=zg();if(h_(t,e,r,i),!!jE(i))switch(t){case"continuousSelection":pc("changeSelectionMode",["continuousSelection"]);break;case"rectangleOutside":pc("changeSelectionMode",["rectangleOutside"]);break;case"rectangleInside":{pc("changeSelectionMode",["rectangleInside"]);break}case"polygonInside":pc("changeSelectionMode",["polygonInside"]);break;case"polygonOutside":pc("changeSelectionMode",["polygonOutside"]);break;case"lineTouched":pc("changeSelectionMode",["lineTouched"]);break;case"select_all":pc(t);break;case"SelectOverlap":pc("panel/select-overlap");break;case"save_all":X.messageBus.rpcCall("saveAllFiles");break;case"file_save":{let d,A=new Bb(r);X.messageBus.publish("ui/startFileSave"),A.todo().then(h=>{h.success?(console.log("save succeed"),d=!0):(console.warn("save failed"),d=!1)}).catch(()=>{console.warn("save error")}).finally(()=>{X.messageBus.publish("ui/completeFileSave",d)});break}case"zoom":tf("");break;case"align_left":case"align_right":case"align_top":case"align_bottom":case"align_horizontal_center":case"align_vertical_center":case"align_horizontal_equidistant":case"align_vertical_equidistant":case"align_left_side_edge_equidistant":case"align_top_side_edge_equidistant":case"align_grid":pc(t);break;case"user_logout":X.messageBus.publish("user_logout");break;case"user_center":let u=open("/account/user/account/overview","_blank");u.sessionStorage.removeItem("tabIds"),u.sessionStorage.removeItem("activeTab");break;case"home":open("/account","_blank");break;case"to_editTag":(0,nl.default)('#mm-common-view>div[cmd="'+t.slice(3)+'"]').trigger("click");break;case"editTag":(0,nl.default)("#toolbar-connect").toggleClass("show-hide"),(0,nl.default)("#toolbar-connect").hasClass("show-hide")?sessionStorage.setItem("toolbar-connect","hide"):sessionStorage.setItem("toolbar-connect","show"),X.messageBus.publish("setTopBarItemChecked",["to_"+t]);break;case"setOriginByCenter":Ei("setOriginByCenter");break;case"selectConnection":Ei("selectConnection");break;case"unlock":case"lock":Ei(t,[]);break;case"toMyHomePage":{if(vb.getValueFromCacheUser("username")){let A;rz?A=window.open("/account/user?shell"):A=window.open("/account/user"),A.sessionStorage.removeItem("tabIds"),A.sessionStorage.removeItem("activeTab")}break}case"adaptAreaSelectionView":Ei("adaptAreaSelectionView",[t,e]),X.messageBus.publish("setTopBarItemChecked",[t]);break;case"adaptSelectionView":Ei("adaptSelectionView",[t,e]);break;case"showTextDialog":QE("text"),X.messageBus.publish("setTopBarItemChecked",[t]);break;case"commonButtonsSetting(PROPERTY)":X.messageBus.publish(t);break;case"rotate_ccw":{Wu({title:"Rotate Selected Objects",type:"prompt",message:"Counter clockwise rotation degrees:",defaultValue:"90",icon:"none",onConfirm:d=>{if(d){if(d%=360,isNaN(d))return Wu({type:"error",message:"Invalid parameters!"}),!1;d!==0&&Ei("rotate",[-d])}}});break}case"panelProductionSVG":case"panelProductionOrder":eBe(e);break;case"panel/3d/order":{let y=function(R=0){X.messageBus.publish("progressUpdate",[R,"Posting panel ordering data...",h,null,!1])},g=function(R=0){X.messageBus.publish("progressUpdate",[R,"Generating panel fabrication file...",h,null,!1])},b=function(R){Wu({type:"confirm",title:"Notice",message:'Panel ordering data have been generated, please click "OK" button and continue.',onConfirm:()=>{R&&R.startsWith("http")?(open(R,"_blank"),(0,nl.default)("#panelProductionOrderDlg").dialog("close")):console.error("Invalid URL",R)}})},E=function(R,q,P){let z=0,W=.75,oe=!1,Ae=Date.now(),me=Ae+3e3,ve=1e3,Le,He=()=>y(z),rt=()=>{let Pe=Date.now();if(oe){let ft=Pe-Ae;z=Math.min(1,W+(1-W)*ft/ve)}else Pe>=me?z=W:z=Math.min(W,W*(me-Pe)/(me-Ae));He(),z<1&&(Le=setTimeout(rt,100))},qe=()=>{oe=!0,Ae=Date.now(),rt()};He(),Le=setTimeout(rt,100);let xt=new FormData;xt.append("panel",q,R);for(let Pe of Object.keys(P))xt.append(Pe,P[Pe]);let Gt=X.apis.others.panelOrder;nl.default.ajax({url:Gt,data:xt,cache:!1,contentType:!1,processData:!1,type:"POST",dataType:"json",xhrFields:{withCredentials:!1}}).then(function(Pe){if(qe(),!Pe||!Pe.success||!Pe.result){Wu({type:"error",message:Pe&&Pe.message||"Load failed!"});return}let{url:ft}=Pe.result;ft&&b(ft)},function(){qe(),Wu({type:"error",message:"Load failed!"})})};if(i!=si.PANEL3D)break;let d=VE().replace(/[^\w\u0080-\uffff]+/g,"_"),A=`Panel_${d}_${ty(new Date,"y-m-d")}`,h=vu(),f=(a=(s=(n=ur().UI)==null?void 0:n.tabBar.getTabById(h))==null?void 0:s.data)==null?void 0:a.panelProductionCache;if(!f)break;let{gJsonCache:p,productionSvg:m}=f;if(!p||!m)break;g(0);let w=Ib(si.PANEL,p,!0),{head:x}=p,{name:I,material:C,thickness:G,print:U,craft:_,desc:H,coverColor:Q,width:j,height:$,backgroundColor:B}=p.head,M={projectUuid:X.currentProject.projectId,uuid:h,editorVersion:Bg,name:I,material:C,thickness:G,print:U,craft:_,desc:H,coverColor:Q,backgroundColor:B,width:j,height:$};if(NL){let R=d+"_"+X.currentProject.title;R=R.replace(/[^\w\u0080-\uffff]+/g,"_"),R=`Panel_${R}_${ty(new Date,"y-m-d")}.epanm`,M.panel_name=R}let v=!1;X.worker.relaunch().rpcCall("/panel/generateProductionFileQuickly",{head:x,productionSvg:m,fileName:A,tabId:h,eeSource:w}).then(({message:R})=>{v=!0,X.worker.terminate();let{buffer:q}=R;if(q){let P=new Blob([q]);E(A,P,M),X.messageBus.publish("/panel/postOrder",{fileName:A,blob:P})}else console.error("Failed to generate panel fabrication file!")}).catch(R=>{X.worker.terminate(),console.error("rpcCall error",R)});let N=X.worker.id;setTimeout(()=>{!v&&N==X.worker.id&&(X.worker.terminate(),X.messageBus.publish("exportTimeOut"))},60*1e3);break}case"panel/3d/download":{if(i!=si.PANEL3D)break;let A=`Panel_${VE().replace(/[^\w\u0080-\uffff]+/g,"_")}_${ty(new Date,"y-m-d")}`,h=vu(),f=(c=(l=(o=ur().UI)==null?void 0:o.tabBar.getTabById(h))==null?void 0:l.data)==null?void 0:c.panelProductionCache;if(!f)break;let{gJsonCache:p,productionSvg:m}=f;if(!p||!m)break;let y=Ib(si.PANEL,p,!0),{head:g}=p,b=!1;X.worker.relaunch().rpcCall("/panel/generateProductionFileQuickly",{head:g,productionSvg:m,fileName:A,tabId:h,eeSource:y}).then(({message:w})=>{b=!0,X.worker.terminate();let{buffer:x}=w;if(x){let I=new Blob([x]);Yg?X.windowBridge.publish("exportFileClientWay",{data:{fileData:x,fileTitle:A,extension:"epanm"}},ur()):pS(I,`${A}.epanm`)}else console.error("Failed to generate panel fabrication file!")}).catch(w=>{X.worker.terminate(),console.error("rpcCall error",w)});let E=X.worker.id;setTimeout(()=>{!b&&E==X.worker.id&&(X.worker.terminate(),X.messageBus.publish("exportTimeOut"))},60*1e3);break}case"panel/closePreview":{X.worker.terminate();break}case"panelPreview2D":{let d=e[1],A=e[2],f=`Panel_${wJ(A)}_${ty(new Date,"y-m-d")}`,p=(0,nl.default)("#panelPreview");d==="panelProductionSVG"?(p=(0,nl.default)("#panelFabricationFileDlg"),(0,nl.default)('input[name="filename"]',p).val(f)):d==="panelProductionOrder"&&(p=(0,nl.default)("#panelProductionOrderDlg")),(0,nl.default)(".preview-box",p).html(""),(0,nl.default)(".preview-operate",p).html(""),(0,nl.default)(".preview-content",p).addClass("loading");let[m]=e;_O(A).then(y=>{tBe(y,p,m)},async y=>{console.error("rpcCall error",y);let g=(await X.windowBridge.rpcCall("i18n","Failed to generate panel fabrication file!",ur())).message;(0,nl.default)(".preview-box",p).html(`<div class="preview-error" style="width: 100%;background:#fff">${g}</div>`),(0,nl.default)(".preview-content",p).removeClass("loading")});break}case"panelPreview3D":{console.log("panelPreview3D");break}default:{let d=t.match(/\((.*?)\)$/);if(d){let h=t.split(d[0])[0],f=d[1];switch(h){case"source":_J(f);break;case"cmd":Ei(f);break;case"zoom":e&&e.clientX!==void 0&&e.clientY!==void 0?tf(f,void 0,{clientX:e.clientX,clientY:e.clientY}):tf(f);break;case"toggle":Ei("forceSwitchSelect"),X.messageBus.publish("setTopBarItemChecked",[t]);break;case"place_part":case"draw":Ei("setToolbarCmd",[t,e]),t!=="place_part(text)"&&X.messageBus.publish("setTopBarItemChecked",[t]);break;default:console.warn(h+", this cmd had not defined");break}return}let A=t.match(/applyFilter\_(.*)/);if(A){let h=A[1];if(h=="More"){X.messageBus.publish("ui/rightPanelTabClick",{tabId:"panel-filter",isTrueClick:!0,isFromRightButton:!0});return}X.messageBus.publish("renderAttributeFilterPanel",{docType:i,tabId:r,configName:h});return}Ei(t,[e]);break}}}async function BJ(t){var l;let e=(l=p8())==null?void 0:l.data,r=e==null?void 0:e["panel-uuid"],i=Ei("getJsonCache",void 0,r),n=i.head.title.replace(/[^\w\u0080-\uffff]+/g,"_"),s=(t.fileName||`Panel_${n}_${ty(new Date,"y-m-d")}`)+".epanm";function a(c=0){X.messageBus.publish("progressUpdate",[c,"Generating panel fabrication file...",r,null,!1])}a(0);let o=Ib(si.PANEL,i,!0);X.worker.relaunch().rpcCall("/panel/generatePanelProductionSvg",{gJsonCache:i,fileName:s,tabId:r,eeSource:o}).then(async({message:c})=>{let{buffer:u}=c;if(u){let d=new Blob([u]);Yg?X.windowBridge.publish("exportFileClientWay",{data:{fileData:u,fileTitle:s,extension:"epanm"}},ur()):pS(d,s),X.messageBus.publish("sensorsEventsReport",{eventName:"export_panel",eventData:{is_success:!0,file_name:s,is_order:!1}}),X.messageBus.publish("exportPanelProductionSVG",null);let A=await Xg("panel/design-check");pc("panel/design-check-show-log",[{type:"success",fileName:s,...A}])}else console.error("Failed to generate panel fabrication file!"),X.messageBus.publish("sensorsEventsReport",{eventName:"export_panel",eventData:{is_success:!1,fail_reason:"Failed to generate panel fabrication file!",file_name:s,is_order:!1}})}).catch(c=>{console.error("rpcCall error",c),X.messageBus.publish("sensorsEventsReport",{eventName:"export_panel",eventData:{is_success:!1,fail_reason:`rpcCall error:${c}`,file_name:s,is_order:!1}})}).finally(a.bind(null,1)).finally(()=>{X.worker.terminate()})}async function eBe(t){var l;let e=(l=p8())==null?void 0:l.data,r=e==null?void 0:e["panel-uuid"],{designCheckWarn:i,type:n}=t,s=Ei("getJsonCache",{},r).head.title;s=s.replace(/[^\w\u0080-\uffff]+/g,"_");let a=`Panel_${s}_${ty(new Date,"y-m-d")}`,o=await Xg("panel/design-check",void 0,r);if(o.fatalErrorCount)return pc("panel/design-check-show-log",[{type:"fail",fileName:a,...o}]),X.messageBus.publish("closeDialog",[["panelProductionOrderDlg-new"]]),il({value:"Checking DRC found fatal error: {0}, operation failed!",options:{0:o.fatalErrorCount}}),o;if(pc("panel/design-check-show-log",[{type:"success",fileName:a,...o}]),(o.errorCount||o.warnCount)&&i){let c;o.errorCount&&!o.warnCount?c="Checking DRC found error: {0}, do you want to confirm before continuing?":!o.errorCount&&o.warnCount?c="Checking DRC found warning: {1}, do you want to confirm before continuing?":c="Checking DRC found error: {0}, warning: {1}, do you want to confirm before continuing?",X.messageBus.publish("panel/design-rule-warn",[{content:c,params:{0:o.errorCount,1:o.warnCount},inputWriting:"Don't show again",confirmText:"Yes,Confirm It",cancelText:"No,Continue Operate",onConfirm(){X.messageBus.publish("closeDialog",[["panelProductionOrderDlg-new"]])},onCancel(){switch(n){case"panelProductionOrder":DJ();break;case"panelProductionSVG":BJ(t);break}X.messageBus.publish("closeDialog",[["panelProductionOrderDlg-new"]])}}])}else n=="panelProductionOrder"?DJ():n=="panelProductionSVG"&&BJ(t);return o}async function DJ(){let t=Ei("getJsonCache"),{width:e,height:r}=Ei("getProductWidthHeight"),i=t.head.title;i=i.replace(/[^\w\u0080-\uffff]+/g,"_");let n=`Panel_${i}_${ty(new Date,"y-m-d")}`,s=vu();function a(U=0){X.messageBus.publish("progressUpdate",[U,"Generating panel fabrication file...",s,null,!1])}function o(U){if(U.length===16)return U.repeat(2);if(U.length===32)return U;let _=U.repeat(2);return _.length>32?_.substring(0,32):_.length<32?_.padEnd(32,"0"):_}function l(U){if(/^[\w\u4e00-\u9fa5\uFF08-\uFF09\x20,.\-$$$$()]+$/.test(U))return U;let H=/[^\w\u4e00-\u9fa5\uFF08-\uFF09\x20,.\-$$$$()]/g;return U.replace(H,"")}a(0);let c=Ib(si.PANEL,t,!0),{name:u,material:d,thickness:A,print:h,craft:f,desc:p,coverColor:m,backgroundColor:y}=t.head,g=l((X.currentProject.title+"_"+VE()).slice(0,80)),b=new Date().getFullYear(),E=(new Date().getMonth()+1).toString().padStart(2,"0"),w=new Date().getDate().toString().padStart(2,"0"),x=new Date().getHours().toString().padStart(2,"0")+new Date().getMinutes().toString().padStart(2,"0")+new Date().getSeconds().toString().padStart(2,"0"),I=`${g}_${b}${E}${w}_${x}.epanm`,C={projectUuid:X.currentProject.projectId,uuid:o(s.split("@")[0])+"@"+s.split("@")[1],editorVersion:Bg,name:u,material:d,thickness:A,print:h,craft:f,desc:p,coverColor:m,backgroundColor:y,width:e,height:r,panel_name:I},G=!1;X.worker.relaunch().rpcCall("/panel/generatePanelProductionOrder",{gJsonCache:t,fileName:n,tabId:s,eeSource:c}).then(({message:U})=>{X.worker.terminate(),G=!0;let{buffer:_,error:H}=U;if(_){let Q=new Blob([_]);IJ(n,Q,C,s)}else console.error("Failed to generate panel fabrication file!",H),Wu({type:"error",message:H.message})}).catch(U=>{X.worker.terminate(),console.error("rpcCall error",U)}).finally(()=>{setTimeout(()=>{G||X.messageBus.publish("exportTimeOut")},1e3),a.bind(null,1)})}async function tBe(t,e,r){(0,nl.default)(".preview-content",e).removeClass("loading"),(0,nl.default)(".preview-box",e).html(t),(0,nl.default)(".preview-box svg",e).css({width:"100%",height:"100%",transform:"translate(0px, 0px)"});let i=(c,u)=>(0,nl.default)(`.preview-box svg > g[id="${c}"]`,e).add(u?(0,nl.default)(`.preview-box svg > g[id="${u}"]`,e):null),n=i("\u767D\u8272\u906E\u76D6\u5C42",c_[3]);n.find('[fill="#000000"]').attr("fill","#ffffff"),n.find('[stroke="#000000"]').attr("stroke","#ffffff");let s=[["All"],["Bun Layer","\u9F13\u5305\u5C42"],["Print Layer","\u6253\u5370\u5C42"],["White Cover Layer","\u767D\u8272\u906E\u76D6\u5C42",c_[3]],["Black Cover Layer","\u9ED1\u8272\u906E\u76D6\u5C42"],["Board Outline Layer","\u677F\u6846\u5C42",c_[1]],["Glue Layer","\u80CC\u80F6\u5C42"],["Lighting Simulation Layer","\u4EFF\u771F\u706F\u5149\u5C42"]].filter((c,u)=>u===0||i(c[1],c[2]).length>0),a=s.map((c,u)=>{let d=c[0],A=!0;return["All","Glue Layer"].includes(d)&&(A=!1),{id:"b"+u,name:d,selected:A,disabled:!1}}),o=(0,nl.default)(".preview-operate",e).get(0),l=r.getComponentByElement(o);l!=null?l.reload(a):l=new r({element:o,bars:a,isThrottle:!1,supportMultiSelect:!0,allId:"b0",icon:"icon-eda-eye",onSwitch:(c,u,d)=>{var A,h;if(c==="b0")(0,nl.default)(".preview-box svg > g",e).toggle(d);else{let f=((A=s[c.slice(1)])==null?void 0:A[1])||"",p=((h=s[c.slice(1)])==null?void 0:h[2])||"";i(f,p).toggle(d)}}})}function PJ(...t){var o,l,c;let e=t[0],r=e.func,i=e.args,n,s,a=this;if(e.uuid)n=Gc.getTabIFrame(e.uuid),s=e.uuid;else{let u=Array.prototype.filter.call(document.querySelectorAll("#tabbar_bodies > div[uuid]"),A=>A.style.display==="none"?!1:A.style.visibility==="visible"),d=u&&u[0]||"";d&&(n=d&&d.querySelector("iframe"),n&&(s=YE(n)))}switch(r){case"getTabIFrame":return Gc.getTabIFrame(i);case"triggerEvent":LJ.apply(a,i);break;case"file_save":ho(r);break;case"save_all":ho(r);break;case"zoom(in)":tf("in",void 0,i[0]);break;case"zoom(out)":tf("out",void 0,i[0]);break;case"zoom":tf(i[0],i[1],i[2],i[3]);break;case"setZoomText":mT.apply(a,i);break;case"updateRuler":i.push(s),X.messageBus.publish("rulerUpdate",[s,i]);break;case"updateMouseXY":uo.updateMouseXY.apply(a,i);break;case"panel/getCrossCursor":return(c=(l=(o=X.profileSetting)==null?void 0:o.commSystemSetting)==null?void 0:l.PANEL_CANVAS)==null?void 0:c.cursor;case"progressUpdate":X.messageBus.publish("progressUpdate",[i[0],i[1],i[2]||s,i[3]]);break;case"show_drawing_attr_dlg":QE(i[0]);break;case"setIsCutPasteFinish":X.messageBus.publish("setIsCutPasteFinish",i[0]);break;case"getIsCutPasteFinish":return X.isCutPasteFinish;case"sheet(toPrevious)":ho("sheet(toPrevious)");break;case"sheet(toNext)":ho("sheet(toNext)");break;case"export(print)":ho("export(print)");break;case"getActiveFileTitle":return VE();default:console.error("no ",r,"plz check code");break}}self.window&&(window.panelCallByEditor=PJ);var rBe=["unlocked","locked","merge","unmerge","visible","invisible","duplicatePaste"];function Ei(t,e=void 0,r=vu()){var n=(Gc.getTabIFrame(r)||{}).contentWindow;try{if(!n||!n.document||n.document.readyState!=="complete")return}catch(a){console.error(a);return}if(n.callCommand&&n.callCommand.hooks&&$t(n.callCommand.hooks,t)||rBe.includes(t))return n.callCommand.invoke.apply(n,[t,e]);try{if(t.indexOf(".")>-1){var s=t.split(".");return s.length===2?t=n[s[0]][s[1]]:s.length===3?t=n[s[0]][s[1]][s[2]]:s.length===4&&(t=n[s[0]][s[1]][s[2]][s[4]]),t.apply(n,e)}else n[t]&&n[t].apply(n,e)}catch{console.error("Invalid editorCall cmd: "+t)}}function LJ(t=void 0,e=void 0){var r=this&&this.frameElement||window.frameElement;if(!(r&&r.getAttribute("blankiframe")))switch(t){case"history_change":let c=function(u,d){X.messageBus.publish("setToolbarItemDisabled",["undo",!u]),X.messageBus.publish("setToolbarItemDisabled",["redo",!d]),X.messageBus.publish("setMenuItemDisabled",["undo",!u]),X.messageBus.publish("setMenuItemDisabled",["redo",!d])},s=YE(r)||e&&e.tabId;var i=vu()===s;let a=arguments[2],o=arguments[3],l=arguments[4];X.messageBus.publish("setTabUnSaved",[s,l?1:0]),i?c(a>0&&o>-1,a>0&&o<a-1):vu()===s&&c(!1,!1);break;case"enable_paste":var n=fn()==r;n&&X.messageBus.publish("updateMenuByDocStatus",t);break;case"editor_load":(0,OJ.default)(r).trigger("editor_load"),X.messageBus.publish("editor_load",[r.id]);break;default:Zn("no ",t,"Plz check code");break}}var hp={getJson:function(t){let e=t;return Ei("getJsonCache",[{uuid:e}],e)},getActiveJson:function(t=void 0){var e=Ei("getJsonCache",[t]);if(e)return delete e.zoom,e},getPanelCompressStr:function(t){var e=Gc.getTabIFrame(t);if(!e)return"";var r=hp.getJson(t),i=r.head.docType;return Ib(i,r)},getActiveCompressStr:function(){return Ei("getActiveCompressStr")}};function g8(t){Ei("updateSaveIndex",[],t),t&&X.messageBus.publish("setTabUnSaved",[t,0])}async function Xg(t,e=[],r){let i=r||vu(),n=Em(i);return n&&n.contentWindow?(await X.windowBridge.rpcCall(t,e,n.contentWindow)).message:null}function pc(t,e,r){r||(r=vu()),e||(e=[]);let n=Em(r);if(!(n&&n.contentWindow))return null;Ei("setTabId",[r],r),X.windowBridge.publish(t,e,n.contentWindow)}async function _J(t){switch(t){case"easyEDA":let e=await hp.getActiveCompressStr();X.messageBus.publish("initViewDocSourceDlgAndOpen",e);break;default:break}}function NJ(t){var r;xb.rebuildPanelThemeCache(t);let e=((r=ur().UI)==null?void 0:r.tabBar.getFilterTabs(["tab_page1","0"]).filter(i=>{var n;return!((n=i==null?void 0:i.data)!=null&&n.isCloseing)}))||[];for(let i of e){let n=i.tabId,s=pT(n);(s==si.PANEL||s==si.PANEL_LIB)&&pc("SET_PANEL_THEME",t,n)}}function QE(t){X.messageBus.publish("showDrawingAttrDlg",[t])}async function RJ(t,e){let r;return t.startsWith('["DOCTYPE","PANEL"')||t instanceof Object?r=await iBe(t,e):r=await Ei("decodeNewJsonStr",[t]),r&&(e.saved=!1,await Ei("uploadJsonCache2",[r,e])),r}function iBe(t,e){let r=e&&e.frame||fn(),i=Ei("getJsonCache"),n=e&&e.notZoom||!1,s=e&&e.uniqueNumber||i.head.uniqueNumber,a=e&&e.title||i.head.title;if(!t||!r||!r.contentWindow)return Wu({type:"error",message:"Invalid Data"}),!1;let o=i.head.displayTitle||a,l=e&&e.docType||i.head.docType;if(typeof t=="string")return bE({dataStr:t,docType:l,sheet_id:s,title:a,display_title:o}).then(d=>c(d),d=>(console.error(d),Wu({type:"error",message:"Invalid Data"}),!1));return c(t);async function c(u){return u}}function wm(t,e={}){let r=[],{forObject:i}=e;for(let n=0,s=t.length;n<s;n+=1){let a=t[n];if(jd(a)){if(n===0||r.at(-1)===g_)continue;r.push(a);continue}if(a.forObject.indexOf(i)>-1){let o=structuredClone(a);r.push(o),Array.isArray(a.submenu)&&(o.submenu=wm(a.submenu,e))}}return r.at(-1)===g_&&r.splice(-1),r[0]===g_&&r.splice(0,1),r}function nBe(t){let e=wm(t,{forObject:1}),r=wm(t,{forObject:"group"}),i=wm(t,{forObject:"dimensionLength"}),n=wm(t,{forObject:"arc"});return{canvas:wm(t,{forObject:0}),group:r,ellipse:e,arc:n,rect:e,circle:e,image:e,text:e,auxiliaryPoint:wm(t,{forObject:3}),auxiliaryLine:wm(t,{forObject:3}),cdot:wm(t,{forObject:2}),dimension:wm(t,{forObject:4}),dimensionLength:i,dimensionAngle:i,dimensionRadius:i}}function sBe(t,e,r){var a;let i=[],n=((a=X.profileSetting)==null?void 0:a.filterConfig)||{},s=n.panel||{};return Object.keys(CS).forEach(o=>{i.push(o,"menu-sep")}),i.push(...Object.keys(s)),i=i.map(o=>{var c;let l=o;return o==((c=n.panelConfigDefault)==null?void 0:c.configName)&&(l+="(Default)"),l=l=="Common"?"Common Used":l,o=="menu-sep"?o:{text:l,forObject:[1,0],forSelection:["none","single","multi"],cmd:`applyFilter_${o}`,disabled:t||e,icon:o==(r==null?void 0:r.configName)?"ok":""}}),i.push("menu-sep",{text:"More...",forObject:[0],forSelection:["none","single","multi"],cmd:"applyFilter_More",disabled:t||e}),i}async function MJ(t){let{isClipboardEmpty:e,objCount:r,isEditCombine:i,aboveCombination:n,hasLocked:s,hasUnLocked:a,hasVisible:o,hasHidden:l,combinationCount:c,checkInHideFlag:u,checkInDisableFlag:d,checkOutHideFlag:A,checkOutDisableFlag:h,filterConfig:f}=t;console.warn(t);let p=d===!0&&A===!1,m=zg()===si.PANEL?X.isProjectReadOnly:!1,y=r>0,g=[{text:"Delete Node",forObject:[2],forSelection:["single"],cmd:"delete",disabled:m||p||!await Xg("isSelectedGroupDeleteByCDot")},{text:"Paste",forObject:[0],forSelection:["single","multi","none"],cmd:"paste",icon:"eda-paste",hotkey:"Ctrl+V",disabled:m||p||e},{text:"Paste In Place",forObject:[0],forSelection:["single","multi","none"],cmd:"pasteInPlace",hotkey:"Ctrl+Shift+V",disabled:m||p||e},"menu-sep",{text:"Fit All in Window",forObject:[0,1,"group","arc",3,4,"dimensionLength"],forSelection:["none","single","multi"],cmd:"fitview",icon:"eda-view-fit-all",i18nContext:"contextMenu"},{text:"Filter",forObject:[0],forSelection:["none","single","multi"],cmd:"opensubmenu-filter",submenu:sBe(m,p,f),disabled:m||p},{text:"Fit Selection View",forObject:[0,1,"group","arc",3,4,"dimensionLength"],forSelection:["none","single","multi"],cmd:"adaptSelectionView",icon:"eda-view-fit-selection",disabled:!y},"menu-sep",{text:"Cut",forObject:[0,1,"group","arc",3,"dimensionLength"],forSelection:["none","single","multi"],cmd:"cut",icon:"eda-cut",disabled:m||p||!y},{text:"Copy",forObject:[0,1,"group","arc",3,"dimensionLength"],forSelection:["none","single","multi"],cmd:"copy",icon:"eda-copy",disabled:!y},{text:"Duplicate to the Original Position",forObject:[0,1,"group","arc",3],forSelection:["none","single","multi"],cmd:"duplicatePaste",icon:"",disabled:m||p||!y},{text:"Delete",forObject:[0,1,"group","arc",3,4,"dimensionLength"],forSelection:["none","single","multi"],cmd:"delete",icon:"eda-delete-trash",disabled:m||p||!y,hotkeyCmd:"Delete",menuHotkeyCmd:"Delete"},{text:"Hide",forObject:[1,"group","arc",3,4,"dimensionLength"],forSelection:["single","multi"],cmd:"hide",disabled:m||p||!o,hide:!o},{text:"Show",forObject:[1,"group","arc",3,4,"dimensionLength"],forSelection:["single","multi"],cmd:"unhide",disabled:m||p||!l,hide:!l},{text:"Lock",forObject:[1,"group","arc",3,"dimensionLength"],forSelection:["single","multi"],cmd:"lock",disabled:m||p||!a,hide:!a},{text:"Unlock",forObject:[1,"group","arc",3,"dimensionLength"],forSelection:["single","multi"],cmd:"unlock",disabled:m||p||!s,hide:!s},"menu-sep",{text:"Level",forObject:[1,"group","arc"],forSelection:["single","multi"],icon:"eda-bring-to-front",cmd:"opensubmenu_level",disabled:m||p,submenu:[{text:"Raise one level",forObject:[1,"group","arc"],forSelection:["single","multi"],cmd:"raise_one_level",icon:"eda-move-up"},{text:"Lower one level",forObject:[1,"group","arc"],forSelection:["single","multi"],cmd:"lower_one_level",icon:"eda-move-down"},{text:"Bring to Front",forObject:[1,"group","arc"],forSelection:["single","multi"],cmd:"bring_to_front",icon:"eda-bring-to-front"},{text:"Send to Back",forObject:[1,"group","arc"],forSelection:["single","multi"],cmd:"send_to_back",icon:"eda-send-to-back"}]},{text:"Select Overlap",forObject:[1,"group","arc",0],forSelection:["single","multi","none"],cmd:"SelectOverlap"},{icon:"eda-group",text:"Group",forObject:[1,"group","arc"],forSelection:["single","multi"],cmd:"opensubmenu-group",submenu:[{text:"Group",forObject:[1,"group","arc"],forSelection:["single"],cmd:"groupSelected",disabled:m||p},{text:"Join Group",forObject:[1,"group","arc"],forSelection:["single"],cmd:"joinGroup",disabled:m||p||c===0},{text:"Remove From Group",forObject:[1,"group","arc"],forSelection:["single"],cmd:"removeFromGroup",disabled:m||p||!i},{text:"Ungroup",forObject:[1,"group","arc"],forSelection:["single"],cmd:"ungroupSelected",disabled:m||p||n.length===0}],disabled:m||p},{text:"Enter Group",forObject:[1,"group","arc",0],forSelection:["single","multi"],cmd:"enterGroup",disabled:n.length===0,hide:n.length===0},{text:"Rotate",forObject:[1,"group","arc","dimensionLength"],forSelection:["single","multi"],icon:"eda-rotate-left",cmd:"opensubmenu-rotate",menuHotkeyCmd:"opensubmenu_rotate",submenu:[{text:"Rotate...",forObject:[1,"group","arc","dimensionLength"],forSelection:["single","multi"],cmd:"rotate_ccw",icon:"eda-rotate-left",disabled:m||p},{text:"Rotate Left",forObject:[1,"group","arc","dimensionLength"],forSelection:["single","multi"],cmd:"rotate_left",icon:"eda-rotate-left",disabled:m||p},{text:"Rotate Right",forObject:[1,"group","arc","dimensionLength"],forSelection:["single","multi"],cmd:"rotate_right",icon:"eda-rotate-right",disabled:m||p}],disabled:m||p},{text:"Flip Right and Left",forObject:[1,"group","arc","dimensionLength"],forSelection:["single","multi"],cmd:"fliph",icon:"eda-flip-horizontally",disabled:m||p},{text:"Flip Up and Down",forObject:[1,"group","arc","dimensionLength"],forSelection:["single","multi"],cmd:"flipv",icon:"eda-flip-vertically",disabled:m||p},{text:"Convert",forObject:[1,"group","arc"],forSelection:["single","multi"],cmd:"opensubmenu_convert",submenu:[{text:"Convert stroke to shape",forObject:[1,"group","arc"],forSelection:["single","multi"],cmd:"convertStrokeToShape",disabled:m||p},{text:"Convert rect or ellipse to path",forObject:[1,"group","arc"],forSelection:["single","multi"],cmd:"convertBaseShapeToPath",disabled:m||p},{text:"Combine shapes",forObject:[1,"group"],forSelection:["multi"],cmd:"combineShapes",disabled:m||p},{text:"Break shape apart",forObject:["group"],forSelection:["single","multi"],cmd:"breakShapeApart",disabled:m||p},{text:"Join path",forObject:[1,"group"],forSelection:["single","multi"],cmd:"joinPath",disabled:m||p},{text:"Reverse path",forObject:[1,"group"],forSelection:["single","multi"],cmd:"reversePath",disabled:m||p},{text:"Simplify path",forObject:[1,"group"],forSelection:["single","multi"],cmd:"simplifyPath",disabled:m||p}],disabled:m||p},"menu-sep",{text:"Refresh...",forObject:[0],forSelection:["single","multi","none"],cmd:"checkDocTicket",disabled:!(await X.messageBus.rpcCall("docNeedUpdate")).message},{text:"Property...",forObject:[0,1,"group","arc",3,4,"dimensionLength"],forSelection:["single","multi","none"],cmd:"openPropertyPanel",icon:"eda-list-2"},{text:"Check Out",forSelection:["none"],forObject:[0],cmd:"check_out",hide:A,disabled:h},{text:"Check In",forObject:[0],cmd:"check_in",forSelection:["none"],hide:u,disabled:d}],b="none",E=+r||0;E===1?b="single":E>1&&(b="multi");let w=[];for(let I=0;I<g.length;I+=1){let C=g[I];if(typeof C=="string"){w.push(C);continue}if(!C.hide&&C.forSelection.indexOf(b)>=0){let G=C.hotkeyCmd||C.cmd,U=C.menuHotkeyCmd||C.cmd;C.hotkeyCmd=G,C.subHotKeyCmd=U,C.submenu&&kJ(C.submenu),w.push(C)}}return nBe(w)}function kJ(t){for(let e of t){if(typeof e=="string")continue;let r=e.hotkeyCmd||e.cmd,i=e.menuHotkeyCmd||e.cmd;e.hotkeyCmd=r,e.subHotKeyCmd=i,e.submenu&&kJ(e.submenu)}}var aBe={6:"panel",10:"panel_lib",8:"panel3D"},oBe={1:"editor",2:"select_canvas",3:"not_select_canvas",4:"draw",5:"place",6:"local"};async function y8(){if(zg()===si.PANEL3D)return 3;let e=await Xg("panel/getDocStatus"),{adaptAreaSelectionView:r,selected:i,cmdToken:n,isPasting:s,isLibPlacing:a,isEditingPath:o,currentEditingComId:l}=e;return n.includes("place_part")||s||a||n.includes("draw(image)")?5:n?4:i||r||o||l?2:3}function lBe(){switch(zg()){case si.PANEL:return 6;case si.PANEL3D:return 8;case si.PANEL_LIB:return 10;default:return null}}var zE=class zE{static async validator(e){if(!aBe[e.range]||!oBe[e.scene])return!1;let r=lBe();if(r==null||e.range!==r)return!1;if(e.scene!==6){let i=await y8();if(e.scene!==i)return!1}return!0}static async performCmd(e){if(!await zE.validator(e))return!1;let r=e.function,i={cmd:r,args:e.args,keyStr:e.keyStr,keyCode:e.keyCode};return zE.hooks[r]?await zE.hooks[r].call(null,i):(console.warn("panel_hotkey ",r+" does not exist! called openTopMenu as default."),gs(i)),h_(e),X.messageBus.publish("sensorsEventsReport",{eventName:"hotkey",eventData:{hotkey:e.keyStr,function:e.funcE}}),!0}};zE.hooks={"openMenu(#mm-common-file)":function(e={}){gs(e)},"opensubmenu-draw-dimension":function(e={}){gs(e)},"opensubmenu-dimension":function(e={}){e.cmd="opensubmenu-dimension-panel",gs(e)},"opensubmenu-panel-arc":function(e={}){gs(e)},"opensubmenu-new":function(e={}){gs(e)},"opensubmenu-import":function(e={}){gs(e)},"opensubmenu-saveas":function(e={}){gs(e)},"opensubmenu-selectobj":function(e={}){gs(e)},"opensubmenu-export":function(e={}){gs(e)},"opensubmenu-recent":function(e={}){gs(e)},"opensubmenu-duplicate-panel":function(e={}){gs(e)},"opensubmenu-delete":function(e={}){gs(e)},"opensubmenu-gridsize":function(e={}){gs(e)},"opensubmenu-gridtype":function(e={}){gs(e)},"opensubmenu-align":function(e={}){gs(e)},"opensubmenu-distribute":function(e={}){gs(e)},"opensubmenu-rotate":function(e={}){gs(e)},"opensubmenu-flip":function(e={}){gs(e)},"opensubmenu-level":function(e={}){gs(e)},"opensubmenu-canvasOrigin":function(e={}){gs(e)},"opensubmenu-system":function(e={}){gs(e)},"opensubmenu-schematic_symbol":function(e={}){gs(e)},"opensubmenu-pcb_footprint":function(e={}){gs(e)},"opensubmenu-panel":function(e={}){gs(e)},"opensubmenu-tabmenu":function(e={}){gs(e)},"opensubmenu-auxiliary":function(e={}){gs(e)},new_board:function(e={}){X.messageBus.publish("doCommand_panel",e)},new_device:function(e={}){e.cmd="new_device",e.args={docType:si.PART},X.messageBus.publish("doCommand_panel",e)},new_NetFlag:function(e={}){e.cmd="new_device",e.args={docType:si.NETFLAG},X.messageBus.publish("doCommand_panel",e)},new_NetPort:function(e={}){e.cmd="new_device",e.args={docType:si.NETPORT},X.messageBus.publish("doCommand_panel",e)},new_Drawing:function(e={}){e.cmd="new_device",e.args={docType:si.SHEET_SYMBOL},X.messageBus.publish("doCommand_panel",e)},new_Non_Electronic:function(e={}){e.cmd="new_device",e.args={docType:si.NONEELEC_SYMBOL},X.messageBus.publish("doCommand_panel",e)},new_schematicLib:function(e={}){X.messageBus.publish("doCommand_panel",e)},new_footprint:function(e={}){X.messageBus.publish("doCommand_panel",e)},new_3D_model:function(e={}){X.messageBus.publish("doCommand_panel",e)},new_CBB:function(e={}){X.messageBus.publish("doCommand_panel",e)},panelProductionOrder:function(e={}){X.messageBus.publish("doCommand_panel",e)},"show_help_file(part_store)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"show_help_file(pcb_manu_facturing)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"show_help_file(3d_cnc)":function(e={}){X.messageBus.publish("doCommand_panel",e)},switchVersion:function(e={}){X.messageBus.publish("doCommand_panel",e)},standard_edition_migration:function(e={}){X.messageBus.publish("doCommand_panel",e)},projectSaveAsCloud:function(e={}){X.messageBus.publish("doCommand_panel",e)},projectSaveAsLocal:function(e={}){X.messageBus.publish("doCommand_panel",e)},docSaveAsCloud:function(e={}){X.messageBus.publish("doCommand_panel",e)},docSaveAsLocal:function(e={}){X.messageBus.publish("doCommand_panel",e)},backup:function(e={}){X.messageBus.publish("doCommand_panel",e)},recovery:function(e={}){X.messageBus.publish("doCommand_panel",e)},cacheRecovery:function(e={}){X.messageBus.publish("doCommand_panel",e)},importDXF:function(e={}){X.messageBus.publish("doCommand_panel",e)},importSVG:function(e={}){X.messageBus.publish("doCommand_panel",e)},insertImage:function(e={}){X.messageBus.publish("doCommand_panel",e)},"importFile(easyeda)":function(e={}){X.messageBus.publish("doCommand_panel",e)},file_open:function(e={}){X.messageBus.publish("doCommand_panel",e)},"importFile(altium)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"importFile(eagle)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"importFile(kicad)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"importFile(pads)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"importFile(protel)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"importFile(ltspice)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"export(filePdf)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"export(panelSVG)":function(e={}){X.messageBus.publish("doCommand_panel",{...e,cmd:"export(fileSVG)"})},exportPng:function(e={}){X.messageBus.publish("doCommand_panel",{...e,cmd:"export(fileImage)"})},closeProject:function(e={}){X.messageBus.publish("doCommand_panel",e)},clearRecentList:function(e={}){X.messageBus.publish("doCommand_panel",e)},"source(easyEDA)":function(e={}){X.messageBus.publish("doCommand_panel",e)},duplicatePaste:function(e={}){X.messageBus.publish("doCommand_panel",e)},"delete-target":function(e={}){X.messageBus.publish("doCommand_panel",e)},"delete-all":function(e={}){X.messageBus.publish("doCommand_panel",e)},continuousSelection:function(e={}){X.messageBus.publish("doCommand_panel",e)},rectangleOutside:function(e={}){X.messageBus.publish("doCommand_panel",e)},rectangleInside:function(e={}){X.messageBus.publish("doCommand_panel",e)},polygonInside:function(e={}){X.messageBus.publish("doCommand_panel",e)},polygonOutside:function(e={}){X.messageBus.publish("doCommand_panel",e)},lineTouched:function(e={}){X.messageBus.publish("doCommand_panel",e)},editArray:function(e={}){X.messageBus.publish("doCommand_panel",e)},boolAggregate:function(e={}){X.messageBus.publish("doCommand_panel",e)},boolSubtraction:function(e={}){X.messageBus.publish("doCommand_panel",e)},boolIntersection:function(e={}){X.messageBus.publish("doCommand_panel",e)},boolExclusive:function(e={}){X.messageBus.publish("doCommand_panel",e)},"draw(pen)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"draw(dimension-xy)":function(e={}){ho(e.cmd,e.args)},"draw(dimension-x)":function(e={}){ho(e.cmd,e.args)},"draw(dimension-y)":function(e={}){ho(e.cmd,e.args)},"draw(dimension)":function(e={}){ho("draw(measure-length)",e.args)},"draw(protractor)":function(e={}){ho("draw(measure-angle)",e.args)},"draw(radius)":function(e={}){ho("draw(measure-radius)",e.args)},"place_auxiliary(crossLine)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"place_auxiliary(verticalLine)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"place_auxiliary(horizontalLine)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"place_auxiliary(point)":function(e={}){X.messageBus.publish("doCommand_panel",e)},Preview2D:function(e={}){X.messageBus.publish("doCommand_panel",e)},Preview3D:function(e={}){X.messageBus.publish("doCommand_panel",e)},adaptAreaSelectionView:function(e={}){X.messageBus.publish("doCommand_panel",e)},"switchGridSizeBtn(size_1)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"switchGridSizeBtn(size_0.5)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"switchGridSizeBtn(size_0.1)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"switchGridSizeBtn(size_0.05)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"switchGridSizeBtn(size_0.01)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"switchGridType(outlets)":function(e={}){e.cmd="switchGridType(dot)",X.messageBus.publish("doCommand_panel",e)},"switchGridType(grid)":function(e={}){e.cmd="switchGridType(line)",X.messageBus.publish("doCommand_panel",e)},"switchGridType(none)":function(e={}){e.cmd="switchGridType(not)",X.messageBus.publish("doCommand_panel",e)},"toolbar_toggle(topbar)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"toolbar_toggle(leftbar)":function(e={}){e.cmd="toolbar_toggle(leftbar)",X.messageBus.publish("doCommand_panel",e)},"toolbar_toggle(rightbar)":function(e={}){e.cmd="toolbar_toggle(rightbar)",X.messageBus.publish("doCommand_panel",e)},operateBottomPanel:function(e={}){e.cmd="toolbar_toggle(bottombar)",X.messageBus.publish("doCommand_panel",e)},rotate_ccw:function(e={}){X.messageBus.publish("doCommand_panel",e)},rotate_right:function(e={}){X.messageBus.publish("doCommand_panel",e)},bring_to_front:function(e={}){X.messageBus.publish("doCommand_panel",e)},send_to_back:function(e={}){X.messageBus.publish("doCommand_panel",e)},"show_help_file(community)":function(e={}){X.messageBus.publish("doCommand_panel",e)},"show_help_file(contact)":function(e={}){X.messageBus.publish("doCommand_panel",e)},show_about:function(e={}){X.messageBus.publish("doCommand_panel",e)},"openMenu(#mm-common-edit)":function(e={}){gs(e)},"openMenu(#mm-common-view)":function(e={}){gs(e)},"openMenu(#mm-common-place)":function(e={}){gs(e)},"openMenu(#mm-common-layout)":function(e={}){gs(e)},"openMenu(#mm-common-fabrication2)":function(e={}){gs(e)},"openMenu(#mm-common-order)":function(e={}){gs(e)},"openMenu(#mm-common-settings)":function(e={}){gs(e)},"openMenu(#mm-common-help)":function(e={}){gs(e)},openProject:function(e={}){X.messageBus.publish("doCommand_panel",e)},newProject:function(e={}){e.cmd="new_project",X.messageBus.publish("doCommand_panel",e)},full_screen:function(e={}){X.messageBus.publish("doCommand_ui",["fullScreen",{keyCode:e.keyCode}])},close_tab:function(){X.messageBus.publish("doCommand_ui",["close_tab"])},close_all_tabs:function(){X.messageBus.publish("doCommand_ui",["close_all_tabs"])},file_save:function(e={}){ho("file_save")},save_all:function(e={}){X.messageBus.publish("doCommand_panel",e)},tutorials:function(){X.messageBus.publish("doCommand_panel",{cmd:"tutorials"})},undo:function(e={}){let r=fn();X.windowBridge.publish("undo",null,r.contentWindow)},redo:function(e={}){let r=fn();X.windowBridge.publish("redo",null,r.contentWindow)},cut:function(e={}){ho("cut")},copy:function(e={}){ho("copy")},paste:function(e={}){ho("paste")},centerViewByCursor:function(e={}){let r=fn();X.windowBridge.publish("centerViewByCursor",null,r.contentWindow)},duplicate:function(e={}){let r=fn();X.windowBridge.publish("duplicate",null,r.contentWindow)},duplicateToCursor:function(e={}){let r=fn();X.windowBridge.publish("duplicate",null,r.contentWindow)},Delete:function(e={}){Ei("delete")},select_all:function(e={}){let r=fn();X.windowBridge.publish("select_all",null,r.contentWindow)},findObjects:function(e={}){ho("findObjects")},"zoom(in)":function(e={}){let r=fn();X.windowBridge.publish("zoom(in)",null,r.contentWindow)},"zoom(out)":function(e={}){let r=fn();X.windowBridge.publish("zoom(out)",null,r.contentWindow)},fitview(){let e=fn();X.windowBridge.publish("fitview",null,e.contentWindow)},SelectOverlap(e){pc("panel/select-overlap")},scrollLeft:function(e={}){if(X.isMouseOnEditFrame){let r=fn();X.windowBridge.publish("moveCanvas",{direction:"Left"},r.contentWindow)}},scrollRight:function(e={}){if(X.isMouseOnEditFrame){let r=fn();X.windowBridge.publish("moveCanvas",{direction:"Right"},r.contentWindow)}},scrollUp:function(e={}){if(X.isMouseOnEditFrame){let r=fn();X.windowBridge.publish("moveCanvas",{direction:"Up"},r.contentWindow)}},scrollDown:function(e={}){if(X.isMouseOnEditFrame){let r=fn();X.windowBridge.publish("moveCanvas",{direction:"Down"},r.contentWindow)}},"draw(rect)":function(e={}){let r=fn();X.windowBridge.publish("draw","draw(rect)",r.contentWindow)},"draw(circle)":function(e={}){let r=fn();X.windowBridge.publish("draw","draw(circle)",r.contentWindow)},"draw(polyline)":function(e={}){let r=fn();X.windowBridge.publish("draw","draw(polyline)",r.contentWindow)},repeat:function(){Ei("repeat")},showTextDialog:function(e={}){let r=fn();X.windowBridge.publish("showTextDialog",null,r.contentWindow)},rotate_left:function(e={}){let r=fn();X.windowBridge.publish("rotate_left",null,r.contentWindow)},align_left:function(e={}){let r=fn();X.windowBridge.publish("align_left",null,r.contentWindow)},align_vertical_center:function(e={}){let r=fn();X.windowBridge.publish("align_vertical_center",null,r.contentWindow)},align_right:function(e={}){let r=fn();X.windowBridge.publish("align_right",null,r.contentWindow)},align_top:function(e={}){let r=fn();X.windowBridge.publish("align_top",null,r.contentWindow)},align_horizontal_center:function(e={}){let r=fn();X.windowBridge.publish("align_horizontal_center",null,r.contentWindow)},align_bottom:function(e={}){let r=fn();X.windowBridge.publish("align_bottom",null,r.contentWindow)},align_grid:function(e={}){let r=fn();X.windowBridge.publish("align_grid",null,r.contentWindow)},align_horizontal_equidistant:function(e={}){let r=fn();X.windowBridge.publish("align_horizontal_equidistant",null,r.contentWindow)},align_vertical_equidistant:function(e={}){let r=fn();X.windowBridge.publish("align_vertical_equidistant",null,r.contentWindow)},fliph:function(e={}){let r=fn();X.windowBridge.publish("fliph",null,r.contentWindow)},flipv:function(e={}){let r=fn();X.windowBridge.publish("flipv",null,r.contentWindow)},moveSelectedLeft(e={}){if(X.isMouseOnEditFrame){let r=fn();X.windowBridge.publish("moveSelected",{args:[-1,0]},r.contentWindow)}},moveSelectedRight(e={}){if(X.isMouseOnEditFrame){let r=fn();X.windowBridge.publish("moveSelected",{args:[1,0]},r.contentWindow)}},moveSelectedUp(e={}){if(X.isMouseOnEditFrame){let r=fn();X.windowBridge.publish("moveSelected",{args:[0,-1]},r.contentWindow)}},moveSelectedDown(e={}){if(X.isMouseOnEditFrame){let r=fn();X.windowBridge.publish("moveSelected",{args:[0,1]},r.contentWindow)}},draw_end:function(e={}){let r=fn();X.windowBridge.publish("draw_end",null,r.contentWindow)},expandAndModifyProperties:function(){X.messageBus.publish("expandAndModifyProperties")},undoDraw:function(e={}){let r=fn();X.windowBridge.publish("undoDraw",null,r.contentWindow)},show_drawing_attr_dlg:function(e={}){QE("text")},switchNextDoc:function(){},switchPreDoc:function(){},setOriginByCoordinate:function(){},"draw(origin)":function(){},toggleLocked:function(){}};var gT=zE;async function gs(t){let e=fn(),r=(await X.windowBridge.rpcCall("panel/getMouseRecorder",null,e.contentWindow)).message;t.args=Object.assign({},r,t.args||{}),X.messageBus.publish("doCommand_panel",t)}PO();var FJ={},cBe=(function(t,e,r,i,n){var s=FJ[e]||(FJ[e]=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))),a=new Worker(s);return a.onerror=function(o){return n(o.error,null)},a.onmessage=function(o){return n(null,o.data)},a.postMessage(r,i),a}),vl=Uint8Array,Cu=Uint16Array,Dy=Uint32Array,wT=new vl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),vT=new vl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),MO=new vl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),VJ=function(t,e){for(var r=new Cu(31),i=0;i<31;++i)r[i]=e+=1<<t[i-1];for(var n=new Dy(r[30]),i=1;i<30;++i)for(var s=r[i];s<r[i+1];++s)n[s]=s-r[i]<<5|i;return[r,n]},jJ=VJ(wT,2),C8=jJ[0],x8=jJ[1];C8[28]=258,x8[258]=28;var QJ=VJ(vT,0),zJ=QJ[0],UJ=QJ[1],kO=new Cu(32768);for(ua=0;ua<32768;++ua)qg=(ua&43690)>>>1|(ua&21845)<<1,qg=(qg&52428)>>>2|(qg&13107)<<2,qg=(qg&61680)>>>4|(qg&3855)<<4,kO[ua]=((qg&65280)>>>8|(qg&255)<<8)>>>1;var qg,ua,dp=(function(t,e,r){for(var i=t.length,n=0,s=new Cu(e);n<i;++n)++s[t[n]-1];var a=new Cu(e);for(n=0;n<e;++n)a[n]=a[n-1]+s[n-1]<<1;var o;if(r){o=new Cu(1<<e);var l=15-e;for(n=0;n<i;++n)if(t[n])for(var c=n<<4|t[n],u=e-t[n],d=a[t[n]-1]++<<u,A=d|(1<<u)-1;d<=A;++d)o[kO[d]>>>l]=c}else for(o=new Cu(i),n=0;n<i;++n)o[n]=kO[a[t[n]-1]++]>>>15-t[n];return o}),_y=new vl(288);for(ua=0;ua<144;++ua)_y[ua]=8;var ua;for(ua=144;ua<256;++ua)_y[ua]=9;var ua;for(ua=256;ua<280;++ua)_y[ua]=7;var ua;for(ua=280;ua<288;++ua)_y[ua]=8;var ua,xT=new vl(32);for(ua=0;ua<32;++ua)xT[ua]=5;var ua,uBe=dp(_y,9,0),XJ=dp(_y,9,1),hBe=dp(xT,5,0),qJ=dp(xT,5,1),OO=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},rf=function(t,e,r){var i=e/8>>0;return(t[i]|t[i+1]<<8)>>>(e&7)&r},NO=function(t,e){var r=e/8>>0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>>(e&7)},UO=function(t){return(t/8>>0)+(t&7&&1)},XE=function(t,e,r){(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length);var i=new(t instanceof Cu?Cu:t instanceof Dy?Dy:vl)(r-e);return i.set(t.subarray(e,r)),i},HO=function(t,e,r){var i=t.length,n=!e||r,s=!r||r.i;r||(r={}),e||(e=new vl(i*3));var a=function(Ae){var me=e.length;if(Ae>me){var ve=new vl(Math.max(me*2,Ae));ve.set(e),e=ve}},o=r.f||0,l=r.p||0,c=r.b||0,u=r.l,d=r.d,A=r.m,h=r.n,f=i*8;do{if(!u){r.f=o=rf(t,l,1);var p=rf(t,l+1,3);if(l+=3,p)if(p==1)u=XJ,d=qJ,A=9,h=5;else if(p==2){var b=rf(t,l,31)+257,E=rf(t,l+10,15)+4,w=b+rf(t,l+5,31)+1;l+=14;for(var x=new vl(w),I=new vl(19),C=0;C<E;++C)I[MO[C]]=rf(t,l+C*3,7);l+=E*3;var G=OO(I),U=(1<<G)-1;if(!s&&l+w*(G+7)>f)break;for(var _=dp(I,G,1),C=0;C<w;){var H=_[rf(t,l,U)];l+=H&15;var m=H>>>4;if(m<16)x[C++]=m;else{var Q=0,j=0;for(m==16?(j=3+rf(t,l,3),l+=2,Q=x[C-1]):m==17?(j=3+rf(t,l,7),l+=3):m==18&&(j=11+rf(t,l,127),l+=7);j--;)x[C++]=Q}}var $=x.subarray(0,b),B=x.subarray(b);A=OO($),h=OO(B),u=dp($,A,1),d=dp(B,h,1)}else throw"invalid block type";else{var m=UO(l)+4,y=t[m-4]|t[m-3]<<8,g=m+y;if(g>i){if(s)throw"unexpected EOF";break}n&&a(c+y),e.set(t.subarray(m,g),c),r.b=c+=y,r.p=l=g*8;continue}if(l>f)throw"unexpected EOF"}n&&a(c+131072);for(var M=(1<<A)-1,v=(1<<h)-1,N=A+h+18;s||l+N<f;){var Q=u[NO(t,l)&M],R=Q>>>4;if(l+=Q&15,l>f)throw"unexpected EOF";if(!Q)throw"invalid length/literal";if(R<256)e[c++]=R;else if(R==256){u=null;break}else{var q=R-254;if(R>264){var C=R-257,P=wT[C];q=rf(t,l,(1<<P)-1)+C8[C],l+=P}var z=d[NO(t,l)&v],W=z>>>4;if(!z)throw"invalid distance";l+=z&15;var B=zJ[W];if(W>3){var P=vT[W];B+=NO(t,l)&(1<<P)-1,l+=P}if(l>f)throw"unexpected EOF";n&&a(c+131072);for(var oe=c+q;c<oe;c+=4)e[c]=e[c-B],e[c+1]=e[c+1-B],e[c+2]=e[c+2-B],e[c+3]=e[c+3-B];c=oe}}r.l=u,r.p=l,r.b=c,u&&(o=1,r.m=A,r.d=d,r.n=h)}while(!o);return c==e.length?e:XE(e,0,c)},Wg=function(t,e,r){r<<=e&7;var i=e/8>>0;t[i]|=r,t[i+1]|=r>>>8},yT=function(t,e,r){r<<=e&7;var i=e/8>>0;t[i]|=r,t[i+1]|=r>>>8,t[i+2]|=r>>>16},b8=function(t,e){for(var r=[],i=0;i<t.length;++i)t[i]&&r.push({s:i,f:t[i]});var n=r.length,s=r.slice();if(!n)return[new vl(0),0];if(n==1){var a=new vl(r[0].s+1);return a[r[0].s]=1,[a,1]}r.sort(function(w,x){return w.f-x.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],c=0,u=1,d=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=n-1;)o=r[r[c].f<r[d].f?c++:d++],l=r[c!=u&&r[c].f<r[d].f?c++:d++],r[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var A=s[0].s,i=1;i<n;++i)s[i].s>A&&(A=s[i].s);var h=new Cu(A+1),f=E8(r[u-1],h,0);if(f>e){var i=0,p=0,m=f-e,y=1<<m;for(s.sort(function(x,I){return h[I.s]-h[x.s]||x.f-I.f});i<n;++i){var g=s[i].s;if(h[g]>e)p+=y-(1<<f-h[g]),h[g]=e;else break}for(p>>>=m;p>0;){var b=s[i].s;h[b]<e?p-=1<<e-h[b]++-1:++i}for(;i>=0&&p;--i){var E=s[i].s;h[E]==e&&(--h[E],++p)}f=e}return[new vl(h),f]},E8=function(t,e,r){return t.s==-1?Math.max(E8(t.l,e,r+1),E8(t.r,e,r+1)):e[t.s]=r},HJ=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Cu(++e),i=0,n=t[0],s=1,a=function(l){r[i++]=l},o=1;o<=e;++o)if(t[o]==n&&o!=e)++s;else{if(!n&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(n),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(n);s=1,n=t[o]}return[r.subarray(0,i),e]},bT=function(t,e){for(var r=0,i=0;i<e.length;++i)r+=t[i]*e[i];return r},RO=function(t,e,r){var i=r.length,n=UO(e+2);t[n]=i&255,t[n+1]=i>>>8,t[n+2]=t[n]^255,t[n+3]=t[n+1]^255;for(var s=0;s<i;++s)t[n+s+4]=r[s];return(n+4+i)*8},GJ=function(t,e,r,i,n,s,a,o,l,c,u){Wg(e,u++,r),++n[256];for(var d=b8(n,15),A=d[0],h=d[1],f=b8(s,15),p=f[0],m=f[1],y=HJ(A),g=y[0],b=y[1],E=HJ(p),w=E[0],x=E[1],I=new Cu(19),C=0;C<g.length;++C)I[g[C]&31]++;for(var C=0;C<w.length;++C)I[w[C]&31]++;for(var G=b8(I,7),U=G[0],_=G[1],H=19;H>4&&!U[MO[H-1]];--H);var Q=c+5<<3,j=bT(n,_y)+bT(s,xT)+a,$=bT(n,A)+bT(s,p)+a+14+3*H+bT(I,U)+(2*I[16]+3*I[17]+7*I[18]);if(Q<=j&&Q<=$)return RO(e,u,t.subarray(l,l+c));var B,M,v,N;if(Wg(e,u,1+($<j)),u+=2,$<j){B=dp(A,h,0),M=A,v=dp(p,m,0),N=p;var R=dp(U,_,0);Wg(e,u,b-257),Wg(e,u+5,x-1),Wg(e,u+10,H-4),u+=14;for(var C=0;C<H;++C)Wg(e,u+3*C,U[MO[C]]);u+=3*H;for(var q=[g,w],P=0;P<2;++P)for(var z=q[P],C=0;C<z.length;++C){var W=z[C]&31;Wg(e,u,R[W]),u+=U[W],W>15&&(Wg(e,u,z[C]>>>5&127),u+=z[C]>>>12)}}else B=uBe,M=_y,v=hBe,N=xT;for(var C=0;C<o;++C)if(i[C]>255){var W=i[C]>>>18&31;yT(e,u,B[W+257]),u+=M[W+257],W>7&&(Wg(e,u,i[C]>>>23&31),u+=wT[W]);var oe=i[C]&31;yT(e,u,v[oe]),u+=N[oe],oe>3&&(yT(e,u,i[C]>>>5&8191),u+=vT[oe])}else yT(e,u,B[i[C]]),u+=M[i[C]];return yT(e,u,B[256]),u+M[256]},dBe=new Dy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ABe=new vl(0),fBe=function(t,e,r,i,n,s){var a=t.length,o=new vl(i+a+5*(1+Math.floor(a/7e3))+n),l=o.subarray(i,o.length-n),c=0;if(!e||a<8)for(var u=0;u<=a;u+=65535){var d=u+65535;d<a?c=RO(l,c,t.subarray(u,d)):(l[u]=s,c=RO(l,c,t.subarray(u,a)))}else{for(var A=dBe[e-1],h=A>>>13,f=A&8191,p=(1<<r)-1,m=new Cu(32768),y=new Cu(p+1),g=Math.ceil(r/3),b=2*g,E=function(Gt){return(t[Gt]^t[Gt+1]<<g^t[Gt+2]<<b)&p},w=new Dy(25e3),x=new Cu(288),I=new Cu(32),C=0,G=0,u=0,U=0,_=0,H=0;u<a;++u){var Q=E(u),j=u&32767,$=y[Q];if(m[j]=$,y[Q]=j,_<=u){var B=a-u;if((C>7e3||U>24576)&&B>423){c=GJ(t,l,0,w,x,I,G,U,H,u-H,c),U=C=G=0,H=u;for(var M=0;M<286;++M)x[M]=0;for(var M=0;M<30;++M)I[M]=0}var v=2,N=0,R=f,q=j-$&32767;if(B>2&&Q==E(u-q))for(var P=Math.min(h,B)-1,z=Math.min(32767,u),W=Math.min(258,B);q<=z&&--R&&j!=$;){if(t[u+v]==t[u+v-q]){for(var oe=0;oe<W&&t[u+oe]==t[u+oe-q];++oe);if(oe>v){if(v=oe,N=q,oe>P)break;for(var Ae=Math.min(q,oe-2),me=0,M=0;M<Ae;++M){var ve=u-q+M+32768&32767,Le=m[ve],He=ve-Le+32768&32767;He>me&&(me=He,$=ve)}}}j=$,$=m[j],q+=j-$+32768&32767}if(N){w[U++]=268435456|x8[v]<<18|UJ[N];var rt=x8[v]&31,qe=UJ[N]&31;G+=wT[rt]+vT[qe],++x[257+rt],++I[qe],_=u+v,++C}else w[U++]=t[u],++x[t[u]]}}c=GJ(t,l,s,w,x,I,G,U,H,u-H,c),s||(c=RO(l,c,ABe))}return XE(o,0,i+UO(c)+n)},pBe=(function(){for(var t=new Dy(256),e=0;e<256;++e){for(var r=e,i=9;--i;)r=(r&1&&3988292384)^r>>>1;t[e]=r}return t})(),mBe=function(){var t=4294967295;return{p:function(e){for(var r=t,i=0;i<e.length;++i)r=pBe[r&255^e[i]]^r>>>8;t=r},d:function(){return t^4294967295}}},WJ=function(){var t=1,e=0;return{p:function(r){for(var i=t,n=e,s=r.length,a=0;a!=s;){for(var o=Math.min(a+5552,s);a<o;++a)i+=r[a],n+=i;i%=65521,n%=65521}t=i,e=n},d:function(){return(t>>>8<<16|(e&255)<<8|e>>>8)+((t&255)<<23)*2}}},GO=function(t,e,r,i,n){return fBe(t,e.level==null?6:e.level,e.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):12+e.mem,r,i,!n)},gBe=function(t,e){var r={};for(var i in t)r[i]=t[i];for(var i in e)r[i]=e[i];return r},YJ=function(t,e,r){for(var i=t(),n=t.toString(),s=n.slice(n.indexOf("[")+1,n.lastIndexOf("]")).replace(/ /g,"").split(","),a=0;a<i.length;++a){var o=i[a],l=s[a];if(typeof o=="function"){e+=";"+l+"=";var c=o.toString();if(o.prototype)if(c.indexOf("[native code]")!=-1){var u=c.indexOf(" ",8)+1;e+=c.slice(u,c.indexOf("(",u))}else{e+=c;for(var d in o.prototype)e+=";"+l+".prototype."+d+"="+o.prototype[d].toString()}else e+=c}else r[l]=o}return[e,r]},LO=[],yBe=function(t){var e=[];for(var r in t)(t[r]instanceof vl||t[r]instanceof Cu||t[r]instanceof Dy)&&e.push((t[r]=new t[r].constructor(t[r])).buffer);return e},bBe=function(t,e,r,i){var n;if(!LO[r]){for(var s="",a={},o=t.length-1,l=0;l<o;++l)n=YJ(t[l],s,a),s=n[0],a=n[1];LO[r]=YJ(t[o],s,a)}var c=gBe({},LO[r][1]);return cBe(LO[r][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",r,c,yBe(c),i)},S8=function(){return[vl,Cu,Dy,wT,vT,MO,C8,zJ,XJ,qJ,kO,dp,OO,rf,NO,UO,XE,HO,BBe,wBe,vBe]};var xBe=function(){return[KJ,SBe]};var EBe=function(){return[$J]},wBe=function(t){return postMessage(t,[t.buffer])},vBe=function(t){return t&&t.size&&new vl(t.size)};var qE=function(t){return t.ondata=function(e,r){return postMessage([e,r],[e.buffer])},function(e){return t.push(e.data[0],e.data[1])}},T8=function(t,e,r,i,n){var s,a=bBe(t,i,n,function(o,l){o?(a.terminate(),e.ondata.call(e,o)):(l[1]&&a.terminate(),e.ondata.call(e,o,l[0],l[1]))});a.postMessage(r),e.push=function(o,l){if(s)throw"stream finished";if(!e.ondata)throw"no stream handler";a.postMessage([o,s=l],[o.buffer])},e.terminate=function(){a.terminate()}};var ET=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},CBe=function(t,e){var r=e.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=e.level<2?4:e.level==9?2:0,t[9]=3,e.mtime!=0&&ET(t,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),r){t[3]=8;for(var i=0;i<=r.length;++i)t[i+10]=r.charCodeAt(i)}},KJ=function(t){if(t[0]!=31||t[1]!=139||t[2]!=8)throw"invalid gzip data";var e=t[3],r=10;e&4&&(r+=t[10]|(t[11]<<8)+2);for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!t[r++]);return r+(e&2)},SBe=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16)+2*(t[e-1]<<23)},TBe=function(t){return 10+(t.filename&&t.filename.length+1||0)},JJ=function(t,e){var r=e.level,i=r==0?0:r<6?1:r==9?3:2;t[0]=120,t[1]=i<<6|(i?32-2*i:1)},$J=function(t){if((t[0]&15)!=8||t[0]>>>4>7||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(t[1]&32)throw"invalid zlib data: preset dictionaries not supported"};var FO=(function(){function t(e,r){!r&&typeof e=="function"&&(r=e,e={}),this.ondata=r,this.o=e||{}}return t.prototype.p=function(e,r){this.ondata(GO(e,this.o,0,0,!r),r)},t.prototype.push=function(e,r){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=r,this.p(e,r||!1)},t})();var Ap=(function(){function t(e){this.s={},this.p=new vl(0),this.ondata=e}return t.prototype.e=function(e){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var r=this.p.length,i=new vl(r+e.length);i.set(this.p),i.set(e,r),this.p=i},t.prototype.c=function(e){this.d=this.s.i=e||!1;var r=this.s.b,i=HO(this.p,this.o,this.s);this.ondata(XE(i,r,this.s.b),this.d),this.o=XE(i,this.s.b-32768),this.s.b=this.o.length,this.p=XE(this.p,this.s.p/8>>0),this.s.p&=7},t.prototype.push=function(e,r){this.e(e),this.c(r)},t})();var IBe=(function(){function t(e){this.ondata=e,T8([S8,function(){return[qE,Ap]}],this,0,function(){var r=new Ap;onmessage=qE(r)},7)}return t})();function BBe(t,e){return HO(t,e)}var $Mt=(function(){function t(e,r){this.c=mBe(),this.l=0,this.v=1,FO.call(this,e,r)}return t.prototype.push=function(e,r){FO.prototype.push.call(this,e,r)},t.prototype.p=function(e,r){this.c.p(e),this.l+=e.length;var i=GO(e,this.o,this.v&&TBe(this.o),r&&8,!r);this.v&&(CBe(i,this.o),this.v=0),r&&(ET(i,i.length-8,this.c.d()),ET(i,i.length-4,this.l)),this.ondata(i,r)},t})();var w8=(function(){function t(e){this.v=1,Ap.call(this,e)}return t.prototype.push=function(e,r){if(Ap.prototype.e.call(this,e),this.v){var i=KJ(this.p);if(i>=this.p.length&&!r)return;this.p=this.p.subarray(i),this.v=0}if(r){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}Ap.prototype.c.call(this,r)},t})();var DBe=(function(){function t(e){this.ondata=e,T8([S8,xBe,function(){return[qE,Ap,w8]}],this,0,function(){var r=new w8;onmessage=qE(r)},9)}return t})();var ZMt=(function(){function t(e,r){this.c=WJ(),this.v=1,FO.call(this,e,r)}return t.prototype.push=function(e,r){FO.prototype.push.call(this,e,r)},t.prototype.p=function(e,r){this.c.p(e);var i=GO(e,this.o,this.v&&2,r&&4,!r);this.v&&(JJ(i,this.o),this.v=0),r&&ET(i,i.length-4,this.c.d()),this.ondata(i,r)},t})();function YO(t,e){e===void 0&&(e={});var r=WJ();r.p(t);var i=GO(t,e,2,4);return JJ(i,e),ET(i,i.length-4,r.d()),i}var v8=(function(){function t(e){this.v=1,Ap.call(this,e)}return t.prototype.push=function(e,r){if(Ap.prototype.e.call(this,e),this.v){if(this.p.length<2&&!r)return;this.p=this.p.subarray(2),this.v=0}if(r){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}Ap.prototype.c.call(this,r)},t})();var _Be=(function(){function t(e){this.ondata=e,T8([S8,EBe,function(){return[qE,Ap,v8]}],this,0,function(){var r=new v8;onmessage=qE(r)},11)}return t})();function ZJ(t,e){return HO(($J(t),t.subarray(2,-4)),e)}var PBe=(function(){function t(e){this.G=w8,this.I=Ap,this.Z=v8,this.ondata=e}return t.prototype.push=function(e,r){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(e,r);else{if(this.p&&this.p.length){var i=new vl(this.p.length+e.length);i.set(this.p),i.set(e,this.p.length)}else this.p=e;if(this.p.length>2){var n=this,s=function(){n.ondata.apply(n,arguments)};this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(s):(this.p[0]&15)!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(s):new this.Z(s),this.s.push(this.p,r),this.p=null}}},t})();var e6t=(function(){function t(e){this.G=DBe,this.I=IBe,this.Z=_Be,this.ondata=e}return t.prototype.push=function(e,r){PBe.prototype.push.call(this,e,r)},t})();var Ki=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function rU(){Ki.console&&typeof Ki.console.log=="function"&&Ki.console.log.apply(Ki.console,arguments)}var Qa={log:rU,warn:function(t){Ki.console&&(typeof Ki.console.warn=="function"?Ki.console.warn.apply(Ki.console,arguments):rU.call(null,arguments))},error:function(t){Ki.console&&(typeof Ki.console.error=="function"?Ki.console.error.apply(Ki.console,arguments):rU(t))}};function iU(t,e,r){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){Gb(i.response,e,r)},i.onerror=function(){Qa.error("could not download file")},i.send()}function _se(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function D3(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var lI,lU,Gb=Ki.saveAs||((typeof window>"u"?"undefined":ys(window))!=="object"||window!==Ki?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var i=Ki.URL||Ki.webkitURL,n=document.createElement("a");e=e||t.name||"download",n.download=e,n.rel="noopener",typeof t=="string"?(n.href=t,n.origin!==location.origin?_se(n.href)?iU(t,e,r):D3(n,n.target="_blank"):D3(n)):(n.href=i.createObjectURL(t),setTimeout((function(){i.revokeObjectURL(n.href)}),4e4),setTimeout((function(){D3(n)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(_se(t))iU(t,e,r);else{var i=document.createElement("a");i.href=t,i.target="_blank",setTimeout((function(){D3(i)}))}else navigator.msSaveOrOpenBlob((function(n,s){return s===void 0?s={autoBom:!1}:ys(s)!=="object"&&(Qa.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n})(t,r),e)}:function(t,e,r,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof t=="string")return iU(t,e,r);var n=t.type==="application/octet-stream",s=/constructor/i.test(Ki.HTMLElement)||Ki.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||n&&s)&&(typeof FileReader>"u"?"undefined":ys(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=a?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=u:location=u,i=null},o.readAsDataURL(t)}else{var l=Ki.URL||Ki.webkitURL,c=l.createObjectURL(t);i?i.location=c:location.href=c,i=null,setTimeout((function(){l.revokeObjectURL(c)}),4e4)}});function Xse(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],i=0;i<r.length;i++){var n=r[i].re,s=r[i].process,a=n.exec(t);a&&(e=s(a),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}function nU(t,e){var r=t[0],i=t[1],n=t[2],s=t[3];r=ah(r,i,n,s,e[0],7,-680876936),s=ah(s,r,i,n,e[1],12,-389564586),n=ah(n,s,r,i,e[2],17,606105819),i=ah(i,n,s,r,e[3],22,-1044525330),r=ah(r,i,n,s,e[4],7,-176418897),s=ah(s,r,i,n,e[5],12,1200080426),n=ah(n,s,r,i,e[6],17,-1473231341),i=ah(i,n,s,r,e[7],22,-45705983),r=ah(r,i,n,s,e[8],7,1770035416),s=ah(s,r,i,n,e[9],12,-1958414417),n=ah(n,s,r,i,e[10],17,-42063),i=ah(i,n,s,r,e[11],22,-1990404162),r=ah(r,i,n,s,e[12],7,1804603682),s=ah(s,r,i,n,e[13],12,-40341101),n=ah(n,s,r,i,e[14],17,-1502002290),r=oh(r,i=ah(i,n,s,r,e[15],22,1236535329),n,s,e[1],5,-165796510),s=oh(s,r,i,n,e[6],9,-1069501632),n=oh(n,s,r,i,e[11],14,643717713),i=oh(i,n,s,r,e[0],20,-373897302),r=oh(r,i,n,s,e[5],5,-701558691),s=oh(s,r,i,n,e[10],9,38016083),n=oh(n,s,r,i,e[15],14,-660478335),i=oh(i,n,s,r,e[4],20,-405537848),r=oh(r,i,n,s,e[9],5,568446438),s=oh(s,r,i,n,e[14],9,-1019803690),n=oh(n,s,r,i,e[3],14,-187363961),i=oh(i,n,s,r,e[8],20,1163531501),r=oh(r,i,n,s,e[13],5,-1444681467),s=oh(s,r,i,n,e[2],9,-51403784),n=oh(n,s,r,i,e[7],14,1735328473),r=lh(r,i=oh(i,n,s,r,e[12],20,-1926607734),n,s,e[5],4,-378558),s=lh(s,r,i,n,e[8],11,-2022574463),n=lh(n,s,r,i,e[11],16,1839030562),i=lh(i,n,s,r,e[14],23,-35309556),r=lh(r,i,n,s,e[1],4,-1530992060),s=lh(s,r,i,n,e[4],11,1272893353),n=lh(n,s,r,i,e[7],16,-155497632),i=lh(i,n,s,r,e[10],23,-1094730640),r=lh(r,i,n,s,e[13],4,681279174),s=lh(s,r,i,n,e[0],11,-358537222),n=lh(n,s,r,i,e[3],16,-722521979),i=lh(i,n,s,r,e[6],23,76029189),r=lh(r,i,n,s,e[9],4,-640364487),s=lh(s,r,i,n,e[12],11,-421815835),n=lh(n,s,r,i,e[15],16,530742520),r=ch(r,i=lh(i,n,s,r,e[2],23,-995338651),n,s,e[0],6,-198630844),s=ch(s,r,i,n,e[7],10,1126891415),n=ch(n,s,r,i,e[14],15,-1416354905),i=ch(i,n,s,r,e[5],21,-57434055),r=ch(r,i,n,s,e[12],6,1700485571),s=ch(s,r,i,n,e[3],10,-1894986606),n=ch(n,s,r,i,e[10],15,-1051523),i=ch(i,n,s,r,e[1],21,-2054922799),r=ch(r,i,n,s,e[8],6,1873313359),s=ch(s,r,i,n,e[15],10,-30611744),n=ch(n,s,r,i,e[6],15,-1560198380),i=ch(i,n,s,r,e[13],21,1309151649),r=ch(r,i,n,s,e[4],6,-145523070),s=ch(s,r,i,n,e[11],10,-1120210379),n=ch(n,s,r,i,e[2],15,718787259),i=ch(i,n,s,r,e[9],21,-343485551),t[0]=Gy(r,t[0]),t[1]=Gy(i,t[1]),t[2]=Gy(n,t[2]),t[3]=Gy(s,t[3])}function U3(t,e,r,i,n,s){return e=Gy(Gy(e,t),Gy(i,s)),Gy(e<<n|e>>>32-n,r)}function ah(t,e,r,i,n,s,a){return U3(e&r|~e&i,t,e,n,s,a)}function oh(t,e,r,i,n,s,a){return U3(e&i|r&~i,t,e,n,s,a)}function lh(t,e,r,i,n,s,a){return U3(e^r^i,t,e,n,s,a)}function ch(t,e,r,i,n,s,a){return U3(r^(e|~i),t,e,n,s,a)}function qse(t){var e,r=t.length,i=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)nU(i,PMe(t.substring(e-64,e)));t=t.substring(e-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)n[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(nU(i,n),e=0;e<16;e++)n[e]=0;return n[14]=8*r,nU(i,n),i}function PMe(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}lI=Ki.atob.bind(Ki),lU=Ki.btoa.bind(Ki);var Pse="0123456789abcdef".split("");function LMe(t){for(var e="",r=0;r<4;r++)e+=Pse[t>>8*r+4&15]+Pse[t>>8*r&15];return e}function OMe(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function cU(t){return qse(t).map(OMe).join("")}var NMe=(function(t){for(var e=0;e<t.length;e++)t[e]=LMe(t[e]);return t.join("")})(qse("hello"))!="5d41402abc4b2a76b9719d911017c592";function Gy(t,e){if(NMe){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}function uU(t,e){var r,i,n,s;if(t!==r){for(var a=(n=t,s=1+(256/t.length>>0),new Array(s+1).join(n)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var u=o[l];c=(c+u+a.charCodeAt(l))%256,o[l]=o[c],o[c]=u}r=t,i=o}else o=i;var d=e.length,A=0,h=0,f="";for(l=0;l<d;l++)h=(h+(u=o[A=(A+1)%256]))%256,o[A]=o[h],o[h]=u,a=o[(o[A]+o[h])%256],f+=String.fromCharCode(e.charCodeAt(l)^a);return f}var Lse={print:4,modify:8,copy:16,"annot-forms":32};function xw(t,e,r,i){this.v=1,this.r=2;var n=192;t.forEach((function(o){if(Lse.perm!==void 0)throw new Error("Invalid permission: "+o);n+=Lse[o]})),this.padding="(\xBFN^Nu\x8AAd\0NV\xFF\xFA\b..\0\xB6\xD0h>\x80/\f\xA9\xFEdSiz";var s=(e+this.padding).substr(0,32),a=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^n)),this.encryptionKey=cU(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=uU(this.encryptionKey,this.padding)}function Ew(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,i=0;i<r;i++){var n=t.charCodeAt(i);n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?e+="#"+("0"+n.toString(16)).slice(-2):e+=t[i]}return e}function Ose(t){if(ys(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,i,n){if(n=n||!1,typeof r!="string"||typeof i!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var s=Math.random().toString(35);return e[r][s]=[i,!!n],s},this.unsubscribe=function(r){for(var i in e)if(e[i][r])return delete e[i][r],Object.keys(e[i]).length===0&&delete e[i],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var i=Array.prototype.slice.call(arguments,1),n=[];for(var s in e[r]){var a=e[r][s];try{a[0].apply(t,i)}catch(o){Ki.console&&Qa.error("jsPDF PubSub Error",o.message,o)}a[1]&&n.push(s)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function k3(t){if(!(this instanceof k3))return new k3(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function Wse(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Yb(t,e,r,i,n){if(!(this instanceof Yb))return new Yb(t,e,r,i,n);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,Wse.call(this,i,n)}function cf(t,e,r,i,n){if(!(this instanceof cf))return new cf(t,e,r,i,n);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,Wse.call(this,i,n)}function ji(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],n=arguments[2],s=arguments[3],a=[],o=1,l=16,c="S",u=null;ys(t=t||{})==="object"&&(r=t.orientation,i=t.unit||i,n=t.format||n,s=t.compress||t.compressPdf||s,(u=t.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(l=t.floatPrecision),c=t.defaultPathOperation||"S"),a=t.filters||(s===!0?["FlateEncode"]:a),i=i||"mm",r=(""+(r||"P")).toLowerCase();var d=t.putOnlyUsedFonts||!1,A={},h={internal:{},__private__:{}};h.__private__.PubSub=Ose;var f="1.3",p=h.__private__.getPdfVersion=function(){return f};h.__private__.setPdfVersion=function(J){f=J};var m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return m};var y=h.__private__.getPageFormat=function(J){return m[J]};n=n||"a4";var g={COMPAT:"compat",ADVANCED:"advanced"},b=g.COMPAT;function E(){this.saveGraphicsState(),Pe(new ai(K,0,0,-K,0,Vs()*K).toString()+" cm"),this.setFontSize(this.getFontSize()/K),c="n",b=g.ADVANCED}function w(){this.restoreGraphicsState(),c="S",b=g.COMPAT}var x=h.__private__.combineFontStyleAndFontWeight=function(J,fe){if(J=="bold"&&fe=="normal"||J=="bold"&&fe==400||J=="normal"&&fe=="italic"||J=="bold"&&fe=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return fe&&(J=fe==400||fe==="normal"?J==="italic"?"italic":"normal":fe!=700&&fe!=="bold"||J!=="normal"?(fe==700?"bold":fe)+""+J:"bold"),J};h.advancedAPI=function(J){var fe=b===g.COMPAT;return fe&&E.call(this),typeof J!="function"||(J(this),fe&&w.call(this)),this},h.compatAPI=function(J){var fe=b===g.ADVANCED;return fe&&w.call(this),typeof J!="function"||(J(this),fe&&E.call(this)),this},h.isAdvancedAPI=function(){return b===g.ADVANCED};var I,C=function(J){if(b!==g.ADVANCED)throw new Error(J+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},G=h.roundToPrecision=h.__private__.roundToPrecision=function(J,fe){var Oe=e||fe;if(isNaN(J)||isNaN(Oe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return J.toFixed(Oe).replace(/0+$/,"")};I=h.hpf=h.__private__.hpf=typeof l=="number"?function(J){if(isNaN(J))throw new Error("Invalid argument passed to jsPDF.hpf");return G(J,l)}:l==="smart"?function(J){if(isNaN(J))throw new Error("Invalid argument passed to jsPDF.hpf");return G(J,J>-1&&J<1?16:5)}:function(J){if(isNaN(J))throw new Error("Invalid argument passed to jsPDF.hpf");return G(J,16)};var U=h.f2=h.__private__.f2=function(J){if(isNaN(J))throw new Error("Invalid argument passed to jsPDF.f2");return G(J,2)},_=h.__private__.f3=function(J){if(isNaN(J))throw new Error("Invalid argument passed to jsPDF.f3");return G(J,3)},H=h.scale=h.__private__.scale=function(J){if(isNaN(J))throw new Error("Invalid argument passed to jsPDF.scale");return b===g.COMPAT?J*K:b===g.ADVANCED?J:void 0},Q=function(J){return b===g.COMPAT?Vs()-J:b===g.ADVANCED?J:void 0},j=function(J){return H(Q(J))};h.__private__.setPrecision=h.setPrecision=function(J){typeof parseInt(J,10)=="number"&&(e=parseInt(J,10))};var $,B="00000000000000000000000000000000",M=h.__private__.getFileId=function(){return B},v=h.__private__.setFileId=function(J){return B=J!==void 0&&/^[a-fA-F0-9]{32}$/.test(J)?J.toUpperCase():B.split("").map((function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))})).join(""),u!==null&&(_n=new xw(u.userPermissions,u.userPassword,u.ownerPassword,B)),B};h.setFileId=function(J){return v(J),this},h.getFileId=function(){return M()};var N=h.__private__.convertDateToPDFDate=function(J){var fe=J.getTimezoneOffset(),Oe=fe<0?"+":"-",Xe=Math.floor(Math.abs(fe/60)),Je=Math.abs(fe%60),_t=[Oe,W(Xe),"'",W(Je),"'"].join("");return["D:",J.getFullYear(),W(J.getMonth()+1),W(J.getDate()),W(J.getHours()),W(J.getMinutes()),W(J.getSeconds()),_t].join("")},R=h.__private__.convertPDFDateToDate=function(J){var fe=parseInt(J.substr(2,4),10),Oe=parseInt(J.substr(6,2),10)-1,Xe=parseInt(J.substr(8,2),10),Je=parseInt(J.substr(10,2),10),_t=parseInt(J.substr(12,2),10),or=parseInt(J.substr(14,2),10);return new Date(fe,Oe,Xe,Je,_t,or,0)},q=h.__private__.setCreationDate=function(J){var fe;if(J===void 0&&(J=new Date),J instanceof Date)fe=N(J);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(J))throw new Error("Invalid argument passed to jsPDF.setCreationDate");fe=J}return $=fe},P=h.__private__.getCreationDate=function(J){var fe=$;return J==="jsDate"&&(fe=R($)),fe};h.setCreationDate=function(J){return q(J),this},h.getCreationDate=function(J){return P(J)};var z,W=h.__private__.padd2=function(J){return("0"+parseInt(J)).slice(-2)},oe=h.__private__.padd2Hex=function(J){return("00"+(J=J.toString())).substr(J.length)},Ae=0,me=[],ve=[],Le=0,He=[],rt=[],qe=!1,xt=ve,Gt=function(){Ae=0,Le=0,ve=[],me=[],He=[],gc=Zi(),jc=Zi()};h.__private__.setCustomOutputDestination=function(J){qe=!0,xt=J};var ut=function(J){qe||(xt=J)};h.__private__.resetCustomOutputDestination=function(){qe=!1,xt=ve};var Pe=h.__private__.out=function(J){return J=J.toString(),Le+=J.length+1,xt.push(J),xt},ft=h.__private__.write=function(J){return Pe(arguments.length===1?J.toString():Array.prototype.join.call(arguments," "))},ht=h.__private__.getArrayBuffer=function(J){for(var fe=J.length,Oe=new ArrayBuffer(fe),Xe=new Uint8Array(Oe);fe--;)Xe[fe]=J.charCodeAt(fe);return Oe},Qt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return Qt};var Yt=t.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(J){return Yt=b===g.ADVANCED?J/K:J,this};var Ft,kt=h.__private__.getFontSize=h.getFontSize=function(){return b===g.COMPAT?Yt:Yt*K},sr=t.R2L||!1;h.__private__.setR2L=h.setR2L=function(J){return sr=J,this},h.__private__.getR2L=h.getR2L=function(){return sr};var Pt,_r=h.__private__.setZoomMode=function(J){var fe=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(J))Ft=J;else if(isNaN(J)){if(fe.indexOf(J)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+J+'" is not recognized.');Ft=J}else Ft=parseInt(J,10)};h.__private__.getZoomMode=function(){return Ft};var Lt,ct=h.__private__.setPageMode=function(J){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(J)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+J+'" is not recognized.');Pt=J};h.__private__.getPageMode=function(){return Pt};var Zt=h.__private__.setLayoutMode=function(J){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(J)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+J+'" is not recognized.');Lt=J};h.__private__.getLayoutMode=function(){return Lt},h.__private__.setDisplayMode=h.setDisplayMode=function(J,fe,Oe){return _r(J),Zt(fe),ct(Oe),this};var Jt={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(J){if(Object.keys(Jt).indexOf(J)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Jt[J]},h.__private__.getDocumentProperties=function(){return Jt},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(J){for(var fe in Jt)Jt.hasOwnProperty(fe)&&J[fe]&&(Jt[fe]=J[fe]);return this},h.__private__.setDocumentProperty=function(J,fe){if(Object.keys(Jt).indexOf(J)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Jt[J]=fe};var O,K,se,ae,ue,Ie={},Ce={},st=[],it={},Kt={},ar={},lr={},yr=null,xi=0,Tr=[],ii=new Ose(h),nn=t.hotfixes||[],sn={},Dn={},Za=[],ai=function J(fe,Oe,Xe,Je,_t,or){if(!(this instanceof J))return new J(fe,Oe,Xe,Je,_t,or);isNaN(fe)&&(fe=1),isNaN(Oe)&&(Oe=0),isNaN(Xe)&&(Xe=0),isNaN(Je)&&(Je=1),isNaN(_t)&&(_t=0),isNaN(or)&&(or=0),this._matrix=[fe,Oe,Xe,Je,_t,or]};Object.defineProperty(ai.prototype,"sx",{get:function(){return this._matrix[0]},set:function(J){this._matrix[0]=J}}),Object.defineProperty(ai.prototype,"shy",{get:function(){return this._matrix[1]},set:function(J){this._matrix[1]=J}}),Object.defineProperty(ai.prototype,"shx",{get:function(){return this._matrix[2]},set:function(J){this._matrix[2]=J}}),Object.defineProperty(ai.prototype,"sy",{get:function(){return this._matrix[3]},set:function(J){this._matrix[3]=J}}),Object.defineProperty(ai.prototype,"tx",{get:function(){return this._matrix[4]},set:function(J){this._matrix[4]=J}}),Object.defineProperty(ai.prototype,"ty",{get:function(){return this._matrix[5]},set:function(J){this._matrix[5]=J}}),Object.defineProperty(ai.prototype,"a",{get:function(){return this._matrix[0]},set:function(J){this._matrix[0]=J}}),Object.defineProperty(ai.prototype,"b",{get:function(){return this._matrix[1]},set:function(J){this._matrix[1]=J}}),Object.defineProperty(ai.prototype,"c",{get:function(){return this._matrix[2]},set:function(J){this._matrix[2]=J}}),Object.defineProperty(ai.prototype,"d",{get:function(){return this._matrix[3]},set:function(J){this._matrix[3]=J}}),Object.defineProperty(ai.prototype,"e",{get:function(){return this._matrix[4]},set:function(J){this._matrix[4]=J}}),Object.defineProperty(ai.prototype,"f",{get:function(){return this._matrix[5]},set:function(J){this._matrix[5]=J}}),Object.defineProperty(ai.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ai.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ai.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ai.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ai.prototype.join=function(J){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(J)},ai.prototype.multiply=function(J){var fe=J.sx*this.sx+J.shy*this.shx,Oe=J.sx*this.shy+J.shy*this.sy,Xe=J.shx*this.sx+J.sy*this.shx,Je=J.shx*this.shy+J.sy*this.sy,_t=J.tx*this.sx+J.ty*this.shx+this.tx,or=J.tx*this.shy+J.ty*this.sy+this.ty;return new ai(fe,Oe,Xe,Je,_t,or)},ai.prototype.decompose=function(){var J=this.sx,fe=this.shy,Oe=this.shx,Xe=this.sy,Je=this.tx,_t=this.ty,or=Math.sqrt(J*J+fe*fe),Nr=(J/=or)*Oe+(fe/=or)*Xe;Oe-=J*Nr,Xe-=fe*Nr;var ei=Math.sqrt(Oe*Oe+Xe*Xe);return Nr/=ei,J*(Xe/=ei)<fe*(Oe/=ei)&&(J=-J,fe=-fe,Nr=-Nr,or=-or),{scale:new ai(or,0,0,ei,0,0),translate:new ai(1,0,0,1,Je,_t),rotate:new ai(J,fe,-fe,J,0,0),skew:new ai(1,0,Nr,1,0,0)}},ai.prototype.toString=function(J){return this.join(" ")},ai.prototype.inversed=function(){var J=this.sx,fe=this.shy,Oe=this.shx,Xe=this.sy,Je=this.tx,_t=this.ty,or=1/(J*Xe-fe*Oe),Nr=Xe*or,ei=-fe*or,Ui=-Oe*or,Si=J*or;return new ai(Nr,ei,Ui,Si,-Nr*Je-Ui*_t,-ei*Je-Si*_t)},ai.prototype.applyToPoint=function(J){var fe=J.x*this.sx+J.y*this.shx+this.tx,Oe=J.x*this.shy+J.y*this.sy+this.ty;return new at(fe,Oe)},ai.prototype.applyToRectangle=function(J){var fe=this.applyToPoint(J),Oe=this.applyToPoint(new at(J.x+J.w,J.y+J.h));return new Ot(fe.x,fe.y,Oe.x-fe.x,Oe.y-fe.y)},ai.prototype.clone=function(){var J=this.sx,fe=this.shy,Oe=this.shx,Xe=this.sy,Je=this.tx,_t=this.ty;return new ai(J,fe,Oe,Xe,Je,_t)},h.Matrix=ai;var xa=h.matrixMult=function(J,fe){return fe.multiply(J)},Lr=new ai(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Lr;var mn=function(J,fe){if(!Kt[J]){var Oe=(fe instanceof Yb?"Sh":"P")+(Object.keys(it).length+1).toString(10);fe.id=Oe,Kt[J]=Oe,it[Oe]=fe,ii.publish("addPattern",fe)}};h.ShadingPattern=Yb,h.TilingPattern=cf,h.addShadingPattern=function(J,fe){return C("addShadingPattern()"),mn(J,fe),this},h.beginTilingPattern=function(J){C("beginTilingPattern()"),Bt(J.boundingBox[0],J.boundingBox[1],J.boundingBox[2]-J.boundingBox[0],J.boundingBox[3]-J.boundingBox[1],J.matrix)},h.endTilingPattern=function(J,fe){C("endTilingPattern()"),fe.stream=rt[z].join(`
`),mn(J,fe),ii.publish("endTilingPattern",fe),Za.pop().restore()};var bs=h.__private__.newObject=function(){var J=Zi();return Do(J,!0),J},Zi=h.__private__.newObjectDeferred=function(){return Ae++,me[Ae]=function(){return Le},Ae},Do=function(J,fe){return fe=typeof fe=="boolean"&&fe,me[J]=Le,fe&&Pe(J+" 0 obj"),J},Su=h.__private__.newAdditionalObject=function(){var J={objId:Zi(),content:""};return He.push(J),J},gc=Zi(),jc=Zi(),ec=h.__private__.decodeColorString=function(J){var fe=J.split(" ");if(fe.length!==2||fe[1]!=="g"&&fe[1]!=="G")fe.length===5&&(fe[4]==="k"||fe[4]==="K")&&(fe=[(1-fe[0])*(1-fe[3]),(1-fe[1])*(1-fe[3]),(1-fe[2])*(1-fe[3]),"r"]);else{var Oe=parseFloat(fe[0]);fe=[Oe,Oe,Oe,"r"]}for(var Xe="#",Je=0;Je<3;Je++)Xe+=("0"+Math.floor(255*parseFloat(fe[Je])).toString(16)).slice(-2);return Xe},Qc=h.__private__.encodeColorString=function(J){var fe;typeof J=="string"&&(J={ch1:J});var Oe=J.ch1,Xe=J.ch2,Je=J.ch3,_t=J.ch4,or=J.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Oe=="string"&&Oe.charAt(0)!=="#"){var Nr=new Xse(Oe);if(Nr.ok)Oe=Nr.toHex();else if(!/^\d*\.?\d*$/.test(Oe))throw new Error('Invalid color "'+Oe+'" passed to jsPDF.encodeColorString.')}if(typeof Oe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Oe)&&(Oe="#"+Oe[1]+Oe[1]+Oe[2]+Oe[2]+Oe[3]+Oe[3]),typeof Oe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Oe)){var ei=parseInt(Oe.substr(1),16);Oe=ei>>16&255,Xe=ei>>8&255,Je=255&ei}if(Xe===void 0||_t===void 0&&Oe===Xe&&Xe===Je)if(typeof Oe=="string")fe=Oe+" "+or[0];else switch(J.precision){case 2:fe=U(Oe/255)+" "+or[0];break;case 3:default:fe=_(Oe/255)+" "+or[0]}else if(_t===void 0||ys(_t)==="object"){if(_t&&!isNaN(_t.a)&&_t.a===0)return fe=["1.","1.","1.",or[1]].join(" ");if(typeof Oe=="string")fe=[Oe,Xe,Je,or[1]].join(" ");else switch(J.precision){case 2:fe=[U(Oe/255),U(Xe/255),U(Je/255),or[1]].join(" ");break;default:case 3:fe=[_(Oe/255),_(Xe/255),_(Je/255),or[1]].join(" ")}}else if(typeof Oe=="string")fe=[Oe,Xe,Je,_t,or[2]].join(" ");else switch(J.precision){case 2:fe=[U(Oe),U(Xe),U(Je),U(_t),or[2]].join(" ");break;case 3:default:fe=[_(Oe),_(Xe),_(Je),_(_t),or[2]].join(" ")}return fe},Uo=h.__private__.getFilters=function(){return a},ul=h.__private__.putStream=function(J){var fe=(J=J||{}).data||"",Oe=J.filters||Uo(),Xe=J.alreadyAppliedFilters||[],Je=J.addLength1||!1,_t=fe.length,or=J.objectId,Nr=function(Ea){return Ea};if(u!==null&&or===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(Nr=_n.encryptor(or,0));var ei={};Oe===!0&&(Oe=["FlateEncode"]);var Ui=J.additionalKeyValues||[],Si=(ei=ji.API.processDataByFilters!==void 0?ji.API.processDataByFilters(fe,Oe):{data:fe,reverseChain:[]}).reverseChain+(Array.isArray(Xe)?Xe.join(" "):Xe.toString());if(ei.data.length!==0&&(Ui.push({key:"Length",value:ei.data.length}),Je===!0&&Ui.push({key:"Length1",value:_t})),Si.length!=0)if(Si.split("/").length-1==1)Ui.push({key:"Filter",value:Si});else{Ui.push({key:"Filter",value:"["+Si+"]"});for(var Vi=0;Vi<Ui.length;Vi+=1)if(Ui[Vi].key==="DecodeParms"){for(var gi=[],$n=0;$n<ei.reverseChain.split("/").length-1;$n+=1)gi.push("null");gi.push(Ui[Vi].value),Ui[Vi].value="["+gi.join(" ")+"]"}}Pe("<<");for(var La=0;La<Ui.length;La++)Pe("/"+Ui[La].key+" "+Ui[La].value);Pe(">>"),ei.data.length!==0&&(Pe("stream"),Pe(Nr(ei.data)),Pe("endstream"))},hl=h.__private__.putPage=function(J){var fe=J.number,Oe=J.data,Xe=J.objId,Je=J.contentsObjId;Do(Xe,!0),Pe("<</Type /Page"),Pe("/Parent "+J.rootDictionaryObjId+" 0 R"),Pe("/Resources "+J.resourceDictionaryObjId+" 0 R"),Pe("/MediaBox ["+parseFloat(I(J.mediaBox.bottomLeftX))+" "+parseFloat(I(J.mediaBox.bottomLeftY))+" "+I(J.mediaBox.topRightX)+" "+I(J.mediaBox.topRightY)+"]"),J.cropBox!==null&&Pe("/CropBox ["+I(J.cropBox.bottomLeftX)+" "+I(J.cropBox.bottomLeftY)+" "+I(J.cropBox.topRightX)+" "+I(J.cropBox.topRightY)+"]"),J.bleedBox!==null&&Pe("/BleedBox ["+I(J.bleedBox.bottomLeftX)+" "+I(J.bleedBox.bottomLeftY)+" "+I(J.bleedBox.topRightX)+" "+I(J.bleedBox.topRightY)+"]"),J.trimBox!==null&&Pe("/TrimBox ["+I(J.trimBox.bottomLeftX)+" "+I(J.trimBox.bottomLeftY)+" "+I(J.trimBox.topRightX)+" "+I(J.trimBox.topRightY)+"]"),J.artBox!==null&&Pe("/ArtBox ["+I(J.artBox.bottomLeftX)+" "+I(J.artBox.bottomLeftY)+" "+I(J.artBox.topRightX)+" "+I(J.artBox.topRightY)+"]"),typeof J.userUnit=="number"&&J.userUnit!==1&&Pe("/UserUnit "+J.userUnit),ii.publish("putPage",{objId:Xe,pageContext:Tr[fe],pageNumber:fe,page:Oe}),Pe("/Contents "+Je+" 0 R"),Pe(">>"),Pe("endobj");var _t=Oe.join(`
`);return b===g.ADVANCED&&(_t+=`
Q`),Do(Je,!0),ul({data:_t,filters:Uo(),objectId:Je}),Pe("endobj"),Xe},Ms=h.__private__.putPages=function(){var J,fe,Oe=[];for(J=1;J<=xi;J++)Tr[J].objId=Zi(),Tr[J].contentsObjId=Zi();for(J=1;J<=xi;J++)Oe.push(hl({number:J,data:rt[J],objId:Tr[J].objId,contentsObjId:Tr[J].contentsObjId,mediaBox:Tr[J].mediaBox,cropBox:Tr[J].cropBox,bleedBox:Tr[J].bleedBox,trimBox:Tr[J].trimBox,artBox:Tr[J].artBox,userUnit:Tr[J].userUnit,rootDictionaryObjId:gc,resourceDictionaryObjId:jc}));Do(gc,!0),Pe("<</Type /Pages");var Xe="/Kids [";for(fe=0;fe<xi;fe++)Xe+=Oe[fe]+" 0 R ";Pe(Xe+"]"),Pe("/Count "+xi),Pe(">>"),Pe("endobj"),ii.publish("postPutPages")},Tu=function(J){ii.publish("putFont",{font:J,out:Pe,newObject:bs,putStream:ul}),J.isAlreadyPutted!==!0&&(J.objectNumber=bs(),Pe("<<"),Pe("/Type /Font"),Pe("/BaseFont /"+Ew(J.postScriptName)),Pe("/Subtype /Type1"),typeof J.encoding=="string"&&Pe("/Encoding /"+J.encoding),Pe("/FirstChar 32"),Pe("/LastChar 255"),Pe(">>"),Pe("endobj"))},ha=function(){for(var J in Ie)Ie.hasOwnProperty(J)&&(d===!1||d===!0&&A.hasOwnProperty(J))&&Tu(Ie[J])},Sd=function(J){J.objectNumber=bs();var fe=[];fe.push({key:"Type",value:"/XObject"}),fe.push({key:"Subtype",value:"/Form"}),fe.push({key:"BBox",value:"["+[I(J.x),I(J.y),I(J.x+J.width),I(J.y+J.height)].join(" ")+"]"}),fe.push({key:"Matrix",value:"["+J.matrix.toString()+"]"});var Oe=J.pages[1].join(`
`);ul({data:Oe,additionalKeyValues:fe,objectId:J.objectNumber}),Pe("endobj")},is=function(){for(var J in sn)sn.hasOwnProperty(J)&&Sd(sn[J])},uh=function(J,fe){var Oe,Xe=[],Je=1/(fe-1);for(Oe=0;Oe<1;Oe+=Je)Xe.push(Oe);if(Xe.push(1),J[0].offset!=0){var _t={offset:0,color:J[0].color};J.unshift(_t)}if(J[J.length-1].offset!=1){var or={offset:1,color:J[J.length-1].color};J.push(or)}for(var Nr="",ei=0,Ui=0;Ui<Xe.length;Ui++){for(Oe=Xe[Ui];Oe>J[ei+1].offset;)ei++;var Si=J[ei].offset,Vi=(Oe-Si)/(J[ei+1].offset-Si),gi=J[ei].color,$n=J[ei+1].color;Nr+=oe(Math.round((1-Vi)*gi[0]+Vi*$n[0]).toString(16))+oe(Math.round((1-Vi)*gi[1]+Vi*$n[1]).toString(16))+oe(Math.round((1-Vi)*gi[2]+Vi*$n[2]).toString(16))}return Nr.trim()},Iu=function(J,fe){fe||(fe=21);var Oe=bs(),Xe=uh(J.colors,fe),Je=[];Je.push({key:"FunctionType",value:"0"}),Je.push({key:"Domain",value:"[0.0 1.0]"}),Je.push({key:"Size",value:"["+fe+"]"}),Je.push({key:"BitsPerSample",value:"8"}),Je.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Je.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ul({data:Xe,additionalKeyValues:Je,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Oe}),Pe("endobj"),J.objectNumber=bs(),Pe("<< /ShadingType "+J.type),Pe("/ColorSpace /DeviceRGB");var _t="/Coords ["+I(parseFloat(J.coords[0]))+" "+I(parseFloat(J.coords[1]))+" ";J.type===2?_t+=I(parseFloat(J.coords[2]))+" "+I(parseFloat(J.coords[3])):_t+=I(parseFloat(J.coords[2]))+" "+I(parseFloat(J.coords[3]))+" "+I(parseFloat(J.coords[4]))+" "+I(parseFloat(J.coords[5])),Pe(_t+="]"),J.matrix&&Pe("/Matrix ["+J.matrix.toString()+"]"),Pe("/Function "+Oe+" 0 R"),Pe("/Extend [true true]"),Pe(">>"),Pe("endobj")},oA=function(J,fe){var Oe=Zi(),Xe=bs();fe.push({resourcesOid:Oe,objectOid:Xe}),J.objectNumber=Xe;var Je=[];Je.push({key:"Type",value:"/Pattern"}),Je.push({key:"PatternType",value:"1"}),Je.push({key:"PaintType",value:"1"}),Je.push({key:"TilingType",value:"1"}),Je.push({key:"BBox",value:"["+J.boundingBox.map(I).join(" ")+"]"}),Je.push({key:"XStep",value:I(J.xStep)}),Je.push({key:"YStep",value:I(J.yStep)}),Je.push({key:"Resources",value:Oe+" 0 R"}),J.matrix&&Je.push({key:"Matrix",value:"["+J.matrix.toString()+"]"}),ul({data:J.stream,additionalKeyValues:Je,objectId:J.objectNumber}),Pe("endobj")},yc=function(J){var fe;for(fe in it)it.hasOwnProperty(fe)&&(it[fe]instanceof Yb?Iu(it[fe]):it[fe]instanceof cf&&oA(it[fe],J))},lA=function(J){for(var fe in J.objectNumber=bs(),Pe("<<"),J)switch(fe){case"opacity":Pe("/ca "+U(J[fe]));break;case"stroke-opacity":Pe("/CA "+U(J[fe]))}Pe(">>"),Pe("endobj")},Bu=function(){var J;for(J in ar)ar.hasOwnProperty(J)&&lA(ar[J])},Du=function(){for(var J in Pe("/XObject <<"),sn)sn.hasOwnProperty(J)&&sn[J].objectNumber>=0&&Pe("/"+J+" "+sn[J].objectNumber+" 0 R");ii.publish("putXobjectDict"),Pe(">>")},uf=function(){_n.oid=bs(),Pe("<<"),Pe("/Filter /Standard"),Pe("/V "+_n.v),Pe("/R "+_n.r),Pe("/U <"+_n.toHexString(_n.U)+">"),Pe("/O <"+_n.toHexString(_n.O)+">"),Pe("/P "+_n.P),Pe(">>"),Pe("endobj")},Bl=function(){for(var J in Pe("/Font <<"),Ie)Ie.hasOwnProperty(J)&&(d===!1||d===!0&&A.hasOwnProperty(J))&&Pe("/"+J+" "+Ie[J].objectNumber+" 0 R");Pe(">>")},_u=function(){if(Object.keys(it).length>0){for(var J in Pe("/Shading <<"),it)it.hasOwnProperty(J)&&it[J]instanceof Yb&&it[J].objectNumber>=0&&Pe("/"+J+" "+it[J].objectNumber+" 0 R");ii.publish("putShadingPatternDict"),Pe(">>")}},Pu=function(J){if(Object.keys(it).length>0){for(var fe in Pe("/Pattern <<"),it)it.hasOwnProperty(fe)&&it[fe]instanceof h.TilingPattern&&it[fe].objectNumber>=0&&it[fe].objectNumber<J&&Pe("/"+fe+" "+it[fe].objectNumber+" 0 R");ii.publish("putTilingPatternDict"),Pe(">>")}},hh=function(){if(Object.keys(ar).length>0){var J;for(J in Pe("/ExtGState <<"),ar)ar.hasOwnProperty(J)&&ar[J].objectNumber>=0&&Pe("/"+J+" "+ar[J].objectNumber+" 0 R");ii.publish("putGStateDict"),Pe(">>")}},xn=function(J){Do(J.resourcesOid,!0),Pe("<<"),Pe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Bl(),_u(),Pu(J.objectOid),hh(),Du(),Pe(">>"),Pe("endobj")},dl=function(){var J=[];ha(),Bu(),is(),yc(J),ii.publish("putResources"),J.forEach(xn),xn({resourcesOid:jc,objectOid:Number.MAX_SAFE_INTEGER}),ii.publish("postPutResources")},zc=function(){ii.publish("putAdditionalObjects");for(var J=0;J<He.length;J++){var fe=He[J];Do(fe.objId,!0),Pe(fe.content),Pe("endobj")}ii.publish("postPutAdditionalObjects")},dh=function(J){Ce[J.fontName]=Ce[J.fontName]||{},Ce[J.fontName][J.fontStyle]=J.id},hf=function(J,fe,Oe,Xe,Je){var _t={id:"F"+(Object.keys(Ie).length+1).toString(10),postScriptName:J,fontName:fe,fontStyle:Oe,encoding:Xe,isStandardFont:Je||!1,metadata:{}};return ii.publish("addFont",{font:_t,instance:this}),Ie[_t.id]=_t,dh(_t),_t.id},za=function(J){for(var fe=0,Oe=Qt.length;fe<Oe;fe++){var Xe=hf.call(this,J[fe][0],J[fe][1],J[fe][2],Qt[fe][3],!0);d===!1&&(A[Xe]=!0);var Je=J[fe][0].split("-");dh({id:Xe,fontName:Je[0],fontStyle:Je[1]||""})}ii.publish("addFonts",{fonts:Ie,dictionary:Ce})},Ho=function(J){return J.foo=function(){try{return J.apply(this,arguments)}catch(Xe){var fe=Xe.stack||"";~fe.indexOf(" at ")&&(fe=fe.split(" at ")[1]);var Oe="Error in function "+fe.split(`
`)[0].split("<")[0]+": "+Xe.message;if(!Ki.console)throw new Error(Oe);Ki.console.error(Oe,Xe),Ki.alert&&alert(Oe)}},J.foo.bar=J,J.foo},Dl=function(J,fe){var Oe,Xe,Je,_t,or,Nr,ei,Ui,Si;if(Je=(fe=fe||{}).sourceEncoding||"Unicode",or=fe.outputEncoding,(fe.autoencode||or)&&Ie[O].metadata&&Ie[O].metadata[Je]&&Ie[O].metadata[Je].encoding&&(_t=Ie[O].metadata[Je].encoding,!or&&Ie[O].encoding&&(or=Ie[O].encoding),!or&&_t.codePages&&(or=_t.codePages[0]),typeof or=="string"&&(or=_t[or]),or)){for(ei=!1,Nr=[],Oe=0,Xe=J.length;Oe<Xe;Oe++)(Ui=or[J.charCodeAt(Oe)])?Nr.push(String.fromCharCode(Ui)):Nr.push(J[Oe]),Nr[Oe].charCodeAt(0)>>8&&(ei=!0);J=Nr.join("")}for(Oe=J.length;ei===void 0&&Oe!==0;)J.charCodeAt(Oe-1)>>8&&(ei=!0),Oe--;if(!ei)return J;for(Nr=fe.noBOM?[]:[254,255],Oe=0,Xe=J.length;Oe<Xe;Oe++){if((Si=(Ui=J.charCodeAt(Oe))>>8)>>8)throw new Error("Character at position "+Oe+" of string '"+J+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Nr.push(Si),Nr.push(Ui-(Si<<8))}return String.fromCharCode.apply(void 0,Nr)},Xa=h.__private__.pdfEscape=h.pdfEscape=function(J,fe){return Dl(J,fe).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},cA=h.__private__.beginPage=function(J){rt[++xi]=[],Tr[xi]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(J[0]),topRightY:Number(J[1])}},Td(xi),ut(rt[z])},df=function(J,fe){var Oe,Xe,Je;switch(r=fe||r,typeof J=="string"&&(Oe=y(J.toLowerCase()),Array.isArray(Oe)&&(Xe=Oe[0],Je=Oe[1])),Array.isArray(J)&&(Xe=J[0]*K,Je=J[1]*K),isNaN(Xe)&&(Xe=n[0],Je=n[1]),(Xe>14400||Je>14400)&&(Qa.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Xe=Math.min(14400,Xe),Je=Math.min(14400,Je)),n=[Xe,Je],r.substr(0,1)){case"l":Je>Xe&&(n=[Je,Xe]);break;case"p":Xe>Je&&(n=[Je,Xe])}cA(n),gf(Mh),Pe(S),ye!==0&&Pe(ye+" J"),Qe!==0&&Pe(Qe+" j"),ii.publish("addPage",{pageNumber:xi})},_l=function(J){J>0&&J<=xi&&(rt.splice(J,1),Tr.splice(J,1),xi--,z>xi&&(z=xi),this.setPage(z))},Td=function(J){J>0&&J<=xi&&(z=J)},Oh=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return rt.length-1},Lu=function(J,fe,Oe){var Xe,Je=void 0;return Oe=Oe||{},J=J!==void 0?J:Ie[O].fontName,fe=fe!==void 0?fe:Ie[O].fontStyle,Xe=J.toLowerCase(),Ce[Xe]!==void 0&&Ce[Xe][fe]!==void 0?Je=Ce[Xe][fe]:Ce[J]!==void 0&&Ce[J][fe]!==void 0?Je=Ce[J][fe]:Oe.disableWarning===!1&&Qa.warn("Unable to look up font label for font '"+J+"', '"+fe+"'. Refer to getFontList() for available fonts."),Je||Oe.noFallback||(Je=Ce.times[fe])==null&&(Je=Ce.times.normal),Je},uA=h.__private__.putInfo=function(){var J=bs(),fe=function(Xe){return Xe};for(var Oe in u!==null&&(fe=_n.encryptor(J,0)),Pe("<<"),Pe("/Producer ("+Xa(fe("jsPDF "+ji.version))+")"),Jt)Jt.hasOwnProperty(Oe)&&Jt[Oe]&&Pe("/"+Oe.substr(0,1).toUpperCase()+Oe.substr(1)+" ("+Xa(fe(Jt[Oe]))+")");Pe("/CreationDate ("+Xa(fe($))+")"),Pe(">>"),Pe("endobj")},qa=h.__private__.putCatalog=function(J){var fe=(J=J||{}).rootDictionaryObjId||gc;switch(bs(),Pe("<<"),Pe("/Type /Catalog"),Pe("/Pages "+fe+" 0 R"),Ft||(Ft="fullwidth"),Ft){case"fullwidth":Pe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Pe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Pe("/OpenAction [3 0 R /Fit]");break;case"original":Pe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Oe=""+Ft;Oe.substr(Oe.length-1)==="%"&&(Ft=parseInt(Ft)/100),typeof Ft=="number"&&Pe("/OpenAction [3 0 R /XYZ null null "+U(Ft)+"]")}switch(Lt||(Lt="continuous"),Lt){case"continuous":Pe("/PageLayout /OneColumn");break;case"single":Pe("/PageLayout /SinglePage");break;case"two":case"twoleft":Pe("/PageLayout /TwoColumnLeft");break;case"tworight":Pe("/PageLayout /TwoColumnRight")}Pt&&Pe("/PageMode /"+Pt),ii.publish("putCatalog"),Pe(">>"),Pe("endobj")},Pl=h.__private__.putTrailer=function(){Pe("trailer"),Pe("<<"),Pe("/Size "+(Ae+1)),Pe("/Root "+Ae+" 0 R"),Pe("/Info "+(Ae-1)+" 0 R"),u!==null&&Pe("/Encrypt "+_n.oid+" 0 R"),Pe("/ID [ <"+B+"> <"+B+"> ]"),Pe(">>")},Id=h.__private__.putHeader=function(){Pe("%PDF-"+f),Pe("%\xBA\xDF\xAC\xE0")},hA=h.__private__.putXRef=function(){var J="0000000000";Pe("xref"),Pe("0 "+(Ae+1)),Pe("0000000000 65535 f ");for(var fe=1;fe<=Ae;fe++)typeof me[fe]=="function"?Pe((J+me[fe]()).slice(-10)+" 00000 n "):me[fe]!==void 0?Pe((J+me[fe]).slice(-10)+" 00000 n "):Pe("0000000000 00000 n ")},Al=h.__private__.buildDocument=function(){Gt(),ut(ve),ii.publish("buildDocument"),Id(),Ms(),zc(),dl(),u!==null&&uf(),uA(),qa();var J=Le;return hA(),Pl(),Pe("startxref"),Pe(""+J),Pe("%%EOF"),ut(rt[z]),ve.join(`
`)},eo=h.__private__.getBlob=function(J){return new Blob([ht(J)],{type:"application/pdf"})},Nh=h.output=h.__private__.output=Ho((function(J,fe){switch(typeof(fe=fe||{})=="string"?fe={filename:fe}:fe.filename=fe.filename||"generated.pdf",J){case void 0:return Al();case"save":h.save(fe.filename);break;case"arraybuffer":return ht(Al());case"blob":return eo(Al());case"bloburi":case"bloburl":if(Ki.URL!==void 0&&typeof Ki.URL.createObjectURL=="function")return Ki.URL&&Ki.URL.createObjectURL(eo(Al()))||void 0;Qa.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Oe="",Xe=Al();try{Oe=lU(Xe)}catch{Oe=lU(unescape(encodeURIComponent(Xe)))}return"data:application/pdf;filename="+fe.filename+";base64,"+Oe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ki)==="[object Window]"){var Je="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",_t=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';fe.pdfObjectUrl&&(Je=fe.pdfObjectUrl,_t="");var or='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Je+'"'+_t+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(fe)+");<\/script></body></html>",Nr=Ki.open();return Nr!==null&&Nr.document.write(or),Nr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ki)==="[object Window]"){var ei='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(fe.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+fe.filename+'" width="500px" height="400px" /></body></html>',Ui=Ki.open();if(Ui!==null){Ui.document.write(ei);var Si=this;Ui.document.documentElement.querySelector("#pdfViewer").onload=function(){Ui.document.title=fe.filename,Ui.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Si.output("bloburl"))}}return Ui}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ki)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Vi='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",fe)+'"></iframe></body></html>',gi=Ki.open();if(gi!==null&&(gi.document.write(Vi),gi.document.title=fe.filename),gi||typeof safari>"u")return gi;break;case"datauri":case"dataurl":return Ki.document.location.href=this.output("datauristring",fe);default:return null}})),Af=function(J){return Array.isArray(nn)===!0&&nn.indexOf(J)>-1};switch(i){case"pt":K=1;break;case"mm":K=72/25.4;break;case"cm":K=72/2.54;break;case"in":K=72;break;case"px":K=Af("px_scaling")==1?.75:96/72;break;case"pc":case"em":K=12;break;case"ex":K=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);K=i}var _n=null;q(),v();var bc=function(J){return u!==null?_n.encryptor(J,0):function(fe){return fe}},ff=h.__private__.getPageInfo=h.getPageInfo=function(J){if(isNaN(J)||J%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Tr[J].objId,pageNumber:J,pageContext:Tr[J]}},Fi=h.__private__.getPageInfoByObjId=function(J){if(isNaN(J)||J%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var fe in Tr)if(Tr[fe].objId===J)break;return ff(fe)},pf=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:Tr[z].objId,pageNumber:z,pageContext:Tr[z]}};h.addPage=function(){return df.apply(this,arguments),this},h.setPage=function(){return Td.apply(this,arguments),ut.call(this,rt[z]),this},h.insertPage=function(J){return this.addPage(),this.movePage(z,J),this},h.movePage=function(J,fe){var Oe,Xe;if(J>fe){Oe=rt[J],Xe=Tr[J];for(var Je=J;Je>fe;Je--)rt[Je]=rt[Je-1],Tr[Je]=Tr[Je-1];rt[fe]=Oe,Tr[fe]=Xe,this.setPage(fe)}else if(J<fe){Oe=rt[J],Xe=Tr[J];for(var _t=J;_t<fe;_t++)rt[_t]=rt[_t+1],Tr[_t]=Tr[_t+1];rt[fe]=Oe,Tr[fe]=Xe,this.setPage(fe)}return this},h.deletePage=function(){return _l.apply(this,arguments),this},h.__private__.text=h.text=function(J,fe,Oe,Xe,Je){var _t,or,Nr,ei,Ui,Si,Vi,gi,$n,La=(Xe=Xe||{}).scope||this;if(typeof J=="number"&&typeof fe=="number"&&(typeof Oe=="string"||Array.isArray(Oe))){var Ea=Oe;Oe=fe,fe=J,J=Ea}if(arguments[3]instanceof ai?(C("The transform parameter of text() with a Matrix value"),$n=Je):(Nr=arguments[4],ei=arguments[5],ys(Vi=arguments[3])==="object"&&Vi!==null||(typeof Nr=="string"&&(ei=Nr,Nr=null),typeof Vi=="string"&&(ei=Vi,Vi=null),typeof Vi=="number"&&(Nr=Vi,Vi=null),Xe={flags:Vi,angle:Nr,align:ei})),isNaN(fe)||isNaN(Oe)||J==null)throw new Error("Invalid arguments passed to jsPDF.text");if(J.length===0)return La;var cs="",po=!1,qc=typeof Xe.lineHeightFactor=="number"?Xe.lineHeightFactor:fh,Ll=La.internal.scaleFactor;function Ni(Ln){return Ln=Ln.split("	").join(Array(Xe.TabLen||9).join(" ")),Xa(Ln,Vi)}function Bd(Ln){for(var ss,On=Ln.concat(),Qo=[],mA=On.length;mA--;)typeof(ss=On.shift())=="string"?Qo.push(ss):Array.isArray(Ln)&&(ss.length===1||ss[1]===void 0&&ss[2]===void 0)?Qo.push(ss[0]):Qo.push([ss[0],ss[1],ss[2]]);return Qo}function us(Ln,ss){var On;if(typeof Ln=="string")On=ss(Ln)[0];else if(Array.isArray(Ln)){for(var Qo,mA,bf=Ln.concat(),r0=[],_m=bf.length;_m--;)typeof(Qo=bf.shift())=="string"?r0.push(ss(Qo)[0]):Array.isArray(Qo)&&typeof Qo[0]=="string"&&(mA=ss(Qo[0],Qo[1],Qo[2]),r0.push([mA[0],mA[1],mA[2]]));On=r0}return On}var Wc=!1,Nu=!0;if(typeof J=="string")Wc=!0;else if(Array.isArray(J)){var Dd=J.concat();or=[];for(var ns,to=Dd.length;to--;)(typeof(ns=Dd.shift())!="string"||Array.isArray(ns)&&typeof ns[0]!="string")&&(Nu=!1);Wc=Nu}if(Wc===!1)throw new Error('Type of text must be string or Array. "'+J+'" is not recognized.');typeof J=="string"&&(J=J.match(/[\r?\n]/)?J.split(/\r\n|\r|\n/g):[J]);var _d=Yt/La.internal.scaleFactor,xc=_d*(qc-1);switch(Xe.baseline){case"bottom":Oe-=xc;break;case"top":Oe+=_d-xc;break;case"hanging":Oe+=_d-2*xc;break;case"middle":Oe+=_d/2-xc}if((Si=Xe.maxWidth||0)>0&&(typeof J=="string"?J=La.splitTextToSize(J,Si):Object.prototype.toString.call(J)==="[object Array]"&&(J=J.reduce((function(Ln,ss){return Ln.concat(La.splitTextToSize(ss,Si))}),[]))),_t={text:J,x:fe,y:Oe,options:Xe,mutex:{pdfEscape:Xa,activeFontKey:O,fonts:Ie,activeFontSize:Yt}},ii.publish("preProcessText",_t),J=_t.text,Nr=(Xe=_t.options).angle,!($n instanceof ai)&&Nr&&typeof Nr=="number"){Nr*=Math.PI/180,Xe.rotationDirection===0&&(Nr=-Nr),b===g.ADVANCED&&(Nr=-Nr);var pA=Math.cos(Nr),Ru=Math.sin(Nr);$n=new ai(pA,Ru,-Ru,pA,0,0)}else Nr&&Nr instanceof ai&&($n=Nr);b!==g.ADVANCED||$n||($n=Lr),(Ui=Xe.charSpace||he)!==void 0&&(cs+=I(H(Ui))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(gi=Xe.horizontalScale)!==void 0&&(cs+=I(100*gi)+` Tz
`),Xe.lang;var Yo=-1,yf=Xe.renderingMode!==void 0?Xe.renderingMode:Xe.stroke,Vo=La.internal.getCurrentPageInfo().pageContext;switch(yf){case 0:case!1:case"fill":Yo=0;break;case 1:case!0:case"stroke":Yo=1;break;case 2:case"fillThenStroke":Yo=2;break;case 3:case"invisible":Yo=3;break;case 4:case"fillAndAddForClipping":Yo=4;break;case 5:case"strokeAndAddPathForClipping":Yo=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Yo=6;break;case 7:case"addToPathForClipping":Yo=7}var mh=Vo.usedRenderingMode!==void 0?Vo.usedRenderingMode:-1;Yo!==-1?cs+=Yo+` Tr
`:mh!==-1&&(cs+=`0 Tr
`),Yo!==-1&&(Vo.usedRenderingMode=Yo),ei=Xe.align||"left";var ro,Oa=Yt*qc,Mu=La.internal.pageSize.getWidth(),t0=Ie[O];Ui=Xe.charSpace||he,Si=Xe.maxWidth||0,Vi=Object.assign({autoencode:!0,noBOM:!0},Xe.flags);var gh=[];if(Object.prototype.toString.call(J)==="[object Array]"){var rc;or=Bd(J),ei!=="left"&&(ro=or.map((function(Ln){return La.getStringUnitWidth(Ln,{font:t0,charSpace:Ui,fontSize:Yt,doKerning:!1})*Yt/Ll})));var Me,Ke=0;if(ei==="right"){fe-=ro[0],J=[],to=or.length;for(var mt=0;mt<to;mt++)mt===0?(Me=ir(fe),rc=wr(Oe)):(Me=H(Ke-ro[mt]),rc=-Oa),J.push([or[mt],Me,rc]),Ke=ro[mt]}else if(ei==="center"){fe-=ro[0]/2,J=[],to=or.length;for(var Tt=0;Tt<to;Tt++)Tt===0?(Me=ir(fe),rc=wr(Oe)):(Me=H((Ke-ro[Tt])/2),rc=-Oa),J.push([or[Tt],Me,rc]),Ke=ro[Tt]}else if(ei==="left"){J=[],to=or.length;for(var Ut=0;Ut<to;Ut++)J.push(or[Ut])}else{if(ei!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');J=[],to=or.length,Si=Si!==0?Si:Mu;for(var fr=0;fr<to;fr++)rc=fr===0?wr(Oe):-Oa,Me=fr===0?ir(fe):0,fr<to-1?gh.push(I(H((Si-ro[fr])/(or[fr].split(" ").length-1)))):gh.push(0),J.push([or[fr],Me,rc])}}var Br=typeof Xe.R2L=="boolean"?Xe.R2L:sr;Br===!0&&(J=us(J,(function(Ln,ss,On){return[Ln.split("").reverse().join(""),ss,On]}))),_t={text:J,x:fe,y:Oe,options:Xe,mutex:{pdfEscape:Xa,activeFontKey:O,fonts:Ie,activeFontSize:Yt}},ii.publish("postProcessText",_t),J=_t.text,po=_t.mutex.isHex||!1;var Zr=Ie[O].encoding;Zr!=="WinAnsiEncoding"&&Zr!=="StandardEncoding"||(J=us(J,(function(Ln,ss,On){return[Ni(Ln),ss,On]}))),or=Bd(J),J=[];for(var Pr,Gi,qr,Di=0,an=1,mi=Array.isArray(or[0])?an:Di,Pn="",jo=function(Ln,ss,On){var Qo="";return On instanceof ai?(On=typeof Xe.angle=="number"?xa(On,new ai(1,0,0,1,Ln,ss)):xa(new ai(1,0,0,1,Ln,ss),On),b===g.ADVANCED&&(On=xa(new ai(1,0,0,-1,0,0),On)),Qo=On.join(" ")+` Tm
`):Qo=I(Ln)+" "+I(ss)+` Td
`,Qo},ks=0;ks<or.length;ks++){switch(Pn="",mi){case an:qr=(po?"<":"(")+or[ks][0]+(po?">":")"),Pr=parseFloat(or[ks][1]),Gi=parseFloat(or[ks][2]);break;case Di:qr=(po?"<":"(")+or[ks]+(po?">":")"),Pr=ir(fe),Gi=wr(Oe)}gh!==void 0&&gh[ks]!==void 0&&(Pn=gh[ks]+` Tw
`),ks===0?J.push(Pn+jo(Pr,Gi,$n)+qr):mi===Di?J.push(Pn+qr):mi===an&&J.push(Pn+jo(Pr,Gi,$n)+qr)}J=mi===Di?J.join(` Tj
T* `):J.join(` Tj
`),J+=` Tj
`;var io=`BT
/`;return io+=O+" "+Yt+` Tf
`,io+=I(Yt*qc)+` TL
`,io+=ee+`
`,io+=cs,io+=J,Pe(io+="ET"),A[O]=!0,La};var dA=h.__private__.clip=h.clip=function(J){return Pe(J==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return dA("evenodd")},h.__private__.discardPath=h.discardPath=function(){return Pe("n"),this};var Xc=h.__private__.isValidStyle=function(J){var fe=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(J)!==-1&&(fe=!0),fe};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(J){return Xc(J)&&(c=J),this};var Cp=h.__private__.getStyle=h.getStyle=function(J){var fe=c;switch(J){case"D":case"S":fe="S";break;case"F":fe="f";break;case"FD":case"DF":fe="B";break;case"f":case"f*":case"B":case"B*":fe=J}return fe},Go=h.close=function(){return Pe("h"),this};h.stroke=function(){return Pe("S"),this},h.fill=function(J){return Ah("f",J),this},h.fillEvenOdd=function(J){return Ah("f*",J),this},h.fillStroke=function(J){return Ah("B",J),this},h.fillStrokeEvenOdd=function(J){return Ah("B*",J),this};var Ah=function(J,fe){ys(fe)==="object"?fA(fe,J):Pe(J)},AA=function(J){J===null||b===g.ADVANCED&&J===void 0||(J=Cp(J),Pe(J))};function fl(J,fe,Oe,Xe,Je){var _t=new cf(fe||this.boundingBox,Oe||this.xStep,Xe||this.yStep,this.gState,Je||this.matrix);_t.stream=this.stream;var or=J+"$$"+this.cloneIndex+++"$$";return mn(or,_t),_t}var fA=function(J,fe){var Oe=Kt[J.key],Xe=it[Oe];if(Xe instanceof Yb)Pe("q"),Pe(mf(fe)),Xe.gState&&h.setGState(Xe.gState),Pe(J.matrix.toString()+" cm"),Pe("/"+Oe+" sh"),Pe("Q");else if(Xe instanceof cf){var Je=new ai(1,0,0,-1,0,Vs());J.matrix&&(Je=Je.multiply(J.matrix||Lr),Oe=fl.call(Xe,J.key,J.boundingBox,J.xStep,J.yStep,Je).id),Pe("q"),Pe("/Pattern cs"),Pe("/"+Oe+" scn"),Xe.gState&&h.setGState(Xe.gState),Pe(fe),Pe("Q")}},mf=function(J){switch(J){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Rh=h.moveTo=function(J,fe){return Pe(I(H(J))+" "+I(j(fe))+" m"),this},Ou=h.lineTo=function(J,fe){return Pe(I(H(J))+" "+I(j(fe))+" l"),this},pl=h.curveTo=function(J,fe,Oe,Xe,Je,_t){return Pe([I(H(J)),I(j(fe)),I(H(Oe)),I(j(Xe)),I(H(Je)),I(j(_t)),"c"].join(" ")),this};h.__private__.line=h.line=function(J,fe,Oe,Xe,Je){if(isNaN(J)||isNaN(fe)||isNaN(Oe)||isNaN(Xe)||!Xc(Je))throw new Error("Invalid arguments passed to jsPDF.line");return b===g.COMPAT?this.lines([[Oe-J,Xe-fe]],J,fe,[1,1],Je||"S"):this.lines([[Oe-J,Xe-fe]],J,fe,[1,1]).stroke()},h.__private__.lines=h.lines=function(J,fe,Oe,Xe,Je,_t){var or,Nr,ei,Ui,Si,Vi,gi,$n,La,Ea,cs,po;if(typeof J=="number"&&(po=Oe,Oe=fe,fe=J,J=po),Xe=Xe||[1,1],_t=_t||!1,isNaN(fe)||isNaN(Oe)||!Array.isArray(J)||!Array.isArray(Xe)||!Xc(Je)||typeof _t!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Rh(fe,Oe),or=Xe[0],Nr=Xe[1],Ui=J.length,Ea=fe,cs=Oe,ei=0;ei<Ui;ei++)(Si=J[ei]).length===2?(Ea=Si[0]*or+Ea,cs=Si[1]*Nr+cs,Ou(Ea,cs)):(Vi=Si[0]*or+Ea,gi=Si[1]*Nr+cs,$n=Si[2]*or+Ea,La=Si[3]*Nr+cs,Ea=Si[4]*or+Ea,cs=Si[5]*Nr+cs,pl(Vi,gi,$n,La,Ea,cs));return _t&&Go(),AA(Je),this},h.path=function(J){for(var fe=0;fe<J.length;fe++){var Oe=J[fe],Xe=Oe.c;switch(Oe.op){case"m":Rh(Xe[0],Xe[1]);break;case"l":Ou(Xe[0],Xe[1]);break;case"c":pl.apply(this,Xe);break;case"h":Go()}}return this},h.__private__.rect=h.rect=function(J,fe,Oe,Xe,Je){if(isNaN(J)||isNaN(fe)||isNaN(Oe)||isNaN(Xe)||!Xc(Je))throw new Error("Invalid arguments passed to jsPDF.rect");return b===g.COMPAT&&(Xe=-Xe),Pe([I(H(J)),I(j(fe)),I(H(Oe)),I(H(Xe)),"re"].join(" ")),AA(Je),this},h.__private__.triangle=h.triangle=function(J,fe,Oe,Xe,Je,_t,or){if(isNaN(J)||isNaN(fe)||isNaN(Oe)||isNaN(Xe)||isNaN(Je)||isNaN(_t)||!Xc(or))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Oe-J,Xe-fe],[Je-Oe,_t-Xe],[J-Je,fe-_t]],J,fe,[1,1],or,!0),this},h.__private__.roundedRect=h.roundedRect=function(J,fe,Oe,Xe,Je,_t,or){if(isNaN(J)||isNaN(fe)||isNaN(Oe)||isNaN(Xe)||isNaN(Je)||isNaN(_t)||!Xc(or))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Nr=4/3*(Math.SQRT2-1);return Je=Math.min(Je,.5*Oe),_t=Math.min(_t,.5*Xe),this.lines([[Oe-2*Je,0],[Je*Nr,0,Je,_t-_t*Nr,Je,_t],[0,Xe-2*_t],[0,_t*Nr,-Je*Nr,_t,-Je,_t],[2*Je-Oe,0],[-Je*Nr,0,-Je,-_t*Nr,-Je,-_t],[0,2*_t-Xe],[0,-_t*Nr,Je*Nr,-_t,Je,-_t]],J+Je,fe,[1,1],or,!0),this},h.__private__.ellipse=h.ellipse=function(J,fe,Oe,Xe,Je){if(isNaN(J)||isNaN(fe)||isNaN(Oe)||isNaN(Xe)||!Xc(Je))throw new Error("Invalid arguments passed to jsPDF.ellipse");var _t=4/3*(Math.SQRT2-1)*Oe,or=4/3*(Math.SQRT2-1)*Xe;return Rh(J+Oe,fe),pl(J+Oe,fe-or,J+_t,fe-Xe,J,fe-Xe),pl(J-_t,fe-Xe,J-Oe,fe-or,J-Oe,fe),pl(J-Oe,fe+or,J-_t,fe+Xe,J,fe+Xe),pl(J+_t,fe+Xe,J+Oe,fe+or,J+Oe,fe),AA(Je),this},h.__private__.circle=h.circle=function(J,fe,Oe,Xe){if(isNaN(J)||isNaN(fe)||isNaN(Oe)||!Xc(Xe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(J,fe,Oe,Oe,Xe)},h.setFont=function(J,fe,Oe){return Oe&&(fe=x(fe,Oe)),O=Lu(J,fe,{disableWarning:!1}),this};var tc=h.__private__.getFont=h.getFont=function(){return Ie[Lu.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var J,fe,Oe={};for(J in Ce)if(Ce.hasOwnProperty(J))for(fe in Oe[J]=[],Ce[J])Ce[J].hasOwnProperty(fe)&&Oe[J].push(fe);return Oe},h.addFont=function(J,fe,Oe,Xe,Je){var _t=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&_t.indexOf(arguments[3])!==-1?Je=arguments[3]:arguments[3]&&_t.indexOf(arguments[3])==-1&&(Oe=x(Oe,Xe)),Je=Je||"Identity-H",hf.call(this,J,fe,Oe,Je)};var fh,Mh=t.lineWidth||.200025,Pa=h.__private__.getLineWidth=h.getLineWidth=function(){return Mh},gf=h.__private__.setLineWidth=h.setLineWidth=function(J){return Mh=J,Pe(I(H(J))+" w"),this};h.__private__.setLineDash=ji.API.setLineDash=ji.API.setLineDashPattern=function(J,fe){if(J=J||[],fe=fe||0,isNaN(fe)||!Array.isArray(J))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return J=J.map((function(Oe){return I(H(Oe))})).join(" "),fe=I(H(fe)),Pe("["+J+"] "+fe+" d"),this};var ph=h.__private__.getLineHeight=h.getLineHeight=function(){return Yt*fh};h.__private__.getLineHeight=h.getLineHeight=function(){return Yt*fh};var $r=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(J){return typeof(J=J||1.15)=="number"&&(fh=J),this},$e=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return fh};$r(t.lineHeight);var ir=h.__private__.getHorizontalCoordinate=function(J){return H(J)},wr=h.__private__.getVerticalCoordinate=function(J){return b===g.ADVANCED?J:Tr[z].mediaBox.topRightY-Tr[z].mediaBox.bottomLeftY-H(J)},Cn=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(J){return I(ir(J))},da=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(J){return I(wr(J))},S=t.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return ec(S)},h.__private__.setStrokeColor=h.setDrawColor=function(J,fe,Oe,Xe){return S=Qc({ch1:J,ch2:fe,ch3:Oe,ch4:Xe,pdfColorType:"draw",precision:2}),Pe(S),this};var V=t.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return ec(V)},h.__private__.setFillColor=h.setFillColor=function(J,fe,Oe,Xe){return V=Qc({ch1:J,ch2:fe,ch3:Oe,ch4:Xe,pdfColorType:"fill",precision:2}),Pe(V),this};var ee=t.textColor||"0 g",ie=h.__private__.getTextColor=h.getTextColor=function(){return ec(ee)};h.__private__.setTextColor=h.setTextColor=function(J,fe,Oe,Xe){return ee=Qc({ch1:J,ch2:fe,ch3:Oe,ch4:Xe,pdfColorType:"text",precision:3}),this};var he=t.charSpace,de=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(he||0)};h.__private__.setCharSpace=h.setCharSpace=function(J){if(isNaN(J))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return he=J,this};var ye=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(J){var fe=h.CapJoinStyles[J];if(fe===void 0)throw new Error("Line cap style of '"+J+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ye=fe,Pe(fe+" J"),this};var Qe=0;h.__private__.setLineJoin=h.setLineJoin=function(J){var fe=h.CapJoinStyles[J];if(fe===void 0)throw new Error("Line join style of '"+J+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qe=fe,Pe(fe+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(J){if(J=J||0,isNaN(J))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Pe(I(H(J))+" M"),this},h.GState=k3,h.setGState=function(J){(J=typeof J=="string"?ar[lr[J]]:Ve(null,J)).equals(yr)||(Pe("/"+J.id+" gs"),yr=J)};var Ve=function(J,fe){if(!J||!lr[J]){var Oe=!1;for(var Xe in ar)if(ar.hasOwnProperty(Xe)&&ar[Xe].equals(fe)){Oe=!0;break}if(Oe)fe=ar[Xe];else{var Je="GS"+(Object.keys(ar).length+1).toString(10);ar[Je]=fe,fe.id=Je}return J&&(lr[J]=fe.id),ii.publish("addGState",fe),fe}};h.addGState=function(J,fe){return Ve(J,fe),this},h.saveGraphicsState=function(){return Pe("q"),st.push({key:O,size:Yt,color:ee}),this},h.restoreGraphicsState=function(){Pe("Q");var J=st.pop();return O=J.key,Yt=J.size,ee=J.color,yr=null,this},h.setCurrentTransformationMatrix=function(J){return Pe(J.toString()+" cm"),this},h.comment=function(J){return Pe("#"+J),this};var at=function(J,fe){var Oe=J||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Oe},set:function(_t){isNaN(_t)||(Oe=parseFloat(_t))}});var Xe=fe||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Xe},set:function(_t){isNaN(_t)||(Xe=parseFloat(_t))}});var Je="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Je},set:function(_t){Je=_t.toString()}}),this},Ot=function(J,fe,Oe,Xe){at.call(this,J,fe),this.type="rect";var Je=Oe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Je},set:function(or){isNaN(or)||(Je=parseFloat(or))}});var _t=Xe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return _t},set:function(or){isNaN(or)||(_t=parseFloat(or))}}),this},Vt=function(){this.page=xi,this.currentPage=z,this.pages=rt.slice(0),this.pagesContext=Tr.slice(0),this.x=se,this.y=ae,this.matrix=ue,this.width=gn(z),this.height=Vs(z),this.outputDestination=xt,this.id="",this.objectNumber=-1};Vt.prototype.restore=function(){xi=this.page,z=this.currentPage,Tr=this.pagesContext,rt=this.pages,se=this.x,ae=this.y,ue=this.matrix,Ji(z,this.width),Ha(z,this.height),xt=this.outputDestination};var Bt=function(J,fe,Oe,Xe,Je){Za.push(new Vt),xi=z=0,rt=[],se=J,ae=fe,ue=Je,cA([Oe,Xe])},hr=function(J){if(Dn[J])Za.pop().restore();else{var fe=new Vt,Oe="Xo"+(Object.keys(sn).length+1).toString(10);fe.id=Oe,Dn[J]=Oe,sn[Oe]=fe,ii.publish("addFormObject",fe),Za.pop().restore()}};for(var Oi in h.beginFormObject=function(J,fe,Oe,Xe,Je){return Bt(J,fe,Oe,Xe,Je),this},h.endFormObject=function(J){return hr(J),this},h.doFormObject=function(J,fe){var Oe=sn[Dn[J]];return Pe("q"),Pe(fe.toString()+" cm"),Pe("/"+Oe.id+" Do"),Pe("Q"),this},h.getFormObject=function(J){var fe=sn[Dn[J]];return{x:fe.x,y:fe.y,width:fe.width,height:fe.height,matrix:fe.matrix}},h.save=function(J,fe){return J=J||"generated.pdf",(fe=fe||{}).returnPromise=fe.returnPromise||!1,fe.returnPromise===!1?(Gb(eo(Al()),J),typeof Gb.unload=="function"&&Ki.setTimeout&&setTimeout(Gb.unload,911),this):new Promise((function(Oe,Xe){try{var Je=Gb(eo(Al()),J);typeof Gb.unload=="function"&&Ki.setTimeout&&setTimeout(Gb.unload,911),Oe(Je)}catch(_t){Xe(_t.message)}}))},ji.API)ji.API.hasOwnProperty(Oi)&&(Oi==="events"&&ji.API.events.length?(function(J,fe){var Oe,Xe,Je;for(Je=fe.length-1;Je!==-1;Je--)Oe=fe[Je][0],Xe=fe[Je][1],J.subscribe.apply(J,[Oe].concat(typeof Xe=="function"?[Xe]:Xe))})(ii,ji.API.events):h[Oi]=ji.API[Oi]);var gn=h.getPageWidth=function(J){return(Tr[J=J||z].mediaBox.topRightX-Tr[J].mediaBox.bottomLeftX)/K},Ji=h.setPageWidth=function(J,fe){Tr[J].mediaBox.topRightX=fe*K+Tr[J].mediaBox.bottomLeftX},Vs=h.getPageHeight=function(J){return(Tr[J=J||z].mediaBox.topRightY-Tr[J].mediaBox.bottomLeftY)/K},Ha=h.setPageHeight=function(J,fe){Tr[J].mediaBox.topRightY=fe*K+Tr[J].mediaBox.bottomLeftY};return h.internal={pdfEscape:Xa,getStyle:Cp,getFont:tc,getFontSize:kt,getCharSpace:de,getTextColor:ie,getLineHeight:ph,getLineHeightFactor:$e,getLineWidth:Pa,write:ft,getHorizontalCoordinate:ir,getVerticalCoordinate:wr,getCoordinateString:Cn,getVerticalCoordinateString:da,collections:{},newObject:bs,newAdditionalObject:Su,newObjectDeferred:Zi,newObjectDeferredBegin:Do,getFilters:Uo,putStream:ul,events:ii,scaleFactor:K,pageSize:{getWidth:function(){return gn(z)},setWidth:function(J){Ji(z,J)},getHeight:function(){return Vs(z)},setHeight:function(J){Ha(z,J)}},encryptionOptions:u,encryption:_n,getEncryptor:bc,output:Nh,getNumberOfPages:Oh,pages:rt,out:Pe,f2:U,f3:_,getPageInfo:ff,getPageInfoByObjId:Fi,getCurrentPageInfo:pf,getPDFVersion:p,Point:at,Rectangle:Ot,Matrix:ai,hasHotfix:Af},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return gn(z)},set:function(J){Ji(z,J)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return Vs(z)},set:function(J){Ha(z,J)},enumerable:!0,configurable:!0}),za.call(h,Qt),O="F1",df(n,r),ii.publish("initialized"),h}xw.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},xw.prototype.toHexString=function(t){return t.split("").map((function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)})).join("")},xw.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},xw.prototype.processOwnerPassword=function(t,e){return uU(cU(e).substr(0,5),t)},xw.prototype.encryptor=function(t,e){var r=cU(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(i){return uU(r,i)}},k3.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||ys(t)!==ys(this))return!1;var i=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;i++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&i--;return i===0},ji.API={events:[]},ji.version="2.5.1";var cl=ji.API,fU=1,jb=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},yw=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},bn=function(t){return t.toFixed(2)},Hy=function(t){return t.toFixed(5)};cl.__acroform__={};var vd=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},Nse=function(t){return t*fU},Tm=function(t){var e=new Jse,r=fi.internal.getHeight(t)||0,i=fi.internal.getWidth(t)||0;return e.BBox=[0,0,Number(bn(i)),Number(bn(r))],e},RMe=cl.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},MMe=cl.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},kMe=cl.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(t&1<<e)==0?0:1},Sl=cl.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return kMe(t,e-1)},Tl=cl.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return RMe(t,e-1)},Il=cl.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return MMe(t,e-1)},FMe=cl.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,i=e.internal.getVerticalCoordinate,n=t[0],s=t[1],a=t[2],o=t[3],l={};return l.lowerLeft_X=r(n)||0,l.lowerLeft_Y=i(s+o)||0,l.upperRight_X=r(n+a)||0,l.upperRight_Y=i(s)||0,[Number(bn(l.lowerLeft_X)),Number(bn(l.lowerLeft_Y)),Number(bn(l.upperRight_X)),Number(bn(l.upperRight_Y))]},UMe=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,i=hU(t,r),n=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+n+" "+bn(i.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(i.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Tm(t);return s.scope=t.scope,s.stream=e.join(`
`),s}},hU=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,i={text:"",fontSize:""},n=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");n=t.multiline?n.map((function(_){return _.split(`
`)})):n.map((function(_){return[_]}));var s=r,a=fi.internal.getHeight(t)||0;a=a<0?-a:a;var o=fi.internal.getWidth(t)||0;o=o<0?-o:o;var l=function(_,H,Q){if(_+1<n.length){var j=H+" "+n[_+1][0];return _3(j,t,Q).width<=o-4}return!1};s++;e:for(;s>0;){e="",s--;var c,u,d=_3("3",t,s).height,A=t.multiline?a-s:(a-d)/2,h=A+=2,f=0,p=0,m=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+_3(e,t,s=12).width+", FieldWidth:"+o+`
`;break}for(var y="",g=0,b=0;b<n.length;b++)if(n.hasOwnProperty(b)){var E=!1;if(n[b].length!==1&&m!==n[b].length-1){if((d+2)*(g+2)+2>a)continue e;y+=n[b][m],E=!0,p=b,b--}else{y=(y+=n[b][m]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var w=parseInt(b),x=l(w,y,s),I=b>=n.length-1;if(x&&!I){y+=" ",m=0;continue}if(x||I){if(I)p=w;else if(t.multiline&&(d+2)*(g+2)+2>a)continue e}else{if(!t.multiline||(d+2)*(g+2)+2>a)continue e;p=w}}for(var C="",G=f;G<=p;G++){var U=n[G];if(t.multiline){if(G===p){C+=U[m]+" ",m=(m+1)%U.length;continue}if(G===f){C+=U[U.length-1]+" ";continue}}C+=U[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,u=_3(C,t,s).width,t.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;case"left":default:c=2}e+=bn(c)+" "+bn(h)+` Td
`,e+="("+jb(C)+`) Tj
`,e+=-bn(c)+` 0 Td
`,h=-(s+2),u=0,f=E?p:p+1,g++,y=""}break}return i.text=e,i.fontSize=s,i},_3=function(t,e,r){var i=e.scope.internal.getFont(e.fontName,e.fontStyle),n=e.scope.getStringUnitWidth(t,{font:i,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},HMe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},GMe=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find((function(i){return i.type===r.type&&i.object===r.object}))===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},YMe=function(t,e){for(var r in t)if(t.hasOwnProperty(r)){var i=r,n=t[r];e.internal.newObjectDeferredBegin(n.objId,!0),ys(n)==="object"&&typeof n.putStream=="function"&&n.putStream(),delete t[i]}},VMe=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Ep.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(HMe)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");fU=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new $se,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",(function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)})),t.internal.events.subscribe("buildDocument",(function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in i)if(i.hasOwnProperty(n)){var s=i[n];s.objId=void 0,s.hasAnnotation&&GMe(s,r)}})(t)})),t.internal.events.subscribe("putCatalog",(function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)})),t.internal.events.subscribe("postPutPages",(function(r){(function(i,n){var s=!i;for(var a in i||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(a)){var o=i[a],l=[],c=o.Rect;if(o.Rect&&(o.Rect=FMe(o.Rect,n)),n.internal.newObjectDeferredBegin(o.objId,!0),o.DA=fi.createDefaultAppearanceStream(o),ys(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=UMe(o);l.push({key:"AP",value:"<</N "+u+">>"}),n.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var d="";for(var A in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(A)){var h=o.appearanceStreamContent[A];if(d+="/"+A+" ",d+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var a in h)if(h.hasOwnProperty(a)){var f=h[a];typeof f=="function"&&(f=f.call(n,o)),d+="/"+a+" "+f+" ",n.internal.acroformPlugin.xForms.indexOf(f)>=0||n.internal.acroformPlugin.xForms.push(f)}}else typeof(f=h)=="function"&&(f=f.call(n,o)),d+="/"+a+" "+f,n.internal.acroformPlugin.xForms.indexOf(f)>=0||n.internal.acroformPlugin.xForms.push(f);d+=">>"}l.push({key:"AP",value:`<<
`+d+">>"})}n.internal.putStream({additionalKeyValues:l,objectId:o.objId}),n.internal.out("endobj")}s&&YMe(n.internal.acroformPlugin.xForms,n)})(r,t)})),t.internal.acroformPlugin.isInitialized=!0}},Kse=cl.__acroform__.arrayToPdfArray=function(t,e,r){var i=function(a){return a};if(Array.isArray(t)){for(var n="[",s=0;s<t.length;s++)switch(s!==0&&(n+=" "),ys(t[s])){case"boolean":case"number":case"object":n+=t[s].toString();break;case"string":t[s].substr(0,1)!=="/"?(e!==void 0&&r&&(i=r.internal.getEncryptor(e)),n+="("+jb(i(t[s].toString()))+")"):n+=t[s].toString()}return n+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},sU=function(t,e,r){var i=function(n){return n};return e!==void 0&&r&&(i=r.internal.getEncryptor(e)),(t=t||"").toString(),t="("+jb(i(t))+")"},Im=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Im.prototype.toString=function(){return this.objId+" 0 R"},Im.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Im.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter((function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"}));for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var i=e[r],n=this[i];n&&(Array.isArray(n)?t.push({key:i,value:Kse(n,this.objId,this.scope)}):n instanceof Im?(n.scope=this.scope,t.push({key:i,value:n.objId+" 0 R"})):typeof n!="function"&&t.push({key:i,value:n}))}return t};var Jse=function(){Im.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};vd(Jse,Im);var $se=function(){Im.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(i){return i};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+jb(r(t))+")"}},set:function(r){t=r}})};vd($se,Im);var Ep=function t(){Im.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');e=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Sl(e,3)},set:function(y){y?this.F=Tl(e,3):this.F=Il(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');r=y}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(y){i=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(y){i[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(y){i[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(y){i[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(y){i[3]=y}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof F3)return;s="FieldObject"+t.FieldNum++}var y=function(g){return g};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+jb(y(s))+")"},set:function(y){s=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(y){s=y}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(y){a=y}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/fU:c},set:function(y){c=y}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(y){u=y}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof F3||this instanceof Vb))return sU(d,this.objId,this.scope)},set:function(y){y=y.toString(),d=y}});var A=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(A)return this instanceof Vc?A:sU(A,this.objId,this.scope)},set:function(y){y=y.toString(),A=this instanceof Vc?y:y.substr(0,1)==="("?yw(y.substr(1,y.length-2)):yw(y)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Vc?yw(A.substr(1,A.length-1)):A},set:function(y){y=y.toString(),A=this instanceof Vc?"/"+y:y}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Vc?h:sU(h,this.objId,this.scope)},set:function(y){y=y.toString(),h=this instanceof Vc?y:y.substr(0,1)==="("?yw(y.substr(1,y.length-2)):yw(y)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Vc?yw(h.substr(1,h.length-1)):h},set:function(y){y=y.toString(),h=this instanceof Vc?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var f,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(y){y=!!y,p=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(f)return f},set:function(y){f=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,1)},set:function(y){y?this.Ff=Tl(this.Ff,1):this.Ff=Il(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,2)},set:function(y){y?this.Ff=Tl(this.Ff,2):this.Ff=Il(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,3)},set:function(y){y?this.Ff=Tl(this.Ff,3):this.Ff=Il(this.Ff,3)}});var m=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(m!==null)return m},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');m=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(m){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:m=2;break;case"center":case 1:m=1;break;case"left":case 0:default:m=0}}})};vd(Ep,Im);var ww=function(){Ep.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Kse(e,this.objId,this.scope)},set:function(r){var i,n;n=[],typeof(i=r)=="string"&&(n=(function(s,a,o){o||(o=1);for(var l,c=[];l=a.exec(s);)c.push(l[o]);return c})(i,/\((.*?)\)/g)),e=n}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,i){for(i=i||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,18)},set:function(r){r?this.Ff=Tl(this.Ff,18):this.Ff=Il(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Tl(this.Ff,19):this.Ff=Il(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,20)},set:function(r){r?(this.Ff=Tl(this.Ff,20),e.sort()):this.Ff=Il(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,22)},set:function(r){r?this.Ff=Tl(this.Ff,22):this.Ff=Il(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,23)},set:function(r){r?this.Ff=Tl(this.Ff,23):this.Ff=Il(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,27)},set:function(r){r?this.Ff=Tl(this.Ff,27):this.Ff=Il(this.Ff,27)}}),this.hasAppearanceStream=!1};vd(ww,Ep);var vw=function(){ww.call(this),this.fontName="helvetica",this.combo=!1};vd(vw,ww);var Cw=function(){vw.call(this),this.combo=!0};vd(Cw,vw);var O3=function(){Cw.call(this),this.edit=!0};vd(O3,Cw);var Vc=function(){Ep.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,15)},set:function(r){r?this.Ff=Tl(this.Ff,15):this.Ff=Il(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,16)},set:function(r){r?this.Ff=Tl(this.Ff,16):this.Ff=Il(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,17)},set:function(r){r?this.Ff=Tl(this.Ff,17):this.Ff=Il(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,26)},set:function(r){r?this.Ff=Tl(this.Ff,26):this.Ff=Il(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var i,n=[];for(i in n.push("<<"),e)n.push("/"+i+" ("+jb(r(e[i]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){ys(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};vd(Vc,Ep);var N3=function(){Vc.call(this),this.pushButton=!0};vd(N3,Vc);var Sw=function(){Vc.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};vd(Sw,Vc);var F3=function(){var t,e;Ep.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(n){e=n}});var r,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(o){return o};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var s,a=[];for(s in a.push("<<"),i)a.push("/"+s+" ("+jb(n(i[s]))+")");return a.push(">>"),a.join(`
`)},set:function(n){ys(n)==="object"&&(i=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(n){typeof n=="string"&&(i.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=fi.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};vd(F3,Ep),Sw.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Sw.prototype.createOption=function(t){var e=new F3;return e.Parent=this,e.optionName=t,this.Kids.push(e),jMe.call(this.scope,e),e};var R3=function(){Vc.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=fi.CheckBox.createAppearanceStream()};vd(R3,Vc);var Vb=function(){Ep.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,13)},set:function(e){e?this.Ff=Tl(this.Ff,13):this.Ff=Il(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,21)},set:function(e){e?this.Ff=Tl(this.Ff,21):this.Ff=Il(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,23)},set:function(e){e?this.Ff=Tl(this.Ff,23):this.Ff=Il(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,24)},set:function(e){e?this.Ff=Tl(this.Ff,24):this.Ff=Il(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,25)},set:function(e){e?this.Ff=Tl(this.Ff,25):this.Ff=Il(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,26)},set:function(e){e?this.Ff=Tl(this.Ff,26):this.Ff=Il(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};vd(Vb,Ep);var M3=function(){Vb.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Sl(this.Ff,14)},set:function(t){t?this.Ff=Tl(this.Ff,14):this.Ff=Il(this.Ff,14)}}),this.password=!0};vd(M3,Vb);var fi={CheckBox:{createAppearanceStream:function(){return{N:{On:fi.CheckBox.YesNormal},D:{On:fi.CheckBox.YesPushDown,Off:fi.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Tm(t);e.scope=t.scope;var r=[],i=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),s=hU(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+bn(fi.internal.getWidth(t))+" "+bn(fi.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+i+" "+bn(s.fontSize)+" Tf "+n),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Tm(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),n=[],s=fi.internal.getHeight(t),a=fi.internal.getWidth(t),o=hU(t,t.caption);return n.push("1 g"),n.push("0 0 "+bn(a)+" "+bn(s)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+bn(a-1)+" "+bn(s-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+bn(o.fontSize)+" Tf "+i),n.push(o.text),n.push("ET"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Tm(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+bn(fi.internal.getWidth(t))+" "+bn(fi.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:fi.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=fi.RadioButton.Circle.YesNormal,e.D[t]=fi.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Tm(t);e.scope=t.scope;var r=[],i=fi.internal.getWidth(t)<=fi.internal.getHeight(t)?fi.internal.getWidth(t)/4:fi.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var n=fi.internal.Bezier_C,s=Number((i*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Hy(fi.internal.getWidth(t)/2)+" "+Hy(fi.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Tm(t);e.scope=t.scope;var r=[],i=fi.internal.getWidth(t)<=fi.internal.getHeight(t)?fi.internal.getWidth(t)/4:fi.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var n=Number((2*i).toFixed(5)),s=Number((n*fi.internal.Bezier_C).toFixed(5)),a=Number((i*fi.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Hy(fi.internal.getWidth(t)/2)+" "+Hy(fi.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Hy(fi.internal.getWidth(t)/2)+" "+Hy(fi.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Tm(t);e.scope=t.scope;var r=[],i=fi.internal.getWidth(t)<=fi.internal.getHeight(t)?fi.internal.getWidth(t)/4:fi.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var n=Number((2*i).toFixed(5)),s=Number((n*fi.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Hy(fi.internal.getWidth(t)/2)+" "+Hy(fi.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:fi.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=fi.RadioButton.Cross.YesNormal,e.D[t]=fi.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Tm(t);e.scope=t.scope;var r=[],i=fi.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+bn(fi.internal.getWidth(t)-2)+" "+bn(fi.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(bn(i.x1.x)+" "+bn(i.x1.y)+" m"),r.push(bn(i.x2.x)+" "+bn(i.x2.y)+" l"),r.push(bn(i.x4.x)+" "+bn(i.x4.y)+" m"),r.push(bn(i.x3.x)+" "+bn(i.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Tm(t);e.scope=t.scope;var r=fi.internal.calculateCross(t),i=[];return i.push("0.749023 g"),i.push("0 0 "+bn(fi.internal.getWidth(t))+" "+bn(fi.internal.getHeight(t))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+bn(fi.internal.getWidth(t)-2)+" "+bn(fi.internal.getHeight(t)-2)+" re"),i.push("W"),i.push("n"),i.push(bn(r.x1.x)+" "+bn(r.x1.y)+" m"),i.push(bn(r.x2.x)+" "+bn(r.x2.y)+" l"),i.push(bn(r.x4.x)+" "+bn(r.x4.y)+" m"),i.push(bn(r.x3.x)+" "+bn(r.x3.y)+" l"),i.push("s"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=Tm(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+bn(fi.internal.getWidth(t))+" "+bn(fi.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};fi.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=fi.internal.getWidth(t),r=fi.internal.getHeight(t),i=Math.min(e,r);return{x1:{x:(e-i)/2,y:(r-i)/2+i},x2:{x:(e-i)/2+i,y:(r-i)/2},x3:{x:(e-i)/2,y:(r-i)/2},x4:{x:(e-i)/2+i,y:(r-i)/2+i}}}},fi.internal.getWidth=function(t){var e=0;return ys(t)==="object"&&(e=Nse(t.Rect[2])),e},fi.internal.getHeight=function(t){var e=0;return ys(t)==="object"&&(e=Nse(t.Rect[3])),e};var jMe=cl.addField=function(t){if(VMe(this,t),!(t instanceof Ep))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};cl.AcroFormChoiceField=ww,cl.AcroFormListBox=vw,cl.AcroFormComboBox=Cw,cl.AcroFormEditBox=O3,cl.AcroFormButton=Vc,cl.AcroFormPushButton=N3,cl.AcroFormRadioButton=Sw,cl.AcroFormCheckBox=R3,cl.AcroFormTextField=Vb,cl.AcroFormPasswordField=M3,cl.AcroFormAppearance=fi,cl.AcroForm={ChoiceField:ww,ListBox:vw,ComboBox:Cw,EditBox:O3,Button:Vc,PushButton:N3,RadioButton:Sw,CheckBox:R3,TextField:Vb,PasswordField:M3,Appearance:fi},ji.AcroForm={ChoiceField:ww,ListBox:vw,ComboBox:Cw,EditBox:O3,Button:Vc,PushButton:N3,RadioButton:Sw,CheckBox:R3,TextField:Vb,PasswordField:M3,Appearance:fi};var ZFt=ji.AcroForm;function Zse(t){return t.reduce((function(e,r,i){return e[r]=i,e}),{})}(function(t){t.__addimage__={};var e="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(_,H){var Q,j,$,B,M,v=e;if((H=H||e)==="RGBA"||_.data!==void 0&&_.data instanceof Uint8ClampedArray&&"height"in _&&"width"in _)return"RGBA";if(x(_))for(M in r)for($=r[M],Q=0;Q<$.length;Q+=1){for(B=!0,j=0;j<$[Q].length;j+=1)if($[Q][j]!==void 0&&$[Q][j]!==_[j]){B=!1;break}if(B===!0){v=M;break}}else for(M in r)for($=r[M],Q=0;Q<$.length;Q+=1){for(B=!0,j=0;j<$[Q].length;j+=1)if($[Q][j]!==void 0&&$[Q][j]!==_.charCodeAt(j)){B=!1;break}if(B===!0){v=M;break}}return v===e&&H!==e&&(v=H),v},n=function _(H){for(var Q=this.internal.write,j=this.internal.putStream,$=(0,this.internal.getFilters)();$.indexOf("FlateEncode")!==-1;)$.splice($.indexOf("FlateEncode"),1);H.objectId=this.internal.newObject();var B=[];if(B.push({key:"Type",value:"/XObject"}),B.push({key:"Subtype",value:"/Image"}),B.push({key:"Width",value:H.width}),B.push({key:"Height",value:H.height}),H.colorSpace===m.INDEXED?B.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(H.palette.length/3-1)+" "+("sMask"in H&&H.sMask!==void 0?H.objectId+2:H.objectId+1)+" 0 R]"}):(B.push({key:"ColorSpace",value:"/"+H.colorSpace}),H.colorSpace===m.DEVICE_CMYK&&B.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),B.push({key:"BitsPerComponent",value:H.bitsPerComponent}),"decodeParameters"in H&&H.decodeParameters!==void 0&&B.push({key:"DecodeParms",value:"<<"+H.decodeParameters+">>"}),"transparency"in H&&Array.isArray(H.transparency)){for(var M="",v=0,N=H.transparency.length;v<N;v++)M+=H.transparency[v]+" "+H.transparency[v]+" ";B.push({key:"Mask",value:"["+M+"]"})}H.sMask!==void 0&&B.push({key:"SMask",value:H.objectId+1+" 0 R"});var R=H.filter!==void 0?["/"+H.filter]:void 0;if(j({data:H.data,additionalKeyValues:B,alreadyAppliedFilters:R,objectId:H.objectId}),Q("endobj"),"sMask"in H&&H.sMask!==void 0){var q="/Predictor "+H.predictor+" /Colors 1 /BitsPerComponent "+H.bitsPerComponent+" /Columns "+H.width,P={width:H.width,height:H.height,colorSpace:"DeviceGray",bitsPerComponent:H.bitsPerComponent,decodeParameters:q,data:H.sMask};"filter"in H&&(P.filter=H.filter),_.call(this,P)}if(H.colorSpace===m.INDEXED){var z=this.internal.newObject();j({data:C(new Uint8Array(H.palette)),objectId:z}),Q("endobj")}},s=function(){var _=this.internal.collections.addImage_images;for(var H in _)n.call(this,_[H])},a=function(){var _,H=this.internal.collections.addImage_images,Q=this.internal.write;for(var j in H)Q("/I"+(_=H[j]).index,_.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",a))},l=function(){var _=this.internal.collections.addImage_images;return o.call(this),_},c=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(_){return typeof t["process"+_.toUpperCase()]=="function"},d=function(_){return ys(_)==="object"&&_.nodeType===1},A=function(_,H){if(_.nodeName==="IMG"&&_.hasAttribute("src")){var Q=""+_.getAttribute("src");if(Q.indexOf("data:image/")===0)return lI(unescape(Q).split("base64,").pop());var j=t.loadFile(Q,!0);if(j!==void 0)return j}if(_.nodeName==="CANVAS"){if(_.width===0||_.height===0)throw new Error("Given canvas must have data. Canvas width: "+_.width+", height: "+_.height);var $;switch(H){case"PNG":$="image/png";break;case"WEBP":$="image/webp";break;case"JPEG":case"JPG":default:$="image/jpeg"}return lI(_.toDataURL($,1).split("base64,").pop())}},h=function(_){var H=this.internal.collections.addImage_images;if(H){for(var Q in H)if(_===H[Q].alias)return H[Q]}},f=function(_,H,Q){return _||H||(_=-96,H=-96),_<0&&(_=-1*Q.width*72/_/this.internal.scaleFactor),H<0&&(H=-1*Q.height*72/H/this.internal.scaleFactor),_===0&&(_=H*Q.width/Q.height),H===0&&(H=_*Q.height/Q.width),[_,H]},p=function(_,H,Q,j,$,B){var M=f.call(this,Q,j,$),v=this.internal.getCoordinateString,N=this.internal.getVerticalCoordinateString,R=l.call(this);if(Q=M[0],j=M[1],R[$.index]=$,B){B*=Math.PI/180;var q=Math.cos(B),P=Math.sin(B),z=function(oe){return oe.toFixed(4)},W=[z(q),z(P),z(-1*P),z(q),0,0,"cm"]}this.internal.write("q"),B?(this.internal.write([1,"0","0",1,v(_),N(H+j),"cm"].join(" ")),this.internal.write(W.join(" ")),this.internal.write([v(Q),"0","0",v(j),"0","0","cm"].join(" "))):this.internal.write([v(Q),"0","0",v(j),v(_),N(H+j),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+$.index+" Do"),this.internal.write("Q")},m=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},g=t.__addimage__.sHashCode=function(_){var H,Q,j=0;if(typeof _=="string")for(Q=_.length,H=0;H<Q;H++)j=(j<<5)-j+_.charCodeAt(H),j|=0;else if(x(_))for(Q=_.byteLength/2,H=0;H<Q;H++)j=(j<<5)-j+_[H],j|=0;return j},b=t.__addimage__.validateStringAsBase64=function(_){(_=_||"").toString().trim();var H=!0;return _.length===0&&(H=!1),_.length%4!=0&&(H=!1),/^[A-Za-z0-9+/]+$/.test(_.substr(0,_.length-2))===!1&&(H=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(_.substr(-2))===!1&&(H=!1),H},E=t.__addimage__.extractImageFromDataUrl=function(_){var H=(_=_||"").split("base64,"),Q=null;if(H.length===2){var j=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(H[0]);Array.isArray(j)&&(Q={mimeType:j[1],charset:j[2],data:H[1]})}return Q},w=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(_){return w()&&_ instanceof ArrayBuffer};var x=t.__addimage__.isArrayBufferView=function(_){return w()&&typeof Uint32Array<"u"&&(_ instanceof Int8Array||_ instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&_ instanceof Uint8ClampedArray||_ instanceof Int16Array||_ instanceof Uint16Array||_ instanceof Int32Array||_ instanceof Uint32Array||_ instanceof Float32Array||_ instanceof Float64Array)},I=t.__addimage__.binaryStringToUint8Array=function(_){for(var H=_.length,Q=new Uint8Array(H),j=0;j<H;j++)Q[j]=_.charCodeAt(j);return Q},C=t.__addimage__.arrayBufferToBinaryString=function(_){for(var H="",Q=x(_)?_:new Uint8Array(_),j=0;j<Q.length;j+=8192)H+=String.fromCharCode.apply(null,Q.subarray(j,j+8192));return H};t.addImage=function(){var _,H,Q,j,$,B,M,v,N;if(typeof arguments[1]=="number"?(H=e,Q=arguments[1],j=arguments[2],$=arguments[3],B=arguments[4],M=arguments[5],v=arguments[6],N=arguments[7]):(H=arguments[1],Q=arguments[2],j=arguments[3],$=arguments[4],B=arguments[5],M=arguments[6],v=arguments[7],N=arguments[8]),ys(_=arguments[0])==="object"&&!d(_)&&"imageData"in _){var R=_;_=R.imageData,H=R.format||H||e,Q=R.x||Q||0,j=R.y||j||0,$=R.w||R.width||$,B=R.h||R.height||B,M=R.alias||M,v=R.compression||v,N=R.rotation||R.angle||N}var q=this.internal.getFilters();if(v===void 0&&q.indexOf("FlateEncode")!==-1&&(v="SLOW"),isNaN(Q)||isNaN(j))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var P=G.call(this,_,H,M,v);return p.call(this,Q,j,$,B,P,N),this};var G=function(_,H,Q,j){var $,B,M;if(typeof _=="string"&&i(_)===e){_=unescape(_);var v=U(_,!1);(v!==""||(v=t.loadFile(_,!0))!==void 0)&&(_=v)}if(d(_)&&(_=A(_,H)),H=i(_,H),!u(H))throw new Error("addImage does not support files of type '"+H+"', please ensure that a plugin for '"+H+"' support is added.");if(((M=Q)==null||M.length===0)&&(Q=(function(N){return typeof N=="string"||x(N)?g(N):x(N.data)?g(N.data):null})(_)),($=h.call(this,Q))||(w()&&(_ instanceof Uint8Array||H==="RGBA"||(B=_,_=I(_))),$=this["process"+H.toUpperCase()](_,c.call(this),Q,(function(N){return N&&typeof N=="string"&&(N=N.toUpperCase()),N in t.image_compression?N:y.NONE})(j),B)),!$)throw new Error("An unknown error occurred whilst processing the image.");return $},U=t.__addimage__.convertBase64ToBinaryString=function(_,H){var Q;H=typeof H!="boolean"||H;var j,$="";if(typeof _=="string"){j=(Q=E(_))!==null?Q.data:_;try{$=lI(j)}catch(B){if(H)throw b(j)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+B.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return $};t.getImageProperties=function(_){var H,Q,j="";if(d(_)&&(_=A(_)),typeof _=="string"&&i(_)===e&&((j=U(_,!1))===""&&(j=t.loadFile(_)||""),_=j),Q=i(_),!u(Q))throw new Error("addImage does not support files of type '"+Q+"', please ensure that a plugin for '"+Q+"' support is added.");if(!w()||_ instanceof Uint8Array||(_=I(_)),!(H=this["process"+Q.toUpperCase()](_)))throw new Error("An unknown error occurred whilst processing the image");return H.fileType=Q,H}})(ji.API),(function(t){var e=function(r){if(r!==void 0&&r!="")return!0};ji.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var i,n,s,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(r.objId),c=r.pageContext.annotations,u=!1,d=0;d<c.length&&!u;d++)switch((i=c[d]).type){case"link":(e(i.options.url)||e(i.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var A=0;A<c.length;A++){i=c[A];var h=this.internal.pdfEscape,f=this.internal.getEncryptor(r.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),m=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(p.objId),g=i.title||"Note";s="<</Type /Annot /Subtype /Text "+(n="/Rect ["+a(i.bounds.x)+" "+o(i.bounds.y+i.bounds.h)+" "+a(i.bounds.x+i.bounds.w)+" "+o(i.bounds.y)+"] ")+"/Contents ("+h(y(i.contents))+")",s+=" /Popup "+m.objId+" 0 R",s+=" /P "+l.objId+" 0 R",s+=" /T ("+h(y(g))+") >>",p.content=s;var b=p.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+a(i.bounds.x+30)+" "+o(i.bounds.y+i.bounds.h)+" "+a(i.bounds.x+i.bounds.w+30)+" "+o(i.bounds.y)+"] ")+" /Parent "+b,i.open&&(s+=" /Open true"),s+=" >>",m.content=s,this.internal.write(p.objId,"0 R",m.objId,"0 R");break;case"freetext":n="/Rect ["+a(i.bounds.x)+" "+o(i.bounds.y)+" "+a(i.bounds.x+i.bounds.w)+" "+o(i.bounds.y+i.bounds.h)+"] ";var E=i.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+h(f(i.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+E+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(i.options.name){var w=this.annotations._nameMap[i.options.name];i.options.pageNumber=w.page,i.options.top=w.y}else i.options.top||(i.options.top=0);if(n="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",s="",i.options.url)s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+h(f(i.options.url))+") >>";else if(i.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,s+=" /FitV "+i.options.left+"]";break;case"XYZ":default:var x=o(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),s+=" /XYZ "+i.options.left+" "+x+" "+i.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var i=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":i.pageContext.annotations.push(r)}},t.link=function(r,i,n,s,a){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(r),y:c(i),w:l(r+n),h:c(i+s)},options:a,type:"link"})},t.textWithLink=function(r,i,n,s){var a,o,l=this.getTextWidth(r),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){o=s.maxWidth;var u=this.splitTextToSize(r,o).length;a=Math.ceil(c*u)}else o=l,a=c;return this.text(r,i,n,s),n+=.2*c,s.align==="center"&&(i-=l/2),s.align==="right"&&(i-=l),this.link(i,n-c,o,a,s),l},t.getTextWidth=function(r){var i=this.internal.getFontSize();return this.getStringUnitWidth(r)*i/this.internal.scaleFactor}})(ji.API),(function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];t.__arabicParser__={};var s=t.__arabicParser__.isInArabicSubstitutionA=function(p){return e[p.charCodeAt(0)]!==void 0},a=t.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},o=t.__arabicParser__.isArabicEndLetter=function(p){return a(p)&&s(p)&&e[p.charCodeAt(0)].length<=2},l=t.__arabicParser__.isArabicAlfLetter=function(p){return a(p)&&n.indexOf(p.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return a(p)&&s(p)&&e[p.charCodeAt(0)].length>=1};var c=t.__arabicParser__.arabicLetterHasFinalForm=function(p){return a(p)&&s(p)&&e[p.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(p){return a(p)&&s(p)&&e[p.charCodeAt(0)].length>=3};var u=t.__arabicParser__.arabicLetterHasMedialForm=function(p){return a(p)&&s(p)&&e[p.charCodeAt(0)].length==4},d=t.__arabicParser__.resolveLigatures=function(p){var m=0,y=r,g="",b=0;for(m=0;m<p.length;m+=1)y[p.charCodeAt(m)]!==void 0?(b++,typeof(y=y[p.charCodeAt(m)])=="number"&&(g+=String.fromCharCode(y),y=r,b=0),m===p.length-1&&(y=r,g+=p.charAt(m-(b-1)),m-=b-1,b=0)):(y=r,g+=p.charAt(m-b),m-=b,b=0);return g};t.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&i[p.charCodeAt(0)]!==void 0};var A=t.__arabicParser__.getCorrectForm=function(p,m,y){return a(p)?s(p)===!1?-1:!c(p)||!a(m)&&!a(y)||!a(y)&&o(m)||o(p)&&!a(m)||o(p)&&l(m)||o(p)&&o(m)?0:u(p)&&a(m)&&!o(m)&&a(y)&&c(y)?3:o(p)||!a(y)?1:2:-1},h=function(p){var m=0,y=0,g=0,b="",E="",w="",x=(p=p||"").split("\\s+"),I=[];for(m=0;m<x.length;m+=1){for(I.push(""),y=0;y<x[m].length;y+=1)b=x[m][y],E=x[m][y-1],w=x[m][y+1],a(b)?(g=A(b,E,w),I[m]+=g!==-1?String.fromCharCode(e[b.charCodeAt(0)][g]):b):I[m]+=b;I[m]=d(I[m])}return I.join(" ")},f=t.__arabicParser__.processArabic=t.processArabic=function(){var p,m=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(m)){var g=0;for(y=[],g=0;g<m.length;g+=1)Array.isArray(m[g])?y.push([h(m[g][0]),m[g][1],m[g][2]]):y.push([h(m[g])]);p=y}else p=h(m);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};t.events.push(["preProcessText",f])})(ji.API),ji.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",(function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){this.internal.out("/OpenAction "+e+" 0 R")}))}return this},(function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(o){s=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,i){var n;if((r=r||"2d")!=="2d")return null;for(n in i)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=i[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(ji.API),(function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(p){l=p}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var A=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return A},set:function(p){A=p}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var f=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return f},set:function(p){f=p}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(l){return i.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},t.getTextDimensions=function(l,c){i.call(this);var u=(c=c||{}).fontSize||this.getFontSize(),d=c.font||this.getFont(),A=c.scaleFactor||this.internal.scaleFactor,h=0,f=0,p=0,m=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var y=c.maxWidth;y>0?typeof l=="string"?l=this.splitTextToSize(l,y):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce((function(b,E){return b.concat(m.splitTextToSize(E,y))}),[])):l=Array.isArray(l)?l:[l];for(var g=0;g<l.length;g++)h<(p=this.getStringUnitWidth(l[g],{font:d})*u)&&(h=p);return h!==0&&(f=l.length),{w:h/=A,h:Math.max((f*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/A,0)}},t.cellAddPage=function(){i.call(this),this.addPage();var l=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=t.cell=function(){var l;l=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),i.call(this);var c=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,A=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=d.top,h&&A&&(this.printHeaderRow(l.lineNumber,!0),l.y+=A[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,r===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-u,l.y+u,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+u,{align:"center",baseline:"top",maxWidth:l.width-u-u}):this.text(l.text,l.x+u,l.y+u,{align:"left",baseline:"top",maxWidth:l.width-u-u})),this.internal.__cell__.lastCell=l,this};t.table=function(l,c,u,d,A){if(i.call(this),!u)throw new Error("No data for PDF table.");var h,f,p,m,y=[],g=[],b=[],E={},w={},x=[],I=[],C=(A=A||{}).autoSize||!1,G=A.printHeaders!==!1,U=A.css&&A.css["font-size"]!==void 0?16*A.css["font-size"]:A.fontSize||12,_=A.margins||Object.assign({width:this.getPageWidth()},e),H=typeof A.padding=="number"?A.padding:3,Q=A.headerBackgroundColor||"#c8c8c8",j=A.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=G,this.internal.__cell__.margins=_,this.internal.__cell__.table_font_size=U,this.internal.__cell__.padding=H,this.internal.__cell__.headerBackgroundColor=Q,this.internal.__cell__.headerTextColor=j,this.setFontSize(U),d==null)g=y=Object.keys(u[0]),b=y.map((function(){return"left"}));else if(Array.isArray(d)&&ys(d[0])==="object")for(y=d.map((function(R){return R.name})),g=d.map((function(R){return R.prompt||R.name||""})),b=d.map((function(R){return R.align||"left"})),h=0;h<d.length;h+=1)w[d[h].name]=d[h].width*(19.049976/25.4);else Array.isArray(d)&&typeof d[0]=="string"&&(g=y=d,b=y.map((function(){return"left"})));if(C||Array.isArray(d)&&typeof d[0]=="string")for(h=0;h<y.length;h+=1){for(E[m=y[h]]=u.map((function(R){return R[m]})),this.setFont(void 0,"bold"),x.push(this.getTextDimensions(g[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),f=E[m],this.setFont(void 0,"normal"),p=0;p<f.length;p+=1)x.push(this.getTextDimensions(f[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);w[m]=Math.max.apply(null,x)+H+H,x=[]}if(G){var $={};for(h=0;h<y.length;h+=1)$[y[h]]={},$[y[h]].text=g[h],$[y[h]].align=b[h];var B=o.call(this,$,w);I=y.map((function(R){return new s(l,c,w[R],B,$[R].text,void 0,$[R].align)})),this.setTableHeaderRow(I),this.printHeaderRow(1,!1)}var M=d.reduce((function(R,q){return R[q.name]=q.align,R}),{});for(h=0;h<u.length;h+=1){"rowStart"in A&&A.rowStart instanceof Function&&A.rowStart({row:h,data:u[h]},this);var v=o.call(this,u[h],w);for(p=0;p<y.length;p+=1){var N=u[h][y[p]];"cellStart"in A&&A.cellStart instanceof Function&&A.cellStart({row:h,col:p,data:N},this),a.call(this,new s(l,c,w[y[p]],v,N,h+2,M[y[p]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var u=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,A=this.internal.scaleFactor;return Object.keys(l).map((function(h){var f=l[h];return this.splitTextToSize(f.hasOwnProperty("text")?f.text:f,c[h]-u-u)}),this).map((function(h){return this.getLineHeightFactor()*h.length*d/A+u+u}),this).reduce((function(h,f){return Math.max(h,f)}),0)};t.setTableHeaderRow=function(l){i.call(this),this.internal.__cell__.tableHeaderRow=l},t.printHeaderRow=function(l,c){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var A=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){u=this.internal.__cell__.tableHeaderRow[h].clone(),c&&(u.y=this.internal.__cell__.margins.top||0,A.push(u)),u.lineNumber=l;var f=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,u),this.setTextColor(f)}A.length>0&&this.setTableHeaderRow(A),this.setFont(void 0,"normal"),r=!1}})(ji.API);var eae={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},tae=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],dU=Zse(tae),rae=[100,200,300,400,500,600,700,800,900],QMe=Zse(rae);function AU(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(s){return eae[s=s||"normal"]?s:"normal"})(t.style),i=(function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}})(t.weight),n=(function(s){return typeof dU[s=s||"normal"]=="number"?s:"normal"})(t.stretch);return{family:e,style:r,weight:i,stretch:n,src:t.src||[],ref:t.ref||{name:e,style:[n,r,i].join(" ")}}}function Rse(t,e,r,i){var n;for(n=r;n>=0&&n<e.length;n+=i)if(t[e[n]])return t[e[n]];for(n=r;n>=0&&n<e.length;n-=i)if(t[e[n]])return t[e[n]]}var zMe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Mse={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function kse(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function XMe(t,e,r){for(var i=(r=r||{}).defaultFontFamily||"times",n=Object.assign({},zMe,r.genericFontFamilies||{}),s=null,a=null,o=0;o<e.length;++o)if(n[(s=AU(e[o])).family]&&(s.family=n[s.family]),t.hasOwnProperty(s.family)){a=t[s.family];break}if(!(a=a||t[i]))throw new Error("Could not find a font-family for the rule '"+kse(s)+"' and default family '"+i+"'.");if(a=(function(l,c){if(c[l])return c[l];var u=dU[l],d=u<=dU.normal?-1:1,A=Rse(c,tae,u,d);if(!A)throw new Error("Could not find a matching font-stretch value for "+l);return A})(s.stretch,a),a=(function(l,c){if(c[l])return c[l];for(var u=eae[l],d=0;d<u.length;++d)if(c[u[d]])return c[u[d]];throw new Error("Could not find a matching font-style for "+l)})(s.style,a),!(a=(function(l,c){if(c[l])return c[l];if(l===400&&c[500])return c[500];if(l===500&&c[400])return c[400];var u=QMe[l],d=Rse(c,rae,u,l<400?-1:1);if(!d)throw new Error("Could not find a matching font-weight for value "+l);return d})(s.weight,a)))throw new Error("Failed to resolve a font for the rule '"+kse(s)+"'.");return a}function Fse(t){return t.trimLeft()}function qMe(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function WMe(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var P3,Use,Hse,aU=["times"];(function(t){var e,r,i,n,s,a,o,l,c,u=function(P){return P=P||{},this.isStrokeTransparent=P.isStrokeTransparent||!1,this.strokeOpacity=P.strokeOpacity||1,this.strokeStyle=P.strokeStyle||"#000000",this.fillStyle=P.fillStyle||"#000000",this.isFillTransparent=P.isFillTransparent||!1,this.fillOpacity=P.fillOpacity||1,this.font=P.font||"10px sans-serif",this.textBaseline=P.textBaseline||"alphabetic",this.textAlign=P.textAlign||"left",this.lineWidth=P.lineWidth||1,this.lineJoin=P.lineJoin||"miter",this.lineCap=P.lineCap||"butt",this.path=P.path||[],this.transform=P.transform!==void 0?P.transform.clone():new l,this.globalCompositeOperation=P.globalCompositeOperation||"normal",this.globalAlpha=P.globalAlpha||1,this.clip_path=P.clip_path||[],this.currentPoint=P.currentPoint||new a,this.miterLimit=P.miterLimit||10,this.lastPoint=P.lastPoint||new a,this.lineDashOffset=P.lineDashOffset||0,this.lineDash=P.lineDash||[],this.margin=P.margin||[0,0,0,0],this.prevPageLastElemOffset=P.prevPageLastElemOffset||0,this.ignoreClearRect=typeof P.ignoreClearRect!="boolean"||P.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,r=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new u}]);var d=function(P){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var z=P;Object.defineProperty(this,"pdf",{get:function(){return z}});var W=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return W},set:function(ut){W=!!ut}});var oe=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return oe},set:function(ut){oe=!!ut}});var Ae=0;Object.defineProperty(this,"posX",{get:function(){return Ae},set:function(ut){isNaN(ut)||(Ae=ut)}});var me=0;Object.defineProperty(this,"posY",{get:function(){return me},set:function(ut){isNaN(ut)||(me=ut)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(ut){var Pe;typeof ut=="number"?Pe=[ut,ut,ut,ut]:((Pe=new Array(4))[0]=ut[0],Pe[1]=ut.length>=2?ut[1]:Pe[0],Pe[2]=ut.length>=3?ut[2]:Pe[0],Pe[3]=ut.length>=4?ut[3]:Pe[1]),c.margin=Pe}});var ve=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ve},set:function(ut){ve=ut}});var Le=0;Object.defineProperty(this,"lastBreak",{get:function(){return Le},set:function(ut){Le=ut}});var He=[];Object.defineProperty(this,"pageBreaks",{get:function(){return He},set:function(ut){He=ut}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(ut){ut instanceof u&&(c=ut)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(ut){c.path=ut}});var rt=[];Object.defineProperty(this,"ctxStack",{get:function(){return rt},set:function(ut){rt=ut}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ut){var Pe;Pe=A(ut),this.ctx.fillStyle=Pe.style,this.ctx.isFillTransparent=Pe.a===0,this.ctx.fillOpacity=Pe.a,this.pdf.setFillColor(Pe.r,Pe.g,Pe.b,{a:Pe.a}),this.pdf.setTextColor(Pe.r,Pe.g,Pe.b,{a:Pe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ut){var Pe=A(ut);this.ctx.strokeStyle=Pe.style,this.ctx.isStrokeTransparent=Pe.a===0,this.ctx.strokeOpacity=Pe.a,Pe.a===0?this.pdf.setDrawColor(255,255,255):(Pe.a,this.pdf.setDrawColor(Pe.r,Pe.g,Pe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ut){["butt","round","square"].indexOf(ut)!==-1&&(this.ctx.lineCap=ut,this.pdf.setLineCap(ut))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ut){isNaN(ut)||(this.ctx.lineWidth=ut,this.pdf.setLineWidth(ut))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ut){["bevel","round","miter"].indexOf(ut)!==-1&&(this.ctx.lineJoin=ut,this.pdf.setLineJoin(ut))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ut){isNaN(ut)||(this.ctx.miterLimit=ut,this.pdf.setMiterLimit(ut))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ut){this.ctx.textBaseline=ut}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ut){["right","end","center","left","start"].indexOf(ut)!==-1&&(this.ctx.textAlign=ut)}});var qe=null;function xt(ut,Pe){if(qe===null){var ft=(function(ht){var Qt=[];return Object.keys(ht).forEach((function(Yt){ht[Yt].forEach((function(Ft){var kt=null;switch(Ft){case"bold":kt={family:Yt,weight:"bold"};break;case"italic":kt={family:Yt,style:"italic"};break;case"bolditalic":kt={family:Yt,weight:"bold",style:"italic"};break;case"":case"normal":kt={family:Yt}}kt!==null&&(kt.ref={name:Yt,style:Ft},Qt.push(kt))}))})),Qt})(ut.getFontList());qe=(function(ht){for(var Qt={},Yt=0;Yt<ht.length;++Yt){var Ft=AU(ht[Yt]),kt=Ft.family,sr=Ft.stretch,Pt=Ft.style,_r=Ft.weight;Qt[kt]=Qt[kt]||{},Qt[kt][sr]=Qt[kt][sr]||{},Qt[kt][sr][Pt]=Qt[kt][sr][Pt]||{},Qt[kt][sr][Pt][_r]=Ft}return Qt})(ft.concat(Pe))}return qe}var Gt=null;Object.defineProperty(this,"fontFaces",{get:function(){return Gt},set:function(ut){qe=null,Gt=ut}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ut){var Pe;if(this.ctx.font=ut,(Pe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ut))!==null){var ft=Pe[1],ht=(Pe[2],Pe[3]),Qt=Pe[4],Yt=(Pe[5],Pe[6]),Ft=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Qt)[2];Qt=Math.floor(Ft==="px"?parseFloat(Qt)*this.pdf.internal.scaleFactor:Ft==="em"?parseFloat(Qt)*this.pdf.getFontSize():parseFloat(Qt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Qt);var kt=(function(Jt){var O,K,se=[],ae=Jt.trim();if(ae==="")return aU;if(ae in Mse)return[Mse[ae]];for(;ae!=="";){switch(K=null,O=(ae=Fse(ae)).charAt(0)){case'"':case"'":K=qMe(ae.substring(1),O);break;default:K=WMe(ae)}if(K===null||(se.push(K[0]),(ae=Fse(K[1]))!==""&&ae.charAt(0)!==","))return aU;ae=ae.replace(/^,/,"")}return se})(Yt);if(this.fontFaces){var sr=XMe(xt(this.pdf,this.fontFaces),kt.map((function(Jt){return{family:Jt,stretch:"normal",weight:ht,style:ft}})));this.pdf.setFont(sr.ref.name,sr.ref.style)}else{var Pt="";(ht==="bold"||parseInt(ht,10)>=700||ft==="bold")&&(Pt="bold"),ft==="italic"&&(Pt+="italic"),Pt.length===0&&(Pt="normal");for(var _r="",Lt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ct=0;ct<kt.length;ct++){if(this.pdf.internal.getFont(kt[ct],Pt,{noFallback:!0,disableWarning:!0})!==void 0){_r=kt[ct];break}if(Pt==="bolditalic"&&this.pdf.internal.getFont(kt[ct],"bold",{noFallback:!0,disableWarning:!0})!==void 0)_r=kt[ct],Pt="bold";else if(this.pdf.internal.getFont(kt[ct],"normal",{noFallback:!0,disableWarning:!0})!==void 0){_r=kt[ct],Pt="normal";break}}if(_r===""){for(var Zt=0;Zt<kt.length;Zt++)if(Lt[kt[Zt]]){_r=Lt[kt[Zt]];break}}_r=_r===""?"Times":_r,this.pdf.setFont(_r,Pt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ut){this.ctx.globalCompositeOperation=ut}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ut){this.ctx.globalAlpha=ut}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ut){this.ctx.lineDashOffset=ut,q.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ut){this.ctx.lineDash=ut,q.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ut){this.ctx.ignoreClearRect=!!ut}})};d.prototype.setLineDash=function(P){this.lineDash=P},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){E.call(this,"fill",!1)},d.prototype.stroke=function(){E.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(P,z){if(isNaN(P)||isNaN(z))throw Qa.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var W=this.ctx.transform.applyToPoint(new a(P,z));this.path.push({type:"mt",x:W.x,y:W.y}),this.ctx.lastPoint=new a(P,z)},d.prototype.closePath=function(){var P=new a(0,0),z=0;for(z=this.path.length-1;z!==-1;z--)if(this.path[z].type==="begin"&&ys(this.path[z+1])==="object"&&typeof this.path[z+1].x=="number"){P=new a(this.path[z+1].x,this.path[z+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(P.x,P.y)},d.prototype.lineTo=function(P,z){if(isNaN(P)||isNaN(z))throw Qa.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var W=this.ctx.transform.applyToPoint(new a(P,z));this.path.push({type:"lt",x:W.x,y:W.y}),this.ctx.lastPoint=new a(W.x,W.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),E.call(this,null,!0)},d.prototype.quadraticCurveTo=function(P,z,W,oe){if(isNaN(W)||isNaN(oe)||isNaN(P)||isNaN(z))throw Qa.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Ae=this.ctx.transform.applyToPoint(new a(W,oe)),me=this.ctx.transform.applyToPoint(new a(P,z));this.path.push({type:"qct",x1:me.x,y1:me.y,x:Ae.x,y:Ae.y}),this.ctx.lastPoint=new a(Ae.x,Ae.y)},d.prototype.bezierCurveTo=function(P,z,W,oe,Ae,me){if(isNaN(Ae)||isNaN(me)||isNaN(P)||isNaN(z)||isNaN(W)||isNaN(oe))throw Qa.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ve=this.ctx.transform.applyToPoint(new a(Ae,me)),Le=this.ctx.transform.applyToPoint(new a(P,z)),He=this.ctx.transform.applyToPoint(new a(W,oe));this.path.push({type:"bct",x1:Le.x,y1:Le.y,x2:He.x,y2:He.y,x:ve.x,y:ve.y}),this.ctx.lastPoint=new a(ve.x,ve.y)},d.prototype.arc=function(P,z,W,oe,Ae,me){if(isNaN(P)||isNaN(z)||isNaN(W)||isNaN(oe)||isNaN(Ae))throw Qa.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(me=!!me,!this.ctx.transform.isIdentity){var ve=this.ctx.transform.applyToPoint(new a(P,z));P=ve.x,z=ve.y;var Le=this.ctx.transform.applyToPoint(new a(0,W)),He=this.ctx.transform.applyToPoint(new a(0,0));W=Math.sqrt(Math.pow(Le.x-He.x,2)+Math.pow(Le.y-He.y,2))}Math.abs(Ae-oe)>=2*Math.PI&&(oe=0,Ae=2*Math.PI),this.path.push({type:"arc",x:P,y:z,radius:W,startAngle:oe,endAngle:Ae,counterclockwise:me})},d.prototype.arcTo=function(P,z,W,oe,Ae){throw new Error("arcTo not implemented.")},d.prototype.rect=function(P,z,W,oe){if(isNaN(P)||isNaN(z)||isNaN(W)||isNaN(oe))throw Qa.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(P,z),this.lineTo(P+W,z),this.lineTo(P+W,z+oe),this.lineTo(P,z+oe),this.lineTo(P,z),this.lineTo(P+W,z),this.lineTo(P,z)},d.prototype.fillRect=function(P,z,W,oe){if(isNaN(P)||isNaN(z)||isNaN(W)||isNaN(oe))throw Qa.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var Ae={};this.lineCap!=="butt"&&(Ae.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Ae.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(P,z,W,oe),this.fill(),Ae.hasOwnProperty("lineCap")&&(this.lineCap=Ae.lineCap),Ae.hasOwnProperty("lineJoin")&&(this.lineJoin=Ae.lineJoin)}},d.prototype.strokeRect=function(P,z,W,oe){if(isNaN(P)||isNaN(z)||isNaN(W)||isNaN(oe))throw Qa.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");f.call(this)||(this.beginPath(),this.rect(P,z,W,oe),this.stroke())},d.prototype.clearRect=function(P,z,W,oe){if(isNaN(P)||isNaN(z)||isNaN(W)||isNaN(oe))throw Qa.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(P,z,W,oe))},d.prototype.save=function(P){P=typeof P!="boolean"||P;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("q");if(this.pdf.setPage(z),P){this.ctx.fontSize=this.pdf.internal.getFontSize();var oe=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=oe}},d.prototype.restore=function(P){P=typeof P!="boolean"||P;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("Q");this.pdf.setPage(z),P&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var A=function(P){var z,W,oe,Ae;if(P.isCanvasGradient===!0&&(P=P.getColor()),!P)return{r:0,g:0,b:0,a:0,style:P};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(P))z=0,W=0,oe=0,Ae=0;else{var me=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(P);if(me!==null)z=parseInt(me[1]),W=parseInt(me[2]),oe=parseInt(me[3]),Ae=1;else if((me=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(P))!==null)z=parseInt(me[1]),W=parseInt(me[2]),oe=parseInt(me[3]),Ae=parseFloat(me[4]);else{if(Ae=1,typeof P=="string"&&P.charAt(0)!=="#"){var ve=new Xse(P);P=ve.ok?ve.toHex():"#000000"}P.length===4?(z=P.substring(1,2),z+=z,W=P.substring(2,3),W+=W,oe=P.substring(3,4),oe+=oe):(z=P.substring(1,3),W=P.substring(3,5),oe=P.substring(5,7)),z=parseInt(z,16),W=parseInt(W,16),oe=parseInt(oe,16)}}return{r:z,g:W,b:oe,a:Ae,style:P}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},f=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(P,z,W,oe){if(isNaN(z)||isNaN(W)||typeof P!="string")throw Qa.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(oe=isNaN(oe)?void 0:oe,!h.call(this)){var Ae=v(this.ctx.transform.rotation),me=this.ctx.transform.scaleX;H.call(this,{text:P,x:z,y:W,scale:me,angle:Ae,align:this.textAlign,maxWidth:oe})}},d.prototype.strokeText=function(P,z,W,oe){if(isNaN(z)||isNaN(W)||typeof P!="string")throw Qa.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!f.call(this)){oe=isNaN(oe)?void 0:oe;var Ae=v(this.ctx.transform.rotation),me=this.ctx.transform.scaleX;H.call(this,{text:P,x:z,y:W,scale:me,renderingMode:"stroke",angle:Ae,align:this.textAlign,maxWidth:oe})}},d.prototype.measureText=function(P){if(typeof P!="string")throw Qa.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var z=this.pdf,W=this.pdf.internal.scaleFactor,oe=z.internal.getFontSize(),Ae=z.getStringUnitWidth(P)*oe/z.internal.scaleFactor,me=function(ve){var Le=(ve=ve||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Le}}),this};return new me({width:Ae*=Math.round(96*W/72*1e4)/1e4})},d.prototype.scale=function(P,z){if(isNaN(P)||isNaN(z))throw Qa.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var W=new l(P,0,0,z,0,0);this.ctx.transform=this.ctx.transform.multiply(W)},d.prototype.rotate=function(P){if(isNaN(P))throw Qa.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var z=new l(Math.cos(P),Math.sin(P),-Math.sin(P),Math.cos(P),0,0);this.ctx.transform=this.ctx.transform.multiply(z)},d.prototype.translate=function(P,z){if(isNaN(P)||isNaN(z))throw Qa.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var W=new l(1,0,0,1,P,z);this.ctx.transform=this.ctx.transform.multiply(W)},d.prototype.transform=function(P,z,W,oe,Ae,me){if(isNaN(P)||isNaN(z)||isNaN(W)||isNaN(oe)||isNaN(Ae)||isNaN(me))throw Qa.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ve=new l(P,z,W,oe,Ae,me);this.ctx.transform=this.ctx.transform.multiply(ve)},d.prototype.setTransform=function(P,z,W,oe,Ae,me){P=isNaN(P)?1:P,z=isNaN(z)?0:z,W=isNaN(W)?0:W,oe=isNaN(oe)?1:oe,Ae=isNaN(Ae)?0:Ae,me=isNaN(me)?0:me,this.ctx.transform=new l(P,z,W,oe,Ae,me)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(P,z,W,oe,Ae,me,ve,Le,He){var rt=this.pdf.getImageProperties(P),qe=1,xt=1,Gt=1,ut=1;oe!==void 0&&Le!==void 0&&(Gt=Le/oe,ut=He/Ae,qe=rt.width/oe*Le/oe,xt=rt.height/Ae*He/Ae),me===void 0&&(me=z,ve=W,z=0,W=0),oe!==void 0&&Le===void 0&&(Le=oe,He=Ae),oe===void 0&&Le===void 0&&(Le=rt.width,He=rt.height);for(var Pe,ft=this.ctx.transform.decompose(),ht=v(ft.rotate.shx),Qt=new l,Yt=(Qt=(Qt=(Qt=Qt.multiply(ft.translate)).multiply(ft.skew)).multiply(ft.scale)).applyToRectangle(new o(me-z*Gt,ve-W*ut,oe*qe,Ae*xt)),Ft=m.call(this,Yt),kt=[],sr=0;sr<Ft.length;sr+=1)kt.indexOf(Ft[sr])===-1&&kt.push(Ft[sr]);if(b(kt),this.autoPaging)for(var Pt=kt[0],_r=kt[kt.length-1],Lt=Pt;Lt<_r+1;Lt++){this.pdf.setPage(Lt);var ct=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Zt=Lt===1?this.posY+this.margin[0]:this.margin[0],Jt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],O=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],K=Lt===1?0:Jt+(Lt-2)*O;if(this.ctx.clip_path.length!==0){var se=this.path;Pe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=g(Pe,this.posX+this.margin[3],-K+Zt+this.ctx.prevPageLastElemOffset),w.call(this,"fill",!0),this.path=se}var ae=JSON.parse(JSON.stringify(Yt));ae=g([ae],this.posX+this.margin[3],-K+Zt+this.ctx.prevPageLastElemOffset)[0];var ue=(Lt>Pt||Lt<_r)&&p.call(this);ue&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ct,O,null).clip().discardPath()),this.pdf.addImage(P,"JPEG",ae.x,ae.y,ae.w,ae.h,null,null,ht),ue&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(P,"JPEG",Yt.x,Yt.y,Yt.w,Yt.h,null,null,ht)};var m=function(P,z,W){var oe=[];z=z||this.pdf.internal.pageSize.width,W=W||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Ae=this.posY+this.ctx.prevPageLastElemOffset;switch(P.type){default:case"mt":case"lt":oe.push(Math.floor((P.y+Ae)/W)+1);break;case"arc":oe.push(Math.floor((P.y+Ae-P.radius)/W)+1),oe.push(Math.floor((P.y+Ae+P.radius)/W)+1);break;case"qct":var me=N(this.ctx.lastPoint.x,this.ctx.lastPoint.y,P.x1,P.y1,P.x,P.y);oe.push(Math.floor((me.y+Ae)/W)+1),oe.push(Math.floor((me.y+me.h+Ae)/W)+1);break;case"bct":var ve=R(this.ctx.lastPoint.x,this.ctx.lastPoint.y,P.x1,P.y1,P.x2,P.y2,P.x,P.y);oe.push(Math.floor((ve.y+Ae)/W)+1),oe.push(Math.floor((ve.y+ve.h+Ae)/W)+1);break;case"rect":oe.push(Math.floor((P.y+Ae)/W)+1),oe.push(Math.floor((P.y+P.h+Ae)/W)+1)}for(var Le=0;Le<oe.length;Le+=1)for(;this.pdf.internal.getNumberOfPages()<oe[Le];)y.call(this);return oe},y=function(){var P=this.fillStyle,z=this.strokeStyle,W=this.font,oe=this.lineCap,Ae=this.lineWidth,me=this.lineJoin;this.pdf.addPage(),this.fillStyle=P,this.strokeStyle=z,this.font=W,this.lineCap=oe,this.lineWidth=Ae,this.lineJoin=me},g=function(P,z,W){for(var oe=0;oe<P.length;oe++)switch(P[oe].type){case"bct":P[oe].x2+=z,P[oe].y2+=W;case"qct":P[oe].x1+=z,P[oe].y1+=W;case"mt":case"lt":case"arc":default:P[oe].x+=z,P[oe].y+=W}return P},b=function(P){return P.sort((function(z,W){return z-W}))},E=function(P,z){for(var W,oe,Ae=this.fillStyle,me=this.strokeStyle,ve=this.lineCap,Le=this.lineWidth,He=Math.abs(Le*this.ctx.transform.scaleX),rt=this.lineJoin,qe=JSON.parse(JSON.stringify(this.path)),xt=JSON.parse(JSON.stringify(this.path)),Gt=[],ut=0;ut<xt.length;ut++)if(xt[ut].x!==void 0)for(var Pe=m.call(this,xt[ut]),ft=0;ft<Pe.length;ft+=1)Gt.indexOf(Pe[ft])===-1&&Gt.push(Pe[ft]);for(var ht=0;ht<Gt.length;ht++)for(;this.pdf.internal.getNumberOfPages()<Gt[ht];)y.call(this);if(b(Gt),this.autoPaging)for(var Qt=Gt[0],Yt=Gt[Gt.length-1],Ft=Qt;Ft<Yt+1;Ft++){this.pdf.setPage(Ft),this.fillStyle=Ae,this.strokeStyle=me,this.lineCap=ve,this.lineWidth=He,this.lineJoin=rt;var kt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],sr=Ft===1?this.posY+this.margin[0]:this.margin[0],Pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_r=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Lt=Ft===1?0:Pt+(Ft-2)*_r;if(this.ctx.clip_path.length!==0){var ct=this.path;W=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=g(W,this.posX+this.margin[3],-Lt+sr+this.ctx.prevPageLastElemOffset),w.call(this,P,!0),this.path=ct}if(oe=JSON.parse(JSON.stringify(qe)),this.path=g(oe,this.posX+this.margin[3],-Lt+sr+this.ctx.prevPageLastElemOffset),z===!1||Ft===0){var Zt=(Ft>Qt||Ft<Yt)&&p.call(this);Zt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],kt,_r,null).clip().discardPath()),w.call(this,P,z),Zt&&this.pdf.restoreGraphicsState()}this.lineWidth=Le}else this.lineWidth=He,w.call(this,P,z),this.lineWidth=Le;this.path=qe},w=function(P,z){if((P!=="stroke"||z||!f.call(this))&&(P==="stroke"||z||!h.call(this))){for(var W,oe,Ae=[],me=this.path,ve=0;ve<me.length;ve++){var Le=me[ve];switch(Le.type){case"begin":Ae.push({begin:!0});break;case"close":Ae.push({close:!0});break;case"mt":Ae.push({start:Le,deltas:[],abs:[]});break;case"lt":var He=Ae.length;if(me[ve-1]&&!isNaN(me[ve-1].x)&&(W=[Le.x-me[ve-1].x,Le.y-me[ve-1].y],He>0)){for(;He>=0;He--)if(Ae[He-1].close!==!0&&Ae[He-1].begin!==!0){Ae[He-1].deltas.push(W),Ae[He-1].abs.push(Le);break}}break;case"bct":W=[Le.x1-me[ve-1].x,Le.y1-me[ve-1].y,Le.x2-me[ve-1].x,Le.y2-me[ve-1].y,Le.x-me[ve-1].x,Le.y-me[ve-1].y],Ae[Ae.length-1].deltas.push(W);break;case"qct":var rt=me[ve-1].x+2/3*(Le.x1-me[ve-1].x),qe=me[ve-1].y+2/3*(Le.y1-me[ve-1].y),xt=Le.x+2/3*(Le.x1-Le.x),Gt=Le.y+2/3*(Le.y1-Le.y),ut=Le.x,Pe=Le.y;W=[rt-me[ve-1].x,qe-me[ve-1].y,xt-me[ve-1].x,Gt-me[ve-1].y,ut-me[ve-1].x,Pe-me[ve-1].y],Ae[Ae.length-1].deltas.push(W);break;case"arc":Ae.push({deltas:[],abs:[],arc:!0}),Array.isArray(Ae[Ae.length-1].abs)&&Ae[Ae.length-1].abs.push(Le)}}oe=z?null:P==="stroke"?"stroke":"fill";for(var ft=!1,ht=0;ht<Ae.length;ht++)if(Ae[ht].arc)for(var Qt=Ae[ht].abs,Yt=0;Yt<Qt.length;Yt++){var Ft=Qt[Yt];Ft.type==="arc"?C.call(this,Ft.x,Ft.y,Ft.radius,Ft.startAngle,Ft.endAngle,Ft.counterclockwise,void 0,z,!ft):Q.call(this,Ft.x,Ft.y),ft=!0}else if(Ae[ht].close===!0)this.pdf.internal.out("h"),ft=!1;else if(Ae[ht].begin!==!0){var kt=Ae[ht].start.x,sr=Ae[ht].start.y;j.call(this,Ae[ht].deltas,kt,sr),ft=!0}oe&&G.call(this,oe),z&&U.call(this)}},x=function(P){var z=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,W=z*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return P-W;case"top":return P+z-W;case"hanging":return P+z-2*W;case"middle":return P+z/2-W;case"ideographic":return P;case"alphabetic":default:return P}},I=function(P){return P+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var P=function(){};return P.colorStops=[],P.addColorStop=function(z,W){this.colorStops.push([z,W])},P.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},P.isCanvasGradient=!0,P},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(P,z,W,oe,Ae,me,ve,Le,He){for(var rt=B.call(this,W,oe,Ae,me),qe=0;qe<rt.length;qe++){var xt=rt[qe];qe===0&&(He?_.call(this,xt.x1+P,xt.y1+z):Q.call(this,xt.x1+P,xt.y1+z)),$.call(this,P,z,xt.x2,xt.y2,xt.x3,xt.y3,xt.x4,xt.y4)}Le?U.call(this):G.call(this,ve)},G=function(P){switch(P){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},U=function(){this.pdf.clip(),this.pdf.discardPath()},_=function(P,z){this.pdf.internal.out(r(P)+" "+i(z)+" m")},H=function(P){var z;switch(P.align){case"right":case"end":z="right";break;case"center":z="center";break;case"left":case"start":default:z="left"}var W=this.pdf.getTextDimensions(P.text),oe=x.call(this,P.y),Ae=I.call(this,oe)-W.h,me=this.ctx.transform.applyToPoint(new a(P.x,oe)),ve=this.ctx.transform.decompose(),Le=new l;Le=(Le=(Le=Le.multiply(ve.translate)).multiply(ve.skew)).multiply(ve.scale);for(var He,rt,qe,xt=this.ctx.transform.applyToRectangle(new o(P.x,oe,W.w,W.h)),Gt=Le.applyToRectangle(new o(P.x,Ae,W.w,W.h)),ut=m.call(this,Gt),Pe=[],ft=0;ft<ut.length;ft+=1)Pe.indexOf(ut[ft])===-1&&Pe.push(ut[ft]);if(b(Pe),this.autoPaging)for(var ht=Pe[0],Qt=Pe[Pe.length-1],Yt=ht;Yt<Qt+1;Yt++){this.pdf.setPage(Yt);var Ft=Yt===1?this.posY+this.margin[0]:this.margin[0],kt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],sr=this.pdf.internal.pageSize.height-this.margin[2],Pt=sr-this.margin[0],_r=this.pdf.internal.pageSize.width-this.margin[1],Lt=_r-this.margin[3],ct=Yt===1?0:kt+(Yt-2)*Pt;if(this.ctx.clip_path.length!==0){var Zt=this.path;He=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=g(He,this.posX+this.margin[3],-1*ct+Ft),w.call(this,"fill",!0),this.path=Zt}var Jt=g([JSON.parse(JSON.stringify(Gt))],this.posX+this.margin[3],-ct+Ft+this.ctx.prevPageLastElemOffset)[0];P.scale>=.01&&(rt=this.pdf.internal.getFontSize(),this.pdf.setFontSize(rt*P.scale),qe=this.lineWidth,this.lineWidth=qe*P.scale);var O=this.autoPaging!=="text";if(O||Jt.y+Jt.h<=sr){if(O||Jt.y>=Ft&&Jt.x<=_r){var K=O?P.text:this.pdf.splitTextToSize(P.text,P.maxWidth||_r-Jt.x)[0],se=g([JSON.parse(JSON.stringify(xt))],this.posX+this.margin[3],-ct+Ft+this.ctx.prevPageLastElemOffset)[0],ae=O&&(Yt>ht||Yt<Qt)&&p.call(this);ae&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Lt,Pt,null).clip().discardPath()),this.pdf.text(K,se.x,se.y,{angle:P.angle,align:z,renderingMode:P.renderingMode}),ae&&this.pdf.restoreGraphicsState()}}else Jt.y<sr&&(this.ctx.prevPageLastElemOffset+=sr-Jt.y);P.scale>=.01&&(this.pdf.setFontSize(rt),this.lineWidth=qe)}else P.scale>=.01&&(rt=this.pdf.internal.getFontSize(),this.pdf.setFontSize(rt*P.scale),qe=this.lineWidth,this.lineWidth=qe*P.scale),this.pdf.text(P.text,me.x+this.posX,me.y+this.posY,{angle:P.angle,align:z,renderingMode:P.renderingMode,maxWidth:P.maxWidth}),P.scale>=.01&&(this.pdf.setFontSize(rt),this.lineWidth=qe)},Q=function(P,z,W,oe){W=W||0,oe=oe||0,this.pdf.internal.out(r(P+W)+" "+i(z+oe)+" l")},j=function(P,z,W){return this.pdf.lines(P,z,W,null,null)},$=function(P,z,W,oe,Ae,me,ve,Le){this.pdf.internal.out([e(n(W+P)),e(s(oe+z)),e(n(Ae+P)),e(s(me+z)),e(n(ve+P)),e(s(Le+z)),"c"].join(" "))},B=function(P,z,W,oe){for(var Ae=2*Math.PI,me=Math.PI/2;z>W;)z-=Ae;var ve=Math.abs(W-z);ve<Ae&&oe&&(ve=Ae-ve);for(var Le=[],He=oe?-1:1,rt=z;ve>1e-5;){var qe=rt+He*Math.min(ve,me);Le.push(M.call(this,P,rt,qe)),ve-=Math.abs(qe-rt),rt=qe}return Le},M=function(P,z,W){var oe=(W-z)/2,Ae=P*Math.cos(oe),me=P*Math.sin(oe),ve=Ae,Le=-me,He=ve*ve+Le*Le,rt=He+ve*Ae+Le*me,qe=4/3*(Math.sqrt(2*He*rt)-rt)/(ve*me-Le*Ae),xt=ve-qe*Le,Gt=Le+qe*ve,ut=xt,Pe=-Gt,ft=oe+z,ht=Math.cos(ft),Qt=Math.sin(ft);return{x1:P*Math.cos(z),y1:P*Math.sin(z),x2:xt*ht-Gt*Qt,y2:xt*Qt+Gt*ht,x3:ut*ht-Pe*Qt,y3:ut*Qt+Pe*ht,x4:P*Math.cos(W),y4:P*Math.sin(W)}},v=function(P){return 180*P/Math.PI},N=function(P,z,W,oe,Ae,me){var ve=P+.5*(W-P),Le=z+.5*(oe-z),He=Ae+.5*(W-Ae),rt=me+.5*(oe-me),qe=Math.min(P,Ae,ve,He),xt=Math.max(P,Ae,ve,He),Gt=Math.min(z,me,Le,rt),ut=Math.max(z,me,Le,rt);return new o(qe,Gt,xt-qe,ut-Gt)},R=function(P,z,W,oe,Ae,me,ve,Le){var He,rt,qe,xt,Gt,ut,Pe,ft,ht,Qt,Yt,Ft,kt,sr,Pt=W-P,_r=oe-z,Lt=Ae-W,ct=me-oe,Zt=ve-Ae,Jt=Le-me;for(rt=0;rt<41;rt++)ht=(Pe=(qe=P+(He=rt/40)*Pt)+He*((Gt=W+He*Lt)-qe))+He*(Gt+He*(Ae+He*Zt-Gt)-Pe),Qt=(ft=(xt=z+He*_r)+He*((ut=oe+He*ct)-xt))+He*(ut+He*(me+He*Jt-ut)-ft),rt==0?(Yt=ht,Ft=Qt,kt=ht,sr=Qt):(Yt=Math.min(Yt,ht),Ft=Math.min(Ft,Qt),kt=Math.max(kt,ht),sr=Math.max(sr,Qt));return new o(Math.round(Yt),Math.round(Ft),Math.round(kt-Yt),Math.round(sr-Ft))},q=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var P,z,W=(P=this.ctx.lineDash,z=this.ctx.lineDashOffset,JSON.stringify({lineDash:P,lineDashOffset:z}));this.prevLineDash!==W&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=W)}}})(ji.API),(function(t){var e=function(s){var a,o,l,c,u,d,A,h,f,p;for(/[^\x00-\xFF]/.test(s),o=[],l=0,c=(s+=a="\0\0\0\0".slice(s.length%4||4)).length;c>l;l+=4)(u=(s.charCodeAt(l)<<24)+(s.charCodeAt(l+1)<<16)+(s.charCodeAt(l+2)<<8)+s.charCodeAt(l+3))!==0?(d=(u=((u=((u=((u=(u-(p=u%85))/85)-(f=u%85))/85)-(h=u%85))/85)-(A=u%85))/85)%85,o.push(d+33,A+33,h+33,f+33,p+33)):o.push(122);return(function(m,y){for(var g=y;g>0;g--)m.pop()})(o,a.length),String.fromCharCode.apply(String,o)+"~>"},r=function(s){var a,o,l,c,u,d=String,A="length",h=255,f="charCodeAt",p="slice",m="replace";for(s[p](-2),s=s[p](0,-2)[m](/\s/g,"")[m]("z","!!!!!"),l=[],c=0,u=(s+=a="uuuuu"[p](s[A]%5||5))[A];u>c;c+=5)o=52200625*(s[f](c)-33)+614125*(s[f](c+1)-33)+7225*(s[f](c+2)-33)+85*(s[f](c+3)-33)+(s[f](c+4)-33),l.push(h&o>>24,h&o>>16,h&o>>8,h&o);return(function(y,g){for(var b=g;b>0;b--)y.pop()})(l,a[A]),d.fromCharCode.apply(d,l)},i=function(s){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),a.test(s)===!1)return"";for(var o="",l=0;l<s.length;l+=2)o+=String.fromCharCode("0x"+(s[l]+s[l+1]));return o},n=function(s){for(var a=new Uint8Array(s.length),o=s.length;o--;)a[o]=s.charCodeAt(o);return s=(a=YO(a)).reduce((function(l,c){return l+String.fromCharCode(c)}),"")};t.processDataByFilters=function(s,a){var o=0,l=s||"",c=[];for(typeof(a=a||[])=="string"&&(a=[a]),o=0;o<a.length;o+=1)switch(a[o]){case"ASCII85Decode":case"/ASCII85Decode":l=r(l),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=e(l),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=i(l),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map((function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)})).join("")+">",c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=n(l),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[o]+'" is not implemented')}return{data:l,reverseChain:c.reverse().join(" ")}}})(ji.API),(function(t){t.loadFile=function(e,r,i){return(function(n,s,a){s=s!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=(function(l,c,u){var d=new XMLHttpRequest,A=0,h=function(f){var p=f.length,m=[],y=String.fromCharCode;for(A=0;A<p;A+=1)m.push(y(255&f.charCodeAt(A)));return m.join("")};if(d.open("GET",l,!c),d.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(d.onload=function(){d.status===200?u(h(this.responseText)):u(void 0)}),d.send(null),c&&d.status===200)return h(d.responseText)})(n,s,a)}catch{}return o})(e,r,i)},t.loadImageFile=t.loadFile})(ji.API),(function(t){function e(){return(Ki.html2canvas?Promise.resolve(Ki.html2canvas):Promise.resolve().then(()=>pa(e$()))).catch((function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))})).then((function(a){return a.default?a.default:a}))}function r(){return(Ki.DOMPurify?Promise.resolve(Ki.DOMPurify):Promise.resolve().then(()=>pa(t$()))).catch((function(a){return Promise.reject(new Error("Could not load dompurify: "+a))})).then((function(a){return a.default?a.default:a}))}var i=function(a){var o=ys(a);return o==="undefined"?"undefined":o==="string"||a instanceof String?"string":o==="number"||a instanceof Number?"number":o==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":o==="object"?"object":"unknown"},n=function(a,o){var l=document.createElement(a);for(var c in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[c]=o.style[c];return l},s=function a(o){var l=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),c=a.convert(Promise.resolve(),l);return c=(c=c.setProgress(1,a,1,[a])).set(o)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(a,o){return a.__proto__=o||s.prototype,a},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(a,o){return this.then((function(){switch(o=o||(function(l){switch(i(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(a)){case"string":return this.then(r).then((function(l){return this.set({src:n("div",{innerHTML:a,dompurify:l})})}));case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}}))},s.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then((function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=(function l(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),A=c.firstChild;A;A=A.nextSibling)u!==!0&&A.nodeType===1&&A.nodeName==="SCRIPT"||d.appendChild(l(A,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",(function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft}),!0)),d})(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"}))},s.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then((function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)})).then((function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)}))},s.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then((function(o){var l=this.opt.jsPDF,c=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,d=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete d.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=c,c)for(var A=0;A<c.length;++A){var h=c[A],f=h.src.find((function(p){return p.format==="truetype"}));f&&l.addFont(f.url,h.ref.name,h.ref.style)}return d.windowHeight=d.windowHeight||0,d.windowHeight=d.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):d.windowHeight,l.context2d.save(!0),o(this.prop.container,d)})).then((function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)}))},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then((function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a}))},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then((function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF}))},s.prototype.output=function(a,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(a,o):this.outputPdf(a,o)},s.prototype.outputPdf=function(a,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){return this.prop.pdf.output(a,o)}))},s.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then((function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}}))},s.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then((function(){this.prop.pdf.save(this.opt.filename)}))},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){this.prop.callback(this.prop.pdf)}))},s.prototype.set=function(a){if(i(a)!=="object")return this;var o=Object.keys(a||{}).map((function(l){if(l in s.template.prop)return function(){this.prop[l]=a[l]};switch(l){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[l]=a[l]}}}),this);return this.then((function(){return this.thenList(o)}))},s.prototype.get=function(a,o){return this.then((function(){var l=a in s.template.prop?this.prop[a]:this.opt[a];return o?o(l):l}))},s.prototype.setMargin=function(a){return this.then((function(){switch(i(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a})).then(this.setPageSize)},s.prototype.setPageSize=function(a){function o(l,c){return Math.floor(l*c/72*96)}return this.then((function(){(a=a||ji.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:o(a.inner.width,a.k),height:o(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a}))},s.prototype.setProgress=function(a,o,l,c){return a!=null&&(this.progress.val=a),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),c!=null&&(this.progress.stack=c),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(a,o,l,c){return this.setProgress(a?this.progress.val+a:null,o||null,l?this.progress.n+l:null,c?this.progress.stack.concat(c):null)},s.prototype.then=function(a,o){var l=this;return this.thenCore(a,o,(function(c,u){return l.updateProgress(null,null,1,[c]),Promise.prototype.then.call(this,(function(d){return l.updateProgress(null,c),d})).then(c,u).then((function(d){return l.updateProgress(1),d}))}))},s.prototype.thenCore=function(a,o,l){l=l||Promise.prototype.then,a&&(a=a.bind(this)),o&&(o=o.bind(this));var c=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),u=l.call(c,a,o);return s.convert(u,this.__proto__)},s.prototype.thenExternal=function(a,o){return Promise.prototype.then.call(this,a,o)},s.prototype.thenList=function(a){var o=this;return a.forEach((function(l){o=o.thenCore(l)})),o},s.prototype.catch=function(a){a&&(a=a.bind(this));var o=Promise.prototype.catch.call(this,a);return s.convert(o,this)},s.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},s.prototype.error=function(a){return this.then((function(){throw new Error(a)}))},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,ji.getPageSize=function(a,o,l){if(ys(a)==="object"){var c=a;a=c.orientation,o=c.unit||o,l=c.format||l}o=o||"mm",l=l||"a4",a=(""+(a||"P")).toLowerCase();var u,d=(""+l).toLowerCase(),A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+o}var h,f=0,p=0;if(A.hasOwnProperty(d))f=A[d][1]/u,p=A[d][0]/u;else try{f=l[1],p=l[0]}catch{throw new Error("Invalid format: "+l)}if(a==="p"||a==="portrait")a="p",p>f&&(h=p,p=f,f=h);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",f>p&&(h=p,p=f,f=h)}return{width:p,height:f,unit:o,k:u,orientation:a}},t.html=function(a,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(AU):null;var l=new s(o);return o.worker?l:l.from(a).doCallback()}})(ji.API),ji.API.addJS=function(t){return Hse=t,this.internal.events.subscribe("postPutResources",(function(){P3=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(P3+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Use=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Hse+")"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){P3!==void 0&&Use!==void 0&&this.internal.out("/Names <</JavaScript "+P3+" 0 R>>")})),this},(function(t){var e;t.events.push(["postPutResources",function(){var r=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),s=0;s<n.length;s++){var a=n[s],o=i.exec(a);if(o!=null){var l=o[1];r.internal.newObjectDeferredBegin(l,!1)}r.internal.write(a)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,u=[];for(s=0;s<c;s++){var d=r.internal.newObject();u.push(d);var A=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+A.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<u.length;s++)r.internal.write("(page_"+(s+1)+")"+u[s]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(i,n,s){var a={title:n,options:s,children:[]};return i==null&&(i=this.root),i.children.push(a),a},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(i){i.id=r.internal.newObjectDeferred();for(var n=0;n<i.children.length;n++)this.genIds_r(i.children[n])},r.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},r.outline.renderItems=function(i){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<i.children.length;s++){var a=i.children[s];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(i)),s>0&&this.line("/Prev "+this.makeRef(i.children[s-1])),s<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[s+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var l=r.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var c=0;c<i.children.length;c++)this.renderItems(i.children[c])},r.outline.line=function(i){this.ctx.val+=i+`\r
`},r.outline.makeRef=function(i){return i.id+" 0 R"},r.outline.makeString=function(i){return"("+r.internal.pdfEscape(i)+")"},r.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(i,n){for(var s=0;s<n.children.length;s++)i.count++,this.count_r(i,n.children[s]);return i.count}}])})(ji.API),(function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,i,n,s,a,o){var l,c=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=a||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(l=(function(d){for(var A,h=256*d.charCodeAt(4)+d.charCodeAt(5),f=d.length,p={width:0,height:0,numcomponents:1},m=4;m<f;m+=2){if(m+=h,e.indexOf(d.charCodeAt(m+1))!==-1){A=256*d.charCodeAt(m+5)+d.charCodeAt(m+6),p={width:256*d.charCodeAt(m+7)+d.charCodeAt(m+8),height:A,numcomponents:d.charCodeAt(m+9)};break}h=256*d.charCodeAt(m+2)+d.charCodeAt(m+3)}return p})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:r,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:i,alias:n}}return u}})(ji.API);var bw,L3,Gse,Yse,Vse,KMe=(function(){var t,e,r;function i(s){var a,o,l,c,u,d,A,h,f,p,m,y,g,b;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},d=null;;){switch(a=this.readUInt32(),f=(function(){var E,w;for(w=[],E=0;E<4;++E)w.push(String.fromCharCode(this.data[this.pos++]));return w}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(a);break;case"fcTL":d&&this.animation.frames.push(d),this.pos+=4,d={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),c=this.readUInt16()||100,d.delay=1e3*u/c,d.disposeOp=this.data[this.pos++],d.blendOp=this.data[this.pos++],d.data=[];break;case"IDAT":case"fdAT":for(f==="fdAT"&&(this.pos+=4,a-=4),s=(d!=null?d.data:void 0)||this.imgData,y=0;0<=a?y<a:y>a;0<=a?++y:--y)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(a),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((p=l-this.transparency.indexed.length)>0)for(g=0;0<=p?g<p:g>p;0<=p?++g:--g)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case"tEXt":A=(m=this.read(a)).indexOf(0),h=String.fromCharCode.apply(String,m.slice(0,A)),this.text[h]=String.fromCharCode.apply(String,m.slice(A+1));break;case"IEND":return d&&this.animation.frames.push(d),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(b=this.colorType)===4||b===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=a}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}i.prototype.read=function(s){var a,o;for(o=[],a=0;0<=s?a<s:a>s;0<=s?++a:--a)o.push(this.data[this.pos++]);return o},i.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.decodePixels=function(s){var a=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*a),l=0,c=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function u(d,A,h,f){var p,m,y,g,b,E,w,x,I,C,G,U,_,H,Q,j,$,B,M,v,N,R=Math.ceil((c.width-d)/h),q=Math.ceil((c.height-A)/f),P=c.width==R&&c.height==q;for(H=a*R,U=P?o:new Uint8Array(H*q),E=s.length,_=0,m=0;_<q&&l<E;){switch(s[l++]){case 0:for(g=$=0;$<H;g=$+=1)U[m++]=s[l++];break;case 1:for(g=B=0;B<H;g=B+=1)p=s[l++],b=g<a?0:U[m-a],U[m++]=(p+b)%256;break;case 2:for(g=M=0;M<H;g=M+=1)p=s[l++],y=(g-g%a)/a,Q=_&&U[(_-1)*H+y*a+g%a],U[m++]=(Q+p)%256;break;case 3:for(g=v=0;v<H;g=v+=1)p=s[l++],y=(g-g%a)/a,b=g<a?0:U[m-a],Q=_&&U[(_-1)*H+y*a+g%a],U[m++]=(p+Math.floor((b+Q)/2))%256;break;case 4:for(g=N=0;N<H;g=N+=1)p=s[l++],y=(g-g%a)/a,b=g<a?0:U[m-a],_===0?Q=j=0:(Q=U[(_-1)*H+y*a+g%a],j=y&&U[(_-1)*H+(y-1)*a+g%a]),w=b+Q-j,x=Math.abs(w-b),C=Math.abs(w-Q),G=Math.abs(w-j),I=x<=C&&x<=G?b:C<=G?Q:j,U[m++]=(p+I)%256;break;default:throw new Error("Invalid filter algorithm: "+s[l-1])}if(!P){var z=((A+_*f)*c.width+d)*a,W=_*H;for(g=0;g<R;g+=1){for(var oe=0;oe<a;oe+=1)o[z++]=U[W++];z+=(h-1)*a}}_++}}return s=ZJ(s),c.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),o},i.prototype.decodePalette=function(){var s,a,o,l,c,u,d,A,h;for(o=this.palette,u=this.transparency.indexed||[],c=new Uint8Array((u.length||0)+o.length),l=0,s=0,a=d=0,A=o.length;d<A;a=d+=3)c[l++]=o[a],c[l++]=o[a+1],c[l++]=o[a+2],c[l++]=(h=u[s++])!=null?h:255;return c},i.prototype.copyToImageData=function(s,a){var o,l,c,u,d,A,h,f,p,m,y;if(l=this.colors,p=null,o=this.hasAlphaChannel,this.palette.length&&(p=(y=this._decodedPalette)!=null?y:this._decodedPalette=this.decodePalette(),l=4,o=!0),f=(c=s.data||s).length,d=p||a,u=A=0,l===1)for(;u<f;)h=p?4*a[u/4]:A,m=d[h++],c[u++]=m,c[u++]=m,c[u++]=m,c[u++]=o?d[h++]:255,A=h;else for(;u<f;)h=p?4*a[u/4]:A,c[u++]=d[h++],c[u++]=d[h++],c[u++]=d[h++],c[u++]=o?d[h++]:255,A=h},i.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var n=function(){if(Object.prototype.toString.call(Ki)==="[object Window]"){try{e=Ki.document.createElement("canvas"),r=e.getContext("2d")}catch{return!1}return!0}return!1};return n(),t=function(s){var a;if(n()===!0)return r.width=s.width,r.height=s.height,r.clearRect(0,0,s.width,s.height),r.putImageData(s,0,0),(a=new Image).src=e.toDataURL(),a;throw new Error("This method requires a Browser with Canvas-capability.")},i.prototype.decodeFrames=function(s){var a,o,l,c,u,d,A,h;if(this.animation){for(h=[],o=u=0,d=(A=this.animation.frames).length;u<d;o=++u)a=A[o],l=s.createImageData(a.width,a.height),c=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(l,c),a.imageData=l,h.push(a.image=t(l));return h}},i.prototype.renderFrame=function(s,a){var o,l,c;return o=(l=this.animation.frames)[a],c=l[a-1],a===0&&s.clearRect(0,0,this.width,this.height),(c!=null?c.disposeOp:void 0)===1?s.clearRect(c.xOffset,c.yOffset,c.width,c.height):(c!=null?c.disposeOp:void 0)===2&&s.putImageData(c.imageData,c.xOffset,c.yOffset),o.blendOp===0&&s.clearRect(o.xOffset,o.yOffset,o.width,o.height),s.drawImage(o.image,o.xOffset,o.yOffset)},i.prototype.animate=function(s){var a,o,l,c,u,d,A=this;return o=0,d=this.animation,c=d.numFrames,l=d.frames,u=d.numPlays,(a=function(){var h,f;if(h=o++%c,f=l[h],A.renderFrame(s,h),c>1&&o/c<u)return A.animation._timeout=setTimeout(a,f.delay)})()},i.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},i.prototype.render=function(s){var a,o;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,a=s.getContext("2d"),this.animation?(this.decodeFrames(a),this.animate(a)):(o=a.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),a.putImageData(o,0,0))},i})();function JMe(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,i=t[e++]|t[e++]<<8,n=t[e++],s=n>>7,a=1<<(7&n)+1;t[e++],t[e++];var o=null,l=null;s&&(o=e,l=a,e+=3*a);var c=!0,u=[],d=0,A=null,h=0,f=null;for(this.width=r,this.height=i;c&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,f=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((_=t[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var p=t[e++];d=t[e++]|t[e++]<<8,A=t[e++],(1&p)==0&&(A=null),h=p>>2&7,e++;break;case 254:for(;;){if(!((_=t[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var m=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,g=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,E=t[e++],w=E>>6&1,x=1<<(7&E)+1,I=o,C=l,G=!1;E>>7&&(G=!0,I=e,C=x,e+=3*x);var U=e;for(e++;;){var _;if(!((_=t[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}u.push({x:m,y,width:g,height:b,has_local_palette:G,palette_offset:I,palette_size:C,data_offset:U,data_length:e-U,transparent_index:A,interlaced:!!w,delay:d,disposal:h});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return f},this.frameInfo=function(H){if(H<0||H>=u.length)throw new Error("Frame index out of range.");return u[H]},this.decodeAndBlitFrameBGRA=function(H,Q){var j=this.frameInfo(H),$=j.width*j.height,B=new Uint8Array($);jse(t,j.data_offset,B,$);var M=j.palette_offset,v=j.transparent_index;v===null&&(v=256);var N=j.width,R=r-N,q=N,P=4*(j.y*r+j.x),z=4*((j.y+j.height)*r+j.x),W=P,oe=4*R;j.interlaced===!0&&(oe+=4*r*7);for(var Ae=8,me=0,ve=B.length;me<ve;++me){var Le=B[me];if(q===0&&(q=N,(W+=oe)>=z&&(oe=4*R+4*r*(Ae-1),W=P+(N+R)*(Ae<<1),Ae>>=1)),Le===v)W+=4;else{var He=t[M+3*Le],rt=t[M+3*Le+1],qe=t[M+3*Le+2];Q[W++]=qe,Q[W++]=rt,Q[W++]=He,Q[W++]=255}--q}},this.decodeAndBlitFrameRGBA=function(H,Q){var j=this.frameInfo(H),$=j.width*j.height,B=new Uint8Array($);jse(t,j.data_offset,B,$);var M=j.palette_offset,v=j.transparent_index;v===null&&(v=256);var N=j.width,R=r-N,q=N,P=4*(j.y*r+j.x),z=4*((j.y+j.height)*r+j.x),W=P,oe=4*R;j.interlaced===!0&&(oe+=4*r*7);for(var Ae=8,me=0,ve=B.length;me<ve;++me){var Le=B[me];if(q===0&&(q=N,(W+=oe)>=z&&(oe=4*R+4*r*(Ae-1),W=P+(N+R)*(Ae<<1),Ae>>=1)),Le===v)W+=4;else{var He=t[M+3*Le],rt=t[M+3*Le+1],qe=t[M+3*Le+2];Q[W++]=He,Q[W++]=rt,Q[W++]=qe,Q[W++]=255}--q}}}function jse(t,e,r,i){for(var n=t[e++],s=1<<n,a=s+1,o=a+1,l=n+1,c=(1<<l)-1,u=0,d=0,A=0,h=t[e++],f=new Int32Array(4096),p=null;;){for(;u<16&&h!==0;)d|=t[e++]<<u,u+=8,h===1?h=t[e++]:--h;if(u<l)break;var m=d&c;if(d>>=l,u-=l,m!==s){if(m===a)break;for(var y=m<o?m:p,g=0,b=y;b>s;)b=f[b]>>8,++g;var E=b;if(A+g+(y!==m?1:0)>i)return void Qa.log("Warning, gif stream longer than expected.");r[A++]=E;var w=A+=g;for(y!==m&&(r[A++]=E),b=y;g--;)b=f[b],r[--w]=255&b,b>>=8;p!==null&&o<4096&&(f[o++]=p<<8|E,o>=c+1&&l<12&&(++l,c=c<<1|1)),p=m}else o=a+1,c=(1<<(l=n+1))-1,p=null}return A!==i&&Qa.log("Warning, gif stream shorter than expected."),r}function oU(t){var e,r,i,n,s,a=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(65535),A=new Array(65535),h=new Array(64),f=new Array(64),p=[],m=0,y=7,g=new Array(64),b=new Array(64),E=new Array(64),w=new Array(256),x=new Array(2048),I=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],G=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],_=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],H=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Q=[0,1,2,3,4,5,6,7,8,9,10,11],j=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],$=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function B(P,z){for(var W=0,oe=0,Ae=new Array,me=1;me<=16;me++){for(var ve=1;ve<=P[me];ve++)Ae[z[oe]]=[],Ae[z[oe]][0]=W,Ae[z[oe]][1]=me,oe++,W++;W*=2}return Ae}function M(P){for(var z=P[0],W=P[1]-1;W>=0;)z&1<<W&&(m|=1<<y),W--,--y<0&&(m==255?(v(255),v(0)):v(m),y=7,m=0)}function v(P){p.push(P)}function N(P){v(P>>8&255),v(255&P)}function R(P,z,W,oe,Ae){for(var me,ve=Ae[0],Le=Ae[240],He=(function(Qt,Yt){var Ft,kt,sr,Pt,_r,Lt,ct,Zt,Jt,O,K=0;for(Jt=0;Jt<8;++Jt){Ft=Qt[K],kt=Qt[K+1],sr=Qt[K+2],Pt=Qt[K+3],_r=Qt[K+4],Lt=Qt[K+5],ct=Qt[K+6];var se=Ft+(Zt=Qt[K+7]),ae=Ft-Zt,ue=kt+ct,Ie=kt-ct,Ce=sr+Lt,st=sr-Lt,it=Pt+_r,Kt=Pt-_r,ar=se+it,lr=se-it,yr=ue+Ce,xi=ue-Ce;Qt[K]=ar+yr,Qt[K+4]=ar-yr;var Tr=.707106781*(xi+lr);Qt[K+2]=lr+Tr,Qt[K+6]=lr-Tr;var ii=.382683433*((ar=Kt+st)-(xi=Ie+ae)),nn=.5411961*ar+ii,sn=1.306562965*xi+ii,Dn=.707106781*(yr=st+Ie),Za=ae+Dn,ai=ae-Dn;Qt[K+5]=ai+nn,Qt[K+3]=ai-nn,Qt[K+1]=Za+sn,Qt[K+7]=Za-sn,K+=8}for(K=0,Jt=0;Jt<8;++Jt){Ft=Qt[K],kt=Qt[K+8],sr=Qt[K+16],Pt=Qt[K+24],_r=Qt[K+32],Lt=Qt[K+40],ct=Qt[K+48];var xa=Ft+(Zt=Qt[K+56]),Lr=Ft-Zt,mn=kt+ct,bs=kt-ct,Zi=sr+Lt,Do=sr-Lt,Su=Pt+_r,gc=Pt-_r,jc=xa+Su,ec=xa-Su,Qc=mn+Zi,Uo=mn-Zi;Qt[K]=jc+Qc,Qt[K+32]=jc-Qc;var ul=.707106781*(Uo+ec);Qt[K+16]=ec+ul,Qt[K+48]=ec-ul;var hl=.382683433*((jc=gc+Do)-(Uo=bs+Lr)),Ms=.5411961*jc+hl,Tu=1.306562965*Uo+hl,ha=.707106781*(Qc=Do+bs),Sd=Lr+ha,is=Lr-ha;Qt[K+40]=is+Ms,Qt[K+24]=is-Ms,Qt[K+8]=Sd+Tu,Qt[K+56]=Sd-Tu,K++}for(Jt=0;Jt<64;++Jt)O=Qt[Jt]*Yt[Jt],h[Jt]=O>0?O+.5|0:O-.5|0;return h})(P,z),rt=0;rt<64;++rt)f[I[rt]]=He[rt];var qe=f[0]-W;W=f[0],qe==0?M(oe[0]):(M(oe[A[me=32767+qe]]),M(d[me]));for(var xt=63;xt>0&&f[xt]==0;)xt--;if(xt==0)return M(ve),W;for(var Gt,ut=1;ut<=xt;){for(var Pe=ut;f[ut]==0&&ut<=xt;)++ut;var ft=ut-Pe;if(ft>=16){Gt=ft>>4;for(var ht=1;ht<=Gt;++ht)M(Le);ft&=15}me=32767+f[ut],M(Ae[(ft<<4)+A[me]]),M(d[me]),ut++}return xt!=63&&M(ve),W}function q(P){P=Math.min(Math.max(P,1),100),s!=P&&((function(z){for(var W=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],oe=0;oe<64;oe++){var Ae=a((W[oe]*z+50)/100);Ae=Math.min(Math.max(Ae,1),255),o[I[oe]]=Ae}for(var me=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ve=0;ve<64;ve++){var Le=a((me[ve]*z+50)/100);Le=Math.min(Math.max(Le,1),255),l[I[ve]]=Le}for(var He=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],rt=0,qe=0;qe<8;qe++)for(var xt=0;xt<8;xt++)c[rt]=1/(o[I[rt]]*He[qe]*He[xt]*8),u[rt]=1/(l[I[rt]]*He[qe]*He[xt]*8),rt++})(P<50?Math.floor(5e3/P):Math.floor(200-2*P)),s=P)}this.encode=function(P,z){z&&q(z),p=new Array,m=0,y=7,N(65496),N(65504),N(16),v(74),v(70),v(73),v(70),v(0),v(1),v(1),v(0),N(1),N(1),v(0),v(0),(function(){N(65499),N(132),v(0);for(var kt=0;kt<64;kt++)v(o[kt]);v(1);for(var sr=0;sr<64;sr++)v(l[sr])})(),(function(kt,sr){N(65472),N(17),v(8),N(sr),N(kt),v(3),v(1),v(17),v(0),v(2),v(17),v(1),v(3),v(17),v(1)})(P.width,P.height),(function(){N(65476),N(418),v(0);for(var kt=0;kt<16;kt++)v(C[kt+1]);for(var sr=0;sr<=11;sr++)v(G[sr]);v(16);for(var Pt=0;Pt<16;Pt++)v(U[Pt+1]);for(var _r=0;_r<=161;_r++)v(_[_r]);v(1);for(var Lt=0;Lt<16;Lt++)v(H[Lt+1]);for(var ct=0;ct<=11;ct++)v(Q[ct]);v(17);for(var Zt=0;Zt<16;Zt++)v(j[Zt+1]);for(var Jt=0;Jt<=161;Jt++)v($[Jt])})(),N(65498),N(12),v(3),v(1),v(0),v(2),v(17),v(3),v(17),v(0),v(63),v(0);var W=0,oe=0,Ae=0;m=0,y=7,this.encode.displayName="_encode_";for(var me,ve,Le,He,rt,qe,xt,Gt,ut,Pe=P.data,ft=P.width,ht=P.height,Qt=4*ft,Yt=0;Yt<ht;){for(me=0;me<Qt;){for(rt=Qt*Yt+me,xt=-1,Gt=0,ut=0;ut<64;ut++)qe=rt+(Gt=ut>>3)*Qt+(xt=4*(7&ut)),Yt+Gt>=ht&&(qe-=Qt*(Yt+1+Gt-ht)),me+xt>=Qt&&(qe-=me+xt-Qt+4),ve=Pe[qe++],Le=Pe[qe++],He=Pe[qe++],g[ut]=(x[ve]+x[Le+256>>0]+x[He+512>>0]>>16)-128,b[ut]=(x[ve+768>>0]+x[Le+1024>>0]+x[He+1280>>0]>>16)-128,E[ut]=(x[ve+1280>>0]+x[Le+1536>>0]+x[He+1792>>0]>>16)-128;W=R(g,c,W,e,i),oe=R(b,u,oe,r,n),Ae=R(E,u,Ae,r,n),me+=32}Yt+=8}if(y>=0){var Ft=[];Ft[1]=y+1,Ft[0]=(1<<y+1)-1,M(Ft)}return N(65497),new Uint8Array(p)},t=t||50,(function(){for(var P=String.fromCharCode,z=0;z<256;z++)w[z]=P(z)})(),e=B(C,G),r=B(H,Q),i=B(U,_),n=B(j,$),(function(){for(var P=1,z=2,W=1;W<=15;W++){for(var oe=P;oe<z;oe++)A[32767+oe]=W,d[32767+oe]=[],d[32767+oe][1]=W,d[32767+oe][0]=oe;for(var Ae=-(z-1);Ae<=-P;Ae++)A[32767+Ae]=W,d[32767+Ae]=[],d[32767+Ae][1]=W,d[32767+Ae][0]=z-1+Ae;P<<=1,z<<=1}})(),(function(){for(var P=0;P<256;P++)x[P]=19595*P,x[P+256>>0]=38470*P,x[P+512>>0]=7471*P+32768,x[P+768>>0]=-11059*P,x[P+1024>>0]=-21709*P,x[P+1280>>0]=32768*P+8421375,x[P+1536>>0]=-27439*P,x[P+1792>>0]=-5329*P})(),q(t)}function xp(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Qse(t){function e(C){if(!C)throw Error("assert :P")}function r(C,G,U){for(var _=0;4>_;_++)if(C[G+_]!=U.charCodeAt(_))return!0;return!1}function i(C,G,U,_,H){for(var Q=0;Q<H;Q++)C[G+Q]=U[_+Q]}function n(C,G,U,_){for(var H=0;H<_;H++)C[G+H]=U}function s(C){return new Int32Array(C)}function a(C,G){for(var U=[],_=0;_<C;_++)U.push(new G);return U}function o(C,G){var U=[];return(function _(H,Q,j){for(var $=j[Q],B=0;B<$&&(H.push(j.length>Q+1?[]:new G),!(j.length<Q+1));B++)_(H[B],Q+1,j)})(U,0,C),U}var l=function(){var C=this;function G(T,Y){for(var Z=1<<Y-1>>>0;T&Z;)Z>>>=1;return Z?(T&Z-1)+Z:T}function U(T,Y,Z,le,pe){e(!(le%Z));do T[Y+(le-=Z)]=pe;while(0<le)}function _(T,Y,Z,le,pe){if(e(2328>=pe),512>=pe)var be=s(512);else if((be=s(pe))==null)return 0;return(function(we,Se,Te,ke,Ze,At){var It,dt,Wt=Se,Mt=1<<Te,et=s(16),ot=s(16);for(e(Ze!=0),e(ke!=null),e(we!=null),e(0<Te),dt=0;dt<Ze;++dt){if(15<ke[dt])return 0;++et[ke[dt]]}if(et[0]==Ze)return 0;for(ot[1]=0,It=1;15>It;++It){if(et[It]>1<<It)return 0;ot[It+1]=ot[It]+et[It]}for(dt=0;dt<Ze;++dt)It=ke[dt],0<ke[dt]&&(At[ot[It]++]=dt);if(ot[15]==1)return(ke=new H).g=0,ke.value=At[0],U(we,Wt,1,Mt,ke),Mt;var Xt,rr=-1,qt=Mt-1,Gr=0,Or=1,Mi=1,Rr=1<<Te;for(dt=0,It=1,Ze=2;It<=Te;++It,Ze<<=1){if(Or+=Mi<<=1,0>(Mi-=et[It]))return 0;for(;0<et[It];--et[It])(ke=new H).g=It,ke.value=At[dt++],U(we,Wt+Gr,Ze,Rr,ke),Gr=G(Gr,It)}for(It=Te+1,Ze=2;15>=It;++It,Ze<<=1){if(Or+=Mi<<=1,0>(Mi-=et[It]))return 0;for(;0<et[It];--et[It]){if(ke=new H,(Gr&qt)!=rr){for(Wt+=Rr,Xt=1<<(rr=It)-Te;15>rr&&!(0>=(Xt-=et[rr]));)++rr,Xt<<=1;Mt+=Rr=1<<(Xt=rr-Te),we[Se+(rr=Gr&qt)].g=Xt+Te,we[Se+rr].value=Wt-Se-rr}ke.g=It-Te,ke.value=At[dt++],U(we,Wt+(Gr>>Te),Ze,Rr,ke),Gr=G(Gr,It)}}return Or!=2*ot[15]-1?0:Mt})(T,Y,Z,le,pe,be)}function H(){this.value=this.g=0}function Q(){this.value=this.g=0}function j(){this.G=a(5,H),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(to,Q)}function $(T,Y,Z,le){e(T!=null),e(Y!=null),e(2147483648>le),T.Ca=254,T.I=0,T.b=-8,T.Ka=0,T.oa=Y,T.pa=Z,T.Jd=Y,T.Yc=Z+le,T.Zc=4<=le?Z+le-4+1:Z,me(T)}function B(T,Y){for(var Z=0;0<Y--;)Z|=Le(T,128)<<Y;return Z}function M(T,Y){var Z=B(T,Y);return ve(T)?-Z:Z}function v(T,Y,Z,le){var pe,be=0;for(e(T!=null),e(Y!=null),e(4294967288>le),T.Sb=le,T.Ra=0,T.u=0,T.h=0,4<le&&(le=4),pe=0;pe<le;++pe)be+=Y[Z+pe]<<8*pe;T.Ra=be,T.bb=le,T.oa=Y,T.pa=Z}function N(T){for(;8<=T.u&&T.bb<T.Sb;)T.Ra>>>=8,T.Ra+=T.oa[T.pa+T.bb]<<pA-8>>>0,++T.bb,T.u-=8;W(T)&&(T.h=1,T.u=0)}function R(T,Y){if(e(0<=Y),!T.h&&Y<=xc){var Z=z(T)&_d[Y];return T.u+=Y,N(T),Z}return T.h=1,T.u=0}function q(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function P(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function z(T){return T.Ra>>>(T.u&pA-1)>>>0}function W(T){return e(T.bb<=T.Sb),T.h||T.bb==T.Sb&&T.u>pA}function oe(T,Y){T.u=Y,T.h=W(T)}function Ae(T){T.u>=Ru&&(e(T.u>=Ru),N(T))}function me(T){e(T!=null&&T.oa!=null),T.pa<T.Zc?(T.I=(T.oa[T.pa++]|T.I<<8)>>>0,T.b+=8):(e(T!=null&&T.oa!=null),T.pa<T.Yc?(T.b+=8,T.I=T.oa[T.pa++]|T.I<<8):T.Ka?T.b=0:(T.I<<=8,T.b+=8,T.Ka=1))}function ve(T){return B(T,1)}function Le(T,Y){var Z=T.Ca;0>T.b&&me(T);var le=T.b,pe=Z*Y>>>8,be=(T.I>>>le>pe)+0;for(be?(Z-=pe,T.I-=pe+1<<le>>>0):Z=pe+1,le=Z,pe=0;256<=le;)pe+=8,le>>=8;return le=7^pe+Yo[le],T.b-=le,T.Ca=(Z<<le)-1,be}function He(T,Y,Z){T[Y+0]=Z>>24&255,T[Y+1]=Z>>16&255,T[Y+2]=Z>>8&255,T[Y+3]=Z>>0&255}function rt(T,Y){return T[Y+0]<<0|T[Y+1]<<8}function qe(T,Y){return rt(T,Y)|T[Y+2]<<16}function xt(T,Y){return rt(T,Y)|rt(T,Y+2)<<16}function Gt(T,Y){var Z=1<<Y;return e(T!=null),e(0<Y),T.X=s(Z),T.X==null?0:(T.Mb=32-Y,T.Xa=Y,1)}function ut(T,Y){e(T!=null),e(Y!=null),e(T.Xa==Y.Xa),i(Y.X,0,T.X,0,1<<Y.Xa)}function Pe(){this.X=[],this.Xa=this.Mb=0}function ft(T,Y,Z,le){e(Z!=null),e(le!=null);var pe=Z[0],be=le[0];return pe==0&&(pe=(T*be+Y/2)/Y),be==0&&(be=(Y*pe+T/2)/T),0>=pe||0>=be?0:(Z[0]=pe,le[0]=be,1)}function ht(T,Y){return T+(1<<Y)-1>>>Y}function Qt(T,Y){return((4278255360&T)+(4278255360&Y)>>>0&4278255360)+((16711935&T)+(16711935&Y)>>>0&16711935)>>>0}function Yt(T,Y){C[Y]=function(Z,le,pe,be,we,Se,Te){var ke;for(ke=0;ke<we;++ke){var Ze=C[T](Se[Te+ke-1],pe,be+ke);Se[Te+ke]=Qt(Z[le+ke],Ze)}}}function Ft(){this.ud=this.hd=this.jd=0}function kt(T,Y){return((4278124286&(T^Y))>>>1)+(T&Y)>>>0}function sr(T){return 0<=T&&256>T?T:0>T?0:255<T?255:void 0}function Pt(T,Y){return sr(T+(T-Y+.5>>1))}function _r(T,Y,Z){return Math.abs(Y-Z)-Math.abs(T-Z)}function Lt(T,Y,Z,le,pe,be,we){for(le=be[we-1],Z=0;Z<pe;++Z)be[we+Z]=le=Qt(T[Y+Z],le)}function ct(T,Y,Z,le,pe){var be;for(be=0;be<Z;++be){var we=T[Y+be],Se=we>>8&255,Te=16711935&(Te=(Te=16711935&we)+((Se<<16)+Se));le[pe+be]=(4278255360&we)+Te>>>0}}function Zt(T,Y){Y.jd=T>>0&255,Y.hd=T>>8&255,Y.ud=T>>16&255}function Jt(T,Y,Z,le,pe,be){var we;for(we=0;we<le;++we){var Se=Y[Z+we],Te=Se>>>8,ke=Se,Ze=255&(Ze=(Ze=Se>>>16)+((T.jd<<24>>24)*(Te<<24>>24)>>>5));ke=255&(ke=(ke=ke+((T.hd<<24>>24)*(Te<<24>>24)>>>5))+((T.ud<<24>>24)*(Ze<<24>>24)>>>5)),pe[be+we]=(4278255360&Se)+(Ze<<16)+ke}}function O(T,Y,Z,le,pe){C[Y]=function(be,we,Se,Te,ke,Ze,At,It,dt){for(Te=At;Te<It;++Te)for(At=0;At<dt;++At)ke[Ze++]=pe(Se[le(be[we++])])},C[T]=function(be,we,Se,Te,ke,Ze,At){var It=8>>be.b,dt=be.Ea,Wt=be.K[0],Mt=be.w;if(8>It)for(be=(1<<be.b)-1,Mt=(1<<It)-1;we<Se;++we){var et,ot=0;for(et=0;et<dt;++et)et&be||(ot=le(Te[ke++])),Ze[At++]=pe(Wt[ot&Mt]),ot>>=It}else C["VP8LMapColor"+Z](Te,ke,Wt,Mt,Ze,At,we,Se,dt)}}function K(T,Y,Z,le,pe){for(Z=Y+Z;Y<Z;){var be=T[Y++];le[pe++]=be>>16&255,le[pe++]=be>>8&255,le[pe++]=be>>0&255}}function se(T,Y,Z,le,pe){for(Z=Y+Z;Y<Z;){var be=T[Y++];le[pe++]=be>>16&255,le[pe++]=be>>8&255,le[pe++]=be>>0&255,le[pe++]=be>>24&255}}function ae(T,Y,Z,le,pe){for(Z=Y+Z;Y<Z;){var be=(we=T[Y++])>>16&240|we>>12&15,we=we>>0&240|we>>28&15;le[pe++]=be,le[pe++]=we}}function ue(T,Y,Z,le,pe){for(Z=Y+Z;Y<Z;){var be=(we=T[Y++])>>16&248|we>>13&7,we=we>>5&224|we>>3&31;le[pe++]=be,le[pe++]=we}}function Ie(T,Y,Z,le,pe){for(Z=Y+Z;Y<Z;){var be=T[Y++];le[pe++]=be>>0&255,le[pe++]=be>>8&255,le[pe++]=be>>16&255}}function Ce(T,Y,Z,le,pe,be){if(be==0)for(Z=Y+Z;Y<Z;)He(le,((be=T[Y++])[0]>>24|be[1]>>8&65280|be[2]<<8&16711680|be[3]<<24)>>>0),pe+=32;else i(le,pe,T,Y,Z)}function st(T,Y){C[Y][0]=C[T+"0"],C[Y][1]=C[T+"1"],C[Y][2]=C[T+"2"],C[Y][3]=C[T+"3"],C[Y][4]=C[T+"4"],C[Y][5]=C[T+"5"],C[Y][6]=C[T+"6"],C[Y][7]=C[T+"7"],C[Y][8]=C[T+"8"],C[Y][9]=C[T+"9"],C[Y][10]=C[T+"10"],C[Y][11]=C[T+"11"],C[Y][12]=C[T+"12"],C[Y][13]=C[T+"13"],C[Y][14]=C[T+"0"],C[Y][15]=C[T+"0"]}function it(T){return T==_w||T==i0||T==Wb||T==Pw}function Kt(){this.eb=[],this.size=this.A=this.fb=0}function ar(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function lr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Kt,this.f.kb=new ar,this.sd=null}function yr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function xi(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Tr(T){return alert("todo:WebPSamplerProcessPlane"),T.T}function ii(T,Y){var Z=T.T,le=Y.ba.f.RGBA,pe=le.eb,be=le.fb+T.ka*le.A,we=ku[Y.ba.S],Se=T.y,Te=T.O,ke=T.f,Ze=T.N,At=T.ea,It=T.W,dt=Y.cc,Wt=Y.dc,Mt=Y.Mc,et=Y.Nc,ot=T.ka,Xt=T.ka+T.T,rr=T.U,qt=rr+1>>1;for(ot==0?we(Se,Te,null,null,ke,Ze,At,It,ke,Ze,At,It,pe,be,null,null,rr):(we(Y.ec,Y.fc,Se,Te,dt,Wt,Mt,et,ke,Ze,At,It,pe,be-le.A,pe,be,rr),++Z);ot+2<Xt;ot+=2)dt=ke,Wt=Ze,Mt=At,et=It,Ze+=T.Rc,It+=T.Rc,be+=2*le.A,we(Se,(Te+=2*T.fa)-T.fa,Se,Te,dt,Wt,Mt,et,ke,Ze,At,It,pe,be-le.A,pe,be,rr);return Te+=T.fa,T.j+Xt<T.o?(i(Y.ec,Y.fc,Se,Te,rr),i(Y.cc,Y.dc,ke,Ze,qt),i(Y.Mc,Y.Nc,At,It,qt),Z--):1&Xt||we(Se,Te,null,null,ke,Ze,At,It,ke,Ze,At,It,pe,be+le.A,null,null,rr),Z}function nn(T,Y,Z){var le=T.F,pe=[T.J];if(le!=null){var be=T.U,we=Y.ba.S,Se=we==qb||we==Wb;Y=Y.ba.f.RGBA;var Te=[0],ke=T.ka;Te[0]=T.T,T.Kb&&(ke==0?--Te[0]:(--ke,pe[0]-=T.width),T.j+T.ka+T.T==T.o&&(Te[0]=T.o-T.j-ke));var Ze=Y.eb;ke=Y.fb+ke*Y.A,T=_m(le,pe[0],T.width,be,Te,Ze,ke+(Se?0:3),Y.A),e(Z==Te),T&&it(we)&&bf(Ze,ke,Se,be,Te,Y.A)}return 0}function sn(T){var Y=T.ma,Z=Y.ba.S,le=11>Z,pe=Z==Xb||Z==Pm||Z==qb||Z==Dw||Z==12||it(Z);if(Y.memory=null,Y.Ib=null,Y.Jb=null,Y.Nd=null,!Nu(Y.Oa,T,pe?11:12))return 0;if(pe&&it(Z)&&or(),T.da)alert("todo:use_scaling");else{if(le){if(Y.Ib=Tr,T.Kb){if(Z=T.U+1>>1,Y.memory=s(T.U+2*Z),Y.memory==null)return 0;Y.ec=Y.memory,Y.fc=0,Y.cc=Y.ec,Y.dc=Y.fc+T.U,Y.Mc=Y.cc,Y.Nc=Y.dc+Z,Y.Ib=ii,or()}}else alert("todo:EmitYUV");pe&&(Y.Jb=nn,le&&Je())}if(le&&!vI){for(T=0;256>T;++T)sN[T]=89858*(T-128)+$b>>Lm,lN[T]=-22014*(T-128)+$b,oN[T]=-45773*(T-128),aN[T]=113618*(T-128)+$b>>Lm;for(T=Qy;T<Nw;++T)Y=76283*(T-16)+$b>>Lm,cN[T-Qy]=qc(Y,255),uN[T-Qy]=qc(Y+8>>4,15);vI=1}return 1}function Dn(T){var Y=T.ma,Z=T.U,le=T.T;return e(!(1&T.ka)),0>=Z||0>=le?0:(Z=Y.Ib(T,Y),Y.Jb!=null&&Y.Jb(T,Y,Z),Y.Dc+=Z,1)}function Za(T){T.ma.memory=null}function ai(T,Y,Z,le){return R(T,8)!=47?0:(Y[0]=R(T,14)+1,Z[0]=R(T,14)+1,le[0]=R(T,1),R(T,3)!=0?0:!T.h)}function xa(T,Y){if(4>T)return T+1;var Z=T-2>>1;return(2+(1&T)<<Z)+R(Y,Z)+1}function Lr(T,Y){return 120<Y?Y-120:1<=(Z=((Z=q3[Y-1])>>4)*T+(8-(15&Z)))?Z:1;var Z}function mn(T,Y,Z){var le=z(Z),pe=T[Y+=255&le].g-8;return 0<pe&&(oe(Z,Z.u+8),le=z(Z),Y+=T[Y].value,Y+=le&(1<<pe)-1),oe(Z,Z.u+T[Y].g),T[Y].value}function bs(T,Y,Z){return Z.g+=T.g,Z.value+=T.value<<Y>>>0,e(8>=Z.g),T.g}function Zi(T,Y,Z){var le=T.xc;return e((Y=le==0?0:T.vc[T.md*(Z>>le)+(Y>>le)])<T.Wb),T.Ya[Y]}function Do(T,Y,Z,le){var pe=T.ab,be=T.c*Y,we=T.C;Y=we+Y;var Se=Z,Te=le;for(le=T.Ta,Z=T.Ua;0<pe--;){var ke=T.gc[pe],Ze=we,At=Y,It=Se,dt=Te,Wt=(Te=le,Se=Z,ke.Ea);switch(e(Ze<At),e(At<=ke.nc),ke.hc){case 2:mh(It,dt,(At-Ze)*Wt,Te,Se);break;case 0:var Mt=Ze,et=At,ot=Te,Xt=Se,rr=(Rr=ke).Ea;Mt==0&&(yf(It,dt,null,null,1,ot,Xt),Lt(It,dt+1,0,0,rr-1,ot,Xt+1),dt+=rr,Xt+=rr,++Mt);for(var qt=1<<Rr.b,Gr=qt-1,Or=ht(rr,Rr.b),Mi=Rr.K,Rr=Rr.w+(Mt>>Rr.b)*Or;Mt<et;){var dr=Mi,js=Rr,hs=1;for(Vo(It,dt,ot,Xt-rr,1,ot,Xt);hs<rr;){var Nn=(hs&~Gr)+qt;Nn>rr&&(Nn=rr),(0,gh[dr[js++]>>8&15])(It,dt+ +hs,ot,Xt+hs-rr,Nn-hs,ot,Xt+hs),hs=Nn}dt+=rr,Xt+=rr,++Mt&Gr||(Rr+=Or)}At!=ke.nc&&i(Te,Se-Wt,Te,Se+(At-Ze-1)*Wt,Wt);break;case 1:for(Wt=It,et=dt,rr=(It=ke.Ea)-(Xt=It&~(ot=(dt=1<<ke.b)-1)),Mt=ht(It,ke.b),qt=ke.K,ke=ke.w+(Ze>>ke.b)*Mt;Ze<At;){for(Gr=qt,Or=ke,Mi=new Ft,Rr=et+Xt,dr=et+It;et<Rr;)Zt(Gr[Or++],Mi),rc(Mi,Wt,et,dt,Te,Se),et+=dt,Se+=dt;et<dr&&(Zt(Gr[Or++],Mi),rc(Mi,Wt,et,rr,Te,Se),et+=rr,Se+=rr),++Ze&ot||(ke+=Mt)}break;case 3:if(It==Te&&dt==Se&&0<ke.b){for(et=Te,It=Wt=Se+(At-Ze)*Wt-(Xt=(At-Ze)*ht(ke.Ea,ke.b)),dt=Te,ot=Se,Mt=[],Xt=(rr=Xt)-1;0<=Xt;--Xt)Mt[Xt]=dt[ot+Xt];for(Xt=rr-1;0<=Xt;--Xt)et[It+Xt]=Mt[Xt];ro(ke,Ze,At,Te,Wt,Te,Se)}else ro(ke,Ze,At,It,dt,Te,Se)}Se=le,Te=Z}Te!=Z&&i(le,Z,Se,Te,be)}function Su(T,Y){var Z=T.V,le=T.Ba+T.c*T.C,pe=Y-T.C;if(e(Y<=T.l.o),e(16>=pe),0<pe){var be=T.l,we=T.Ta,Se=T.Ua,Te=be.width;if(Do(T,pe,Z,le),pe=Se=[Se],e((Z=T.C)<(le=Y)),e(be.v<be.va),le>be.o&&(le=be.o),Z<be.j){var ke=be.j-Z;Z=be.j,pe[0]+=ke*Te}if(Z>=le?Z=0:(pe[0]+=4*be.v,be.ka=Z-be.j,be.U=be.va-be.v,be.T=le-Z,Z=1),Z){if(Se=Se[0],11>(Z=T.ca).S){var Ze=Z.f.RGBA,At=(le=Z.S,pe=be.U,be=be.T,ke=Ze.eb,Ze.A),It=be;for(Ze=Ze.fb+T.Ma*Ze.A;0<It--;){var dt=we,Wt=Se,Mt=pe,et=ke,ot=Ze;switch(le){case xf:Me(dt,Wt,Mt,et,ot);break;case Xb:Ke(dt,Wt,Mt,et,ot);break;case _w:Ke(dt,Wt,Mt,et,ot),bf(et,ot,0,Mt,1,0);break;case AI:Ut(dt,Wt,Mt,et,ot);break;case Pm:Ce(dt,Wt,Mt,et,ot,1);break;case i0:Ce(dt,Wt,Mt,et,ot,1),bf(et,ot,0,Mt,1,0);break;case qb:Ce(dt,Wt,Mt,et,ot,0);break;case Wb:Ce(dt,Wt,Mt,et,ot,0),bf(et,ot,1,Mt,1,0);break;case Dw:mt(dt,Wt,Mt,et,ot);break;case Pw:mt(dt,Wt,Mt,et,ot),r0(et,ot,Mt,1,0);break;case fI:Tt(dt,Wt,Mt,et,ot);break;default:e(0)}Se+=Te,Ze+=At}T.Ma+=be}else alert("todo:EmitRescaledRowsYUVA");e(T.Ma<=Z.height)}}T.C=Y,e(T.C<=T.i)}function gc(T){var Y;if(0<T.ua)return 0;for(Y=0;Y<T.Wb;++Y){var Z=T.Ya[Y].G,le=T.Ya[Y].H;if(0<Z[1][le[1]+0].g||0<Z[2][le[2]+0].g||0<Z[3][le[3]+0].g)return 0}return 1}function jc(T,Y,Z,le,pe,be){if(T.Z!=0){var we=T.qd,Se=T.rd;for(e(Sp[T.Z]!=null);Y<Z;++Y)Sp[T.Z](we,Se,le,pe,le,pe,be),we=le,Se=pe,pe+=be;T.qd=we,T.rd=Se}}function ec(T,Y){var Z=T.l.ma,le=Z.Z==0||Z.Z==1?T.l.j:T.C;if(le=T.C<le?le:T.C,e(Y<=T.l.o),Y>le){var pe=T.l.width,be=Z.ca,we=Z.tb+pe*le,Se=T.V,Te=T.Ba+T.c*le,ke=T.gc;e(T.ab==1),e(ke[0].hc==3),Mu(ke[0],le,Y,Se,Te,be,we),jc(Z,le,Y,be,we,pe)}T.C=T.Ma=Y}function Qc(T,Y,Z,le,pe,be,we){var Se=T.$/le,Te=T.$%le,ke=T.m,Ze=T.s,At=Z+T.$,It=At;pe=Z+le*pe;var dt=Z+le*be,Wt=280+Ze.ua,Mt=T.Pb?Se:16777216,et=0<Ze.ua?Ze.Wa:null,ot=Ze.wc,Xt=At<dt?Zi(Ze,Te,Se):null;e(T.C<be),e(dt<=pe);var rr=!1;e:for(;;){for(;rr||At<dt;){var qt=0;if(Se>=Mt){var Gr=At-Z;e((Mt=T).Pb),Mt.wd=Mt.m,Mt.xd=Gr,0<Mt.s.ua&&ut(Mt.s.Wa,Mt.s.vb),Mt=Se+Kb}if(Te&ot||(Xt=Zi(Ze,Te,Se)),e(Xt!=null),Xt.Qb&&(Y[At]=Xt.qb,rr=!0),!rr)if(Ae(ke),Xt.jc){qt=ke,Gr=Y;var Or=At,Mi=Xt.pd[z(qt)&to-1];e(Xt.jc),256>Mi.g?(oe(qt,qt.u+Mi.g),Gr[Or]=Mi.value,qt=0):(oe(qt,qt.u+Mi.g-256),e(256<=Mi.value),qt=Mi.value),qt==0&&(rr=!0)}else qt=mn(Xt.G[0],Xt.H[0],ke);if(ke.h)break;if(rr||256>qt){if(!rr)if(Xt.nd)Y[At]=(Xt.qb|qt<<8)>>>0;else{if(Ae(ke),rr=mn(Xt.G[1],Xt.H[1],ke),Ae(ke),Gr=mn(Xt.G[2],Xt.H[2],ke),Or=mn(Xt.G[3],Xt.H[3],ke),ke.h)break;Y[At]=(Or<<24|rr<<16|qt<<8|Gr)>>>0}if(rr=!1,++At,++Te>=le&&(Te=0,++Se,we!=null&&Se<=be&&!(Se%16)&&we(T,Se),et!=null))for(;It<At;)qt=Y[It++],et.X[(506832829*qt&4294967295)>>>et.Mb]=qt}else if(280>qt){if(qt=xa(qt-256,ke),Gr=mn(Xt.G[4],Xt.H[4],ke),Ae(ke),Gr=Lr(le,Gr=xa(Gr,ke)),ke.h)break;if(At-Z<Gr||pe-At<qt)break e;for(Or=0;Or<qt;++Or)Y[At+Or]=Y[At+Or-Gr];for(At+=qt,Te+=qt;Te>=le;)Te-=le,++Se,we!=null&&Se<=be&&!(Se%16)&&we(T,Se);if(e(At<=pe),Te&ot&&(Xt=Zi(Ze,Te,Se)),et!=null)for(;It<At;)qt=Y[It++],et.X[(506832829*qt&4294967295)>>>et.Mb]=qt}else{if(!(qt<Wt))break e;for(rr=qt-280,e(et!=null);It<At;)qt=Y[It++],et.X[(506832829*qt&4294967295)>>>et.Mb]=qt;qt=At,e(!(rr>>>(Gr=et).Xa)),Y[qt]=Gr.X[rr],rr=!0}rr||e(ke.h==W(ke))}if(T.Pb&&ke.h&&At<pe)e(T.m.h),T.a=5,T.m=T.wd,T.$=T.xd,0<T.s.ua&&ut(T.s.vb,T.s.Wa);else{if(ke.h)break e;we!=null&&we(T,Se>be?be:Se),T.a=0,T.$=At-Z}return 1}return T.a=3,0}function Uo(T){e(T!=null),T.vc=null,T.yc=null,T.Ya=null;var Y=T.Wa;Y!=null&&(Y.X=null),T.vb=null,e(T!=null)}function ul(){var T=new hr;return T==null?null:(T.a=0,T.xb=gI,st("Predictor","VP8LPredictors"),st("Predictor","VP8LPredictors_C"),st("PredictorAdd","VP8LPredictorsAdd"),st("PredictorAdd","VP8LPredictorsAdd_C"),mh=ct,rc=Jt,Me=K,Ke=se,mt=ae,Tt=ue,Ut=Ie,C.VP8LMapColor32b=Oa,C.VP8LMapColor8b=t0,T)}function hl(T,Y,Z,le,pe){var be=1,we=[T],Se=[Y],Te=le.m,ke=le.s,Ze=null,At=0;e:for(;;){if(Z)for(;be&&R(Te,1);){var It=we,dt=Se,Wt=le,Mt=1,et=Wt.m,ot=Wt.gc[Wt.ab],Xt=R(et,2);if(Wt.Oc&1<<Xt)be=0;else{switch(Wt.Oc|=1<<Xt,ot.hc=Xt,ot.Ea=It[0],ot.nc=dt[0],ot.K=[null],++Wt.ab,e(4>=Wt.ab),Xt){case 0:case 1:ot.b=R(et,3)+2,Mt=hl(ht(ot.Ea,ot.b),ht(ot.nc,ot.b),0,Wt,ot.K),ot.K=ot.K[0];break;case 3:var rr,qt=R(et,8)+1,Gr=16<qt?0:4<qt?1:2<qt?2:3;if(It[0]=ht(ot.Ea,Gr),ot.b=Gr,rr=Mt=hl(qt,1,0,Wt,ot.K)){var Or,Mi=qt,Rr=ot,dr=1<<(8>>Rr.b),js=s(dr);if(js==null)rr=0;else{var hs=Rr.K[0],Nn=Rr.w;for(js[0]=Rr.K[0][0],Or=1;Or<1*Mi;++Or)js[Or]=Qt(hs[Nn+Or],js[Or-1]);for(;Or<4*dr;++Or)js[Or]=0;Rr.K[0]=null,Rr.K[0]=js,rr=1}}Mt=rr;break;case 2:break;default:e(0)}be=Mt}}if(we=we[0],Se=Se[0],be&&R(Te,1)&&!(be=1<=(At=R(Te,4))&&11>=At)){le.a=3;break e}var jn;if(jn=be)t:{var Aa,hn,Wa,ic=le,zo=we,Fu=Se,Qs=At,ml=Z,Kc=ic.m,Xo=ic.s,nc=[null],Ec=1,Fh=0,Uh=W3[Qs];r:for(;;){if(ml&&R(Kc,1)){var Ol=R(Kc,3)+2,wf=ht(zo,Ol),Om=ht(Fu,Ol),s0=wf*Om;if(!hl(wf,Om,0,ic,nc))break r;for(nc=nc[0],Xo.xc=Ol,Aa=0;Aa<s0;++Aa){var Tp=nc[Aa]>>8&65535;nc[Aa]=Tp,Tp>=Ec&&(Ec=Tp+1)}}if(Kc.h)break r;for(hn=0;5>hn;++hn){var mo=Vy[hn];!hn&&0<Qs&&(mo+=1<<Qs),Fh<mo&&(Fh=mo)}var Mw=a(Ec*Uh,H),CI=Ec,kw=a(CI,j);if(kw==null)var ex=null;else e(65536>=CI),ex=kw;var zy=s(Fh);if(ex==null||zy==null||Mw==null){ic.a=1;break r}var tx=Mw;for(Aa=Wa=0;Aa<Ec;++Aa){var Hh=ex[Aa],a0=Hh.G,vf=Hh.H,SI=0,o0=1,rx=0;for(hn=0;5>hn;++hn){mo=Vy[hn],a0[hn]=tx,vf[hn]=Wa,!hn&&0<Qs&&(mo+=1<<Qs);n:{var Xy,ix=mo,nx=ic,l0=zy,Fw=tx,Uw=Wa,sx=0,Cf=nx.m,TI=R(Cf,1);if(n(l0,0,0,ix),TI){var II=R(Cf,1)+1,Hw=R(Cf,1),BI=R(Cf,Hw==0?1:8);l0[BI]=1,II==2&&(l0[BI=R(Cf,8)]=1);var ax=1}else{var DI=s(19),bh=R(Cf,4)+4;if(19<bh){nx.a=3;var c0=0;break n}for(Xy=0;Xy<bh;++Xy)DI[X3[Xy]]=R(Cf,3);var Gw=void 0,qy=void 0,_I=nx,AN=DI,ox=ix,PI=l0,Yw=0,Ip=_I.m,LI=8,Vw=a(128,H);i:for(;_(Vw,0,7,AN,19);){if(R(Ip,1)){var fN=2+2*R(Ip,3);if((Gw=2+R(Ip,fN))>ox)break i}else Gw=ox;for(qy=0;qy<ox&&Gw--;){Ae(Ip);var lx=Vw[0+(127&z(Ip))];oe(Ip,Ip.u+lx.g);var Nm=lx.value;if(16>Nm)PI[qy++]=Nm,Nm!=0&&(LI=Nm);else{var sc=Nm==16,u0=Nm-16,pN=Q3[u0],OI=R(Ip,j3[u0])+pN;if(qy+OI>ox)break i;for(var NI=sc?LI:0;0<OI--;)PI[qy++]=NI}}Yw=1;break i}Yw||(_I.a=3),ax=Yw}(ax=ax&&!Cf.h)&&(sx=_(Fw,Uw,8,l0,ix)),ax&&sx!=0?c0=sx:(nx.a=3,c0=0)}if(c0==0)break r;if(o0&&z3[hn]==1&&(o0=tx[Wa].g==0),SI+=tx[Wa].g,Wa+=c0,3>=hn){var Rm,jw=zy[0];for(Rm=1;Rm<mo;++Rm)zy[Rm]>jw&&(jw=zy[Rm]);rx+=jw}}if(Hh.nd=o0,Hh.Qb=0,o0&&(Hh.qb=(a0[3][vf[3]+0].value<<24|a0[1][vf[1]+0].value<<16|a0[2][vf[2]+0].value)>>>0,SI==0&&256>a0[0][vf[0]+0].value&&(Hh.Qb=1,Hh.qb+=a0[0][vf[0]+0].value<<8)),Hh.jc=!Hh.Qb&&6>rx,Hh.jc){var cx,Sf=Hh;for(cx=0;cx<to;++cx){var Bp=cx,Dp=Sf.pd[Bp],ux=Sf.G[0][Sf.H[0]+Bp];256<=ux.value?(Dp.g=ux.g+256,Dp.value=ux.value):(Dp.g=0,Dp.value=0,Bp>>=bs(ux,8,Dp),Bp>>=bs(Sf.G[1][Sf.H[1]+Bp],16,Dp),Bp>>=bs(Sf.G[2][Sf.H[2]+Bp],0,Dp),bs(Sf.G[3][Sf.H[3]+Bp],24,Dp))}}}Xo.vc=nc,Xo.Wb=Ec,Xo.Ya=ex,Xo.yc=Mw,jn=1;break t}jn=0}if(!(be=jn)){le.a=3;break e}if(0<At){if(ke.ua=1<<At,!Gt(ke.Wa,At)){le.a=1,be=0;break e}}else ke.ua=0;var Qw=le,RI=we,MI=Se,hx=Qw.s,dx=hx.xc;if(Qw.c=RI,Qw.i=MI,hx.md=ht(RI,dx),hx.wc=dx==0?-1:(1<<dx)-1,Z){le.xb=mI;break e}if((Ze=s(we*Se))==null){le.a=1,be=0;break e}be=(be=Qc(le,Ze,0,we,Se,Se,null))&&!Te.h;break e}return be?(pe!=null?pe[0]=Ze:(e(Ze==null),e(Z)),le.$=0,Z||Uo(ke)):Uo(ke),be}function Ms(T,Y){var Z=T.c*T.i,le=Z+Y+16*Y;return e(T.c<=Y),T.V=s(le),T.V==null?(T.Ta=null,T.Ua=0,T.a=1,0):(T.Ta=T.V,T.Ua=T.Ba+Z+Y,1)}function Tu(T,Y){var Z=T.C,le=Y-Z,pe=T.V,be=T.Ba+T.c*Z;for(e(Y<=T.l.o);0<le;){var we=16<le?16:le,Se=T.l.ma,Te=T.l.width,ke=Te*we,Ze=Se.ca,At=Se.tb+Te*Z,It=T.Ta,dt=T.Ua;Do(T,we,pe,be),cI(It,dt,Ze,At,ke),jc(Se,Z,Z+we,Ze,At,Te),le-=we,pe+=we*T.c,Z+=we}e(Z==Y),T.C=T.Ma=Y}function ha(){this.ub=this.yd=this.td=this.Rb=0}function Sd(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function is(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function uh(){this.Yb=(function(){var T=[];return(function Y(Z,le,pe){for(var be=pe[le],we=0;we<be&&(Z.push(pe.length>le+1?[]:0),!(pe.length<le+1));we++)Y(Z[we],le+1,pe)})(T,0,[3,11]),T})()}function Iu(){this.jb=s(3),this.Wc=o([4,8],uh),this.Xc=o([4,17],uh)}function oA(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function yc(){this.ld=this.La=this.dd=this.tc=0}function lA(){this.Na=this.la=0}function Bu(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Du(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function uf(){this.uc=this.M=this.Nb=0,this.wa=Array(new yc),this.Y=0,this.ya=Array(new Du),this.aa=0,this.l=new Pu}function Bl(){this.y=s(16),this.f=s(8),this.ea=s(8)}function _u(){this.cb=this.a=0,this.sc="",this.m=new q,this.Od=new ha,this.Kc=new Sd,this.ed=new oA,this.Qa=new is,this.Ic=this.$c=this.Aa=0,this.D=new uf,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,q),this.ia=0,this.pb=a(4,Bu),this.Pa=new Iu,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Bl),this.Hd=0,this.rb=Array(new lA),this.sb=0,this.wa=Array(new yc),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Du),this.L=this.aa=0,this.gd=o([4,2],yc),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Pu(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function hh(){var T=new _u;return T!=null&&(T.a=0,T.sc="OK",T.cb=0,T.Xb=0,jy||(jy=dh)),T}function xn(T,Y,Z){return T.a==0&&(T.a=Y,T.sc=Z,T.cb=0),0}function dl(T,Y,Z){return 3<=Z&&T[Y+0]==157&&T[Y+1]==1&&T[Y+2]==42}function zc(T,Y){if(T==null)return 0;if(T.a=0,T.sc="OK",Y==null)return xn(T,2,"null VP8Io passed to VP8GetHeaders()");var Z=Y.data,le=Y.w,pe=Y.ha;if(4>pe)return xn(T,7,"Truncated header.");var be=Z[le+0]|Z[le+1]<<8|Z[le+2]<<16,we=T.Od;if(we.Rb=!(1&be),we.td=be>>1&7,we.yd=be>>4&1,we.ub=be>>5,3<we.td)return xn(T,3,"Incorrect keyframe parameters.");if(!we.yd)return xn(T,4,"Frame not displayable.");le+=3,pe-=3;var Se=T.Kc;if(we.Rb){if(7>pe)return xn(T,7,"cannot parse picture header");if(!dl(Z,le,pe))return xn(T,3,"Bad code word");Se.c=16383&(Z[le+4]<<8|Z[le+3]),Se.Td=Z[le+4]>>6,Se.i=16383&(Z[le+6]<<8|Z[le+5]),Se.Ud=Z[le+6]>>6,le+=7,pe-=7,T.za=Se.c+15>>4,T.Ub=Se.i+15>>4,Y.width=Se.c,Y.height=Se.i,Y.Da=0,Y.j=0,Y.v=0,Y.va=Y.width,Y.o=Y.height,Y.da=0,Y.ib=Y.width,Y.hb=Y.height,Y.U=Y.width,Y.T=Y.height,n((be=T.Pa).jb,0,255,be.jb.length),e((be=T.Qa)!=null),be.Cb=0,be.Bb=0,be.Fb=1,n(be.Zb,0,0,be.Zb.length),n(be.Lb,0,0,be.Lb)}if(we.ub>pe)return xn(T,7,"bad partition length");$(be=T.m,Z,le,we.ub),le+=we.ub,pe-=we.ub,we.Rb&&(Se.Ld=ve(be),Se.Kd=ve(be)),Se=T.Qa;var Te,ke=T.Pa;if(e(be!=null),e(Se!=null),Se.Cb=ve(be),Se.Cb){if(Se.Bb=ve(be),ve(be)){for(Se.Fb=ve(be),Te=0;4>Te;++Te)Se.Zb[Te]=ve(be)?M(be,7):0;for(Te=0;4>Te;++Te)Se.Lb[Te]=ve(be)?M(be,6):0}if(Se.Bb)for(Te=0;3>Te;++Te)ke.jb[Te]=ve(be)?B(be,8):255}else Se.Bb=0;if(be.Ka)return xn(T,3,"cannot parse segment header");if((Se=T.ed).zd=ve(be),Se.Tb=B(be,6),Se.wb=B(be,3),Se.Pc=ve(be),Se.Pc&&ve(be)){for(ke=0;4>ke;++ke)ve(be)&&(Se.vd[ke]=M(be,6));for(ke=0;4>ke;++ke)ve(be)&&(Se.od[ke]=M(be,6))}if(T.L=Se.Tb==0?0:Se.zd?1:2,be.Ka)return xn(T,3,"cannot parse filter header");var Ze=pe;if(pe=Te=le,le=Te+Ze,Se=Ze,T.Xb=(1<<B(T.m,2))-1,Ze<3*(ke=T.Xb))Z=7;else{for(Te+=3*ke,Se-=3*ke,Ze=0;Ze<ke;++Ze){var At=Z[pe+0]|Z[pe+1]<<8|Z[pe+2]<<16;At>Se&&(At=Se),$(T.Jc[+Ze],Z,Te,At),Te+=At,Se-=At,pe+=3}$(T.Jc[+ke],Z,Te,Se),Z=Te<le?0:5}if(Z!=0)return xn(T,Z,"cannot parse partitions");for(Z=B(Te=T.m,7),pe=ve(Te)?M(Te,4):0,le=ve(Te)?M(Te,4):0,Se=ve(Te)?M(Te,4):0,ke=ve(Te)?M(Te,4):0,Te=ve(Te)?M(Te,4):0,Ze=T.Qa,At=0;4>At;++At){if(Ze.Cb){var It=Ze.Zb[At];Ze.Fb||(It+=Z)}else{if(0<At){T.pb[At]=T.pb[0];continue}It=Z}var dt=T.pb[At];dt.Sc[0]=Lw[qc(It+pe,127)],dt.Sc[1]=Ow[qc(It+0,127)],dt.Eb[0]=2*Lw[qc(It+le,127)],dt.Eb[1]=101581*Ow[qc(It+Se,127)]>>16,8>dt.Eb[1]&&(dt.Eb[1]=8),dt.Qc[0]=Lw[qc(It+ke,117)],dt.Qc[1]=Ow[qc(It+Te,127)],dt.lc=It+Te}if(!we.Rb)return xn(T,4,"Not a key frame.");for(ve(be),we=T.Pa,Z=0;4>Z;++Z){for(pe=0;8>pe;++pe)for(le=0;3>le;++le)for(Se=0;11>Se;++Se)ke=Le(be,eN[Z][pe][le][Se])?B(be,8):$3[Z][pe][le][Se],we.Wc[Z][pe].Yb[le][Se]=ke;for(pe=0;17>pe;++pe)we.Xc[Z][pe]=we.Wc[Z][tN[pe]]}return T.kc=ve(be),T.kc&&(T.Bd=B(be,8)),T.cb=1}function dh(T,Y,Z,le,pe,be,we){var Se=Y[pe].Yb[Z];for(Z=0;16>pe;++pe){if(!Le(T,Se[Z+0]))return pe;for(;!Le(T,Se[Z+1]);)if(Se=Y[++pe].Yb[0],Z=0,pe==16)return 16;var Te=Y[pe+1].Yb;if(Le(T,Se[Z+2])){var ke=T,Ze=0;if(Le(ke,(It=Se)[(At=Z)+3]))if(Le(ke,It[At+6])){for(Se=0,At=2*(Ze=Le(ke,It[At+8]))+(It=Le(ke,It[At+9+Ze])),Ze=0,It=K3[At];It[Se];++Se)Ze+=Ze+Le(ke,It[Se]);Ze+=3+(8<<At)}else Le(ke,It[At+7])?(Ze=7+2*Le(ke,165),Ze+=Le(ke,145)):Ze=5+Le(ke,159);else Ze=Le(ke,It[At+4])?3+Le(ke,It[At+5]):2;Se=Te[2]}else Ze=1,Se=Te[1];Te=we+J3[pe],0>(ke=T).b&&me(ke);var At,It=ke.b,dt=(At=ke.Ca>>1)-(ke.I>>It)>>31;--ke.b,ke.Ca+=dt,ke.Ca|=1,ke.I-=(At+1&dt)<<It,be[Te]=((Ze^dt)-dt)*le[(0<pe)+0]}return 16}function hf(T){var Y=T.rb[T.sb-1];Y.la=0,Y.Na=0,n(T.zc,0,0,T.zc.length),T.ja=0}function za(T,Y){if(T==null)return 0;if(Y==null)return xn(T,2,"NULL VP8Io parameter in VP8Decode().");if(!T.cb&&!zc(T,Y))return 0;if(e(T.cb),Y.ac==null||Y.ac(Y)){Y.ob&&(T.L=0);var Z=Zb[T.L];if(T.L==2?(T.yb=0,T.zb=0):(T.yb=Y.v-Z>>4,T.zb=Y.j-Z>>4,0>T.yb&&(T.yb=0),0>T.zb&&(T.zb=0)),T.Va=Y.o+15+Z>>4,T.Hb=Y.va+15+Z>>4,T.Hb>T.za&&(T.Hb=T.za),T.Va>T.Ub&&(T.Va=T.Ub),0<T.L){var le=T.ed;for(Z=0;4>Z;++Z){var pe;if(T.Qa.Cb){var be=T.Qa.Lb[Z];T.Qa.Fb||(be+=le.Tb)}else be=le.Tb;for(pe=0;1>=pe;++pe){var we=T.gd[Z][pe],Se=be;if(le.Pc&&(Se+=le.vd[0],pe&&(Se+=le.od[0])),0<(Se=0>Se?0:63<Se?63:Se)){var Te=Se;0<le.wb&&(Te=4<le.wb?Te>>2:Te>>1)>9-le.wb&&(Te=9-le.wb),1>Te&&(Te=1),we.dd=Te,we.tc=2*Se+Te,we.ld=40<=Se?2:15<=Se?1:0}else we.tc=0;we.La=pe}}}Z=0}else xn(T,6,"Frame setup failed"),Z=T.a;if(Z=Z==0){if(Z){T.$c=0,0<T.Aa||(T.Ic=dN);e:{Z=T.Ic,le=4*(Te=T.za);var ke=32*Te,Ze=Te+1,At=0<T.L?Te*(0<T.Aa?2:1):0,It=(T.Aa==2?2:1)*Te;if((we=le+832+(pe=3*(16*Z+Zb[T.L])/2*ke)+(be=T.Fa!=null&&0<T.Fa.length?T.Kc.c*T.Kc.i:0))!=we)Z=0;else{if(we>T.Vb){if(T.Vb=0,T.Ec=s(we),T.Fc=0,T.Ec==null){Z=xn(T,1,"no memory during frame initialization.");break e}T.Vb=we}we=T.Ec,Se=T.Fc,T.Ac=we,T.Bc=Se,Se+=le,T.Gd=a(ke,Bl),T.Hd=0,T.rb=a(Ze+1,lA),T.sb=1,T.wa=At?a(At,yc):null,T.Y=0,T.D.Nb=0,T.D.wa=T.wa,T.D.Y=T.Y,0<T.Aa&&(T.D.Y+=Te),e(!0),T.oc=we,T.pc=Se,Se+=832,T.ya=a(It,Du),T.aa=0,T.D.ya=T.ya,T.D.aa=T.aa,T.Aa==2&&(T.D.aa+=Te),T.R=16*Te,T.B=8*Te,Te=(ke=Zb[T.L])*T.R,ke=ke/2*T.B,T.sa=we,T.ta=Se+Te,T.qa=T.sa,T.ra=T.ta+16*Z*T.R+ke,T.Ha=T.qa,T.Ia=T.ra+8*Z*T.B+ke,T.$c=0,Se+=pe,T.mb=be?we:null,T.nb=be?Se:null,e(Se+be<=T.Fc+T.Vb),hf(T),n(T.Ac,T.Bc,0,le),Z=1}}if(Z){if(Y.ka=0,Y.y=T.sa,Y.O=T.ta,Y.f=T.qa,Y.N=T.ra,Y.ea=T.Ha,Y.Vd=T.Ia,Y.fa=T.R,Y.Rc=T.B,Y.F=null,Y.J=0,!dI){for(Z=-255;255>=Z;++Z)uI[255+Z]=0>Z?-Z:Z;for(Z=-1020;1020>=Z;++Z)Qb[1020+Z]=-128>Z?-128:127<Z?127:Z;for(Z=-112;112>=Z;++Z)hI[112+Z]=-16>Z?-16:15<Z?15:Z;for(Z=-255;510>=Z;++Z)Iw[255+Z]=0>Z?0:255<Z?255:Z;dI=1}fr=uA,Br=_l,Pr=Td,Gi=Oh,qr=Lu,Zr=df,Di=V,an=ee,mi=de,Pn=ye,jo=ie,ks=he,io=Qe,Ln=Ve,ss=$e,On=ir,Qo=wr,mA=Cn,Ld[0]=Xc,Ld[1]=Pl,Ld[2]=pf,Ld[3]=dA,Ld[4]=Cp,Ld[5]=Ah,Ld[6]=Go,Ld[7]=AA,Ld[8]=fA,Ld[9]=fl,Pd[0]=Af,Pd[1]=hA,Pd[2]=Al,Pd[3]=eo,Pd[4]=_n,Pd[5]=bc,Pd[6]=ff,Ef[0]=pl,Ef[1]=Id,Ef[2]=mf,Ef[3]=Rh,Ef[4]=fh,Ef[5]=tc,Ef[6]=Mh,Z=1}else Z=0}Z&&(Z=(function(dt,Wt){for(dt.M=0;dt.M<dt.Va;++dt.M){var Mt,et=dt.Jc[dt.M&dt.Xb],ot=dt.m,Xt=dt;for(Mt=0;Mt<Xt.za;++Mt){var rr=ot,qt=Xt,Gr=qt.Ac,Or=qt.Bc+4*Mt,Mi=qt.zc,Rr=qt.ya[qt.aa+Mt];if(qt.Qa.Bb?Rr.$b=Le(rr,qt.Pa.jb[0])?2+Le(rr,qt.Pa.jb[2]):Le(rr,qt.Pa.jb[1]):Rr.$b=0,qt.kc&&(Rr.Ad=Le(rr,qt.Bd)),Rr.Za=!Le(rr,145)+0,Rr.Za){var dr=Rr.Ob,js=0;for(qt=0;4>qt;++qt){var hs,Nn=Mi[0+qt];for(hs=0;4>hs;++hs){Nn=Z3[Gr[Or+hs]][Nn];for(var jn=pI[Le(rr,Nn[0])];0<jn;)jn=pI[2*jn+Le(rr,Nn[jn])];Nn=-jn,Gr[Or+hs]=Nn}i(dr,js,Gr,Or,4),js+=4,Mi[0+qt]=Nn}}else Nn=Le(rr,156)?Le(rr,128)?1:3:Le(rr,163)?2:0,Rr.Ob[0]=Nn,n(Gr,Or,Nn,4),n(Mi,0,Nn,4);Rr.Dd=Le(rr,142)?Le(rr,114)?Le(rr,183)?1:3:2:0}if(Xt.m.Ka)return xn(dt,7,"Premature end-of-partition0 encountered.");for(;dt.ja<dt.za;++dt.ja){if(Xt=et,rr=(ot=dt).rb[ot.sb-1],Gr=ot.rb[ot.sb+ot.ja],Mt=ot.ya[ot.aa+ot.ja],Or=ot.kc?Mt.Ad:0)rr.la=Gr.la=0,Mt.Za||(rr.Na=Gr.Na=0),Mt.Hc=0,Mt.Gc=0,Mt.ia=0;else{var Aa,hn;if(rr=Gr,Gr=Xt,Or=ot.Pa.Xc,Mi=ot.ya[ot.aa+ot.ja],Rr=ot.pb[Mi.$b],qt=Mi.ad,dr=0,js=ot.rb[ot.sb-1],Nn=hs=0,n(qt,dr,0,384),Mi.Za)var Wa=0,ic=Or[3];else{jn=s(16);var zo=rr.Na+js.Na;if(zo=jy(Gr,Or[1],zo,Rr.Eb,0,jn,0),rr.Na=js.Na=(0<zo)+0,1<zo)fr(jn,0,qt,dr);else{var Fu=jn[0]+3>>3;for(jn=0;256>jn;jn+=16)qt[dr+jn]=Fu}Wa=1,ic=Or[0]}var Qs=15&rr.la,ml=15&js.la;for(jn=0;4>jn;++jn){var Kc=1&ml;for(Fu=hn=0;4>Fu;++Fu)Qs=Qs>>1|(Kc=(zo=jy(Gr,ic,zo=Kc+(1&Qs),Rr.Sc,Wa,qt,dr))>Wa)<<7,hn=hn<<2|(3<zo?3:1<zo?2:qt[dr+0]!=0),dr+=16;Qs>>=4,ml=ml>>1|Kc<<7,hs=(hs<<8|hn)>>>0}for(ic=Qs,Wa=ml>>4,Aa=0;4>Aa;Aa+=2){for(hn=0,Qs=rr.la>>4+Aa,ml=js.la>>4+Aa,jn=0;2>jn;++jn){for(Kc=1&ml,Fu=0;2>Fu;++Fu)zo=Kc+(1&Qs),Qs=Qs>>1|(Kc=0<(zo=jy(Gr,Or[2],zo,Rr.Qc,0,qt,dr)))<<3,hn=hn<<2|(3<zo?3:1<zo?2:qt[dr+0]!=0),dr+=16;Qs>>=2,ml=ml>>1|Kc<<5}Nn|=hn<<4*Aa,ic|=Qs<<4<<Aa,Wa|=(240&ml)<<Aa}rr.la=ic,js.la=Wa,Mi.Hc=hs,Mi.Gc=Nn,Mi.ia=43690&Nn?0:Rr.ia,Or=!(hs|Nn)}if(0<ot.L&&(ot.wa[ot.Y+ot.ja]=ot.gd[Mt.$b][Mt.Za],ot.wa[ot.Y+ot.ja].La|=!Or),Xt.Ka)return xn(dt,7,"Premature end-of-file encountered.")}if(hf(dt),ot=Wt,Xt=1,Mt=(et=dt).D,rr=0<et.L&&et.M>=et.zb&&et.M<=et.Va,et.Aa==0)e:{if(Mt.M=et.M,Mt.uc=rr,us(et,Mt),Xt=1,Mt=(hn=et.D).Nb,rr=(Nn=Zb[et.L])*et.R,Gr=Nn/2*et.B,jn=16*Mt*et.R,Fu=8*Mt*et.B,Or=et.sa,Mi=et.ta-rr+jn,Rr=et.qa,qt=et.ra-Gr+Fu,dr=et.Ha,js=et.Ia-Gr+Fu,ml=(Qs=hn.M)==0,hs=Qs>=et.Va-1,et.Aa==2&&us(et,hn),hn.uc)for(Kc=(zo=et).D.M,e(zo.D.uc),hn=zo.yb;hn<zo.Hb;++hn){Wa=hn,ic=Kc;var Xo=(nc=(mo=zo).D).Nb;Aa=mo.R;var nc=nc.wa[nc.Y+Wa],Ec=mo.sa,Fh=mo.ta+16*Xo*Aa+16*Wa,Uh=nc.dd,Ol=nc.tc;if(Ol!=0)if(e(3<=Ol),mo.L==1)0<Wa&&On(Ec,Fh,Aa,Ol+4),nc.La&&mA(Ec,Fh,Aa,Ol),0<ic&&ss(Ec,Fh,Aa,Ol+4),nc.La&&Qo(Ec,Fh,Aa,Ol);else{var wf=mo.B,Om=mo.qa,s0=mo.ra+8*Xo*wf+8*Wa,Tp=mo.Ha,mo=mo.Ia+8*Xo*wf+8*Wa;Xo=nc.ld,0<Wa&&(an(Ec,Fh,Aa,Ol+4,Uh,Xo),Pn(Om,s0,Tp,mo,wf,Ol+4,Uh,Xo)),nc.La&&(ks(Ec,Fh,Aa,Ol,Uh,Xo),Ln(Om,s0,Tp,mo,wf,Ol,Uh,Xo)),0<ic&&(Di(Ec,Fh,Aa,Ol+4,Uh,Xo),mi(Om,s0,Tp,mo,wf,Ol+4,Uh,Xo)),nc.La&&(jo(Ec,Fh,Aa,Ol,Uh,Xo),io(Om,s0,Tp,mo,wf,Ol,Uh,Xo))}}if(et.ia&&alert("todo:DitherRow"),ot.put!=null){if(hn=16*Qs,Qs=16*(Qs+1),ml?(ot.y=et.sa,ot.O=et.ta+jn,ot.f=et.qa,ot.N=et.ra+Fu,ot.ea=et.Ha,ot.W=et.Ia+Fu):(hn-=Nn,ot.y=Or,ot.O=Mi,ot.f=Rr,ot.N=qt,ot.ea=dr,ot.W=js),hs||(Qs-=Nn),Qs>ot.o&&(Qs=ot.o),ot.F=null,ot.J=null,et.Fa!=null&&0<et.Fa.length&&hn<Qs&&(ot.J=Ha(et,ot,hn,Qs-hn),ot.F=et.mb,ot.F==null&&ot.F.length==0)){Xt=xn(et,3,"Could not decode alpha data.");break e}hn<ot.j&&(Nn=ot.j-hn,hn=ot.j,e(!(1&Nn)),ot.O+=et.R*Nn,ot.N+=et.B*(Nn>>1),ot.W+=et.B*(Nn>>1),ot.F!=null&&(ot.J+=ot.width*Nn)),hn<Qs&&(ot.O+=ot.v,ot.N+=ot.v>>1,ot.W+=ot.v>>1,ot.F!=null&&(ot.J+=ot.v),ot.ka=hn-ot.j,ot.U=ot.va-ot.v,ot.T=Qs-hn,Xt=ot.put(ot))}Mt+1!=et.Ic||hs||(i(et.sa,et.ta-rr,Or,Mi+16*et.R,rr),i(et.qa,et.ra-Gr,Rr,qt+8*et.B,Gr),i(et.Ha,et.Ia-Gr,dr,js+8*et.B,Gr))}if(!Xt)return xn(dt,6,"Output aborted.")}return 1})(T,Y)),Y.bc!=null&&Y.bc(Y),Z&=1}return Z?(T.cb=0,Z):0}function Ho(T,Y,Z,le,pe){pe=T[Y+Z+32*le]+(pe>>3),T[Y+Z+32*le]=-256&pe?0>pe?0:255:pe}function Dl(T,Y,Z,le,pe,be){Ho(T,Y,0,Z,le+pe),Ho(T,Y,1,Z,le+be),Ho(T,Y,2,Z,le-be),Ho(T,Y,3,Z,le-pe)}function Xa(T){return(20091*T>>16)+T}function cA(T,Y,Z,le){var pe,be=0,we=s(16);for(pe=0;4>pe;++pe){var Se=T[Y+0]+T[Y+8],Te=T[Y+0]-T[Y+8],ke=(35468*T[Y+4]>>16)-Xa(T[Y+12]),Ze=Xa(T[Y+4])+(35468*T[Y+12]>>16);we[be+0]=Se+Ze,we[be+1]=Te+ke,we[be+2]=Te-ke,we[be+3]=Se-Ze,be+=4,Y++}for(pe=be=0;4>pe;++pe)Se=(T=we[be+0]+4)+we[be+8],Te=T-we[be+8],ke=(35468*we[be+4]>>16)-Xa(we[be+12]),Ho(Z,le,0,0,Se+(Ze=Xa(we[be+4])+(35468*we[be+12]>>16))),Ho(Z,le,1,0,Te+ke),Ho(Z,le,2,0,Te-ke),Ho(Z,le,3,0,Se-Ze),be++,le+=32}function df(T,Y,Z,le){var pe=T[Y+0]+4,be=35468*T[Y+4]>>16,we=Xa(T[Y+4]),Se=35468*T[Y+1]>>16;Dl(Z,le,0,pe+we,T=Xa(T[Y+1]),Se),Dl(Z,le,1,pe+be,T,Se),Dl(Z,le,2,pe-be,T,Se),Dl(Z,le,3,pe-we,T,Se)}function _l(T,Y,Z,le,pe){cA(T,Y,Z,le),pe&&cA(T,Y+16,Z,le+4)}function Td(T,Y,Z,le){Br(T,Y+0,Z,le,1),Br(T,Y+32,Z,le+128,1)}function Oh(T,Y,Z,le){var pe;for(T=T[Y+0]+4,pe=0;4>pe;++pe)for(Y=0;4>Y;++Y)Ho(Z,le,Y,pe,T)}function Lu(T,Y,Z,le){T[Y+0]&&Gi(T,Y+0,Z,le),T[Y+16]&&Gi(T,Y+16,Z,le+4),T[Y+32]&&Gi(T,Y+32,Z,le+128),T[Y+48]&&Gi(T,Y+48,Z,le+128+4)}function uA(T,Y,Z,le){var pe,be=s(16);for(pe=0;4>pe;++pe){var we=T[Y+0+pe]+T[Y+12+pe],Se=T[Y+4+pe]+T[Y+8+pe],Te=T[Y+4+pe]-T[Y+8+pe],ke=T[Y+0+pe]-T[Y+12+pe];be[0+pe]=we+Se,be[8+pe]=we-Se,be[4+pe]=ke+Te,be[12+pe]=ke-Te}for(pe=0;4>pe;++pe)we=(T=be[0+4*pe]+3)+be[3+4*pe],Se=be[1+4*pe]+be[2+4*pe],Te=be[1+4*pe]-be[2+4*pe],ke=T-be[3+4*pe],Z[le+0]=we+Se>>3,Z[le+16]=ke+Te>>3,Z[le+32]=we-Se>>3,Z[le+48]=ke-Te>>3,le+=64}function qa(T,Y,Z){var le,pe=Y-32,be=yh,we=255-T[pe-1];for(le=0;le<Z;++le){var Se,Te=be,ke=we+T[Y-1];for(Se=0;Se<Z;++Se)T[Y+Se]=Te[ke+T[pe+Se]];Y+=32}}function Pl(T,Y){qa(T,Y,4)}function Id(T,Y){qa(T,Y,8)}function hA(T,Y){qa(T,Y,16)}function Al(T,Y){var Z;for(Z=0;16>Z;++Z)i(T,Y+32*Z,T,Y-32,16)}function eo(T,Y){var Z;for(Z=16;0<Z;--Z)n(T,Y,T[Y-1],16),Y+=32}function Nh(T,Y,Z){var le;for(le=0;16>le;++le)n(Y,Z+32*le,T,16)}function Af(T,Y){var Z,le=16;for(Z=0;16>Z;++Z)le+=T[Y-1+32*Z]+T[Y+Z-32];Nh(le>>5,T,Y)}function _n(T,Y){var Z,le=8;for(Z=0;16>Z;++Z)le+=T[Y-1+32*Z];Nh(le>>4,T,Y)}function bc(T,Y){var Z,le=8;for(Z=0;16>Z;++Z)le+=T[Y+Z-32];Nh(le>>4,T,Y)}function ff(T,Y){Nh(128,T,Y)}function Fi(T,Y,Z){return T+2*Y+Z+2>>2}function pf(T,Y){var Z,le=Y-32;for(le=new Uint8Array([Fi(T[le-1],T[le+0],T[le+1]),Fi(T[le+0],T[le+1],T[le+2]),Fi(T[le+1],T[le+2],T[le+3]),Fi(T[le+2],T[le+3],T[le+4])]),Z=0;4>Z;++Z)i(T,Y+32*Z,le,0,le.length)}function dA(T,Y){var Z=T[Y-1],le=T[Y-1+32],pe=T[Y-1+64],be=T[Y-1+96];He(T,Y+0,16843009*Fi(T[Y-1-32],Z,le)),He(T,Y+32,16843009*Fi(Z,le,pe)),He(T,Y+64,16843009*Fi(le,pe,be)),He(T,Y+96,16843009*Fi(pe,be,be))}function Xc(T,Y){var Z,le=4;for(Z=0;4>Z;++Z)le+=T[Y+Z-32]+T[Y-1+32*Z];for(le>>=3,Z=0;4>Z;++Z)n(T,Y+32*Z,le,4)}function Cp(T,Y){var Z=T[Y-1+0],le=T[Y-1+32],pe=T[Y-1+64],be=T[Y-1-32],we=T[Y+0-32],Se=T[Y+1-32],Te=T[Y+2-32],ke=T[Y+3-32];T[Y+0+96]=Fi(le,pe,T[Y-1+96]),T[Y+1+96]=T[Y+0+64]=Fi(Z,le,pe),T[Y+2+96]=T[Y+1+64]=T[Y+0+32]=Fi(be,Z,le),T[Y+3+96]=T[Y+2+64]=T[Y+1+32]=T[Y+0+0]=Fi(we,be,Z),T[Y+3+64]=T[Y+2+32]=T[Y+1+0]=Fi(Se,we,be),T[Y+3+32]=T[Y+2+0]=Fi(Te,Se,we),T[Y+3+0]=Fi(ke,Te,Se)}function Go(T,Y){var Z=T[Y+1-32],le=T[Y+2-32],pe=T[Y+3-32],be=T[Y+4-32],we=T[Y+5-32],Se=T[Y+6-32],Te=T[Y+7-32];T[Y+0+0]=Fi(T[Y+0-32],Z,le),T[Y+1+0]=T[Y+0+32]=Fi(Z,le,pe),T[Y+2+0]=T[Y+1+32]=T[Y+0+64]=Fi(le,pe,be),T[Y+3+0]=T[Y+2+32]=T[Y+1+64]=T[Y+0+96]=Fi(pe,be,we),T[Y+3+32]=T[Y+2+64]=T[Y+1+96]=Fi(be,we,Se),T[Y+3+64]=T[Y+2+96]=Fi(we,Se,Te),T[Y+3+96]=Fi(Se,Te,Te)}function Ah(T,Y){var Z=T[Y-1+0],le=T[Y-1+32],pe=T[Y-1+64],be=T[Y-1-32],we=T[Y+0-32],Se=T[Y+1-32],Te=T[Y+2-32],ke=T[Y+3-32];T[Y+0+0]=T[Y+1+64]=be+we+1>>1,T[Y+1+0]=T[Y+2+64]=we+Se+1>>1,T[Y+2+0]=T[Y+3+64]=Se+Te+1>>1,T[Y+3+0]=Te+ke+1>>1,T[Y+0+96]=Fi(pe,le,Z),T[Y+0+64]=Fi(le,Z,be),T[Y+0+32]=T[Y+1+96]=Fi(Z,be,we),T[Y+1+32]=T[Y+2+96]=Fi(be,we,Se),T[Y+2+32]=T[Y+3+96]=Fi(we,Se,Te),T[Y+3+32]=Fi(Se,Te,ke)}function AA(T,Y){var Z=T[Y+0-32],le=T[Y+1-32],pe=T[Y+2-32],be=T[Y+3-32],we=T[Y+4-32],Se=T[Y+5-32],Te=T[Y+6-32],ke=T[Y+7-32];T[Y+0+0]=Z+le+1>>1,T[Y+1+0]=T[Y+0+64]=le+pe+1>>1,T[Y+2+0]=T[Y+1+64]=pe+be+1>>1,T[Y+3+0]=T[Y+2+64]=be+we+1>>1,T[Y+0+32]=Fi(Z,le,pe),T[Y+1+32]=T[Y+0+96]=Fi(le,pe,be),T[Y+2+32]=T[Y+1+96]=Fi(pe,be,we),T[Y+3+32]=T[Y+2+96]=Fi(be,we,Se),T[Y+3+64]=Fi(we,Se,Te),T[Y+3+96]=Fi(Se,Te,ke)}function fl(T,Y){var Z=T[Y-1+0],le=T[Y-1+32],pe=T[Y-1+64],be=T[Y-1+96];T[Y+0+0]=Z+le+1>>1,T[Y+2+0]=T[Y+0+32]=le+pe+1>>1,T[Y+2+32]=T[Y+0+64]=pe+be+1>>1,T[Y+1+0]=Fi(Z,le,pe),T[Y+3+0]=T[Y+1+32]=Fi(le,pe,be),T[Y+3+32]=T[Y+1+64]=Fi(pe,be,be),T[Y+3+64]=T[Y+2+64]=T[Y+0+96]=T[Y+1+96]=T[Y+2+96]=T[Y+3+96]=be}function fA(T,Y){var Z=T[Y-1+0],le=T[Y-1+32],pe=T[Y-1+64],be=T[Y-1+96],we=T[Y-1-32],Se=T[Y+0-32],Te=T[Y+1-32],ke=T[Y+2-32];T[Y+0+0]=T[Y+2+32]=Z+we+1>>1,T[Y+0+32]=T[Y+2+64]=le+Z+1>>1,T[Y+0+64]=T[Y+2+96]=pe+le+1>>1,T[Y+0+96]=be+pe+1>>1,T[Y+3+0]=Fi(Se,Te,ke),T[Y+2+0]=Fi(we,Se,Te),T[Y+1+0]=T[Y+3+32]=Fi(Z,we,Se),T[Y+1+32]=T[Y+3+64]=Fi(le,Z,we),T[Y+1+64]=T[Y+3+96]=Fi(pe,le,Z),T[Y+1+96]=Fi(be,pe,le)}function mf(T,Y){var Z;for(Z=0;8>Z;++Z)i(T,Y+32*Z,T,Y-32,8)}function Rh(T,Y){var Z;for(Z=0;8>Z;++Z)n(T,Y,T[Y-1],8),Y+=32}function Ou(T,Y,Z){var le;for(le=0;8>le;++le)n(Y,Z+32*le,T,8)}function pl(T,Y){var Z,le=8;for(Z=0;8>Z;++Z)le+=T[Y+Z-32]+T[Y-1+32*Z];Ou(le>>4,T,Y)}function tc(T,Y){var Z,le=4;for(Z=0;8>Z;++Z)le+=T[Y+Z-32];Ou(le>>3,T,Y)}function fh(T,Y){var Z,le=4;for(Z=0;8>Z;++Z)le+=T[Y-1+32*Z];Ou(le>>3,T,Y)}function Mh(T,Y){Ou(128,T,Y)}function Pa(T,Y,Z){var le=T[Y-Z],pe=T[Y+0],be=3*(pe-le)+Bw[1020+T[Y-2*Z]-T[Y+Z]],we=zb[112+(be+4>>3)];T[Y-Z]=yh[255+le+zb[112+(be+3>>3)]],T[Y+0]=yh[255+pe-we]}function gf(T,Y,Z,le){var pe=T[Y+0],be=T[Y+Z];return kh[255+T[Y-2*Z]-T[Y-Z]]>le||kh[255+be-pe]>le}function ph(T,Y,Z,le){return 4*kh[255+T[Y-Z]-T[Y+0]]+kh[255+T[Y-2*Z]-T[Y+Z]]<=le}function $r(T,Y,Z,le,pe){var be=T[Y-3*Z],we=T[Y-2*Z],Se=T[Y-Z],Te=T[Y+0],ke=T[Y+Z],Ze=T[Y+2*Z],At=T[Y+3*Z];return 4*kh[255+Se-Te]+kh[255+we-ke]>le?0:kh[255+T[Y-4*Z]-be]<=pe&&kh[255+be-we]<=pe&&kh[255+we-Se]<=pe&&kh[255+At-Ze]<=pe&&kh[255+Ze-ke]<=pe&&kh[255+ke-Te]<=pe}function $e(T,Y,Z,le){var pe=2*le+1;for(le=0;16>le;++le)ph(T,Y+le,Z,pe)&&Pa(T,Y+le,Z)}function ir(T,Y,Z,le){var pe=2*le+1;for(le=0;16>le;++le)ph(T,Y+le*Z,1,pe)&&Pa(T,Y+le*Z,1)}function wr(T,Y,Z,le){var pe;for(pe=3;0<pe;--pe)$e(T,Y+=4*Z,Z,le)}function Cn(T,Y,Z,le){var pe;for(pe=3;0<pe;--pe)ir(T,Y+=4,Z,le)}function da(T,Y,Z,le,pe,be,we,Se){for(be=2*be+1;0<pe--;){if($r(T,Y,Z,be,we))if(gf(T,Y,Z,Se))Pa(T,Y,Z);else{var Te=T,ke=Y,Ze=Z,At=Te[ke-2*Ze],It=Te[ke-Ze],dt=Te[ke+0],Wt=Te[ke+Ze],Mt=Te[ke+2*Ze],et=27*(Xt=Bw[1020+3*(dt-It)+Bw[1020+At-Wt]])+63>>7,ot=18*Xt+63>>7,Xt=9*Xt+63>>7;Te[ke-3*Ze]=yh[255+Te[ke-3*Ze]+Xt],Te[ke-2*Ze]=yh[255+At+ot],Te[ke-Ze]=yh[255+It+et],Te[ke+0]=yh[255+dt-et],Te[ke+Ze]=yh[255+Wt-ot],Te[ke+2*Ze]=yh[255+Mt-Xt]}Y+=le}}function S(T,Y,Z,le,pe,be,we,Se){for(be=2*be+1;0<pe--;){if($r(T,Y,Z,be,we))if(gf(T,Y,Z,Se))Pa(T,Y,Z);else{var Te=T,ke=Y,Ze=Z,At=Te[ke-Ze],It=Te[ke+0],dt=Te[ke+Ze],Wt=zb[112+((Mt=3*(It-At))+4>>3)],Mt=zb[112+(Mt+3>>3)],et=Wt+1>>1;Te[ke-2*Ze]=yh[255+Te[ke-2*Ze]+et],Te[ke-Ze]=yh[255+At+Mt],Te[ke+0]=yh[255+It-Wt],Te[ke+Ze]=yh[255+dt-et]}Y+=le}}function V(T,Y,Z,le,pe,be){da(T,Y,Z,1,16,le,pe,be)}function ee(T,Y,Z,le,pe,be){da(T,Y,1,Z,16,le,pe,be)}function ie(T,Y,Z,le,pe,be){var we;for(we=3;0<we;--we)S(T,Y+=4*Z,Z,1,16,le,pe,be)}function he(T,Y,Z,le,pe,be){var we;for(we=3;0<we;--we)S(T,Y+=4,1,Z,16,le,pe,be)}function de(T,Y,Z,le,pe,be,we,Se){da(T,Y,pe,1,8,be,we,Se),da(Z,le,pe,1,8,be,we,Se)}function ye(T,Y,Z,le,pe,be,we,Se){da(T,Y,1,pe,8,be,we,Se),da(Z,le,1,pe,8,be,we,Se)}function Qe(T,Y,Z,le,pe,be,we,Se){S(T,Y+4*pe,pe,1,8,be,we,Se),S(Z,le+4*pe,pe,1,8,be,we,Se)}function Ve(T,Y,Z,le,pe,be,we,Se){S(T,Y+4,1,pe,8,be,we,Se),S(Z,le+4,1,pe,8,be,we,Se)}function at(){this.ba=new lr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new xi,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ot(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Vt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Bt(){this.ua=0,this.Wa=new Pe,this.vb=new Pe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new j,this.yc=new H}function hr(){this.xb=this.a=0,this.l=new Pu,this.ca=new lr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new P,this.Pb=0,this.wd=new P,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Bt,this.ab=0,this.gc=a(4,Vt),this.Oc=0}function Oi(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Pu,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function gn(T,Y,Z,le,pe,be,we){for(T=T==null?0:T[Y+0],Y=0;Y<we;++Y)pe[be+Y]=T+Z[le+Y]&255,T=pe[be+Y]}function Ji(T,Y,Z,le,pe,be,we){var Se;if(T==null)gn(null,null,Z,le,pe,be,we);else for(Se=0;Se<we;++Se)pe[be+Se]=T[Y+Se]+Z[le+Se]&255}function Vs(T,Y,Z,le,pe,be,we){if(T==null)gn(null,null,Z,le,pe,be,we);else{var Se,Te=T[Y+0],ke=Te,Ze=Te;for(Se=0;Se<we;++Se)ke=Ze+(Te=T[Y+Se])-ke,Ze=Z[le+Se]+(-256&ke?0>ke?0:255:ke)&255,ke=Te,pe[be+Se]=Ze}}function Ha(T,Y,Z,le){var pe=Y.width,be=Y.o;if(e(T!=null&&Y!=null),0>Z||0>=le||Z+le>be)return null;if(!T.Cc){if(T.ga==null){var we;if(T.ga=new Oi,(we=T.ga==null)||(we=Y.width*Y.o,e(T.Gb.length==0),T.Gb=s(we),T.Uc=0,T.Gb==null?we=0:(T.mb=T.Gb,T.nb=T.Uc,T.rc=null,we=1),we=!we),!we){we=T.ga;var Se=T.Fa,Te=T.P,ke=T.qc,Ze=T.mb,At=T.nb,It=Te+1,dt=ke-1,Wt=we.l;if(e(Se!=null&&Ze!=null&&Y!=null),Sp[0]=null,Sp[1]=gn,Sp[2]=Ji,Sp[3]=Vs,we.ca=Ze,we.tb=At,we.c=Y.width,we.i=Y.height,e(0<we.c&&0<we.i),1>=ke)Y=0;else if(we.$a=Se[Te+0]>>0&3,we.Z=Se[Te+0]>>2&3,we.Lc=Se[Te+0]>>4&3,Te=Se[Te+0]>>6&3,0>we.$a||1<we.$a||4<=we.Z||1<we.Lc||Te)Y=0;else if(Wt.put=Dn,Wt.ac=sn,Wt.bc=Za,Wt.ma=we,Wt.width=Y.width,Wt.height=Y.height,Wt.Da=Y.Da,Wt.v=Y.v,Wt.va=Y.va,Wt.j=Y.j,Wt.o=Y.o,we.$a)e:{e(we.$a==1),Y=ul();t:for(;;){if(Y==null){Y=0;break e}if(e(we!=null),we.mc=Y,Y.c=we.c,Y.i=we.i,Y.l=we.l,Y.l.ma=we,Y.l.width=we.c,Y.l.height=we.i,Y.a=0,v(Y.m,Se,It,dt),!hl(we.c,we.i,1,Y,null)||(Y.ab==1&&Y.gc[0].hc==3&&gc(Y.s)?(we.ic=1,Se=Y.c*Y.i,Y.Ta=null,Y.Ua=0,Y.V=s(Se),Y.Ba=0,Y.V==null?(Y.a=1,Y=0):Y=1):(we.ic=0,Y=Ms(Y,we.c)),!Y))break t;Y=1;break e}we.mc=null,Y=0}else Y=dt>=we.c*we.i;we=!Y}if(we)return null;T.ga.Lc!=1?T.Ga=0:le=be-Z}e(T.ga!=null),e(Z+le<=be);e:{if(Y=(Se=T.ga).c,be=Se.l.o,Se.$a==0){if(It=T.rc,dt=T.Vc,Wt=T.Fa,Te=T.P+1+Z*Y,ke=T.mb,Ze=T.nb+Z*Y,e(Te<=T.P+T.qc),Se.Z!=0)for(e(Sp[Se.Z]!=null),we=0;we<le;++we)Sp[Se.Z](It,dt,Wt,Te,ke,Ze,Y),It=ke,dt=Ze,Ze+=Y,Te+=Y;else for(we=0;we<le;++we)i(ke,Ze,Wt,Te,Y),It=ke,dt=Ze,Ze+=Y,Te+=Y;T.rc=It,T.Vc=dt}else{if(e(Se.mc!=null),Y=Z+le,e((we=Se.mc)!=null),e(Y<=we.i),we.C>=Y)Y=1;else if(Se.ic||Je(),Se.ic){Se=we.V,It=we.Ba,dt=we.c;var Mt=we.i,et=(Wt=1,Te=we.$/dt,ke=we.$%dt,Ze=we.m,At=we.s,we.$),ot=dt*Mt,Xt=dt*Y,rr=At.wc,qt=et<Xt?Zi(At,ke,Te):null;e(et<=ot),e(Y<=Mt),e(gc(At));t:for(;;){for(;!Ze.h&&et<Xt;){if(ke&rr||(qt=Zi(At,ke,Te)),e(qt!=null),Ae(Ze),256>(Mt=mn(qt.G[0],qt.H[0],Ze)))Se[It+et]=Mt,++et,++ke>=dt&&(ke=0,++Te<=Y&&!(Te%16)&&ec(we,Te));else{if(!(280>Mt)){Wt=0;break t}Mt=xa(Mt-256,Ze);var Gr,Or=mn(qt.G[4],qt.H[4],Ze);if(Ae(Ze),!(et>=(Or=Lr(dt,Or=xa(Or,Ze)))&&ot-et>=Mt)){Wt=0;break t}for(Gr=0;Gr<Mt;++Gr)Se[It+et+Gr]=Se[It+et+Gr-Or];for(et+=Mt,ke+=Mt;ke>=dt;)ke-=dt,++Te<=Y&&!(Te%16)&&ec(we,Te);et<Xt&&ke&rr&&(qt=Zi(At,ke,Te))}e(Ze.h==W(Ze))}ec(we,Te>Y?Y:Te);break t}!Wt||Ze.h&&et<ot?(Wt=0,we.a=Ze.h?5:3):we.$=et,Y=Wt}else Y=Qc(we,we.V,we.Ba,we.c,we.i,Y,Tu);if(!Y){le=0;break e}}Z+le>=be&&(T.Cc=1),le=1}if(!le)return null;if(T.Cc&&((le=T.ga)!=null&&(le.mc=null),T.ga=null,0<T.Ga))return alert("todo:WebPDequantizeLevels"),null}return T.nb+Z*pe}function J(T,Y,Z,le,pe,be){for(;0<pe--;){var we,Se=T,Te=Y+(Z?1:0),ke=T,Ze=Y+(Z?0:3);for(we=0;we<le;++we){var At=ke[Ze+4*we];At!=255&&(At*=32897,Se[Te+4*we+0]=Se[Te+4*we+0]*At>>23,Se[Te+4*we+1]=Se[Te+4*we+1]*At>>23,Se[Te+4*we+2]=Se[Te+4*we+2]*At>>23)}Y+=be}}function fe(T,Y,Z,le,pe){for(;0<le--;){var be;for(be=0;be<Z;++be){var we=T[Y+2*be+0],Se=15&(ke=T[Y+2*be+1]),Te=4369*Se,ke=(240&ke|ke>>4)*Te>>16;T[Y+2*be+0]=(240&we|we>>4)*Te>>16&240|(15&we|we<<4)*Te>>16>>4&15,T[Y+2*be+1]=240&ke|Se}Y+=pe}}function Oe(T,Y,Z,le,pe,be,we,Se){var Te,ke,Ze=255;for(ke=0;ke<pe;++ke){for(Te=0;Te<le;++Te){var At=T[Y+Te];be[we+4*Te]=At,Ze&=At}Y+=Z,we+=Se}return Ze!=255}function Xe(T,Y,Z,le,pe){var be;for(be=0;be<pe;++be)Z[le+be]=T[Y+be]>>8}function Je(){bf=J,r0=fe,_m=Oe,cI=Xe}function _t(T,Y,Z){C[T]=function(le,pe,be,we,Se,Te,ke,Ze,At,It,dt,Wt,Mt,et,ot,Xt,rr){var qt,Gr=rr-1>>1,Or=Se[Te+0]|ke[Ze+0]<<16,Mi=At[It+0]|dt[Wt+0]<<16;e(le!=null);var Rr=3*Or+Mi+131074>>2;for(Y(le[pe+0],255&Rr,Rr>>16,Mt,et),be!=null&&(Rr=3*Mi+Or+131074>>2,Y(be[we+0],255&Rr,Rr>>16,ot,Xt)),qt=1;qt<=Gr;++qt){var dr=Se[Te+qt]|ke[Ze+qt]<<16,js=At[It+qt]|dt[Wt+qt]<<16,hs=Or+dr+Mi+js+524296,Nn=hs+2*(dr+Mi)>>3;Rr=Nn+Or>>1,Or=(hs=hs+2*(Or+js)>>3)+dr>>1,Y(le[pe+2*qt-1],255&Rr,Rr>>16,Mt,et+(2*qt-1)*Z),Y(le[pe+2*qt-0],255&Or,Or>>16,Mt,et+(2*qt-0)*Z),be!=null&&(Rr=hs+Mi>>1,Or=Nn+js>>1,Y(be[we+2*qt-1],255&Rr,Rr>>16,ot,Xt+(2*qt-1)*Z),Y(be[we+2*qt+0],255&Or,Or>>16,ot,Xt+(2*qt+0)*Z)),Or=dr,Mi=js}1&rr||(Rr=3*Or+Mi+131074>>2,Y(le[pe+rr-1],255&Rr,Rr>>16,Mt,et+(rr-1)*Z),be!=null&&(Rr=3*Mi+Or+131074>>2,Y(be[we+rr-1],255&Rr,Rr>>16,ot,Xt+(rr-1)*Z)))}}function or(){ku[xf]=Jb,ku[Xb]=yI,ku[AI]=rN,ku[Pm]=bI,ku[qb]=xI,ku[Dw]=EI,ku[fI]=iN,ku[_w]=yI,ku[i0]=bI,ku[Wb]=xI,ku[Pw]=EI}function Nr(T){return T&~nN?0>T?0:255:T>>wI}function ei(T,Y){return Nr((19077*T>>8)+(26149*Y>>8)-14234)}function Ui(T,Y,Z){return Nr((19077*T>>8)-(6419*Y>>8)-(13320*Z>>8)+8708)}function Si(T,Y){return Nr((19077*T>>8)+(33050*Y>>8)-17685)}function Vi(T,Y,Z,le,pe){le[pe+0]=ei(T,Z),le[pe+1]=Ui(T,Y,Z),le[pe+2]=Si(T,Y)}function gi(T,Y,Z,le,pe){le[pe+0]=Si(T,Y),le[pe+1]=Ui(T,Y,Z),le[pe+2]=ei(T,Z)}function $n(T,Y,Z,le,pe){var be=Ui(T,Y,Z);Y=be<<3&224|Si(T,Y)>>3,le[pe+0]=248&ei(T,Z)|be>>5,le[pe+1]=Y}function La(T,Y,Z,le,pe){var be=240&Si(T,Y)|15;le[pe+0]=240&ei(T,Z)|Ui(T,Y,Z)>>4,le[pe+1]=be}function Ea(T,Y,Z,le,pe){le[pe+0]=255,Vi(T,Y,Z,le,pe+1)}function cs(T,Y,Z,le,pe){gi(T,Y,Z,le,pe),le[pe+3]=255}function po(T,Y,Z,le,pe){Vi(T,Y,Z,le,pe),le[pe+3]=255}function qc(T,Y){return 0>T?0:T>Y?Y:T}function Ll(T,Y,Z){C[T]=function(le,pe,be,we,Se,Te,ke,Ze,At){for(var It=Ze+(-2&At)*Z;Ze!=It;)Y(le[pe+0],be[we+0],Se[Te+0],ke,Ze),Y(le[pe+1],be[we+0],Se[Te+0],ke,Ze+Z),pe+=2,++we,++Te,Ze+=2*Z;1&At&&Y(le[pe+0],be[we+0],Se[Te+0],ke,Ze)}}function Ni(T,Y,Z){return Z==0?T==0?Y==0?6:5:Y==0?4:0:Z}function Bd(T,Y,Z,le,pe){switch(T>>>30){case 3:Br(Y,Z,le,pe,0);break;case 2:Zr(Y,Z,le,pe);break;case 1:Gi(Y,Z,le,pe)}}function us(T,Y){var Z,le,pe=Y.M,be=Y.Nb,we=T.oc,Se=T.pc+40,Te=T.oc,ke=T.pc+584,Ze=T.oc,At=T.pc+600;for(Z=0;16>Z;++Z)we[Se+32*Z-1]=129;for(Z=0;8>Z;++Z)Te[ke+32*Z-1]=129,Ze[At+32*Z-1]=129;for(0<pe?we[Se-1-32]=Te[ke-1-32]=Ze[At-1-32]=129:(n(we,Se-32-1,127,21),n(Te,ke-32-1,127,9),n(Ze,At-32-1,127,9)),le=0;le<T.za;++le){var It=Y.ya[Y.aa+le];if(0<le){for(Z=-1;16>Z;++Z)i(we,Se+32*Z-4,we,Se+32*Z+12,4);for(Z=-1;8>Z;++Z)i(Te,ke+32*Z-4,Te,ke+32*Z+4,4),i(Ze,At+32*Z-4,Ze,At+32*Z+4,4)}var dt=T.Gd,Wt=T.Hd+le,Mt=It.ad,et=It.Hc;if(0<pe&&(i(we,Se-32,dt[Wt].y,0,16),i(Te,ke-32,dt[Wt].f,0,8),i(Ze,At-32,dt[Wt].ea,0,8)),It.Za){var ot=we,Xt=Se-32+16;for(0<pe&&(le>=T.za-1?n(ot,Xt,dt[Wt].y[15],4):i(ot,Xt,dt[Wt+1].y,0,4)),Z=0;4>Z;Z++)ot[Xt+128+Z]=ot[Xt+256+Z]=ot[Xt+384+Z]=ot[Xt+0+Z];for(Z=0;16>Z;++Z,et<<=2)ot=we,Xt=Se+Rw[Z],Ld[It.Ob[Z]](ot,Xt),Bd(et,Mt,16*+Z,ot,Xt)}else if(ot=Ni(le,pe,It.Ob[0]),Pd[ot](we,Se),et!=0)for(Z=0;16>Z;++Z,et<<=2)Bd(et,Mt,16*+Z,we,Se+Rw[Z]);for(Z=It.Gc,ot=Ni(le,pe,It.Dd),Ef[ot](Te,ke),Ef[ot](Ze,At),et=Mt,ot=Te,Xt=ke,255&(It=Z>>0)&&(170&It?Pr(et,256,ot,Xt):qr(et,256,ot,Xt)),It=Ze,et=At,255&(Z>>=8)&&(170&Z?Pr(Mt,320,It,et):qr(Mt,320,It,et)),pe<T.Ub-1&&(i(dt[Wt].y,0,we,Se+480,16),i(dt[Wt].f,0,Te,ke+224,8),i(dt[Wt].ea,0,Ze,At+224,8)),Z=8*be*T.B,dt=T.sa,Wt=T.ta+16*le+16*be*T.R,Mt=T.qa,It=T.ra+8*le+Z,et=T.Ha,ot=T.Ia+8*le+Z,Z=0;16>Z;++Z)i(dt,Wt+Z*T.R,we,Se+32*Z,16);for(Z=0;8>Z;++Z)i(Mt,It+Z*T.B,Te,ke+32*Z,8),i(et,ot+Z*T.B,Ze,At+32*Z,8)}}function Wc(T,Y,Z,le,pe,be,we,Se,Te){var ke=[0],Ze=[0],At=0,It=Te!=null?Te.kd:0,dt=Te!=null?Te:new Ot;if(T==null||12>Z)return 7;dt.data=T,dt.w=Y,dt.ha=Z,Y=[Y],Z=[Z],dt.gb=[dt.gb];e:{var Wt=Y,Mt=Z,et=dt.gb;if(e(T!=null),e(Mt!=null),e(et!=null),et[0]=0,12<=Mt[0]&&!r(T,Wt[0],"RIFF")){if(r(T,Wt[0]+8,"WEBP")){et=3;break e}var ot=xt(T,Wt[0]+4);if(12>ot||4294967286<ot){et=3;break e}if(It&&ot>Mt[0]-8){et=7;break e}et[0]=ot,Wt[0]+=12,Mt[0]-=12}et=0}if(et!=0)return et;for(ot=0<dt.gb[0],Z=Z[0];;){e:{var Xt=T;Mt=Y,et=Z;var rr=ke,qt=Ze,Gr=Wt=[0];if((Rr=At=[At])[0]=0,8>et[0])et=7;else{if(!r(Xt,Mt[0],"VP8X")){if(xt(Xt,Mt[0]+4)!=10){et=3;break e}if(18>et[0]){et=7;break e}var Or=xt(Xt,Mt[0]+8),Mi=1+qe(Xt,Mt[0]+12);if(2147483648<=Mi*(Xt=1+qe(Xt,Mt[0]+15))){et=3;break e}Gr!=null&&(Gr[0]=Or),rr!=null&&(rr[0]=Mi),qt!=null&&(qt[0]=Xt),Mt[0]+=18,et[0]-=18,Rr[0]=1}et=0}}if(At=At[0],Wt=Wt[0],et!=0)return et;if(Mt=!!(2&Wt),!ot&&At)return 3;if(be!=null&&(be[0]=!!(16&Wt)),we!=null&&(we[0]=Mt),Se!=null&&(Se[0]=0),we=ke[0],Wt=Ze[0],At&&Mt&&Te==null){et=0;break}if(4>Z){et=7;break}if(ot&&At||!ot&&!At&&!r(T,Y[0],"ALPH")){Z=[Z],dt.na=[dt.na],dt.P=[dt.P],dt.Sa=[dt.Sa];e:{Or=T,et=Y,ot=Z;var Rr=dt.gb;rr=dt.na,qt=dt.P,Gr=dt.Sa,Mi=22,e(Or!=null),e(ot!=null),Xt=et[0];var dr=ot[0];for(e(rr!=null),e(Gr!=null),rr[0]=null,qt[0]=null,Gr[0]=0;;){if(et[0]=Xt,ot[0]=dr,8>dr){et=7;break e}var js=xt(Or,Xt+4);if(4294967286<js){et=3;break e}var hs=8+js+1&-2;if(Mi+=hs,0<Rr&&Mi>Rr){et=3;break e}if(!r(Or,Xt,"VP8 ")||!r(Or,Xt,"VP8L")){et=0;break e}if(dr[0]<hs){et=7;break e}r(Or,Xt,"ALPH")||(rr[0]=Or,qt[0]=Xt+8,Gr[0]=js),Xt+=hs,dr-=hs}}if(Z=Z[0],dt.na=dt.na[0],dt.P=dt.P[0],dt.Sa=dt.Sa[0],et!=0)break}Z=[Z],dt.Ja=[dt.Ja],dt.xa=[dt.xa];e:if(Rr=T,et=Y,ot=Z,rr=dt.gb[0],qt=dt.Ja,Gr=dt.xa,Or=et[0],Xt=!r(Rr,Or,"VP8 "),Mi=!r(Rr,Or,"VP8L"),e(Rr!=null),e(ot!=null),e(qt!=null),e(Gr!=null),8>ot[0])et=7;else{if(Xt||Mi){if(Rr=xt(Rr,Or+4),12<=rr&&Rr>rr-12){et=3;break e}if(It&&Rr>ot[0]-8){et=7;break e}qt[0]=Rr,et[0]+=8,ot[0]-=8,Gr[0]=Mi}else Gr[0]=5<=ot[0]&&Rr[Or+0]==47&&!(Rr[Or+4]>>5),qt[0]=ot[0];et=0}if(Z=Z[0],dt.Ja=dt.Ja[0],dt.xa=dt.xa[0],Y=Y[0],et!=0)break;if(4294967286<dt.Ja)return 3;if(Se==null||Mt||(Se[0]=dt.xa?2:1),we=[we],Wt=[Wt],dt.xa){if(5>Z){et=7;break}Se=we,It=Wt,Mt=be,T==null||5>Z?T=0:5<=Z&&T[Y+0]==47&&!(T[Y+4]>>5)?(ot=[0],Rr=[0],rr=[0],v(qt=new P,T,Y,Z),ai(qt,ot,Rr,rr)?(Se!=null&&(Se[0]=ot[0]),It!=null&&(It[0]=Rr[0]),Mt!=null&&(Mt[0]=rr[0]),T=1):T=0):T=0}else{if(10>Z){et=7;break}Se=Wt,T==null||10>Z||!dl(T,Y+3,Z-3)?T=0:(It=T[Y+0]|T[Y+1]<<8|T[Y+2]<<16,Mt=16383&(T[Y+7]<<8|T[Y+6]),T=16383&(T[Y+9]<<8|T[Y+8]),1&It||3<(It>>1&7)||!(It>>4&1)||It>>5>=dt.Ja||!Mt||!T?T=0:(we&&(we[0]=Mt),Se&&(Se[0]=T),T=1))}if(!T||(we=we[0],Wt=Wt[0],At&&(ke[0]!=we||Ze[0]!=Wt)))return 3;Te!=null&&(Te[0]=dt,Te.offset=Y-Te.w,e(4294967286>Y-Te.w),e(Te.offset==Te.ha-Z));break}return et==0||et==7&&At&&Te==null?(be!=null&&(be[0]|=dt.na!=null&&0<dt.na.length),le!=null&&(le[0]=we),pe!=null&&(pe[0]=Wt),0):et}function Nu(T,Y,Z){var le=Y.width,pe=Y.height,be=0,we=0,Se=le,Te=pe;if(Y.Da=T!=null&&0<T.Da,Y.Da&&(Se=T.cd,Te=T.bd,be=T.v,we=T.j,11>Z||(be&=-2,we&=-2),0>be||0>we||0>=Se||0>=Te||be+Se>le||we+Te>pe))return 0;if(Y.v=be,Y.j=we,Y.va=be+Se,Y.o=we+Te,Y.U=Se,Y.T=Te,Y.da=T!=null&&0<T.da,Y.da){if(!ft(Se,Te,Z=[T.ib],be=[T.hb]))return 0;Y.ib=Z[0],Y.hb=be[0]}return Y.ob=T!=null&&T.ob,Y.Kb=T==null||!T.Sd,Y.da&&(Y.ob=Y.ib<3*le/4&&Y.hb<3*pe/4,Y.Kb=0),1}function Dd(T){if(T==null)return 2;if(11>T.S){var Y=T.f.RGBA;Y.fb+=(T.height-1)*Y.A,Y.A=-Y.A}else Y=T.f.kb,T=T.height,Y.O+=(T-1)*Y.fa,Y.fa=-Y.fa,Y.N+=(T-1>>1)*Y.Ab,Y.Ab=-Y.Ab,Y.W+=(T-1>>1)*Y.Db,Y.Db=-Y.Db,Y.F!=null&&(Y.J+=(T-1)*Y.lb,Y.lb=-Y.lb);return 0}function ns(T,Y,Z,le){if(le==null||0>=T||0>=Y)return 2;if(Z!=null){if(Z.Da){var pe=Z.cd,be=Z.bd,we=-2&Z.v,Se=-2&Z.j;if(0>we||0>Se||0>=pe||0>=be||we+pe>T||Se+be>Y)return 2;T=pe,Y=be}if(Z.da){if(!ft(T,Y,pe=[Z.ib],be=[Z.hb]))return 2;T=pe[0],Y=be[0]}}le.width=T,le.height=Y;e:{var Te=le.width,ke=le.height;if(T=le.S,0>=Te||0>=ke||!(T>=xf&&13>T))T=2;else{if(0>=le.Rd&&le.sd==null){we=be=pe=Y=0;var Ze=(Se=Te*n0[T])*ke;if(11>T||(be=(ke+1)/2*(Y=(Te+1)/2),T==12&&(we=(pe=Te)*ke)),(ke=s(Ze+2*be+we))==null){T=1;break e}le.sd=ke,11>T?((Te=le.f.RGBA).eb=ke,Te.fb=0,Te.A=Se,Te.size=Ze):((Te=le.f.kb).y=ke,Te.O=0,Te.fa=Se,Te.Fd=Ze,Te.f=ke,Te.N=0+Ze,Te.Ab=Y,Te.Cd=be,Te.ea=ke,Te.W=0+Ze+be,Te.Db=Y,Te.Ed=be,T==12&&(Te.F=ke,Te.J=0+Ze+2*be),Te.Tc=we,Te.lb=pe)}if(Y=1,pe=le.S,be=le.width,we=le.height,pe>=xf&&13>pe)if(11>pe)T=le.f.RGBA,Y&=(Se=Math.abs(T.A))*(we-1)+be<=T.size,Y&=Se>=be*n0[pe],Y&=T.eb!=null;else{T=le.f.kb,Se=(be+1)/2,Ze=(we+1)/2,Te=Math.abs(T.fa),ke=Math.abs(T.Ab);var At=Math.abs(T.Db),It=Math.abs(T.lb),dt=It*(we-1)+be;Y&=Te*(we-1)+be<=T.Fd,Y&=ke*(Ze-1)+Se<=T.Cd,Y=(Y&=At*(Ze-1)+Se<=T.Ed)&Te>=be&ke>=Se&At>=Se,Y&=T.y!=null,Y&=T.f!=null,Y&=T.ea!=null,pe==12&&(Y&=It>=be,Y&=dt<=T.Tc,Y&=T.F!=null)}else Y=0;T=Y?0:2}}return T!=0||Z!=null&&Z.fd&&(T=Dd(le)),T}var to=64,_d=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],xc=24,pA=32,Ru=8,Yo=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Yt("Predictor0","PredictorAdd0"),C.Predictor0=function(){return 4278190080},C.Predictor1=function(T){return T},C.Predictor2=function(T,Y,Z){return Y[Z+0]},C.Predictor3=function(T,Y,Z){return Y[Z+1]},C.Predictor4=function(T,Y,Z){return Y[Z-1]},C.Predictor5=function(T,Y,Z){return kt(kt(T,Y[Z+1]),Y[Z+0])},C.Predictor6=function(T,Y,Z){return kt(T,Y[Z-1])},C.Predictor7=function(T,Y,Z){return kt(T,Y[Z+0])},C.Predictor8=function(T,Y,Z){return kt(Y[Z-1],Y[Z+0])},C.Predictor9=function(T,Y,Z){return kt(Y[Z+0],Y[Z+1])},C.Predictor10=function(T,Y,Z){return kt(kt(T,Y[Z-1]),kt(Y[Z+0],Y[Z+1]))},C.Predictor11=function(T,Y,Z){var le=Y[Z+0];return 0>=_r(le>>24&255,T>>24&255,(Y=Y[Z-1])>>24&255)+_r(le>>16&255,T>>16&255,Y>>16&255)+_r(le>>8&255,T>>8&255,Y>>8&255)+_r(255&le,255&T,255&Y)?le:T},C.Predictor12=function(T,Y,Z){var le=Y[Z+0];return(sr((T>>24&255)+(le>>24&255)-((Y=Y[Z-1])>>24&255))<<24|sr((T>>16&255)+(le>>16&255)-(Y>>16&255))<<16|sr((T>>8&255)+(le>>8&255)-(Y>>8&255))<<8|sr((255&T)+(255&le)-(255&Y)))>>>0},C.Predictor13=function(T,Y,Z){var le=Y[Z-1];return(Pt((T=kt(T,Y[Z+0]))>>24&255,le>>24&255)<<24|Pt(T>>16&255,le>>16&255)<<16|Pt(T>>8&255,le>>8&255)<<8|Pt(T>>0&255,le>>0&255))>>>0};var yf=C.PredictorAdd0;C.PredictorAdd1=Lt,Yt("Predictor2","PredictorAdd2"),Yt("Predictor3","PredictorAdd3"),Yt("Predictor4","PredictorAdd4"),Yt("Predictor5","PredictorAdd5"),Yt("Predictor6","PredictorAdd6"),Yt("Predictor7","PredictorAdd7"),Yt("Predictor8","PredictorAdd8"),Yt("Predictor9","PredictorAdd9"),Yt("Predictor10","PredictorAdd10"),Yt("Predictor11","PredictorAdd11"),Yt("Predictor12","PredictorAdd12"),Yt("Predictor13","PredictorAdd13");var Vo=C.PredictorAdd2;O("ColorIndexInverseTransform","MapARGB","32b",(function(T){return T>>8&255}),(function(T){return T})),O("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",(function(T){return T}),(function(T){return T>>8&255}));var mh,ro=C.ColorIndexInverseTransform,Oa=C.MapARGB,Mu=C.VP8LColorIndexInverseTransformAlpha,t0=C.MapAlpha,gh=C.VP8LPredictorsAdd=[];gh.length=16,(C.VP8LPredictors=[]).length=16,(C.VP8LPredictorsAdd_C=[]).length=16,(C.VP8LPredictors_C=[]).length=16;var rc,Me,Ke,mt,Tt,Ut,fr,Br,Zr,Pr,Gi,qr,Di,an,mi,Pn,jo,ks,io,Ln,ss,On,Qo,mA,bf,r0,_m,cI,uI=s(511),Qb=s(2041),hI=s(225),Iw=s(767),dI=0,Bw=Qb,zb=hI,yh=Iw,kh=uI,xf=0,Xb=1,AI=2,Pm=3,qb=4,Dw=5,fI=6,_w=7,i0=8,Wb=9,Pw=10,j3=[2,3,7],Q3=[3,3,11],Vy=[280,256,256,256,40],z3=[0,1,1,1,0],X3=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],q3=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],W3=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Kb=8,Lw=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Ow=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],jy=null,K3=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],J3=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],pI=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],$3=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Z3=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],eN=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],tN=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Pd=[],Ld=[],Ef=[],mI=1,gI=2,Sp=[],ku=[];_t("UpsampleRgbLinePair",Vi,3),_t("UpsampleBgrLinePair",gi,3),_t("UpsampleRgbaLinePair",po,4),_t("UpsampleBgraLinePair",cs,4),_t("UpsampleArgbLinePair",Ea,4),_t("UpsampleRgba4444LinePair",La,2),_t("UpsampleRgb565LinePair",$n,2);var Jb=C.UpsampleRgbLinePair,rN=C.UpsampleBgrLinePair,yI=C.UpsampleRgbaLinePair,bI=C.UpsampleBgraLinePair,xI=C.UpsampleArgbLinePair,EI=C.UpsampleRgba4444LinePair,iN=C.UpsampleRgb565LinePair,Lm=16,$b=1<<Lm-1,Qy=-227,Nw=482,wI=6,nN=(256<<wI)-1,vI=0,sN=s(256),aN=s(256),oN=s(256),lN=s(256),cN=s(Nw-Qy),uN=s(Nw-Qy);Ll("YuvToRgbRow",Vi,3),Ll("YuvToBgrRow",gi,3),Ll("YuvToRgbaRow",po,4),Ll("YuvToBgraRow",cs,4),Ll("YuvToArgbRow",Ea,4),Ll("YuvToRgba4444Row",La,2),Ll("YuvToRgb565Row",$n,2);var Rw=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Zb=[0,2,8],hN=[8,7,6,4,4,2,2,2,1,1,1,1],dN=1;this.WebPDecodeRGBA=function(T,Y,Z,le,pe){var be=Xb,we=new at,Se=new lr;we.ba=Se,Se.S=be,Se.width=[Se.width],Se.height=[Se.height];var Te=Se.width,ke=Se.height,Ze=new yr;if(Ze==null||T==null)var At=2;else e(Ze!=null),At=Wc(T,Y,Z,Ze.width,Ze.height,Ze.Pd,Ze.Qd,Ze.format,null);if(At!=0?Te=0:(Te!=null&&(Te[0]=Ze.width[0]),ke!=null&&(ke[0]=Ze.height[0]),Te=1),Te){Se.width=Se.width[0],Se.height=Se.height[0],le!=null&&(le[0]=Se.width),pe!=null&&(pe[0]=Se.height);e:{if(le=new Pu,(pe=new Ot).data=T,pe.w=Y,pe.ha=Z,pe.kd=1,Y=[0],e(pe!=null),((T=Wc(pe.data,pe.w,pe.ha,null,null,null,Y,null,pe))==0||T==7)&&Y[0]&&(T=4),(Y=T)==0){if(e(we!=null),le.data=pe.data,le.w=pe.w+pe.offset,le.ha=pe.ha-pe.offset,le.put=Dn,le.ac=sn,le.bc=Za,le.ma=we,pe.xa){if((T=ul())==null){we=1;break e}if((function(It,dt){var Wt=[0],Mt=[0],et=[0];t:for(;;){if(It==null)return 0;if(dt==null)return It.a=2,0;if(It.l=dt,It.a=0,v(It.m,dt.data,dt.w,dt.ha),!ai(It.m,Wt,Mt,et)){It.a=3;break t}if(It.xb=gI,dt.width=Wt[0],dt.height=Mt[0],!hl(Wt[0],Mt[0],1,It,null))break t;return 1}return e(It.a!=0),0})(T,le)){if(le=(Y=ns(le.width,le.height,we.Oa,we.ba))==0){t:{le=T;r:for(;;){if(le==null){le=0;break t}if(e(le.s.yc!=null),e(le.s.Ya!=null),e(0<le.s.Wb),e((Z=le.l)!=null),e((pe=Z.ma)!=null),le.xb!=0){if(le.ca=pe.ba,le.tb=pe.tb,e(le.ca!=null),!Nu(pe.Oa,Z,Pm)){le.a=2;break r}if(!Ms(le,Z.width)||Z.da)break r;if((Z.da||it(le.ca.S))&&Je(),11>le.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),le.ca.f.kb.F!=null&&Je()),le.Pb&&0<le.s.ua&&le.s.vb.X==null&&!Gt(le.s.vb,le.s.Wa.Xa)){le.a=1;break r}le.xb=0}if(!Qc(le,le.V,le.Ba,le.c,le.i,Z.o,Su))break r;pe.Dc=le.Ma,le=1;break t}e(le.a!=0),le=0}le=!le}le&&(Y=T.a)}else Y=T.a}else{if((T=new hh)==null){we=1;break e}if(T.Fa=pe.na,T.P=pe.P,T.qc=pe.Sa,zc(T,le)){if((Y=ns(le.width,le.height,we.Oa,we.ba))==0){if(T.Aa=0,Z=we.Oa,e((pe=T)!=null),Z!=null){if(0<(Te=0>(Te=Z.Md)?0:100<Te?255:255*Te/100)){for(ke=Ze=0;4>ke;++ke)12>(At=pe.pb[ke]).lc&&(At.ia=Te*hN[0>At.lc?0:At.lc]>>3),Ze|=At.ia;Ze&&(alert("todo:VP8InitRandom"),pe.ia=1)}pe.Ga=Z.Id,100<pe.Ga?pe.Ga=100:0>pe.Ga&&(pe.Ga=0)}za(T,le)||(Y=T.a)}}else Y=T.a}Y==0&&we.Oa!=null&&we.Oa.fd&&(Y=Dd(we.ba))}we=Y}be=we!=0?null:11>be?Se.f.RGBA.eb:Se.f.kb.y}else be=null;return be};var n0=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(C,G){for(var U="",_=0;_<4;_++)U+=String.fromCharCode(C[G++]);return U}function u(C,G){return(C[G+0]<<0|C[G+1]<<8|C[G+2]<<16)>>>0}function d(C,G){return(C[G+0]<<0|C[G+1]<<8|C[G+2]<<16|C[G+3]<<24)>>>0}new l;var A=[0],h=[0],f=[],p=new l,m=t,y=(function(C,G){var U={},_=0,H=!1,Q=0,j=0;if(U.frames=[],!(function(z,W,oe,Ae){for(var me=0;me<Ae;me++)if(z[W+me]!=oe.charCodeAt(me))return!0;return!1})(C,G,"RIFF",4)){var $,B;for(d(C,G+=4),G+=8;G<C.length;){var M=c(C,G),v=d(C,G+=4);G+=4;var N=v+(1&v);switch(M){case"VP8 ":case"VP8L":U.frames[_]===void 0&&(U.frames[_]={}),(P=U.frames[_]).src_off=H?j:G-8,P.src_size=Q+v+8,_++,H&&(H=!1,Q=0,j=0);break;case"VP8X":(P=U.header={}).feature_flags=C[G];var R=G+4;P.canvas_width=1+u(C,R),R+=3,P.canvas_height=1+u(C,R),R+=3;break;case"ALPH":H=!0,Q=N+8,j=G-8;break;case"ANIM":(P=U.header).bgcolor=d(C,G),R=G+4,P.loop_count=($=C)[(B=R)+0]<<0|$[B+1]<<8,R+=2;break;case"ANMF":var q,P;(P=U.frames[_]={}).offset_x=2*u(C,G),G+=3,P.offset_y=2*u(C,G),G+=3,P.width=1+u(C,G),G+=3,P.height=1+u(C,G),G+=3,P.duration=u(C,G),G+=3,q=C[G++],P.dispose=1&q,P.blend=q>>1&1}M!="ANMF"&&(G+=N)}return U}})(m,0);y.response=m,y.rgbaoutput=!0,y.dataurl=!1;var g=y.header?y.header:null,b=y.frames?y.frames:null;if(g){g.loop_counter=g.loop_count,A=[g.canvas_height],h=[g.canvas_width];for(var E=0;E<b.length&&b[E].blend!=0;E++);}var w=b[0],x=p.WebPDecodeRGBA(m,w.src_off,w.src_size,h,A);w.rgba=x,w.imgwidth=h[0],w.imgheight=A[0];for(var I=0;I<h[0]*A[0]*4;I++)f[I]=x[I];return this.width=h,this.height=A,this.data=f,this}(function(t){var e=function(){return typeof YO=="function"},r=function(A,h,f,p){var m=4,y=a;switch(p){case t.image_compression.FAST:m=1,y=s;break;case t.image_compression.MEDIUM:m=6,y=o;break;case t.image_compression.SLOW:m=9,y=l}A=i(A,h,f,y);var g=YO(A,{level:m});return t.__addimage__.arrayBufferToBinaryString(g)},i=function(A,h,f,p){for(var m,y,g,b=A.length/h,E=new Uint8Array(A.length+b),w=u(),x=0;x<b;x+=1){if(g=x*h,m=A.subarray(g,g+h),p)E.set(p(m,f,y),g+x);else{for(var I,C=w.length,G=[];I<C;I+=1)G[I]=w[I](m,f,y);var U=d(G.concat());E.set(G[U],g+x)}y=m}return E},n=function(A){var h=Array.apply([],A);return h.unshift(0),h},s=function(A,h){var f,p=[],m=A.length;p[0]=1;for(var y=0;y<m;y+=1)f=A[y-h]||0,p[y+1]=A[y]-f+256&255;return p},a=function(A,h,f){var p,m=[],y=A.length;m[0]=2;for(var g=0;g<y;g+=1)p=f&&f[g]||0,m[g+1]=A[g]-p+256&255;return m},o=function(A,h,f){var p,m,y=[],g=A.length;y[0]=3;for(var b=0;b<g;b+=1)p=A[b-h]||0,m=f&&f[b]||0,y[b+1]=A[b]+256-(p+m>>>1)&255;return y},l=function(A,h,f){var p,m,y,g,b=[],E=A.length;b[0]=4;for(var w=0;w<E;w+=1)p=A[w-h]||0,m=f&&f[w]||0,y=f&&f[w-h]||0,g=c(p,m,y),b[w+1]=A[w]-g+256&255;return b},c=function(A,h,f){if(A===h&&h===f)return A;var p=Math.abs(h-f),m=Math.abs(A-f),y=Math.abs(A+h-f-f);return p<=m&&p<=y?A:m<=y?h:f},u=function(){return[n,s,a,o,l]},d=function(A){var h=A.map((function(f){return f.reduce((function(p,m){return p+Math.abs(m)}),0)}));return h.indexOf(Math.min.apply(null,h))};t.processPNG=function(A,h,f,p){var m,y,g,b,E,w,x,I,C,G,U,_,H,Q,j,$=this.decode.FLATE_DECODE,B="";if(this.__addimage__.isArrayBuffer(A)&&(A=new Uint8Array(A)),this.__addimage__.isArrayBufferView(A)){if(A=(g=new KMe(A)).imgData,y=g.bits,m=g.colorSpace,E=g.colors,[4,6].indexOf(g.colorType)!==-1){if(g.bits===8){C=(I=g.pixelBitlength==32?new Uint32Array(g.decodePixels().buffer):g.pixelBitlength==16?new Uint16Array(g.decodePixels().buffer):new Uint8Array(g.decodePixels().buffer)).length,U=new Uint8Array(C*g.colors),G=new Uint8Array(C);var M,v=g.pixelBitlength-g.bits;for(Q=0,j=0;Q<C;Q++){for(H=I[Q],M=0;M<v;)U[j++]=H>>>M&255,M+=g.bits;G[Q]=H>>>M&255}}if(g.bits===16){C=(I=new Uint32Array(g.decodePixels().buffer)).length,U=new Uint8Array(C*(32/g.pixelBitlength)*g.colors),G=new Uint8Array(C*(32/g.pixelBitlength)),_=g.colors>1,Q=0,j=0;for(var N=0;Q<C;)H=I[Q++],U[j++]=H>>>0&255,_&&(U[j++]=H>>>16&255,H=I[Q++],U[j++]=H>>>0&255),G[N++]=H>>>16&255;y=8}p!==t.image_compression.NONE&&e()?(A=r(U,g.width*g.colors,g.colors,p),x=r(G,g.width,1,p)):(A=U,x=G,$=void 0)}if(g.colorType===3&&(m=this.color_spaces.INDEXED,w=g.palette,g.transparency.indexed)){var R=g.transparency.indexed,q=0;for(Q=0,C=R.length;Q<C;++Q)q+=R[Q];if((q/=255)===C-1&&R.indexOf(0)!==-1)b=[R.indexOf(0)];else if(q!==C){for(I=g.decodePixels(),G=new Uint8Array(I.length),Q=0,C=I.length;Q<C;Q++)G[Q]=R[I[Q]];x=r(G,g.width,1)}}var P=(function(z){var W;switch(z){case t.image_compression.FAST:W=11;break;case t.image_compression.MEDIUM:W=13;break;case t.image_compression.SLOW:W=14;break;default:W=12}return W})(p);return $===this.decode.FLATE_DECODE&&(B="/Predictor "+P+" "),B+="/Colors "+E+" /BitsPerComponent "+y+" /Columns "+g.width,(this.__addimage__.isArrayBuffer(A)||this.__addimage__.isArrayBufferView(A))&&(A=this.__addimage__.arrayBufferToBinaryString(A)),(x&&this.__addimage__.isArrayBuffer(x)||this.__addimage__.isArrayBufferView(x))&&(x=this.__addimage__.arrayBufferToBinaryString(x)),{alias:f,data:A,index:h,filter:$,decodeParameters:B,transparency:b,palette:w,sMask:x,predictor:P,width:g.width,height:g.height,bitsPerComponent:y,colorSpace:m}}}})(ji.API),(function(t){t.processGIF89A=function(e,r,i,n){var s=new JMe(e),a=s.width,o=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:a,height:o},u=new oU(100).encode(c,100);return t.processJPEG.call(this,u,r,i,n)},t.processGIF87A=t.processGIF89A})(ji.API),xp.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:n,green:i,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},xp.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Qa.log("bit decode error:"+r)}},xp.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,n=0;n<e;n++)for(var s=this.datav.getUint8(this.pos++,!0),a=i*this.width*4+8*n*4,o=0;o<8&&8*n+o<this.width;o++){var l=this.palette[s>>7-o&1];this.data[a+4*o]=l.blue,this.data[a+4*o+1]=l.green,this.data[a+4*o+2]=l.red,this.data[a+4*o+3]=255}r!==0&&(this.pos+=4-r)}},xp.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,n=0;n<t;n++){var s=this.datav.getUint8(this.pos++,!0),a=i*this.width*4+2*n*4,o=s>>4,l=15&s,c=this.palette[o];if(this.data[a]=c.blue,this.data[a+1]=c.green,this.data[a+2]=c.red,this.data[a+3]=255,2*n+1>=this.width)break;c=this.palette[l],this.data[a+4]=c.blue,this.data[a+4+1]=c.green,this.data[a+4+2]=c.red,this.data[a+4+3]=255}e!==0&&(this.pos+=4-e)}},xp.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,i=0;i<this.width;i++){var n=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*i;if(n<this.palette.length){var a=this.palette[n];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}t!==0&&(this.pos+=4-t)}},xp.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,o=(s>>5&e)/e*255|0,l=(s>>10&e)/e*255|0,c=s>>15?255:0,u=i*this.width*4+4*n;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=a,this.data[u+3]=c}this.pos+=t}},xp.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var n=this.bottom_up?i:this.height-1-i,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&r)/r*255|0,c=(a>>11)/e*255|0,u=n*this.width*4+4*s;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=t}},xp.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*r;this.data[a]=s,this.data[a+1]=n,this.data[a+2]=i,this.data[a+3]=255}this.pos+=this.width%4}},xp.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=s,this.data[o+1]=n,this.data[o+2]=i,this.data[o+3]=a}},xp.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(e,r,i,n){var s=new xp(e,!1),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},c=new oU(100).encode(l,100);return t.processJPEG.call(this,c,r,i,n)}})(ji.API),Qse.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(e,r,i,n){var s=new Qse(e,!1),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},c=new oU(100).encode(l,100);return t.processJPEG.call(this,c,r,i,n)}})(ji.API),ji.API.processRGBA=function(t,e,r){for(var i=t.data,n=i.length,s=new Uint8Array(n/4*3),a=new Uint8Array(n/4),o=0,l=0,c=0;c<n;c+=4){var u=i[c],d=i[c+1],A=i[c+2],h=i[c+3];s[o++]=u,s[o++]=d,s[o++]=A,a[l++]=h}var f=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:f,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},ji.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")})),this.internal.languageSettings.isSubscribed=!0)),this},bw=ji.API,L3=bw.getCharWidthsArray=function(t,e){var r,i,n=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),a=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:n.metadata.Unicode.widths,l=o.fof?o.fof:1,c=e.kerning?e.kerning:n.metadata.Unicode.kerning,u=c.fof?c.fof:1,d=e.doKerning!==!1,A=0,h=t.length,f=0,p=o[0]||l,m=[];for(r=0;r<h;r++)i=t.charCodeAt(r),typeof n.metadata.widthOfString=="function"?m.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(i))+a*(1e3/s)||0)/1e3):(A=d&&ys(c[i])==="object"&&!isNaN(parseInt(c[i][f],10))?c[i][f]/u:0,m.push((o[i]||p)/l+A)),f=i;return m},Gse=bw.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),i=e.font||this.internal.getFont(),n=e.charSpace||this.internal.getCharSpace();return bw.processArabic&&(t=bw.processArabic(t)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(t,r,n)/r:L3.apply(this,arguments).reduce((function(s,a){return s+a}),0)},Yse=function(t,e,r,i){for(var n=[],s=0,a=t.length,o=0;s!==a&&o+e[s]<r;)o+=e[s],s++;n.push(t.slice(0,s));var l=s;for(o=0;s!==a;)o+e[s]>i&&(n.push(t.slice(l,s)),o=0,l=s),o+=e[s],s++;return l!==s&&n.push(t.slice(l,s)),n},Vse=function(t,e,r){r||(r={});var i,n,s,a,o,l,c,u=[],d=[u],A=r.textIndent||0,h=0,f=0,p=t.split(" "),m=L3.apply(this,[" ",r])[0];if(l=r.lineIndent===-1?p[0].length+2:r.lineIndent||0){var y=Array(l).join(" "),g=[];p.map((function(E){(E=E.split(/\s*\n/)).length>1?g=g.concat(E.map((function(w,x){return(x&&w.length?`
`:"")+w}))):g.push(E[0])})),p=g,l=Gse.apply(this,[y,r])}for(s=0,a=p.length;s<a;s++){var b=0;if(i=p[s],l&&i[0]==`
`&&(i=i.substr(1),b=1),A+h+(f=(n=L3.apply(this,[i,r])).reduce((function(E,w){return E+w}),0))>e||b){if(f>e){for(o=Yse.apply(this,[i,n,e-(A+h),e]),u.push(o.shift()),u=[o.pop()];o.length;)d.push([o.shift()]);f=n.slice(i.length-(u[0]?u[0].length:0)).reduce((function(E,w){return E+w}),0)}else u=[i];d.push(u),A=f+l,h=m}else u.push(i),A+=h+f,h=m}return c=l?function(E,w){return(w?y:"")+E.join(" ")}:function(E){return E.join(" ")},d.map(c)},bw.splitTextToSize=function(t,e,r){var i,n=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var d=this.internal.getFont(u.fontName,u.fontStyle);return d.metadata.Unicode?{widths:d.metadata.Unicode.widths||{0:1},kerning:d.metadata.Unicode.kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);i=Array.isArray(t)?t:String(t).split(/\r?\n/);var a=1*this.internal.scaleFactor*e/n;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,s.lineIndent=r.lineIndent;var o,l,c=[];for(o=0,l=i.length;o<l;o++)c=c.concat(Vse.apply(this,[i[o],a,s]));return c},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",r={},i={},n=0;n<e.length;n++)r[e[n]]="0123456789abcdef"[n],i["0123456789abcdef"[n]]=e[n];var s=function(d){return"0x"+parseInt(d,10).toString(16)},a=t.__fontmetrics__.compress=function(d){var A,h,f,p,m=["{"];for(var y in d){if(A=d[y],isNaN(parseInt(y,10))?h="'"+y+"'":(y=parseInt(y,10),h=(h=s(y).slice(2)).slice(0,-1)+i[h.slice(-1)]),typeof A=="number")A<0?(f=s(A).slice(3),p="-"):(f=s(A).slice(2),p=""),f=p+f.slice(0,-1)+i[f.slice(-1)];else{if(ys(A)!=="object")throw new Error("Don't know what to do with value type "+ys(A)+".");f=a(A)}m.push(h+f)}return m.push("}"),m.join("")},o=t.__fontmetrics__.uncompress=function(d){if(typeof d!="string")throw new Error("Invalid argument passed to uncompress.");for(var A,h,f,p,m={},y=1,g=m,b=[],E="",w="",x=d.length-1,I=1;I<x;I+=1)(p=d[I])=="'"?A?(f=A.join(""),A=void 0):A=[]:A?A.push(p):p=="{"?(b.push([g,f]),g={},f=void 0):p=="}"?((h=b.pop())[0][h[1]]=g,f=void 0,g=h[0]):p=="-"?y=-1:f===void 0?r.hasOwnProperty(p)?(E+=r[p],f=parseInt(E,16)*y,y=1,E=""):E+=p:r.hasOwnProperty(p)?(w+=r[p],g[f]=parseInt(w,16)*y,y=1,f=void 0,w=""):w+=p;return m},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},u={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(d){var A=d.font,h=u.Unicode[A.postScriptName];h&&(A.metadata.Unicode={},A.metadata.Unicode.widths=h.widths,A.metadata.Unicode.kerning=h.kerning);var f=c.Unicode[A.postScriptName];f&&(A.metadata.Unicode.encoding=f,A.encoding=f.codePages[0])}])})(ji.API),(function(t){var e=function(r){for(var i=r.length,n=new Uint8Array(i),s=0;s<i;s++)n[s]=r.charCodeAt(s);return n};t.API.events.push(["addFont",function(r){var i=void 0,n=r.font,s=r.instance;if(!n.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(i=s.existsFileInVFS(n.postScriptName)===!1?s.loadFile(n.postScriptName):s.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e(lI(o)),a.metadata=t.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(n,i)}}])})(ji),(function(t){function e(){return(Ki.canvg?Promise.resolve(Ki.canvg):Promise.resolve().then(()=>(Dse(),Bse))).catch((function(r){return Promise.reject(new Error("Could not load canvg: "+r))})).then((function(r){return r.default?r.default:r}))}ji.API.addSvgAsImage=function(r,i,n,s,a,o,l,c){if(isNaN(i)||isNaN(n))throw Qa.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(a))throw Qa.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=s,u.height=a;var d=u.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,u.width,u.height);var A={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return e().then((function(f){return f.fromString(d,r,A)}),(function(){return Promise.reject(new Error("Could not load canvg."))})).then((function(f){return f.render(A)})).then((function(){h.addImage(u.toDataURL("image/jpeg",1),i,n,s,a,l,c)}))}})(),ji.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var n=0;n<this.internal.pages[i].length;n++)this.internal.pages[i][n]=this.internal.pages[i][n].replace(e,r);return this},ji.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var i,n,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),l=[],c=0,u=0,d=0;function A(f,p){var m,y=!1;for(m=0;m<f.length;m+=1)f[m]===p&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var h=o.length;for(d=0;d<h;d+=1)r[o[d]].value=r[o[d]].defaultValue,r[o[d]].explicitSet=!1}if(ys(t)==="object"){for(n in t)if(s=t[n],A(o,n)&&s!==void 0){if(r[n].type==="boolean"&&typeof s=="boolean")r[n].value=s;else if(r[n].type==="name"&&A(r[n].valueSet,s))r[n].value=s;else if(r[n].type==="integer"&&Number.isInteger(s))r[n].value=s;else if(r[n].type==="array"){for(c=0;c<s.length;c+=1)if(i=!0,s[c].length===1&&typeof s[c][0]=="number")l.push(String(s[c]-1));else if(s[c].length>1){for(u=0;u<s[c].length;u+=1)typeof s[c][u]!="number"&&(i=!1);i===!0&&l.push([s[c][0]-1,s[c][1]-1].join(" "))}r[n].value="["+l.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){var f,p=[];for(f in r)r[f].explicitSet===!0&&(r[f].type==="name"?p.push("/"+f+" /"+r[f].value):p.push("/"+f+" "+r[f].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)})),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var e=function(){var i='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(i)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=s.length+a.length+o.length+n.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(n+s+a+o+l),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(i,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:i,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}})(ji.API),(function(t){var e=t.API,r=e.pdfEscape16=function(s,a){for(var o,l=a.metadata.Unicode.widths,c=["","0","00","000","0000"],u=[""],d=0,A=s.length;d<A;++d){if(o=a.metadata.characterToGlyph(s.charCodeAt(d)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=s.charCodeAt(d),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(c[4-o.length],o)}return u.join("")},i=function(s){var a,o,l,c,u,d,A;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],d=0,A=(o=Object.keys(s).sort((function(h,f){return h-f}))).length;d<A;d++)a=o[d],l.length>=100&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),s[a]!==void 0&&s[a]!==null&&typeof s[a].toString=="function"&&(c=("0000"+s[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),l.push("<"+a+"><"+c+">"));return l.length&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(a){var o=a.font,l=a.out,c=a.newObject,u=a.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="Identity-H"){for(var d=o.metadata.Unicode.widths,A=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),h="",f=0;f<A.length;f++)h+=String.fromCharCode(A[f]);var p=c();u({data:h,addLength1:!0,objectId:p}),l("endobj");var m=c();u({data:i(o.metadata.toUnicode),addLength1:!0,objectId:m}),l("endobj");var y=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Ew(o.fontName)),l("/FontFile2 "+p+" 0 R"),l("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var g=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+Ew(o.fontName)),l("/FontDescriptor "+y+" 0 R"),l("/W "+t.API.PDFObject.convert(d)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+m+" 0 R"),l("/BaseFont /"+Ew(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+g+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(a){var o=a.font,l=a.out,c=a.newObject,u=a.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var d=o.metadata.rawData,A="",h=0;h<d.length;h++)A+=String.fromCharCode(d[h]);var f=c();u({data:A,addLength1:!0,objectId:f}),l("endobj");var p=c();u({data:i(o.metadata.toUnicode),addLength1:!0,objectId:p}),l("endobj");var m=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+f+" 0 R"),l("/Flags 96"),l("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+Ew(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var y=0;y<o.metadata.hmtx.widths.length;y++)o.metadata.hmtx.widths[y]=parseInt(o.metadata.hmtx.widths[y]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+Ew(o.fontName)+"/FontDescriptor "+m+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(s)}]);var n=function(s){var a,o=s.text||"",l=s.x,c=s.y,u=s.options||{},d=s.mutex||{},A=d.pdfEscape,h=d.activeFontKey,f=d.fonts,p=h,m="",y=0,g="",b=f[p].encoding;if(f[p].encoding!=="Identity-H")return{text:o,x:l,y:c,options:u,mutex:d};for(g=o,p=h,Array.isArray(o)&&(g=o[0]),y=0;y<g.length;y+=1)f[p].metadata.hasOwnProperty("cmap")&&(a=f[p].metadata.cmap.unicode.codeMap[g[y].charCodeAt(0)]),a||g[y].charCodeAt(0)<256&&f[p].metadata.hasOwnProperty("Unicode")?m+=g[y]:m+="";var E="";return parseInt(p.slice(1))<14||b==="WinAnsiEncoding"?E=A(m,p).split("").map((function(w){return w.charCodeAt(0).toString(16)})).join(""):b==="Identity-H"&&(E=r(m,f[p])),d.isHex=!0,{text:E,x:l,y:c,options:u,mutex:d}};e.events.push(["postProcessText",function(s){var a=s.text||"",o=[],l={text:a,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(a)){var c=0;for(c=0;c<a.length;c+=1)Array.isArray(a[c])&&a[c].length===3?o.push([n(Object.assign({},l,{text:a[c][0]})).text,a[c][1],a[c][2]]):o.push(n(Object.assign({},l,{text:a[c]})).text);s.text=o}else s.text=n(Object.assign({},l,{text:a})).text}])})(ji),(function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,i){return e.call(this),this.internal.vFS[r]=i,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(ji.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(i){var n,s,a,o,l,c,u,d=e,A=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],f={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},m=["(",")","(","<",">","<","[","]","[","{","}","{","\xAB","\xBB","\xAB","\u2039","\u203A","\u2039","\u2045","\u2046","\u2045","\u207D","\u207E","\u207D","\u208D","\u208E","\u208D","\u2264","\u2265","\u2264","\u2329","\u232A","\u2329","\uFE59","\uFE5A","\uFE59","\uFE5B","\uFE5C","\uFE5B","\uFE5D","\uFE5E","\uFE5D","\uFE64","\uFE65","\uFE64"],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),g=!1,b=0;this.__bidiEngine__={};var E=function(_){var H=_.charCodeAt(),Q=H>>8,j=p[Q];return j!==void 0?d[256*j+(255&H)]:Q===252||Q===253?"AL":y.test(Q)?"L":Q===8?"R":"N"},w=function(_){for(var H,Q=0;Q<_.length;Q++){if((H=E(_.charAt(Q)))==="L")return!1;if(H==="R")return!0}return!1},x=function(_,H,Q,j){var $,B,M,v,N=H[j];switch(N){case"L":case"R":g=!1;break;case"N":case"AN":break;case"EN":g&&(N="AN");break;case"AL":g=!0,N="R";break;case"WS":N="N";break;case"CS":j<1||j+1>=H.length||($=Q[j-1])!=="EN"&&$!=="AN"||(B=H[j+1])!=="EN"&&B!=="AN"?N="N":g&&(B="AN"),N=B===$?B:"N";break;case"ES":N=($=j>0?Q[j-1]:"B")==="EN"&&j+1<H.length&&H[j+1]==="EN"?"EN":"N";break;case"ET":if(j>0&&Q[j-1]==="EN"){N="EN";break}if(g){N="N";break}for(M=j+1,v=H.length;M<v&&H[M]==="ET";)M++;N=M<v&&H[M]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(v=H.length,M=j+1;M<v&&H[M]==="NSM";)M++;if(M<v){var R=_[j],q=R>=1425&&R<=2303||R===64286;if($=H[M],q&&($==="R"||$==="AL")){N="R";break}}}N=j<1||($=H[j-1])==="B"?"N":Q[j-1];break;case"B":g=!1,n=!0,N=b;break;case"S":s=!0,N="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":g=!1;break;case"BN":N="N"}return N},I=function(_,H,Q){var j=_.split("");return Q&&C(j,Q,{hiLevel:b}),j.reverse(),H&&H.reverse(),j.join("")},C=function(_,H,Q){var j,$,B,M,v,N=-1,R=_.length,q=0,P=[],z=b?h:A,W=[];for(g=!1,n=!1,s=!1,$=0;$<R;$++)W[$]=E(_[$]);for(B=0;B<R;B++){if(v=q,P[B]=x(_,W,P,B),j=240&(q=z[v][f[P[B]]]),q&=15,H[B]=M=z[q][5],j>0)if(j===16){for($=N;$<B;$++)H[$]=1;N=-1}else N=-1;if(z[q][6])N===-1&&(N=B);else if(N>-1){for($=N;$<B;$++)H[$]=M;N=-1}W[B]==="B"&&(H[B]=0),Q.hiLevel|=M}s&&(function(oe,Ae,me){for(var ve=0;ve<me;ve++)if(oe[ve]==="S"){Ae[ve]=b;for(var Le=ve-1;Le>=0&&oe[Le]==="WS";Le--)Ae[Le]=b}})(W,H,R)},G=function(_,H,Q,j,$){if(!($.hiLevel<_)){if(_===1&&b===1&&!n)return H.reverse(),void(Q&&Q.reverse());for(var B,M,v,N,R=H.length,q=0;q<R;){if(j[q]>=_){for(v=q+1;v<R&&j[v]>=_;)v++;for(N=q,M=v-1;N<M;N++,M--)B=H[N],H[N]=H[M],H[M]=B,Q&&(B=Q[N],Q[N]=Q[M],Q[M]=B);q=v}q++}}},U=function(_,H,Q){var j=_.split(""),$={hiLevel:b};return Q||(Q=[]),C(j,Q,$),(function(B,M,v){if(v.hiLevel!==0&&u)for(var N,R=0;R<B.length;R++)M[R]===1&&(N=m.indexOf(B[R]))>=0&&(B[R]=m[N+1])})(j,Q,$),G(2,j,H,Q,$),G(1,j,H,Q,$),j.join("")};return this.__bidiEngine__.doBidiReorder=function(_,H,Q){if((function($,B){if(B)for(var M=0;M<$.length;M++)B[M]=M;o===void 0&&(o=w($)),c===void 0&&(c=w($))})(_,H),a||!l||c)if(a&&l&&o^c)b=o?1:0,_=I(_,H,Q);else if(!a&&l&&c)b=o?1:0,_=U(_,H,Q),_=I(_,H);else if(!a||o||l||c){if(a&&!l&&o^c)_=I(_,H),o?(b=0,_=U(_,H,Q)):(b=1,_=U(_,H,Q),_=I(_,H));else if(a&&o&&!l&&c)b=1,_=U(_,H,Q),_=I(_,H);else if(!a&&!l&&o^c){var j=u;o?(b=1,_=U(_,H,Q),b=0,u=!1,_=U(_,H,Q),u=j):(b=0,_=U(_,H,Q),_=I(_,H),b=1,u=!1,_=U(_,H,Q),u=j,_=I(_,H))}}else b=0,_=U(_,H,Q);else b=o?1:0,_=U(_,H,Q);return _},this.__bidiEngine__.setOptions=function(_){_&&(a=_.isInputVisual,l=_.isOutputVisual,o=_.isInputRtl,c=_.isOutputRtl,u=_.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(i){var n=i.text,s=(i.x,i.y,i.options||{}),a=(i.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(n)==="[object Array]"){var o=0;for(a=[],o=0;o<n.length;o+=1)Object.prototype.toString.call(n[o])==="[object Array]"?a.push([r.doBidiReorder(n[o][0]),n[o][1],n[o][2]]):a.push([r.doBidiReorder(n[o])]);i.text=a}else i.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])})(ji),ji.API.TTFFont=(function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Yy(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new d6e(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new $Me(this.contents),this.head=new e6e(this),this.name=new s6e(this),this.cmap=new iae(this),this.toUnicode={},this.hhea=new t6e(this),this.maxp=new a6e(this),this.hmtx=new o6e(this),this.post=new i6e(this),this.os2=new r6e(this),this.loca=new h6e(this),this.glyf=new l6e(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,i,n,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,l,c;for(c=[],a=0,o=(l=this.bbox).length;a<o;a++)e=l[a],c.push(Math.round(e*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(i=255&(n=this.post.italic_angle),(32768&(r=n>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,i){var n,s,a,o;for(a=0,s=0,o=(e=""+e).length;0<=o?s<o:s>o;s=0<=o?++s:--s)n=e.charCodeAt(s),a+=this.widthOfGlyph(this.characterToGlyph(n))+i*(1e3/r)||0;return a*(r/1e3)},t.prototype.lineHeight=function(e,r){var i;return r==null&&(r=!1),i=r?this.lineGap:0,(this.ascender+i-this.decender)/1e3*e},t})();var wp,Yy=(function(){function t(e){this.data=e!=null?e:[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,i;for(i=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)i[r]=String.fromCharCode(this.readByte());return i.join("")},t.prototype.writeString=function(e){var r,i,n;for(n=[],r=0,i=e.length;0<=i?r<i:r>i;r=0<=i?++r:--r)n.push(this.writeByte(e.charCodeAt(r)));return n},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,i,n,s,a,o,l;return e=this.readByte(),r=this.readByte(),i=this.readByte(),n=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^i)+4294967296*(255^n)+16777216*(255^s)+65536*(255^a)+256*(255^o)+(255^l)+1):72057594037927940*e+281474976710656*r+1099511627776*i+4294967296*n+16777216*s+65536*a+256*o+l},t.prototype.writeLongLong=function(e){var r,i;return r=Math.floor(e/4294967296),i=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,i;for(r=[],i=0;0<=e?i<e:i>e;i=0<=e?++i:--i)r.push(this.readByte());return r},t.prototype.write=function(e){var r,i,n,s;for(s=[],i=0,n=e.length;i<n;i++)r=e[i],s.push(this.writeByte(r));return s},t})(),$Me=(function(){var t;function e(r){var i,n,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,s=this.tableCount;0<=s?n<s:n>s;n=0<=s?++n:--n)i={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[i.tag]=i}return e.prototype.encode=function(r){var i,n,s,a,o,l,c,u,d,A,h,f,p;for(p in h=Object.keys(r).length,l=Math.log(2),d=16*Math.floor(Math.log(h)/l),a=Math.floor(d/l),u=16*h-d,(n=new Yy).writeInt(this.scalarType),n.writeShort(h),n.writeShort(d),n.writeShort(a),n.writeShort(u),s=16*h,c=n.pos+s,o=null,f=[],r)for(A=r[p],n.writeString(p),n.writeInt(t(A)),n.writeInt(c),n.writeInt(A.length),f=f.concat(A),p==="head"&&(o=c),c+=A.length;c%4;)f.push(0),c++;return n.write(f),i=2981146554-t(n.data),n.pos=o+8,n.writeUInt32(i),n.data},t=function(r){var i,n,s,a;for(r=nae.call(r);r.length%4;)r.push(0);for(s=new Yy(r),n=0,i=0,a=r.length;i<a;i=i+=4)n+=s.readUInt32();return 4294967295&n},e})(),ZMe={}.hasOwnProperty,Bm=function(t,e){for(var r in e)ZMe.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};wp=(function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var e6e=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bm(e,wp),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var i;return(i=new Yy).writeInt(this.version),i.writeInt(this.revision),i.writeInt(this.checkSumAdjustment),i.writeInt(this.magicNumber),i.writeShort(this.flags),i.writeShort(this.unitsPerEm),i.writeLongLong(this.created),i.writeLongLong(this.modified),i.writeShort(this.xMin),i.writeShort(this.yMin),i.writeShort(this.xMax),i.writeShort(this.yMax),i.writeShort(this.macStyle),i.writeShort(this.lowestRecPPEM),i.writeShort(this.fontDirectionHint),i.writeShort(r),i.writeShort(this.glyphDataFormat),i.data},e})(),zse=(function(){function t(e,r){var i,n,s,a,o,l,c,u,d,A,h,f,p,m,y,g,b;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(h=e.readUInt16(),A=h/2,e.pos+=6,s=(function(){var E,w;for(w=[],l=E=0;0<=A?E<A:E>A;l=0<=A?++E:--E)w.push(e.readUInt16());return w})(),e.pos+=2,p=(function(){var E,w;for(w=[],l=E=0;0<=A?E<A:E>A;l=0<=A?++E:--E)w.push(e.readUInt16());return w})(),c=(function(){var E,w;for(w=[],l=E=0;0<=A?E<A:E>A;l=0<=A?++E:--E)w.push(e.readUInt16());return w})(),u=(function(){var E,w;for(w=[],l=E=0;0<=A?E<A:E>A;l=0<=A?++E:--E)w.push(e.readUInt16());return w})(),n=(this.length-e.pos+this.offset)/2,o=(function(){var E,w;for(w=[],l=E=0;0<=n?E<n:E>n;l=0<=n?++E:--E)w.push(e.readUInt16());return w})(),l=y=0,b=s.length;y<b;l=++y)for(m=s[l],i=g=f=p[l];f<=m?g<=m:g>=m;i=f<=m?++g:--g)u[l]===0?a=i+c[l]:(a=o[u[l]/2+(i-f)-(A-l)]||0)!==0&&(a+=c[l]),this.codeMap[i]=65535&a}e.pos=d}return t.encode=function(e,r){var i,n,s,a,o,l,c,u,d,A,h,f,p,m,y,g,b,E,w,x,I,C,G,U,_,H,Q,j,$,B,M,v,N,R,q,P,z,W,oe,Ae,me,ve,Le,He,rt,qe;switch(j=new Yy,a=Object.keys(e).sort((function(xt,Gt){return xt-Gt})),r){case"macroman":for(p=0,m=(function(){var xt=[];for(f=0;f<256;++f)xt.push(0);return xt})(),g={0:0},s={},$=0,N=a.length;$<N;$++)g[Le=e[n=a[$]]]==null&&(g[Le]=++p),s[n]={old:e[n],new:g[e[n]]},m[n]=g[e[n]];return j.writeUInt16(1),j.writeUInt16(0),j.writeUInt32(12),j.writeUInt16(0),j.writeUInt16(262),j.writeUInt16(0),j.write(m),{charMap:s,subtable:j.data,maxGlyphID:p+1};case"unicode":for(H=[],d=[],b=0,g={},i={},y=c=null,B=0,R=a.length;B<R;B++)g[w=e[n=a[B]]]==null&&(g[w]=++b),i[n]={old:w,new:g[w]},o=g[w]-n,y!=null&&o===c||(y&&d.push(y),H.push(n),c=o),y=n;for(y&&d.push(y),d.push(65535),H.push(65535),U=2*(G=H.length),C=2*Math.pow(Math.log(G)/Math.LN2,2),A=Math.log(C/2)/Math.LN2,I=2*G-C,l=[],x=[],h=[],f=M=0,q=H.length;M<q;f=++M){if(_=H[f],u=d[f],_===65535){l.push(0),x.push(0);break}if(_-(Q=i[_].new)>=32768)for(l.push(0),x.push(2*(h.length+G-f)),n=v=_;_<=u?v<=u:v>=u;n=_<=u?++v:--v)h.push(i[n].new);else l.push(Q-_),x.push(0)}for(j.writeUInt16(3),j.writeUInt16(1),j.writeUInt32(12),j.writeUInt16(4),j.writeUInt16(16+8*G+2*h.length),j.writeUInt16(0),j.writeUInt16(U),j.writeUInt16(C),j.writeUInt16(A),j.writeUInt16(I),me=0,P=d.length;me<P;me++)n=d[me],j.writeUInt16(n);for(j.writeUInt16(0),ve=0,z=H.length;ve<z;ve++)n=H[ve],j.writeUInt16(n);for(He=0,W=l.length;He<W;He++)o=l[He],j.writeUInt16(o);for(rt=0,oe=x.length;rt<oe;rt++)E=x[rt],j.writeUInt16(E);for(qe=0,Ae=h.length;qe<Ae;qe++)p=h[qe],j.writeUInt16(p);return{charMap:i,subtable:j.data,maxGlyphID:b+1}}},t})(),iae=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bm(e,wp),e.prototype.tag="cmap",e.prototype.parse=function(r){var i,n,s;for(r.pos=this.offset,this.version=r.readUInt16(),s=r.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)i=new zse(r,this.offset),this.tables.push(i),i.isUnicode&&this.unicode==null&&(this.unicode=i);return!0},e.encode=function(r,i){var n,s;return i==null&&(i="macroman"),n=zse.encode(r,i),(s=new Yy).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},e})(),t6e=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bm(e,wp),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e})(),r6e=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bm(e,wp),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=(function(){var i,n;for(n=[],i=0;i<10;++i)n.push(r.readByte());return n})(),this.charRange=(function(){var i,n;for(n=[],i=0;i<4;++i)n.push(r.readInt());return n})(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=(function(){var i,n;for(n=[],i=0;i<2;i=++i)n.push(r.readInt());return n})(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e})(),i6e=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bm(e,wp),e.prototype.tag="post",e.prototype.parse=function(r){var i,n,s;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var a;for(n=r.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],s=[];r.pos<this.offset+this.length;)i=r.readByte(),s.push(this.names.push(r.readString(i)));return s;case 151552:return n=r.readUInt16(),this.offsets=r.read(n);case 196608:break;case 262144:return this.map=(function(){var o,l,c;for(c=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)c.push(r.readUInt32());return c}).call(this)}},e})(),n6e=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},s6e=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bm(e,wp),e.prototype.tag="name",e.prototype.parse=function(r){var i,n,s,a,o,l,c,u,d,A,h;for(r.pos=this.offset,r.readShort(),i=r.readShort(),l=r.readShort(),n=[],a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)n.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+l+r.readShort()});for(c={},a=d=0,A=n.length;d<A;a=++d)s=n[a],r.pos=s.offset,u=r.readString(s.length),o=new n6e(u,s),c[h=s.nameID]==null&&(c[h]=[]),c[s.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e})(),a6e=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bm(e,wp),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e})(),o6e=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bm(e,wp),e.prototype.tag="hmtx",e.prototype.parse=function(r){var i,n,s,a,o,l,c;for(r.pos=this.offset,this.metrics=[],i=0,l=this.file.hhea.numberOfMetrics;0<=l?i<l:i>l;i=0<=l?++i:--i)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var u,d;for(d=[],i=u=0;0<=s?u<s:u>s;i=0<=s?++u:--u)d.push(r.readInt16());return d})(),this.widths=(function(){var u,d,A,h;for(h=[],u=0,d=(A=this.metrics).length;u<d;u++)a=A[u],h.push(a.advance);return h}).call(this),n=this.widths[this.widths.length-1],c=[],i=o=0;0<=s?o<s:o>s;i=0<=s?++o:--o)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e})(),nae=[].slice,l6e=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bm(e,wp),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var i,n,s,a,o,l,c,u,d,A;return r in this.cache?this.cache[r]:(a=this.file.loca,i=this.file.contents,n=a.indexOf(r),(s=a.lengthOf(r))===0?this.cache[r]=null:(i.pos=this.offset+n,o=(l=new Yy(i.read(s))).readShort(),u=l.readShort(),A=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[r]=o===-1?new u6e(l,u,A,c,d):new c6e(l,o,u,A,c,d),this.cache[r]))},e.prototype.encode=function(r,i,n){var s,a,o,l,c;for(o=[],a=[],l=0,c=i.length;l<c;l++)s=r[i[l]],a.push(o.length),s&&(o=o.concat(s.encode(n)));return a.push(o.length),{table:o,offsets:a}},e})(),c6e=(function(){function t(e,r,i,n,s,a){this.raw=e,this.numberOfContours=r,this.xMin=i,this.yMin=n,this.xMax=s,this.yMax=a,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),u6e=(function(){function t(e,r,i,n,s){var a,o;for(this.raw=e,this.xMin=r,this.yMin=i,this.xMax=n,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return t.prototype.encode=function(){var e,r,i;for(r=new Yy(nae.call(this.raw.data)),e=0,i=this.glyphIDs.length;e<i;++e)r.pos=this.glyphOffsets[e];return r.data},t})(),h6e=(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return Bm(e,wp),e.prototype.tag="loca",e.prototype.parse=function(r){var i,n;return r.pos=this.offset,i=this.file.head.indexToLocFormat,this.offsets=i===0?(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=2)a.push(2*r.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=4)a.push(r.readUInt32());return a}).call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,i){for(var n=new Uint32Array(this.offsets.length),s=0,a=0,o=0;o<n.length;++o)if(n[o]=s,a<i.length&&i[a]==o){++a,n[o]=s;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(s+=c)}for(var u=new Array(4*n.length),d=0;d<n.length;++d)u[4*d+3]=255&n[d],u[4*d+2]=(65280&n[d])>>8,u[4*d+1]=(16711680&n[d])>>16,u[4*d]=(4278190080&n[d])>>24;return u},e})(),d6e=(function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,i,n,s;for(r in n=this.font.cmap.tables[0].codeMap,e={},s=this.subset)i=s[r],e[r]=n[i];return e},t.prototype.glyphsFor=function(e){var r,i,n,s,a,o,l;for(n={},a=0,o=e.length;a<o;a++)n[s=e[a]]=this.font.glyf.glyphFor(s);for(s in r=[],n)(i=n[s])!=null&&i.compound&&r.push.apply(r,i.glyphIDs);if(r.length>0)for(s in l=this.glyphsFor(r))i=l[s],n[s]=i;return n},t.prototype.encode=function(e,r){var i,n,s,a,o,l,c,u,d,A,h,f,p,m,y;for(n in i=iae.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(e),h={0:0},y=i.charMap)h[(l=y[n]).old]=l.new;for(f in A=i.maxGlyphID,a)f in h||(h[f]=A++);return u=(function(g){var b,E;for(b in E={},g)E[g[b]]=b;return E})(h),d=Object.keys(u).sort((function(g,b){return g-b})),p=(function(){var g,b,E;for(E=[],g=0,b=d.length;g<b;g++)o=d[g],E.push(u[o]);return E})(),s=this.font.glyf.encode(a,p,h),c=this.font.loca.encode(s.offsets,p),m={cmap:this.font.cmap.raw(),glyf:s.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(m["OS/2"]=this.font.os2.raw()),this.font.directory.encode(m)},t})();ji.API.PDFObject=(function(){var t;function e(){}return t=function(r,i){return(Array(i+1).join("0")+r).slice(-i)},e.convert=function(r){var i,n,s,a;if(Array.isArray(r))return"["+(function(){var o,l,c;for(c=[],o=0,l=r.length;o<l;o++)i=r[o],c.push(e.convert(i));return c})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in s=["<<"],r)a=r[n],s.push("/"+n+" "+e.convert(a));return s.push(">>"),s.join(`
`)}return""+r},e})();var Tw=ji;function sae(t){return _A}function aae(t){let e=t.context2d.lineWidth;return()=>{t.context2d.lineWidth=e}}var Cd=Tw.API;function oae(){g6e(),E6e(),f6e(),p6e(),m6e(),y6e(),b6e(),x6e(),C6e(),w6e(),v6e(),S6e(),T6e(),I6e()}function f6e(){Cd.panelEllipse=function(t){if(t.displayVisible===!1)return this;if(t.hide)return this;let e=this;return e.context2d.save(),H3(t,e)===_c||(e.panelSVGPath(t.d),t.displayFill&&t.fillColor!=="none"&&(e.context2d.fillStyle=t.fillColor,e.context2d.fill()),t.displayStroke&&t.strokeColor!=="none"&&(e.context2d.strokeStyle=t.strokeColor,e.context2d.lineWidth=t.strokeWidth,e.context2d.lineCap="round",e.context2d.stroke())),e.context2d.restore(),e}}function p6e(){Cd.panelRect=function(t){if(t.displayVisible===!1||t.hide)return;let e=this;e.saveGraphicsState();let r=aae(this);H3(t,e)===_c||((t.displayFill||t.displayStroke)&&this.panelSVGPath(t.d),t.displayFill&&(e.context2d.fillStyle=t.fillColor==="none"?"transparent":t.fillColor,e.context2d.fill()),t.displayStroke&&t.strokeWidth&&(e.context2d.strokeStyle=t.strokeColor,e.context2d.lineWidth=t.strokeWidth,e.context2d.stroke())),e.restoreGraphicsState(),r()}}function m6e(){Cd.panelImage=async function(t){if(t.displayVisible===!1||t.hide)return;let e=this;e.saveGraphicsState();let r=new this.Matrix(...t.matrix);e.setCurrentTransformationMatrix(r);let i=t.content;t.content.startsWith("data:image/svg+xml;")&&(i=await OC(t.content)),e.addImage({imageData:i,x:0,y:0,height:1,width:1}),e.restoreGraphicsState()}}function g6e(){Cd.panelSVGPath=function(t){let e=this,r=ZA(t),i=e.context2d,n=[0,0];e.context2d.beginPath();for(let s=0,a=r.length;s<a;s++){let o=r[s],l=o[0];switch(l){case"m":o[1]=+o[1]+n[0],o[2]=+o[2]+n[1],i.moveTo(o[1],o[2]),n=[o[1],o[2]];break;case"M":i.moveTo(o[1],o[2]),n=[o[1],o[2]];break;case"l":{let c=o[1]+n[0],u=o[2]+n[1];i.lineTo(c,u),n=[c,u]}break;case"L":{o.length%2===0&&Zn(o);let c=o.length;for(let u=1;u<c;u+=2){let d=o[u],A=o[u+1];i.lineTo(d,A),n=[d,A]}}break;case"h":o[1]=+o[1]+n[0],i.lineTo(o[1],n[1]),n=[o[1],n[1]];break;case"H":i.lineTo(o[1],n[1]),n=[o[1],n[1]];break;case"v":o[1]=+o[1]+n[1],i.lineTo(n[0],o[1]),n=[n[0],o[1]];break;case"V":i.lineTo(n[0],o[1]),n=[n[0],o[1]];break;case"Q":i.quadraticCurveTo(o[1],o[2],o[3],o[4]),n=[o[3],o[4]];break;case"c":o[1]=+o[1]+n[0],o[2]=+o[2]+n[1],o[3]=+o[3]+n[0],o[4]=+o[4]+n[1],o[5]=+o[5]+n[0],o[6]=+o[6]+n[1],i.bezierCurveTo(o[1],o[2],o[3],o[4],o[5],o[6]),n=[o[5],o[6]];break;case"C":i.bezierCurveTo(o[1],o[2],o[3],o[4],o[5],o[6]),n=[o[5],o[6]];break;case"A":{let c=o[1],u=mm({x1:n[0],y1:n[1],x2:c.x,y2:c.y,angle:c.arcAngle,sweep:c.arcSweep?1:0,large:c.arcLarge?1:0,rx:c.rx,ry:c.ry}),[d,...A]=ZA(u);for(let h of A)i.bezierCurveTo(h[1],h[2],h[3],h[4],h[5],h[6]);n=[c.x,c.y];break}case"Z":case"z":i.closePath();break;default:Zn(l);break}}}}function y6e(){Cd.panelGroup=function(t){if(t.displayVisible===!1)return this;if(t.hide)return this;let e=this;return e.saveGraphicsState(),H3(t,e)===_c||(this.panelSVGPath(t.d),t.displayFill&&t.fillColor!=="none"&&(e.context2d.fillStyle=t.fillColor,e.context2d.fill()),t.displayStroke&&t.strokeColor!=="none"&&(e.context2d.strokeStyle=t.strokeColor,e.context2d.lineWidth=t.strokeWidth,e.context2d.lineCap="round",e.context2d.stroke())),e.restoreGraphicsState(),e}}function b6e(){Cd.panelArc=function(t){return this.panelGroup(t)}}function x6e(){Cd.panelText=function(t){if(t.displayVisible===!1)return this;if(t.hide)return this;let e=this;e.saveGraphicsState();let r=new this.Matrix(...t.matrix);return e.setCurrentTransformationMatrix(r),H3(t,e)===_c||(this.panelSVGPath(t.d),e.context2d.fillStyle=t.strokeColor,e.context2d.fill()),e.restoreGraphicsState(),this}}function E6e(){Cd.panelFrame=function(t){let e=this;e.saveGraphicsState(),e.setDrawColor(255,0,0),this.panelSVGPath(t),e.context2d.lineWidth=0,e.context2d.stroke(),e.restoreGraphicsState()}}function w6e(){Cd.panelDimensionLength=function(t){if(t.displayVisible===!1)return;let e=this,r=new ya(t).getPath();e.saveGraphicsState(),this.panelSVGPath(r.line),e.context2d.lineWidth=0,e.context2d.stroke(),e.setCurrentTransformationMatrix(new this.Matrix(...nr.getMatrix6FromMatrix(r.text.m3))),e.setFontSize(16*e.internal.scaleFactor),e.text(r.text.textContent,0,0),e.restoreGraphicsState()}}function v6e(){Cd.panelDimensionAngle=function(t){if(t.displayVisible===!1)return;let e=this;e.saveGraphicsState();let r=new ga(t).getPath();this.panelSVGPath(r.line),e.context2d.lineWidth=0,e.context2d.stroke(),e.setCurrentTransformationMatrix(new this.Matrix(...nr.getMatrix6FromMatrix(r.text.m3))),e.setFontSize(16*.72),e.text(r.text.textContent,0,0),e.restoreGraphicsState()}}function C6e(){Cd.panelDimension=function(t){if(t.displayVisible===!1)return;let e=this,r=new Ua(t).getPath();this.panelSVGPath(r.line),e.context2d.stroke(),e.saveGraphicsState(),e.setCurrentTransformationMatrix(new this.Matrix(...nr.getMatrix6FromMatrix(r.text.m3))),e.text(r.text.textContent,0,0),e.restoreGraphicsState()}}function S6e(){Cd.panelDimensionRadius=function(t){if(t.displayVisible===!1)return;let e=this,r=new ca(t).getPath();this.panelSVGPath(r.line),e.context2d.stroke(),e.saveGraphicsState(),e.setFontSize(16*.72),e.setCurrentTransformationMatrix(new this.Matrix(...nr.getMatrix6FromMatrix(r.text.m3))),e.text(r.text.textContent,0,0),e.restoreGraphicsState()}}function T6e(){Cd.panelAuxiliaryLine=function(t,e){if(t.displayVisible===!1)return;let r=this;if(t.visible===!1)return;let i=new dd(t).updateAuxiliaryLineDataXY(e).getPath();this.panelSVGPath(i),r.context2d.strokeStyle=t.strokeColor||X.profileSetting.commSystemSetting.PANEL_THEME.color.auxiliaryLine,r.context2d.stroke()}}function I6e(){Cd.panelAuxiliaryPoint=function(t){if(t.displayVisible===!1)return;let e=this;t.visible!==!1&&(e.setFillColor(t.fillColor||X.profileSetting.commSystemSetting.PANEL_THEME.fillColor.auxiliaryPoint),e.circle(t.x,t.y,4,"f"))}}function H3(t,e){let r=e.Matrix(e.internal.scaleFactor,0,0,e.internal.scaleFactor,0,0);if(t.layer===4){let i=ZA(t.d),n=ym(i);return e.setLineWidth(0),e.setDrawColor("#000"),e.path(n),e.fillStroke({key:"transparent-pattern",matrix:r}),_c}else{if(t.layer===3)return e.panelSVGPath(t.d),e.context2d.strokeStyle="#000",e.context2d.lineWidth=0,e.context2d.stroke(),_c;if(t.layer===7)return e.panelSVGPath(t.d),e.context2d.strokeStyle="#ff00ff",e.context2d.lineWidth=0,e.context2d.setLineDash([12,4,2,4]),e.context2d.stroke(),_c;if(t.layer===2){let i=ZA(t.d),n=ym(i);return e.path(n),e.fill({key:"slash-pattern",matrix:r}),_c}else if(t.layer===5){let i=ZA(t.d),n=ym(i);return e.path(n),e.fill({key:"grid-45-degree",matrix:r}),_c}}}function lae(t){B6e(t),D6e(t),_6e(t)}function B6e(t){let e=new cf([0,0,16,16],16,16);t.beginTilingPattern(e),t.setFillColor("#fff"),t.rect(0,0,16,16,"f"),t.setFillColor("#dfdfdf"),t.rect(0,0,8,8,"f"),t.setFillColor("#dfdfdf"),t.rect(8,8,8,8,"f"),t.endTilingPattern("transparent-pattern",e)}function D6e(t){let e=new cf([0,0,16,16],16,16);t.beginTilingPattern(e),t.setFillColor("#ccc"),t.rect(0,0,16,16,"f"),t.fill();let i=ZA("M 8 0 L 16 0 0 16 0 8 Z M 8 16 L 16 8 16 16 Z"),n=ym(i);t.path(n),t.setFillColor("#999"),t.fill(),t.endTilingPattern("slash-pattern",e)}function _6e(t){let e=new cf([0,0,8,8],8,8);t.beginTilingPattern(e),t.setFillColor("#fff"),t.rect(0,0,8,8,"f"),t.fill(),t.setDrawColor("#ccc"),t.line(0,0,8,8),t.line(8,0,0,8),t.stroke(),t.endTilingPattern("grid-45-degree",e)}oae();function cae(){return new Promise(t=>{new pU(e=>{let r=e.output("blob");t(r)})})}var pU=class{constructor(e){this.callback=e;this.margin=0;this.scaleFactor=.72;this.gJsonCache=Ei("getJsonCache",[{getPath:!0}]),this.canvasBBox=this.gJsonCache.BBox;let{isHidden:r,path:i,BBox:n}=Ei("getFrameInfo");if(this.frameBBox=n,this.framePath=r?"":i,r===!1){let a=new pr().ext10(this.frameBBox).ext10(this.gJsonCache.BBox).build();this.canvasBBox={x:a.minX,y:a.minY,width:a.width(),height:a.height()}}this.pdf=new Tw(this.getPDFOptions(this.canvasBBox.width,this.canvasBBox.height)),this.recoverGJsonCache=te.exchangeJsonCache(this.gJsonCache),this.onStart(),this.pdf.advancedAPI(),lae(this.pdf),this.exportInOnePage()}getPDFOptions(e,r){return{compress:!d_(),orientation:e>r?"l":"p",unit:this.scaleFactor,format:[e+2*this.margin,r+2*this.margin]}}onStart(){X.messageBus.publish("progressUpdate",[0,"panel export pdf"])}onComplete(){this.callback(this.pdf),this.recoverGJsonCache(),this.pdf.compatAPI(),this.onProgress(1)}onProgress(e){X.messageBus.publish("progressUpdate",[e,"panel export pdf"])}async exportInOnePage(){let e=this.pdf.Matrix(1,0,0,1,this.margin-this.canvasBBox.x,this.margin-this.canvasBBox.y);this.pdf.setCurrentTransformationMatrix(e);for(let r of this.gJsonCache.itemOrder){let{json:i}=te.getById(r);await this.generateOnePDFPrimitive(this.pdf,i,this.canvasBBox,this.margin)}this.pdf.panelFrame(this.framePath),this.onComplete()}async generateOnePDFPrimitive(e,r,i,n){let s=sae.call(e,r);switch(r.cmdKey){case"ellipse":e.panelEllipse(r);break;case"rect":e.panelRect(r);break;case"obj":{await e.panelImage(r);break}case"group":e.panelGroup(r);break;case"arc":{e.panelArc(r);break}case"text":{e.panelText(r);break}case"dimensionLength":{e.panelDimensionLength(r);break}case"dimensionAngle":{e.panelDimensionAngle(r);break}case"dimension":{e.panelDimension(r);break}case"dimensionRadius":{e.panelDimensionRadius(r);break}case"auxiliaryLine":{let a=new pr;a.ext10(i).ext7(n),e.panelAuxiliaryLine(r,a.build());break}case"auxiliaryPoint":{e.panelAuxiliaryPoint(r);break}default:Zn(r);break}s()}};var G3=class{constructor(e){this.maskMap=new Map;this.options={scaleFactor:.72,...e},this.json=Ei("getJsonCache",[{getPath:!1}])}async startParse(){let e=rl(this.options.svgStr);await this.parseOne(e)}getBlob(){return this.pdf.output("blob")}async parseOne(e){let r=e.tagName.toLowerCase();switch(r){case"svg":await this.svg(e);break;case"g":await this.g(e);break;case"path":this.path(e);break;case"rect":this.rect(e);break;case"image":await this.image(e);break;case"defs":await this.defs(e);break;case"mask":this.mask(e);break;case"pattern":await this.pattern(e);break;default:console.error(r);break}}async dfs(e){for(let r of e.children)await this.parseOne(r)}async pattern(e){let r=+ge(e,"width"),i=+ge(e,"height"),n=e.id,s=new cf([0,0,r,i],r,i);this.pdf.beginTilingPattern(s),await this.dfs(e),this.pdf.endTilingPattern(n,s)}mask(e){this.maskMap.set(e.id,e)}async defs(e){await this.dfs(e)}async g(e){var s;if(!kK(e))return;let r=(s=ge(e,"mask"))==null?void 0:s.replace("%23","#"),i=aT(r);this.pdf.saveGraphicsState();let n=t8(e,this.pdf);if(this.pdf.setCurrentTransformationMatrix(n),r&&i&&this.maskMap.get(i)){for(let a of this.maskMap.get(i).children)fS(a,"fill"),await this.parseOne(a);this.pdf.clip(),this.pdf.discardPath()}await this.dfs(e),this.pdf.restoreGraphicsState()}async svg(e){let r=e.viewBox.baseVal,{x:i,y:n,width:s,height:a}=r;if(this.pdf){let o=e.parentElement.dataset.originId,l=te.exchangeJsonCache(this.json),c=te.getById(o).json.content;l();let u=await OC(c);this.pdf.addImage({imageData:u,x:0,y:0,width:1,height:1})}else{this.pdf=new Tw({unit:this.options.scaleFactor,orientation:s>a?"l":"p",format:[s,a]}),this.pdf.advancedAPI();let o=this.pdf.Matrix(1,0,0,1,-i,-n);this.pdf.setCurrentTransformationMatrix(o),await this.dfs(e),this.pdf.compatAPI()}}path(e){var c,u;let r=ge(e,"d"),i=ZA(r),n=ym(i),s=this.pdf;s.saveGraphicsState().path(n);let a=(c=ge(e,"fill"))==null?void 0:c.replace("%23","#"),o=(u=ge(e,"stroke"))==null?void 0:u.replace("%23","#"),l=+ge(e,"opacity")||1;if(l!==1&&s.setGState(s.GState({opacity:l})),a&&a!=="none")if(a.startsWith("url")){let d=aT(a);s.fill({key:d,matrix:this.pdf.Matrix(this.options.scaleFactor,0,0,this.options.scaleFactor,0,0)})}else s.setFillColor(a),s.fill();if(o&&o!=="none"){let d=+ge(e,"stroke-width")||1;ge(e,"vector-effect")==="non-scaling-stroke"&&(d=0);let h=ge(e,"stroke-dasharray")||"";h&&s.setLineDashPattern(h.split(" ").map(f=>+f),10),s.setLineWidth(d),s.setDrawColor(o),s.stroke(),s.setLineDashPattern([],0)}s.restoreGraphicsState()}rect(e){var c,u;let r=+ge(e,"x"),i=+ge(e,"y"),n=+ge(e,"width"),s=+ge(e,"height"),a=(c=ge(e,"fill"))==null?void 0:c.replace("%23","#"),o=(u=ge(e,"stroke"))==null?void 0:u.replace("%23","#"),l="";a&&a!=="none"&&(this.pdf.setFillColor(a),l+="f"),o&&o!=="none"&&(this.pdf.setDrawColor(o),l+="S"),this.pdf.rect(r,i,n,s,l)}async image(e){this.pdf.saveGraphicsState();let r=t8(e,this.pdf);this.pdf.setCurrentTransformationMatrix(r);let i=ge(e,"xlink:href");i.startsWith("data:image/svg+xml;")&&(i=await OC(i)),this.pdf.addImage({imageData:i,x:0,y:0,height:1,width:1}),this.pdf.restoreGraphicsState()}};var uae={leftTreeMenuClick([t,e,r]){switch(t){case"properties":X.messageBus.publish("closeOrOpenSidebar",["layout_toggler_right",!1]),X.messageBus.publish("ui/rightPanelTabClick",{tabId:"panel-attr"});break;default:console.warn(t);break}},"/panel/updatePanelValue":uo.updatePanelValue,"-panel/generate-svg-str":SW,"-panel/get-source-code":hp.getActiveCompressStr.bind(hp),"-panel/3d/get-attr-data"(){return CJ.pickData()},"-panel/2d/get-attr-data"(t){return uo.pickData4UI(t)},"-get-panel-canvas-pdf"(){return cae()},"-get2dPreviewSVG":_O,async"-panel/svg2pdf"(t){let e=new G3(t);return await e.startParse(),e.getBlob()}};var mU=class{constructor(){this.iframeSet={}}add(e,r){this.iframeSet[e]=r}delete(e){this.iframeSet[e]&&delete this.iframeSet[e]}modify(e,r){this.iframeSet[e]&&(this.iframeSet[e]=Object.assign(this.iframeSet[e],r))}},Dm=new mU;function Aae(){X.messageBus.subscribe("/panel/confirmPanelThemeHandler",e=>{NJ(e)}),X.messageBus.subscribe("/panel/generatePanelProductionSvgProgress",e=>{X.messageBus.publish("progressUpdate",[e.progress,"Generating panel fabrication file...",e.tabId,null,!1])}),X.messageBus.subscribe("/panel/generatePanelProductionOrderProgress",e=>{X.messageBus.publish("progressUpdate",[e.progress,"Generating panel fabrication file...",e.tabId,null,!1])});let t=Object.assign({},P6e,uae);for(let e of Object.keys(t))e.startsWith("-")?X.messageBus.rpcService(e.substring(1),t[e]):X.messageBus.subscribe(e,t[e])}var P6e={"-/panel/create/new":async t=>{let{message:e}=await X.messageBus.rpcCall(DQ.LOCAL.PANEL);return e},setReferencePosition(t){t!==void 0?X.referencePosition={offX:t.offX,offY:t.offY}:X.referencePosition=void 0,JX("referencePosition",JSON.stringify(X.referencePosition))},"-getReferencePosition":()=>X.referencePosition,"/pro-ui/container/resize":t=>{let{containerId:e,domRect:r}=t;Object.keys(Dm.iframeSet).forEach(i=>{if(Dm.iframeSet[i].containerId==e){let s=Em(i);if(s){let a=s.parentElement.style;a.position="fixed",a.width=r.width+"px",a.height=r.height+"px",a.top=r.top+"px",a.left=r.left+"px",s.contentWindow.dispatchEvent(new Event("beforeResize"))}}})},"/pro-ui/tab/changeContainer":t=>{let{tabId:e,containerId:r}=t;Dm.modify(e,{containerId:r})},onTabbarActive:async function(t){let{props:e,tabData:r}=t,{tabId:i,containerId:n}=e;Object.keys(Dm.iframeSet).forEach(s=>{if(i!==s&&Dm.iframeSet[s].containerId===n){let a=Em(s);a!=null&&(a.parentElement.style.visibility="hidden",X.windowBridge.publish("uninstallCurrentTool",[],a.contentWindow))}})},onTabbarClick:async function(t){var f;let{props:e,tabData:r}=t,{doctype:i,deviceUuid:n}=r,{tabId:s,containerId:a,domRect:o,isActive:l=!0}=e;if(![si.PANEL,si.PANEL_LIB].includes(i))return;let c=Em(s);if(!c){let[p,m]=hO(s);await X.messageBus.rpcCall("openDoc",{uuid:p,path:m,isActive:l})}if(c=Em(s),!c){console.log("\u8981\u5148\u6253\u5F00iframe");return}let u=c.parentElement.style,d=c.parentElement.getBoundingClientRect();u.position="fixed",u.width=o.width+"px",u.height=o.height+"px",u.top=o.top+"px",u.left=o.left+"px",u.visibility="visible",c.contentWindow.dispatchEvent(new Event("resize")),((f=Dm.iframeSet[s])==null?void 0:f.containerId)!==a&&Dm.modify(s,{containerId:a});let A=c.parentElement.querySelector(".rulerh");if(A){let p=o.width-23+"px";A.getAttribute("width")!==p&&A.setAttribute("width",p)}let h=c.parentElement.querySelector(".rulerv");if(h){let p=o.height-23+"px";h.getAttribute("height")!==p&&h.setAttribute("height",p)}A&&h&&X.windowBridge.publish("updateRulerOnResize",{tabId:s},ur()),X.messageBus.rpcCall("/pro-ui/container/tab/active",{tabId:s,containerId:a,isActive:l})},setPanelTabActive:async function(t){var a;let{tabId:e,fromTab:r,docType:i}=t;if(![si.PANEL,si.PANEL_LIB].includes(i))return;let n=(a=X.profileSetting)==null?void 0:a.commSystemSetting.CANVAS.referencePoint_select_method.value,s=await Xg("getReferencePointToolStatus",null);n&&!s&&Ei("abortReferencePointModeAndCancelPaste"),X.messageBus.publish("renderAttributeFilterPanel",{docType:i,tabId:e,fromTab:r}),uo.updateSG(e)},"/pro-ui/container/tab/delete":t=>{let{containerId:e,tabId:r}=t;Dm.delete(r)},"-panel/createDoc":async t=>{let{tabId:e,data:r,docType:i}=t;if(![si.PANEL,si.PANEL_LIB].includes(i))return;let n=bJ(e);Dm.add(e,{containerId:n});let[s,a]=e.split("@");Ei("importDocEdit",[s,a,t],e)},"-copyPanelLib":async({origin:t,target:e})=>{let r=new cp(e.uuid,e.path,!1),i=await cp.getJsonCache(t.uuid,t.path);if(!(await r.init()).success||Kr(i))return!1;let s=await ef.uploadJsonCache(r,i);return r.destroy(),s},"panel/closeDoc":t=>{Ei("closeDoc",[],t)},modifyCanvas:({data:t},e)=>{Ei("modifyCanvas",[t],e)},openDocComplete:t=>{let{tabId:e,docType:r}=t;[si.PANEL,si.PANEL_LIB].includes(r)&&Ei("openDocComplete",[],e)},setOrigin:function({originX:t,originY:e}){zg()===si.PANEL&&Ei("setOrigin",[{originX:t,originY:e}])},"-/panel/save":function({tabid:t,options:e}){return new Bb(t,e).todo()},"panel/resumeDataMerge":function(){Ei("panel/resumeDataMerge")},file_save:function(t){ho(t.func)},save_all:function(t){ho(t.func)},"zoom(in)":function(t){tf("in",gU(t).frame,t[0])},"zoom(out)":function(t){tf("out",gU(t).frame,t[0])},zoom:function(t){tf(t[0],gU(t).frame,t[1],t[2])},setZoomText:function(t){mT(t[0])},setActiveDoctype:function(t){EJ(t)},updateMouseXY:function(t){uo.updateMouseXY.apply(null,t)},"from/ui/canvas/scale":t=>{Ei("zoom",[t.scale],t.tabId)},setIsCutPasteFinish:function(t){X.isCutPasteFinish=t},getIsCutPasteFinish:function(){return X.isCutPasteFinish},"-panel/decode":function(t){let[e,r]=t;return RJ(e,r)},[s_.ON_OPENED]:function({info:t}){X.currentProject=t},[s_.ON_CLOSED]:function(){X.currentProject={}},[t_.ON_TEMP_OPENED]:function(t){X.currentProject={projectId:t.uuid,title:t.title}},[t_.ON_TEMP_CLOSED]:function(t){X.currentProject={}},[jQ.PROJECT.ON_UPDATE]:async({ops:t,projectId:e})=>{if(e!==X.currentProject.projectId)return;let r=(t==null?void 0:t.project)||(t==null?void 0:t.initPrj)||t;r.title&&r.title!==X.currentProject.title&&(X.currentProject.title=r.title)},updateSystemConfig(t){X.profileSetting=t||{}},"-panelMenuData":async function(t){let[e]=t;return await MJ(e)},setUserInfo:function(t){X.globalVariableCookieData||(X.globalVariableCookieData={}),X.globalVariableCookieData.userInfo={username:t.username,nickname:t.nickname||"",avatar:t.avatar,uuid:t.uuid}},"-panel/getSvgstr":async function(t){let e=await bE(t);return Ba.toSVG(e)},"-panel_hotkey":async function(t){return await gT.performCmd(t)},updateIFrameState:t=>{let{doctype:e,to:r}=t.head,{active:i}=t.body;!i&&jE(e)&&r?Ei("forceReleaseToken",null,r):i&&jE(e)&&X.messageBus.publish("setTopMenuItemsChecked",{"unit(mm)":!0})},"panel/doCommand":function(t){if(typeof t=="string")ho(t);else if(Array.isArray(t)){let[e,...r]=t;ho(e,...r)}},"-/panel/3d/source":async t=>{let{tabId:e}=t;if(!jE(pT(e)))return{};try{let r=Ei("getJsonCache",void 0,e),{message:i}=await X.worker.relaunch().rpcCall("/panel/generatePanelPreview3DSource",{gJsonCache:r,tabId:e}),{dataStr:n,blobStr:s,head:a,productionSvg:o,error:l}=i;if(!l&&n)return a.name=a.display_title||a.title||a.name,{tabId:e,dataStr:n,blobStr:s,head:a,productionSvg:o};console.error("Failed to generate panel fabrication file!")}catch(r){console.error("rpcCall error",r)}finally{X.worker.terminate()}return{}},"/panel/3d/download":()=>{ho("panel/3d/download",["download"])},"/panel/3d/order":()=>{ho("panel/3d/order",["order"])},"/panel/3d/doCommand":([t,e])=>{switch(t){case"zoom(in)":case"zoom(out)":{pc(t,e);break}default:{console.log("Invalid command: "+t);break}}},"-/panel/filterConfigs":function(){return CS},"-/panel/getCompressStr":async function(t){return await hp.getPanelCompressStr(t)},"-/panel/getActiveCompressStr":async function(){return await hp.getActiveCompressStr()},"-/panel/imageUrlToImageData":async function(t){let{imageUrl:e,width:r,height:i}=t;return await(async(s,a,o)=>new Promise((l,c)=>{let u=4096,d=4096,A=1;(a>u||o>d)&&(A=Math.min(u/a,d/o),a=Math.floor(A*a),o=Math.floor(A*o)),a=Math.max(3,a),o=Math.max(3,o);let h=new Image(a,o);h.onload=async()=>{let f=new OffscreenCanvas(a,o),p=f.getContext("2d");p.drawImage(h,0,0,a,o);let m={width:a,height:o};switch("PixelDataBuffer"){case"PixelDataBuffer":{let g=p.getImageData(0,0,a,o);l({source:g.data.buffer,type:"PixelDataBuffer",...m});break}case"FileBuffer":{let b=await(await f.convertToBlob()).arrayBuffer();l({source:b,type:"FileBuffer",...m});break}default:{c("invalid sourceType");break}}h=null,f=null,p=null},h.onerror=f=>{h=null,c(f)},h.src=s}))(e,r,i)},"-/panel/resizeImageFromURL":async function([t,e]){return await mE(t,e)},updateProjectReadOnly:t=>{X.isProjectReadOnly=t},"-getPanelScene":()=>y8()};function gU(t){let e;return t&&t.uuid?(e=Gc.getTabIFrame(t.uuid),{frame:e,win:e&&e.contentWindow,tabid:t.uuid}):(e=T6("#tabbar_bodies > div[uuid]")&&(0,dae.default)(T6("#tabbar_bodies > div[uuid]")).find("iframe")[0],{frame:e,win:e&&e.contentWindow,tabid:YE(e)})}function hae(t=0,e){X.messageBus.publish("progressUpdate",[t,"Generating panel fabrication file...",e,null,!1]),X.worker.terminate()}async function _O(t=vu()){hae(0,t);let e=Ei("getJsonCache",void 0,t);return X.worker.relaunch().rpcCall("/panel/generatePanelPreviewSvg",{gJsonCache:e,tabId:t}).then(({message:r})=>{let{svgStr:i,error:n}=r;if(i&&!n)return i;throw console.error("Failed to generate panel fabrication file!"),n||"Failed to generate panel fabrication file!"},r=>{throw r}).finally(hae.bind(null,1,t))}var pae=pa(pv()),fae=0,Y3=class{constructor(e,r){this.bus=e;this.workerMaker=r;this._id=++fae}relaunch(){return this.terminate(),this.bridge=new pae.WorkerMessageBridge(this.bus,this.workerMaker()),this}terminate(){var e;return(e=this.bridge)==null||e.discard(),this.bridge=null,this._id=++fae,this}rpcCall(e,r){return this.bridge||this.relaunch(),this.bridge.rpcCall(e,r)}get id(){return this._id}};X.messageBus=window._MSG_BUS_=window._MSG_BUS_||new V3.MessageBus;X.windowBridge=window._MSG_BUS_WIN_=window._MSG_BUS_WIN_||new V3.WindowMessageBridge(X.messageBus);X.worker=new Y3(X.messageBus,()=>new Worker(`editor?entry=panel-worker.js&cll=${self.PRO_LOG_LEVEL||""}`,{name:"panel-worker"}));Aae();L6e();function L6e(){(0,Lh.default)(document).on("updateLocale",function(t,e){X.messageBus.publish("updateLocale",e)}),(0,Lh.default)("#treePanelObjects").on("mousedown",".tree-node",function(t){mae()}),(0,Lh.default)("#treePanelObjects").on("mousemove",".tree-node",function(t){mae()}),(0,Lh.default)("#tabbar_bodies").on("mouseover mouseout","iframe.editframe",function(t){X.isMouseOnEditFrame=t.type=="mouseover"})}function mae(){let t=(0,Lh.default)("#treePanelObjects");(0,Lh.default)("#treePanelObjects-content").removeClass("no-hover"),(0,Lh.default)(".tree-node",t).removeClass("tree-node-auto-hover")}X.currZoom=100;Lh.default.getJSON=(function(t){return function(e,r,i){if(typeof e=="string")return t.call(Lh.default,e,r,i);if(Lh.default.isPlainObject(e))return Lh.default.ajax(Object.assign({type:"GET",dataType:"json"},e));throw Error("Invalid parameters")}})(Lh.default.getJSON);(function(){Lh.default.ajaxTransport("+*",function(t){t.url.match(/^https?:/)&&t.url.indexOf(location.protocol+location.host+"/")!==0||t.url.match(/^\/(projects|components|document|)\//)}),Lh.default.ajaxPrefilter(function(t,e){var r=e.data;r&&t.url.match(/{.+?}/)&&(typeof r=="string"&&e.contentType.indexOf("application/json")===0&&(r=u_(r),t.data=JSON.stringify(r)),r&&typeof r=="object"&&(t.url=t.url.replace(/{(.+?)}/g,function(n){var s=n.slice(1,-1);return $t(r,s)?""+r[s]:r.get&&r.has&&r.has(s)?r.get(s):(console.log(t.url+"\uFF1AThis url is illegality!"),n)}))),t.type.match(/post/i)&&t.url.startsWith("/")&&!t.url.startsWith("/servicecenter/")&&typeof t.data=="string"&&typeof sR=="object"&&t.data.length>=X.autoGzipAjaxPostSize&&(Object.assign(t,{data:sR.gzip(t.data),processData:!1}),t.headers=t.headers||{},Object.assign(t.headers,{"Content-Encoding":"gzip"}));let i=t.type.toUpperCase();if(i!=="GET"&&i!=="HEAD"){let n=/XSRF-TOKEN=(\S+);?/.exec(document.cookie);n&&(t.headers=Object.assign(t.headers||{},{"X-XSRF-TOKEN":decodeURIComponent(n[1])}))}})})();X.gZoom=1;X.currZoom=100;X.messageBus.subscribe("/debug/draw",t=>X.windowBridge.publish("/debug/draw",t,xJ()));function fo(){}self.assert=fo;self.assert_eq=fo;self.assert_ne=fo;self.assert_gt=fo;self.assert_gte=fo;self.assert_lt=fo;self.assert_lte=fo;self.assert_def=fo;self.assert_notnull=fo;self.assert_undef=fo;self.assert_number=fo;self.assert_string=fo;self.assert_boolean=fo;self.assert_string=fo;self.assert_null=fo;self.assert_finite=fo;self.assert_regex=fo;self.assert_line_style=fo;self.assert_text_style=fo;self.assert_not_key=fo;self.assert_string_or_null=fo;self.assert_number_or_null=fo;self.assert_boolean_or_null=fo;self.assert_point_arr=fo;self.assert_group_type=fo;var vp={};vp.PANELGVars=X;vp.History=mr;vp.$$$=Us;vp.$$$1=Hs;vp.$$=Fe;vp.jsonMgr=te;vp.Config=zt;vp.DOCTYPE=si;vp.parseXML=kc;vp.adsorptionTool=Jr;window.PANEL=vp;})();
/*! Bundled license information:

jquery/dist/jquery.js:
  (*!
   * jQuery JavaScript Library v3.7.1
   * https://jquery.com/
   *
   * Copyright OpenJS Foundation and other contributors
   * Released under the MIT license
   * https://jquery.org/license
   *
   * Date: 2023-08-28T13:37Z
   *)

html2canvas/dist/html2canvas.js:
  (*!
   * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
   * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
   * Released under MIT License
   *)
  (*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** *)

dompurify/dist/purify.js:
  (*! @license DOMPurify 2.5.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.5/LICENSE *)

svg-pathdata/lib/SVGPathData.module.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)

pako/dist/pako.esm.mjs:
  (*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) *)

lc-editor-common/dist/index.js:
  (*! Bundled license information:
  
  lc-protocol/dist/index.js:
    (*! Bundled license information:
    
    crypto-js/ripemd160.js:
      (** @preserve
      	(c) 2012 by Cdric Mesnil. All rights reserved.
      
      	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
      
      	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
      	    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
      
      	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
      	*)
    
    crypto-js/mode-ctr-gladman.js:
      (** @preserve
       * Counter block mode compatible with  Dr Brian Gladman fileenc.c
       * derived from CryptoJS.mode.CTR
       * Jan Hruby jhruby.web@gmail.com
       *)
    *)
  *)

lc-protocol/dist/index.js:
  (*! Bundled license information:
  
  crypto-js/ripemd160.js:
    (** @preserve
    	(c) 2012 by Cdric Mesnil. All rights reserved.
    
    	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
    
    	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
    	    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
    
    	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    	*)
  
  crypto-js/mode-ctr-gladman.js:
    (** @preserve
     * Counter block mode compatible with  Dr Brian Gladman fileenc.c
     * derived from CryptoJS.mode.CTR
     * Jan Hruby jhruby.web@gmail.com
     *)
  *)

jspdf/dist/jspdf.es.min.js:
  (** @license
   *
   * jsPDF - PDF Document creation from JavaScript
   * Version 2.5.1 Built on 2022-01-28T15:37:57.791Z
   *                      CommitID 00000000
   *
   * Copyright (c) 2010-2021 James Hall <james@parall.ax>, https://github.com/MrRio/jsPDF
   *               2015-2021 yWorks GmbH, http://www.yworks.com
   *               2015-2021 Lukas Hollnder <lukas.hollaender@yworks.com>, https://github.com/HackbrettXXX
   *               2016-2018 Aras Abbasi <aras.abbasi@gmail.com>
   *               2010 Aaron Spike, https://github.com/acspike
   *               2012 Willow Systems Corporation, https://github.com/willowsystems
   *               2012 Pablo Hess, https://github.com/pablohess
   *               2012 Florian Jenett, https://github.com/fjenett
   *               2013 Warren Weckesser, https://github.com/warrenweckesser
   *               2013 Youssef Beddad, https://github.com/lifof
   *               2013 Lee Driscoll, https://github.com/lsdriscoll
   *               2013 Stefan Slonevskiy, https://github.com/stefslon
   *               2013 Jeremy Morel, https://github.com/jmorel
   *               2013 Christoph Hartmann, https://github.com/chris-rock
   *               2014 Juan Pablo Gaviria, https://github.com/juanpgaviria
   *               2014 James Makes, https://github.com/dollaruw
   *               2014 Diego Casorran, https://github.com/diegocr
   *               2014 Steven Spungin, https://github.com/Flamenco
   *               2014 Kenneth Glassey, https://github.com/Gavvers
   *
   * Permission is hereby granted, free of charge, to any person obtaining
   * a copy of this software and associated documentation files (the
   * "Software"), to deal in the Software without restriction, including
   * without limitation the rights to use, copy, modify, merge, publish,
   * distribute, sublicense, and/or sell copies of the Software, and to
   * permit persons to whom the Software is furnished to do so, subject to
   * the following conditions:
   *
   * The above copyright notice and this permission notice shall be
   * included in all copies or substantial portions of the Software.
   *
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
   * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
   * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
   * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
   * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
   * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
   * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
   *
   * Contributor(s):
   *    siefkenj, ahwolf, rickygu, Midnith, saintclair, eaparango,
   *    kim3er, mfo, alnorth, Flamenco
   *)
  (**
   * A class to parse color values
   * @author Stoyan Stefanov <sstoo@gmail.com>
   * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
   * @license Use it if you like it
   *)
  (**
   * @license
   * Joseph Myers does not specify a particular license for his work.
   *
   * Author: Joseph Myers
   * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
   *
   * Modified by: Owen Leong
   *)
  (**
   * @license
   * FPDF is released under a permissive license: there is no usage restriction.
   * You may embed it freely in your application (commercial or not), with or
   * without modifications.
   *
   * Reference: http://www.fpdf.org/en/script/script37.php
   *)
  (**
   * @license
   * Licensed under the MIT License.
   * http://opensource.org/licenses/mit-license
   * Author: Owen Leong (@owenl131)
   * Date: 15 Oct 2020
   * References:
   * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
   * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
   * http://www.fpdf.org/en/script/script37.php
   *)
  (**
   * @license
   *
   * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
   *
   * Permission is hereby granted, free of charge, to any person obtaining
   * a copy of this software and associated documentation files (the
   * "Software"), to deal in the Software without restriction, including
   * without limitation the rights to use, copy, modify, merge, publish,
   * distribute, sublicense, and/or sell copies of the Software, and to
   * permit persons to whom the Software is furnished to do so, subject to
   * the following conditions:
   *
   * The above copyright notice and this permission notice shall be
   * included in all copies or substantial portions of the Software.
   *
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
   * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
   * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
   * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
   * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
   * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
   * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
   * ====================================================================
   *)
  (**
   * @license
   * (c) Dean McNamee <dean@gmail.com>, 2013.
   *
   * https://github.com/deanm/omggif
   *
   * Permission is hereby granted, free of charge, to any person obtaining a copy
   * of this software and associated documentation files (the "Software"), to
   * deal in the Software without restriction, including without limitation the
   * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
   * sell copies of the Software, and to permit persons to whom the Software is
   * furnished to do so, subject to the following conditions:
   *
   * The above copyright notice and this permission notice shall be included in
   * all copies or substantial portions of the Software.
   *
   * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
   * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
   * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
   * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
   * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
   * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
   * IN THE SOFTWARE.
   *
   * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
   * including animation and compression.  It does not rely on any specific
   * underlying system, so should run in the browser, Node, or Plask.
   *)
  (**
   * @license
    Copyright (c) 2008, Adobe Systems Incorporated
    All rights reserved.
  
    Redistribution and use in source and binary forms, with or without 
    modification, are permitted provided that the following conditions are
    met:
  
    * Redistributions of source code must retain the above copyright notice, 
      this list of conditions and the following disclaimer.
    
    * Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the 
      documentation and/or other materials provided with the distribution.
    
    * Neither the name of Adobe Systems Incorporated nor the names of its 
      contributors may be used to endorse or promote products derived from 
      this software without specific prior written permission.
  
    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
    IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
    THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
    PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
    CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
    EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
    PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
    PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
    LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  *)
  (**
   * @license
   * Copyright (c) 2017 Aras Abbasi
   *
   * Licensed under the MIT License.
   * http://opensource.org/licenses/mit-license
   *)
*/
//# sourceMappingURL=https://modules.lceda.cn/pro-panel/3.1.48.5df9d457/js/panel-main.js.map
