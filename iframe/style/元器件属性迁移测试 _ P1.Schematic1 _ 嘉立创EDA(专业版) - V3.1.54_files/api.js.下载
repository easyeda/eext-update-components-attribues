"use strict";(()=>{var L6=Object.create;var sI=Object.defineProperty;var N6=Object.getOwnPropertyDescriptor;var D6=Object.getOwnPropertyNames;var B6=Object.getPrototypeOf,O6=Object.prototype.hasOwnProperty;var ar=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,i)=>(typeof require<"u"?require:t)[i]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var _e=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var M6=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of D6(t))!O6.call(e,n)&&n!==i&&sI(e,n,{get:()=>t[n],enumerable:!(r=N6(t,n))||r.enumerable});return e};var Hn=(e,t,i)=>(i=e!=null?L6(B6(e)):{},M6(t||!e||!e.__esModule?sI(i,"default",{value:e,enumerable:!0}):i,e));var oI=_e((EQ,aI)=>{(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:function(i,r){return i<<r|i>>>32-r},rotr:function(i,r){return i<<32-r|i>>>r},endian:function(i){if(i.constructor==Number)return t.rotl(i,8)&16711935|t.rotl(i,24)&4278255360;for(var r=0;r<i.length;r++)i[r]=t.endian(i[r]);return i},randomBytes:function(i){for(var r=[];i>0;i--)r.push(Math.floor(Math.random()*256));return r},bytesToWords:function(i){for(var r=[],n=0,s=0;n<i.length;n++,s+=8)r[s>>>5]|=i[n]<<24-s%32;return r},wordsToBytes:function(i){for(var r=[],n=0;n<i.length*32;n+=8)r.push(i[n>>>5]>>>24-n%32&255);return r},bytesToHex:function(i){for(var r=[],n=0;n<i.length;n++)r.push((i[n]>>>4).toString(16)),r.push((i[n]&15).toString(16));return r.join("")},hexToBytes:function(i){for(var r=[],n=0;n<i.length;n+=2)r.push(parseInt(i.substr(n,2),16));return r},bytesToBase64:function(i){for(var r=[],n=0;n<i.length;n+=3)for(var s=i[n]<<16|i[n+1]<<8|i[n+2],a=0;a<4;a++)n*8+a*6<=i.length*8?r.push(e.charAt(s>>>6*(3-a)&63)):r.push("=");return r.join("")},base64ToBytes:function(i){i=i.replace(/[^A-Z0-9+\/]/ig,"");for(var r=[],n=0,s=0;n<i.length;s=++n%4)s!=0&&r.push((e.indexOf(i.charAt(n-1))&Math.pow(2,-2*s+8)-1)<<s*2|e.indexOf(i.charAt(n))>>>6-s*2);return r}};aI.exports=t})()});var I_=_e((SQ,lI)=>{var v_={utf8:{stringToBytes:function(e){return v_.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(v_.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],i=0;i<e.length;i++)t.push(e.charCodeAt(i)&255);return t},bytesToString:function(e){for(var t=[],i=0;i<e.length;i++)t.push(String.fromCharCode(e[i]));return t.join("")}}};lI.exports=v_});var dI=_e((vQ,cI)=>{cI.exports=function(e){return e!=null&&(uI(e)||k6(e)||!!e._isBuffer)};function uI(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function k6(e){return typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&uI(e.slice(0,0))}});var A_=_e((IQ,hI)=>{(function(){var e=oI(),t=I_().utf8,i=dI(),r=I_().bin,n=function(s,a){s.constructor==String?a&&a.encoding==="binary"?s=r.stringToBytes(s):s=t.stringToBytes(s):i(s)?s=Array.prototype.slice.call(s,0):!Array.isArray(s)&&s.constructor!==Uint8Array&&(s=s.toString());for(var o=e.bytesToWords(s),l=s.length*8,u=1732584193,c=-271733879,h=-1732584194,m=271733878,f=0;f<o.length;f++)o[f]=(o[f]<<8|o[f]>>>24)&16711935|(o[f]<<24|o[f]>>>8)&4278255360;o[l>>>5]|=128<<l%32,o[(l+64>>>9<<4)+14]=l;for(var g=n._ff,y=n._gg,b=n._hh,E=n._ii,f=0;f<o.length;f+=16){var S=u,v=c,A=h,x=m;u=g(u,c,h,m,o[f+0],7,-680876936),m=g(m,u,c,h,o[f+1],12,-389564586),h=g(h,m,u,c,o[f+2],17,606105819),c=g(c,h,m,u,o[f+3],22,-1044525330),u=g(u,c,h,m,o[f+4],7,-176418897),m=g(m,u,c,h,o[f+5],12,1200080426),h=g(h,m,u,c,o[f+6],17,-1473231341),c=g(c,h,m,u,o[f+7],22,-45705983),u=g(u,c,h,m,o[f+8],7,1770035416),m=g(m,u,c,h,o[f+9],12,-1958414417),h=g(h,m,u,c,o[f+10],17,-42063),c=g(c,h,m,u,o[f+11],22,-1990404162),u=g(u,c,h,m,o[f+12],7,1804603682),m=g(m,u,c,h,o[f+13],12,-40341101),h=g(h,m,u,c,o[f+14],17,-1502002290),c=g(c,h,m,u,o[f+15],22,1236535329),u=y(u,c,h,m,o[f+1],5,-165796510),m=y(m,u,c,h,o[f+6],9,-1069501632),h=y(h,m,u,c,o[f+11],14,643717713),c=y(c,h,m,u,o[f+0],20,-373897302),u=y(u,c,h,m,o[f+5],5,-701558691),m=y(m,u,c,h,o[f+10],9,38016083),h=y(h,m,u,c,o[f+15],14,-660478335),c=y(c,h,m,u,o[f+4],20,-405537848),u=y(u,c,h,m,o[f+9],5,568446438),m=y(m,u,c,h,o[f+14],9,-1019803690),h=y(h,m,u,c,o[f+3],14,-187363961),c=y(c,h,m,u,o[f+8],20,1163531501),u=y(u,c,h,m,o[f+13],5,-1444681467),m=y(m,u,c,h,o[f+2],9,-51403784),h=y(h,m,u,c,o[f+7],14,1735328473),c=y(c,h,m,u,o[f+12],20,-1926607734),u=b(u,c,h,m,o[f+5],4,-378558),m=b(m,u,c,h,o[f+8],11,-2022574463),h=b(h,m,u,c,o[f+11],16,1839030562),c=b(c,h,m,u,o[f+14],23,-35309556),u=b(u,c,h,m,o[f+1],4,-1530992060),m=b(m,u,c,h,o[f+4],11,1272893353),h=b(h,m,u,c,o[f+7],16,-155497632),c=b(c,h,m,u,o[f+10],23,-1094730640),u=b(u,c,h,m,o[f+13],4,681279174),m=b(m,u,c,h,o[f+0],11,-358537222),h=b(h,m,u,c,o[f+3],16,-722521979),c=b(c,h,m,u,o[f+6],23,76029189),u=b(u,c,h,m,o[f+9],4,-640364487),m=b(m,u,c,h,o[f+12],11,-421815835),h=b(h,m,u,c,o[f+15],16,530742520),c=b(c,h,m,u,o[f+2],23,-995338651),u=E(u,c,h,m,o[f+0],6,-198630844),m=E(m,u,c,h,o[f+7],10,1126891415),h=E(h,m,u,c,o[f+14],15,-1416354905),c=E(c,h,m,u,o[f+5],21,-57434055),u=E(u,c,h,m,o[f+12],6,1700485571),m=E(m,u,c,h,o[f+3],10,-1894986606),h=E(h,m,u,c,o[f+10],15,-1051523),c=E(c,h,m,u,o[f+1],21,-2054922799),u=E(u,c,h,m,o[f+8],6,1873313359),m=E(m,u,c,h,o[f+15],10,-30611744),h=E(h,m,u,c,o[f+6],15,-1560198380),c=E(c,h,m,u,o[f+13],21,1309151649),u=E(u,c,h,m,o[f+4],6,-145523070),m=E(m,u,c,h,o[f+11],10,-1120210379),h=E(h,m,u,c,o[f+2],15,718787259),c=E(c,h,m,u,o[f+9],21,-343485551),u=u+S>>>0,c=c+v>>>0,h=h+A>>>0,m=m+x>>>0}return e.endian([u,c,h,m])};n._ff=function(s,a,o,l,u,c,h){var m=s+(a&o|~a&l)+(u>>>0)+h;return(m<<c|m>>>32-c)+a},n._gg=function(s,a,o,l,u,c,h){var m=s+(a&l|o&~l)+(u>>>0)+h;return(m<<c|m>>>32-c)+a},n._hh=function(s,a,o,l,u,c,h){var m=s+(a^o^l)+(u>>>0)+h;return(m<<c|m>>>32-c)+a},n._ii=function(s,a,o,l,u,c,h){var m=s+(o^(a|~l))+(u>>>0)+h;return(m<<c|m>>>32-c)+a},n._blocksize=16,n._digestsize=16,hI.exports=function(s,a){if(s==null)throw new Error("Illegal argument "+s);var o=e.wordsToBytes(n(s,a));return a&&a.asBytes?o:a&&a.asString?r.bytesToString(o):e.bytesToHex(o)}})()});var yc=_e((AQ,pI)=>{"use strict";var F6="2.0.0",U6=Number.MAX_SAFE_INTEGER||9007199254740991,H6=16,j6=250,Y6=["major","premajor","minor","preminor","patch","prepatch","prerelease"];pI.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:H6,MAX_SAFE_BUILD_LENGTH:j6,MAX_SAFE_INTEGER:U6,RELEASE_TYPES:Y6,SEMVER_SPEC_VERSION:F6,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var _c=_e((CQ,fI)=>{"use strict";var G6=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};fI.exports=G6});var Dl=_e((ds,mI)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:C_,MAX_SAFE_BUILD_LENGTH:W6,MAX_LENGTH:z6}=yc(),V6=_c();ds=mI.exports={};var q6=ds.re=[],X6=ds.safeRe=[],De=ds.src=[],J6=ds.safeSrc=[],Be=ds.t={},$6=0,x_="[a-zA-Z0-9-]",K6=[["\\s",1],["\\d",z6],[x_,W6]],Z6=e=>{for(let[t,i]of K6)e=e.split(`${t}*`).join(`${t}{0,${i}}`).split(`${t}+`).join(`${t}{1,${i}}`);return e},st=(e,t,i)=>{let r=Z6(t),n=$6++;V6(e,n,t),Be[e]=n,De[n]=t,J6[n]=r,q6[n]=new RegExp(t,i?"g":void 0),X6[n]=new RegExp(r,i?"g":void 0)};st("NUMERICIDENTIFIER","0|[1-9]\\d*");st("NUMERICIDENTIFIERLOOSE","\\d+");st("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${x_}*`);st("MAINVERSION",`(${De[Be.NUMERICIDENTIFIER]})\\.(${De[Be.NUMERICIDENTIFIER]})\\.(${De[Be.NUMERICIDENTIFIER]})`);st("MAINVERSIONLOOSE",`(${De[Be.NUMERICIDENTIFIERLOOSE]})\\.(${De[Be.NUMERICIDENTIFIERLOOSE]})\\.(${De[Be.NUMERICIDENTIFIERLOOSE]})`);st("PRERELEASEIDENTIFIER",`(?:${De[Be.NONNUMERICIDENTIFIER]}|${De[Be.NUMERICIDENTIFIER]})`);st("PRERELEASEIDENTIFIERLOOSE",`(?:${De[Be.NONNUMERICIDENTIFIER]}|${De[Be.NUMERICIDENTIFIERLOOSE]})`);st("PRERELEASE",`(?:-(${De[Be.PRERELEASEIDENTIFIER]}(?:\\.${De[Be.PRERELEASEIDENTIFIER]})*))`);st("PRERELEASELOOSE",`(?:-?(${De[Be.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${De[Be.PRERELEASEIDENTIFIERLOOSE]})*))`);st("BUILDIDENTIFIER",`${x_}+`);st("BUILD",`(?:\\+(${De[Be.BUILDIDENTIFIER]}(?:\\.${De[Be.BUILDIDENTIFIER]})*))`);st("FULLPLAIN",`v?${De[Be.MAINVERSION]}${De[Be.PRERELEASE]}?${De[Be.BUILD]}?`);st("FULL",`^${De[Be.FULLPLAIN]}$`);st("LOOSEPLAIN",`[v=\\s]*${De[Be.MAINVERSIONLOOSE]}${De[Be.PRERELEASELOOSE]}?${De[Be.BUILD]}?`);st("LOOSE",`^${De[Be.LOOSEPLAIN]}$`);st("GTLT","((?:<|>)?=?)");st("XRANGEIDENTIFIERLOOSE",`${De[Be.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);st("XRANGEIDENTIFIER",`${De[Be.NUMERICIDENTIFIER]}|x|X|\\*`);st("XRANGEPLAIN",`[v=\\s]*(${De[Be.XRANGEIDENTIFIER]})(?:\\.(${De[Be.XRANGEIDENTIFIER]})(?:\\.(${De[Be.XRANGEIDENTIFIER]})(?:${De[Be.PRERELEASE]})?${De[Be.BUILD]}?)?)?`);st("XRANGEPLAINLOOSE",`[v=\\s]*(${De[Be.XRANGEIDENTIFIERLOOSE]})(?:\\.(${De[Be.XRANGEIDENTIFIERLOOSE]})(?:\\.(${De[Be.XRANGEIDENTIFIERLOOSE]})(?:${De[Be.PRERELEASELOOSE]})?${De[Be.BUILD]}?)?)?`);st("XRANGE",`^${De[Be.GTLT]}\\s*${De[Be.XRANGEPLAIN]}$`);st("XRANGELOOSE",`^${De[Be.GTLT]}\\s*${De[Be.XRANGEPLAINLOOSE]}$`);st("COERCEPLAIN",`(^|[^\\d])(\\d{1,${C_}})(?:\\.(\\d{1,${C_}}))?(?:\\.(\\d{1,${C_}}))?`);st("COERCE",`${De[Be.COERCEPLAIN]}(?:$|[^\\d])`);st("COERCEFULL",De[Be.COERCEPLAIN]+`(?:${De[Be.PRERELEASE]})?(?:${De[Be.BUILD]})?(?:$|[^\\d])`);st("COERCERTL",De[Be.COERCE],!0);st("COERCERTLFULL",De[Be.COERCEFULL],!0);st("LONETILDE","(?:~>?)");st("TILDETRIM",`(\\s*)${De[Be.LONETILDE]}\\s+`,!0);ds.tildeTrimReplace="$1~";st("TILDE",`^${De[Be.LONETILDE]}${De[Be.XRANGEPLAIN]}$`);st("TILDELOOSE",`^${De[Be.LONETILDE]}${De[Be.XRANGEPLAINLOOSE]}$`);st("LONECARET","(?:\\^)");st("CARETTRIM",`(\\s*)${De[Be.LONECARET]}\\s+`,!0);ds.caretTrimReplace="$1^";st("CARET",`^${De[Be.LONECARET]}${De[Be.XRANGEPLAIN]}$`);st("CARETLOOSE",`^${De[Be.LONECARET]}${De[Be.XRANGEPLAINLOOSE]}$`);st("COMPARATORLOOSE",`^${De[Be.GTLT]}\\s*(${De[Be.LOOSEPLAIN]})$|^$`);st("COMPARATOR",`^${De[Be.GTLT]}\\s*(${De[Be.FULLPLAIN]})$|^$`);st("COMPARATORTRIM",`(\\s*)${De[Be.GTLT]}\\s*(${De[Be.LOOSEPLAIN]}|${De[Be.XRANGEPLAIN]})`,!0);ds.comparatorTrimReplace="$1$2$3";st("HYPHENRANGE",`^\\s*(${De[Be.XRANGEPLAIN]})\\s+-\\s+(${De[Be.XRANGEPLAIN]})\\s*$`);st("HYPHENRANGELOOSE",`^\\s*(${De[Be.XRANGEPLAINLOOSE]})\\s+-\\s+(${De[Be.XRANGEPLAINLOOSE]})\\s*$`);st("STAR","(<|>)?=?\\s*\\*");st("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");st("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Qh=_e((xQ,gI)=>{"use strict";var Q6=Object.freeze({loose:!0}),e8=Object.freeze({}),t8=e=>e?typeof e!="object"?Q6:e:e8;gI.exports=t8});var T_=_e((TQ,bI)=>{"use strict";var yI=/^[0-9]+$/,_I=(e,t)=>{let i=yI.test(e),r=yI.test(t);return i&&r&&(e=+e,t=+t),e===t?0:i&&!r?-1:r&&!i?1:e<t?-1:1},i8=(e,t)=>_I(t,e);bI.exports={compareIdentifiers:_I,rcompareIdentifiers:i8}});var or=_e((wQ,EI)=>{"use strict";var ep=_c(),{MAX_LENGTH:PI,MAX_SAFE_INTEGER:tp}=yc(),{safeRe:ip,t:rp}=Dl(),r8=Qh(),{compareIdentifiers:Bl}=T_(),w_=class e{constructor(t,i){if(i=r8(i),t instanceof e){if(t.loose===!!i.loose&&t.includePrerelease===!!i.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>PI)throw new TypeError(`version is longer than ${PI} characters`);ep("SemVer",t,i),this.options=i,this.loose=!!i.loose,this.includePrerelease=!!i.includePrerelease;let r=t.trim().match(i.loose?ip[rp.LOOSE]:ip[rp.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>tp||this.major<0)throw new TypeError("Invalid major version");if(this.minor>tp||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>tp||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(n=>{if(/^[0-9]+$/.test(n)){let s=+n;if(s>=0&&s<tp)return s}return n}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(ep("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if(typeof t=="string"&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof e||(t=new e(t,this.options)),Bl(this.major,t.major)||Bl(this.minor,t.minor)||Bl(this.patch,t.patch)}comparePre(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let i=0;do{let r=this.prerelease[i],n=t.prerelease[i];if(ep("prerelease compare",i,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return Bl(r,n)}while(++i)}compareBuild(t){t instanceof e||(t=new e(t,this.options));let i=0;do{let r=this.build[i],n=t.build[i];if(ep("build compare",i,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return Bl(r,n)}while(++i)}inc(t,i,r){if(t.startsWith("pre")){if(!i&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(i){let n=`-${i}`.match(this.options.loose?ip[rp.PRERELEASELOOSE]:ip[rp.PRERELEASE]);if(!n||n[1]!==i)throw new Error(`invalid identifier: ${i}`)}}switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",i,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",i,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",i,r),this.inc("pre",i,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",i,r),this.inc("pre",i,r);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let n=Number(r)?1:0;if(this.prerelease.length===0)this.prerelease=[n];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(i===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(i){let s=[i,n];r===!1&&(s=[i]),Bl(this.prerelease[0],i)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};EI.exports=w_});var xo=_e((RQ,vI)=>{"use strict";var SI=or(),n8=(e,t,i=!1)=>{if(e instanceof SI)return e;try{return new SI(e,t)}catch(r){if(!i)return null;throw r}};vI.exports=n8});var AI=_e((LQ,II)=>{"use strict";var s8=xo(),a8=(e,t)=>{let i=s8(e,t);return i?i.version:null};II.exports=a8});var xI=_e((NQ,CI)=>{"use strict";var o8=xo(),l8=(e,t)=>{let i=o8(e.trim().replace(/^[=v]+/,""),t);return i?i.version:null};CI.exports=l8});var RI=_e((DQ,wI)=>{"use strict";var TI=or(),u8=(e,t,i,r,n)=>{typeof i=="string"&&(n=r,r=i,i=void 0);try{return new TI(e instanceof TI?e.version:e,i).inc(t,r,n).version}catch{return null}};wI.exports=u8});var DI=_e((BQ,NI)=>{"use strict";var LI=xo(),c8=(e,t)=>{let i=LI(e,null,!0),r=LI(t,null,!0),n=i.compare(r);if(n===0)return null;let s=n>0,a=s?i:r,o=s?r:i,l=!!a.prerelease.length;if(!!o.prerelease.length&&!l){if(!o.patch&&!o.minor)return"major";if(o.compareMain(a)===0)return o.minor&&!o.patch?"minor":"patch"}let c=l?"pre":"";return i.major!==r.major?c+"major":i.minor!==r.minor?c+"minor":i.patch!==r.patch?c+"patch":"prerelease"};NI.exports=c8});var OI=_e((OQ,BI)=>{"use strict";var d8=or(),h8=(e,t)=>new d8(e,t).major;BI.exports=h8});var kI=_e((MQ,MI)=>{"use strict";var p8=or(),f8=(e,t)=>new p8(e,t).minor;MI.exports=f8});var UI=_e((kQ,FI)=>{"use strict";var m8=or(),g8=(e,t)=>new m8(e,t).patch;FI.exports=g8});var jI=_e((FQ,HI)=>{"use strict";var y8=xo(),_8=(e,t)=>{let i=y8(e,t);return i&&i.prerelease.length?i.prerelease:null};HI.exports=_8});var _n=_e((UQ,GI)=>{"use strict";var YI=or(),b8=(e,t,i)=>new YI(e,i).compare(new YI(t,i));GI.exports=b8});var zI=_e((HQ,WI)=>{"use strict";var P8=_n(),E8=(e,t,i)=>P8(t,e,i);WI.exports=E8});var qI=_e((jQ,VI)=>{"use strict";var S8=_n(),v8=(e,t)=>S8(e,t,!0);VI.exports=v8});var np=_e((YQ,JI)=>{"use strict";var XI=or(),I8=(e,t,i)=>{let r=new XI(e,i),n=new XI(t,i);return r.compare(n)||r.compareBuild(n)};JI.exports=I8});var KI=_e((GQ,$I)=>{"use strict";var A8=np(),C8=(e,t)=>e.sort((i,r)=>A8(i,r,t));$I.exports=C8});var QI=_e((WQ,ZI)=>{"use strict";var x8=np(),T8=(e,t)=>e.sort((i,r)=>x8(r,i,t));ZI.exports=T8});var bc=_e((zQ,eA)=>{"use strict";var w8=_n(),R8=(e,t,i)=>w8(e,t,i)>0;eA.exports=R8});var sp=_e((VQ,tA)=>{"use strict";var L8=_n(),N8=(e,t,i)=>L8(e,t,i)<0;tA.exports=N8});var R_=_e((qQ,iA)=>{"use strict";var D8=_n(),B8=(e,t,i)=>D8(e,t,i)===0;iA.exports=B8});var L_=_e((XQ,rA)=>{"use strict";var O8=_n(),M8=(e,t,i)=>O8(e,t,i)!==0;rA.exports=M8});var ap=_e((JQ,nA)=>{"use strict";var k8=_n(),F8=(e,t,i)=>k8(e,t,i)>=0;nA.exports=F8});var op=_e(($Q,sA)=>{"use strict";var U8=_n(),H8=(e,t,i)=>U8(e,t,i)<=0;sA.exports=H8});var N_=_e((KQ,aA)=>{"use strict";var j8=R_(),Y8=L_(),G8=bc(),W8=ap(),z8=sp(),V8=op(),q8=(e,t,i,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof i=="object"&&(i=i.version),e===i;case"!==":return typeof e=="object"&&(e=e.version),typeof i=="object"&&(i=i.version),e!==i;case"":case"=":case"==":return j8(e,i,r);case"!=":return Y8(e,i,r);case">":return G8(e,i,r);case">=":return W8(e,i,r);case"<":return z8(e,i,r);case"<=":return V8(e,i,r);default:throw new TypeError(`Invalid operator: ${t}`)}};aA.exports=q8});var lA=_e((ZQ,oA)=>{"use strict";var X8=or(),J8=xo(),{safeRe:lp,t:up}=Dl(),$8=(e,t)=>{if(e instanceof X8)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let i=null;if(!t.rtl)i=e.match(t.includePrerelease?lp[up.COERCEFULL]:lp[up.COERCE]);else{let l=t.includePrerelease?lp[up.COERCERTLFULL]:lp[up.COERCERTL],u;for(;(u=l.exec(e))&&(!i||i.index+i[0].length!==e.length);)(!i||u.index+u[0].length!==i.index+i[0].length)&&(i=u),l.lastIndex=u.index+u[1].length+u[2].length;l.lastIndex=-1}if(i===null)return null;let r=i[2],n=i[3]||"0",s=i[4]||"0",a=t.includePrerelease&&i[5]?`-${i[5]}`:"",o=t.includePrerelease&&i[6]?`+${i[6]}`:"";return J8(`${r}.${n}.${s}${a}${o}`,t)};oA.exports=$8});var cA=_e((QQ,uA)=>{"use strict";var D_=class{constructor(){this.max=1e3,this.map=new Map}get(t){let i=this.map.get(t);if(i!==void 0)return this.map.delete(t),this.map.set(t,i),i}delete(t){return this.map.delete(t)}set(t,i){if(!this.delete(t)&&i!==void 0){if(this.map.size>=this.max){let n=this.map.keys().next().value;this.delete(n)}this.map.set(t,i)}return this}};uA.exports=D_});var bn=_e((eee,fA)=>{"use strict";var K8=/\s+/g,B_=class e{constructor(t,i){if(i=Q8(i),t instanceof e)return t.loose===!!i.loose&&t.includePrerelease===!!i.includePrerelease?t:new e(t.raw,i);if(t instanceof O_)return this.raw=t.value,this.set=[[t]],this.formatted=void 0,this;if(this.options=i,this.loose=!!i.loose,this.includePrerelease=!!i.includePrerelease,this.raw=t.trim().replace(K8," "),this.set=this.raw.split("||").map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let r=this.set[0];if(this.set=this.set.filter(n=>!hA(n[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(let n of this.set)if(n.length===1&&aF(n[0])){this.set=[n];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let t=0;t<this.set.length;t++){t>0&&(this.formatted+="||");let i=this.set[t];for(let r=0;r<i.length;r++)r>0&&(this.formatted+=" "),this.formatted+=i[r].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(t){let r=((this.options.includePrerelease&&nF)|(this.options.loose&&sF))+":"+t,n=dA.get(r);if(n)return n;let s=this.options.loose,a=s?Nr[_r.HYPHENRANGELOOSE]:Nr[_r.HYPHENRANGE];t=t.replace(a,gF(this.options.includePrerelease)),Kt("hyphen replace",t),t=t.replace(Nr[_r.COMPARATORTRIM],tF),Kt("comparator trim",t),t=t.replace(Nr[_r.TILDETRIM],iF),Kt("tilde trim",t),t=t.replace(Nr[_r.CARETTRIM],rF),Kt("caret trim",t);let o=t.split(" ").map(h=>oF(h,this.options)).join(" ").split(/\s+/).map(h=>mF(h,this.options));s&&(o=o.filter(h=>(Kt("loose invalid filter",h,this.options),!!h.match(Nr[_r.COMPARATORLOOSE])))),Kt("range list",o);let l=new Map,u=o.map(h=>new O_(h,this.options));for(let h of u){if(hA(h))return[h];l.set(h.value,h)}l.size>1&&l.has("")&&l.delete("");let c=[...l.values()];return dA.set(r,c),c}intersects(t,i){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some(r=>pA(r,i)&&t.set.some(n=>pA(n,i)&&r.every(s=>n.every(a=>s.intersects(a,i)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new eF(t,this.options)}catch{return!1}for(let i=0;i<this.set.length;i++)if(yF(this.set[i],t,this.options))return!0;return!1}};fA.exports=B_;var Z8=cA(),dA=new Z8,Q8=Qh(),O_=Pc(),Kt=_c(),eF=or(),{safeRe:Nr,t:_r,comparatorTrimReplace:tF,tildeTrimReplace:iF,caretTrimReplace:rF}=Dl(),{FLAG_INCLUDE_PRERELEASE:nF,FLAG_LOOSE:sF}=yc(),hA=e=>e.value==="<0.0.0-0",aF=e=>e.value==="",pA=(e,t)=>{let i=!0,r=e.slice(),n=r.pop();for(;i&&r.length;)i=r.every(s=>n.intersects(s,t)),n=r.pop();return i},oF=(e,t)=>(Kt("comp",e,t),e=cF(e,t),Kt("caret",e),e=lF(e,t),Kt("tildes",e),e=hF(e,t),Kt("xrange",e),e=fF(e,t),Kt("stars",e),e),br=e=>!e||e.toLowerCase()==="x"||e==="*",lF=(e,t)=>e.trim().split(/\s+/).map(i=>uF(i,t)).join(" "),uF=(e,t)=>{let i=t.loose?Nr[_r.TILDELOOSE]:Nr[_r.TILDE];return e.replace(i,(r,n,s,a,o)=>{Kt("tilde",e,r,n,s,a,o);let l;return br(n)?l="":br(s)?l=`>=${n}.0.0 <${+n+1}.0.0-0`:br(a)?l=`>=${n}.${s}.0 <${n}.${+s+1}.0-0`:o?(Kt("replaceTilde pr",o),l=`>=${n}.${s}.${a}-${o} <${n}.${+s+1}.0-0`):l=`>=${n}.${s}.${a} <${n}.${+s+1}.0-0`,Kt("tilde return",l),l})},cF=(e,t)=>e.trim().split(/\s+/).map(i=>dF(i,t)).join(" "),dF=(e,t)=>{Kt("caret",e,t);let i=t.loose?Nr[_r.CARETLOOSE]:Nr[_r.CARET],r=t.includePrerelease?"-0":"";return e.replace(i,(n,s,a,o,l)=>{Kt("caret",e,n,s,a,o,l);let u;return br(s)?u="":br(a)?u=`>=${s}.0.0${r} <${+s+1}.0.0-0`:br(o)?s==="0"?u=`>=${s}.${a}.0${r} <${s}.${+a+1}.0-0`:u=`>=${s}.${a}.0${r} <${+s+1}.0.0-0`:l?(Kt("replaceCaret pr",l),s==="0"?a==="0"?u=`>=${s}.${a}.${o}-${l} <${s}.${a}.${+o+1}-0`:u=`>=${s}.${a}.${o}-${l} <${s}.${+a+1}.0-0`:u=`>=${s}.${a}.${o}-${l} <${+s+1}.0.0-0`):(Kt("no pr"),s==="0"?a==="0"?u=`>=${s}.${a}.${o}${r} <${s}.${a}.${+o+1}-0`:u=`>=${s}.${a}.${o}${r} <${s}.${+a+1}.0-0`:u=`>=${s}.${a}.${o} <${+s+1}.0.0-0`),Kt("caret return",u),u})},hF=(e,t)=>(Kt("replaceXRanges",e,t),e.split(/\s+/).map(i=>pF(i,t)).join(" ")),pF=(e,t)=>{e=e.trim();let i=t.loose?Nr[_r.XRANGELOOSE]:Nr[_r.XRANGE];return e.replace(i,(r,n,s,a,o,l)=>{Kt("xRange",e,r,n,s,a,o,l);let u=br(s),c=u||br(a),h=c||br(o),m=h;return n==="="&&m&&(n=""),l=t.includePrerelease?"-0":"",u?n===">"||n==="<"?r="<0.0.0-0":r="*":n&&m?(c&&(a=0),o=0,n===">"?(n=">=",c?(s=+s+1,a=0,o=0):(a=+a+1,o=0)):n==="<="&&(n="<",c?s=+s+1:a=+a+1),n==="<"&&(l="-0"),r=`${n+s}.${a}.${o}${l}`):c?r=`>=${s}.0.0${l} <${+s+1}.0.0-0`:h&&(r=`>=${s}.${a}.0${l} <${s}.${+a+1}.0-0`),Kt("xRange return",r),r})},fF=(e,t)=>(Kt("replaceStars",e,t),e.trim().replace(Nr[_r.STAR],"")),mF=(e,t)=>(Kt("replaceGTE0",e,t),e.trim().replace(Nr[t.includePrerelease?_r.GTE0PRE:_r.GTE0],"")),gF=e=>(t,i,r,n,s,a,o,l,u,c,h,m)=>(br(r)?i="":br(n)?i=`>=${r}.0.0${e?"-0":""}`:br(s)?i=`>=${r}.${n}.0${e?"-0":""}`:a?i=`>=${i}`:i=`>=${i}${e?"-0":""}`,br(u)?l="":br(c)?l=`<${+u+1}.0.0-0`:br(h)?l=`<${u}.${+c+1}.0-0`:m?l=`<=${u}.${c}.${h}-${m}`:e?l=`<${u}.${c}.${+h+1}-0`:l=`<=${l}`,`${i} ${l}`.trim()),yF=(e,t,i)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!i.includePrerelease){for(let r=0;r<e.length;r++)if(Kt(e[r].semver),e[r].semver!==O_.ANY&&e[r].semver.prerelease.length>0){let n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}});var Pc=_e((tee,PA)=>{"use strict";var Ec=Symbol("SemVer ANY"),F_=class e{static get ANY(){return Ec}constructor(t,i){if(i=mA(i),t instanceof e){if(t.loose===!!i.loose)return t;t=t.value}t=t.trim().split(/\s+/).join(" "),k_("comparator",t,i),this.options=i,this.loose=!!i.loose,this.parse(t),this.semver===Ec?this.value="":this.value=this.operator+this.semver.version,k_("comp",this)}parse(t){let i=this.options.loose?gA[yA.COMPARATORLOOSE]:gA[yA.COMPARATOR],r=t.match(i);if(!r)throw new TypeError(`Invalid comparator: ${t}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new _A(r[2],this.options.loose):this.semver=Ec}toString(){return this.value}test(t){if(k_("Comparator.test",t,this.options.loose),this.semver===Ec||t===Ec)return!0;if(typeof t=="string")try{t=new _A(t,this.options)}catch{return!1}return M_(t,this.operator,this.semver,this.options)}intersects(t,i){if(!(t instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new bA(t.value,i).test(this.value):t.operator===""?t.value===""?!0:new bA(this.value,i).test(t.semver):(i=mA(i),i.includePrerelease&&(this.value==="<0.0.0-0"||t.value==="<0.0.0-0")||!i.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&t.operator.startsWith(">")||this.operator.startsWith("<")&&t.operator.startsWith("<")||this.semver.version===t.semver.version&&this.operator.includes("=")&&t.operator.includes("=")||M_(this.semver,"<",t.semver,i)&&this.operator.startsWith(">")&&t.operator.startsWith("<")||M_(this.semver,">",t.semver,i)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))}};PA.exports=F_;var mA=Qh(),{safeRe:gA,t:yA}=Dl(),M_=N_(),k_=_c(),_A=or(),bA=bn()});var Sc=_e((iee,EA)=>{"use strict";var _F=bn(),bF=(e,t,i)=>{try{t=new _F(t,i)}catch{return!1}return t.test(e)};EA.exports=bF});var vA=_e((ree,SA)=>{"use strict";var PF=bn(),EF=(e,t)=>new PF(e,t).set.map(i=>i.map(r=>r.value).join(" ").trim().split(" "));SA.exports=EF});var AA=_e((nee,IA)=>{"use strict";var SF=or(),vF=bn(),IF=(e,t,i)=>{let r=null,n=null,s=null;try{s=new vF(t,i)}catch{return null}return e.forEach(a=>{s.test(a)&&(!r||n.compare(a)===-1)&&(r=a,n=new SF(r,i))}),r};IA.exports=IF});var xA=_e((see,CA)=>{"use strict";var AF=or(),CF=bn(),xF=(e,t,i)=>{let r=null,n=null,s=null;try{s=new CF(t,i)}catch{return null}return e.forEach(a=>{s.test(a)&&(!r||n.compare(a)===1)&&(r=a,n=new AF(r,i))}),r};CA.exports=xF});var RA=_e((aee,wA)=>{"use strict";var U_=or(),TF=bn(),TA=bc(),wF=(e,t)=>{e=new TF(e,t);let i=new U_("0.0.0");if(e.test(i)||(i=new U_("0.0.0-0"),e.test(i)))return i;i=null;for(let r=0;r<e.set.length;++r){let n=e.set[r],s=null;n.forEach(a=>{let o=new U_(a.semver.version);switch(a.operator){case">":o.prerelease.length===0?o.patch++:o.prerelease.push(0),o.raw=o.format();case"":case">=":(!s||TA(o,s))&&(s=o);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),s&&(!i||TA(i,s))&&(i=s)}return i&&e.test(i)?i:null};wA.exports=wF});var NA=_e((oee,LA)=>{"use strict";var RF=bn(),LF=(e,t)=>{try{return new RF(e,t).range||"*"}catch{return null}};LA.exports=LF});var cp=_e((lee,MA)=>{"use strict";var NF=or(),OA=Pc(),{ANY:DF}=OA,BF=bn(),OF=Sc(),DA=bc(),BA=sp(),MF=op(),kF=ap(),FF=(e,t,i,r)=>{e=new NF(e,r),t=new BF(t,r);let n,s,a,o,l;switch(i){case">":n=DA,s=MF,a=BA,o=">",l=">=";break;case"<":n=BA,s=kF,a=DA,o="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(OF(e,t,r))return!1;for(let u=0;u<t.set.length;++u){let c=t.set[u],h=null,m=null;if(c.forEach(f=>{f.semver===DF&&(f=new OA(">=0.0.0")),h=h||f,m=m||f,n(f.semver,h.semver,r)?h=f:a(f.semver,m.semver,r)&&(m=f)}),h.operator===o||h.operator===l||(!m.operator||m.operator===o)&&s(e,m.semver))return!1;if(m.operator===l&&a(e,m.semver))return!1}return!0};MA.exports=FF});var FA=_e((uee,kA)=>{"use strict";var UF=cp(),HF=(e,t,i)=>UF(e,t,">",i);kA.exports=HF});var HA=_e((cee,UA)=>{"use strict";var jF=cp(),YF=(e,t,i)=>jF(e,t,"<",i);UA.exports=YF});var GA=_e((dee,YA)=>{"use strict";var jA=bn(),GF=(e,t,i)=>(e=new jA(e,i),t=new jA(t,i),e.intersects(t,i));YA.exports=GF});var zA=_e((hee,WA)=>{"use strict";var WF=Sc(),zF=_n();WA.exports=(e,t,i)=>{let r=[],n=null,s=null,a=e.sort((c,h)=>zF(c,h,i));for(let c of a)WF(c,t,i)?(s=c,n||(n=c)):(s&&r.push([n,s]),s=null,n=null);n&&r.push([n,null]);let o=[];for(let[c,h]of r)c===h?o.push(c):!h&&c===a[0]?o.push("*"):h?c===a[0]?o.push(`<=${h}`):o.push(`${c} - ${h}`):o.push(`>=${c}`);let l=o.join(" || "),u=typeof t.raw=="string"?t.raw:String(t);return l.length<u.length?l:t}});var KA=_e((pee,$A)=>{"use strict";var VA=bn(),j_=Pc(),{ANY:H_}=j_,vc=Sc(),Y_=_n(),VF=(e,t,i={})=>{if(e===t)return!0;e=new VA(e,i),t=new VA(t,i);let r=!1;e:for(let n of e.set){for(let s of t.set){let a=XF(n,s,i);if(r=r||a!==null,a)continue e}if(r)return!1}return!0},qF=[new j_(">=0.0.0-0")],qA=[new j_(">=0.0.0")],XF=(e,t,i)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===H_){if(t.length===1&&t[0].semver===H_)return!0;i.includePrerelease?e=qF:e=qA}if(t.length===1&&t[0].semver===H_){if(i.includePrerelease)return!0;t=qA}let r=new Set,n,s;for(let f of e)f.operator===">"||f.operator===">="?n=XA(n,f,i):f.operator==="<"||f.operator==="<="?s=JA(s,f,i):r.add(f.semver);if(r.size>1)return null;let a;if(n&&s){if(a=Y_(n.semver,s.semver,i),a>0)return null;if(a===0&&(n.operator!==">="||s.operator!=="<="))return null}for(let f of r){if(n&&!vc(f,String(n),i)||s&&!vc(f,String(s),i))return null;for(let g of t)if(!vc(f,String(g),i))return!1;return!0}let o,l,u,c,h=s&&!i.includePrerelease&&s.semver.prerelease.length?s.semver:!1,m=n&&!i.includePrerelease&&n.semver.prerelease.length?n.semver:!1;h&&h.prerelease.length===1&&s.operator==="<"&&h.prerelease[0]===0&&(h=!1);for(let f of t){if(c=c||f.operator===">"||f.operator===">=",u=u||f.operator==="<"||f.operator==="<=",n){if(m&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===m.major&&f.semver.minor===m.minor&&f.semver.patch===m.patch&&(m=!1),f.operator===">"||f.operator===">="){if(o=XA(n,f,i),o===f&&o!==n)return!1}else if(n.operator===">="&&!vc(n.semver,String(f),i))return!1}if(s){if(h&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===h.major&&f.semver.minor===h.minor&&f.semver.patch===h.patch&&(h=!1),f.operator==="<"||f.operator==="<="){if(l=JA(s,f,i),l===f&&l!==s)return!1}else if(s.operator==="<="&&!vc(s.semver,String(f),i))return!1}if(!f.operator&&(s||n)&&a!==0)return!1}return!(n&&u&&!s&&a!==0||s&&c&&!n&&a!==0||m||h)},XA=(e,t,i)=>{if(!e)return t;let r=Y_(e.semver,t.semver,i);return r>0?e:r<0||t.operator===">"&&e.operator===">="?t:e},JA=(e,t,i)=>{if(!e)return t;let r=Y_(e.semver,t.semver,i);return r<0?e:r>0||t.operator==="<"&&e.operator==="<="?t:e};$A.exports=VF});var W_=_e((fee,eC)=>{"use strict";var G_=Dl(),ZA=yc(),JF=or(),QA=T_(),$F=xo(),KF=AI(),ZF=xI(),QF=RI(),eU=DI(),tU=OI(),iU=kI(),rU=UI(),nU=jI(),sU=_n(),aU=zI(),oU=qI(),lU=np(),uU=KI(),cU=QI(),dU=bc(),hU=sp(),pU=R_(),fU=L_(),mU=ap(),gU=op(),yU=N_(),_U=lA(),bU=Pc(),PU=bn(),EU=Sc(),SU=vA(),vU=AA(),IU=xA(),AU=RA(),CU=NA(),xU=cp(),TU=FA(),wU=HA(),RU=GA(),LU=zA(),NU=KA();eC.exports={parse:$F,valid:KF,clean:ZF,inc:QF,diff:eU,major:tU,minor:iU,patch:rU,prerelease:nU,compare:sU,rcompare:aU,compareLoose:oU,compareBuild:lU,sort:uU,rsort:cU,gt:dU,lt:hU,eq:pU,neq:fU,gte:mU,lte:gU,cmp:yU,coerce:_U,Comparator:bU,Range:PU,satisfies:EU,toComparators:SU,maxSatisfying:vU,minSatisfying:IU,minVersion:AU,validRange:CU,outside:xU,gtr:TU,ltr:wU,intersects:RU,simplifyRange:LU,subset:NU,SemVer:JF,re:G_.re,src:G_.src,tokens:G_.t,SEMVER_SPEC_VERSION:ZA.SEMVER_SPEC_VERSION,RELEASE_TYPES:ZA.RELEASE_TYPES,compareIdentifiers:QA.compareIdentifiers,rcompareIdentifiers:QA.rcompareIdentifiers}});var bd=_e((qae,J0)=>{"use strict";typeof process>"u"||!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0?J0.exports={nextTick:Uq}:J0.exports=process;function Uq(e,t,i,r){if(typeof e!="function")throw new TypeError('"callback" argument must be a function');var n=arguments.length,s,a;switch(n){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,t)});case 3:return process.nextTick(function(){e.call(null,t,i)});case 4:return process.nextTick(function(){e.call(null,t,i,r)});default:for(s=new Array(n-1),a=0;a<s.length;)s[a++]=arguments[a];return process.nextTick(function(){e.apply(null,s)})}}});var c2=_e((Xae,u2)=>{var Hq={}.toString;u2.exports=Array.isArray||function(e){return Hq.call(e)=="[object Array]"}});var $0=_e((Jae,d2)=>{d2.exports=ar("stream")});var Pd=_e((K0,p2)=>{var hm=ar("buffer"),ha=hm.Buffer;function h2(e,t){for(var i in e)t[i]=e[i]}ha.from&&ha.alloc&&ha.allocUnsafe&&ha.allocUnsafeSlow?p2.exports=hm:(h2(hm,K0),K0.Buffer=_u);function _u(e,t,i){return ha(e,t,i)}h2(ha,_u);_u.from=function(e,t,i){if(typeof e=="number")throw new TypeError("Argument must not be a number");return ha(e,t,i)};_u.alloc=function(e,t,i){if(typeof e!="number")throw new TypeError("Argument must be a number");var r=ha(e);return t!==void 0?typeof i=="string"?r.fill(t,i):r.fill(t):r.fill(0),r};_u.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return ha(e)};_u.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return hm.SlowBuffer(e)}});var bu=_e(dr=>{function jq(e){return Array.isArray?Array.isArray(e):pm(e)==="[object Array]"}dr.isArray=jq;function Yq(e){return typeof e=="boolean"}dr.isBoolean=Yq;function Gq(e){return e===null}dr.isNull=Gq;function Wq(e){return e==null}dr.isNullOrUndefined=Wq;function zq(e){return typeof e=="number"}dr.isNumber=zq;function Vq(e){return typeof e=="string"}dr.isString=Vq;function qq(e){return typeof e=="symbol"}dr.isSymbol=qq;function Xq(e){return e===void 0}dr.isUndefined=Xq;function Jq(e){return pm(e)==="[object RegExp]"}dr.isRegExp=Jq;function $q(e){return typeof e=="object"&&e!==null}dr.isObject=$q;function Kq(e){return pm(e)==="[object Date]"}dr.isDate=Kq;function Zq(e){return pm(e)==="[object Error]"||e instanceof Error}dr.isError=Zq;function Qq(e){return typeof e=="function"}dr.isFunction=Qq;function eX(e){return e===null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||typeof e=="symbol"||typeof e>"u"}dr.isPrimitive=eX;dr.isBuffer=ar("buffer").Buffer.isBuffer;function pm(e){return Object.prototype.toString.call(e)}});var f2=_e((Kae,Z0)=>{typeof Object.create=="function"?Z0.exports=function(t,i){i&&(t.super_=i,t.prototype=Object.create(i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Z0.exports=function(t,i){if(i){t.super_=i;var r=function(){};r.prototype=i.prototype,t.prototype=new r,t.prototype.constructor=t}}});var Pu=_e((Zae,eP)=>{try{if(Q0=ar("util"),typeof Q0.inherits!="function")throw"";eP.exports=Q0.inherits}catch{eP.exports=f2()}var Q0});var g2=_e((Qae,tP)=>{"use strict";function tX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var m2=Pd().Buffer,Ed=ar("util");function iX(e,t,i){e.copy(t,i)}tP.exports=(function(){function e(){tX(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(i){var r={data:i,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length},e.prototype.unshift=function(i){var r={data:i,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length},e.prototype.shift=function(){if(this.length!==0){var i=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,i}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(i){if(this.length===0)return"";for(var r=this.head,n=""+r.data;r=r.next;)n+=i+r.data;return n},e.prototype.concat=function(i){if(this.length===0)return m2.alloc(0);for(var r=m2.allocUnsafe(i>>>0),n=this.head,s=0;n;)iX(n.data,r,s),s+=n.data.length,n=n.next;return r},e})();Ed&&Ed.inspect&&Ed.inspect.custom&&(tP.exports.prototype[Ed.inspect.custom]=function(){var e=Ed.inspect({length:this.length});return this.constructor.name+" "+e})});var iP=_e((eoe,y2)=>{"use strict";var fm=bd();function rX(e,t){var i=this,r=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return r||n?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,fm.nextTick(mm,this,e)):fm.nextTick(mm,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(s){!t&&s?i._writableState?i._writableState.errorEmitted||(i._writableState.errorEmitted=!0,fm.nextTick(mm,i,s)):fm.nextTick(mm,i,s):t&&t(s)}),this)}function nX(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function mm(e,t){e.emit("error",t)}y2.exports={destroy:rX,undestroy:nX}});var b2=_e((toe,_2)=>{_2.exports=ar("util").deprecate});var nP=_e((ioe,x2)=>{"use strict";var Qo=bd();x2.exports=Ti;function E2(e){var t=this;this.next=null,this.entry=null,this.finish=function(){SX(t,e)}}var sX=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:Qo.nextTick,Eu;Ti.WritableState=vd;var S2=Object.create(bu());S2.inherits=Pu();var aX={deprecate:b2()},v2=$0(),ym=Pd().Buffer,oX=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function lX(e){return ym.from(e)}function uX(e){return ym.isBuffer(e)||e instanceof oX}var I2=iP();S2.inherits(Ti,v2);function cX(){}function vd(e,t){Eu=Eu||el(),e=e||{};var i=t instanceof Eu;this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,n=e.writableHighWaterMark,s=this.objectMode?16:16*1024;r||r===0?this.highWaterMark=r:i&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=s,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=e.decodeStrings===!1;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(o){yX(t,o)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new E2(this)}vd.prototype.getBuffer=function(){for(var t=this.bufferedRequest,i=[];t;)i.push(t),t=t.next;return i};(function(){try{Object.defineProperty(vd.prototype,"buffer",{get:aX.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var gm;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(gm=Function.prototype[Symbol.hasInstance],Object.defineProperty(Ti,Symbol.hasInstance,{value:function(e){return gm.call(this,e)?!0:this!==Ti?!1:e&&e._writableState instanceof vd}})):gm=function(e){return e instanceof this};function Ti(e){if(Eu=Eu||el(),!gm.call(Ti,this)&&!(this instanceof Eu))return new Ti(e);this._writableState=new vd(e,this),this.writable=!0,e&&(typeof e.write=="function"&&(this._write=e.write),typeof e.writev=="function"&&(this._writev=e.writev),typeof e.destroy=="function"&&(this._destroy=e.destroy),typeof e.final=="function"&&(this._final=e.final)),v2.call(this)}Ti.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function dX(e,t){var i=new Error("write after end");e.emit("error",i),Qo.nextTick(t,i)}function hX(e,t,i,r){var n=!0,s=!1;return i===null?s=new TypeError("May not write null values to stream"):typeof i!="string"&&i!==void 0&&!t.objectMode&&(s=new TypeError("Invalid non-string/buffer chunk")),s&&(e.emit("error",s),Qo.nextTick(r,s),n=!1),n}Ti.prototype.write=function(e,t,i){var r=this._writableState,n=!1,s=!r.objectMode&&uX(e);return s&&!ym.isBuffer(e)&&(e=lX(e)),typeof t=="function"&&(i=t,t=null),s?t="buffer":t||(t=r.defaultEncoding),typeof i!="function"&&(i=cX),r.ended?dX(this,i):(s||hX(this,r,e,i))&&(r.pendingcb++,n=fX(this,r,s,e,t,i)),n};Ti.prototype.cork=function(){var e=this._writableState;e.corked++};Ti.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,!e.writing&&!e.corked&&!e.bufferProcessing&&e.bufferedRequest&&A2(this,e))};Ti.prototype.setDefaultEncoding=function(t){if(typeof t=="string"&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this};function pX(e,t,i){return!e.objectMode&&e.decodeStrings!==!1&&typeof t=="string"&&(t=ym.from(t,i)),t}Object.defineProperty(Ti.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function fX(e,t,i,r,n,s){if(!i){var a=pX(t,r,n);r!==a&&(i=!0,n="buffer",r=a)}var o=t.objectMode?1:r.length;t.length+=o;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:n,isBuf:i,callback:s,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else rP(e,t,!1,o,r,n,s);return l}function rP(e,t,i,r,n,s,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,i?e._writev(n,t.onwrite):e._write(n,s,t.onwrite),t.sync=!1}function mX(e,t,i,r,n){--t.pendingcb,i?(Qo.nextTick(n,r),Qo.nextTick(Sd,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(n(r),e._writableState.errorEmitted=!0,e.emit("error",r),Sd(e,t))}function gX(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function yX(e,t){var i=e._writableState,r=i.sync,n=i.writecb;if(gX(i),t)mX(e,i,r,t,n);else{var s=C2(i);!s&&!i.corked&&!i.bufferProcessing&&i.bufferedRequest&&A2(e,i),r?sX(P2,e,i,s,n):P2(e,i,s,n)}}function P2(e,t,i,r){i||_X(e,t),t.pendingcb--,r(),Sd(e,t)}function _X(e,t){t.length===0&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function A2(e,t){t.bufferProcessing=!0;var i=t.bufferedRequest;if(e._writev&&i&&i.next){var r=t.bufferedRequestCount,n=new Array(r),s=t.corkedRequestsFree;s.entry=i;for(var a=0,o=!0;i;)n[a]=i,i.isBuf||(o=!1),i=i.next,a+=1;n.allBuffers=o,rP(e,t,!0,t.length,n,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new E2(t),t.bufferedRequestCount=0}else{for(;i;){var l=i.chunk,u=i.encoding,c=i.callback,h=t.objectMode?1:l.length;if(rP(e,t,!1,h,l,u,c),i=i.next,t.bufferedRequestCount--,t.writing)break}i===null&&(t.lastBufferedRequest=null)}t.bufferedRequest=i,t.bufferProcessing=!1}Ti.prototype._write=function(e,t,i){i(new Error("_write() is not implemented"))};Ti.prototype._writev=null;Ti.prototype.end=function(e,t,i){var r=this._writableState;typeof e=="function"?(i=e,e=null,t=null):typeof t=="function"&&(i=t,t=null),e!=null&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||EX(this,r,i)};function C2(e){return e.ending&&e.length===0&&e.bufferedRequest===null&&!e.finished&&!e.writing}function bX(e,t){e._final(function(i){t.pendingcb--,i&&e.emit("error",i),t.prefinished=!0,e.emit("prefinish"),Sd(e,t)})}function PX(e,t){!t.prefinished&&!t.finalCalled&&(typeof e._final=="function"?(t.pendingcb++,t.finalCalled=!0,Qo.nextTick(bX,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function Sd(e,t){var i=C2(t);return i&&(PX(e,t),t.pendingcb===0&&(t.finished=!0,e.emit("finish"))),i}function EX(e,t,i){t.ending=!0,Sd(e,t),i&&(t.finished?Qo.nextTick(i):e.once("finish",i)),t.ended=!0,e.writable=!1}function SX(e,t,i){var r=e.entry;for(e.entry=null;r;){var n=r.callback;t.pendingcb--,n(i),r=r.next}t.corkedRequestsFree.next=e}Object.defineProperty(Ti.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}});Ti.prototype.destroy=I2.destroy;Ti.prototype._undestroy=I2.undestroy;Ti.prototype._destroy=function(e,t){this.end(),t(e)}});var el=_e((roe,L2)=>{"use strict";var T2=bd(),vX=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t};L2.exports=pa;var w2=Object.create(bu());w2.inherits=Pu();var R2=oP(),aP=nP();w2.inherits(pa,R2);for(sP=vX(aP.prototype),_m=0;_m<sP.length;_m++)bm=sP[_m],pa.prototype[bm]||(pa.prototype[bm]=aP.prototype[bm]);var sP,bm,_m;function pa(e){if(!(this instanceof pa))return new pa(e);R2.call(this,e),aP.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",IX)}Object.defineProperty(pa.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function IX(){this.allowHalfOpen||this._writableState.ended||T2.nextTick(AX,this)}function AX(e){e.end()}Object.defineProperty(pa.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}});pa.prototype._destroy=function(e,t){this.push(null),this.end(),T2.nextTick(t,e)}});var cP=_e(D2=>{"use strict";var uP=Pd().Buffer,N2=uP.isEncoding||function(e){switch(e=""+e,e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function CX(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function xX(e){var t=CX(e);if(typeof t!="string"&&(uP.isEncoding===N2||!N2(e)))throw new Error("Unknown encoding: "+e);return t||e}D2.StringDecoder=Id;function Id(e){this.encoding=xX(e);var t;switch(this.encoding){case"utf16le":this.text=DX,this.end=BX,t=4;break;case"utf8":this.fillLast=RX,t=4;break;case"base64":this.text=OX,this.end=MX,t=3;break;default:this.write=kX,this.end=FX;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=uP.allocUnsafe(t)}Id.prototype.write=function(e){if(e.length===0)return"";var t,i;if(this.lastNeed){if(t=this.fillLast(e),t===void 0)return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<e.length?t?t+this.text(e,i):this.text(e,i):t||""};Id.prototype.end=NX;Id.prototype.text=LX;Id.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length};function lP(e){return e<=127?0:e>>5===6?2:e>>4===14?3:e>>3===30?4:e>>6===2?-1:-2}function TX(e,t,i){var r=t.length-1;if(r<i)return 0;var n=lP(t[r]);return n>=0?(n>0&&(e.lastNeed=n-1),n):--r<i||n===-2?0:(n=lP(t[r]),n>=0?(n>0&&(e.lastNeed=n-2),n):--r<i||n===-2?0:(n=lP(t[r]),n>=0?(n>0&&(n===2?n=0:e.lastNeed=n-3),n):0))}function wX(e,t,i){if((t[0]&192)!==128)return e.lastNeed=0,"\uFFFD";if(e.lastNeed>1&&t.length>1){if((t[1]&192)!==128)return e.lastNeed=1,"\uFFFD";if(e.lastNeed>2&&t.length>2&&(t[2]&192)!==128)return e.lastNeed=2,"\uFFFD"}}function RX(e){var t=this.lastTotal-this.lastNeed,i=wX(this,e,t);if(i!==void 0)return i;if(this.lastNeed<=e.length)return e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,t,0,e.length),this.lastNeed-=e.length}function LX(e,t){var i=TX(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=i;var r=e.length-(i-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)}function NX(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"\uFFFD":t}function DX(e,t){if((e.length-t)%2===0){var i=e.toString("utf16le",t);if(i){var r=i.charCodeAt(i.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function BX(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,i)}return t}function OX(e,t){var i=(e.length-t)%3;return i===0?e.toString("base64",t):(this.lastNeed=3-i,this.lastTotal=3,i===1?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-i))}function MX(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function kX(e){return e.toString(this.encoding)}function FX(e){return e&&e.length?this.write(e):""}});var oP=_e((aoe,z2)=>{"use strict";var vu=bd();z2.exports=ei;var UX=c2(),Ad;ei.ReadableState=H2;var soe=ar("events").EventEmitter,k2=function(e,t){return e.listeners(t).length},mP=$0(),Cd=Pd().Buffer,HX=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function jX(e){return Cd.from(e)}function YX(e){return Cd.isBuffer(e)||e instanceof HX}var F2=Object.create(bu());F2.inherits=Pu();var dP=ar("util"),Bt=void 0;dP&&dP.debuglog?Bt=dP.debuglog("stream"):Bt=function(){};var GX=g2(),U2=iP(),Su;F2.inherits(ei,mP);var hP=["error","close","destroy","pause","resume"];function WX(e,t,i){if(typeof e.prependListener=="function")return e.prependListener(t,i);!e._events||!e._events[t]?e.on(t,i):UX(e._events[t])?e._events[t].unshift(i):e._events[t]=[i,e._events[t]]}function H2(e,t){Ad=Ad||el(),e=e||{};var i=t instanceof Ad;this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,n=e.readableHighWaterMark,s=this.objectMode?16:16*1024;r||r===0?this.highWaterMark=r:i&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new GX,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(Su||(Su=cP().StringDecoder),this.decoder=new Su(e.encoding),this.encoding=e.encoding)}function ei(e){if(Ad=Ad||el(),!(this instanceof ei))return new ei(e);this._readableState=new H2(e,this),this.readable=!0,e&&(typeof e.read=="function"&&(this._read=e.read),typeof e.destroy=="function"&&(this._destroy=e.destroy)),mP.call(this)}Object.defineProperty(ei.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}});ei.prototype.destroy=U2.destroy;ei.prototype._undestroy=U2.undestroy;ei.prototype._destroy=function(e,t){this.push(null),t(e)};ei.prototype.push=function(e,t){var i=this._readableState,r;return i.objectMode?r=!0:typeof e=="string"&&(t=t||i.defaultEncoding,t!==i.encoding&&(e=Cd.from(e,t),t=""),r=!0),j2(this,e,t,!1,r)};ei.prototype.unshift=function(e){return j2(this,e,null,!0,!1)};function j2(e,t,i,r,n){var s=e._readableState;if(t===null)s.reading=!1,XX(e,s);else{var a;n||(a=zX(s,t)),a?e.emit("error",a):s.objectMode||t&&t.length>0?(typeof t!="string"&&!s.objectMode&&Object.getPrototypeOf(t)!==Cd.prototype&&(t=jX(t)),r?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):pP(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!i?(t=s.decoder.write(t),s.objectMode||t.length!==0?pP(e,s,t,!1):Y2(e,s)):pP(e,s,t,!1))):r||(s.reading=!1)}return VX(s)}function pP(e,t,i,r){t.flowing&&t.length===0&&!t.sync?(e.emit("data",i),e.read(0)):(t.length+=t.objectMode?1:i.length,r?t.buffer.unshift(i):t.buffer.push(i),t.needReadable&&Pm(e)),Y2(e,t)}function zX(e,t){var i;return!YX(t)&&typeof t!="string"&&t!==void 0&&!e.objectMode&&(i=new TypeError("Invalid non-string/buffer chunk")),i}function VX(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||e.length===0)}ei.prototype.isPaused=function(){return this._readableState.flowing===!1};ei.prototype.setEncoding=function(e){return Su||(Su=cP().StringDecoder),this._readableState.decoder=new Su(e),this._readableState.encoding=e,this};var B2=8388608;function qX(e){return e>=B2?e=B2:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function O2(e,t){return e<=0||t.length===0&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=qX(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}ei.prototype.read=function(e){Bt("read",e),e=parseInt(e,10);var t=this._readableState,i=e;if(e!==0&&(t.emittedReadable=!1),e===0&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return Bt("read: emitReadable",t.length,t.ended),t.length===0&&t.ended?fP(this):Pm(this),null;if(e=O2(e,t),e===0&&t.ended)return t.length===0&&fP(this),null;var r=t.needReadable;Bt("need readable",r),(t.length===0||t.length-e<t.highWaterMark)&&(r=!0,Bt("length less than watermark",r)),t.ended||t.reading?(r=!1,Bt("reading or ended",r)):r&&(Bt("do read"),t.reading=!0,t.sync=!0,t.length===0&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=O2(i,t)));var n;return e>0?n=G2(e,t):n=null,n===null?(t.needReadable=!0,e=0):t.length-=e,t.length===0&&(t.ended||(t.needReadable=!0),i!==e&&t.ended&&fP(this)),n!==null&&this.emit("data",n),n};function XX(e,t){if(!t.ended){if(t.decoder){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,Pm(e)}}function Pm(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(Bt("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?vu.nextTick(M2,e):M2(e))}function M2(e){Bt("emit readable"),e.emit("readable"),gP(e)}function Y2(e,t){t.readingMore||(t.readingMore=!0,vu.nextTick(JX,e,t))}function JX(e,t){for(var i=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(Bt("maybeReadMore read 0"),e.read(0),i!==t.length);)i=t.length;t.readingMore=!1}ei.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))};ei.prototype.pipe=function(e,t){var i=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e);break}r.pipesCount+=1,Bt("pipe count=%d opts=%j",r.pipesCount,t);var n=(!t||t.end!==!1)&&e!==process.stdout&&e!==process.stderr,s=n?o:b;r.endEmitted?vu.nextTick(s):i.once("end",s),e.on("unpipe",a);function a(E,S){Bt("onunpipe"),E===i&&S&&S.hasUnpiped===!1&&(S.hasUnpiped=!0,c())}function o(){Bt("onend"),e.end()}var l=$X(i);e.on("drain",l);var u=!1;function c(){Bt("cleanup"),e.removeListener("close",g),e.removeListener("finish",y),e.removeListener("drain",l),e.removeListener("error",f),e.removeListener("unpipe",a),i.removeListener("end",o),i.removeListener("end",b),i.removeListener("data",m),u=!0,r.awaitDrain&&(!e._writableState||e._writableState.needDrain)&&l()}var h=!1;i.on("data",m);function m(E){Bt("ondata"),h=!1;var S=e.write(E);S===!1&&!h&&((r.pipesCount===1&&r.pipes===e||r.pipesCount>1&&W2(r.pipes,e)!==-1)&&!u&&(Bt("false write response, pause",r.awaitDrain),r.awaitDrain++,h=!0),i.pause())}function f(E){Bt("onerror",E),b(),e.removeListener("error",f),k2(e,"error")===0&&e.emit("error",E)}WX(e,"error",f);function g(){e.removeListener("finish",y),b()}e.once("close",g);function y(){Bt("onfinish"),e.removeListener("close",g),b()}e.once("finish",y);function b(){Bt("unpipe"),i.unpipe(e)}return e.emit("pipe",i),r.flowing||(Bt("pipe resume"),i.resume()),e};function $X(e){return function(){var t=e._readableState;Bt("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,t.awaitDrain===0&&k2(e,"data")&&(t.flowing=!0,gP(e))}}ei.prototype.unpipe=function(e){var t=this._readableState,i={hasUnpiped:!1};if(t.pipesCount===0)return this;if(t.pipesCount===1)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,i),this);if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<n;s++)r[s].emit("unpipe",this,{hasUnpiped:!1});return this}var a=W2(t.pipes,e);return a===-1?this:(t.pipes.splice(a,1),t.pipesCount-=1,t.pipesCount===1&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,i),this)};ei.prototype.on=function(e,t){var i=mP.prototype.on.call(this,e,t);if(e==="data")this._readableState.flowing!==!1&&this.resume();else if(e==="readable"){var r=this._readableState;!r.endEmitted&&!r.readableListening&&(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&Pm(this):vu.nextTick(KX,this))}return i};ei.prototype.addListener=ei.prototype.on;function KX(e){Bt("readable nexttick read 0"),e.read(0)}ei.prototype.resume=function(){var e=this._readableState;return e.flowing||(Bt("resume"),e.flowing=!0,ZX(this,e)),this};function ZX(e,t){t.resumeScheduled||(t.resumeScheduled=!0,vu.nextTick(QX,e,t))}function QX(e,t){t.reading||(Bt("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),gP(e),t.flowing&&!t.reading&&e.read(0)}ei.prototype.pause=function(){return Bt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Bt("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function gP(e){var t=e._readableState;for(Bt("flow",t.flowing);t.flowing&&e.read()!==null;);}ei.prototype.wrap=function(e){var t=this,i=this._readableState,r=!1;e.on("end",function(){if(Bt("wrapped end"),i.decoder&&!i.ended){var a=i.decoder.end();a&&a.length&&t.push(a)}t.push(null)}),e.on("data",function(a){if(Bt("wrapped data"),i.decoder&&(a=i.decoder.write(a)),!(i.objectMode&&a==null)&&!(!i.objectMode&&(!a||!a.length))){var o=t.push(a);o||(r=!0,e.pause())}});for(var n in e)this[n]===void 0&&typeof e[n]=="function"&&(this[n]=(function(a){return function(){return e[a].apply(e,arguments)}})(n));for(var s=0;s<hP.length;s++)e.on(hP[s],this.emit.bind(this,hP[s]));return this._read=function(a){Bt("wrapped _read",a),r&&(r=!1,e.resume())},this};Object.defineProperty(ei.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});ei._fromList=G2;function G2(e,t){if(t.length===0)return null;var i;return t.objectMode?i=t.buffer.shift():!e||e>=t.length?(t.decoder?i=t.buffer.join(""):t.buffer.length===1?i=t.buffer.head.data:i=t.buffer.concat(t.length),t.buffer.clear()):i=eJ(e,t.buffer,t.decoder),i}function eJ(e,t,i){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):e===t.head.data.length?r=t.shift():r=i?tJ(e,t):iJ(e,t),r}function tJ(e,t){var i=t.head,r=1,n=i.data;for(e-=n.length;i=i.next;){var s=i.data,a=e>s.length?s.length:e;if(a===s.length?n+=s:n+=s.slice(0,e),e-=a,e===0){a===s.length?(++r,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=s.slice(a));break}++r}return t.length-=r,n}function iJ(e,t){var i=Cd.allocUnsafe(e),r=t.head,n=1;for(r.data.copy(i),e-=r.data.length;r=r.next;){var s=r.data,a=e>s.length?s.length:e;if(s.copy(i,i.length-e,0,a),e-=a,e===0){a===s.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=s.slice(a));break}++n}return t.length-=n,i}function fP(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,vu.nextTick(rJ,t,e))}function rJ(e,t){!e.endEmitted&&e.length===0&&(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function W2(e,t){for(var i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1}});var yP=_e((ooe,X2)=>{"use strict";X2.exports=fa;var Em=el(),q2=Object.create(bu());q2.inherits=Pu();q2.inherits(fa,Em);function nJ(e,t){var i=this._transformState;i.transforming=!1;var r=i.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,i.writecb=null,t!=null&&this.push(t),r(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function fa(e){if(!(this instanceof fa))return new fa(e);Em.call(this,e),this._transformState={afterTransform:nJ.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.on("prefinish",sJ)}function sJ(){var e=this;typeof this._flush=="function"?this._flush(function(t,i){V2(e,t,i)}):V2(this,null,null)}fa.prototype.push=function(e,t){return this._transformState.needTransform=!1,Em.prototype.push.call(this,e,t)};fa.prototype._transform=function(e,t,i){throw new Error("_transform() is not implemented")};fa.prototype._write=function(e,t,i){var r=this._transformState;if(r.writecb=i,r.writechunk=e,r.writeencoding=t,!r.transforming){var n=this._readableState;(r.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};fa.prototype._read=function(e){var t=this._transformState;t.writechunk!==null&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0};fa.prototype._destroy=function(e,t){var i=this;Em.prototype._destroy.call(this,e,function(r){t(r),i.emit("close")})};function V2(e,t,i){if(t)return e.emit("error",t);if(i!=null&&e.push(i),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}});var Z2=_e((loe,K2)=>{"use strict";K2.exports=xd;var J2=yP(),$2=Object.create(bu());$2.inherits=Pu();$2.inherits(xd,J2);function xd(e){if(!(this instanceof xd))return new xd(e);J2.call(this,e)}xd.prototype._transform=function(e,t,i){i(null,e)}});var _P=_e((ir,Sm)=>{var xs=ar("stream");process.env.READABLE_STREAM==="disable"&&xs?(Sm.exports=xs,ir=Sm.exports=xs.Readable,ir.Readable=xs.Readable,ir.Writable=xs.Writable,ir.Duplex=xs.Duplex,ir.Transform=xs.Transform,ir.PassThrough=xs.PassThrough,ir.Stream=xs):(ir=Sm.exports=oP(),ir.Stream=xs||ir,ir.Readable=ir,ir.Writable=nP(),ir.Duplex=el(),ir.Transform=yP(),ir.PassThrough=Z2())});var ma=_e(rn=>{"use strict";rn.base64=!0;rn.array=!0;rn.string=!0;rn.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u";rn.nodebuffer=typeof Buffer<"u";rn.uint8array=typeof Uint8Array<"u";if(typeof ArrayBuffer>"u")rn.blob=!1;else{bP=new ArrayBuffer(0);try{rn.blob=new Blob([bP],{type:"application/zip"}).size===0}catch{try{Q2=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,PP=new Q2,PP.append(bP),rn.blob=PP.getBlob("application/zip").size===0}catch{rn.blob=!1}}}var bP,Q2,PP;try{rn.nodestream=!!_P().Readable}catch{rn.nodestream=!1}});var SP=_e(EP=>{"use strict";var aJ=ci(),oJ=ma(),Ts="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";EP.encode=function(e){for(var t=[],i,r,n,s,a,o,l,u=0,c=e.length,h=c,m=aJ.getTypeOf(e)!=="string";u<e.length;)h=c-u,m?(i=e[u++],r=u<c?e[u++]:0,n=u<c?e[u++]:0):(i=e.charCodeAt(u++),r=u<c?e.charCodeAt(u++):0,n=u<c?e.charCodeAt(u++):0),s=i>>2,a=(i&3)<<4|r>>4,o=h>1?(r&15)<<2|n>>6:64,l=h>2?n&63:64,t.push(Ts.charAt(s)+Ts.charAt(a)+Ts.charAt(o)+Ts.charAt(l));return t.join("")};EP.decode=function(e){var t,i,r,n,s,a,o,l=0,u=0,c="data:";if(e.substr(0,c.length)===c)throw new Error("Invalid base64 input, it looks like a data url.");e=e.replace(/[^A-Za-z0-9+/=]/g,"");var h=e.length*3/4;if(e.charAt(e.length-1)===Ts.charAt(64)&&h--,e.charAt(e.length-2)===Ts.charAt(64)&&h--,h%1!==0)throw new Error("Invalid base64 input, bad content length.");var m;for(oJ.uint8array?m=new Uint8Array(h|0):m=new Array(h|0);l<e.length;)n=Ts.indexOf(e.charAt(l++)),s=Ts.indexOf(e.charAt(l++)),a=Ts.indexOf(e.charAt(l++)),o=Ts.indexOf(e.charAt(l++)),t=n<<2|s>>4,i=(s&15)<<4|a>>2,r=(a&3)<<6|o,m[u++]=t,a!==64&&(m[u++]=i),o!==64&&(m[u++]=r);return m}});var Td=_e((doe,eR)=>{"use strict";eR.exports={isNode:typeof Buffer<"u",newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if(typeof e=="number")throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&typeof e.on=="function"&&typeof e.pause=="function"&&typeof e.resume=="function"}}});var nR=_e((hoe,rR)=>{"use strict";var tR=global.MutationObserver||global.WebKitMutationObserver,Iu;process.browser?tR?(vP=0,iR=new tR(wd),IP=global.document.createTextNode(""),iR.observe(IP,{characterData:!0}),Iu=function(){IP.data=vP=++vP%2}):!global.setImmediate&&typeof global.MessageChannel<"u"?(AP=new global.MessageChannel,AP.port1.onmessage=wd,Iu=function(){AP.port2.postMessage(0)}):"document"in global&&"onreadystatechange"in global.document.createElement("script")?Iu=function(){var e=global.document.createElement("script");e.onreadystatechange=function(){wd(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},global.document.documentElement.appendChild(e)}:Iu=function(){setTimeout(wd,0)}:Iu=function(){process.nextTick(wd)};var vP,iR,IP,AP,CP,Rd=[];function wd(){CP=!0;for(var e,t,i=Rd.length;i;){for(t=Rd,Rd=[],e=-1;++e<i;)t[e]();i=Rd.length}CP=!1}rR.exports=lJ;function lJ(e){Rd.push(e)===1&&!CP&&Iu()}});var dR=_e((poe,cR)=>{"use strict";var sR=nR();function Au(){}var hr={},aR=["REJECTED"],xP=["FULFILLED"],oR=["PENDING"];process.browser||(Ld=["UNHANDLED"]);var Ld;cR.exports=Za;function Za(e){if(typeof e!="function")throw new TypeError("resolver must be a function");this.state=oR,this.queue=[],this.outcome=void 0,process.browser||(this.handled=Ld),e!==Au&&lR(this,e)}Za.prototype.finally=function(e){if(typeof e!="function")return this;var t=this.constructor;return this.then(i,r);function i(n){function s(){return n}return t.resolve(e()).then(s)}function r(n){function s(){throw n}return t.resolve(e()).then(s)}};Za.prototype.catch=function(e){return this.then(null,e)};Za.prototype.then=function(e,t){if(typeof e!="function"&&this.state===xP||typeof t!="function"&&this.state===aR)return this;var i=new this.constructor(Au);if(process.browser||this.handled===Ld&&(this.handled=null),this.state!==oR){var r=this.state===xP?e:t;TP(i,r,this.outcome)}else this.queue.push(new Nd(i,e,t));return i};function Nd(e,t,i){this.promise=e,typeof t=="function"&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),typeof i=="function"&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}Nd.prototype.callFulfilled=function(e){hr.resolve(this.promise,e)};Nd.prototype.otherCallFulfilled=function(e){TP(this.promise,this.onFulfilled,e)};Nd.prototype.callRejected=function(e){hr.reject(this.promise,e)};Nd.prototype.otherCallRejected=function(e){TP(this.promise,this.onRejected,e)};function TP(e,t,i){sR(function(){var r;try{r=t(i)}catch(n){return hr.reject(e,n)}r===e?hr.reject(e,new TypeError("Cannot resolve promise with itself")):hr.resolve(e,r)})}hr.resolve=function(e,t){var i=uR(uJ,t);if(i.status==="error")return hr.reject(e,i.value);var r=i.value;if(r)lR(e,r);else{e.state=xP,e.outcome=t;for(var n=-1,s=e.queue.length;++n<s;)e.queue[n].callFulfilled(t)}return e};hr.reject=function(e,t){e.state=aR,e.outcome=t,process.browser||e.handled===Ld&&sR(function(){e.handled===Ld&&process.emit("unhandledRejection",t,e)});for(var i=-1,r=e.queue.length;++i<r;)e.queue[i].callRejected(t);return e};function uJ(e){var t=e&&e.then;if(e&&(typeof e=="object"||typeof e=="function")&&typeof t=="function")return function(){t.apply(e,arguments)}}function lR(e,t){var i=!1;function r(o){i||(i=!0,hr.reject(e,o))}function n(o){i||(i=!0,hr.resolve(e,o))}function s(){t(n,r)}var a=uR(s);a.status==="error"&&r(a.value)}function uR(e,t){var i={};try{i.value=e(t),i.status="success"}catch(r){i.status="error",i.value=r}return i}Za.resolve=cJ;function cJ(e){return e instanceof this?e:hr.resolve(new this(Au),e)}Za.reject=dJ;function dJ(e){var t=new this(Au);return hr.reject(t,e)}Za.all=hJ;function hJ(e){var t=this;if(Object.prototype.toString.call(e)!=="[object Array]")return this.reject(new TypeError("must be an array"));var i=e.length,r=!1;if(!i)return this.resolve([]);for(var n=new Array(i),s=0,a=-1,o=new this(Au);++a<i;)l(e[a],a);return o;function l(u,c){t.resolve(u).then(h,function(m){r||(r=!0,hr.reject(o,m))});function h(m){n[c]=m,++s===i&&!r&&(r=!0,hr.resolve(o,n))}}}Za.race=pJ;function pJ(e){var t=this;if(Object.prototype.toString.call(e)!=="[object Array]")return this.reject(new TypeError("must be an array"));var i=e.length,r=!1;if(!i)return this.resolve([]);for(var n=-1,s=new this(Au);++n<i;)a(e[n]);return s;function a(o){t.resolve(o).then(function(l){r||(r=!0,hr.resolve(s,l))},function(l){r||(r=!0,hr.reject(s,l))})}}});var Cu=_e((foe,hR)=>{"use strict";var wP=null;typeof Promise<"u"?wP=Promise:wP=dR();hR.exports={Promise:wP}});var fR=_e(pR=>{(function(e,t){"use strict";if(e.setImmediate)return;var i=1,r={},n=!1,s=e.document,a;function o(S){typeof S!="function"&&(S=new Function(""+S));for(var v=new Array(arguments.length-1),A=0;A<v.length;A++)v[A]=arguments[A+1];var x={callback:S,args:v};return r[i]=x,a(i),i++}function l(S){delete r[S]}function u(S){var v=S.callback,A=S.args;switch(A.length){case 0:v();break;case 1:v(A[0]);break;case 2:v(A[0],A[1]);break;case 3:v(A[0],A[1],A[2]);break;default:v.apply(t,A);break}}function c(S){if(n)setTimeout(c,0,S);else{var v=r[S];if(v){n=!0;try{u(v)}finally{l(S),n=!1}}}}function h(){a=function(S){process.nextTick(function(){c(S)})}}function m(){if(e.postMessage&&!e.importScripts){var S=!0,v=e.onmessage;return e.onmessage=function(){S=!1},e.postMessage("","*"),e.onmessage=v,S}}function f(){var S="setImmediate$"+Math.random()+"$",v=function(A){A.source===e&&typeof A.data=="string"&&A.data.indexOf(S)===0&&c(+A.data.slice(S.length))};e.addEventListener?e.addEventListener("message",v,!1):e.attachEvent("onmessage",v),a=function(A){e.postMessage(S+A,"*")}}function g(){var S=new MessageChannel;S.port1.onmessage=function(v){var A=v.data;c(A)},a=function(v){S.port2.postMessage(v)}}function y(){var S=s.documentElement;a=function(v){var A=s.createElement("script");A.onreadystatechange=function(){c(v),A.onreadystatechange=null,S.removeChild(A),A=null},S.appendChild(A)}}function b(){a=function(S){setTimeout(c,0,S)}}var E=Object.getPrototypeOf&&Object.getPrototypeOf(e);E=E&&E.setTimeout?E:e,{}.toString.call(e.process)==="[object process]"?h():m()?f():e.MessageChannel?g():s&&"onreadystatechange"in s.createElement("script")?y():b(),E.setImmediate=o,E.clearImmediate=l})(typeof self>"u"?typeof global>"u"?pR:global:self)});var ci=_e(wi=>{"use strict";var Qa=ma(),fJ=SP(),xu=Td(),RP=Cu();fR();function mJ(e){var t=null;return Qa.uint8array?t=new Uint8Array(e.length):t=new Array(e.length),Im(e,t)}wi.newBlob=function(e,t){wi.checkSupport("blob");try{return new Blob([e],{type:t})}catch{try{var i=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,r=new i;return r.append(e),r.getBlob(t)}catch{throw new Error("Bug : can't construct the Blob.")}}};function Dd(e){return e}function Im(e,t){for(var i=0;i<e.length;++i)t[i]=e.charCodeAt(i)&255;return t}var vm={stringifyByChunk:function(e,t,i){var r=[],n=0,s=e.length;if(s<=i)return String.fromCharCode.apply(null,e);for(;n<s;)t==="array"||t==="nodebuffer"?r.push(String.fromCharCode.apply(null,e.slice(n,Math.min(n+i,s)))):r.push(String.fromCharCode.apply(null,e.subarray(n,Math.min(n+i,s)))),n+=i;return r.join("")},stringifyByChar:function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t},applyCanBeUsed:{uint8array:(function(){try{return Qa.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return Qa.nodebuffer&&String.fromCharCode.apply(null,xu.allocBuffer(1)).length===1}catch{return!1}})()}};function Bd(e){var t=65536,i=wi.getTypeOf(e),r=!0;if(i==="uint8array"?r=vm.applyCanBeUsed.uint8array:i==="nodebuffer"&&(r=vm.applyCanBeUsed.nodebuffer),r)for(;t>1;)try{return vm.stringifyByChunk(e,i,t)}catch{t=Math.floor(t/2)}return vm.stringifyByChar(e)}wi.applyFromCharCode=Bd;function Am(e,t){for(var i=0;i<e.length;i++)t[i]=e[i];return t}var eo={};eo.string={string:Dd,array:function(e){return Im(e,new Array(e.length))},arraybuffer:function(e){return eo.string.uint8array(e).buffer},uint8array:function(e){return Im(e,new Uint8Array(e.length))},nodebuffer:function(e){return Im(e,xu.allocBuffer(e.length))}};eo.array={string:Bd,array:Dd,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return xu.newBufferFrom(e)}};eo.arraybuffer={string:function(e){return Bd(new Uint8Array(e))},array:function(e){return Am(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:Dd,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return xu.newBufferFrom(new Uint8Array(e))}};eo.uint8array={string:Bd,array:function(e){return Am(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:Dd,nodebuffer:function(e){return xu.newBufferFrom(e)}};eo.nodebuffer={string:Bd,array:function(e){return Am(e,new Array(e.length))},arraybuffer:function(e){return eo.nodebuffer.uint8array(e).buffer},uint8array:function(e){return Am(e,new Uint8Array(e.length))},nodebuffer:Dd};wi.transformTo=function(e,t){if(t||(t=""),!e)return t;wi.checkSupport(e);var i=wi.getTypeOf(t),r=eo[i][e](t);return r};wi.resolve=function(e){for(var t=e.split("/"),i=[],r=0;r<t.length;r++){var n=t[r];n==="."||n===""&&r!==0&&r!==t.length-1||(n===".."?i.pop():i.push(n))}return i.join("/")};wi.getTypeOf=function(e){if(typeof e=="string")return"string";if(Object.prototype.toString.call(e)==="[object Array]")return"array";if(Qa.nodebuffer&&xu.isBuffer(e))return"nodebuffer";if(Qa.uint8array&&e instanceof Uint8Array)return"uint8array";if(Qa.arraybuffer&&e instanceof ArrayBuffer)return"arraybuffer"};wi.checkSupport=function(e){var t=Qa[e.toLowerCase()];if(!t)throw new Error(e+" is not supported by this platform")};wi.MAX_VALUE_16BITS=65535;wi.MAX_VALUE_32BITS=-1;wi.pretty=function(e){var t="",i,r;for(r=0;r<(e||"").length;r++)i=e.charCodeAt(r),t+="\\x"+(i<16?"0":"")+i.toString(16).toUpperCase();return t};wi.delay=function(e,t,i){setImmediate(function(){e.apply(i||null,t||[])})};wi.inherits=function(e,t){var i=function(){};i.prototype=t.prototype,e.prototype=new i};wi.extend=function(){var e={},t,i;for(t=0;t<arguments.length;t++)for(i in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],i)&&typeof e[i]>"u"&&(e[i]=arguments[t][i]);return e};wi.prepareContent=function(e,t,i,r,n){var s=RP.Promise.resolve(t).then(function(a){var o=Qa.blob&&(a instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(a))!==-1);return o&&typeof FileReader<"u"?new RP.Promise(function(l,u){var c=new FileReader;c.onload=function(h){l(h.target.result)},c.onerror=function(h){u(h.target.error)},c.readAsArrayBuffer(a)}):a});return s.then(function(a){var o=wi.getTypeOf(a);return o?(o==="arraybuffer"?a=wi.transformTo("uint8array",a):o==="string"&&(n?a=fJ.decode(a):i&&r!==!0&&(a=mJ(a))),a):RP.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}});var nn=_e((yoe,gR)=>{"use strict";function mR(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}mR.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return this.isFinished?!1:(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var i=0;i<this._listeners[e].length;i++)this._listeners[e][i].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(i){t.processChunk(i)}),e.on("end",function(){t.end()}),e.on("error",function(i){t.error(i)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}};gR.exports=mR});var wu=_e(to=>{"use strict";var Tu=ci(),tl=ma(),gJ=Td(),Cm=nn(),Od=new Array(256);for(ga=0;ga<256;ga++)Od[ga]=ga>=252?6:ga>=248?5:ga>=240?4:ga>=224?3:ga>=192?2:1;var ga;Od[254]=Od[254]=1;var yJ=function(e){var t,i,r,n,s,a=e.length,o=0;for(n=0;n<a;n++)i=e.charCodeAt(n),(i&64512)===55296&&n+1<a&&(r=e.charCodeAt(n+1),(r&64512)===56320&&(i=65536+(i-55296<<10)+(r-56320),n++)),o+=i<128?1:i<2048?2:i<65536?3:4;for(tl.uint8array?t=new Uint8Array(o):t=new Array(o),s=0,n=0;s<o;n++)i=e.charCodeAt(n),(i&64512)===55296&&n+1<a&&(r=e.charCodeAt(n+1),(r&64512)===56320&&(i=65536+(i-55296<<10)+(r-56320),n++)),i<128?t[s++]=i:i<2048?(t[s++]=192|i>>>6,t[s++]=128|i&63):i<65536?(t[s++]=224|i>>>12,t[s++]=128|i>>>6&63,t[s++]=128|i&63):(t[s++]=240|i>>>18,t[s++]=128|i>>>12&63,t[s++]=128|i>>>6&63,t[s++]=128|i&63);return t},_J=function(e,t){var i;for(t=t||e.length,t>e.length&&(t=e.length),i=t-1;i>=0&&(e[i]&192)===128;)i--;return i<0||i===0?t:i+Od[e[i]]>t?i:t},bJ=function(e){var t,i,r,n,s=e.length,a=new Array(s*2);for(i=0,t=0;t<s;){if(r=e[t++],r<128){a[i++]=r;continue}if(n=Od[r],n>4){a[i++]=65533,t+=n-1;continue}for(r&=n===2?31:n===3?15:7;n>1&&t<s;)r=r<<6|e[t++]&63,n--;if(n>1){a[i++]=65533;continue}r<65536?a[i++]=r:(r-=65536,a[i++]=55296|r>>10&1023,a[i++]=56320|r&1023)}return a.length!==i&&(a.subarray?a=a.subarray(0,i):a.length=i),Tu.applyFromCharCode(a)};to.utf8encode=function(t){return tl.nodebuffer?gJ.newBufferFrom(t,"utf-8"):yJ(t)};to.utf8decode=function(t){return tl.nodebuffer?Tu.transformTo("nodebuffer",t).toString("utf-8"):(t=Tu.transformTo(tl.uint8array?"uint8array":"array",t),bJ(t))};function xm(){Cm.call(this,"utf-8 decode"),this.leftOver=null}Tu.inherits(xm,Cm);xm.prototype.processChunk=function(e){var t=Tu.transformTo(tl.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(tl.uint8array){var i=t;t=new Uint8Array(i.length+this.leftOver.length),t.set(this.leftOver,0),t.set(i,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var r=_J(t),n=t;r!==t.length&&(tl.uint8array?(n=t.subarray(0,r),this.leftOver=t.subarray(r,t.length)):(n=t.slice(0,r),this.leftOver=t.slice(r,t.length))),this.push({data:to.utf8decode(n),meta:e.meta})};xm.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:to.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)};to.Utf8DecodeWorker=xm;function LP(){Cm.call(this,"utf-8 encode")}Tu.inherits(LP,Cm);LP.prototype.processChunk=function(e){this.push({data:to.utf8encode(e.data),meta:e.meta})};to.Utf8EncodeWorker=LP});var PR=_e((boe,bR)=>{"use strict";var yR=nn(),_R=ci();function NP(e){yR.call(this,"ConvertWorker to "+e),this.destType=e}_R.inherits(NP,yR);NP.prototype.processChunk=function(e){this.push({data:_R.transformTo(this.destType,e.data),meta:e.meta})};bR.exports=NP});var vR=_e((Poe,SR)=>{"use strict";var ER=_P().Readable,PJ=ci();PJ.inherits(DP,ER);function DP(e,t,i){ER.call(this,t),this._helper=e;var r=this;e.on("data",function(n,s){r.push(n)||r._helper.pause(),i&&i(s)}).on("error",function(n){r.emit("error",n)}).on("end",function(){r.push(null)})}DP.prototype._read=function(){this._helper.resume()};SR.exports=DP});var BP=_e((Eoe,CR)=>{"use strict";var il=ci(),EJ=PR(),SJ=nn(),vJ=SP(),IJ=ma(),AJ=Cu(),IR=null;if(IJ.nodestream)try{IR=vR()}catch{}function CJ(e,t,i){switch(e){case"blob":return il.newBlob(il.transformTo("arraybuffer",t),i);case"base64":return vJ.encode(t);default:return il.transformTo(e,t)}}function xJ(e,t){var i,r=0,n=null,s=0;for(i=0;i<t.length;i++)s+=t[i].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(n=new Uint8Array(s),i=0;i<t.length;i++)n.set(t[i],r),r+=t[i].length;return n;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}function TJ(e,t){return new AJ.Promise(function(i,r){var n=[],s=e._internalType,a=e._outputType,o=e._mimeType;e.on("data",function(l,u){n.push(l),t&&t(u)}).on("error",function(l){n=[],r(l)}).on("end",function(){try{var l=CJ(a,xJ(s,n),o);i(l)}catch(u){r(u)}n=[]}).resume()})}function AR(e,t,i){var r=t;switch(t){case"blob":case"arraybuffer":r="uint8array";break;case"base64":r="string";break}try{this._internalType=r,this._outputType=t,this._mimeType=i,il.checkSupport(r),this._worker=e.pipe(new EJ(r)),e.lock()}catch(n){this._worker=new SJ("error"),this._worker.error(n)}}AR.prototype={accumulate:function(e){return TJ(this,e)},on:function(e,t){var i=this;return e==="data"?this._worker.on(e,function(r){t.call(i,r.data,r.meta)}):this._worker.on(e,function(){il.delay(t,arguments,i)}),this},resume:function(){return il.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(il.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new IR(this,{objectMode:this._outputType!=="nodebuffer"},e)}};CR.exports=AR});var OP=_e(Jn=>{"use strict";Jn.base64=!1;Jn.binary=!1;Jn.dir=!1;Jn.createFolders=!0;Jn.date=null;Jn.compression=null;Jn.compressionOptions=null;Jn.comment=null;Jn.unixPermissions=null;Jn.dosPermissions=null});var MP=_e((voe,xR)=>{"use strict";var Tm=ci(),wm=nn(),wJ=16*1024;function Ru(e){wm.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(i){t.dataIsReady=!0,t.data=i,t.max=i&&i.length||0,t.type=Tm.getTypeOf(i),t.isPaused||t._tickAndRepeat()},function(i){t.error(i)})}Tm.inherits(Ru,wm);Ru.prototype.cleanUp=function(){wm.prototype.cleanUp.call(this),this.data=null};Ru.prototype.resume=function(){return wm.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,Tm.delay(this._tickAndRepeat,[],this)),!0):!1};Ru.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(Tm.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))};Ru.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=wJ,t=null,i=Math.min(this.max,this.index+e);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,i);break;case"uint8array":t=this.data.subarray(this.index,i);break;case"array":case"nodebuffer":t=this.data.slice(this.index,i);break}return this.index=i,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})};xR.exports=Ru});var Rm=_e((Ioe,wR)=>{"use strict";var RJ=ci();function LJ(){for(var e,t=[],i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[i]=e}return t}var TR=LJ();function NJ(e,t,i,r){var n=TR,s=r+i;e=e^-1;for(var a=r;a<s;a++)e=e>>>8^n[(e^t[a])&255];return e^-1}function DJ(e,t,i,r){var n=TR,s=r+i;e=e^-1;for(var a=r;a<s;a++)e=e>>>8^n[(e^t.charCodeAt(a))&255];return e^-1}wR.exports=function(t,i){if(typeof t>"u"||!t.length)return 0;var r=RJ.getTypeOf(t)!=="string";return r?NJ(i|0,t,t.length,0):DJ(i|0,t,t.length,0)}});var FP=_e((Aoe,LR)=>{"use strict";var RR=nn(),BJ=Rm(),OJ=ci();function kP(){RR.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}OJ.inherits(kP,RR);kP.prototype.processChunk=function(e){this.streamInfo.crc32=BJ(e.data,this.streamInfo.crc32||0),this.push(e)};LR.exports=kP});var DR=_e((Coe,NR)=>{"use strict";var MJ=ci(),UP=nn();function HP(e){UP.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}MJ.inherits(HP,UP);HP.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}UP.prototype.processChunk.call(this,e)};NR.exports=HP});var Lm=_e((xoe,MR)=>{"use strict";var BR=Cu(),OR=MP(),kJ=FP(),jP=DR();function YP(e,t,i,r,n){this.compressedSize=e,this.uncompressedSize=t,this.crc32=i,this.compression=r,this.compressedContent=n}YP.prototype={getContentWorker:function(){var e=new OR(BR.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new jP("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new OR(BR.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}};YP.createWorkerFrom=function(e,t,i){return e.pipe(new kJ).pipe(new jP("uncompressedSize")).pipe(t.compressWorker(i)).pipe(new jP("compressedSize")).withStreamInfo("compression",t)};MR.exports=YP});var HR=_e((Toe,UR)=>{"use strict";var FJ=BP(),UJ=MP(),GP=wu(),WP=Lm(),kR=nn(),zP=function(e,t,i){this.name=e,this.dir=i.dir,this.date=i.date,this.comment=i.comment,this.unixPermissions=i.unixPermissions,this.dosPermissions=i.dosPermissions,this._data=t,this._dataBinary=i.binary,this.options={compression:i.compression,compressionOptions:i.compressionOptions}};zP.prototype={internalStream:function(e){var t=null,i="string";try{if(!e)throw new Error("No output type specified.");i=e.toLowerCase();var r=i==="string"||i==="text";(i==="binarystring"||i==="text")&&(i="string"),t=this._decompressWorker();var n=!this._dataBinary;n&&!r&&(t=t.pipe(new GP.Utf8EncodeWorker)),!n&&r&&(t=t.pipe(new GP.Utf8DecodeWorker))}catch(s){t=new kR("error"),t.error(s)}return new FJ(t,i,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof WP&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var i=this._decompressWorker();return this._dataBinary||(i=i.pipe(new GP.Utf8EncodeWorker)),WP.createWorkerFrom(i,e,t)},_decompressWorker:function(){return this._data instanceof WP?this._data.getContentWorker():this._data instanceof kR?this._data:new UJ(this._data)}};var FR=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],HJ=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")};for(Nm=0;Nm<FR.length;Nm++)zP.prototype[FR[Nm]]=HJ;var Nm;UR.exports=zP});var ya=_e(Ir=>{"use strict";var jJ=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function YJ(e,t){return Object.prototype.hasOwnProperty.call(e,t)}Ir.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if(typeof i!="object")throw new TypeError(i+"must be non-object");for(var r in i)YJ(i,r)&&(e[r]=i[r])}}return e};Ir.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var GJ={arraySet:function(e,t,i,r,n){if(t.subarray&&e.subarray){e.set(t.subarray(i,i+r),n);return}for(var s=0;s<r;s++)e[n+s]=t[i+s]},flattenChunks:function(e){var t,i,r,n,s,a;for(r=0,t=0,i=e.length;t<i;t++)r+=e[t].length;for(a=new Uint8Array(r),n=0,t=0,i=e.length;t<i;t++)s=e[t],a.set(s,n),n+=s.length;return a}},WJ={arraySet:function(e,t,i,r,n){for(var s=0;s<r;s++)e[n+s]=t[i+s]},flattenChunks:function(e){return[].concat.apply([],e)}};Ir.setTyped=function(e){e?(Ir.Buf8=Uint8Array,Ir.Buf16=Uint16Array,Ir.Buf32=Int32Array,Ir.assign(Ir,GJ)):(Ir.Buf8=Array,Ir.Buf16=Array,Ir.Buf32=Array,Ir.assign(Ir,WJ))};Ir.setTyped(jJ)});var uL=_e(Du=>{"use strict";var zJ=ya(),VJ=4,jR=0,YR=1,qJ=2;function Nu(e){for(var t=e.length;--t>=0;)e[t]=0}var XJ=0,XR=1,JJ=2,$J=3,KJ=258,ZP=29,jd=256,kd=jd+1+ZP,Lu=30,QP=19,JR=2*kd+1,rl=15,VP=16,ZJ=7,eE=256,$R=16,KR=17,ZR=18,$P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Dm=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],QJ=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],QR=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],e$=512,_a=new Array((kd+2)*2);Nu(_a);var Md=new Array(Lu*2);Nu(Md);var Fd=new Array(e$);Nu(Fd);var Ud=new Array(KJ-$J+1);Nu(Ud);var tE=new Array(ZP);Nu(tE);var Bm=new Array(Lu);Nu(Bm);function qP(e,t,i,r,n){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=r,this.max_length=n,this.has_stree=e&&e.length}var eL,tL,iL;function XP(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function rL(e){return e<256?Fd[e]:Fd[256+(e>>>7)]}function Hd(e,t){e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255}function Hr(e,t,i){e.bi_valid>VP-i?(e.bi_buf|=t<<e.bi_valid&65535,Hd(e,e.bi_buf),e.bi_buf=t>>VP-e.bi_valid,e.bi_valid+=i-VP):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)}function ws(e,t,i){Hr(e,i[t*2],i[t*2+1])}function nL(e,t){var i=0;do i|=e&1,e>>>=1,i<<=1;while(--t>0);return i>>>1}function t$(e){e.bi_valid===16?(Hd(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}function i$(e,t){var i=t.dyn_tree,r=t.max_code,n=t.stat_desc.static_tree,s=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,l=t.stat_desc.max_length,u,c,h,m,f,g,y=0;for(m=0;m<=rl;m++)e.bl_count[m]=0;for(i[e.heap[e.heap_max]*2+1]=0,u=e.heap_max+1;u<JR;u++)c=e.heap[u],m=i[i[c*2+1]*2+1]+1,m>l&&(m=l,y++),i[c*2+1]=m,!(c>r)&&(e.bl_count[m]++,f=0,c>=o&&(f=a[c-o]),g=i[c*2],e.opt_len+=g*(m+f),s&&(e.static_len+=g*(n[c*2+1]+f)));if(y!==0){do{for(m=l-1;e.bl_count[m]===0;)m--;e.bl_count[m]--,e.bl_count[m+1]+=2,e.bl_count[l]--,y-=2}while(y>0);for(m=l;m!==0;m--)for(c=e.bl_count[m];c!==0;)h=e.heap[--u],!(h>r)&&(i[h*2+1]!==m&&(e.opt_len+=(m-i[h*2+1])*i[h*2],i[h*2+1]=m),c--)}}function sL(e,t,i){var r=new Array(rl+1),n=0,s,a;for(s=1;s<=rl;s++)r[s]=n=n+i[s-1]<<1;for(a=0;a<=t;a++){var o=e[a*2+1];o!==0&&(e[a*2]=nL(r[o]++,o))}}function r$(){var e,t,i,r,n,s=new Array(rl+1);for(i=0,r=0;r<ZP-1;r++)for(tE[r]=i,e=0;e<1<<$P[r];e++)Ud[i++]=r;for(Ud[i-1]=r,n=0,r=0;r<16;r++)for(Bm[r]=n,e=0;e<1<<Dm[r];e++)Fd[n++]=r;for(n>>=7;r<Lu;r++)for(Bm[r]=n<<7,e=0;e<1<<Dm[r]-7;e++)Fd[256+n++]=r;for(t=0;t<=rl;t++)s[t]=0;for(e=0;e<=143;)_a[e*2+1]=8,e++,s[8]++;for(;e<=255;)_a[e*2+1]=9,e++,s[9]++;for(;e<=279;)_a[e*2+1]=7,e++,s[7]++;for(;e<=287;)_a[e*2+1]=8,e++,s[8]++;for(sL(_a,kd+1,s),e=0;e<Lu;e++)Md[e*2+1]=5,Md[e*2]=nL(e,5);eL=new qP(_a,$P,jd+1,kd,rl),tL=new qP(Md,Dm,0,Lu,rl),iL=new qP(new Array(0),QJ,0,QP,ZJ)}function aL(e){var t;for(t=0;t<kd;t++)e.dyn_ltree[t*2]=0;for(t=0;t<Lu;t++)e.dyn_dtree[t*2]=0;for(t=0;t<QP;t++)e.bl_tree[t*2]=0;e.dyn_ltree[eE*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function oL(e){e.bi_valid>8?Hd(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function n$(e,t,i,r){oL(e),r&&(Hd(e,i),Hd(e,~i)),zJ.arraySet(e.pending_buf,e.window,t,i,e.pending),e.pending+=i}function GR(e,t,i,r){var n=t*2,s=i*2;return e[n]<e[s]||e[n]===e[s]&&r[t]<=r[i]}function JP(e,t,i){for(var r=e.heap[i],n=i<<1;n<=e.heap_len&&(n<e.heap_len&&GR(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!GR(t,r,e.heap[n],e.depth));)e.heap[i]=e.heap[n],i=n,n<<=1;e.heap[i]=r}function WR(e,t,i){var r,n,s=0,a,o;if(e.last_lit!==0)do r=e.pending_buf[e.d_buf+s*2]<<8|e.pending_buf[e.d_buf+s*2+1],n=e.pending_buf[e.l_buf+s],s++,r===0?ws(e,n,t):(a=Ud[n],ws(e,a+jd+1,t),o=$P[a],o!==0&&(n-=tE[a],Hr(e,n,o)),r--,a=rL(r),ws(e,a,i),o=Dm[a],o!==0&&(r-=Bm[a],Hr(e,r,o)));while(s<e.last_lit);ws(e,eE,t)}function KP(e,t){var i=t.dyn_tree,r=t.stat_desc.static_tree,n=t.stat_desc.has_stree,s=t.stat_desc.elems,a,o,l=-1,u;for(e.heap_len=0,e.heap_max=JR,a=0;a<s;a++)i[a*2]!==0?(e.heap[++e.heap_len]=l=a,e.depth[a]=0):i[a*2+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=l<2?++l:0,i[u*2]=1,e.depth[u]=0,e.opt_len--,n&&(e.static_len-=r[u*2+1]);for(t.max_code=l,a=e.heap_len>>1;a>=1;a--)JP(e,i,a);u=s;do a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],JP(e,i,1),o=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=o,i[u*2]=i[a*2]+i[o*2],e.depth[u]=(e.depth[a]>=e.depth[o]?e.depth[a]:e.depth[o])+1,i[a*2+1]=i[o*2+1]=u,e.heap[1]=u++,JP(e,i,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],i$(e,t),sL(i,l,e.bl_count)}function zR(e,t,i){var r,n=-1,s,a=t[1],o=0,l=7,u=4;for(a===0&&(l=138,u=3),t[(i+1)*2+1]=65535,r=0;r<=i;r++)s=a,a=t[(r+1)*2+1],!(++o<l&&s===a)&&(o<u?e.bl_tree[s*2]+=o:s!==0?(s!==n&&e.bl_tree[s*2]++,e.bl_tree[$R*2]++):o<=10?e.bl_tree[KR*2]++:e.bl_tree[ZR*2]++,o=0,n=s,a===0?(l=138,u=3):s===a?(l=6,u=3):(l=7,u=4))}function VR(e,t,i){var r,n=-1,s,a=t[1],o=0,l=7,u=4;for(a===0&&(l=138,u=3),r=0;r<=i;r++)if(s=a,a=t[(r+1)*2+1],!(++o<l&&s===a)){if(o<u)do ws(e,s,e.bl_tree);while(--o!==0);else s!==0?(s!==n&&(ws(e,s,e.bl_tree),o--),ws(e,$R,e.bl_tree),Hr(e,o-3,2)):o<=10?(ws(e,KR,e.bl_tree),Hr(e,o-3,3)):(ws(e,ZR,e.bl_tree),Hr(e,o-11,7));o=0,n=s,a===0?(l=138,u=3):s===a?(l=6,u=3):(l=7,u=4)}}function s$(e){var t;for(zR(e,e.dyn_ltree,e.l_desc.max_code),zR(e,e.dyn_dtree,e.d_desc.max_code),KP(e,e.bl_desc),t=QP-1;t>=3&&e.bl_tree[QR[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t}function a$(e,t,i,r){var n;for(Hr(e,t-257,5),Hr(e,i-1,5),Hr(e,r-4,4),n=0;n<r;n++)Hr(e,e.bl_tree[QR[n]*2+1],3);VR(e,e.dyn_ltree,t-1),VR(e,e.dyn_dtree,i-1)}function o$(e){var t=4093624447,i;for(i=0;i<=31;i++,t>>>=1)if(t&1&&e.dyn_ltree[i*2]!==0)return jR;if(e.dyn_ltree[18]!==0||e.dyn_ltree[20]!==0||e.dyn_ltree[26]!==0)return YR;for(i=32;i<jd;i++)if(e.dyn_ltree[i*2]!==0)return YR;return jR}var qR=!1;function l$(e){qR||(r$(),qR=!0),e.l_desc=new XP(e.dyn_ltree,eL),e.d_desc=new XP(e.dyn_dtree,tL),e.bl_desc=new XP(e.bl_tree,iL),e.bi_buf=0,e.bi_valid=0,aL(e)}function lL(e,t,i,r){Hr(e,(XJ<<1)+(r?1:0),3),n$(e,t,i,!0)}function u$(e){Hr(e,XR<<1,3),ws(e,eE,_a),t$(e)}function c$(e,t,i,r){var n,s,a=0;e.level>0?(e.strm.data_type===qJ&&(e.strm.data_type=o$(e)),KP(e,e.l_desc),KP(e,e.d_desc),a=s$(e),n=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=n&&(n=s)):n=s=i+5,i+4<=n&&t!==-1?lL(e,t,i,r):e.strategy===VJ||s===n?(Hr(e,(XR<<1)+(r?1:0),3),WR(e,_a,Md)):(Hr(e,(JJ<<1)+(r?1:0),3),a$(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),WR(e,e.dyn_ltree,e.dyn_dtree)),aL(e),r&&oL(e)}function d$(e,t,i){return e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255,e.pending_buf[e.l_buf+e.last_lit]=i&255,e.last_lit++,t===0?e.dyn_ltree[i*2]++:(e.matches++,t--,e.dyn_ltree[(Ud[i]+jd+1)*2]++,e.dyn_dtree[rL(t)*2]++),e.last_lit===e.lit_bufsize-1}Du._tr_init=l$;Du._tr_stored_block=lL;Du._tr_flush_block=c$;Du._tr_tally=d$;Du._tr_align=u$});var iE=_e((Loe,cL)=>{"use strict";function h$(e,t,i,r){for(var n=e&65535|0,s=e>>>16&65535|0,a=0;i!==0;){a=i>2e3?2e3:i,i-=a;do n=n+t[r++]|0,s=s+n|0;while(--a);n%=65521,s%=65521}return n|s<<16|0}cL.exports=h$});var rE=_e((Noe,dL)=>{"use strict";function p$(){for(var e,t=[],i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[i]=e}return t}var f$=p$();function m$(e,t,i,r){var n=f$,s=r+i;e^=-1;for(var a=r;a<s;a++)e=e>>>8^n[(e^t[a])&255];return e^-1}dL.exports=m$});var Om=_e((Doe,hL)=>{"use strict";hL.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var EL=_e(Ns=>{"use strict";var Ar=ya(),xn=uL(),gL=iE(),io=rE(),g$=Om(),ol=0,y$=1,_$=3,oo=4,pL=5,Ls=0,fL=1,Tn=-2,b$=-3,nE=-5,P$=-1,E$=1,Mm=2,S$=3,v$=4,I$=0,A$=2,Hm=8,C$=9,x$=15,T$=8,w$=29,R$=256,aE=R$+1+w$,L$=30,N$=19,D$=2*aE+1,B$=15,It=3,so=258,$n=so+It+1,O$=32,jm=42,oE=69,km=73,Fm=91,Um=103,nl=113,Gd=666,Fi=1,Wd=2,sl=3,Mu=4,M$=3;function ao(e,t){return e.msg=g$[t],t}function mL(e){return(e<<1)-(e>4?9:0)}function no(e){for(var t=e.length;--t>=0;)e[t]=0}function ro(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),i!==0&&(Ar.arraySet(e.output,t.pending_buf,t.pending_out,i,e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,t.pending===0&&(t.pending_out=0))}function rr(e,t){xn._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ro(e.strm)}function wt(e,t){e.pending_buf[e.pending++]=t}function Yd(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255}function k$(e,t,i,r){var n=e.avail_in;return n>r&&(n=r),n===0?0:(e.avail_in-=n,Ar.arraySet(t,e.input,e.next_in,n,i),e.state.wrap===1?e.adler=gL(e.adler,t,n,i):e.state.wrap===2&&(e.adler=io(e.adler,t,n,i)),e.next_in+=n,e.total_in+=n,n)}function yL(e,t){var i=e.max_chain_length,r=e.strstart,n,s,a=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-$n?e.strstart-(e.w_size-$n):0,u=e.window,c=e.w_mask,h=e.prev,m=e.strstart+so,f=u[r+a-1],g=u[r+a];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do if(n=t,!(u[n+a]!==g||u[n+a-1]!==f||u[n]!==u[r]||u[++n]!==u[r+1])){r+=2,n++;do;while(u[++r]===u[++n]&&u[++r]===u[++n]&&u[++r]===u[++n]&&u[++r]===u[++n]&&u[++r]===u[++n]&&u[++r]===u[++n]&&u[++r]===u[++n]&&u[++r]===u[++n]&&r<m);if(s=so-(m-r),r=m-so,s>a){if(e.match_start=t,a=s,s>=o)break;f=u[r+a-1],g=u[r+a]}}while((t=h[t&c])>l&&--i!==0);return a<=e.lookahead?a:e.lookahead}function al(e){var t=e.w_size,i,r,n,s,a;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-$n)){Ar.arraySet(e.window,e.window,t,t,0),e.match_start-=t,e.strstart-=t,e.block_start-=t,r=e.hash_size,i=r;do n=e.head[--i],e.head[i]=n>=t?n-t:0;while(--r);r=t,i=r;do n=e.prev[--i],e.prev[i]=n>=t?n-t:0;while(--r);s+=t}if(e.strm.avail_in===0)break;if(r=k$(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=r,e.lookahead+e.insert>=It)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+It-1])&e.hash_mask,e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<It)););}while(e.lookahead<$n&&e.strm.avail_in!==0)}function F$(e,t){var i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(al(e),e.lookahead===0&&t===ol)return Fi;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+i;if((e.strstart===0||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,rr(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-$n&&(rr(e,!1),e.strm.avail_out===0))return Fi}return e.insert=0,t===oo?(rr(e,!0),e.strm.avail_out===0?sl:Mu):(e.strstart>e.block_start&&(rr(e,!1),e.strm.avail_out===0),Fi)}function sE(e,t){for(var i,r;;){if(e.lookahead<$n){if(al(e),e.lookahead<$n&&t===ol)return Fi;if(e.lookahead===0)break}if(i=0,e.lookahead>=It&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+It-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),i!==0&&e.strstart-i<=e.w_size-$n&&(e.match_length=yL(e,i)),e.match_length>=It)if(r=xn._tr_tally(e,e.strstart-e.match_start,e.match_length-It),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=It){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+It-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=xn._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(rr(e,!1),e.strm.avail_out===0))return Fi}return e.insert=e.strstart<It-1?e.strstart:It-1,t===oo?(rr(e,!0),e.strm.avail_out===0?sl:Mu):e.last_lit&&(rr(e,!1),e.strm.avail_out===0)?Fi:Wd}function Bu(e,t){for(var i,r,n;;){if(e.lookahead<$n){if(al(e),e.lookahead<$n&&t===ol)return Fi;if(e.lookahead===0)break}if(i=0,e.lookahead>=It&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+It-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=It-1,i!==0&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-$n&&(e.match_length=yL(e,i),e.match_length<=5&&(e.strategy===E$||e.match_length===It&&e.strstart-e.match_start>4096)&&(e.match_length=It-1)),e.prev_length>=It&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-It,r=xn._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-It),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+It-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=It-1,e.strstart++,r&&(rr(e,!1),e.strm.avail_out===0))return Fi}else if(e.match_available){if(r=xn._tr_tally(e,0,e.window[e.strstart-1]),r&&rr(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Fi}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=xn._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<It-1?e.strstart:It-1,t===oo?(rr(e,!0),e.strm.avail_out===0?sl:Mu):e.last_lit&&(rr(e,!1),e.strm.avail_out===0)?Fi:Wd}function U$(e,t){for(var i,r,n,s,a=e.window;;){if(e.lookahead<=so){if(al(e),e.lookahead<=so&&t===ol)return Fi;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=It&&e.strstart>0&&(n=e.strstart-1,r=a[n],r===a[++n]&&r===a[++n]&&r===a[++n])){s=e.strstart+so;do;while(r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&r===a[++n]&&n<s);e.match_length=so-(s-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=It?(i=xn._tr_tally(e,1,e.match_length-It),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=xn._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(rr(e,!1),e.strm.avail_out===0))return Fi}return e.insert=0,t===oo?(rr(e,!0),e.strm.avail_out===0?sl:Mu):e.last_lit&&(rr(e,!1),e.strm.avail_out===0)?Fi:Wd}function H$(e,t){for(var i;;){if(e.lookahead===0&&(al(e),e.lookahead===0)){if(t===ol)return Fi;break}if(e.match_length=0,i=xn._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(rr(e,!1),e.strm.avail_out===0))return Fi}return e.insert=0,t===oo?(rr(e,!0),e.strm.avail_out===0?sl:Mu):e.last_lit&&(rr(e,!1),e.strm.avail_out===0)?Fi:Wd}function Rs(e,t,i,r,n){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=r,this.func=n}var Ou;Ou=[new Rs(0,0,0,0,F$),new Rs(4,4,8,4,sE),new Rs(4,5,16,8,sE),new Rs(4,6,32,32,sE),new Rs(4,4,16,16,Bu),new Rs(8,16,32,32,Bu),new Rs(8,16,128,128,Bu),new Rs(8,32,128,256,Bu),new Rs(32,128,258,1024,Bu),new Rs(32,258,258,4096,Bu)];function j$(e){e.window_size=2*e.w_size,no(e.head),e.max_lazy_match=Ou[e.level].max_lazy,e.good_match=Ou[e.level].good_length,e.nice_match=Ou[e.level].nice_length,e.max_chain_length=Ou[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=It-1,e.match_available=0,e.ins_h=0}function Y$(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Hm,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Ar.Buf16(D$*2),this.dyn_dtree=new Ar.Buf16((2*L$+1)*2),this.bl_tree=new Ar.Buf16((2*N$+1)*2),no(this.dyn_ltree),no(this.dyn_dtree),no(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Ar.Buf16(B$+1),this.heap=new Ar.Buf16(2*aE+1),no(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Ar.Buf16(2*aE+1),no(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _L(e){var t;return!e||!e.state?ao(e,Tn):(e.total_in=e.total_out=0,e.data_type=A$,t=e.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?jm:nl,e.adler=t.wrap===2?0:1,t.last_flush=ol,xn._tr_init(t),Ls)}function bL(e){var t=_L(e);return t===Ls&&j$(e.state),t}function G$(e,t){return!e||!e.state||e.state.wrap!==2?Tn:(e.state.gzhead=t,Ls)}function PL(e,t,i,r,n,s){if(!e)return Tn;var a=1;if(t===P$&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),n<1||n>C$||i!==Hm||r<8||r>15||t<0||t>9||s<0||s>v$)return ao(e,Tn);r===8&&(r=9);var o=new Y$;return e.state=o,o.strm=e,o.wrap=a,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+It-1)/It),o.window=new Ar.Buf8(o.w_size*2),o.head=new Ar.Buf16(o.hash_size),o.prev=new Ar.Buf16(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Ar.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=3*o.lit_bufsize,o.level=t,o.strategy=s,o.method=i,bL(e)}function W$(e,t){return PL(e,t,Hm,x$,T$,I$)}function z$(e,t){var i,r,n,s;if(!e||!e.state||t>pL||t<0)return e?ao(e,Tn):Tn;if(r=e.state,!e.output||!e.input&&e.avail_in!==0||r.status===Gd&&t!==oo)return ao(e,e.avail_out===0?nE:Tn);if(r.strm=e,i=r.last_flush,r.last_flush=t,r.status===jm)if(r.wrap===2)e.adler=0,wt(r,31),wt(r,139),wt(r,8),r.gzhead?(wt(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),wt(r,r.gzhead.time&255),wt(r,r.gzhead.time>>8&255),wt(r,r.gzhead.time>>16&255),wt(r,r.gzhead.time>>24&255),wt(r,r.level===9?2:r.strategy>=Mm||r.level<2?4:0),wt(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(wt(r,r.gzhead.extra.length&255),wt(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=io(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=oE):(wt(r,0),wt(r,0),wt(r,0),wt(r,0),wt(r,0),wt(r,r.level===9?2:r.strategy>=Mm||r.level<2?4:0),wt(r,M$),r.status=nl);else{var a=Hm+(r.w_bits-8<<4)<<8,o=-1;r.strategy>=Mm||r.level<2?o=0:r.level<6?o=1:r.level===6?o=2:o=3,a|=o<<6,r.strstart!==0&&(a|=O$),a+=31-a%31,r.status=nl,Yd(r,a),r.strstart!==0&&(Yd(r,e.adler>>>16),Yd(r,e.adler&65535)),e.adler=1}if(r.status===oE)if(r.gzhead.extra){for(n=r.pending;r.gzindex<(r.gzhead.extra.length&65535)&&!(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=io(e.adler,r.pending_buf,r.pending-n,n)),ro(e),n=r.pending,r.pending===r.pending_buf_size));)wt(r,r.gzhead.extra[r.gzindex]&255),r.gzindex++;r.gzhead.hcrc&&r.pending>n&&(e.adler=io(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=km)}else r.status=km;if(r.status===km)if(r.gzhead.name){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=io(e.adler,r.pending_buf,r.pending-n,n)),ro(e),n=r.pending,r.pending===r.pending_buf_size)){s=1;break}r.gzindex<r.gzhead.name.length?s=r.gzhead.name.charCodeAt(r.gzindex++)&255:s=0,wt(r,s)}while(s!==0);r.gzhead.hcrc&&r.pending>n&&(e.adler=io(e.adler,r.pending_buf,r.pending-n,n)),s===0&&(r.gzindex=0,r.status=Fm)}else r.status=Fm;if(r.status===Fm)if(r.gzhead.comment){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=io(e.adler,r.pending_buf,r.pending-n,n)),ro(e),n=r.pending,r.pending===r.pending_buf_size)){s=1;break}r.gzindex<r.gzhead.comment.length?s=r.gzhead.comment.charCodeAt(r.gzindex++)&255:s=0,wt(r,s)}while(s!==0);r.gzhead.hcrc&&r.pending>n&&(e.adler=io(e.adler,r.pending_buf,r.pending-n,n)),s===0&&(r.status=Um)}else r.status=Um;if(r.status===Um&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&ro(e),r.pending+2<=r.pending_buf_size&&(wt(r,e.adler&255),wt(r,e.adler>>8&255),e.adler=0,r.status=nl)):r.status=nl),r.pending!==0){if(ro(e),e.avail_out===0)return r.last_flush=-1,Ls}else if(e.avail_in===0&&mL(t)<=mL(i)&&t!==oo)return ao(e,nE);if(r.status===Gd&&e.avail_in!==0)return ao(e,nE);if(e.avail_in!==0||r.lookahead!==0||t!==ol&&r.status!==Gd){var l=r.strategy===Mm?H$(r,t):r.strategy===S$?U$(r,t):Ou[r.level].func(r,t);if((l===sl||l===Mu)&&(r.status=Gd),l===Fi||l===sl)return e.avail_out===0&&(r.last_flush=-1),Ls;if(l===Wd&&(t===y$?xn._tr_align(r):t!==pL&&(xn._tr_stored_block(r,0,0,!1),t===_$&&(no(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),ro(e),e.avail_out===0))return r.last_flush=-1,Ls}return t!==oo?Ls:r.wrap<=0?fL:(r.wrap===2?(wt(r,e.adler&255),wt(r,e.adler>>8&255),wt(r,e.adler>>16&255),wt(r,e.adler>>24&255),wt(r,e.total_in&255),wt(r,e.total_in>>8&255),wt(r,e.total_in>>16&255),wt(r,e.total_in>>24&255)):(Yd(r,e.adler>>>16),Yd(r,e.adler&65535)),ro(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Ls:fL)}function V$(e){var t;return!e||!e.state?Tn:(t=e.state.status,t!==jm&&t!==oE&&t!==km&&t!==Fm&&t!==Um&&t!==nl&&t!==Gd?ao(e,Tn):(e.state=null,t===nl?ao(e,b$):Ls))}function q$(e,t){var i=t.length,r,n,s,a,o,l,u,c;if(!e||!e.state||(r=e.state,a=r.wrap,a===2||a===1&&r.status!==jm||r.lookahead))return Tn;for(a===1&&(e.adler=gL(e.adler,t,i,0)),r.wrap=0,i>=r.w_size&&(a===0&&(no(r.head),r.strstart=0,r.block_start=0,r.insert=0),c=new Ar.Buf8(r.w_size),Ar.arraySet(c,t,i-r.w_size,r.w_size,0),t=c,i=r.w_size),o=e.avail_in,l=e.next_in,u=e.input,e.avail_in=i,e.next_in=0,e.input=t,al(r);r.lookahead>=It;){n=r.strstart,s=r.lookahead-(It-1);do r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+It-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++;while(--s);r.strstart=n,r.lookahead=It-1,al(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=It-1,r.match_available=0,e.next_in=l,e.input=u,e.avail_in=o,r.wrap=a,Ls}Ns.deflateInit=W$;Ns.deflateInit2=PL;Ns.deflateReset=bL;Ns.deflateResetKeep=_L;Ns.deflateSetHeader=G$;Ns.deflate=z$;Ns.deflateEnd=V$;Ns.deflateSetDictionary=q$;Ns.deflateInfo="pako deflate (from Nodeca project)"});var lE=_e(ku=>{"use strict";var Ym=ya(),SL=!0,vL=!0;try{String.fromCharCode.apply(null,[0])}catch{SL=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{vL=!1}var zd=new Ym.Buf8(256);for(ba=0;ba<256;ba++)zd[ba]=ba>=252?6:ba>=248?5:ba>=240?4:ba>=224?3:ba>=192?2:1;var ba;zd[254]=zd[254]=1;ku.string2buf=function(e){var t,i,r,n,s,a=e.length,o=0;for(n=0;n<a;n++)i=e.charCodeAt(n),(i&64512)===55296&&n+1<a&&(r=e.charCodeAt(n+1),(r&64512)===56320&&(i=65536+(i-55296<<10)+(r-56320),n++)),o+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Ym.Buf8(o),s=0,n=0;s<o;n++)i=e.charCodeAt(n),(i&64512)===55296&&n+1<a&&(r=e.charCodeAt(n+1),(r&64512)===56320&&(i=65536+(i-55296<<10)+(r-56320),n++)),i<128?t[s++]=i:i<2048?(t[s++]=192|i>>>6,t[s++]=128|i&63):i<65536?(t[s++]=224|i>>>12,t[s++]=128|i>>>6&63,t[s++]=128|i&63):(t[s++]=240|i>>>18,t[s++]=128|i>>>12&63,t[s++]=128|i>>>6&63,t[s++]=128|i&63);return t};function IL(e,t){if(t<65534&&(e.subarray&&vL||!e.subarray&&SL))return String.fromCharCode.apply(null,Ym.shrinkBuf(e,t));for(var i="",r=0;r<t;r++)i+=String.fromCharCode(e[r]);return i}ku.buf2binstring=function(e){return IL(e,e.length)};ku.binstring2buf=function(e){for(var t=new Ym.Buf8(e.length),i=0,r=t.length;i<r;i++)t[i]=e.charCodeAt(i);return t};ku.buf2string=function(e,t){var i,r,n,s,a=t||e.length,o=new Array(a*2);for(r=0,i=0;i<a;){if(n=e[i++],n<128){o[r++]=n;continue}if(s=zd[n],s>4){o[r++]=65533,i+=s-1;continue}for(n&=s===2?31:s===3?15:7;s>1&&i<a;)n=n<<6|e[i++]&63,s--;if(s>1){o[r++]=65533;continue}n<65536?o[r++]=n:(n-=65536,o[r++]=55296|n>>10&1023,o[r++]=56320|n&1023)}return IL(o,r)};ku.utf8border=function(e,t){var i;for(t=t||e.length,t>e.length&&(t=e.length),i=t-1;i>=0&&(e[i]&192)===128;)i--;return i<0||i===0?t:i+zd[e[i]]>t?i:t}});var uE=_e((Moe,AL)=>{"use strict";function X$(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}AL.exports=X$});var wL=_e(Xd=>{"use strict";var Vd=EL(),qd=ya(),dE=lE(),hE=Om(),J$=uE(),TL=Object.prototype.toString,$$=0,cE=4,Fu=0,CL=1,xL=2,K$=-1,Z$=0,Q$=8;function ll(e){if(!(this instanceof ll))return new ll(e);this.options=qd.assign({level:K$,method:Q$,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z$,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new J$,this.strm.avail_out=0;var i=Vd.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==Fu)throw new Error(hE[i]);if(t.header&&Vd.deflateSetHeader(this.strm,t.header),t.dictionary){var r;if(typeof t.dictionary=="string"?r=dE.string2buf(t.dictionary):TL.call(t.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(t.dictionary):r=t.dictionary,i=Vd.deflateSetDictionary(this.strm,r),i!==Fu)throw new Error(hE[i]);this._dict_set=!0}}ll.prototype.push=function(e,t){var i=this.strm,r=this.options.chunkSize,n,s;if(this.ended)return!1;s=t===~~t?t:t===!0?cE:$$,typeof e=="string"?i.input=dE.string2buf(e):TL.call(e)==="[object ArrayBuffer]"?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(i.avail_out===0&&(i.output=new qd.Buf8(r),i.next_out=0,i.avail_out=r),n=Vd.deflate(i,s),n!==CL&&n!==Fu)return this.onEnd(n),this.ended=!0,!1;(i.avail_out===0||i.avail_in===0&&(s===cE||s===xL))&&(this.options.to==="string"?this.onData(dE.buf2binstring(qd.shrinkBuf(i.output,i.next_out))):this.onData(qd.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||i.avail_out===0)&&n!==CL);return s===cE?(n=Vd.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Fu):(s===xL&&(this.onEnd(Fu),i.avail_out=0),!0)};ll.prototype.onData=function(e){this.chunks.push(e)};ll.prototype.onEnd=function(e){e===Fu&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=qd.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function pE(e,t){var i=new ll(t);if(i.push(e,!0),i.err)throw i.msg||hE[i.err];return i.result}function eK(e,t){return t=t||{},t.raw=!0,pE(e,t)}function tK(e,t){return t=t||{},t.gzip=!0,pE(e,t)}Xd.Deflate=ll;Xd.deflate=pE;Xd.deflateRaw=eK;Xd.gzip=tK});var LL=_e((Foe,RL)=>{"use strict";var Gm=30,iK=12;RL.exports=function(t,i){var r,n,s,a,o,l,u,c,h,m,f,g,y,b,E,S,v,A,x,T,R,L,O,H,k;r=t.state,n=t.next_in,H=t.input,s=n+(t.avail_in-5),a=t.next_out,k=t.output,o=a-(i-t.avail_out),l=a+(t.avail_out-257),u=r.dmax,c=r.wsize,h=r.whave,m=r.wnext,f=r.window,g=r.hold,y=r.bits,b=r.lencode,E=r.distcode,S=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;e:do{y<15&&(g+=H[n++]<<y,y+=8,g+=H[n++]<<y,y+=8),A=b[g&S];t:for(;;){if(x=A>>>24,g>>>=x,y-=x,x=A>>>16&255,x===0)k[a++]=A&65535;else if(x&16){T=A&65535,x&=15,x&&(y<x&&(g+=H[n++]<<y,y+=8),T+=g&(1<<x)-1,g>>>=x,y-=x),y<15&&(g+=H[n++]<<y,y+=8,g+=H[n++]<<y,y+=8),A=E[g&v];i:for(;;){if(x=A>>>24,g>>>=x,y-=x,x=A>>>16&255,x&16){if(R=A&65535,x&=15,y<x&&(g+=H[n++]<<y,y+=8,y<x&&(g+=H[n++]<<y,y+=8)),R+=g&(1<<x)-1,R>u){t.msg="invalid distance too far back",r.mode=Gm;break e}if(g>>>=x,y-=x,x=a-o,R>x){if(x=R-x,x>h&&r.sane){t.msg="invalid distance too far back",r.mode=Gm;break e}if(L=0,O=f,m===0){if(L+=c-x,x<T){T-=x;do k[a++]=f[L++];while(--x);L=a-R,O=k}}else if(m<x){if(L+=c+m-x,x-=m,x<T){T-=x;do k[a++]=f[L++];while(--x);if(L=0,m<T){x=m,T-=x;do k[a++]=f[L++];while(--x);L=a-R,O=k}}}else if(L+=m-x,x<T){T-=x;do k[a++]=f[L++];while(--x);L=a-R,O=k}for(;T>2;)k[a++]=O[L++],k[a++]=O[L++],k[a++]=O[L++],T-=3;T&&(k[a++]=O[L++],T>1&&(k[a++]=O[L++]))}else{L=a-R;do k[a++]=k[L++],k[a++]=k[L++],k[a++]=k[L++],T-=3;while(T>2);T&&(k[a++]=k[L++],T>1&&(k[a++]=k[L++]))}}else if((x&64)===0){A=E[(A&65535)+(g&(1<<x)-1)];continue i}else{t.msg="invalid distance code",r.mode=Gm;break e}break}}else if((x&64)===0){A=b[(A&65535)+(g&(1<<x)-1)];continue t}else if(x&32){r.mode=iK;break e}else{t.msg="invalid literal/length code",r.mode=Gm;break e}break}}while(n<s&&a<l);T=y>>3,n-=T,y-=T<<3,g&=(1<<y)-1,t.next_in=n,t.next_out=a,t.avail_in=n<s?5+(s-n):5-(n-s),t.avail_out=a<l?257+(l-a):257-(a-l),r.hold=g,r.bits=y}});var FL=_e((Uoe,kL)=>{"use strict";var NL=ya(),Uu=15,DL=852,BL=592,OL=0,fE=1,ML=2,rK=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],nK=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],sK=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],aK=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];kL.exports=function(t,i,r,n,s,a,o,l){var u=l.bits,c=0,h=0,m=0,f=0,g=0,y=0,b=0,E=0,S=0,v=0,A,x,T,R,L,O=null,H=0,k,ee=new NL.Buf16(Uu+1),q=new NL.Buf16(Uu+1),Q=null,ne=0,G,X,D;for(c=0;c<=Uu;c++)ee[c]=0;for(h=0;h<n;h++)ee[i[r+h]]++;for(g=u,f=Uu;f>=1&&ee[f]===0;f--);if(g>f&&(g=f),f===0)return s[a++]=1<<24|64<<16|0,s[a++]=1<<24|64<<16|0,l.bits=1,0;for(m=1;m<f&&ee[m]===0;m++);for(g<m&&(g=m),E=1,c=1;c<=Uu;c++)if(E<<=1,E-=ee[c],E<0)return-1;if(E>0&&(t===OL||f!==1))return-1;for(q[1]=0,c=1;c<Uu;c++)q[c+1]=q[c]+ee[c];for(h=0;h<n;h++)i[r+h]!==0&&(o[q[i[r+h]]++]=h);if(t===OL?(O=Q=o,k=19):t===fE?(O=rK,H-=257,Q=nK,ne-=257,k=256):(O=sK,Q=aK,k=-1),v=0,h=0,c=m,L=a,y=g,b=0,T=-1,S=1<<g,R=S-1,t===fE&&S>DL||t===ML&&S>BL)return 1;for(;;){G=c-b,o[h]<k?(X=0,D=o[h]):o[h]>k?(X=Q[ne+o[h]],D=O[H+o[h]]):(X=96,D=0),A=1<<c-b,x=1<<y,m=x;do x-=A,s[L+(v>>b)+x]=G<<24|X<<16|D|0;while(x!==0);for(A=1<<c-1;v&A;)A>>=1;if(A!==0?(v&=A-1,v+=A):v=0,h++,--ee[c]===0){if(c===f)break;c=i[r+o[h]]}if(c>g&&(v&R)!==T){for(b===0&&(b=g),L+=m,y=c-b,E=1<<y;y+b<f&&(E-=ee[y+b],!(E<=0));)y++,E<<=1;if(S+=1<<y,t===fE&&S>DL||t===ML&&S>BL)return 1;T=v&R,s[T]=g<<24|y<<16|L-a|0}}return v!==0&&(s[L+v]=c-b<<24|64<<16|0),l.bits=g,0}});var bN=_e(Kn=>{"use strict";var sn=ya(),PE=iE(),Ds=rE(),oK=LL(),Jd=FL(),lK=0,cN=1,dN=2,UL=4,uK=5,Wm=6,ul=0,cK=1,dK=2,wn=-2,hN=-3,EE=-4,hK=-5,HL=8,pN=1,jL=2,YL=3,GL=4,WL=5,zL=6,VL=7,qL=8,XL=9,JL=10,qm=11,Pa=12,mE=13,$L=14,gE=15,KL=16,ZL=17,QL=18,eN=19,zm=20,Vm=21,tN=22,iN=23,rN=24,nN=25,sN=26,yE=27,aN=28,oN=29,ni=30,SE=31,pK=32,fK=852,mK=592,gK=15,yK=gK;function lN(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function _K(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new sn.Buf16(320),this.work=new sn.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function fN(e){var t;return!e||!e.state?wn:(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=pN,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new sn.Buf32(fK),t.distcode=t.distdyn=new sn.Buf32(mK),t.sane=1,t.back=-1,ul)}function mN(e){var t;return!e||!e.state?wn:(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,fN(e))}function gN(e,t){var i,r;return!e||!e.state||(r=e.state,t<0?(i=0,t=-t):(i=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15))?wn:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=i,r.wbits=t,mN(e))}function yN(e,t){var i,r;return e?(r=new _K,e.state=r,r.window=null,i=gN(e,t),i!==ul&&(e.state=null),i):wn}function bK(e){return yN(e,yK)}var uN=!0,_E,bE;function PK(e){if(uN){var t;for(_E=new sn.Buf32(512),bE=new sn.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Jd(cN,e.lens,0,288,_E,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Jd(dN,e.lens,0,32,bE,0,e.work,{bits:5}),uN=!1}e.lencode=_E,e.lenbits=9,e.distcode=bE,e.distbits=5}function _N(e,t,i,r){var n,s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new sn.Buf8(s.wsize)),r>=s.wsize?(sn.arraySet(s.window,t,i-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>r&&(n=r),sn.arraySet(s.window,t,i-r,n,s.wnext),r-=n,r?(sn.arraySet(s.window,t,i-r,r,0),s.wnext=r,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0}function EK(e,t){var i,r,n,s,a,o,l,u,c,h,m,f,g,y,b=0,E,S,v,A,x,T,R,L,O=new sn.Buf8(4),H,k,ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return wn;i=e.state,i.mode===Pa&&(i.mode=mE),a=e.next_out,n=e.output,l=e.avail_out,s=e.next_in,r=e.input,o=e.avail_in,u=i.hold,c=i.bits,h=o,m=l,L=ul;e:for(;;)switch(i.mode){case pN:if(i.wrap===0){i.mode=mE;break}for(;c<16;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}if(i.wrap&2&&u===35615){i.check=0,O[0]=u&255,O[1]=u>>>8&255,i.check=Ds(i.check,O,2,0),u=0,c=0,i.mode=jL;break}if(i.flags=0,i.head&&(i.head.done=!1),!(i.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",i.mode=ni;break}if((u&15)!==HL){e.msg="unknown compression method",i.mode=ni;break}if(u>>>=4,c-=4,R=(u&15)+8,i.wbits===0)i.wbits=R;else if(R>i.wbits){e.msg="invalid window size",i.mode=ni;break}i.dmax=1<<R,e.adler=i.check=1,i.mode=u&512?JL:Pa,u=0,c=0;break;case jL:for(;c<16;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}if(i.flags=u,(i.flags&255)!==HL){e.msg="unknown compression method",i.mode=ni;break}if(i.flags&57344){e.msg="unknown header flags set",i.mode=ni;break}i.head&&(i.head.text=u>>8&1),i.flags&512&&(O[0]=u&255,O[1]=u>>>8&255,i.check=Ds(i.check,O,2,0)),u=0,c=0,i.mode=YL;case YL:for(;c<32;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}i.head&&(i.head.time=u),i.flags&512&&(O[0]=u&255,O[1]=u>>>8&255,O[2]=u>>>16&255,O[3]=u>>>24&255,i.check=Ds(i.check,O,4,0)),u=0,c=0,i.mode=GL;case GL:for(;c<16;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}i.head&&(i.head.xflags=u&255,i.head.os=u>>8),i.flags&512&&(O[0]=u&255,O[1]=u>>>8&255,i.check=Ds(i.check,O,2,0)),u=0,c=0,i.mode=WL;case WL:if(i.flags&1024){for(;c<16;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}i.length=u,i.head&&(i.head.extra_len=u),i.flags&512&&(O[0]=u&255,O[1]=u>>>8&255,i.check=Ds(i.check,O,2,0)),u=0,c=0}else i.head&&(i.head.extra=null);i.mode=zL;case zL:if(i.flags&1024&&(f=i.length,f>o&&(f=o),f&&(i.head&&(R=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),sn.arraySet(i.head.extra,r,s,f,R)),i.flags&512&&(i.check=Ds(i.check,r,f,s)),o-=f,s+=f,i.length-=f),i.length))break e;i.length=0,i.mode=VL;case VL:if(i.flags&2048){if(o===0)break e;f=0;do R=r[s+f++],i.head&&R&&i.length<65536&&(i.head.name+=String.fromCharCode(R));while(R&&f<o);if(i.flags&512&&(i.check=Ds(i.check,r,f,s)),o-=f,s+=f,R)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=qL;case qL:if(i.flags&4096){if(o===0)break e;f=0;do R=r[s+f++],i.head&&R&&i.length<65536&&(i.head.comment+=String.fromCharCode(R));while(R&&f<o);if(i.flags&512&&(i.check=Ds(i.check,r,f,s)),o-=f,s+=f,R)break e}else i.head&&(i.head.comment=null);i.mode=XL;case XL:if(i.flags&512){for(;c<16;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}if(u!==(i.check&65535)){e.msg="header crc mismatch",i.mode=ni;break}u=0,c=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=Pa;break;case JL:for(;c<32;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}e.adler=i.check=lN(u),u=0,c=0,i.mode=qm;case qm:if(i.havedict===0)return e.next_out=a,e.avail_out=l,e.next_in=s,e.avail_in=o,i.hold=u,i.bits=c,dK;e.adler=i.check=1,i.mode=Pa;case Pa:if(t===uK||t===Wm)break e;case mE:if(i.last){u>>>=c&7,c-=c&7,i.mode=yE;break}for(;c<3;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}switch(i.last=u&1,u>>>=1,c-=1,u&3){case 0:i.mode=$L;break;case 1:if(PK(i),i.mode=zm,t===Wm){u>>>=2,c-=2;break e}break;case 2:i.mode=ZL;break;case 3:e.msg="invalid block type",i.mode=ni}u>>>=2,c-=2;break;case $L:for(u>>>=c&7,c-=c&7;c<32;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",i.mode=ni;break}if(i.length=u&65535,u=0,c=0,i.mode=gE,t===Wm)break e;case gE:i.mode=KL;case KL:if(f=i.length,f){if(f>o&&(f=o),f>l&&(f=l),f===0)break e;sn.arraySet(n,r,s,f,a),o-=f,s+=f,l-=f,a+=f,i.length-=f;break}i.mode=Pa;break;case ZL:for(;c<14;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}if(i.nlen=(u&31)+257,u>>>=5,c-=5,i.ndist=(u&31)+1,u>>>=5,c-=5,i.ncode=(u&15)+4,u>>>=4,c-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=ni;break}i.have=0,i.mode=QL;case QL:for(;i.have<i.ncode;){for(;c<3;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}i.lens[ee[i.have++]]=u&7,u>>>=3,c-=3}for(;i.have<19;)i.lens[ee[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,H={bits:i.lenbits},L=Jd(lK,i.lens,0,19,i.lencode,0,i.work,H),i.lenbits=H.bits,L){e.msg="invalid code lengths set",i.mode=ni;break}i.have=0,i.mode=eN;case eN:for(;i.have<i.nlen+i.ndist;){for(;b=i.lencode[u&(1<<i.lenbits)-1],E=b>>>24,S=b>>>16&255,v=b&65535,!(E<=c);){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}if(v<16)u>>>=E,c-=E,i.lens[i.have++]=v;else{if(v===16){for(k=E+2;c<k;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}if(u>>>=E,c-=E,i.have===0){e.msg="invalid bit length repeat",i.mode=ni;break}R=i.lens[i.have-1],f=3+(u&3),u>>>=2,c-=2}else if(v===17){for(k=E+3;c<k;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}u>>>=E,c-=E,R=0,f=3+(u&7),u>>>=3,c-=3}else{for(k=E+7;c<k;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}u>>>=E,c-=E,R=0,f=11+(u&127),u>>>=7,c-=7}if(i.have+f>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=ni;break}for(;f--;)i.lens[i.have++]=R}}if(i.mode===ni)break;if(i.lens[256]===0){e.msg="invalid code -- missing end-of-block",i.mode=ni;break}if(i.lenbits=9,H={bits:i.lenbits},L=Jd(cN,i.lens,0,i.nlen,i.lencode,0,i.work,H),i.lenbits=H.bits,L){e.msg="invalid literal/lengths set",i.mode=ni;break}if(i.distbits=6,i.distcode=i.distdyn,H={bits:i.distbits},L=Jd(dN,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,H),i.distbits=H.bits,L){e.msg="invalid distances set",i.mode=ni;break}if(i.mode=zm,t===Wm)break e;case zm:i.mode=Vm;case Vm:if(o>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=s,e.avail_in=o,i.hold=u,i.bits=c,oK(e,m),a=e.next_out,n=e.output,l=e.avail_out,s=e.next_in,r=e.input,o=e.avail_in,u=i.hold,c=i.bits,i.mode===Pa&&(i.back=-1);break}for(i.back=0;b=i.lencode[u&(1<<i.lenbits)-1],E=b>>>24,S=b>>>16&255,v=b&65535,!(E<=c);){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}if(S&&(S&240)===0){for(A=E,x=S,T=v;b=i.lencode[T+((u&(1<<A+x)-1)>>A)],E=b>>>24,S=b>>>16&255,v=b&65535,!(A+E<=c);){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}u>>>=A,c-=A,i.back+=A}if(u>>>=E,c-=E,i.back+=E,i.length=v,S===0){i.mode=sN;break}if(S&32){i.back=-1,i.mode=Pa;break}if(S&64){e.msg="invalid literal/length code",i.mode=ni;break}i.extra=S&15,i.mode=tN;case tN:if(i.extra){for(k=i.extra;c<k;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}i.length+=u&(1<<i.extra)-1,u>>>=i.extra,c-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=iN;case iN:for(;b=i.distcode[u&(1<<i.distbits)-1],E=b>>>24,S=b>>>16&255,v=b&65535,!(E<=c);){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}if((S&240)===0){for(A=E,x=S,T=v;b=i.distcode[T+((u&(1<<A+x)-1)>>A)],E=b>>>24,S=b>>>16&255,v=b&65535,!(A+E<=c);){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}u>>>=A,c-=A,i.back+=A}if(u>>>=E,c-=E,i.back+=E,S&64){e.msg="invalid distance code",i.mode=ni;break}i.offset=v,i.extra=S&15,i.mode=rN;case rN:if(i.extra){for(k=i.extra;c<k;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}i.offset+=u&(1<<i.extra)-1,u>>>=i.extra,c-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=ni;break}i.mode=nN;case nN:if(l===0)break e;if(f=m-l,i.offset>f){if(f=i.offset-f,f>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=ni;break}f>i.wnext?(f-=i.wnext,g=i.wsize-f):g=i.wnext-f,f>i.length&&(f=i.length),y=i.window}else y=n,g=a-i.offset,f=i.length;f>l&&(f=l),l-=f,i.length-=f;do n[a++]=y[g++];while(--f);i.length===0&&(i.mode=Vm);break;case sN:if(l===0)break e;n[a++]=i.length,l--,i.mode=Vm;break;case yE:if(i.wrap){for(;c<32;){if(o===0)break e;o--,u|=r[s++]<<c,c+=8}if(m-=l,e.total_out+=m,i.total+=m,m&&(e.adler=i.check=i.flags?Ds(i.check,n,m,a-m):PE(i.check,n,m,a-m)),m=l,(i.flags?u:lN(u))!==i.check){e.msg="incorrect data check",i.mode=ni;break}u=0,c=0}i.mode=aN;case aN:if(i.wrap&&i.flags){for(;c<32;){if(o===0)break e;o--,u+=r[s++]<<c,c+=8}if(u!==(i.total&4294967295)){e.msg="incorrect length check",i.mode=ni;break}u=0,c=0}i.mode=oN;case oN:L=cK;break e;case ni:L=hN;break e;case SE:return EE;case pK:default:return wn}return e.next_out=a,e.avail_out=l,e.next_in=s,e.avail_in=o,i.hold=u,i.bits=c,(i.wsize||m!==e.avail_out&&i.mode<ni&&(i.mode<yE||t!==UL))&&_N(e,e.output,e.next_out,m-e.avail_out)?(i.mode=SE,EE):(h-=e.avail_in,m-=e.avail_out,e.total_in+=h,e.total_out+=m,i.total+=m,i.wrap&&m&&(e.adler=i.check=i.flags?Ds(i.check,n,m,e.next_out-m):PE(i.check,n,m,e.next_out-m)),e.data_type=i.bits+(i.last?64:0)+(i.mode===Pa?128:0)+(i.mode===zm||i.mode===gE?256:0),(h===0&&m===0||t===UL)&&L===ul&&(L=hK),L)}function SK(e){if(!e||!e.state)return wn;var t=e.state;return t.window&&(t.window=null),e.state=null,ul}function vK(e,t){var i;return!e||!e.state||(i=e.state,(i.wrap&2)===0)?wn:(i.head=t,t.done=!1,ul)}function IK(e,t){var i=t.length,r,n,s;return!e||!e.state||(r=e.state,r.wrap!==0&&r.mode!==qm)?wn:r.mode===qm&&(n=1,n=PE(n,t,i,0),n!==r.check)?hN:(s=_N(e,t,i,i),s?(r.mode=SE,EE):(r.havedict=1,ul))}Kn.inflateReset=mN;Kn.inflateReset2=gN;Kn.inflateResetKeep=fN;Kn.inflateInit=bK;Kn.inflateInit2=yN;Kn.inflate=EK;Kn.inflateEnd=SK;Kn.inflateGetHeader=vK;Kn.inflateSetDictionary=IK;Kn.inflateInfo="pako inflate (from Nodeca project)"});var vE=_e((joe,PN)=>{"use strict";PN.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var SN=_e((Yoe,EN)=>{"use strict";function AK(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}EN.exports=AK});var IN=_e(Kd=>{"use strict";var Hu=bN(),$d=ya(),Xm=lE(),Pi=vE(),IE=Om(),CK=uE(),xK=SN(),vN=Object.prototype.toString;function cl(e){if(!(this instanceof cl))return new cl(e);this.options=$d.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new CK,this.strm.avail_out=0;var i=Hu.inflateInit2(this.strm,t.windowBits);if(i!==Pi.Z_OK)throw new Error(IE[i]);if(this.header=new xK,Hu.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Xm.string2buf(t.dictionary):vN.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=Hu.inflateSetDictionary(this.strm,t.dictionary),i!==Pi.Z_OK)))throw new Error(IE[i])}cl.prototype.push=function(e,t){var i=this.strm,r=this.options.chunkSize,n=this.options.dictionary,s,a,o,l,u,c=!1;if(this.ended)return!1;a=t===~~t?t:t===!0?Pi.Z_FINISH:Pi.Z_NO_FLUSH,typeof e=="string"?i.input=Xm.binstring2buf(e):vN.call(e)==="[object ArrayBuffer]"?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(i.avail_out===0&&(i.output=new $d.Buf8(r),i.next_out=0,i.avail_out=r),s=Hu.inflate(i,Pi.Z_NO_FLUSH),s===Pi.Z_NEED_DICT&&n&&(s=Hu.inflateSetDictionary(this.strm,n)),s===Pi.Z_BUF_ERROR&&c===!0&&(s=Pi.Z_OK,c=!1),s!==Pi.Z_STREAM_END&&s!==Pi.Z_OK)return this.onEnd(s),this.ended=!0,!1;i.next_out&&(i.avail_out===0||s===Pi.Z_STREAM_END||i.avail_in===0&&(a===Pi.Z_FINISH||a===Pi.Z_SYNC_FLUSH))&&(this.options.to==="string"?(o=Xm.utf8border(i.output,i.next_out),l=i.next_out-o,u=Xm.buf2string(i.output,o),i.next_out=l,i.avail_out=r-l,l&&$d.arraySet(i.output,i.output,o,l,0),this.onData(u)):this.onData($d.shrinkBuf(i.output,i.next_out))),i.avail_in===0&&i.avail_out===0&&(c=!0)}while((i.avail_in>0||i.avail_out===0)&&s!==Pi.Z_STREAM_END);return s===Pi.Z_STREAM_END&&(a=Pi.Z_FINISH),a===Pi.Z_FINISH?(s=Hu.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===Pi.Z_OK):(a===Pi.Z_SYNC_FLUSH&&(this.onEnd(Pi.Z_OK),i.avail_out=0),!0)};cl.prototype.onData=function(e){this.chunks.push(e)};cl.prototype.onEnd=function(e){e===Pi.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=$d.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function AE(e,t){var i=new cl(t);if(i.push(e,!0),i.err)throw i.msg||IE[i.err];return i.result}function TK(e,t){return t=t||{},t.raw=!0,AE(e,t)}Kd.Inflate=cl;Kd.inflate=AE;Kd.inflateRaw=TK;Kd.ungzip=AE});var xN=_e((Woe,CN)=>{"use strict";var wK=ya().assign,RK=wL(),LK=IN(),NK=vE(),AN={};wK(AN,RK,LK,NK);CN.exports=AN});var wN=_e($m=>{"use strict";var DK=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",BK=xN(),TN=ci(),Jm=nn(),OK=DK?"uint8array":"array";$m.magic="\b\0";function dl(e,t){Jm.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}TN.inherits(dl,Jm);dl.prototype.processChunk=function(e){this.meta=e.meta,this._pako===null&&this._createPako(),this._pako.push(TN.transformTo(OK,e.data),!1)};dl.prototype.flush=function(){Jm.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)};dl.prototype.cleanUp=function(){Jm.prototype.cleanUp.call(this),this._pako=null};dl.prototype._createPako=function(){this._pako=new BK[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}};$m.compressWorker=function(e){return new dl("Deflate",e)};$m.uncompressWorker=function(){return new dl("Inflate",{})}});var xE=_e(CE=>{"use strict";var RN=nn();CE.STORE={magic:"\0\0",compressWorker:function(){return new RN("STORE compression")},uncompressWorker:function(){return new RN("STORE decompression")}};CE.DEFLATE=wN()});var TE=_e(hl=>{"use strict";hl.LOCAL_FILE_HEADER="PK";hl.CENTRAL_FILE_HEADER="PK";hl.CENTRAL_DIRECTORY_END="PK";hl.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07";hl.ZIP64_CENTRAL_DIRECTORY_END="PK";hl.DATA_DESCRIPTOR="PK\x07\b"});var BN=_e((Xoe,DN)=>{"use strict";var ju=ci(),Yu=nn(),wE=wu(),LN=Rm(),Km=TE(),Xt=function(e,t){var i="",r;for(r=0;r<t;r++)i+=String.fromCharCode(e&255),e=e>>>8;return i},MK=function(e,t){var i=e;return e||(i=t?16893:33204),(i&65535)<<16},kK=function(e){return(e||0)&63},NN=function(e,t,i,r,n,s){var a=e.file,o=e.compression,l=s!==wE.utf8encode,u=ju.transformTo("string",s(a.name)),c=ju.transformTo("string",wE.utf8encode(a.name)),h=a.comment,m=ju.transformTo("string",s(h)),f=ju.transformTo("string",wE.utf8encode(h)),g=c.length!==a.name.length,y=f.length!==h.length,b,E,S="",v="",A="",x=a.dir,T=a.date,R={crc32:0,compressedSize:0,uncompressedSize:0};(!t||i)&&(R.crc32=e.crc32,R.compressedSize=e.compressedSize,R.uncompressedSize=e.uncompressedSize);var L=0;t&&(L|=8),!l&&(g||y)&&(L|=2048);var O=0,H=0;x&&(O|=16),n==="UNIX"?(H=798,O|=MK(a.unixPermissions,x)):(H=20,O|=kK(a.dosPermissions,x)),b=T.getUTCHours(),b=b<<6,b=b|T.getUTCMinutes(),b=b<<5,b=b|T.getUTCSeconds()/2,E=T.getUTCFullYear()-1980,E=E<<4,E=E|T.getUTCMonth()+1,E=E<<5,E=E|T.getUTCDate(),g&&(v=Xt(1,1)+Xt(LN(u),4)+c,S+="up"+Xt(v.length,2)+v),y&&(A=Xt(1,1)+Xt(LN(m),4)+f,S+="uc"+Xt(A.length,2)+A);var k="";k+=`
\0`,k+=Xt(L,2),k+=o.magic,k+=Xt(b,2),k+=Xt(E,2),k+=Xt(R.crc32,4),k+=Xt(R.compressedSize,4),k+=Xt(R.uncompressedSize,4),k+=Xt(u.length,2),k+=Xt(S.length,2);var ee=Km.LOCAL_FILE_HEADER+k+u+S,q=Km.CENTRAL_FILE_HEADER+Xt(H,2)+k+Xt(m.length,2)+"\0\0\0\0"+Xt(O,4)+Xt(r,4)+u+S+m;return{fileRecord:ee,dirRecord:q}},FK=function(e,t,i,r,n){var s="",a=ju.transformTo("string",n(r));return s=Km.CENTRAL_DIRECTORY_END+"\0\0\0\0"+Xt(e,2)+Xt(e,2)+Xt(t,4)+Xt(i,4)+Xt(a.length,2)+a,s},UK=function(e){var t="";return t=Km.DATA_DESCRIPTOR+Xt(e.crc32,4)+Xt(e.compressedSize,4)+Xt(e.uncompressedSize,4),t};function Zn(e,t,i,r){Yu.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=i,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}ju.inherits(Zn,Yu);Zn.prototype.push=function(e){var t=e.meta.percent||0,i=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,Yu.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:i?(t+100*(i-r-1))/i:100}}))};Zn.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var i=NN(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:i.fileRecord,meta:{percent:0}})}else this.accumulate=!0};Zn.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,i=NN(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(i.dirRecord),t)this.push({data:UK(e),meta:{percent:100}});else for(this.push({data:i.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null};Zn.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var i=this.bytesWritten-e,r=FK(this.dirRecords.length,i,e,this.zipComment,this.encodeFileName);this.push({data:r,meta:{percent:100}})};Zn.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()};Zn.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(i){t.processChunk(i)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(i){t.error(i)}),this};Zn.prototype.resume=function(){if(!Yu.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0};Zn.prototype.error=function(e){var t=this._sources;if(!Yu.prototype.error.call(this,e))return!1;for(var i=0;i<t.length;i++)try{t[i].error(e)}catch{}return!0};Zn.prototype.lock=function(){Yu.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()};DN.exports=Zn});var MN=_e(ON=>{"use strict";var HK=xE(),jK=BN(),YK=function(e,t){var i=e||t,r=HK[i];if(!r)throw new Error(i+" is not a valid compression method !");return r};ON.generateWorker=function(e,t,i){var r=new jK(t.streamFiles,i,t.platform,t.encodeFileName),n=0;try{e.forEach(function(s,a){n++;var o=YK(a.options.compression,t.compression),l=a.options.compressionOptions||t.compressionOptions||{},u=a.dir,c=a.date;a._compressWorker(o,l).withStreamInfo("file",{name:s,dir:u,date:c,comment:a.comment||"",unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions}).pipe(r)}),r.entriesCount=n}catch(s){r.error(s)}return r}});var FN=_e(($oe,kN)=>{"use strict";var GK=ci(),Zm=nn();function Zd(e,t){Zm.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}GK.inherits(Zd,Zm);Zd.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on("data",function(i){t.push({data:i,meta:{percent:0}})}).on("error",function(i){t.isPaused?this.generatedError=i:t.error(i)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})};Zd.prototype.pause=function(){return Zm.prototype.pause.call(this)?(this._stream.pause(),!0):!1};Zd.prototype.resume=function(){return Zm.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1};kN.exports=Zd});var XN=_e((Koe,qN)=>{"use strict";var WK=wu(),Qd=ci(),YN=nn(),zK=BP(),GN=OP(),UN=Lm(),VK=HR(),qK=MN(),HN=Td(),XK=FN(),WN=function(e,t,i){var r=Qd.getTypeOf(t),n,s=Qd.extend(i||{},GN);s.date=s.date||new Date,s.compression!==null&&(s.compression=s.compression.toUpperCase()),typeof s.unixPermissions=="string"&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&s.unixPermissions&16384&&(s.dir=!0),s.dosPermissions&&s.dosPermissions&16&&(s.dir=!0),s.dir&&(e=zN(e)),s.createFolders&&(n=JK(e))&&VN.call(this,n,!0);var a=r==="string"&&s.binary===!1&&s.base64===!1;(!i||typeof i.binary>"u")&&(s.binary=!a);var o=t instanceof UN&&t.uncompressedSize===0;(o||s.dir||!t||t.length===0)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",r="string");var l=null;t instanceof UN||t instanceof YN?l=t:HN.isNode&&HN.isStream(t)?l=new XK(e,t):l=Qd.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var u=new VK(e,l,s);this.files[e]=u},JK=function(e){e.slice(-1)==="/"&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},zN=function(e){return e.slice(-1)!=="/"&&(e+="/"),e},VN=function(e,t){return t=typeof t<"u"?t:GN.createFolders,e=zN(e),this.files[e]||WN.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function jN(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var $K={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,i,r;for(t in this.files)r=this.files[t],i=t.slice(this.root.length,t.length),i&&t.slice(0,this.root.length)===this.root&&e(i,r)},filter:function(e){var t=[];return this.forEach(function(i,r){e(i,r)&&t.push(r)}),t},file:function(e,t,i){if(arguments.length===1)if(jN(e)){var r=e;return this.filter(function(s,a){return!a.dir&&r.test(s)})}else{var n=this.files[this.root+e];return n&&!n.dir?n:null}else e=this.root+e,WN.call(this,e,t,i);return this},folder:function(e){if(!e)return this;if(jN(e))return this.filter(function(n,s){return s.dir&&e.test(n)});var t=this.root+e,i=VN.call(this,t),r=this.clone();return r.root=i.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||(e.slice(-1)!=="/"&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var i=this.filter(function(n,s){return s.name.slice(0,e.length)===e}),r=0;r<i.length;r++)delete this.files[i[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,i={};try{if(i=Qd.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:WK.utf8encode}),i.type=i.type.toLowerCase(),i.compression=i.compression.toUpperCase(),i.type==="binarystring"&&(i.type="string"),!i.type)throw new Error("No output type specified.");Qd.checkSupport(i.type),(i.platform==="darwin"||i.platform==="freebsd"||i.platform==="linux"||i.platform==="sunos")&&(i.platform="UNIX"),i.platform==="win32"&&(i.platform="DOS");var r=i.comment||this.comment||"";t=qK.generateWorker(this,i,r)}catch(n){t=new YN("error"),t.error(n)}return new zK(t,i.type||"string",i.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return e=e||{},e.type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};qN.exports=$K});var RE=_e((Zoe,$N)=>{"use strict";var KK=ci();function JN(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}JN.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t=0,i;for(this.checkOffset(e),i=this.index+e-1;i>=this.index;i--)t=(t<<8)+this.byteAt(i);return this.index+=e,t},readString:function(e){return KK.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(e&31)<<1))}};$N.exports=JN});var LE=_e((Qoe,ZN)=>{"use strict";var KN=RE(),ZK=ci();function Gu(e){KN.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=e[t]&255}ZK.inherits(Gu,KN);Gu.prototype.byteAt=function(e){return this.data[this.zero+e]};Gu.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),i=e.charCodeAt(1),r=e.charCodeAt(2),n=e.charCodeAt(3),s=this.length-4;s>=0;--s)if(this.data[s]===t&&this.data[s+1]===i&&this.data[s+2]===r&&this.data[s+3]===n)return s-this.zero;return-1};Gu.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),i=e.charCodeAt(1),r=e.charCodeAt(2),n=e.charCodeAt(3),s=this.readData(4);return t===s[0]&&i===s[1]&&r===s[2]&&n===s[3]};Gu.prototype.readData=function(e){if(this.checkOffset(e),e===0)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};ZN.exports=Gu});var tD=_e((ele,eD)=>{"use strict";var QN=RE(),QK=ci();function Wu(e){QN.call(this,e)}QK.inherits(Wu,QN);Wu.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)};Wu.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero};Wu.prototype.readAndCheckSignature=function(e){var t=this.readData(4);return e===t};Wu.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};eD.exports=Wu});var DE=_e((tle,rD)=>{"use strict";var iD=LE(),eZ=ci();function NE(e){iD.call(this,e)}eZ.inherits(NE,iD);NE.prototype.readData=function(e){if(this.checkOffset(e),e===0)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};rD.exports=NE});var aD=_e((ile,sD)=>{"use strict";var nD=DE(),tZ=ci();function BE(e){nD.call(this,e)}tZ.inherits(BE,nD);BE.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};sD.exports=BE});var OE=_e((rle,lD)=>{"use strict";var Qm=ci(),oD=ma(),iZ=LE(),rZ=tD(),nZ=aD(),sZ=DE();lD.exports=function(e){var t=Qm.getTypeOf(e);return Qm.checkSupport(t),t==="string"&&!oD.uint8array?new rZ(e):t==="nodebuffer"?new nZ(e):oD.uint8array?new sZ(Qm.transformTo("uint8array",e)):new iZ(Qm.transformTo("array",e))}});var hD=_e((nle,dD)=>{"use strict";var ME=OE(),lo=ci(),aZ=Lm(),uD=Rm(),eg=wu(),tg=xE(),oZ=ma(),lZ=0,uZ=3,cZ=function(e){for(var t in tg)if(Object.prototype.hasOwnProperty.call(tg,t)&&tg[t].magic===e)return tg[t];return null};function cD(e,t){this.options=e,this.loadOptions=t}cD.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(e){var t,i;if(e.skip(22),this.fileNameLength=e.readInt(2),i=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(i),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(t=cZ(this.compressionMethod),t===null)throw new Error("Corrupted zip : compression "+lo.pretty(this.compressionMethod)+" unknown (inner file : "+lo.transformTo("string",this.fileName)+")");this.decompressed=new aZ(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),e===lZ&&(this.dosPermissions=this.externalFileAttributes&63),e===uZ&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=ME(this.extraFields[1].value);this.uncompressedSize===lo.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===lo.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===lo.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===lo.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t=e.index+this.extraFieldsLength,i,r,n;for(this.extraFields||(this.extraFields={});e.index+4<t;)i=e.readInt(2),r=e.readInt(2),n=e.readData(r),this.extraFields[i]={id:i,length:r,value:n};e.setIndex(t)},handleUTF8:function(){var e=oZ.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=eg.utf8decode(this.fileName),this.fileCommentStr=eg.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(t!==null)this.fileNameStr=t;else{var i=lo.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var r=this.findExtraFieldUnicodeComment();if(r!==null)this.fileCommentStr=r;else{var n=lo.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(n)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=ME(e.value);return t.readInt(1)!==1||uD(this.fileName)!==t.readInt(4)?null:eg.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=ME(e.value);return t.readInt(1)!==1||uD(this.fileComment)!==t.readInt(4)?null:eg.utf8decode(t.readData(e.length-5))}return null}};dD.exports=cD});var mD=_e((sle,fD)=>{"use strict";var dZ=OE(),Ea=ci(),Qn=TE(),hZ=hD(),pZ=ma();function pD(e){this.files=[],this.loadOptions=e}pD.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+Ea.pretty(t)+", expected "+Ea.pretty(e)+")")}},isSignature:function(e,t){var i=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4),n=r===t;return this.reader.setIndex(i),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=pZ.uint8array?"uint8array":"array",i=Ea.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e=this.zip64EndOfCentralSize-44,t=0,i,r,n;t<e;)i=this.reader.readInt(2),r=this.reader.readInt(4),n=this.reader.readData(r),this.zip64ExtensibleData[i]={id:i,length:r,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(Qn.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(Qn.CENTRAL_FILE_HEADER);)e=new hZ({zip64:this.zip64},this.loadOptions),e.readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(Qn.CENTRAL_DIRECTORY_END);if(e<0){var t=!this.isSignature(0,Qn.LOCAL_FILE_HEADER);throw t?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(e);var i=e;if(this.checkSignature(Qn.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===Ea.MAX_VALUE_16BITS||this.diskWithCentralDirStart===Ea.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===Ea.MAX_VALUE_16BITS||this.centralDirRecords===Ea.MAX_VALUE_16BITS||this.centralDirSize===Ea.MAX_VALUE_32BITS||this.centralDirOffset===Ea.MAX_VALUE_32BITS){if(this.zip64=!0,e=this.reader.lastIndexOfSignature(Qn.ZIP64_CENTRAL_DIRECTORY_LOCATOR),e<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(Qn.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,Qn.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(Qn.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(Qn.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=i-r;if(n>0)this.isSignature(i,Qn.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(e){this.reader=dZ(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};fD.exports=pD});var _D=_e((ale,yD)=>{"use strict";var kE=ci(),ig=Cu(),fZ=wu(),mZ=mD(),gZ=FP(),gD=Td();function yZ(e){return new ig.Promise(function(t,i){var r=e.decompressed.getContentWorker().pipe(new gZ);r.on("error",function(n){i(n)}).on("end",function(){r.streamInfo.crc32!==e.decompressed.crc32?i(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}yD.exports=function(e,t){var i=this;return t=kE.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:fZ.utf8decode}),gD.isNode&&gD.isStream(e)?ig.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):kE.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(r){var n=new mZ(t);return n.load(r),n}).then(function(n){var s=[ig.Promise.resolve(n)],a=n.files;if(t.checkCRC32)for(var o=0;o<a.length;o++)s.push(yZ(a[o]));return ig.Promise.all(s)}).then(function(n){for(var s=n.shift(),a=s.files,o=0;o<a.length;o++){var l=a[o],u=l.fileNameStr,c=kE.resolve(l.fileNameStr);i.file(c,l.decompressed,{binary:!0,optimizedBinaryString:!0,date:l.date,dir:l.dir,comment:l.fileCommentStr.length?l.fileCommentStr:null,unixPermissions:l.unixPermissions,dosPermissions:l.dosPermissions,createFolders:t.createFolders}),l.dir||(i.file(c).unsafeOriginalName=u)}return s.zipComment.length&&(i.comment=s.zipComment),i})}});var FE=_e((ole,bD)=>{"use strict";function Rn(){if(!(this instanceof Rn))return new Rn;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new Rn;for(var t in this)typeof this[t]!="function"&&(e[t]=this[t]);return e}}Rn.prototype=XN();Rn.prototype.loadAsync=_D();Rn.support=ma();Rn.defaults=OP();Rn.version="3.10.1";Rn.loadAsync=function(e,t){return new Rn().loadAsync(e,t)};Rn.external=Cu();bD.exports=Rn});var yg=_e((aue,LD)=>{"use strict";var KE=Object.defineProperty,SZ=Object.getOwnPropertyDescriptor,vZ=Object.getOwnPropertyNames,IZ=Object.prototype.hasOwnProperty,AZ=(e,t)=>{for(var i in t)KE(e,i,{get:t[i],enumerable:!0})},CZ=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of vZ(t))!IZ.call(e,n)&&n!==i&&KE(e,n,{get:()=>t[n],enumerable:!(r=SZ(t,n))||r.enumerable});return e},xZ=e=>CZ(KE({},"__esModule",{value:!0}),e),vD={};AZ(vD,{BroadcastChannelMessageBus:()=>WZ,MessageBus:()=>UZ,MessageBus2:()=>YZ,MessageBusTask:()=>JE,MessageBusTask2:()=>eh,WindowMessageBridge:()=>FZ,WorkerMessageBridge:()=>kZ,createBroadcastP2PStream:()=>wD,createBufferedByteBufferStream:()=>TD,createBufferedStream:()=>eS,createBufferedStringStream:()=>xD,dropP2PStream:()=>zZ,flowRead:()=>qZ,flowWrite:()=>VZ});LD.exports=xZ(vD);var mg=class{constructor(e=1.5){this.growthFactor=e,this.capacity=10,this.buffer=new Array(this.capacity),this.head=0,this.tail=0,this.count=0}enqueue(e){if(this.count===this.capacity){let t=Math.floor(this.capacity*this.growthFactor);console.log("grow",this.capacity,t);let i=new Array(t);for(let r=0;r<this.count;r++)i[r]=this.buffer[(this.head+r)%this.capacity];this.buffer=i,this.head=0,this.tail=this.count,this.capacity=t}this.buffer[this.tail]=e,this.tail=(this.tail+1)%this.capacity,this.count++}dequeue(){if(this.isEmpty())return;let e=this.buffer[this.head];return this.head=(this.head+1)%this.capacity,this.count--,e}peek(){return this.buffer[this.head]}isEmpty(){return this.count===0}clear(){this.buffer.length=0,this.head=0,this.tail=0,this.count=0}},ZE=new ArrayBuffer(8),rue=new Float64Array(ZE),nue=new Uint32Array(ZE),sue=new Uint16Array(ZE),XE=ArrayBuffer;try{XE=self.HTMLImageElement||XE}catch{}var TZ=typeof SharedArrayBuffer<"u";function gg(e){if(typeof e!="object"||e===null||e instanceof Date||e instanceof ArrayBuffer||TZ&&e instanceof SharedArrayBuffer||e instanceof Blob||e instanceof FormData||e instanceof Function||e instanceof Uint8ClampedArray||e instanceof XE)return e;if(Array.isArray(e))return e.map(gg);{let t={};for(let i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=gg(e[i]));return t}}function qE(e,t){return wZ(e,t,()=>[])}function wZ(e,t,i){let r=e[t];return r!==void 0||(r=i(t),e[t]=r),r}var RZ=class{constructor(e){this.maxResources=e,this.idle=new mg,this.isClosed=!1,this.resources=e}acquire(e){this.isClosed?Promise.resolve(!1).then(e):this.resources>0?(this.resources--,Promise.resolve(!0).then(e)):this.idle.enqueue(e)}acquireSync(){return new Promise(e=>{this.acquire(e)})}release(){if(!this.isClosed){let e=this.idle.dequeue();e?Promise.resolve(!0).then(e):this.resources++}}close(){if(!this.isClosed)for(this.isClosed=!0;!this.idle.isEmpty();){let e=this.idle.dequeue();Promise.resolve(!1).then(e)}}};function LZ(){if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global}function NZ(e,t){let i=0,r=e.length;for(let n=0;n<r;n++)e[n]===t&&(e.splice(n,1),n--,r--,i++);return i}var DZ=LZ(),BZ=DZ.WeakRef||(e=>e);function ml(e){if(e!=null){if(typeof e=="object")return new BZ(e);console.error(e,e instanceof Object,typeof e);return}}function ho(e){return e==null?void 0:e.deref()}var OZ="_MSG_BUS_RPC_",QE=300*1e3,MZ=(e=>(e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.PUSH="push",e.PULL="pull",e))(MZ||{}),ID=class{constructor(e){this.bus=e}processRemoteMessage(e,t){let i=ml(t),r=e.topic,n=e.type,s=e.message;switch(n){case"pull":this.bus.pull(r,a=>{this.push(r,a,ho(i))});break;case"subscribe":this.bus.subscribe(r,a=>{this.publish(r,a,ho(i))});break;case"publish":this.bus.publish(r,s,this,ho(i));break;case"push":this.bus.push(r,s,this,ho(i));break;default:console.debug("unknown message type "+n)}}rpcCall(e,t,i,r=QE){let n=ml(i),s=new Promise(a=>{let o=this.bus.uniqueRpcTopic(e);this.publish(e,{message:t,reply:o},ho(n)),this.bus.pull(o,(l,u,c)=>{a({message:l,bridge:u,source:ml(c)})})});return r>0?Promise.race([s,new Promise((a,o)=>{setTimeout(o,r)})]):s}},kZ=class extends ID{constructor(e,t){super(e),this.worker=t,t.onmessage=i=>{this.processRemoteMessage(i.data,void 0)}}publish(e,t){this.postMessage(e,"publish",t)}subscribe(e){this.postMessage(e,"subscribe",null)}push(e,t){this.postMessage(e,"push",t)}pull(e){this.postMessage(e,"pull",null)}rpcCall(e,t,i=QE){return super.rpcCall(e,t,void 0,i)}postMessage(e,t,i){let r={topic:e,type:t,message:i};this.worker.postMessage(r)}discard(){this.worker.terminate()}},FZ=class extends ID{constructor(e){super(e),window.addEventListener("message",t=>{this.processRemoteMessage(t.data,t.source)},!1)}publish(e,t,i){this.postMessage(e,"publish",t,i)}subscribe(e,t){if(t===window)throw new Error("regist remote subscribe from current window is not permitted");this.postMessage(e,"subscribe",null,t)}push(e,t,i){this.postMessage(e,"push",t,i)}pull(e,t){if(t===window)throw new Error("regist remote pull from current window is not permitted");this.postMessage(e,"pull",null,t)}postMessage(e,t,i,r){let n={topic:e,type:t,message:i};r&&r.postMessage(n,"*")}},JE=class{constructor(e){this.isRunning=!0,this.callback=e}cancel(){this.callback=null,this.isRunning=!1}running(){return this.isRunning}execute(e,t,i,r){try{e=r?e:gg(e),this.callback(e,t,i)}catch(n){console.error(n)}}},UZ=class{constructor(e=!1){this.subscribed={},this.pulled={},this.pushed={},this.uuid=crypto.randomUUID().replace(/-/g,""),this.rpcTicket=0,this.unsafe=e}uniqueRpcTopic(e){return`${OZ}-${e}-${this.uuid}-${this.rpcTicket++}`}publish(e,t,i,r){let n=this.subscribed[e];if(n){let s;for(let a of n)a.running()?a.execute(t,i,r,this.unsafe):(s=s||new Array,s.push(a));if(s)for(let a of s)NZ(n,a)}else console.debug("no sub on topic: "+e)}subscribe(e,t){let i=new JE(t);return qE(this.subscribed,e).push(i),i}push(e,t,i,r){let n=!1,s=this.pulled[e];if(s){for(;s.length>0;){let a=s.shift();if(a.running()){a.execute(t,i,r,this.unsafe),n=!0;break}}s.length===0&&delete this.pulled[e]}n||qE(this.pushed,e).push({message:t,bridge:i,source:ml(r)})}pull(e,t){let i=new JE(t),r=this.pushed[e];if(r){let n=r.shift();i.execute(n.message,n.bridge,ho(n.source),this.unsafe),r.length===0&&delete this.pushed[e]}else qE(this.pulled,e).push(i);return i}pullA(e){return new Promise(t=>{this.pull(e,(i,r,n)=>{t({message:i,bridge:r,source:ml(n)})})})}rpcService(e,t){this.subscribe(e,(i,r,n)=>{let{message:s,reply:a}=i;try{let o=t(s);if(o instanceof Promise){let l=ml(n);o.then(u=>{this.rpcReply(u,a,r,ho(l))},u=>{console.error(u),this.rpcReply(void 0,a,r,ho(l))})}else this.rpcReply(o,a,r,n)}catch(o){console.error(o),this.rpcReply(void 0,a,r,n)}})}rpcCall(e,t,i=QE){let r=new Promise(n=>{let s=this.uniqueRpcTopic(e);this.publish(e,{message:t,reply:s}),this.pull(s,(a,o,l)=>{n({message:a,bridge:o,source:ml(l)})})});return i>0?Promise.race([r,new Promise((n,s)=>{setTimeout(s,i)})]):r}rpcReply(e,t,i,r){i?i.push(t,e,r):this.push(t,e)}},HZ="_MSG_BUS_RPC_";function $E(e,t){let i=0,r=e.length;for(let n=0;n<r;n++)e[n]===t&&(e.splice(n,1),n--,r--,i++);return i}function Vu(e,t){return jZ(e,t,()=>[])}function jZ(e,t,i){let r=e[t];return r!==void 0||(r=i(t),e[t]=r),r}var eh=class{constructor(e,t){this.callback=e,this.unsafe=t,this.isRunning=!0}cancel(){this.callback=null,this.isRunning=!1}running(){return this.isRunning}async execute(e){try{e=this.unsafe?e:gg(e),this.callback(e)}catch(t){console.error(t)}}},AD=class{constructor(e=crypto.randomUUID()){this.uuid=e,this.rpcTicket=0}subscribeOnce(e,t){let i=this.subscribe(e,r=>{i.cancel(),t(r)});return i}pullA(e){return new Promise(t=>{this.pull(e,t)})}rpcService(e,t){let i=r=>{try{let{message:n,replyTopic:s}=r;try{let a=t(n);a instanceof Promise?a.then(o=>{this.publish(s,{success:!0,result:o})}).catch(o=>{console.error(o),this.publish(s,{success:!1,err:String(o)})}):this.publish(s,{success:!0,result:a})}catch(a){this.publish(s,{success:!1,err:String(a)})}}finally{this.pull(e,i)}};this.pull(e,i)}rpcCall(e,t,i=0){let r=new Promise((n,s)=>{let a=`${HZ}-${e}-${this.uuid}-${this.rpcTicket++}`;this.subscribeOnce(a,o=>{o.success?n(o.result):s(new Error(o.err))}),this.push(e,{message:t,replyTopic:a})});return i>0?Promise.race([r,new Promise((n,s)=>{setTimeout(s,i)})]):r}},YZ=class extends AD{constructor(e=!1){super(),this.unsafe=e,this.subscribed={},this.pulled={},this.pushed={}}publish(e,t){let i=this.subscribed[e];if(i){let r;for(let n of i)n.running()?n.execute(t):(r=r||new Array,r.push(n));if(r)for(let n of r)$E(i,n)}}subscribe(e,t){let i=new eh(t,this.unsafe);return Vu(this.subscribed,e).push(i),i}push(e,t){let i=!1,r=this.pulled[e];if(r){for(;r.length>0;){let n=r.shift();if(n&&n.running()){n.execute(t),i=!0;break}}r.length===0&&delete this.pulled[e]}i||Vu(this.pushed,e).push(t)}pull(e,t){let i=new eh(t,this.unsafe);return this.repull(e,i),i}repull(e,t){let i=this.pushed[e];if(i){let r=i.shift();r&&(t.execute(r),i.length===0&&delete this.pushed[e])}else Vu(this.pulled,e).push(t)}},GZ=class extends AD{constructor(e=crypto.randomUUID()){super(e),this.subscribed={},this.pushed={},this.pulled={},this.pushCnt=0}publish(e,t){console.debug("BC",this.uuid,"PUBLISH",e,t),this.broadcastPublish(e,t)}subscribe(e,t){console.debug("BC",this.uuid,"SUBSCRIBE",e);let i=new eh(t,!0);return Vu(this.subscribed,e).push(i),i}push(e,t){let i=this.pushCnt++;console.debug("BC",this.uuid,"PUSH",e,`(${i})`,t),Vu(this.pushed,e).push({id:i,message:t}),this.broadcastPushedHeadMessage(e)}pull(e,t){console.debug("BC",this.uuid,"PULL",e);let i=new eh(t,!0);return Vu(this.pulled,e).push(i),this.broadcastWhoHas(e),i}broadcastPushedHeadMessage(e){let t=this.pushed[e];t&&t[0]&&this.broadcastIHave(e,t[0].id)}onReceivedPublish(e,t,i){console.debug("BCMSG(",this.uuid,")","from",e,"PUBLISH",t,"message",i);let r=this.subscribed[t];if(r){let n;for(let s of r)s.running()?s.execute(i):(n=n||new Array,n.push(s));if(n)for(let s of n)$E(r,s);r.length===0&&delete this.subscribed[t]}}onReceivedWhoHas(e,t){console.debug("BCMSG(",this.uuid,")","from",e,"WHOHAS",t),this.broadcastPushedHeadMessage(t)}onReceivedIHave(e,t,i){console.debug("BCMSG(",this.uuid,")","from",e,"IHAVE",t,"id",i);let r=this.pulled[t];if(r){let n;for(let s of r)if(s.running()){this.broadcastINeed(t,e,i);break}else n=n||new Array,n.push(s);if(n)for(let s of n)$E(r,s);r.length===0&&delete this.pulled[t]}}onReceivedINeed(e,t,i,r){if(console.debug("BCMSG(",this.uuid,")","from",e,"INEED",t,"source",i,"id",r),this.uuid===i){let n=this.pushed[t];if(n&&n[0]&&n[0].id===r){let{message:s}=n.shift();this.broadcastIGive(t,r,e,s),this.broadcastPushedHeadMessage(t),n.length===0&&delete this.pushed[t]}}}onReceivedIGive(e,t,i,r,n){console.debug("BCMSG(",this.uuid,")","from",e,"IGIVE",t,"id",i,"target",r,"message",n);let s=this.pulled[t];if(s&&this.uuid===r){let a=!1;for(;s.length>0;){let o=s.shift();if(o.running()){o.execute(n),a=!0;break}}a||this.push(t,n),s.length===0&&delete this.pulled[t]}}},WZ=class extends GZ{constructor(e,t=crypto.randomUUID()){super(t),this.bc=new BroadcastChannel(e),this.bc.onmessage=i=>{this.onMessage(i.data)}}onMessage(e){let{type:t,uuid:i,topic:r}=e;switch(t){case"PUBLISH":{let{message:n}=e;this.onReceivedPublish(i,r,n);break}case"WHOHAS":{this.onReceivedWhoHas(i,r);break}case"IHAVE":{let{id:n}=e;this.onReceivedIHave(i,r,n);break}case"INEED":{let{source:n,id:s}=e;this.onReceivedINeed(i,r,n,s);break}case"IGIVE":{let{target:n,id:s,message:a}=e;this.onReceivedIGive(i,r,s,n,a);break}default:console.warn("unsupported",e)}}broadcastPublish(e,t){this.post({type:"PUBLISH",uuid:this.uuid,topic:e,message:t})}broadcastWhoHas(e){this.post({type:"WHOHAS",uuid:this.uuid,topic:e})}broadcastIHave(e,t){this.post({type:"IHAVE",uuid:this.uuid,topic:e,id:t})}broadcastINeed(e,t,i){this.post({type:"INEED",uuid:this.uuid,topic:e,source:t,id:i})}broadcastIGive(e,t,i,r){this.post({type:"IGIVE",uuid:this.uuid,topic:e,id:t,target:i,message:r})}post(e){this.bc.postMessage(e),Promise.resolve().then(()=>{this.onMessage(e)})}},qu=Symbol("BLOCKING_QUEUE_RESET"),CD=class{constructor(e,t=()=>1){if(this.maxSize=e,this.itemSizeOf=t,this.queue=new mg,this.waitingConsumers=new mg,this.waitingProducers=new mg,this.queueSize=0,this.closePromise=null,this.closeResolve=null,e<=0)throw new Error("Max size must be greater than 0")}enqueue(e){return this.closePromise?!1:this.isFull()?(async()=>{console.debug("queue is full",this.queueSize,this.maxSize);let t=await new Promise(i=>{this.waitingProducers.enqueue(i)});return console.debug("queue is not full",this.size(),t),t?(this.innerEnqueue(e),!0):!1})():(this.innerEnqueue(e),!0)}innerEnqueue(e){if(this.waitingConsumers.isEmpty())this.queue.enqueue(e),this.queueSize+=this.itemSizeOf(e),console.debug("queue pushed",e,"size",this.queueSize);else{let t=this.waitingConsumers.dequeue();Promise.resolve(e).then(t),console.debug("queue direct",e,"size",this.queueSize)}}dequeue(){if(this.queue.isEmpty())if(this.closePromise){for(;!this.waitingConsumers.isEmpty();){let e=this.waitingConsumers.dequeue();Promise.resolve(qu).then(e)}return setTimeout(()=>this.closeResolve(),0),qu}else return new Promise(e=>{this.waitingConsumers.enqueue(e)});else{let e=this.queue.dequeue();if(this.queueSize-=this.itemSizeOf(e),!this.waitingProducers.isEmpty()){let t=this.waitingProducers.dequeue();Promise.resolve(!0).then(t)}return e}}size(){return this.queueSize}isEmpty(){return this.queueSize===0}isFull(){return this.queueSize>=this.maxSize}close(){return this.closePromise||(this.closePromise=new Promise(e=>{for(this.closeResolve=e;!this.waitingProducers.isEmpty();){let t=this.waitingProducers.dequeue();Promise.resolve(!1).then(t)}if(this.queueSize===0){for(;!this.waitingConsumers.isEmpty();){let t=this.waitingConsumers.dequeue();Promise.resolve(qu).then(t)}e()}})),this.closePromise}};function eS(e,t,i=Number.MAX_SAFE_INTEGER){let r=new CD(i,t),n=new ReadableStream({pull(a){let o=!0,l=(async()=>{let u=new Array;do{let c=r.dequeue();if(c instanceof Promise){o=!1;let h=await c;h===qu?a.close():u.push(h)}else{let h=c;h===qu?a.close():u.push(h)}}while(r.size()>0);if(u.length>0){let c=e(u);a.enqueue(c)}})();if(!o)return console.debug("read stream stucked --------------------------------------"),l},async cancel(){console.debug("buffered readable cancel"),await r.close()}}),s=new WritableStream({write(a,o){let l=!0,u=(async()=>{let c=r.enqueue(a);typeof c=="boolean"?c||o.error(new Error("Write stream closed")):(l=!1,await c||o.error(new Error("Write stream closed")))})();if(!l)return console.debug("read stream stucked >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"),u},async close(){console.debug("buffered writable closing",r.size()),await r.close(),console.debug("buffered writable closed",r.size())},async abort(){console.debug("buffered writable aborting",r.size()),await r.close(),console.debug("buffered writable aborted",r.size())}});return{readable:n,writable:s}}function xD(e=Number.MAX_SAFE_INTEGER){return eS(t=>t.join(""),t=>t.length,e)}function TD(e=Number.MAX_SAFE_INTEGER){return eS(t=>{let i=new Uint8Array(t.reduce((n,s)=>n+s.byteLength,0)),r=0;return t.forEach(n=>{i.set(n,r),r+=n.byteLength}),i},t=>t.byteLength,e)}function wD(e){return new Promise((t,i)=>{let r=new BroadcastChannel(e),n=new CD(1),s=new RZ(1),a=null,o=!1,l=!1,u=!1;r.onmessage=c=>{let h=c.data,{type:m}=h;if(console.debug("p2p",e,"type",m,"data",m==="DATA"&&h.data),m==="DATA")n.enqueue(h.data);else if(m==="HI"){if(!a){r.postMessage({type:"HI"});let b=0;a={rs:new ReadableStream({async pull(E){let S=await n.dequeue();S===qu?(await g(),E.close()):(E.enqueue(S),r.postMessage({type:"ACK"}))},cancel(){return g()}}),ws:new WritableStream({async write(E,S){await s.acquireSync()?r.postMessage({type:"DATA",id:b++,data:E}):(f(),S.error(new Error("Write stream closed")))},close(){f()},abort(){f()}})},t(a)}}else m==="REND"?a?s.close():y("REND1"):m==="WEND"?a?n.close():y("WEND1"):m==="ACK"&&s.release();function f(){o||(o=!0,console.debug(e,"p2p write stream closed"),s.close(),r.postMessage({type:"WEND"}),l&&(console.debug(e,"p2p channel closed on ws"),r.close()))}async function g(){l||(l=!0,console.debug(e,"p2p read stream closed"),r.postMessage({type:"REND"}),await n.close(),o&&(console.debug(e,"p2p channel closed on rs"),r.close()))}async function y(b){u||(u=!0,console.debug(e,"p2p channel connection released on",b),s.close(),n.close(),a?(a.rs.locked||(console.debug(e,"p2p unlocked read stream direct cancel"),a.rs.cancel()),a.ws.locked||(console.debug(e,"p2p unlocked write stream direct close"),a.ws.close())):(r.postMessage({type:"HI"}),r.close()),i(new Error("p2p channel connection released")))}},r.postMessage({type:"HI"})})}function zZ(e){return new Promise(t=>{let i=new BroadcastChannel(e);i.onmessage=r=>{let n=r.data,{type:s}=n;s==="HI"&&(i.postMessage({type:"REND"}),i.close(),t())},i.postMessage({type:"REND"})})}async function RD(e){try{return await wD(e)}catch(t){t.message!=="p2p channel connection released"&&console.error(t)}}async function VZ(e,t,i=10*1024*1024,r=!0){let n=await RD(e);if(!n)return!1;let s=!1;try{let a,o=l=>{if(!a)if(!r)a=n.ws.getWriter();else if(typeof l=="string"){let u=xD(i);u.readable.pipeTo(n.ws),a=u.writable.getWriter()}else{let u=TD(i);u.readable.pipeTo(n.ws),a=u.writable.getWriter()}return a.write(l)};if(Array.isArray(t))for(let l of t)await o(l);else await t({write:o,get desiredSize(){return((a==null?void 0:a.desiredSize)||0)+10}});a&&await a.close(),s=!0}catch(a){console.error(a)}finally{return n.rs.cancel(),s}}async function qZ(e,t){var r,n;let i=await RD(e);if(i)try{let s=i.rs.getReader();for((r=t.start)==null?void 0:r.call(t);;){let{value:a,done:o}=await s.read();if(a!==void 0){let l;if(t.update instanceof Promise?l=await t.update(a):l=t.update(a),l){await s.cancel();break}}if(o){(n=t.end)==null||n.call(t);break}}}catch(s){console.error(s)}finally{i.ws.close()}}});var JD=_e((Ype,sy)=>{function GD(e){return Array.isArray(e)?e:[e]}var $Z=void 0,PS="",jD=" ",bS="\\",KZ=/^\s+$/,ZZ=/(?:[^\\]|^)\\$/,QZ=/^\\!/,eQ=/^\\#/,tQ=/\r?\n/g,iQ=/^\.{0,2}\/|^\.{1,2}$/,rQ=/\/$/,Ku="/",WD="node-ignore";typeof Symbol<"u"&&(WD=Symbol.for("node-ignore"));var zD=WD,Zu=(e,t,i)=>(Object.defineProperty(e,t,{value:i}),i),nQ=/([0-z])-([0-z])/g,VD=()=>!1,sQ=e=>e.replace(nQ,(t,i,r)=>i.charCodeAt(0)<=r.charCodeAt(0)?t:PS),aQ=e=>{let{length:t}=e;return e.slice(0,t-t%2)},oQ=[[/^\uFEFF/,()=>PS],[/((?:\\\\)*?)(\\?\s+)$/,(e,t,i)=>t+(i.indexOf("\\")===0?jD:PS)],[/(\\+?)\s/g,(e,t)=>{let{length:i}=t;return t.slice(0,i-i%2)+jD}],[/[\\$.|*+(){^]/g,e=>`\\${e}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(e,t,i)=>t+6<i.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(e,t,i)=>{let r=i.replace(/\\\*/g,"[^\\/]*");return t+r}],[/\\\\\\(?=[$.|*+(){^])/g,()=>bS],[/\\\\/g,()=>bS],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(e,t,i,r,n)=>t===bS?`\\[${i}${aQ(r)}${n}`:n==="]"&&r.length%2===0?`[${sQ(i)}${r}]`:"[]"],[/(?:[^*])$/,e=>/\/$/.test(e)?`${e}$`:`${e}(?=$|\\/$)`]],lQ=/(^|\\\/)?\\\*$/,ah="regex",ry="checkRegex",YD="_",uQ={[ah](e,t){return`${t?`${t}[^/]+`:"[^/]*"}(?=$|\\/$)`},[ry](e,t){return`${t?`${t}[^/]*`:"[^/]*"}(?=$|\\/$)`}},cQ=e=>oQ.reduce((t,[i,r])=>t.replace(i,r.bind(e)),e),ny=e=>typeof e=="string",dQ=e=>e&&ny(e)&&!KZ.test(e)&&!ZZ.test(e)&&e.indexOf("#")!==0,hQ=e=>e.split(tQ).filter(Boolean),ES=class{constructor(t,i,r,n,s,a){this.pattern=t,this.mark=i,this.negative=s,Zu(this,"body",r),Zu(this,"ignoreCase",n),Zu(this,"regexPrefix",a)}get regex(){let t=YD+ah;return this[t]?this[t]:this._make(ah,t)}get checkRegex(){let t=YD+ry;return this[t]?this[t]:this._make(ry,t)}_make(t,i){let r=this.regexPrefix.replace(lQ,uQ[t]),n=this.ignoreCase?new RegExp(r,"i"):new RegExp(r);return Zu(this,i,n)}},pQ=({pattern:e,mark:t},i)=>{let r=!1,n=e;n.indexOf("!")===0&&(r=!0,n=n.substr(1)),n=n.replace(QZ,"!").replace(eQ,"#");let s=cQ(n);return new ES(e,t,n,i,r,s)},SS=class{constructor(t){this._ignoreCase=t,this._rules=[]}_add(t){if(t&&t[zD]){this._rules=this._rules.concat(t._rules._rules),this._added=!0;return}if(ny(t)&&(t={pattern:t}),dQ(t.pattern)){let i=pQ(t,this._ignoreCase);this._added=!0,this._rules.push(i)}}add(t){return this._added=!1,GD(ny(t)?hQ(t):t).forEach(this._add,this),this._added}test(t,i,r){let n=!1,s=!1,a;this._rules.forEach(l=>{let{negative:u}=l;s===u&&n!==s||u&&!n&&!s&&!i||!l[r].test(t)||(n=!u,s=u,a=u?$Z:l)});let o={ignored:n,unignored:s};return a&&(o.rule=a),o}},fQ=(e,t)=>{throw new t(e)},va=(e,t,i)=>ny(e)?e?va.isNotRelative(e)?i(`path should be a \`path.relative()\`d string, but got "${t}"`,RangeError):!0:i("path must not be empty",TypeError):i(`path must be a string, but got \`${t}\``,TypeError),qD=e=>iQ.test(e);va.isNotRelative=qD;va.convert=e=>e;var vS=class{constructor({ignorecase:t=!0,ignoreCase:i=t,allowRelativePaths:r=!1}={}){Zu(this,zD,!0),this._rules=new SS(i),this._strictPathCheck=!r,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}add(t){return this._rules.add(t)&&this._initCache(),this}addPattern(t){return this.add(t)}_test(t,i,r,n){let s=t&&va.convert(t);return va(s,t,this._strictPathCheck?fQ:VD),this._t(s,i,r,n)}checkIgnore(t){if(!rQ.test(t))return this.test(t);let i=t.split(Ku).filter(Boolean);if(i.pop(),i.length){let r=this._t(i.join(Ku)+Ku,this._testCache,!0,i);if(r.ignored)return r}return this._rules.test(t,!1,ry)}_t(t,i,r,n){if(t in i)return i[t];if(n||(n=t.split(Ku).filter(Boolean)),n.pop(),!n.length)return i[t]=this._rules.test(t,r,ah);let s=this._t(n.join(Ku)+Ku,i,r,n);return i[t]=s.ignored?s:this._rules.test(t,r,ah)}ignores(t){return this._test(t,this._ignoreCache,!1).ignored}createFilter(){return t=>!this.ignores(t)}filter(t){return GD(t).filter(this.createFilter())}test(t){return this._test(t,this._testCache,!0)}},IS=e=>new vS(e),mQ=e=>va(e&&va.convert(e),e,VD),XD=()=>{let e=i=>/^\\\\\?\\/.test(i)||/["<>|\u0000-\u001F]+/u.test(i)?i:i.replace(/\\/g,"/");va.convert=e;let t=/^[a-z]:\//i;va.isNotRelative=i=>t.test(i)||qD(i)};typeof process<"u"&&process.platform==="win32"&&XD();sy.exports=IS;IS.default=IS;sy.exports.isPathValid=mQ;Zu(sy.exports,Symbol.for("setupWindows"),XD)});var tB=_e((ec,lh)=>{(function(){var e,t="4.17.21",i=200,r="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",n="Expected a function",s="Invalid `variable` option passed into `_.template`",a="__lodash_hash_undefined__",o=500,l="__lodash_placeholder__",u=1,c=2,h=4,m=1,f=2,g=1,y=2,b=4,E=8,S=16,v=32,A=64,x=128,T=256,R=512,L=30,O="...",H=800,k=16,ee=1,q=2,Q=3,ne=1/0,G=9007199254740991,X=17976931348623157e292,D=NaN,F=4294967295,W=F-1,z=F>>>1,$=[["ary",x],["bind",g],["bindKey",y],["curry",E],["curryRight",S],["flip",R],["partial",v],["partialRight",A],["rearg",T]],te="[object Arguments]",Z="[object Array]",pe="[object AsyncFunction]",Se="[object Boolean]",Ce="[object Date]",we="[object DOMException]",Fe="[object Error]",Ue="[object Function]",je="[object GeneratorFunction]",me="[object Map]",Ae="[object Number]",We="[object Null]",tt="[object Object]",Ct="[object Promise]",it="[object Proxy]",Ze="[object RegExp]",Ri="[object Set]",Jt="[object String]",di="[object Symbol]",hi="[object Undefined]",Ei="[object WeakMap]",ln="[object WeakSet]",xr="[object ArrayBuffer]",Xi="[object DataView]",pr="[object Float32Array]",ks="[object Float64Array]",ss="[object Int8Array]",I="[object Int16Array]",w="[object Int32Array]",B="[object Uint8Array]",M="[object Uint8ClampedArray]",V="[object Uint16Array]",oe="[object Uint32Array]",ce=/\b__p \+= '';/g,Ie=/\b(__p \+=) '' \+/g,ze=/(__e\(.*?\)|\b__t\)) \+\n'';/g,$e=/&(?:amp|lt|gt|quot|#39);/g,xt=/[&<>"']/g,si=RegExp($e.source),Si=RegExp(xt.source),On=/<%-([\s\S]+?)%>/g,Fs=/<%([\s\S]+?)%>/g,as=/<%=([\s\S]+?)%>/g,un=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,jr=/^\w*$/,Yr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,_l=/[\\^$.*+?()[\]{}|]/g,dy=RegExp(_l.source),bl=/^\s+/,fr=/\s/,os=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,se=/\{\n\/\* \[wrapped with (.+)\] \*/,hy=/,? & /,pB=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,fB=/[()=,{}\[\]\/\s]/,mB=/\\(\\)?/g,gB=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,DS=/\w*$/,yB=/^[-+]0x[0-9a-f]+$/i,_B=/^0b[01]+$/i,bB=/^\[object .+?Constructor\]$/,PB=/^0o[0-7]+$/i,EB=/^(?:0|[1-9]\d*)$/,SB=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,dh=/($^)/,vB=/['\n\r\u2028\u2029\\]/g,hh="\\ud800-\\udfff",IB="\\u0300-\\u036f",AB="\\ufe20-\\ufe2f",CB="\\u20d0-\\u20ff",BS=IB+AB+CB,OS="\\u2700-\\u27bf",MS="a-z\\xdf-\\xf6\\xf8-\\xff",xB="\\xac\\xb1\\xd7\\xf7",TB="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",wB="\\u2000-\\u206f",RB=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",kS="A-Z\\xc0-\\xd6\\xd8-\\xde",FS="\\ufe0e\\ufe0f",US=xB+TB+wB+RB,py="['\u2019]",LB="["+hh+"]",HS="["+US+"]",ph="["+BS+"]",jS="\\d+",NB="["+OS+"]",YS="["+MS+"]",GS="[^"+hh+US+jS+OS+MS+kS+"]",fy="\\ud83c[\\udffb-\\udfff]",DB="(?:"+ph+"|"+fy+")",WS="[^"+hh+"]",my="(?:\\ud83c[\\udde6-\\uddff]){2}",gy="[\\ud800-\\udbff][\\udc00-\\udfff]",Pl="["+kS+"]",zS="\\u200d",VS="(?:"+YS+"|"+GS+")",BB="(?:"+Pl+"|"+GS+")",qS="(?:"+py+"(?:d|ll|m|re|s|t|ve))?",XS="(?:"+py+"(?:D|LL|M|RE|S|T|VE))?",JS=DB+"?",$S="["+FS+"]?",OB="(?:"+zS+"(?:"+[WS,my,gy].join("|")+")"+$S+JS+")*",MB="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",kB="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",KS=$S+JS+OB,FB="(?:"+[NB,my,gy].join("|")+")"+KS,UB="(?:"+[WS+ph+"?",ph,my,gy,LB].join("|")+")",HB=RegExp(py,"g"),jB=RegExp(ph,"g"),yy=RegExp(fy+"(?="+fy+")|"+UB+KS,"g"),YB=RegExp([Pl+"?"+YS+"+"+qS+"(?="+[HS,Pl,"$"].join("|")+")",BB+"+"+XS+"(?="+[HS,Pl+VS,"$"].join("|")+")",Pl+"?"+VS+"+"+qS,Pl+"+"+XS,kB,MB,jS,FB].join("|"),"g"),GB=RegExp("["+zS+hh+BS+FS+"]"),WB=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,zB=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],VB=-1,$t={};$t[pr]=$t[ks]=$t[ss]=$t[I]=$t[w]=$t[B]=$t[M]=$t[V]=$t[oe]=!0,$t[te]=$t[Z]=$t[xr]=$t[Se]=$t[Xi]=$t[Ce]=$t[Fe]=$t[Ue]=$t[me]=$t[Ae]=$t[tt]=$t[Ze]=$t[Ri]=$t[Jt]=$t[Ei]=!1;var Vt={};Vt[te]=Vt[Z]=Vt[xr]=Vt[Xi]=Vt[Se]=Vt[Ce]=Vt[pr]=Vt[ks]=Vt[ss]=Vt[I]=Vt[w]=Vt[me]=Vt[Ae]=Vt[tt]=Vt[Ze]=Vt[Ri]=Vt[Jt]=Vt[di]=Vt[B]=Vt[M]=Vt[V]=Vt[oe]=!0,Vt[Fe]=Vt[Ue]=Vt[Ei]=!1;var qB={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},XB={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},JB={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},$B={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},KB=parseFloat,ZB=parseInt,ZS=typeof global=="object"&&global&&global.Object===Object&&global,QB=typeof self=="object"&&self&&self.Object===Object&&self,Ui=ZS||QB||Function("return this")(),_y=typeof ec=="object"&&ec&&!ec.nodeType&&ec,_o=_y&&typeof lh=="object"&&lh&&!lh.nodeType&&lh,QS=_o&&_o.exports===_y,by=QS&&ZS.process,cn=(function(){try{var ae=_o&&_o.require&&_o.require("util").types;return ae||by&&by.binding&&by.binding("util")}catch{}})(),e1=cn&&cn.isArrayBuffer,t1=cn&&cn.isDate,i1=cn&&cn.isMap,r1=cn&&cn.isRegExp,n1=cn&&cn.isSet,s1=cn&&cn.isTypedArray;function Gr(ae,ye,fe){switch(fe.length){case 0:return ae.call(ye);case 1:return ae.call(ye,fe[0]);case 2:return ae.call(ye,fe[0],fe[1]);case 3:return ae.call(ye,fe[0],fe[1],fe[2])}return ae.apply(ye,fe)}function eO(ae,ye,fe,Oe){for(var rt=-1,Rt=ae==null?0:ae.length;++rt<Rt;){var Li=ae[rt];ye(Oe,Li,fe(Li),ae)}return Oe}function dn(ae,ye){for(var fe=-1,Oe=ae==null?0:ae.length;++fe<Oe&&ye(ae[fe],fe,ae)!==!1;);return ae}function tO(ae,ye){for(var fe=ae==null?0:ae.length;fe--&&ye(ae[fe],fe,ae)!==!1;);return ae}function a1(ae,ye){for(var fe=-1,Oe=ae==null?0:ae.length;++fe<Oe;)if(!ye(ae[fe],fe,ae))return!1;return!0}function Ia(ae,ye){for(var fe=-1,Oe=ae==null?0:ae.length,rt=0,Rt=[];++fe<Oe;){var Li=ae[fe];ye(Li,fe,ae)&&(Rt[rt++]=Li)}return Rt}function fh(ae,ye){var fe=ae==null?0:ae.length;return!!fe&&El(ae,ye,0)>-1}function Py(ae,ye,fe){for(var Oe=-1,rt=ae==null?0:ae.length;++Oe<rt;)if(fe(ye,ae[Oe]))return!0;return!1}function ti(ae,ye){for(var fe=-1,Oe=ae==null?0:ae.length,rt=Array(Oe);++fe<Oe;)rt[fe]=ye(ae[fe],fe,ae);return rt}function Aa(ae,ye){for(var fe=-1,Oe=ye.length,rt=ae.length;++fe<Oe;)ae[rt+fe]=ye[fe];return ae}function Ey(ae,ye,fe,Oe){var rt=-1,Rt=ae==null?0:ae.length;for(Oe&&Rt&&(fe=ae[++rt]);++rt<Rt;)fe=ye(fe,ae[rt],rt,ae);return fe}function iO(ae,ye,fe,Oe){var rt=ae==null?0:ae.length;for(Oe&&rt&&(fe=ae[--rt]);rt--;)fe=ye(fe,ae[rt],rt,ae);return fe}function Sy(ae,ye){for(var fe=-1,Oe=ae==null?0:ae.length;++fe<Oe;)if(ye(ae[fe],fe,ae))return!0;return!1}var rO=vy("length");function nO(ae){return ae.split("")}function sO(ae){return ae.match(pB)||[]}function o1(ae,ye,fe){var Oe;return fe(ae,function(rt,Rt,Li){if(ye(rt,Rt,Li))return Oe=Rt,!1}),Oe}function mh(ae,ye,fe,Oe){for(var rt=ae.length,Rt=fe+(Oe?1:-1);Oe?Rt--:++Rt<rt;)if(ye(ae[Rt],Rt,ae))return Rt;return-1}function El(ae,ye,fe){return ye===ye?yO(ae,ye,fe):mh(ae,l1,fe)}function aO(ae,ye,fe,Oe){for(var rt=fe-1,Rt=ae.length;++rt<Rt;)if(Oe(ae[rt],ye))return rt;return-1}function l1(ae){return ae!==ae}function u1(ae,ye){var fe=ae==null?0:ae.length;return fe?Ay(ae,ye)/fe:D}function vy(ae){return function(ye){return ye==null?e:ye[ae]}}function Iy(ae){return function(ye){return ae==null?e:ae[ye]}}function c1(ae,ye,fe,Oe,rt){return rt(ae,function(Rt,Li,Yt){fe=Oe?(Oe=!1,Rt):ye(fe,Rt,Li,Yt)}),fe}function oO(ae,ye){var fe=ae.length;for(ae.sort(ye);fe--;)ae[fe]=ae[fe].value;return ae}function Ay(ae,ye){for(var fe,Oe=-1,rt=ae.length;++Oe<rt;){var Rt=ye(ae[Oe]);Rt!==e&&(fe=fe===e?Rt:fe+Rt)}return fe}function Cy(ae,ye){for(var fe=-1,Oe=Array(ae);++fe<ae;)Oe[fe]=ye(fe);return Oe}function lO(ae,ye){return ti(ye,function(fe){return[fe,ae[fe]]})}function d1(ae){return ae&&ae.slice(0,m1(ae)+1).replace(bl,"")}function Wr(ae){return function(ye){return ae(ye)}}function xy(ae,ye){return ti(ye,function(fe){return ae[fe]})}function ic(ae,ye){return ae.has(ye)}function h1(ae,ye){for(var fe=-1,Oe=ae.length;++fe<Oe&&El(ye,ae[fe],0)>-1;);return fe}function p1(ae,ye){for(var fe=ae.length;fe--&&El(ye,ae[fe],0)>-1;);return fe}function uO(ae,ye){for(var fe=ae.length,Oe=0;fe--;)ae[fe]===ye&&++Oe;return Oe}var cO=Iy(qB),dO=Iy(XB);function hO(ae){return"\\"+$B[ae]}function pO(ae,ye){return ae==null?e:ae[ye]}function Sl(ae){return GB.test(ae)}function fO(ae){return WB.test(ae)}function mO(ae){for(var ye,fe=[];!(ye=ae.next()).done;)fe.push(ye.value);return fe}function Ty(ae){var ye=-1,fe=Array(ae.size);return ae.forEach(function(Oe,rt){fe[++ye]=[rt,Oe]}),fe}function f1(ae,ye){return function(fe){return ae(ye(fe))}}function Ca(ae,ye){for(var fe=-1,Oe=ae.length,rt=0,Rt=[];++fe<Oe;){var Li=ae[fe];(Li===ye||Li===l)&&(ae[fe]=l,Rt[rt++]=fe)}return Rt}function gh(ae){var ye=-1,fe=Array(ae.size);return ae.forEach(function(Oe){fe[++ye]=Oe}),fe}function gO(ae){var ye=-1,fe=Array(ae.size);return ae.forEach(function(Oe){fe[++ye]=[Oe,Oe]}),fe}function yO(ae,ye,fe){for(var Oe=fe-1,rt=ae.length;++Oe<rt;)if(ae[Oe]===ye)return Oe;return-1}function _O(ae,ye,fe){for(var Oe=fe+1;Oe--;)if(ae[Oe]===ye)return Oe;return Oe}function vl(ae){return Sl(ae)?PO(ae):rO(ae)}function Mn(ae){return Sl(ae)?EO(ae):nO(ae)}function m1(ae){for(var ye=ae.length;ye--&&fr.test(ae.charAt(ye)););return ye}var bO=Iy(JB);function PO(ae){for(var ye=yy.lastIndex=0;yy.test(ae);)++ye;return ye}function EO(ae){return ae.match(yy)||[]}function SO(ae){return ae.match(YB)||[]}var vO=(function ae(ye){ye=ye==null?Ui:xa.defaults(Ui.Object(),ye,xa.pick(Ui,zB));var fe=ye.Array,Oe=ye.Date,rt=ye.Error,Rt=ye.Function,Li=ye.Math,Yt=ye.Object,wy=ye.RegExp,IO=ye.String,hn=ye.TypeError,yh=fe.prototype,AO=Rt.prototype,Il=Yt.prototype,_h=ye["__core-js_shared__"],bh=AO.toString,Mt=Il.hasOwnProperty,CO=0,g1=(function(){var d=/[^.]+$/.exec(_h&&_h.keys&&_h.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""})(),Ph=Il.toString,xO=bh.call(Yt),TO=Ui._,wO=wy("^"+bh.call(Mt).replace(_l,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Eh=QS?ye.Buffer:e,Ta=ye.Symbol,Sh=ye.Uint8Array,y1=Eh?Eh.allocUnsafe:e,vh=f1(Yt.getPrototypeOf,Yt),_1=Yt.create,b1=Il.propertyIsEnumerable,Ih=yh.splice,P1=Ta?Ta.isConcatSpreadable:e,rc=Ta?Ta.iterator:e,bo=Ta?Ta.toStringTag:e,Ah=(function(){try{var d=Io(Yt,"defineProperty");return d({},"",{}),d}catch{}})(),RO=ye.clearTimeout!==Ui.clearTimeout&&ye.clearTimeout,LO=Oe&&Oe.now!==Ui.Date.now&&Oe.now,NO=ye.setTimeout!==Ui.setTimeout&&ye.setTimeout,Ch=Li.ceil,xh=Li.floor,Ry=Yt.getOwnPropertySymbols,DO=Eh?Eh.isBuffer:e,E1=ye.isFinite,BO=yh.join,OO=f1(Yt.keys,Yt),Ni=Li.max,nr=Li.min,MO=Oe.now,kO=ye.parseInt,S1=Li.random,FO=yh.reverse,Ly=Io(ye,"DataView"),nc=Io(ye,"Map"),Ny=Io(ye,"Promise"),Al=Io(ye,"Set"),sc=Io(ye,"WeakMap"),ac=Io(Yt,"create"),Th=sc&&new sc,Cl={},UO=Ao(Ly),HO=Ao(nc),jO=Ao(Ny),YO=Ao(Al),GO=Ao(sc),wh=Ta?Ta.prototype:e,oc=wh?wh.valueOf:e,v1=wh?wh.toString:e;function U(d){if(pi(d)&&!nt(d)&&!(d instanceof bt)){if(d instanceof pn)return d;if(Mt.call(d,"__wrapped__"))return Iv(d)}return new pn(d)}var xl=(function(){function d(){}return function(p){if(!ai(p))return{};if(_1)return _1(p);d.prototype=p;var P=new d;return d.prototype=e,P}})();function Rh(){}function pn(d,p){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!p,this.__index__=0,this.__values__=e}U.templateSettings={escape:On,evaluate:Fs,interpolate:as,variable:"",imports:{_:U}},U.prototype=Rh.prototype,U.prototype.constructor=U,pn.prototype=xl(Rh.prototype),pn.prototype.constructor=pn;function bt(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=F,this.__views__=[]}function WO(){var d=new bt(this.__wrapped__);return d.__actions__=Tr(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=Tr(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=Tr(this.__views__),d}function zO(){if(this.__filtered__){var d=new bt(this);d.__dir__=-1,d.__filtered__=!0}else d=this.clone(),d.__dir__*=-1;return d}function VO(){var d=this.__wrapped__.value(),p=this.__dir__,P=nt(d),C=p<0,N=P?d.length:0,j=n3(0,N,this.__views__),K=j.start,re=j.end,le=re-K,Pe=C?re:K-1,Ee=this.__iteratees__,ve=Ee.length,Le=0,He=nr(le,this.__takeCount__);if(!P||!C&&N==le&&He==le)return q1(d,this.__actions__);var qe=[];e:for(;le--&&Le<He;){Pe+=p;for(var ut=-1,Xe=d[Pe];++ut<ve;){var _t=Ee[ut],St=_t.iteratee,qr=_t.type,yr=St(Xe);if(qr==q)Xe=yr;else if(!yr){if(qr==ee)continue e;break e}}qe[Le++]=Xe}return qe}bt.prototype=xl(Rh.prototype),bt.prototype.constructor=bt;function Po(d){var p=-1,P=d==null?0:d.length;for(this.clear();++p<P;){var C=d[p];this.set(C[0],C[1])}}function qO(){this.__data__=ac?ac(null):{},this.size=0}function XO(d){var p=this.has(d)&&delete this.__data__[d];return this.size-=p?1:0,p}function JO(d){var p=this.__data__;if(ac){var P=p[d];return P===a?e:P}return Mt.call(p,d)?p[d]:e}function $O(d){var p=this.__data__;return ac?p[d]!==e:Mt.call(p,d)}function KO(d,p){var P=this.__data__;return this.size+=this.has(d)?0:1,P[d]=ac&&p===e?a:p,this}Po.prototype.clear=qO,Po.prototype.delete=XO,Po.prototype.get=JO,Po.prototype.has=$O,Po.prototype.set=KO;function Us(d){var p=-1,P=d==null?0:d.length;for(this.clear();++p<P;){var C=d[p];this.set(C[0],C[1])}}function ZO(){this.__data__=[],this.size=0}function QO(d){var p=this.__data__,P=Lh(p,d);if(P<0)return!1;var C=p.length-1;return P==C?p.pop():Ih.call(p,P,1),--this.size,!0}function eM(d){var p=this.__data__,P=Lh(p,d);return P<0?e:p[P][1]}function tM(d){return Lh(this.__data__,d)>-1}function iM(d,p){var P=this.__data__,C=Lh(P,d);return C<0?(++this.size,P.push([d,p])):P[C][1]=p,this}Us.prototype.clear=ZO,Us.prototype.delete=QO,Us.prototype.get=eM,Us.prototype.has=tM,Us.prototype.set=iM;function Hs(d){var p=-1,P=d==null?0:d.length;for(this.clear();++p<P;){var C=d[p];this.set(C[0],C[1])}}function rM(){this.size=0,this.__data__={hash:new Po,map:new(nc||Us),string:new Po}}function nM(d){var p=Gh(this,d).delete(d);return this.size-=p?1:0,p}function sM(d){return Gh(this,d).get(d)}function aM(d){return Gh(this,d).has(d)}function oM(d,p){var P=Gh(this,d),C=P.size;return P.set(d,p),this.size+=P.size==C?0:1,this}Hs.prototype.clear=rM,Hs.prototype.delete=nM,Hs.prototype.get=sM,Hs.prototype.has=aM,Hs.prototype.set=oM;function Eo(d){var p=-1,P=d==null?0:d.length;for(this.__data__=new Hs;++p<P;)this.add(d[p])}function lM(d){return this.__data__.set(d,a),this}function uM(d){return this.__data__.has(d)}Eo.prototype.add=Eo.prototype.push=lM,Eo.prototype.has=uM;function kn(d){var p=this.__data__=new Us(d);this.size=p.size}function cM(){this.__data__=new Us,this.size=0}function dM(d){var p=this.__data__,P=p.delete(d);return this.size=p.size,P}function hM(d){return this.__data__.get(d)}function pM(d){return this.__data__.has(d)}function fM(d,p){var P=this.__data__;if(P instanceof Us){var C=P.__data__;if(!nc||C.length<i-1)return C.push([d,p]),this.size=++P.size,this;P=this.__data__=new Hs(C)}return P.set(d,p),this.size=P.size,this}kn.prototype.clear=cM,kn.prototype.delete=dM,kn.prototype.get=hM,kn.prototype.has=pM,kn.prototype.set=fM;function I1(d,p){var P=nt(d),C=!P&&Co(d),N=!P&&!C&&Da(d),j=!P&&!C&&!N&&Ll(d),K=P||C||N||j,re=K?Cy(d.length,IO):[],le=re.length;for(var Pe in d)(p||Mt.call(d,Pe))&&!(K&&(Pe=="length"||N&&(Pe=="offset"||Pe=="parent")||j&&(Pe=="buffer"||Pe=="byteLength"||Pe=="byteOffset")||Ws(Pe,le)))&&re.push(Pe);return re}function A1(d){var p=d.length;return p?d[Gy(0,p-1)]:e}function mM(d,p){return Wh(Tr(d),So(p,0,d.length))}function gM(d){return Wh(Tr(d))}function Dy(d,p,P){(P!==e&&!Fn(d[p],P)||P===e&&!(p in d))&&js(d,p,P)}function lc(d,p,P){var C=d[p];(!(Mt.call(d,p)&&Fn(C,P))||P===e&&!(p in d))&&js(d,p,P)}function Lh(d,p){for(var P=d.length;P--;)if(Fn(d[P][0],p))return P;return-1}function yM(d,p,P,C){return wa(d,function(N,j,K){p(C,N,P(N),K)}),C}function C1(d,p){return d&&us(p,Hi(p),d)}function _M(d,p){return d&&us(p,Rr(p),d)}function js(d,p,P){p=="__proto__"&&Ah?Ah(d,p,{configurable:!0,enumerable:!0,value:P,writable:!0}):d[p]=P}function By(d,p){for(var P=-1,C=p.length,N=fe(C),j=d==null;++P<C;)N[P]=j?e:f_(d,p[P]);return N}function So(d,p,P){return d===d&&(P!==e&&(d=d<=P?d:P),p!==e&&(d=d>=p?d:p)),d}function fn(d,p,P,C,N,j){var K,re=p&u,le=p&c,Pe=p&h;if(P&&(K=N?P(d,C,N,j):P(d)),K!==e)return K;if(!ai(d))return d;var Ee=nt(d);if(Ee){if(K=a3(d),!re)return Tr(d,K)}else{var ve=sr(d),Le=ve==Ue||ve==je;if(Da(d))return $1(d,re);if(ve==tt||ve==te||Le&&!N){if(K=le||Le?{}:mv(d),!re)return le?JM(d,_M(K,d)):XM(d,C1(K,d))}else{if(!Vt[ve])return N?d:{};K=o3(d,ve,re)}}j||(j=new kn);var He=j.get(d);if(He)return He;j.set(d,K),Wv(d)?d.forEach(function(Xe){K.add(fn(Xe,p,P,Xe,d,j))}):Yv(d)&&d.forEach(function(Xe,_t){K.set(_t,fn(Xe,p,P,_t,d,j))});var qe=Pe?le?e_:Qy:le?Rr:Hi,ut=Ee?e:qe(d);return dn(ut||d,function(Xe,_t){ut&&(_t=Xe,Xe=d[_t]),lc(K,_t,fn(Xe,p,P,_t,d,j))}),K}function bM(d){var p=Hi(d);return function(P){return x1(P,d,p)}}function x1(d,p,P){var C=P.length;if(d==null)return!C;for(d=Yt(d);C--;){var N=P[C],j=p[N],K=d[N];if(K===e&&!(N in d)||!j(K))return!1}return!0}function T1(d,p,P){if(typeof d!="function")throw new hn(n);return mc(function(){d.apply(e,P)},p)}function uc(d,p,P,C){var N=-1,j=fh,K=!0,re=d.length,le=[],Pe=p.length;if(!re)return le;P&&(p=ti(p,Wr(P))),C?(j=Py,K=!1):p.length>=i&&(j=ic,K=!1,p=new Eo(p));e:for(;++N<re;){var Ee=d[N],ve=P==null?Ee:P(Ee);if(Ee=C||Ee!==0?Ee:0,K&&ve===ve){for(var Le=Pe;Le--;)if(p[Le]===ve)continue e;le.push(Ee)}else j(p,ve,C)||le.push(Ee)}return le}var wa=tv(ls),w1=tv(My,!0);function PM(d,p){var P=!0;return wa(d,function(C,N,j){return P=!!p(C,N,j),P}),P}function Nh(d,p,P){for(var C=-1,N=d.length;++C<N;){var j=d[C],K=p(j);if(K!=null&&(re===e?K===K&&!Vr(K):P(K,re)))var re=K,le=j}return le}function EM(d,p,P,C){var N=d.length;for(P=lt(P),P<0&&(P=-P>N?0:N+P),C=C===e||C>N?N:lt(C),C<0&&(C+=N),C=P>C?0:Vv(C);P<C;)d[P++]=p;return d}function R1(d,p){var P=[];return wa(d,function(C,N,j){p(C,N,j)&&P.push(C)}),P}function Ji(d,p,P,C,N){var j=-1,K=d.length;for(P||(P=u3),N||(N=[]);++j<K;){var re=d[j];p>0&&P(re)?p>1?Ji(re,p-1,P,C,N):Aa(N,re):C||(N[N.length]=re)}return N}var Oy=iv(),L1=iv(!0);function ls(d,p){return d&&Oy(d,p,Hi)}function My(d,p){return d&&L1(d,p,Hi)}function Dh(d,p){return Ia(p,function(P){return zs(d[P])})}function vo(d,p){p=La(p,d);for(var P=0,C=p.length;d!=null&&P<C;)d=d[cs(p[P++])];return P&&P==C?d:e}function N1(d,p,P){var C=p(d);return nt(d)?C:Aa(C,P(d))}function mr(d){return d==null?d===e?hi:We:bo&&bo in Yt(d)?r3(d):g3(d)}function ky(d,p){return d>p}function SM(d,p){return d!=null&&Mt.call(d,p)}function vM(d,p){return d!=null&&p in Yt(d)}function IM(d,p,P){return d>=nr(p,P)&&d<Ni(p,P)}function Fy(d,p,P){for(var C=P?Py:fh,N=d[0].length,j=d.length,K=j,re=fe(j),le=1/0,Pe=[];K--;){var Ee=d[K];K&&p&&(Ee=ti(Ee,Wr(p))),le=nr(Ee.length,le),re[K]=!P&&(p||N>=120&&Ee.length>=120)?new Eo(K&&Ee):e}Ee=d[0];var ve=-1,Le=re[0];e:for(;++ve<N&&Pe.length<le;){var He=Ee[ve],qe=p?p(He):He;if(He=P||He!==0?He:0,!(Le?ic(Le,qe):C(Pe,qe,P))){for(K=j;--K;){var ut=re[K];if(!(ut?ic(ut,qe):C(d[K],qe,P)))continue e}Le&&Le.push(qe),Pe.push(He)}}return Pe}function AM(d,p,P,C){return ls(d,function(N,j,K){p(C,P(N),j,K)}),C}function cc(d,p,P){p=La(p,d),d=bv(d,p);var C=d==null?d:d[cs(gn(p))];return C==null?e:Gr(C,d,P)}function D1(d){return pi(d)&&mr(d)==te}function CM(d){return pi(d)&&mr(d)==xr}function xM(d){return pi(d)&&mr(d)==Ce}function dc(d,p,P,C,N){return d===p?!0:d==null||p==null||!pi(d)&&!pi(p)?d!==d&&p!==p:TM(d,p,P,C,dc,N)}function TM(d,p,P,C,N,j){var K=nt(d),re=nt(p),le=K?Z:sr(d),Pe=re?Z:sr(p);le=le==te?tt:le,Pe=Pe==te?tt:Pe;var Ee=le==tt,ve=Pe==tt,Le=le==Pe;if(Le&&Da(d)){if(!Da(p))return!1;K=!0,Ee=!1}if(Le&&!Ee)return j||(j=new kn),K||Ll(d)?hv(d,p,P,C,N,j):t3(d,p,le,P,C,N,j);if(!(P&m)){var He=Ee&&Mt.call(d,"__wrapped__"),qe=ve&&Mt.call(p,"__wrapped__");if(He||qe){var ut=He?d.value():d,Xe=qe?p.value():p;return j||(j=new kn),N(ut,Xe,P,C,j)}}return Le?(j||(j=new kn),i3(d,p,P,C,N,j)):!1}function wM(d){return pi(d)&&sr(d)==me}function Uy(d,p,P,C){var N=P.length,j=N,K=!C;if(d==null)return!j;for(d=Yt(d);N--;){var re=P[N];if(K&&re[2]?re[1]!==d[re[0]]:!(re[0]in d))return!1}for(;++N<j;){re=P[N];var le=re[0],Pe=d[le],Ee=re[1];if(K&&re[2]){if(Pe===e&&!(le in d))return!1}else{var ve=new kn;if(C)var Le=C(Pe,Ee,le,d,p,ve);if(!(Le===e?dc(Ee,Pe,m|f,C,ve):Le))return!1}}return!0}function B1(d){if(!ai(d)||d3(d))return!1;var p=zs(d)?wO:bB;return p.test(Ao(d))}function RM(d){return pi(d)&&mr(d)==Ze}function LM(d){return pi(d)&&sr(d)==Ri}function NM(d){return pi(d)&&$h(d.length)&&!!$t[mr(d)]}function O1(d){return typeof d=="function"?d:d==null?Lr:typeof d=="object"?nt(d)?F1(d[0],d[1]):k1(d):rI(d)}function Hy(d){if(!fc(d))return OO(d);var p=[];for(var P in Yt(d))Mt.call(d,P)&&P!="constructor"&&p.push(P);return p}function DM(d){if(!ai(d))return m3(d);var p=fc(d),P=[];for(var C in d)C=="constructor"&&(p||!Mt.call(d,C))||P.push(C);return P}function jy(d,p){return d<p}function M1(d,p){var P=-1,C=wr(d)?fe(d.length):[];return wa(d,function(N,j,K){C[++P]=p(N,j,K)}),C}function k1(d){var p=i_(d);return p.length==1&&p[0][2]?yv(p[0][0],p[0][1]):function(P){return P===d||Uy(P,d,p)}}function F1(d,p){return n_(d)&&gv(p)?yv(cs(d),p):function(P){var C=f_(P,d);return C===e&&C===p?m_(P,d):dc(p,C,m|f)}}function Bh(d,p,P,C,N){d!==p&&Oy(p,function(j,K){if(N||(N=new kn),ai(j))BM(d,p,K,P,Bh,C,N);else{var re=C?C(a_(d,K),j,K+"",d,p,N):e;re===e&&(re=j),Dy(d,K,re)}},Rr)}function BM(d,p,P,C,N,j,K){var re=a_(d,P),le=a_(p,P),Pe=K.get(le);if(Pe){Dy(d,P,Pe);return}var Ee=j?j(re,le,P+"",d,p,K):e,ve=Ee===e;if(ve){var Le=nt(le),He=!Le&&Da(le),qe=!Le&&!He&&Ll(le);Ee=le,Le||He||qe?nt(re)?Ee=re:yi(re)?Ee=Tr(re):He?(ve=!1,Ee=$1(le,!0)):qe?(ve=!1,Ee=K1(le,!0)):Ee=[]:gc(le)||Co(le)?(Ee=re,Co(re)?Ee=qv(re):(!ai(re)||zs(re))&&(Ee=mv(le))):ve=!1}ve&&(K.set(le,Ee),N(Ee,le,C,j,K),K.delete(le)),Dy(d,P,Ee)}function U1(d,p){var P=d.length;if(P)return p+=p<0?P:0,Ws(p,P)?d[p]:e}function H1(d,p,P){p.length?p=ti(p,function(j){return nt(j)?function(K){return vo(K,j.length===1?j[0]:j)}:j}):p=[Lr];var C=-1;p=ti(p,Wr(Ve()));var N=M1(d,function(j,K,re){var le=ti(p,function(Pe){return Pe(j)});return{criteria:le,index:++C,value:j}});return oO(N,function(j,K){return qM(j,K,P)})}function OM(d,p){return j1(d,p,function(P,C){return m_(d,C)})}function j1(d,p,P){for(var C=-1,N=p.length,j={};++C<N;){var K=p[C],re=vo(d,K);P(re,K)&&hc(j,La(K,d),re)}return j}function MM(d){return function(p){return vo(p,d)}}function Yy(d,p,P,C){var N=C?aO:El,j=-1,K=p.length,re=d;for(d===p&&(p=Tr(p)),P&&(re=ti(d,Wr(P)));++j<K;)for(var le=0,Pe=p[j],Ee=P?P(Pe):Pe;(le=N(re,Ee,le,C))>-1;)re!==d&&Ih.call(re,le,1),Ih.call(d,le,1);return d}function Y1(d,p){for(var P=d?p.length:0,C=P-1;P--;){var N=p[P];if(P==C||N!==j){var j=N;Ws(N)?Ih.call(d,N,1):Vy(d,N)}}return d}function Gy(d,p){return d+xh(S1()*(p-d+1))}function kM(d,p,P,C){for(var N=-1,j=Ni(Ch((p-d)/(P||1)),0),K=fe(j);j--;)K[C?j:++N]=d,d+=P;return K}function Wy(d,p){var P="";if(!d||p<1||p>G)return P;do p%2&&(P+=d),p=xh(p/2),p&&(d+=d);while(p);return P}function dt(d,p){return o_(_v(d,p,Lr),d+"")}function FM(d){return A1(Nl(d))}function UM(d,p){var P=Nl(d);return Wh(P,So(p,0,P.length))}function hc(d,p,P,C){if(!ai(d))return d;p=La(p,d);for(var N=-1,j=p.length,K=j-1,re=d;re!=null&&++N<j;){var le=cs(p[N]),Pe=P;if(le==="__proto__"||le==="constructor"||le==="prototype")return d;if(N!=K){var Ee=re[le];Pe=C?C(Ee,le,re):e,Pe===e&&(Pe=ai(Ee)?Ee:Ws(p[N+1])?[]:{})}lc(re,le,Pe),re=re[le]}return d}var G1=Th?function(d,p){return Th.set(d,p),d}:Lr,HM=Ah?function(d,p){return Ah(d,"toString",{configurable:!0,enumerable:!1,value:y_(p),writable:!0})}:Lr;function jM(d){return Wh(Nl(d))}function mn(d,p,P){var C=-1,N=d.length;p<0&&(p=-p>N?0:N+p),P=P>N?N:P,P<0&&(P+=N),N=p>P?0:P-p>>>0,p>>>=0;for(var j=fe(N);++C<N;)j[C]=d[C+p];return j}function YM(d,p){var P;return wa(d,function(C,N,j){return P=p(C,N,j),!P}),!!P}function Oh(d,p,P){var C=0,N=d==null?C:d.length;if(typeof p=="number"&&p===p&&N<=z){for(;C<N;){var j=C+N>>>1,K=d[j];K!==null&&!Vr(K)&&(P?K<=p:K<p)?C=j+1:N=j}return N}return zy(d,p,Lr,P)}function zy(d,p,P,C){var N=0,j=d==null?0:d.length;if(j===0)return 0;p=P(p);for(var K=p!==p,re=p===null,le=Vr(p),Pe=p===e;N<j;){var Ee=xh((N+j)/2),ve=P(d[Ee]),Le=ve!==e,He=ve===null,qe=ve===ve,ut=Vr(ve);if(K)var Xe=C||qe;else Pe?Xe=qe&&(C||Le):re?Xe=qe&&Le&&(C||!He):le?Xe=qe&&Le&&!He&&(C||!ut):He||ut?Xe=!1:Xe=C?ve<=p:ve<p;Xe?N=Ee+1:j=Ee}return nr(j,W)}function W1(d,p){for(var P=-1,C=d.length,N=0,j=[];++P<C;){var K=d[P],re=p?p(K):K;if(!P||!Fn(re,le)){var le=re;j[N++]=K===0?0:K}}return j}function z1(d){return typeof d=="number"?d:Vr(d)?D:+d}function zr(d){if(typeof d=="string")return d;if(nt(d))return ti(d,zr)+"";if(Vr(d))return v1?v1.call(d):"";var p=d+"";return p=="0"&&1/d==-ne?"-0":p}function Ra(d,p,P){var C=-1,N=fh,j=d.length,K=!0,re=[],le=re;if(P)K=!1,N=Py;else if(j>=i){var Pe=p?null:QM(d);if(Pe)return gh(Pe);K=!1,N=ic,le=new Eo}else le=p?[]:re;e:for(;++C<j;){var Ee=d[C],ve=p?p(Ee):Ee;if(Ee=P||Ee!==0?Ee:0,K&&ve===ve){for(var Le=le.length;Le--;)if(le[Le]===ve)continue e;p&&le.push(ve),re.push(Ee)}else N(le,ve,P)||(le!==re&&le.push(ve),re.push(Ee))}return re}function Vy(d,p){return p=La(p,d),d=bv(d,p),d==null||delete d[cs(gn(p))]}function V1(d,p,P,C){return hc(d,p,P(vo(d,p)),C)}function Mh(d,p,P,C){for(var N=d.length,j=C?N:-1;(C?j--:++j<N)&&p(d[j],j,d););return P?mn(d,C?0:j,C?j+1:N):mn(d,C?j+1:0,C?N:j)}function q1(d,p){var P=d;return P instanceof bt&&(P=P.value()),Ey(p,function(C,N){return N.func.apply(N.thisArg,Aa([C],N.args))},P)}function qy(d,p,P){var C=d.length;if(C<2)return C?Ra(d[0]):[];for(var N=-1,j=fe(C);++N<C;)for(var K=d[N],re=-1;++re<C;)re!=N&&(j[N]=uc(j[N]||K,d[re],p,P));return Ra(Ji(j,1),p,P)}function X1(d,p,P){for(var C=-1,N=d.length,j=p.length,K={};++C<N;){var re=C<j?p[C]:e;P(K,d[C],re)}return K}function Xy(d){return yi(d)?d:[]}function Jy(d){return typeof d=="function"?d:Lr}function La(d,p){return nt(d)?d:n_(d,p)?[d]:vv(Ot(d))}var GM=dt;function Na(d,p,P){var C=d.length;return P=P===e?C:P,!p&&P>=C?d:mn(d,p,P)}var J1=RO||function(d){return Ui.clearTimeout(d)};function $1(d,p){if(p)return d.slice();var P=d.length,C=y1?y1(P):new d.constructor(P);return d.copy(C),C}function $y(d){var p=new d.constructor(d.byteLength);return new Sh(p).set(new Sh(d)),p}function WM(d,p){var P=p?$y(d.buffer):d.buffer;return new d.constructor(P,d.byteOffset,d.byteLength)}function zM(d){var p=new d.constructor(d.source,DS.exec(d));return p.lastIndex=d.lastIndex,p}function VM(d){return oc?Yt(oc.call(d)):{}}function K1(d,p){var P=p?$y(d.buffer):d.buffer;return new d.constructor(P,d.byteOffset,d.length)}function Z1(d,p){if(d!==p){var P=d!==e,C=d===null,N=d===d,j=Vr(d),K=p!==e,re=p===null,le=p===p,Pe=Vr(p);if(!re&&!Pe&&!j&&d>p||j&&K&&le&&!re&&!Pe||C&&K&&le||!P&&le||!N)return 1;if(!C&&!j&&!Pe&&d<p||Pe&&P&&N&&!C&&!j||re&&P&&N||!K&&N||!le)return-1}return 0}function qM(d,p,P){for(var C=-1,N=d.criteria,j=p.criteria,K=N.length,re=P.length;++C<K;){var le=Z1(N[C],j[C]);if(le){if(C>=re)return le;var Pe=P[C];return le*(Pe=="desc"?-1:1)}}return d.index-p.index}function Q1(d,p,P,C){for(var N=-1,j=d.length,K=P.length,re=-1,le=p.length,Pe=Ni(j-K,0),Ee=fe(le+Pe),ve=!C;++re<le;)Ee[re]=p[re];for(;++N<K;)(ve||N<j)&&(Ee[P[N]]=d[N]);for(;Pe--;)Ee[re++]=d[N++];return Ee}function ev(d,p,P,C){for(var N=-1,j=d.length,K=-1,re=P.length,le=-1,Pe=p.length,Ee=Ni(j-re,0),ve=fe(Ee+Pe),Le=!C;++N<Ee;)ve[N]=d[N];for(var He=N;++le<Pe;)ve[He+le]=p[le];for(;++K<re;)(Le||N<j)&&(ve[He+P[K]]=d[N++]);return ve}function Tr(d,p){var P=-1,C=d.length;for(p||(p=fe(C));++P<C;)p[P]=d[P];return p}function us(d,p,P,C){var N=!P;P||(P={});for(var j=-1,K=p.length;++j<K;){var re=p[j],le=C?C(P[re],d[re],re,P,d):e;le===e&&(le=d[re]),N?js(P,re,le):lc(P,re,le)}return P}function XM(d,p){return us(d,r_(d),p)}function JM(d,p){return us(d,pv(d),p)}function kh(d,p){return function(P,C){var N=nt(P)?eO:yM,j=p?p():{};return N(P,d,Ve(C,2),j)}}function Tl(d){return dt(function(p,P){var C=-1,N=P.length,j=N>1?P[N-1]:e,K=N>2?P[2]:e;for(j=d.length>3&&typeof j=="function"?(N--,j):e,K&&gr(P[0],P[1],K)&&(j=N<3?e:j,N=1),p=Yt(p);++C<N;){var re=P[C];re&&d(p,re,C,j)}return p})}function tv(d,p){return function(P,C){if(P==null)return P;if(!wr(P))return d(P,C);for(var N=P.length,j=p?N:-1,K=Yt(P);(p?j--:++j<N)&&C(K[j],j,K)!==!1;);return P}}function iv(d){return function(p,P,C){for(var N=-1,j=Yt(p),K=C(p),re=K.length;re--;){var le=K[d?re:++N];if(P(j[le],le,j)===!1)break}return p}}function $M(d,p,P){var C=p&g,N=pc(d);function j(){var K=this&&this!==Ui&&this instanceof j?N:d;return K.apply(C?P:this,arguments)}return j}function rv(d){return function(p){p=Ot(p);var P=Sl(p)?Mn(p):e,C=P?P[0]:p.charAt(0),N=P?Na(P,1).join(""):p.slice(1);return C[d]()+N}}function wl(d){return function(p){return Ey(tI(eI(p).replace(HB,"")),d,"")}}function pc(d){return function(){var p=arguments;switch(p.length){case 0:return new d;case 1:return new d(p[0]);case 2:return new d(p[0],p[1]);case 3:return new d(p[0],p[1],p[2]);case 4:return new d(p[0],p[1],p[2],p[3]);case 5:return new d(p[0],p[1],p[2],p[3],p[4]);case 6:return new d(p[0],p[1],p[2],p[3],p[4],p[5]);case 7:return new d(p[0],p[1],p[2],p[3],p[4],p[5],p[6])}var P=xl(d.prototype),C=d.apply(P,p);return ai(C)?C:P}}function KM(d,p,P){var C=pc(d);function N(){for(var j=arguments.length,K=fe(j),re=j,le=Rl(N);re--;)K[re]=arguments[re];var Pe=j<3&&K[0]!==le&&K[j-1]!==le?[]:Ca(K,le);if(j-=Pe.length,j<P)return lv(d,p,Fh,N.placeholder,e,K,Pe,e,e,P-j);var Ee=this&&this!==Ui&&this instanceof N?C:d;return Gr(Ee,this,K)}return N}function nv(d){return function(p,P,C){var N=Yt(p);if(!wr(p)){var j=Ve(P,3);p=Hi(p),P=function(re){return j(N[re],re,N)}}var K=d(p,P,C);return K>-1?N[j?p[K]:K]:e}}function sv(d){return Gs(function(p){var P=p.length,C=P,N=pn.prototype.thru;for(d&&p.reverse();C--;){var j=p[C];if(typeof j!="function")throw new hn(n);if(N&&!K&&Yh(j)=="wrapper")var K=new pn([],!0)}for(C=K?C:P;++C<P;){j=p[C];var re=Yh(j),le=re=="wrapper"?t_(j):e;le&&s_(le[0])&&le[1]==(x|E|v|T)&&!le[4].length&&le[9]==1?K=K[Yh(le[0])].apply(K,le[3]):K=j.length==1&&s_(j)?K[re]():K.thru(j)}return function(){var Pe=arguments,Ee=Pe[0];if(K&&Pe.length==1&&nt(Ee))return K.plant(Ee).value();for(var ve=0,Le=P?p[ve].apply(this,Pe):Ee;++ve<P;)Le=p[ve].call(this,Le);return Le}})}function Fh(d,p,P,C,N,j,K,re,le,Pe){var Ee=p&x,ve=p&g,Le=p&y,He=p&(E|S),qe=p&R,ut=Le?e:pc(d);function Xe(){for(var _t=arguments.length,St=fe(_t),qr=_t;qr--;)St[qr]=arguments[qr];if(He)var yr=Rl(Xe),Xr=uO(St,yr);if(C&&(St=Q1(St,C,N,He)),j&&(St=ev(St,j,K,He)),_t-=Xr,He&&_t<Pe){var _i=Ca(St,yr);return lv(d,p,Fh,Xe.placeholder,P,St,_i,re,le,Pe-_t)}var Un=ve?P:this,qs=Le?Un[d]:d;return _t=St.length,re?St=y3(St,re):qe&&_t>1&&St.reverse(),Ee&&le<_t&&(St.length=le),this&&this!==Ui&&this instanceof Xe&&(qs=ut||pc(qs)),qs.apply(Un,St)}return Xe}function av(d,p){return function(P,C){return AM(P,d,p(C),{})}}function Uh(d,p){return function(P,C){var N;if(P===e&&C===e)return p;if(P!==e&&(N=P),C!==e){if(N===e)return C;typeof P=="string"||typeof C=="string"?(P=zr(P),C=zr(C)):(P=z1(P),C=z1(C)),N=d(P,C)}return N}}function Ky(d){return Gs(function(p){return p=ti(p,Wr(Ve())),dt(function(P){var C=this;return d(p,function(N){return Gr(N,C,P)})})})}function Hh(d,p){p=p===e?" ":zr(p);var P=p.length;if(P<2)return P?Wy(p,d):p;var C=Wy(p,Ch(d/vl(p)));return Sl(p)?Na(Mn(C),0,d).join(""):C.slice(0,d)}function ZM(d,p,P,C){var N=p&g,j=pc(d);function K(){for(var re=-1,le=arguments.length,Pe=-1,Ee=C.length,ve=fe(Ee+le),Le=this&&this!==Ui&&this instanceof K?j:d;++Pe<Ee;)ve[Pe]=C[Pe];for(;le--;)ve[Pe++]=arguments[++re];return Gr(Le,N?P:this,ve)}return K}function ov(d){return function(p,P,C){return C&&typeof C!="number"&&gr(p,P,C)&&(P=C=e),p=Vs(p),P===e?(P=p,p=0):P=Vs(P),C=C===e?p<P?1:-1:Vs(C),kM(p,P,C,d)}}function jh(d){return function(p,P){return typeof p=="string"&&typeof P=="string"||(p=yn(p),P=yn(P)),d(p,P)}}function lv(d,p,P,C,N,j,K,re,le,Pe){var Ee=p&E,ve=Ee?K:e,Le=Ee?e:K,He=Ee?j:e,qe=Ee?e:j;p|=Ee?v:A,p&=~(Ee?A:v),p&b||(p&=~(g|y));var ut=[d,p,N,He,ve,qe,Le,re,le,Pe],Xe=P.apply(e,ut);return s_(d)&&Pv(Xe,ut),Xe.placeholder=C,Ev(Xe,d,p)}function Zy(d){var p=Li[d];return function(P,C){if(P=yn(P),C=C==null?0:nr(lt(C),292),C&&E1(P)){var N=(Ot(P)+"e").split("e"),j=p(N[0]+"e"+(+N[1]+C));return N=(Ot(j)+"e").split("e"),+(N[0]+"e"+(+N[1]-C))}return p(P)}}var QM=Al&&1/gh(new Al([,-0]))[1]==ne?function(d){return new Al(d)}:P_;function uv(d){return function(p){var P=sr(p);return P==me?Ty(p):P==Ri?gO(p):lO(p,d(p))}}function Ys(d,p,P,C,N,j,K,re){var le=p&y;if(!le&&typeof d!="function")throw new hn(n);var Pe=C?C.length:0;if(Pe||(p&=~(v|A),C=N=e),K=K===e?K:Ni(lt(K),0),re=re===e?re:lt(re),Pe-=N?N.length:0,p&A){var Ee=C,ve=N;C=N=e}var Le=le?e:t_(d),He=[d,p,P,C,N,Ee,ve,j,K,re];if(Le&&f3(He,Le),d=He[0],p=He[1],P=He[2],C=He[3],N=He[4],re=He[9]=He[9]===e?le?0:d.length:Ni(He[9]-Pe,0),!re&&p&(E|S)&&(p&=~(E|S)),!p||p==g)var qe=$M(d,p,P);else p==E||p==S?qe=KM(d,p,re):(p==v||p==(g|v))&&!N.length?qe=ZM(d,p,P,C):qe=Fh.apply(e,He);var ut=Le?G1:Pv;return Ev(ut(qe,He),d,p)}function cv(d,p,P,C){return d===e||Fn(d,Il[P])&&!Mt.call(C,P)?p:d}function dv(d,p,P,C,N,j){return ai(d)&&ai(p)&&(j.set(p,d),Bh(d,p,e,dv,j),j.delete(p)),d}function e3(d){return gc(d)?e:d}function hv(d,p,P,C,N,j){var K=P&m,re=d.length,le=p.length;if(re!=le&&!(K&&le>re))return!1;var Pe=j.get(d),Ee=j.get(p);if(Pe&&Ee)return Pe==p&&Ee==d;var ve=-1,Le=!0,He=P&f?new Eo:e;for(j.set(d,p),j.set(p,d);++ve<re;){var qe=d[ve],ut=p[ve];if(C)var Xe=K?C(ut,qe,ve,p,d,j):C(qe,ut,ve,d,p,j);if(Xe!==e){if(Xe)continue;Le=!1;break}if(He){if(!Sy(p,function(_t,St){if(!ic(He,St)&&(qe===_t||N(qe,_t,P,C,j)))return He.push(St)})){Le=!1;break}}else if(!(qe===ut||N(qe,ut,P,C,j))){Le=!1;break}}return j.delete(d),j.delete(p),Le}function t3(d,p,P,C,N,j,K){switch(P){case Xi:if(d.byteLength!=p.byteLength||d.byteOffset!=p.byteOffset)return!1;d=d.buffer,p=p.buffer;case xr:return!(d.byteLength!=p.byteLength||!j(new Sh(d),new Sh(p)));case Se:case Ce:case Ae:return Fn(+d,+p);case Fe:return d.name==p.name&&d.message==p.message;case Ze:case Jt:return d==p+"";case me:var re=Ty;case Ri:var le=C&m;if(re||(re=gh),d.size!=p.size&&!le)return!1;var Pe=K.get(d);if(Pe)return Pe==p;C|=f,K.set(d,p);var Ee=hv(re(d),re(p),C,N,j,K);return K.delete(d),Ee;case di:if(oc)return oc.call(d)==oc.call(p)}return!1}function i3(d,p,P,C,N,j){var K=P&m,re=Qy(d),le=re.length,Pe=Qy(p),Ee=Pe.length;if(le!=Ee&&!K)return!1;for(var ve=le;ve--;){var Le=re[ve];if(!(K?Le in p:Mt.call(p,Le)))return!1}var He=j.get(d),qe=j.get(p);if(He&&qe)return He==p&&qe==d;var ut=!0;j.set(d,p),j.set(p,d);for(var Xe=K;++ve<le;){Le=re[ve];var _t=d[Le],St=p[Le];if(C)var qr=K?C(St,_t,Le,p,d,j):C(_t,St,Le,d,p,j);if(!(qr===e?_t===St||N(_t,St,P,C,j):qr)){ut=!1;break}Xe||(Xe=Le=="constructor")}if(ut&&!Xe){var yr=d.constructor,Xr=p.constructor;yr!=Xr&&"constructor"in d&&"constructor"in p&&!(typeof yr=="function"&&yr instanceof yr&&typeof Xr=="function"&&Xr instanceof Xr)&&(ut=!1)}return j.delete(d),j.delete(p),ut}function Gs(d){return o_(_v(d,e,xv),d+"")}function Qy(d){return N1(d,Hi,r_)}function e_(d){return N1(d,Rr,pv)}var t_=Th?function(d){return Th.get(d)}:P_;function Yh(d){for(var p=d.name+"",P=Cl[p],C=Mt.call(Cl,p)?P.length:0;C--;){var N=P[C],j=N.func;if(j==null||j==d)return N.name}return p}function Rl(d){var p=Mt.call(U,"placeholder")?U:d;return p.placeholder}function Ve(){var d=U.iteratee||__;return d=d===__?O1:d,arguments.length?d(arguments[0],arguments[1]):d}function Gh(d,p){var P=d.__data__;return c3(p)?P[typeof p=="string"?"string":"hash"]:P.map}function i_(d){for(var p=Hi(d),P=p.length;P--;){var C=p[P],N=d[C];p[P]=[C,N,gv(N)]}return p}function Io(d,p){var P=pO(d,p);return B1(P)?P:e}function r3(d){var p=Mt.call(d,bo),P=d[bo];try{d[bo]=e;var C=!0}catch{}var N=Ph.call(d);return C&&(p?d[bo]=P:delete d[bo]),N}var r_=Ry?function(d){return d==null?[]:(d=Yt(d),Ia(Ry(d),function(p){return b1.call(d,p)}))}:E_,pv=Ry?function(d){for(var p=[];d;)Aa(p,r_(d)),d=vh(d);return p}:E_,sr=mr;(Ly&&sr(new Ly(new ArrayBuffer(1)))!=Xi||nc&&sr(new nc)!=me||Ny&&sr(Ny.resolve())!=Ct||Al&&sr(new Al)!=Ri||sc&&sr(new sc)!=Ei)&&(sr=function(d){var p=mr(d),P=p==tt?d.constructor:e,C=P?Ao(P):"";if(C)switch(C){case UO:return Xi;case HO:return me;case jO:return Ct;case YO:return Ri;case GO:return Ei}return p});function n3(d,p,P){for(var C=-1,N=P.length;++C<N;){var j=P[C],K=j.size;switch(j.type){case"drop":d+=K;break;case"dropRight":p-=K;break;case"take":p=nr(p,d+K);break;case"takeRight":d=Ni(d,p-K);break}}return{start:d,end:p}}function s3(d){var p=d.match(se);return p?p[1].split(hy):[]}function fv(d,p,P){p=La(p,d);for(var C=-1,N=p.length,j=!1;++C<N;){var K=cs(p[C]);if(!(j=d!=null&&P(d,K)))break;d=d[K]}return j||++C!=N?j:(N=d==null?0:d.length,!!N&&$h(N)&&Ws(K,N)&&(nt(d)||Co(d)))}function a3(d){var p=d.length,P=new d.constructor(p);return p&&typeof d[0]=="string"&&Mt.call(d,"index")&&(P.index=d.index,P.input=d.input),P}function mv(d){return typeof d.constructor=="function"&&!fc(d)?xl(vh(d)):{}}function o3(d,p,P){var C=d.constructor;switch(p){case xr:return $y(d);case Se:case Ce:return new C(+d);case Xi:return WM(d,P);case pr:case ks:case ss:case I:case w:case B:case M:case V:case oe:return K1(d,P);case me:return new C;case Ae:case Jt:return new C(d);case Ze:return zM(d);case Ri:return new C;case di:return VM(d)}}function l3(d,p){var P=p.length;if(!P)return d;var C=P-1;return p[C]=(P>1?"& ":"")+p[C],p=p.join(P>2?", ":" "),d.replace(os,`{
/* [wrapped with `+p+`] */
`)}function u3(d){return nt(d)||Co(d)||!!(P1&&d&&d[P1])}function Ws(d,p){var P=typeof d;return p=p==null?G:p,!!p&&(P=="number"||P!="symbol"&&EB.test(d))&&d>-1&&d%1==0&&d<p}function gr(d,p,P){if(!ai(P))return!1;var C=typeof p;return(C=="number"?wr(P)&&Ws(p,P.length):C=="string"&&p in P)?Fn(P[p],d):!1}function n_(d,p){if(nt(d))return!1;var P=typeof d;return P=="number"||P=="symbol"||P=="boolean"||d==null||Vr(d)?!0:jr.test(d)||!un.test(d)||p!=null&&d in Yt(p)}function c3(d){var p=typeof d;return p=="string"||p=="number"||p=="symbol"||p=="boolean"?d!=="__proto__":d===null}function s_(d){var p=Yh(d),P=U[p];if(typeof P!="function"||!(p in bt.prototype))return!1;if(d===P)return!0;var C=t_(P);return!!C&&d===C[0]}function d3(d){return!!g1&&g1 in d}var h3=_h?zs:S_;function fc(d){var p=d&&d.constructor,P=typeof p=="function"&&p.prototype||Il;return d===P}function gv(d){return d===d&&!ai(d)}function yv(d,p){return function(P){return P==null?!1:P[d]===p&&(p!==e||d in Yt(P))}}function p3(d){var p=Xh(d,function(C){return P.size===o&&P.clear(),C}),P=p.cache;return p}function f3(d,p){var P=d[1],C=p[1],N=P|C,j=N<(g|y|x),K=C==x&&P==E||C==x&&P==T&&d[7].length<=p[8]||C==(x|T)&&p[7].length<=p[8]&&P==E;if(!(j||K))return d;C&g&&(d[2]=p[2],N|=P&g?0:b);var re=p[3];if(re){var le=d[3];d[3]=le?Q1(le,re,p[4]):re,d[4]=le?Ca(d[3],l):p[4]}return re=p[5],re&&(le=d[5],d[5]=le?ev(le,re,p[6]):re,d[6]=le?Ca(d[5],l):p[6]),re=p[7],re&&(d[7]=re),C&x&&(d[8]=d[8]==null?p[8]:nr(d[8],p[8])),d[9]==null&&(d[9]=p[9]),d[0]=p[0],d[1]=N,d}function m3(d){var p=[];if(d!=null)for(var P in Yt(d))p.push(P);return p}function g3(d){return Ph.call(d)}function _v(d,p,P){return p=Ni(p===e?d.length-1:p,0),function(){for(var C=arguments,N=-1,j=Ni(C.length-p,0),K=fe(j);++N<j;)K[N]=C[p+N];N=-1;for(var re=fe(p+1);++N<p;)re[N]=C[N];return re[p]=P(K),Gr(d,this,re)}}function bv(d,p){return p.length<2?d:vo(d,mn(p,0,-1))}function y3(d,p){for(var P=d.length,C=nr(p.length,P),N=Tr(d);C--;){var j=p[C];d[C]=Ws(j,P)?N[j]:e}return d}function a_(d,p){if(!(p==="constructor"&&typeof d[p]=="function")&&p!="__proto__")return d[p]}var Pv=Sv(G1),mc=NO||function(d,p){return Ui.setTimeout(d,p)},o_=Sv(HM);function Ev(d,p,P){var C=p+"";return o_(d,l3(C,_3(s3(C),P)))}function Sv(d){var p=0,P=0;return function(){var C=MO(),N=k-(C-P);if(P=C,N>0){if(++p>=H)return arguments[0]}else p=0;return d.apply(e,arguments)}}function Wh(d,p){var P=-1,C=d.length,N=C-1;for(p=p===e?C:p;++P<p;){var j=Gy(P,N),K=d[j];d[j]=d[P],d[P]=K}return d.length=p,d}var vv=p3(function(d){var p=[];return d.charCodeAt(0)===46&&p.push(""),d.replace(Yr,function(P,C,N,j){p.push(N?j.replace(mB,"$1"):C||P)}),p});function cs(d){if(typeof d=="string"||Vr(d))return d;var p=d+"";return p=="0"&&1/d==-ne?"-0":p}function Ao(d){if(d!=null){try{return bh.call(d)}catch{}try{return d+""}catch{}}return""}function _3(d,p){return dn($,function(P){var C="_."+P[0];p&P[1]&&!fh(d,C)&&d.push(C)}),d.sort()}function Iv(d){if(d instanceof bt)return d.clone();var p=new pn(d.__wrapped__,d.__chain__);return p.__actions__=Tr(d.__actions__),p.__index__=d.__index__,p.__values__=d.__values__,p}function b3(d,p,P){(P?gr(d,p,P):p===e)?p=1:p=Ni(lt(p),0);var C=d==null?0:d.length;if(!C||p<1)return[];for(var N=0,j=0,K=fe(Ch(C/p));N<C;)K[j++]=mn(d,N,N+=p);return K}function P3(d){for(var p=-1,P=d==null?0:d.length,C=0,N=[];++p<P;){var j=d[p];j&&(N[C++]=j)}return N}function E3(){var d=arguments.length;if(!d)return[];for(var p=fe(d-1),P=arguments[0],C=d;C--;)p[C-1]=arguments[C];return Aa(nt(P)?Tr(P):[P],Ji(p,1))}var S3=dt(function(d,p){return yi(d)?uc(d,Ji(p,1,yi,!0)):[]}),v3=dt(function(d,p){var P=gn(p);return yi(P)&&(P=e),yi(d)?uc(d,Ji(p,1,yi,!0),Ve(P,2)):[]}),I3=dt(function(d,p){var P=gn(p);return yi(P)&&(P=e),yi(d)?uc(d,Ji(p,1,yi,!0),e,P):[]});function A3(d,p,P){var C=d==null?0:d.length;return C?(p=P||p===e?1:lt(p),mn(d,p<0?0:p,C)):[]}function C3(d,p,P){var C=d==null?0:d.length;return C?(p=P||p===e?1:lt(p),p=C-p,mn(d,0,p<0?0:p)):[]}function x3(d,p){return d&&d.length?Mh(d,Ve(p,3),!0,!0):[]}function T3(d,p){return d&&d.length?Mh(d,Ve(p,3),!0):[]}function w3(d,p,P,C){var N=d==null?0:d.length;return N?(P&&typeof P!="number"&&gr(d,p,P)&&(P=0,C=N),EM(d,p,P,C)):[]}function Av(d,p,P){var C=d==null?0:d.length;if(!C)return-1;var N=P==null?0:lt(P);return N<0&&(N=Ni(C+N,0)),mh(d,Ve(p,3),N)}function Cv(d,p,P){var C=d==null?0:d.length;if(!C)return-1;var N=C-1;return P!==e&&(N=lt(P),N=P<0?Ni(C+N,0):nr(N,C-1)),mh(d,Ve(p,3),N,!0)}function xv(d){var p=d==null?0:d.length;return p?Ji(d,1):[]}function R3(d){var p=d==null?0:d.length;return p?Ji(d,ne):[]}function L3(d,p){var P=d==null?0:d.length;return P?(p=p===e?1:lt(p),Ji(d,p)):[]}function N3(d){for(var p=-1,P=d==null?0:d.length,C={};++p<P;){var N=d[p];C[N[0]]=N[1]}return C}function Tv(d){return d&&d.length?d[0]:e}function D3(d,p,P){var C=d==null?0:d.length;if(!C)return-1;var N=P==null?0:lt(P);return N<0&&(N=Ni(C+N,0)),El(d,p,N)}function B3(d){var p=d==null?0:d.length;return p?mn(d,0,-1):[]}var O3=dt(function(d){var p=ti(d,Xy);return p.length&&p[0]===d[0]?Fy(p):[]}),M3=dt(function(d){var p=gn(d),P=ti(d,Xy);return p===gn(P)?p=e:P.pop(),P.length&&P[0]===d[0]?Fy(P,Ve(p,2)):[]}),k3=dt(function(d){var p=gn(d),P=ti(d,Xy);return p=typeof p=="function"?p:e,p&&P.pop(),P.length&&P[0]===d[0]?Fy(P,e,p):[]});function F3(d,p){return d==null?"":BO.call(d,p)}function gn(d){var p=d==null?0:d.length;return p?d[p-1]:e}function U3(d,p,P){var C=d==null?0:d.length;if(!C)return-1;var N=C;return P!==e&&(N=lt(P),N=N<0?Ni(C+N,0):nr(N,C-1)),p===p?_O(d,p,N):mh(d,l1,N,!0)}function H3(d,p){return d&&d.length?U1(d,lt(p)):e}var j3=dt(wv);function wv(d,p){return d&&d.length&&p&&p.length?Yy(d,p):d}function Y3(d,p,P){return d&&d.length&&p&&p.length?Yy(d,p,Ve(P,2)):d}function G3(d,p,P){return d&&d.length&&p&&p.length?Yy(d,p,e,P):d}var W3=Gs(function(d,p){var P=d==null?0:d.length,C=By(d,p);return Y1(d,ti(p,function(N){return Ws(N,P)?+N:N}).sort(Z1)),C});function z3(d,p){var P=[];if(!(d&&d.length))return P;var C=-1,N=[],j=d.length;for(p=Ve(p,3);++C<j;){var K=d[C];p(K,C,d)&&(P.push(K),N.push(C))}return Y1(d,N),P}function l_(d){return d==null?d:FO.call(d)}function V3(d,p,P){var C=d==null?0:d.length;return C?(P&&typeof P!="number"&&gr(d,p,P)?(p=0,P=C):(p=p==null?0:lt(p),P=P===e?C:lt(P)),mn(d,p,P)):[]}function q3(d,p){return Oh(d,p)}function X3(d,p,P){return zy(d,p,Ve(P,2))}function J3(d,p){var P=d==null?0:d.length;if(P){var C=Oh(d,p);if(C<P&&Fn(d[C],p))return C}return-1}function $3(d,p){return Oh(d,p,!0)}function K3(d,p,P){return zy(d,p,Ve(P,2),!0)}function Z3(d,p){var P=d==null?0:d.length;if(P){var C=Oh(d,p,!0)-1;if(Fn(d[C],p))return C}return-1}function Q3(d){return d&&d.length?W1(d):[]}function ek(d,p){return d&&d.length?W1(d,Ve(p,2)):[]}function tk(d){var p=d==null?0:d.length;return p?mn(d,1,p):[]}function ik(d,p,P){return d&&d.length?(p=P||p===e?1:lt(p),mn(d,0,p<0?0:p)):[]}function rk(d,p,P){var C=d==null?0:d.length;return C?(p=P||p===e?1:lt(p),p=C-p,mn(d,p<0?0:p,C)):[]}function nk(d,p){return d&&d.length?Mh(d,Ve(p,3),!1,!0):[]}function sk(d,p){return d&&d.length?Mh(d,Ve(p,3)):[]}var ak=dt(function(d){return Ra(Ji(d,1,yi,!0))}),ok=dt(function(d){var p=gn(d);return yi(p)&&(p=e),Ra(Ji(d,1,yi,!0),Ve(p,2))}),lk=dt(function(d){var p=gn(d);return p=typeof p=="function"?p:e,Ra(Ji(d,1,yi,!0),e,p)});function uk(d){return d&&d.length?Ra(d):[]}function ck(d,p){return d&&d.length?Ra(d,Ve(p,2)):[]}function dk(d,p){return p=typeof p=="function"?p:e,d&&d.length?Ra(d,e,p):[]}function u_(d){if(!(d&&d.length))return[];var p=0;return d=Ia(d,function(P){if(yi(P))return p=Ni(P.length,p),!0}),Cy(p,function(P){return ti(d,vy(P))})}function Rv(d,p){if(!(d&&d.length))return[];var P=u_(d);return p==null?P:ti(P,function(C){return Gr(p,e,C)})}var hk=dt(function(d,p){return yi(d)?uc(d,p):[]}),pk=dt(function(d){return qy(Ia(d,yi))}),fk=dt(function(d){var p=gn(d);return yi(p)&&(p=e),qy(Ia(d,yi),Ve(p,2))}),mk=dt(function(d){var p=gn(d);return p=typeof p=="function"?p:e,qy(Ia(d,yi),e,p)}),gk=dt(u_);function yk(d,p){return X1(d||[],p||[],lc)}function _k(d,p){return X1(d||[],p||[],hc)}var bk=dt(function(d){var p=d.length,P=p>1?d[p-1]:e;return P=typeof P=="function"?(d.pop(),P):e,Rv(d,P)});function Lv(d){var p=U(d);return p.__chain__=!0,p}function Pk(d,p){return p(d),d}function zh(d,p){return p(d)}var Ek=Gs(function(d){var p=d.length,P=p?d[0]:0,C=this.__wrapped__,N=function(j){return By(j,d)};return p>1||this.__actions__.length||!(C instanceof bt)||!Ws(P)?this.thru(N):(C=C.slice(P,+P+(p?1:0)),C.__actions__.push({func:zh,args:[N],thisArg:e}),new pn(C,this.__chain__).thru(function(j){return p&&!j.length&&j.push(e),j}))});function Sk(){return Lv(this)}function vk(){return new pn(this.value(),this.__chain__)}function Ik(){this.__values__===e&&(this.__values__=zv(this.value()));var d=this.__index__>=this.__values__.length,p=d?e:this.__values__[this.__index__++];return{done:d,value:p}}function Ak(){return this}function Ck(d){for(var p,P=this;P instanceof Rh;){var C=Iv(P);C.__index__=0,C.__values__=e,p?N.__wrapped__=C:p=C;var N=C;P=P.__wrapped__}return N.__wrapped__=d,p}function xk(){var d=this.__wrapped__;if(d instanceof bt){var p=d;return this.__actions__.length&&(p=new bt(this)),p=p.reverse(),p.__actions__.push({func:zh,args:[l_],thisArg:e}),new pn(p,this.__chain__)}return this.thru(l_)}function Tk(){return q1(this.__wrapped__,this.__actions__)}var wk=kh(function(d,p,P){Mt.call(d,P)?++d[P]:js(d,P,1)});function Rk(d,p,P){var C=nt(d)?a1:PM;return P&&gr(d,p,P)&&(p=e),C(d,Ve(p,3))}function Lk(d,p){var P=nt(d)?Ia:R1;return P(d,Ve(p,3))}var Nk=nv(Av),Dk=nv(Cv);function Bk(d,p){return Ji(Vh(d,p),1)}function Ok(d,p){return Ji(Vh(d,p),ne)}function Mk(d,p,P){return P=P===e?1:lt(P),Ji(Vh(d,p),P)}function Nv(d,p){var P=nt(d)?dn:wa;return P(d,Ve(p,3))}function Dv(d,p){var P=nt(d)?tO:w1;return P(d,Ve(p,3))}var kk=kh(function(d,p,P){Mt.call(d,P)?d[P].push(p):js(d,P,[p])});function Fk(d,p,P,C){d=wr(d)?d:Nl(d),P=P&&!C?lt(P):0;var N=d.length;return P<0&&(P=Ni(N+P,0)),Kh(d)?P<=N&&d.indexOf(p,P)>-1:!!N&&El(d,p,P)>-1}var Uk=dt(function(d,p,P){var C=-1,N=typeof p=="function",j=wr(d)?fe(d.length):[];return wa(d,function(K){j[++C]=N?Gr(p,K,P):cc(K,p,P)}),j}),Hk=kh(function(d,p,P){js(d,P,p)});function Vh(d,p){var P=nt(d)?ti:M1;return P(d,Ve(p,3))}function jk(d,p,P,C){return d==null?[]:(nt(p)||(p=p==null?[]:[p]),P=C?e:P,nt(P)||(P=P==null?[]:[P]),H1(d,p,P))}var Yk=kh(function(d,p,P){d[P?0:1].push(p)},function(){return[[],[]]});function Gk(d,p,P){var C=nt(d)?Ey:c1,N=arguments.length<3;return C(d,Ve(p,4),P,N,wa)}function Wk(d,p,P){var C=nt(d)?iO:c1,N=arguments.length<3;return C(d,Ve(p,4),P,N,w1)}function zk(d,p){var P=nt(d)?Ia:R1;return P(d,Jh(Ve(p,3)))}function Vk(d){var p=nt(d)?A1:FM;return p(d)}function qk(d,p,P){(P?gr(d,p,P):p===e)?p=1:p=lt(p);var C=nt(d)?mM:UM;return C(d,p)}function Xk(d){var p=nt(d)?gM:jM;return p(d)}function Jk(d){if(d==null)return 0;if(wr(d))return Kh(d)?vl(d):d.length;var p=sr(d);return p==me||p==Ri?d.size:Hy(d).length}function $k(d,p,P){var C=nt(d)?Sy:YM;return P&&gr(d,p,P)&&(p=e),C(d,Ve(p,3))}var Kk=dt(function(d,p){if(d==null)return[];var P=p.length;return P>1&&gr(d,p[0],p[1])?p=[]:P>2&&gr(p[0],p[1],p[2])&&(p=[p[0]]),H1(d,Ji(p,1),[])}),qh=LO||function(){return Ui.Date.now()};function Zk(d,p){if(typeof p!="function")throw new hn(n);return d=lt(d),function(){if(--d<1)return p.apply(this,arguments)}}function Bv(d,p,P){return p=P?e:p,p=d&&p==null?d.length:p,Ys(d,x,e,e,e,e,p)}function Ov(d,p){var P;if(typeof p!="function")throw new hn(n);return d=lt(d),function(){return--d>0&&(P=p.apply(this,arguments)),d<=1&&(p=e),P}}var c_=dt(function(d,p,P){var C=g;if(P.length){var N=Ca(P,Rl(c_));C|=v}return Ys(d,C,p,P,N)}),Mv=dt(function(d,p,P){var C=g|y;if(P.length){var N=Ca(P,Rl(Mv));C|=v}return Ys(p,C,d,P,N)});function kv(d,p,P){p=P?e:p;var C=Ys(d,E,e,e,e,e,e,p);return C.placeholder=kv.placeholder,C}function Fv(d,p,P){p=P?e:p;var C=Ys(d,S,e,e,e,e,e,p);return C.placeholder=Fv.placeholder,C}function Uv(d,p,P){var C,N,j,K,re,le,Pe=0,Ee=!1,ve=!1,Le=!0;if(typeof d!="function")throw new hn(n);p=yn(p)||0,ai(P)&&(Ee=!!P.leading,ve="maxWait"in P,j=ve?Ni(yn(P.maxWait)||0,p):j,Le="trailing"in P?!!P.trailing:Le);function He(_i){var Un=C,qs=N;return C=N=e,Pe=_i,K=d.apply(qs,Un),K}function qe(_i){return Pe=_i,re=mc(_t,p),Ee?He(_i):K}function ut(_i){var Un=_i-le,qs=_i-Pe,nI=p-Un;return ve?nr(nI,j-qs):nI}function Xe(_i){var Un=_i-le,qs=_i-Pe;return le===e||Un>=p||Un<0||ve&&qs>=j}function _t(){var _i=qh();if(Xe(_i))return St(_i);re=mc(_t,ut(_i))}function St(_i){return re=e,Le&&C?He(_i):(C=N=e,K)}function qr(){re!==e&&J1(re),Pe=0,C=le=N=re=e}function yr(){return re===e?K:St(qh())}function Xr(){var _i=qh(),Un=Xe(_i);if(C=arguments,N=this,le=_i,Un){if(re===e)return qe(le);if(ve)return J1(re),re=mc(_t,p),He(le)}return re===e&&(re=mc(_t,p)),K}return Xr.cancel=qr,Xr.flush=yr,Xr}var Qk=dt(function(d,p){return T1(d,1,p)}),e4=dt(function(d,p,P){return T1(d,yn(p)||0,P)});function t4(d){return Ys(d,R)}function Xh(d,p){if(typeof d!="function"||p!=null&&typeof p!="function")throw new hn(n);var P=function(){var C=arguments,N=p?p.apply(this,C):C[0],j=P.cache;if(j.has(N))return j.get(N);var K=d.apply(this,C);return P.cache=j.set(N,K)||j,K};return P.cache=new(Xh.Cache||Hs),P}Xh.Cache=Hs;function Jh(d){if(typeof d!="function")throw new hn(n);return function(){var p=arguments;switch(p.length){case 0:return!d.call(this);case 1:return!d.call(this,p[0]);case 2:return!d.call(this,p[0],p[1]);case 3:return!d.call(this,p[0],p[1],p[2])}return!d.apply(this,p)}}function i4(d){return Ov(2,d)}var r4=GM(function(d,p){p=p.length==1&&nt(p[0])?ti(p[0],Wr(Ve())):ti(Ji(p,1),Wr(Ve()));var P=p.length;return dt(function(C){for(var N=-1,j=nr(C.length,P);++N<j;)C[N]=p[N].call(this,C[N]);return Gr(d,this,C)})}),d_=dt(function(d,p){var P=Ca(p,Rl(d_));return Ys(d,v,e,p,P)}),Hv=dt(function(d,p){var P=Ca(p,Rl(Hv));return Ys(d,A,e,p,P)}),n4=Gs(function(d,p){return Ys(d,T,e,e,e,p)});function s4(d,p){if(typeof d!="function")throw new hn(n);return p=p===e?p:lt(p),dt(d,p)}function a4(d,p){if(typeof d!="function")throw new hn(n);return p=p==null?0:Ni(lt(p),0),dt(function(P){var C=P[p],N=Na(P,0,p);return C&&Aa(N,C),Gr(d,this,N)})}function o4(d,p,P){var C=!0,N=!0;if(typeof d!="function")throw new hn(n);return ai(P)&&(C="leading"in P?!!P.leading:C,N="trailing"in P?!!P.trailing:N),Uv(d,p,{leading:C,maxWait:p,trailing:N})}function l4(d){return Bv(d,1)}function u4(d,p){return d_(Jy(p),d)}function c4(){if(!arguments.length)return[];var d=arguments[0];return nt(d)?d:[d]}function d4(d){return fn(d,h)}function h4(d,p){return p=typeof p=="function"?p:e,fn(d,h,p)}function p4(d){return fn(d,u|h)}function f4(d,p){return p=typeof p=="function"?p:e,fn(d,u|h,p)}function m4(d,p){return p==null||x1(d,p,Hi(p))}function Fn(d,p){return d===p||d!==d&&p!==p}var g4=jh(ky),y4=jh(function(d,p){return d>=p}),Co=D1((function(){return arguments})())?D1:function(d){return pi(d)&&Mt.call(d,"callee")&&!b1.call(d,"callee")},nt=fe.isArray,_4=e1?Wr(e1):CM;function wr(d){return d!=null&&$h(d.length)&&!zs(d)}function yi(d){return pi(d)&&wr(d)}function b4(d){return d===!0||d===!1||pi(d)&&mr(d)==Se}var Da=DO||S_,P4=t1?Wr(t1):xM;function E4(d){return pi(d)&&d.nodeType===1&&!gc(d)}function S4(d){if(d==null)return!0;if(wr(d)&&(nt(d)||typeof d=="string"||typeof d.splice=="function"||Da(d)||Ll(d)||Co(d)))return!d.length;var p=sr(d);if(p==me||p==Ri)return!d.size;if(fc(d))return!Hy(d).length;for(var P in d)if(Mt.call(d,P))return!1;return!0}function v4(d,p){return dc(d,p)}function I4(d,p,P){P=typeof P=="function"?P:e;var C=P?P(d,p):e;return C===e?dc(d,p,e,P):!!C}function h_(d){if(!pi(d))return!1;var p=mr(d);return p==Fe||p==we||typeof d.message=="string"&&typeof d.name=="string"&&!gc(d)}function A4(d){return typeof d=="number"&&E1(d)}function zs(d){if(!ai(d))return!1;var p=mr(d);return p==Ue||p==je||p==pe||p==it}function jv(d){return typeof d=="number"&&d==lt(d)}function $h(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=G}function ai(d){var p=typeof d;return d!=null&&(p=="object"||p=="function")}function pi(d){return d!=null&&typeof d=="object"}var Yv=i1?Wr(i1):wM;function C4(d,p){return d===p||Uy(d,p,i_(p))}function x4(d,p,P){return P=typeof P=="function"?P:e,Uy(d,p,i_(p),P)}function T4(d){return Gv(d)&&d!=+d}function w4(d){if(h3(d))throw new rt(r);return B1(d)}function R4(d){return d===null}function L4(d){return d==null}function Gv(d){return typeof d=="number"||pi(d)&&mr(d)==Ae}function gc(d){if(!pi(d)||mr(d)!=tt)return!1;var p=vh(d);if(p===null)return!0;var P=Mt.call(p,"constructor")&&p.constructor;return typeof P=="function"&&P instanceof P&&bh.call(P)==xO}var p_=r1?Wr(r1):RM;function N4(d){return jv(d)&&d>=-G&&d<=G}var Wv=n1?Wr(n1):LM;function Kh(d){return typeof d=="string"||!nt(d)&&pi(d)&&mr(d)==Jt}function Vr(d){return typeof d=="symbol"||pi(d)&&mr(d)==di}var Ll=s1?Wr(s1):NM;function D4(d){return d===e}function B4(d){return pi(d)&&sr(d)==Ei}function O4(d){return pi(d)&&mr(d)==ln}var M4=jh(jy),k4=jh(function(d,p){return d<=p});function zv(d){if(!d)return[];if(wr(d))return Kh(d)?Mn(d):Tr(d);if(rc&&d[rc])return mO(d[rc]());var p=sr(d),P=p==me?Ty:p==Ri?gh:Nl;return P(d)}function Vs(d){if(!d)return d===0?d:0;if(d=yn(d),d===ne||d===-ne){var p=d<0?-1:1;return p*X}return d===d?d:0}function lt(d){var p=Vs(d),P=p%1;return p===p?P?p-P:p:0}function Vv(d){return d?So(lt(d),0,F):0}function yn(d){if(typeof d=="number")return d;if(Vr(d))return D;if(ai(d)){var p=typeof d.valueOf=="function"?d.valueOf():d;d=ai(p)?p+"":p}if(typeof d!="string")return d===0?d:+d;d=d1(d);var P=_B.test(d);return P||PB.test(d)?ZB(d.slice(2),P?2:8):yB.test(d)?D:+d}function qv(d){return us(d,Rr(d))}function F4(d){return d?So(lt(d),-G,G):d===0?d:0}function Ot(d){return d==null?"":zr(d)}var U4=Tl(function(d,p){if(fc(p)||wr(p)){us(p,Hi(p),d);return}for(var P in p)Mt.call(p,P)&&lc(d,P,p[P])}),Xv=Tl(function(d,p){us(p,Rr(p),d)}),Zh=Tl(function(d,p,P,C){us(p,Rr(p),d,C)}),H4=Tl(function(d,p,P,C){us(p,Hi(p),d,C)}),j4=Gs(By);function Y4(d,p){var P=xl(d);return p==null?P:C1(P,p)}var G4=dt(function(d,p){d=Yt(d);var P=-1,C=p.length,N=C>2?p[2]:e;for(N&&gr(p[0],p[1],N)&&(C=1);++P<C;)for(var j=p[P],K=Rr(j),re=-1,le=K.length;++re<le;){var Pe=K[re],Ee=d[Pe];(Ee===e||Fn(Ee,Il[Pe])&&!Mt.call(d,Pe))&&(d[Pe]=j[Pe])}return d}),W4=dt(function(d){return d.push(e,dv),Gr(Jv,e,d)});function z4(d,p){return o1(d,Ve(p,3),ls)}function V4(d,p){return o1(d,Ve(p,3),My)}function q4(d,p){return d==null?d:Oy(d,Ve(p,3),Rr)}function X4(d,p){return d==null?d:L1(d,Ve(p,3),Rr)}function J4(d,p){return d&&ls(d,Ve(p,3))}function $4(d,p){return d&&My(d,Ve(p,3))}function K4(d){return d==null?[]:Dh(d,Hi(d))}function Z4(d){return d==null?[]:Dh(d,Rr(d))}function f_(d,p,P){var C=d==null?e:vo(d,p);return C===e?P:C}function Q4(d,p){return d!=null&&fv(d,p,SM)}function m_(d,p){return d!=null&&fv(d,p,vM)}var e5=av(function(d,p,P){p!=null&&typeof p.toString!="function"&&(p=Ph.call(p)),d[p]=P},y_(Lr)),t5=av(function(d,p,P){p!=null&&typeof p.toString!="function"&&(p=Ph.call(p)),Mt.call(d,p)?d[p].push(P):d[p]=[P]},Ve),i5=dt(cc);function Hi(d){return wr(d)?I1(d):Hy(d)}function Rr(d){return wr(d)?I1(d,!0):DM(d)}function r5(d,p){var P={};return p=Ve(p,3),ls(d,function(C,N,j){js(P,p(C,N,j),C)}),P}function n5(d,p){var P={};return p=Ve(p,3),ls(d,function(C,N,j){js(P,N,p(C,N,j))}),P}var s5=Tl(function(d,p,P){Bh(d,p,P)}),Jv=Tl(function(d,p,P,C){Bh(d,p,P,C)}),a5=Gs(function(d,p){var P={};if(d==null)return P;var C=!1;p=ti(p,function(j){return j=La(j,d),C||(C=j.length>1),j}),us(d,e_(d),P),C&&(P=fn(P,u|c|h,e3));for(var N=p.length;N--;)Vy(P,p[N]);return P});function o5(d,p){return $v(d,Jh(Ve(p)))}var l5=Gs(function(d,p){return d==null?{}:OM(d,p)});function $v(d,p){if(d==null)return{};var P=ti(e_(d),function(C){return[C]});return p=Ve(p),j1(d,P,function(C,N){return p(C,N[0])})}function u5(d,p,P){p=La(p,d);var C=-1,N=p.length;for(N||(N=1,d=e);++C<N;){var j=d==null?e:d[cs(p[C])];j===e&&(C=N,j=P),d=zs(j)?j.call(d):j}return d}function c5(d,p,P){return d==null?d:hc(d,p,P)}function d5(d,p,P,C){return C=typeof C=="function"?C:e,d==null?d:hc(d,p,P,C)}var Kv=uv(Hi),Zv=uv(Rr);function h5(d,p,P){var C=nt(d),N=C||Da(d)||Ll(d);if(p=Ve(p,4),P==null){var j=d&&d.constructor;N?P=C?new j:[]:ai(d)?P=zs(j)?xl(vh(d)):{}:P={}}return(N?dn:ls)(d,function(K,re,le){return p(P,K,re,le)}),P}function p5(d,p){return d==null?!0:Vy(d,p)}function f5(d,p,P){return d==null?d:V1(d,p,Jy(P))}function m5(d,p,P,C){return C=typeof C=="function"?C:e,d==null?d:V1(d,p,Jy(P),C)}function Nl(d){return d==null?[]:xy(d,Hi(d))}function g5(d){return d==null?[]:xy(d,Rr(d))}function y5(d,p,P){return P===e&&(P=p,p=e),P!==e&&(P=yn(P),P=P===P?P:0),p!==e&&(p=yn(p),p=p===p?p:0),So(yn(d),p,P)}function _5(d,p,P){return p=Vs(p),P===e?(P=p,p=0):P=Vs(P),d=yn(d),IM(d,p,P)}function b5(d,p,P){if(P&&typeof P!="boolean"&&gr(d,p,P)&&(p=P=e),P===e&&(typeof p=="boolean"?(P=p,p=e):typeof d=="boolean"&&(P=d,d=e)),d===e&&p===e?(d=0,p=1):(d=Vs(d),p===e?(p=d,d=0):p=Vs(p)),d>p){var C=d;d=p,p=C}if(P||d%1||p%1){var N=S1();return nr(d+N*(p-d+KB("1e-"+((N+"").length-1))),p)}return Gy(d,p)}var P5=wl(function(d,p,P){return p=p.toLowerCase(),d+(P?Qv(p):p)});function Qv(d){return g_(Ot(d).toLowerCase())}function eI(d){return d=Ot(d),d&&d.replace(SB,cO).replace(jB,"")}function E5(d,p,P){d=Ot(d),p=zr(p);var C=d.length;P=P===e?C:So(lt(P),0,C);var N=P;return P-=p.length,P>=0&&d.slice(P,N)==p}function S5(d){return d=Ot(d),d&&Si.test(d)?d.replace(xt,dO):d}function v5(d){return d=Ot(d),d&&dy.test(d)?d.replace(_l,"\\$&"):d}var I5=wl(function(d,p,P){return d+(P?"-":"")+p.toLowerCase()}),A5=wl(function(d,p,P){return d+(P?" ":"")+p.toLowerCase()}),C5=rv("toLowerCase");function x5(d,p,P){d=Ot(d),p=lt(p);var C=p?vl(d):0;if(!p||C>=p)return d;var N=(p-C)/2;return Hh(xh(N),P)+d+Hh(Ch(N),P)}function T5(d,p,P){d=Ot(d),p=lt(p);var C=p?vl(d):0;return p&&C<p?d+Hh(p-C,P):d}function w5(d,p,P){d=Ot(d),p=lt(p);var C=p?vl(d):0;return p&&C<p?Hh(p-C,P)+d:d}function R5(d,p,P){return P||p==null?p=0:p&&(p=+p),kO(Ot(d).replace(bl,""),p||0)}function L5(d,p,P){return(P?gr(d,p,P):p===e)?p=1:p=lt(p),Wy(Ot(d),p)}function N5(){var d=arguments,p=Ot(d[0]);return d.length<3?p:p.replace(d[1],d[2])}var D5=wl(function(d,p,P){return d+(P?"_":"")+p.toLowerCase()});function B5(d,p,P){return P&&typeof P!="number"&&gr(d,p,P)&&(p=P=e),P=P===e?F:P>>>0,P?(d=Ot(d),d&&(typeof p=="string"||p!=null&&!p_(p))&&(p=zr(p),!p&&Sl(d))?Na(Mn(d),0,P):d.split(p,P)):[]}var O5=wl(function(d,p,P){return d+(P?" ":"")+g_(p)});function M5(d,p,P){return d=Ot(d),P=P==null?0:So(lt(P),0,d.length),p=zr(p),d.slice(P,P+p.length)==p}function k5(d,p,P){var C=U.templateSettings;P&&gr(d,p,P)&&(p=e),d=Ot(d),p=Zh({},p,C,cv);var N=Zh({},p.imports,C.imports,cv),j=Hi(N),K=xy(N,j),re,le,Pe=0,Ee=p.interpolate||dh,ve="__p += '",Le=wy((p.escape||dh).source+"|"+Ee.source+"|"+(Ee===as?gB:dh).source+"|"+(p.evaluate||dh).source+"|$","g"),He="//# sourceURL="+(Mt.call(p,"sourceURL")?(p.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++VB+"]")+`
`;d.replace(Le,function(Xe,_t,St,qr,yr,Xr){return St||(St=qr),ve+=d.slice(Pe,Xr).replace(vB,hO),_t&&(re=!0,ve+=`' +
__e(`+_t+`) +
'`),yr&&(le=!0,ve+=`';
`+yr+`;
__p += '`),St&&(ve+=`' +
((__t = (`+St+`)) == null ? '' : __t) +
'`),Pe=Xr+Xe.length,Xe}),ve+=`';
`;var qe=Mt.call(p,"variable")&&p.variable;if(!qe)ve=`with (obj) {
`+ve+`
}
`;else if(fB.test(qe))throw new rt(s);ve=(le?ve.replace(ce,""):ve).replace(Ie,"$1").replace(ze,"$1;"),ve="function("+(qe||"obj")+`) {
`+(qe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(re?", __e = _.escape":"")+(le?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ve+`return __p
}`;var ut=iI(function(){return Rt(j,He+"return "+ve).apply(e,K)});if(ut.source=ve,h_(ut))throw ut;return ut}function F5(d){return Ot(d).toLowerCase()}function U5(d){return Ot(d).toUpperCase()}function H5(d,p,P){if(d=Ot(d),d&&(P||p===e))return d1(d);if(!d||!(p=zr(p)))return d;var C=Mn(d),N=Mn(p),j=h1(C,N),K=p1(C,N)+1;return Na(C,j,K).join("")}function j5(d,p,P){if(d=Ot(d),d&&(P||p===e))return d.slice(0,m1(d)+1);if(!d||!(p=zr(p)))return d;var C=Mn(d),N=p1(C,Mn(p))+1;return Na(C,0,N).join("")}function Y5(d,p,P){if(d=Ot(d),d&&(P||p===e))return d.replace(bl,"");if(!d||!(p=zr(p)))return d;var C=Mn(d),N=h1(C,Mn(p));return Na(C,N).join("")}function G5(d,p){var P=L,C=O;if(ai(p)){var N="separator"in p?p.separator:N;P="length"in p?lt(p.length):P,C="omission"in p?zr(p.omission):C}d=Ot(d);var j=d.length;if(Sl(d)){var K=Mn(d);j=K.length}if(P>=j)return d;var re=P-vl(C);if(re<1)return C;var le=K?Na(K,0,re).join(""):d.slice(0,re);if(N===e)return le+C;if(K&&(re+=le.length-re),p_(N)){if(d.slice(re).search(N)){var Pe,Ee=le;for(N.global||(N=wy(N.source,Ot(DS.exec(N))+"g")),N.lastIndex=0;Pe=N.exec(Ee);)var ve=Pe.index;le=le.slice(0,ve===e?re:ve)}}else if(d.indexOf(zr(N),re)!=re){var Le=le.lastIndexOf(N);Le>-1&&(le=le.slice(0,Le))}return le+C}function W5(d){return d=Ot(d),d&&si.test(d)?d.replace($e,bO):d}var z5=wl(function(d,p,P){return d+(P?" ":"")+p.toUpperCase()}),g_=rv("toUpperCase");function tI(d,p,P){return d=Ot(d),p=P?e:p,p===e?fO(d)?SO(d):sO(d):d.match(p)||[]}var iI=dt(function(d,p){try{return Gr(d,e,p)}catch(P){return h_(P)?P:new rt(P)}}),V5=Gs(function(d,p){return dn(p,function(P){P=cs(P),js(d,P,c_(d[P],d))}),d});function q5(d){var p=d==null?0:d.length,P=Ve();return d=p?ti(d,function(C){if(typeof C[1]!="function")throw new hn(n);return[P(C[0]),C[1]]}):[],dt(function(C){for(var N=-1;++N<p;){var j=d[N];if(Gr(j[0],this,C))return Gr(j[1],this,C)}})}function X5(d){return bM(fn(d,u))}function y_(d){return function(){return d}}function J5(d,p){return d==null||d!==d?p:d}var $5=sv(),K5=sv(!0);function Lr(d){return d}function __(d){return O1(typeof d=="function"?d:fn(d,u))}function Z5(d){return k1(fn(d,u))}function Q5(d,p){return F1(d,fn(p,u))}var e6=dt(function(d,p){return function(P){return cc(P,d,p)}}),t6=dt(function(d,p){return function(P){return cc(d,P,p)}});function b_(d,p,P){var C=Hi(p),N=Dh(p,C);P==null&&!(ai(p)&&(N.length||!C.length))&&(P=p,p=d,d=this,N=Dh(p,Hi(p)));var j=!(ai(P)&&"chain"in P)||!!P.chain,K=zs(d);return dn(N,function(re){var le=p[re];d[re]=le,K&&(d.prototype[re]=function(){var Pe=this.__chain__;if(j||Pe){var Ee=d(this.__wrapped__),ve=Ee.__actions__=Tr(this.__actions__);return ve.push({func:le,args:arguments,thisArg:d}),Ee.__chain__=Pe,Ee}return le.apply(d,Aa([this.value()],arguments))})}),d}function i6(){return Ui._===this&&(Ui._=TO),this}function P_(){}function r6(d){return d=lt(d),dt(function(p){return U1(p,d)})}var n6=Ky(ti),s6=Ky(a1),a6=Ky(Sy);function rI(d){return n_(d)?vy(cs(d)):MM(d)}function o6(d){return function(p){return d==null?e:vo(d,p)}}var l6=ov(),u6=ov(!0);function E_(){return[]}function S_(){return!1}function c6(){return{}}function d6(){return""}function h6(){return!0}function p6(d,p){if(d=lt(d),d<1||d>G)return[];var P=F,C=nr(d,F);p=Ve(p),d-=F;for(var N=Cy(C,p);++P<d;)p(P);return N}function f6(d){return nt(d)?ti(d,cs):Vr(d)?[d]:Tr(vv(Ot(d)))}function m6(d){var p=++CO;return Ot(d)+p}var g6=Uh(function(d,p){return d+p},0),y6=Zy("ceil"),_6=Uh(function(d,p){return d/p},1),b6=Zy("floor");function P6(d){return d&&d.length?Nh(d,Lr,ky):e}function E6(d,p){return d&&d.length?Nh(d,Ve(p,2),ky):e}function S6(d){return u1(d,Lr)}function v6(d,p){return u1(d,Ve(p,2))}function I6(d){return d&&d.length?Nh(d,Lr,jy):e}function A6(d,p){return d&&d.length?Nh(d,Ve(p,2),jy):e}var C6=Uh(function(d,p){return d*p},1),x6=Zy("round"),T6=Uh(function(d,p){return d-p},0);function w6(d){return d&&d.length?Ay(d,Lr):0}function R6(d,p){return d&&d.length?Ay(d,Ve(p,2)):0}return U.after=Zk,U.ary=Bv,U.assign=U4,U.assignIn=Xv,U.assignInWith=Zh,U.assignWith=H4,U.at=j4,U.before=Ov,U.bind=c_,U.bindAll=V5,U.bindKey=Mv,U.castArray=c4,U.chain=Lv,U.chunk=b3,U.compact=P3,U.concat=E3,U.cond=q5,U.conforms=X5,U.constant=y_,U.countBy=wk,U.create=Y4,U.curry=kv,U.curryRight=Fv,U.debounce=Uv,U.defaults=G4,U.defaultsDeep=W4,U.defer=Qk,U.delay=e4,U.difference=S3,U.differenceBy=v3,U.differenceWith=I3,U.drop=A3,U.dropRight=C3,U.dropRightWhile=x3,U.dropWhile=T3,U.fill=w3,U.filter=Lk,U.flatMap=Bk,U.flatMapDeep=Ok,U.flatMapDepth=Mk,U.flatten=xv,U.flattenDeep=R3,U.flattenDepth=L3,U.flip=t4,U.flow=$5,U.flowRight=K5,U.fromPairs=N3,U.functions=K4,U.functionsIn=Z4,U.groupBy=kk,U.initial=B3,U.intersection=O3,U.intersectionBy=M3,U.intersectionWith=k3,U.invert=e5,U.invertBy=t5,U.invokeMap=Uk,U.iteratee=__,U.keyBy=Hk,U.keys=Hi,U.keysIn=Rr,U.map=Vh,U.mapKeys=r5,U.mapValues=n5,U.matches=Z5,U.matchesProperty=Q5,U.memoize=Xh,U.merge=s5,U.mergeWith=Jv,U.method=e6,U.methodOf=t6,U.mixin=b_,U.negate=Jh,U.nthArg=r6,U.omit=a5,U.omitBy=o5,U.once=i4,U.orderBy=jk,U.over=n6,U.overArgs=r4,U.overEvery=s6,U.overSome=a6,U.partial=d_,U.partialRight=Hv,U.partition=Yk,U.pick=l5,U.pickBy=$v,U.property=rI,U.propertyOf=o6,U.pull=j3,U.pullAll=wv,U.pullAllBy=Y3,U.pullAllWith=G3,U.pullAt=W3,U.range=l6,U.rangeRight=u6,U.rearg=n4,U.reject=zk,U.remove=z3,U.rest=s4,U.reverse=l_,U.sampleSize=qk,U.set=c5,U.setWith=d5,U.shuffle=Xk,U.slice=V3,U.sortBy=Kk,U.sortedUniq=Q3,U.sortedUniqBy=ek,U.split=B5,U.spread=a4,U.tail=tk,U.take=ik,U.takeRight=rk,U.takeRightWhile=nk,U.takeWhile=sk,U.tap=Pk,U.throttle=o4,U.thru=zh,U.toArray=zv,U.toPairs=Kv,U.toPairsIn=Zv,U.toPath=f6,U.toPlainObject=qv,U.transform=h5,U.unary=l4,U.union=ak,U.unionBy=ok,U.unionWith=lk,U.uniq=uk,U.uniqBy=ck,U.uniqWith=dk,U.unset=p5,U.unzip=u_,U.unzipWith=Rv,U.update=f5,U.updateWith=m5,U.values=Nl,U.valuesIn=g5,U.without=hk,U.words=tI,U.wrap=u4,U.xor=pk,U.xorBy=fk,U.xorWith=mk,U.zip=gk,U.zipObject=yk,U.zipObjectDeep=_k,U.zipWith=bk,U.entries=Kv,U.entriesIn=Zv,U.extend=Xv,U.extendWith=Zh,b_(U,U),U.add=g6,U.attempt=iI,U.camelCase=P5,U.capitalize=Qv,U.ceil=y6,U.clamp=y5,U.clone=d4,U.cloneDeep=p4,U.cloneDeepWith=f4,U.cloneWith=h4,U.conformsTo=m4,U.deburr=eI,U.defaultTo=J5,U.divide=_6,U.endsWith=E5,U.eq=Fn,U.escape=S5,U.escapeRegExp=v5,U.every=Rk,U.find=Nk,U.findIndex=Av,U.findKey=z4,U.findLast=Dk,U.findLastIndex=Cv,U.findLastKey=V4,U.floor=b6,U.forEach=Nv,U.forEachRight=Dv,U.forIn=q4,U.forInRight=X4,U.forOwn=J4,U.forOwnRight=$4,U.get=f_,U.gt=g4,U.gte=y4,U.has=Q4,U.hasIn=m_,U.head=Tv,U.identity=Lr,U.includes=Fk,U.indexOf=D3,U.inRange=_5,U.invoke=i5,U.isArguments=Co,U.isArray=nt,U.isArrayBuffer=_4,U.isArrayLike=wr,U.isArrayLikeObject=yi,U.isBoolean=b4,U.isBuffer=Da,U.isDate=P4,U.isElement=E4,U.isEmpty=S4,U.isEqual=v4,U.isEqualWith=I4,U.isError=h_,U.isFinite=A4,U.isFunction=zs,U.isInteger=jv,U.isLength=$h,U.isMap=Yv,U.isMatch=C4,U.isMatchWith=x4,U.isNaN=T4,U.isNative=w4,U.isNil=L4,U.isNull=R4,U.isNumber=Gv,U.isObject=ai,U.isObjectLike=pi,U.isPlainObject=gc,U.isRegExp=p_,U.isSafeInteger=N4,U.isSet=Wv,U.isString=Kh,U.isSymbol=Vr,U.isTypedArray=Ll,U.isUndefined=D4,U.isWeakMap=B4,U.isWeakSet=O4,U.join=F3,U.kebabCase=I5,U.last=gn,U.lastIndexOf=U3,U.lowerCase=A5,U.lowerFirst=C5,U.lt=M4,U.lte=k4,U.max=P6,U.maxBy=E6,U.mean=S6,U.meanBy=v6,U.min=I6,U.minBy=A6,U.stubArray=E_,U.stubFalse=S_,U.stubObject=c6,U.stubString=d6,U.stubTrue=h6,U.multiply=C6,U.nth=H3,U.noConflict=i6,U.noop=P_,U.now=qh,U.pad=x5,U.padEnd=T5,U.padStart=w5,U.parseInt=R5,U.random=b5,U.reduce=Gk,U.reduceRight=Wk,U.repeat=L5,U.replace=N5,U.result=u5,U.round=x6,U.runInContext=ae,U.sample=Vk,U.size=Jk,U.snakeCase=D5,U.some=$k,U.sortedIndex=q3,U.sortedIndexBy=X3,U.sortedIndexOf=J3,U.sortedLastIndex=$3,U.sortedLastIndexBy=K3,U.sortedLastIndexOf=Z3,U.startCase=O5,U.startsWith=M5,U.subtract=T6,U.sum=w6,U.sumBy=R6,U.template=k5,U.times=p6,U.toFinite=Vs,U.toInteger=lt,U.toLength=Vv,U.toLower=F5,U.toNumber=yn,U.toSafeInteger=F4,U.toString=Ot,U.toUpper=U5,U.trim=H5,U.trimEnd=j5,U.trimStart=Y5,U.truncate=G5,U.unescape=W5,U.uniqueId=m6,U.upperCase=z5,U.upperFirst=g_,U.each=Nv,U.eachRight=Dv,U.first=Tv,b_(U,(function(){var d={};return ls(U,function(p,P){Mt.call(U.prototype,P)||(d[P]=p)}),d})(),{chain:!1}),U.VERSION=t,dn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(d){U[d].placeholder=U}),dn(["drop","take"],function(d,p){bt.prototype[d]=function(P){P=P===e?1:Ni(lt(P),0);var C=this.__filtered__&&!p?new bt(this):this.clone();return C.__filtered__?C.__takeCount__=nr(P,C.__takeCount__):C.__views__.push({size:nr(P,F),type:d+(C.__dir__<0?"Right":"")}),C},bt.prototype[d+"Right"]=function(P){return this.reverse()[d](P).reverse()}}),dn(["filter","map","takeWhile"],function(d,p){var P=p+1,C=P==ee||P==Q;bt.prototype[d]=function(N){var j=this.clone();return j.__iteratees__.push({iteratee:Ve(N,3),type:P}),j.__filtered__=j.__filtered__||C,j}}),dn(["head","last"],function(d,p){var P="take"+(p?"Right":"");bt.prototype[d]=function(){return this[P](1).value()[0]}}),dn(["initial","tail"],function(d,p){var P="drop"+(p?"":"Right");bt.prototype[d]=function(){return this.__filtered__?new bt(this):this[P](1)}}),bt.prototype.compact=function(){return this.filter(Lr)},bt.prototype.find=function(d){return this.filter(d).head()},bt.prototype.findLast=function(d){return this.reverse().find(d)},bt.prototype.invokeMap=dt(function(d,p){return typeof d=="function"?new bt(this):this.map(function(P){return cc(P,d,p)})}),bt.prototype.reject=function(d){return this.filter(Jh(Ve(d)))},bt.prototype.slice=function(d,p){d=lt(d);var P=this;return P.__filtered__&&(d>0||p<0)?new bt(P):(d<0?P=P.takeRight(-d):d&&(P=P.drop(d)),p!==e&&(p=lt(p),P=p<0?P.dropRight(-p):P.take(p-d)),P)},bt.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},bt.prototype.toArray=function(){return this.take(F)},ls(bt.prototype,function(d,p){var P=/^(?:filter|find|map|reject)|While$/.test(p),C=/^(?:head|last)$/.test(p),N=U[C?"take"+(p=="last"?"Right":""):p],j=C||/^find/.test(p);N&&(U.prototype[p]=function(){var K=this.__wrapped__,re=C?[1]:arguments,le=K instanceof bt,Pe=re[0],Ee=le||nt(K),ve=function(_t){var St=N.apply(U,Aa([_t],re));return C&&Le?St[0]:St};Ee&&P&&typeof Pe=="function"&&Pe.length!=1&&(le=Ee=!1);var Le=this.__chain__,He=!!this.__actions__.length,qe=j&&!Le,ut=le&&!He;if(!j&&Ee){K=ut?K:new bt(this);var Xe=d.apply(K,re);return Xe.__actions__.push({func:zh,args:[ve],thisArg:e}),new pn(Xe,Le)}return qe&&ut?d.apply(this,re):(Xe=this.thru(ve),qe?C?Xe.value()[0]:Xe.value():Xe)})}),dn(["pop","push","shift","sort","splice","unshift"],function(d){var p=yh[d],P=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",C=/^(?:pop|shift)$/.test(d);U.prototype[d]=function(){var N=arguments;if(C&&!this.__chain__){var j=this.value();return p.apply(nt(j)?j:[],N)}return this[P](function(K){return p.apply(nt(K)?K:[],N)})}}),ls(bt.prototype,function(d,p){var P=U[p];if(P){var C=P.name+"";Mt.call(Cl,C)||(Cl[C]=[]),Cl[C].push({name:p,func:P})}}),Cl[Fh(e,y).name]=[{name:"wrapper",func:e}],bt.prototype.clone=WO,bt.prototype.reverse=zO,bt.prototype.value=VO,U.prototype.at=Ek,U.prototype.chain=Sk,U.prototype.commit=vk,U.prototype.next=Ik,U.prototype.plant=Ck,U.prototype.reverse=xk,U.prototype.toJSON=U.prototype.valueOf=U.prototype.value=Tk,U.prototype.first=U.prototype.head,rc&&(U.prototype[rc]=Ak),U}),xa=vO();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Ui._=xa,define(function(){return xa})):_o?((_o.exports=xa)._=xa,_y._=xa):Ui._=xa}).call(ec)});var z_=Hn(A_()),Xs=Hn(W_());var _={editorCurrentVersion:void 0,editorCompliedDate:void 0,indexedDBVersion:6,extensionIndexedDBUtils:void 0,isExtensionsInitialized:!1,loadedExtensions:[],extensionCheckUpdateStatus:{},loadedExtensionsIsAllowExternalInteractions:{eda:!0},isDisableAllExtensionsGlobal:!1,extensionUserConfigs:{},currentLanguage:void 0,multilingualNamespaces:{eda:{}},extensionPCB_Events:[],extensionPCB_ManufactureDataAutoRouteRule:void 0,extensionSCH_Events:[],extension_SYS_I18nEvents:[],extensionSYS_MessageBus:{public:{}},extensionSYS_Timers:[],extensionSYS_WebSocketConnections:[],extensionLIB_RegisteredExtendLibraries:{},extensionRegisteredHeaderMenus:{home:[],blank:[],sch:[],symbol:[],pcb:[],footprint:[],pcbView:[],panel:[],panelView:[]},extensionActivationEventListOnCommands:{},extensionActivationEventListOnLanguages:{},extensionActivationEventListOnProjectOpened:[],extensionActivationEventListOnEditorSchematic:[],extensionActivationEventListOnEditorSymbol:[],extensionActivationEventListOnEditorPcb:[],extensionActivationEventListOnEditorFootprint:[],extensionActivationEventListOnEditorPanel:[],extensionActivationEventListOnLibraryManagerOpened:[],extensionActivationEventListOnStartupFinished:[],extensionActivationEventListOnLogged:[],extensionActivationEventListOnChangeAllowExternalInteractions:{on:[],off:[]},messageBus:void 0,pcbMessageBus:void 0,windowMessageBridge:void 0,extensionApiMessageBus2:void 0,extensionApiBroadcastChannelMessageBus:void 0,chameleonBroadcastChannelMessageBus:void 0,globalVariableUserInfo:{}};var xe=class{static checkNum(t){return/^-?[0-9]*.?[0-9]*$/.test(t)&&!isNaN(Number(t))}static checkNull(t){return t===null}static checkString(t){return typeof t=="string"}static checkIntegerNum(t){return!isNaN(t)&&t%1===0}static checkArray(t){return Array.isArray(t)}static checkBoolean(t){return typeof t=="boolean"}static checkObject(t){return t!==null&&typeof t=="object"}};function wo(){var e;return((e=_.globalVariableUserInfo)==null?void 0:e.uuid)===void 0?!1:!!Ic(_.globalVariableUserInfo.uuid,!1,!1)}var To;function V_(e){if(To)return BU(To,String(e))?To[e]:null;try{return localStorage.getItem(e)}catch{return null}}function q_(e,t){if(To){To[e]=String(t);return}try{localStorage.setItem(e,t)}catch{To={},To[e]=String(t)}}function tC(e,t=!1){let i=/^[a-z0-9-]+$/g;return t?e.trim().match(i)||!1:i.test(e.trim())}function Ic(e,t=!1,i){let r;return typeof i>"u"?r=/^[a-z0-9]{32}$|^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$/g:i?r=/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$/g:r=/^[a-z0-9]{32}$/g,t?e.trim().match(r)||!1:r.test(e.trim())}function iC(e){return Xs.valid(e)!==null}function rC(e){return Xs.validRange(e)!==null}var bee=DU(/\s+/g);function DU(e){return(t,i)=>{let r=!Object.is(i,void 0);return t?r?t.replace(e,i):e.test(t):r?"":!1}}function hs(e,t){return t.indexOf(e)!==-1}function nC(e){let t=e.split(/[\r\n]+/);return t.forEach((i,r)=>{i||t.splice(r,1)}),Array.from(new Set(t))}function BU(e,t){return Object.hasOwn(e,t)}function OU(e,t){return(0,z_.default)((0,z_.default)(e)+t)}function Ol(e=""){return OU(Date.now()+t(!0,3,32),e).substring(8,16);function t(i,r,n){r=r||1,n=n||32;let s="",a=r,o=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];i&&(a=Math.round(Math.random()*(n-r))+r);for(let l=0;l<a;l++){let u=Math.round(Math.random()*(o.length-1));s+=o[u]}return s}}function Ro(e){return e=e.replaceAll("\\","/"),e.startsWith("./")&&(e=e.substring(2)),e.startsWith("/")&&(e=e.substring(1)),e}function Ml(e=""){return e=Ro(e),(!e||e==="")&&(e="index.js"),e.endsWith(".js")||(e+=".js"),e}function X_(e,t){for(let i in t)e[i]&&typeof e[i]=="object"&&typeof t[i]=="object"&&Object.prototype.toString.call(e[i])==="[object Object]"&&Object.prototype.toString.call(t[i])==="[object Object]"?e[i]=X_(e[i],t[i]):e[i]=t[i];return e}function J_(e,t){let i={...e};for(let r in t)if(t.hasOwnProperty(r)){let n=e[r],s=t[r];xe.checkObject(n)&&xe.checkObject(s)&&!Array.isArray(n)&&!Array.isArray(s)?i[r]=J_(n,s):i[r]=s}return i}function ps(e){return e<0?e%360+360:e%360}function sC(e,t,i){return e<t?e=t:e>i&&(e=i),e}function Js(e,t,i=!0){if(typeof e!="number"&&(e=Number(e)),isNaN(e))return NaN;if(t=t|0,t<=0||!e&&!i)return Math.round(e);let n=[1,10,100,1e3][t]||Math.pow(10,t)||10;if(i){let s=e<0?"-":"";for(e=e<0?-e:e,e=String(Math.round(e*n));e.length<=t;)e="0"+e;return e=e.slice(0,-t)+"."+e.slice(-t),Number(s+e)}else return Math.round(e*n+1e-10)/n}function aC(e=new Date,t="yyyy-MM-dd HH:ii:ss"){let i={"M+":e.getMonth()+1,"d+":e.getDate(),"H+":e.getHours(),"h+":e.getHours(),"i+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,String(e.getFullYear()).substr(4-RegExp.$1.length)));for(let r in i)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,RegExp.$1.length===1?i[r]:("00"+i[r]).substr(String(i[r]).length)));return t}function $_(e=""){let t=new Date;return t.getFullYear().toString()+e+(t.getMonth()+1).toString()+e+t.getDate().toString()}function Ac(e,t,i=!1,r=!1){if(e&&e!==""){let n=e.split(/[\.\|\ \#\@]/g);if(n.length===1&&t&&t!=="")return{id:n[0],extensionUuid:t};if(n.length===2)return{id:n[1],extensionUuid:t&&t!==""&&i?t:n[0]};if(n.length===1&&r)return{id:n[0],extensionUuid:""}}if(r)return{id:Ol(),extensionUuid:t||""}}function Cc(e,t="."){let i=Ac(e.fullIdStr,e.extensionUuid,e.forceExtensionUuid,e.forceNeedReturns);if(i)return i.extensionUuid===""?i.id:i.extensionUuid+t+i.id}function xc(e){return _.editorCurrentVersion||(()=>{let t=document.getElementsByTagName("meta").editorMainVersion.content;if(e){let i=t.split(".");i.length>3&&(i.length=3),_.editorCurrentVersion=i.join(".")}else _.editorCurrentVersion=t;return _.editorCurrentVersion})()}function fs(){let e=xc().split(".");return e[0]==="dev"||e[0]==="3"}function oC(){return _.editorCompliedDate||(_.editorCompliedDate=document.getElementsByTagName("meta").editorMainDate.content,_.editorCompliedDate)}function dp(e){return new URLSearchParams(new URL(window.location.href).search).get(e)}async function K_(e,t){if(typeof t=="object"){e+="?";let r=[];for(let n of Object.keys(t))r.push(n+"="+encodeURIComponent(t[n]));e+=r.join("&")}let i={method:"GET",cache:"no-cache",redirect:"follow",priority:"low"};try{let r=await fetch(e,i);return r.ok?await r.text():void 0}catch{return}}function lC(e,t){let i=e.split(/[\.\-]/),r=t.split(/[\.\-]/);for(let[n,s]of i.entries()){if(r.length-1<n)return!1;if(Number(r[n])>Number(s))return!0;if((Number.isNaN(Number(r[n]))||Number.isNaN(Number(s)))&&r[n]!==s)return!0;if(Number(r[n])<Number(s))return!1;if(n===i.length-1&&r.length-1>n)return!0}return!1}function uC(e){return new Promise(t=>{let i=new FileReader;i.onload=r=>{var n;t(((n=r.target)==null?void 0:n.result)||"")},i.readAsDataURL(e)})}var hp=class{async createBoard(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Board.createBoard",{schematicUuid:t,pcbUuid:i})}async modifyBoardName(t,i){return typeof await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Board.modifyBoardName",{rawName:t,value:i})=="string"}async copyBoard(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Board.copyBoard",t)}async getBoardInfo(t){return(await this.getAllBoardsInfo()).find(r=>r.name===t)}async getAllBoardsInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Board.getAllBoardsInfo")}async getCurrentBoardInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Board.getCurrentBoardInfo")}async deleteBoard(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Board.deleteBoard",t)}};var Z_=(i=>(i.HORIZONTAL="horizontal",i.VERTICAL="vertical",i))(Z_||{}),Q_=(s=>(s.POINT="point",s.CIRCLE="circle",s.LINE="line",s.ARC="arc",s.RECTANGLE="rectangle",s))(Q_||{}),pp=class{async openDocument(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.openDocument",{documentUuid:t,splitScreenId:i})}async openLibraryDocument(t,i,r,n){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.openLibraryDocument",{libraryUuid:t,libraryType:i,uuid:r,splitScreenId:n})}async closeDocument(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.closeDocument",t)}async getSplitScreenTree(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.getSplitScreenTree")}async getSplitScreenIdByTabId(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.getSplitScreenIdByTabId",t)}async getTabsBySplitScreenId(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.getTabsBySplitScreenId",t)}async createSplitScreen(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.createSplitScreen",{splitScreenType:t,tabId:i})}async moveDocumentToSplitScreen(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.moveDocumentToSplitScreen",{documentUuid:t,splitScreenId:i})}async activateDocument(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.activateDocument",t)}async activateSplitScreen(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.activateSplitScreen",t)}async tileAllDocumentToSplitScreen(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.tileAllDocumentToSplitScreen")}async mergeAllDocumentFromSplitScreen(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.mergeAllDocumentFromSplitScreen")}async getCurrentRenderedAreaImage(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.getCurrentRenderedAreaImage",t)}async zoomToRegion(t,i,r,n,s){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.zoomToRegion",{left:t,right:i,top:r,bottom:n,tabId:s})}async zoomTo(t,i,r,n){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.zoomTo",{x:t,y:i,scaleRatio:r,tabId:n})}async zoomToAllPrimitives(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.zoomToAllPrimitives",t)}async zoomToSelectedPrimitives(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.zoomToSelectedPrimitives",t)}async generateIndicatorMarkers(t,i,r,n,s){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.generateIndicatorMarkers",{markers:t,color:i,lineWidth:r,zoom:n,tabId:s})}async removeIndicatorMarkers(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_EditorControl.removeIndicatorMarkers",t)}};var fp=class{async createFolder(t,i,r,n){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Folder.createFolder",{folderName:t,teamUuid:i,parentFolderUuid:r,description:n})}async modifyFolderName(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Folder.modifyFolderName",{folderName:r,teamUuid:t,folderUuid:i})}async modifyFolderDescription(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Folder.modifyFolderDescription",{description:r,teamUuid:t,folderUuid:i})}async moveFolderToFolder(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Folder.moveFolderToFolder",{teamUuid:t,folderUuid:i,parentFolderUuid:r})}async getAllFoldersUuid(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Folder.getAllFoldersUuid",t)}async getFolderInfo(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Folder.getFolderInfo",{folderUuid:i,teamUuid:t})}async deleteFolder(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Folder.deleteFolder",{folderUuid:i,teamUuid:t})}};var mp=class{async createPanel(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Panel.createPanel")}async modifyPanelName(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Panel.modifyPanelName",{panelUuid:t,value:i})}async copyPanel(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Panel.copyPanel",t)}async getPanelInfo(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Panel.getPanelInfo",t)}async getAllPanelsInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Panel.getAllPanelsInfo")}async getCurrentPanelInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Panel.getCurrentPanelInfo")}async deletePanel(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Panel.deletePanel",t)}};var gp=class{async createPcb(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Pcb.createPcb",t)}async modifyPcbName(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Pcb.modifyPcbName",{pcbUuid:t,value:i})}async copyPcb(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Pcb.copyPcb",{pcbUuid:t,boardName:i})}async getPcbInfo(t){return(await this.getAllPcbsInfo()).find(r=>r.uuid===t)}async getAllPcbsInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Pcb.getAllPcbsInfo")}async getCurrentPcbInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Pcb.getCurrentPcbInfo")}async deletePcb(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Pcb.deletePcb",t)}};var MU=Object.create,Zb=Object.defineProperty,kU=Object.getOwnPropertyDescriptor,FU=Object.getOwnPropertyNames,UU=Object.getPrototypeOf,HU=Object.prototype.hasOwnProperty,kl=(e=>typeof ar<"u"?ar:typeof Proxy<"u"?new Proxy(e,{get:(t,i)=>(typeof ar<"u"?ar:t)[i]}):e)(function(e){if(typeof ar<"u")return ar.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),jU=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),YU=(e,t)=>{for(var i in t)Zb(e,i,{get:t[i],enumerable:!0})},GU=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of FU(t))!HU.call(e,n)&&n!==i&&Zb(e,n,{get:()=>t[n],enumerable:!(r=kU(t,n))||r.enumerable});return e},rd=(e,t,i)=>(i=e!=null?MU(UU(e)):{},GU(t||!e||!e.__esModule?Zb(i,"default",{value:e,enumerable:!0}):i,e)),nd=jU((e,t)=>{"use strict";var i=Object.defineProperty,r=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,a=(I,w)=>{for(var B in w)i(I,B,{get:w[B],enumerable:!0})},o=(I,w,B,M)=>{if(w&&typeof w=="object"||typeof w=="function")for(let V of n(w))!s.call(I,V)&&V!==B&&i(I,V,{get:()=>w[V],enumerable:!(M=r(w,V))||M.enumerable});return I},l=I=>o(i({},"__esModule",{value:!0}),I),u={};a(u,{BroadcastChannelMessageBus:()=>Ri,MessageBus:()=>Ue,MessageBus2:()=>it,MessageBusTask:()=>Fe,MessageBusTask2:()=>tt,WindowMessageBridge:()=>we,WorkerMessageBridge:()=>Ce,createBroadcastP2PStream:()=>xr,createBufferedByteBufferStream:()=>ln,createBufferedStream:()=>hi,createBufferedStringStream:()=>Ei,dropP2PStream:()=>Xi,flowRead:()=>ss,flowWrite:()=>ks}),t.exports=l(u);var c=class{constructor(I=1.5){this.growthFactor=I,this.capacity=10,this.buffer=new Array(this.capacity),this.head=0,this.tail=0,this.count=0}enqueue(I){if(this.count===this.capacity){let w=Math.floor(this.capacity*this.growthFactor);console.log("grow",this.capacity,w);let B=new Array(w);for(let M=0;M<this.count;M++)B[M]=this.buffer[(this.head+M)%this.capacity];this.buffer=B,this.head=0,this.tail=this.count,this.capacity=w}this.buffer[this.tail]=I,this.tail=(this.tail+1)%this.capacity,this.count++}dequeue(){if(this.isEmpty())return;let I=this.buffer[this.head];return this.head=(this.head+1)%this.capacity,this.count--,I}peek(){return this.buffer[this.head]}isEmpty(){return this.count===0}clear(){this.buffer.length=0,this.head=0,this.tail=0,this.count=0}},h=new ArrayBuffer(8),m=new Float64Array(h),f=new Uint32Array(h),g=new Uint16Array(h),y=ArrayBuffer;try{y=self.HTMLImageElement||y}catch{}var b=typeof SharedArrayBuffer<"u";function E(I){if(typeof I!="object"||I===null||I instanceof Date||I instanceof ArrayBuffer||b&&I instanceof SharedArrayBuffer||I instanceof Blob||I instanceof FormData||I instanceof Function||I instanceof Uint8ClampedArray||I instanceof y)return I;if(Array.isArray(I))return I.map(E);{let w={};for(let B in I)Object.hasOwnProperty.call(I,B)&&(w[B]=E(I[B]));return w}}function S(I,w){return v(I,w,()=>[])}function v(I,w,B){let M=I[w];return M!==void 0||(M=B(w),I[w]=M),M}function A(I,w){if(Array.isArray(I)){for(let B=0,M=I.length;B<M;B++)if(w(void 0,I[B],B)===!1)return}else{let B=0;for(let M in I)if(I.hasOwnProperty(M)){let V=I[M];if(w(M,V,B)===!1)return;B++}}}var x=Object.prototype.hasOwnProperty;async function T(I,w){if(Array.isArray(I)){for(let B=0,M=I.length;B<M;B++)if(await w(void 0,I[B],B)===!1)return}else{let B=0;for(let M in I)if(x.call(I,M)){let V=I[M];if(await w(M,V,B)===!1)return;B++}}}function R(I,w,B){return typeof I=="string"&&(/https?:/.test(I)||(I=location.origin+I)),Promise.race([fetch(I,w),new Promise((M,V)=>setTimeout(V,B))])}function L(I,w){let B=0,M=0;return(...V)=>{let oe=++B;setTimeout(()=>{let ce=performance.now();if(oe===B||ce-M>=I){try{w(...V)}catch(Ie){console.log(Ie)}M=ce}},Math.max(0,I-(performance.now()-M)))}}function O(I,w){let B=I.length,M=0;for(;M<B;){let V=I.indexOf(`
`,M);V<0&&(V=B);let oe=I.substring(M,V);try{if(w(oe)===!1)return}catch(ce){console.error(ce)}M=V+1}}function H(I){let w=null;return()=>(w===null&&(w=I()),w)}var k=0;function ee(){k===0&&(k=Date.now()-performance.now());let I=new Array,w=k+performance.now();m[0]=w,I.push(f[1].toString(16)),m[0]=Math.random(),I.push(g[3].toString(16));let B=g[2].toString(16);I.push("4"+B.substr(0,3)),m[0]=w;let M=f[0].toString(16)+f[1].toString(16);return I.push("0"+M.substr(0,3)),I.push(M.substr(3)),I.join("-")}var q=class{constructor(I){this.maxResources=I,this.idle=new c,this.isClosed=!1,this.resources=I}acquire(I){this.isClosed?Promise.resolve(!1).then(I):this.resources>0?(this.resources--,Promise.resolve(!0).then(I)):this.idle.enqueue(I)}acquireSync(){return new Promise(I=>{this.acquire(I)})}release(){if(!this.isClosed){let I=this.idle.dequeue();I?Promise.resolve(!0).then(I):this.resources++}}close(){if(!this.isClosed)for(this.isClosed=!0;!this.idle.isEmpty();){let I=this.idle.dequeue();Promise.resolve(!1).then(I)}}};function Q(){if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global}function ne(I,w,B){let M=I.length+w-1;for(let V=0;V<M;V++){let oe=new Array;for(let ce=V-w+1;ce<=V;ce++)oe.push(I[ce]);if(B(oe)===!1)break}}function G(){let I=new Date,w=I.getFullYear(),B=I.getMonth()+1,M=I.getDate(),V=I.getHours(),oe=I.getMinutes(),ce=I.getSeconds(),Ie=I.getMilliseconds();return"["+w+"-"+(B<10?"0"+B:B)+"-"+(M<10?"0"+M:M)+" "+(V<10?"0"+V:V)+":"+(oe<10?"0"+oe:oe)+":"+(ce<10?"0"+ce:ce)+"."+(Ie<100?Ie<10?"00"+Ie:"0"+Ie:Ie)+"] "}function X(I){return new Promise(w=>setTimeout(w,I))}function D(I,w){let B=0,M=I.length;for(let V=0;V<M;V++)I[V]===w&&(I.splice(V,1),V--,M--,B++);return B}var F=Q(),W=F.WeakRef||(I=>I);function z(I){if(I!=null){if(typeof I=="object")return new W(I);console.error(I,I instanceof Object,typeof I);return}}function $(I){return I==null?void 0:I.deref()}var te="_MSG_BUS_RPC_",Z=300*1e3,pe=(I=>(I.PUBLISH="publish",I.SUBSCRIBE="subscribe",I.PUSH="push",I.PULL="pull",I))(pe||{}),Se=class{constructor(I){this.bus=I}processRemoteMessage(I,w){let B=z(w),M=I.topic,V=I.type,oe=I.message;switch(V){case"pull":this.bus.pull(M,ce=>{this.push(M,ce,$(B))});break;case"subscribe":this.bus.subscribe(M,ce=>{this.publish(M,ce,$(B))});break;case"publish":this.bus.publish(M,oe,this,$(B));break;case"push":this.bus.push(M,oe,this,$(B));break;default:console.debug("unknown message type "+V)}}rpcCall(I,w,B,M=Z){let V=z(B),oe=new Promise(ce=>{let Ie=this.bus.uniqueRpcTopic(I);this.publish(I,{message:w,reply:Ie},$(V)),this.bus.pull(Ie,(ze,$e,xt)=>{ce({message:ze,bridge:$e,source:z(xt)})})});return M>0?Promise.race([oe,new Promise((ce,Ie)=>{setTimeout(Ie,M)})]):oe}},Ce=class extends Se{constructor(I,w){super(I),this.worker=w,w.onmessage=B=>{this.processRemoteMessage(B.data,void 0)}}publish(I,w){this.postMessage(I,"publish",w)}subscribe(I){this.postMessage(I,"subscribe",null)}push(I,w){this.postMessage(I,"push",w)}pull(I){this.postMessage(I,"pull",null)}rpcCall(I,w,B=Z){return super.rpcCall(I,w,void 0,B)}postMessage(I,w,B){let M={topic:I,type:w,message:B};this.worker.postMessage(M)}discard(){this.worker.terminate()}},we=class extends Se{constructor(I){super(I),window.addEventListener("message",w=>{this.processRemoteMessage(w.data,w.source)},!1)}publish(I,w,B){this.postMessage(I,"publish",w,B)}subscribe(I,w){if(w===window)throw new Error("regist remote subscribe from current window is not permitted");this.postMessage(I,"subscribe",null,w)}push(I,w,B){this.postMessage(I,"push",w,B)}pull(I,w){if(w===window)throw new Error("regist remote pull from current window is not permitted");this.postMessage(I,"pull",null,w)}postMessage(I,w,B,M){let V={topic:I,type:w,message:B};M&&M.postMessage(V,"*")}},Fe=class{constructor(I){this.isRunning=!0,this.callback=I}cancel(){this.callback=null,this.isRunning=!1}running(){return this.isRunning}execute(I,w,B,M){try{I=M?I:E(I),this.callback(I,w,B)}catch(V){console.error(V)}}},Ue=class{constructor(I=!1){this.subscribed={},this.pulled={},this.pushed={},this.uuid=crypto.randomUUID().replace(/-/g,""),this.rpcTicket=0,this.unsafe=I}uniqueRpcTopic(I){return`${te}-${I}-${this.uuid}-${this.rpcTicket++}`}publish(I,w,B,M){let V=this.subscribed[I];if(V){let oe;for(let ce of V)ce.running()?ce.execute(w,B,M,this.unsafe):(oe=oe||new Array,oe.push(ce));if(oe)for(let ce of oe)D(V,ce)}else console.debug("no sub on topic: "+I)}subscribe(I,w){let B=new Fe(w);return S(this.subscribed,I).push(B),B}push(I,w,B,M){let V=!1,oe=this.pulled[I];if(oe){for(;oe.length>0;){let ce=oe.shift();if(ce.running()){ce.execute(w,B,M,this.unsafe),V=!0;break}}oe.length===0&&delete this.pulled[I]}V||S(this.pushed,I).push({message:w,bridge:B,source:z(M)})}pull(I,w){let B=new Fe(w),M=this.pushed[I];if(M){let V=M.shift();B.execute(V.message,V.bridge,$(V.source),this.unsafe),M.length===0&&delete this.pushed[I]}else S(this.pulled,I).push(B);return B}pullA(I){return new Promise(w=>{this.pull(I,(B,M,V)=>{w({message:B,bridge:M,source:z(V)})})})}rpcService(I,w){this.subscribe(I,(B,M,V)=>{let{message:oe,reply:ce}=B;try{let Ie=w(oe);if(Ie instanceof Promise){let ze=z(V);Ie.then($e=>{this.rpcReply($e,ce,M,$(ze))},$e=>{console.error($e),this.rpcReply(void 0,ce,M,$(ze))})}else this.rpcReply(Ie,ce,M,V)}catch(Ie){console.error(Ie),this.rpcReply(void 0,ce,M,V)}})}rpcCall(I,w,B=Z){let M=new Promise(V=>{let oe=this.uniqueRpcTopic(I);this.publish(I,{message:w,reply:oe}),this.pull(oe,(ce,Ie,ze)=>{V({message:ce,bridge:Ie,source:z(ze)})})});return B>0?Promise.race([M,new Promise((V,oe)=>{setTimeout(oe,B)})]):M}rpcReply(I,w,B,M){B?B.push(w,I,M):this.push(w,I)}},je="_MSG_BUS_RPC_";function me(I,w){let B=0,M=I.length;for(let V=0;V<M;V++)I[V]===w&&(I.splice(V,1),V--,M--,B++);return B}function Ae(I,w){return We(I,w,()=>[])}function We(I,w,B){let M=I[w];return M!==void 0||(M=B(w),I[w]=M),M}var tt=class{constructor(I,w){this.callback=I,this.unsafe=w,this.isRunning=!0}cancel(){this.callback=null,this.isRunning=!1}running(){return this.isRunning}async execute(I){try{I=this.unsafe?I:E(I),this.callback(I)}catch(w){console.error(w)}}},Ct=class{constructor(I=crypto.randomUUID()){this.uuid=I,this.rpcTicket=0}subscribeOnce(I,w){let B=this.subscribe(I,M=>{B.cancel(),w(M)});return B}pullA(I){return new Promise(w=>{this.pull(I,w)})}rpcService(I,w){let B=M=>{try{let{message:V,replyTopic:oe}=M;try{let ce=w(V);ce instanceof Promise?ce.then(Ie=>{this.publish(oe,{success:!0,result:Ie})}).catch(Ie=>{console.error(Ie),this.publish(oe,{success:!1,err:String(Ie)})}):this.publish(oe,{success:!0,result:ce})}catch(ce){this.publish(oe,{success:!1,err:String(ce)})}}finally{this.pull(I,B)}};this.pull(I,B)}rpcCall(I,w,B=0){let M=new Promise((V,oe)=>{let ce=`${je}-${I}-${this.uuid}-${this.rpcTicket++}`;this.subscribeOnce(ce,Ie=>{Ie.success?V(Ie.result):oe(new Error(Ie.err))}),this.push(I,{message:w,replyTopic:ce})});return B>0?Promise.race([M,new Promise((V,oe)=>{setTimeout(oe,B)})]):M}},it=class extends Ct{constructor(I=!1){super(),this.unsafe=I,this.subscribed={},this.pulled={},this.pushed={}}publish(I,w){let B=this.subscribed[I];if(B){let M;for(let V of B)V.running()?V.execute(w):(M=M||new Array,M.push(V));if(M)for(let V of M)me(B,V)}}subscribe(I,w){let B=new tt(w,this.unsafe);return Ae(this.subscribed,I).push(B),B}push(I,w){let B=!1,M=this.pulled[I];if(M){for(;M.length>0;){let V=M.shift();if(V&&V.running()){V.execute(w),B=!0;break}}M.length===0&&delete this.pulled[I]}B||Ae(this.pushed,I).push(w)}pull(I,w){let B=new tt(w,this.unsafe);return this.repull(I,B),B}repull(I,w){let B=this.pushed[I];if(B){let M=B.shift();M&&(w.execute(M),B.length===0&&delete this.pushed[I])}else Ae(this.pulled,I).push(w)}},Ze=class extends Ct{constructor(I=crypto.randomUUID()){super(I),this.subscribed={},this.pushed={},this.pulled={},this.pushCnt=0}publish(I,w){console.debug("BC",this.uuid,"PUBLISH",I,w),this.broadcastPublish(I,w)}subscribe(I,w){console.debug("BC",this.uuid,"SUBSCRIBE",I);let B=new tt(w,!0);return Ae(this.subscribed,I).push(B),B}push(I,w){let B=this.pushCnt++;console.debug("BC",this.uuid,"PUSH",I,`(${B})`,w),Ae(this.pushed,I).push({id:B,message:w}),this.broadcastPushedHeadMessage(I)}pull(I,w){console.debug("BC",this.uuid,"PULL",I);let B=new tt(w,!0);return Ae(this.pulled,I).push(B),this.broadcastWhoHas(I),B}broadcastPushedHeadMessage(I){let w=this.pushed[I];w&&w[0]&&this.broadcastIHave(I,w[0].id)}onReceivedPublish(I,w,B){console.debug("BCMSG(",this.uuid,")","from",I,"PUBLISH",w,"message",B);let M=this.subscribed[w];if(M){let V;for(let oe of M)oe.running()?oe.execute(B):(V=V||new Array,V.push(oe));if(V)for(let oe of V)me(M,oe);M.length===0&&delete this.subscribed[w]}}onReceivedWhoHas(I,w){console.debug("BCMSG(",this.uuid,")","from",I,"WHOHAS",w),this.broadcastPushedHeadMessage(w)}onReceivedIHave(I,w,B){console.debug("BCMSG(",this.uuid,")","from",I,"IHAVE",w,"id",B);let M=this.pulled[w];if(M){let V;for(let oe of M)if(oe.running()){this.broadcastINeed(w,I,B);break}else V=V||new Array,V.push(oe);if(V)for(let oe of V)me(M,oe);M.length===0&&delete this.pulled[w]}}onReceivedINeed(I,w,B,M){if(console.debug("BCMSG(",this.uuid,")","from",I,"INEED",w,"source",B,"id",M),this.uuid===B){let V=this.pushed[w];if(V&&V[0]&&V[0].id===M){let{message:oe}=V.shift();this.broadcastIGive(w,M,I,oe),this.broadcastPushedHeadMessage(w),V.length===0&&delete this.pushed[w]}}}onReceivedIGive(I,w,B,M,V){console.debug("BCMSG(",this.uuid,")","from",I,"IGIVE",w,"id",B,"target",M,"message",V);let oe=this.pulled[w];if(oe&&this.uuid===M){let ce=!1;for(;oe.length>0;){let Ie=oe.shift();if(Ie.running()){Ie.execute(V),ce=!0;break}}ce||this.push(w,V),oe.length===0&&delete this.pulled[w]}}},Ri=class extends Ze{constructor(I,w=crypto.randomUUID()){super(w),this.bc=new BroadcastChannel(I),this.bc.onmessage=B=>{this.onMessage(B.data)}}onMessage(I){let{type:w,uuid:B,topic:M}=I;switch(w){case"PUBLISH":{let{message:V}=I;this.onReceivedPublish(B,M,V);break}case"WHOHAS":{this.onReceivedWhoHas(B,M);break}case"IHAVE":{let{id:V}=I;this.onReceivedIHave(B,M,V);break}case"INEED":{let{source:V,id:oe}=I;this.onReceivedINeed(B,M,V,oe);break}case"IGIVE":{let{target:V,id:oe,message:ce}=I;this.onReceivedIGive(B,M,oe,V,ce);break}default:console.warn("unsupported",I)}}broadcastPublish(I,w){this.post({type:"PUBLISH",uuid:this.uuid,topic:I,message:w})}broadcastWhoHas(I){this.post({type:"WHOHAS",uuid:this.uuid,topic:I})}broadcastIHave(I,w){this.post({type:"IHAVE",uuid:this.uuid,topic:I,id:w})}broadcastINeed(I,w,B){this.post({type:"INEED",uuid:this.uuid,topic:I,source:w,id:B})}broadcastIGive(I,w,B,M){this.post({type:"IGIVE",uuid:this.uuid,topic:I,id:w,target:B,message:M})}post(I){this.bc.postMessage(I),Promise.resolve().then(()=>{this.onMessage(I)})}},Jt=Symbol("BLOCKING_QUEUE_RESET"),di=class{constructor(I,w=()=>1){if(this.maxSize=I,this.itemSizeOf=w,this.queue=new c,this.waitingConsumers=new c,this.waitingProducers=new c,this.queueSize=0,this.closePromise=null,this.closeResolve=null,I<=0)throw new Error("Max size must be greater than 0")}enqueue(I){return this.closePromise?!1:this.isFull()?(async()=>{console.debug("queue is full",this.queueSize,this.maxSize);let w=await new Promise(B=>{this.waitingProducers.enqueue(B)});return console.debug("queue is not full",this.size(),w),w?(this.innerEnqueue(I),!0):!1})():(this.innerEnqueue(I),!0)}innerEnqueue(I){if(this.waitingConsumers.isEmpty())this.queue.enqueue(I),this.queueSize+=this.itemSizeOf(I),console.debug("queue pushed",I,"size",this.queueSize);else{let w=this.waitingConsumers.dequeue();Promise.resolve(I).then(w),console.debug("queue direct",I,"size",this.queueSize)}}dequeue(){if(this.queue.isEmpty())if(this.closePromise){for(;!this.waitingConsumers.isEmpty();){let I=this.waitingConsumers.dequeue();Promise.resolve(Jt).then(I)}return setTimeout(()=>this.closeResolve(),0),Jt}else return new Promise(I=>{this.waitingConsumers.enqueue(I)});else{let I=this.queue.dequeue();if(this.queueSize-=this.itemSizeOf(I),!this.waitingProducers.isEmpty()){let w=this.waitingProducers.dequeue();Promise.resolve(!0).then(w)}return I}}size(){return this.queueSize}isEmpty(){return this.queueSize===0}isFull(){return this.queueSize>=this.maxSize}close(){return this.closePromise||(this.closePromise=new Promise(I=>{for(this.closeResolve=I;!this.waitingProducers.isEmpty();){let w=this.waitingProducers.dequeue();Promise.resolve(!1).then(w)}if(this.queueSize===0){for(;!this.waitingConsumers.isEmpty();){let w=this.waitingConsumers.dequeue();Promise.resolve(Jt).then(w)}I()}})),this.closePromise}};function hi(I,w,B=Number.MAX_SAFE_INTEGER){let M=new di(B,w),V=new ReadableStream({pull(ce){let Ie=!0,ze=(async()=>{let $e=new Array;do{let xt=M.dequeue();if(xt instanceof Promise){Ie=!1;let si=await xt;si===Jt?ce.close():$e.push(si)}else{let si=xt;si===Jt?ce.close():$e.push(si)}}while(M.size()>0);if($e.length>0){let xt=I($e);ce.enqueue(xt)}})();if(!Ie)return console.debug("read stream stucked --------------------------------------"),ze},async cancel(){console.debug("buffered readable cancel"),await M.close()}}),oe=new WritableStream({write(ce,Ie){let ze=!0,$e=(async()=>{let xt=M.enqueue(ce);typeof xt=="boolean"?xt||Ie.error(new Error("Write stream closed")):(ze=!1,await xt||Ie.error(new Error("Write stream closed")))})();if(!ze)return console.debug("read stream stucked >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"),$e},async close(){console.debug("buffered writable closing",M.size()),await M.close(),console.debug("buffered writable closed",M.size())},async abort(){console.debug("buffered writable aborting",M.size()),await M.close(),console.debug("buffered writable aborted",M.size())}});return{readable:V,writable:oe}}function Ei(I=Number.MAX_SAFE_INTEGER){return hi(w=>w.join(""),w=>w.length,I)}function ln(I=Number.MAX_SAFE_INTEGER){return hi(w=>{let B=new Uint8Array(w.reduce((V,oe)=>V+oe.byteLength,0)),M=0;return w.forEach(V=>{B.set(V,M),M+=V.byteLength}),B},w=>w.byteLength,I)}function xr(I){return new Promise((w,B)=>{let M=new BroadcastChannel(I),V=new di(1),oe=new q(1),ce=null,Ie=!1,ze=!1,$e=!1;M.onmessage=xt=>{let si=xt.data,{type:Si}=si;if(console.debug("p2p",I,"type",Si,"data",Si==="DATA"&&si.data),Si==="DATA")V.enqueue(si.data);else if(Si==="HI"){if(!ce){M.postMessage({type:"HI"});let un=0;ce={rs:new ReadableStream({async pull(jr){let Yr=await V.dequeue();Yr===Jt?(await Fs(),jr.close()):(jr.enqueue(Yr),M.postMessage({type:"ACK"}))},cancel(){return Fs()}}),ws:new WritableStream({async write(jr,Yr){await oe.acquireSync()?M.postMessage({type:"DATA",id:un++,data:jr}):(On(),Yr.error(new Error("Write stream closed")))},close(){On()},abort(){On()}})},w(ce)}}else Si==="REND"?ce?oe.close():as("REND1"):Si==="WEND"?ce?V.close():as("WEND1"):Si==="ACK"&&oe.release();function On(){Ie||(Ie=!0,console.debug(I,"p2p write stream closed"),oe.close(),M.postMessage({type:"WEND"}),ze&&(console.debug(I,"p2p channel closed on ws"),M.close()))}async function Fs(){ze||(ze=!0,console.debug(I,"p2p read stream closed"),M.postMessage({type:"REND"}),await V.close(),Ie&&(console.debug(I,"p2p channel closed on rs"),M.close()))}async function as(un){$e||($e=!0,console.debug(I,"p2p channel connection released on",un),oe.close(),V.close(),ce?(ce.rs.locked||(console.debug(I,"p2p unlocked read stream direct cancel"),ce.rs.cancel()),ce.ws.locked||(console.debug(I,"p2p unlocked write stream direct close"),ce.ws.close())):(M.postMessage({type:"HI"}),M.close()),B(new Error("p2p channel connection released")))}},M.postMessage({type:"HI"})})}function Xi(I){return new Promise(w=>{let B=new BroadcastChannel(I);B.onmessage=M=>{let V=M.data,{type:oe}=V;oe==="HI"&&(B.postMessage({type:"REND"}),B.close(),w())},B.postMessage({type:"REND"})})}async function pr(I){try{return await xr(I)}catch(w){w.message!=="p2p channel connection released"&&console.error(w)}}async function ks(I,w,B=10*1024*1024,M=!0){let V=await pr(I);if(!V)return!1;let oe=!1;try{let ce,Ie=ze=>{if(!ce)if(!M)ce=V.ws.getWriter();else if(typeof ze=="string"){let $e=Ei(B);$e.readable.pipeTo(V.ws),ce=$e.writable.getWriter()}else{let $e=ln(B);$e.readable.pipeTo(V.ws),ce=$e.writable.getWriter()}return ce.write(ze)};if(Array.isArray(w))for(let ze of w)await Ie(ze);else await w({write:Ie,get desiredSize(){return((ce==null?void 0:ce.desiredSize)||0)+10}});ce&&await ce.close(),oe=!0}catch(ce){console.error(ce)}finally{return V.rs.cancel(),oe}}async function ss(I,w){var M,V;let B=await pr(I);if(B)try{let oe=B.rs.getReader();for((M=w.start)==null?void 0:M.call(w);;){let{value:ce,done:Ie}=await oe.read();if(ce!==void 0){let ze;if(w.update instanceof Promise?ze=await w.update(ce):ze=w.update(ce),ze){await oe.cancel();break}}if(Ie){(V=w.end)==null||V.call(w);break}}}catch(oe){console.error(oe)}finally{B.ws.close()}}}),WU={UNAUTHORIZED:"Not logged in yet, please log in and try again",LOGIN_FAIL:"The login status is invalid",PERMISSION_DENIED:"No permission or project does not exist",PERMISSION_DENIED1:"No permission or project does not exist",PRJ_NOT_EXIST:"No permission or project does not exist",ERROR_PATH:"No permission or project does not exist",PROJECT_NOT_FOUND:"The project was not found",PERMISSION_DENIED_PARAMS:"No permission to operate {type}",DATA_NOT_FOUND:"Data not found",PARAMS_DATA_NOT_FOUND:"The {type} data was not found",REQUEST_PARAM_ILLEGAL:"Parameter error",REQUEST_PARAM_ILLEGAL1:"Parameter error",REQUEST_PARAMS_ILLEGAL2:"The {type} parameter request is incorrect",REQUEST_PARAMS_NOT_NULL:"The {type} parameter of the request cannot be empty",REQUEST_PARAMS_NOT_ALL_NULL:"The {type} parameter of the request cannot be empty simultaneously",REQUEST_PARAMS_MUST_ARRAY:"The request parameter {type} must be an array",REQUEST_PARAMS_MUST_STRING:"The request parameter {type} must be a string",REQUEST_PARAMS_MUST_NUMBER:"The request parameter {type} must be a number",REQUEST_PARAMS_MUST_NUMBER_ARRAY:"The request parameter {type} must be a numeric array",REQUEST_PARAMS_MUST_STRING_ARRAY:"The request parameter {type} must be a string array",REQUEST_PARAMS_LENGTH_ERROR:"The length of the request parameter {type} is incorrect",REQUEST_PARAMS_TYPE_ERROR:"The request parameter {type} is of incorrect type",ILLEGAL_NAME:'The name is illegal and contains illegal characters such as /:*?"<>|',ILLEGAL_NAME1:'The name is illegal and contains illegal characters such as /:*?"<>|',ILLEGAL_NAME_ZH:"The name cannot contain Chinese characters",UUID_ERROR:"uuid error",DUPLICATE_DATA:"The title already exists",DUPLICATE_DATA1:"Library duplicate name",DUPLICATE_DATA_PARAMS:"{type} Duplicate data",UPLOAD_LIMIT:"Document {documentName} size over 15MB, it is too big to save in the server, please modify and then try again.",MORE_THAN_LIMIT:"Exceed the maximum limit",FILE_MORE_THAN_LIMIT:"Exceed the maximum upload limit of {type}",PARAMS_MORE_THAN_LIMIT:"Exceed the maximum upload limit of the parameter {type}",IMAGE_MORE_THAN_LIMIT_PARAMS:"The picture exceeds the maximum upload limit",FILE_MORE_THAN_LIMIT_PARAMS:"The file exceeds the maximum upload limit",END_MUST_AFTER_START:"The start time cannot be later than the end time",FILE_READ_ONLY:"The project file eprj or library file elib property was set as read only, please enable the read only property at File Manager and try again, and contact with support",FILE_READ_ONLY1:"The project file eprj or library file elib property was set as read only, please enable the read only property at File Manager and try again, and contact with support",DATA_NOT_EXIST:"document {documentName} not exists",REQUEST_PARAMS_TIME_ERROR:"The time request parameter is incorrect",FILES_PATH_NOT_FOUND:"The file address cannot be found",FILES_DATA_NOT_FOUND:"The file data cannot be found",FILES_TYPE_ERROR:"File type error",FILES_TYPE_MUST_BE_ONE:"The file type must be {type}",SET_WATERMARK_FAIL:"Watermark setting failed",MYSQL_CRUD_ERROR:"{type} data execution failed. Please contact technical support for resolution",PARAMS_JSON_FAILED:"{type} data parsing failed",MYSQL_ERROR:"Database operation anomaly",NOT_FOUND:"The request does not exist",PRJ_NAME_EXISTS:"The name of the project already exists",BACKUP_NAME_EXISTS:"Backup Name already exists",TITLE_ILLEGAL_LEN:"The {documentName} length must be 1~128 bytes!",LIB_NOT_EXIST:"The component library does not exist",CONFIG_API_URLS_ERROR:"Real-time prices and inventory are not enabled. Please contact the administrator",ONE_CLICK_ORDER_NOT_OPEN:"The order placement function is not enabled. Please contact the administrator",MATERIAL_NOT_OPEN:"The material warehouse is not open. Please contact the administrator",SNAPSHOT_DEPTH_LIMIT:"There is a snapshot near the latest node or the snapshot has been applied for",OCR_SYMBOL_URL_ERROR:"The OCR request address is not configured",USER_DATA_NOT_FOUND:"The user does not exist",USER_DISABLE_ERROR:"The account has been deactivated",USER_EXISTS_LOGIN_ERROR:"The user has logged in elsewhere",USER_UNAUTHORIZED_MODULES_ERROR:"This account has not authorized the module",USER_UNAUTHORIZED_ACCESS_ERROR:"Access type error",ADMIN_NOT_CHANGE_PASSWORD:"The super administrator cannot reset the password",SAME_PASSWORD_NEW_PASSWORD:"The original password is the same as the new one",USER_ONLINE_REGISTRATION_FAILED:"The registration of the user online failed",USER_PASSWORD_CAN_NOT_DEFAULT:"The default password cannot be used",USER_BEFORE_PASSWORD_ERROR:"The original password is incorrect",USER_PASSWORD_LENGTH_ERROR:"The password length is 8 to 255 characters",ORG_ROLE_NOT_CREATE:"System roles cannot be created. Please make the necessary modifications",ORG_ROLE_NAME_DUPLICATE:"The character name already exists. Please modify it",ORG_ROLE_ORIGIN_ERROR:"Unknown character source {message}",ORG_ROLE_NOT_DEFAULT:"This character is not a preset one and cannot be operated",ADMIN_ROLE_NOT_CHANGE:"Administrator privileges do not allow for modification",ADMIN_NOT_CHANGE_STATUS:"The admin account cannot change its status",PROJECT_ARCHIVED:"The project has been locked",PROJECT_UUID_NULL:"The project uuid cannot be empty",PROJECT_UUID_ERROR:"uuid error or the project uuid already exists",PROJECT_OR_TEAM_UUID_ERROR:"The project uuid is incorrect or the team uuid already exists",PROJECT_NOT_PERSON_ERROR:"Personal projects are not allowed to be created",PROJECT_DUPLICATE_NAME:"The title already exists",ANNOTATION_HAS_BE_FOUND:"The annotation has been created",ANNOTATION_NOT_FOUND:"The annotation block does not exist",ANNOTATION_CREATE_ERROR:"The annotation block creation failed",ANNOTATION_UPDATE_ERROR:"The update of the annotation block failed",ANNOTATION_DELETE_ERROR:"The annotation failed to be deleted",PROJECT_DUPLICATE_PATH:"The same path cannot be created",TEAM_NOT_FOUND:"The team does not exist",TEAM_UUID_NULL:"The team uuid cannot be empty",TEAM_FOLDER_ERROR:"The parent folder does not exist or does not belong to the current team",TEAM_FOLDER_UUID_ERROR:"The folder uuid is incorrect or the project uuid already exists",TEAM_URL_DUPLICATE:"Team link repetition",TEAM_CAN_NOT_DELETE:"There are still projects in the team. Please transfer or delete them first",COMPONENT_UUID_NULL:"The uuid of a component cannot be empty",COMPONENT_DATA_NOT_FOUND:"The component library data does not exist",COMPONENT_NAME_DUPLICATE:"Component libraries cannot have the same name",COMPONENT_TYPE_ERROR:"Library type error",DELETE_SON_CATEGORY:"The subcategories need to be deleted first",LICENSE:"License not found",START_TIME:"The start time of the license is incorrect",END_TIME:"The end time of the license is incorrect",PROJECT_LIMIT:"The maximum number of projects has been reached",USER_LIMIT:"The maximum number of accounts has been reached",ONLINE_NUMBER_LIMIT:"The maximum number of online users has been reached",LIMIT_PCB:"The PCB authorization quota has been reached and the addition failed",LIMIT_SCH:"The schematic authorization number is full, and the addition failed",LIMIT_PANEL:"The panel authorization number is full and the addition failed",TIME_ERROR:"If the system time is incorrect, please restart the server or fix the system time. After fixing, the private service needs to be restarted",LICENSE_ERROR:"Authorization error",LICENSE_TYPE_ERROR:"The type of authorized application is incorrect",LICENSE_ORIGIN_ERROR:"Unknown authorized application {type}",BRANCH_DATA_NOT_FOUND:"There is no engineering branch",PARENT_UUID_ERROR:"parent uuid error",BRANCH_MUST_AFTER_NODE:"The branch must be after the node",BRANCH_NAME_ERROR:"Incorrect branch name",BRANCH_NAME_DUPLICATE:"The branch name already exists",BRANCH_UUID_ERROR:"The branch uuid is incorrect",BRANCH_NODE_SET_ERROR:"Nodes cannot be set as default branches or marked as master",BRANCH_DELETE_MAIN_ERROR:"Nodes or branches on the main branch cannot be deleted",BRANCH_CHECK_OUT_ERROR:"There are documents that have been checked out",DOCUMENT_UUID_ERROR:"The document uuid is incorrect",UPDATE_FAILED:"Update failed",INNER_API_KEY_ERROR:"The ApiKey of the internal interface of the server is incorrect",BRANCH_MORE_THAN_LIMIT:"The version exceeds the maximum limit",WORKSPACE_API_ERROR:"The workspace request response is abnormal"},zU={UNAUTHORIZED:"\u5C1A\u672A\u767B\u5F55\uFF0C\u8BF7\u767B\u5F55\u540E\u518D\u8BD5",LOGIN_FAIL:"\u767B\u5F55\u72B6\u6001\u5F02\u5E38",PERMISSION_DENIED:"\u6CA1\u6709\u6743\u9650\u6216\u5DE5\u7A0B\u4E0D\u5B58\u5728",PERMISSION_DENIED1:"\u6CA1\u6709\u6743\u9650\u6216\u5DE5\u7A0B\u4E0D\u5B58\u5728",PRJ_NOT_EXIST:"\u6CA1\u6709\u6743\u9650\u6216\u5DE5\u7A0B\u4E0D\u5B58\u5728",ERROR_PATH:"\u6CA1\u6709\u6743\u9650\u6216\u5DE5\u7A0B\u4E0D\u5B58\u5728",PROJECT_NOT_FOUND:"\u5DE5\u7A0B\u672A\u627E\u5230",PERMISSION_DENIED_PARAMS:"\u6CA1\u6709\u6743\u9650\u64CD\u4F5C{type}",DATA_NOT_FOUND:"\u6570\u636E\u672A\u627E\u5230",PARAMS_DATA_NOT_FOUND:"{type}\u6570\u636E\u672A\u627E\u5230",REQUEST_PARAM_ILLEGAL:"\u53C2\u6570\u9519\u8BEF",REQUEST_PARAM_ILLEGAL1:"\u53C2\u6570\u9519\u8BEF",REQUEST_PARAMS_ILLEGAL2:"\u8BF7\u6C42{type}\u53C2\u6570\u9519\u8BEF",REQUEST_PARAMS_NOT_NULL:"\u8BF7\u6C42{type}\u53C2\u6570\u4E0D\u80FD\u4E3A\u7A7A",REQUEST_PARAMS_NOT_ALL_NULL:"\u8BF7\u6C42{type}\u53C2\u6570\u4E0D\u80FD\u540C\u65F6\u4E3A\u7A7A",REQUEST_PARAMS_MUST_ARRAY:"\u8BF7\u6C42\u53C2\u6570{type}\u5FC5\u987B\u662F\u6570\u7EC4",REQUEST_PARAMS_MUST_STRING:"\u8BF7\u6C42\u53C2\u6570{type}\u5FC5\u987B\u662F\u5B57\u7B26\u4E32",REQUEST_PARAMS_MUST_NUMBER:"\u8BF7\u6C42\u53C2\u6570{type}\u5FC5\u987B\u662F\u6570\u5B57",REQUEST_PARAMS_MUST_NUMBER_ARRAY:"\u8BF7\u6C42\u53C2\u6570{type}\u5FC5\u987B\u662F\u6570\u5B57\u6570\u7EC4",REQUEST_PARAMS_MUST_STRING_ARRAY:"\u8BF7\u6C42\u53C2\u6570{type}\u5FC5\u987B\u662F\u5B57\u7B26\u4E32\u6570\u7EC4",REQUEST_PARAMS_LENGTH_ERROR:"\u8BF7\u6C42\u53C2\u6570{type}\u957F\u5EA6\u9519\u8BEF",REQUEST_PARAMS_TYPE_ERROR:"\u8BF7\u6C42\u53C2\u6570{type}\u7C7B\u578B\u9519\u8BEF",ILLEGAL_NAME:'\u540D\u79F0\u975E\u6CD5, \u5305\u542B /:*?"<>| \u7B49\u975E\u6CD5\u5B57\u7B26',ILLEGAL_NAME1:'\u540D\u79F0\u975E\u6CD5, \u5305\u542B /:*?"<>| \u7B49\u975E\u6CD5\u5B57\u7B26',ILLEGAL_NAME_ZH:"\u540D\u79F0\u4E0D\u80FD\u5305\u542B\u4E2D\u6587",UUID_ERROR:"uuid \u9519\u8BEF",DUPLICATE_DATA:"\u6807\u9898\u5DF2\u5B58\u5728",DUPLICATE_DATA1:"\u5E93\u91CD\u540D",DUPLICATE_DATA_PARAMS:"{type}\u91CD\u590D\u6570\u636E",UPLOAD_LIMIT:"\u6587\u6863 {documentName} \u8D85\u8FC715MB\uFF0C\u5BFC\u81F4\u65E0\u6CD5\u6B63\u5E38\u4FDD\u5B58\uFF0C\u8BF7\u4FEE\u6539\u540E\u518D\u5BFC\u5165",MORE_THAN_LIMIT:"\u8D85\u8FC7\u6700\u5927\u9650\u5236",FILE_MORE_THAN_LIMIT:"\u8D85\u8FC7{type}\u6700\u5927\u4E0A\u4F20\u9650\u5236",PARAMS_MORE_THAN_LIMIT:"\u8D85\u8FC7\u53C2\u6570{type}\u7684\u6700\u5927\u4E0A\u4F20\u9650\u5236",IMAGE_MORE_THAN_LIMIT_PARAMS:"\u56FE\u7247\u8D85\u8FC7\u6700\u5927\u4E0A\u4F20\u9650\u5236",FILE_MORE_THAN_LIMIT_PARAMS:"\u6587\u4EF6\u8D85\u8FC7\u6700\u5927\u4E0A\u4F20\u9650\u5236",END_MUST_AFTER_START:"\u5F00\u59CB\u65F6\u95F4\u4E0D\u80FD\u665A\u4E8E\u7ED3\u675F\u65F6\u95F4",FILE_READ_ONLY:"\u5DE5\u7A0B\u6587\u4EF6eprj\u6216\u5E93\u6587\u4EF6elib\u5C5E\u6027\u53D8\u4E3A\u53EA\u8BFB\uFF0C\u8BF7\u5728\u8D44\u6E90\u7BA1\u7406\u5668\u53D6\u6D88\u53EA\u8BFB\u540E\u518D\u8BD5\uFF0C\u5E76\u8054\u7CFB\u6280\u672F\u652F\u6301",FILE_READ_ONLY1:"\u5DE5\u7A0B\u6587\u4EF6eprj\u6216\u5E93\u6587\u4EF6elib\u5C5E\u6027\u53D8\u4E3A\u53EA\u8BFB\uFF0C\u8BF7\u5728\u8D44\u6E90\u7BA1\u7406\u5668\u53D6\u6D88\u53EA\u8BFB\u540E\u518D\u8BD5\uFF0C\u5E76\u8054\u7CFB\u6280\u672F\u652F\u6301",DATA_NOT_EXIST:"\u6587\u6863{documentName}\u4E0D\u5B58\u5728",REQUEST_PARAMS_TIME_ERROR:"\u65F6\u95F4\u8BF7\u6C42\u53C2\u6570\u9519\u8BEF",FILES_PATH_NOT_FOUND:"\u627E\u4E0D\u5230\u6587\u4EF6\u5730\u5740",FILES_DATA_NOT_FOUND:"\u627E\u4E0D\u5230\u6587\u4EF6\u6570\u636E",FILES_TYPE_ERROR:"\u6587\u4EF6\u7C7B\u578B\u9519\u8BEF",FILES_TYPE_MUST_BE_ONE:"\u6587\u4EF6\u7C7B\u578B\u5FC5\u987B\u4E3A{type}",SET_WATERMARK_FAIL:"\u6C34\u5370\u8BBE\u7F6E\u5931\u8D25",MYSQL_CRUD_ERROR:"{type}\u6570\u636E\u6267\u884C\u5931\u8D25, \u8BF7\u8054\u7CFB\u6280\u672F\u652F\u6301\u89E3\u51B3",PARAMS_JSON_FAILED:"{type}\u6570\u636E\u89E3\u6790\u5931\u8D25",MYSQL_ERROR:"\u6570\u636E\u5E93\u64CD\u4F5C\u5F02\u5E38",NOT_FOUND:"\u8BF7\u6C42\u4E0D\u5B58\u5728",PRJ_NAME_EXISTS:"\u5DE5\u7A0B\u540D\u79F0\u5DF2\u5B58\u5728",BACKUP_NAME_EXISTS:"\u5907\u4EFD\u540D\u79F0\u5DF2\u5B58\u5728",TITLE_ILLEGAL_LEN:"{documentName}\u957F\u5EA6\u5FC5\u987B\u4E3A1~128\u5B57\u7B26\u957F\u5EA6\uFF01",LIB_NOT_EXIST:"\u5143\u4EF6\u5E93\u4E0D\u5B58\u5728",CONFIG_API_URLS_ERROR:"\u5B9E\u65F6\u4EF7\u683C\u548C\u5E93\u5B58\u672A\u5F00\u542F, \u8BF7\u8054\u7CFB\u7BA1\u7406\u5458",ONE_CLICK_ORDER_NOT_OPEN:"\u4E00\u4EF6\u4E0B\u5355\u529F\u80FD\u672A\u5F00\u542F, \u8BF7\u8054\u7CFB\u7BA1\u7406\u5458",MATERIAL_NOT_OPEN:"\u7269\u6599\u5E93\u672A\u5F00\u542F, \u8BF7\u8054\u7CFB\u7BA1\u7406\u5458",SNAPSHOT_DEPTH_LIMIT:"\u6700\u65B0\u8282\u70B9\u9644\u8FD1\u5B58\u5728\u5FEB\u7167\u6216\u5FEB\u7167\u5DF2\u88AB\u7533\u8BF7",OCR_SYMBOL_URL_ERROR:"OCR\u8BF7\u6C42\u5730\u5740\u672A\u914D\u7F6E",USER_DATA_NOT_FOUND:"\u7528\u6237\u4E0D\u5B58\u5728",USER_DISABLE_ERROR:"\u8D26\u53F7\u5DF2\u505C\u7528",USER_EXISTS_LOGIN_ERROR:"\u7528\u6237\u5DF2\u5728\u522B\u7684\u5730\u65B9\u767B\u5F55",USER_UNAUTHORIZED_MODULES_ERROR:"\u8BE5\u8D26\u53F7\u672A\u6388\u6743\u6A21\u5757",USER_UNAUTHORIZED_ACCESS_ERROR:"\u8BBF\u95EE\u7C7B\u578B\u9519\u8BEF",ADMIN_NOT_CHANGE_PASSWORD:"\u8D85\u7EA7\u7BA1\u7406\u5458\u65E0\u6CD5\u91CD\u7F6E\u5BC6\u7801",SAME_PASSWORD_NEW_PASSWORD:"\u539F\u5BC6\u7801\u8DDF\u65B0\u5BC6\u7801\u76F8\u540C",USER_ONLINE_REGISTRATION_FAILED:"\u767B\u8BB0\u7528\u6237\u5728\u7EBF\u5931\u8D25",USER_PASSWORD_CAN_NOT_DEFAULT:"\u4E0D\u80FD\u4F7F\u7528\u9ED8\u8BA4\u5BC6\u7801",USER_BEFORE_PASSWORD_ERROR:"\u539F\u5BC6\u7801\u9519\u8BEF",USER_PASSWORD_LENGTH_ERROR:"\u5BC6\u7801\u957F\u5EA6\u4E3A8-255\u4F4D",ORG_ROLE_NOT_CREATE:"\u4E0D\u80FD\u521B\u5EFA\u7CFB\u7EDF\u89D2\u8272, \u8BF7\u4FEE\u6539",ORG_ROLE_NAME_DUPLICATE:"\u89D2\u8272\u540D\u79F0\u5DF2\u5B58\u5728, \u8BF7\u4FEE\u6539",ORG_ROLE_ORIGIN_ERROR:"\u672A\u77E5\u7684\u89D2\u8272\u6765\u6E90{message}",ORG_ROLE_NOT_DEFAULT:"\u8BE5\u89D2\u8272\u4E0D\u662F\u9884\u8BBE\u89D2\u8272, \u4E0D\u80FD\u64CD\u4F5C",ADMIN_ROLE_NOT_CHANGE:"\u7BA1\u7406\u5458\u6743\u9650\u4E0D\u5141\u8BB8\u4FEE\u6539",ADMIN_NOT_CHANGE_STATUS:"admin\u8D26\u53F7\u4E0D\u80FD\u66F4\u6539\u72B6\u6001",PROJECT_ARCHIVED:"\u5DE5\u7A0B\u5DF2\u88AB\u9501\u5B9A",PROJECT_UUID_NULL:"\u5DE5\u7A0Buuid\u4E0D\u80FD\u4E3A\u7A7A",PROJECT_UUID_ERROR:"uuid\u9519\u8BEF\u6216\u8005\u5DE5\u7A0Buuid\u5DF2\u5B58\u5728",PROJECT_OR_TEAM_UUID_ERROR:"\u5DE5\u7A0Buuid\u9519\u8BEF\u6216\u8005\u5DF2\u5B58\u5728\u56E2\u961Fuuid",PROJECT_NOT_PERSON_ERROR:"\u4E0D\u5141\u8BB8\u521B\u5EFA\u4E2A\u4EBA\u5DE5\u7A0B",PROJECT_DUPLICATE_NAME:"\u6807\u9898\u5DF2\u5B58\u5728",ANNOTATION_HAS_BE_FOUND:"\u6279\u6CE8\u5DF2\u521B\u5EFA",ANNOTATION_NOT_FOUND:"\u6279\u6CE8\u5757\u4E0D\u5B58\u5728",ANNOTATION_CREATE_ERROR:"\u6279\u6CE8\u5757\u521B\u5EFA\u5931\u8D25",ANNOTATION_UPDATE_ERROR:"\u66F4\u65B0\u6279\u6CE8\u5757\u5931\u8D25",ANNOTATION_DELETE_ERROR:"\u6279\u6CE8\u6761\u5220\u9664\u5931\u8D25",PROJECT_DUPLICATE_PATH:"\u4E0D\u80FD\u521B\u5EFA\u76F8\u540C\u7684\u8DEF\u5F84",TEAM_NOT_FOUND:"\u56E2\u961F\u4E0D\u5B58\u5728",TEAM_UUID_NULL:"\u56E2\u961Fuuid\u4E0D\u80FD\u4E3A\u7A7A",TEAM_FOLDER_ERROR:"\u7236\u6587\u4EF6\u5939\u4E0D\u5B58\u5728\u6216\u4E0D\u5C5E\u4E8E\u5F53\u524D\u56E2\u961F",TEAM_FOLDER_UUID_ERROR:"\u6587\u4EF6\u5939uuid\u9519\u8BEF\u6216\u8005\u5DE5\u7A0Buuid\u5DF2\u5B58\u5728",TEAM_URL_DUPLICATE:"\u56E2\u961F\u94FE\u63A5\u91CD\u590D",TEAM_CAN_NOT_DELETE:"\u56E2\u961F\u4ECD\u5B58\u5728\u5DE5\u7A0B, \u8BF7\u5148\u8F6C\u79FB\u6216\u8005\u5220\u9664",COMPONENT_UUID_NULL:"\u5143\u4EF6uuid\u4E0D\u80FD\u4E3A\u7A7A",COMPONENT_DATA_NOT_FOUND:"\u5143\u4EF6\u5E93\u6570\u636E\u4E0D\u5B58\u5728",COMPONENT_NAME_DUPLICATE:"\u5143\u4EF6\u5E93\u4E0D\u80FD\u91CD\u540D",COMPONENT_TYPE_ERROR:"\u5E93\u7C7B\u578B\u9519\u8BEF",DELETE_SON_CATEGORY:"\u9700\u8981\u5148\u5220\u9664\u5B50\u7C7B\u522B",LICENSE:"\u672A\u627E\u5230\u8BB8\u53EF\u8BC1",START_TIME:"\u8BB8\u53EF\u8BC1\u5F00\u59CB\u65F6\u95F4\u9519\u8BEF",END_TIME:"\u8BB8\u53EF\u8BC1\u7ED3\u675F\u65F6\u95F4\u9519\u8BEF",PROJECT_LIMIT:"\u5DF2\u8FBE\u5230\u6700\u5927\u5DE5\u7A0B\u6570",USER_LIMIT:"\u5DF2\u8FBE\u5230\u6700\u5927\u8D26\u53F7\u6570",ONLINE_NUMBER_LIMIT:"\u5DF2\u8FBE\u5230\u6700\u5927\u5728\u7EBF\u6570",LIMIT_PCB:"PCB\u6388\u6743\u6570\u5DF2\u6EE1, \u6DFB\u52A0\u5931\u8D25",LIMIT_SCH:"\u539F\u7406\u56FE\u6388\u6743\u6570\u5DF2\u6EE1, \u6DFB\u52A0\u5931\u8D25",LIMIT_PANEL:"\u9762\u677F\u6388\u6743\u6570\u5DF2\u6EE1, \u6DFB\u52A0\u5931\u8D25",TIME_ERROR:"\u7CFB\u7EDF\u65F6\u95F4\u9519\u8BEF\u8BF7\u91CD\u542F\u670D\u52A1\u5668\u6216\u4FEE\u590D\u7CFB\u7EDF\u65F6\u95F4, \u4FEE\u590D\u540E\u9700\u8981\u91CD\u542F\u79C1\u6709\u5316\u670D\u52A1",LICENSE_ERROR:"\u6388\u6743\u9519\u8BEF",LICENSE_TYPE_ERROR:"\u6388\u6743\u5E94\u7528\u7C7B\u578B\u9519\u8BEF",LICENSE_ORIGIN_ERROR:"\u672A\u77E5\u7684\u6388\u6743\u5E94\u7528{type}",BRANCH_DATA_NOT_FOUND:"\u5DE5\u7A0B\u5206\u652F\u4E0D\u5B58\u5728",PARENT_UUID_ERROR:"\u7236\u7EA7uuid\u9519\u8BEF",BRANCH_MUST_AFTER_NODE:"\u5206\u652F\u5FC5\u987B\u5728\u8282\u70B9\u540E",BRANCH_NAME_ERROR:"\u5206\u652F\u540D\u9519\u8BEF",BRANCH_NAME_DUPLICATE:"\u5206\u652F\u540D\u5DF2\u5B58\u5728",BRANCH_UUID_ERROR:"\u5206\u652Fuuid\u9519\u8BEF",BRANCH_NODE_SET_ERROR:"\u8282\u70B9\u4E0D\u80FD\u8BBE\u7F6E\u4E3A\u9ED8\u8BA4\u5206\u652F\u6216\u6807\u8BB0\u4E3Amaster",BRANCH_DELETE_MAIN_ERROR:"\u4E0D\u80FD\u5220\u9664\u4E3B\u5206\u652F\u4E0A\u7684\u8282\u70B9\u6216\u5206\u652F",BRANCH_CHECK_OUT_ERROR:"\u5B58\u5728\u6587\u6863\u5DF2\u7B7E\u51FA",DOCUMENT_UUID_ERROR:"\u6587\u6863uuid\u9519\u8BEF",UPDATE_FAILED:"\u66F4\u65B0\u5931\u8D25",INNER_API_KEY_ERROR:"\u670D\u52A1\u7AEF\u5185\u90E8\u63A5\u53E3 ApiKey \u9519\u8BEF",BRANCH_MORE_THAN_LIMIT:"\u7248\u672C\u8D85\u8FC7\u6700\u5927\u9650\u5236",WORKSPACE_API_ERROR:"\u5DE5\u4F5C\u533A\u8BF7\u6C42\u54CD\u5E94\u5F02\u5E38"},cC={codeEN:WU,codeCN:zU},jo,Cb=(jo=class{static load(){typeof cC=="object"&&(jo.cache=cC)}static match(t,i,r){if(!this.cache||!this.cache[t])return;let n=this.cache[t][i];if(r&&Object.prototype.toString.call(r)==="[object Object]")for(let s in r){let a=r[s];n=n.replace(`{${s}}`,a)}return n}},jo.cache={},jo);function VU(){console.log("common init----------------"),Cb.load()}var qU=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.PERCENT=1]="PERCENT",e[e.LEFT_PAD0=2]="LEFT_PAD0",e))(qU||{});function Jr(e,t){throw new Error(`invalid format state on (${t}) of ${e}`)}function XU(e,...t){let i=[],r=0,n=0,s,a=0,o=0;for(let l=0;l<e.length;l++){let u=e.charAt(l);switch(r){case 0:u==="%"?r=1:i.push(u);break;case 1:switch(u){case"d":s=t[n++],typeof s=="number"?(i.push(s.toFixed(0)),r=0):Jr(e,l);break;case"f":s=t[n++],typeof s=="number"?(i.push(s.toString()),r=0):Jr(e,l);break;case"x":s=t[n++],typeof s=="number"?(i.push((s|0).toString(16)),r=0):Jr(e,l);break;case"X":s=t[n++],typeof s=="number"?(i.push((s|0).toString(16).toUpperCase()),r=0):Jr(e,l);break;case"s":case"c":s=t[n++],i.push(s===null?"null":s.toString()),r=0;break;case"0":a=l+1,o=-1,r=2;break;case"%":i.push("%"),r=0;break;default:Jr(e,l)}break;case 2:switch(u){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":o=l;break;case"d":if(o>=a){let c=parseInt(e.substring(a,o+1));s=t[n++],typeof s=="number"?(i.push((s|0).toString(10).padStart(c,"0")),r=0):Jr(e,l)}else Jr(e,l);break;case"x":if(o>=a){let c=parseInt(e.substring(a,o+1));s=t[n++],typeof s=="number"?(i.push((s|0).toString(16).padStart(c,"0")),r=0):Jr(e,l)}else Jr(e,l);break;case"X":if(o>=a){let c=parseInt(e.substring(a,o+1));s=t[n++],typeof s=="number"?(i.push((s|0).toString(16).toUpperCase().padStart(c,"0")),r=0):Jr(e,l)}else Jr(e,l);break;default:Jr(e,l)}break;default:Jr(e,l)}}return i.join("")}function fx(e){let t="";try{let i=/.*\\(.*)$/.exec(e);i&&i[1]&&typeof i[1]=="string"&&(t=i[1])}catch(i){console.error("Query Folder Name Error:",i)}return t}function mx(e,t){let i=Math.max(e.length,t.length);for(let r=0;r<i;r++){let n=e[r],s=t[r],a=0;if(typeof n=="string"&&typeof s=="string")a=n.localeCompare(s);else if(typeof n=="number"&&typeof s=="number")a=n-s;else{if(typeof n=="number"&&typeof s=="string")return-1;if(typeof n=="string"&&typeof s=="number")return 1;if(n===void 0&&s!==void 0)return-1;if(n!==void 0&&s===void 0)return 1}if(a!==0)return a}return 0}function xb(e){let t=/\d+/g,i=new Array,r=0;for(;;){let n=t.exec(e);if(n)r<n.index&&i.push(e.substring(r,n.index)),r=n.index+n[0].length,i.push(parseInt(n[0]));else break}return i.push(e),i}function JU(e,t,i,r){var u,c;let n=[],s=[],a=[];for(let h=0,m=e.length;h<m;h++){n[h]=h;let f;if(Array.isArray(t)){let g="";for(let y=0;y<t.length;y++)if(Object.hasOwnProperty.call(e[h],t[y])){g=e[h][t[y]];break}}else f=t?e[h][t]||((c=(u=e[h])==null?void 0:u[r])==null?void 0:c[t])||"":e[h];if(s[h]=String(f).toUpperCase().match(/\D+|\d+(?:\.\d+)?/g),a[h]=[],s[h])for(let g=0;g<s[h].length;g++)a[h][g]=s[h][g].match(/\d/)?1:2}let o=function(h,m){let f=s[h],g=s[m],y=a[h],b=a[m];if(!f||!g)return i?f==g?0:f?-1:1:f==g?0:f?1:-1;let E=Math.max(f.length,g.length);for(let S=0;S<E;S++){if(i)if(f[S])if(g[S]){if(f[S]!=g[S])return y[S]!=b[S]?y[S]==1?1:-1:y[S]==1?g[S]-f[S]:f[S]<g[S]?1:-1}else return-1;else return 1;if(f[S])if(g[S]){if(f[S]!=g[S])return y[S]!=b[S]?y[S]==1?-1:1:y[S]==1?f[S]-g[S]:f[S]<g[S]?-1:1}else return 1;else return-1}return 0};n.sort(o);let l=[];for(let h=0;h<e.length;h++)l[h]=e[n[h]];return l}function $U(e,t,i){let r=[],n=[],s=[],a=[e,t];for(let o=0,l=a.length;o<l;o++){r[o]=o;let u=a[o];if(n[o]=String(u).toUpperCase().match(/\D+|\d+(?:\.\d+)?/g),s[o]=[],n[o])for(let c=0;c<n[o].length;c++)s[o][c]=n[o][c].match(/\d/)?1:2}return(function(o,l){let u=n[o],c=n[l],h=s[o],m=s[l];if(!u||!c)return i?u==c?0:u?-1:1:u==c?0:u?1:-1;let f=Math.max(u.length,c.length);for(let g=0;g<f;g++){if(i)if(u[g])if(c[g]){if(u[g]!=c[g])return h[g]!=m[g]?h[g]==1?1:-1:h[g]==1?c[g]-u[g]:u[g]<c[g]?1:-1}else return-1;else return 1;if(u[g])if(c[g]){if(u[g]!=c[g])return h[g]!=m[g]?h[g]==1?-1:1:h[g]==1?u[g]-c[g]:u[g]<c[g]?-1:1}else return 1;else return-1}return 0})(r[0],r[1])}function mf(e,t){let i=!1;for(let r in t)if(Object.hasOwnProperty.call(t,r)&&e.indexOf(r)!==-1){i=!0;break}return i}function KU(e,t=""){return e.sort((r,n)=>mx(xb(i(r)),xb(i(n)))),e;function i(r){if(!r)return r;let n;if(Array.isArray(t)){let s="";for(let a=0;a<t.length;a++)if(Object.hasOwnProperty.call(r,t[a])){s=r[t[a]];break}}else n=r[t]||r;return n}}function ZU(e,t,i=1){var o,l,u,c;let r=(o=e.match(/^\D+/))==null?void 0:o[0],n=(l=e.match(/\d+$/))==null?void 0:l[0],s=(u=t.match(/^\D+/))==null?void 0:u[0],a=(c=t.match(/\d+$/))==null?void 0:c[0];return r&&s?r!==s?i===1?r.localeCompare(s):s.localeCompare(r):n!==a?+n>+a?1*i:-1*i:0:r?-1*i:s?1*i:0}function QU(e){return new Promise(t=>{setTimeout(t,e)})}var Lee=Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").map(e=>e.charCodeAt(0));function e7(){try{if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof globalThis<"u")return globalThis}catch{return null}}function An(){return self.EDITOR_TOP||self}function t7(e,t,i){t=t||1,i=i||32;var r="",n=t,s=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];e&&(n=Math.round(Math.random()*(i-t))+t);for(var a=0;a<n;a++){let o=Math.round(Math.random()*(s.length-1));r+=s[o]}return r}function i7(e){try{return JSON.parse(e)}catch{return console.error(`ParseJSON failed:
`+e),null}}var r7=(e=>(e[e.TRACE=0]="TRACE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.DUMMY=5]="DUMMY",e))(r7||{}),n7=(e,t)=>{switch(e){case 4:console.error(...t);break;case 3:console.warn(...t);break;case 2:console.info(...t);break;default:console.log(...t)}},s7=(e,t)=>t,a7=class Oc{constructor(t,i=n7,r=s7){this.level=t,this.writer=i,this.formatter=r}wrap(t){return new Oc(this.level,this.writer,(i,r)=>(r=this.formatter(i,r),t(i,r)))}inject(t){return new Oc(this.level,this.writer,(i,r)=>(r=t(i,r),this.formatter(i,r)))}shadow(...t){return new Oc(this.level,(i,r)=>{this.writer(i,r);for(let n of t)n(i,r)},this.formatter)}mix(...t){return new Oc(0,(i,r)=>{this.process(i,r);for(let n of t)n.process(i,r)},(i,r)=>r)}process(t,i){this.level<=t&&this.writer(t,this.formatter(t,i))}process1(t,i,r){this.level<=t&&this.writer(t,this.formatter(t,[XU(i,...r)]))}trace(...t){this.process(0,t)}trace1(t,...i){this.process1(0,t,i)}debug(...t){this.process(1,t)}debug1(t,...i){this.process1(1,t,i)}info(...t){this.process(2,t)}info1(t,...i){this.process1(2,t,i)}warn(...t){this.process(3,t)}warn1(t,...i){this.process1(3,t,i)}error(...t){this.process(4,t)}error1(t,...i){this.process1(4,t,i)}},Nee=new a7(5),Dee=Date.now()-performance.now(),gx=new ArrayBuffer(10),Bee=new Float64Array(gx,0,1),Oee=new Uint8Array(gx);var Qb={};YU(Qb,{HAS_PANEL:()=>C7,HAS_PCB:()=>A7,HAS_SCH:()=>I7,IS_CLIENT:()=>zn,IS_CLIENT_HALF_OFFLINE:()=>Jp,IS_CLIENT_NOT_ONLINE:()=>bx,IS_CLIENT_OFFLINE:()=>b7,IS_CLIENT_ONLINE:()=>$p,IS_DEV:()=>c7,IS_EASYEDA:()=>_x,IS_EASYEDA_CLIENT:()=>_7,IS_ECAD:()=>d7,IS_HALF_OFFLINE:()=>_f,IS_LCEDA:()=>yx,IS_LCEDA_CLIENT:()=>y7,IS_OFFLINE:()=>bf,IS_ONLINE:()=>yf,IS_PCBLUXSHARE:()=>h7,IS_PRIVATE:()=>gf,PRO_EDITOR_MODE:()=>P7,PRO_EDITOR_MODES:()=>zi,SSO_EXTERNAL_IDENTITY_DOMAIN:()=>f7,SSO_EXTERNAL_PERMISSION_DOMAIN:()=>m7,SSO_EXTERNAL_PERMISSION_MANAGED_DOMAIN:()=>g7,SSO_IDENTITY_CONNECT:()=>p7});var o7=(e=>(e.ruler="ruler",e.un_ruler="un_ruler",e))(o7||{}),l7=(e=>(e[e.HOME=-1]="HOME",e[e.BLANKTAB=0]="BLANKTAB",e[e.SCH=1]="SCH",e[e.PART=2]="PART",e[e.PCB=3]="PCB",e[e.FOOTPRINT=4]="FOOTPRINT",e[e.PRJ=5]="PRJ",e[e.SUBPART=6]="SUBPART",e[e.NGSPICE_MODEL=7]="NGSPICE_MODEL",e[e.NGSPICE=8]="NGSPICE",e[e.SIMULIDE=9]="SIMULIDE",e[e.WAVEFORM=10]="WAVEFORM",e[e.SCHLIB3D=11]="SCHLIB3D",e[e.PHOTOVIEW=12]="PHOTOVIEW",e[e.SCHMODULE=13]="SCHMODULE",e[e.PCBMODULE=14]="PCBMODULE",e[e.VIEW3D=15]="VIEW3D",e[e.PCBLIB3D=16]="PCBLIB3D",e[e.BLOCK_SYMBOL=17]="BLOCK_SYMBOL",e[e.NETFLAG=18]="NETFLAG",e[e.NETPORT=19]="NETPORT",e[e.SHEET_SYMBOL=20]="SHEET_SYMBOL",e[e.NONEELEC_SYMBOL=21]="NONEELEC_SYMBOL",e[e.SHORT_SYMBOL=22]="SHORT_SYMBOL",e[e.FOOTPRINTVIEW=23]="FOOTPRINTVIEW",e[e.CNCPRINTVIEW=24]="CNCPRINTVIEW",e[e.OFF_PAGE_CONNECTOR=25]="OFF_PAGE_CONNECTOR",e[e.PANEL=26]="PANEL",e[e.PANEL3D=27]="PANEL3D",e[e.DEVICE=28]="DEVICE",e[e.PANEL_LIB=29]="PANEL_LIB",e[e.ASSEMBLY_VARIANT=30]="ASSEMBLY_VARIANT",e[e.DIFF_PAIRS_FLAG=31]="DIFF_PAIRS_FLAG",e[e.SIMULIDE_MODEL=32]="SIMULIDE_MODEL",e))(l7||{}),u7=(e=>(e.SCH="SCH",e.PCB="PCB",e.PANEL="PANEL",e))(u7||{}),eb=e7(),zi=String((eb==null?void 0:eb.PRO_EDITOR_MODE)||"LCEDA").split("-"),c7=zi.indexOf("DEVPRO")>=0,zn=zi.indexOf("CLIENT")>=0,yx=zi.indexOf("LCEDA")>=0,_x=zi.indexOf("EASYEDA")>=0,gf=zi.indexOf("PRIVATE")>=0,yf=zi.indexOf("ONLINE")>=0,_f=zi.indexOf("HALF_OFFLINE")>=0,bf=zi.indexOf("OFFLINE")>=0,d7=zi.indexOf("ECAD")>=0,h7=zi.indexOf("PCB_LUXSHARE")>=0,p7=zi.indexOf("SSO_IDENTITY_CONNECT")>=0,f7=zi.indexOf("SSO_EXTERNAL_IDENTITY_DOMAIN")>=0,m7=zi.indexOf("SSO_EXTERNAL_PERMISSION_DOMAIN")>=0,g7=zi.indexOf("SSO_EXTERNAL_PERMISSION_MANAGED_DOMAIN")>=0,y7=zn&&yx,_7=zn&&_x,Jp=zn&&_f,bx=zn&&!yf,b7=zn&&bf,$p=zn&&yf,P7=zn?yf?"ONLINE":_f?"HALF_OFFLINE":bf?"OFFLINE":"":"",E7=zi.indexOf("SCH")>=0,S7=zi.indexOf("PCB")>=0,v7=zi.indexOf("PANEL")>=0,I7=E7,A7=S7,C7=v7,x7=(e=>(e.PROJECT_BACKUPS_MANUAL="Backup Project Manually",e.PROJECT_BACKUPS_AUTO="Backup Project Automatically",e.DELETE_BACKUPS="Delete Backup",e.SAVE="Save",e.CREATE_SHEET="New Page",e.DELETE_SHEET="Delete Page",e.RENAME_SHEET="Rename Page",e.SIGNED_SHEET="Check Out Page",e.SIGNIN_SHEET="Check In Page",e.CLEAR_SIGNED="Clear Check Out",e.PROJECT_LOCK="Lock Project",e.PROJECT_UNLOCK="Unlock Project",e.PROJECT_OPEN="Open Project",e.PROJECT_CLOSE="Close Project",e.DOCUMENT_PASTE="Paste Document",e.DOCUMENT_PASTE_ACROSS_PROJECT="Paste Document Across Projects",e.SCHEMATIC_PASTE="Paste Schematic",e.SCHEMATIC_PASTE_ACROSS_PROJECT="Paste Schematic Across Projects",e.PRIMITIVE_PASTE_ACROSS_PROJECT="Paste Elements Across Projects",e.PROJECT_SAVEAS_REMOTE="Save Project to Cloud",e.PROJECT_SAVEAS_LOCAL="Save Project to Local",e.DOCUMENT_SAVEAS_REMOTE="Save Document to Cloud",e.DOCUMENT_SAVEAS_LOCAL="Save Document to Local",e.CBB_SAVEAS_REMOTE="Save Reuse Module to Cloud",e.CBB_SAVEAS_LOCAL="Save Reuse Module to Local",e.SVG_EXPORT="Export SVG",e.PNG_EXPORT="Export PNG",e.PDF_EXPORT="Export PDF",e.BOM_EXPORT="Export BOM",e.PRINT="Print",e.GERBER_EXPORT="Export Gerber",e.COORDINATE_EXPORT="Export Pick and Place File",e.D3FILE_EXPORT="Export 3D File",e.D3SHELLFILE_EXPORT="Export 3D Shell File",e.TESTPOINT_REPORT_EXPORT="Export Test Point Report",e.DXF_EXPORT="Export DXF",e.ODBPLUSS_EXPORT="Export ODB++",e.AD_EXPORT="Export Altium Designer",e.DEVICE_REPLACE="Replace Device",e.FOOTPRINT_REPLACE="Replace Footprint",e.D3MODEL_REPLACE="Replace 3D Model",e.PROJECTLIB_UPDATE="Update Project Library",e.REPLACE="Find and Replace",e.TRACK_BATCH_RENAME="Rename Wires in Batch",e.SHEET_BATCH_RENAME="Rename Pages in Batch",e.NET_CREATED_AUTO="Automatic Network Generation",e.DESIGNATOR_ALLOCATION="Annotate Designator",e.UNIQUE_ID_RESET="Reset Unique ID",e.NET_TABLE_EXPORT="Export Netlist",e.REFRESH_PCB_BY_SCH="Update Schematic to PCB",e.REFRESH_SCH_BY_PCB="Update PCB to Schematic",e.CLEAR_DESIGNATOR="Clear Designator",e.UPDATE_PORT_BY_MODULE_SYMBOL="Update Ports from Module Symbol",e.DESIGN_RULE="Set Design Rules",e.NET_CLASS="Set Network Class",e.EQUAL_LENGTH_GROUP="Set Equal Length Group",e.DIFFERENTIAL_PAIR="Set Differential Pair",e))(x7||{}),Pr,Mee=(Pr=class{constructor(t,i=crypto.randomUUID()){this.fileName=t,this.uuid=i,this._params=new URLSearchParams,this._aTarget=document.createElement("a"),this._params.append("uuid",i),this._params.append("fileName",t)}static get URL_VERSION(){var t;try{let i=location.host,r="/";return((t=new RegExp(`${i}(/[\\w|.]+)${r}`).exec(location.href))==null?void 0:t[1])||""}catch{return""}}static getOpenedStream(t){return this._openedInstances.get(t)}get createURL(){return`${Pr.CREATE_URL}?${this._params}`}get writeURL(){return`${Pr.WRITE_URL}?${this._params}`}get closeURL(){return`${Pr.CLOSE_URL}?${this._params}`}async create(){this._aTarget.href=this.createURL,this._aTarget.click(),this._aTarget.remove(),Pr._openedInstances.set(this.uuid,this),await QU(100)}async write(t){await(await fetch(this.writeURL,{method:"post",body:t})).json()}async close(){await fetch(this.closeURL,{method:"post"}),Pr._openedInstances.delete(this.uuid)}},Pr.CREATE_URL=`${Pr.URL_VERSION}/sw/download/stream/create`,Pr.WRITE_URL="/sw/download/stream/write",Pr.CLOSE_URL="/sw/download/stream/close",Pr._openedInstances=new Map,Pr);var T7=Object.create,Px=Object.defineProperty,w7=Object.getOwnPropertyDescriptor,R7=Object.getOwnPropertyNames,L7=Object.getPrototypeOf,N7=Object.prototype.hasOwnProperty,D7=(e=>typeof kl<"u"?kl:typeof Proxy<"u"?new Proxy(e,{get:(t,i)=>(typeof kl<"u"?kl:t)[i]}):e)(function(e){if(typeof kl<"u")return kl.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),yt=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),B7=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of R7(t))!N7.call(e,n)&&n!==i&&Px(e,n,{get:()=>t[n],enumerable:!(r=w7(t,n))||r.enumerable});return e},cu=(e,t,i)=>(i=e!=null?T7(L7(e)):{},B7(t||!e||!e.__esModule?Px(i,"default",{value:e,enumerable:!0}):i,e)),sd=yt((e,t)=>{"use strict";var i=Object.defineProperty,r=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,a=(I,w)=>{for(var B in w)i(I,B,{get:w[B],enumerable:!0})},o=(I,w,B,M)=>{if(w&&typeof w=="object"||typeof w=="function")for(let V of n(w))!s.call(I,V)&&V!==B&&i(I,V,{get:()=>w[V],enumerable:!(M=r(w,V))||M.enumerable});return I},l=I=>o(i({},"__esModule",{value:!0}),I),u={};a(u,{BroadcastChannelMessageBus:()=>Ri,MessageBus:()=>Ue,MessageBus2:()=>it,MessageBusTask:()=>Fe,MessageBusTask2:()=>tt,WindowMessageBridge:()=>we,WorkerMessageBridge:()=>Ce,createBroadcastP2PStream:()=>xr,createBufferedByteBufferStream:()=>ln,createBufferedStream:()=>hi,createBufferedStringStream:()=>Ei,dropP2PStream:()=>Xi,flowRead:()=>ss,flowWrite:()=>ks}),t.exports=l(u);var c=class{constructor(I=1.5){this.growthFactor=I,this.capacity=10,this.buffer=new Array(this.capacity),this.head=0,this.tail=0,this.count=0}enqueue(I){if(this.count===this.capacity){let w=Math.floor(this.capacity*this.growthFactor);console.log("grow",this.capacity,w);let B=new Array(w);for(let M=0;M<this.count;M++)B[M]=this.buffer[(this.head+M)%this.capacity];this.buffer=B,this.head=0,this.tail=this.count,this.capacity=w}this.buffer[this.tail]=I,this.tail=(this.tail+1)%this.capacity,this.count++}dequeue(){if(this.isEmpty())return;let I=this.buffer[this.head];return this.head=(this.head+1)%this.capacity,this.count--,I}peek(){return this.buffer[this.head]}isEmpty(){return this.count===0}clear(){this.buffer.length=0,this.head=0,this.tail=0,this.count=0}},h=new ArrayBuffer(8),m=new Float64Array(h),f=new Uint32Array(h),g=new Uint16Array(h),y=ArrayBuffer;try{y=self.HTMLImageElement||y}catch{}var b=typeof SharedArrayBuffer<"u";function E(I){if(typeof I!="object"||I===null||I instanceof Date||I instanceof ArrayBuffer||b&&I instanceof SharedArrayBuffer||I instanceof Blob||I instanceof FormData||I instanceof Function||I instanceof Uint8ClampedArray||I instanceof y)return I;if(Array.isArray(I))return I.map(E);{let w={};for(let B in I)Object.hasOwnProperty.call(I,B)&&(w[B]=E(I[B]));return w}}function S(I,w){return v(I,w,()=>[])}function v(I,w,B){let M=I[w];return M!==void 0||(M=B(w),I[w]=M),M}function A(I,w){if(Array.isArray(I)){for(let B=0,M=I.length;B<M;B++)if(w(void 0,I[B],B)===!1)return}else{let B=0;for(let M in I)if(I.hasOwnProperty(M)){let V=I[M];if(w(M,V,B)===!1)return;B++}}}var x=Object.prototype.hasOwnProperty;async function T(I,w){if(Array.isArray(I)){for(let B=0,M=I.length;B<M;B++)if(await w(void 0,I[B],B)===!1)return}else{let B=0;for(let M in I)if(x.call(I,M)){let V=I[M];if(await w(M,V,B)===!1)return;B++}}}function R(I,w,B){return typeof I=="string"&&(/https?:/.test(I)||(I=location.origin+I)),Promise.race([fetch(I,w),new Promise((M,V)=>setTimeout(V,B))])}function L(I,w){let B=0,M=0;return(...V)=>{let oe=++B;setTimeout(()=>{let ce=performance.now();if(oe===B||ce-M>=I){try{w(...V)}catch(Ie){console.log(Ie)}M=ce}},Math.max(0,I-(performance.now()-M)))}}function O(I,w){let B=I.length,M=0;for(;M<B;){let V=I.indexOf(`
`,M);V<0&&(V=B);let oe=I.substring(M,V);try{if(w(oe)===!1)return}catch(ce){console.error(ce)}M=V+1}}function H(I){let w=null;return()=>(w===null&&(w=I()),w)}var k=0;function ee(){k===0&&(k=Date.now()-performance.now());let I=new Array,w=k+performance.now();m[0]=w,I.push(f[1].toString(16)),m[0]=Math.random(),I.push(g[3].toString(16));let B=g[2].toString(16);I.push("4"+B.substr(0,3)),m[0]=w;let M=f[0].toString(16)+f[1].toString(16);return I.push("0"+M.substr(0,3)),I.push(M.substr(3)),I.join("-")}var q=class{constructor(I){this.maxResources=I,this.idle=new c,this.isClosed=!1,this.resources=I}acquire(I){this.isClosed?Promise.resolve(!1).then(I):this.resources>0?(this.resources--,Promise.resolve(!0).then(I)):this.idle.enqueue(I)}acquireSync(){return new Promise(I=>{this.acquire(I)})}release(){if(!this.isClosed){let I=this.idle.dequeue();I?Promise.resolve(!0).then(I):this.resources++}}close(){if(!this.isClosed)for(this.isClosed=!0;!this.idle.isEmpty();){let I=this.idle.dequeue();Promise.resolve(!1).then(I)}}};function Q(){if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global}function ne(I,w,B){let M=I.length+w-1;for(let V=0;V<M;V++){let oe=new Array;for(let ce=V-w+1;ce<=V;ce++)oe.push(I[ce]);if(B(oe)===!1)break}}function G(){let I=new Date,w=I.getFullYear(),B=I.getMonth()+1,M=I.getDate(),V=I.getHours(),oe=I.getMinutes(),ce=I.getSeconds(),Ie=I.getMilliseconds();return"["+w+"-"+(B<10?"0"+B:B)+"-"+(M<10?"0"+M:M)+" "+(V<10?"0"+V:V)+":"+(oe<10?"0"+oe:oe)+":"+(ce<10?"0"+ce:ce)+"."+(Ie<100?Ie<10?"00"+Ie:"0"+Ie:Ie)+"] "}function X(I){return new Promise(w=>setTimeout(w,I))}function D(I,w){let B=0,M=I.length;for(let V=0;V<M;V++)I[V]===w&&(I.splice(V,1),V--,M--,B++);return B}var F=Q(),W=F.WeakRef||(I=>I);function z(I){if(I!=null){if(typeof I=="object")return new W(I);console.error(I,I instanceof Object,typeof I);return}}function $(I){return I==null?void 0:I.deref()}var te="_MSG_BUS_RPC_",Z=300*1e3,pe=(I=>(I.PUBLISH="publish",I.SUBSCRIBE="subscribe",I.PUSH="push",I.PULL="pull",I))(pe||{}),Se=class{constructor(I){this.bus=I}processRemoteMessage(I,w){let B=z(w),M=I.topic,V=I.type,oe=I.message;switch(V){case"pull":this.bus.pull(M,ce=>{this.push(M,ce,$(B))});break;case"subscribe":this.bus.subscribe(M,ce=>{this.publish(M,ce,$(B))});break;case"publish":this.bus.publish(M,oe,this,$(B));break;case"push":this.bus.push(M,oe,this,$(B));break;default:console.debug("unknown message type "+V)}}rpcCall(I,w,B,M=Z){let V=z(B),oe=new Promise(ce=>{let Ie=this.bus.uniqueRpcTopic(I);this.publish(I,{message:w,reply:Ie},$(V)),this.bus.pull(Ie,(ze,$e,xt)=>{ce({message:ze,bridge:$e,source:z(xt)})})});return M>0?Promise.race([oe,new Promise((ce,Ie)=>{setTimeout(Ie,M)})]):oe}},Ce=class extends Se{constructor(I,w){super(I),this.worker=w,w.onmessage=B=>{this.processRemoteMessage(B.data,void 0)}}publish(I,w){this.postMessage(I,"publish",w)}subscribe(I){this.postMessage(I,"subscribe",null)}push(I,w){this.postMessage(I,"push",w)}pull(I){this.postMessage(I,"pull",null)}rpcCall(I,w,B=Z){return super.rpcCall(I,w,void 0,B)}postMessage(I,w,B){let M={topic:I,type:w,message:B};this.worker.postMessage(M)}discard(){this.worker.terminate()}},we=class extends Se{constructor(I){super(I),window.addEventListener("message",w=>{this.processRemoteMessage(w.data,w.source)},!1)}publish(I,w,B){this.postMessage(I,"publish",w,B)}subscribe(I,w){if(w===window)throw new Error("regist remote subscribe from current window is not permitted");this.postMessage(I,"subscribe",null,w)}push(I,w,B){this.postMessage(I,"push",w,B)}pull(I,w){if(w===window)throw new Error("regist remote pull from current window is not permitted");this.postMessage(I,"pull",null,w)}postMessage(I,w,B,M){let V={topic:I,type:w,message:B};M&&M.postMessage(V,"*")}},Fe=class{constructor(I){this.isRunning=!0,this.callback=I}cancel(){this.callback=null,this.isRunning=!1}running(){return this.isRunning}execute(I,w,B,M){try{I=M?I:E(I),this.callback(I,w,B)}catch(V){console.error(V)}}},Ue=class{constructor(I=!1){this.subscribed={},this.pulled={},this.pushed={},this.uuid=crypto.randomUUID().replace(/-/g,""),this.rpcTicket=0,this.unsafe=I}uniqueRpcTopic(I){return`${te}-${I}-${this.uuid}-${this.rpcTicket++}`}publish(I,w,B,M){let V=this.subscribed[I];if(V){let oe;for(let ce of V)ce.running()?ce.execute(w,B,M,this.unsafe):(oe=oe||new Array,oe.push(ce));if(oe)for(let ce of oe)D(V,ce)}else console.debug("no sub on topic: "+I)}subscribe(I,w){let B=new Fe(w);return S(this.subscribed,I).push(B),B}push(I,w,B,M){let V=!1,oe=this.pulled[I];if(oe){for(;oe.length>0;){let ce=oe.shift();if(ce.running()){ce.execute(w,B,M,this.unsafe),V=!0;break}}oe.length===0&&delete this.pulled[I]}V||S(this.pushed,I).push({message:w,bridge:B,source:z(M)})}pull(I,w){let B=new Fe(w),M=this.pushed[I];if(M){let V=M.shift();B.execute(V.message,V.bridge,$(V.source),this.unsafe),M.length===0&&delete this.pushed[I]}else S(this.pulled,I).push(B);return B}pullA(I){return new Promise(w=>{this.pull(I,(B,M,V)=>{w({message:B,bridge:M,source:z(V)})})})}rpcService(I,w){this.subscribe(I,(B,M,V)=>{let{message:oe,reply:ce}=B;try{let Ie=w(oe);if(Ie instanceof Promise){let ze=z(V);Ie.then($e=>{this.rpcReply($e,ce,M,$(ze))},$e=>{console.error($e),this.rpcReply(void 0,ce,M,$(ze))})}else this.rpcReply(Ie,ce,M,V)}catch(Ie){console.error(Ie),this.rpcReply(void 0,ce,M,V)}})}rpcCall(I,w,B=Z){let M=new Promise(V=>{let oe=this.uniqueRpcTopic(I);this.publish(I,{message:w,reply:oe}),this.pull(oe,(ce,Ie,ze)=>{V({message:ce,bridge:Ie,source:z(ze)})})});return B>0?Promise.race([M,new Promise((V,oe)=>{setTimeout(oe,B)})]):M}rpcReply(I,w,B,M){B?B.push(w,I,M):this.push(w,I)}},je="_MSG_BUS_RPC_";function me(I,w){let B=0,M=I.length;for(let V=0;V<M;V++)I[V]===w&&(I.splice(V,1),V--,M--,B++);return B}function Ae(I,w){return We(I,w,()=>[])}function We(I,w,B){let M=I[w];return M!==void 0||(M=B(w),I[w]=M),M}var tt=class{constructor(I,w){this.callback=I,this.unsafe=w,this.isRunning=!0}cancel(){this.callback=null,this.isRunning=!1}running(){return this.isRunning}async execute(I){try{I=this.unsafe?I:E(I),this.callback(I)}catch(w){console.error(w)}}},Ct=class{constructor(I=crypto.randomUUID()){this.uuid=I,this.rpcTicket=0}subscribeOnce(I,w){let B=this.subscribe(I,M=>{B.cancel(),w(M)});return B}pullA(I){return new Promise(w=>{this.pull(I,w)})}rpcService(I,w){let B=M=>{try{let{message:V,replyTopic:oe}=M;try{let ce=w(V);ce instanceof Promise?ce.then(Ie=>{this.publish(oe,{success:!0,result:Ie})}).catch(Ie=>{console.error(Ie),this.publish(oe,{success:!1,err:String(Ie)})}):this.publish(oe,{success:!0,result:ce})}catch(ce){this.publish(oe,{success:!1,err:String(ce)})}}finally{this.pull(I,B)}};this.pull(I,B)}rpcCall(I,w,B=0){let M=new Promise((V,oe)=>{let ce=`${je}-${I}-${this.uuid}-${this.rpcTicket++}`;this.subscribeOnce(ce,Ie=>{Ie.success?V(Ie.result):oe(new Error(Ie.err))}),this.push(I,{message:w,replyTopic:ce})});return B>0?Promise.race([M,new Promise((V,oe)=>{setTimeout(oe,B)})]):M}},it=class extends Ct{constructor(I=!1){super(),this.unsafe=I,this.subscribed={},this.pulled={},this.pushed={}}publish(I,w){let B=this.subscribed[I];if(B){let M;for(let V of B)V.running()?V.execute(w):(M=M||new Array,M.push(V));if(M)for(let V of M)me(B,V)}}subscribe(I,w){let B=new tt(w,this.unsafe);return Ae(this.subscribed,I).push(B),B}push(I,w){let B=!1,M=this.pulled[I];if(M){for(;M.length>0;){let V=M.shift();if(V&&V.running()){V.execute(w),B=!0;break}}M.length===0&&delete this.pulled[I]}B||Ae(this.pushed,I).push(w)}pull(I,w){let B=new tt(w,this.unsafe);return this.repull(I,B),B}repull(I,w){let B=this.pushed[I];if(B){let M=B.shift();M&&(w.execute(M),B.length===0&&delete this.pushed[I])}else Ae(this.pulled,I).push(w)}},Ze=class extends Ct{constructor(I=crypto.randomUUID()){super(I),this.subscribed={},this.pushed={},this.pulled={},this.pushCnt=0}publish(I,w){console.debug("BC",this.uuid,"PUBLISH",I,w),this.broadcastPublish(I,w)}subscribe(I,w){console.debug("BC",this.uuid,"SUBSCRIBE",I);let B=new tt(w,!0);return Ae(this.subscribed,I).push(B),B}push(I,w){let B=this.pushCnt++;console.debug("BC",this.uuid,"PUSH",I,`(${B})`,w),Ae(this.pushed,I).push({id:B,message:w}),this.broadcastPushedHeadMessage(I)}pull(I,w){console.debug("BC",this.uuid,"PULL",I);let B=new tt(w,!0);return Ae(this.pulled,I).push(B),this.broadcastWhoHas(I),B}broadcastPushedHeadMessage(I){let w=this.pushed[I];w&&w[0]&&this.broadcastIHave(I,w[0].id)}onReceivedPublish(I,w,B){console.debug("BCMSG(",this.uuid,")","from",I,"PUBLISH",w,"message",B);let M=this.subscribed[w];if(M){let V;for(let oe of M)oe.running()?oe.execute(B):(V=V||new Array,V.push(oe));if(V)for(let oe of V)me(M,oe);M.length===0&&delete this.subscribed[w]}}onReceivedWhoHas(I,w){console.debug("BCMSG(",this.uuid,")","from",I,"WHOHAS",w),this.broadcastPushedHeadMessage(w)}onReceivedIHave(I,w,B){console.debug("BCMSG(",this.uuid,")","from",I,"IHAVE",w,"id",B);let M=this.pulled[w];if(M){let V;for(let oe of M)if(oe.running()){this.broadcastINeed(w,I,B);break}else V=V||new Array,V.push(oe);if(V)for(let oe of V)me(M,oe);M.length===0&&delete this.pulled[w]}}onReceivedINeed(I,w,B,M){if(console.debug("BCMSG(",this.uuid,")","from",I,"INEED",w,"source",B,"id",M),this.uuid===B){let V=this.pushed[w];if(V&&V[0]&&V[0].id===M){let{message:oe}=V.shift();this.broadcastIGive(w,M,I,oe),this.broadcastPushedHeadMessage(w),V.length===0&&delete this.pushed[w]}}}onReceivedIGive(I,w,B,M,V){console.debug("BCMSG(",this.uuid,")","from",I,"IGIVE",w,"id",B,"target",M,"message",V);let oe=this.pulled[w];if(oe&&this.uuid===M){let ce=!1;for(;oe.length>0;){let Ie=oe.shift();if(Ie.running()){Ie.execute(V),ce=!0;break}}ce||this.push(w,V),oe.length===0&&delete this.pulled[w]}}},Ri=class extends Ze{constructor(I,w=crypto.randomUUID()){super(w),this.bc=new BroadcastChannel(I),this.bc.onmessage=B=>{this.onMessage(B.data)}}onMessage(I){let{type:w,uuid:B,topic:M}=I;switch(w){case"PUBLISH":{let{message:V}=I;this.onReceivedPublish(B,M,V);break}case"WHOHAS":{this.onReceivedWhoHas(B,M);break}case"IHAVE":{let{id:V}=I;this.onReceivedIHave(B,M,V);break}case"INEED":{let{source:V,id:oe}=I;this.onReceivedINeed(B,M,V,oe);break}case"IGIVE":{let{target:V,id:oe,message:ce}=I;this.onReceivedIGive(B,M,oe,V,ce);break}default:console.warn("unsupported",I)}}broadcastPublish(I,w){this.post({type:"PUBLISH",uuid:this.uuid,topic:I,message:w})}broadcastWhoHas(I){this.post({type:"WHOHAS",uuid:this.uuid,topic:I})}broadcastIHave(I,w){this.post({type:"IHAVE",uuid:this.uuid,topic:I,id:w})}broadcastINeed(I,w,B){this.post({type:"INEED",uuid:this.uuid,topic:I,source:w,id:B})}broadcastIGive(I,w,B,M){this.post({type:"IGIVE",uuid:this.uuid,topic:I,id:w,target:B,message:M})}post(I){this.bc.postMessage(I),Promise.resolve().then(()=>{this.onMessage(I)})}},Jt=Symbol("BLOCKING_QUEUE_RESET"),di=class{constructor(I,w=()=>1){if(this.maxSize=I,this.itemSizeOf=w,this.queue=new c,this.waitingConsumers=new c,this.waitingProducers=new c,this.queueSize=0,this.closePromise=null,this.closeResolve=null,I<=0)throw new Error("Max size must be greater than 0")}enqueue(I){return this.closePromise?!1:this.isFull()?(async()=>{console.debug("queue is full",this.queueSize,this.maxSize);let w=await new Promise(B=>{this.waitingProducers.enqueue(B)});return console.debug("queue is not full",this.size(),w),w?(this.innerEnqueue(I),!0):!1})():(this.innerEnqueue(I),!0)}innerEnqueue(I){if(this.waitingConsumers.isEmpty())this.queue.enqueue(I),this.queueSize+=this.itemSizeOf(I),console.debug("queue pushed",I,"size",this.queueSize);else{let w=this.waitingConsumers.dequeue();Promise.resolve(I).then(w),console.debug("queue direct",I,"size",this.queueSize)}}dequeue(){if(this.queue.isEmpty())if(this.closePromise){for(;!this.waitingConsumers.isEmpty();){let I=this.waitingConsumers.dequeue();Promise.resolve(Jt).then(I)}return setTimeout(()=>this.closeResolve(),0),Jt}else return new Promise(I=>{this.waitingConsumers.enqueue(I)});else{let I=this.queue.dequeue();if(this.queueSize-=this.itemSizeOf(I),!this.waitingProducers.isEmpty()){let w=this.waitingProducers.dequeue();Promise.resolve(!0).then(w)}return I}}size(){return this.queueSize}isEmpty(){return this.queueSize===0}isFull(){return this.queueSize>=this.maxSize}close(){return this.closePromise||(this.closePromise=new Promise(I=>{for(this.closeResolve=I;!this.waitingProducers.isEmpty();){let w=this.waitingProducers.dequeue();Promise.resolve(!1).then(w)}if(this.queueSize===0){for(;!this.waitingConsumers.isEmpty();){let w=this.waitingConsumers.dequeue();Promise.resolve(Jt).then(w)}I()}})),this.closePromise}};function hi(I,w,B=Number.MAX_SAFE_INTEGER){let M=new di(B,w),V=new ReadableStream({pull(ce){let Ie=!0,ze=(async()=>{let $e=new Array;do{let xt=M.dequeue();if(xt instanceof Promise){Ie=!1;let si=await xt;si===Jt?ce.close():$e.push(si)}else{let si=xt;si===Jt?ce.close():$e.push(si)}}while(M.size()>0);if($e.length>0){let xt=I($e);ce.enqueue(xt)}})();if(!Ie)return console.debug("read stream stucked --------------------------------------"),ze},async cancel(){console.debug("buffered readable cancel"),await M.close()}}),oe=new WritableStream({write(ce,Ie){let ze=!0,$e=(async()=>{let xt=M.enqueue(ce);typeof xt=="boolean"?xt||Ie.error(new Error("Write stream closed")):(ze=!1,await xt||Ie.error(new Error("Write stream closed")))})();if(!ze)return console.debug("read stream stucked >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"),$e},async close(){console.debug("buffered writable closing",M.size()),await M.close(),console.debug("buffered writable closed",M.size())},async abort(){console.debug("buffered writable aborting",M.size()),await M.close(),console.debug("buffered writable aborted",M.size())}});return{readable:V,writable:oe}}function Ei(I=Number.MAX_SAFE_INTEGER){return hi(w=>w.join(""),w=>w.length,I)}function ln(I=Number.MAX_SAFE_INTEGER){return hi(w=>{let B=new Uint8Array(w.reduce((V,oe)=>V+oe.byteLength,0)),M=0;return w.forEach(V=>{B.set(V,M),M+=V.byteLength}),B},w=>w.byteLength,I)}function xr(I){return new Promise((w,B)=>{let M=new BroadcastChannel(I),V=new di(1),oe=new q(1),ce=null,Ie=!1,ze=!1,$e=!1;M.onmessage=xt=>{let si=xt.data,{type:Si}=si;if(console.debug("p2p",I,"type",Si,"data",Si==="DATA"&&si.data),Si==="DATA")V.enqueue(si.data);else if(Si==="HI"){if(!ce){M.postMessage({type:"HI"});let un=0;ce={rs:new ReadableStream({async pull(jr){let Yr=await V.dequeue();Yr===Jt?(await Fs(),jr.close()):(jr.enqueue(Yr),M.postMessage({type:"ACK"}))},cancel(){return Fs()}}),ws:new WritableStream({async write(jr,Yr){await oe.acquireSync()?M.postMessage({type:"DATA",id:un++,data:jr}):(On(),Yr.error(new Error("Write stream closed")))},close(){On()},abort(){On()}})},w(ce)}}else Si==="REND"?ce?oe.close():as("REND1"):Si==="WEND"?ce?V.close():as("WEND1"):Si==="ACK"&&oe.release();function On(){Ie||(Ie=!0,console.debug(I,"p2p write stream closed"),oe.close(),M.postMessage({type:"WEND"}),ze&&(console.debug(I,"p2p channel closed on ws"),M.close()))}async function Fs(){ze||(ze=!0,console.debug(I,"p2p read stream closed"),M.postMessage({type:"REND"}),await V.close(),Ie&&(console.debug(I,"p2p channel closed on rs"),M.close()))}async function as(un){$e||($e=!0,console.debug(I,"p2p channel connection released on",un),oe.close(),V.close(),ce?(ce.rs.locked||(console.debug(I,"p2p unlocked read stream direct cancel"),ce.rs.cancel()),ce.ws.locked||(console.debug(I,"p2p unlocked write stream direct close"),ce.ws.close())):(M.postMessage({type:"HI"}),M.close()),B(new Error("p2p channel connection released")))}},M.postMessage({type:"HI"})})}function Xi(I){return new Promise(w=>{let B=new BroadcastChannel(I);B.onmessage=M=>{let V=M.data,{type:oe}=V;oe==="HI"&&(B.postMessage({type:"REND"}),B.close(),w())},B.postMessage({type:"REND"})})}async function pr(I){try{return await xr(I)}catch(w){w.message!=="p2p channel connection released"&&console.error(w)}}async function ks(I,w,B=10*1024*1024,M=!0){let V=await pr(I);if(!V)return!1;let oe=!1;try{let ce,Ie=ze=>{if(!ce)if(!M)ce=V.ws.getWriter();else if(typeof ze=="string"){let $e=Ei(B);$e.readable.pipeTo(V.ws),ce=$e.writable.getWriter()}else{let $e=ln(B);$e.readable.pipeTo(V.ws),ce=$e.writable.getWriter()}return ce.write(ze)};if(Array.isArray(w))for(let ze of w)await Ie(ze);else await w({write:Ie,get desiredSize(){return((ce==null?void 0:ce.desiredSize)||0)+10}});ce&&await ce.close(),oe=!0}catch(ce){console.error(ce)}finally{return V.rs.cancel(),oe}}async function ss(I,w){var M,V;let B=await pr(I);if(B)try{let oe=B.rs.getReader();for((M=w.start)==null?void 0:M.call(w);;){let{value:ce,done:Ie}=await oe.read();if(ce!==void 0){let ze;if(w.update instanceof Promise?ze=await w.update(ce):ze=w.update(ce),ze){await oe.cancel();break}}if(Ie){(V=w.end)==null||V.call(w);break}}}catch(oe){console.error(oe)}finally{B.ws.close()}}}),O7=yt(()=>{}),vt=yt((e,t)=>{(function(i,r){typeof e=="object"?t.exports=e=r():typeof define=="function"&&define.amd?define([],r):i.CryptoJS=r()})(e,function(){var i=i||(function(r,n){var s;if(typeof window<"u"&&window.crypto&&(s=window.crypto),typeof self<"u"&&self.crypto&&(s=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(s=globalThis.crypto),!s&&typeof window<"u"&&window.msCrypto&&(s=window.msCrypto),!s&&typeof global<"u"&&global.crypto&&(s=global.crypto),!s&&typeof D7=="function")try{s=O7()}catch{}var a=function(){if(s){if(typeof s.getRandomValues=="function")try{return s.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof s.randomBytes=="function")try{return s.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||(function(){function v(){}return function(A){var x;return v.prototype=A,x=new v,v.prototype=null,x}})(),l={},u=l.lib={},c=u.Base=(function(){return{extend:function(v){var A=o(this);return v&&A.mixIn(v),(!A.hasOwnProperty("init")||this.init===A.init)&&(A.init=function(){A.$super.init.apply(this,arguments)}),A.init.prototype=A,A.$super=this,A},create:function(){var v=this.extend();return v.init.apply(v,arguments),v},init:function(){},mixIn:function(v){for(var A in v)v.hasOwnProperty(A)&&(this[A]=v[A]);v.hasOwnProperty("toString")&&(this.toString=v.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),h=u.WordArray=c.extend({init:function(v,A){v=this.words=v||[],A!=n?this.sigBytes=A:this.sigBytes=v.length*4},toString:function(v){return(v||f).stringify(this)},concat:function(v){var A=this.words,x=v.words,T=this.sigBytes,R=v.sigBytes;if(this.clamp(),T%4)for(var L=0;L<R;L++){var O=x[L>>>2]>>>24-L%4*8&255;A[T+L>>>2]|=O<<24-(T+L)%4*8}else for(var H=0;H<R;H+=4)A[T+H>>>2]=x[H>>>2];return this.sigBytes+=R,this},clamp:function(){var v=this.words,A=this.sigBytes;v[A>>>2]&=4294967295<<32-A%4*8,v.length=r.ceil(A/4)},clone:function(){var v=c.clone.call(this);return v.words=this.words.slice(0),v},random:function(v){for(var A=[],x=0;x<v;x+=4)A.push(a());return new h.init(A,v)}}),m=l.enc={},f=m.Hex={stringify:function(v){for(var A=v.words,x=v.sigBytes,T=[],R=0;R<x;R++){var L=A[R>>>2]>>>24-R%4*8&255;T.push((L>>>4).toString(16)),T.push((L&15).toString(16))}return T.join("")},parse:function(v){for(var A=v.length,x=[],T=0;T<A;T+=2)x[T>>>3]|=parseInt(v.substr(T,2),16)<<24-T%8*4;return new h.init(x,A/2)}},g=m.Latin1={stringify:function(v){for(var A=v.words,x=v.sigBytes,T=[],R=0;R<x;R++){var L=A[R>>>2]>>>24-R%4*8&255;T.push(String.fromCharCode(L))}return T.join("")},parse:function(v){for(var A=v.length,x=[],T=0;T<A;T++)x[T>>>2]|=(v.charCodeAt(T)&255)<<24-T%4*8;return new h.init(x,A)}},y=m.Utf8={stringify:function(v){try{return decodeURIComponent(escape(g.stringify(v)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(v){return g.parse(unescape(encodeURIComponent(v)))}},b=u.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(v){typeof v=="string"&&(v=y.parse(v)),this._data.concat(v),this._nDataBytes+=v.sigBytes},_process:function(v){var A,x=this._data,T=x.words,R=x.sigBytes,L=this.blockSize,O=L*4,H=R/O;v?H=r.ceil(H):H=r.max((H|0)-this._minBufferSize,0);var k=H*L,ee=r.min(k*4,R);if(k){for(var q=0;q<k;q+=L)this._doProcessBlock(T,q);A=T.splice(0,k),x.sigBytes-=ee}return new h.init(A,ee)},clone:function(){var v=c.clone.call(this);return v._data=this._data.clone(),v},_minBufferSize:0}),E=u.Hasher=b.extend({cfg:c.extend(),init:function(v){this.cfg=this.cfg.extend(v),this.reset()},reset:function(){b.reset.call(this),this._doReset()},update:function(v){return this._append(v),this._process(),this},finalize:function(v){v&&this._append(v);var A=this._doFinalize();return A},blockSize:512/32,_createHelper:function(v){return function(A,x){return new v.init(x).finalize(A)}},_createHmacHelper:function(v){return function(A,x){return new S.HMAC.init(v,x).finalize(A)}}}),S=l.algo={};return l})(Math);return i})}),Pf=yt((e,t)=>{(function(i,r){typeof e=="object"?t.exports=e=r(vt()):typeof define=="function"&&define.amd?define(["./core"],r):r(i.CryptoJS)})(e,function(i){return(function(r){var n=i,s=n.lib,a=s.Base,o=s.WordArray,l=n.x64={},u=l.Word=a.extend({init:function(h,m){this.high=h,this.low=m}}),c=l.WordArray=a.extend({init:function(h,m){h=this.words=h||[],m!=r?this.sigBytes=m:this.sigBytes=h.length*8},toX32:function(){for(var h=this.words,m=h.length,f=[],g=0;g<m;g++){var y=h[g];f.push(y.high),f.push(y.low)}return o.create(f,this.sigBytes)},clone:function(){for(var h=a.clone.call(this),m=h.words=this.words.slice(0),f=m.length,g=0;g<f;g++)m[g]=m[g].clone();return h}})})(),i})}),M7=yt((e,t)=>{(function(i,r){typeof e=="object"?t.exports=e=r(vt()):typeof define=="function"&&define.amd?define(["./core"],r):r(i.CryptoJS)})(e,function(i){return(function(){if(typeof ArrayBuffer=="function"){var r=i,n=r.lib,s=n.WordArray,a=s.init,o=s.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var u=l.byteLength,c=[],h=0;h<u;h++)c[h>>>2]|=l[h]<<24-h%4*8;a.call(this,c,u)}else a.apply(this,arguments)};o.prototype=s}})(),i.lib.WordArray})}),k7=yt((e,t)=>{(function(i,r){typeof e=="object"?t.exports=e=r(vt()):typeof define=="function"&&define.amd?define(["./core"],r):r(i.CryptoJS)})(e,function(i){return(function(){var r=i,n=r.lib,s=n.WordArray,a=r.enc,o=a.Utf16=a.Utf16BE={stringify:function(u){for(var c=u.words,h=u.sigBytes,m=[],f=0;f<h;f+=2){var g=c[f>>>2]>>>16-f%4*8&65535;m.push(String.fromCharCode(g))}return m.join("")},parse:function(u){for(var c=u.length,h=[],m=0;m<c;m++)h[m>>>1]|=u.charCodeAt(m)<<16-m%2*16;return s.create(h,c*2)}};a.Utf16LE={stringify:function(u){for(var c=u.words,h=u.sigBytes,m=[],f=0;f<h;f+=2){var g=l(c[f>>>2]>>>16-f%4*8&65535);m.push(String.fromCharCode(g))}return m.join("")},parse:function(u){for(var c=u.length,h=[],m=0;m<c;m++)h[m>>>1]|=l(u.charCodeAt(m)<<16-m%2*16);return s.create(h,c*2)}};function l(u){return u<<8&4278255360|u>>>8&16711935}})(),i.enc.Utf16})}),qo=yt((e,t)=>{(function(i,r){typeof e=="object"?t.exports=e=r(vt()):typeof define=="function"&&define.amd?define(["./core"],r):r(i.CryptoJS)})(e,function(i){return(function(){var r=i,n=r.lib,s=n.WordArray,a=r.enc,o=a.Base64={stringify:function(u){var c=u.words,h=u.sigBytes,m=this._map;u.clamp();for(var f=[],g=0;g<h;g+=3)for(var y=c[g>>>2]>>>24-g%4*8&255,b=c[g+1>>>2]>>>24-(g+1)%4*8&255,E=c[g+2>>>2]>>>24-(g+2)%4*8&255,S=y<<16|b<<8|E,v=0;v<4&&g+v*.75<h;v++)f.push(m.charAt(S>>>6*(3-v)&63));var A=m.charAt(64);if(A)for(;f.length%4;)f.push(A);return f.join("")},parse:function(u){var c=u.length,h=this._map,m=this._reverseMap;if(!m){m=this._reverseMap=[];for(var f=0;f<h.length;f++)m[h.charCodeAt(f)]=f}var g=h.charAt(64);if(g){var y=u.indexOf(g);y!==-1&&(c=y)}return l(u,c,m)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function l(u,c,h){for(var m=[],f=0,g=0;g<c;g++)if(g%4){var y=h[u.charCodeAt(g-1)]<<g%4*2,b=h[u.charCodeAt(g)]>>>6-g%4*2,E=y|b;m[f>>>2]|=E<<24-f%4*8,f++}return s.create(m,f)}})(),i.enc.Base64})}),F7=yt((e,t)=>{(function(i,r){typeof e=="object"?t.exports=e=r(vt()):typeof define=="function"&&define.amd?define(["./core"],r):r(i.CryptoJS)})(e,function(i){return(function(){var r=i,n=r.lib,s=n.WordArray,a=r.enc,o=a.Base64url={stringify:function(u,c){c===void 0&&(c=!0);var h=u.words,m=u.sigBytes,f=c?this._safe_map:this._map;u.clamp();for(var g=[],y=0;y<m;y+=3)for(var b=h[y>>>2]>>>24-y%4*8&255,E=h[y+1>>>2]>>>24-(y+1)%4*8&255,S=h[y+2>>>2]>>>24-(y+2)%4*8&255,v=b<<16|E<<8|S,A=0;A<4&&y+A*.75<m;A++)g.push(f.charAt(v>>>6*(3-A)&63));var x=f.charAt(64);if(x)for(;g.length%4;)g.push(x);return g.join("")},parse:function(u,c){c===void 0&&(c=!0);var h=u.length,m=c?this._safe_map:this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var g=0;g<m.length;g++)f[m.charCodeAt(g)]=g}var y=m.charAt(64);if(y){var b=u.indexOf(y);b!==-1&&(h=b)}return l(u,h,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function l(u,c,h){for(var m=[],f=0,g=0;g<c;g++)if(g%4){var y=h[u.charCodeAt(g-1)]<<g%4*2,b=h[u.charCodeAt(g)]>>>6-g%4*2,E=y|b;m[f>>>2]|=E<<24-f%4*8,f++}return s.create(m,f)}})(),i.enc.Base64url})}),Xo=yt((e,t)=>{(function(i,r){typeof e=="object"?t.exports=e=r(vt()):typeof define=="function"&&define.amd?define(["./core"],r):r(i.CryptoJS)})(e,function(i){return(function(r){var n=i,s=n.lib,a=s.WordArray,o=s.Hasher,l=n.algo,u=[];(function(){for(var y=0;y<64;y++)u[y]=r.abs(r.sin(y+1))*4294967296|0})();var c=l.MD5=o.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(y,b){for(var E=0;E<16;E++){var S=b+E,v=y[S];y[S]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360}var A=this._hash.words,x=y[b+0],T=y[b+1],R=y[b+2],L=y[b+3],O=y[b+4],H=y[b+5],k=y[b+6],ee=y[b+7],q=y[b+8],Q=y[b+9],ne=y[b+10],G=y[b+11],X=y[b+12],D=y[b+13],F=y[b+14],W=y[b+15],z=A[0],$=A[1],te=A[2],Z=A[3];z=h(z,$,te,Z,x,7,u[0]),Z=h(Z,z,$,te,T,12,u[1]),te=h(te,Z,z,$,R,17,u[2]),$=h($,te,Z,z,L,22,u[3]),z=h(z,$,te,Z,O,7,u[4]),Z=h(Z,z,$,te,H,12,u[5]),te=h(te,Z,z,$,k,17,u[6]),$=h($,te,Z,z,ee,22,u[7]),z=h(z,$,te,Z,q,7,u[8]),Z=h(Z,z,$,te,Q,12,u[9]),te=h(te,Z,z,$,ne,17,u[10]),$=h($,te,Z,z,G,22,u[11]),z=h(z,$,te,Z,X,7,u[12]),Z=h(Z,z,$,te,D,12,u[13]),te=h(te,Z,z,$,F,17,u[14]),$=h($,te,Z,z,W,22,u[15]),z=m(z,$,te,Z,T,5,u[16]),Z=m(Z,z,$,te,k,9,u[17]),te=m(te,Z,z,$,G,14,u[18]),$=m($,te,Z,z,x,20,u[19]),z=m(z,$,te,Z,H,5,u[20]),Z=m(Z,z,$,te,ne,9,u[21]),te=m(te,Z,z,$,W,14,u[22]),$=m($,te,Z,z,O,20,u[23]),z=m(z,$,te,Z,Q,5,u[24]),Z=m(Z,z,$,te,F,9,u[25]),te=m(te,Z,z,$,L,14,u[26]),$=m($,te,Z,z,q,20,u[27]),z=m(z,$,te,Z,D,5,u[28]),Z=m(Z,z,$,te,R,9,u[29]),te=m(te,Z,z,$,ee,14,u[30]),$=m($,te,Z,z,X,20,u[31]),z=f(z,$,te,Z,H,4,u[32]),Z=f(Z,z,$,te,q,11,u[33]),te=f(te,Z,z,$,G,16,u[34]),$=f($,te,Z,z,F,23,u[35]),z=f(z,$,te,Z,T,4,u[36]),Z=f(Z,z,$,te,O,11,u[37]),te=f(te,Z,z,$,ee,16,u[38]),$=f($,te,Z,z,ne,23,u[39]),z=f(z,$,te,Z,D,4,u[40]),Z=f(Z,z,$,te,x,11,u[41]),te=f(te,Z,z,$,L,16,u[42]),$=f($,te,Z,z,k,23,u[43]),z=f(z,$,te,Z,Q,4,u[44]),Z=f(Z,z,$,te,X,11,u[45]),te=f(te,Z,z,$,W,16,u[46]),$=f($,te,Z,z,R,23,u[47]),z=g(z,$,te,Z,x,6,u[48]),Z=g(Z,z,$,te,ee,10,u[49]),te=g(te,Z,z,$,F,15,u[50]),$=g($,te,Z,z,H,21,u[51]),z=g(z,$,te,Z,X,6,u[52]),Z=g(Z,z,$,te,L,10,u[53]),te=g(te,Z,z,$,ne,15,u[54]),$=g($,te,Z,z,T,21,u[55]),z=g(z,$,te,Z,q,6,u[56]),Z=g(Z,z,$,te,W,10,u[57]),te=g(te,Z,z,$,k,15,u[58]),$=g($,te,Z,z,D,21,u[59]),z=g(z,$,te,Z,O,6,u[60]),Z=g(Z,z,$,te,G,10,u[61]),te=g(te,Z,z,$,R,15,u[62]),$=g($,te,Z,z,Q,21,u[63]),A[0]=A[0]+z|0,A[1]=A[1]+$|0,A[2]=A[2]+te|0,A[3]=A[3]+Z|0},_doFinalize:function(){var y=this._data,b=y.words,E=this._nDataBytes*8,S=y.sigBytes*8;b[S>>>5]|=128<<24-S%32;var v=r.floor(E/4294967296),A=E;b[(S+64>>>9<<4)+15]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,b[(S+64>>>9<<4)+14]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,y.sigBytes=(b.length+1)*4,this._process();for(var x=this._hash,T=x.words,R=0;R<4;R++){var L=T[R];T[R]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360}return x},clone:function(){var y=o.clone.call(this);return y._hash=this._hash.clone(),y}});function h(y,b,E,S,v,A,x){var T=y+(b&E|~b&S)+v+x;return(T<<A|T>>>32-A)+b}function m(y,b,E,S,v,A,x){var T=y+(b&S|E&~S)+v+x;return(T<<A|T>>>32-A)+b}function f(y,b,E,S,v,A,x){var T=y+(b^E^S)+v+x;return(T<<A|T>>>32-A)+b}function g(y,b,E,S,v,A,x){var T=y+(E^(b|~S))+v+x;return(T<<A|T>>>32-A)+b}n.MD5=o._createHelper(c),n.HmacMD5=o._createHmacHelper(c)})(Math),i.MD5})}),Ex=yt((e,t)=>{(function(i,r){typeof e=="object"?t.exports=e=r(vt()):typeof define=="function"&&define.amd?define(["./core"],r):r(i.CryptoJS)})(e,function(i){return(function(){var r=i,n=r.lib,s=n.WordArray,a=n.Hasher,o=r.algo,l=[],u=o.SHA1=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(c,h){for(var m=this._hash.words,f=m[0],g=m[1],y=m[2],b=m[3],E=m[4],S=0;S<80;S++){if(S<16)l[S]=c[h+S]|0;else{var v=l[S-3]^l[S-8]^l[S-14]^l[S-16];l[S]=v<<1|v>>>31}var A=(f<<5|f>>>27)+E+l[S];S<20?A+=(g&y|~g&b)+1518500249:S<40?A+=(g^y^b)+1859775393:S<60?A+=(g&y|g&b|y&b)-1894007588:A+=(g^y^b)-899497514,E=b,b=y,y=g<<30|g>>>2,g=f,f=A}m[0]=m[0]+f|0,m[1]=m[1]+g|0,m[2]=m[2]+y|0,m[3]=m[3]+b|0,m[4]=m[4]+E|0},_doFinalize:function(){var c=this._data,h=c.words,m=this._nDataBytes*8,f=c.sigBytes*8;return h[f>>>5]|=128<<24-f%32,h[(f+64>>>9<<4)+14]=Math.floor(m/4294967296),h[(f+64>>>9<<4)+15]=m,c.sigBytes=h.length*4,this._process(),this._hash},clone:function(){var c=a.clone.call(this);return c._hash=this._hash.clone(),c}});r.SHA1=a._createHelper(u),r.HmacSHA1=a._createHmacHelper(u)})(),i.SHA1})}),e0=yt((e,t)=>{(function(i,r){typeof e=="object"?t.exports=e=r(vt()):typeof define=="function"&&define.amd?define(["./core"],r):r(i.CryptoJS)})(e,function(i){return(function(r){var n=i,s=n.lib,a=s.WordArray,o=s.Hasher,l=n.algo,u=[],c=[];(function(){function f(E){for(var S=r.sqrt(E),v=2;v<=S;v++)if(!(E%v))return!1;return!0}function g(E){return(E-(E|0))*4294967296|0}for(var y=2,b=0;b<64;)f(y)&&(b<8&&(u[b]=g(r.pow(y,1/2))),c[b]=g(r.pow(y,1/3)),b++),y++})();var h=[],m=l.SHA256=o.extend({_doReset:function(){this._hash=new a.init(u.slice(0))},_doProcessBlock:function(f,g){for(var y=this._hash.words,b=y[0],E=y[1],S=y[2],v=y[3],A=y[4],x=y[5],T=y[6],R=y[7],L=0;L<64;L++){if(L<16)h[L]=f[g+L]|0;else{var O=h[L-15],H=(O<<25|O>>>7)^(O<<14|O>>>18)^O>>>3,k=h[L-2],ee=(k<<15|k>>>17)^(k<<13|k>>>19)^k>>>10;h[L]=H+h[L-7]+ee+h[L-16]}var q=A&x^~A&T,Q=b&E^b&S^E&S,ne=(b<<30|b>>>2)^(b<<19|b>>>13)^(b<<10|b>>>22),G=(A<<26|A>>>6)^(A<<21|A>>>11)^(A<<7|A>>>25),X=R+G+q+c[L]+h[L],D=ne+Q;R=T,T=x,x=A,A=v+X|0,v=S,S=E,E=b,b=X+D|0}y[0]=y[0]+b|0,y[1]=y[1]+E|0,y[2]=y[2]+S|0,y[3]=y[3]+v|0,y[4]=y[4]+A|0,y[5]=y[5]+x|0,y[6]=y[6]+T|0,y[7]=y[7]+R|0},_doFinalize:function(){var f=this._data,g=f.words,y=this._nDataBytes*8,b=f.sigBytes*8;return g[b>>>5]|=128<<24-b%32,g[(b+64>>>9<<4)+14]=r.floor(y/4294967296),g[(b+64>>>9<<4)+15]=y,f.sigBytes=g.length*4,this._process(),this._hash},clone:function(){var f=o.clone.call(this);return f._hash=this._hash.clone(),f}});n.SHA256=o._createHelper(m),n.HmacSHA256=o._createHmacHelper(m)})(Math),i.SHA256})}),U7=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),e0()):typeof define=="function"&&define.amd?define(["./core","./sha256"],r):r(i.CryptoJS)})(e,function(i){return(function(){var r=i,n=r.lib,s=n.WordArray,a=r.algo,o=a.SHA256,l=a.SHA224=o.extend({_doReset:function(){this._hash=new s.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var u=o._doFinalize.call(this);return u.sigBytes-=4,u}});r.SHA224=o._createHelper(l),r.HmacSHA224=o._createHmacHelper(l)})(),i.SHA224})}),Sx=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Pf()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],r):r(i.CryptoJS)})(e,function(i){return(function(){var r=i,n=r.lib,s=n.Hasher,a=r.x64,o=a.Word,l=a.WordArray,u=r.algo;function c(){return o.create.apply(o,arguments)}var h=[c(1116352408,3609767458),c(1899447441,602891725),c(3049323471,3964484399),c(3921009573,2173295548),c(961987163,4081628472),c(1508970993,3053834265),c(2453635748,2937671579),c(2870763221,3664609560),c(3624381080,2734883394),c(310598401,1164996542),c(607225278,1323610764),c(1426881987,3590304994),c(1925078388,4068182383),c(2162078206,991336113),c(2614888103,633803317),c(3248222580,3479774868),c(3835390401,2666613458),c(4022224774,944711139),c(264347078,2341262773),c(604807628,2007800933),c(770255983,1495990901),c(1249150122,1856431235),c(1555081692,3175218132),c(1996064986,2198950837),c(2554220882,3999719339),c(2821834349,766784016),c(2952996808,2566594879),c(3210313671,3203337956),c(3336571891,1034457026),c(3584528711,2466948901),c(113926993,3758326383),c(338241895,168717936),c(666307205,1188179964),c(773529912,1546045734),c(1294757372,1522805485),c(1396182291,2643833823),c(1695183700,2343527390),c(1986661051,1014477480),c(2177026350,1206759142),c(2456956037,344077627),c(2730485921,1290863460),c(2820302411,3158454273),c(3259730800,3505952657),c(3345764771,106217008),c(3516065817,3606008344),c(3600352804,1432725776),c(4094571909,1467031594),c(275423344,851169720),c(430227734,3100823752),c(506948616,1363258195),c(659060556,3750685593),c(883997877,3785050280),c(958139571,3318307427),c(1322822218,3812723403),c(1537002063,2003034995),c(1747873779,3602036899),c(1955562222,1575990012),c(2024104815,1125592928),c(2227730452,2716904306),c(2361852424,442776044),c(2428436474,593698344),c(2756734187,3733110249),c(3204031479,2999351573),c(3329325298,3815920427),c(3391569614,3928383900),c(3515267271,566280711),c(3940187606,3454069534),c(4118630271,4000239992),c(116418474,1914138554),c(174292421,2731055270),c(289380356,3203993006),c(460393269,320620315),c(685471733,587496836),c(852142971,1086792851),c(1017036298,365543100),c(1126000580,2618297676),c(1288033470,3409855158),c(1501505948,4234509866),c(1607167915,987167468),c(1816402316,1246189591)],m=[];(function(){for(var g=0;g<80;g++)m[g]=c()})();var f=u.SHA512=s.extend({_doReset:function(){this._hash=new l.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(g,y){for(var b=this._hash.words,E=b[0],S=b[1],v=b[2],A=b[3],x=b[4],T=b[5],R=b[6],L=b[7],O=E.high,H=E.low,k=S.high,ee=S.low,q=v.high,Q=v.low,ne=A.high,G=A.low,X=x.high,D=x.low,F=T.high,W=T.low,z=R.high,$=R.low,te=L.high,Z=L.low,pe=O,Se=H,Ce=k,we=ee,Fe=q,Ue=Q,je=ne,me=G,Ae=X,We=D,tt=F,Ct=W,it=z,Ze=$,Ri=te,Jt=Z,di=0;di<80;di++){var hi,Ei,ln=m[di];if(di<16)Ei=ln.high=g[y+di*2]|0,hi=ln.low=g[y+di*2+1]|0;else{var xr=m[di-15],Xi=xr.high,pr=xr.low,ks=(Xi>>>1|pr<<31)^(Xi>>>8|pr<<24)^Xi>>>7,ss=(pr>>>1|Xi<<31)^(pr>>>8|Xi<<24)^(pr>>>7|Xi<<25),I=m[di-2],w=I.high,B=I.low,M=(w>>>19|B<<13)^(w<<3|B>>>29)^w>>>6,V=(B>>>19|w<<13)^(B<<3|w>>>29)^(B>>>6|w<<26),oe=m[di-7],ce=oe.high,Ie=oe.low,ze=m[di-16],$e=ze.high,xt=ze.low;hi=ss+Ie,Ei=ks+ce+(hi>>>0<ss>>>0?1:0),hi=hi+V,Ei=Ei+M+(hi>>>0<V>>>0?1:0),hi=hi+xt,Ei=Ei+$e+(hi>>>0<xt>>>0?1:0),ln.high=Ei,ln.low=hi}var si=Ae&tt^~Ae&it,Si=We&Ct^~We&Ze,On=pe&Ce^pe&Fe^Ce&Fe,Fs=Se&we^Se&Ue^we&Ue,as=(pe>>>28|Se<<4)^(pe<<30|Se>>>2)^(pe<<25|Se>>>7),un=(Se>>>28|pe<<4)^(Se<<30|pe>>>2)^(Se<<25|pe>>>7),jr=(Ae>>>14|We<<18)^(Ae>>>18|We<<14)^(Ae<<23|We>>>9),Yr=(We>>>14|Ae<<18)^(We>>>18|Ae<<14)^(We<<23|Ae>>>9),_l=h[di],dy=_l.high,bl=_l.low,fr=Jt+Yr,os=Ri+jr+(fr>>>0<Jt>>>0?1:0),fr=fr+Si,os=os+si+(fr>>>0<Si>>>0?1:0),fr=fr+bl,os=os+dy+(fr>>>0<bl>>>0?1:0),fr=fr+hi,os=os+Ei+(fr>>>0<hi>>>0?1:0),se=un+Fs,hy=as+On+(se>>>0<un>>>0?1:0);Ri=it,Jt=Ze,it=tt,Ze=Ct,tt=Ae,Ct=We,We=me+fr|0,Ae=je+os+(We>>>0<me>>>0?1:0)|0,je=Fe,me=Ue,Fe=Ce,Ue=we,Ce=pe,we=Se,Se=fr+se|0,pe=os+hy+(Se>>>0<fr>>>0?1:0)|0}H=E.low=H+Se,E.high=O+pe+(H>>>0<Se>>>0?1:0),ee=S.low=ee+we,S.high=k+Ce+(ee>>>0<we>>>0?1:0),Q=v.low=Q+Ue,v.high=q+Fe+(Q>>>0<Ue>>>0?1:0),G=A.low=G+me,A.high=ne+je+(G>>>0<me>>>0?1:0),D=x.low=D+We,x.high=X+Ae+(D>>>0<We>>>0?1:0),W=T.low=W+Ct,T.high=F+tt+(W>>>0<Ct>>>0?1:0),$=R.low=$+Ze,R.high=z+it+($>>>0<Ze>>>0?1:0),Z=L.low=Z+Jt,L.high=te+Ri+(Z>>>0<Jt>>>0?1:0)},_doFinalize:function(){var g=this._data,y=g.words,b=this._nDataBytes*8,E=g.sigBytes*8;y[E>>>5]|=128<<24-E%32,y[(E+128>>>10<<5)+30]=Math.floor(b/4294967296),y[(E+128>>>10<<5)+31]=b,g.sigBytes=y.length*4,this._process();var S=this._hash.toX32();return S},clone:function(){var g=s.clone.call(this);return g._hash=this._hash.clone(),g},blockSize:1024/32});r.SHA512=s._createHelper(f),r.HmacSHA512=s._createHmacHelper(f)})(),i.SHA512})}),H7=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Pf(),Sx()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./sha512"],r):r(i.CryptoJS)})(e,function(i){return(function(){var r=i,n=r.x64,s=n.Word,a=n.WordArray,o=r.algo,l=o.SHA512,u=o.SHA384=l.extend({_doReset:function(){this._hash=new a.init([new s.init(3418070365,3238371032),new s.init(1654270250,914150663),new s.init(2438529370,812702999),new s.init(355462360,4144912697),new s.init(1731405415,4290775857),new s.init(2394180231,1750603025),new s.init(3675008525,1694076839),new s.init(1203062813,3204075428)])},_doFinalize:function(){var c=l._doFinalize.call(this);return c.sigBytes-=16,c}});r.SHA384=l._createHelper(u),r.HmacSHA384=l._createHmacHelper(u)})(),i.SHA384})}),j7=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Pf()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],r):r(i.CryptoJS)})(e,function(i){return(function(r){var n=i,s=n.lib,a=s.WordArray,o=s.Hasher,l=n.x64,u=l.Word,c=n.algo,h=[],m=[],f=[];(function(){for(var b=1,E=0,S=0;S<24;S++){h[b+5*E]=(S+1)*(S+2)/2%64;var v=E%5,A=(2*b+3*E)%5;b=v,E=A}for(var b=0;b<5;b++)for(var E=0;E<5;E++)m[b+5*E]=E+(2*b+3*E)%5*5;for(var x=1,T=0;T<24;T++){for(var R=0,L=0,O=0;O<7;O++){if(x&1){var H=(1<<O)-1;H<32?L^=1<<H:R^=1<<H-32}x&128?x=x<<1^113:x<<=1}f[T]=u.create(R,L)}})();var g=[];(function(){for(var b=0;b<25;b++)g[b]=u.create()})();var y=c.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var b=this._state=[],E=0;E<25;E++)b[E]=new u.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(b,E){for(var S=this._state,v=this.blockSize/2,A=0;A<v;A++){var x=b[E+2*A],T=b[E+2*A+1];x=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,T=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360;var R=S[A];R.high^=T,R.low^=x}for(var L=0;L<24;L++){for(var O=0;O<5;O++){for(var H=0,k=0,ee=0;ee<5;ee++){var R=S[O+5*ee];H^=R.high,k^=R.low}var q=g[O];q.high=H,q.low=k}for(var O=0;O<5;O++)for(var Q=g[(O+4)%5],ne=g[(O+1)%5],G=ne.high,X=ne.low,H=Q.high^(G<<1|X>>>31),k=Q.low^(X<<1|G>>>31),ee=0;ee<5;ee++){var R=S[O+5*ee];R.high^=H,R.low^=k}for(var D=1;D<25;D++){var H,k,R=S[D],F=R.high,W=R.low,z=h[D];z<32?(H=F<<z|W>>>32-z,k=W<<z|F>>>32-z):(H=W<<z-32|F>>>64-z,k=F<<z-32|W>>>64-z);var $=g[m[D]];$.high=H,$.low=k}var te=g[0],Z=S[0];te.high=Z.high,te.low=Z.low;for(var O=0;O<5;O++)for(var ee=0;ee<5;ee++){var D=O+5*ee,R=S[D],pe=g[D],Se=g[(O+1)%5+5*ee],Ce=g[(O+2)%5+5*ee];R.high=pe.high^~Se.high&Ce.high,R.low=pe.low^~Se.low&Ce.low}var R=S[0],we=f[L];R.high^=we.high,R.low^=we.low}},_doFinalize:function(){var b=this._data,E=b.words,S=this._nDataBytes*8,v=b.sigBytes*8,A=this.blockSize*32;E[v>>>5]|=1<<24-v%32,E[(r.ceil((v+1)/A)*A>>>5)-1]|=128,b.sigBytes=E.length*4,this._process();for(var x=this._state,T=this.cfg.outputLength/8,R=T/8,L=[],O=0;O<R;O++){var H=x[O],k=H.high,ee=H.low;k=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,ee=(ee<<8|ee>>>24)&16711935|(ee<<24|ee>>>8)&4278255360,L.push(ee),L.push(k)}return new a.init(L,T)},clone:function(){for(var b=o.clone.call(this),E=b._state=this._state.slice(0),S=0;S<25;S++)E[S]=E[S].clone();return b}});n.SHA3=o._createHelper(y),n.HmacSHA3=o._createHmacHelper(y)})(Math),i.SHA3})}),Y7=yt((e,t)=>{(function(i,r){typeof e=="object"?t.exports=e=r(vt()):typeof define=="function"&&define.amd?define(["./core"],r):r(i.CryptoJS)})(e,function(i){return(function(r){var n=i,s=n.lib,a=s.WordArray,o=s.Hasher,l=n.algo,u=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),h=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),m=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),f=a.create([0,1518500249,1859775393,2400959708,2840853838]),g=a.create([1352829926,1548603684,1836072691,2053994217,0]),y=l.RIPEMD160=o.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(T,R){for(var L=0;L<16;L++){var O=R+L,H=T[O];T[O]=(H<<8|H>>>24)&16711935|(H<<24|H>>>8)&4278255360}var k=this._hash.words,ee=f.words,q=g.words,Q=u.words,ne=c.words,G=h.words,X=m.words,D,F,W,z,$,te,Z,pe,Se,Ce;te=D=k[0],Z=F=k[1],pe=W=k[2],Se=z=k[3],Ce=$=k[4];for(var we,L=0;L<80;L+=1)we=D+T[R+Q[L]]|0,L<16?we+=b(F,W,z)+ee[0]:L<32?we+=E(F,W,z)+ee[1]:L<48?we+=S(F,W,z)+ee[2]:L<64?we+=v(F,W,z)+ee[3]:we+=A(F,W,z)+ee[4],we=we|0,we=x(we,G[L]),we=we+$|0,D=$,$=z,z=x(W,10),W=F,F=we,we=te+T[R+ne[L]]|0,L<16?we+=A(Z,pe,Se)+q[0]:L<32?we+=v(Z,pe,Se)+q[1]:L<48?we+=S(Z,pe,Se)+q[2]:L<64?we+=E(Z,pe,Se)+q[3]:we+=b(Z,pe,Se)+q[4],we=we|0,we=x(we,X[L]),we=we+Ce|0,te=Ce,Ce=Se,Se=x(pe,10),pe=Z,Z=we;we=k[1]+W+Se|0,k[1]=k[2]+z+Ce|0,k[2]=k[3]+$+te|0,k[3]=k[4]+D+Z|0,k[4]=k[0]+F+pe|0,k[0]=we},_doFinalize:function(){var T=this._data,R=T.words,L=this._nDataBytes*8,O=T.sigBytes*8;R[O>>>5]|=128<<24-O%32,R[(O+64>>>9<<4)+14]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360,T.sigBytes=(R.length+1)*4,this._process();for(var H=this._hash,k=H.words,ee=0;ee<5;ee++){var q=k[ee];k[ee]=(q<<8|q>>>24)&16711935|(q<<24|q>>>8)&4278255360}return H},clone:function(){var T=o.clone.call(this);return T._hash=this._hash.clone(),T}});function b(T,R,L){return T^R^L}function E(T,R,L){return T&R|~T&L}function S(T,R,L){return(T|~R)^L}function v(T,R,L){return T&L|R&~L}function A(T,R,L){return T^(R|~L)}function x(T,R){return T<<R|T>>>32-R}n.RIPEMD160=o._createHelper(y),n.HmacRIPEMD160=o._createHmacHelper(y)})(Math),i.RIPEMD160})}),t0=yt((e,t)=>{(function(i,r){typeof e=="object"?t.exports=e=r(vt()):typeof define=="function"&&define.amd?define(["./core"],r):r(i.CryptoJS)})(e,function(i){(function(){var r=i,n=r.lib,s=n.Base,a=r.enc,o=a.Utf8,l=r.algo,u=l.HMAC=s.extend({init:function(c,h){c=this._hasher=new c.init,typeof h=="string"&&(h=o.parse(h));var m=c.blockSize,f=m*4;h.sigBytes>f&&(h=c.finalize(h)),h.clamp();for(var g=this._oKey=h.clone(),y=this._iKey=h.clone(),b=g.words,E=y.words,S=0;S<m;S++)b[S]^=1549556828,E[S]^=909522486;g.sigBytes=y.sigBytes=f,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var h=this._hasher,m=h.finalize(c);h.reset();var f=h.finalize(this._oKey.clone().concat(m));return f}})})()})}),G7=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),e0(),t0()):typeof define=="function"&&define.amd?define(["./core","./sha256","./hmac"],r):r(i.CryptoJS)})(e,function(i){return(function(){var r=i,n=r.lib,s=n.Base,a=n.WordArray,o=r.algo,l=o.SHA256,u=o.HMAC,c=o.PBKDF2=s.extend({cfg:s.extend({keySize:128/32,hasher:l,iterations:25e4}),init:function(h){this.cfg=this.cfg.extend(h)},compute:function(h,m){for(var f=this.cfg,g=u.create(f.hasher,h),y=a.create(),b=a.create([1]),E=y.words,S=b.words,v=f.keySize,A=f.iterations;E.length<v;){var x=g.update(m).finalize(b);g.reset();for(var T=x.words,R=T.length,L=x,O=1;O<A;O++){L=g.finalize(L),g.reset();for(var H=L.words,k=0;k<R;k++)T[k]^=H[k]}y.concat(x),S[0]++}return y.sigBytes=v*4,y}});r.PBKDF2=function(h,m,f){return c.create(f).compute(h,m)}})(),i.PBKDF2})}),qa=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Ex(),t0()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],r):r(i.CryptoJS)})(e,function(i){return(function(){var r=i,n=r.lib,s=n.Base,a=n.WordArray,o=r.algo,l=o.MD5,u=o.EvpKDF=s.extend({cfg:s.extend({keySize:128/32,hasher:l,iterations:1}),init:function(c){this.cfg=this.cfg.extend(c)},compute:function(c,h){for(var m,f=this.cfg,g=f.hasher.create(),y=a.create(),b=y.words,E=f.keySize,S=f.iterations;b.length<E;){m&&g.update(m),m=g.update(c).finalize(h),g.reset();for(var v=1;v<S;v++)m=g.finalize(m),g.reset();y.concat(m)}return y.sigBytes=E*4,y}});r.EvpKDF=function(c,h,m){return u.create(m).compute(c,h)}})(),i.EvpKDF})}),Vi=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),qa()):typeof define=="function"&&define.amd?define(["./core","./evpkdf"],r):r(i.CryptoJS)})(e,function(i){i.lib.Cipher||(function(r){var n=i,s=n.lib,a=s.Base,o=s.WordArray,l=s.BufferedBlockAlgorithm,u=n.enc,c=u.Utf8,h=u.Base64,m=n.algo,f=m.EvpKDF,g=s.Cipher=l.extend({cfg:a.extend(),createEncryptor:function(q,Q){return this.create(this._ENC_XFORM_MODE,q,Q)},createDecryptor:function(q,Q){return this.create(this._DEC_XFORM_MODE,q,Q)},init:function(q,Q,ne){this.cfg=this.cfg.extend(ne),this._xformMode=q,this._key=Q,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(q){return this._append(q),this._process()},finalize:function(q){q&&this._append(q);var Q=this._doFinalize();return Q},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function q(Q){return typeof Q=="string"?ee:O}return function(Q){return{encrypt:function(ne,G,X){return q(G).encrypt(Q,ne,G,X)},decrypt:function(ne,G,X){return q(G).decrypt(Q,ne,G,X)}}}})()}),y=s.StreamCipher=g.extend({_doFinalize:function(){var q=this._process(!0);return q},blockSize:1}),b=n.mode={},E=s.BlockCipherMode=a.extend({createEncryptor:function(q,Q){return this.Encryptor.create(q,Q)},createDecryptor:function(q,Q){return this.Decryptor.create(q,Q)},init:function(q,Q){this._cipher=q,this._iv=Q}}),S=b.CBC=(function(){var q=E.extend();q.Encryptor=q.extend({processBlock:function(ne,G){var X=this._cipher,D=X.blockSize;Q.call(this,ne,G,D),X.encryptBlock(ne,G),this._prevBlock=ne.slice(G,G+D)}}),q.Decryptor=q.extend({processBlock:function(ne,G){var X=this._cipher,D=X.blockSize,F=ne.slice(G,G+D);X.decryptBlock(ne,G),Q.call(this,ne,G,D),this._prevBlock=F}});function Q(ne,G,X){var D,F=this._iv;F?(D=F,this._iv=r):D=this._prevBlock;for(var W=0;W<X;W++)ne[G+W]^=D[W]}return q})(),v=n.pad={},A=v.Pkcs7={pad:function(q,Q){for(var ne=Q*4,G=ne-q.sigBytes%ne,X=G<<24|G<<16|G<<8|G,D=[],F=0;F<G;F+=4)D.push(X);var W=o.create(D,G);q.concat(W)},unpad:function(q){var Q=q.words[q.sigBytes-1>>>2]&255;q.sigBytes-=Q}},x=s.BlockCipher=g.extend({cfg:g.cfg.extend({mode:S,padding:A}),reset:function(){var q;g.reset.call(this);var Q=this.cfg,ne=Q.iv,G=Q.mode;this._xformMode==this._ENC_XFORM_MODE?q=G.createEncryptor:(q=G.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==q?this._mode.init(this,ne&&ne.words):(this._mode=q.call(G,this,ne&&ne.words),this._mode.__creator=q)},_doProcessBlock:function(q,Q){this._mode.processBlock(q,Q)},_doFinalize:function(){var q,Q=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(Q.pad(this._data,this.blockSize),q=this._process(!0)):(q=this._process(!0),Q.unpad(q)),q},blockSize:128/32}),T=s.CipherParams=a.extend({init:function(q){this.mixIn(q)},toString:function(q){return(q||this.formatter).stringify(this)}}),R=n.format={},L=R.OpenSSL={stringify:function(q){var Q,ne=q.ciphertext,G=q.salt;return G?Q=o.create([1398893684,1701076831]).concat(G).concat(ne):Q=ne,Q.toString(h)},parse:function(q){var Q,ne=h.parse(q),G=ne.words;return G[0]==1398893684&&G[1]==1701076831&&(Q=o.create(G.slice(2,4)),G.splice(0,4),ne.sigBytes-=16),T.create({ciphertext:ne,salt:Q})}},O=s.SerializableCipher=a.extend({cfg:a.extend({format:L}),encrypt:function(q,Q,ne,G){G=this.cfg.extend(G);var X=q.createEncryptor(ne,G),D=X.finalize(Q),F=X.cfg;return T.create({ciphertext:D,key:ne,iv:F.iv,algorithm:q,mode:F.mode,padding:F.padding,blockSize:q.blockSize,formatter:G.format})},decrypt:function(q,Q,ne,G){G=this.cfg.extend(G),Q=this._parse(Q,G.format);var X=q.createDecryptor(ne,G).finalize(Q.ciphertext);return X},_parse:function(q,Q){return typeof q=="string"?Q.parse(q,this):q}}),H=n.kdf={},k=H.OpenSSL={execute:function(q,Q,ne,G,X){if(G||(G=o.random(64/8)),X)var D=f.create({keySize:Q+ne,hasher:X}).compute(q,G);else var D=f.create({keySize:Q+ne}).compute(q,G);var F=o.create(D.words.slice(Q),ne*4);return D.sigBytes=Q*4,T.create({key:D,iv:F,salt:G})}},ee=s.PasswordBasedCipher=O.extend({cfg:O.cfg.extend({kdf:k}),encrypt:function(q,Q,ne,G){G=this.cfg.extend(G);var X=G.kdf.execute(ne,q.keySize,q.ivSize,G.salt,G.hasher);G.iv=X.iv;var D=O.encrypt.call(this,q,Q,X.key,G);return D.mixIn(X),D},decrypt:function(q,Q,ne,G){G=this.cfg.extend(G),Q=this._parse(Q,G.format);var X=G.kdf.execute(ne,q.keySize,q.ivSize,Q.salt,G.hasher);G.iv=X.iv;var D=O.decrypt.call(this,q,Q,X.key,G);return D}})})()})}),W7=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Vi()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return i.mode.CFB=(function(){var r=i.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(s,a){var o=this._cipher,l=o.blockSize;n.call(this,s,a,l,o),this._prevBlock=s.slice(a,a+l)}}),r.Decryptor=r.extend({processBlock:function(s,a){var o=this._cipher,l=o.blockSize,u=s.slice(a,a+l);n.call(this,s,a,l,o),this._prevBlock=u}});function n(s,a,o,l){var u,c=this._iv;c?(u=c.slice(0),this._iv=void 0):u=this._prevBlock,l.encryptBlock(u,0);for(var h=0;h<o;h++)s[a+h]^=u[h]}return r})(),i.mode.CFB})}),z7=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Vi()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return i.mode.CTR=(function(){var r=i.lib.BlockCipherMode.extend(),n=r.Encryptor=r.extend({processBlock:function(s,a){var o=this._cipher,l=o.blockSize,u=this._iv,c=this._counter;u&&(c=this._counter=u.slice(0),this._iv=void 0);var h=c.slice(0);o.encryptBlock(h,0),c[l-1]=c[l-1]+1|0;for(var m=0;m<l;m++)s[a+m]^=h[m]}});return r.Decryptor=n,r})(),i.mode.CTR})}),V7=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Vi()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return i.mode.CTRGladman=(function(){var r=i.lib.BlockCipherMode.extend();function n(o){if((o>>24&255)===255){var l=o>>16&255,u=o>>8&255,c=o&255;l===255?(l=0,u===255?(u=0,c===255?c=0:++c):++u):++l,o=0,o+=l<<16,o+=u<<8,o+=c}else o+=1<<24;return o}function s(o){return(o[0]=n(o[0]))===0&&(o[1]=n(o[1])),o}var a=r.Encryptor=r.extend({processBlock:function(o,l){var u=this._cipher,c=u.blockSize,h=this._iv,m=this._counter;h&&(m=this._counter=h.slice(0),this._iv=void 0),s(m);var f=m.slice(0);u.encryptBlock(f,0);for(var g=0;g<c;g++)o[l+g]^=f[g]}});return r.Decryptor=a,r})(),i.mode.CTRGladman})}),q7=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Vi()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return i.mode.OFB=(function(){var r=i.lib.BlockCipherMode.extend(),n=r.Encryptor=r.extend({processBlock:function(s,a){var o=this._cipher,l=o.blockSize,u=this._iv,c=this._keystream;u&&(c=this._keystream=u.slice(0),this._iv=void 0),o.encryptBlock(c,0);for(var h=0;h<l;h++)s[a+h]^=c[h]}});return r.Decryptor=n,r})(),i.mode.OFB})}),X7=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Vi()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return i.mode.ECB=(function(){var r=i.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(n,s){this._cipher.encryptBlock(n,s)}}),r.Decryptor=r.extend({processBlock:function(n,s){this._cipher.decryptBlock(n,s)}}),r})(),i.mode.ECB})}),J7=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Vi()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return i.pad.AnsiX923={pad:function(r,n){var s=r.sigBytes,a=n*4,o=a-s%a,l=s+o-1;r.clamp(),r.words[l>>>2]|=o<<24-l%4*8,r.sigBytes+=o},unpad:function(r){var n=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=n}},i.pad.Ansix923})}),$7=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Vi()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return i.pad.Iso10126={pad:function(r,n){var s=n*4,a=s-r.sigBytes%s;r.concat(i.lib.WordArray.random(a-1)).concat(i.lib.WordArray.create([a<<24],1))},unpad:function(r){var n=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=n}},i.pad.Iso10126})}),K7=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Vi()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return i.pad.Iso97971={pad:function(r,n){r.concat(i.lib.WordArray.create([2147483648],1)),i.pad.ZeroPadding.pad(r,n)},unpad:function(r){i.pad.ZeroPadding.unpad(r),r.sigBytes--}},i.pad.Iso97971})}),Z7=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Vi()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return i.pad.ZeroPadding={pad:function(r,n){var s=n*4;r.clamp(),r.sigBytes+=s-(r.sigBytes%s||s)},unpad:function(r){for(var n=r.words,s=r.sigBytes-1,s=r.sigBytes-1;s>=0;s--)if(n[s>>>2]>>>24-s%4*8&255){r.sigBytes=s+1;break}}},i.pad.ZeroPadding})}),Q7=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Vi()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return i.pad.NoPadding={pad:function(){},unpad:function(){}},i.pad.NoPadding})}),e9=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Vi()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return(function(r){var n=i,s=n.lib,a=s.CipherParams,o=n.enc,l=o.Hex,u=n.format,c=u.Hex={stringify:function(h){return h.ciphertext.toString(l)},parse:function(h){var m=l.parse(h);return a.create({ciphertext:m})}}})(),i.format.Hex})}),t9=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),qo(),Xo(),qa(),Vi()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return(function(){var r=i,n=r.lib,s=n.BlockCipher,a=r.algo,o=[],l=[],u=[],c=[],h=[],m=[],f=[],g=[],y=[],b=[];(function(){for(var v=[],A=0;A<256;A++)A<128?v[A]=A<<1:v[A]=A<<1^283;for(var x=0,T=0,A=0;A<256;A++){var R=T^T<<1^T<<2^T<<3^T<<4;R=R>>>8^R&255^99,o[x]=R,l[R]=x;var L=v[x],O=v[L],H=v[O],k=v[R]*257^R*16843008;u[x]=k<<24|k>>>8,c[x]=k<<16|k>>>16,h[x]=k<<8|k>>>24,m[x]=k;var k=H*16843009^O*65537^L*257^x*16843008;f[R]=k<<24|k>>>8,g[R]=k<<16|k>>>16,y[R]=k<<8|k>>>24,b[R]=k,x?(x=L^v[v[v[H^L]]],T^=v[v[T]]):x=T=1}})();var E=[0,1,2,4,8,16,32,64,128,27,54],S=a.AES=s.extend({_doReset:function(){var v;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var A=this._keyPriorReset=this._key,x=A.words,T=A.sigBytes/4,R=this._nRounds=T+6,L=(R+1)*4,O=this._keySchedule=[],H=0;H<L;H++)H<T?O[H]=x[H]:(v=O[H-1],H%T?T>6&&H%T==4&&(v=o[v>>>24]<<24|o[v>>>16&255]<<16|o[v>>>8&255]<<8|o[v&255]):(v=v<<8|v>>>24,v=o[v>>>24]<<24|o[v>>>16&255]<<16|o[v>>>8&255]<<8|o[v&255],v^=E[H/T|0]<<24),O[H]=O[H-T]^v);for(var k=this._invKeySchedule=[],ee=0;ee<L;ee++){var H=L-ee;if(ee%4)var v=O[H];else var v=O[H-4];ee<4||H<=4?k[ee]=v:k[ee]=f[o[v>>>24]]^g[o[v>>>16&255]]^y[o[v>>>8&255]]^b[o[v&255]]}}},encryptBlock:function(v,A){this._doCryptBlock(v,A,this._keySchedule,u,c,h,m,o)},decryptBlock:function(v,A){var x=v[A+1];v[A+1]=v[A+3],v[A+3]=x,this._doCryptBlock(v,A,this._invKeySchedule,f,g,y,b,l);var x=v[A+1];v[A+1]=v[A+3],v[A+3]=x},_doCryptBlock:function(v,A,x,T,R,L,O,H){for(var k=this._nRounds,ee=v[A]^x[0],q=v[A+1]^x[1],Q=v[A+2]^x[2],ne=v[A+3]^x[3],G=4,X=1;X<k;X++){var D=T[ee>>>24]^R[q>>>16&255]^L[Q>>>8&255]^O[ne&255]^x[G++],F=T[q>>>24]^R[Q>>>16&255]^L[ne>>>8&255]^O[ee&255]^x[G++],W=T[Q>>>24]^R[ne>>>16&255]^L[ee>>>8&255]^O[q&255]^x[G++],z=T[ne>>>24]^R[ee>>>16&255]^L[q>>>8&255]^O[Q&255]^x[G++];ee=D,q=F,Q=W,ne=z}var D=(H[ee>>>24]<<24|H[q>>>16&255]<<16|H[Q>>>8&255]<<8|H[ne&255])^x[G++],F=(H[q>>>24]<<24|H[Q>>>16&255]<<16|H[ne>>>8&255]<<8|H[ee&255])^x[G++],W=(H[Q>>>24]<<24|H[ne>>>16&255]<<16|H[ee>>>8&255]<<8|H[q&255])^x[G++],z=(H[ne>>>24]<<24|H[ee>>>16&255]<<16|H[q>>>8&255]<<8|H[Q&255])^x[G++];v[A]=D,v[A+1]=F,v[A+2]=W,v[A+3]=z},keySize:256/32});r.AES=s._createHelper(S)})(),i.AES})}),i9=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),qo(),Xo(),qa(),Vi()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return(function(){var r=i,n=r.lib,s=n.WordArray,a=n.BlockCipher,o=r.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],u=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],h=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],m=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],f=o.DES=a.extend({_doReset:function(){for(var E=this._key,S=E.words,v=[],A=0;A<56;A++){var x=l[A]-1;v[A]=S[x>>>5]>>>31-x%32&1}for(var T=this._subKeys=[],R=0;R<16;R++){for(var L=T[R]=[],O=c[R],A=0;A<24;A++)L[A/6|0]|=v[(u[A]-1+O)%28]<<31-A%6,L[4+(A/6|0)]|=v[28+(u[A+24]-1+O)%28]<<31-A%6;L[0]=L[0]<<1|L[0]>>>31;for(var A=1;A<7;A++)L[A]=L[A]>>>(A-1)*4+3;L[7]=L[7]<<5|L[7]>>>27}for(var H=this._invSubKeys=[],A=0;A<16;A++)H[A]=T[15-A]},encryptBlock:function(E,S){this._doCryptBlock(E,S,this._subKeys)},decryptBlock:function(E,S){this._doCryptBlock(E,S,this._invSubKeys)},_doCryptBlock:function(E,S,v){this._lBlock=E[S],this._rBlock=E[S+1],g.call(this,4,252645135),g.call(this,16,65535),y.call(this,2,858993459),y.call(this,8,16711935),g.call(this,1,1431655765);for(var A=0;A<16;A++){for(var x=v[A],T=this._lBlock,R=this._rBlock,L=0,O=0;O<8;O++)L|=h[O][((R^x[O])&m[O])>>>0];this._lBlock=R,this._rBlock=T^L}var H=this._lBlock;this._lBlock=this._rBlock,this._rBlock=H,g.call(this,1,1431655765),y.call(this,8,16711935),y.call(this,2,858993459),g.call(this,16,65535),g.call(this,4,252645135),E[S]=this._lBlock,E[S+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function g(E,S){var v=(this._lBlock>>>E^this._rBlock)&S;this._rBlock^=v,this._lBlock^=v<<E}function y(E,S){var v=(this._rBlock>>>E^this._lBlock)&S;this._lBlock^=v,this._rBlock^=v<<E}r.DES=a._createHelper(f);var b=o.TripleDES=a.extend({_doReset:function(){var E=this._key,S=E.words;if(S.length!==2&&S.length!==4&&S.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var v=S.slice(0,2),A=S.length<4?S.slice(0,2):S.slice(2,4),x=S.length<6?S.slice(0,2):S.slice(4,6);this._des1=f.createEncryptor(s.create(v)),this._des2=f.createEncryptor(s.create(A)),this._des3=f.createEncryptor(s.create(x))},encryptBlock:function(E,S){this._des1.encryptBlock(E,S),this._des2.decryptBlock(E,S),this._des3.encryptBlock(E,S)},decryptBlock:function(E,S){this._des3.decryptBlock(E,S),this._des2.encryptBlock(E,S),this._des1.decryptBlock(E,S)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=a._createHelper(b)})(),i.TripleDES})}),r9=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),qo(),Xo(),qa(),Vi()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return(function(){var r=i,n=r.lib,s=n.StreamCipher,a=r.algo,o=a.RC4=s.extend({_doReset:function(){for(var c=this._key,h=c.words,m=c.sigBytes,f=this._S=[],g=0;g<256;g++)f[g]=g;for(var g=0,y=0;g<256;g++){var b=g%m,E=h[b>>>2]>>>24-b%4*8&255;y=(y+f[g]+E)%256;var S=f[g];f[g]=f[y],f[y]=S}this._i=this._j=0},_doProcessBlock:function(c,h){c[h]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var c=this._S,h=this._i,m=this._j,f=0,g=0;g<4;g++){h=(h+1)%256,m=(m+c[h])%256;var y=c[h];c[h]=c[m],c[m]=y,f|=c[(c[h]+c[m])%256]<<24-g*8}return this._i=h,this._j=m,f}r.RC4=s._createHelper(o);var u=a.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var c=this.cfg.drop;c>0;c--)l.call(this)}});r.RC4Drop=s._createHelper(u)})(),i.RC4})}),n9=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),qo(),Xo(),qa(),Vi()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return(function(){var r=i,n=r.lib,s=n.StreamCipher,a=r.algo,o=[],l=[],u=[],c=a.Rabbit=s.extend({_doReset:function(){for(var m=this._key.words,f=this.cfg.iv,g=0;g<4;g++)m[g]=(m[g]<<8|m[g]>>>24)&16711935|(m[g]<<24|m[g]>>>8)&4278255360;var y=this._X=[m[0],m[3]<<16|m[2]>>>16,m[1],m[0]<<16|m[3]>>>16,m[2],m[1]<<16|m[0]>>>16,m[3],m[2]<<16|m[1]>>>16],b=this._C=[m[2]<<16|m[2]>>>16,m[0]&4294901760|m[1]&65535,m[3]<<16|m[3]>>>16,m[1]&4294901760|m[2]&65535,m[0]<<16|m[0]>>>16,m[2]&4294901760|m[3]&65535,m[1]<<16|m[1]>>>16,m[3]&4294901760|m[0]&65535];this._b=0;for(var g=0;g<4;g++)h.call(this);for(var g=0;g<8;g++)b[g]^=y[g+4&7];if(f){var E=f.words,S=E[0],v=E[1],A=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,x=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,T=A>>>16|x&4294901760,R=x<<16|A&65535;b[0]^=A,b[1]^=T,b[2]^=x,b[3]^=R,b[4]^=A,b[5]^=T,b[6]^=x,b[7]^=R;for(var g=0;g<4;g++)h.call(this)}},_doProcessBlock:function(m,f){var g=this._X;h.call(this),o[0]=g[0]^g[5]>>>16^g[3]<<16,o[1]=g[2]^g[7]>>>16^g[5]<<16,o[2]=g[4]^g[1]>>>16^g[7]<<16,o[3]=g[6]^g[3]>>>16^g[1]<<16;for(var y=0;y<4;y++)o[y]=(o[y]<<8|o[y]>>>24)&16711935|(o[y]<<24|o[y]>>>8)&4278255360,m[f+y]^=o[y]},blockSize:128/32,ivSize:64/32});function h(){for(var m=this._X,f=this._C,g=0;g<8;g++)l[g]=f[g];f[0]=f[0]+1295307597+this._b|0,f[1]=f[1]+3545052371+(f[0]>>>0<l[0]>>>0?1:0)|0,f[2]=f[2]+886263092+(f[1]>>>0<l[1]>>>0?1:0)|0,f[3]=f[3]+1295307597+(f[2]>>>0<l[2]>>>0?1:0)|0,f[4]=f[4]+3545052371+(f[3]>>>0<l[3]>>>0?1:0)|0,f[5]=f[5]+886263092+(f[4]>>>0<l[4]>>>0?1:0)|0,f[6]=f[6]+1295307597+(f[5]>>>0<l[5]>>>0?1:0)|0,f[7]=f[7]+3545052371+(f[6]>>>0<l[6]>>>0?1:0)|0,this._b=f[7]>>>0<l[7]>>>0?1:0;for(var g=0;g<8;g++){var y=m[g]+f[g],b=y&65535,E=y>>>16,S=((b*b>>>17)+b*E>>>15)+E*E,v=((y&4294901760)*y|0)+((y&65535)*y|0);u[g]=S^v}m[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,m[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,m[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,m[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,m[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,m[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,m[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,m[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}r.Rabbit=s._createHelper(c)})(),i.Rabbit})}),s9=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),qo(),Xo(),qa(),Vi()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return(function(){var r=i,n=r.lib,s=n.StreamCipher,a=r.algo,o=[],l=[],u=[],c=a.RabbitLegacy=s.extend({_doReset:function(){var m=this._key.words,f=this.cfg.iv,g=this._X=[m[0],m[3]<<16|m[2]>>>16,m[1],m[0]<<16|m[3]>>>16,m[2],m[1]<<16|m[0]>>>16,m[3],m[2]<<16|m[1]>>>16],y=this._C=[m[2]<<16|m[2]>>>16,m[0]&4294901760|m[1]&65535,m[3]<<16|m[3]>>>16,m[1]&4294901760|m[2]&65535,m[0]<<16|m[0]>>>16,m[2]&4294901760|m[3]&65535,m[1]<<16|m[1]>>>16,m[3]&4294901760|m[0]&65535];this._b=0;for(var b=0;b<4;b++)h.call(this);for(var b=0;b<8;b++)y[b]^=g[b+4&7];if(f){var E=f.words,S=E[0],v=E[1],A=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,x=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,T=A>>>16|x&4294901760,R=x<<16|A&65535;y[0]^=A,y[1]^=T,y[2]^=x,y[3]^=R,y[4]^=A,y[5]^=T,y[6]^=x,y[7]^=R;for(var b=0;b<4;b++)h.call(this)}},_doProcessBlock:function(m,f){var g=this._X;h.call(this),o[0]=g[0]^g[5]>>>16^g[3]<<16,o[1]=g[2]^g[7]>>>16^g[5]<<16,o[2]=g[4]^g[1]>>>16^g[7]<<16,o[3]=g[6]^g[3]>>>16^g[1]<<16;for(var y=0;y<4;y++)o[y]=(o[y]<<8|o[y]>>>24)&16711935|(o[y]<<24|o[y]>>>8)&4278255360,m[f+y]^=o[y]},blockSize:128/32,ivSize:64/32});function h(){for(var m=this._X,f=this._C,g=0;g<8;g++)l[g]=f[g];f[0]=f[0]+1295307597+this._b|0,f[1]=f[1]+3545052371+(f[0]>>>0<l[0]>>>0?1:0)|0,f[2]=f[2]+886263092+(f[1]>>>0<l[1]>>>0?1:0)|0,f[3]=f[3]+1295307597+(f[2]>>>0<l[2]>>>0?1:0)|0,f[4]=f[4]+3545052371+(f[3]>>>0<l[3]>>>0?1:0)|0,f[5]=f[5]+886263092+(f[4]>>>0<l[4]>>>0?1:0)|0,f[6]=f[6]+1295307597+(f[5]>>>0<l[5]>>>0?1:0)|0,f[7]=f[7]+3545052371+(f[6]>>>0<l[6]>>>0?1:0)|0,this._b=f[7]>>>0<l[7]>>>0?1:0;for(var g=0;g<8;g++){var y=m[g]+f[g],b=y&65535,E=y>>>16,S=((b*b>>>17)+b*E>>>15)+E*E,v=((y&4294901760)*y|0)+((y&65535)*y|0);u[g]=S^v}m[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,m[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,m[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,m[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,m[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,m[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,m[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,m[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}r.RabbitLegacy=s._createHelper(c)})(),i.RabbitLegacy})}),a9=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),qo(),Xo(),qa(),Vi()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],r):r(i.CryptoJS)})(e,function(i){return(function(){var r=i,n=r.lib,s=n.BlockCipher,a=r.algo;let o=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],u=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var c={pbox:[],sbox:[]};function h(b,E){let S=E>>24&255,v=E>>16&255,A=E>>8&255,x=E&255,T=b.sbox[0][S]+b.sbox[1][v];return T=T^b.sbox[2][A],T=T+b.sbox[3][x],T}function m(b,E,S){let v=E,A=S,x;for(let T=0;T<o;++T)v=v^b.pbox[T],A=h(b,v)^A,x=v,v=A,A=x;return x=v,v=A,A=x,A=A^b.pbox[o],v=v^b.pbox[o+1],{left:v,right:A}}function f(b,E,S){let v=E,A=S,x;for(let T=o+1;T>1;--T)v=v^b.pbox[T],A=h(b,v)^A,x=v,v=A,A=x;return x=v,v=A,A=x,A=A^b.pbox[1],v=v^b.pbox[0],{left:v,right:A}}function g(b,E,S){for(let R=0;R<4;R++){b.sbox[R]=[];for(let L=0;L<256;L++)b.sbox[R][L]=u[R][L]}let v=0;for(let R=0;R<o+2;R++)b.pbox[R]=l[R]^E[v],v++,v>=S&&(v=0);let A=0,x=0,T=0;for(let R=0;R<o+2;R+=2)T=m(b,A,x),A=T.left,x=T.right,b.pbox[R]=A,b.pbox[R+1]=x;for(let R=0;R<4;R++)for(let L=0;L<256;L+=2)T=m(b,A,x),A=T.left,x=T.right,b.sbox[R][L]=A,b.sbox[R][L+1]=x;return!0}var y=a.Blowfish=s.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var b=this._keyPriorReset=this._key,E=b.words,S=b.sigBytes/4;g(c,E,S)}},encryptBlock:function(b,E){var S=m(c,b[E],b[E+1]);b[E]=S.left,b[E+1]=S.right},decryptBlock:function(b,E){var S=f(c,b[E],b[E+1]);b[E]=S.left,b[E+1]=S.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=s._createHelper(y)})(),i.Blowfish})}),o9=yt((e,t)=>{(function(i,r,n){typeof e=="object"?t.exports=e=r(vt(),Pf(),M7(),k7(),qo(),F7(),Xo(),Ex(),e0(),U7(),Sx(),H7(),j7(),Y7(),t0(),G7(),qa(),Vi(),W7(),z7(),V7(),q7(),X7(),J7(),$7(),K7(),Z7(),Q7(),e9(),t9(),i9(),r9(),n9(),s9(),a9()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./lib-typedarrays","./enc-utf16","./enc-base64","./enc-base64url","./md5","./sha1","./sha256","./sha224","./sha512","./sha384","./sha3","./ripemd160","./hmac","./pbkdf2","./evpkdf","./cipher-core","./mode-cfb","./mode-ctr","./mode-ctr-gladman","./mode-ofb","./mode-ecb","./pad-ansix923","./pad-iso10126","./pad-iso97971","./pad-zeropadding","./pad-nopadding","./format-hex","./aes","./tripledes","./rc4","./rabbit","./rabbit-legacy","./blowfish"],r):i.CryptoJS=r(i.CryptoJS)})(e,function(i){return i})}),l9=(e=>(e.Device="Device",e.Symbol="Symbol",e.Footprint="Footprint",e.OBJ="OBJ",e.ModelID="3D Model",e.ModelName="3D Model Title",e.ModelTransform="3D Model Transform",e.OriginFootprint="Origin Footprint",e))(l9||{}),zc=(e=>(e.DOCHEAD="DOCHEAD",e.EDIT_HEAD="EDIT_HEAD",e.SCH="SCH",e.SCH_PAGE="SCH_PAGE",e.PCB="PCB",e.PANEL="PANEL",e.PANEL_LIB="PANEL_LIB",e.SYMBOL="SYMBOL",e.FOOTPRINT="FOOTPRINT",e.DEVICE="DEVICE",e.BLOB="BLOB",e.INSTANCE="INSTANCE",e.CONFIG="CONFIG",e.BOARD="BOARD",e.FONT="FONT",e.VARIANT="VARIANT",e.COMPONENT_GROUP="COMPONENT_GROUP",e.COMPONENT_GROUP_DATA="COMPONENT_GROUP_DATA",e.SIMULATION="SIMULATION",e))(zc||{}),u9=(e=>(e.META="META",e.META_SORT="META_SORT",e.META_CREATE="META_CREATE",e.META_MODIFY="META_MODIFY",e.FONT="FONT",e.BLOB="BLOB",e.MAX_NUM="MAX_NUM",e.INSTANCE_ATTR="INSTANCE_ATTR",e.DELETE_DOC="DELETE_DOC",e.META_Z_INDEX="META_Z_INDEX",e.VARIANT_GROUPED="VARIANT_GROUPED",e.GROUP_INDEX="GROUP_INDEX",e.GROUP_DATA="GROUP_DATA",e.RULE_TEMPLATE="RULE_TEMPLATE",e.RULE="RULE",e.RULE_SELECTOR="RULE_SELECTOR",e.ELE_PLACEHOLDER="ELE_PLACEHOLDER",e.META_PLACEHOLDER="META_PLACEHOLDER",e))(u9||{}),Wn="||",ui=`|
`;function Vc(e,t,i){return e.slice(t,i)}function Kp(e,t,i){let r=e.length,n=0;for(;n<r;){let s=e.indexOf(ui,n);if(s<0){if(i)return e.substring(n);s=r}let a=Vc(e,n,s);try{if(a){let o=a.indexOf(Wn),l=o>-1,u=l?Vc(a,0,o):a,c=l?Vc(a,o+Wn.length):"";if(t(u,c,a,l?n+o+Wn.length:n)===!1){a=null;break}a=null}}catch(o){console.error(o)}n=s+ui.length}e=null}var c9=class{parseFull(e,t,i){let r=t,n=i,s,a=null;Kp(e,(o,l,u)=>{let c=JSON.parse(o);if(c.type==="EDIT_HEAD")a=JSON.parse(l),this.onEditHead&&this.onEditHead(a);else if(c.type==="DOCHEAD"){let h=JSON.parse(l);n=h.docType,r=h.uuid,s=h.client,h.ticket=c.ticket,this.onDocHead(h,a,u)}else this.onLine(c.id,c.ticket,l,c.type,c.client||s,n,r,c.firstTicket,c.pend,a,c.num,u)}),this.onEnd(),e=null}flowParseFull(e={}){let{cache:t,chunkLength:i=100*1024*1024,idsData:r,history:n}=e,s="",a=null,o,l=null,u=!0,c="",h=0,m={},f=t?{}:void 0,g=E=>{f[E]===void 0&&(f[E]=-1),t(E,++f[E],m[E].data.join(ui)),m[E].data.length=0,m[E].size=0,m[E].data.push(m[E].head),m[E].size+=m[E].head.length},y=E=>{t&&(m[s].data.push(E),m[s].size+=(m[s].size?ui.length:0)+E.length,m[s].size+E.length>i&&g(s))},b=(E,S)=>Kp(E,(v,A,x,T)=>{var L,O,H,k,ee;let R=JSON.parse(v);if(R.type==="EDIT_HEAD")l=JSON.parse(A),(L=this.onEditHead)==null||L.call(this,l),(O=e.onEditHead)==null||O.call(e,l);else if(R.type==="DOCHEAD"){let q=JSON.parse(A);a=q.docType,s=q.uuid,o=q.client,q.ticket=R.ticket,this.onDocHead(q,l,x),t&&!m[s]&&(m[s]={size:0,data:[],head:""}),t&&(m[s].head=x),y(x)}else{let q=R.num,Q=R.client||o;if(r){let ne=(ee=(k=(H=r.ids)==null?void 0:H[s])==null?void 0:k[Q])==null?void 0:ee[R.id];if(!ne||ne[0]!==R.ticket)return;q=ne[1],r.size-=1,delete r.ids[s][Q][R.id]}n&&(t&&(n.dNum=(f==null?void 0:f[s])===void 0?0:(f==null?void 0:f[s])+1),n.start=t?m[s].size+ui.length+v.length+Wn.length:h+T),this.onLine(R.id,R.ticket,A,R.type,Q,a,s,R.firstTicket,R.pend,l||(n==null?void 0:n.editHead),q,x,n),y(x)}},S);return{start:()=>{u=!0},end:()=>{if(c&&b(c,!1),t)for(let E in m)m[E].size&&m[E].data.length>1&&g(E),m[E]=null;u=!1,c="",s="",s=null,o="",l=null,this.onEnd()},update:E=>{if(!u)throw new Error("\u66F4\u65B0\u524D\u672A\u8C03\u7528 start \u65B9\u6CD5");let S=b(c+E,!0);h=h+c.length+E.length-((S==null?void 0:S.length)||0),c="",S&&(c=S)},docMap:f}}parseLine(e,t,i){let r=e.indexOf(Wn),n=r!==-1,s=n?Vc(e,0,r):e,a=n?Vc(e,r+Wn.length):"",o=JSON.parse(s);this.onLine(o.id,o.ticket,a,o.type,o.client,i,t,o.firstTicket,o.pend,void 0,o.num,e),e=null}onEditHead(e){}},tb=new Uint8Array(8);function cr(){crypto.getRandomValues(tb);let e="";for(let t=0;t<tb.length;t++)e+=tb[t].toString(16).padStart(2,"0");return e}function Fo(e,t,i,r,n,s,a){let o={docType:e,client:t,uuid:i};return(r||r===0)&&(o.updateTime=r),(n||o.updateTime||o.updateTime===0)&&(o.version=n||String(r)),s&&(o.user=s),`${JSON.stringify({type:"DOCHEAD",ticket:a})}${Wn}${JSON.stringify(o)}`}function kr(e,t,i,r,n,s,a,o){let l={type:e,ticket:t,id:i};return s!==void 0&&(l.firstTicket=s),a!==void 0&&(l.pend=a),o!==void 0&&(l.num=o),n&&(l.client=n),`${JSON.stringify(l)}${Wn}${r}`}var vx=class extends c9{constructor(e){super(),this.unique=cr(),this.maxTicket=0,this.isPendChange=!0,this.isLocalChange=!0,this.cbArr=[],this.tempLocalIds={},this.client=e||cr()}onLine(e,t,i,r,n,s,a,o,l,u,c){this.remoteChange(t,n,a,e,i,r,s,void 0,o,l,u,void 0,void 0,c)}getUnique(){return this.unique}onDocHead(e,t){}onEnd(){}setIsPendChange(e){this.isPendChange=e}getIsPendChange(){return this.isPendChange}getMaxTicket(){return this.maxTicket}setMaxTicket(e,t){e&&(t||this.maxTicket<e)&&(this.maxTicket=e)}setIsLocalChange(e){this.isLocalChange=e}getIsLocalChange(){return this.isLocalChange}revoke(e,t,i,r,n,s,a,o,l,u,c){var h;if(!((h=this.tempLocalIds[e])!=null&&h[t]))return c?c(t,n,i,a,`${r}-1`,e,s,void 0,void 0,!0,u):this.cbArr.forEach(m=>m(e,t,i,a,`${r}-1`,n,void 0,s,void 0,void 0,void 0,u)),!0}getRandomUuid(){return cr()}getClient(){return this.client}onChange(e){this.cbArr.push(e)}localChange(e,t,i,r,n,s){let a=this.maxTicket+1;return this.tempLocalIds[e]||(this.tempLocalIds[e]={}),this.tempLocalIds[e][t]=[this.getClient(),a],this.remoteChange(a,this.client,e,t,i,r,n,!0,void 0,!0,void 0,this.unique,void 0,s),a}remoteChange(e,t,i,r,n,s,a,o,l,u,c,h,m,f){var S;this.setMaxTicket(e);let g=h===this.unique,y=o||g,b=(!y||y&&this.isLocalChange)&&(!m||m&&this.isPendChange),E=(S=this.tempLocalIds[i])==null?void 0:S[r];!o&&g?E?(b=!1,E[0]===t&&E[1]===e&&delete this.tempLocalIds[i][r]):b=!0:!o&&E&&(E[1]>e||E[1]===e&&E[0]>t?b=!1:delete this.tempLocalIds[i][r]),b&&this.cbArr.forEach(v=>v(i,r,n,s,t,e,l,u,void 0,m,h,f))}};var i0=/^(?:ie|e)(\d+)$/;function Jc(e){let t=e.match(i0);return t?Number(t[1]):null}function mt(e){if(!e||typeof e!="string")return e;let t=e.match(/(?:ie|e)\d+/g);return t&&t.length===2&&t.join("")===e?t.join("-"):e}function ji(e){return e&&typeof e=="number"&&!isNaN(e)?-e:e}function d9(e,t){let i=[];for(let r=0;r<e.length;r+=2){let n={x:e[r],y:t?ji(e[r+1]):e[r+1]};i.push(n)}return i}function Mr(e,t){return JSON.stringify([t,e])}function Ba(e){try{let t=JSON.parse(e);return typeof t=="string"?e:t[1]}catch{return e}}var h9=(e=>(e.META="META",e.CANVAS="CANVAS",e.GROUP="GROUP",e.POLY="POLY",e.STRING="STRING",e.AUX_LINE="AUXLINE",e.DIMENSION="DIMENSION",e.ELE_PLACEHOLDER="ELE_PLACEHOLDER",e))(h9||{}),p9=(e=>(e.META="META",e.CANVAS="CANVAS",e.LAYER="LAYER",e.LAYER_PHYS="LAYER_PHYS",e.ACTIVE_LAYER="ACTIVE_LAYER",e.PARTITION="PARTITION",e.NET="NET",e.PRIMITIVE="PRIMITIVE",e.GROUP="GROUP",e.SILK_OPTS="SILK_OPTS",e.PREFERENCE="PREFERENCE",e.VIA="VIA",e.PAD="PAD",e.LINE="LINE",e.ARC="ARC",e.OBJ="OBJ",e.EQLEN_GRP="EQLEN_GRP",e.POLY="POLY",e.FILL="FILL",e.LAYER_FILL="LAYER_FILL",e.REGION="REGION",e.POUR="POUR",e.POURED="POURED",e.IMAGE="IMAGE",e.TEARDROP="TEARDROP",e.FPC_FILL="FPC_FILL",e.SHELL="SHELL",e.CREASE="CREASE",e.SHELLCUT="SHELLCUT",e.SHELL_ENTITY="SHELL_ENTITY",e.BOSS="BOSS",e.STRING="STRING",e.ATTR="ATTR",e.DIMENSION="DIMENSION",e.COMPONENT="COMPONENT",e.PAD_NET="PAD_NET",e.RULE_TEMPLATE="RULE_TEMPLATE",e.RULE="RULE",e.RULE_SELECTOR="RULE_SELECTOR",e.PANELIZE="PANELIZE",e.ELE_PLACEHOLDER="ELE_PLACEHOLDER",e))(p9||{}),f9=(e=>(e.META="META",e.CANVAS="CANVAS",e.GROUP="GROUP",e.ATTR="ATTR",e.LINE="LINE",e.WIRE="WIRE",e.BUS="BUS",e.TEXT="TEXT",e.POLY="POLY",e.CIRCLE="CIRCLE",e.ARC="ARC",e.BUSENTRY="BUSENTRY",e.RECT="RECT",e.MASK_REGION="MASK_REGION",e.PIN="PIN",e.OBJ="OBJ",e.COMPONENT="COMPONENT",e.PART="PART",e.ELLIPSE="ELLIPSE",e.BEZIER="BEZIER",e.TABLE="TABLE",e.ELE_PLACEHOLDER="ELE_PLACEHOLDER",e.NG_SETTING="NG_SETTING",e))(f9||{});var m9=["PARTITION","VIA","PAD","LINE","ARC","OBJ","POLY","FILL","REGION","POUR","POURED","IMAGE","TEARDROP","FPC_FILL","SHELL","CREASE","SHELLCUT","SHELL_ENTITY","BOSS","STRING","ATTR","DIMENSION","COMPONENT"];var kee=cu(sd());var g9=class{constructor(e,t=1,i=[]){this.consistencyManager=e,this.startNum=t,this.needOrderType=i,this.initIng=!1,this.allOrderNum={},this.maxNum={},this.consistencyManager.onChange((r,n,s,a,o,l,u,c,h,m,f,g)=>{try{this.onParseLine(n,a,s?JSON.parse(s):null,o,l,c,g)}catch(y){console.error(y)}})}setIsInit(e){this.initIng=e}setNeedNum(e){this.needNum=e}setOrderNum(e,t,i){this.needNum&&this.needOrderType&&this.needOrderType.includes(i)&&t!==void 0&&(this.allOrderNum[e]=t,this.setMaxNum(i,t))}deleteOrderNum(e){delete this.allOrderNum[e]}getOrderNum(e){return this.allOrderNum[e]}setMaxNum(e,t,i){(i||this.maxNum[e]===void 0||this.maxNum[e]<t)&&(this.maxNum[e]=t)}getMaxNum(e){return this.maxNum[e]===void 0&&(this.maxNum[e]=this.startNum-1),++this.maxNum[e]}},y9=(e=>(e.SOLID="SOLID",e.SHORT_DASH="SHORT_DASH",e.DOT="DOT",e.DOT_DASH="DOT_DASH",e))(y9||{}),_9=(e=>(e.PRINT="PRINT",e.COVER="COVER",e.PRINT_AND_COVER="PRINT&COVER",e))(_9||{}),b9=(e=>(e.LEFT="LEFT",e.CENTER="CENTER",e.RIGHT="RIGHT",e))(b9||{}),P9=(e=>(e.TOP="TOP",e.MIDDLE="MIDDLE",e.BOTTOM="BOTTOM",e))(P9||{}),E9=(e=>(e.LEFT_BOTTOM="LEFT_BOTTOM",e.CENTER_BOTTOM="CENTER_BOTTOM",e.RIGHT_BOTTOM="RIGHT_BOTTOM",e.LEFT_MIDDLE="LEFT_MIDDLE",e.CENTER_MIDDLE="CENTER_MIDDLE",e.RIGHT_MIDDLE="RIGHT_MIDDLE",e.LEFT_TOP="LEFT_TOP",e.CENTER_TOP="CENTER_TOP",e.RIGHT_TOP="RIGHT_TOP",e))(E9||{}),S9=(e=>(e.NONE="NONE",e.SOLID="SOLID",e.GRID="GRID",e.HORIZONTAL_LINE="HORIZONTAL_LINE",e.VERTICAL_LINE="VERTICAL_LINE",e.RHOMBIC="RHOMBIC",e.LEFT_SLASH_LINE="LEFT_SLASH_LINE",e.RIGHT_SLASH_LINE="RIGHT_SLASH_LINE",e))(S9||{}),v9=(e=>(e.NONE="NONE",e.CLOCK="CLOCK",e.INVERTED="INVERTED",e.INVERTED_CLOCK="INVERTED_CLOCK",e))(v9||{}),I9=(e=>(e.NONE="NONE",e.GRID="GRID",e.OUTLETS="OUTLETS",e))(I9||{}),A9=(e=>(e.NONE="NONE",e.PUSH="PUSH",e.SURROUND="SURROUND",e.OBSTRUCT="OBSTRUCT",e.SURROUND_AND_PUSH="SURROUND&PUSH",e))(A9||{}),C9=(e=>(e.ELLIPSE="ELLIPSE",e.RECT="RECT",e.OVAL="OVAL",e.POLYGON="POLYGON",e))(C9||{}),x9=(e=>(e.ROUND="ROUND",e.RECT="RECT",e.SLOT="SLOT",e))(x9||{}),T9=(e=>(e.SOLID="SOLID",e.GRID_LINE="GRID_LINE",e.HORIZONTAL_LINE="HORIZONTAL_LINE",e.VERTICAL_LINE="VERTICAL_LINE",e))(T9||{}),w9=(e=>(e.ALL="ALL",e.PAD="PAD",e.VIA="VIA",e))(w9||{}),R9=(e=>(e.NONE="NONE",e.SINGLE="SINGLE",e.ALL="ALL",e))(R9||{}),L9=(e=>(e.OPTIMIZA_OPEN="OPTIMIZA_OPEN",e.OPTIMIZA_NONE="OPTIMIZA_NONE",e))(L9||{}),N9=(e=>(e.OPTIMIZA_STRONG="OPTIMIZA_STRONG",e.OPTIMIZA_WEAK="OPTIMIZA_WEAK",e.OPTIMIZA_NONE="OPTIMIZA_NONE",e))(N9||{}),D9=(e=>(e.L45="L45",e.L90="L90",e.L="L",e.R45="R45",e.R90="R90",e.R="R",e))(D9||{}),B9=(e=>(e.NORMAL="NORMAL",e.BLIND="BLIND",e.SUTURE="SUTURE",e))(B9||{}),O9=(e=>(e.NORMAL="NORMAL",e.TEST="TEST",e.MARKER="MARKER",e))(O9||{}),M9=(e=>(e.DIVERGENCE="DIVERGENCE",e.DIRECT="DIRECT",e.NON_CONNECT="NON_CONNECT",e))(M9||{}),k9=(e=>(e.DOT="DOT",e.CENTER="CENT",e))(k9||{}),F9=(e=>(e.NORMAL="NORMAL",e.BOARD_OUTLINE="BOARD_OUTLINE",e))(F9||{}),U9=(e=>(e.SOLID="SOLID",e.GRID="GRID",e.PLANE="PLANE",e))(U9||{}),H9=(e=>(e.PROHIBIT="PROHIBIT",e.CONSTRAINT="CONSTRAINT",e))(H9||{}),j9=(e=>(e.COMPONENT="COMPONENT",e.VIA="VIA",e.TRACK="TRACK",e.FILL="FILL",e.COPPER="COPPER",e.PLANE="PLANE",e))(j9||{}),Y9=(e=>(e.PI="Polyimide",e.FR4="FR4",e.STEEL_SHEET="Stainless Steel",e.M3_DOUBLE_SIDED_TAPE="3M Tape",e.EMI_SHIELDING_FILM="EMI Shielding Film",e))(Y9||{}),G9=(e=>(e.PUSH_COVER="DRAWER",e.UPPER_LOWER_SHELLS="T&B",e))(G9||{}),W9=(e=>(e.X_AXIS_POSITIVE="X_AXIS_POSITIVE",e.X_AXIS_NEGATIVE="X_AXIS_NEGATIVE",e.Y_AXIS_POSITIVE="Y_AXIS_POSITIVE",e.Y_AXIS_NEGATIVE="Y_AXIS_NEGATIVE",e))(W9||{}),z9=(e=>(e.SLOT="SLOT",e.ENTITY="ENTITY",e))(z9||{}),V9=(e=>(e.AUTO="AUTO",e.UPPER_SHELLS="UPPER_SHELLS",e.LOWER_SHELLS="LOWER_SHELLS",e))(V9||{}),q9=(e=>(e.OUTLINE="OUTLINE",e.SCREW_PILLAR="SCREW_PILLAR",e.ENTITY="ENTITY",e))(q9||{}),X9=(e=>(e.M2="M2",e.M3="M3",e.M4="M4",e.M5="M5",e.M6="M6",e))(X9||{}),J9=(e=>(e.LENGTH="LENGTH",e.RADIUS="RADIUS",e.ANGLE="ANGLE",e))(J9||{}),$9=(e=>(e.MIL="mil",e.INCH="inch",e.CM="cm",e.MM="mm",e))($9||{}),K9=(e=>(e.SAFE="SAFE",e.OTHER="OTHER",e.TRACK="TRACK",e.BLIND="BLIND",e.RADIUS="RADIUS",e.PLANE="PLANE",e.COPPER="COPPER",e.PASTE="PASTE",e.SOLDER="SOLDER",e.DIFFER_ENTAIL="DIFFER_ENTAIL",e.NET_LENGTH="NET_LENGTH",e.AUTO_ROUTER="AUTO_ROUTER",e.NET_LENGTH_TOLERANCE="NET_LENGTH_TOLERANCE",e))(K9||{}),Z9=(e=>(e.NORMAL="NORMAL",e.DEFAULT="DEFAULT",e))(Z9||{}),Q9=(e=>(e.ALL="ALL",e.LAYERED="LAYERED",e))(Q9||{}),eH=(e=>(e.DIRECT="DIRECT",e.NON_CONNECT="NON_CONNECT",e))(eH||{}),tH=(e=>(e.FORTY_FIVE="L45",e.NINETY="L90",e.NINETY_ARC="A90",e))(tH||{}),iH=(e=>(e.LESS="LESS",e.MID="MID",e.MORE="MORE",e))(iH||{}),rH=(e=>(e.SPEED_FIRST="SPEED_FIRST",e.COMPLETION_FIRST="COMPLETION_FIRST",e))(rH||{}),nH=(e=>(e.DesignRule="DesignRule",e.Board="Board",e.SlotRegion="SlotRegion",e.ProhibitedRegion="ProhibitedRegion",e.ConstraintRegion="ConstraintRegion",e.Component="Component",e.Track="Track",e.TestPoint="TestPoint",e.Pad="Pad",e.Via="Via",e.SutureHole="SutureHole",e.Text="Text",e.ColorfulImage="ColorfulImage",e.Image="Image",e.FPCStiffener="FPCStiffener",e.Dimension="Dimension",e.CopperRegion="CopperRegion",e.FillRegion="Fill Region",e.Line="Line",e.Teardrop="Teardrop",e.D3Shell="D3Shell",e))(nH||{});function Ix(e){switch(e=String(e),e){case"1":return"SAFE";case"2":return"OTHER";case"3":return"TRACK";case"4":return"BLIND";case"5":return"RADIUS";case"6":return"PLANE";case"7":return"COPPER";case"8":return"PASTE";case"9":return"SOLDER";case"10":return"DIFFER_ENTAIL";case"11":return"NET_LENGTH";case"12":return"AUTO_ROUTER";case"13":return"NET_LENGTH_TOLERANCE"}return e}function Ax(e){if(!e)return{};let t=["1","2","3","4","5","6","7","8","9","10","11","12","13"];for(let i of t)if(e.hasOwnProperty(i)){let r=e[i];delete e[i],e[Ix(i)]=r}return e}var sH=(e=>(e[e.TRACK=0]="TRACK",e[e.SMDPad=1]="SMDPad",e[e.THPad=2]="THPad",e[e.SMD_Test_Point=3]="SMD_Test_Point",e[e.TH_Test_Point=4]="TH_Test_Point",e[e.VIA=5]="VIA",e[e.REGION=6]="REGION",e[e.PLANE=7]="PLANE",e[e.SLOT=8]="SLOT",e[e.LINE=9]="LINE",e[e.OTHER=10]="OTHER",e[e.SHEETFRAME=11]="SHEETFRAME",e[e.Hole=12]="Hole",e[e.Copper=13]="Copper",e[e.Inner=14]="Inner",e[e.PROHIBITAREA=15]="PROHIBITAREA",e[e.COMPONENT=16]="COMPONENT",e))(sH||{}),dC=class{constructor(){this.init=!1,this.defaultSafeData=null,this.defaultCopperSpace=null,this.defaultInnerSpace=null,this.copperChangeMap=new Map,this.innerChangeMap=new Map}addDefaultSafeSpaceData(e){this.init=!0,this.defaultSafeData=e}addDefaultCopperSpace(e,t){this.defaultCopperSpace={netClearance:e,boardClearance:t}}addDefaultInnerSpace(e,t){this.defaultInnerSpace={netClearance:e,boardClearance:t}}getNewDefaultData(e,t){if(e&&this.defaultSafeData==null||!e&&this.defaultInnerSpace==null)return null;let i=e?this.copperChangeMap.get(t):this.innerChangeMap.get(t);if(i==null)return null;let{netClearance:r,boardClearance:n}=i,s=this.defaultSafeData.safeSpacing[0].content,a=new Array(s.length);for(let o=0;o<s.length;o++)a[o]=Array.from(s[o]);return this.updateSafeData(a,r,n),a}fixSafeData(e){if(this.defaultCopperSpace!=null)for(let t of e.safeSpacing)this.updateSafeData(t.content,this.defaultCopperSpace.netClearance,this.defaultCopperSpace.netClearance)}updateSafeData(e,t,i){for(let r=0;r<e.length;r++){let n=e[r];for(let s=0;s<n.length;s++)r==7?s==11||s==8?n[s]=i:n[s]=t:s==7&&(r==11||r==8?n[s]=i:n[s]=t)}}addCopper2SafeChangeMap(e,t,i,r,n){this.copperChangeMap.set(e,{name:t,isDefault:i,netClearance:r,boardClearance:n})}addInner2SafeChangeMap(e,t,i,r,n){this.innerChangeMap.set(e,{name:t,isDefault:i,netClearance:r,boardClearance:n})}getSafeName4Copper(e){var t;return(t=this.copperChangeMap.get(e))==null?void 0:t.name}getSafeName4Plane(e){var t;return(t=this.innerChangeMap.get(e))==null?void 0:t.name}getDefaultCopper(){for(let[,e]of this.copperChangeMap)if(e.isDefault)return e.name;return null}getDefaultPlane(){for(let[,e]of this.innerChangeMap)if(e.isDefault)return e.name;return null}};function hC(e,t){let i=e,r={TWO_LAYERS_BOARD:"JLCPCB Capability(Two Layers Board)",SINGLE_LAYER_BOARD:"JLCPCB Capability(Single Layer Board)",MULTIPLE_LAYERS_BOARD:"JLCPCB Capability(Multiple Layers Board)",HIGH_FREQUENCY_BOARD:"JLCPCB Capability(High Frequency Board)",ALUMINUM_SUBSTRATE_BOARD:"JLCPCB Capability(Aluminum Substrate Board)",COPPER_SUBSTRATE_BOARD:"JLCPCB Capability(Copper Substrate Board)"};if(i.length==8){Object.values(r).includes(t)&&(i[4][0]=11.811,i[5][4]=11.811),i.splice(1,0,i[1].slice(0));for(let s=2;s<i.length;s++)i[s].splice(1,0,i[s][1]);i.push([].concat(i[1][0],i.slice(1).map(s=>s[1])))}i[1].push(i[1][i[1].length-1]),i.splice(3,0,[...i[1]]),i.splice(4,0,[...i[2]]),i[1].pop();for(let s=5;s<i.length;s++)i[s].splice(3,0,i[s][1]),i[s].splice(4,0,i[s][2]);i[3][3]=i[1][1],i[4][3]=i[2][1],i[4][4]=i[2][2];let n=6;i.splice(7,0,new Array(7).fill(n));for(let s=7;s<i.length;s++)i[s].splice(7,0,n);return i}function aH(e,t){let i=e[0],r=e[1],n=[],s="ALL";if(r instanceof Array){let a=hC(r,t);n.push({layerId:1,isOpen:!0,content:a})}else{for(let a in r){let o=r[a],l=hC(o,t);n.push({layerId:+a,isOpen:!0,content:l})}Object.keys(r).length>1&&(s="LAYERED")}return{unit:i,isForAll:s,safeSpacing:n}}function oH(e){let t=e[0],i=e[1],r=e[2];isNaN(r)&&(r=0);let n=e[3];return isNaN(n)&&(n=11.8),{unit:t,deviceClearance:i,thru2SmdClearance:r,holeClearance:n}}function lH(e){let t=e[0],i=e[1],r=!0,n=[];if(i instanceof Object)for(let s in i){let a=i[s];n.push({layerId:+s,stroMin:a[0],stroDef:a[1],stroMax:a[2]})}else n.push({layerId:1,stroMin:e[1],stroDef:e[2],stroMax:e[3]});return{unit:t,track:{isOpen:r,content:n}}}function uH(e){return{unit:e[0],netLenMin:e[1],netLenMax:e[2]}}function cH(e){return{unit:e[0],netLengthTolerance:e[1]}}function dH(e){let t=e[0],i=e[1],r=!0,n=[],s=[],a=0;if(i instanceof Object)for(let o in i){let l=i[o],{stroke:u,spacing:c,lenTolerMax:h}=l;n.push({layerId:+o,stroMin:u[0],stroDef:u[1],stroMax:u[2]}),s.push({layerId:+o,spacMin:c[0],spacDef:c[1]}),a=h}else n.push({layerId:1,stroMin:e[1],stroDef:e[2],stroMax:e[3]}),s.push({layerId:1,spacMin:e[4],spacDef:e[5]}),a=e[7];return{unit:t,stroWidth:{isOpen:r,content:n},spacing:{isOpen:r,content:s},differPairLenTolerMax:a}}function hH(e){let t=new Array;for(let i of e){let r=+i[1],n=+i[2];isNaN(r)||r<=0||isNaN(n)||n<=0||r===n||r===1&&n===2||r===2&&n===1||t.push({name:i[0],staLayerId:r,endLayerId:n,viaSizeRule:i[3]})}return{blinds:{content:t}}}function pH(e){return{unit:e[0],minRadius:e[1],defRadius:e[2],maxRadius:e[3],minInner:e[4],defInner:e[5],maxInner:e[6]}}function fH(e){let t=[{layerId:1,connType:tu(e[7]!==void 0?e[7]:e[3]),spoWidth:e[8]!==void 0?e[8]:e[4],spoSpac:e[9]!==void 0?e[9]:e[5],spoAng:e[10]?e[10]:e[6]}];return{unit:e[0],mulPad:{isOpen:!0,content:t}}}function mH(e){let t=[{layerId:1,connType:tu(e[3]),spoWidth:e[4],spoSpac:e[5],spoAng:e[6]}],i=[{layerId:1,connType:Number(e[7])?"NON_CONNECT":"DIRECT"}],r=[{layerId:1,connType:tu(e[8]!==void 0?e[8]:e[3]),spoWidth:e[9]!==void 0?e[9]:e[4],spoSpac:e[10]!==void 0?e[10]:e[5],spoAng:e[11]?e[11]:e[6]}];return{unit:e[0],sglPad:{isOpen:!0,content:t},mulPad:{isOpen:!0,content:r},track:{isOpen:!0,content:i}}}function gH(e){return{unit:e[0],padTopExpan:e[1],padBotExpan:e[2],testPointTopExpan:e[3]?e[3]:-1e3,testPointBotExpan:e[4]?e[4]:-1e3}}function yH(e){return{unit:e[0],padTopExpan:e[1],padBotExpan:e[2],viaTopExpan:e[3],viaBotExpan:e[4],testPointTopExpan:e[5]?e[5]:2,testPointBotExpan:e[6]?e[6]:2}}function _H(e){function t(n){switch(n=n&&Number(n),n){case 0:return"L45";case 1:return"L90";case 2:return"A90";default:return"L45"}}function i(n){switch(n=n&&Number(n),n){case 0:return"LESS";case 1:return"MID";case 2:return"MORE";default:return"LESS"}}function r(n){switch(n=n&&Number(n),n){case 0:return"SPEED_FIRST";case 1:return"COMPLETION_FIRST";default:return"COMPLETION_FIRST"}}return{routingCorner:t(e[0]),isKeep:!!e[1],viaQuantity:i(e[2]),routingEffectPriority:r(e[3]),layers:e[5],ignoreNets:e[6]}}function tu(e){switch(e=e&&Number(e),e){case 0:return"DIVERGENCE";case 1:return"DIRECT";case 2:return"NON_CONNECT";default:return null}}function bH(e,t){let i=t;switch(e){case"SAFE":{let r=t;if(r.isForAll=r.isForAll?"LAYERED":"ALL",r.safeSpacing)for(let n of r.safeSpacing)n.isOpen=!!n.isOpen;i=r;break}case"OTHER":break;case"TRACK":{let r=t;r!=null&&r.track&&(r.track.isOpen=!!r.track.isOpen),i=r;break}case"NET_LENGTH":break;case"NET_LENGTH_TOLERANCE":break;case"DIFFER_ENTAIL":{let r=t;r!=null&&r.stroWidth&&(r.stroWidth.isOpen=!!r.stroWidth.isOpen),r!=null&&r.spacing&&(r.spacing.isOpen=!!r.spacing.isOpen),i=r;break}case"BLIND":break;case"RADIUS":break;case"PLANE":{let r=t;if(r!=null&&r.mulPad&&(r.mulPad.isOpen=!!r.mulPad.isOpen),r.mulPad&&r.mulPad.content)for(let n of r.mulPad.content)n.connType=tu(n.connType);i=r;break}case"COPPER":{let r=t;if(r!=null&&r.sglPad&&(r.sglPad.isOpen=!!r.sglPad.isOpen),r!=null&&r.mulPad&&(r.mulPad.isOpen=!!r.mulPad.isOpen),r!=null&&r.track&&(r.track.isOpen=!!r.track.isOpen),r.track&&r.track.content&&(r.track.content=r.track.content.map(n=>(n.connType=Number(n.connType)?"NON_CONNECT":"DIRECT",n))),r.sglPad&&r.sglPad.content)for(let n of r.sglPad.content)n.connType=tu(n.connType);if(r.mulPad&&r.mulPad.content)for(let n of r.mulPad.content)n.connType=tu(n.connType);i=r;break}case"PASTE":break;case"SOLDER":break;case"AUTO_ROUTER":break}return i}function PH(e,t,i,r,n,s){if(!(r instanceof Array))return bH(e,r);let a,o=!1;switch(i&&(i==="NORMAL"?o=!1:i==="DEFAULT"&&(o=!0)),e){case"SAFE":{a=aH(r,s),o&&n.addDefaultSafeSpaceData(a);break}case"OTHER":{a=oH(r);break}case"TRACK":{a=lH(r);break}case"NET_LENGTH":{a=uH(r);break}case"NET_LENGTH_TOLERANCE":{a=cH(r);break}case"DIFFER_ENTAIL":{a=dH(r);break}case"BLIND":{a=hH(r);break}case"RADIUS":{a=pH(r);break}case"PLANE":{let l=r[1],u=r[2];o&&n.addDefaultInnerSpace(l,u),n.addInner2SafeChangeMap(t,"Plane_"+t,o,l,u),a=fH(r);break}case"COPPER":{let l=r[1],u=r[2];o&&n.addDefaultCopperSpace(l,u),n.addCopper2SafeChangeMap(t,"Copper_"+t,o,l,u),a=mH(r);break}case"PASTE":{a=gH(r);break}case"SOLDER":{a=yH(r);break}case"AUTO_ROUTER":{a=_H(r);break}}return a}function EH(e,t,i,r){if(!r.init)return null;function n(s,a){let o=s?"Copper_":"Plane_",l=["RULE"];l[1]="SAFE",l[2]=o+t,l[3]=0;let u=a.getNewDefaultData(s,t);return u==null?null:(l[4]={unit:a.defaultSafeData.unit,isForAll:"ALL",safeSpacing:[{layerId:1,isOpen:!0,content:u}]},l)}switch(e){case"SAFE":return r.fixSafeData(i),null;case"PLANE":return n(!1,r);case"COPPER":return n(!0,r);default:return null}}function SH(e,t,i,r){if(!r.init)return{ruleKeyValue:i};let n=e[0],s,a;if(t==4){if(n==="NET_CLASS"||n==="NET"){for(let o in i)String(o)==="COPPER"&&(s={COPPER:r.getSafeName4Copper(i[o])}),String(o)==="PLANE"&&(a={PLANE:r.getSafeName4Plane(i[o])});e[1]==""?(s!=null&&s.COPPER||(s={COPPER:"default"}),a!=null&&a.PLANE||(a={PLANE:"default"})):(s!=null&&s.COPPER||(s={COPPER:r.getDefaultCopper()}),a!=null&&a.PLANE||(a={PLANE:r.getDefaultPlane()}))}}else for(let o in i){if(String(o)==="COPPER"){let l=i[o],u=r.getSafeName4Copper(l);if(u==null&&l=="default"&&(u=r.getDefaultCopper()),u==null)continue;s={COPPER:u}}if(String(o)==="PLANE"){let l=i[o],u=r.getSafeName4Plane(l);if(u==null&&l=="default"&&(u=r.getDefaultPlane()),u==null)continue;a={PLANE:u}}}return{ruleKeyValue:i,copperRuleValue:s,innerPlaneRuleValue:a}}function Cx(e,t){let i=e.length,r=0;for(;r<i;){let n=e.indexOf(`
`,r);n<0&&(n=i);let s=e.substring(r,n);try{if(t(s)===!1)break}catch(a){console.error(a)}r=n+1}}function vH(e){let t={};return Cx(e,i=>{if(i.startsWith('["PAD"')){let r=JSON.parse(i);t[r[5]]||(t[r[5]]=[]),t[r[5]].push(r[1])}}),t}var r0=class{parseFull(e){Cx(e,t=>this.onParseLine(JSON.parse(t))),this.onParseEnd()}},IH=(e=>(e[e.pro1=1]="pro1",e[e.pro2=1.1]="pro2",e[e.pro3=1.2]="pro3",e[e.pro4=1.3]="pro4",e[e.pro5=1.4]="pro5",e[e.pro6=1.5]="pro6",e[e.pro7=1.6]="pro7",e[e.pro8=1.7]="pro8",e[e.pro9=1.8]="pro9",e[e.pro=1.8]="pro",e))(IH||{}),AH=class extends r0{constructor(e={},t={},i=[],r=[],n=!1){super(),this.deviceName=e,this.footprintName=t,this.footprints=i,this.devices=r,this.footprintIsConnectDevice=n,this.fontCache=[],this.poured={},this.curPartition="",this.eQLenData={},this.eQLenSort=1,this.cache={},this.components={},this.errorIds={},this.dimension={},this.connects={},this.specialColors={},this.reuseBlock={},this.panelize={data:[],stamp:{h:null,v:null},size:{h:null,v:null}},this.layerPhys=0,this.fac=new dC,this.rules=[],this.ruleSelectors=[],this.ruleTemplateName="",this.layerFill={},this.idsSet=new Set,this.oldId={},this.cachePadNet={},this.creaseIds=[],this.padNumId={},this.componentPadNum={}}getOldId(e){return this.oldId[e]||e}handConnect(){for(let e of this.creaseIds)if(this.connects[e])for(let t of this.connects[e])this.connects[t]?this.connects[t].push(e):this.connects[t]=[e]}getConnect(e){return this.connects[e]||[]}transRuleType(e){return Ix(e)}transRuleStatus(e){switch(e=e&&Number(e),e){case 0:return"NORMAL";case 1:return"DEFAULT";default:return"NORMAL"}}transGridType(e){switch(e=e&&Number(e),e){case 0:return"NONE";case 1:return"GRID";case 2:return"OUTLETS";default:return"NONE"}}transLayerStatus(e){e=e&&Number(e);let t=!1,i=!1,r=!1;return e!=null&&!isNaN(e)?(e>=4&&(r=!0,e-=4),e>=2&&(i=!0,e-=2),e===1&&(t=!0)):t=!0,{use:t,show:i,locked:r}}transRoutingMode(e){switch(e=e&&Number(e),e){case 0:return"NONE";case 1:return"PUSH";case 2:return"SURROUND";case 3:return"OBSTRUCT";case 4:return"SURROUND&PUSH";default:return"NONE"}}transPadDef(e){switch(e==null?void 0:e[0]){case"ELLIPSE":return{padType:"ELLIPSE",width:e[1],height:e[2]};case"RECT":return{padType:"RECT",width:e[1],height:e[2],radius:e[3]};case"OVAL":return{padType:"OVAL",width:e[1],height:e[2]};case"POLYGON":case"POLY":return{padType:"POLYGON",path:e[1]};default:return null}}transHoleDef(e){return e?{holeType:e[0],width:e[1],height:e[2]}:null}transPourDef(e){function t(i){switch(i=i&&Number(i),i){case 0:return"GRID_LINE";case 1:return"HORIZONTAL_LINE";case 2:return"VERTICAL_LINE";default:return"GRID_LINE"}}switch(e==null?void 0:e[0]){case"SOLID":return{pourType:"SOLID",fineness:e[1]};case"LINE":return{pourType:t(e[1]),angle:e[2],strokeWidth:e[3],strokeSpacing:e[4]};default:return null}}transUnusedPadRange(e){switch(e=e&&Number(e),e){case 1:return"ALL";case 2:return"PAD";case 3:return"VIA";default:return"VIA"}}transPathOptimization(e){switch(e=e&&Number(e),e){case 0:return"SINGLE";case 1:return"ALL";case 2:return"NONE";default:return"SINGLE"}}transViaType(e){switch(e=e&&Number(e),e){case 0:return"NORMAL";case 1:return"BLIND";case 2:return"SUTURE";default:return"NORMAL"}}transPadFuncType(e){switch(e=e&&Number(e),e){case 0:return"NORMAL";case 1:return"TEST";case 2:return"MARKER";default:return"NORMAL"}}transPadConnect(e){switch(e=e&&Number(e),e){case 0:return"DIVERGENCE";case 1:return"DIRECT";case 2:return"NON_CONNECT";default:return null}}transFillStyle(e){switch(e=e&&Number(e),e){case 0:return"SOLID";case 1:return"GRID";case 2:return"PLANE";default:return null}}transProhibitType(e){let t=new Set;if(!e)return[];for(let i of e)switch(i=i&&Number(i),i){case 1:t.add("TRACK"),t.add("FILL");break;case 2:t.add("COMPONENT");break;case 3:t.add("VIA");break;case 4:t.add("COPPER"),t.add("PLANE");break;case 5:t.add("TRACK");break;case 6:t.add("FILL");break;case 7:t.add("COPPER");break;case 8:t.add("PLANE");break}return Array.from(t)}transPushCoverDir(e){switch(e=e&&Number(e),e){case 1:return"X_AXIS_POSITIVE";case 2:return"X_AXIS_NEGATIVE";case 4:return"Y_AXIS_POSITIVE";case 8:return"Y_AXIS_NEGATIVE";default:return"X_AXIS_POSITIVE"}}transEntityBelong(e){switch(e=e&&Number(e),e){case 0:return"AUTO";case 1:return"UPPER_SHELLS";case 2:return"LOWER_SHELLS";default:return"AUTO"}}transSlotOption(e){e=e&&Number(e);let t=e;if(!t||t<4)return["OUTLINE","SCREW_PILLAR","ENTITY"];let i=[];return t>=16&&(i.push("ENTITY"),t-=16),t>=8&&(i.push("SCREW_PILLAR"),t-=8),t>=4&&(i.push("OUTLINE"),t-=4),i}transAlignType(e){switch(e=e&&Number(e),e){case 1:return"LEFT_TOP";case 4:return"CENTER_TOP";case 7:return"RIGHT_TOP";case 2:return"LEFT_MIDDLE";case 5:return"CENTER_MIDDLE";case 8:return"RIGHT_MIDDLE";case 3:return"LEFT_BOTTOM";case 6:return"CENTER_BOTTOM";case 9:return"RIGHT_BOTTOM";default:return"LEFT_BOTTOM"}}onParseLine(e){var i;let t=e[0];switch(t){case"DOCTYPE":this.parseDocType(e);break;case"HEAD":this.parseHead(e);break;case"CANVAS":this.parseCanvas(e);break;case"LAYER":this.parseLayer(e);break;case"LAYER_PHYS":this.parseLayerPhys(e);break;case"ACTIVE_LAYER":this.parseActiveLayer(e);break;case"NET":this.parseNet(e);break;case"PRIMITIVE":this.parsePrimitive(e);break;case"GROUP":this.parseGroup(e);break;case"SILK_OPTS":this.parseSilkOpts(e);break;case"PREFERENCE":this.parsePreference(e);break;case"CONNECT":this.parseConnect(e);break;case"ITEM_ORDER":this.parseItemOrder(e);break;case"PROP":this.parseProp(e);break;case"EQLEN_GRP":this.parseEQLenGrp(e);break;case"EQLEN":this.parseEQLen(e);break;case"FONT":this.parseFont(e);break;case"PAD_NET":{this.cachePadNet[e[1]]||(this.cachePadNet[e[1]]=[]),this.cachePadNet[e[1]].push(e);break}case"REUSE_BLOCK":this.parseReuseBlock(e);break;case"RULE_TEMPLATE":this.parseRuleTemplate(e);break;case"RULE":this.rules.push(e);break;case"RULE_SELECTOR":this.ruleSelectors.push(e);break;case"PANELIZE":this.panelize.data=e;break;case"PANELIZE_STAMP":this.parsePanelizeStamp(e);break;case"PANELIZE_SIDE":this.parsePanelizeSide(e);break;case"POURED":{this.parsePoured(e);break}case"PARTITION":t==="PARTITION"&&(this.curPartition=e[3]?e[1]:"");case"VIA":case"PAD":case"LINE":case"ARC":case"CARC":case"OBJ":case"POLY":case"FILL":if(t==="FILL"&&e[6]===2){this.layerFill[e[4]]||(this.layerFill[e[4]]=[]),this.layerFill[e[4]].push(e);break}case"REGION":case"POUR":case"IMAGE":case"TEARDROP":case"FPC_FILL":case"SHELL":case"CREASE":t==="CREASE"&&this.creaseIds.push(e[1]);case"SHELLCUT":case"SHELL_ENTITY":case"BOSS":case"STRING":if(t==="STRING"&&!/^[a-zA-Z]+\d+$/.test(e[1])){let r=e[1],n=r.split(/([0-9].*)/);if(n.length>=2){let s=n[0],a=n[1];for(let o=0;o<a.length;o++){let l=a.charCodeAt(o);s+=l}r=s}e[1]=r}case"DIMENSION":case"COMPONENT":{let r=t==="CARC"?"ARC":t,n=Jc(e[1]);this.cache[r]||(this.cache[r]={}),n!==null&&!this.cache[r][n]?this.cache[r][n]={part:this.curPartition,value:e}:(this.errorIds[r]||(this.errorIds[r]=[]),this.errorIds[r].push({part:this.curPartition,value:e})),r==="COMPONENT"&&(this.components[e[1]]||(this.components[e[1]]={attrs:{},footprint:"",device:""}),this.components[e[1]].attrs=e[7]||{}),r==="DIMENSION"&&(this.dimension[e[1]]={attr:[]});break}case"ATTR":{if(this.docType==="PCB"&&!e[3])break;if(e[7]==="Footprint"&&(this.components[e[3]]||(this.components[e[3]]={attrs:{},footprint:"",device:""}),this.components[e[3]].footprint=e[8]),e[7]==="Device"&&(this.components[e[3]]||(this.components[e[3]]={attrs:{},footprint:"",device:""}),this.components[e[3]].device=e[8]),this.dimension[e[1]]){this.dimension[e[1]].attr=e;break}let r=Object.keys(((i=this.cache)==null?void 0:i.COMPONENT)||{}).find(s=>this.cache.COMPONENT[s].value[1]===e[3]);if(r){let s=this.cache.COMPONENT[r];s.attr||(s.attr=[]),s.attr.push({part:this.curPartition,value:e});break}let n=Jc(e[1]);this.cache[t]||(this.cache[t]={}),n!==null&&!this.cache[t][n]?this.cache[t][n]={part:this.curPartition,value:e}:(this.errorIds[t]||(this.errorIds[t]=[]),this.errorIds[t].push({part:this.curPartition,value:e}));break}default:console.warn("can not find hanlder with",e)}}async secondParseLine(e,t,i){let r=e[0];if(this.idsSet.has(e[1])||!e[1]){let n=cr();if(this.oldId[n]=e[1],e[1]=n,i)for(let s of i)s[3]=n}else this.idsSet.add(e[1]);switch(r){case"DOCTYPE":case"HEAD":case"CANVAS":case"LAYER":case"LAYER_PHYS":case"ACTIVE_LAYER":case"NET":case"PRIMITIVE":case"GROUP":case"SILK_OPTS":case"PREFERENCE":case"ITEM_ORDER":case"RULE_TEMPLATE":case"RULE":case"RULE_SELECTOR":case"PANELIZE":case"PANELIZE_STAMP":case"PANELIZE_SIDE":case"CONNECT":case"EQLEN_GRP":case"EQLEN":case"FONT":case"PAD_NET":case"REUSE_BLOCK":case"PROP":break;case"PARTITION":this.parsePartition(e);break;case"VIA":this.parseVia(e);break;case"PAD":this.parsePad(e);break;case"LINE":await this.parseLine(e);break;case"ARC":this.parseArc(e);break;case"CARC":this.parseCArc(e);break;case"OBJ":this.parseObj(e);break;case"POLY":this.parsePoly(e);break;case"FILL":this.parseFill(e);break;case"REGION":this.parseRegion(e);break;case"POUR":this.parsePour(e);break;case"IMAGE":this.parseImage(e);break;case"TEARDROP":this.parseTeardrop(e);break;case"FPC_FILL":this.parseFpcFill(e);break;case"SHELL":this.parseShell(e);break;case"CREASE":this.parseCrease(e);break;case"SHELLCUT":this.parseShellCut(e);break;case"SHELL_ENTITY":this.parseShellEntity(e);break;case"BOSS":this.parseBoss(e);break;case"STRING":this.parseString(e);break;case"ATTR":this.parseAttr(e,t);break;case"DIMENSION":this.parseDimension(e);break;case"COMPONENT":this.parseComponent(e);break;default:console.warn("can not find hanlder with",e)}}onParseEnd(){for(let e of this.rules)e[1]=this.transRuleType(e[1]),e[3]=this.transRuleStatus(e[3]),e[4]=PH(e[1],e[2],e[3],e[4],this.fac,this.ruleTemplateName);if(this.fac.init){let e=Array.from(this.rules);for(let t of e){let i=EH(t[1],t[2],t[4],this.fac);i&&this.rules.push(i)}}for(let e of this.rules)this.parseRule(e);for(let e of this.ruleSelectors)this.parseRuleSelector(e);this.handConnect(),this.parseEQLenGrpFull(),this.parsePanelize(),this.parseLayerFill();for(let e in this.cache){let t=this.cache[e],i=Object.keys(t).sort((n,s)=>Number(n)-Number(s)),r=-1;for(let n of i){let s=Number(n),a=s-r-1;a>=1&&this.onPHolder(e,a),r=s,this.curPartition=t[s].part,this.secondParseLine(t[s].value,void 0,t[s].attr),t[s].attr&&t[s].attr.forEach(o=>{this.curPartition=o.part,this.secondParseLine(o.value)})}if(this.errorIds[e])for(let n of this.errorIds[e])this.curPartition=n.part,this.secondParseLine(n.value)}this.clearCache()}clearCache(){this.version=void 0,this.docType=void 0,this.curPartition="",this.eQLenData={},this.eQLenSort=1,this.cache={},this.components={},this.errorIds={},this.dimension={},this.connects={},this.specialColors={},this.reuseBlock={},this.panelize.data.length&&(this.panelize.data.length=0,this.panelize.stamp={h:null,v:null},this.panelize.size={h:null,v:null}),this.layerPhys=0,this.fac.init&&(this.fac=new dC),this.rules=[],this.ruleSelectors=[],this.ruleTemplateName="",this.layerFill={},this.idsSet.clear(),this.oldId={},this.creaseIds.length=0}fixPolygon(e){if(e[0]=="R"){let t=parseFloat(e[3])/10,i=parseFloat(e[4])/10;e[6]=Math.min(t,i)/2*(parseFloat(e[6])||0)*10}}handleSimplePolygon(e){return!e||this.version>=1.5||this.fixPolygon(e),e}handlePolygon(e){if(this.version<1.5&&e&&e.length){if(!Array.isArray(e[0]))return this.handleSimplePolygon(e);for(let t of e)this.fixPolygon(t)}return e}parseEQLen(e){this.eQLenData[e[1]]?this.eQLenData[e[1]].pads?this.eQLenData[e[1]].pads.push(e[2]):this.eQLenData[e[1]].pads=[e[2]]:this.eQLenData[e[1]]={pads:[e[2]]}}parseEQLenGrp(e){this.eQLenData[e[1]]?(this.eQLenData[e[1]].id=e[1],this.eQLenData[e[1]].name=e[2],this.eQLenData[e[1]].sort=++this.eQLenSort):this.eQLenData[e[1]]={id:e[1],name:e[2],sort:++this.eQLenSort}}parseCanvas(e){this.onCanvas(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],this.transGridType(e[10]),this.transGridType(e[11]),e[12])}parseDocType(e){this.docType=e[1];let t=parseFloat(e[2]);this.version=t}parseHead(e){}parseLayer(e){let t=e[8];this.version<1.7&&(t=.5);let i=this.transLayerStatus(e[4]);this.onLayer(e[1],e[2],e[3],i.use,i.show,i.locked,e[5],e[6],e[7],t)}parseLayerPhys(e){this.onLayerPhys(e[1],e[2],e[3],e[4],e[5],!!e[6],++this.layerPhys)}parseActiveLayer(e){this.onActiveLayer(e[1])}parsePartition(e){this.onPartition(e[1],e[2],e[3],this.handlePolygon(e[4]))}parseNet(e){var t,i,r,n;this.onNet(e[1],(t=e[2])!=null?t:null,(i=e[3])!=null?i:null,!!e[4],(r=e[5])!=null?r:null,!!e[6],(n=e[7])!=null?n:null)}parsePrimitive(e){this.onPrimitive(e[1],!!e[2],!!e[3])}parseGroup(e){this.onGroup(e[1],e[2])}parseSilkOpts(e){this.onSilkOpts(e[1],e[2],e[3])}parsePreference(e){this.onPreference(!!e[1],e[2],!!e[3],e[4],e[5],!!e[6],this.transRoutingMode(e[7]),e[8],!!e[9],!!e[10],!!e[11],e[12],e[13],!!e[14],this.transUnusedPadRange(e[15]),e[16],this.transPathOptimization(e[17]),e[18],e[19],e[20])}parseConnect(e){this.connects[e[1]]=e[2]}parseVia(e){var t,i;this.onVia(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],e[6],e[7],e[8],this.transViaType(e[9]),(t=e[10])!=null?t:null,(i=e[11])!=null?i:null,!!e[12],e[13])}parsePad(e){var t,i,r,n,s,a,o,l,u;this.onPad(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],e[6],e[7],e[8],this.transHoleDef(e[9]),this.transPadDef(e[10]),e[11]&&(i=(t=e[11])==null?void 0:t.map(c=>({startLayer:c[0],endLayer:c[1],pad:this.transPadDef(c[2])})))!=null?i:null,e[12],e[13],e[14],!!e[15],this.transPadFuncType(e[16]),(r=e[17])!=null?r:null,(n=e[18])!=null?n:null,(s=e[19])!=null?s:null,(a=e[20])!=null?a:null,!!e[21],this.transPadConnect(e[22]),(o=e[23])!=null?o:null,(l=e[24])!=null?l:null,(u=e[25])!=null?u:null,e[26],this.getConnect(e[1]))}parseLine(e){this.onLine(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],!!e[10])}parseArc(e){this.onArc(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],!!e[11],this.specialColors[this.getOldId(e[1])])}parseCArc(e){this.onCArc(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],!!e[11],this.specialColors[this.getOldId(e[1])])}parseObj(e){this.onObj(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],!!e[10],e[11],!!e[12],this.specialColors[this.getOldId(e[1])])}parseItemOrder(e){this.itemOrder=e[1]}parseProp(e){this.specialColors[e[1]]=e[2]}parseEQLenGrpFull(){for(let e in this.eQLenData){let t=this.eQLenData[e];t.id&&this.onEQLenGrp(t.id,t.name,t.sort,t.pads||[])}this.eQLenData={},this.eQLenSort=1}parsePoly(e){this.onPoly(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],this.handleSimplePolygon(e[6]),!!e[7],this.specialColors[this.getOldId(e[1])])}parseFill(e){this.onFill(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],this.transFillStyle(e[6]),this.handlePolygon(e[7]),!!e[8],this.getConnect(e[1]),this.specialColors[this.getOldId(e[1])])}getZIndex1(e){let t=e.match(i0);return t!=null&&t.length?t[1]:null}parseLayerFill(){for(let e in this.layerFill){let t=this.layerFill[e];this.onLayerFill(Number(e),{fill:t.map(i=>{let r=this.getZIndex1(i[1]);return{id:i[1],partitionId:this.curPartition||"",groupId:i[2],locked:!!i[8],zIndex:r===null?null:Number(r),netName:i[3],width:i[5],path:this.handlePolygon(i[7]),refs:this.getConnect(i[1]),specialColor:this.specialColors[this.getOldId(i[1])]}})})}}parseRegion(e){let t=e[5],i=t&&t.includes(9)?"CONSTRAINT":"PROHIBIT";t=i?t.filter(r=>r!==9):t,this.onRegion(e[1],this.curPartition||"",e[2],e[3],e[4],this.transProhibitType(t),this.handlePolygon(e[6]),!!e[7],e[8],i)}parsePour(e){let t=e[9];this.version<=1.7&&t&&t[0]==="SOLID"&&t[1]&&(t[1]=8),this.onPour(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],e[6],e[7],this.handlePolygon(e[8]),this.transPourDef(t),!!e[10],!!e[11]),this.poured[e[1]]&&this.onPoured(e[1],this.poured[e[1]])}parsePoured(e){if(this.version<1.1){if(this.curPourId){let t={id:e[1],strokeWidth:e[2],fill:e[3],path:this.handlePolygon(e[4])};this.poured[this.curPourId]||(this.poured[this.curPourId]={pourFill:[]}),this.poured[this.curPourId].pourFill.push(t)}}else{let t={id:e[1],strokeWidth:e[3],fill:e[4],path:this.handlePolygon(e[5])};this.poured[e[2]]||(this.poured[e[2]]={pourFill:[]}),this.poured[e[2]].pourFill.push(t)}}parseImage(e){this.onImage(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],e[6],e[7],e[8],!!e[9],e[10],!!e[11],this.specialColors[this.getOldId(e[1])])}parseTeardrop(e){let t,i,r;this.version<1.2?(t=e[5],r=e[4]):(t=e[4],i=e[5],r=this.getConnect(e[1])),this.onTeardrop(e[1],this.curPartition||"",e[2],e[3],this.handleSimplePolygon(t),i!=null?i:null,r)}parseFpcFill(e){this.onFpcFill(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],this.handlePolygon(e[6]),!!e[7])}parseShell(e){let t=e[8];t&&t.Direction&&(t.Direction=this.transPushCoverDir(t.Direction)),this.onShell(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],e[6],this.handlePolygon(e[7]),t,!!e[9])}parseCrease(e){this.onCrease(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],e[6],e[7],e[8],!!e[9])}parseShellCut(e){this.onShellCut(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],this.handlePolygon(e[6]),!!e[7],this.getConnect(e[1]))}parseShellEntity(e){this.onShellEntity(e[1],this.curPartition||"",e[2],e[3],e[4],this.transEntityBelong(e[5]),this.transSlotOption(e[5]),e[6],e[7],this.handlePolygon(e[8]),!!e[9],this.getConnect(e[1]))}parseBoss(e){var t,i,r,n,s,a;this.version<1.4?this.onBoss(e[1],this.curPartition||"",e[2],e[3],e[5],e[6],(t=e[4])!=null?t:null,e[7],null,null,(i=e[8])!=null?i:null,(r=e[9])!=null?r:null,!!e[10]):this.onBoss(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],(n=e[6])!=null?n:null,e[7],e[8],e[9],(s=e[10])!=null?s:null,(a=e[11])!=null?a:null,!!e[12])}parseDimension(e){var n;let t=this.getOldId(e[1]),i=((n=this.dimension[t])==null?void 0:n.attr)||[];if(i.length){let s=this.fontCache.find(a=>a.id&&a.id===i[1]);this.version<1.6&&s&&(s.text=i[8],s.fontFamily=i[11],s.fontSize=i[12]/10,s.thickness=i[13],s.bold=i[15],s.italic=i[16],s.reverse=i[18],s.expansion=i[19])}let r={groupId:i[2],layerId:i[4],x:i[5],y:i[6],text:i[8],fontFamily:i[11],fontSize:i[12],strokeWidth:i[13],bold:i[14],italic:i[15],origin:i[16],angle:i[17],reverse:i[18],expansion:i[19],mirror:i[20],locked:i[21],zIndex:null,specialColor:this.specialColors[this.getOldId(i[1])]};this.onDimension(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],e[6],!!e[7],e[8],!!e[9],r,this.specialColors[this.getOldId(e[1])],i[2]||"")}parseRuleTemplate(e){this.ruleTemplateName=e[1],this.onRuleTemplate(e[1])}parseRule(e){this.onRule(e[1],e[2],e[3],e[4])}parseRuleSelector(e){let t=SH(e[1],e[2],Ax(e[3]),this.fac);this.onRuleSelector(e[1],e[2],t.ruleKeyValue,t.copperRuleValue||e[4]||{},t.innerPlaneRuleValue||e[5]||{})}parsePanelize(){let e=this.panelize.data;e.length&&this.onPanelize(!!e[1],e[2],e[3],e[4],e[5],!!e[6],this.panelize.stamp.h,this.panelize.stamp.v,this.panelize.size.h,this.panelize.size.v)}parsePanelizeStamp(e){let t={on:!!e[2],stampHoleGroupQuantity:e[3],stampHoleDiameter:e[4],stampHoleQuantityPerGroup:e[5],stampHoleSpacing:e[6]};e[1]?this.panelize.stamp.v=t:this.panelize.stamp.h=t}parsePanelizeSide(e){let t={on:!!e[2],sideHeight:e[3],positionHoleDiameter:e[4],markDiameter:e[5],markExpansion:e[6]};e[1]?this.panelize.size.v=t:this.panelize.size.h=t}parseComponent(e){let t=this.getOldId(e[1]),i=e[7]||{},r=this.reuseBlock[t];if(r&&Object.assign(i,{"Group ID":r[2]||"","Channel ID":r[3]||""}),this.onComponent(e[1],this.curPartition||"",e[2],e[3],e[4],e[5],e[6],i,!!e[8],this.specialColors[t]),this.cachePadNet[t])for(let n of this.cachePadNet[t])this.parsePadNet(n)}parsePadNet(e){let t=this.getOldId(e[1]);if(e[4]===void 0&&this.components[t]){let i=this.components[t].footprint;if(!i){let n=this.components[t].device;i=this.devices.find(s=>s.uuid===n).attributes.Footprint}let r=this.padNumId[i];if(!r){let n=this.footprints.find(s=>s.uuid===i);n&&(this.padNumId[i]=vH(n==null?void 0:n.dataStr),r=this.padNumId[i])}if(r){this.componentPadNum[t]||(this.componentPadNum[t]={}),this.componentPadNum[t][e[2]]===void 0&&(this.componentPadNum[t][e[2]]=-1);let n=++this.componentPadNum[t][e[2]];e[4]=r[e[2]][n]}}this.onPadNet(e[1],this.curPartition||"",e[2],e[3],e[4])}parseReuseBlock(e){this.reuseBlock[e[1]]=e}getFontCache(e,t,i,r,n,s,a,o){let l;return this.version<1.6?l=this.fontCache.find(u=>u.id===e):l=this.fontCache.find(u=>i==u.fontFamily&&t==u.text&&r/10==u.fontSize&&!!a==u.reverse&&o==u.expansion&&!!n==u.bold&&!!s==u.italic&&u.path.length>0),{paths:l==null?void 0:l.path,width:l==null?void 0:l.width,height:l==null?void 0:l.height}}getTextValue(e,t,i,r,n){let s="";return e!=""&&t===""&&this.docType!="PCB"&&!n&&e!="Footprint"&&!this.footprintIsConnectDevice&&(t=`<${e}>`),i?r?s=e+":"+t:s=e:r?s=t:s="",s}getFormulaName(e,t){if(!e||!e.startsWith("="))return e;e=e.slice(1);let i=/\{([^\}]+)\}/g,r=[],n=[];for(;r=i.exec(e);)n.push(r[1]);for(let s=0;s<n.length;s++){let a=n[s],o=`{${a}!}`;t.has(a)&&(o=t.get(a)),e=e.replace(`{${a}}`,o)}return e}parseAttr(e,t){let i=e[11],r=e[12];r&&this.version<1.2&&(i=="default"||i=="")&&(r*=1.5);let n=e[7],s=e[8],a=!!e[9],o=!!e[10],l=this.getOldId(e[3]),u=s;if(n==="Device"){let h=this.deviceName[s]||s;u=this.getTextValue(n,h,a,o,l)}else if(n==="Footprint"){let h=this.footprintName[s]||s;u=this.getTextValue(n,h,a,o,l)}else if(n==="Name"){let h=new Map;if(l){let m=this.components[l];if(h.set("ID",l),Object.entries(m.attrs).forEach(f=>h.set(f[0],f[1])),m.device){let f=this.devices.find(g=>g.uuid===m.device);f&&Object.entries(f.attributes).forEach(g=>h.set(g[0],g[1]))}}u=this.getTextValue(n,this.getFormulaName(s,h),a,o,l)}else u=this.getTextValue(n,s,a,o,l);let c=this.fontCache.find(h=>h.id&&h.id===e[1]);this.version<1.6&&c&&(c.text=u,c.fontFamily=i,c.fontSize=r/10,c.thickness=e[13],c.bold=e[15],c.italic=e[16],c.reverse=e[18],c.expansion=e[19]),this.onAttr(e[1],this.curPartition||"",e[2],l,e[4],e[5],e[6],n,s,a,o,i,r,e[13],!!e[14],!!e[15],this.transAlignType(e[16]),e[17],!!e[18],e[19],!!e[20],!!e[21],t,this.specialColors[this.getOldId(e[1])])}parseFont(e){let t;switch(this.version){case 1:case 1.1:t={id:e[1],path:e[2]};break;case 1.2:case 1.3:case 1.4:case 1.5:t={id:e[1],width:e[2],height:e[3],path:e[4]};break;default:t={text:e[1],fontFamily:e[2],fontSize:e[3],thickness:e[4],bold:!!e[5],italic:!!e[6],reverse:!!e[7],expansion:e[8],width:e[9],height:e[10],path:e[11]};break}this.fontCache.push(t)}parseString(e){let[,t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E]=e;if(!/^[a-zA-Z]+\d+$/.test(t)){let v=t.split(/([0-9].*)/);if(v.length>=2){let A=v[0],x=v[1];for(let T=0;T<x.length;T++){let R=x.charCodeAt(T);A+=R}t=A}}l&&this.version<1.2&&(o=="default"||o=="")&&(l*=1.5);let S=this.fontCache.find(v=>v.id&&v.id===e[1]);this.version<1.6&&S&&(S.text=a,S.fontFamily=o,S.fontSize=l/10,S.thickness=u,S.bold=c,S.italic=h,S.reverse=g,S.expansion=y),this.onString(t,this.curPartition||"",i,r,n,s,a,o,l,u,!!c,!!h,this.transAlignType(m),f,!!g,y,!!b,!!E,this.specialColors[this.getOldId(e[1])])}},CH=Object.create,xx=Object.defineProperty,xH=Object.getOwnPropertyDescriptor,TH=Object.getOwnPropertyNames,wH=Object.getPrototypeOf,RH=Object.prototype.hasOwnProperty,LH=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),NH=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of TH(t))!RH.call(e,n)&&n!==i&&xx(e,n,{get:()=>t[n],enumerable:!(r=xH(t,n))||r.enumerable});return e},DH=(e,t,i)=>(i=e!=null?CH(wH(e)):{},NH(t||!e||!e.__esModule?xx(i,"default",{value:e,enumerable:!0}):i,e)),BH=LH((e,t)=>{"use strict";t.exports=i,t.exports.default=i;function i(D,F,W){W=W||2;var z=F&&F.length,$=z?F[0]*W:D.length,te=r(D,0,$,W,!0),Z=[];if(!te||te.next===te.prev)return Z;var pe,Se,Ce,we,Fe,Ue,je;if(z&&(te=c(D,F,te,W)),D.length>80*W){pe=Ce=D[0],Se=we=D[1];for(var me=W;me<$;me+=W)Fe=D[me],Ue=D[me+1],Fe<pe&&(pe=Fe),Ue<Se&&(Se=Ue),Fe>Ce&&(Ce=Fe),Ue>we&&(we=Ue);je=Math.max(Ce-pe,we-Se),je=je!==0?32767/je:0}return s(te,Z,W,pe,Se,je,0),Z}function r(D,F,W,z,$){var te,Z;if($===X(D,F,W,z)>0)for(te=F;te<W;te+=z)Z=Q(te,D[te],D[te+1],Z);else for(te=W-z;te>=F;te-=z)Z=Q(te,D[te],D[te+1],Z);return Z&&T(Z,Z.next)&&(ne(Z),Z=Z.next),Z}function n(D,F){if(!D)return D;F||(F=D);var W=D,z;do if(z=!1,!W.steiner&&(T(W,W.next)||x(W.prev,W,W.next)===0)){if(ne(W),W=F=W.prev,W===W.next)break;z=!0}else W=W.next;while(z||W!==F);return F}function s(D,F,W,z,$,te,Z){if(D){!Z&&te&&y(D,z,$,te);for(var pe=D,Se,Ce;D.prev!==D.next;){if(Se=D.prev,Ce=D.next,te?o(D,z,$,te):a(D)){F.push(Se.i/W|0),F.push(D.i/W|0),F.push(Ce.i/W|0),ne(D),D=Ce.next,pe=Ce.next;continue}if(D=Ce,D===pe){Z?Z===1?(D=l(n(D),F,W),s(D,F,W,z,$,te,2)):Z===2&&u(D,F,W,z,$,te):s(n(D),F,W,z,$,te,1);break}}}}function a(D){var F=D.prev,W=D,z=D.next;if(x(F,W,z)>=0)return!1;for(var $=F.x,te=W.x,Z=z.x,pe=F.y,Se=W.y,Ce=z.y,we=$<te?$<Z?$:Z:te<Z?te:Z,Fe=pe<Se?pe<Ce?pe:Ce:Se<Ce?Se:Ce,Ue=$>te?$>Z?$:Z:te>Z?te:Z,je=pe>Se?pe>Ce?pe:Ce:Se>Ce?Se:Ce,me=z.next;me!==F;){if(me.x>=we&&me.x<=Ue&&me.y>=Fe&&me.y<=je&&v($,pe,te,Se,Z,Ce,me.x,me.y)&&x(me.prev,me,me.next)>=0)return!1;me=me.next}return!0}function o(D,F,W,z){var $=D.prev,te=D,Z=D.next;if(x($,te,Z)>=0)return!1;for(var pe=$.x,Se=te.x,Ce=Z.x,we=$.y,Fe=te.y,Ue=Z.y,je=pe<Se?pe<Ce?pe:Ce:Se<Ce?Se:Ce,me=we<Fe?we<Ue?we:Ue:Fe<Ue?Fe:Ue,Ae=pe>Se?pe>Ce?pe:Ce:Se>Ce?Se:Ce,We=we>Fe?we>Ue?we:Ue:Fe>Ue?Fe:Ue,tt=E(je,me,F,W,z),Ct=E(Ae,We,F,W,z),it=D.prevZ,Ze=D.nextZ;it&&it.z>=tt&&Ze&&Ze.z<=Ct;){if(it.x>=je&&it.x<=Ae&&it.y>=me&&it.y<=We&&it!==$&&it!==Z&&v(pe,we,Se,Fe,Ce,Ue,it.x,it.y)&&x(it.prev,it,it.next)>=0||(it=it.prevZ,Ze.x>=je&&Ze.x<=Ae&&Ze.y>=me&&Ze.y<=We&&Ze!==$&&Ze!==Z&&v(pe,we,Se,Fe,Ce,Ue,Ze.x,Ze.y)&&x(Ze.prev,Ze,Ze.next)>=0))return!1;Ze=Ze.nextZ}for(;it&&it.z>=tt;){if(it.x>=je&&it.x<=Ae&&it.y>=me&&it.y<=We&&it!==$&&it!==Z&&v(pe,we,Se,Fe,Ce,Ue,it.x,it.y)&&x(it.prev,it,it.next)>=0)return!1;it=it.prevZ}for(;Ze&&Ze.z<=Ct;){if(Ze.x>=je&&Ze.x<=Ae&&Ze.y>=me&&Ze.y<=We&&Ze!==$&&Ze!==Z&&v(pe,we,Se,Fe,Ce,Ue,Ze.x,Ze.y)&&x(Ze.prev,Ze,Ze.next)>=0)return!1;Ze=Ze.nextZ}return!0}function l(D,F,W){var z=D;do{var $=z.prev,te=z.next.next;!T($,te)&&R($,z,z.next,te)&&k($,te)&&k(te,$)&&(F.push($.i/W|0),F.push(z.i/W|0),F.push(te.i/W|0),ne(z),ne(z.next),z=D=te),z=z.next}while(z!==D);return n(z)}function u(D,F,W,z,$,te){var Z=D;do{for(var pe=Z.next.next;pe!==Z.prev;){if(Z.i!==pe.i&&A(Z,pe)){var Se=q(Z,pe);Z=n(Z,Z.next),Se=n(Se,Se.next),s(Z,F,W,z,$,te,0),s(Se,F,W,z,$,te,0);return}pe=pe.next}Z=Z.next}while(Z!==D)}function c(D,F,W,z){var $=[],te,Z,pe,Se,Ce;for(te=0,Z=F.length;te<Z;te++)pe=F[te]*z,Se=te<Z-1?F[te+1]*z:D.length,Ce=r(D,pe,Se,z,!1),Ce===Ce.next&&(Ce.steiner=!0),$.push(S(Ce));for($.sort(h),te=0;te<$.length;te++)W=m($[te],W);return W}function h(D,F){return D.x-F.x}function m(D,F){var W=f(D,F);if(!W)return F;var z=q(W,D);return n(z,z.next),n(W,W.next)}function f(D,F){var W=F,z=D.x,$=D.y,te=-1/0,Z;do{if($<=W.y&&$>=W.next.y&&W.next.y!==W.y){var pe=W.x+($-W.y)*(W.next.x-W.x)/(W.next.y-W.y);if(pe<=z&&pe>te&&(te=pe,Z=W.x<W.next.x?W:W.next,pe===z))return Z}W=W.next}while(W!==F);if(!Z)return null;var Se=Z,Ce=Z.x,we=Z.y,Fe=1/0,Ue;W=Z;do z>=W.x&&W.x>=Ce&&z!==W.x&&v($<we?z:te,$,Ce,we,$<we?te:z,$,W.x,W.y)&&(Ue=Math.abs($-W.y)/(z-W.x),k(W,D)&&(Ue<Fe||Ue===Fe&&(W.x>Z.x||W.x===Z.x&&g(Z,W)))&&(Z=W,Fe=Ue)),W=W.next;while(W!==Se);return Z}function g(D,F){return x(D.prev,D,F.prev)<0&&x(F.next,D,D.next)<0}function y(D,F,W,z){var $=D;do $.z===0&&($.z=E($.x,$.y,F,W,z)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==D);$.prevZ.nextZ=null,$.prevZ=null,b($)}function b(D){var F,W,z,$,te,Z,pe,Se,Ce=1;do{for(W=D,D=null,te=null,Z=0;W;){for(Z++,z=W,pe=0,F=0;F<Ce&&(pe++,z=z.nextZ,!!z);F++);for(Se=Ce;pe>0||Se>0&&z;)pe!==0&&(Se===0||!z||W.z<=z.z)?($=W,W=W.nextZ,pe--):($=z,z=z.nextZ,Se--),te?te.nextZ=$:D=$,$.prevZ=te,te=$;W=z}te.nextZ=null,Ce*=2}while(Z>1);return D}function E(D,F,W,z,$){return D=(D-W)*$|0,F=(F-z)*$|0,D=(D|D<<8)&16711935,D=(D|D<<4)&252645135,D=(D|D<<2)&858993459,D=(D|D<<1)&1431655765,F=(F|F<<8)&16711935,F=(F|F<<4)&252645135,F=(F|F<<2)&858993459,F=(F|F<<1)&1431655765,D|F<<1}function S(D){var F=D,W=D;do(F.x<W.x||F.x===W.x&&F.y<W.y)&&(W=F),F=F.next;while(F!==D);return W}function v(D,F,W,z,$,te,Z,pe){return($-Z)*(F-pe)>=(D-Z)*(te-pe)&&(D-Z)*(z-pe)>=(W-Z)*(F-pe)&&(W-Z)*(te-pe)>=($-Z)*(z-pe)}function A(D,F){return D.next.i!==F.i&&D.prev.i!==F.i&&!H(D,F)&&(k(D,F)&&k(F,D)&&ee(D,F)&&(x(D.prev,D,F.prev)||x(D,F.prev,F))||T(D,F)&&x(D.prev,D,D.next)>0&&x(F.prev,F,F.next)>0)}function x(D,F,W){return(F.y-D.y)*(W.x-F.x)-(F.x-D.x)*(W.y-F.y)}function T(D,F){return D.x===F.x&&D.y===F.y}function R(D,F,W,z){var $=O(x(D,F,W)),te=O(x(D,F,z)),Z=O(x(W,z,D)),pe=O(x(W,z,F));return!!($!==te&&Z!==pe||$===0&&L(D,W,F)||te===0&&L(D,z,F)||Z===0&&L(W,D,z)||pe===0&&L(W,F,z))}function L(D,F,W){return F.x<=Math.max(D.x,W.x)&&F.x>=Math.min(D.x,W.x)&&F.y<=Math.max(D.y,W.y)&&F.y>=Math.min(D.y,W.y)}function O(D){return D>0?1:D<0?-1:0}function H(D,F){var W=D;do{if(W.i!==D.i&&W.next.i!==D.i&&W.i!==F.i&&W.next.i!==F.i&&R(W,W.next,D,F))return!0;W=W.next}while(W!==D);return!1}function k(D,F){return x(D.prev,D,D.next)<0?x(D,F,D.next)>=0&&x(D,D.prev,F)>=0:x(D,F,D.prev)<0||x(D,D.next,F)<0}function ee(D,F){var W=D,z=!1,$=(D.x+F.x)/2,te=(D.y+F.y)/2;do W.y>te!=W.next.y>te&&W.next.y!==W.y&&$<(W.next.x-W.x)*(te-W.y)/(W.next.y-W.y)+W.x&&(z=!z),W=W.next;while(W!==D);return z}function q(D,F){var W=new G(D.i,D.x,D.y),z=new G(F.i,F.x,F.y),$=D.next,te=F.prev;return D.next=F,F.prev=D,W.next=$,$.prev=W,z.next=W,W.prev=z,te.next=z,z.prev=te,z}function Q(D,F,W,z){var $=new G(D,F,W);return z?($.next=z.next,$.prev=z,z.next.prev=$,z.next=$):($.prev=$,$.next=$),$}function ne(D){D.next.prev=D.prev,D.prev.next=D.next,D.prevZ&&(D.prevZ.nextZ=D.nextZ),D.nextZ&&(D.nextZ.prevZ=D.prevZ)}function G(D,F,W){this.i=D,this.x=F,this.y=W,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}i.deviation=function(D,F,W,z){var $=F&&F.length,te=$?F[0]*W:D.length,Z=Math.abs(X(D,0,te,W));if($)for(var pe=0,Se=F.length;pe<Se;pe++){var Ce=F[pe]*W,we=pe<Se-1?F[pe+1]*W:D.length;Z-=Math.abs(X(D,Ce,we,W))}var Fe=0;for(pe=0;pe<z.length;pe+=3){var Ue=z[pe]*W,je=z[pe+1]*W,me=z[pe+2]*W;Fe+=Math.abs((D[Ue]-D[me])*(D[je+1]-D[Ue+1])-(D[Ue]-D[je])*(D[me+1]-D[Ue+1]))}return Z===0&&Fe===0?0:Math.abs((Fe-Z)/Z)};function X(D,F,W,z){for(var $=0,te=F,Z=W-z;te<W;te+=z)$+=(D[Z]-D[te])*(D[te+1]+D[Z+1]),Z=te;return $}i.flatten=function(D){for(var F=D[0][0].length,W={vertices:[],holes:[],dimensions:F},z=0,$=0;$<D.length;$++){for(var te=0;te<D[$].length;te++)for(var Z=0;Z<F;Z++)W.vertices.push(D[$][te][Z]);$>0&&(z+=D[$-1].length,W.holes.push(z))}return W}}),OH=(e=>(e[e.MIL=1]="MIL",e[e.INCH=1e3]="INCH",e[e.FT=12e3]="FT",e[e.YARD=36e3]="YARD",e[e.MILE=6336e4]="MILE",e[e.KM=3937007874e-2]="KM",e[e.M=39370]="M",e[e.DM=3937]="DM",e[e.CM=393.7]="CM",e[e.MM=39.37]="MM",e[e.UM=.039]="UM",e[e.NM=394e-7]="NM",e[e.PT=13.88888888888889]="PT",e[e.PX72=13.88888888888889]="PX72",e[e.PX96=10.416666666666666]="PX96",e[e.PX100=10]="PX100",e[e.LTSPICE=6.25]="LTSPICE",e[e.PX1=.1]="PX1",e[e.PX001=.001]="PX001",e))(OH||{}),MH=(e=>(e.MIL="mil",e.INCH="inch",e.FT="ft",e.YARD="yard",e.MILE="mile",e.KM="km",e.M="m",e.DM="dm",e.CM="cm",e.MM="mm",e.UM="um",e.NM="nm",e.PT="pt",e.PX72="px(72)",e.PX96="px(96)",e.PX100="px(100)",e))(MH||{}),pC={mil:1,inch:1e3,ft:12e3,yard:36e3,mile:6336e4,km:3937007874e-2,dm:3937,mm:39.37,um:.039,nm:394e-7,pt:13.88888888888889,"px(72)":13.88888888888889,"px(96)":10.416666666666666,"px(100)":10},Fee=(()=>{let e={};for(let t in pC)e[pC[t]]=t;return e})();var Yo,Uee=(Yo=class{constructor(t,i){this.ratio=t/i}wrap(t){return t*this.ratio}static convert(t,i,r){return t*i/r}},Yo.ASIS=new Yo(1,1),Yo),yp=class{conversion(e,t,i){if(e===t)return i;let r=e+2+t;return this[r](i)}conversion1(e,t,i){let r=e+2+t,n=this[r](i);return t=="mil"?Math.round(n*10)/10:Math.round(n*1e3)/1e3}mil2mil(e){return e}mil2mm(e){return e*.0254}mil2cm(e){return e*.00254}mil2inch(e){return e/1e3}mm2mm(e){return e}mm2mil(e){let t=Math.pow(10,5);return Math.round(e*39.37007874015748*t)/t}mm2cm(e){return e/10}mm2inch(e){let t=Math.pow(10,8);return Math.round(e*.03937007874015748*t)/t}cm2mil(e){let t=Math.pow(10,6);return Math.round(e*393.7007874015748*t)/t}cm2mm(e){return e*10}cm2inch(e){let t=Math.pow(10,7);return Math.round(e*.3937007874015748*t)/t}inch2mil(e){return e*1e3}inch2mm(e){return e*25.4}inch2cm(e){return e*2.54}};yp.prototype["px(100)2mil"]=e=>e*10,yp.prototype["px(100)2mm"]=e=>e*.254,yp.prototype["mil2px(100)"]=e=>e/10,yp.prototype["mm2px(100)"]=e=>{let t=Math.pow(10,5);return Math.round(e*3.937007874015748*t)/t};var _p=null,n0=new ArrayBuffer(8),ib=new Float64Array(n0),rb=new Uint32Array(n0),fC=new Uint16Array(n0);var mC=class{static repeat(e,t){let i=new Array(t);for(;t-- >0;)i[t]=e;return i.join("")}static lpad(e,t,i){let r=i-e.length;return r>0?this.repeat(t,r)+e:e}static rpad(e,t,i){let r=i-e.length;return r>0?e+this.repeat(t,r):e}static strHashcode(e){if(e.length>0){let t=0;for(let i=0;i<e.length;i++)t=31*t+e.charCodeAt(i)|0;return t}else return 0}static arraycopy(e,t,i,r,n){if(e.length>=t+n&&i.length>=r+n)for(;n-- >0;)i[r++]=e[t++];else throw new Error("arraycopy out of range")}static undefAsNull(e){return null}static reverse(e,t){for(let i=0,r=e.length-1;r>=0;i++,r--)t[i]=e[r];return t}static sortAsc(e,t){return e-t}static xmlDecode(e){let t=e.length,i=new Array,r=-1;for(let n=0;n<t;n++){let s=e.charAt(n);if(r>=0){if(s===";"){let a=e.substring(r+1,n);switch(a){case"lt":i.push("<");break;case"gt":i.push(">");break;case"quot":i.push('"');break;case"apos":i.push("'");break;case"amp":i.push("&");break;default:if(a.charAt(0)==="#"){let o=parseInt(a.substring(1));i.push(String.fromCharCode(o))}else i.push("&"+a+";")}r=-1}}else s==="&"?r=n:i.push(s)}return r>=0&&i.push(e.substring(r)),i.join("")}static addAll(e,t){for(let i of t)e.push(i)}static addAllSet(e,t){for(let i of t)e.add(i)}static contains(e,t){for(let i of e)if(i.equals(t))return!0;return!1}static equals(e,t){if(e.length==t.length){for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}else return!1}static remove(e,t){let i=0,r=e.length;for(let n=0;n<r;n++)e[n]===t&&(e.splice(n,1),n--,r--,i++);return i}static getUrlVars(){for(var e={},t=location.href.slice(location.href.indexOf("?")+1).split("&"),i=0;i<t.length;i++){var r=t[i].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return e}static prefix(){if(!_p){let e=this.getUrlVars().version;e?_p="/analyzer/v"+e:_p="/analyzer"}return _p}static add2objS(e,t,i){if(t in e)return e[t];{let r=i(t);return e[t]=r,r}}static downloadFile(e,t){let i=document.createElement("a"),r=URL.createObjectURL(t);i.download=e,i.href=r,i.click(),URL.revokeObjectURL(r)}static uuid(){let e=new Array;ib[0]=new Date().getTime(),e.push(rb[1].toString(16)),ib[0]=Math.random(),e.push(fC[3].toString(16));let t=fC[2].toString(16);e.push("4"+t.substr(0,3)),ib[0]=performance.now();let i=rb[0].toString(16)+rb[1].toString(16);return e.push("0"+i.substr(0,3)),e.push(i.substr(3)),e.join("-")}static funcCopy(e){return(0,eval)("("+e.toString()+")")}static NVL(...e){for(let t of e)if(t!==null)return t;return null}static isSingle(e){return Array.from(new Set(e)).length===e.length}};var Tx=class{static rgb(e){if(0<=e&&e<=255)return e;throw new Error($l.format("RGB should not nagative and not over 255(0xFF): %X",e))}static normal(e){if(isFinite(e))return e;throw new Error($l.format("%f is not permitted",e))}static positiveOr0(e){if(e>=0)return e;throw new Error($l.format("%f must >= 0",e))}static positive(e){if(e>0)return e;throw new Error($l.format("%f must > 0",e))}static notnull(e){if(e!=null)return e;throw new Error("invalid null value")}static mustnull(e){if(e===null)return null;throw new Error("value must be null")}static notEmpty(e){if(e==null||e.length===0)throw new Error("invalid empty string");return e}static nullOrEmpty(e){return e==null||e.length===0}static notNullOrUndef(e){if(e!=null)return e;throw new Error("null or undefined is not permitted")}},kH=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.PERCENT=1]="PERCENT",e[e.LEFT_PAD0=2]="LEFT_PAD0",e))(kH||{}),FH=/(\.?0+)$/,$l=class{static format(e,...t){return this.format1(e,t)}static format1(e,t){let i=this._format(e,t);if(typeof i=="string")return i;throw new Error(this.format("Invalid state on (%d) %s",i,e))}static _format(e,t){let i=[],r=0,n=0,s,a=0,o=0;for(let l=0;l<e.length;l++){let u=e.charAt(l),c=u.charCodeAt(0);switch(r){case 0:c===37?r=1:i.push(u);break;case 1:switch(c){case 100:if(s=t[n++],typeof s=="number")i.push(s.toFixed(0)),r=0;else return l;break;case 102:if(s=t[n++],typeof s=="number")i.push(s.toString()),r=0;else return l;break;case 120:if(s=t[n++],typeof s=="number")i.push((s|0).toString(16)),r=0;else return l;break;case 88:if(s=t[n++],typeof s=="number")i.push((s|0).toString(16).toUpperCase()),r=0;else return l;break;case 115:case 99:s=t[n++],i.push(s===null?"null":s.toString()),r=0;break;case 48:a=l+1,o=-1,r=2;break;case 37:i.push("%"),r=0;break;default:return l}break;case 2:switch(c){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=l;break;case 120:if(o>=a){let h=parseInt(e.substring(a,o+1));if(s=t[n++],typeof s=="number")i.push(mC.lpad((s|0).toString(16),"0",h)),r=0;else return l}else return l;break;case 88:if(o>=a){let h=parseInt(e.substring(a,o+1));if(s=t[n++],typeof s=="number")i.push(mC.lpad((s|0).toString(16).toUpperCase(),"0",h)),r=0;else return l}else return l;break;default:return l}break;default:return l}}return i.join("")}static startsWith(e,t){return e.length>=t.length?e.substring(0,t.length)===t:!1}static endsWith(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}static split(e,t){let i=new Array,r=0;for(;;){let n=e.exec(t);if(n!==null){let s=e.lastIndex-n[0].length;i.push(t.substring(r,s)),r=e.lastIndex}else{let s=t.substring(r);Tx.nullOrEmpty(s)||i.push(s);break}}return i}static fmtNumber(e){return e.toFixed(5).replace(FH,"")}},UH=(e=>(e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARNING=2]="WARNING",e[e.ERROR=3]="ERROR",e[e.DUMMY=4]="DUMMY",e))(UH||{});function HH(e){switch(e){case 0:return"DEBUG";case 1:return"INFO";case 2:return"WARNING";case 3:return"ERROR";case 4:return"DUMMY"}}var jH=(e,t)=>{e===3?console.error(t):console.log(t)},YH=(e,t)=>$l.format("%s %s: %s",new Date,HH(e),t),na,Ef=(na=class{constructor(t,i=jH,r=YH){this.debug=!1,this.level=t,this.writer=i,this.fmt=r}static mix(...t){let i=4;for(let r of t)r.level<i&&(i=r.level);return new na(i,(r,n)=>{for(let s of t)s.write1(r,n)},(r,n)=>n)}wrap(t=null,i=null){let r=t===null?this.fmt:(s,a)=>(a=t(s,a),this.fmt(s,a)),n=i===null?this.writer:(s,a)=>{i(s,a),this.writer(s,a)};return new na(this.level,n,r)}chain(t){return t.wrap(this.fmt.bind(this),this.writer.bind(this))}include(t){return this.level<=t}write3(t,i,r){this.include(t)&&this.writer(t,this.fmt(t,$l.format(i,...r)))}write2(t,i){this.include(t)&&(i instanceof Error?this.writer(t,this.fmt(t,i.stack)):this.writer(t,this.fmt(t,i.toString())))}write1(t,i){this.include(t)&&this.writer(t,this.fmt(t,i))}debug3(t,...i){this.write3(0,t,i)}debug2(t){this.write2(0,t)}debug1(t){this.write1(0,t)}info3(t,...i){this.write3(1,t,i)}info2(t){this.write2(1,t)}info1(t){this.write1(1,t)}warning3(t,...i){this.write3(2,t,i)}warning2(t){this.write2(2,t)}warning1(t){this.write1(2,t)}error3(t,...i){this.write3(3,t,i)}error2(t){this.write2(3,t)}error1(t){this.write1(3,t)}},na.DUMMY=new na(4),na),s0=new ArrayBuffer(8),nb=new Float64Array(s0),sb=new Uint32Array(s0),gC=new Uint16Array(s0),yC=ArrayBuffer;try{yC=self.HTMLImageElement||yC}catch{}var bp=null;function Wo(e,t,i=0,r=e.length){n(e,null,t,i,r);function n(a,o,l,u,c){let h,m,f,g;if(u<c-1){let y=c-u;if(y>50)o===null&&(o=new Array(y+1)),s(a,o,l,u,(u+c)/2|0,c);else{h=a[u],m=u,f=u,g=c;let b=m+1;for(;b<g;){if(f!=g){if(g=g+-1,l(h,a[g])<=0)continue;a[f]=a[g],f=g;continue}if(l(h,a[b])>=0){m=b,b=m+1;continue}a[f]=a[b],m=b,f=b,b=m+1}a[f]=h,n(a,o,l,u,f),n(a,o,l,f+1,c)}}}function s(a,o,l,u,c,h){n(a,o,l,u,c),n(a,o,l,c,h);for(var m=u,f=c,g=0,y=a[m],b=a[f];m<c&&f<h;){var E=l(y,b);isNaN(E)?(o[g++]=b,b=a[++f]):(E<=0&&(o[g++]=y,y=a[++m]),E>=0&&(o[g++]=b,b=a[++f]))}for(;m<c;m++)o[g++]=a[m];for(;f<h;f++)o[g++]=a[f];for(m=u,f=0;f<g;m++,f++)a[m]=o[f]}}var Qi=class{static repeat(e,t){let i=new Array(t);for(;t-- >0;)i[t]=e;return i.join("")}static lpad(e,t,i){let r=i-e.length;return r>0?this.repeat(t,r)+e:e}static rpad(e,t,i){let r=i-e.length;return r>0?e+this.repeat(t,r):e}static strHashcode(e){if(e.length>0){let t=0;for(let i=0;i<e.length;i++)t=31*t+e.charCodeAt(i)|0;return t}else return 0}static arraycopy(e,t,i,r,n){if(e.length>=t+n&&i.length>=r+n)for(;n-- >0;)i[r++]=e[t++];else throw new Error("arraycopy out of range")}static undefAsNull(e){return null}static reverse(e,t){for(let i=0,r=e.length-1;r>=0;i++,r--)t[i]=e[r];return t}static sortAsc(e,t){return e-t}static xmlDecode(e){let t=e.length,i=new Array,r=-1;for(let n=0;n<t;n++){let s=e.charAt(n);if(r>=0){if(s===";"){let a=e.substring(r+1,n);switch(a){case"lt":i.push("<");break;case"gt":i.push(">");break;case"quot":i.push('"');break;case"apos":i.push("'");break;case"amp":i.push("&");break;default:if(a.charAt(0)==="#"){let o=parseInt(a.substring(1));i.push(String.fromCharCode(o))}else i.push("&"+a+";")}r=-1}}else s==="&"?r=n:i.push(s)}return r>=0&&i.push(e.substring(r)),i.join("")}static addAll(e,t){for(let i of t)e.push(i)}static addAllSet(e,t){for(let i of t)e.add(i)}static contains(e,t){for(let i of e)if(i.equals(t))return!0;return!1}static equals(e,t){if(e.length==t.length){for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}else return!1}static remove(e,t){let i=0,r=e.length;for(let n=0;n<r;n++)e[n]===t&&(e.splice(n,1),n--,r--,i++);return i}static getUrlVars(){for(var e={},t=location.href.slice(location.href.indexOf("?")+1).split("&"),i=0;i<t.length;i++){var r=t[i].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return e}static prefix(){if(!bp){let e=this.getUrlVars().version;e?bp="/analyzer/v"+e:bp="/analyzer"}return bp}static add2objS(e,t,i){if(t in e)return e[t];{let r=i(t);return e[t]=r,r}}static downloadFile(e,t){let i=document.createElement("a"),r=URL.createObjectURL(t);i.download=e,i.href=r,i.click(),URL.revokeObjectURL(r)}static uuid(){let e=new Array;nb[0]=new Date().getTime(),e.push(sb[1].toString(16)),nb[0]=Math.random(),e.push(gC[3].toString(16));let t=gC[2].toString(16);e.push("4"+t.substr(0,3)),nb[0]=performance.now();let i=sb[0].toString(16)+sb[1].toString(16);return e.push("0"+i.substr(0,3)),e.push(i.substr(3)),e.join("-")}static funcCopy(e){return(0,eval)("("+e.toString()+")")}static NVL(...e){for(let t of e)if(t!==null)return t;return null}static isSingle(e){return Array.from(new Set(e)).length===e.length}},GH=[1,10,100,1e3];var Pp=0,Lo=0;function _C(e,t,i){return Pp=Math.abs(e-t),i>=5&&Pp>1e-5||isNaN(i)&&Pp>1e-8?!1:Pp<1e-13?!0:(Lo=Math.min(bC(e),bC(t)),Lo<10&&(Lo=10),isNaN(i)||(Lo=Math.min(Lo,i)),PC(e,Lo)===PC(t,Lo))}var Ep=0,Sp=0;function bC(e){return Ep=0,Sp=0,e>0?Ep=e-Math.floor(e):Ep=e-Math.ceil(e),Sp=(Ep.toString()||"").length,Sp>2?Sp-2:0}function PC(e,t,i){if(typeof e!="number"&&(e=+e),isNaN(e))return NaN;if(t=t|0,t<=0||!e&&!i)return Math.round(e);var r=GH[t]||Math.pow(10,t)||10;if(i){var n=e<0?"-":"";for(e=e<0?-e:e,e=Math.round(e*r)+"";e.length<=t;)e="0"+e;return e=e.slice(0,-t)+"."+e.slice(-t),parseFloat(n+e)}else return Math.round(e*r+1e-10)/r}var WH=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.PERCENT=1]="PERCENT",e[e.LEFT_PAD0=2]="LEFT_PAD0",e))(WH||{}),zH=/(\.?0+)$/,Kl=class{static format(e,...t){return this.format1(e,t)}static format1(e,t){let i=this._format(e,t);if(typeof i=="string")return i;throw new Error(this.format("Invalid state on (%d) %s",i,e))}static _format(e,t){let i=[],r=0,n=0,s,a=0,o=0;for(let l=0;l<e.length;l++){let u=e.charAt(l),c=u.charCodeAt(0);switch(r){case 0:c===37?r=1:i.push(u);break;case 1:switch(c){case 100:if(s=t[n++],typeof s=="number")i.push(s.toFixed(0)),r=0;else return l;break;case 102:if(s=t[n++],typeof s=="number")i.push(s.toString()),r=0;else return l;break;case 120:if(s=t[n++],typeof s=="number")i.push((s|0).toString(16)),r=0;else return l;break;case 88:if(s=t[n++],typeof s=="number")i.push((s|0).toString(16).toUpperCase()),r=0;else return l;break;case 115:case 99:s=t[n++],i.push(s===null?"null":s.toString()),r=0;break;case 48:a=l+1,o=-1,r=2;break;case 37:i.push("%"),r=0;break;default:return l}break;case 2:switch(c){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=l;break;case 120:if(o>=a){let h=parseInt(e.substring(a,o+1));if(s=t[n++],typeof s=="number")i.push(Qi.lpad((s|0).toString(16),"0",h)),r=0;else return l}else return l;break;case 88:if(o>=a){let h=parseInt(e.substring(a,o+1));if(s=t[n++],typeof s=="number")i.push(Qi.lpad((s|0).toString(16).toUpperCase(),"0",h)),r=0;else return l}else return l;break;default:return l}break;default:return l}}return i.join("")}static startsWith(e,t){return e.length>=t.length?e.substring(0,t.length)===t:!1}static endsWith(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}static split(e,t){let i=new Array,r=0;for(;;){let n=e.exec(t);if(n!==null){let s=e.lastIndex-n[0].length;i.push(t.substring(r,s)),r=e.lastIndex}else{let s=t.substring(r);Ft.nullOrEmpty(s)||i.push(s);break}}return i}static fmtNumber(e){return e.toFixed(5).replace(zH,"")}},Ft=class{static rgb(e){if(0<=e&&e<=255)return e;throw new Error(Kl.format("RGB should not nagative and not over 255(0xFF): %X",e))}static normal(e){if(isFinite(e))return e;throw new Error(Kl.format("%f is not permitted",e))}static positiveOr0(e){if(e>=0)return e;throw new Error(Kl.format("%f must >= 0",e))}static positive(e){if(e>0)return e;throw new Error(Kl.format("%f must > 0",e))}static notnull(e){if(e!=null)return e;throw new Error("invalid null value")}static mustnull(e){if(e===null)return null;throw new Error("value must be null")}static notEmpty(e){if(e==null||e.length===0)throw new Error("invalid empty string");return e}static nullOrEmpty(e){return e==null||e.length===0}static notNullOrUndef(e){if(e!=null)return e;throw new Error("null or undefined is not permitted")}},Go,de=(Go=class{static regular(t){return Math.round(t*this.precision)/this.precision}static eq(t,i){return Math.abs(t-i)<=this.eps}static neq(t,i){return Math.abs(t-i)>this.eps}static less(t,i){return t-i<-this.eps}static lesseq(t,i){return t-i<=this.eps}static greater(t,i){return t-i>this.eps}static greatereq(t,i){return t-i>=-this.eps}static sqrt(t){return Math.abs(t)<=1e-10?0:Math.sqrt(t)}static sortAsc(t,i){return t-i}static sortDesc(t,i){return i-t}},Go.eps=1e-8,Go.precision=1e8,Go);function iu(e,t){Zp(e.iterator(),t)}function Zp(e,t){let i=0;for(;e.hasNext();){let r=e.next();t(i++,r)}}var VH=class{constructor(e){this.idx=-1,this.lst=e}hasNext(){return this.idx<this.lst.length-1}next(){if(this.idx<this.lst.length-1)return this.idx++,this.lst[this.idx];throw new Error("bug")}};function Tb(e){return new VH(e)}var Ii,Ye=(Ii=class{static toDegrees(t){return t*180/Math.PI}static toRadians(t){return t/180*Math.PI}static regularD(t){return t=t%360,t=t<0?360+t:t,t===360?0:t}static regular(t){return t=t%Ii.PIx2,t=t<0?Ii.PIx2+t:t,t===Ii.PIx2?0:t}static toQuarterBase(t){return Ii.regular((t+Ii.PI_4)/Ii.PI_2*Ii.PI_2)}static toQuarterBaseD(t){return Ii.regularD(((t+45)/90|0)*90)}static transformD(t,i){return Ii.toDegrees(Ii.transform(Ii.toRadians(t),i))}static transform(t,i){let r=Math.cos(t),n=Math.sin(t),s=new ie(i.data[6],i.data[7]),a=new ie(r,n).multiply3(i);return Ii.regular(a.angle(s))}},Ii.PIx2=Math.PI*2,Ii.PI_2=Math.PI/2,Ii.PI_4=Math.PI/4,Ii),Zt=class{static dotProd1(e,t,i,r){return e*i+t*r}static dotProd2(e,t,i,r,n,s){return this.dotProd1(i-e,r-t,n-i,s-r)}static dotProd3(e,t,i){return this.dotProd2(e.x,e.y,t.x,t.y,i.x,i.y)}static crossProd1(e,t,i,r){return e*r-t*i}static crossProd2(e,t,i,r,n,s){return this.crossProd1(i-e,r-t,n-i,s-r)}static crossProd3(e,t,i){return this.crossProd2(e.x,e.y,t.x,t.y,i.x,i.y)}static distance2(e,t,i,r){let n=i-e,s=r-t;return n*n+s*s}static distance1(e,t,i,r){return this.hypot(i-e,r-t)}static distance1p(e,t){return this.distance1(e.x,e.y,t.x,t.y)}static hypot(e,t){if(e=Math.abs(e),t=Math.abs(t),t>e){var i=t;t=e,e=i}if(e===0)return t;var r=t/e;return e*Math.sqrt(1+r*r)}},wx=new ArrayBuffer(16),EC=new Float64Array(wx),vp=new Int32Array(wx),ct,ie=(ct=class{static sortByXAsc(t,i){return t.x-i.x}static sortByYAsc(t,i){return t.y-i.y}static sortByXYAsc(t,i){return t.x<i.x?-1:t.x>i.x?1:t.y-i.y}static caculateAngle(t,i){let r=Math.cos(t),n=Math.sin(t),s=r*i.data[0]+n*i.data[4],a=r*i.data[1]+n*i.data[5],o=new ct(s,a).normalize();return Math.atan2(o.y,o.x)}static normal(t,i,r){let n=i.sub(t),s=r.sub(i);return n.cross(s)}static getVector2(t){return new ct(Math.cos(t),Math.sin(t))}static getCrossPoint1(t,i,r,n){if(t.equals1(i)||r.equals1(n)||de.eq(1,Math.abs(i.sub(t).normalize().dot(n.sub(r).normalize()))))return null;let s=i.y-t.y,a=t.x-i.x,o=i.x*t.y-t.x*i.y,l=n.y-r.y,u=r.x-n.x,c=n.x*r.y-r.x*n.y,h=s*u-l*a;return new ct((c*a-o*u)/h,(o*l-c*s)/h)}static getCrossPoint2(t,i,r,n){return this.getCrossPoint1(t,t.add(i),r,r.add(n))}constructor(t,i){this.x=Ft.normal(t),this.y=Ft.normal(i)}get hashed(){return this._hashed==null&&(EC[0]=this.x,EC[1]=this.y,this._hashed=vp[0]^vp[1]^vp[2]^vp[3]),this._hashed}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.sqrt(this.dot(this))}getCos(){return this.x/this.length()}sub(t){var i=this.x-t.x,r=this.y-t.y;return new ct(i,r)}add(t){var i=this.x+t.x,r=this.y+t.y;return new ct(i,r)}div(t){return new ct(this.x/t,this.y/t)}add1(t,i){return new ct(this.x+t,this.y+i)}mul(t){return new ct(this.x*t,this.y*t)}cross(t){return this.x*t.y-this.y*t.x}getSin(){return this.y/this.length()}angle2(t){let i=this.y-t.y,r=this.x-t.x;return i=Math.abs(i-0)<10**-4?0:i,r=Math.abs(r-0)<10**-4?0:r,Math.atan2(i,r)}angleD2(t){return Ye.toDegrees(this.angle2(t))}angle(t){return Math.atan2(this.y-t.y,this.x-t.x)}angleX(t=ct.ORIGIN){let i=this.angle(t);return i<0&&(i=Math.PI*2+i),i}angleD(t){return Ye.toDegrees(this.angle(t))}distance1(t){let i=t.x-this.x,r=t.y-this.y;return Zt.hypot(i,r)}distance2(t){let i=t.x-this.x,r=t.y-this.y;return i*i+r*r}rotateD(t,i){return this.rotate(t,Ye.toRadians(i))}rotate(t,i){let r=Math.cos(i),n=Math.sin(i),s=this.x-t.x,a=this.y-t.y,o=s*r+a*-n,l=s*n+a*r;return t.add1(o,l)}multiply3(t){let i=this.x*t.data[0]+this.y*t.data[3]+t.data[6],r=this.x*t.data[1]+this.y*t.data[4]+t.data[7];return new ct(i,r)}multiply4(t){let i=this.x*t.data[0]+this.y*t.data[4]+t.data[12],r=this.x*t.data[1]+this.y*t.data[5]+t.data[13];return new ct(i,r)}hashCode(){return this.hashed}equals(t,i){return t instanceof ct?_C(t.x,this.x,i)&&_C(t.y,this.y,i):!1}equals1(t){return t?de.eq(this.x,t.x)&&de.eq(this.y,t.y):!1}equals2(t,i){return t instanceof ct?Math.abs(this.x-t.x)<=i&&Math.abs(this.y-t.y)<=i:!1}similarEquals(t,i=.5){return Math.abs(this.x*.1-t.x*.1)<=i&&Math.abs(this.y*.1-t.y*.1)<=i}toString(){return"Vector [X="+this.x+", Y="+this.y+"]"}bbox(){let t=this.x,i=this.y;return new Zi(t,t,i,i)}normalize(){if(this.x===0&&this.y===0)return new ct(0,0);let t=this.x/this.length(),i=this.y/this.length();return new ct(t,i)}regular(t=1e-4){let i=Math.round(1/t);return new ct(Math.round(this.x*i)/i,Math.round(this.y*i)/i)}round(t=4){let i=10**(t|0);return new ct(Math.round(this.x*i)/i,Math.round(this.y*i)/i)}mirrorX(t=ct.ORIGIN){return new ct(this.x,2*t.y-this.y)}mirrorY(t=ct.ORIGIN){return new ct(2*t.x-this.x,this.y)}mirrorCenter(t=ct.ORIGIN){return new ct(2*t.x-this.x,2*t.y-this.y)}clone(){return new ct(this.x,this.y)}mirror(t=ct.ORIGIN){return new ct(2*t.x-this.x,2*t.y-this.y)}pointOnRays(t,i){let r=Ye.toRadians(t);return new ct(this.x+Math.cos(r)*i,this.y+Math.sin(r)*i)}pointOnRays2(t,i){let r=t.angle(this);return new ct(this.x+Math.cos(r)*i,this.y+Math.sin(r)*i)}scale(t){return new ct(this.x*t,this.y*t)}},ct.ORIGIN=new ct(0,0),ct.X_UNIT_VECTOR=new ct(1,0),ct.Y_UNIT_VECTOR=new ct(0,1),ct),qH=(e=>(e[e.LEFT=0]="LEFT",e[e.CENTER=1]="CENTER",e[e.RIGHT=2]="RIGHT",e))(qH||{}),XH=(e=>(e[e.TOP=0]="TOP",e[e.CENTER=1]="CENTER",e[e.BOTTOM=2]="BOTTOM",e))(XH||{}),li,$s=(li=class{constructor(t,i){this.horizontal=t,this.vertical=i}},li.LT=new li(0,0),li.LC=new li(0,1),li.LB=new li(0,2),li.CT=new li(1,0),li.CC=new li(1,1),li.CB=new li(1,2),li.RT=new li(2,0),li.RC=new li(2,1),li.RB=new li(2,2),li),JH=(e=>(e[e.INNER=0]="INNER",e[e.OUTER=1]="OUTER",e[e.SEPARATED=2]="SEPARATED",e[e.INTERSECTED=3]="INTERSECTED",e[e.EQ=4]="EQ",e[e.INSIDE_TOUCHED=5]="INSIDE_TOUCHED",e[e.OUTSIDE_TOUCHED=6]="OUTSIDE_TOUCHED",e))(JH||{}),Sr=class{constructor(){this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY}ext1(e){return this.minX=Math.min(this.minX,e.minX),this.maxX=Math.max(this.maxX,e.maxX),this.minY=Math.min(this.minY,e.minY),this.maxY=Math.max(this.maxY,e.maxY),this}ext2(e){return this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y),this}ext3(e){for(let t=0;t<e.length;t++){let i=e[t];this.ext2(i)}return this}ext4(e){return iu(e,(t,i)=>(this.ext2(i),!0)),this}ext5(e,t,i,r){return this.minX=Math.min(this.minX,e),this.maxX=Math.max(this.maxX,t),this.minY=Math.min(this.minY,i),this.maxY=Math.max(this.maxY,r),this}ext6(e,t){return this.minX=Math.min(this.minX,e),this.maxX=Math.max(this.maxX,e),this.minY=Math.min(this.minY,t),this.maxY=Math.max(this.maxY,t),this}ext7(e){if(e<0){let t=e*2;if(t<this.minX-this.maxX||t<this.minY-this.maxY)throw new Error("")}return this.minX-=e,this.maxX+=e,this.minY-=e,this.maxY+=e,this}ext8(e){let t=[];for(let i=0;i<e.length;i+=2)t.push(new ie(e[i],e[i+1]));return this.ext3(t)}ext9(e,t,i,r){return this.minX=Math.min(this.minX,e),this.maxX=Math.max(this.maxX,e+i),this.minY=Math.min(this.minY,t),this.maxY=Math.max(this.maxY,t+r),this}ext10({x:e,y:t,width:i,height:r}){return this.ext9(e,t,i,r)}valid(){return isFinite(this.minX)&&isFinite(this.maxX)&&isFinite(this.minY)&&isFinite(this.maxY)}clear(){this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY}build(){return new Zi(this.minX,this.maxX,this.minY,this.maxY)}build1(){return this.valid()?new Zi(this.minX,this.maxX,this.minY,this.maxY):new Zi(0,0,0,0)}},Tc=new Float64Array(4),Zi=class Pn{static extendRect({x:t,y:i,width:r,height:n}){return new Pn(t,t+r,i,i+n)}static extend1(t,i){if(t===null)return new Pn(i.x,i.x,i.y,i.y);{let r=Math.min(t.minX,i.x),n=Math.max(t.maxX,i.x),s=Math.min(t.minY,i.y),a=Math.max(t.maxY,i.y);return new Pn(r,n,s,a)}}static extend2(t,i){if(t){let r=Math.min(t.minX,i.minX),n=Math.max(t.maxX,i.maxX),s=Math.min(t.minY,i.minY),a=Math.max(t.maxY,i.maxY);return new Pn(r,n,s,a)}else return i}static extend3(t,i){let r=Math.min(t.x,i.x),n=Math.max(t.x,i.x),s=Math.min(t.y,i.y),a=Math.max(t.y,i.y);return new Pn(r,n,s,a)}static extend4(t,i,r){return new Pn(t.x-i/2,t.x+i/2,t.y-r/2,t.y+r/2)}constructor(t,i,r,n){if(this.minX=Ft.normal(t),this.maxX=Ft.normal(i),this.minY=Ft.normal(r),this.maxY=Ft.normal(n),t>i||r>n)throw new Error(`min > max is not permitted: [${t}, ${i}, ${r}, ${n}]`)}get data(){return Tc[0]=this.minX,Tc[1]=this.maxX,Tc[2]=this.minY,Tc[3]=this.maxY,Tc}isContains(t){return this.isContains1(t.x,t.y)}points(){return[this.LL(),this.LR(),this.UR(),this.UL(),this.LL()]}isContains1(t,i){return this.isContainsX(t)&&this.isContainsY(i)}isContains2(t,i){return this.isContainsX1(t)&&this.isContainsY1(i)}isContainsX(t){return t>=this.minX&&t<=this.maxX}isContainsX1(t){return de.greatereq(t,this.minX)&&de.lesseq(t,this.maxX)}isContainsY(t){return t>=this.minY&&t<=this.maxY}isContainsY1(t){return de.greatereq(t,this.minY)&&de.lesseq(t,this.maxY)}isIntersect(t){return!(this.maxX<t.minX||this.minX>t.maxX||this.maxY<t.minY||this.minY>t.maxY)}extendOfSize(t){return Ft.positiveOr0(this.maxX-this.minX+t*2),Ft.positiveOr0(this.maxY-this.minY+t*2),new Pn(this.minX-t,this.maxX+t,this.minY-t,this.maxY+t)}isInside(t){return this.minX>=t.minX&&this.maxX<=t.maxX&&this.minY>=t.minY&&this.maxY<=t.maxY}isContainsBBox(t){return this.maxX>=t.maxX&&this.minX<=t.minX&&this.maxY>=t.maxY&&this.minY<=t.minY}isContainsBBox1(t){return de.greatereq(this.maxX,t.maxX)&&de.lesseq(this.minX,t.minX)&&de.greatereq(this.maxY,t.maxY)&&de.lesseq(this.minY,t.minY)}intersect(t){let i=Math.max(this.minX,t.minX),r=Math.min(this.maxX,t.maxX);if(i>r)return null;let n=Math.max(this.minY,t.minY),s=Math.min(this.maxY,t.maxY);return n>s?null:new Pn(i,r,n,s)}intersection1(t){let i=Math.max(this.minX,t.minX),r=Math.min(this.maxX,t.maxX);if(de.greater(i,r))return null;i>r&&(r=i);let n=Math.max(this.minY,t.minY),s=Math.min(this.maxY,t.maxY);return de.greater(n,s)?null:(n>s&&(s=n),new Pn(i,r,n,s))}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}UL(){return new ie(this.minX,this.maxY)}UR(){return new ie(this.maxX,this.maxY)}LL(){return new ie(this.minX,this.minY)}LR(){return new ie(this.maxX,this.minY)}center(){return new ie(this.maxX-(this.maxX-this.minX)/2,this.maxY-(this.maxY-this.minY)/2)}area(){return this.width()*this.height()}transform(t){let i=new Sr;return i.ext2(this.LL().multiply3(t)),i.ext2(this.LR().multiply3(t)),i.ext2(this.UR().multiply3(t)),i.ext2(this.UL().multiply3(t)),i.build()}transform4(t){let i=new Sr;return i.ext2(this.LL().multiply4(t)),i.ext2(this.LR().multiply4(t)),i.ext2(this.UR().multiply4(t)),i.ext2(this.UL().multiply4(t)),i.build()}isSeparated(t){if(t==null||t==null)return!1;let i;this.minX>=t.minX?i=this.minX:i=t.minX;let r;if(this.maxX<=t.maxX?r=this.maxX:r=t.maxX,i>r)return!0;{let n;this.minY>=t.minY?n=this.minY:n=t.minY;let s;return this.maxY<=t.maxY?s=this.maxY:s=t.maxY,n>s}}relation(t){let i=0,r=0,n;this.minX>t.minX?(i++,n=this.minX):this.minX===t.minX?n=this.minX:(r++,n=t.minX);let s;if(this.maxX<t.maxX?(i++,s=this.maxX):this.maxX===t.maxX?s=this.maxX:(r++,s=t.maxX),n>s)return 2;{let a;this.minY>t.minY?(i++,a=this.minY):this.minY===t.minY?a=this.minY:(r++,a=t.minY);let o;return this.maxY<t.maxY?(i++,o=this.maxY):this.maxY===t.maxY?o=this.maxY:(r++,o=t.maxY),a>o?2:i===4?0:r===4?1:i===0&&r===0?4:n===s||a===o?6:i!==r?5:3}}zoom(t){let i=this.width(),r=this.height(),n=this.center();return t!=0&&(i/=t/2,r/=t/2),new Pn(n.x-i,n.x+i,n.y-i,n.y+i)}toString(){return"BBox [minX="+this.minX+", maxX="+this.maxX+", minY="+this.minY+", maxY="+this.maxY+"]"}equals(t){return this.minY==t.minY&&this.minX==t.minX&&this.maxX==t.maxX&&this.maxY==t.maxY}extendSize(t,i){return Object.is(void 0,i)&&(i=t),Pn.extend4(this.center(),this.width()+t,this.height()+i)}positionOnBBox(t,i=0){let r=this.center(),n=this.width()*i/2,s=this.height()*i/2,a=t.x-r.x,o=t.y-r.y;return a>n?o>s?$s.RT:o<-s?$s.RB:$s.RC:a<-n?o>s?$s.LT:o<-s?$s.LB:$s.LC:o>s?$s.CT:o<-s?$s.CB:$s.CC}bbox(){return this}},Qp=class ht{static mul(t,i,r,n,s,a){let o=0,l=0;for(let u=0;u<t;u++){for(let c=0;c<r;c++){let h=c,m=0;for(let f=0;f<i;f++)m+=n[l+f]*s[h],h+=r;a[o++]=m}l+=i}}constructor(t,i,r){this.m=Ft.normal(t),this.n=Ft.normal(i);let n=t*i;if(r.length===n){for(let s=0;s<r.length;s++)Ft.normal(r[s]);this.data=r}else throw new Error("invalid matrix size")}mul(t){if(this.n===t.m){let i=new Array(this.m*t.n);return ht.mul(this.m,this.n,t.n,this.data,t.data,i),new ht(this.m,t.n,i)}else throw new Error("m !== p")}toString(){let t=[];t.push("Matrix ("),t.push(this.m.toString()),t.push(" x "),t.push(this.n.toString()),t.push(")");let i=0;for(let r=0;r<this.m;r++)for(let n=0;n<this.n;n++){let s=this.data[i++].toString();n===0?(t.push(`
`),t.push("	"),t.push(s)):(t.push(", "),t.push(s))}return t.join("")}static on(t,i,r){return t*i+r}initExpandMatrix(t){let i=this.m,r=this.n,n=r*2,s=new Array(i*n);for(let a=0;a<i;a++)for(let o=0;o<n;o++)o<r?s[ht.on(n,a,o)]=t[ht.on(r,a,o)]:o===i+a?s[ht.on(n,a,o)]=1:s[ht.on(n,a,o)]=0;return s}inverseMatrix(t,i,r){for(let n=0;n<i;n++){let s=t[ht.on(r,n,n)];for(let a=0;a<r;a++)t[ht.on(r,n,a)]/=s}return t}getMatrixRank(t,i,r){let n=Math.min(i,r);for(let s=0;s<i;s++){if(t[ht.on(r,s,s)]===0){let a=new Array(r),o;for(o=s;o<i;o++)if(t[ht.on(r,o,s)]!==0){Qi.arraycopy(t,ht.on(r,o,0),a,0,r),Qi.arraycopy(t,ht.on(r,s,0),t,ht.on(r,o,0),r),Qi.arraycopy(a,0,t,ht.on(r,s,0),r);break}o>=i&&(n-=1)}if(!(n<i))for(let a=0;a<i;a++){if(a===s)continue;let o=t[ht.on(r,a,s)]/t[ht.on(r,s,s)];for(let l=0;l<r;l++)t[ht.on(r,a,l)]-=t[ht.on(r,s,l)]*o}}return n}getInverseMatrix(){if(this.m!==this.n)throw new Error("The matrix is an "+this.m+"x"+this.n+" order matrix, non-square matrix, please check!");function t(a){return de.lesseq(Math.abs(a),0)}let i=this.initExpandMatrix(this.data.slice(0)),r=this.n*2;function n(a,o){for(let l=0;l<r;l++){let u=i[ht.on(r,a,l)];i[ht.on(r,a,l)]=i[ht.on(r,o,l)],i[ht.on(r,o,l)]=u}}for(let a=0;a<this.m;a++){let o=Math.abs(i[ht.on(r,a,a)]),l=a;if(t(i[ht.on(r,a,a)]))for(let c=a+1;c<this.m;c++){if(t(i[ht.on(r,c,a)])){Math.abs(i[ht.on(r,c,a)])>o&&(o=Math.abs(i[ht.on(r,c,a)]),l=c);continue}n(a,c);break}if(t(i[ht.on(r,a,a)])){if(o===0)throw new Error("The matrix is a non-full rank matrix, please check!");console.warn("The matrix may be a non-full rank matrix, please check!"),l!==a&&n(a,l)}let u=1/i[ht.on(r,a,a)];for(let c=0;c<r;c++)i[ht.on(r,a,c)]*=u;for(let c=0;c<this.m;c++){if(a===c)continue;let h=i[ht.on(r,c,a)];for(let m=a;m<r;m++)i[ht.on(r,c,m)]-=i[ht.on(r,a,m)]*h}}let s=[];for(let a=0;a<this.m;a++)for(let o=this.n;o<r;o++)s[ht.on(this.n,a,o-this.n)]=i[ht.on(r,a,o)];return new ht(this.m,this.n,s)}getTransposeMatrix(){let t=new Array(this.data.length);for(let i=0;i<this.m;i++)for(let r=0;r<this.n;r++)t[r*this.n+i]=this.data[i*this.m+r];return new ht(this.n,this.m,t)}hashCode(){let t=0;for(let i of this.data)t+=i;return t}equals(t){return this===t?!0:t===null?!1:t instanceof ht?!(this.m!=t.m||this.n!=t.n||!Qi.equals(this.data,t.data)):!1}},$H=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Nt,Rx=(Nt=class extends Qp{static translate(t,i,r){return new Nt([1,0,0,0,0,1,0,0,0,0,1,0,t,i,r,1])}static translate1(t){return new Nt([1,0,0,0,0,1,0,0,0,0,1,0,t.x,t.y,t.z,1])}static rotateX(t){let i=Math.cos(t),r=Math.sin(t);return new Nt([1,0,0,0,0,i,r,0,0,-r,i,0,0,0,0,1])}static rotateY(t){let i=Math.cos(t),r=Math.sin(t);return new Nt([i,0,-r,0,0,1,0,0,r,0,i,0,0,0,0,1])}static rotateZ(t){let i=Math.cos(t),r=Math.sin(t);return new Nt([i,r,0,0,-r,i,0,0,0,0,1,0,0,0,0,1])}static rotateAxis(t,i){t=t.normalize();let r=t.x,n=t.y,s=t.z,a=Math.sin(i),o=Math.cos(i);return new Nt([r*r*(1-o)+o,r*n*(1-o)+s*a,r*s*(1-o)-n*a,0,r*n*(1-o)-s*a,n*n*(1-o)+o,n*s*(1-o)+r*a,0,r*s*(1-o)+n*a,n*s*(1-o)-r*a,s*s*(1-o)+o,0,0,0,0,1])}static scale(t,i=t,r=t){return new Nt([t,0,0,0,0,i,0,0,0,0,r,0,0,0,0,1])}static flipX(){return new Nt([1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])}static flipY(){return new Nt([-1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}static rotateZForPoint(t,i){return t.equals1(ie.ORIGIN)?Nt.rotateZ(i):Nt.translate(-t.x,-t.y,0).rotateZ(i).translate1(t.x,t.y,0)}static getMatrix4(t,i,r,n){let s=Math.cos(i),a=Math.sin(i),o=r*(t.x*s-t.y*a)+n.x,l=t.x*a+t.y*s+n.y,u=[r*s,a,0,0,-a*r,s,0,0,0,0,1,0,o,l,0,1];return new Nt(u)}constructor(t=$H){super(4,4,t)}translate(t){return this.multiply4(Nt.translate1(t))}translate1(t,i,r){return this.multiply4(Nt.translate(t,i,r))}rotateX(t){return this.multiply4(Nt.rotateX(t))}rotateY(t){return this.multiply4(Nt.rotateY(t))}rotateZ(t){return this.multiply4(Nt.rotateZ(t))}scale(t,i=t,r=t){return this.multiply4(Nt.scale(t,i,r))}scale1(t){return this.multiply4(Nt.scale(t.x,t.y,t.z))}setOrigin(t,i,r){return Nt.translate(-t,-i,-r).multiply4(this).translate1(t,i,r)}setOrigin1(t){return this.setOrigin(t.x,t.y,t.z)}multiply4(t){let i=new Array(16);return Qp.mul(4,4,4,this.data,t.data,i),new Nt(i)}getInverseMatrix(){let t=super.getInverseMatrix();return new Nt(t.data)}getTransposeMatrix(){let t=super.getTransposeMatrix();return new Nt(t.data)}inverse(){let t=this.getInverseMatrix();return new Nt(t.data)}toMatrix3(){let t=this.data;return new Pt([t[0],t[1],0,t[4],t[5],0,t[12],t[13],1])}},Nt.ORIGIN=new Nt,Nt);function wc(e){return Tx.normal(parseFloat(e))}var KH=[1,0,0,0,1,0,0,0,1],Tt,Pt=(Tt=class extends Qp{static translate(t,i){return new Tt([1,0,0,0,1,0,t,i,1])}static translate1(t){return this.translate(t.x,t.y)}static rotate(t){let i=Math.cos(t),r=Math.sin(t);return new Tt([i,r,0,-r,i,0,0,0,1])}static rotateD(t){return this.rotate(Ye.toRadians(t))}static scale(t,i=t){return new Tt([t,0,0,0,i,0,0,0,1])}static scale1(t,i){return new Tt([t,0,0,0,i,0,0,0,1])}static toDOMMatrix(t){let[i,r,,n,s,,a,o]=t.data;return`matrix(${[i,r,n,s,a,o].join(",")})`}static svgTrasform(t){let i=t.split(" "),r=null;return i.forEach(n=>{n=n.trim();let s=n.trim().replace(")","").split("("),a=s[0],o=s[1].split(",");switch(a){case"translate":let l=wc(o[0]),u=wc(o[1]);r=r?r.translate(l,u):Tt.translate(l,u);break;case"rotate":let c=wc(o[0]),h=wc(o[1]),m=wc(o[2]);r=r?r.setOrigin(h,m):Tt.translate(h,m),r=r.rotateD(c);break;default:return}}),r}constructor(t=KH){super(3,3,t);let i=t[0],r=t[3],n=t[1],s=t[4];this.iScale=Math.sqrt(i*i+n*n),this.jScale=Math.sqrt(r*r+s*s)}isMirrored(){return this.det()<0}multiply3(t){let i=new Array(9);return Qp.mul(3,3,3,this.data,t.data,i),new Tt(i)}translate(t,i){return this.multiply3(Tt.translate(t,i))}translate1(t){return this.multiply3(Tt.translate1(t))}scale(t,i=t){return this.multiply3(Tt.scale(t,i))}scale1(t,i){return this.multiply3(Tt.scale1(t,i))}det(){return this.data[0]*this.data[4]-this.data[3]*this.data[1]}invert(){let t=this.getInverseMatrix();return new Tt(t.data)}rotateD(t){return this.multiply3(Tt.rotateD(t))}rotate(t){return this.multiply3(Tt.rotate(t))}resetOffset(){let t=this.data;return new Tt([t[0],t[1],0,t[3],t[4],0,0,0,1])}setOrigin(t,i){return Tt.translate(-t,-i).multiply3(this).translate(t,i)}setOrigin1(t){return this.setOrigin(t.x,t.y)}getInverseMatrix(){return new Tt(super.getInverseMatrix().data)}getTransposeMatrix(){let t=super.getTransposeMatrix();return new Tt(t.data)}toMatrix4(){let t=this.data;return new Rx([t[0],t[1],0,t[2],t[3],t[4],0,t[5],0,0,1,0,t[6],t[7],0,t[8]])}scaleNum(t){return!t||isNaN(t)?t:t*this.iScale}},Tt.ORIGIN=new Tt,Tt.MIRROR_Y=new Tt([1,0,0,0,-1,0,0,0,1]),Tt.MIRROR_X=new Tt([-1,0,0,0,1,0,0,0,1]),Tt.ROT_90=new Tt([0,1,0,-1,0,0,0,0,1]),Tt.ROT_N90=new Tt([0,-1,0,1,0,0,0,0,1]),Tt),ZH=(e=>(e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e))(ZH||{}),Fa=(e=>(e[e.CW=0]="CW",e[e.CCW=1]="CCW",e))(Fa||{}),ad=class{},wb=class Mc{constructor(t,i,r){this.p1=t,this.p2=i,this.p3=r}barycentre(){return Mc.barycentre(this.p1,this.p2,this.p3)}incentre(){return Mc.incentre(this.p1,this.p2,this.p3)}static barycentre(t,i,r){let n=t.x+i.x+r.x,s=t.y+i.y+r.y;return new ie(n/3,s/3)}static incentre(t,i,r){let n=i.sub(r).length(),s=t.sub(r).length(),a=t.sub(i).length(),o=n+s+a,l=n*t.x+s*i.x+a*r.x,u=n*t.y+s*i.y+a*r.y;return new ie(l/o,u/o)}area(){return Mc.area(this.p1,this.p2,this.p3)}static area(t,i,r){return this.area2(t.x,t.y,i.x,i.y,r.x,r.y)/2}static area2(t,i,r,n,s,a){return Math.abs(Zt.crossProd2(t,i,r,n,s,a))}scale(t,i){let r=Pt.translate(-t.x,-t.y).scale(i).translate1(t),n=this.p1.multiply3(r),s=this.p2.multiply3(r),a=this.p3.multiply3(r);return new Mc(n,s,a)}scaleOnBarycentre(t){return this.scale(this.barycentre(),t)}scaleOnIncentre(t){return this.scale(this.incentre(),t)}extend(t){let i=this.incentre(),r=this.p1.add(this.p2).sub(i).scale(1/2),n=r.length(),s=ie.ORIGIN.pointOnRays2(r,n+t).length()/n;return this.scaleOnIncentre(s)}container(t){let i=this.p3.sub(this.p1),r=this.p2.sub(this.p1),n=t.sub(this.p1),s=i.dot(i),a=i.dot(r),o=i.dot(n),l=r.dot(r),u=r.dot(n),c=1/(s*l-a*a),h=(l*o-a*u)*c;if(h<0||h>1)return!1;let m=(s*u-a*o)*c;return m<0||m>1?!1:h+m<=1}};function Ip(){return{minDistance:Number.POSITIVE_INFINITY,start:null,end:null}}var Vn=class ka{static getMinDistanceWithoutCross(t,i){let r=Ip();return ka.minLine(t,i,r),r.minDistance}static getMinDistance(t,i){return vn(t,i)?0:this.getMinDistanceWithoutCross(t,i)}static getMinLineWithCross(t,i){let r=Ip();return ka.minLine(t,i,r),new J(r.start,r.end)}static getMinLine(t,i){return ka.intersection(t,i)||this.getMinLineWithCross(t,i)}static getMinDistanceFromPoint(t,i){let r=Ip();if(i instanceof J)this.point2LineMinLine(r,i,t);else if(i instanceof ue)this.point2ArcMinDistance(t,i,r);else throw new Error("not support");return r.minDistance}constructor(t,i){if(this.pt1=t,this.pt2=i,this.minline=ka.intersection(t,i),this.minline)this.minDistance=0;else{let r=Ip();ka.minLine(t,i,r),this.minline=new J(r.start,r.end),this.minDistance=r.minDistance}}getDistance(){return this.minDistance}getLine(){return this.minline}static intersection(t,i){let r=vn(t,i);if(r===0)return;let n=new Array;for(let s=0;s<r;s+=2){let a=new ie(Y[s],Y[s+1]);n.push(a)}return n.length>1?new J(n[0],n[1]):new J(n[0],n[0])}static minLine(t,i,r){if(t instanceof J&&i instanceof J)return this.minDistanceForLines(t,i,r);if(t instanceof ue&&i instanceof J)return this.minDistanceForLineAndArc(t,i,r);if(t instanceof J&&i instanceof ue)return this.minDistanceForLineAndArc(i,t,r);if(t instanceof ue&&i instanceof ue)return this.minDistanceForArcs(t,i,r);throw new Error("not support")}static minDistanceForLines(t,i,r){[t.start(),t.end(),i.start(),i.end()].forEach((n,s)=>{s<2?this.point2LineMinLine(r,i,n):this.point2LineMinLine(r,t,n)})}static minDistanceForLineAndArc(t,i,r){this.point2LineMinLine(r,i,t.start()),this.point2LineMinLine(r,i,t.svgEnd);let n=ka.foot(i,t.center);i.bbox().extendOfSize(1e-8).isContains(n)&&this.point2ArcMinLine(r,t,n),this.point2ArcMinLine(r,t,i.start()),this.point2ArcMinLine(r,t,i.end())}static minDistanceForArcs(t,i,r){this.concentricArc(t,i,r),this.point2ArcMinDistance(i.start(),t,r),this.point2ArcMinDistance(i.svgEnd,t,r),this.point2ArcMinDistance(t.start(),i,r),this.point2ArcMinDistance(t.svgEnd,i,r),(jn(t,i.center)||jn(i,t.center))&&this.shortestLineForArcs(t,i,r)}static minLineForArcAndLine(t,i,r){let n=t.pointOn(r.angleD(t.center)),s=t.pointOn(t.center.angleD(r));this.arcShortestLine(t,i,r,n),this.arcShortestLine(t,i,r,s)}static arcInnerLineFootSegment(t,i,r){let n=r.distance1(t.center);if(n!==0){let s=t.rx*(r.y-t.center.y)/n+t.center.y,a=t.rx*(r.x-t.center.x)/n+t.center.x;n=t.rx-n,n<i.minDistance&&(i.minDistance=n,i.start=new ie(a,s),i.end=r)}else n=t.rx-n,n<i.minDistance&&(i.minDistance=n,i.start=t.start(),i.end=r)}static shortestLineForArcs(t,i,r){let n=t.center.angleD(i.center),s=i.center.angleD(t.center),a=t.pointOn(n),o=t.pointOn(s),l=i.pointOn(n),u=i.pointOn(s);jn(t,a)&&(this.arcShortestLine(i,r,a,l),this.arcShortestLine(i,r,a,u)),jn(t,o)&&(this.arcShortestLine(i,r,o,l),this.arcShortestLine(i,r,o,u)),this.shortestLineForArcs1(t,i,r)}static shortestLineForArcs1(t,i,r){let n=i.start().sub(t.center).normalize(),s=i.end().sub(t.center).normalize(),a=t.start().sub(i.center).normalize(),o=t.end().sub(i.center).normalize(),l=t.center.add(n.mul(t.rx)),u=t.center.add(s.mul(t.rx)),c=i.center.add(a.mul(i.rx)),h=i.center.add(o.mul(i.rx));jn(t,l)&&de.greater(i.start().distance2(t.center),0)&&this.arcShortestLine(t,r,i.start(),l),jn(t,u)&&de.greater(i.end().distance2(t.center),0)&&this.arcShortestLine(t,r,i.end(),u),jn(i,c)&&de.greater(t.start().distance2(i.center),0)&&this.arcShortestLine(i,r,t.start(),c),jn(i,h)&&de.greater(t.end().distance2(i.center),0)&&this.arcShortestLine(i,r,t.end(),h)}static concentricArc(t,i,r){if(!(t.center.distance1(i.center)<1e-5&&t.rx===i.rx&&t.ry===i.ry))return;let n=t.start().distance1(i.svgEnd);n<r.minDistance&&(r.minDistance=n,r.start=t.start(),r.end=i.svgEnd),n=i.start().distance1(t.svgEnd),n<r.minDistance&&(r.minDistance=n,r.start=i.start(),r.end=t.svgEnd)}static point2ArcMinDistance(t,i,r){if(jn(i,t)){let n=i.pointOn(t.angleD(i.center)),s=i.pointOn(i.center.angleD(t));this.arcShortestLine(i,r,t,n),this.arcShortestLine(i,r,t,s)}else this.minLineSegment(r,i.start(),t),this.minLineSegment(r,i.svgEnd,t)}static point2ArcMinLine(t,i,r){if(jn(i,r)){let n=r.distance1(i.center);n>i.rx||n>i.ry?this.minLineForArcAndLine(i,t,r):this.arcInnerLineFootSegment(i,t,r)}}static point2LineMinLine(t,i,r){let n=ka.foot(i,r);i.bbox().extendOfSize(1e-8).isContains(n)?this.minLineSegment(t,n,r):(this.minLineSegment(t,i.start(),r),this.minLineSegment(t,i.end(),r))}static minLineSegment(t,i,r){let n=i.distance1(r);n<t.minDistance&&(t.minDistance=n,t.start=i,t.end=r)}static arcShortestLine(t,i,r,n){if(!jn(t,n))return;let s=r.distance1(n);s<i.minDistance&&(i.minDistance=s,i.start=r,i.end=n)}static foot(t,i){if(t.isPoint())return t.start();if(!de.eq(t.b,0)&&!de.eq(t.a,0)){let r=t.start(),n=t.direct,s=(i.x-r.x)*n.x+(i.y-r.y)*n.y;return new ie(r.x+n.x*s,r.y+n.y*s)}else return de.eq(t.b,0)&&!de.eq(t.a,0)?new ie(t.start().x,i.y):!de.eq(t.b,0)&&de.eq(t.a,0)?new ie(i.x,t.start().y):i}};function jn(e,t){if(de.eq(e.sweepAngle,360))return!0;let i=Ye.regularD(t.angleD(e.center));return e.sweepAngle>0?(de.less(i,e.startAngle)&&(i+=360),de.greatereq(e.endAngle(),i)):(de.greater(i,e.startAngle)&&(i-=360),de.lesseq(e.endAngle(),i))}var QH=[1,10,100,1e3],SC="http://www.w3.org/2000/svg",vC="http://www.w3.org/1999/xlink",IC="http://www.w3.org/XML/1998/namespace",AC="https://easyeda.com/",Hee=(function(){var e={svg:SC,xlink:vC,xml:IC,c:AC};return e[SC]="svg",e[vC]="xlink",e[IC]="xml",e[AC]="c",e})();var oi=(function(){var e={RATLINES:9,MODEL3D:19,ALL:11,TOPSILKLAYER:3,TOPLAYER:1,TOPPASTERLAYER:5,TOPSOLDERLAYER:7,LIBBODY:99,PADSURFACE:100,BOARDOUTLINE:10,DOCUMENT:12,TOPASSEMBLY:13,MECHANICAL:15,TOPCOMPONENT:16,SUBSTRATE:18},t;for(t=21;t<53;t++)e["INNER"+(t-20)]=t;for(e.BOTTOMSILKLAYER=4,e.BOTTOMLAYER=2,e.BOTTOMPASTERLAYER=6,e.BOTTOMSOLDERLAYER=8,e.BOTTOMASSEMBLY=14,e.BOTTOMCOMPONENT=17,t=53;t<85;t++)e["BOARD"+(t-52)]=t;return e})(),jee=(function(){var e={COPPERAREA:[1,2,21,22,23,24],PLANEZONE:[1,2,21,22,23,24],RECT:[1,2,3,4,5,6,7,8,12,13,14,15,21,22,23,24,99],TRACK:[1,2,3,4,5,6,7,8,10,12,13,14,15,21,22,23,24,99],PAD:[11,1,2],VIA:[11],HOLE:[11],TEXT:[3,4,1,2,7,8,12,13,14,15,21,22,23,24],ARC:[1,2,3,4,5,6,7,8,10,12,13,14,15,21,22,23,24,99],ELLIPSE:[3,4,12,13,14,15],CIRCLE:[1,2,3,4,5,6,7,8,10,12,13,14,15,21,22,23,24,99],DIMENSION:[3,4,12,13,14,15],FOOTPRINT:[1,2],SOLIDREGION:[1,2,3,4,5,6,7,8,12,13,14,15,21,22,23,24,11,99,100],SVGNODE:[1,2,3,4,7,8,12,13,14,15],PROTRACTOR:[3,4,12,13,14,15],SHEET:[12,13,14,15]};e["3D"]=(function(){for(var n=[16,19,3,7,5,1],s=21;s<52;s++)n.push(s+32,s);return n.push(2,6,8,4,17),n})();var t,i,r;for(t in e)if(e.hasOwnProperty(t)&&(r=e[t],r.indexOf(21)>0&&r.indexOf(25)===-1))for(i=25;i<=52;i++)r.push(i);return e})(),Di=(function(){var e={1:"TopLayer",2:"BottomLayer",3:"TopSilkLayer",4:"BottomSilkLayer",5:"TopPasteMaskLayer",6:"BottomPasteMaskLayer",7:"TopSolderMaskLayer",8:"BottomSolderMaskLayer",9:"Ratlines",10:"BoardOutLine",11:"Multi-Layer",12:"Document",13:"TopAssembly",14:"BottomAssembly",15:"Mechanical",16:"TopComponents",17:"BottomComponents",18:"Substrate",19:"3DModel",99:"ComponentShapeLayer",100:"LeadShapeLayer"},t;for(t=21;t<53;t++)e[t]="Inner"+(t-20);for(t=53;t<85;t++)e[t]="Substrate"+(t-52);return e})(),Yee=(function(){var e=[],t=[];for(var i in oi)if(oi.hasOwnProperty(i)){if(i.match(/^BOARD\d+/))continue;e.push(oi[i])}e.sort(),t.sort();var r={},n,s={21:"#999966",22:"#008000",23:"#00FF00",24:"#BC8E00",25:"#70DBFA",26:"#00CC66",27:"#9966FF",28:"#800080",29:"#008080",30:"#15935F",31:"#000080",32:"#00B400",33:"#2E4756",34:"#99842F",35:"#FFFFAA",36:"#99842F",37:"#2E4756",38:"#3535FF",39:"#8000BC",40:"#43AE5F",41:"#C3ECCE",42:"#728978",43:"#39503F",44:"#0C715D",45:"#5A8A80",46:"#2B937E",47:"#23999D",48:"#45B4E3",49:"#215DA1",50:"#4564D7",51:"#6969E9",52:"#9069E9"};e.forEach(function(o){switch(o){case oi.TOPLAYER:n={name:Di[o],color:"#FF0000",darkColor:"#CC0000",visible:!0,active:!0,config:!0};break;case oi.BOTTOMLAYER:n={name:Di[o],color:"#0000FF",darkColor:"#000080",visible:!0,active:!1,config:!0};break;case oi.TOPSILKLAYER:n={name:Di[o],color:"#FFCC00",darkColor:"#806600",visible:!0,active:!1,config:!0};break;case oi.BOTTOMSILKLAYER:n={name:Di[o],color:"#66CC33",darkColor:"#33661A",visible:!0,active:!1,config:!0};break;case oi.TOPPASTERLAYER:n={name:Di[o],color:"#808080",darkColor:"#666666",visible:!0,active:!1,config:!0};break;case oi.BOTTOMPASTERLAYER:n={name:Di[o],color:"#800000",darkColor:"#660000",visible:!0,active:!1,config:!0};break;case oi.TOPSOLDERLAYER:n={name:Di[o],color:"#800080",darkColor:"#660066",visible:!0,active:!1,transparency:.3,config:!0};break;case oi.BOTTOMSOLDERLAYER:n={name:Di[o],color:"#AA00FF",darkColor:"#8800CC",visible:!0,active:!1,transparency:.3,config:!0};break;case oi.RATLINES:n={name:Di[o],color:"#6464FF",darkColor:"#5050CC",visible:!1,active:!1,config:!0};break;case oi.BOARDOUTLINE:n={name:Di[o],color:"#FF00FF",darkColor:"#CC00CC",visible:!0,active:!1,config:!0};break;case oi.ALL:n={name:Di[o],color:"#C0C0C0",darkColor:"#999999",visible:!0,active:!1,config:!0};break;case oi.DOCUMENT:n={name:Di[o],color:"#FFFFFF",darkColor:"#CCCCCC",visible:!0,active:!1,config:!0};break;case oi.TOPASSEMBLY:n={name:Di[o],color:"#33CC99",darkColor:"#33AA99",visible:!1,active:!1,config:!1};break;case oi.BOTTOMASSEMBLY:n={name:Di[o],color:"#5555FF",darkColor:"#8888FF",visible:!1,active:!1,config:!1};break;case oi.MECHANICAL:n={name:Di[o],color:"#F022F0",darkColor:"#F088F0",visible:!1,active:!1,config:!1};break;case oi.MODEL3D:n={name:Di[o],color:"#66CCFF",visible:!1,active:!1,config:!1};break;case oi.LIBBODY:n={name:Di[o],color:"#00CCCC",visible:!1,active:!1,config:!1};break;case oi.PADSURFACE:n={name:Di[o],color:"#CC9999",visible:!1,active:!1,config:!1};break;default:o>=oi.INNER1&&o<=oi.INNER32?n={name:Di[o],color:s[o],darkColor:a(s[o]),visible:!1,active:!1,config:!1}:n=null;break}n&&(r[o]=n)}),r.Hole={config:!0,name:"Hole",darkColor:"#222222",color:"#222222"},r.DRCError={config:!0,name:"DRCError",color:"#FAD609",darkColor:"#FAD609"};function a(o){if(typeof o!="string"||!o.match(/#?([\da-f]{6})/i))return o;var l=parseInt(RegExp.$1,16),u=.5,c=Math.min(255,Math.round((l>>16)*u)),h=Math.min(255,Math.round((l>>8&255)*u)),m=Math.min(255,Math.round((l&255)*u)),f=((c<<16)+(h<<8)+m).toString(16);return"#"+("00000"+f).substr(-6).toUpperCase()}return r})(),CC={BLANK:0,SCH:1,PART:2,PCB:3,FOOTPRINT:4,PRJ:5,SUBPART:6,SPICESYMBOL:7,SUBCKT:8,NETLIST:9,WAVEFORM:10,SCHLIB3D:11,PHOTOVIEW:12,SCHMODULE:13,PCBMODULE:14,VIEW3D:15,PCBLIB3D:16,BLOCK_SYMBOL:17,NETFLAG:18,NETPORT:19,SHEET_SYMBOL:20,NONEELEC_SYMBOL:21,SHORT_SYMBOL:22,FOOTPRINTVIEW:23,CNCPRINTVIEW:24,PCB2D:31,PCB3D:32},Gee=(function(){var e={};for(let t in CC)e[CC[t]]=t;return e})();var Sf=Math.PI*2,ef=Math.PI/2,Wee=Math.sin(Math.PI/180);function ej(e,t,i){if(typeof e!="number"&&(e=+e),isNaN(e))return NaN;if(t=t|0,t<=0||!e&&!i)return Math.round(e);var r=QH[t]||Math.pow(10,t)||10;if(i){var n=e<0?"-":"";for(e=e<0?-e:e,e=Math.round(e*r)+"";e.length<=t;)e="0"+e;return e=e.slice(0,-t)+"."+e.slice(-t),parseFloat(n+e)}else return Math.round(e*r+1e-10)/r}function Lx(e,t,i){var r=e-t;return i||(i=1e-10),(r>0?r:-r)<i}function tj(e,t,i){var r=c(e)&&c(t)&&c(i);if(!r)return console.warn("Bad arguments"),null;var n=t.x-i.x>0?t.x:i.x,s=t.y-i.y>0?t.y:i.y,a=t.x-i.x>0?i.x:t.x,o=t.y-i.y>0?i.y:t.y,l=e.x,u=e.y;return l<=n+.001&&l>=a-.001&&u<=s+.001&&u>=o-.001;function c(h){return h?(h.x=Number(h.x),h.y=Number(h.y),isNaN(h.x)||isNaN(h.y)?(console.warn("Can not convert to Number, NaN found"),!1):!0):(console.warn("Empty input!"),!1)}}function ij(e,t,i,r,n,s){var a=(n-i)*(e-i)+(s-r)*(t-r),o=(n-i)*(n-i)+(s-r)*(s-r),l=a/o,u=i+(n-i)*l,c=r+(s-r)*l;return a<=0?Math.sqrt((e-i)*(e-i)+(t-r)*(t-r)):a>=o?Math.sqrt((e-n)*(e-n)+(t-s)*(t-s)):Math.sqrt((e-u)*(e-u)+(c-t)*(c-t))}function rj(e,t,i){return tj(e,t,i)?Lx((e.x-t.x)*(i.y-t.y),(i.x-t.x)*(e.y-t.y),.001):!1}var kc=1e-4,Y=new Float64Array(100);function vn(e,t){if(e instanceof J&&t instanceof J)return Ss(e,t);if(e instanceof ue&&t instanceof J)return Rb(e,t);if(e instanceof J&&t instanceof ue)return Rb(t,e);if(e instanceof ue&&t instanceof ue)return Dx(e,t);if(e instanceof Te&&t instanceof Te)return Up(e,t);if(e instanceof Te&&t instanceof J)return Up(e,new Te([t.start(),t.end()]));if(e instanceof J&&t instanceof Te)return Up(new Te([e.start(),e.end()]),t);if(e instanceof Te&&t instanceof ue)return DC(t,e);if(e instanceof ue&&t instanceof Te)return DC(e,t);throw new Error("not supported operation")}function nj(e,t){let i=e.bbox();if(i.isContainsY1(t)){let r=new J(new ie(i.minX-1,t),new ie(i.maxX+1,t));return Ss(r,e)>0?1:0}else return 0}function sj(e,t){if(e.rx===e.ry){let i=e.bbox();if(i.isContainsY1(t)){let r=new J(new ie(i.minX-1,t),new ie(i.maxX+1,t));return tf(e,r)>0?1:0}else return 0}else throw new Error("not supported operation")}function xC(e,t){let i=e.bbox();return i.isContainsY1(t)&&Up(new Te([new ie(i.minX-1,t),new ie(i.maxX+1,t)]),e)>0?1:0}function TC(e,t,i){return isFinite(t)&&isFinite(i)?e.isContains2(t,i):!1}function aj(e,t){let i=t.length(),r=Zt.crossProd3(t.start(),t.end(),e.start())/i,n=Zt.crossProd3(t.start(),t.end(),e.end())/i;return Math.abs(r)<1e-8||Math.abs(n)<1e-8||r*n<0}function Ss(e,t){let i=e.bbox().intersection1(t.bbox());if(!i)return 0;if(e.isPoint())if(t.isPoint()){let r=i.center();return Y[0]=r.x,Y[1]=r.y,2}else return wC(t,e,i);else{if(t.isPoint())return wC(e,t,i);{let r=function(v,A){i.isContains2(v,A)&&(Y[S++]=v,Y[S++]=A)};if(!aj(e,t))return 0;let n=e.start().x,s=e.start().y,a=e.end().x,o=e.end().y,l=t.start().x,u=t.start().y,c=t.end().x,h=t.end().y,m=t.length(),f=Zt.crossProd2(n,s,l,u,c,h)/m,g=Zt.crossProd2(a,o,l,u,c,h)/m;if(f*g>0&&!de.eq(f,0)&&!de.eq(g,0))return 0;let y=e.length(),b=Zt.crossProd2(l,u,n,s,a,o)/y,E=Zt.crossProd2(c,h,n,s,a,o)/y;if(b*E>0&&!de.eq(b,0)&&!de.eq(E,0))return 0;let S=0;if(de.eq(f,0)&&de.eq(g,0)){let v=i.UL(),A=i.UR(),x=i.LL(),T=i.LR();if(de.eq(i.width(),0))de.eq(i.height(),0)?(Y[S++]=v.x,Y[S++]=v.y):(Y[S++]=v.x,Y[S++]=v.y,Y[S++]=x.x,Y[S++]=x.y);else if(de.eq(i.height(),0))Y[S++]=v.x,Y[S++]=v.y,Y[S++]=A.x,Y[S++]=A.y;else{let R=wb.area2(v.x,v.y,l,u,c,h),L=wb.area2(A.x,A.y,l,u,c,h);R<L?(Y[S++]=v.x,Y[S++]=v.y,Y[S++]=T.x,Y[S++]=T.y):(Y[S++]=A.x,Y[S++]=A.y,Y[S++]=x.x,Y[S++]=x.y)}}else if(de.eq(f,0))r(n,s);else if(de.eq(g,0))r(a,o);else{let v=Math.abs(f/(f-g));r(n+(a-n)*v,s+(o-s)*v)}return S}}}function wC(e,t,i){let r=t.start(),n=t.end(),s=Zt.crossProd3(e.start(),e.end(),t.start()),a=Zt.crossProd3(e.start(),e.end(),t.end());if(s*a<0){let o=i.center();return Y[0]=o.x,Y[1]=o.y,2}else if(Math.abs(s)<Math.abs(a)){if(de.eq(s/e.length(),0))return Y[0]=r.x,Y[1]=r.y,2}else if(de.eq(a/e.length(),0))return Y[0]=n.x,Y[1]=n.y,2;return 0}function tf(e,t){let i=e.bbox().intersection1(t.bbox());if(i!=null){i=i.extendOfSize(kc);let r=e.center.x,n=e.center.y,s=e.rx,a=e.rx2,o=t.start().x,l=t.start().y,u=t.end().x,c=t.end().y,h=e.center.distance1(t.start()),m=e.center.distance1(t.end()),f=de.eq(h,s)?0:h>s?1:-1,g=de.eq(m,s)?0:m>s?1:-1,y=0;if(f===-1&&g===-1)return 0;if(f===0&&g===0)Y[y++]=o,Y[y++]=l,Y[y++]=u,Y[y++]=c;else if(f===1&&g===1){let b=Vn.foot(t,e.center),E=b.distance1(e.center);if(de.greater(E,s))return 0;if(de.eq(E,s))de.eq(t.distance2(e.start()),0)?(Y[y++]=e.start().x,Y[y++]=e.start().y,Y[y++]=e.start().x,Y[y++]=e.start().y):de.eq(t.distance2(e.end()),0)?(Y[y++]=e.end().x,Y[y++]=e.end().y,Y[y++]=e.end().x,Y[y++]=e.end().y):(Y[y++]=b.x,Y[y++]=b.y,Y[y++]=b.x,Y[y++]=b.y);else{y=Nx(r,n,o,l,u,c,y,b);let S=Y[y-2],v=Y[y-1];y-=2;let A=Zt.distance1(r,n,S,v);if(de.eq(A,s))Y[y++]=S,Y[y++]=v,Y[y++]=S,Y[y++]=v;else if(A<s)y=Yi(a,r,n,o,l,S,v,y),y=Yi(a,r,n,S,v,u,c,y);else return 0}}else if(f===-1||g===-1)y=Yi(a,r,n,o,l,u,c,y);else{let b=Vn.foot(t,e.center),E=b.distance1(e.center);if(de.eq(E,s)){let S=function(x){return TC(i,x.x,x.y)&&ri(e,x)},v=e.start(),A=e.end();if(f===0){let x=t.start();if(S(x))return Y[y++]=x.x,Y[y++]=x.y,Y[y++]=x.x,Y[y++]=x.y,y;if(S(b))return Y[y++]=b.x,Y[y++]=b.y,Y[y++]=b.x,Y[y++]=b.y,y;if(de.eq(t.distance2(v),0)&&S(v))return Y[y++]=v.x,Y[y++]=v.y,Y[y++]=v.x,Y[y++]=v.y,y;if(de.eq(t.distance2(A),0)&&S(A))return Y[y++]=A.x,Y[y++]=A.y,Y[y++]=A.x,Y[y++]=A.y,y;if(h<=s)y=Yi(a,r,n,b.x,b.y,u,c,y),y===2&&(Y[y++]=Y[0],Y[y++]=Y[1]);else if(E<s){if(y=Yi(a,r,n,b.x,b.y,u,c,y),y===2&&S(new ie(Y[0],Y[1])))return Y[y++]=Y[0],Y[y++]=Y[1],y;y=Yi(a,r,n,b.x,b.y,o,l,0),y===2&&(Y[y++]=Y[0],Y[y++]=Y[1])}}else{let x=t.end();if(S(x))return Y[y++]=x.x,Y[y++]=x.y,Y[y++]=x.x,Y[y++]=x.y,y;if(S(b))return Y[y++]=b.x,Y[y++]=b.y,Y[y++]=b.x,Y[y++]=b.y,y;if(de.eq(t.distance2(v),0)&&S(v))return Y[y++]=v.x,Y[y++]=v.y,Y[y++]=v.x,Y[y++]=v.y,y;if(de.eq(t.distance2(A),0)&&S(A))return Y[y++]=A.x,Y[y++]=A.y,Y[y++]=A.x,Y[y++]=A.y,y;if(m<=s)y=Yi(a,r,n,b.x,b.y,o,l,y),y===2&&(Y[y++]=Y[0],Y[y++]=Y[1]);else if(E<s){if(y=Yi(a,r,n,b.x,b.y,o,l,y),y===2&&S(new ie(Y[0],Y[1])))return Y[y++]=Y[0],Y[y++]=Y[1],y;y=Yi(a,r,n,b.x,b.y,u,c,0),y===2&&(Y[y++]=Y[0],Y[y++]=Y[1])}}}else if(f===0){let S=t.start();Y[y++]=S.x,Y[y++]=S.y,(o-b.x)*(u-b.x)+(l-b.y)*(c-b.y)<0&&(y=Yi(a,r,n,b.x,b.y,u,c,y))}else{let S=t.end();Y[y++]=S.x,Y[y++]=S.y,(o-b.x)*(u-b.x)+(l-b.y)*(c-b.y)<0&&(y=Yi(a,r,n,b.x,b.y,o,l,y))}}if(y>0){let b=0;for(let E=0;E<y;E+=2){let S=Y[E],v=Y[E+1];isFinite(S)&&isFinite(v)&&TC(i,S,v)&&ri(e,new ie(S,v))&&(Y[b++]=S,Y[b++]=v)}return b}else return 0}else return 0}function oj(e,t){if(e.bbox()){let i=e.center.x,r=e.center.y,n=e.rx2,s=t.start().x,a=t.start().y,o=t.end().x,l=t.end().y,u=e.center.distance2(t.start()),c=e.center.distance2(t.end()),h=de.eq(u,n)?0:u>n?1:-1,m=de.eq(c,n)?0:c>n?1:-1,f=0;if(h===-1&&m===-1)return 0;if(h===0&&m===0)Y[f++]=s,Y[f++]=a,Y[f++]=o,Y[f++]=l;else if(h===1&&m===1){let g=Vn.foot(t,e.center),y=g.distance2(e.center);if(de.greater(y,n))return 0;if(de.eq(y,n)){let b=g.distance2(e.start()),E=g.distance2(e.end());de.eq(b,0)?(Y[f++]=e.start().x,Y[f++]=e.start().y):de.eq(E,0)?(Y[f++]=e.end().x,Y[f++]=e.end().y):(Y[f++]=g.x,Y[f++]=g.y)}else{f=Nx(i,r,s,a,o,l,f,g);let b=Y[f-2],E=Y[f-1],S=Zt.distance2(i,r,b,E);if(f-=2,de.eq(S,n))Y[f++]=b,Y[f++]=E;else if(S<n)f=Yi(n,i,r,s,a,b,E,f),f=Yi(n,i,r,b,E,o,l,f);else return 0}}else if(h===-1||m===-1)f=Yi(n,i,r,s,a,o,l,f);else{let g=Vn.foot(t,e.center);h===0?(Y[f++]=t.start().x,Y[f++]=t.start().y,de.neq(g.distance2(t.start()),0)&&(s-g.x)*(o-g.x)+(a-g.y)*(l-g.y)<0&&(f=Yi(n,i,r,g.x,g.y,o,l,f))):(Y[f++]=t.end().x,Y[f++]=t.end().y,de.neq(g.distance2(t.end()),0)&&(s-g.x)*(o-g.x)+(a-g.y)*(l-g.y)<0&&(f=Yi(n,i,r,g.x,g.y,s,a,f)))}if(f>0){let g=0;for(let y=0;y<f;y+=2){let b=Y[y],E=Y[y+1];isFinite(b)&&isFinite(E)&&(Y[g++]=b,Y[g++]=E)}return g}else return 0}else return 0}function Yi(e,t,i,r,n,s,a,o){if(n==a){let v=e-(n-i)*(n-i);if(de.greater(v,0)){let A=Math.sqrt(v),x=t-A,T=t+A,R=Math.min(r,s),L=Math.max(r,s);return x>=R&&x<=L&&(Y[o++]=x,Y[o++]=n),T>=R&&T<=L&&(Y[o++]=T,Y[o++]=n),o}}let l=Zt.distance2(r,n,t,i)-e;if(l===0)return Y[o++]=r,Y[o++]=n,o;let u=Zt.distance2(s,a,t,i)-e;if(u===0)return Y[o++]=s,Y[o++]=a,o;let c=r,h=n,m=s,f=a,g=NaN,y=NaN,b=Number.POSITIVE_INFINITY,E=0;for(;b!==0;){E++;let v=Math.max(Math.min(Math.abs(l)/(Math.abs(l)+Math.abs(u)),.75),.25);if(g=c+(m-c)*v,y=h+(f-h)*v,c===g&&h===y||m===g&&f===y){Math.abs(l)>Math.abs(u)?(g=m,y=f,b=u):(g=c,y=h,b=l);break}else b=Zt.distance2(g,y,t,i)-e,b<0&&l>u||b>0&&l<u?(m=g,f=y,u=b):(c=g,h=y,l=b)}let S=Math.sqrt(e)-Zt.distance1(g,y,t,i);return(de.eq(0,b)||de.eq(0,S))&&(Y[o++]=g,Y[o++]=y),o}function Nx(e,t,i,r,n,s,a,o){let l=Zt.dotProd2(i,r,n,s,e,t),u=Zt.dotProd2(n,s,i,r,e,t);if(l>=0)return Y[a++]=n,Y[a++]=s,a;if(u>=0)return Y[a++]=i,Y[a++]=r,a;if(Zt.crossProd2(i,r,n,s,e,t)==0)return Y[a++]=e,Y[a++]=t,a;{let c=NaN,h=NaN,m=i,f=r,g=n,y=s,b=Zt.distance2(i,r,e,t),E=Zt.distance2(n,s,e,t),S=Number.POSITIVE_INFINITY,v=0;for(;S>0&&(v++,c=m+(g-m)*.5,h=f+(y-f)*.5,!(b==E||m==c&&f==h||g==c&&y==h));){S=Zt.distance2(c,h,e,t);let A=Zt.dotProd2(m,f,c,h,e,t);if(A==0)break;A<0?(g=c,y=h,E=S):(m=c,f=h,b=S)}return Zt.distance2(c,h,e,t)<Zt.distance2(o.x,o.y,e,t)?(Y[a++]=c,Y[a++]=h):(Y[a++]=o.x,Y[a++]=o.y),a}}function Rb(e,t){if(e.rx===e.ry)return tf(e,t);throw new Error("not supported")}function lj(e,t){if(e.rx===e.ry)return oj(e,t);throw new Error("not supported")}function Dx(e,t){if(e.bbox().intersection1(t.bbox())!=null){if(e.rx===e.ry&&t.rx===t.ry)return uj(e,t);throw new Error("not supported operation")}return 0}function uj(e,t){let i=e.center.x,r=e.center.y,n=t.center.x,s=t.center.y,a=e.rx,o=t.rx,l=e.rx2,u=t.rx2,c=e.center.distance1(t.center),h=Math.abs(a-o),m=a+o;if(de.greater(c,m)||de.less(c,h))return 0;if(de.eq(h+c,0)){let f=0,g;return ri(e,t.start())&&(Y[f]=t.start().x,Y[f+1]=t.start().y,f+=2,g=t.start()),ri(e,t.end())&&(Y[f]=t.end().x,Y[f+1]=t.end().y,f+=2,g=t.end()),f===0?(ri(t,e.start())&&(Y[f]=e.start().x,Y[f+1]=e.start().y,f+=2),ri(t,e.end())&&(Y[f]=e.end().x,Y[f+1]=e.end().y,f+=2)):f===2&&(!g.equals1(e.start())&&ri(t,e.start())&&(Y[f]=e.start().x,Y[f+1]=e.start().y,f+=2),!g.equals1(e.end())&&ri(t,e.end())&&(Y[f]=e.end().x,Y[f+1]=e.end().y,f+=2)),f}else if(de.eq(c,m)){if(RC(e,t))return 4;let f=new J(e.center,t.center),g=tf(t,f);return g=LC(e,g),g!==0?g:(g=tf(e,f),LC(t,g))}else if(de.eq(c,h)){if(RC(e,t))return 4;if(a>o){let f=(a-o)/a;return Y[0]=i+(n-i)/f,Y[1]=r+(s-r)/f,NC(e,t,2)}else{let f=(o-a)/o;return Y[0]=n+(i-n)/f,Y[1]=s+(r-s)/f,NC(e,t,2)}}else{let f=(e.center.distance2(t.center)-u+l)/(c*2)/c,g=(n-i)*f+i,y=(s-r)*f+r,b=n-i,E=s-r,S=Math.max(a,o),v,A,x,T;if(Math.abs(b)<Math.abs(E)){let H=b/-E,k=y-H*g;v=g-S,A=H*v+k,x=g+S,T=H*x+k}else{let H=E/-b,k=g-H*y;A=y-S,v=H*A+k,T=y+S,x=H*T+k}let R=Yi(l,i,r,v,A,g,y,0);if(R=Yi(l,i,r,g,y,x,T,R),R!==4)throw new Error("cnt !== 4");let L=new ie(Y[0],Y[1]),O=new ie(Y[2],Y[3]);if(ri(e,L)&&ri(t,L))return ri(e,O)&&ri(t,O)?4:Oa(e.start(),t,O,L)?(Y[2]=e.start().x,Y[3]=e.start().y,4):Oa(e.end(),t,O,L)?(Y[2]=e.end().x,Y[3]=e.end().y,4):Oa(t.start(),e,O,L)?(Y[2]=t.start().x,Y[3]=t.start().y,4):Oa(t.end(),e,O,L)?(Y[2]=t.end().x,Y[3]=t.end().y,4):2;if(ri(e,O)&&ri(t,O))return Oa(e.start(),t,L,O)?(Y[0]=e.start().x,Y[1]=e.start().y,4):Oa(e.end(),t,L,O)?(Y[0]=e.end().x,Y[1]=e.end().y,4):Oa(t.start(),e,L,O)?(Y[0]=t.start().x,Y[1]=t.start().y,4):Oa(t.end(),e,L,O)?(Y[0]=t.end().x,Y[1]=t.end().y,4):(Y[0]=Y[2],Y[1]=Y[3],2);{let H=function(Q,ne){if(de.eq(Q.distance1(ne.center),ne.rx)&&ri(ne,Q)){if(Q.distance2(L)<Q.distance2(O)){if(k)return;k=!0}else{if(ee)return;ee=!0}Y[q++]=Q.x,Y[q++]=Q.y}},k=!1,ee=!1,q=0;return H(e.start(),t),H(e.end(),t),H(t.start(),e),H(t.end(),e),q}}}function Oa(e,t,i,r){return de.eq(e.distance1(t.center),t.rx)&&ri(t,e)&&e.distance2(i)<e.distance2(r)}function RC(e,t){return de.eq(t.start().distance1(e.center),e.rx)&&ri(e,t.start())?(Y[0]=t.start().x,Y[1]=t.start().y,Y[2]=t.start().x,Y[3]=t.start().y,!0):de.eq(t.end().distance1(e.center),e.rx)&&ri(e,t.end())?(Y[0]=t.end().x,Y[1]=t.end().y,Y[2]=t.end().x,Y[3]=t.end().y,!0):de.eq(e.start().distance1(t.center),t.rx)&&ri(t,e.start())?(Y[0]=e.start().x,Y[1]=e.start().y,Y[2]=e.start().x,Y[3]=e.start().y,!0):de.eq(e.end().distance1(t.center),t.rx)&&ri(t,e.end())?(Y[0]=e.end().x,Y[1]=e.end().y,Y[2]=e.end().x,Y[3]=e.end().y,!0):!1}function LC(e,t){if(t===0)return 0;let i=Y[0],r=Y[1];return ri(e,new ie(i,r))?(Y[0]=i,Y[1]=r,Y[2]=i,Y[3]=r,4):0}function NC(e,t,i){if(i===0)return 0;let r=Y[0],n=Y[1],s=new ie(r,n);return ri(e,s)&&ri(t,s)?(Y[0]=r,Y[1]=n,Y[2]=r,Y[3]=n,4):0}function Fl(e,t){return Math.abs(e-t)<=1e-6}function ri(e,t){let i=e.bbox();if(t.x-i.minX>-kc&&t.x-i.maxX<kc&&t.y-i.minY>-kc&&t.y-i.maxY<kc){let r=Ye.regularD(t.angleD(e.center));return Fl(r,e.startAngle)||Fl(r,e.startAngle+360)||Fl(r,e.startAngle-360)||Fl(r,e.endAngle())||Fl(r,e.endAngle()+360)||Fl(r,e.endAngle()-360)?!0:e.sweepAngle>0?(de.less(r,e.startAngle)&&(r+=360),de.greatereq(e.endAngle(),r)):(de.greater(r,e.startAngle)&&(r-=360),de.lesseq(e.endAngle(),r))}else return!1}function cj(e,t){let i=e[1].x-e[0].x,r=e[1].y-e[0].y,n=t[1].x-t[0].x,s=t[1].y-t[0].y;if(i===0&&n!==0||i!==0&&n===0)return!1;if(i===0&&n===0)return!0;let a=r/i,o=s/n;return Lx(a,o,Math.sin(Math.PI/180))}function dj(e,t,i){var r,n=+t.x,s=+t.y,a=+i.x,o=+i.y,l=+e.x,u=+e.y,c=a-n,h=o-s,m=l-n,f=u-s,g,y,b,E,S,v;return c===0&&h===0?{d:Math.sqrt(m*m+f*f),point:new ie(n,s)}:(r=(m*c+f*h)/(c*c+h*h),r<0?{d:Math.sqrt(m*m+f*f),point:new ie(n,s)}:r>1?(g=l-a,y=u-o,{d:Math.sqrt(g*g+y*y),point:new ie(a,o)}):(S=n+r*c,v=s+r*h,b=l-S,E=u-v,{d:Math.sqrt(b*b+E*E),point:new ie(S,v)}))}function Gn(e,t){if(!e||!t||e.length!=t.length)return!1;let i="equals1";return!e.some((r,n)=>{let s=t[n],a=!1;return r&&s&&typeof r=="object"&&typeof s=="object"?typeof r[i]=="function"&&pj(r,s)?a=!r[i].call(r,s):a=!(r===s||r.toString()===s.toString()):typeof r=="number"&&typeof s=="number"?a=!(hj(r,s)||Number.isNaN(r)&&Number.isNaN(s)):a=r!==s,a})}function hj(e,t,i=5){return Math.abs(e-t)*Math.pow(10,i)<1}function pj(e,t){return!e||!t||typeof e!="object"||typeof t!="object"?e===t:e.constructor===t.constructor}var Je=new Float64Array(100);function Up(e,t){if(e.bbox().extendOfSize(de.eps).isSeparated(t.bbox()))return 0;let i=[[e,t]],r=(e.controls.length-1)*(t.controls.length-1)*8,n=0,s=Number.POSITIVE_INFINITY;for(;i.length!==0;){let a=function(G){k=Math.min(k,G),ee=Math.max(ee,G)},o=function(G,X){let D=Ss(G,X);if(D===0)throw new Error("cnt === 0");for(let F=0;F<D;F+=2)a(Y[F])};if(n>r){for(let G=n-2;G>=2;G-=2)for(let X=G-2;X>=0;X-=2)if(de.eq(Je[G],Je[X])&&de.eq(Je[G+1],Je[X+1])){Je[X]=(Je[G]+Je[X])/2,Je[X+1]=(Je[G+1]+Je[X+1])/2;for(let D=n-3;D>=G;D--)Je[D]=Je[D+2];n-=2;break}if(n>r){n=0;let G=t.start(),X=new Float64Array(8);e.getPercent(G)!==null&&(X[n++]=G.x,X[n++]=G.y);let D=t.end();e.getPercent(D)!==null&&(X[n++]=D.x,X[n++]=D.y);let F=e.start();t.getPercent(F)!==null&&(X[n++]=F.x,X[n++]=F.y);let W=e.end();return t.getPercent(W)!==null&&(X[n++]=W.x,X[n++]=W.y),Y.set(X),n}}let[l,u]=i.pop(),c=l.controls,h=u.controls;if(c.length===2&&h.length===2){let G=Ss(new J(c[0],c[1]),new J(h[0],h[1]));for(let X=0;X<G;X++)Je[n++]=Y[X];continue}let m=c[0],f=c[c.length-1];m.equals1(f)&&(f=m.add1(1,0));let g=f.y-m.y,y=m.x-f.x,b=-g*m.x-y*m.y,E=Math.sqrt(1/(g**2+y**2));g*=E,y*=E,b*=E;let S=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY;if(c.forEach(G=>{let X=g*G.x+y*G.y+b;X<S&&(S=X),X>v&&(v=X)}),de.eq(S,v)){if(u.controls.length===2){let G=Ss(new J(l.start(),l.end()),new J(u.start(),u.end()));for(let X=0;X<G;X++)Je[n++]=Y[X];if(G!==0)continue}l=new Te([c[0],c[c.length-1]]),c=l.controls}let A=h.map(G=>{let X=g*G.x+y*G.y+b,D=Math.abs(X);return D<s&&(s=D),X}),x=0;for(let G of A){if(de.less(G,S))x=x|1;else if(de.greater(G,v))x=x|2;else{x=3;break}if(x===3)break}if(x!==3)continue;let T=0,R=0,L=f.x-m.x,O=f.y-m.y,H=Math.sqrt(1/(L**2+O**2));L*=H,O*=H;for(let G=1;G<c.length;G++){let X=c[G],D=(X.x-m.x)*L+(X.y-m.y)*O;D<T?T=D:D>R&&(R=D)}x=0;for(let G of h){let X=(G.x-m.x)*L+(G.y-m.y)*O;if(de.less(X,T))x=x|1;else if(de.greater(X,R))x=x|2;else{x=3;break}if(x===3)break}if(x!==3)continue;let k=Number.POSITIVE_INFINITY,ee=Number.NEGATIVE_INFINITY;s/=2,s<=de.eps&&(s=de.eps),S-=s,v+=s,A.forEach((G,X)=>{G>=S&&G<=v&&a(X/(A.length-1))});let q=new J(new ie(0,S),new ie(1,S)),Q=new J(new ie(0,v),new ie(1,v));for(let G=0;G<A.length-1;G++){let X=new ie(G/(A.length-1),A[G]),D=X.y<S?1:X.y>v?2:3;for(let F=0;F<A.length;F++){let W=new ie(F/(A.length-1),A[F]),z=W.y<S?1:W.y>v?2:3;D!==z&&(D===1?z===2?(o(new J(X,W),q),o(new J(X,W),Q)):o(new J(X,W),q):D===2?z===1?(o(new J(X,W),q),o(new J(X,W),Q)):o(new J(X,W),Q):z===1?o(new J(X,W),q):o(new J(X,W),Q))}}k!==0&&(u=u.clip(k)[1]),ee!==1&&(u=u.clip((ee-k)/(1-k))[0]);let ne=u.bbox();if(de.eq(ne.minX,ne.maxX)&&de.eq(ne.minY,ne.maxY)){x=0;for(let G of u.controls){let X=(G.x-m.x)*L+(G.y-m.y)*O;if(de.less(X,T))x=x|1;else if(de.greater(X,R))x=x|2;else{x=3;break}if(x===3)break}if(x===3){let G=new ie((ne.minX+ne.maxX)/2,(ne.minY+ne.maxY)/2);l.getPercent(G)&&(Je[n++]=G.x,Je[n++]=G.y)}continue}if(ee-k>.8){let[G,X]=u.clip(.5);i.push([G,l]),i.push([X,l])}else i.push([u,l])}for(let a=0;a<n;a++)Y[a]=Je[a];return n}function fj(e,t){if(e.bbox().extendOfSize(de.eps).isSeparated(t.bbox()))return{cnt:0};let i=[[e,t]],r=(e.controls.length-1)*(t.controls.length-1)*8,n=0,s=Number.POSITIVE_INFINITY;for(;i.length!==0;){let a=function(G){k=Math.min(k,G),ee=Math.max(ee,G)},o=function(G,X){let D=Ss(G,X);if(D===0)throw new Error("cnt === 0");for(let F=0;F<D;F+=2)a(Y[F])};if(n>r){for(let G=n-2;G>=2;G-=2)for(let X=G-2;X>=0;X-=2)if(de.eq(Je[G],Je[X])&&de.eq(Je[G+1],Je[X+1])){Je[X]=(Je[G]+Je[X])/2,Je[X+1]=(Je[G+1]+Je[X+1])/2;for(let D=n-3;D>=G;D--)Je[D]=Je[D+2];n-=2;break}if(n>r){n=0;let G=new Float64Array(8),X=t.end(),D=0;e.getPercent(X)!==null&&(G[n++]=X.x,G[n++]=X.y,D=2);let F=e.end();return t.getPercent(F)!==null&&(G[n++]=F.x,G[n++]=F.y,D=D===0?1:3),Y.set(G),{havOverlap:D,cnt:n}}}let[l,u]=i.pop(),c=l.controls,h=u.controls;if(c.length===2&&h.length===2){let G=Ss(new J(c[0],c[1]),new J(h[0],h[1]));for(let X=0;X<G;X++)Je[n++]=Y[X];continue}let m=c[0],f=c[c.length-1];m.equals1(f)&&(f=m.add1(1,0));let g=f.y-m.y,y=m.x-f.x,b=-g*m.x-y*m.y,E=Math.sqrt(1/(g**2+y**2));g*=E,y*=E,b*=E;let S=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY;if(c.forEach(G=>{let X=g*G.x+y*G.y+b;X<S&&(S=X),X>v&&(v=X)}),de.eq(S,v)){if(u.controls.length===2){let G=Ss(new J(l.start(),l.end()),new J(u.start(),u.end()));for(let X=0;X<G;X++)Je[n++]=Y[X];if(G!==0)continue}l=new Te([c[0],c[c.length-1]]),c=l.controls}let A=h.map(G=>{let X=g*G.x+y*G.y+b,D=Math.abs(X);return D<s&&(s=D),X}),x=0;for(let G of A){if(de.less(G,S))x=x|1;else if(de.greater(G,v))x=x|2;else{x=3;break}if(x===3)break}if(x!==3)continue;let T=0,R=0,L=f.x-m.x,O=f.y-m.y,H=Math.sqrt(1/(L**2+O**2));L*=H,O*=H;for(let G=1;G<c.length;G++){let X=c[G],D=(X.x-m.x)*L+(X.y-m.y)*O;D<T?T=D:D>R&&(R=D)}x=0;for(let G of h){let X=(G.x-m.x)*L+(G.y-m.y)*O;if(de.less(X,T))x=x|1;else if(de.greater(X,R))x=x|2;else{x=3;break}if(x===3)break}if(x!==3)continue;let k=Number.POSITIVE_INFINITY,ee=Number.NEGATIVE_INFINITY;s/=2,s<=de.eps&&(s=de.eps),S-=s,v+=s,A.forEach((G,X)=>{G>=S&&G<=v&&a(X/(A.length-1))});let q=new J(new ie(0,S),new ie(1,S)),Q=new J(new ie(0,v),new ie(1,v));for(let G=0;G<A.length-1;G++){let X=new ie(G/(A.length-1),A[G]),D=X.y<S?1:X.y>v?2:3;for(let F=0;F<A.length;F++){let W=new ie(F/(A.length-1),A[F]),z=W.y<S?1:W.y>v?2:3;D!==z&&(D===1?z===2?(o(new J(X,W),q),o(new J(X,W),Q)):o(new J(X,W),q):D===2?z===1?(o(new J(X,W),q),o(new J(X,W),Q)):o(new J(X,W),Q):z===1?o(new J(X,W),q):o(new J(X,W),Q))}}k!==0&&(u=u.clip(k)[1]),ee!==1&&(u=u.clip((ee-k)/(1-k))[0]);let ne=u.bbox();if(de.eq(ne.minX,ne.maxX)&&de.eq(ne.minY,ne.maxY)){x=0;for(let G of u.controls){let X=(G.x-m.x)*L+(G.y-m.y)*O;if(de.less(X,T))x=x|1;else if(de.greater(X,R))x=x|2;else{x=3;break}if(x===3)break}if(x===3){let G=new ie((ne.minX+ne.maxX)/2,(ne.minY+ne.maxY)/2);l.getPercent(G)&&(Je[n++]=G.x,Je[n++]=G.y)}continue}if(ee-k>.8){let[G,X]=u.clip(.5);i.push([G,l]),i.push([X,l])}else i.push([u,l])}for(let a=0;a<n;a++)Y[a]=Je[a];return{cnt:n}}var mj=class{constructor(e=de.eps){this.eps=e}eq(e,t){return Math.abs(e-t)<=this.eps}setEps(e){this.eps=e}},Rc=new mj;function DC(e,t){if(e.bbox().extendOfSize(de.eps).isSeparated(t.bbox()))return 0;let i=[[e,t]],r=(t.controls.length-1)*16,n=0;for(;i.length!==0;){if(n>r){let a=function(){for(let u=0;u<n;u+=2)for(let c=u+2;c<n;c+=2)if(!(Rc.eq(Je[u],Je[c])&&Rc.eq(Je[u+1],Je[c+1]))){l(Je[c],Je[c+1],o);break}function l(u,c,h){let m=!1;for(let f=0;f<h.length;f+=2)if(Rc.eq(u,h[f])&&Rc.eq(c,h[f+1])){m=!0;break}m||h.push(u,c)}},o=[Je[0],Je[1]];if(a(),o.length>=100&&(Rc.setEps(.001),o=[Je[0],Je[1]],a(),o.length>=100))throw new Error("clearSamePoint()");n=o.length,o.forEach((l,u)=>Je[u]=l)}let s=i.pop();if(s[0]instanceof ue){let a=function(Q){O=Math.min(O,Q),H=Math.max(H,Q)},o=function(Q,ne){let G=Ss(Q,ne);if(G===0)throw new Error("cnt === 0");for(let X=0;X<G;X+=2)a(Y[X])},[l,u]=s,c=u.controls;if(c.length===2){let Q=Rb(l,new J(c[0],c[1]));for(let ne=0;ne<Q;ne++)Je[n++]=Y[ne];continue}let h=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,f,g,y,b,E;if(Math.abs(l.sweepAngle)>359){let Q=l.rx;f=l.center.add1(Q,0),g=l.center.add1(-Q,0),h=-Q,m=Q,y=0,b=1,E=-l.center.y}else{f=l.start(),g=l.end(),y=g.y-f.y,b=f.x-g.x,E=-y*f.x-b*f.y;let Q=Math.sqrt(1/(y**2+b**2));y*=Q,b*=Q,E*=Q;let ne=y*l.center.x+b*l.center.y+E;l.isCCW?(m=l.rx+ne,h=0):(h=ne-l.rx,m=0)}let S=c.map(Q=>y*Q.x+b*Q.y+E),v=0;for(let Q of S){if(de.less(Q,h))v=v|1;else if(de.greater(Q,m))v=v|2;else{v=3;break}if(v===3)break}if(v!==3)continue;let A=0,x=0,T=g.x-f.x,R=g.y-f.y,L=Math.sqrt(1/(T**2+R**2));if(T*=L,R*=L,Math.abs(l.sweepAngle)<=180)A=0,x=(g.x-f.x)*T+(g.y-f.y)*R;else throw new Error("not support");v=0;for(let Q of c){let ne=(Q.x-f.x)*T+(Q.y-f.y)*R;if(de.less(ne,A))v=v|1;else if(de.greater(ne,x))v=v|2;else{v=3;break}if(v===3)break}if(v!==3)continue;let O=Number.POSITIVE_INFINITY,H=Number.NEGATIVE_INFINITY;h-=de.eps,m+=de.eps,S.forEach((Q,ne)=>{Q>=h&&Q<=m&&a(ne/(S.length-1))});let k=new J(new ie(0,h),new ie(1,h)),ee=new J(new ie(0,m),new ie(1,m));for(let Q=0;Q<S.length-1;Q++){let ne=new ie(Q/(S.length-1),S[Q]),G=ne.y<h?1:ne.y>m?2:3;for(let X=0;X<S.length;X++){let D=new ie(X/(S.length-1),S[X]),F=D.y<h?1:D.y>m?2:3;G!==F&&(G===1?F===2?(o(new J(ne,D),k),o(new J(ne,D),ee)):o(new J(ne,D),k):G===2?F===1?(o(new J(ne,D),k),o(new J(ne,D),ee)):o(new J(ne,D),ee):F===1?o(new J(ne,D),k):o(new J(ne,D),ee))}}O!==0&&(u=u.clip(O)[1]),H!==1&&(u=u.clip((H-O)/(1-O))[0]);let q=u.bbox();if(de.eq(q.minX,q.maxX)&&de.eq(q.minY,q.maxY)){v=0;for(let Q of u.controls){let ne=(Q.x-f.x)*T+(Q.y-f.y)*R;if(de.less(ne,A))v=v|1;else if(de.greater(ne,x))v=v|2;else{v=3;break}if(v===3)break}v===3&&(Je[n++]=(q.minX+q.maxX)/2,Je[n++]=(q.minY+q.maxY)/2);continue}H-O>.8?u.clip(.5).forEach(Q=>i.push([Q,l])):i.push([u,l])}else{let[a,o]=s;i.push([ue.build3(o.center,o.startAngle,o.sweepAngle/2,o.rx,o.ry),a]),i.push([ue.build3(o.center,o.startAngle+o.sweepAngle/2,o.sweepAngle/2,o.rx,o.ry),a])}}for(let s=0;s<n;s++)Y[s]=Je[s];return n}var gj=class{static getSweep(e){if(e.length>2){let t=0,i=e.length;for(let s=0;s<i-1;s++){let a=e[s],o=e[s+1];t+=(o.x+a.x)*(o.y-a.y)}let r=e[0],n=e[i-1];return t+=(r.x+n.x)*(r.y-n.y),t>0}else throw new Error("Unable to determine the direction of rotation!")}static isClose(e){return!!(e.primitives.length>0&&e.primitives[0].start().equals1(e.primitives[e.primitives.length-1].end()))}};function yj(e){let t=e.primitives,i=t[0],r=i instanceof ue?i.sweepAngle%360:null;if(t.length===1&&i instanceof ue&&(de.eq(r,0)||de.eq(Math.abs(r),360)))return!!i.isCCW;let n=new Array;return e.points(.1,s=>{n.push(s)}),gj.getSweep(n)}var _j=class{static zoomCorner(e,t){let i=new Array,r=new Array,n=new Array;return this.getPanPrimitive(e,i,n,t),this.rearrange(i,n),this.processStart(i,n),this.getResult(i,n,r,t),r.length>0?et.build2(r):null}static zoomPolygon(e,t){let i=new Array,r=new Array,n=new Array;return yj(e)&&(e=e.reverse().asClose()),this.getPanPrimitive(e,i,n,t),this.rearrange(i,n),this.processStart(i,n),this.getResult(i,n,r,t),r.length>0?et.build2(r):null}static zoomLines(e,t){return this.zoomPolygon(et.build2(e.primitives.concat(e.reverse().primitives)),t/2)}static getPanPrimitive(e,t,i,r){let n=e.primitives;for(let s of n){let a=this.panDistance(s,r);a!==void 0&&(t.push(a),i.push(s))}}static rearrange(e,t){let i=e.length,r=0;for(let a=0;a<i;a++){let o=t[a],l=e[a],u=a==i-1?e[0]:e[a+1];if(!(l instanceof ue&&u instanceof ue)&&!this.isCW(l.end(),u.start(),o.end())){if(vn(l,u)!=0){r=a==i-1?0:a+1;break}}else{r=a;break}}let n=this.start4Index(t,r),s=this.start4Index(e,r);t.length=0,e.length=0,n.forEach(a=>{t.push(a)}),s.forEach(a=>{e.push(a)})}static processStart(e,t){let i=e.length;if(i>2){let r=e[i-1],n=e[0],s=t[i-1];if(!(r instanceof ue&&n instanceof ue)&&!this.isCW(r.end(),n.start(),s.end())){let a=vn(r,n);for(let o=0;o<a;o+=2){let l=new ie(Y[o],Y[o+1]);e[i-1]=this.generatePrimitive(r,r.start(),l),e[0]=this.generatePrimitive(n,l,n.end())}}}}static getResult(e,t,i,r){let n=e.length;for(let s=0;s<n;s++){let a=t[s],o=s===n-1?t[0]:t[s+1],l=s==n-1?0:s+1,u=l==n-1?t[0]:t[l+1],c=e[s],h=s==n-1?e[0]:e[s+1],m=l==n-1?e[0]:e[l+1];if(!(c instanceof ue&&h instanceof ue)&&!this.isCW(c.end(),h.start(),a.end())){let g=this.add(e,i,s,c,h,0);g=this.update(e,i,s,h,g);let y=this.generateArc(o,u,h,m,r);if(g=this.add(e,i,s,c,y,g),g=this.update(e,i,s,y,g),g>0)continue}i.push(c);let f=this.generateArc(a,o,c,h,r);f!==void 0&&i.push(f)}}static generateArc(e,t,i,r,n){if(n>0){let s=e.end(),a=t.start(),o=i.end(),l=r.start();if(o.distance2(l)>1e-8)if(s.equals(a)){let u=o.angleD(s),c=l.angleD(s);return ue.build2(s,u,c,n,n,0)}else{let u=o.angleD(s),c=l.angleD(s),h=o.angleD(a),m=l.angleD(a),f=ue.build2(s,u,c,n,n,0),g=ue.build2(a,h,m,n,n,0);return f.pointOn(f.endAngle()).equals1(l)?f:g.pointOn(g.endAngle()).equals1(l)?g:f}}}static updateNews(e,t,i,r){let n=e.length,s=t==n-1?0:t+1;e[s]=this.generatePrimitive(i,r,i.end())}static add(e,t,i,r,n,s){if(s>0)return s;if(r!=null&&n!=null){let a=vn(r,n);for(let o=0;o<a;o+=2){let l=new ie(Y[o],Y[o+1]);t.push(this.generatePrimitive(r,r.start(),l)),this.updateNews(e,i,n,l);break}return a}else return 0}static update(e,t,i,r,n){if(n>0)return n;let s=t.length;if(s>0&&r!=null){let a=t[s-1],o=vn(a,r);for(let l=0;l<o;l+=2){let u=new ie(Y[l],Y[l+1]);t[s-1]=this.generatePrimitive(a,a.start(),u),this.updateNews(e,i,r,u)}return o}else return 0}static generatePrimitive(e,t,i){if(e instanceof J)return new J(t,i);if(e instanceof ue){let r=e,n=t.angleD(r.center),s=i.angleD(r.center);return ue.build2(r.center,n,s,r.rx,r.ry,r.sweep())}else throw new Error("not supported operation")}static start4Index(e,t){let i=e.length,r=new Array;for(let n=t;n<i;n++)r.push(e[n]);for(let n=0;n<t;n++)r.push(e[n]);return r}static isCW(e,t,i){let r=new J(i,e),n=new J(i,t),s=r.end().x-r.start().x,a=r.end().y-r.start().y,o=n.end().x-n.start().x,l=n.end().y-n.start().y;return!(s*l-a*o>0)}static panDistance(e,t){if(e instanceof J){if(e.isPoint())return;{let i=e.panDistance(t);return i.length()>1e-5?i:void 0}}else if(e instanceof ue){let i=e;if(i.sweepAngle>0){if(i.rx-t<=0||i.ry-t<=0)return}else if(i.sweepAngle<0&&(i.rx+t<=0||i.ry+t<=0))return;return i=i.panDistance(t),i.start().distance1(i.end())>1e-5||de.eq(Math.abs(i.sweepAngle),360)?i:void 0}else throw new Error("not supported operation")}},ke=.001,tr=ke**2;function Ne(e,t){return e.distance2(t)<tr}function Is(e,t){return Math.abs(e-t)<=1e-4}function bj(e,t){if(e instanceof J)return new J(e.start(),t);if(e instanceof ue){let i=t.angleD(e.center);return Is(Ye.regularD(e.startAngle),Ye.regularD(i))?ue.build3(e.center,e.startAngle,0,e.rx,e.ry):ue.build2(e.center,e.startAngle,i,e.rx,e.ry,e.isCCW?1:0)}else{if(e instanceof Te)return e.clip(e.getPercent(t,ke))[0];throw new Error("not supported operation")}}function qn(e,t=Ye.toRadians(e.startAngle)){return e.isCCW?t+=ef:t-=ef,new ie(Math.cos(t),Math.sin(t))}function $c(e,t=0){let i=e.controls;if(t===0){let r=i[0],n=i.slice(1).find(s=>!(s.x===r.x&&s.y===r.y));if(!n)throw Error("getTangentBezier(bezier: Bezier, t: number = 0)");return n.sub(r)}else if(t===1){let r=i[i.length-1],n=i.slice(0,-1).reverse().find(s=>!(s.x===r.x&&s.y===r.y));if(!n)throw Error("getTangentBezier(bezier: Bezier, t: number = 0)");return r.sub(n)}if(i.length===3){let[r,n,s]=i;return n.sub(r).mul(2*(1-t)).add(s.sub(n).mul(2*t)).normalize()}else{let[r,n,s,a]=i;return n.sub(r).mul(3*(1-t)**2).add(s.sub(n).mul(6*(1-t)*t)).add(a.sub(s).mul(3*t**2)).normalize()}}function Zl(e,t,i){let r=e.slice(1).findIndex(s=>!(s.x===t.x&&s.y===t.y)),n=e[r+1];if(i&&(i.getPercent(n,ke)!==null||new J(i.start(),i.end()).distance(n)<=ke)&&(n=e[r+2]),!n)throw Error("getSecondPoint(controls: readonly Vector2[])");return n}function Me(e,t){if(e instanceof J)return e.end().sub(e.start()).normalize();if(e instanceof ue)return(t?qn(e,t.angle(e.center)):qn(e)).normalize();if(e instanceof Te)if(e.controls.length===2){let[i,r]=e.controls;if(Ne(i,r))throw Error("equalsPP(p0, p1)");return r.sub(i).normalize()}else return(t?$c(e,e.getPercent(t,ke)):$c(e)).normalize();else throw new Error("not support")}function Pj(e,t,i){let r=[],n=t**2-4*e*i;if(n>=0){let s=-t/(2*e),a=Math.sqrt(n)/(2*e),o=s+a;if(r.push(o),n>0){let l=s-a;r.push(l)}}return r}function Ej(e,t,i,r,n=0,s=1){let a=[],o=e*Math.pow(n,3)+t*Math.pow(n,2)+i*n+r,l=e*Math.pow(s,3)+t*Math.pow(s,2)+i*s+r,u,c;if(o*l<0)for(;Math.abs(n-s)>ke;)if(u=(n+s)/2,c=e*Math.pow(u,3)+t*Math.pow(u,2)+i*u+r,Math.abs(c)<ke){a.push(u);break}else o*c<0?s=u:l*c<0&&(n=u);else o*l===0&&(o===0&&a.push(n),l===0&&a.push(s));return a}function ab(e,t,i){if(e instanceof J||t.distance2(i)<=tr)return new J(t,i);if(e instanceof ue)return ue.build2(e.center,t.angleD(e.center),i.angleD(e.center),e.rx,e.ry,e.isCCW?1:0);if(e instanceof Te){let r=e.getPercent(t,ke),n=e.getPercent(i,ke);return e.clip(r)[1].clip((n-r)/(1-r))[0]}else throw new Error("not supported operation")}function Lb(e){return de.greater(e,0)&&de.less(e,1)}function rf(e,t,i,r){let n=e[r]-2*t[r]+i[r],s=t[r]-e[r];if(n===0)return[];let a=-s/n,o=[];return Lb(a)&&o.push(a),o}function nf(e,t,i,r,n){let s,a,o=-e[n]+3*t[n]-3*i[n]+r[n],l=2*(e[n]-2*t[n]+i[n]),u=t[n]-e[n],c=l**2-4*o*u;if(de.lesseq(c,0))s=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY;else{let m=Math.sqrt(c);s=(-l-m)/(2*o),a=(-l+m)/(2*o);let f=o*2;if(de.lesseq(s,1)&&de.greatereq(s,0)){let g=Number.NEGATIVE_INFINITY;for(;de.neq(s,g);){g=s;let y=f*s+l;s=-(o*s**2+l*s+u-y*s)/y}}if(de.lesseq(a,1)&&de.greatereq(a,0)){let g=Number.NEGATIVE_INFINITY;for(;de.neq(a,g);){g=a;let y=f*a+l;a=-(o*a**2+l*a+u-y*a)/y}}}let h=[];return Lb(a)&&h.push(a),Lb(s)&&h.push(s),h}function Bx(e,t){if(e.controls.length===2){let[o,l]=e.controls;Ne(o,l)||t.push(new J(o,l));return}let i,r;if(e.controls.length===3){let[o,l,u]=e.controls;i=rf(o,l,u,"x"),r=rf(o,l,u,"y")}else{let[o,l,u,c]=e.controls;i=nf(o,l,u,c,"x"),r=nf(o,l,u,c,"y")}i.sort((o,l)=>l-o),r.sort((o,l)=>l-o);let n=i.pop()||1,s=r.pop()||1,a=0;for(;n!==1||s!==1;)if(de.eq(n,s))n=i.pop()||1,s=r.pop()||1;else if(n<s){let[o,l]=e.clip((n-a)/(1-a));a=n,t.push(o),e=l,n=i.pop()||1}else{let[o,l]=e.clip((s-a)/(1-a));a=s,t.push(o),e=l,s=r.pop()||1}t.push(e)}var Sj=1e-5,a0=1,Te=class lr extends ad{constructor(t){if(super(),this._startToEndL=null,t.length<2)throw new Error("Bezier needs at least 2 endpoints");this.controls=t.slice()}get startToEndL(){return this._startToEndL===null&&(this._startToEndL=new J(this.start(),this.end())),this._startToEndL}build1(t){let i=[];return iu(t,(r,n)=>(i.push(n),!0)),new lr(i)}start(){return this.controls[0]}end(){return this.controls[this.controls.length-1]}static pointOn(t,i){if(i.length<1)throw new Error("bezier must have at least 1 point");if(i.length===1)return i[0];{let r=new Array(i.length-1);for(let n=1;n<i.length;n++){let s=i[n-1],a=i[n],o=(a.x-s.x)*t,l=(a.y-s.y)*t;r[n-1]=s.add1(o,l)}return lr.pointOn(t,r)}}clip1(t,i,r,n){if(r.push(i[0]),n.push(i[i.length-1]),i.length<2)throw new Error("bezier clip must have at least 2 point");if(i.length===2){let s=i[0],a=i[1],o=(a.x-s.x)*t,l=(a.y-s.y)*t,u=s.add1(o,l);r.push(u),n.push(u)}else{let s=new Array(i.length-1);for(let a=1;a<i.length;a++){let o=i[a-1],l=i[a],u=(l.x-o.x)*t,c=(l.y-o.y)*t;s[a-1]=o.add1(u,c)}this.clip1(t,s,r,n)}}clip(t){let i=[],r=[];return this.clip1(t,this.controls,i,r),[new lr(i),new lr(r.reverse())]}greater(t,i,r){return t-i>r}less(t,i,r){return t-i<-r}eq(t,i,r){return Math.abs(t-i)<=r}eqPP(t,i,r){return!t||!i?!1:this.eq(t.x,i.x,r)&&this.eq(t.y,i.y,r)}isInRange(t,i=de.eps){let r=this.controls.map(s=>s.y-t.y),n=0;for(let s of r){if(this.less(s,0,i))n=n|1;else if(this.greater(s,0,i))n=n|2;else{n=3;break}if(n===3)break}if(n!==3)return!1;n=0;for(let s of this.controls){let a=s.x-t.x;if(this.less(a,0,i))n=n|1;else if(this.greater(a,0,i))n=n|2;else{n=3;break}if(n===3)break}return n===3}getPercent(t,i=de.eps){if(!this.isInRange(t,i))return null;let r=Number.POSITIVE_INFINITY,n=[[this,0,1]];for(;n.length!==0;){let s=function(b){c=Math.min(c,b),h=Math.max(h,b)},a=function(b,E){let S=Ss(b,E);if(S===0)throw new Error("cnt === 0");for(let v=0;v<S;v+=2)s(Y[v])},[o,l,u]=n.pop();if(this.eqPP(o.start(),t,i))return l;if(this.eqPP(o.end(),t,i))return u;let c=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,m=o.controls.map(b=>b.y-t.y);r=m.reduce((b,E)=>{let S=Math.abs(E);return S<b?S:b},r),r/=2,r<=i&&(r=i),m.forEach((b,E)=>{this.eq(b,0,i)&&s(E/(m.length-1))});let f=new J(new ie(0,-r),new ie(1,-r)),g=new J(new ie(0,r),new ie(1,r));for(let b=0;b<m.length-1;b++){let E=new ie(b/(m.length-1),m[b]),S=this.less(E.y,0,i)?1:this.greater(E.y,0,i)?2:3;for(let v=0;v<m.length;v++){let A=new ie(v/(m.length-1),m[v]),x=this.less(A.y,0,i)?1:this.greater(A.y,0,i)?2:3;S!==x&&(S===1?x===2?(a(new J(E,A),f),a(new J(E,A),g)):a(new J(E,A),f):S===2?x===1?(a(new J(E,A),f),a(new J(E,A),g)):a(new J(E,A),g):x===1?a(new J(E,A),f):a(new J(E,A),g))}}if(!isFinite(c)){if(Math.max(...m.map(b=>Math.abs(b)))<i*4)return(l+u)/2;continue}if(c!==0&&(o=o.clip(c)[1],l=(u-l)*c+l),h!==1){let b=(h-c)/(1-c);o=o.clip(b)[0],u=(u-l)*b+l}if(!o.isInRange(t,i))continue;let y=o.controls.reduce((b,E)=>b.ext2(E),new Sr).build1();if(this.eq(y.minX,y.maxX,i)&&this.eq(y.minY,y.maxY,i))return(l+u)/2;if(h-c>.8){let[b,E]=o.clip(.5);b.isInRange(t,i)?(n.push([b,l,(l+u)/2]),E.isInRange(t,i)&&n.push([E,(l+u)/2,u])):n.push([E,(l+u)/2,u])}else n.push([o,l,u])}return null}toBezier(){return this}toString(){return"Bezier ["+this.controls.join(" ")+"]"}bbox(){return this._bbox||(this._bbox=new Sr().ext3(this.points(.1)).build1()),this._bbox}bboxWithControls(){return this._bbox_controls||(this._bbox_controls=new Sr().ext3(this.controls).build()),this._bbox_controls}multiply3(t){let i=new Array(this.controls.length);for(let r=0;r<this.controls.length;r++){let n=this.controls[r];i[r]=n.multiply3(t)}return new lr(i)}stroke(t,i,r,n=a0){let s=_j.zoomLines(et.build4(this.points(n)),t);return r===0?s:s.reverse()}points(t){let i=[];return this.getBezierPoints(t,r=>i.push(r)),i}getBezierPoints(t,i){if(this.controls.length===2){i(this.start()),i(this.end());return}let r=[this];for(i(this.start());r.length!==0;){let s=r.pop(),a=new J(s.start(),s.end());if(n(s.controls,a)<=t)i(s.end());else{let[o,l]=s.clip(.5);r.push(l,o)}}function n(s,a){let o=a.start(),l=a.end();o.equals1(l)&&(l=o.add1(1,0));let u=l.y-o.y,c=o.x-l.x,h=-u*o.x-c*o.y,m=Math.sqrt(1/(u**2+c**2));u*=m,c*=m,h*=m;let f=s.map(g=>Math.abs(u*g.x+c*g.y+h));return Math.max(...f)}}getBezierPoints3(t,i){if(this.controls.length===2){i(this.start()),i(this.end());return}let r=t*t,n=this.controls[0],s=.5;for(;s>Sj&&!(n.distance2(lr.pointOn(s,this.controls))<=r);s*=.5);let a=Math.ceil(1/s);s=1/a,i(n);let o=0;for(let l=1;l<a;l++)o+=s,i(lr.pointOn(o,this.controls));i(this.end())}getPointsBySlope(t){if(this.controls.length===4)return this.getPointsBySlope4(t);throw new Error("Currently, only 4 control points are supported!")}getPointsBySlope4(t){let[i,r,n,s]=this.controls,a=-3*i.x+9*r.x-9*n.x+3*s.x,o=6*i.x-12*r.x+6*n.x,l=-3*i.x+3*r.x,u=[];if(Number.isFinite(t)){let c=-3*i.y+9*r.y-9*n.y+3*s.y,h=6*i.y-12*r.y+6*n.y,m=-3*i.y+3*r.y,f=c-a*t,g=h-o*t,y=m-l*t,b=-g/(2*f),E=Math.sqrt(g**2-4*f*y)/(2*f),S=b+E;S>=0&&S<=1&&u.push(lr.pointOn(S,this.controls));let v=b-E;v>=0&&v<=1&&u.push(lr.pointOn(v,this.controls))}else{let c=-o/(2*a),h=Math.sqrt(o**2-4*a*l)/(2*a),m=c+h;m>=0&&m<=1&&u.push(lr.pointOn(m,this.controls));let f=c-h;f>=0&&f<=1&&u.push(lr.pointOn(f,this.controls))}return u}buildConverxHull(t=de.eps){let i=[...this.controls],r=[],n=i[0],s=1;do{let a=i[s%i.length];this.eqPP(n,a,t)||r.push(new J(n,a)),n=a,s++}while(n!==i[0]);if(r.length===0)throw Error("buildConverxHull(diff = DoubleKit.eps)");return et.build7(r).asClose()}getExtremePoints(t){if(!t)return a(this.controls);let i=t.start(),r=t.end(),n=r.x-i.x,s=r.y-i.y;if(Math.abs(n)<=de.eps||Math.abs(s)<=de.eps)return a(this.controls);{let o=s/n;if(this.controls.length===3){i.equals1(r)&&(r=i.add1(1,0));let l=r.y-i.y,u=i.x-r.x,c=-l*i.x-u*i.y,h=Math.sqrt(1/(l**2+u**2));l*=h,u*=h,c*=h;let m=this.controls.map(y=>l*y.x+u*y.y+c),f=m[0]-2*m[1]+m[2],g=m[1]-m[0]-o/2;if(f!==0){let y=-g/f;if(de.greater(y,0)&&de.less(y,1))return[lr.pointOn(y,this.controls)]}}else if(this.controls.length===4)return this.getPointsBySlope(o)}return[];function a(o){let l,u;if(o.length===3){let[f,g,y]=o;l=rf(f,g,y,"x"),u=rf(f,g,y,"y")}else if(o.length===4){let[f,g,y,b]=o;l=nf(f,g,y,b,"x"),u=nf(f,g,y,b,"y")}l.sort((f,g)=>g-f),u.sort((f,g)=>g-f);let c=l.pop()||1,h=u.pop()||1,m=[];for(;c!==1||h!==1;)de.eq(c,h)?(c=l.pop()||1,h=u.pop()||1):c<h?(m.push(lr.pointOn(c,o)),c=l.pop()||1):(m.push(lr.pointOn(h,o)),h=u.pop()||1);return m}}getToLineMaxDis2(t){let i=this.getExtremePoints(t),r=t.distance2(this.start()),n=t.distance2(this.end()),s=Math.max(r,n);return i.forEach(o=>a(t.distance2(o))),s;function a(o){s=Math.max(s,o)}}getToLineMinAndMaxDis_Controls(t){let i=t.start(),r=t.end();t.start().equals1(t.end())&&(r=i.add1(1,0));let n=r.y-i.y,s=i.x-r.x,a=-n*i.x-s*i.y,o=Math.sqrt(1/(n**2+s**2));n*=o,s*=o,a*=o;let l=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY;return this.controls.forEach(c=>{let h=n*c.x+s*c.y+a;h<l&&(l=h),h>u&&(u=h)}),{minDis:l,maxDis:u}}getPercentInLine(t){let i=[],r=[],n=this.controls,s=t.start(),a=t.end(),o=a.y-s.y,l=s.x-a.x,u=-o*s.x-l*s.y,c=Math.sqrt(1/(o**2+l**2));if(o*=c,l*=c,u*=c,o**2+l**2<=0)return i;if(n.length===3){let[h,m,f]=n,g=o*(h.x-2*m.x+f.x)+l*(h.y-2*m.y+f.y),y=2*(o*(m.x-h.x)+l*(m.y-h.y)),b=o*h.x+l*h.y+u;r=Pj(g,y,b)}else if(n.length===4){let[h,m,f,g]=n,y=g.sub(f.mul(3)).add(m.mul(3)).sub(h),b=h.sub(m.mul(2)).add(f).mul(3),E=m.sub(h).mul(3),S=h,v=o*y.x+l*y.y,A=o*b.x+l*b.y,x=o*E.x+l*E.y,T=o*S.x+l*S.y+u,R=Math.sqrt(1/(v**2+A**2));v*=R,A*=R,x*=R,T*=R,r=Ej(v,A,x,T)}else throw Error("not support getBeizerPointInLine");return r.forEach(h=>{h>=0&&h<=1&&i.push(h)}),i}reverse(){return new lr(this.controls.slice().reverse())}},bs,Ox=(bs=class{constructor(){this.textCache=new Map,this.numCache=new Array(20),this.boxCache=new Array(4),this.textOffsetCache=new Array(9),this.BuildLineCache=new Array(7),this.BuildTrackCache=new Array(7),this.BuildViaCache=new Array(11),this.BuildBoxCache=new Array(10),this.BuildArcCache=new Array(10),this.BuildArcTrackCache=new Array(10),this.BuildTextCache=new Array(7),this.BuildPadStyleCache=new Array(4),this.BuildPadCache=new Array(12),this.ARRAY1=new Array(1),this.ARRAY2=new Array(2),this.ARRAY3=new Array(3),this.ARRAY4=new Array(4),this.ARRAY5=new Array(5),this.ARRAY6=new Array(6),this.ARRAY7=new Array(7),this.ARRAY8=new Array(8),this.ARRAY9=new Array(9),this.ARRAY10=new Array(10),this.ARRAY11=new Array(11),this.ARRAY12=new Array(12),this.textOffsetCache[0]=ie.ORIGIN,this.textOffsetCache[1]=new ie(0,-.5),this.textOffsetCache[2]=new ie(0,-1),this.textOffsetCache[3]=new ie(-.5,0),this.textOffsetCache[4]=new ie(-.5,-.5),this.textOffsetCache[5]=new ie(-.5,-1),this.textOffsetCache[6]=new ie(-1,0),this.textOffsetCache[7]=new ie(-1,-.5),this.textOffsetCache[8]=new ie(-1,-1)}static getCache(){return bs.instance==null&&(bs.instance=new bs),bs.instance}},bs.instance=null,bs),J=class No extends ad{constructor(t,i){super(),this._a=null,this._b=null,this._c=null,this.__bbox=null,this._hashed=null,this._direct=null,this._start=t,this._end=i}get a(){return this._a===null&&(this._start.equals1(this._end)?(this._a=NaN,this._b=NaN,this._c=NaN):(this._a=this._end.y-this._start.y,this._b=this._start.x-this._end.x,this._c=this._end.x*this._start.y-this._start.x*this._end.y)),this._a}get b(){return this._b===null&&(this._start.equals1(this._end)?(this._a=NaN,this._b=NaN,this._c=NaN):(this._a=this._end.y-this._start.y,this._b=this._start.x-this._end.x,this._c=this._end.x*this._start.y-this._start.x*this._end.y)),this._b}get c(){return this._c===null&&(this._start.equals1(this._end)?(this._a=NaN,this._b=NaN,this._c=NaN):(this._a=this._end.y-this._start.y,this._b=this._start.x-this._end.x,this._c=this._end.x*this._start.y-this._start.x*this._end.y)),this._c}get hashed(){return this._hashed==null&&(this._hashed=this._hashCode()),this._hashed}get direct(){return this._direct==null&&(this._direct=this._end.sub(this._start).normalize()),this._direct}cutLine(t){if(de.eq(this.distance(t),0)){let i=new No(this._start,t);return i._a=this._a,i._b=this._b,i._c=this._c,i}return new No(this._start,t)}get midPoint(){return this._start.add(this._end).mul(.5)}toBezier(){return new Te([this._start,this._end])}_hashCode(){let t=31,i=1;return i=t*i+this._start.hashCode(),i=t*i+this._end.hashCode(),i}start(){return this._start}end(){return this._end}center(){let t=this.start(),i=this.end();return t.add(i).mul(.5)}panDistance(t){let i=this._end.x-this._start.x,r=this._end.y-this._start.y,n=this.length();i=i*t/n,r=-r*t/n;let s=new ie(this._start.x+r,this._start.y+i),a=new ie(this._end.x+r,this._end.y+i);return new No(s,a)}isPoint(){return this._start.distance2(this._end)<=1e-8}length(){return this._start.distance1(this._end)}toString(){return"Line [start="+this._start+", end="+this._end+"]"}bbox(){if(this.__bbox==null){let t=Ox.getCache().boxCache;t[0]=Math.min(this._start.x,this._end.x),t[1]=Math.max(this._start.x,this._end.x),t[2]=Math.min(this._start.y,this._end.y),t[3]=Math.max(this._start.y,this._end.y),this.__bbox=new Zi(t[0],t[1],t[2],t[3])}return this.__bbox}multiply3(t){return new No(this._start.multiply3(t),this._end.multiply3(t))}hashCode(){return this.hashed}equals(t){let i=t;return this.hashed===i.hashed&&this._start.equals(i._start)&&this._end.equals(i._end)}equals1(t){let i=t;return this.hashed===i.hashed&&this._start.equals1(i._start)&&this._end.equals1(i._end)}equals2(t){let i=[this.start(),this.end()],r=[t.start(),t.end()];return Gn(i,r)||Gn(i,r.reverse())}stroke(t,i,r){let n,s,a;this._end.x<this._start.x?(s=this._start.x-this._end.x,a=this._start.y-this._end.y,n=this._end):(s=this._end.x-this._start.x,a=this._end.y-this._start.y,n=this._start);let o=Math.sqrt(s*s+a*a),l=t/2,u,c,h;i===2?(c=-l,h=o+l):(c=0,h=o),i===0||i===2?r===0?u=et.build5([c,-l,c,l,h,l,h,-l]):u=et.build5([c,l,c,-l,h,-l,h,l]):r===0?u=et.build2([ue.build3(new ie(c,0),-90,-180,l,l),ue.build3(new ie(h,0),90,-180,l,l)]):u=et.build2([ue.build3(new ie(c,0),90,180,l,l),ue.build3(new ie(h,0),-90,180,l,l)]);let m=Math.atan2(a,s),f=Pt.rotate(m).translate1(n);return u.asClose().multiply3(f)}points(t){return[this._start,this._end]}mirrorY(t){return new No(this.start().mirrorY(t),this.end().mirrorY(t))}reverse(){return new No(this._end,this._start)}inArea(t,i,r){let n=t.x,s=t.y,a=this._start,o=this._end,l=r==1,u=n-a.x,c=s-a.y,h=n-o.x,m=s-o.y,f=o.x-a.x,g=o.y-a.y,y=new ie(-g,f).normalize(),b=f+y.x*i/2,E=g+y.y*i/2,S=b*b+E*E,v=u*u+c*c,A=h*h+m*m,x=Math.abs(u*g-c*f)/2,T=Math.sqrt(f*f+g*g)*i/4;if(x<=T&&v<=S&&A<=S){if(l)return!0;{let R=new ie(n,s).sub(o).normalize(),L=new ie(n,s).sub(a).normalize(),O=new ie(y.x,y.y).cross(R),H=new ie(y.x,y.y).cross(L);return O>=0&&H<=0}}else if(l){let R=i/2;return v<=R*R?!0:A<=R*R}else return!1}isParallel(t,i=!1){let r=de.eq(Math.abs(this.direct.cross(t.direct)),0),n=!i||de.greatereq(this.direct.dot(t.direct),0);return r&&n}distance2(t){return(this.a*t.x+this.b*t.y+this.c)**2/(this.a**2+this.b**2)}distance2ForPP(t){let{x:i,y:r}=t,{x:n,y:s}=this.start(),{x:a,y:o}=this.end();return((i-n)*(o-s)-(r-s)*(a-n))**2/((o-s)**2+(a-n)**2)}distance(t){return Math.abs(this.a*t.x+this.b*t.y+this.c)/Math.sqrt(this.a**2+this.b**2)}};function vj(e,t=.05){if(e.length<3)return e.slice();let i=e.slice(0,1),r=(s,a,o)=>ij(s.x,s.y,a.x,a.y,o.x,o.y);for(;;){i=e.slice(0,1);for(let s=1;s<e.length-1;s+=2)r(e[s],e[s-1],e[s+1])>t&&i.push(e[s]),i.push(e[s+1]);if(i.at(-1).equals1(e.at(-1))||i.push(e.at(-1)),e.length==i.length)break;e=i}let n=e[e.length-1];return i.push(n),i}var Ij=DH(BH());var Aj=class{constructor(){this.fac=new Sr,this.length=0,this.box=null,this.pt=null,this.i=0}calcBBox(e){for(this.fac.clear(),this.length=e.length,this.box=null,this.pt=null,this.i=0;this.i<this.length;this.i++)this.pt=e[this.i],this.box=this.pt.bbox(),this.fac.ext1(this.box);return this.fac.build1()}},Cj=new Aj,et=class ii{constructor(t,i){this.__bbox=null,this.primitives=t,this.__bbox=i}static calcBBox(t){return Cj.calcBBox(t)}static build1(t){let i=[],r=null;return Zp(t,(n,s)=>{let a=s.start();return r!==null&&!a.equals(r)&&i.push(new J(r,a)),i.push(s),r=s.end(),!0}),i.length===0&&r!=null&&i.push(new J(r,r)),new ii(i)}static build2(t){return ii.build1(Tb(t))}static build3(t){let i=[],r=null;return Zp(t,(n,s)=>(r!==null&&i.push(new J(r,s)),r=s,!0)),new ii(i)}static build4(t){return this.build3(Tb(t))}static build5(t){let i=[];for(let r=0;r<t.length;r+=2)i.push(new ie(t[r],t[r+1]));return this.build4(i)}static build6(t){return ii.build4([t.LL(),t.LR(),t.UR(),t.UL(),t.LL()])}static build7(t){return new ii(t)}static build8(t){let i=new ie(t[0],t[1]),r,n=[],s,a=(o,l)=>o.length==l&&o.every(u=>typeof u=="number");for(let o=2;o<t.length;)switch(typeof t[o]=="string"?s=t[o]:o-=1,s){case"ARC":{let l=t.slice(o+1,o+4);if(!a(l,3))throw new Error("invalid rawData");let u=l[0];r=new ie(l[1],l[2]),n.push(ue.build5(i,r,u)),i=r,o+=4;break}case"L":{let l=t.slice(o+1,o+3);if(!a(l,2))throw new Error("invalid rawData");r=new ie(l[0],l[1]),n.push(new J(i,r)),i=r,o+=3;break}case"C":{let l=t.slice(o+1,o+7);if(!a(l,7))throw new Error("invalid rawData");let u=new ie(l[0],l[1]),c=new ie(l[2],l[3]);r=new ie(l[4],l[5]),n.push(new Te([i,u,c,r])),i=r,o+=7;break}default:throw new Error("invalid rawData")}return ii.build2(n)}static buildBBox(t,i=0){return i===1?ii.build5([t.minX,t.minY,t.maxX,t.minY,t.maxX,t.maxY,t.minX,t.maxY,t.minX,t.minY]):ii.build5([t.minX,t.minY,t.minX,t.maxY,t.maxX,t.maxY,t.maxX,t.minY,t.minX,t.minY])}static triangulate(t,i,r=1){if(t.length===1){let l=new Array;t[0].asClose().points2(r,m=>l.push(m));let u,c=l[0],h=[];for(let m=0;m<l.length-2;m+=2){let f=l[m+1],g=l[m+2],y=f.sub(c).normalize().cross(g.sub(c).normalize());if(de.neq(y,0)){if(u===!0){if(y<0){h.length=0;break}}else if(u===!1){if(y>0){h.length=0;break}}else u=y>0;h.push(c),h.push(f),h.push(g)}l.push(c),c=g}if(h.length!==0){for(let m=0;m<h.length;m+=3)i(h[m],h[m+1],h[m+2]);return}}let n=[],s=[];t.forEach(l=>{n.length!==0&&s.push(n.length/2),l.asClose().points2(r,u=>n.push(u.x,u.y))});let a=Ij.default(n,s),o=[];for(let l=1;l<n.length;l+=2)o.push(new ie(n[l-1],n[l]));for(let l=0;l<a.length;l+=3)i(o[a[l]],o[a[l+1]],o[a[l+2]])}lines(t,i){let r=new Array;this.points(t,s=>r.push(s));let n=r[0];for(let s=1;s<r.length;s++){let a=r[s];i(n),i(a),n=a}}triangles(t,i){ii.triangulate([this],(...r)=>{r.forEach(n=>i(n))},t)}mirror(){let t=[];return this.primitives.forEach(i=>{if(i instanceof J)i=new J(i.start().mirror(),i.end().mirror());else if(i instanceof ue)i=i.mirror();else if(i instanceof Te){let r=i.controls.map(n=>n.mirror());i=new Te(r)}else throw new Error("bug");t.push(i)}),new ii(t,this.__bbox)}getPoints(t){let i=[];for(let r of this.primitives)for(let n of r.points(t))i.push(n);return i}round(t=4){let i=this.primitives.slice();for(let r=0;r<i.length;r++){let n=i[r];if(n instanceof J){let s=n.start().round(t),a=n.end().round(t);i[r]=new J(s,a)}else if(n instanceof Te){let s=n.controls.map(a=>a.round(t));i[r]=new Te(s)}else if(n instanceof ue){let s=n.start().round(t),a=n.end().round(t),o=n.sweepAngle;i[r]=ue.build5(s,a,o)}}return new ii(i,this.__bbox)}simplify(t=.05){let i=[],r=!1,n=[],s=this.closed();if(this.primitives.length<=1)return ii.build2(this.primitives);let a=()=>{if(n.length>2){let l=vj(n,t);for(let u=1;u<l.length;u++)i.push(new J(l[u-1],l[u]))}else i.push(new J(n[0],n[1]));n.length=0,r=!1};for(let l=0;l<this.primitives.length;l++){let u=this.primitives[l];u instanceof J?(r?n.push(u.end()):(n.length=0,n.push(u.start(),u.end()),r=!0),l===this.primitives.length-1&&a()):(r&&a(),i.push(u))}let o=new ii(i,this.__bbox);return s&&!o.closed()&&(o=o.asClose()),o}hasBackLine(){let{primitives:t}=this,i;for(let r=0;r<t.length;r++){let n=t[r];if(n instanceof J){if(n.end().equals1(n.start()))continue;if(i&&(n.end().equals1(i.start())||rj(n.end(),i.start(),i.end())))return!0;i=n}else i=null}return!1}area(t=.1){let i=0,r=this.end();return this.primitives.forEach(n=>{let s=n.start(),a=n.end();if(i+=(s.x+r.x)*(s.y-r.y),n instanceof J)i+=(a.x+s.x)*(a.y-s.y);else if(n instanceof ue)i+=(a.x+s.x)*(a.y-s.y),i+=Math.PI*n.rx2*n.sweepAngle/180-ie.normal(n.center,n.start(),n.end());else if(n instanceof Te){let o=s;n.points(t).forEach(l=>{i+=(l.x+o.x)*(l.y-o.y),o=l}),i+=(a.x+o.x)*(a.y-o.y)}r=a}),i/2}closed(t){return this.primitives.length===0?!1:this.start().equals(this.end(),t)}asClose(){let t=this.primitives[0],i=this.primitives[this.primitives.length-1],r=t.start(),n=i.end();if(r.equals(n))return this;{let s=new Array;return Qi.addAll(s,this.primitives),s.push(new J(n,r)),ii.build2(s)}}closeEndpoint(){let t=this.primitives[0],i=this.primitives[this.primitives.length-1],r=t.start(),n=i.end();if(r.equals1(n))return this;{let s=new Array;return Qi.addAll(s,this.primitives),s.push(new J(n,r)),new ii(s)}}reverse(){let t=new Array(this.primitives.length);for(let i=0,r=this.primitives.length-1;r>=0;i++,r--){let n=this.primitives[r];if(n instanceof J)n=new J(n.end(),n.start());else if(n instanceof ue)n=n.exchangeSweep();else if(n instanceof Te)n=new Te(n.controls.slice().reverse());else throw new Error("bug");t[i]=n}return new ii(t,this.__bbox)}reverse1(){let t=new Array(this.primitives.length);for(let i=0,r=this.primitives.length-1;r>=0;i++,r--){let n=this.primitives[r];if(n instanceof J)n=new J(n.end(),n.start());else if(n instanceof ue)n=n.exchangeSweep1();else if(n instanceof Te)n=new Te(n.controls.slice().reverse());else throw new Error("bug");t[i]=n}return new ii(t,this.__bbox)}mirrorY(t){let i=[];return this.primitives.forEach(r=>{if(r instanceof J)r=r.mirrorY(t);else if(r instanceof ue)r=r.mirrorY(t);else if(r instanceof Te){let n=r.controls.map(s=>s.mirrorY(t));r=new Te(n)}else throw new Error("bug");i.push(r)}),new ii(i,this.__bbox)}points(t,i){if(this.primitives.length!==0){for(let r=0;r<this.primitives.length-1;r++){let n=this.primitives[r].points(t);n.pop(),n.forEach(s=>i(s))}this.primitives[this.primitives.length-1].points(t).forEach(r=>i(r))}}points1(t,i){if(this.primitives.length===0)return;for(let n=0;n<this.primitives.length-1;n++){let s=this.primitives[n],a=s instanceof ue?s.points1(t):s.points(t);a.pop(),a.forEach(o=>i(o))}let r=this.primitives[this.primitives.length-1];(r instanceof ue?r.points1(t):r.points(t)).forEach(n=>i(n))}points2(t,i){if(this.primitives.length===0)return;for(let n=0;n<this.primitives.length-1;n++){let s=this.primitives[n],a=s instanceof ue?s.points2():s.points(t);a.pop(),a.forEach(o=>i(o))}let r=this.primitives[this.primitives.length-1];(r instanceof ue?r.points2():r.points(t)).forEach(n=>i(n))}multiply3(t){let i=new Array(this.primitives.length);for(let r=0;r<this.primitives.length;r++)i[r]=this.primitives[r].multiply3(t);return ii.build7(i)}bbox(){return this.__bbox==null&&(this.__bbox=ii.calcBBox(this.primitives)),this.__bbox}start(){return this.primitives.length!==0?this.primitives[0].start():null}end(){return this.primitives.length!==0?this.primitives[this.primitives.length-1].end():null}isClose(t){if(this.primitives.length<=1&&!(this.primitives[0]instanceof ue))return!1;{let i=this.primitives[0],r=this.primitives[this.primitives.length-1];return i.start().equals(r.end(),t)}}isEqual(t){if(t instanceof ii&&t.primitives.length==this.primitives.length){let i=t.primitives.length;for(let r=0;r<i;r++){let n=t.primitives[r],s=this.primitives[r];if(JSON.stringify(n)!=JSON.stringify(s))return!1}return!0}return!1}equals(t){if(!t)return!1;let i=this.primitives,r=t.primitives;if(i.length!=r.length)return!1;if(t.isClose()){let n=0;for(;n<i.length;){let s=i.slice(n).concat(i.slice(0,n));if(Gn(s,r)||Gn(s.reverse(),r))return!0;n++}return!1}else return Gn(this.primitives,t.primitives)}clone(){return ii.build2(this.primitives)}putItem(t,i){if(!t)return!1;if(t instanceof ii)return this.mergePolyline(t,i);let r=this.start();if(!r){this.primitives.push(t),this.__bbox=t.bbox();return}let n=this.end();if(r.equals(n,i))return!1;let s=t.start(),a=t.end(),o=!1,l=!1;if(r.equals(s,i))o=!0,l=!1;else if(r.equals(a,i))o=!1,l=!1;else if(n.equals(s,i))o=!1,l=!0;else if(n.equals(a,i))o=!0,l=!0;else return!1;return l?this.primitives.push(o?t.reverse():t):this.primitives.unshift(o?t.reverse():t),this.__bbox=Zi.extend2(this.__bbox,t.bbox()),!0}mergePolyline(t,i,r=0){if(!t)return!1;let n=this.start();if(!n){this.primitives.push(...t.primitives),this.__bbox=t.bbox();return}let s=this.end();if(n.equals(s,i))return!1;let a=t.start(),o=t.end(),l=!1,u=!1;if(n.equals(a,i))l=!0,u=!1;else if(n.equals(o,i))l=!1,u=!1;else if(s.equals(a,i))l=!1,u=!0;else if(s.equals(o,i))l=!0,u=!0;else return!1;let c=l?t.reverse():t;return u?this.primitives.push(...c.primitives):this.primitives.unshift(...c.primitives),this.__bbox=Zi.extend2(this.__bbox,t.bbox()),!0}deDuplicationPoint(t){let i=this.primitives[this.primitives.length-1].start(),r=this.primitives[this.primitives.length-1].end(),n=t.primitives[0].start(),s=t.primitives[0].end();if(this.primitives[this.primitives.length-1]instanceof J&&t.primitives[0]instanceof J&&cj([i,r],[n,s])){this.primitives.pop(),t.primitives.shift();let a=[];a.push(new J(i,s)),this.primitives.push(...a)}}getMaxBBoxHeightByVec(t){let i=t.normalize(),r=-1/0,n=1/0;if(this.primitives.forEach(a=>{let o=a.start().dot(i),l=a.end().dot(i);if(s(o),s(l),a instanceof ue){let u=t.angleD(ie.ORIGIN);if(a.angleIsInArc(u)){let c=a.pointOn(u).dot(i);s(c)}if(a.angleIsInArc(u+180)){let c=a.pointOn(u-180).dot(i);s(c)}}}),r-n<=0)throw new Error("getMaxBBoxHeightByVec");return r-n;function s(a){a>r&&(r=a),a<n&&(n=a)}}getWindingNum(t){let i=this.end(),r=0,{x:n,y:s}=t;for(let o of this.primitives){if(i.y>s?o.bbox().minY>s:o.bbox().maxY<=s){i=o.end();continue}if(o instanceof ue&&(o.isCCW?Math.floor(o.startAngle/90)+1!==Math.ceil(o.endAngle()/90):Math.ceil(o.startAngle/90)-1!==Math.floor(o.endAngle()/90))){let l=o.startAngle,u=o.endAngle();if(o.sweepAngle>0){let c=90;for(;c<=u;)c>l&&(a(ue.build3(o.center,l,c-l,o.rx,o.ry)),l=c),c+=90;l<u&&a(ue.build3(o.center,l,u-l,o.rx,o.ry))}else{let c=270;for(;c>=u;)c<l&&(a(ue.build3(o.center,l,c-l,o.rx,o.ry)),l=c),c-=90;l>u&&a(ue.build3(o.center,l,u-l,o.rx,o.ry))}}else if(o instanceof Te){let l=[];Bx(o,l),l.forEach(u=>a(u))}else a(o)}return r;function a(o){let l=o.start(),u=o.end();if(i.y>s!=l.y>s&&(i.x>n?l.x>n?r+=l.y>i.y?1:-1:i.y>l.y?(i.x-n)*(l.y-s)-(i.y-s)*(l.x-n)<0&&r--:(i.x-n)*(l.y-s)-(i.y-s)*(l.x-n)>0&&r++:l.x>n&&(i.y>l.y?(i.x-n)*(l.y-s)-(i.y-s)*(l.x-n)<0&&r--:(i.x-n)*(l.y-s)-(i.y-s)*(l.x-n)>0&&r++)),l.y>s!=u.y>s){if(l.x>n)if(u.x>n)r+=u.y>l.y?1:-1;else if(o instanceof J)l.y>u.y?(l.x-n)*(u.y-s)-(l.y-s)*(u.x-n)<0&&r--:(l.x-n)*(u.y-s)-(l.y-s)*(u.x-n)>0&&r++;else if(o instanceof ue){let{center:c,isCCW:h,rx2:m}=o,f=(c.x-n)**2+(c.y-s)**2;l.y>u.y?(h?f>m:f<m)&&r--:(h?f<m:f>m)&&r++}else if(o instanceof Te){if(xC(o,s)===0)throw new Error("no inters");Y[0]>n&&(r+=u.y>l.y?1:-1)}else throw new Error("not support!");else if(u.x>n)if(o instanceof J)l.y>u.y?(l.x-n)*(u.y-s)-(l.y-s)*(u.x-n)<0&&r--:(l.x-n)*(u.y-s)-(l.y-s)*(u.x-n)>0&&r++;else if(o instanceof ue){let{center:c,isCCW:h,rx2:m}=o,f=(c.x-n)**2+(c.y-s)**2;l.y>u.y?(h?f>m:f<m)&&r--:(h?f<m:f>m)&&r++}else if(o instanceof Te){if(xC(o,s)===0)throw new Error("no inters");Y[0]>n&&(r+=u.y>l.y?1:-1)}else throw new Error("not support!")}i=u}}},Ap=Math.PI*2;var zee=Math.PI/2,Vee=Math.sin(Math.PI/180);var xj=4,ue=class Lt extends ad{constructor(t,i,r,n,s){super(),this._rx2=null,this._ry2=null,this._svgEnd=null,this._hashed=null,this.__bbox=null,this.rx=t,this.ry=i,this.center=r,this.startAngle=n,this.sweepAngle=s,this._start=ie.ORIGIN,this._end=ie.ORIGIN,this._start=this.pointOn(n),this._end=this.pointOn(n+s)}get hashed(){return this._hashed==null&&(this._hashed=this._hashCode()),this._hashed}hashCode(){return this.hashed}_hashCode(){let t=31,i=1;return i=t*i+new ie(this.rx,this.rx).hashCode(),i=t*i+this.center.hashCode(),i=t*i+new ie(this.startAngle,this.sweepAngle).hashCode(),i}get rx2(){return this._rx2==null&&(this._rx2=this.rx*this.rx),this._rx2}get ry2(){return this._ry2==null&&(this._ry2=this.ry*this.ry),this._ry2}get svgEnd(){return this._svgEnd==null&&(this._svgEnd=this.getSvgEnd(this.startAngle,this.sweepAngle,this._start,this._end)),this._svgEnd}getSvgEnd(t,i,r,n){let s=i>=0?-.01:.01,a=t+i;for(;(i>=0&&a>t||i<0&&a<t)&&r.distance2(n)<2e-4;)s*=2,a+=s,n=this.pointOn(a);return n}static build1(t,i,r,n,s,a){Ft.positive(r),Ft.positive(n);let o=t.equals(i);if(o)return new Lt(r,n,t,0,s?360:0);{let l=t.x,u=-t.y,c=i.x,h=-i.y,m=a===0,f=(l-c)/2,g=(u-h)/2,y=Math.cos(0),b=Math.sin(0),E=y*f+b*g,S=-b*f+y*g;r=Math.abs(r),n=Math.abs(n);let v=r*r,A=n*n,x=E*E,T=S*S,R=s===m?-1:1,L=(v*A-v*T-A*x)/(v*T+A*x);L=L<0?0:L;let O=R*Math.sqrt(L),H=O*(r*S/n),k=O*-(n*E/r),ee=(l+c)/2,q=(u+h)/2,Q=ee+(y*H-b*k),ne=q+(b*H+y*k),G=(E-H)/r,X=(S-k)/n,D=(-E-H)/r,F=(-S-k)/n,W,z;z=Math.sqrt(G*G+X*X),W=G,R=X<0?-1:1;let $=Ye.toDegrees(R*Math.acos(W/z));z=Math.sqrt((G*G+X*X)*(D*D+F*F)),W=G*D+X*F,R=G*F-X*D<0?-1:1;let te=W/z,Z;te<-1?Z=Math.acos(-1):te>1?Z=Math.acos(1):Z=Math.acos(te);let pe=Ye.toDegrees(R*Z);!m&&pe>0?pe-=360:m&&pe<0&&(pe+=360),Ft.normal($),Ft.normal(pe);let Se=f*f/v+g*g/A,Ce=t.distance1(i)/2;r<Ce&&n<Ce&&(r*=Math.sqrt(Se),n*=Math.sqrt(Se));let we=o?0:Ye.regularD(-$),Fe=o?s?360:0:-pe;return new Lt(r,n,new ie(Q,-ne),we,Fe)}}static build2(t,i,r,n,s,a){Ft.positive(n),Ft.positive(s),Ft.normal(i),Ft.normal(r);let o;return i===r?(i=Ye.regularD(i),r=Ye.regularD(r),o=0):(i=Ye.regularD(i),r=Ye.regularD(r),a===1?r<=i&&(r+=360):r>=i&&(i+=360),o=r-i),new Lt(n,s,t,Ye.regularD(i),o)}static build3(t,i,r,n,s){return Ft.positive(n),Ft.positive(s),Ft.normal(r),new Lt(n,s,t,Ye.regularD(i),r)}static build4(t,i,r,n,s,a){let o=t.angleD(r),l=i.angleD(r);return Lt.build2(r,o,l,n,s,a)}static build5(t,i,r){r=Ye.toRadians(r);let n=i.sub(t),s=new ie(-n.y,n.x).normalize(),a=Math.abs(r)/2,o;if(a!=0)o=n.length()/2/Math.sin(a);else throw new Error("Can't represent circle!!!");let l=s.rotate(ie.ORIGIN,a),u,c;r>0?(u=1,c=i.add(l.scale(o))):(u=0,c=t.sub(l.scale(o)));let h=Ye.toDegrees(t.angle(c)),m=Ye.toDegrees(i.angle(c));return Lt.build2(c,h,m,o,o,u)}static buildCircle(t,i,r=0){return Lt.build2(t,0,360,i,i,r)}start(){return this._start}end(){return this._end}isLarge(){return Math.abs(this.sweepAngle)>180}sweep(){return this.sweepAngle>=0?1:0}get isCCW(){return this.sweepAngle>=0}endAngle(){return this.startAngle+this.sweepAngle}pointOn(t){t=Ye.regularD(t);let i=this.rx,r=this.ry;if(t===0)return this.center.add1(i,0);if(t===90)return this.center.add1(0,r);if(t===180)return this.center.add1(-i,0);if(t===270)return this.center.add1(0,-r);{let n=this.rx2,s=this.ry2,a=Math.tan(Ye.toRadians(t)),o=a*a,l=Math.sqrt(n*s/(n+s/o)),u=Math.sqrt(n*s/(s+n*o));return t>90&&t<270&&(u=-u),t>180&&t<360&&(l=-l),isNaN(u)&&(u=0),isNaN(l)&&(l=0),this.center.add1(u,l)}}exchangeSweep(){return Lt.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle,this.rx,this.ry)}exchangeSweepAndStart(){return Lt.build1(this.end(),this.start(),this.rx,this.ry,this.isLarge(),this.sweepAngle>=0?0:1)}exchangeSweep1(){return Lt.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle+.01,this.rx,this.ry)}mirrorY(t){let i=this.start(),r=this.end();return i.equals(r)?Lt.build3(this.center.mirrorY(),0,360,this.rx,this.ry):Lt.build1(i.mirrorY(t),r.mirrorY(t),this.rx,this.ry,this.isLarge(),this.sweepAngle>=0?0:1)}mirror(t=ie.ORIGIN){let i=this.start(),r=this.end();return i.equals(r)?Lt.build3(this.center.mirror(t),0,360,this.rx,this.ry):Lt.build1(i.mirror(t),r.mirror(t),this.rx,this.ry,this.isLarge(),this.sweep())}sectorArea(){return Math.abs(this.sweepAngle)/360*Math.PI*this.rx*this.ry}area(){let t=wb.area(this.center,this._start,this.pointOn(this.endAngle()));return this.sectorArea()-t}multiply3(t){let i;t.isMirrored()?i=-this.sweepAngle:i=this.sweepAngle;let r;return t.equals(Pt.ROT_90)?r=Ye.regularD(this.startAngle+90):t.equals(Pt.ROT_N90)?r=Ye.regularD(this.startAngle-90):r=Ye.transformD(this.startAngle,t),Lt.build3(this.center.multiply3(t),r,i,t.iScale*this.rx,t.iScale*this.ry)}angleIsInArc(t){return t=Ye.regularD(t),this.sweepAngle>0?(t<this.startAngle&&(t+=360),this.endAngle()>t):(t>this.startAngle&&(t-=360),this.endAngle()<t)}toBezier(){if(Math.abs(this.sweepAngle)>90)throw new Error("not support!");let t=this.start(),i=this.end(),r=Ye.toRadians(this.sweepAngle)/2,n=4/3*(1-Math.cos(r))/Math.sin(r)*this.rx;return new Te([t,t.add(new ie(n,0).multiply3(Pt.rotateD(this.startAngle+90))),i.add(new ie(n,0).multiply3(Pt.rotateD(this.endAngle()-90))),i])}toBezier2(){let t=[];r(this,90);let i=[];return t.forEach(n=>i.push(n.toBezier())),i;function r(n,s){if(Math.abs(n.sweepAngle)>s){let a=n.sweepAngle/2;r(Lt.build3(n.center,n.startAngle,a,n.rx,n.ry),s),r(Lt.build3(n.center,n.startAngle+a,a,n.rx,n.ry),s)}else t.push(n)}}buildBBox(){let t=Ox.getCache().boxCache,i=this.startAngle+this.sweepAngle;if(t[0]=Math.min(this._start.x,this._end.x),t[1]=Math.max(this._start.x,this._end.x),t[2]=Math.min(this._start.y,this._end.y),t[3]=Math.max(this._start.y,this._end.y),this.sweepAngle>0){let r=0;for(;r<i;){if(r>this.startAngle){let n=this.pointOn(r);t[0]=Math.min(t[0],n.x),t[1]=Math.max(t[1],n.x),t[2]=Math.min(t[2],n.y),t[3]=Math.max(t[3],n.y)}r+=90}}else if(this.sweepAngle<0){let r=360;for(;r>i;){if(r<this.startAngle){let n=this.pointOn(r);t[0]=Math.min(t[0],n.x),t[1]=Math.max(t[1],n.x),t[2]=Math.min(t[2],n.y),t[3]=Math.max(t[3],n.y)}r-=90}}return new Zi(t[0],t[1],t[2],t[3])}bbox(){return this.__bbox==null&&(this.__bbox=this.buildBBox()),this.__bbox}length(){return Math.abs(this.rx*this.sweepAngle*Math.PI/180)}toString(){return Kl.format("Arc [start=%s, end=%s, rx=%s, ry=%s, center=%s, startAngle=%s, sweepAngle=%s]",this._start,this._end,this.rx,this.ry,this.center,this.startAngle,this.sweepAngle)}stroke(t,i,r){let n=t/2,s=this.rx+n,a=this.ry+n,o=this.rx-n,l=this.ry-n,u=new Pt;o<0&&(o=-o,u=u.multiply3(Pt.MIRROR_Y)),l<0&&(l=-l,u=u.multiply3(Pt.MIRROR_X)),o===0&&(o=.001),l===0&&(l=.001),u=u.setOrigin1(this.center);let c,h;switch(r===this.sweep()?(c=Lt.build3(this.center,this.startAngle,this.sweepAngle,s,a),h=Lt.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle,o,l)):(c=Lt.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle,s,a),h=Lt.build3(this.center,this.startAngle,this.sweepAngle,o,l)),h=h.multiply3(u),i){case 1:{let m=r===1?180:-180,f=r===this.sweep()?this.pointOn(this.endAngle()):this.pointOn(this.startAngle),g=r===this.sweep()?this.pointOn(this.startAngle):this.pointOn(this.endAngle()),y=c.pointOn(c.endAngle()).angleD(f),b=h.pointOn(h.endAngle()).angleD(g);return et.build2([c,Lt.build3(f,y,m,n,n),h,Lt.build3(g,b,m,n,n)])}default:return et.build2([c,h])}}points2(){let t=Math.ceil(Math.abs(this.sweepAngle)/xj),i=this.sweepAngle/t,r=[this._start];for(let n=1;n<t;n++)r.push(this.pointOn(this.startAngle+i*n));return r.push(this._end),r}points1(t){let i=Math.max(this.rx,this.ry);if(i<=t)return[this.start(),this.svgEnd];let r=(i-t)/i,n=Math.ceil(Math.abs(this.sweepAngle/Ye.toDegrees(Math.acos(r))/2)),s=new Array(n+1),a=this.sweepAngle/n,o=this.startAngle;for(let l=0;l<=n;l++,o+=a)s[l]=this.pointOn(o);return s}points(t){let i=Math.max(this.rx,this.ry);if(t=Math.abs(t),i<=t)return[this.start(),this.svgEnd];t=Math.max(t,i*1e-5),t=Math.min(t,i*(1-Math.SQRT1_2));let r=(i-t)/i,n=Math.ceil(Math.abs(this.sweepAngle/Ye.toDegrees(Math.acos(r))/2));n=Math.max(n,2);let s=new Array(n+1),a=this.sweepAngle/n,o=this.startAngle+a;s[0]=this.start();for(let l=1;l<n;l++,o+=a)s[l]=this.pointOn(o);return s[n]=this.end(),s}panDistance(t){return this.sweepAngle>0?new Lt(this.rx-t,this.ry-t,this.center,this.startAngle,this.sweepAngle):new Lt(this.rx+t,this.ry+t,this.center,this.startAngle,this.sweepAngle)}panDistance1(t){if(this.sweepAngle>0){let i=this.rx-t;return i<0?(i=Math.abs(i),Lt.build3(this.center,this.startAngle-180,this.sweepAngle,i,i)):new Lt(i,i,this.center,this.startAngle,this.sweepAngle)}else{let i=this.rx+t;return i<0?(i=Math.abs(i),Lt.build3(this.center,this.startAngle-180,this.sweepAngle,i,i)):new Lt(i,i,this.center,this.startAngle,this.sweepAngle)}}get bulge(){let t=Math.abs(ej(this.sweepAngle,3))/180*Math.PI;return Math.tan(t/4)}get midPoint(){let t=Ye.toRadians(this.startAngle),i=Ye.toRadians(this.endAngle()),r=this.sweep(),n=this.center,s=this.rx;if(r==1)if(i>t){let a=(i-t)/2+t;return n.add(new ie(Math.cos(a),Math.sin(a)).mul(s))}else{if(i==t)return n.add(new ie(Math.cos(Math.PI*3/2),Math.sin(Math.PI*3/2)).mul(s));{let a=(i+Ap-t)/2+t;return n.add(new ie(Math.cos(a),Math.sin(a)).mul(s))}}else if(i>t){let a=(t+Ap-i)/2+i;return n.add(new ie(Math.cos(a),Math.sin(a)).mul(s))}else{if(i==t)return n.add(new ie(Math.cos(Math.PI*3/2),Math.sin(Math.PI*3/2)).mul(s));{let a=(t-i)/2+i;return n.add(new ie(Math.cos(a),Math.sin(a)).mul(s))}}}get svgPathData(){return[{type:"M",values:[this._start.x,this._start.y]},{type:"A",values:[this.rx,this.ry,0,this.isLarge()?1:0,this.isCCW,this._end.x,this._end.y]}]}equals(t){let i=Ye.regularD(this.startAngle),r=Ye.regularD(this.sweepAngle),n=Ye.regularD(t.startAngle),s=Ye.regularD(t.sweepAngle);return Gn([this.rx,this.ry,this.center,Math.abs(r)],[t.rx,t.ry,t.center,Math.abs(s)])&&(Gn([r,i],[s,n])||Gn([Ye.regularD(i+r)],[n]))}equals1(t){let i=Ye.regularD(this.startAngle),r=Ye.regularD(this.sweepAngle),n=Ye.regularD(t.startAngle),s=Ye.regularD(t.sweepAngle);return Gn([this.rx,this.ry,this.center,Math.abs(r)],[t.rx,t.ry,t.center,Math.abs(s)])&&(Gn([r,i],[s,n])||Gn([Ye.regularD(i+r)],[n]))}inArea(t,i){let r=t.x,n=t.y,s=this.center,a=this.rx,o=Ye.toRadians(this.startAngle);this.sweep()==0&&(o=Ye.toRadians(this.endAngle()));let l=Ye.toRadians(this.endAngle());this.sweep()==0&&(l=Ye.toRadians(this.startAngle));let u=a-i/2,c=a+i/2;var h=r-s.x,m=n-s.y,f=Math.atan2(m,h);if(f<0&&(f+=Ap),o<=l&&f>=o&&f<=l||o>l&&(f>=o&&f<=Ap||f>=0&&f<=l)||o==l){var g=Math.sqrt(h*h+m*m);return g<=c&&g>=u}else{var g=(c+u)/2,y=new ie(s.x+Math.cos(o)*g,s.y+Math.sin(o)*g),b=new ie(s.x+Math.cos(l)*g,s.y+Math.sin(l)*g),E=r-y.x,S=n-y.y,v=r-b.x,A=n-b.y;return E*E+S*S<=i*i/4?!0:v*v+A*A<=i*i/4}}isCircle(){return(de.eq(Math.abs(this.sweepAngle),360)||this._start.equals1(this._end))&&this.rx==this.ry}reverse(){return Lt.build3(this.center,this.endAngle(),-this.sweepAngle,this.rx,this.ry)}getAngle(){let t=Math.PI*2;return this.sweep()==1?(this.endAngle()-this.startAngle+t)%t:(this.startAngle-this.endAngle()+t)%t}isValid(){return this.rx>0&&this.ry>0}},Mx=new ArrayBuffer(24),ob=new Float64Array(Mx),Ul=new Int32Array(Mx),fi,qee=(fi=class{static normal(t,i,r){let n=i.sub(t),s=r.sub(i);return n.cross(s)}constructor(t,i,r){this.x=Ft.normal(t),this.y=Ft.normal(i),this.z=Ft.normal(r),ob[0]=t,ob[1]=i,ob[2]=r,this.hashed=Ul[0]^Ul[1]^Ul[2]^Ul[3]^Ul[4]^Ul[5]}isZeroVector(){return this.x===0&&this.y===0&&this.z===0}hashCode(){return this.hashed}equals(t){return t instanceof fi?t.x===this.x&&t.y===this.y&&t.z===this.z:!1}cross(t){return new fi(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){var t=this.length();return new fi(this.x/t,this.y/t,this.z/t)}sub(t){return new fi(this.x-t.x,this.y-t.y,this.z-t.z)}add(t){return new fi(this.x+t.x,this.y+t.y,this.z+t.z)}scale(t){return new fi(this.x*t,this.y*t,this.z*t)}neg(){return new fi(-this.x,-this.y,-this.z)}multiply4(t){var i=this.x*t.data[0]+this.y*t.data[4]+this.z*t.data[8]+t.data[12],r=this.x*t.data[1]+this.y*t.data[5]+this.z*t.data[9]+t.data[13],n=this.x*t.data[2]+this.y*t.data[6]+this.z*t.data[10]+t.data[14],s=this.x*t.data[3]+this.y*t.data[7]+this.z*t.data[11]+t.data[15];return s!=0?new fi(i/s,r/s,n/s):new fi(i,r,n)}rotate(t,i){return this.multiply4(Rx.rotateAxis(t,i))}toVector2(){return new ie(this.x,this.y)}},fi.ORIGIN=new fi(0,0,0),fi.X_UNIT_VECTOR=new fi(1,0,0),fi.Y_UNIT_VECTOR=new fi(0,1,0),fi.Z_UNIT_VECTOR=new fi(0,0,1),fi);var Qt=class zl{static build(t){return t instanceof et?new zl([new mi([t])]):t instanceof mi?new zl([t]):t}static buildByPolygon(t){return t?new zl([t]):new zl([])}static buildByStroke(t,i,r=1,n){return this.buildByPolygon(mi.buildByStroke(t,i,r,a0,n))}static buildCircle(t,i){return this.buildByPolygon(mi.buildCircle(t,i))}static buildRect(t){return this.buildByPolygon(mi.buildRect(t))}static buildBBox(t){return this.buildByPolygon(mi.buildBBox(t))}constructor(t){this.items=t.slice()}multiply3(t){return new zl(this.items.map(i=>i.multiply3(t)))}bbox(){return this._bbox||(this._bbox=this.items.reduce((t,i)=>t.ext1(i.bbox()),new Sr).build1()),this._bbox}toPolylineGroups(){return this.items.map(t=>t.toPolylineGroup())}},At,gt=(At=class{static isHexFormate(t){return!t||typeof t!="string"?!1:/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)}static of1(t){return this.of2(t>>16&255,t>>8&255,t&255)}static of2(t,i,r,n=255){return new At(t/255,i/255,r/255,n/255)}static of3(t){t.startsWith("#")&&(t=t.substr(1));let i=t.length;if(i==3)return new At(parseInt(t[0],16)/15,parseInt(t[1],16)/15,parseInt(t[2],16)/15);if(i==6)return new At(parseInt(t.substr(0,2),16)/255,parseInt(t.substr(2,2),16)/255,parseInt(t.substr(4,2),16)/255);if(i==8)return new At(parseInt(t.substr(0,2),16)/255,parseInt(t.substr(2,2),16)/255,parseInt(t.substr(4,2),16)/255,parseInt(t.substr(6,2),16)/255);throw new Error("invalid color string")}static of4(t){let i=parseInt(t.r*255+"").toString(16),r=parseInt(t.g*255+"").toString(16),n=parseInt(t.b*255+"").toString(16);return i.length<2&&(i="0"+i),r.length<2&&(r="0"+r),n.length<2&&(n="0"+n),("#"+i+r+n).toUpperCase()}static of5(t,i){if(t.startsWith("#")&&(t=t.substr(1)),t.length==3)return new At(parseInt(t[0],16)/15,parseInt(t[1],16)/15,parseInt(t[2],16)/15,i);if(t.length==6)return new At(parseInt(t.substr(0,2),16)/255,parseInt(t.substr(2,2),16)/255,parseInt(t.substr(4,2),16)/255,i);throw new Error("invalid color string")}static of6(t,i){return new At(t.r,t.g,t.b,i)}static of7(t){return t==null?null:At.of3(t)}constructor(t,i,r,n=1){this.r=Ft.positiveOr0(t),this.g=Ft.positiveOr0(i),this.b=Ft.positiveOr0(r),this.alpha=n}hashCode(){return this.r+this.g+this.b+this.alpha}equals(t,i=!1){let r=this.r===t.r&&this.g===t.g&&this.b===t.b;return i?r:r&&this.alpha===t.alpha}add(t,i,r,n){return new At(Math.max(0,Math.min(1,this.r+t)),Math.max(0,Math.min(1,this.g+i)),Math.max(0,Math.min(1,this.b+r)),Math.max(0,Math.min(1,this.alpha+n)))}mul(t){return new At(Math.max(0,Math.min(1,this.r*t)),Math.max(0,Math.min(1,this.g*t)),Math.max(0,Math.min(1,this.b*t)),this.alpha)}mul1(t){return new At(Math.max(0,this.r*t),Math.max(0,this.g*t),Math.max(0,this.b*t),this.alpha)}getData(){return[this.r,this.g,this.b,this.alpha]}toString(){let t=(this.r*255).toString(16),i=(this.g*255).toString(16),r=(this.b*255).toString(16);return t.length<2&&(t="0"+t),i.length<2&&(i="0"+i),r.length<2&&(r="0"+r),"#"+t.substr(0,2)+i.substr(0,2)+r.substr(0,2)}toString1(){let t=(this.r*255).toString(16),i=(this.g*255).toString(16),r=(this.b*255).toString(16),n=(this.alpha*255).toString(16);return t.length<2&&(t="0"+t),i.length<2&&(i="0"+i),r.length<2&&(r="0"+r),n.length<2&&(n="0"+n),"#"+t.substr(0,2)+i.substr(0,2)+r.substr(0,2)+n.substr(0,2)}toRGBA(){let t=this.r*255,i=this.g*255,r=this.b*255;return[t,i,r,this.alpha]}toRGBAString(){let t=this.r*255,i=this.g*255,r=this.b*255;return`rgba(${t},${i},${r},${this.alpha})`}isWHITE(){return this.r===1&&this.g===1&&this.b===1&&this.alpha===1}},At.WHITE=new At(1,1,1,1),At.BLACK=new At(0,0,0,1),At.RED=new At(1,0,0,1),At.GREEN=new At(0,1,0,1),At.BLUE=new At(0,0,1,1),At.Gray=At.of3("#9966ff"),At.Silver=At.of3("#D2D2D2"),At.Golden=At.of3("#DCAA14"),At.Pink=At.of3("#ffaec9"),At),BC=!1,kx=class{onRTreeBBox(e){}onResultSide(e){}onOriginSide(e){}onSplitedSide(e){}onDebugSide(e){}onSweep(e,t,i,r,n,s){}onIntersect(e,t,i){}onSegment(e,t,i,r,n,s){}onSegment1(e,t,i){if(BC){let r=new ie(e.getX(i),i),n=new ie(t.getX(i),i);this.onSegment(r,e.weight,e,n,t.weight,t)}else this.onSegment(e.start,e.weight,e,t.end,t.weight,t)}onSweep1(e,t,i){if(BC){let r=new ie(e.getX(i),i),n=new ie(t.getX(i),i);this.onSweep(r,e.weight,e,n,t.weight,t)}else this.onSweep(e.start,e.weight,e,t.end,t.weight,t)}},qc=class extends kx{constructor(e){super(),this.plGrps=new Array,this.debug=e}onPolylineGroup(e,t){this.plGrps.push(e)}},od=class{constructor(e){this.cache={},this.levels=e,this.result=new Array(e),this.weights=new Array(e),this.maxIdx=e-1,this.rule=this.decide.bind(this);let t=1;for(let i=0;i<e;i++)this.weights[i]=t,t*=50}weight(e){return this.weights[e]}decide(e){e=Math.abs(e);let t=this.cache[e];if(t===void 0){let i=e;for(let r=this.maxIdx;r>=0;r--){let n=this.weights[r],s=e/n|0,a=e%n;a>(n/2|0)?(e=n-a,s++):e=a,this.result[r]=s>0}t=this.decide1(this.result),this.cache[i]=t}return t}},Tj=e=>e!==0;var wj=new class extends od{decide1(e){return e[0]||e[1]}}(2),Hp=new class extends od{decide1(e){return e[0]&&!e[1]}}(2),jp=new class extends od{decide1(e){return e[0]&&e[1]}}(2),Yp=new class extends od{decide1(e){return e[0]&&!e[1]||!e[0]&&e[1]}}(2),Rj=(e=>(e[e.UNMARKED=0]="UNMARKED",e[e.INSIDE=1]="INSIDE",e[e.OUTSIDE=2]="OUTSIDE",e[e.INVALID=3]="INVALID",e))(Rj||{}),lu=class Vl{constructor(t,i,r,n,s,a,o){this.inters=[],this.connect=new Array,this.previous=null,this.next=null,this.finalGrp=-1,this.trans=NaN,this.outsideWeight=0,this.insideWeight=0,this.invalidWeight=0,this._confidence=0,this._confidence_y=NaN,this._x=NaN,this._x_y=NaN,this.status=0,this.bo=t,this.shape=i,this.baseWeight=r,n.y>s.y?this.weight=-r:n.y==s.y?this.weight=0:this.weight=r,this.start=n,this.end=s,this.polyGrp=a,this.polyIndex=o,this._bbox=new Sr().ext1(i.bbox()).ext2(n).ext2(s).build1(),this.inters.push(n),this.inters.push(s);let l=31,u=1;u=l*u+this.polyGrp,u=l*u+this.polyIndex,this._hashcode=u}static rebuild(t,i,r){if(t instanceof J||i.distance2(r)<1e-6)return new J(i,r);if(t instanceof ue){let n=t,s=t.bbox().center().x,a;i.y>r.y?a=s>n.center.x?0:1:a=s>n.center.x?1:0;let o=i.angleD(n.center),l=r.angleD(n.center);return ue.build2(n.center,o,l,n.rx,n.ry,a)}else throw new Error("not supported operation")}updateBbox(){this._bbox=new Sr().ext2(this.start).ext2(this.end).build1()}is(t,i){return t===this.polyGrp&&i===this.polyIndex}confidence(t){if(this._confidence_y!=t){let i=this._bbox.height();if(i!==0)if(Math.abs(t-this._bbox.maxY)>5e-4&&Math.abs(t-this._bbox.minY)>5e-4){let r=1-Math.abs(2*t-this._bbox.maxY-this._bbox.minY)/i;this._confidence=r*1e4|0}else this._confidence=0;else this._confidence=1;this._confidence_y=t}return this._confidence}needCountWeight(){return this.outsideWeight+this.insideWeight+this.invalidWeight<5e3}revokeOutside(t){let i=this.confidence(t);return this.outsideWeight-=i,this.invalidWeight+=i,i}revokeInside(t){let i=this.confidence(t);return this.insideWeight-=i,this.invalidWeight+=i,i}setOutside(t){let i=this.confidence(t);return this.outsideWeight+=i,i}setInside(t){let i=this.confidence(t);return this.insideWeight+=i,i}setInvalid(t){let i=this.confidence(t);return this.invalidWeight+=i,i}prevNot0(){let t=this.previous;for(;t!=null&&t!=this;){if(t.weight!=0)return t;t=t.previous}return null}nextNot0(){let t=this.next;for(;t!=null&&t!=this;){if(t.weight!=0)return t;t=t.next}return null}getX(t){if(this.bo!==null)return(this._x_y!=t||isNaN(this._x))&&(Fj(this,t)>0?this._x=Y[0]:this._x=NaN,this._x_y=t),this._x;throw new Error("not supported operation")}voteStatus(){return this.outsideWeight>this.insideWeight&&this.outsideWeight>this.invalidWeight?2:this.insideWeight>this.outsideWeight&&this.insideWeight>this.invalidWeight?1:this.invalidWeight>this.outsideWeight&&this.invalidWeight>this.insideWeight?3:0}reverse(t){if(t===2)if(this.start.y>this.end.y){let i=Vl.rebuild(this.shape,this.end,this.start),r=new Vl(this.bo,i,this.baseWeight,this.end,this.start,this.polyGrp,this.polyIndex);return Qi.addAll(r.connect,this.connect),r}else return this;else if(t===1)if(this.start.y<this.end.y){let i=Vl.rebuild(this.shape,this.end,this.start),r=new Vl(this.bo,i,this.baseWeight,this.end,this.start,this.polyGrp,this.polyIndex);return Qi.addAll(r.connect,this.connect),r}else return this;return this}isNeedScan(t){return this.needCountWeight()&&this.confidence(t)>0}hashCode(){return this._hashcode}equals(t){return t instanceof Vl?!(this.polyGrp!==t.polyGrp||this.polyIndex!==t.polyIndex):!1}bbox(){return this._bbox}toString(){return Kl.format("(%d,%d,%d) (%d,%d,%d) %s %s",this.polyGrp,this.polyIndex,this.weight,this.outsideWeight,this.invalidWeight,this.insideWeight,this.start,this.end)}};function Lj(e,t){let i=e.bbox(),r=t.bbox(),n=(i.minY+i.maxY)/2,s=(r.minY+r.maxY)/2;return n-s}function Nj(e,t){let i=e.bbox(),r=t.bbox(),n=(i.minX+i.maxX)/2,s=(r.minX+r.maxX)/2;return n-s}var Hl=class{constructor(e){if(this.__bbox=null,typeof e<"u")if(e instanceof Array){this.__items=[];for(let t of e)this.add(t)}else this.__items=e,this.__bbox=e.bbox();else this.__items=[]}add(e){if(this.__items instanceof Array)this.__items.push(e),this.__bbox=Zi.extend2(this.__bbox,e.bbox());else throw new Error("can't insert multiple item into leaf node")}items(){return this.__items}bbox(){if(this.__bbox!==null)return this.__bbox;throw new Error("bug")}},Kc=class{constructor(e){this.changed=!1,this.root=new Hl,this.capacity=e,this.capacity2=e*e,this.itemList=[]}size(){return this.itemList.length}items(){return this.flushWhenNeed(),this.itemList}add(e){this.itemList.push(e),this.changed=!0}remove(e){Qi.remove(this.itemList,e),this.changed=!0}clear(){this.changed=!1,this.root=new Hl,this.itemList.length=0}flushWhenNeed(){if(this.changed){let e=new Array;for(let t of this.itemList)e.push(new Hl(t));for(;;){let t=this.organize(e);if(t.length>1)e=t;else break}this.root=new Hl(e),this.changed=!1}}organize(e){Wo(e,Nj,0,e.length);let t=e.length,i=[];for(let r=0;r<t;)if(r+this.capacity2<=t){let n=r+this.capacity2;Wo(e,Lj,r,n);for(let s=r;s<n;s+=this.capacity){let a=new Hl(e.slice(s,s+this.capacity));i.push(a)}r=r+this.capacity*this.capacity}else{let n=new Hl(e.slice(r,r+this.capacity));i.push(n),r=r+this.capacity}return i}search(e){this.flushWhenNeed();let t=[],i=[];for(i.push(this.root);;){let r=i.shift();if(typeof r<"u"){let n=r.items();if(n instanceof Array){for(let s of n)if(!e.isSeparated(s.bbox())){let a=s.items();a instanceof Array?i.push(s):t.push(a)}}else e.isSeparated(r.bbox())||t.push(n)}else break}return t}walker(e){this.flushWhenNeed(),this._walker(this.root,0,e)}_walker(e,t,i){this.flushWhenNeed();let r=e.items();if(r instanceof Array)for(let n of r)this._walker(n,t+1,i);else i(r,t)}bbox(){return this.flushWhenNeed(),this.root.bbox()}};function lb(e,t){Dj(e.iterator(),t)}function Dj(e,t){let i=0;for(;e.hasNext();){let r=e.next();t(i++,r)}}var Cp=new Error("list is empty"),xp=class{constructor(e,t){this.prev=null,this.next=null,this.parent=e,this.item=t}insertAfter(e){e.next=this.next,this.next=e,e.prev=this,e.next!==null&&(e.next.prev=e)}insertBefore(e){e.prev=this.prev,this.prev=e,e.next=this,e.prev!==null&&(e.prev.next=e)}remove(){this.prev!==null&&(this.prev.next=this.next),this.next!==null&&(this.next.prev=this.prev)}set(e){this.item=e}},Bj=class{constructor(e){this._next=e}hasNext(){return this._next!==null}next(){let e=this._next;if(e!==null)return this._next=e.next,e.item;throw new Error("iterator is null")}},Oj=class{constructor(e){this._next=e}hasNext(){return this._next!==null}next(){let e=this._next;if(e!==null)return this._next=e.next,e;throw new Error("iterator is null")}},Mo=class{constructor(){this.first=null,this.last=null,this.cnt=0}add(e){return this.addLast(e)}push(e){return this.addLast(e)}pop(){return this.removeLast()}shift(){return this.removeFirst()}removeFirst(){let e=this.first;if(e===null)throw Cp;return this.remove(e),e.item}removeLast(){let e=this.last;if(e===null)throw Cp;return this.remove(e),e.item}addLast(e){return this.first===null||this.last===null?(this.first=new xp(this,e),this.last=this.first,this.cnt=1,this.first):this.insertAfter(this.last,e)}addFirst(e){if(this.first===null||this.last===null){let t=new xp(this,e);return this.first=t,this.last=t,this.cnt++,t}else return this.insertBefore(this.first,e)}getFirst(){if(this.first===null)throw Cp;return this.first.item}getLast(){if(this.last===null)throw Cp;return this.last.item}insertAfter(e,t){let i=new xp(this,t);return e.insertAfter(i),e===this.last&&(this.last=i),this.cnt++,i}insertBefore(e,t){let i=new xp(this,t);return e.insertBefore(i),e===this.first&&(this.first=i),this.cnt++,i}remove(e){e.remove(),e===this.first&&(this.first=e.next),e===this.last&&(this.last=e.prev),this.cnt--}size(){return this.cnt}clear(){this.first=null,this.last=null,this.cnt=0}iterator(){return new Bj(this.first)}listIterator(){return new Oj(this.first)}toArray(){let e=new Array(this.cnt),t=this.first,i=0;for(;t!=null;)e[i]=t.item,t=t.next,i++;return e}};function ub(e){throw new Error("")}var Tp=class{constructor(e,t){this.node1=null,this.node2=null,this.key=e,this.value=t}},Mj=class{constructor(e){this.itors=e}hasNext(){return this.itors.hasNext()}next(){return this.itors.next().key}},kj=class{constructor(e){this.itors=e}hasNext(){return this.itors.hasNext()}next(){return this.itors.next().value}},sf=class{constructor(){this.innerList=new Mo,this.innerMap={}}replace(e,t){e.node1!==null&&(e.node1.set(t),t.node1=e.node1),e.node2!==null&&(e.node2.set(t),t.node2=e.node2)}clear(){this.innerList.clear();for(let e in this.innerMap)delete this.innerMap[e]}put(e,t){let i=e.hashCode(),r=new Tp(e,t),n=this.innerMap[i];if(n===void 0)return r.node1=this.innerList.add(r),this.innerMap[i]=r,null;if(n instanceof Tp){if(n.key.equals(e))return this.innerMap[i]=r,this.replace(n,r),n.value;{r.node1=this.innerList.add(r);let s=new Mo;return n.node2=s.add(n),r.node2=s.add(r),this.innerMap[i]=s,null}}if(n instanceof Mo){let s=null;return lb(n,(a,o)=>o.key.equals(e)?(this.replace(o,r),s=o.value,!1):!0),s===null?(r.node1=this.innerList.add(r),r.node2=n.push(r),null):s}return ub(n)}get(e){let t=e.hashCode(),i=this.innerMap[t];if(i===void 0)return null;if(i instanceof Tp)return i.key.equals(e)?i.value:null;if(i instanceof Mo){let r=null;return lb(i,(n,s)=>s.key.equals(e)?(r=s.value,!1):!0),r}return ub(i)}containsKey(e){return this.get(e)!==null}delete(e){e.node1!==null&&e.node1.parent.remove(e.node1),e.node2===null?delete this.innerMap[e.key.hashCode()]:e.node2.parent.remove(e.node2)}remove(e){let t=e.hashCode(),i=this.innerMap[t];if(i===void 0)return null;if(i instanceof Tp)return i.key.equals(e)?(this.delete(i),i.value):null;if(i instanceof Mo){let r=null;return lb(i,(n,s)=>s.key.equals(e)?(r=s.value,this.delete(s),!1):!0),r}return ub(i)}computeIfAbsent(e,t){let i=this.get(e);if(i===null){let r=t(e);return this.put(e,r),r}else return i}size(){return this.innerList.size()}isEmpty(){return this.innerList.size()===0}keys(){return new Mj(this.innerList.iterator())}values(){return new kj(this.innerList.iterator())}entries(){return this.innerList.iterator()}},ru=class{constructor(){this.innerMap=new sf}add(e){return this.innerMap.put(e,!0)!==!0}remove(e){this.innerMap.remove(e)}contains(e){return this.innerMap.get(e)===!0}iterator(){return this.innerMap.keys()}addAll(e){let t=e.iterator();for(;t.hasNext();)this.add(t.next())}size(){return this.innerMap.size()}clear(){let e=this.iterator();for(;e.hasNext();){let t=e.next();this.remove(t)}}},OC=Qi.funcCopy(Wo);function Fj(e,t){let i=0;if(Math.abs(e.start.y-t)<=1e-4)Y[i++]=e.start.x;else if(Math.abs(e.end.y-t)<=1e-4)Y[i++]=e.end.x;else if(e.shape instanceof J)i=nj(e.shape,t);else if(e.shape instanceof ue)i=sj(e.shape,t);else throw new Error("not supported operation");return i}var Gp=class{constructor(e,t,i,r){this.sides=new Array,this.loader=e,this.loader.bo=this,this.logger=i,this.rule=t,this.event=r}static sortByBBoxMinY(e,t){return e.bbox().minY-t.bbox().minY}static sortByBBoxAreaDesc(e,t){return t.bbox().area()-e.bbox().area()}addPolyline(e,t=1,i=.01,r=!0){for(let n of this.loader.buildGroup(e,t,i,r))this.sides.push(n),this.event.onOriginSide(n)}buildRTree(){let e=new Kc(10);for(let t of this.sides)e.add(t);return e}fillValidSides(e,t,i){for(let r of t)isFinite(r.getX(i))&&e.push(r)}getSortedEndpointsLineAsc(e){let t=new Array;for(let n of e)n.needCountWeight()&&(t.push(n.start),t.push(n.end));OC(t,ie.sortByYAsc,0,t.length);let i=new Array,r=Number.NEGATIVE_INFINITY;for(let n of t){let s=n.y;s>r&&(i.push(s),r=s)}return i}splitSides(e,t,i){let r=e.start,n=e.end,s=new ie(n.x+(r.x-n.x)*2,n.y+(r.y-n.y)*2);OC(e.inters,(o,l)=>o.distance2(s)-l.distance2(s),0,e.inters.length);let a=null;for(let o of e.inters)if(a==null)o.equals(r)&&(a=o);else if(!o.equals(a)){let l=lu.rebuild(e.shape,a,o);l instanceof ue&&Math.abs(l.sweepAngle)>190&&(l=new J(a,o));let u=new lu(this,l,e.baseWeight,a,o,e.polyGrp,i++);if(t.push(u),u.updateBbox(),o.equals(n))break;a=o}return i}splitSidesByInters(){let e=new Array;for(let t of this.sides)if(t.polyIndex==0){let i=0,r=null,n=null;do{let s=new Array;i=this.splitSides(t,s,i);for(let a of s)r!=null?(r.next=a,a.previous=r):n=a,r=a,this.event.onSplitedSide(a),e.push(a);if(t.next===null)throw new Error("not supported operation");t=t.next}while(t.polyIndex!==0);n!=null&&r!=null&&(n.previous=r,r.next=n)}this.sides.length=0;for(let t of e)this.sides.push(t)}seekIntersection(){if(this.sides.length>0){let e=this.buildRTree(),t=new ru;for(let i of this.sides){t.add(i);let r=i.bbox().extendOfSize(1e-5),n=i.shape instanceof J;for(let s of e.search(r))if(!t.contains(s)){let a=s.shape instanceof J;if(!(n&&a&&i.next!==null&&i.previous!==null&&(i.next.equals(s)||i.previous.equals(s)))){let o=vn(i.shape,s.shape);for(let l=0;l<o;l+=2){let u=new ie(Y[l],Y[l+1]);i.inters.push(u),s.inters.push(u),this.event.onIntersect(u,i,s)}}}}}}},Uj=class Fx{constructor(t){this.sides=new ru,this.others=new ru,this.id=t}add(t){this.sides.add(t),t.finalGrp=this.id;for(let i of t.connect)this.others.add(i)}polyline(){let t=new Array;return iu(this.sides,(i,r)=>(t.push(r.shape),!0)),et.build2(t).asClose()}hashCode(){return this.id}equals(t){return t!=null&&t instanceof Fx?this.id===t.id:!1}},Ux=class{constructor(e){this.bo=null,this.sides=new Array,this.polyGrp=0,this.polyIndex=0,this.prevSide=null,this.firstSide=null,this.noWeight0=e}completeGroup(e){this.prevSide!=null&&this.firstSide!=null&&!this.prevSide.end.equals(this.firstSide.start)&&this.addSide(new J(this.prevSide.end,this.firstSide.start),e);let t=new Array,i=null,r=null;for(let n of this.sides)(!this.noWeight0||n.weight!==0)&&(i!=null?(i.next=n,n.previous=i):r=n,i=n,t.push(n));return i!=null&&r!=null&&(r.previous=i,i.next=r),this.polyGrp++,this.sides.length=0,this.prevSide=null,this.firstSide=null,this.polyIndex=0,t}buildGroup(e,t,i,r=!0){for(let n of e.primitives)if(n instanceof J)this.addSide(n,t);else if(r&&n instanceof ue&&n.rx===n.ry)this.addArc(n,t);else{let s=null;for(let a of n.points(i))s!=null&&this.addSide(new J(s,a),t),s=a}return this.completeGroup(t)}addArc(e,t){let i=e.sweepAngle,r=Ye.regularD(e.startAngle),n=r+i;if(i>0){let s=90;for(;s<=n;)s>r&&(this.addSide(ue.build3(e.center,r,s-r,e.rx,e.ry),t),r=s),s+=90;r<n&&this.addSide(ue.build3(e.center,r,n-r,e.rx,e.ry),t)}else if(i<0){let s=270;for(;s>=n;)s<r&&(this.addSide(ue.build3(e.center,r,s-r,e.rx,e.ry),t),r=s),s-=90;r>n&&this.addSide(ue.build3(e.center,r,n-r,e.rx,e.ry),t)}}addSide(e,t){if(e.start().equals(e.end()))return;let i=e.start(),r;this.prevSide!=null?(this.prevSide.end.equals(i)||this.addSide(new J(this.prevSide.end,i),t),r=new lu(this.bo,e,t,e.start(),e.end(),this.polyGrp,this.polyIndex++)):(r=new lu(this.bo,e,t,e.start(),e.end(),this.polyGrp,this.polyIndex++),this.firstSide=r),this.prevSide=r,this.sides.push(r)}},Hx=class{constructor(e,t,i){this.eps=new Array,this.curWeight=0,this.start=null,this.last=null,this.prevStart=null,this.prevEnd=null,this.y=i,this.rule=e,this.bo=t,this.event=t.event}onEp(e){this.tuningWeight(e),this.start===null?this.rule(this.curWeight)?this.in(e):e.setInvalid(this.y):this.rule(this.curWeight)?e.setInvalid(this.y):this.out(e,this.start),this.last!==null&&this.event.onSweep1(this.last,e,this.y),this.last=e}in(e){this.prevEnd!=null&&this.onSameX(e,this.prevEnd)?(this.start=this.prevStart,this.prevStart=null,this.prevEnd.revokeInside(this.y),this.prevEnd=null):(this.start=e,this.start.setOutside(this.y))}out(e,t){if(this.onSameX(t,e))t.revokeOutside(this.y);else{if(e.setInside(this.y)>0&&t.confidence(this.y)>0){let i=t.voteStatus(),r=e.voteStatus();this.isValid(i)&&this.isValid(r)?i==2&&r==1&&(e.connect.push(t),t.connect.push(e)):(e.connect.push(t),t.connect.push(e))}this.event.onSegment1(t,e,this.y),this.eps.push(t),this.eps.push(e),this.prevStart=t,this.prevEnd=e}this.start=null}isValid(e){return e==1||e==2}onSameX(e,t){return e.bbox().isIntersect(t.bbox())&&de.eq(e.getX(this.y),t.getX(this.y))}tuningWeight(e){this.curWeight+=e.weight;let t=e.nextNot0(),i=e.prevNot0();t!=null&&e.weight===t.weight&&t.trans===this.y&&(this.curWeight-=e.weight),i!=null&&e.weight===i.weight&&i.trans===this.y&&(this.curWeight-=e.weight),e.trans=this.y}},af=new Error,MC=new class extends od{decide1(e){return e[0]&&e[1]}}(2),Hj=new class extends kx{onPolylineGroup(e,t){throw af}onSegment(e,t,i,r,n,s){throw af}},jj=class{constructor(e,t){this.rtree=e,this.level=t}},Yj=class jx extends Gp{static isIntersect(t,i,r=Ef.DUMMY){let n=new jx(r),s=n.createGroup1(t.items),a=n.createGroup2(i.items);return s.rtree.itemList.length==0||a.rtree.itemList.length==0?!1:n.isIntersect(s,a)}constructor(t){super(new Ux(!1),MC.rule,t,Hj)}createGroup1(t){return this.createGroup(t,0)}createGroup2(t){return this.createGroup(t,1)}createGroup(t,i){let r=MC.weight(i);for(let s of t)this.addPolyline(s,r);let n=this.buildRTree();return this.sides.length=0,new jj(n,i)}isIntersect(t,i){if(t.level!==i.level){let r=t.rtree.bbox().intersection1(i.rtree.bbox());if(r!==null){try{this.inters(t,i);let n=(r.minY+r.maxY)/2;this.sweep(t,i,n)}catch(n){if(n===af)return!0;throw n}return!1}else return!1}else throw new Error("inersection detection should not in same group")}inters(t,i){if(t.rtree.size()>i.rtree.size()){let r=t;t=i,i=r}for(let r of t.rtree.items()){r.trans=NaN;let n=r.bbox().extendOfSize(1e-5);for(let s of i.rtree.search(n))if(s.trans=NaN,vn(r.shape,s.shape)>0)throw af}}sweep(t,i,r){let n=Zi.extend2(t.rtree.bbox(),i.rtree.bbox()).extendOfSize(1e-5),s=new Array;this.fillValidSides(s,t.rtree.search(n),r),this.fillValidSides(s,i.rtree.search(n),r),Wo(s,(o,l)=>o.getX(r)-l.getX(r),0,s.length);let a=new Hx(this.rule,this,r);for(let o of s)a.onEp(o)}},o0=class Qs{constructor(t){this.items=new Array(t.length),Qi.arraycopy(t,0,this.items,0,t.length),this.__bbox=this.calcBBox()}static build1(t){let i=[];return Zp(t,(r,n)=>(i.push(n),!0)),new Qs(i)}static build2(t){let i=t.map(r=>et.build8(r));return new Qs(i)}static combinePolylineGroupArr(t){let i=[];for(let r of t)i=i.concat(r.items);return new Qs(i)}calcBBox(){let t=new Sr;for(let i=0;i<this.items.length;i++)t.ext1(this.items[i].bbox());return t.build1()}multiply3(t){let i=new Array(this.items.length);for(let r=0;r<i.length;r++)i[r]=this.items[r].multiply3(t);return new Qs(i)}bbox(){return this.__bbox}asClose(){return this.items.forEach(t=>t.asClose()),this}mirrorY(t){return this.items.forEach(i=>i.mirrorY(t)),this}closeEndpoint(){return this.items.forEach(t=>t.closeEndpoint()),this}get primitives(){return this.items.map(t=>t.primitives).flat(2)}isEqual(t){return t instanceof Qs?this.items.every(i=>t.items.some(r=>r.isEqual(i))):!1}getOutMostPolyline(){return this.items.reduce((t,i)=>i.bbox().area()>t.bbox().area()?i:t,this.items[0])}getOutline(){let t=this.items;if(t.length===1)return{outline:t,hole:new Array};let i=new Set,r=new Set;for(let n=0,s=t.length;n<s;n++){let a=t[n];if(!i.has(a)&&!r.has(a)){n+1>=s&&i.add(a);for(let o=n+1;o<s;o++){let l=t[o];if(!i.has(l)&&!r.has(l)){if(!a.bbox().isInside(l.bbox().extendOfSize(1e-4))&&!l.bbox().isInside(a.bbox().extendOfSize(1e-4)))continue;Yj.isIntersect(new Qs([a]),new Qs([l]))&&(a.bbox().area()>l.bbox().area()?(i.add(a),r.add(l)):(i.add(l),r.add(a)))}}!i.has(a)&&!r.has(a)&&i.add(a)}}return{outline:[...i],hole:[...r]}}round(t=4){let i=this.items.map(r=>r.round(t));return new Qs(i)}},Gj=Qi.funcCopy(Wo),Wj=Qi.funcCopy(Wo),zj=Qi.funcCopy(Wo);function Vj(e){return new Array}function qj(e,t){let i=new qc(!1),r=new Xc(e,Ef.DUMMY,i);for(let n of t)r.addPolyline(n);return r.simplify(),i.plGrps}var Xc=class extends Gp{constructor(e,t,i){super(new Ux(!1),e,t,i),this.finalSides=new Array,this.sideGroups={},this.vecSides=new Array,this.scanY=NaN,this.curNetIndex=0,this.curIndex=-1,this.scanLines=0}sweep(e,t,i){this.scanY=NaN,this.scanLines=0,Gj(t,Gp.sortByBBoxMinY,0,t.length);let r=new Mo;this.curNetIndex=0;let n=Number.POSITIVE_INFINITY;for(let s of e)s>n&&this.scan(r,(n+s)/2,t),n=s;this.getAllMarkPrimitive(i,t),this.logger.debug3("scan %s %d",i,this.scanLines)}simplify(){this.seekIntersection(),this.splitSidesByInters(),this.sweep(this.getSortedEndpointsLineAsc(this.sides),this.sides,!1),this.flipSides(),this.sweep(this.getSortedEndpointsLineAsc(this.vecSides),this.vecSides,!0),this.connectSides(),this.fillResult()}addPolyline(e,t=1,i=.01,r=!0){super.addPolyline(e,t,i,r)}scan(e,t,i){if(this.scanY==t)return;this.scanY=t;let r=!1,n=e.listIterator();for(;n.hasNext();){let s=n.next(),a=s.item;de.less(a.bbox().maxY,t)?e.remove(s):!r&&a.isNeedScan(t)&&(r=!0)}for(;this.curNetIndex<i.length;){let s=i[this.curNetIndex];if(de.less(s.bbox().minY,t))de.greatereq(s.bbox().maxY,t)&&(this.add2AET(e,s),!r&&s.isNeedScan(t)&&(r=!0)),this.curNetIndex++;else break}if(r){this.scanLines++;let s=new Hx(this.rule,this,t),a=e.iterator();for(;a.hasNext();){let o=a.next();s.onEp(o)}}}add2AET(e,t){let i=t.bbox().minX,r=t.bbox().maxX,n=t.bbox().minY,s=t.bbox().maxY,a=e.listIterator(),o=null;for(;a.hasNext();){let l,u=a.next(),c=u.item,h=c.bbox().minX,m=c.bbox().maxX;if(r<=h)l=-1;else if(m<=i)l=1;else{let g=c.bbox().minY,y=c.bbox().maxY,b=Math.max(n,g),E=Math.min(s,y);l=this.compareBySweep(t,c,(b+E)/2)}let f=c.shape;if(f instanceof J&&f.length()<.001&&o==null&&l<0){o=u;continue}if(o!=null&&l<0){e.insertBefore(o,t);return}if(l<0){e.insertBefore(u,t);return}else o=null}e.add(t)}getLineAngle(e){let t=e.start().angle(e.end());return t<0&&(t+=Math.PI),t}getArcAngle(e,t){let i=Math.asin((t-e.center.y)/e.rx);return e.startAngle>90&&e.startAngle<270&&(i=-i),i<0&&(i+=Math.PI),(i+Math.PI/2)%Math.PI}compareArcLine(e,t,i){let r=this.getArcAngle(e,i),n=this.getLineAngle(t);return de.eq(r,n)?-e.sweepAngle:n-r}compareBySweep(e,t,i){let r=e.getX(i);if(!isFinite(r))return 0;let n=t.getX(i);if(!isFinite(n))return 0;if(!de.eq(r,n))return r-n;if(e.shape instanceof J)return t.shape instanceof J?this.getLineAngle(t.shape)-this.getLineAngle(e.shape):-this.compareArcLine(t.shape,e.shape,i);if(t.shape instanceof J)return this.compareArcLine(e.shape,t.shape,i);{let s=e.shape,a=t.shape,o=this.getArcAngle(s,i),l=this.getArcAngle(a,i);return de.eq(o,l)?s.sweepAngle*a.sweepAngle<=0?s.sweepAngle<=0?1:-1:s.sweepAngle>0?s.rx-a.rx:a.rx-s.rx:l-o}}getAllMarkPrimitive(e,t){for(let i of t)if(i.status===0&&i.bbox().height()!=0){let r=i.voteStatus();if(r===2||r===1){i.status=r;let n=i.reverse(r);if(e){this.event.onResultSide(n);let s=n.shape.multiply3(Pt.ROT_N90),a=n.start.multiply3(Pt.ROT_N90),o=n.end.multiply3(Pt.ROT_N90);n=new lu(this,s,n.baseWeight,a,o,n.polyGrp,n.polyIndex)}this.finalSides.push(n),this.event.onResultSide(n)}}}flipSides(){for(let e of this.sides)if(e.polyIndex==0){let t=null,i=null;do{let r=e.shape.multiply3(Pt.ROT_90),n=e.start.multiply3(Pt.ROT_90),s=e.end.multiply3(Pt.ROT_90),a=new lu(this,r,e.baseWeight,n,s,e.polyGrp,e.polyIndex);if(a.outsideWeight=e.outsideWeight,a.insideWeight=e.insideWeight,a.invalidWeight=e.invalidWeight,a.status=e.status,t!=null?(t.next=a,a.previous=t):i=a,this.vecSides.push(a),this.event.onSplitedSide(a),t=a,e.next!==null)e=e.next;else break}while(e.polyIndex!=0);i!=null&&(i.previous=t,t.next=i)}}canBeEnd(e,t){if(e.size()==1){let i=e.getFirst().shape;if(i instanceof ue){if(t&&i.rx<=t)return!1}else if(i instanceof J&&t&&i.length()<=t)return!1}return!0}connectSides(){let e=new sf,t=new Kc(10);for(let s of this.finalSides)e.computeIfAbsent(s.start,Vj).push(s),t.add(s.start);let i=0,r=new ru,n=new Array;for(let s of this.finalSides)if(!r.contains(s)){let a=new ru,o=s.start,l=new Mo;l.add(s),r.add(s);let u=s.end;for(;l.size()>0;)if(this.isStart(o,u)&&this.canBeEnd(l,.01)){l.size()>1&&this.fillSideGroups(l,i++);break}else{let c=e.get(u),h=this.findNext(r,c);if(h==null&&(u=this.findNeigber(u,a,t,.01),u!==null&&(c=e.get(u),h=this.findNext(r,c))),h!=null)l.add(h),r.add(h),u=h.end;else if(u!=null?a.add(u):(n.length==0&&l.size()>1&&this.logger.warning3("unable to connect at %s",l.getLast()),n.push(l.removeLast())),l.size()>0)u=l.getLast().end;else break}}}fillSideGroups(e,t){let i=new Uj(t);iu(e,(r,n)=>(i.add(n),!0)),this.sideGroups[i.id]=i}isStart(e,t){return e.distance2(t)<=1e-4}findNext(e,t){if(t!=null){for(let i of t)if(!e.contains(i))return i}return null}fillResult(){let e=0,t=new sf;for(let r in this.sideGroups){let n=this.sideGroups[r];iu(n.sides,(s,a)=>(a.polyGrp!=-2&&t.put(a,a),!0))}let i=new ru;for(let r in this.sideGroups){let n=this.sideGroups[r];if(i.add(n)){let s=0,a=new Array;for(a.push(n);s<a.length;){let l=a[s],u=new Array;iu(l.others,(h,m)=>{let f=t.get(m);return f!=null&&u.push(f.finalGrp),!0}),Wj(u,Qi.sortAsc,0,u.length);let c=l.id;for(let h of u)if(h!=c&&h!=l.id){let m=this.sideGroups[h];i.add(m)&&a.push(m),c=h}s++}let o=new Array;for(let l of a)o.push(l.polyline());zj(o,Gp.sortByBBoxAreaDesc,0,o.length),this.event.onPolylineGroup(new o0(o),e++)}}}findNeigber(e,t,i,r){let n=r*r,s=Number.MAX_VALUE,a=null;for(let o of i.search(e.bbox().extendOfSize(r)))if(!t.contains(o)){let l=e.distance2(o);l<s&&(s=l,a=o)}return s<n?a:null}},Xj=class{constructor(){this.points=[],this.lines=[],this.arcs=[],this.beziers=[],this.listText=[],this.fonts=[]}addPt(e,t=!0){if(e instanceof J)this.lines.push(e);else if(e instanceof ue)this.arcs.push(e);else if(e instanceof Te)this.beziers.push(e);else throw new Error("not support");t&&this.points.push(e.start())}addPoint(e){this.points.push(e)}addText(e,t,i=1,r=.1,n=!0){this.listText.push({pos:e,str:t,size:i,width:r}),n&&this.points.push(e)}addPly(e,t=!0){e.primitives.forEach(i=>this.addPt(i,t))}build(){let e=[],t=[],i=[],r=[],n=[],s=[];return this.points.forEach(a=>e.push(a.x,a.y)),this.lines.forEach(a=>t.push(a.start().x,a.start().y,a.end().x,a.end().y)),this.arcs.forEach(a=>i.push(a.center.x,a.center.y,a.rx,Ye.toRadians(a.startAngle),Ye.toRadians(a.endAngle()),a.sweep())),this.beziers.forEach(a=>{a.controls.forEach(o=>{r.push(o.x,o.y)}),r.push("end")}),this.listText.forEach(a=>n.push(a.pos.x,a.pos.y,a.str,a.width,a.size)),this.fonts.forEach(a=>s.push(a)),{points:e,lines:t,arcs:i,texts:n,beziers:r,fonts:s}}},Ya,ld=(Ya=class{constructor(t){this.map=new sf,this.bus=t}initColor(t){return this.map.computeIfAbsent(t,()=>new Xj)}draw(){let t={},i=this.map.entries();for(;i.hasNext();){let r=i.next();t[r.key.toString()]=r.value.build()}this.bus.publish("/debug/draw",t)}clear(){this.map.clear()}static init(t){if(!t)throw new Error("bus is undefined!");this.palette=new Ya(t)}static initPalette(t){this.palette=t}static getDefaultColor(){for(let t of this.colorBuffersMap)if(t[0]!==null&&t[0])return t[0]=!1,t[1];return this.colorBuffersMap.forEach(t=>{if(t[0]===null){console.log(1);return}t[0]=!0}),this.getDefaultColor()}static clear(){this.palette.clear()}static auto(t,i=this.getDefaultColor()){if(Array.isArray(t))t.forEach(r=>{this.auto(r,i)});else if(t instanceof ie)this.point(t,i);else if(t instanceof Zi)this.bbox(t,i);else if(t instanceof ad)this.primitive(t,i);else if(t instanceof et)this.polyline(t,i);else if(t instanceof mi)this.polygon(t,i);else if(t instanceof Qt)this.group(t,i);else if(t instanceof o0)this.auto(t.items,i);else{debugger;throw new Error("No incoming type!")}}static text(t,i,r=.5,n=this.getDefaultColor()){if(!this.palette)throw new Error("palette  is not initialised!");this.palette.initColor(n).addText(t,i,r,r/10),this.palette.draw()}static point(t,i=this.getDefaultColor()){if(!this.palette)throw new Error("palette  is not initialised!");let r=this.palette.initColor(i);Array.isArray(t)?t.forEach(n=>{this.point(n,i)}):r.addPoint(t),this.palette.draw()}static bbox(t,i=this.getDefaultColor()){Array.isArray(t)?t.forEach(r=>{this.bbox(r,i)}):(this.primitive(new J(new ie(t.maxX,t.maxY),new ie(t.maxX,t.minY)),i),this.primitive(new J(new ie(t.maxX,t.maxY),new ie(t.minX,t.maxY)),i),this.primitive(new J(new ie(t.minX,t.minY),new ie(t.maxX,t.minY)),i),this.primitive(new J(new ie(t.minX,t.minY),new ie(t.minX,t.maxY)),i))}static primitive(t,i=this.getDefaultColor()){if(!this.palette)throw new Error("palette  is not initialised!");let r=this.palette.initColor(i);Array.isArray(t)?t.forEach(n=>{this.primitive(n,i)}):r.addPt(t),this.palette.draw()}static polyline(t,i=this.getDefaultColor()){Array.isArray(t)?t.forEach(r=>{this.polyline(r,i)}):t.primitives.forEach(r=>{this.primitive(r,i)})}static polygon(t,i=this.getDefaultColor()){Array.isArray(t)?t.forEach(r=>{this.polygon(r,i)}):t.items.forEach(r=>{this.polyline(r,i)})}static group(t,i=this.getDefaultColor()){Array.isArray(t)?t.forEach(r=>{this.group(r,i)}):t.items.forEach(r=>{this.polygon(r,i)})}static async begin(){this.t1=performance.now()}static async end(t){console.log(t||"t1:",performance.now()-this.t1)}static async log(t){console.log(t||"==================")}},Ya.colorBuffersMap=[[!0,gt.BLUE],[!0,gt.GREEN],[!0,gt.WHITE],[!0,gt.RED],[!0,gt.Golden],[!0,gt.Gray]],Ya.t1=0,Ya),Jj=0,ud=class Nb{constructor(t,i){this.inters=[],this.shape=t,this.start=t.start(),this.end=t.end(),this.judgeOverlapMap=new Map,i&&(this.id=Jj++)}reverse(){this.shape=this.shape.reverse();let t=this.start;this.start=this.end,this.end=t}getCenterPoint(t=this.end){let{x:i,y:r}=this.start,{x:n,y:s}=t;if(this.shape instanceof ue){let a=this.shape.rx,o=new ie((i+n)/2,(r+s)/2),l=this.shape.center,u;return o.x!==l.x||o.y!==l.y?(u=o.angle(l),Math.abs(this.shape.sweepAngle)>180&&(u+=u>=0?-180:180)):u=(this.shape.startAngle+this.shape.endAngle())/2,new ie(l.x+Math.cos(u)*a,l.y+Math.sin(u)*a)}else{if(this.shape instanceof J)return new ie((i+n)/2,(r+s)/2);if(this.shape instanceof Te){let a=this.shape.getPercent(t,ke);return Te.pointOn(a/2,this.shape.controls)}else throw Error("not support")}}static finalAngle(t,i,r){let n=t.cross(i)>0,s=Math.acos(Math.min(1,Math.max(-1,t.dot(i)/i.length())));return(r?!n:n)&&(s=Sf-s),s}sortInters(){if(this.shape instanceof ue){let t=this.shape.center,i=this.shape.start().sub(t).normalize(),r=this.shape.isCCW;this.inters.sort((n,s)=>{let a=n.coord.sub(t),o=s.coord.sub(t);return Nb.finalAngle(i,a,r)-Nb.finalAngle(i,o,r)<=0?-1:1})}else if(this.shape instanceof J){let t=this.start,i=this.end,r=new ie(i.x+(t.x-i.x)*2,i.y+(t.y-i.y)*2);this.inters.sort((n,s)=>n.coord.distance2(r)-s.coord.distance2(r)<=0?-1:1)}else if(this.shape instanceof Te){let t=this.shape;this.inters.sort((i,r)=>t.getPercent(i.coord,ke)-t.getPercent(r.coord,ke)<=0?-1:1)}else throw Error("not support the primitive type");this.inters.forEach((t,i)=>t.setIndex(i))}getStart(){return this.start}getEnd(){return this.end}getShape(){return this.shape}connect(t){this.nextSide=t,t.prevSide=this}static returnPolygonList(t){let i=[];return t.forEach(r=>{let n=[];r.forEach((s,a)=>{let o=[];s.forEach(l=>{o.push(l.shape)}),n.push(et.build7(o))}),i.push(new mi(n))}),i}addInter(t){this.inters.push(t)}static returnPolygonGroup(t){let i=[];return t.forEach(r=>{let n=[];r.forEach((s,a)=>{let o=[];s.forEach(l=>{o.push(l.shape)}),n.push(et.build7(o))}),i.push(new mi(n))}),new Qt(i)}static rebuild(t,i,r){let n;if(t instanceof J||i.distance2(r)<1e-6)n=new J(i,r);else if(t instanceof ue)n=ue.build2(t.center,i.angleD(t.center),r.angleD(t.center),t.rx,t.ry,t.isCCW?1:0);else if(t instanceof Te){let s=t.getPercent(i,ke),a=t.clip(s)[1];n=a.clip(a.getPercent(r,ke))[0]}else throw new Error("not supported operation");return Me(t,i).dot(Me(n,i))<0?null:n}static returnPolyline(t){return et.build7(t.map(i=>i.shape))}bbox(){return this.shape.bbox()}},$j=(e=>(e[e.END1=0]="END1",e[e.END2=1]="END2",e[e.END12=2]="END12",e[e.LEFT1=3]="LEFT1",e[e.LEFT2=4]="LEFT2",e))($j||{});function er(e,t,i){if(e instanceof ue&&t instanceof ue)return Qj(e,t);if(e instanceof ue&&t instanceof J)return UC(e,t);if(e instanceof J&&t instanceof ue)return FC(e,t);if(e instanceof J&&t instanceof J)return Uo(e,t);if(e instanceof Te&&t instanceof J)return e.controls.length===2||ra(e)?Uo(new J(e.start(),e.end()),t):Yx(e,t);if(e instanceof J&&t instanceof Te)return t.controls.length===2||ra(t)?Uo(e,new J(t.start(),t.end())):Db(e,t);if(e instanceof ue&&t instanceof Te)return t.controls.length===2||ra(t)?UC(e,new J(t.start(),t.end())):Kj(e,t);if(e instanceof Te&&t instanceof ue)return e.controls.length===2||ra(e)?FC(new J(e.start(),e.end()),t):Zj(e,t);if(e instanceof Te&&t instanceof Te)return l0(e,t);throw new Error("not support")}function jl(e,t){return Me(e,t.start()).dot(Me(t,t.start()))<=0?!1:er(e,t).state<=2}function cb(e,t){let i=t.getPercent(e.end(),ke);if(i===null)return!1;if(i===0)return!0;let r=t.clip(i)[0],n=e.buildConverxHull(ke),s=r.buildConverxHull(ke),a=u(n),o=u(s);return l(a,o);function l(c,h){let m=new Map([[0,1],[1,0],[2,2],[3,4],[4,3]]),f=c[0],g=h[0];if(!f||!g)throw Error("isAllOverlap(sides1: PackSide[], sides2: PackSide[])");let y=!0;do{let b=f.getShape(),E=g.getShape();if(b instanceof J&&E instanceof J){let S=y?Uo(b,E).state:m.get(Uo(E,b).state);if(S===0)f=f.nextSide,y=!1;else if(S===1)g=g.nextSide,y=!0;else if(S===2)f=f.nextSide,g=g.nextSide,y=!0;else return!1}else throw Error("not support")}while(f!==c[0].prevSide&&g!==h[0].prevSide);return!0}function u(c){let h=c.primitives.map(f=>new ud(f)),m=h[h.length-1];return h.forEach(f=>{m.connect(f),m=f}),h}}function kC(e,t){let i=e.end().distance2(t.center);if(i>(t.rx+ke)**2||i<(t.rx-ke)**2||!(Ne(e.end(),t.end())||u0(t,e.end())))return!1;if(e.center.equals1(t.center))return!0;let r=e.center.distance1(t.center),n=Math.abs(e.rx-t.rx);if(r>Math.min(e.rx,t.rx)){let s=e.center.angleD(t.center);return e.rx>t.rx?!(r+n>ke&&ys(e,s))&&!(r-n>ke&&e.rx+t.rx-r>ke&&ys(e,s+180)):!(r-n>ke&&ys(e,s))&&!(e.rx+t.rx-r>ke&&ys(e,s+180))}else{if(r+n<=ke)return!0;let s=e.rx>t.rx?e.center.angleD(t.center):t.center.angleD(e.center);return ys(e,s)?!1:r-n<=ke?!0:!ys(e,s+180)}}function Kj(e,t){let i=c0(e,t.start()).toBezier2(),r,n=0;for(let s=i.length;n<s;n++){let a=i[n];if(r=l0(a,t).state,r!==0)break}return r===2&&n!==i.length-1?{state:1}:{state:r}}function Zj(e,t){let i=t.toBezier2(),r,n=0;for(let s=i.length;n<s;n++){let a=i[n];if(r=l0(e,a).state,r!==1)break}return r===2&&n!==i.length-1?{state:0}:{state:r}}function l0(e,t){if(e.controls.length===2||ra(e))return t.controls.length===2||ra(t)?Uo(new J(e.start(),t.end()),new J(t.start(),t.end())):Db(new J(t.start(),e.end()),t);if(t.controls.length===2||ra(t))return Yx(Bb(e,t.start()),new J(t.start(),t.end()));let i=Bb(e,t.start());if(ra(i))return Db(new J(t.start(),e.end()),t);let r=cb(i,t),n=cb(t,i);if(!r&&!n){let s=fj(i,t);if(s.havOverlap){let a=s.havOverlap!==2,o=s.havOverlap!==1;return la(e,t,a,o)}else{let a=function(){for(let h=0;h<u;h+=2)Y[h]=c[h],Y[h+1]=c[h+1]},o,l,u=s.cnt,c=new Array(u).fill(0).map((h,m)=>Y[m]);for(let h=0;h<u;h+=2){let m=new ie(Y[h],Y[h+1]),f=i.getPercent(m,ke),g=t.getPercent(m,ke);if(f===0||g===0)continue;let y=f===1?i:i.clip(f)[0],b=g===1?t:t.clip(g)[0];if(cb(y,b)){let E=Me(e,m).cross(Me(t,m));if(E===0){o=i.end(),l=t.end();break}return{state:E<0?3:4}}a()}return(!o||!l)&&(o=Zl(i.controls,i.controls[0],t),l=Zl(t.controls,i.controls[0],i)),{state:o.sub(i.controls[0]).cross(l.sub(i.controls[0]))>0?4:3}}}return la(e,t,r,n)}function Yx(e,t){let i=Bb(e,t.start());if(ra(i))return Uo(new J(i.start(),i.end()),t);let r=Wx(i,t),{isIn:n,bezierIsInLeft:s}=Gx(t,i);if(!r&&!n){if(s!==void 0)return{state:s?3:4};let a=null,o=e.getPercent(t.start(),ke)+.01;for(let l=o>1?1:o;l<=1;){let u=Te.pointOn(l,e.controls);if(Zc(t,u)>tr){a=u;break}l+=.01,l>1&&(l=1)}if(!a)throw Error("!end1 && !end2 not result");return{state:t.direct.cross(a.sub(t.start()))<0?4:3}}return la(i,t,r,n)}function Db(e,t){let{isIn:i,bezierIsInLeft:r}=Gx(e,t),n=Wx(t,e);if(!i&&!n){if(r!==void 0)return{state:r?4:3};let s=null;for(let a=.01;a<=1;){let o=Te.pointOn(a,t.controls);if(Zc(e,o)>tr){s=o;break}a+=.01,a>1&&(a=1)}if(!s)throw Error("!end1 && !end2 not result");return{state:e.direct.cross(s.sub(e.start()))<0?3:4}}return la(t,e,i,n)}function Qj(e,t){let i=kC(c0(e,t.start()),t),r=kC(t,e);if(!i&&!r){let n=qn(t);if(e.center.sub(t.start()).dot(t.center.sub(t.start()))>0){if(e.rx===t.rx)return e.isCCW?{state:n.dot(e.center.sub(t.center))<0?3:4,exitIsInvalid:!1}:{state:n.dot(e.center.sub(t.center))>0?3:4,exitIsInvalid:!1};let s,a;return e.rx>t.rx?(s=e,a=t):(s=t,a=e),n.dot(a.center.sub(s.center))>0&&a.rx+a.center.distance1(s.center)-s.rx>ke?e.isCCW?{state:e.rx>t.rx?3:4,exitIsInvalid:!1}:{state:e.rx<t.rx?3:4,exitIsInvalid:!1}:e.isCCW?{state:e.rx<t.rx?3:4,exitIsInvalid:!0}:{state:e.rx>t.rx?3:4,exitIsInvalid:!0}}else return e.rx+t.rx-e.center.distance1(t.center)>ke&&n.dot(e.center.sub(t.center))>0?{state:t.isCCW?3:4,exitIsInvalid:!1}:{state:e.isCCW?3:4,exitIsInvalid:!0}}return la(e,t,i,r)}function FC(e,t){let i=Vn.foot(e,t.center),r=e.end().distance2(t.center),n=e.end().sub(e.start()),s=(t.rx-ke)**2,a=r<=(t.rx+ke)**2&&r>=s&&(n.dot(i.sub(t.start()))<=0||e.start().distance2(e.end())<=e.start().distance2(i)||i.distance2(t.center)>=s)&&(Ne(e.end(),t.end())||u0(t,e.end())),o=zx(t,e);if(!a&&!o){let l=e.distance2(t.center);return l<=tr?{state:n.cross(qn(t))>0?4:3}:n.dot(i.sub(t.start()))>=0&&(r<s||e.start().distance2(t.center)<s||l<s)?{state:n.cross(t.center.sub(e.start()))<0?4:3}:{state:n.cross(t.center.sub(e.start()))>0?4:3}}return la(t,e,a,o)}function ys(e,t){return t=Ye.regularD(t),e.sweepAngle>0?(t<e.startAngle&&(t+=360),e.endAngle()>t):(t>e.startAngle&&(t-=360),e.endAngle()<t)}function u0(e,t){return Ne(e.end(),t)||Ne(e.start(),t)||ys(e,t.angleD(e.center))}function Gx(e,t){let i=e.panDistance(ke),r=e.panDistance(-ke),n=HC(t,i),s=HC(t,r);if(!n.length&&!s.length)return{isIn:t.getPercent(e.end(),ke)!==null};let a=[...n,...s].sort((c,h)=>c.t-h.t),o=new J(r.start(),i.start()),l=[];for(let c=0,h=a.length;c<h;c++){let m=a[c];if(l.push(m),o.distance(m.interP)>e.length()+ke)break;if(l.length===2){let f=(l[1].t*10+l.shift().t*10)/20,g=Te.pointOn(f,t.controls);if(e.distance2(g)>tr)return{isIn:!1,bezierIsInLeft:e.direct.cross(g.sub(e.start()))>0}}}let u=l.length?o.distance(l[0].interP)>=e.length()+ke:!0;return{isIn:u,bezierIsInLeft:u?void 0:e.direct.cross(l[0].interP.sub(e.start()))>0}}function Wx(e,t){if(Zc(t,e.end())>tr||e.getToLineMaxDis2(t)>tr)return!1;let i=tY(t,tr);return e.getToLineMaxDis2(i)<=(t.length()+ke)**2}function zx(e,t){let i=t.end().angleD(t.start()),r=eY(t,e.end());if(r>tr)return!1;if(ys(e,i+90)){if(Vn.foot(t,e.center).distance1(e.pointOn(i+90))>e.rx)return!1;r=Math.max(r,(e.rx-t.distance(e.center))**2)}if(ys(e,i-90)){if(Vn.foot(t,e.center).distance1(e.pointOn(i-90))>e.rx)return!1;r=Math.max(r,(e.rx-t.distance(e.center))**2)}return r<=tr&&(Ne(e.end(),t.end())||Ob(t,e.end()))}var Vx=(ke*2)**2;function c0(e,t){if(Ne(e.end(),t))return ue.build3(e.center,e.endAngle(),0,e.rx,e.ry);if(e.start().distance2(t)<Vx)return e;let i=Ye.regularD(t.angleD(e.center));if(!ys(e,i))throw new Error("!angleIsInArc(arc, angle)");return ue.build2(e.center,i,e.endAngle(),e.rx,e.ry,e.isCCW?1:0)}function Bb(e,t){if(Ne(e.end(),t))return new Te([t,t]);if(e.start().distance2(t)<Vx)return e;let i=e.getPercent(t,ke);if(i===null)throw new Error("!cutBezier(bezier: Bezier, p: Vector2)");return e.clip(i)[1]}function UC(e,t){let i=zx(c0(e,t.start()),t),r=t.end().distance2(e.center),n=t.end().sub(t.start()),s=Vn.foot(t,e.center),a=(e.rx-ke)**2,o=r<=(e.rx+ke)**2&&r>=a&&(n.dot(s.sub(t.start()))<=0||t.start().distance2(t.end())<=t.start().distance2(s)||s.distance2(e.center)>=a)&&(Ne(e.end(),t.end())||u0(e,t.end()));if(!i&&!o){let l=t.distance2(e.center);return l<=tr?{state:n.cross(qn(e,t.start().angle(e.center)))>0?3:4}:n.dot(s.sub(t.start()))>=0&&(r<a||t.start().distance2(e.center)<a||l<a)?{state:n.cross(e.center.sub(t.start()))>0?4:3}:{state:n.cross(e.center.sub(t.start()))<0?4:3}}return la(t,e,i,o)}function Uo(e,t){if(Ne(e.end(),t.end()))return la(e,t,!0,!0);let i=Zc(t,e.end())<=tr&&Ob(t,e.end()),r=Zc(e,t.end())<=tr&&Ob(e,t.end());if(!i&&!r){let n=e.direct.x===0&&e.direct.y===0,s=t.direct.x===0&&t.direct.y===0;if(n&&s)throw Error("2LineAllIsPoint");return n?{state:t.direct.cross(e.end().sub(t.start()))>0?3:4}:{state:e.end().sub(e.start()).cross(t.end().sub(e.start()))>0?4:3}}return la(e,t,i,r)}function Ob(e,t){return Vn.foot(e,t).distance2(e.start())<e.end().distance2(e.start())}function la(e,t,i,r){if(i)return r?Ne(e.end(),t.end())?{state:2}:{state:0}:{state:0};if(r)return{state:1};throw new Error("!end1 && !end2")}function Zc(e,t){return(e.a*t.x+e.b*t.y+e.c)**2/(e.a**2+e.b**2)}function eY(e,t){return Math.min(e.distance2(t),Vn.foot(e,t).distance2(t))}function tY(e,t){let i=e.panDistance(t),r=e.panDistance(-t);return new J(r.start(),i.start())}function ra(e){let t=e.start(),i=e.end();t.equals1(i)&&(i=t.add1(1,0));let r=i.y-t.y,n=t.x-i.x,s=-r*t.x-n*t.y,a=Math.sqrt(1/(r**2+n**2));r*=a,n*=a,s*=a;let o=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;return e.controls.forEach(u=>{let c=r*u.x+n*u.y+s;c<o&&(o=c),c>l&&(l=c)}),Is(o,l)}function HC(e,t){let i=vn(e,t),r=[],n=new Array(i).fill(0).map((a,o)=>Y[o]);for(let a=0;a<i;a+=2){let o=new ie(Y[a],Y[a+1]),l=e.getPercent(o);r.push({interP:o,t:l}),s()}function s(){for(let a=0;a<i;a+=2)Y[a]=n[a],Y[a+1]=n[a+1]}return r}var ms=.01,iY=270;function za(e){let t=ms**2,i=e.end(),r=[],n=[];for(let f=0,g=e.primitives.length;f<g;f++){let y=function(H,k){return H instanceof J&&k instanceof J&&Math.abs(H.direct.cross(k.direct))<de.eps&&H.direct.dot(k.direct)>0||H instanceof ue&&k instanceof ue&&Math.abs(H.rx-k.rx)<=de.eps&&H.center.distance2(k.center)<de.eps&&H.isCCW===k.isCCW},b=function(H){if($r(H,ms))n.push(null);else{if(H instanceof J)n.push(H);else if(H instanceof ue&&H.rx===H.ry)h(H,n);else if(H instanceof Te){let k=[];Bx(H,k),k.forEach(ee=>{let q=ee.start(),Q=ee.end();c(q,Q)||n.push(ee)})}else throw new Error("not support!");i=A}},E=function(H){if(H instanceof J)return H.direct.x===0&&H.direct.y===0;if(H instanceof ue)return H.sweepAngle===0;if(H instanceof Te){let k=new Set(H.controls.map(q=>q.x)),ee=new Set(H.controls.map(q=>q.y));return k.size===1&&ee.size===1}else throw new Error("not support")},S=e.primitives[f],v=S.start(),A=S.end();if(E(S))continue;c(i,v)||(n.push(new J(i,v)),i=v);let x=(f+1)%g,T=e.primitives[x];for(;y(S,T)&&(x=(x+1)%g,T=e.primitives[x],T!==S););if(x===(f+1)%g){b(S);continue}if(T===S){if(!(S instanceof ue)){if(Math.abs(e.area(.1))<t)return null;throw new Error("simplifyPolyline not support")}let H=S instanceof ue?S.isCCW:e.area(.1)>0;n.length=0;let k=H?180:-180;n.push(ue.build3(S.center,S.startAngle,k,S.rx,S.ry),ue.build3(S.center,S.startAngle+k,k,S.rx,S.ry));break}let R=(()=>{if(S instanceof J)return(H,k)=>{let ee=new J(H,k);return $r(ee,ms)?null:[ee]};if(S instanceof ue)return(H,k)=>{let ee;if(H.equals1(k)?ee=ue.build3(S.center,S.startAngle,S.sweep()===1?360:-360,S.rx,S.ry):ee=ue.build4(H,k,S.center,S.rx,S.ry,S.sweep()),$r(ee,ms))return null;let q=ee.pointOn(ee.startAngle+ee.sweepAngle/2),Q=ue.build4(ee.start(),q,S.center,S.rx,S.ry,S.sweep()),ne=ue.build4(q,ee.end(),S.center,S.rx,S.ry,S.sweep());return $r(Q,ms)||$r(ne,ms)?[ee]:[Q,ne]};throw new Error("not support")})(),L=x===0;if(x<f&&!L&&(L=!R(e.primitives[0].start(),e.primitives[x-1].end()),!L)){let H=R(S.start(),e.primitives[g-1].end());if(H)n.push(...H);else{let k=R(S.start(),n[0].end());if(k.length===1)n[0]=k[0];else if(k.length===2)n[0]=k[1],n.push(k[0]);else throw new Error("!!!generatorPt")}break}f=x===0?g-1:x-1,T=e.primitives[f];let O=R(S.start(),T.end());if(O?(O.forEach(H=>n.push(H)),i=T.end()):b(null),L)break}let s=n.length;if(n.forEach((f,g)=>{if(f)r.push(f);else{let y,b;g===s-1&&(y=r[0],b=r[r.length-1]);let E=(g+1)%s;if(y=y!=null?y:n[E],y){let S=g,v=!1;for(;b=b!=null?b:n[(--S+s)%s],b!==y;)if(b){v=!0;break}if(v){if(y.start().equals1(b.end()))return;if(Me(b,b.end()).dot(Me(y,y.start()))<0){if(!c(b.end(),y.start())){let R=new J(b.end(),y.start());r.push(R);return}let{rebuildPrevPt:A,rebuildNextPt:x,rebuildLinkLine:T}=jC(n[(S-1+s)%s],b,new J(b.end(),y.start()),y,n[(g+2)%s]);A&&x&&(A!==b?(n[(S+s)%s]=A,r[r.length-1]&&(r[r.length-1]=A)):x!==y&&(n[(g+1)%s]=x,r[0]===y&&(r[0]=x)),T&&r.push(T))}}}}}),r.length===0)return null;c(i,r[0].start())||r.push(new J(i,r[0].start()));let a=r[r.length-1];if(r.length===1)return a instanceof ue?et.build7([ue.build2(a.center,0,180,a.rx,a.ry,a.sweep()),ue.build2(a.center,180,360,a.rx,a.ry,a.sweep())]):a instanceof Te?et.build7(a.clip(.5)):null;let o=r.map(f=>new rY(f)),l=o[o.length-1];for(o.forEach(f=>{f.connect(l),l=f});!l.isVisited;){let f=function(){l.next.connect(y),l=l.next,l.isConnected=!1,l.isVisited=!1},g=function(){l.connect(y.prev),l.isConnected=!1},y=l.prev;if(l===y)break;let b=l.pt,E=y.pt,S=E.end();if(!l.isConnected&&!S.equals(b.start())){let v=function(x){l.isConnected=!0,l.pt=b=x,l.next.isVisited=!1},A=function(x){l.isConnected=!0,y.pt=x,y.isVisited=!1,l=y};if(b instanceof J)if(c(S,b.end())){f();continue}else v(new J(S,b.end()));else if(E instanceof J){c(E.start(),b.start())?g():A(new J(E.start(),b.start()));continue}else if(b instanceof Te)if(c(S,b.end())&&!(b.controls.length!==2&&b.getToLineMaxDis2(b.startToEndL)>=t)){f();continue}else v(new Te([S,...b.controls.slice(1)]));else if(E instanceof Te)c(E.start(),b.start())&&!(E.controls.length!==2&&E.getToLineMaxDis2(E.startToEndL)>=t)?g():A(new Te([...E.controls.slice(0,-1),b.start()]));else if(b instanceof ue&&E instanceof ue)if(Math.abs(Math.abs(b.sweepAngle)-180)<Math.abs(Math.abs(E.sweepAngle)-180)){let x=ue.build5(S,b.end(),b.sweepAngle);if(c(x.start(),x.end())&&!(x.rx>=ms&&Math.abs(x.sweepAngle)>180)){f();continue}else v(x)}else{let x=ue.build5(E.start(),b.start(),E.sweepAngle);c(x.start(),x.end())&&!(x.rx>=ms&&Math.abs(x.sweepAngle)>180)?g():A(x);continue}else throw new Error("not support")}if(Me(b,b.start()).dot(Me(E,E.end()))<0){let v=function(T,R,L,O,H,k){if(l.next===y){l=null;return}let{rebuildLinkLine:ee,rebuildPrevPt:q,rebuildNextPt:Q}=jC(T,R,L,O,H);q&&Q&&(q!==R&&(y.prev.pt=q),Q!==O&&(l.next.pt=Q),ee?k.pt=ee:f())},A=function(){l.next===y?l=null:(l.next.connect(y.prev),l=l.next,l.isConnected=!1,l.isVisited=!1)},x=er(E.reverse(),b).state;if(x===0){let T=YC(b,E.start(),b.end());if(m(T)){let R=y.prev.pt,L=l.next.pt;if(Me(L,L.start()).dot(Me(R,R.end()))>=0){if(A(),!l)break;continue}if(v(y.prev.prev.pt,R,T instanceof J?T:new J(T.start(),T.end()),L,l.next.next.pt,l),!l)break}else l.pt=T;g();continue}else if(x===1){let T=YC(E,E.start(),b.end());if(m(T)){let R=y.prev.pt,L=l.next.pt;if(Me(L,L.start()).dot(Me(R,R.end()))>=0){if(A(),!l)break;continue}if(v(y.prev.prev.pt,R,T instanceof J?T:new J(T.start(),T.end()),L,l.next.next.pt,y),!l)break}else y.pt=T;f();continue}else if(x===2){if(A(),!l)break;continue}}l.isVisited=!0,l=l.next}if(!l)return null;r.length=0;let u=l;for(r.push(l.pt),l=l.next;l!==u;)r.push(l.pt),l=l.next;if(r.length===1){let f=r[0];return f instanceof ue?(c(f.start(),f.end())?r[0]=ue.buildCircle(f.center,f.rx,f.sweep()):r.push(new J(f.end(),f.start())),et.build7(r)):f instanceof Te?(c(f.start(),f.end())||r.push(new J(f.end(),f.start())),et.build7(r)):null}if(e=et.build7(r),Math.abs(e.area(.1))<t)return null;return e;function c(f,g){return f.distance2(g)<t}function h(f,g){if(Math.abs(f.sweepAngle)>iY){let y=f.sweepAngle/2;h(ue.build3(f.center,f.startAngle,y,f.rx,f.ry),g),h(ue.build3(f.center,f.startAngle+y,y,f.rx,f.ry),g)}else g.push(f)}function m(f){return f.start().distance2(f.end())<t&&!(f instanceof ue&&f.rx>=ms&&Math.abs(f.sweepAngle)>180||f instanceof Te&&f.controls.length!==2&&f.getToLineMaxDis2(new J(f.start().add1(1,0),f.end()))>=t)}}function $r(e,t){if(!e)return!0;let i=e.start(),r=e.end();if(i.distance2(r)<t**2)if(e instanceof ue){if(!(e.rx>=t&&Math.abs(e.sweepAngle)>180))return!0}else if(e instanceof Te){if(!(e.controls.length!==2&&e.getToLineMaxDis2(new J(e.start().add1(1,0),e.end()))>=t))return!0}else return!0;return!1}function Yl(e){if(e.direct.x===0&&e.direct.y===0)throw Error("getEndOfExtendLine(line: Line, distance: number)");let t=Math.abs(ms-e.length())+de.eps,i={x:e.direct.normalize().x*t,y:e.direct.normalize().y*t},r=e.end();return new ie(r.x+i.x,r.y+i.y)}function jC(e,t,i,r,n){if(!e)a();else if(!n)o();else{let l=Me(e,e.end()),u=Me(t,e.end()),c=l.dot(u);if(c>=0)a();else{let h=Me(r,r.end()),m=Me(n,r.end()),f=h.dot(m);if(f>=0)o();else if(Is(c,-1)&&Is(f,-1)){let g=i.center();s(g),i=null}else c>f?a():o()}}function s(l){let u;if(t instanceof J)u=new J(t.start(),l);else if(t instanceof Te)u=new Te([...t.controls.slice(0,-1),l]);else if(t instanceof ue)u=ue.build5(t.start(),l,t.sweepAngle);else throw new Error("not supported");t=$r(u,ke)?null:u;let c;if(r instanceof J)c=new J(l,r.end());else if(r instanceof Te)c=new Te([l,...r.controls.slice(1)]);else if(r instanceof ue)c=ue.build5(l,r.end(),r.sweepAngle);else throw new Error("supported");r=$r(c,ke)?null:c}function a(){if(t instanceof J){let l=Yl(i.reverse());i=new J(l,i.end());let u=new J(t.start(),l);t=$r(u,ke)?null:u}else if(t instanceof Te){let l=Yl(i.reverse());i=new J(l,i.end());let u=new Te([...t.controls.slice(0,-1),l]);t=$r(u,ke)?null:u}else if(t instanceof ue){let l=Yl(i.reverse());i=new J(l,i.end());let u=ue.build5(t.start(),l,t.sweepAngle);t=$r(u,ke)?null:u}else throw new Error("not supported")}function o(){if(r instanceof J){let l=Yl(i);i=new J(i.start(),l);let u=new J(l,r.end());r=$r(u,ke)?null:u}else if(r instanceof Te){let l=Yl(i);i=new J(i.start(),l);let u=new Te([l,...r.controls.slice(1)]);r=$r(u,ke)?null:u}else if(r instanceof ue){let l=Yl(i);i=new J(i.start(),l);let u=ue.build5(l,r.end(),r.sweepAngle);r=$r(u,ke)?null:u}else throw new Error("not supported")}return{rebuildPrevPt:t,rebuildNextPt:r,rebuildLinkLine:i}}function YC(e,t,i){if(e instanceof J||t.distance2(i)<=tr)return new J(t,i);if(e instanceof ue)return ue.build2(e.center,t.angleD(e.center),i.angleD(e.center),e.rx,e.ry,e.isCCW?1:0);if(e instanceof Te){let r=e.getPercent(t,ke),n=e.getPercent(i,ke);return e.clip(r)[1].clip((n-r)/(1-r))[0]}else throw new Error("not supported operation")}var rY=class{constructor(e){this.pt=e}connect(e){this.prev=e,e.next=this}};function of(e){let t=cd(),i;if(e instanceof et){let r=za(e);if(r===null)return null;i=r}else if(e instanceof mi){let r=e.items.map(n=>of(n)).filter(n=>n!==null);if(r.length===0)return null;i=new mi(r)}else{let r=e.items.map(n=>of(n)).filter(n=>n!==null);if(r.length===0)return null;i=new Qt(r)}return Es.preprocessPolyline+=Ua(t),i}var Es={addDocShapes2RTree:0,getPour:0,prepare:0,getSinglePourLayerPolyline:0,combindOutlines:0,mergeSameNet:0,run:0,end:0,deSelfIntersection:0,changeDirect:0,extend:0,preprocessPolyline:0,runBoolean:0,IntersectionSeeker:0,BooleanTools:0,totalBool:0};function cd(){return{timeIndex:Object.assign({},Es),start:performance.now()}}function GC(e){return Object.values(e).reduce((t,i)=>t+i,0)}function Ua(e){return performance.now()-e.start-(GC(Es)-GC(e.timeIndex))}function Ai(e,t,i,r){let n=gt.RED,s=gt.Golden;function a(){if(!r)return;let m=r.initColor(gt.Golden);m.addPt(o),m.addPoint(o.end()),r.initColor(gt.RED).addPt(l),r.draw();debugger}let o=e.getShape(),l=i?t.getShape():t.getShape().reverse(),u=Me(o,l.start()),c=Me(l),h=u.cross(c);if(Is(h,0))if(o instanceof J)if(l instanceof J){if(de.eq(h,0)&&(u.dot(c)>0?!Ne(o.end(),l.start()):!Ne(o.start(),l.start())))throw a(),new Error("line and line");return h<0}else{if(l instanceof ue)return u.cross(l.center.sub(o.start()))<0;if(l instanceof Te){let m=l.getExtremePoints(o),f=m.length?m[0]:Zl(l.controls,o.start());return u.cross(f.sub(o.start()))<0}else throw new Error("not support")}else if(o instanceof ue){if(l instanceof J)return o.isCCW;if(l instanceof ue){if(l.center.equals1(o.center)&&(u.dot(c)>0?!Ne(o.end(),l.start())&&o.end().sub(l.start()).dot(c)>0:!Ne(o.start(),l.start())&&o.start().sub(l.start()).dot(c)>0))throw a(),new Error("arc and arc");return l.rx>=o.rx||l.center.distance2(o.center)>o.rx2?o.isCCW:!o.isCCW}else throw new Error("not support")}else if(o instanceof Te)if(l instanceof J){let m=o.getPercent(l.start(),ke),f=o.clip(m)[1],g=f.getExtremePoints(l);return(g.length?g[0]:Zl(f.controls,l.start())).sub(l.start()).cross(c)<0}else if(l instanceof Te){let m=o.getPercent(l.start(),ke),f=o.clip(m)[1],g=f.getExtremePoints(new J(l.start(),l.end())),y=l.getExtremePoints(new J(f.start(),f.end())),b=g.length?g[0]:Zl(f.controls,l.start()),E=y.length?y[0]:Zl(l.controls,l.start()),S=b.sub(l.start()),v=E.sub(l.start());return S.cross(v)<0}else throw Error("not support");else throw new Error("not support");else return h<0}function zo(e,t,i,r,n){let s=e.getShape(),a=t.getShape(),o=s instanceof ue?qn(s,Ye.toRadians(s.endAngle())):s instanceof Te?$c(s,1):s.end().sub(s.start()).normalize(),l=Me(a),u=o.dot(l);if(Is(u,-1))return Ai(e,t,!0,n)?Ai(e,i,r,n)&&Ai(t,i,r,n):Ai(e,i,r,n)||Ai(t,i,r,n);{let c=o.scale(-1).angle(ie.ORIGIN),h=l.angle(ie.ORIGIN);c>h&&(c-=Sf);let m=(c+h)/2,f=new ie(Math.cos(m),Math.sin(m)),g=r?i.getShape():i.getShape().reverse(),y=Me(g);return f.cross(y)<0?Ai(e,i,r,n):Ai(t,i,r,n)}}function db(e,t,i,r,n){let s=e.getShape(),a=t.getShape(),o=s instanceof ue?qn(s,Ye.toRadians(s.endAngle())):s instanceof Te?$c(s,1):s.end().sub(s.start()).normalize(),l=Me(a),u=o.dot(l);if(Is(u,-1))return Ai(e,t,!0,n)?Ai(e,i,r,n)&&Ai(t,i,r,n):Ai(e,i,r,n)||Ai(t,i,r,n);{let c=o.scale(-1).angle(ie.ORIGIN),h=l.angle(ie.ORIGIN);c>h&&(c-=Sf);let m=(c+h)/2,f=new ie(Math.cos(m),Math.sin(m)),g=r?i.getShape():i.getShape().reverse(),y=Me(g);if(f.cross(y)<0){let b=o.dot(y)<0,E=er(b?e.getShape().reverse():e.getShape(),g).state;return E!==3&&E!==4?Ai(e,i,r,n):E===(b?4:3)}else{let b=l.dot(y)<0,E=er(b?t.getShape().reverse():t.getShape(),g).state;return E!==3&&E!==4?Ai(t,i,r,n):E===(b?4:3)}}}var nY=(e=>(e[e.NOT_IN=0]="NOT_IN",e[e.IS_IN=1]="IS_IN",e[e.IS_OVERLAP=2]="IS_OVERLAP",e))(nY||{}),sY=(e=>(e[e.AllClear=0]="AllClear",e[e.MapClear=1]="MapClear",e))(sY||{}),_s,ja=!1;function Kr(e,t,i,r,n,s,a,o=i.side===t,l=!0,u){return _s=n,ja=s,qx(Xx(e,t,l,u,a,i,o,r),i,o,r,0)}function ea(e,t,i,r,n,s,a,o=r.side===i){_s=n,ja=s;let l=Jx(e,t,i,new Map,r,o,a),u=l instanceof Array?-1:1;return qx(l,r,o,a,u)}function qx(e,t,i,r,n){for(;e instanceof Array;)n++,e.length===4?e=Jx(...e,t,i,r):e=Xx(...e,t,i,r);return{...e,existOverlap:n>0}}function Xx(e,t,i,r,n,s,a,o){if(lf===-1){o.initColor(gt.RED).addPt(e.getShape()),o.initColor(gt.Golden).addPt(t.getShape()),o.draw();debugger}let l=e.getShape(),u=a?t.getShape().reverse():t.getShape(),c=(l instanceof ue?qn(l,i?u.start().angle(l.center):r?Ye.toRadians(l.endAngle()):void 0):l instanceof Te?Me(l,i?u.start():r?l.end():l.start()):l.end().sub(l.start())).normalize(),h=(u instanceof ue?qn(u,i?void 0:(r?l.end():l.start()).angle(u.center)):u instanceof Te?Me(u,i?void 0:r?l.end():l.start()):u.end().sub(u.start())).normalize();if(r===void 0){let g=c.dot(h);if(r=g<0,Is(g,0))return{state:Ai(e,t,!a,o)?1:0,inter:ta(e,t,s,a,i,r,n)}}else if(r?c.dot(h)>0:c.dot(h)<0)if(i){let g,y=!0;if(l instanceof J&&Ne(Vn.foot(l,u.start()),r?l.end():l.start()))y=!1;else if(l instanceof ue||l instanceof Te){let b=r?l.reverse():l,E=er(u,bj(b,u.start()).reverse()).state;(E===1||E===2)&&(y=!1)}if(y){let b=!r;g=er(b?l.reverse():l,u,o).state===(b?4:3)?1:0}else r?g=zo(e,e.nextSide,t,!a,o)?1:0:g=zo(e.prevSide,e,t,!a,o)?1:0;return{state:g,inter:ta(e,t,s,a,i,r,n)}}else return r?{state:Ai(e,e.nextSide,!0,o)?0:1,inter:ta(e,t,s,a,i,r,n),isReversed:!0}:{state:Ai(e.prevSide,e,!0,o)?0:1,inter:ta(e,t,s,a,i,r,n),isReversed:!0};let m,f=new Map([[3,4],[4,3],[0,1],[1,0],[2,2]]);if(i)if(e.judgeOverlapMap.has(t)&&!ja){let g=e.judgeOverlapMap.get(t);m=r?f.get(g.state):g.state}else m=er(r?l.reverse():l,u).state,(m===3||m===4)&&e.judgeOverlapMap.set(t,{state:r?f.get(m):m});else{if(t.judgeOverlapMap.has(e)&&!ja){let g=t.judgeOverlapMap.get(e);m=a?f.get(g.state):g.state}else m=er(u,r?l.reverse():l).state,(m===3||m===4)&&t.judgeOverlapMap.set(e,{state:a?f.get(m):m});m=f.get(m)}if(m===1||m===2){let g=a?t.prevSide:t,y=g.inters,b=g.getEnd();for(let E=y.length-1;E>=0;E--){let S=y[E];if(!(g.getShape()instanceof Te)&&!Ne(b,S.coord))break;if(S===s)return{state:2,inter:ta(e,t,s,a,i,r,n)}}}if(m===3||m===4)return{state:m===(r?4:3)?1:0,inter:ta(e,t,s,a,i,r,n)};if(n.has(e)?n.get(e).mapSideList.push(t):n.set(e,{sideIsReversed:r,mapSideList:[t]}),n.has(t)?n.get(t).mapSideList.push(e):n.set(t,{sideIsReversed:a,mapSideList:[e]}),m===2)return r?[e.prevSide,e,a?t.prevSide:t.nextSide,n]:[e,e.nextSide,a?t.prevSide:t.nextSide,n];if(m===0)return[r?e.prevSide:e.nextSide,t,!1,r,n];if(m===1)return[e,a?t.prevSide:t.nextSide,!0,r,n];throw Error("not support")}function ta(e,t,i,r,n,s,a){if(ja)return null;let o=e.getShape(),l=r?t.getShape().reverse():t.getShape(),u=r;if(!n){let f=t;t=e,e=f,r=s,i=i.getBindedInter()}let c=f=>!(n?s:u)&&Ne(f,e.prevSide.getEnd())?e.prevSide:e;if(r){let f=t.inters;for(let g=0;g<f.length;g++){let y=f[g];if(y.isInvalid&&s===void 0)continue;if(y===i&&Ne(l.start(),i.coord))return n?y:y.getBindedInter();let b=y.getBindedInter().side,E=c(y.coord);if(b===E&&h(y))return m(y)}for(;;){t=t.nextSide;let g=t.inters;for(let y=0;y<g.length;y++){let b=g[y];if(b===i)return n?b:b.getBindedInter();if(a.has(t)){let E=b.getBindedInter().side;if(a.get(t).mapSideList.includes(E)||Ne(b.coord,E.getEnd())&&a.get(t).mapSideList.includes(E.nextSide))return m(b);if(a.has(E)){let S=t.getShape().reverse(),v=Me(S,b.coord).dot(Me(E.getShape(),b.coord))<0,A=v?E.getShape().reverse():E.getShape(),x=er(S,v?ab(A,b.coord,A.end()):ab(A,A.start(),b.coord)).state;if(x===1||x===2)return m(b)}else a.has(E.nextSide)}else if(b.side===i.side&&h(b))return m(b)}}}else{let f=t.inters;for(let g=f.length-1;g>=0;g--){let y=f[g];if(y.isInvalid&&s===void 0)continue;if(y===i&&Ne(l.start(),i.coord))return n?y:y.getBindedInter();let b=y.getBindedInter().side,E=c(y.coord);if(b===E&&h(y))return m(y)}for(;;){t=t.prevSide;let g=t.inters;for(let y=g.length-1;y>=0;y--){let b=g[y];if(b===i)return n?b:b.getBindedInter();if(a.has(t)){let E=b.getBindedInter().side;if(a.get(t).mapSideList.includes(E)||Ne(b.coord,b.getBindedInter().side.getEnd())&&a.get(t).mapSideList.includes(E.nextSide))return m(b);if(!a.has(E)&&a.has(E.prevSide)){let S=t.getShape().reverse(),v=Me(S,b.coord).dot(Me(E.getShape(),b.coord))<0;if(a.has(E.prevSide)){let A=v?E.getShape().reverse():E.getShape(),x=er(t.getShape(),ab(A,b.coord,A.end())).state;if(x===1||x===2)return m(b)}}}else if(b.side===i.side&&h(b))return m(b)}}}function h(f){if(f.isInvalid||f.getBindedInter().side!==(Ne(f.coord,e.prevSide.getEnd())?e.prevSide:e))return!1;let g;if(n){if(Ne(f.coord,l.start()))return!0;g=er(s?o.reverse():o,y(l)).state}else{if(Ne(f.coord,s?o.end():o.start()))return!0;g=er(l,y(s?o.reverse():o)).state}return g===2||g===1;function y(b){if(b instanceof J)return Ne(f.coord,b.end())?b:b.cutLine(f.coord);if(b instanceof ue)return ue.build2(b.center,b.startAngle,f.coord.angleD(b.center),b.rx,b.ry,b.isCCW?1:0);if(b instanceof Te)return b.clip(b.getPercent(f.coord,ke))[0];throw new Error("not supported operation")}}function m(f){let g=i.getBindedInter(),y=i.side,b=g.side,E=i===f,S=i;if(r){let v=i.getIndex()-1;for(;y;){let A=y.inters;for(;v>=0;v--)if(i=A[v],i===f){E||(i.setIsInvalid(),i.isDealed(),S=i),y=null;break}else if(_s===0)!i.isInvalid&&(!Ne(i.coord,f.coord)||i.side===f.side&&i.getBindedInter().side===f.getBindedInter().side)&&(i.setIsInvalid(),i.isDealed(),S=i);else if(_s===1){if(i.isInvalid)continue;let x=i.getBindedInter().side;a.has(y)&&a.get(y).mapSideList.includes(x)&&(i.setIsInvalid(),i.isDealed(),S=i)}y=y==null?void 0:y.prevSide,v=(y==null?void 0:y.inters.length)-1}}else{let v=i.getIndex()+1;for(;y;){let A=y.inters;for(;v<A.length;v++){i=A[v];let x=i.getBindedInter();if(i===f){E||(i.setIsInvalid(),i.isDealed(),S=i),y=null;break}else if(_s===0)!i.isInvalid&&(!Ne(i.coord,f.coord)||y===f.side&&(Ne(x.side.getEnd(),i.coord)?x.side.nextSide:x.side)===f.getBindedInter().side)&&(i.setIsInvalid(),i.isDealed(),S=i);else if(_s===1){let T=x.side;a.has(y)&&a.get(y).mapSideList.includes(T)&&(i.setIsInvalid(),i.isDealed(),S=i)}}y=y==null?void 0:y.nextSide,v=0}}if(_s===0&&!Ne(g.coord,f.coord))if(n?a.has(b)?a.get(b).sideIsReversed:s:u){let v=g.getIndex()-1;for(;b;){let A=a.has(b),x=b.inters;for(;v>=0;v--){if(g=x[v],g===f.getBindedInter()){b=null;break}g.isInvalid||!A||(!Ne(g.coord,f.getBindedInter().coord)||g.side===f.side&&g.getBindedInter().side===f.getBindedInter().side)&&(g.setIsInvalid(),g.isDealed())}b=b==null?void 0:b.prevSide,v=(b==null?void 0:b.inters.length)-1}}else{let v=g.getIndex()+1;for(;b;){let A=b.inters,x=a.has(b);for(;v<A.length;v++){if(g=A[v],g===f.getBindedInter()){b=null;break}let T=Ne(b.getEnd(),g.coord)?a.has(b.nextSide):!1;g.isInvalid||!(x||T)||(!Ne(g.coord,f.getBindedInter().coord)||g.side===f.side&&g.getBindedInter().side===f.getBindedInter().side)&&(g.setIsInvalid(),g.isDealed())}b=b==null?void 0:b.nextSide,v=0}}return n?S:S.getBindedInter()}}function Jx(e,t,i,r,n,s,a){let o=e.getShape(),l=t.getShape(),u=s?i.getShape().reverse():i.getShape(),c=(o instanceof ue?qn(o,u.start().angle(o.center)):o instanceof Te?Me(o,u.start()):o.end().sub(o.start())).normalize(),h=(l instanceof ue?qn(l,u.start().angle(l.center)):l instanceof Te?Me(l,u.start()):l.end().sub(l.start())).normalize(),m=c.dot(h);if(Is(m,-1)){let f=s?i.getShape().reverse():i.getShape(),g=Me(f).normalize(),y=c.add(h.scale(-1)).normalize().dot(g),b=er(o.reverse(),l,a).state;if(y>-.9&&(b===3||b===4))return{state:b===4?0:1,inter:ta(t,i,n,s,!0,!1,r)};let E=Kr(e,i,n,a,_s,ja,r.size===0?new Map:r,s);return E.state===2?E:b===4?E.state===0||E.inter!==n?E:Kr(t,i,n,a,_s,ja,r.size===0?new Map:r,s):E.state===1||E.inter!==n?E:Kr(t,i,n,a,_s,ja,r.size===0?new Map:r,s)}else{let f=c.scale(-1).angle(ie.ORIGIN),g=h.angle(ie.ORIGIN);f>g&&(f-=Sf);let y=(f+g)/2,b=new ie(Math.cos(y),Math.sin(y)),E=Me(u).normalize(),S=E.angle(ie.ORIGIN),v=f<S&&S<g&&o instanceof J&&l instanceof J&&u instanceof J;if(b.cross(E)<=0){if(c.scale(-1).dot(E)<0){let A;return n.coord.equals1(u.start())?A=Me(o,n.coord).dot(Me(u,n.coord))<0:u instanceof J&&(A=Me(o,o.end()).dot(u.direct)<0),{state:zo(e,t,i,!s,a)?1:0,inter:ta(e,i,n,s,!0,A,r)}}return v&&o.distance2(u.start())>tr?[t,i,!0,void 0,r]:[e,i,!0,void 0,r]}else return h.dot(E)<=0?{state:zo(e,t,i,!s,a)?1:0,inter:ta(t,i,n,s,!0,void 0,r)}:v&&l.distance2(u.start())>tr?[e,i,!0,void 0,r]:[t,i,!0,void 0,r]}}var lf=0;function aY(e,t,i,r){let n=t.getBindedInter(),s=t.side,a=n.side,o=s.getShape(),l=a.getShape();if(r&&(lf++,lf===-1)){r.initColor(gt.RED).addPt(o),r.initColor(gt.Golden).addPt(l),r.draw();debugger}let u=0,c=!1;if(e===-1){let R=ea(s,s.nextSide,a,n,u,c,r),L=R.state!==0;if(R.state===2){let H=Me(o,t.coord).add(Me(s.nextSide.getShape(),t.coord)).normalize(),k=Me(l,t.coord).add(Me(a.nextSide.getShape(),t.coord)).normalize();return T(L,H.dot(k)>0)}let O=ea(s,s.nextSide,a.nextSide,n,u,c,r);return R.state!==O.state?(x(R,O),1):T(L,R.state!==ea(a,a.nextSide,s,t,u,!0,r).state,R.inter,O.inter)}if(e===1){let R=Kr(s,a,n,r,u,c,new Map),L=R.state!==0;if(R.state===2)return T(L,Me(o,t.coord).dot(Me(l,t.coord))>0);let O;if(R.isReversed&&R.existOverlap&&Ne(R.inter.coord,a.getEnd())&&R.inter.getBindedInter().side!==s){let ee=R.inter.getBindedInter().side;if(ee===s.nextSide)O={state:zo(s,ee,a.nextSide,!0,r)?1:0,inter:n};else if(ee===s.prevSide){if(O={state:zo(ee,s,a.nextSide,!0,r)?1:0,inter:R.inter},R.state===O.state&&t!==R.inter){let q=Me(l,t.coord),Q=Me(a.nextSide.getShape(),t.coord),ne=Me(ee.getShape(),t.coord);return T(L,q.add(Q).dot(ne)>0,R.inter,O.inter)}}else O=Kr(s,a.nextSide,n,r,u,c,new Map)}else O=Kr(s,a.nextSide,n,r,u,c,new Map);if(R.state!==O.state)return x(R,O),1;let H=Me(l,t.coord),k=Me(a.nextSide.getShape(),t.coord);if(Is(H.dot(k),-1)){let ee=Ai(a,a.nextSide,!0,r);return T(L,R.state!==Kr(a.nextSide,s,t,r,u,!0,new Map,ee?!L:L,!1).state,R.inter,O.inter)}else{let ee=Me(o,t.coord);return T(L,H.add(k).dot(ee)>0,R.inter,O.inter)}}if(!(o instanceof Te||l instanceof Te))return 1;let h=Me(o,t.coord),m=Me(l,t.coord),f,g;if(l instanceof J)f=new J(t.coord,l.start()),g=new J(t.coord,l.end());else if(l instanceof ue){let R=t.coord.angleD(l.center);f=ue.build2(l.center,R,l.startAngle,l.rx,l.ry,l.isCCW?0:1),g=ue.build2(l.center,R,l.endAngle(),l.rx,l.ry,l.isCCW?1:0)}else if(l instanceof Te){let R=l.getPercent(t.coord,ke);[f,g]=l.clip(R),f=f.reverse()}else throw new Error("not support");let y=h.dot(m)>0,b,E;y?(b=er(o.reverse(),f).state,E=er(o,g).state):(b=er(o,f).state,E=er(o.reverse(),g).state);let S;b===0?S=Kr(y?s.prevSide:s.nextSide,a,n,r,u,c,new Map,!0,!1,y):b===1?S=Kr(s,a.prevSide,n,r,u,c,new Map,!0,!0,y):b===2?y?S=ea(s.prevSide,s,a.prevSide,n,u,c,r,!0):S=ea(s,s.nextSide,a.prevSide,n,u,c,r,!0):y?b===3?S={inter:n,state:0}:S={inter:n,state:1}:b===3?S={inter:n,state:1}:S={inter:n,state:0};let v=S.state!==0;if(S.state===2)return T(v,y);let A;if(E===0?A=Kr(y?s.nextSide:s.prevSide,a,n,r,u,c,new Map,!1,!1,!y):E===1?A=Kr(s,a.nextSide,n,r,u,c,new Map,!1,!0,!y):E===2?y?A=ea(s,s.nextSide,a.nextSide,n,u,c,r,!1):A=ea(s.prevSide,s,a.nextSide,n,u,c,r,!1):y?E===3?A={inter:n,state:1}:A={inter:n,state:0}:E===3?A={inter:n,state:0}:A={inter:n,state:1},S.state===A.state)return S.inter===A.inter?(t.setIsInvalid(),0):T(v,y,S.inter,A.inter);return x(S,A),1;function x(R,L){let O=R.state!==0;if(R.inter===L.inter){t.setOutToIn(O);return}else Gl(R.inter,L.inter,!0),Gl(L.inter,R.inter,!1);let H=[];if(e===-1){let ee=Me(o,t.coord),q=Me(s.nextSide.getShape(),t.coord),Q=Me(l,t.coord),ne=Me(a.nextSide.getShape(),t.coord);H.push(ee.dot(Q)),H.push(ee.dot(ne)),H.push(q.dot(Q)),H.push(q.dot(ne))}else{let ee=Me(o,t.coord);H.push(Me(l,t.coord).dot(ee)),H.push(Me(a.nextSide.getShape(),t.coord).dot(ee))}if(H.reduce((ee,q)=>Math.abs(ee)>Math.abs(q)?ee:q,0)>0)if(i===1||i===0||i===2||i===3)t.setOutToIn(O);else throw new Error("not support");else if(i===1)k(!O);else if(i===0||i===2||i===3)k(O);else throw new Error("not support");function k(ee){t.setIsInvalid();let q=(ee?R:L).inter;delete q.isInvalid,delete q.getBindedInter().isInvalid,q.setOutToIn(!O)}}function T(R,L,O,H){if(O===H){if(t.side.outline.inters.find(q=>!q.isInvalid&&q!==t&&Ne(q.coord,t.coord)))return t.setIsInvalid(),0;let k=new ia(t.coord,s,r),ee=new ia(t.coord,a,r);return k.bind(ee),L?s.inters.splice(t.getIndex(),0,k):s.inters.splice(t.getIndex()+1,0,k),a.inters.splice(t.getBindedInter().getIndex(),0,ee),k.setOutToIn(R),t.setOutToIn(!R),k.isDealed(),s.inters.forEach((q,Q)=>q.setIndex(Q)),a.inters.forEach((q,Q)=>q.setIndex(Q)),2}else{let k=function(){let ee=O.getBindedInter(),q=H.getBindedInter();delete O.isInvalid,delete ee.isInvalid,delete H.isInvalid,delete q.isInvalid,O.setOutToIn(!R),H.setOutToIn(R),Gl(O,H,!0),Gl(H,O,!1),Gl(ee,q,L),Gl(q,ee,!L)};if(t.setIsInvalid(),L){if(i===1||i===0||i===2||i===3)return k(),2;throw new Error("not support")}else{if(i===1)return R?0:(k(),2);if(i===0||i===2||i===3)return R?(k(),2):0;throw new Error("not support")}}}}function Gl(e,t,i){let{judge:r,changeNum:n}=a(),s=e.getIndex();for(let o=s+n,l=e.side.inters;r(o);o+=n){if(l[o].isInvalid)continue;if(!Ne(l[o].coord,e.coord))break;l[o].setIndex(s),l[s].setIndex(o);let u=l[o];l[o]=l[s],l[s]=u,s=o}function a(){let o=e.side===t.side;if(i){let l=o?t.getIndex():e.side.inters.length;return{judge:u=>u<l,changeNum:1}}else{let l=o?t.getIndex()+1:0;return{judge:u=>u>=l,changeNum:-1}}}}var WC=0,ia=class{constructor(e,t,i){this.id=WC++,this.coord=e,this.side=t,i&&(this.id=WC++,this.drawDebug=i);let r=new Sr;r.ext2(e),this._bbox=r.build1()}bbox(){return this._bbox}resetVisitStatus(){this.visited=!1,this.bindedInter.visited=!1}isDealed(){this.dealed=!0,this.getBindedInter().dealed=!0}setOutToIn(e){this.outToIn=e,this.bindedInter.outToIn=!e}setIsInvalid(){this.isInvalid=!0,this.getBindedInter().isInvalid=!0}getBindedInter(){return this.bindedInter}bind(e){this.bindedInter=e,e.bindedInter=this}setIndex(e){this.index=e}isSorted(){return this.index!==void 0}getIndex(){return this.index}getVisited(){return this.visited}visitSelf(){this.visited=!0}visit(){this.visited=!0,this.bindedInter.visited=!0}getPrevPoint(){let e=this.getIndex(),t=this.side.getStart();return e&&(t=this.side.inters[e-1].coord),t}getTangent(){let e=this.side.getShape();if(e instanceof J)return e.end().sub(e.start());if(e instanceof ue){let t=this.coord.angle(e.center);return e.isCCW?t+=ef:t-=ef,new ie(Math.cos(t),Math.sin(t))}else{if(e instanceof Te)return $c(e,e.getPercent(this.coord,ke));throw new Error("not support")}}findStartInter(){return this.outToIn===void 0?this.getTangent().cross(this.bindedInter.getTangent())>0?this:this.bindedInter:this.outToIn?this:this.bindedInter}run(){let e=[],t=this,i;if(this.drawDebug){hb++;let r=hb===-1,n=this.drawDebug.initColor(gt.RED);if(r){this.drawDebug.draw();debugger}i=s=>{if(e.push(s),r){n.addPt(e[e.length-1]),this.drawDebug.draw();debugger}}}else i=r=>e.push(r);for(;!t.visited;){let r=function(o,l){if(de.eq(o.distance2(l),0))return;let u=ud.rebuild(s.getShape(),o,l);if(!u)return!0;i(u)};t.visit();let n=t.getIndex(),s=t.side,a=s.inters[n+1];for(;a!=null&&a.isInvalid;)a=s.inters[a.getIndex()+1];if(a)r(t.coord,a.coord),t=a.bindedInter;else{let o=r(t.coord,s.getEnd()),l=t.coord;for(s=s.nextSide,t=null;;){for(let u of s.inters)if(!u.isInvalid){t=u.bindedInter;break}if(t)break;o?(r(l,s.getEnd()),o=!1):i(s.getShape()),s=s.nextSide}o?(de.eq(l.distance2(t.coord),0)?r(l,s.getEnd()):r(l,t.coord),o=!1):de.eq(s.getEnd().distance2(t.coord),0)?i(s.getShape()):r(s.getStart(),t.coord)}}if(t!==this)throw this.drawDebug&&console.log(JSON.stringify({runId:hb,handleId:lf,boolId:Uc})),new Error("inter !== this");return za(et.build7(e))}},hb=0,pb=class Mb{constructor(t,i,r,n,s){this.inters=[],this.allInterIsInvalid=!0,this.isVisit=!1,this.sides=t,this.isGroup1=r,this.isOutside=n,this.finalIsOutside=n,this.polyline=i,s&&(this.polygon=s),t.forEach(a=>a.outline=this)}static build(t,i,r,n,s){let a=t.primitives.map(l=>new ud(l,n)),o=a[a.length-1];return a.forEach(l=>{o.connect(l),o=l}),s?new Mb(a,t,i,r,s):new Mb(a,t,i,r)}setFinalIsOutSide(t){this.finalIsOutside=t}startAndEndIsSameOutsideFlag(){return this.isOutside===this.finalIsOutside}get hasInter(){return!!this.interOutlines}isAllInterIsInvalid(){return this.allInterIsInvalid}setAllInterIsInvalidToFalse(){this.allInterIsInvalid=!1}resetVisited(){this.isVisit=!1}intersect(t,i){if(!(t.interOutlines&&t.interOutlines===this.interOutlines))if(t.interOutlines)if(this.interOutlines){let r,n;this.interOutlines.length>t.interOutlines.length?(r=this.interOutlines,n=t.interOutlines):(r=t.interOutlines,n=this.interOutlines),n.forEach(s=>{r.push(s),s.interOutlines=r}),i.delete(n)}else t.interOutlines.push(this),this.interOutlines=t.interOutlines;else this.interOutlines?(this.interOutlines.push(t),t.interOutlines=this.interOutlines):(t.interOutlines=this.interOutlines=[this,t],i.add(this.interOutlines))}isContain(t){if(!this.polyline.bbox().extendOfSize(ke).isContainsBBox(t.polyline.bbox()))return!1;let i=t.polyline.primitives[0].start();if(t.hasInter&&t.isAllInterIsInvalid()){let r=t.inters[0];r.getBindedInter().side.outline!==this?i=r.side.getCenterPoint():i=r.side.getCenterPoint(r.coord)}return!!this.polyline.getWindingNum(i)}isInternally(t){return!!this.polyline.getWindingNum(t)}isEqual(t){return this.polyline===t.polyline}bbox(){return this.polyline.bbox()}reverse(){this.sides.reverse();let t=this.sides[this.sides.length-1];this.sides.forEach(i=>{i.reverse(),t.connect(i),t=i})}returnPolyline(){let t=this.sides.map(r=>r.getShape()),i=this.polyline.primitives;if(this.sides.length===i.length){let r=new Set(i);if(!t.some(n=>!r.has(n)))return this.polyline}return et.build7(t)}};function zC(e,t,i){let r=[];return e.forEach(n=>n.forEach(s=>{if(s.hasInter&&!s.isAllInterIsInvalid())return;let a=s.bbox(),o=t.search(a.extendOfSize(ke)).filter(l=>l.bbox().extendOfSize(ke).isContainsBBox(a)).sort((l,u)=>l.bbox().area()-u.bbox().area());for(let l of o)if(l.isContain(s)){let u=i(!s.isOutside,l.isOutside),c=i(s.isOutside,l.isOutside);u!==c&&(r.push(s),s.setFinalIsOutSide(!u));return}i(s.isOutside,!1)!==i(!s.isOutside,!1)&&r.push(s)})),r}function oY(e,t,i){let r;switch(i){case 0:r=(o,l)=>o&&l;break;case 1:r=(o,l)=>o||l;break;case 2:r=(o,l)=>o&&!l;break;case 3:r=(o,l)=>o&&!l||!o&&l;break;default:throw Error("not support the rule")}let n=new Kc(10),s=new Kc(10);e.forEach(o=>o.forEach(l=>n.add(l))),t.forEach(o=>o.forEach(l=>s.add(l)));let a=zC(e,s,r);return zC(t,n,(o,l)=>r(l,o)).forEach(o=>a.push(o)),a}var lY=class{constructor(e){this.roots=[],this.nodes=e.sort((t,i)=>t.bbox().minX-i.bbox().minX).map(t=>new uY(t)),this.nodes.forEach((t,i)=>{t.visit()&&(this.roots.push(t),this.build(i))})}build(e){let t=this.nodes[e];for(let i=e+1,r=this.nodes.length;i<r;i++){let n=this.nodes[i];if(t.key.bbox().maxX<n.key.bbox().minX)break;n.getIsVisit()||t.isContain(n)&&(n.visit(),t.addChild(n),this.build(i))}}getPolygons(){let e=[];return this.roots.forEach(t=>t.getPolygons().forEach(i=>e.push(i))),e}},uY=class{constructor(e){this.children=[],this.isVisit=!1,this.key=e}getIsVisit(){return this.isVisit}isContain(e){return this.key.isContain(e.key)}addChild(e){this.children.push(e)}getPolygons(){let e=[];return this.getPolylineList(e),e.map(t=>{let i=t[0].polygon;if(i&&i.items.length===t.length){let r=t.map(s=>s.returnPolyline()),n=new Set(i.items);return r.some(s=>!n.has(s))?new mi(r):i}else return new mi(t.map(r=>r.returnPolyline()))})}getPolylineList(e,t){t?(t.push(this.key),t=null):(t=[this.key],e.push(t)),this.children.forEach(i=>i.getPolylineList(e,t))}visit(){return this.isVisit?!1:(this.isVisit=!0,!0)}};function VC(e){let t="";return e.items.forEach((i,r)=>{let n="$";if(i.items.forEach((s,a)=>{let o="[";if(s.primitives.forEach((l,u)=>{let c="";if(l instanceof J)c=`Line,${l.start().x},${l.start().y},${l.end().x},${l.end().y}`;else if(l instanceof ue)c=`Arc,${l.center.x},${l.center.y},${l.startAngle},${l.sweepAngle},${l.rx}`;else if(l instanceof Te)c=`Bezier,${l.controls.map(h=>`${h.x},${h.y}`).join(",")}`;else throw new Error("not supported");if(u===s.primitives.length-1){o+=`${c}]`;return}o+=`${c},`}),a===i.items.length-1){n+=`${o}$`;return}n+=`${o}_`}),r===e.items.length-1){t+=`${n}`;return}t+=`${n}^`}),console.log(t),t}function qC(e){let t=e.split("^"),i=[];return t.forEach(n=>{let s=/\$(.*?)\$/,a=n.match(s)[1].split("_"),o=[];a.forEach(u=>{let c=/\[(.*?)\]/,h=u.match(c)[1].split(","),m=[],f=[];for(let y=0;y<h.length;y++){let b=h[y];if(b==="Line"||b==="Arc"||b==="Bezier"){if(m.length){let E=r(m);f.push(E),m.length=0}m.push(b);continue}m.push(Number(b))}m.length&&(f.push(r(m)),m.length=0);let g=et.build7(f);o.push(g)});let l=new mi(o);i.push(l)}),new Qt(i);function r(n){let s=n[0];if(s==="Line")return new J(new ie(n[1],n[2]),new ie(n[3],n[4]));if(s==="Arc")return ue.build3(new ie(n[1],n[2]),n[3],n[4],n[5],n[5]);if(s==="Bezier"){let a=[];for(let o=1;o<n.length;o+=2)a.push(new ie(n[o],n[o+1]));return new Te(a)}else throw new Error("not support")}}var cY=class{constructor(e=1){this.group1Str="$[Line,20193.777980000017,4122.200439600661,20193.77082,4211.848760073709,Arc,20193.972672902382,4211.8487570980205,179.99915535323618,-89.99540000050294,0.2018529024026465,Line,20193.972659672283,4212.050609999989,20193.972660393258,4212.039610000013,Arc,20193.97217289501,4211.848257065248,89.85403133887164,89.99540000041924,0.19135355574930143,Line,20193.78082,4211.848759926291,20193.78897999998,4122.200440479205,Line,20193.78897999998,4122.200440479205,20193.777980000017,4122.200439600661]$",this.group2Str="$[Arc,20209.72784128151,4122.2007625157785,258.46768032837986,-75.66780748375947,4.138846238512183,Line,20205.593935808283,4121.998590004101,20193.97982992629,4121.998600000001,Arc,20193.97983290198,4122.2004529023825,269.9991553532362,-89.99540000050297,0.20185290240401074,Arc,20193.782979999996,4122.20044,180.00375535340328,-180.0000000000027,0.004999999999025513,Arc,20193.979332869207,4122.200952909754,180.15347936671733,89.99540000008247,0.19135355575111057,Line,20193.97983008845,4122.009599999999,20205.603694309226,4122.003828485546,Arc,20209.733142304296,4122.194577876843,182.64475341258483,75.73379999998886,4.133851239977064,Line,20208.900400396684,4118.145470939558,20208.902599535475,4118.156248870184,Arc,20206.972515961093,4108.700057667588,78.46393309088245,-78.46759999998636,9.65115405866796,Arc,20216.618669999996,4108.69944,359.99996825446135,-180,0.004999999999200412,Arc,20206.973015966745,4108.699445349495,359.99996822365375,78.46759999998409,9.640654033253735]$^$[Line,20193.997796883676,4095.399470032799,20205.596133314026,4095.4013992171836,Arc,20209.72470159858,4095.1923799234505,177.10172964919312,-75.64935037184974,4.133855965730166,Arc,20209.73000213952,4095.198565517174,101.5415133143569,75.7293000000185,4.128850963459707,Line,20205.605834328744,4095.395161923586,20193.997203529463,4095.389485743675,Arc,20193.994588809255,4095.197684525904,89.21896662213764,4.544099999999517,0.19181903946188483,Arc,20193.981499796217,4095.1977402038,89.85034659953621,89.9999999995926,0.19135044893494071,Arc,20193.78515,4095.19824,0,-180,0.005,Arc,20193.98200016982,4095.1982398301675,179.99995179248322,-89.99999999974185,0.20185016982129908,Arc,20193.981986624152,4095.198185381971,89.9961078637802,-4.487285276547311,0.2019046184835962]$",this.rule=e}getGroup1(){return qC(this.group1Str)}getGroup2(){return qC(this.group2Str)}},fb=new Ef(2),Fc=class{getUnion(e,t=!0){return t&&(e=e.map(i=>this.asSameSweep([i])[0])),qj(Tj,e)}asSameSweep(e){let t=0;return e.forEach(i=>t+=i.area(.01)),t>0?e.map(i=>i.reverse()):e}getSubtraction(e,t){let i=new qc(!1),r=new Xc(Hp.rule,fb,i);for(let n of e){let s=Hp.weight(0);r.addPolyline(n,s)}for(let n of t){let s=Hp.weight(1);r.addPolyline(n,s)}return r.simplify(),i.plGrps}getIntersection(e,t){let i=new qc(!1),r=new Xc(jp.rule,fb,i);for(let n of e){let s=jp.weight(0);r.addPolyline(n,s)}for(let n of t){let s=jp.weight(1);r.addPolyline(n,s)}return r.simplify(),i.plGrps}getMutuallyExclusive(e,t){let i=new qc(!1),r=new Xc(Yp.rule,fb,i);for(let n of e){let s=Yp.weight(0);r.addPolyline(n,s)}for(let n of t){let s=Yp.weight(1);r.addPolyline(n,s)}return r.simplify(),i.plGrps}},Uc=0,mb=!1;function Hc(e,t,i,r,n){let s=cd(),a=[],o=[],l=[],u=new Set,c;if(n){if(c=new ld(n),Uc++,mb){debugger;mb=!1;let A=new cY;Hc(A.rule,A.getGroup1(),A.getGroup2(),r,n)}if(Uc===-1||mb){console.table({rule:e,group1:VC(t),group2:VC(i)}),c.clear();let A=c.initColor(gt.GREEN),x=c.initColor(gt.WHITE),T=c.initColor(gt.BLUE),R=c.initColor(gt.Gray);t.items.forEach(L=>L.items.forEach((O,H)=>{H>0?x.addPly(O):A.addPly(O)})),i.items.forEach(L=>L.items.forEach((O,H)=>{H>0?R.addPly(O):T.addPly(O)})),c.draw();debugger}}let h=t.items.length!==0&&i.items.length!==0?t.bbox().extendOfSize(ke).intersection1(i.bbox().extendOfSize(ke)):null;if(h){let A=[],x=[];switch(e){case 0:{for(let T of t.items)T.bbox().isIntersect(h)&&A.push(T);for(let T of i.items)T.bbox().isIntersect(h)&&x.push(T);break}case 1:case 3:{for(let T of t.items)T.bbox().isIntersect(h)?A.push(T):a.push(T);for(let T of i.items)T.bbox().isIntersect(h)?x.push(T):a.push(T);break}case 2:{for(let T of t.items)T.bbox().isIntersect(h)?A.push(T):a.push(T);for(let T of i.items)T.bbox().isIntersect(h)&&x.push(T);break}default:throw new Error("not support")}A.length!==t.items.length&&(t=new Qt(A)),x.length!==i.items.length&&(i=new Qt(x))}else{switch(e){case 0:break;case 1:case 3:{t.items.forEach(A=>a.push(A)),i.items.forEach(A=>a.push(A));break}case 2:{t.items.forEach(A=>a.push(A));break}default:throw new Error("not support")}t=new Qt([]),i=new Qt([])}S(t,o,!0),S(i,l,!1);let m=e===2||e===3?(A,x)=>Ne(A.getEnd(),x)?A.nextSide:A:(A,x)=>Ne(A.prevSide.getEnd(),x)?A.prevSide:A,f=(A,x,T)=>{if(Ne(A.getEnd(),T)){if(A.inters.findIndex(R=>R.getBindedInter().side===x&&Ne(R.coord,A.getEnd()))===-1)return new ia(T,A,c)}else return new ia(T,A,c)},g=e===2||e===3?(A,x,T)=>{if(Ne(A.getStart(),T)){if(A.inters.findIndex(R=>R.getBindedInter().side===x&&Ne(R.coord,A.getStart()))===-1)return new ia(T,A,c)}else return new ia(T,A,c)}:f;r.seek(t,i,(A,x,T,R,L,O)=>{let H=o[A][x],k=l[R][L],ee=H.sides[T],q=k.sides[O],Q=vn(ee.getShape(),q.getShape());if((ee.getShape()instanceof Te||q.getShape()instanceof Te)&&Q>=4){if(ee.getShape()instanceof ue||q.getShape()instanceof ue){let G=function(D,F){let W=!1;for(let z=0;z<F.length;z+=2)Ne(new ie(F[z],F[z+1]),D)&&(W=!0);W||F.push(D.x,D.y)},X=[Y[0],Y[1]];for(let D=0;D<Q;D+=2){let F=new ie(Y[D],Y[D+1]);for(let W=D+2;W<Q;W+=2){let z=new ie(Y[W],Y[W+1]);if(!Ne(F,z)){G(z,X);break}}}Q=X.length,X.forEach((D,F)=>Y[F]=D)}else for(let G=Q-2;G>=2;G-=2)for(let X=G-2;X>=0;X-=2)if(Ne(new ie(Y[G],Y[G+1]),new ie(Y[X],Y[X+1]))){Y[X]=(Y[G]+Y[X])/2,Y[X+1]=(Y[G+1]+Y[X+1])/2;for(let D=Q-3;D>=G;D--)Y[D]=Y[D+2];Q-=2;break}}let ne=0;if(Q===4){let G=function(F){return Ne(ee.getEnd(),F)||Ne(ee.prevSide.getEnd(),F)||Ne(q.prevSide.getEnd(),F)||Ne(q.getEnd(),F)},X=new ie(Y[0],Y[1]),D=()=>{let F=new ia(X,ee,c),W=new ia(X,q,c);F.bind(W),F.setIsInvalid(),F.isDealed(),H.inters.push(F),k.inters.push(W)};if(Y[0]===Y[2]&&Y[1]===Y[3])if(G(X))ne=2;else{D();return}}for(;ne<Q;ne+=2){let G=new ie(Y[ne],Y[ne+1]),X=ee,D=q;if(Ne(X.prevSide.getEnd(),G)&&(X=X.prevSide),D=m(D,G),ee!==X&&q!==D){let W=e===2||e===3?q.getEnd():D.getEnd();X.getEnd().distance1(G)<W.distance1(G)?(G=X.getEnd(),Ne(W,G)||(D=q)):(G=W,Ne(X.getEnd(),G)||(X=ee))}let F=f(X,D,G);if(F){let W=g(D,X,G);W&&(X.addInter(F),H.inters.push(F),D.addInter(W),k.inters.push(W),F.bind(W),H.intersect(k,u))}}return Q},n);let y=v(),b=oY(o,l,e);b.forEach(A=>!A.startAndEndIsSameOutsideFlag()&&A.reverse()),new lY(y.concat(b)).getPolygons().forEach(A=>a.push(A));let E=new Qt(a);if(c){if(Uc===-1){let A=c.initColor(gt.RED),x=c.initColor(gt.Golden);a.forEach(T=>{A.addPly(T.items[0]),T.items.slice(1).forEach(R=>x.addPly(R))}),c.draw();debugger;throw new Error}E.id=Uc}return Es.BooleanTools+=Ua(s),E;function S(A,x,T){A.items.forEach(R=>{let L=[];L.push(pb.build(R.items[0],T,!0,c,R)),R.items.slice(1).forEach(O=>{L.push(pb.build(O,T,!1,c))}),x.push(L)})}function v(){let A=[];return u.forEach(T=>{e===2||e===3?T.forEach(L=>{L.isGroup1||L.reverse(),L.sides.forEach(O=>O.sortInters())}):T.forEach(L=>L.sides.forEach(O=>O.sortInters())),T.map(L=>L.sides.filter(O=>O.inters.length)).flat(2).sort((L,O)=>{let H=L.inters,k=O.inters,ee=Ne(H[H.length-1].coord,L.getEnd()),q=Ne(k[k.length-1].coord,O.getEnd());if(ee&&q){let Q=0,ne=0;for(let G=H.length-2;G>=0&&Ne(H[G].coord,L.getEnd());G--)Q++;for(let G=k.length-2;G>=0&&Ne(k[G].coord,O.getEnd());G--)ne++;return ne-Q}else return ee?-1:1}).forEach(L=>{L.inters.forEach(O=>{if(O.dealed)return;let H=O.side,k=O.getBindedInter().side,ee;Ne(H.getEnd(),O.coord)&&Ne(k.getEnd(),O.coord)?ee=-1:Ne(H.getEnd(),O.coord)?(ee=1,O=O.getBindedInter()):Ne(k.getEnd(),O.coord)&&(ee=1);let q=aY(ee,O,e,c);O.isDealed(),q&&(H.outline.setAllInterIsInvalidToFalse(),k.outline.setAllInterIsInvalidToFalse())})}),R(T),e===3&&(T.forEach(L=>{L.reverse(),L.sides.forEach(O=>{O.sortInters(),O.inters.forEach(H=>{H.resetVisitStatus()})})}),R(T));function R(L){L.forEach(O=>{O.inters.forEach(H=>{if(H.isInvalid||H.getVisited())return;let k=H.findStartInter(),ee=x(e)?k.run():k.getBindedInter().run(),q=O.polyline.primitives;if(ee){if(q.length===ee.primitives.length){let Q=new Set(q);if(!ee.primitives.some(ne=>!Q.has(ne))){A.push(O);return}}A.push(pb.build(ee,!0,!0,c))}})})}}),A;function x(T){switch(T){case 0:case 2:case 3:return!0;case 1:return!1;default:throw Error("not support the rule")}}}}var wp=/\bstablilizetion\b/.test(self.location.href)||!0,Lc={intersect(e,t,i,r){try{return Hc(0,e,t,i,r)}catch(n){if(wp){let s=new Fc().getIntersection(e.items.map(a=>a.items.map(o=>o)).flat(2),t.items.map(a=>a.items.map(o=>o)).flat(2));return new Qt(s.map(a=>new mi(a.items)))}throw n}},union(e,t,i,r){try{return Hc(1,e,t,i,r)}catch(n){if(wp){let s=new Fc,a=e.items.map(l=>l.items.map(u=>u)).flat(2);t.items.forEach(l=>l.items.forEach(u=>a.push(u)));let o=s.getUnion(a);return new Qt(o.map(l=>new mi(l.items)))}throw n}},diff(e,t,i,r){try{return Hc(2,e,t,i,r)}catch(n){if(wp){let s=new Fc().getSubtraction(e.items.map(a=>a.items.map(o=>o)).flat(2),t.items.map(a=>a.items.map(o=>o)).flat(2));return new Qt(s.map(a=>new mi(a.items)))}throw n}},xor(e,t,i,r){try{return Hc(3,e,t,i,r)}catch(n){if(wp){let s=new Fc().getMutuallyExclusive(e.items.map(a=>a.items.map(o=>o)).flat(2),t.items.map(a=>a.items.map(o=>o)).flat(2));return new Qt(s.map(a=>new mi(a.items)))}throw n}}},dY=class extends Xc{constructor(e,t,i,r,n,s){super(e.rule,Ef.DUMMY,t),this.sideGroup1=[],this.sideGroup2=[],this.group1=i,this.group2=r,this.seeker=n,this.addGroup(i,e.weight(0),this.sideGroup1),this.addGroup(r,e.weight(1),this.sideGroup2),this.bus=s}addGroup(e,t,i){if(!e)debugger;e.items.forEach(r=>{let n=[];r.items.forEach(s=>{let a=this.sides.length;this.addPolyline(s,t),n.push(this.sides.slice(a))}),i.push(n)})}seekIntersection(){this.seeker.seek(this.group1,this.group2,(e,t,i,r,n,s)=>{let a=this.sideGroup1[e][t][i],o=this.sideGroup2[r][n][s],l=vn(a.shape,o.shape);for(let u=0;u<l;u+=2){let c=new ie(Y[u],Y[u+1]);a.inters.push(c),o.inters.push(c),this.event.onIntersect(c,a,o)}return l},this.bus)}},hY=class extends qc{constructor(e){super(!!e),e&&(this.drawDebug=new ld(e),this.blueDrawing=this.drawDebug.initColor(gt.BLUE),this.greenDrawing=this.drawDebug.initColor(gt.GREEN),this.redDrawing=this.drawDebug.initColor(gt.RED))}onOriginSide(e){super.onOriginSide(e),this.debug&&this.blueDrawing.addPt(e.shape)}onPolylineGroup(e,t){super.onPolylineGroup(e,t),this.debug&&e.items.forEach(i=>this.greenDrawing.addPly(i))}draw(){this.drawDebug.draw()}};function Rp(e,t,i,r,n){let s=cd(),a=new hY(n);new dY(e,a,t,i,r,n).simplify();let o=[];a.plGrps.forEach(u=>{let c=u.items.map(h=>of(h));c[0]&&o.push(new mi(c.filter(h=>h)))});let l=new Qt(o);return Es.BooleanTools+=Ua(s),l}var Lp=!0,Nc={intersect(e,t,i,r){try{return Lc.intersect(e,t,i,r)}catch(n){if(Lp)throw n;return console.error(n),Rp(jp,e,t,i,r)}},union(e,t,i,r){try{return Lc.union(e,t,i,r)}catch(n){if(Lp)throw n;return console.error(n),Rp(wj,e,t,i,r)}},diff(e,t,i,r){try{return Lc.diff(e,t,i,r)}catch(n){if(Lp)throw n;return console.error(n),Rp(Hp,e,t,i,r)}},xor(e,t,i,r){return Lc.xor(e,t,i,r)}};var pY=class{init(e){}seek(e,t,i,r){let n=e.bbox().extendOfSize(5e-6).intersection1(t.bbox().extendOfSize(5e-6));if(!n)return;let s=cd(),a=[];for(let m=0,f=e.items.length;m<f;m++){let g=e.items[m];if(n.isIntersect(g.bbox()))for(let y=0,b=g.items.length;y<b;y++){let E=g.items[y];if(n.isIntersect(E.bbox()))for(let S=0,v=E.primitives.length;S<v;S++){let A=E.primitives[S].bbox();n.isIntersect(A)&&a.push({bbox:A,polygonIndex:m,polylineIndex:y,ptIndex:S})}}}let o=a.length;if(o===0){Es.IntersectionSeeker+=Ua(s);return}let l=[];for(let m=0,f=t.items.length;m<f;m++){let g=t.items[m];if(n.isIntersect(g.bbox()))for(let y=0,b=g.items.length;y<b;y++){let E=g.items[y];if(n.isIntersect(E.bbox()))for(let S=0,v=E.primitives.length;S<v;S++){let A=E.primitives[S].bbox();n.isIntersect(A)&&l.push({bbox:A,polygonIndex:m,polylineIndex:y,ptIndex:S})}}}let u=l.length;if(u===0){Es.IntersectionSeeker+=Ua(s);return}if(o<5||u<5){for(let m=0,f=a.length;m<f;m++)for(let g=0,y=l.length;g<y;g++)if(a[m].bbox.isIntersect(l[g].bbox.extendOfSize(1e-5))){let b=a[m],E=l[g];i(b.polygonIndex,b.polylineIndex,b.ptIndex,E.polygonIndex,E.polylineIndex,E.ptIndex)}Es.IntersectionSeeker+=Ua(s);return}a.sort((m,f)=>m.bbox.minX-f.bbox.minX),l.sort((m,f)=>m.bbox.minX-f.bbox.minX);let c=0,h=0;for(;c<o&&h<u;)if(a[c].bbox.minX<l[h].bbox.minX){let m=a[c],f=m.bbox;for(let g=h;g<u;g++){let y=l[g],b=y.bbox;if(b.minX>f.maxX+1e-5)break;(f.minY<b.minY?b.minY:f.minY)<(f.maxY<b.maxY?f.maxY:b.maxY)+1e-5&&i(m.polygonIndex,m.polylineIndex,m.ptIndex,y.polygonIndex,y.polylineIndex,y.ptIndex)}c++}else{let m=l[h],f=m.bbox;for(let g=c;g<o;g++){let y=a[g],b=y.bbox;if(b.minX>f.maxX+1e-5)break;(b.minY<f.minY?f.minY:b.minY)<(b.maxY<f.maxY?b.maxY:f.maxY)+1e-5&&i(y.polygonIndex,y.polylineIndex,y.ptIndex,m.polygonIndex,m.polylineIndex,m.ptIndex)}h++}Es.IntersectionSeeker+=Ua(s)}},Oi,Gi=(Oi=class{static getDebug(){return Oi.drawDebug||(Oi.drawDebug=new ld(Oi.curBus)),Oi.drawDebug}static getDrawing(t=gt.GREEN){return this.getDebug().initColor(t)}static clearDrawing(){Oi.getDebug().clear()}static drawText(t,i,r=gt.GREEN){Oi.getDrawing(r).addText(t,i,1.5,.1,!0)}static drawBBox(t,i=gt.GREEN){if(!t)return;let r=Oi.getDrawing(i),n=new J(t.UL(),t.UR()),s=new J(t.UR(),t.LR()),a=new J(t.LR(),t.LL()),o=new J(t.LL(),t.UL());r.addPt(n),r.addPt(s),r.addPt(a),r.addPt(o)}static drawPolyType(t,i){let r=Oi.getDrawing(i);if(t instanceof et)r.addPly(t);else if(t instanceof mi)for(let n of t.items)n instanceof et?r.addPly(n):this.drawPolyType(n,i);else if(t instanceof Qt)for(let n of t.items)this.drawPolyType(n,i)}static translate(t){switch(t){case 0:return"\u2229";case 2:return"-";case 1:return"U";case 3:return"X";default:break}}},Oi.UseRunArrange=!0,Oi.UseOptimizeSplit=!0,Oi.LocalBestThread=4,Oi.HandleDiff=!0,Oi.OcTreeSplitStep=4,Oi.PrintStart=new ie(150,-200),Oi),Dc=class kb{static getPolyTypeLine(t){let i=[];if(t instanceof et)for(let r of t.primitives)i.push(r);else if(t instanceof mi)for(let r of t.items)if(r instanceof et)for(let n of r.primitives)i.push(n);else{let n=this.getPolyTypeLine(r);for(let s of n)i.push(s)}else if(t instanceof Qt)for(let r of t.items){let n=this.getPolyTypeLine(r);for(let s of n)i.push(s)}return i}static getPolyTypePolyLine(t){let i=[];if(t instanceof et)i.push(t);else if(t instanceof mi)for(let r of t.items)if(r instanceof et)i.push(r);else{let n=this.getPolyTypePolyLine(r);for(let s of n)i.push(s)}else if(t instanceof Qt)for(let r of t.items){let n=this.getPolyTypePolyLine(r);for(let s of n)i.push(s)}return i}static getListBBox(t){if(t.length<=0)return;let i=new Sr;for(let r of t){let n=kb.getSingleBBox(r);i.ext1(n)}return i.build1()}static getSingleBBox(t){if(t instanceof Array){let i=new Sr,r=kb.getListBBox(t.slice(1));return i.ext1(r),i.build1()}else return t.bbox()}static doDrawRule(t,i=Gi.PrintStart){if(t.length<2)return[i,i,i];let r=5,n=10,s=t[0],a=Gi.translate(s),o=[],l=i.y,u=i.x,c=i.x;i=i.add(new ie(0,-n));for(let f=1;f<t.length;f++){let g=t[f];if(g instanceof Array){i=i.add(new ie(r,0));let y=this.doDrawRule(g,i);o.push(y[0]),y[1].x<=u&&(u=y[1].x),y[2].x>=c&&(c=y[2].x),i=new ie(y[2].x+r,i.y)}else o.push(i.clone()),i.x<=u&&(u=i.x),i.x>=c&&(c=i.x),Gi.drawText(i,g.name),i=i.add(new ie(r,0))}let h=0;for(let f of o)h+=f.x;let m=new ie(h/o.length,i.y+n);Gi.drawText(m,"N:"+a);for(let f of o){let g=new J(f,m),y=new Array;y.push(g);let b=et.build1(Tb(y));Gi.drawPolyType(b,gt.GREEN)}return[m,new ie(u,l),new ie(c,l)]}static drawRule(t,i=Gi.PrintStart,r=!1,n){Gi.clearDrawing(),this.doDrawRule(t,i),r&&this.doDrawRulePolygon(t,n),Gi.getDebug().draw()}static doDrawRulePolygon(t,i){let r=t[0];for(let n=1;n<t.length;n++){let s=t[n];if(s instanceof Array)this.doDrawRulePolygon(s,i);else{let a=i;r===2&&n===1&&(a=gt.RED),s.name&&Gi.drawText(s.bbox().UL(),s.name,a),Gi.drawPolyType(s,a)}}}static IsCenterBBoxPointInPolygonType(t,i){let r=t.center();for(let n of i.items)if(n.getOutMostPolyline().getWindingNum(r))return!0;return!1}static KeepBBoxPolygonGroup(t,i){let r=i.bbox().intersection1(t);if(!r)return!1;for(let n of i.items)if(n.bbox().isIntersect(r)){for(let s of n.items)if(s.bbox().isIntersect(r)){for(let a of s.primitives)if(r.isIntersect(a.bbox()))return!0}}return!!this.IsCenterBBoxPointInPolygonType(t,i)}},fY=class ql{static createNode(t,i,r){let n=t.UL(),s=t.width()/i,a=t.height()/i,o=~~(r/i),l=r-o*i,u=n.x+l*s,c=n.y-(o+1)*a,h=u+s,m=c+a;return new Zi(u,h,c,m)}static ocTreeSplitNode(t,i,r,n,s=2){if(t.length<=r)return t;let a=[],o=s**2,l=new Array(o),u=new Array(o);for(let f=0;f<o;f++)l[f]=new Array(t.length),u[f]=0;let c=i.UL(),h=i.width()/s,m=i.height()/s;for(let f of t){let g=n(f).center(),y=~~((g.x-c.x)/h),b=~~((c.y-g.y)/m)*s+y;try{l[b][u[b]]=f,u[b]+=1}catch{a.push(f)}}for(let f=0;f<l.length;f++){let g=u[f];if(g<=0)continue;let y=l[f].slice(0,g);if(y.length===t.length)return t;let b=ql.createNode(i,s,f),E=ql.ocTreeSplitNode(y,b,r,n,s);if(E.length===t.length)return t;a.push(E)}return a}static ocTreeSplitNodeMinIntersect(t,i,r,n){let s=[];if(t.length<=r)return t;let a=3,o=i.LL(),l=i.UR(),u=i.width()/(a+1),c=i.height()/(a+1),h=-(2**32),m=[],f=[];for(let g=1;g<=a;g++)for(let y=1;y<=a;y++){let b=o.x+u*g,E=o.y+c*y,S=[[],[],[],[]],v=new Array(4),A=new Array(4);A[0]=new Zi(o.x,b,E,l.y),A[1]=new Zi(b,l.x,E,l.y),A[2]=new Zi(o.x,b,o.y,E),A[3]=new Zi(b,l.x,o.y,E);for(let L of t){let O=n(L).center(),H=-1,k=-1;O.x===b?H=Math.random()>=.5?1:-1:O.x>b?H=1:O.x<b&&(H=-1),O.y===E?k=Math.random()>=.5?1:-1:O.y>E?k=1:O.y<E&&(k=-1),H===1&&k===1?S[1].push(L):H===1&&k===-1?S[3].push(L):H===-1&&k===-1?S[2].push(L):H===-1&&k===1&&S[0].push(L)}for(let L=0;L<4;L++){let O=S[L];if(O.length<=0)continue;let H=new Sr;for(let k of O)H.ext1(n(k));v[L]=H.build1()}let x=0,T=0;for(let L of v)L&&(x+=L.area());T=x;let R=(L,O)=>{if(!v[L]||!v[O])return 0;let H=v[L].intersection1(v[O]);return H?H.area():0};T-=R(0,1),T-=R(0,2),T-=R(0,3),T-=R(1,2),T-=R(1,3),T-=R(2,3),T/x>=h&&(m=S,f=A)}for(let g=0;g<m.length;g++){let y=m[g];if(y.length<=0)continue;let b=f[g],E;if(y.length===t.length?E=ql.ocTreeSplitNode(y,b,r,n):E=ql.ocTreeSplitNodeMinIntersect(y,b,r,n),E.length===t.length)return t;s.push(E)}return s}static ocTreeSplit(t,i,r,n){return ql.ocTreeSplitNode(t,i,r,n,Gi.OcTreeSplitStep)}},mY=class $x{static simplifyRules(t,i){return Gi.UseOptimizeSplit&&(t=this.optimizeSplit(t,i)),t}static OcTreeOptimizeSplit(t){let i=t[0];if(i!==1||t.length<=Gi.LocalBestThread+1)return t;let r=t.slice(1),n=new Array(r.length);for(let u=1;u<t.length;u++)n[u-1]=u;let s=Dc.getListBBox(r),a=fY.ocTreeSplit(n,s,Gi.LocalBestThread,u=>{let c=t[u];return Dc.getSingleBBox(c)}),o=(u,c)=>{if(!(u.length<=0))for(let h of u)if(Array.isArray(h)){let m=[c[0]];o(h,m),c.push(m)}else{let m=t[h];c.push(m)}},l=[i];return o(a,l),l}static optimizeSplit(t,i){let r=t[0];if(r===2){if(Gi.HandleDiff){let s=t[1],a;if(Array.isArray(s)){let o=this.optimizeSplit(s,i);if(o.length<=1)return[2];a=Fb(o,i)}else a=Fb([2,s],i);if(t.length>3){let o;o=[1];for(let l=2;l<t.length;l++){let u=t[l];if(Array.isArray(u)){let c=Dc.getListBBox([...u.slice(1)]);Dc.KeepBBoxPolygonGroup(c,a)&&o.push(u)}else Dc.KeepBBoxPolygonGroup(u.bbox(),a)&&o.push(u)}return o.length<=1?[2,a]:(o=this.optimizeSplit(o,i),o.length>1?[2,a,...o.slice(1)]:[2,a])}else{let o=t[2];if(Array.isArray(o)&&o[0]===1&&o.length>2){let l=o.slice(1);return this.optimizeSplit([2,a,...l],i)}}}else if(t.slice(1).length>2){let s=t[1],a=t.slice(2),o=this.optimizeSplit([1,...a],i);return o.length>1?[2,s,...o.slice(1)]:s}}else if(r===1){if(t.length-1>Gi.LocalBestThread){let s=!1;for(let a=1;a<t.length;a++){let o=t[a];if(!Array.isArray(o)){s=!0;break}}s&&(t=$x.OcTreeOptimizeSplit(t))}}else if(r===0&&t.length<=2)return[0];let n=[r];for(let s=1;s<t.length;s++){let a=t[s];if(Array.isArray(a)){let o=this.optimizeSplit(a,i);if(o.length<=1)continue;n.push(o)}else n.push(a)}return n}},gY=(e=>(e[e.INTERSECT=0]="INTERSECT",e[e.UNION=1]="UNION",e[e.DIFF=2]="DIFF",e[e.XOR=3]="XOR",e))(gY||{});function jc(e){let t=e[0],i=[t];switch(t){case 0:for(let n=1;n<e.length;n++){let s=e[n];if(Array.isArray(s)&&(s=jc(s),!s))return null;i.push(s)}break;case 1:case 3:for(let n=1;n<e.length;n++){let s=e[n];Array.isArray(s)&&(s=jc(s),!s)||i.push(s)}break;case 2:let r=e[1];if(Array.isArray(r)&&(r=jc(r)),!r)return null;i.push(r);for(let n=2;n<e.length;n++){let s=e[n];Array.isArray(s)&&(s=jc(s),!s)||i.push(s)}break;default:throw new Error("not support boolean rule!")}return i.length===1?null:i}function gb(e,t,i){return Array.isArray(e)?Kx(e,t,i):e}function yb(e,t,i,r,n=!0){if(n)for(;e.length>1;){let s,a=[];for(e.length%2===1?(a.push(e[0]),s=1):s=0;s<e.length;s+=2)a.push(t(e[s],e[s+1],i,r));e=a}else for(;e.length>1;){if(e.length===2)return t(e[0],e[1],i,r);e=[t(e[0],e[1],i,r),...e.slice(2)]}return e[0]}function Kx(e,t,i,r=!0){let n=new Array(e.length-1);for(let s=1;s<e.length;s++)n[s-1]=gb(e[s],t,i);switch(e[0]){case 0:return yb(n,Nc.intersect,t,i);case 1:return yb(n,Nc.union,t,i);case 2:let s=yb(n.slice(1),Nc.union,t,i);return s?Nc.diff(n[0],s,t,i):n[0];case 3:let a=gb(e[1],t,i);for(let o=2;o<e.length;o++)a=Nc.xor(a,gb(e[o],t,i),t,i);return a;default:throw new Error("not support boolean rule! "+e[0])}}function Zx(e){let t=[e[0]];for(let i=1;i<e.length;i++){let r=e[i];if(Array.isArray(r)){let n=Zx(r);Array.isArray(n)?n.length>1&&t.push(n):t.push(n)}else{let n=of(r);n!==null&&t.push(Qt.build(n))}}return t}function yY(e,t){Gi.curBus=t,e=Zx(e);let i;return Gi.UseRunArrange?i=mY.simplifyRules(e,t):i=jc(e),i.length<=1?new Qt([]):Fb(i,t)}function Fb(e,t,i=!0){if(!e||e.length===1)return new Qt([]);let r=e,n=new pY,s=[];function a(o){for(let l=1;l<o.length;l++){let u=o[l];Array.isArray(u)?a(u):s.push(u)}}return a(r),n.init(s),Kx(r,n,t,i)}var Np=new Error("list is empty"),Dp=class{constructor(e,t){this.prev=null,this.next=null,this.parent=e,this.item=t}insertAfter(e){e.next=this.next,this.next=e,e.prev=this,e.next!==null&&(e.next.prev=e)}insertBefore(e){e.prev=this.prev,this.prev=e,e.next=this,e.prev!==null&&(e.prev.next=e)}remove(){this.prev!==null&&(this.prev.next=this.next),this.next!==null&&(this.next.prev=this.prev)}set(e){this.item=e}},_Y=class{constructor(e){this._next=e}hasNext(){return this._next!==null}next(){let e=this._next;if(e!==null)return this._next=e.next,e.item;throw new Error("iterator is null")}},bY=class{constructor(e){this._next=e}hasNext(){return this._next!==null}next(){let e=this._next;if(e!==null)return this._next=e.next,e;throw new Error("iterator is null")}},PY=class{constructor(){this.first=null,this.last=null,this.cnt=0}add(e){return this.addLast(e)}push(e){return this.addLast(e)}pop(){return this.removeLast()}shift(){return this.removeFirst()}removeFirst(){let e=this.first;if(e===null)throw Np;return this.remove(e),e.item}removeLast(){let e=this.last;if(e===null)throw Np;return this.remove(e),e.item}addLast(e){if(this.first===null||this.last===null){let t=new Dp(this,e);return this.first=t,this.last=t,this.cnt++,t}else return this.insertAfter(this.last,e)}addFirst(e){if(this.first===null||this.last===null){let t=new Dp(this,e);return this.first=t,this.last=t,this.cnt++,t}else return this.insertBefore(this.first,e)}getFirst(){if(this.first===null)throw Np;return this.first.item}getLast(){if(this.last===null)throw Np;return this.last.item}insertAfter(e,t){let i=new Dp(this,t);return e.insertAfter(i),e===this.last&&(this.last=i),this.cnt++,i}insertBefore(e,t){let i=new Dp(this,t);return e.insertBefore(i),e===this.first&&(this.first=i),this.cnt++,i}remove(e){e.remove(),e===this.first&&(this.first=e.next),e===this.last&&(this.last=e.prev),this.cnt--}size(){return this.cnt}clear(){this.first=null,this.last=null,this.cnt=0}iterator(){return new _Y(this.first)}listIterator(){return new bY(this.first)}toArray(){let e=new Array,t=this.first;for(;t!=null;)e.push(t.item),t=t.next;return e}},Wp=class{constructor(e){this.inters=[],e&&(this.inters=e)}addInter(e){this.inters.push(e),e.group=this}findInter(e){let t=this.inters.find(i=>Ne(i.coord,e.coord));return t&&this.inters.find(i=>i.side===e.side)&&e.visitSelf(),t}getOutInter(e){let t=this.inters.filter(i=>!i.getVisited());if(t.length!==0)return t.length===1?t[0]:t.reduce((i,r)=>{if(!i||i.side.getShape()===e)return r;if(r.side.getShape()===e)return i;let n=i.coord,s=Me(e,n),a=Me(i.side.getShape(),n),o=Me(r.side.getShape(),n);return s.dot(a)>s.dot(o)?i:r},void 0)}getEntryInter(){}},_b=0;function Qx(e,t){let i=e.primitives[0];if(e.primitives.length===1&&i instanceof ue&&Math.abs(i.sweepAngle)===360)return[e];let r=cd();_b++;let n,s=wY(e);if(s.length===0)return[];let a=vY(s);if(_b===-1){n=new ld(t);let c=n.initColor(gt.BLUE);s.forEach(m=>c.addPt(m.getShape()));let h=n.initColor(gt.GREEN);a.forEach(m=>h.addPoint(m.coord)),n.draw();debugger;throw new Error}if(a.length===0)return[et.build7(s.map(c=>c.getShape()))];IY(a);let o=[],l=!1;try{xY(a,n)}catch(c){c.customType==="IS_OVERLAP"?(l=!0,o=new Fc().getUnion([e]).map(h=>h.items).flat(2)):console.error(c)}if(l)return o;let u=CY(a);if(!u.length)return[et.build7(s.map(c=>c.getShape()))];if(o=EY(u,n),o.length===0)return console.warn("=====deSelfIntersection=====",_b),[];if(n)throw o.forEach(c=>{n.initColor(gt.WHITE).addPly(c),n.draw();debugger}),new Error;return Es.deSelfIntersection+=Ua(r),o}function EY(e,t){let i=[];return e.forEach(r=>{let n=r;r.inters.forEach(s=>{if(s.getVisited())return;let a=[],o=[],l;if(t){debugger;let c=t.initColor(gt.RED);l=h=>{a.push(h),c.addPt(a[a.length-1]),t.draw();debugger}}else l=c=>a.push(c);do{let c=function(y,b){de.eq(y.distance2(b),0)||l(eT(f.getShape(),y,b))},h=o.findIndex(y=>y===s.group);if(h!==-1){let y=a.findIndex(S=>S===s.group),b=a.splice(y).filter(S=>!(S instanceof Wp));if(b.length){let S=za(et.build7(b));S&&i.push(S)}let E=a.filter(S=>!(S instanceof Wp));if(s=o[h].getOutInter(E[E.length-1]),o.splice(h),!s)throw Error("interGroup not hav inter!!!2");continue}s.visitSelf(),o.push(s.group),a.push(s.group);let m=s.getIndex(),f=s.side,g=f.inters[m+1];for(;g!=null&&g.isInvalid||g&&g.group===s.group;)g=f.inters[g.getIndex()+1];if(g){c(s.coord,g.coord);let y=g.getBindedInter();if(s=y.getVisited()?y.group.getOutInter(y.side.getShape()):y,!s){if(g.group===n)break;throw new Error("interGroup not hav inter!!!3")}}else{for(c(s.coord,f.getEnd()),f=f.nextSide,s=null;;){for(let y of f.inters)if(!y.isInvalid){let b=y.group.getOutInter(f.getShape());if(!b){if(y.group===n){s=y;break}else if(y.getBindedInter().group===n){s=y.getBindedInter();break}continue}s=b;break}if(s)break;l(f.getShape()),f=f.nextSide}de.eq(f.getEnd().distance2(s.coord),0)?l(f.getShape()):c(f.getStart(),s.coord)}}while(s.group!==n);let u=za(et.build7(a.filter(c=>!(c instanceof Wp))));u&&i.push(u)})}),i}function SY(e){return{next(){return e.hasNext()?{value:e.next()}:{done:!0,value:void 0}},[Symbol.iterator](){return this}}}function vY(e){let t=[],i=new PY;for(let r of e.slice().sort((n,s)=>n.bbox().minY-s.bbox().minY)){for(let n of SY(i.listIterator())){let s=n.item;if(s.bbox().maxY<r.bbox().minY)i.remove(n);else{let a=function(m,f){let g=new ia(f,m,null);return m.inters.push(g),t.push(g),g},o=function(m,f){let g=m.getEnd(),y=new ie(Y[0],Y[1]),b=new ie(Y[2],Y[3]),E=g.distance2(y)>g.distance2(b)?y:b,S=m.prevSide;a(Ne(S.getEnd(),E)?S:m,E).bind(a(f,E))},l=s.getShape(),u=r.getShape(),c=vn(l,u),h=c===4&&Y[0]===Y[2]&&Y[1]===Y[3];if(h&&(c-=2),s.nextSide===r)s.prevSide!==r&&c===4&&o(s,r);else if(s.prevSide===r)c===4&&o(r,s);else if(c!==0){let m=function(g,y){let b=g.prevSide;return a(Ne(b.getEnd(),y)?b:g,y)},f=new ie(Y[0],Y[1]);if(h&&!Ne(f,s.prevSide.getEnd())&&!Ne(f,r.prevSide.getEnd())&&Me(l,f).dot(Me(u,f))>0)continue;for(let g=0;g<c;g+=2){let y=new ie(Y[g],Y[g+1]);m(s,y).bind(m(r,y))}}}}i.add(r)}return t.forEach(r=>{r.getIndex()===void 0&&r.side.sortInters()}),t}function IY(e){e.forEach(t=>{let i=t.side.getEnd();if(t.isInvalid||!Ne(t.coord,i))return;let r=t.side.inters,n=t.getBindedInter().side;for(let s=r.length-1;s>=0;s--){let a=r[s];if(!Ne(a.coord,i))break;a!==t&&a.getBindedInter().side===n&&a.setIsInvalid()}})}function AY(e){let t=new Kc(10);return e.forEach(i=>{i.isInvalid||t.add(i)}),t}function CY(e){let t=[],i=AY(e);return e.forEach(r=>{if(r.isInvalid||r.group)return;let n=i.search(r.bbox().extendOfSize(de.eps)).filter(s=>!s.group);if(n.length){let s=new Set,a=new Wp(n);n.forEach(o=>{o.group=a,s.has(o.side)&&o.visitSelf(),s.add(o.side)}),t.push(a)}}),t}function xY(e,t){e.forEach(i=>{if(i.isInvalid||i.dealed)return;let r=i.side,n=i.getBindedInter().side,s;Ne(r.getEnd(),i.coord)&&Ne(n.getEnd(),i.coord)?s=-1:Ne(r.getEnd(),i.coord)?r.nextSide!==n&&(s=1,i=i.getBindedInter()):Ne(n.getEnd(),i.coord)&&n.nextSide!==r&&(s=1),TY(s,i,t),i.isDealed()})}function TY(e,t,i){let r=t.getBindedInter(),n=t.side,s=r.side,a=n.getShape(),o=s.getShape(),l=1,u=!1;if(e===-1){if(jl(a.reverse(),o.reverse())||jl(n.nextSide.getShape(),s.nextSide.getShape())){let h=ea(n,n.nextSide,s,r,l,u,i);if(h.state===2){let f=new Error("info1.state === InState.IS_OVERLAP");throw f.customType="IS_OVERLAP",f}let m=ea(n,n.nextSide,s.nextSide,r,l,u,i);h.state===m.state&&c(h,m)}else if(!(jl(a.reverse(),s.nextSide.getShape())||jl(n.nextSide.getShape(),o.reverse()))){let h=db(n,n.nextSide,s,!1,i);h===db(n,n.nextSide,s.nextSide,!0,i)&&h!==db(s,s.nextSide,n.nextSide,!0,i)&&t.setIsInvalid()}}else if(e===1){let h=function(m,f){return Me(m,f.start()).dot(Me(f,f.start()))>0};if(jl(a.reverse(),o.reverse())||jl(a,s.nextSide.getShape())){let m=Kr(n,s,r,i,l,u,new Map);if(m.state===2){let g=new Error("info1.state === InState.IS_OVERLAP");throw g.customType="IS_OVERLAP",g}let f=Kr(n,s.nextSide,r,i,l,u,new Map);m.state===f.state&&c(m,f)}else if(h(a.reverse(),o.reverse())&&h(a,s.nextSide.getShape())){let m=Ai(n,s,!1,i);m===Ai(n,s.nextSide,!0,i)&&m!==zo(s,s.nextSide,new ud(eT(a,t.coord,a.end()),i),!0,i)&&t.setIsInvalid()}}function c(h,m){h.inter.setIsInvalid(),m.inter.setIsInvalid(),t.setIsInvalid()}}function eT(e,t,i){if(e instanceof J||t.distance2(i)<1e-6)return new J(t,i);if(e instanceof ue)return ue.build2(e.center,t.angleD(e.center),i.angleD(e.center),e.rx,e.ry,e.sweep());if(e instanceof Te){let r=e.getPercent(t,ke),n=e.getPercent(i,ke);return e.clip(r)[1].clip((n-r)/(1-r))[0]}else throw new Error("not supported operation")}function wY(e){let t=za(e);if(!t)return[];let i=t.primitives.map(n=>new ud(n,null)),r=i[i.length-1];return i.forEach(n=>{r.connect(n),r=n}),i}var sa,RY=(sa=class{static clearData(t){this.originalPrimitive=[],this.offsetPrimitive=[],this.rawOffsetPrimitive=[],this.offsetDistance=0,this.testI++,this.testI===0?this.drawDebug=new ld(t):delete this.drawDebug}static createRawOffsetEdge(){if(this.drawDebug){let t=this.drawDebug.initColor(gt.WHITE);this.originalPrimitive.forEach(i=>t.addPt(i)),this.drawDebug.draw();debugger}for(let t=0;t<this.originalPrimitive.length;t+=1){let i=this.originalPrimitive[t];this.offsetPrimitive.push({index:t,offsetEdge:this.createOffsetEdge(i)})}if(this.drawDebug){let t=this.drawDebug.initColor(gt.Golden);this.offsetPrimitive.forEach(i=>t.addPt(i.offsetEdge)),this.drawDebug.draw();debugger}if(this.offsetPrimitive.length>1)for(let t=0;t<this.offsetPrimitive.length;t+=1)if(t===this.offsetPrimitive.length-1){this.connectPrimitive(this.offsetPrimitive[t],this.offsetPrimitive[0]);let i=this.rawOffsetPrimitive[0],r;i instanceof ue?r=ue.build4(this.offsetPrimitive[0].offsetEdge.start(),i.end(),i.center,i.rx,i.ry,i.sweep()):r=new J(this.offsetPrimitive[0].offsetEdge.start(),i.end()),this.rawOffsetPrimitive.shift(),this.rawOffsetPrimitive.unshift(r)}else this.connectPrimitive(this.offsetPrimitive[t],this.offsetPrimitive[t+1]);else this.rawOffsetPrimitive=[]}static createCirclePrimitive(t,i){let r=t.width()*.5,n=t.height()*.5,s=Math.sqrt(r**2+n**2)+i;return[ue.buildCircle(t.center(),s)]}static getExtendPolyLine(t,i,r=!0,n){var o,l;if(!((o=t==null?void 0:t.primitives)!=null&&o.length))return[];let s=za(t);if(!((l=s==null?void 0:s.primitives)!=null&&l.length)){if(this.isExpansion){let u=[1],c=i*2;t.primitives.forEach(m=>u.push(m.stroke(c,1,0)));let h=yY(u,n);if(h.items.length!==1)throw new Error("group.items.length !== 1 ");return[h.items[0].items[0]]}return[]}if(t=s,this.clearData(n),this.originalPrimitive=t.primitives,this.isExpansion=i>0,this.offsetDistance=i,this.createRawOffsetEdge(),this.drawDebug){let u=this.drawDebug.initColor(gt.BLUE);this.rawOffsetPrimitive.forEach(c=>u.addPt(c)),this.drawDebug.draw();debugger}let a=r?this.createClippingEdge(n):[et.build2(this.rawOffsetPrimitive)];if(this.drawDebug){let u=this.drawDebug.initColor(gt.RED);a.forEach(c=>u.addPly(c)),this.drawDebug.draw();debugger}if(a.length&&(!this.isExpansion||this.isExpansion&&a.length>1)&&(a=this.getValidityPrimitive(a)),this.drawDebug){let u=this.drawDebug.initColor(gt.GREEN);a.forEach(c=>u.addPly(c)),this.drawDebug.draw();debugger;throw new Error}return a}static getValidityPrimitive(t){let i=[],r=Math.abs(this.offsetDistance);for(let n=0;n<t.length;n+=1){let s=!0,a=t[n].primitives;e:for(let o=0;o<a.length;o+=1){let l=a[o],u;if(l instanceof ue)u=l.midPoint;else if(l instanceof J)u=l.start();else throw new Error("not support!");for(let c=0;c<this.originalPrimitive.length;c+=1){let h=this.originalPrimitive[c],m;if(h instanceof ue?m=this.pointArcClosest(u,h):m=dj(u,h.start(),h.end()).d,r-m>.01){s=!1;break e}}}s&&i.push(t[n])}return i}static getInters(t){let i=[];for(let r=0;r<t;r+=2)i.push(new ie(Y[r],Y[r+1]));return i}static pointArcClosest(t,i){let r=i.center;if(t.equals1(i.center))return i.rx;if(i.inArea(t,0)){let a=t.sub(r);return Math.abs(a.length()-i.rx)}let n=t.distance2(i.start()),s=t.distance2(i.end());return de.less(n,s)?Math.sqrt(n):Math.sqrt(s)}static createClippingEdge(t){let i=[],r=[],n=Qx(et.build2(this.rawOffsetPrimitive),t);n.forEach(a=>{let o=a.area(.01);i.push(o)});let s=Math.min(...i.filter(a=>a<0));for(let a=0;a<i.length;a+=1){let o=i[a];de.eq(o,0)||(!this.isExpansion&&o<0||this.isExpansion&&(o<0&&i[a]===s||o>0))&&r.push(n[a])}return r}static createOffsetEdge(t){if(t instanceof ue)return t.panDistance1(this.offsetDistance);if(t instanceof J)return t.panDistance(this.offsetDistance);throw new Error("not support!")}static connectPrimitive(t,i){t.offsetEdge instanceof J&&i.offsetEdge instanceof J?this.lineToLineConnect(t,i):t.offsetEdge instanceof ue&&i.offsetEdge instanceof ue?this.arcToArcConnect(t,i):t.offsetEdge instanceof J&&i.offsetEdge instanceof ue?this.lineToArcConnect(t,i):this.arcToLineConnect(t,i)}static isFalseIntersection(t){return t>1||t<0}static lineToLineConnect(t,i){let r=t.offsetEdge,n=i.offsetEdge,s=i.index,a=this.originalPrimitive[s].start();if(r.isParallel(n))r.bbox().intersection1(n.bbox())?this.rawOffsetPrimitive.push(r):this.lineToLineUseArcToConnect(a,r,n);else{let o=this.getLineToLineT(r,n),l=o[0],u=o[1];if(this.isFalseIntersection(l)||this.isFalseIntersection(u))l>1&&this.isFalseIntersection(u)?this.lineToLineUseArcToConnect(a,r,n):this.useLineToConnect(r,n);else if(!this.isFalseIntersection(l)&&!this.isFalseIntersection(u)){let c=r.end().sub(r.start()),h=r.start().add(c.mul(l)),m=new J(r.start(),h);this.rawOffsetPrimitive.push(m);let f=new J(h,n.end());this.updateNextOffsetPrimitive(s,f)}}}static updateNextOffsetPrimitive(t,i){this.offsetPrimitive[t].offsetEdge=i}static useLineToConnect(t,i){this.rawOffsetPrimitive.push(t);let r=new J(t.end(),i.start());this.rawOffsetPrimitive.push(r)}static lineToLineUseArcToConnect(t,i,r){let n=this.getSweep(t,i),s=this.getSweepAngel(i.end(),r.start(),t,n);if(s===0){this.useLineToConnect(i,r);return}this.rawOffsetPrimitive.push(i);let a=ue.build5(i.end(),r.start(),s);this.rawOffsetPrimitive.push(a)}static getSweep(t,i,r){let n=null,s=r||r===0?this.originalPrimitive[r]:i;if(s instanceof ue){let a=s.center.sub(s.end()).normalize();s.isCCW?n=new ie(a.y,-a.x):n=new ie(-a.y,a.x)}else n=i.end().sub(i.start()).normalize();return t.sub(i.end()).normalize().cross(n)>0?0:1}static getLineToLineT(t,i){let r=t.end().sub(t.start()),n=i.end().sub(i.start()),s=r.cross(n),a=i.start().sub(t.start()),o=t.start().sub(i.start()),l=a.cross(n)/s,u=o.cross(r)/-s;return[l,u]}static lineToArcConnect(t,i){let r=t.offsetEdge,n=i.offsetEdge,s=t.index,a=i.index,o=this.getLineJoinArcScalarAndIntersectionNum(r,n),l=this.originalPrimitive[a].start();if(o.intersectionNum===0)this.lineAndArcUseArcConnect(l,r,n,s);else if(o.intersectionNum===1){let u=o.points[0];this.lineAndArcConnectionDetail(r,n,o.t[0],u,l,s,a)}else if(o.intersectionNum===2){let u=o.points[0],c=o.points[1],h=u.distance2(l),m=c.distance2(l);this.lineAndArcConnectionDetail(r,n,h<m?o.t[0]:o.t[1],h<m?u:c,l,s,a)}}static lineAndArcConnectionDetail(t,i,r,n,s,a,o){let l=this.isTrueArcIntersection(i,n);if(!this.isFalseIntersection(r)&&l){let u=new J(t.start(),n);this.rawOffsetPrimitive.push(u);let c;!i.center.equals1(n)||i.sweepAngle>1e-4?(c=ue.build4(n,i.end(),i.center,i.rx,i.ry,i.sweep()),c instanceof ue&&c.sweepAngle===0&&(c=new J(c.start(),c.end()))):c=new J(i.center,n),this.updateNextOffsetPrimitive(o,c)}else l?this.useLineToConnect(t,i):this.lineAndArcUseArcConnect(s,t,i,a)}static lineAndArcUseArcConnect(t,i,r,n){let s=this.getSweep(t,i,n),a=this.getSweepAngel(i.end(),r.start(),t,s);if(a===0){this.useLineToConnect(i,r);return}let o=ue.build5(i.end(),r.start(),a);this.rawOffsetPrimitive.push(i),this.rawOffsetPrimitive.push(o)}static arcToLineConnectionDetail(t,i,r,n,s,a,o){let l=this.isTrueArcIntersection(t,n);if(!this.isFalseIntersection(r)&&l){let u;t.center.equals1(n)?u=new J(t.center,n):Math.abs(t.sweepAngle)<1e-4?u=new J(t.start(),n):(u=ue.build4(t.start(),n,t.center,t.rx,t.ry,t.sweep()),u instanceof ue&&u.sweepAngle===0&&(u=new J(u.start(),u.end()))),this.rawOffsetPrimitive.push(u);let c=new J(n,i.end());this.updateNextOffsetPrimitive(o,c)}else l?this.useLineToConnect(t,i):this.lineAndArcUseArcConnect(s,t,i,a)}static isTrueArcIntersection(t,i){return ri(t,i)}static getSweepAngel(t,i,r,n){let s=t.angleD(r),a=i.angleD(r),o;return s===a?o=0:(s=Ye.regularD(s),a=Ye.regularD(a),n===1?a<=s&&(a+=360):a>=s&&(s+=360),o=a-s),o}static getLineJoinArcScalarAndIntersectionNum(t,i){let r={t:[],intersectionNum:0,points:[]},n=lj(i,t);if(n){r.intersectionNum=n/2;for(let s=0;s<n-1;s+=2){let a=new ie(Y[s],Y[s+1]);r.points.push(a),a.sub(t.start()).x<1e-4||a.sub(t.start()).y<1e-4?r.t.push(0):r.t.push(a.sub(t.start()).x/t.end().sub(t.start()).x)}}else r.intersectionNum=0;return r}static arcToLineConnect(t,i){let r=t.offsetEdge,n=i.offsetEdge,s=t.index,a=i.index,o=this.getLineJoinArcScalarAndIntersectionNum(n,r),l=this.originalPrimitive[a].start();if(o.intersectionNum===0)this.lineAndArcUseArcConnect(l,r,n,s);else if(o.intersectionNum===1){let u=o.points[0];this.arcToLineConnectionDetail(r,n,o.t[0],u,l,s,a)}else if(o.intersectionNum===2){let u=o.points[0],c=o.points[1],h=u.distance2(l),m=c.distance2(l);this.arcToLineConnectionDetail(r,n,h<m?o.t[0]:o.t[1],h<m?u:c,l,s,a)}}static rxChangeStatus(t){return t===1?!this.isExpansion:this.isExpansion}static arcToArcConnect(t,i){let r=t.offsetEdge,n=i.offsetEdge,s=Dx(r,n);if(s){let a=this.getInters(s),o;if(a.length===2){let c=this.originalPrimitive[i.index].start(),h=a[0],m=a[1],f=h.distance2(c),g=m.distance2(c);f<g?o=h:o=m}else o=a[0];let l,u;o.equals1(r.center)?l=new J(r.center,o):Math.abs(r.sweepAngle)<1e-4?l=new J(r.start(),o):(l=ue.build4(r.start(),o,r.center,r.rx,r.ry,r.sweep()),l instanceof ue&&l.sweepAngle===0&&(l=new J(l.start(),l.end()))),this.rawOffsetPrimitive.push(l),o.equals1(n.center)?u=new J(o,n.center):Math.abs(n.sweepAngle)<1e-4?u=new J(o,n.end()):(u=ue.build4(o,n.end(),n.center,n.rx,n.ry,n.sweep()),u instanceof ue&&u.sweepAngle===0&&(u=new J(u.start(),u.end()))),this.updateNextOffsetPrimitive(i.index,u)}else{let a=this.originalPrimitive[t.index],o=this.originalPrimitive[i.index],l=this.rxChangeStatus(a.sweep()),u=this.rxChangeStatus(o.sweep()),c=this.originalPrimitive[i.index].start(),h=this.getSweep(c,r,t.index),m=Math.abs(this.offsetDistance),f=ue.build2(c,l?a.endAngle():a.endAngle()+180,u?o.startAngle:o.startAngle+180,m,m,h);this.rawOffsetPrimitive.push(r),this.rawOffsetPrimitive.push(f)}}},sa.originalPrimitive=[],sa.offsetPrimitive=[],sa.rawOffsetPrimitive=[],sa.testI=0,sa),LY=class Yc extends ad{constructor(t,i,r,n,s,a){if(super(),i<0||r<0)throw new Error("The width and height of rect can't be less than 0!");this.leftUpPoint=t,this.width=i,this.height=r,this.angle=n,this.isCCW=s,this.radius=Math.min(Math.max(a,0),i/2,r/2)}get radiusRatio(){return this.radius/Math.min(this.width,this.height)}start(){return this.leftUpPoint.add(new ie(this.radius,0).multiply3(Pt.rotateD(this.angle)))}end(){return this.start()}getLeftPoint(){return this.leftUpPoint.add(new ie(0,-this.height/2).multiply3(Pt.rotateD(this.angle)))}getRightPoint(){return this.leftUpPoint.add(new ie(this.width,-this.height/2).multiply3(Pt.rotateD(this.angle)))}extend(t){return new Yc(this.leftUpPoint.add(new ie(-t,t).rotateD(ie.ORIGIN,this.angle)),this.width+t*2,this.height+t*2,this.angle,this.isCCW,this.radius+t)}bbox(){let t=Pt.rotateD(this.angle),{leftUpPoint:i,width:r,height:n,radius:s}=this,a=i.add(new ie(s,-s).multiply3(t)),o=i.add(new ie(s,s-n).multiply3(t)),l=i.add(new ie(r-s,-s).multiply3(t)),u=i.add(new ie(r-s,s-n).multiply3(t));return new Zi(Math.min(a.x,o.x,l.x,u.x)-s,Math.max(a.x,o.x,l.x,u.x)+s,Math.min(a.y,o.y,l.y,u.y)-s,Math.max(a.y,o.y,l.y,u.y)+s)}toPolyline(){let t=[],{leftUpPoint:i,width:r,height:n,radius:s}=this;if(s===0){let o=ie.ORIGIN,l=new ie(r,0),u=new ie(r,-n),c=new ie(0,-n);t.push(new J(o,l),new J(l,u),new J(u,c),new J(c,o))}else{let o=new ie(0,-s),l=new ie(s,0),u=new ie(r-s,0),c=new ie(r,-s),h=new ie(r,s-n),m=new ie(r-s,-n),f=new ie(s,-n),g=new ie(0,s-n);t.push(ue.build1(o,l,s,s,!1,0),new J(l,u),ue.build1(u,c,s,s,!1,0),new J(c,h),ue.build1(h,m,s,s,!1,0),new J(m,f),ue.build1(f,g,s,s,!1,0),new J(g,o))}t=t.filter(o=>!o.start().equals1(o.end())),this.isCCW&&(t.forEach((o,l)=>t[l]=o.reverse()),t.reverse());let a=Pt.rotateD(this.angle).translate1(i);return et.build2(t.map(o=>o.multiply3(a)))}center(){return this.leftUpPoint.add1(this.width/2,this.height/2).rotateD(this.leftUpPoint,this.angle)}multiply3(t){let i=this.leftUpPoint.multiply3(t),r=new ie(this.width,0).multiply3(Pt.rotateD(this.angle)).multiply3(t),n=new ie(0,-this.height).multiply3(Pt.rotateD(this.angle)).multiply3(t);return t.isMirrored()?new Yc(i,n.length(),r.length(),n.angleD(ie.ORIGIN),this.isCCW===1?0:1,this.radius*r.length()/this.width):new Yc(i,r.length(),n.length(),r.angleD(ie.ORIGIN),this.isCCW,this.radius*r.length()/this.width)}reverse(){return new Yc(this.leftUpPoint,this.width,this.height,this.angle,this.isCCW===1?0:1,this.radius)}stroke(t,i,r){let n=this.stroke1(t,i,r);if(n.length===1)return n[0];{let[s,a]=n;return et.build2(s.primitives.concat(new J(s.primitives[0].start(),a.primitives[0].start()),a.primitives,new J(a.primitives[0].start(),s.primitives[0].start())))}}stroke1(t,i,r){let n=r===this.isCCW?this:this.reverse(),s=t/2,a=Math.min(n.width,n.height)/2,o=n.extend(s).toPolyline();return a<=s?[o]:[o,n.extend(-s).toPolyline().reverse()]}points(t){let i=this.toPolyline(),r=[];return i.points(t,n=>r.push(n)),r}toBezier(){throw new Error("Method not implemented.")}},NY=.01,mi=class Yn{static simplify(t){return t=za(t),t?new Yn([t]):null}static buildByStroke(t,i,r=1,n=a0,s){if(t instanceof ue&&(t.rx<i/2+NY||Math.abs(t.sweepAngle)>180&&de.lesseq(t.start().distance1(t.end()),i))){let o=Qx(t.stroke(i,r,0),s);if(o.length===0)return null;if(o.length===1)return new Yn(o);let l=[null],u=Number.POSITIVE_INFINITY;return o.forEach(c=>{let h=c.area(.1);h<0?h<u&&(l[0]=c,u=h):l.push(c)}),new Yn(l)}else if(t instanceof LY){let o=t.stroke1(i,r,0).map(l=>za(l));return o[0]?o[1]?new Yn(o):new Yn([o[0]]):null}let a=t.stroke(i,r,0,n);return a?this.simplify(a):null}static buildCircle(t,i){return this.simplify(et.build7([ue.buildCircle(t,i,0)]))}static buildRect(t){return this.simplify(t.toPolyline())}static buildBBox(t){return this.simplify(et.buildBBox(t,0))}constructor(t){this.items=t.slice()}multiply3(t){return new Yn(this.items.map(i=>i.multiply3(t)))}bbox(){return this.items[0].bbox()}isEqual(t){return t instanceof Yn?this.items.every(i=>t.items.some(r=>r.isEqual(i))):!1}getOutMostPolyline(){return this.items[0]}extend(t,i){if(this.items.length!==1)throw new Error("this.items.length !== 1");if(t===0)return new Qt([this]);let r=this.items[0],n=[];for(let c of r.primitives)if(c instanceof J)n.push(c);else if(c instanceof ue&&c.rx===c.ry)a(c);else if(c instanceof Te)s(c);else throw new Error("not support!");r=et.build7(n);function s(c){let h=c.points(.1);for(let m=0;m<h.length-1;m++){let f=h[m],g=h[m+1];n.push(new J(f,g))}}function a(c){if(Math.abs(c.sweepAngle)>270){let h=c.sweepAngle/2;a(ue.build3(c.center,c.startAngle,h,c.rx,c.ry)),a(ue.build3(c.center,c.startAngle+h,h,c.rx,c.ry))}else n.push(c)}let o=[],l=[];RY.getExtendPolyLine(r,t,!0,i).forEach(c=>{(c.area(.1)>0?l:o).push(c)});let u;if(o.length===1)l.forEach(c=>o.push(c)),u=new Qt([new Yn(o)]);else if(o.length===0)console.warn("outlines.length === 0"),u=new Qt([]);else if(l.length===0)u=new Qt(o.map(c=>new Yn([c])));else{let c=o.map(h=>[h]);l.forEach(h=>{let m=[],f=h.bbox();if(c.forEach(g=>{g[0].bbox().isContainsBBox1(f)&&m.push(g)}),m.length===1)m[0].push(h);else{if(m.length===0)throw new Error("inPlsArr.length === 0");for(let g of m.sort((y,b)=>y[0].bbox().area()-b[0].bbox().area()))if(g[0].getWindingNum(h.start())===-1){g.push(h);break}}}),u=new Qt(c.map(h=>new Yn(h)))}return u}toPolylineGroup(){return new o0(this.items)}};var DY=(e=>(e[e.POLYGON=1]="POLYGON",e[e.POLYLINE=2]="POLYLINE",e[e.LINE=3]="LINE",e[e.ARC=4]="ARC",e[e.BEZIER2=5]="BEZIER2",e[e.BEZIER3=6]="BEZIER3",e[e.BOOLEAN_OUTPUT=7]="BOOLEAN_OUTPUT",e[e.BOOLEAN_INTERSECTION=8]="BOOLEAN_INTERSECTION",e[e.BOOLEAN_UNION=9]="BOOLEAN_UNION",e[e.BOOLEAN_DIFF=10]="BOOLEAN_DIFF",e[e.BOOLEAN_RESULT=11]="BOOLEAN_RESULT",e[e.LINES=12]="LINES",e[e.ARCS=13]="ARCS",e[e.BEZIER2S=14]="BEZIER2S",e[e.BEZIER3S=15]="BEZIER3S",e[e.CIRCLE_CW=16]="CIRCLE_CW",e[e.CIRCLE_CCW=17]="CIRCLE_CCW",e[e.POLYGON_GROUP=18]="POLYGON_GROUP",e))(DY||{});var BY=class{constructor(e){this.idx=-1,this.lst=e}hasNext(){return this.idx<this.lst.length-1}next(){if(this.idx<this.lst.length-1)return this.idx++,this.lst[this.idx];throw new Error("bug")}};function OY(e){return new BY(e)}function MY(e){return e===32||e===9||e===13||e===10}var kY=class{constructor(){this._line=1,this._col=0}line(){return this._line}col(){return this._col}_feed(e){return e===10?(this._col=0,this._line++):this._col++,this.feed(e)}parse(e){let t=e.length;for(let i=0;i<t;i++){let r=e.charCodeAt(i);if(!this._feed(r))return this}return this.finish(),this}},bb=class{static repeat(e,t){let i=new Array(t);for(;t-- >0;)i[t]=e;return i.join("")}static lpad(e,t,i){let r=i-e.length;return r>0?this.repeat(t,r)+e:e}},FY=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.PERCENT=1]="PERCENT",e[e.LEFT_PAD0=2]="LEFT_PAD0",e))(FY||{}),UY=/(\.?0+)$/,Ub=class{static format(e,...t){return this.format1(e,t)}static format1(e,t){let i=this._format(e,t);if(typeof i=="string")return i;throw new Error(this.format("Invalid state on (%d) %s",i,e))}static _format(e,t){let i=[],r=0,n=0,s,a=0,o=0;for(let l=0;l<e.length;l++){let u=e.charAt(l),c=u.charCodeAt(0);switch(r){case 0:c===37?r=1:i.push(u);break;case 1:switch(c){case 100:if(s=t[n++],typeof s=="number")i.push(s.toFixed(0)),r=0;else return l;break;case 102:if(s=t[n++],typeof s=="number")i.push(s.toString()),r=0;else return l;break;case 120:if(s=t[n++],typeof s=="number")i.push((s|0).toString(16)),r=0;else return l;break;case 88:if(s=t[n++],typeof s=="number")i.push((s|0).toString(16).toUpperCase()),r=0;else return l;break;case 115:case 99:s=t[n++],i.push(s===null?"null":s.toString()),r=0;break;case 48:a=l+1,o=-1,r=2;break;case 37:i.push("%"),r=0;break;default:return l}break;case 2:switch(c){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:o=l;break;case 100:if(o>=a){let h=parseInt(e.substring(a,o+1));if(s=t[n++],typeof s=="number")i.push(bb.lpad((s|0).toString(10),"0",h)),r=0;else return l}else return l;break;case 120:if(o>=a){let h=parseInt(e.substring(a,o+1));if(s=t[n++],typeof s=="number")i.push(bb.lpad((s|0).toString(16),"0",h)),r=0;else return l}else return l;break;case 88:if(o>=a){let h=parseInt(e.substring(a,o+1));if(s=t[n++],typeof s=="number")i.push(bb.lpad((s|0).toString(16).toUpperCase(),"0",h)),r=0;else return l}else return l;break;default:return l}break;default:return l}}return i.join("")}static startsWith(e,t){return e.length>=t.length?e.substring(0,t.length)===t:!1}static endsWith(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}static fmtNumber(e){return e.toFixed(5).replace(UY,"")}},HY=(e=>(e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARNING=2]="WARNING",e[e.ERROR=3]="ERROR",e[e.DUMMY=4]="DUMMY",e))(HY||{});function jY(e){switch(e){case 0:return"DEBUG";case 1:return"INFO";case 2:return"WARNING";case 3:return"ERROR";case 4:return"DUMMY"}}var YY=(e,t)=>{e===3?console.error(...t):e===2?console.warn(...t):console.log(...t)},GY=(e,t)=>[jY(e)].concat(t),aa,WY=(aa=class{static mix(...t){return new aa(0,(i,r)=>{for(let n of t)n.write(i,r)},(i,r)=>r)}constructor(t,i=YY,r=GY){this.level=t,this.writer=i,this.fmt=r}setLevel(t){this.level=t}prepend(t=null,i=null){let r=t===null?this.fmt:(s,a)=>(a=t(s,a),this.fmt(s,a)),n=i===null?this.writer:(s,a)=>{i(s,a),this.writer(s,a)};return new aa(this.level,n,r)}chain(t){return t.prepend(this.fmt.bind(this),this.writer.bind(this))}include(t){return this.level<=t}formatWrite(t,i,r){this.include(t)&&this.writer(t,this.fmt(t,[Ub.format(i,...r)]))}write(t,i){this.include(t)&&this.writer(t,this.fmt(t,i))}write3(t,i,r){this.include(t)&&this.writer(t,this.fmt(t,[Ub.format(i,...r)]))}debug3(t,...i){this.write3(0,t,i)}warning3(t,...i){this.write3(2,t,i)}debugFmt(t,...i){this.formatWrite(0,t,i)}debug(...t){this.write(0,t)}infoFmt(t,...i){this.formatWrite(1,t,i)}info(...t){this.write(1,t)}warningFmt(t,...i){this.formatWrite(2,t,i)}warning(...t){this.write(2,t)}errorFmt(t,...i){this.formatWrite(3,t,i)}error(...t){this.write(3,t)}},aa.DUMMY=new aa(4),aa),Pb=500,XC=String.fromCharCode,zY=class{constructor(){this.buffer=new Array}size(){return this.buffer.length}isEOF(){return!1}write(e){return this.buffer.push(e),1}writen1(e){return this.writen2(e,0,e.length)}writen2(e,t,i){let r=this.buffer;for(let n=0,s=t;n<i;n++,s++)r.push(e[s]);return i}writeAsync(e,t){t(this.write(e))}writenAsync1(e,t){t(this.writen1(e))}writenAsync2(e,t,i,r){r(this.writen2(e,t,i))}writeStr(e){let t=e.length,i=new Array(t);for(let r=0;r<t;r++)i[r]=e.charCodeAt(r);return this.writen1(i)}clear(){this.buffer.length=0}toString(){let e=this.buffer,t=e.length;if(t<=Pb)return XC.apply(null,e);{let i=new Array;for(let r=0;r<e.length;r+=Pb){let n=Math.min(t-r,Pb),s=XC.apply(null,e.slice(r,r+n));i.push(s)}return i.join("")}}},tT=(e=>(e[e.UNKNOW=0]="UNKNOW",e[e.NUMBER_INTEGER=1]="NUMBER_INTEGER",e[e.NUMBER_DECIMAL=2]="NUMBER_DECIMAL",e[e.NUMBER_E=3]="NUMBER_E",e[e.NUMBER_E_SIGNED=4]="NUMBER_E_SIGNED",e))(tT||{}),iT=(e=>(e[e.UNKNOW=0]="UNKNOW",e[e.MOVE_X=1]="MOVE_X",e[e.MOVE_Y=2]="MOVE_Y",e[e.LINE_X=3]="LINE_X",e[e.LINE_Y=4]="LINE_Y",e[e.HORIZONTAL_X=5]="HORIZONTAL_X",e[e.VERTICAL_Y=6]="VERTICAL_Y",e[e.CUBIC_BEZIER_X1=7]="CUBIC_BEZIER_X1",e[e.CUBIC_BEZIER_Y1=8]="CUBIC_BEZIER_Y1",e[e.CUBIC_BEZIER_X2=9]="CUBIC_BEZIER_X2",e[e.CUBIC_BEZIER_Y2=10]="CUBIC_BEZIER_Y2",e[e.CUBIC_BEZIER_X=11]="CUBIC_BEZIER_X",e[e.CUBIC_BEZIER_Y=12]="CUBIC_BEZIER_Y",e[e.ARC_RX=13]="ARC_RX",e[e.ARC_RY=14]="ARC_RY",e[e.ARC_ROTATION=15]="ARC_ROTATION",e[e.ARC_LARGE=16]="ARC_LARGE",e[e.ARC_SWEEP=17]="ARC_SWEEP",e[e.ARC_X=18]="ARC_X",e[e.ARC_Y=19]="ARC_Y",e[e.SMOOTH_CUBIC_BEZIER_X2=20]="SMOOTH_CUBIC_BEZIER_X2",e[e.SMOOTH_CUBIC_BEZIER_Y2=21]="SMOOTH_CUBIC_BEZIER_Y2",e[e.SMOOTH_CUBIC_BEZIER_X=22]="SMOOTH_CUBIC_BEZIER_X",e[e.SMOOTH_CUBIC_BEZIER_Y=23]="SMOOTH_CUBIC_BEZIER_Y",e[e.QUADRATIC_BEZIER_X1=24]="QUADRATIC_BEZIER_X1",e[e.QUADRATIC_BEZIER_Y1=25]="QUADRATIC_BEZIER_Y1",e[e.QUADRATIC_BEZIER_X=26]="QUADRATIC_BEZIER_X",e[e.QUADRATIC_BEZIER_Y=27]="QUADRATIC_BEZIER_Y",e))(iT||{});function VY(e){return 97<=e&&e<=122||65<=e&&e<=90}function vi(e){let t=parseFloat(e);if(isFinite(t))return t;throw new Error("expect number")}var JC=class extends kY{constructor(e,t=!0,i=WY.DUMMY){super(),this.buffer=new zY,this.group=new Array,this.subPartStart=ie.ORIGIN,this.curPoint=ie.ORIGIN,this.lexState=0,this.parseState=0,this.isAbsolute=!1,this.isLargeArc=!1,this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=Number.NaN,this.y=Number.NaN,this.rx=Number.NaN,this.ry=Number.NaN,this.rotation=Number.NaN,this.sweep=Fa.CCW,this.prevBezierCtrl2=null,this.logger=i,this.cb=e,this.yAxis=t?-1:1}on(e){return this.cb(e)}feed(e){switch(this.logger.include(0)&&this.logger.debug3("L: %c(%s)|%s",e,String.fromCharCode(e),tT[this.lexState]),this.lexState){case 0:return MY(e)?!0:48<=e&&e<=57||e===45||e===43?(this.pushBuffer(e),this.lexState=1,!0):e===46?(this.pushBuffer(e),this.lexState=2,!0):VY(e)?this.feedS(String.fromCharCode(e)):(this.logger.warning3("unknow letter %c",e),!0);case 1:return 48<=e&&e<=57?(this.pushBuffer(e),!0):e===46?(this.pushBuffer(e),this.lexState=2,!0):e===101||e===69?(this.pushBuffer(e),this.lexState=3,!0):this.feedS(this.getCleanBuffer())?(this.lexState=0,this.feed(e)):!1;case 2:return 48<=e&&e<=57?(this.pushBuffer(e),!0):e===101||e===69?(this.pushBuffer(e),this.lexState=3,!0):this.feedS(this.getCleanBuffer())?(this.lexState=0,this.feed(e)):!1;case 3:return 48<=e&&e<=57?(this.pushBuffer(e),!0):e===45||e===43?(this.pushBuffer(e),this.lexState=4,!0):this.feedS(this.getCleanBuffer())?(this.lexState=0,this.feed(e)):!1;case 4:return 48<=e&&e<=57?(this.pushBuffer(e),!0):this.feedS(this.getCleanBuffer())?(this.lexState=0,this.feed(e)):!1;default:return!0}}finish(){this.feed(32),this.tryNotify()}feedS(e){switch(this.logger.include(0)&&this.logger.debug3("P: %s|%s|%s|%s",e,iT[this.parseState],this.curPoint,this.subPartStart),this.parseState){case 0:switch(e){case"M":this.isAbsolute=!0,this.parseState=1;break;case"m":this.isAbsolute=!1,this.parseState=1;break;case"L":this.isAbsolute=!0,this.parseState=3;break;case"l":this.isAbsolute=!1,this.parseState=3;break;case"H":this.isAbsolute=!0,this.parseState=5;break;case"h":this.isAbsolute=!1,this.parseState=5;break;case"V":this.isAbsolute=!0,this.parseState=6;break;case"v":this.isAbsolute=!1,this.parseState=6;break;case"z":case"Z":{this.group.push(new J(this.curPoint,this.subPartStart));let r=this.tryNotify();return this.curPoint=this.subPartStart,r}case"C":this.isAbsolute=!0,this.parseState=7;break;case"c":this.isAbsolute=!1,this.parseState=7;break;case"S":this.isAbsolute=!0,this.parseState=20;break;case"s":this.isAbsolute=!1,this.parseState=20;break;case"A":this.isAbsolute=!0,this.parseState=13;break;case"a":this.isAbsolute=!1,this.parseState=13;break;case"Q":this.isAbsolute=!0,this.parseState=24;break;case"q":this.isAbsolute=!1,this.parseState=24;break;default:this.logger.warning3("unknow %s",e)}return!0;case 1:let t=this.tryNotify();return this.x=vi(e),this.parseState=2,t;case 2:{this.y=this.yAxis*vi(e);let r;return this.isAbsolute?r=new ie(this.x,this.y):r=this.curPoint.add1(this.x,this.y),this.curPoint=r,this.subPartStart=r,this.parseState=3,!0}case 3:return this.x=parseFloat(e),isFinite(this.x)?(this.parseState=4,!0):(this.parseState=0,this.feedS(e));case 4:{this.y=this.yAxis*vi(e);let r;return this.isAbsolute?r=new ie(this.x,this.y):r=this.curPoint.add1(this.x,this.y),this.group.push(new J(this.curPoint,r)),this.curPoint=r,this.parseState=3,!0}case 5:if(this.x=parseFloat(e),isFinite(this.x)){let r;return this.isAbsolute?r=new ie(this.x,this.curPoint.y):r=this.curPoint.add1(this.x,0),this.group.push(new J(this.curPoint,r)),this.curPoint=r,!0}else return this.parseState=0,this.feedS(e);case 6:if(this.y=parseFloat(e),isFinite(this.y)){this.y=this.yAxis*this.y;let r;return this.isAbsolute?r=new ie(this.curPoint.x,this.y):r=this.curPoint.add1(0,this.y),this.group.push(new J(this.curPoint,r)),this.curPoint=r,!0}else return this.parseState=0,this.feedS(e);case 7:let i=parseFloat(e);return isFinite(i)?(this.x1=i,this.parseState=8,!0):(e!=="s"&&e!=="S"&&(this.prevBezierCtrl2=null),this.parseState=0,this.feedS(e));case 8:return this.y1=this.yAxis*vi(e),this.parseState=9,!0;case 9:return this.x2=vi(e),this.parseState=10,!0;case 10:return this.y2=this.yAxis*vi(e),this.parseState=11,!0;case 11:return this.x=vi(e),this.parseState=12,!0;case 12:{this.y=this.yAxis*vi(e);let r,n,s;return this.isAbsolute?(r=new ie(this.x1,this.y1),n=new ie(this.x2,this.y2),s=new ie(this.x,this.y)):(r=this.curPoint.add1(this.x1,this.y1),n=this.curPoint.add1(this.x2,this.y2),s=this.curPoint.add1(this.x,this.y)),this.prevBezierCtrl2=n,this.group.push(new Te([this.curPoint,r,n,s])),this.curPoint=s,this.parseState=7,!0}case 13:return this.rx=parseFloat(e),isFinite(this.rx)?(this.parseState=14,!0):(this.parseState=0,this.feedS(e));case 14:return this.ry=vi(e),this.parseState=15,!0;case 15:return this.rotation=vi(e),this.parseState=16,!0;case 16:return this.isLargeArc=vi(e)===1,this.parseState=17,!0;case 17:return this.sweep=vi(e)===1?Fa.CW:Fa.CCW,this.parseState=18,!0;case 18:return this.x=vi(e),this.parseState=19,!0;case 19:{this.y=this.yAxis*vi(e);let r;return this.isAbsolute?r=new ie(this.x,this.y):r=this.curPoint.add1(this.x,this.y),this.rx&&this.ry&&this.group.push(ue.build1(this.curPoint,r,this.rx,this.ry,this.isLargeArc,this.sweep)),this.curPoint=r,this.parseState=13,!0}case 20:return this.x2=parseFloat(e),isFinite(this.x2)?(this.parseState=21,!0):(e!=="s"&&e!=="S"&&(this.prevBezierCtrl2=null),this.parseState=0,this.feedS(e));case 21:return this.y2=this.yAxis*vi(e),this.parseState=22,!0;case 22:return this.x=vi(e),this.parseState=23,!0;case 23:{this.y=this.yAxis*vi(e);let r,n;this.isAbsolute?(r=new ie(this.x2,this.y2),n=new ie(this.x,this.y)):(r=this.curPoint.add1(this.x2,this.y2),n=this.curPoint.add1(this.x,this.y));let s;return this.prevBezierCtrl2?s=this.curPoint.add(this.curPoint.sub(this.prevBezierCtrl2)):s=this.curPoint,this.prevBezierCtrl2=r,this.group.push(new Te([this.curPoint,s,r,n])),this.curPoint=n,this.parseState=20,!0}case 24:return this.x1=parseFloat(e),isFinite(this.x1)?(this.parseState=25,!0):(e!=="s"&&e!=="S"&&(this.prevBezierCtrl2=null),this.parseState=0,this.feedS(e));case 25:return this.y1=this.yAxis*vi(e),this.parseState=26,!0;case 26:return this.x=vi(e),this.parseState=27,!0;case 27:{this.y=this.yAxis*vi(e);let r,n;return this.isAbsolute?(r=new ie(this.x1,this.y1),n=new ie(this.x,this.y)):(r=this.curPoint.add1(this.x1,this.y1),n=this.curPoint.add1(this.x,this.y)),this.prevBezierCtrl2=r,this.group.push(new Te([this.curPoint,r,n])),this.curPoint=n,this.parseState=24,!0}default:return this.logger.warning3("unsupported parse state %s",this.parseState),!0}}pushBuffer(e){this.buffer.write(e)}getCleanBuffer(){let e=this.buffer.toString();return this.buffer.clear(),e}tryNotify(){if(this.group.length===0)return!0;{let e=et.build1(OY(this.group));return this.group.length=0,this.on(e)}}onException(e){throw e}},qY=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.ENC_LINE=1]="ENC_LINE",e[e.ENC_ARC=2]="ENC_ARC",e[e.ENC_CUBIC_BEZIER=3]="ENC_CUBIC_BEZIER",e[e.ENC_QUADRATIC_BEZIER=4]="ENC_QUADRATIC_BEZIER",e))(qY||{}),Xee=Ub.fmtNumber,$C=class{constructor(e=!0){this.buffer=new Array,this.state=0,this.prev=null,this.yAxis=e?-1:1}encPl(e){for(let t of e.primitives)this.encPt(t);return this}encPt(e){if(e instanceof J)this.encLine1(e);else if(e instanceof ue)this.encArc(e);else if(e instanceof Te)this.encBezier(e);else throw new Error("");return this}encBezier(e){if(e.controls.length===3){let t=e.controls[0],i=e.controls[1],r=e.controls[2];this.state===0?this.buffer.push("M",t.x,this.yAxis*t.y,"Q",i.x,this.yAxis*i.y,r.x,this.yAxis*r.y):t.equals1(this.prev)?this.state!==4?this.buffer.push("Q",i.x,this.yAxis*i.y,r.x,this.yAxis*r.y):this.buffer.push(i.x,this.yAxis*i.y,r.x,this.yAxis*r.y):this.buffer.push("L",t.x,this.yAxis*t.y,"Q",i.x,this.yAxis*i.y,r.x,this.yAxis*r.y),this.prev=r,this.state=4}else if(e.controls.length===4){let t=e.controls[0],i=e.controls[1],r=e.controls[2],n=e.controls[3];this.state===0?this.buffer.push("M",t.x,this.yAxis*t.y,"C",i.x,this.yAxis*i.y,r.x,this.yAxis*r.y,n.x,this.yAxis*n.y):t.equals1(this.prev)?this.state!==3?this.buffer.push("C",i.x,this.yAxis*i.y,r.x,this.yAxis*r.y,n.x,this.yAxis*n.y):this.buffer.push(i.x,this.yAxis*i.y,r.x,this.yAxis*r.y,n.x,this.yAxis*n.y):this.buffer.push("L",t.x,this.yAxis*t.y,"C",i.x,this.yAxis*i.y,r.x,this.yAxis*r.y,n.x,this.yAxis*n.y),this.prev=n,this.state=3}else throw new Error("only bezier has 3 or 4 control points supported");return this}encArc(e){let t=e.svgEnd;return this.state===0?this.buffer.push("M",e.start().x,this.yAxis*e.start().y,"A",e.rx,e.ry,0,e.isLarge()?1:0,e.sweep()===Fa.CCW?0:1,t.x,this.yAxis*t.y):e.start().equals1(this.prev)?this.state!==2?this.buffer.push("A",e.rx,e.ry,0,e.isLarge()?1:0,e.sweep()===Fa.CCW?0:1,t.x,this.yAxis*t.y):this.buffer.push(e.rx,e.ry,0,e.isLarge()?1:0,e.sweep()===Fa.CCW?0:1,t.x,this.yAxis*t.y):this.buffer.push("L",e.start().x,this.yAxis*e.start().y,"A",e.rx,e.ry,0,e.isLarge()?1:0,e.sweep()===Fa.CCW?0:1,t.x,this.yAxis*t.y),this.prev=t,this.state=2,this}encLine1(e){return this.encLine2(e.start(),e.end()),this}encLine2(e,t){return this.state===0?this.buffer.push("M",e.x,this.yAxis*e.y,"L",t.x,this.yAxis*t.y):(this.state!==1&&this.buffer.push("L"),e.equals1(this.prev)?this.buffer.push(t.x,this.yAxis*t.y):this.buffer.push(e.x,this.yAxis*e.y,t.x,this.yAxis*t.y)),this.prev=t,this.state=1,this}close(e){return this.state!==0&&(e&&this.buffer.push("Z"),this.state=0,this.prev=null),this}fixNumber(e=4){return this.buffer.forEach((t,i,r)=>{typeof t=="number"&&(t|0)!==t&&(r[i]=+t.toFixed(e))}),this}toString(){return this.buffer.join(" ")}toArray(){return this.buffer}},XY=class extends r0{constructor(){super(),this.lockConfig=[],this.hideConfig=[],this.invisibleConfig=[],this.coverConfig={},this.commentConfig={},this.trnCtrlConfig={},this.transformConfig={},this.fontCache={},this.cache={},this.zIndex=0,this.zIndexMap=new Map}onParseLine(e){let t=e[0];switch(t){case"DOCTYPE":this.parseDocType(e);break;case"HEAD":this.parseHead(e);break;case"LOCK":this.parseLock(e);break;case"HIDE":this.parseHide(e);break;case"INVISIBLE":this.parseInvisible(e);break;case"COVER":this.parseCover(e);break;case"TRN_CTRL":this.parseTrnCtrl(e);break;case"COMMENT":this.parseComment(e);break;case"FONT_CACHE":this.parseFontCache(e);break;case"TRANSFORM":this.parseTransform(e);break;case"GROUP":{let i=e[1];this.cache[t]||(this.cache[t]={errorIds:[]}),i!==null&&this.cache[t][i]?this.cache[t][i]=e:this.cache[t].errorIds.push(e);break}case"POLY":case"STRING":case"AUXLINE":case"DIMENSION":{this.zIndexMap.set(e[1],++this.zIndex);let i=Jc(e[1]);this.cache[t]||(this.cache[t]={errorIds:[]}),i!==null&&!this.cache[t][i]?this.cache[t][i]=e:this.cache[t].errorIds.push(e);break}default:console.warn("can not find hanlder with",e)}}getZIndex(e){var t;return(t=this.zIndexMap.get(e))!=null?t:null}secondParseLine(e){switch(e[0]){case"GROUP":this.parseGroup(e);break;case"POLY":this.parsePoly(e);break;case"STRING":this.parseString(e);break;case"AUXLINE":this.parseAuxLine(e);break;case"DIMENSION":this.parseDimension(e);break}}onParseEnd(){for(let e in this.cache){let t=this.cache[e],i=Object.keys(t).sort((n,s)=>Number(n)-Number(s)),r=0;for(let n of i){if(n==="errorIds")continue;let s=Number(n),a=s-r-1;a>=1&&this.onPHolder(e,a),r=s,this.secondParseLine(t[s])}t.errorIds.forEach(n=>this.secondParseLine(n))}this.clearCache()}clearCache(){this.lockConfig=[],this.hideConfig=[],this.invisibleConfig=[],this.coverConfig={},this.commentConfig={},this.trnCtrlConfig={},this.transformConfig={},this.fontCache={},this.cache={},this.version=void 0}parseDocType(e){this.version=Number(e[2])}parseHead(e){this.version<2&&e[1]&&e[1].print==="AHead Side"&&(e[1].print="Ahead Side"),this.onCanvas(e[1])}parseGroup(e){this.onGroup(e[1],e[2],e[3],!!e[4],!!e[5])}parseLock(e){this.lockConfig.push(...e[1])}parseHide(e){this.hideConfig.push(...e[1])}parseInvisible(e){this.invisibleConfig.push(...e[1])}parseCover(e){this.coverConfig[e[1]]=e[2]}parseTrnCtrl(e){this.trnCtrlConfig[e[1]]={scope:e[2],trans_print:e[3],trans_white:e[4]}}parseComment(e){this.commentConfig[e[1]]=e[2]}matrix2svg(e){let[t,i,r,n,s,a,o,l,u]=e.data;return[t,i,n,s,o,l]}encPath(e){let t=new Array;return new JC(i=>(t.push(new $C(!0).encPl(i).toArray().slice(1)),!0),!0).parse(e),t}parseRect(e){var A,x,T,R,L,O,H,k;let[,t,,i,r,n,s,a,o,,,l,u]=e,c=l[0],h=c[1],m=-c[2],f=c[1]+c[3],g=-c[2]+c[4],y=c[5],b=c[6],E=+c[7],S=+c[8],v=Pt.scale(f-h,g-m).rotateD(-E);S&&(v=v.multiply3(Pt.MIRROR_X)),v=v.translate(h,m),v=this.matrix2svg(v),v=this.encMatrix(v),this.onPoly(t,0,i,-E,r,n,s,a,o,!0,[["R",0,0,1,1,y,b,0,0]],!0,!0,this.lockConfig.some(ee=>ee===e[1]),this.hideConfig.some(ee=>ee===e[1]),this.invisibleConfig.some(ee=>ee===e[1]),i===1?1:(A=this.coverConfig[e[1]])!=null?A:null,u||((x=this.commentConfig[e[1]])!=null?x:null),i===2?3:(R=(T=this.trnCtrlConfig[e[1]])==null?void 0:T.scope)!=null?R:null,i===2?o:(O=(L=this.trnCtrlConfig[e[1]])==null?void 0:L.trans_print)!=null?O:null,i===2?1-o:(k=(H=this.trnCtrlConfig[e[1]])==null?void 0:H.trans_white)!=null?k:null,v!=null?v:null)}parseObj(e){var L,O,H,k,ee,q,Q,ne;let[,t,,i,r,n,s,a,o,,,l,u]=e,[c,h,m,f,g,y,b,E,S]=l[0],v=Pt.rotateD(E);S&&(v=v.multiply3(Pt.MIRROR_X));let A;S?A=new J(new ie(0,0),new ie(0,-g)).multiply3(v):A=new J(new ie(0,0),new ie(f,0)).multiply3(v);let x=A.end().angleD(A.start()),T=S===1;f=S===1?g:f,g=S===1?f:g;let R=Pt.scale(f,g).rotateD(-x);T&&(R=R.multiply3(Pt.MIRROR_X)),R=R.translate(h,-m),R=this.matrix2svg(R),R=this.encMatrix(R),this.onPoly(t,0,i,-x,r,n,s,a,o,!0,[["R",0,0,1,1,0,0,0,0]],!1,!1,this.lockConfig.some(G=>G===e[1]),this.hideConfig.some(G=>G===e[1]),this.invisibleConfig.some(G=>G===e[1]),i===1?1:(L=this.coverConfig[e[1]])!=null?L:null,u||((O=this.commentConfig[e[1]])!=null?O:null),i===2?3:(k=(H=this.trnCtrlConfig[e[1]])==null?void 0:H.scope)!=null?k:null,i===2?o:(q=(ee=this.trnCtrlConfig[e[1]])==null?void 0:ee.trans_print)!=null?q:null,i===2?1-o:(ne=(Q=this.trnCtrlConfig[e[1]])==null?void 0:Q.trans_white)!=null?ne:null,R!=null?R:null)}parseEllipse(e){var S,v,A,x,T,R,L,O;let[,t,,i,r,n,s,a,o,,,l,u]=e,c=l[0],h=c[1],m=-c[2],f=c[3],g=c[4],y=+c[5],b=+c[6],E=Pt.scale(f,g).rotateD(-y);b&&(E=E.multiply3(Pt.MIRROR_X)),E=E.translate(h,m),E=this.matrix2svg(E),E=this.encMatrix(E),this.onPoly(t,0,i,-y,r,n,s,a,o,!0,[["ELLIPSE",0,0,1,1,0,0]],!0,!0,this.lockConfig.some(H=>H===e[1]),this.hideConfig.some(H=>H===e[1]),this.invisibleConfig.some(H=>H===e[1]),i===1?1:(S=this.coverConfig[e[1]])!=null?S:null,u||((v=this.commentConfig[e[1]])!=null?v:null),i===2?3:(x=(A=this.trnCtrlConfig[e[1]])==null?void 0:A.scope)!=null?x:null,i===2?o:(R=(T=this.trnCtrlConfig[e[1]])==null?void 0:T.trans_print)!=null?R:null,i===2?1-o:(O=(L=this.trnCtrlConfig[e[1]])==null?void 0:L.trans_white)!=null?O:null,E!=null?E:null)}parsePolyGroup(e){var f,g,y,b,E,S,v,A;let[,t,,i,r,n,s,a,o,,,l,u]=e,c=!0,h=!0,m=this.decMultiPoly(l).d;this.onPoly(t,0,i,0,r,n,s,a,o,!0,this.encPath(m),c,h,this.lockConfig.some(x=>x===e[1]),this.hideConfig.some(x=>x===e[1]),this.invisibleConfig.some(x=>x===e[1]),i===1?1:(f=this.coverConfig[e[1]])!=null?f:null,u||((g=this.commentConfig[e[1]])!=null?g:null),i===2?3:(b=(y=this.trnCtrlConfig[e[1]])==null?void 0:y.scope)!=null?b:null,i===2?o:(S=(E=this.trnCtrlConfig[e[1]])==null?void 0:E.trans_print)!=null?S:null,i===2?1-o:(A=(v=this.trnCtrlConfig[e[1]])==null?void 0:v.trans_white)!=null?A:null,null)}parsePoly(e){var t,i,r,n,s,a,o,l,u,c;if(this.version<2)if(e[11].length===1)switch(e[11][0][0]){case"R":{let h=e[7];return h.startsWith("data:")||h.startsWith("blob:")?this.parseObj(e):this.parseRect(e)}case"ELLIPSE":return this.parseEllipse(e);default:return this.parsePolyGroup(e)}else return this.parsePolyGroup(e);else this.onPoly(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],!!(e[12]||e[12]===void 0),!!(e[13]||e[13]===void 0),this.lockConfig.some(h=>h===e[1]),this.hideConfig.some(h=>h===e[1]),this.invisibleConfig.some(h=>h===e[1]),(t=this.coverConfig[e[1]])!=null?t:null,(i=this.commentConfig[e[1]])!=null?i:null,(n=(r=this.trnCtrlConfig[e[1]])==null?void 0:r.scope)!=null?n:null,(a=(s=this.trnCtrlConfig[e[1]])==null?void 0:s.trans_print)!=null?a:null,(l=(o=this.trnCtrlConfig[e[1]])==null?void 0:o.trans_white)!=null?l:null,(c=(u=this.transformConfig[e[1]])==null?void 0:u.matrix)!=null?c:null)}decMultiPoly(e){let t=new Sr,i=e.map(r=>{let n="";return new JC(s=>(t.ext1(s.bbox()),n=new $C().encPl(s).toString(),!1),!1).parse("M"+r.join(" ")),n}).join(" ");return{bbox:t.build(),d:i}}encMatrix(e){let[t,i,r,n,s,a]=e,o=new Pt([t,i,0,r,n,0,s,a,1]);o=Pt.MIRROR_Y.multiply3(o).multiply3(Pt.MIRROR_Y);let[l,u,c,h,m,f,g,y,b]=o.data;return[l,h,g,u,m,y]}parseString(e){var t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E,S,v;if(this.version<2){let[,A,x,T,R,L,O,H,k,ee,q,Q,ne,G,X,D,F,W,z,$]=e;L=ji(L);let te=k;H=H===1,ne=ne===1,G=G===1,X=X===1;let Z=-(D[15]/3|0)+2,pe=D%3;z=z||1,$=$||1;let Se=this.fontCache[e[1]],{bbox:Ce,d:we}=this.decMultiPoly(Se),Fe=Ce.width(),Ue=Ce.height();Ue=Ue||0,Fe=Fe||0;let je=0;switch(pe){case 1:je=-Fe/2;break;case 2:je=-Fe;break}let me=0;switch(Z){case 1:me=Ue/2;break;case 0:me=Ue;break}let Ae=Pt.translate(je,me).scale(z,$).rotateD(-O);H&&(Ae=Ae.multiply3(Pt.MIRROR_X)),Ae=Ae.translate(R,L);let We=this.matrix2svg(Ae),tt=this.encMatrix(We);this.onString(A,x,T,O,te,ee,q,Q,ne,G,X,((-Z||0)+2)*3+(pe||0),F,W,this.lockConfig.some(Ct=>Ct===e[1]),this.hideConfig.some(Ct=>Ct===e[1]),this.invisibleConfig.some(Ct=>Ct===e[1]),T===1?1:(t=this.coverConfig[e[1]])!=null?t:null,(i=this.commentConfig[e[1]])!=null?i:null,T===2?3:(n=(r=this.trnCtrlConfig[e[1]])==null?void 0:r.scope)!=null?n:null,T===2?W:(a=(s=this.trnCtrlConfig[e[1]])==null?void 0:s.trans_print)!=null?a:null,T===2?1-W:(l=(o=this.trnCtrlConfig[e[1]])==null?void 0:o.trans_white)!=null?l:null,tt,!!tt,this.encPath(we))}else this.onString(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9]===1,e[10]===1,e[11]===1,e[12],e[13],e[14],this.lockConfig.some(A=>A===e[1]),this.hideConfig.some(A=>A===e[1]),this.invisibleConfig.some(A=>A===e[1]),(u=this.coverConfig[e[1]])!=null?u:null,(c=this.commentConfig[e[1]])!=null?c:null,(m=(h=this.trnCtrlConfig[e[1]])==null?void 0:h.scope)!=null?m:null,(g=(f=this.trnCtrlConfig[e[1]])==null?void 0:f.trans_print)!=null?g:null,(b=(y=this.trnCtrlConfig[e[1]])==null?void 0:y.trans_white)!=null?b:null,(S=(E=this.transformConfig[e[1]])==null?void 0:E.matrix)!=null?S:null,!!((v=this.transformConfig[e[1]])!=null&&v.matrix),this.fontCache[e[1]])}parseFontCache(e){this.fontCache[e[1]]=e[2]}parseDimension(e){var t,i,r,n,s,a,o,l,u,c,h,m;this.onDimension(e[1],e[2],e[3],(t=e[4])!=null?t:null,e[5],e[6],e[7],e[8],this.lockConfig.some(f=>f===e[1]),this.hideConfig.some(f=>f===e[1]),this.invisibleConfig.some(f=>f===e[1]),(i=this.coverConfig[e[1]])!=null?i:null,(r=this.commentConfig[e[1]])!=null?r:null,(s=(n=this.trnCtrlConfig[e[1]])==null?void 0:n.scope)!=null?s:null,(o=(a=this.trnCtrlConfig[e[1]])==null?void 0:a.trans_print)!=null?o:null,(u=(l=this.trnCtrlConfig[e[1]])==null?void 0:l.trans_white)!=null?u:null,(h=(c=this.transformConfig[e[1]])==null?void 0:c.matrix)!=null?h:null,!!((m=this.transformConfig[e[1]])!=null&&m.matrix))}parseTransform(e){this.transformConfig[e[1]]={matrix:e[2],strokes:!!e[3]}}parseAuxLine(e){var t,i,r,n,s,a,o,l,u,c,h;this.onAuxLine(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],this.lockConfig.some(m=>m===e[1]),this.hideConfig.some(m=>m===e[1]),this.invisibleConfig.some(m=>m===e[1]),(t=this.coverConfig[e[1]])!=null?t:null,(i=this.commentConfig[e[1]])!=null?i:null,(n=(r=this.trnCtrlConfig[e[1]])==null?void 0:r.scope)!=null?n:null,(a=(s=this.trnCtrlConfig[e[1]])==null?void 0:s.trans_print)!=null?a:null,(l=(o=this.trnCtrlConfig[e[1]])==null?void 0:o.trans_white)!=null?l:null,(c=(u=this.transformConfig[e[1]])==null?void 0:u.matrix)!=null?c:null,!!((h=this.transformConfig[e[1]])!=null&&h.matrix))}},JY=class extends r0{constructor(e={},t=[]){super(),this.symbolPartIds=e,this.device=t,this.defaultPartId="pid8a0e77bacb214e",this.curPart="",this.onlyPart="",this.partIdMap={},this.fontStyleIndex={},this.lineStyleIndex={},this.groupIndex={},this.zIndex=0,this.zIndexMap=new Map,this.cache={},this.errorIds={},this.tableCell={},this.hasPart=!1,this.components={},this.busEntryMap={},this.defaultLineStyle={strokeColor:null,strokeStyle:null,fillColor:null,strokeWidth:null,fillStyle:null},this.defaultFontStyle={color:null,fillColor:null,fontFamily:null,fontSize:null,strikeout:null,underline:null,italic:null,fontWeight:null,hAlign:null,vAlign:null}}getZIndex(e){var t;return(t=this.zIndexMap.get(e))!=null?t:null}transPinAttrKey(e){switch(e){case"NUMBER":{e="Pin Number";break}case"NAME":{e="Pin Name";break}}return e}transFontStyle(e){return{color:e.color,fillColor:e.fillColor,fontFamily:e.fontFamily,fontSize:e.fontSize,strikeout:e.strikeout,underline:e.underline,italic:e.italic,fontWeight:e.fontWeight,align:this.transAlign(e.vAlign,e.hAlign)}}transTableFontStyle(e){return{color:e.color,fillColor:e.fillColor,fontFamily:e.fontFamily,fontSize:e.fontSize,strikeout:e.strikeout,underline:e.underline,italic:e.italic,fontWeight:e.fontWeight,vAlign:this.transVAlign(e.vAlign),hAlign:this.transHAlign(e.hAlign)}}transVAlign(e){switch(e=e&&Number(e),e){case 0:return"TOP";case 1:return"MIDDLE";case 2:return"BOTTOM";default:return null}}transHAlign(e){switch(e=e&&Number(e),e){case 0:return"LEFT";case 1:return"CENTER";case 2:return"RIGHT";default:return null}}transAlign(e,t){if(e=e&&Number(e),t=t&&Number(t),t===0)switch(e){case 0:return"LEFT_TOP";case 1:return"LEFT_MIDDLE";case 2:return"LEFT_BOTTOM";default:return null}if(t===1)switch(e){case 0:return"CENTER_TOP";case 1:return"CENTER_MIDDLE";case 2:return"CENTER_BOTTOM";default:return null}if(t===2)switch(e){case 0:return"RIGHT_TOP";case 1:return"RIGHT_MIDDLE";case 2:return"RIGHT_BOTTOM";default:return null}return null}transStrokeStyle(e){switch(e=e&&Number(e),e){case 0:return"SOLID";case 1:return"SHORT_DASH";case 2:return"DOT";case 3:return"DOT_DASH";default:return null}}transFillStyle(e){switch(e=e&&Number(e),e){case 0:return"NONE";case 1:return"SOLID";case 2:return"GRID";case 3:return"HORIZONTAL_LINE";case 4:return"VERTICAL_LINE";case 5:return"RHOMBIC";case 6:return"LEFT_SLASH_LINE";case 7:return"RIGHT_SLASH_LINE";default:return null}}transPinShape(e){switch(e=e&&Number(e),e){case 0:return"NONE";case 1:return"CLOCK";case 2:return"INVERTED";case 3:return"INVERTED_CLOCK";default:return"NONE"}}onParseLine(e){var i,r;let t=e[0];switch(t){case"DOCTYPE":this.parseDocType(e);break;case"HEAD":this.parseHead(e);break;case"GROUP":this.parseGroup(e);break;case"FONTSTYLE":this.parseFontStyle(e);break;case"LINESTYLE":this.parseLineStyle(e);break;case"TERM":break;case"PART":this.hasPart=!0,this.parsePart(e);break;case"TABEL_CELL":this.parseTableCell(e);break;case"BUSENTRY":{this.parseBusEntry(e);break}case"WIRE":case"BUS":case"TEXT":case"POLY":case"CIRCLE":case"ARC":case"RECT":case"PIN":case"OBJ":case"COMPONENT":case"ELLIPSE":case"BEZIER":case"TABLE":{this.zIndexMap.set(e[1],++this.zIndex);let n=Jc(e[1]);this.cache[t]||(this.cache[t]={}),n!==null&&!this.cache[t][n]?this.cache[t][n]={part:this.curPart,value:e}:(this.errorIds[t]||(this.errorIds[t]=[]),this.errorIds[t].push({part:this.curPart,value:e}));break}case"ATTR":{this.zIndexMap.set(e[1],++this.zIndex),e[3]==="Symbol"&&(this.components[e[2]]||(this.components[e[2]]={symbol:"",device:""}),this.components[e[2]].symbol=e[4]),e[3]==="Device"&&(this.components[e[3]]||(this.components[e[3]]={symbol:"",device:""}),this.components[e[3]].device=e[4]);let n=Object.keys(((i=this.cache)==null?void 0:i.COMPONENT)||{}).find(o=>this.cache.COMPONENT[o].value[1]===e[2]);if(n){let o=this.cache.COMPONENT[n];o.attr||(o.attr=[]),o.attr.push({part:this.curPart,value:e});break}let s=Object.keys(((r=this.cache)==null?void 0:r.PIN)||{}).find(o=>this.cache.PIN[o].value[1]===e[2]);if(s){let o=this.cache.PIN[s];o.attr||(o.attr=[]),o.attr.push({part:this.curPart,value:e});break}let a=Jc(e[1]);this.cache[t]||(this.cache[t]={}),a!==null&&!this.cache[t][a]?this.cache[t][a]={part:this.curPart,value:e}:(this.errorIds[t]||(this.errorIds[t]=[]),this.errorIds[t].push({part:this.curPart,value:e}));break}default:console.warn("can not find hanlder with",e)}}secondParseLine(e){switch(e[0]){case"DOCTYPE":case"HEAD":case"GROUP":case"FONTSTYLE":case"LINESTYLE":break;case"ATTR":this.parseAttr(e);break;case"WIRE":this.parseWire(e);break;case"BUS":this.parseBus(e);break;case"TEXT":this.parseText(e);break;case"POLY":this.parsePoly(e);break;case"CIRCLE":this.parseCircle(e);break;case"ARC":this.parseArc(e);break;case"BUSENTRY":break;case"RECT":this.parseRect(e);break;case"PIN":this.parsePin(e);break;case"OBJ":this.parseObj(e);break;case"COMPONENT":this.parseComponent(e);break;case"ELLIPSE":this.parseEllipse(e);break;case"BEZIER":this.parseBezier(e);break;case"TABLE":this.parseTable(e);break;case"TABEL_CELL":break}}onParseEnd(){this.docType==="SYMBOL"&&!this.hasPart&&(this.curPart=this.defaultPartId,this.onlyPart=this.curPart,this.partIdMap[""]=this.curPart,this.onPart(this.curPart,{title:""}));for(let e in this.cache){let t=this.cache[e],i=Object.keys(t).sort((n,s)=>Number(n)-Number(s)),r=0;for(let n of i){let s=Number(n),a=s-r-1;a>=1&&this.onPHolder(e,a),r=s,this.curPart=this.hasPart?t[s].part||this.onlyPart:this.curPart,this.secondParseLine(t[s].value),t[s].attr&&t[s].attr.forEach(o=>{this.curPart=this.hasPart?o.part||this.onlyPart:this.curPart,this.secondParseLine(o.value)})}if(this.errorIds[e])for(let n of this.errorIds[e])this.curPart=this.hasPart?n.part||this.onlyPart:this.curPart,this.secondParseLine(n.value)}this.clearCache()}clearCache(){this.fontStyleIndex={},this.lineStyleIndex={},this.groupIndex={},this.cache={},this.errorIds={},this.curPart="",this.components={},this.tableCell={},this.hasPart=!1,this.version=void 0,this.docType=void 0}parseDocType(e){this.docType=e[1];let t=parseFloat(e[2]);this.version=t}parseHead(e){this.onCanvas(e[1])}parseFontStyle(e){this.fontStyleIndex[e[1]]={color:e[3]===""?"none":e[3],fillColor:e[2],fontFamily:e[4],fontSize:e[5],strikeout:e[9]===null?null:e[9]===1,underline:e[8]===null?null:e[8]===1,italic:e[6]===null?null:e[6]===1,fontWeight:e[7]===null?null:e[7]===1,vAlign:e[10],hAlign:e[11]}}parseLineStyle(e){this.lineStyleIndex[e[1]]={strokeColor:e[2],strokeStyle:this.transStrokeStyle(e[3]),fillColor:e[4]===""?"none":e[4],strokeWidth:e[5],fillStyle:this.transFillStyle(e[6])}}getGroupId(e){var i;let t=this;for(let r in t.groupIndex)if((i=t.groupIndex[r])!=null&&i.includes(e))return r;return""}parseBezier(e){let t=this.lineStyleIndex[e[3]];t||(t=this.defaultLineStyle,console.warn("style not found",e));let i=this.getGroupId(e[1]);for(let r=0;r<e[2].length;r+=2)e[2][r+1]=ji(e[2][r+1]);this.onBezier(e[1],this.curPart,i,!!e[4],e[2],t.strokeColor,t.strokeStyle,t.fillColor,t.strokeWidth,t.fillStyle)}parseGroup(e){this.groupIndex[e[1]]=e[4]||[],this.onGroup(e[1],e[2]||"",e[3]||"")}parseBus(e){let t=this.lineStyleIndex[e[3]];t||(t=this.defaultLineStyle,console.warn("style not found",e));let i=e[2]||[],r=this.getGroupId(e[1]);this.onBus(e[1],this.curPart,r,!!e[4],i,t.strokeColor,t.strokeStyle,t.fillColor,t.strokeWidth,t.fillStyle,this.busEntryMap[e[1]]||{})}parseWire(e){let t=this.lineStyleIndex[e[3]];t||(t=this.defaultLineStyle,console.warn("style not found",e));let i=e[2]||[],r=this.getGroupId(e[1]);this.onWire(e[1],this.curPart,r,!!e[4],i,t.strokeColor,t.strokeStyle,t.fillColor,t.strokeWidth,t.fillStyle)}parseText(e){let t=this.fontStyleIndex[e[6]];t||(t=this.defaultFontStyle,console.warn("font not found",e));let i=this.transFontStyle(t),r=this.getGroupId(e[1]);this.onText(e[1],this.curPart,r,!!e[7],e[2],e[3],e[4],e[5],i.color,i.fillColor,i.fontFamily,i.fontSize,i.strikeout,i.underline,i.italic,i.fontWeight,i.align)}parsePoly(e){let t=this.lineStyleIndex[e[4]];t||(t=this.defaultLineStyle,console.warn("style not found",e));let i=this.getGroupId(e[1]);this.onPoly(e[1],this.curPart,i,!!e[5],e[2]||[],!!e[3],t.strokeColor,t.strokeStyle,t.fillColor,t.strokeWidth,t.fillStyle)}parseCircle(e){let t=this.lineStyleIndex[e[5]];t||(t=this.defaultLineStyle,console.warn("style not found",e));let i=this.getGroupId(e[1]);this.onCircle(e[1],this.curPart,i,!!e[6],e[2],e[3],e[4],t.strokeColor,t.strokeStyle,t.fillColor,t.strokeWidth,t.fillStyle)}parseArc(e){let t=this.lineStyleIndex[e[8]];t||(t=this.defaultLineStyle,console.warn("style not found",e));let i=this.getGroupId(e[1]);this.onArc(e[1],this.curPart,i,!!e[9],e[2],e[3],e[4],e[5],e[6],e[7],t.strokeColor,t.strokeStyle,t.fillColor,t.strokeWidth,t.fillStyle)}parseBusEntry(e){let t=e[2],i={groupId:this.getGroupId(e[1]),locked:!1,zIndex:++this.zIndex,order:e[3],pointX:e[4],pointY:ji(e[5]),rotation:e[6]};this.busEntryMap[t]||(this.busEntryMap[t]={}),this.busEntryMap[t][e[1]]=i}parseRect(e){let t=this.lineStyleIndex[e[9]];t||(t=this.defaultLineStyle,console.warn("style not found",e));let i=this.getGroupId(e[1]);this.onRect(e[1],this.curPart,i,!!e[10],e[2],e[3],e[4],e[5],e[6],e[7],e[8],t.strokeColor,t.strokeStyle,t.fillColor,t.strokeWidth,t.fillStyle)}parsePin(e){let t=this.getGroupId(e[1]);this.onPin(e[1],this.curPart,t,!!e[10],!!e[2],e[3],e[4],e[5],e[6],e[7],e[8],this.transPinShape(e[9]))}parseObj(e){let t=this.getGroupId(e[1]);this.version>=1.1?this.onObj(e[1],this.curPart,t,!!e[10],e[2],e[3],e[4],e[5],e[6],e[7],!!e[8],e[9]):this.onObj(e[1],this.curPart,t,!!e[10],e[2],e[4],e[5],e[6],e[7],e[8],!1,`data:${e[3]},${e[9]}`)}parseComponent(e){var n,s,a;let t=this.getGroupId(e[1]),i=e[2],r=this.components[e[1]];if(r){if(r.symbol){let o=this.symbolPartIds[r.symbol];o&&(i=o[e[2]]||e[2]||o[(n=Object.keys(o))==null?void 0:n[0]]||"")}else if(r.device){let o=this.device.find(u=>u.uuid===r.device),l=o?this.symbolPartIds[(s=o==null?void 0:o.attributes)==null?void 0:s.Symbol]:null;l&&(i=l[e[2]]||e[2]||l[(a=Object.keys(l))==null?void 0:a[0]]||"")}}this.onComponent(e[1],!!e[8],i,t,e[3],e[4],e[5],e[6]===1,e[7])}parseEllipse(e){let t=this.lineStyleIndex[e[7]];t||(t=this.defaultLineStyle,console.warn("style not found",e));let i=this.getGroupId(e[1]);this.onEllipse(e[1],this.curPart,i,!!e[8],e[2],e[3],e[4],e[5],e[6],t.strokeColor,t.strokeStyle,t.fillColor,t.strokeWidth,t.fillStyle)}parseTable(e){let t=this.getGroupId(e[1]);this.onTable(e[1],this.curPart,t,e[2],e[3],e[4],e[5],e[6],e[7],e[8],this.tableCell[e[1]]||[])}parseTableCell(e){let t=this.lineStyleIndex[e[8]],i=this.lineStyleIndex[e[9]],r=this.lineStyleIndex[e[10]],n=this.lineStyleIndex[e[11]],s=this.fontStyleIndex[e[12]],a=Object.assign({},s);a.color=s.fillColor,a.fillColor=s.color,(!t||!i||!r||!n||!a)&&console.warn("style not found",e);let o={id:e[1],value:e[3],rowIndex:e[4],columnIndex:e[5],rowSpan:e[6],colSpan:e[7],topStyle:t||this.defaultLineStyle,rightStyle:i||this.defaultLineStyle,bottomStyle:r||this.defaultLineStyle,leftStyle:n||this.defaultLineStyle,fontStyle:this.transTableFontStyle(a||this.defaultFontStyle),lineHeight:e[13],zIndex:++this.zIndex};this.tableCell[e[2]]||(this.tableCell[e[2]]=[]),this.tableCell[e[2]].push(o)}parseAttr(e){let t=this.fontStyleIndex[e[10]];t||(t=this.defaultFontStyle,console.warn("fontStyle not found",e));let i=this.transFontStyle(t),r=this.getGroupId(e[1]);this.onAttr(e[1],this.curPart,r,!!e[11],e[2]||"",this.transPinAttrKey(String(e[3])),e[4],e[5]===null?null:!!e[5],e[6]===null?null:!!e[6],e[7]!==null?e[7]:null,e[8]!==null?e[8]:null,e[9],i.color,i.fillColor,i.fontFamily,i.fontSize,i.strikeout,i.underline,i.italic,i.fontWeight,i.align)}parsePart(e){this.curPart=e[1]||this.defaultPartId,this.onlyPart=this.curPart,this.partIdMap[e[1]]=this.curPart;let t=Object.assign(e[2]||{},{title:e[1]||""});this.onPart(this.curPart,t)}},$Y=class{constructor(){}encodeCanvas(e){return{id:"CANVAS",dataType:"CANVAS",data:JSON.stringify(e)}}encodeGroup(e,t){return{id:e,dataType:"GROUP",data:JSON.stringify(t)}}encodeAuxLine(e,t){return{id:e,dataType:"AUXLINE",data:JSON.stringify(t)}}encodeDimension(e,t){return{id:e,dataType:"DIMENSION",data:JSON.stringify(t)}}encodeString(e,t){return{id:e,dataType:"STRING",data:JSON.stringify(t)}}encodePoly(e,t){return{id:e,dataType:"POLY",data:JSON.stringify(t)}}},rT=class{constructor(){}editHead(e,t){let i={uuid:e.uuid,nickname:e.nickname,username:e.username,updateTime:t};return`${JSON.stringify({type:"EDIT_HEAD"})}${Wn}${JSON.stringify(i)}`}head(e){return Fo(this.doctype,e.client,e.doc,e.updateTime,e.version||String(e.updateTime),e.user,e.ticket)}creator(e,t){let i=typeof t=="string"?t:JSON.stringify(t);return kr("META_CREATE",e,"META_CREATE",i)}modifier(e,t){let i=typeof t=="string"?t:JSON.stringify(t);return kr("META_MODIFY",e,"META_MODIFY",i)}delete(e,t){let i=t||JSON.stringify({isDelete:!0});return kr("DELETE_DOC",e,"DELETE_DOC",i)}},d0=class extends rT{constructor(){super(...arguments),this.doctype="BLOB"}buildStr(e,t,i){let r=typeof i=="string"?i:JSON.stringify(this.buildData(i));return kr("BLOB",e,t,r)}buildData(e){return{filename:e.filename,content:e.content}}};var KY=cu(o9());function Hb(e,t,i,r,n,s,a,o){return JSON.stringify([e||"",t||"",i,r,n?1:0,s?1:0,a?1:0,o])}function ZY(e){let t=JSON.parse(e);return{text:t[0],fontFamily:t[1],fontSize:t[2],thickness:t[3],bold:!!t[4],italic:!!t[5],reverse:!!t[6],expansion:t[7]}}function vf(e){return KY.default.SHA256(e).toString()}function QY(e,t){let i=[],r=[],n={};Kp(e,(u,c)=>{let h=JSON.parse(u);if(h.type==="DOCHEAD"||h.type==="META"||h.type==="META_CREATE"||h.type==="META_MODIFY"||h.type==="ELE_PLACEHOLDER"||h.type==="ELE_PLACEHOLDER"||h.type==="ELE_PLACEHOLDER")return;let{id:m}=h;n[m]=Object.assign(h,{data:c})});let s={};Kp(t,(u,c="")=>{let h=JSON.parse(u);if(h.type==="BLOB")i.push(u+Wn+c);else if(h.type==="FONT")r.push(u+Wn+c);else{if(h.type==="DOCHEAD"||h.type==="META_MODIFY")return;let{id:m}=h;s[m]=Object.assign(h,{data:c})}});let a={},o={},l={};for(let u in n)if(!s.hasOwnProperty(u))o[u]=n[u];else{let{ticket:c}=n[u],{type:h,data:m,client:f}=s[u];(n[u].ticket!==s[u].ticket||s[u].client!==s[u].client)&&(a[u]={type:h,ticket:c,data:m,client:f}),delete s[u]}for(let u in s){let{type:c,data:h,ticket:m,client:f}=s[u];l[u]={type:c,data:h,ticket:m,client:f}}return{delete:o,cover:a,add:l,blobs:i,fonts:r}}function Eb(e,t,i){let{docType:r,uuid:n,client:s,updateTime:a,version:o,user:l,ticket:u}=i,c=[Fo(r,s,n,a,o,l,u)],{delete:h,cover:m,add:f,blobs:g,fonts:y}=QY(e,t);for(let b in h){let{ticket:E,type:S,client:v}=h[b];c.push(kr(S,E+1,b,"",v))}for(let b in m){let{type:E,ticket:S,data:v,client:A}=m[b];c.push(kr(E,S+1,b,v,A))}for(let b in f){let{type:E,ticket:S,data:v,client:A}=f[b];c.push(kr(E,S,b,v,A))}return g.length&&(c.push(Fo("BLOB",s,"BLOB",a,o,l,u)),c=c.concat(g)),y.length&&(c.push(Fo("FONT",s,"FONT",a,o,l,u)),c=c.concat(y)),c.join(ui)}var nT=class{constructor(){}encodeString(e,t){return{id:e,dataType:"STRING",data:JSON.stringify(t)}}encodeAttr(e,t){return{id:e,dataType:"ATTR",data:JSON.stringify(t)}}encodePanelize(e){return{id:"PANELIZE",dataType:"PANELIZE",data:JSON.stringify(e)}}encodeRuleSelector(e){let t=JSON.stringify(["RULE_SELECTOR",e.ruleSelect]),i={...e};return delete i.ruleSelect,{id:t,dataType:"RULE_SELECTOR",data:JSON.stringify(i)}}encodeRule(e){let t=JSON.stringify(["RULE",e.ruleType,e.ruleName]),i={...e};return delete i.ruleType,delete i.ruleName,{id:t,dataType:"RULE",data:JSON.stringify(i)}}encodeRuleTemplate(e){return{id:"RULE_TEMPLATE",dataType:"RULE_TEMPLATE",data:JSON.stringify(e)}}encodeDimension(e,t){return{id:e,dataType:"DIMENSION",data:JSON.stringify(t)}}encodeBoss(e,t){return{id:e,dataType:"BOSS",data:JSON.stringify(t)}}encodeShellEntity(e,t){return{id:e,dataType:"SHELL_ENTITY",data:JSON.stringify(t)}}encodeShellCut(e,t){return{id:e,dataType:"SHELLCUT",data:JSON.stringify(t)}}encodeCrease(e,t){return{id:e,dataType:"CREASE",data:JSON.stringify(t)}}encodeShell(e,t){return{id:e,dataType:"SHELL",data:JSON.stringify(t)}}encodeFpcFill(e,t){return{id:e,dataType:"FPC_FILL",data:JSON.stringify(t)}}encodeTeardrop(e,t){return{id:e,dataType:"TEARDROP",data:JSON.stringify(t)}}encodeImage(e,t){return{id:e,dataType:"IMAGE",data:JSON.stringify(t)}}encodePoured(e,t){return{id:Mr(e,"POURED"),dataType:"POURED",data:JSON.stringify(t)}}encodePour(e,t){return{id:e,dataType:"POUR",data:JSON.stringify(t)}}encodeRegion(e,t){return{id:e,dataType:"REGION",data:JSON.stringify(t)}}encodeFill(e,t){return{id:e,dataType:"FILL",data:JSON.stringify(t)}}encodeLayerFill(e,t){return{id:Mr(e,"LAYER_FILL"),dataType:"LAYER_FILL",data:JSON.stringify(t)}}encodePoly(e,t){return{id:e,dataType:"POLY",data:JSON.stringify(t)}}encodeEQLenGrp(e,t){return{id:e,dataType:"EQLEN_GRP",data:JSON.stringify(t)}}encodeObj(e,t){return{id:e,dataType:"OBJ",data:JSON.stringify(t)}}encodeArc(e,t){return{id:e,dataType:"ARC",data:JSON.stringify(t)}}encodeLine(e,t){return{id:e,dataType:"LINE",data:JSON.stringify(t)}}encodePad(e,t){return{id:e,dataType:"PAD",data:JSON.stringify(t)}}encodeVia(e,t){return{id:e,dataType:"VIA",data:JSON.stringify(t)}}encodePreference(e){return{id:"PREFERENCE",dataType:"PREFERENCE",data:JSON.stringify(e)}}encodeSilkOpts(e,t){return{id:Mr(e,"SILK_OPTS"),dataType:"SILK_OPTS",data:JSON.stringify(t)}}encodeGroup(e,t){return{id:e,dataType:"GROUP",data:JSON.stringify(t)}}encodePrimitive(e,t){return{id:Mr(e,"PRIMITIVE"),dataType:"PRIMITIVE",data:JSON.stringify(t)}}encodeNet(e,t){return{id:Mr(e,"NET"),dataType:"NET",data:JSON.stringify(t)}}encodeActiveLayer(e){return{id:"ACTIVE_LAYER",dataType:"ACTIVE_LAYER",data:JSON.stringify(e)}}encodeLayerPhys(e,t){return{id:Mr(e,"LAYER_PHYS"),dataType:"LAYER_PHYS",data:JSON.stringify(t)}}encodeLayer(e,t){return{id:Mr(e,"LAYER"),dataType:"LAYER",data:JSON.stringify(t)}}encodeCanvas(e){return{id:"CANVAS",dataType:"CANVAS",data:JSON.stringify(e)}}},eG=class extends AH{constructor(e=!1){super(void 0,void 0,void 0,void 0,e),this.encode=new nT,this.maxTicket=0,this.blobEncode=new d0,this.blobData=[],this.encodeData=""}handleData(e){this.encodeData?this.encodeData=this.encodeData+ui+kr(e.dataType,++this.maxTicket,e.id,e.data):this.encodeData=kr(e.dataType,++this.maxTicket,e.id,e.data)}getZIndex(e){let t=e.match(i0);return t!=null&&t.length?t[1]:null}onPHolder(e,t){let i={dataType:e,max:t};this.handleData({id:cr(),dataType:"ELE_PLACEHOLDER",data:JSON.stringify(i)})}onLayerFill(e,t){this.handleData(this.encode.encodeLayerFill(e,t))}onString(e,t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E,S){let v=this.getZIndex(e);this.handleData(this.encode.encodeString(mt(e),{groupId:i,layerId:r,x:n,y:s,text:a,fontFamily:o,fontSize:l,strokeWidth:u,bold:c,italic:h,origin:m,angle:f,reverse:g,expansion:y,mirror:b,locked:E,zIndex:v===null?null:Number(v),specialColor:S}))}onAttr(e,t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E,S,v,A,x,T,R){let L=this.getZIndex(e);L&&T&&(L=L+"."+String(T)),this.handleData(this.encode.encodeAttr(mt(e),{groupId:i,parentId:r,layerId:n,x:s,y:a,key:o,value:l,keyVisible:u,valueVisible:c,fontFamily:h,fontSize:m,strokeWidth:f,bold:g,italic:y,origin:b,angle:E,reverse:S,expansion:v,mirror:A,locked:x,zIndex:L===null?null:Number(L),specialColor:R}))}onPadNet(e,t,i,r,n){}onComponent(e,t,i,r,n,s,a,o,l){}onPanelize(e,t,i,r,n,s,a,o,l,u){this.handleData(this.encode.encodePanelize({on:e,row:t,column:i,rowSpacing:r,columnSpacing:n,onlyOutline:s,horizontalStamp:a,verticalStamp:o,horizontalSize:l,verticalSize:u}))}onRuleSelector(e,t,i,r,n){this.handleData(this.encode.encodeRuleSelector({ruleSelect:e,ruleOrder:t,ruleKeyValue:i,copperValue:r,innerPlaneValue:n}))}onRule(e,t,i,r){this.handleData(this.encode.encodeRule({ruleType:e,ruleName:t,ruleState:i,ruleContext:r}))}onRuleTemplate(e){this.handleData(this.encode.encodeRuleTemplate({name:e}))}onDimension(e,t,i,r,n,s,a,o,l,u,c,h,m){let f=this.getZIndex(e);this.handleData(this.encode.encodeDimension(mt(e),{type:i,layerId:r,unit:n,strokeWidth:s,precision:a,textFollow:o,coords:l,locked:u,zIndex:f===null?null:Number(f),text:c,specialColor:h,groupId:m}))}onBoss(e,t,i,r,n,s,a,o,l,u,c,h,m){let f=this.getZIndex(e);this.handleData(this.encode.encodeBoss(mt(e),{groupId:i,layerId:r,centerX:n,centerY:s,specification:a,depth:o,thickness:l,holeDiameter:u,counterBore:c?{height:c[0],diameter:c[1]}:null,stiffener:h?{topWidth:h[0],bottomWidth:h[1],height:h[2],stiffThickness:h[3]}:null,locked:m,zIndex:f===null?null:Number(f)}))}onShellEntity(e,t,i,r,n,s,a,o,l,u,c,h){let m=this.getZIndex(e),f={groupId:i,layerId:r,type:n?"ENTITY":"SLOT",depth:o,strokeWidth:l,path:u,locked:c,zIndex:m===null?null:Number(m),refs:h};f.type==="ENTITY"&&(f.entityBelong=s),f.type==="SLOT"&&(f.slotOptions=a),this.handleData(this.encode.encodeShellEntity(mt(e),f))}onShellCut(e,t,i,r,n,s,a,o,l){let u=this.getZIndex(e);this.handleData(this.encode.encodeShellCut(mt(e),{groupId:i,layerId:r,depth:n,strokeWidth:s,path:a,locked:o,zIndex:u===null?null:Number(u),refs:l}))}onCrease(e,t,i,r,n,s,a,o,l,u){let c=this.getZIndex(e);this.handleData(this.encode.encodeCrease(mt(e),{groupId:i,layerId:r,startX:n,startY:s,endX:a,endY:o,angle:l,locked:u,zIndex:c===null?null:Number(c)}))}onShell(e,t,i,r,n,s,a,o,l,u){let c=this.getZIndex(e),h={groupId:i,shellType:r,shellHeight:n,pcbHeight:s,strokeWidth:a,path:o,thickness:l.Thickness,locked:u,zIndex:c===null?null:Number(c)};r==="DRAWER"&&(h.direction=l.Direction),r==="T&B"&&(h.bottomHeight=l.BottomHeight,h.topInnerHeight=l.TopInnerHeight,h.bottomInnerHeight=l.BottomInnerHeight),this.handleData(this.encode.encodeShell(mt(e),h))}onFpcFill(e,t,i,r,n,s,a,o){let l=this.getZIndex(e);this.handleData(this.encode.encodeFpcFill(mt(e),{groupId:i,layerId:r,material:n,thickness:s,path:a,locked:o,zIndex:l===null?null:Number(l)}))}onTeardrop(e,t,i,r,n,s,a){this.handleData(this.encode.encodeTeardrop(mt(e),{netName:i,layerId:r,path:n,groupId:s,refs:a,locked:!1}))}onImage(e,t,i,r,n,s,a,o,l,u,c,h,m){let f=this.getZIndex(e);this.handleData(this.encode.encodeImage(mt(e),{groupId:i,layerId:r,startX:n,startY:s,width:a,height:o,angle:l,mirror:u,path:c,locked:h,zIndex:f===null?null:Number(f),specialColor:m}))}onPoured(e,t){this.handleData(this.encode.encodePoured(mt(e),t))}onPour(e,t,i,r,n,s,a,o,l,u,c,h){let m=this.getZIndex(e);this.handleData(this.encode.encodePour(mt(e),{groupId:i,netName:r,layerId:n,width:s,name:a,order:o,path:l,pourType:u,keepIsland:c,locked:h,zIndex:m===null?null:Number(m)}))}onRegion(e,t,i,r,n,s,a,o,l,u){let c=this.getZIndex(e);this.handleData(this.encode.encodeRegion(mt(e),{groupId:i,layerId:r,width:n,prohibitType:s,path:a,locked:o,zIndex:c===null?null:Number(c),name:l,regionType:u}))}onFill(e,t,i,r,n,s,a,o,l,u,c){let h=this.getZIndex(e);this.handleData(this.encode.encodeFill(mt(e),{groupId:i,netName:r,layerId:n,width:s,fillStyle:a,path:o,locked:l,zIndex:h===null?null:Number(h),isBridgingCopper:!1,networkList:[],refs:u,specialColor:c}))}onPoly(e,t,i,r,n,s,a,o,l){let u=this.getZIndex(e);this.handleData(this.encode.encodePoly(mt(e),{groupId:i,netName:r,layerId:n,width:s,path:a,locked:o,zIndex:u===null?null:Number(u),specialColor:l,polyType:n==11?"BOARD_OUTLINE":"NORMAL"}))}onEQLenGrp(e,t,i,r){this.handleData(this.encode.encodeEQLenGrp(mt(e),{name:t,sort:i,pads:r}))}onObj(e,t,i,r,n,s,a,o,l,u,c,h,m,f){if(h.startsWith("data:")){let y=vf(h);this.blobData.push(this.blobEncode.buildStr(1,y,{filename:n,content:h})),h=`blob:${y}`}let g=this.getZIndex(e);this.handleData(this.encode.encodeObj(mt(e),{groupId:i,layerId:r,fileName:n,startX:s,startY:a,width:o,height:l,angle:u,mirror:c,path:h,locked:m,zIndex:g===null?null:Number(g),specialColor:f}))}onArc(e,t,i,r,n,s,a,o,l,u,c,h,m){let f=this.getZIndex(e);this.handleData(this.encode.encodeArc(mt(e),{groupId:i,netName:r,layerId:n,startX:s,startY:a,endX:o,endY:l,angle:u,width:c,locked:h,zIndex:f===null?null:Number(f),arcType:"DOT",specialColor:m}))}onCArc(e,t,i,r,n,s,a,o,l,u,c,h,m){let f=this.getZIndex(e);this.handleData(this.encode.encodeArc(mt(e),{groupId:i,netName:r,layerId:n,startX:s,startY:a,endX:o,endY:l,angle:u,width:c,locked:h,zIndex:f===null?null:Number(f),arcType:"CENT",specialColor:m}))}onLine(e,t,i,r,n,s,a,o,l,u,c){let h=this.getZIndex(e);this.handleData(this.encode.encodeLine(mt(e),{groupId:i,netName:r,layerId:n,startX:s,startY:a,endX:o,endY:l,width:u,locked:c,zIndex:h===null?null:Number(h)}))}onPad(e,t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E,S,v,A,x,T,R,L,O,H){let k=this.getZIndex(e);this.handleData(this.encode.encodePad(mt(e),{groupId:i,netName:r,layerId:n,num:s,centerX:a,centerY:o,padAngle:l,hole:u,defaultPad:c,specialPad:h,padOffsetX:m,padOffsetY:f,relativeAngle:g,plated:y,padType:b,topSolderExpansion:E,bottomSolderExpansion:S,topPasteExpansion:v,bottomPasteExpansion:A,locked:x,zIndex:k===null?null:Number(k),connectMode:T,spokeSpace:R,spokeWidth:L,spokeAngle:O,unusedInnerLayers:H,padLen:0}))}onVia(e,t,i,r,n,s,a,o,l,u,c,h,m,f){let g=this.getZIndex(e);this.handleData(this.encode.encodeVia(mt(e),{groupId:i,netName:r,ruleName:n,centerX:s,centerY:a,holeDiameter:o,viaDiameter:l,viaType:u,topSolderExpansion:c,bottomSolderExpansion:h,locked:m,zIndex:g===null?null:Number(g),unusedInnerLayers:f}))}onPreference(e,t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E,S,v){this.handleData(this.encode.encodePreference({startTrackWidthFollowLast:e,lastTrackWidth:t,startViaSizeFollowLast:i,lastViaInnerDiameter:r,lastViaDiameter:n,snap:s,routingMode:a,routingCorner:o,removeLoop:l,rotatingObject:u,trackFollow:c,stretchTrackMinCorner:h,preferenceConfig:m,realTimeUpdateUnusedLayers:f,unusedPadRange:g,pushVia:y,pathOptimization4BePushed:b,currentPathOptimization4BePushed:E,removeCircuitsContainingVias:S,removeAntenna:v}))}onSilkOpts(e,t,i){this.handleData(this.encode.encodeSilkOpts(e,{defaultColor:t,baseColor:i}))}onGroup(e,t){this.handleData(this.encode.encodeGroup(e,{groupName:t}))}onPrimitive(e,t,i){this.handleData(this.encode.encodePrimitive(e,{display:t,pick:i}))}onNet(e,t,i,r,n,s,a){this.handleData(this.encode.encodeNet(e,{netType:t,specialColor:i,retLine:r,differentialName:n,isPositiveNet:s,equalLengthGroupName:a}))}onPartition(e,t,i,r){}onActiveLayer(e){this.handleData(this.encode.encodeActiveLayer({layerId:e}))}onLayerPhys(e,t,i,r,n,s,a){this.handleData(this.encode.encodeLayerPhys(e,{material:t,thickness:i,permittivity:r,lossTangent:n,isKeepIsland:s,zIndex:a}))}onLayer(e,t,i,r,n,s,a,o,l,u){this.handleData(this.encode.encodeLayer(e,{layerType:t,layerName:i,use:r,show:n,locked:s,activeColor:a,activateTransparency:o,inactiveColor:l,inactiveTransparency:u}))}onCanvas(e,t,i,r,n,s,a,o,l,u,c,h){this.handleData(this.encode.encodeCanvas({originX:e,originY:t,unit:i,gridXSize:r,gridYSize:n,snapXSize:s,snapYSize:a,altSnapXSize:o,altSnapYSize:l,gridType:u,multiGridType:c,multiGridRatio:h,highlightValue:.5}))}};function tG(e,t,i,r=new Date().getTime(),n=String(r),s){let a=new eG(i),o="",l=cr();if(o=Fo("FOOTPRINT",l,e,r,n,s),a.parseFull(t),a.encodeData&&(o=o+ui+a.encodeData),a.blobData.length&&(o=o+ui+a.blobEncode.head({doc:"BLOB",client:l,updateTime:r,version:n,user:s})+ui+a.blobData.join(ui)),a.fontCache.length){let u=new sG,c=u.head({doc:"FONT",client:l,updateTime:r,version:n,user:s});for(let h of a.fontCache){let m=Hb(h.text,h.fontFamily,h.fontSize,h.thickness,h.bold,h.italic,h.reverse,h.expansion),f=u.buildStr(1,m,h);c=c+ui+f}o=c+ui+o}return o}var iG=class{constructor(){}encodePart(e,t){return{id:e,dataType:"PART",data:JSON.stringify(t)}}encodeCanvas(e){return{id:"CANVAS",dataType:"CANVAS",data:JSON.stringify(e)}}encodeAttr(e,t){return{id:e,dataType:"ATTR",data:JSON.stringify(t)}}encodeTable(e,t){return{id:e,dataType:"TABLE",data:JSON.stringify(t)}}encodeEllipse(e,t){return{id:e,dataType:"ELLIPSE",data:JSON.stringify(t)}}encodeObj(e,t){return{id:e,dataType:"OBJ",data:JSON.stringify(t)}}encodePin(e,t){return{id:e,dataType:"PIN",data:JSON.stringify(t)}}encodeRect(e,t){return{id:e,dataType:"RECT",data:JSON.stringify(t)}}encodeArc(e,t){return{id:e,dataType:"ARC",data:JSON.stringify(t)}}encodeCircle(e,t){return{id:e,dataType:"CIRCLE",data:JSON.stringify(t)}}encodePoly(e,t){return{id:e,dataType:"POLY",data:JSON.stringify(t)}}encodeText(e,t){return{id:e,dataType:"TEXT",data:JSON.stringify(t)}}encodeBezier(e,t){return{id:e,dataType:"BEZIER",data:JSON.stringify(t)}}encodeGroup(e,t){return{id:e,dataType:"GROUP",data:JSON.stringify(t)}}},rG=class extends JY{constructor(){super(),this.encode=new iG,this.maxTicket=0,this.blobEncode=new d0,this.blobData=[],this.encodeData=""}handleData(e){this.encodeData?this.encodeData=this.encodeData+ui+kr(e.dataType,++this.maxTicket,e.id,e.data):this.encodeData=kr(e.dataType,++this.maxTicket,e.id,e.data)}onPHolder(e,t){let i={dataType:e,max:t};this.handleData({id:cr(),dataType:"ELE_PLACEHOLDER",data:JSON.stringify(i)})}onPart(e,t){this.handleData(this.encode.encodePart(e,t||{}))}onAttr(e,t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E,S,v,A){this.handleData(this.encode.encodeAttr(mt(e),{partId:t,groupId:i,locked:r,zIndex:this.getZIndex(e),parentId:n,key:s,value:a,keyVisible:o,valueVisible:l,x:u,y:ji(c),rotation:h,color:m,fillColor:f,fontFamily:g,fontSize:y,strikeout:b,underline:E,italic:S,fontWeight:v,align:A}))}onTable(e,t,i,r,n,s,a,o,l,u,c){this.handleData(this.encode.encodeTable(mt(e),{partId:t,groupId:i,startX:r,startY:ji(n),rowSizes:s,colSizes:a,rowLocked:o,colLocked:l,rotation:u,tableCell:c,zIndex:this.getZIndex(e)}))}onEllipse(e,t,i,r,n,s,a,o,l,u,c,h,m,f){this.handleData(this.encode.encodeEllipse(mt(e),{partId:t,groupId:i,locked:r,zIndex:this.getZIndex(e),centerX:n,centerY:ji(s),radiusX:a,radiusY:ji(o),rotation:l,strokeColor:u,strokeStyle:c,fillColor:h,strokeWidth:m,fillStyle:f}))}onComponent(){}onObj(e,t,i,r,n,s,a,o,l,u,c,h){if(h.startsWith("data:")){let m=vf(h);this.blobData.push(this.blobEncode.buildStr(1,m,{filename:"",content:h})),h=`blob:${m}`}this.handleData(this.encode.encodeObj(mt(e),{partId:t,groupId:i,locked:r,zIndex:this.getZIndex(e),fileName:n,startX:s,startY:ji(a),width:o,height:l,rotation:u,isMirror:c,content:h}))}onPin(e,t,i,r,n,s,a,o,l,u,c,h){this.handleData(this.encode.encodePin(mt(e),{partId:t,groupId:i,locked:r,zIndex:this.getZIndex(e),display:n,x:a,y:ji(o),length:l,rotation:u,color:c,pinShape:h}))}onRect(e,t,i,r,n,s,a,o,l,u,c,h,m,f,g,y){this.handleData(this.encode.encodeRect(mt(e),{partId:t,groupId:i,locked:r,zIndex:this.getZIndex(e),dotX1:n,dotY1:ji(s),dotX2:a,dotY2:ji(o),radiusX:l,radiusY:u,rotation:c,strokeColor:h,strokeStyle:m,fillColor:f,strokeWidth:g,fillStyle:y}))}onArc(e,t,i,r,n,s,a,o,l,u,c,h,m,f,g){this.handleData(this.encode.encodeArc(mt(e),{partId:t,groupId:i,locked:r,zIndex:this.getZIndex(e),startX:n,startY:ji(s),referX:a,referY:ji(o),endX:l,endY:ji(u),strokeColor:c,strokeStyle:h,fillColor:m,strokeWidth:f,fillStyle:g}))}onCircle(e,t,i,r,n,s,a,o,l,u,c,h){this.handleData(this.encode.encodeCircle(mt(e),{partId:t,groupId:i,locked:r,zIndex:this.getZIndex(e),centerX:n,centerY:ji(s),radius:a,strokeColor:o,strokeStyle:l,fillColor:u,strokeWidth:c,fillStyle:h}))}onPoly(e,t,i,r,n,s,a,o,l,u,c){this.handleData(this.encode.encodePoly(mt(e),{partId:t,groupId:i,locked:r,zIndex:this.getZIndex(e),points:d9(n,!0),closed:s,strokeColor:a,strokeStyle:o,fillColor:l,strokeWidth:u,fillStyle:c}))}onText(e,t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b){this.handleData(this.encode.encodeText(mt(e),{partId:t,groupId:i,locked:r,zIndex:this.getZIndex(e),x:n,y:ji(s),rotation:a,value:o,color:l,fillColor:u,fontFamily:c,fontSize:h,strikeout:m,underline:f,italic:g,fontWeight:y,align:b}))}onCanvas(e){this.handleData(this.encode.encodeCanvas({originX:e.originX,originY:ji(e.originY)}))}onBezier(e,t,i,r,n,s,a,o,l,u){this.handleData(this.encode.encodeBezier(mt(e),{partId:t,groupId:i,locked:r,zIndex:this.getZIndex(e),controls:n,strokeColor:s,strokeStyle:a,fillColor:o,strokeWidth:l,fillStyle:u}))}onGroup(e,t,i){this.handleData(this.encode.encodeGroup(String(e),{parentId:t,title:i}))}onBus(){}onWire(){}};function nG(e,t,i=new Date().getTime(),r=String(i),n){let s=new rG,a="";s.parseFull(t);let o=cr();s.encodeData&&(a=Fo("SYMBOL",o,e,i,r,n)+ui+s.encodeData),a&&s.blobData.length&&(a=a+ui+s.blobEncode.head({doc:"BLOB",client:o,updateTime:i,version:r,user:n})+ui+s.blobData.join(ui));let l=s.partIdMap;return s.partIdMap={},{dataStr:a,partIdMap:l}}var sG=class extends rT{constructor(){super(...arguments),this.doctype="FONT"}buildStr(e,t,i){let r=typeof i=="string"?i:JSON.stringify(this.buildData(i));return kr("FONT",e,t,r)}buildData(e){return{width:e.width,height:e.height,path:e.path}}};var aG=class extends XY{constructor(){super(),this.encode=new $Y,this.maxTicket=0,this.blobEncode=new d0,this.blobData=[],this.encodeData=""}handleData(e){this.encodeData?this.encodeData=this.encodeData+ui+kr(e.dataType,++this.maxTicket,e.id,e.data):this.encodeData=kr(e.dataType,++this.maxTicket,e.id,e.data)}onPHolder(e,t){let i={dataType:e,max:t};this.handleData({id:cr(),dataType:"ELE_PLACEHOLDER",data:JSON.stringify(i)})}strokeStyleType(e){switch(e=e&&Number(e),e){case 0:return"SOLID";case 1:return"SHORT_DASH";case 2:return"DOT";case 3:return"DOT_DASH";default:return null}}transScopeType(e){switch(e=e&&Number(e),e){case 1:return"PRINT";case 2:return"COVER";case 3:return"PRINT&COVER";default:return null}}transAlignType(e){switch(e=e&&Number(e),e){case 0:return"LEFT_BOTTOM";case 1:return"CENTER_BOTTOM";case 2:return"RIGHT_BOTTOM";case 3:return"LEFT_MIDDLE";case 4:return"CENTER_MIDDLE";case 5:return"RIGHT_MIDDLE";case 6:return"LEFT_TOP";case 7:return"CENTER_TOP";case 8:return"RIGHT_TOP";default:return null}}onAuxLine(e,t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E,S,v){this.handleData(this.encode.encodeAuxLine(mt(e),{groupId:t?`e${t}`:"",layer:i,x:r,y:n,rotation:s,strokeWidth:a,strokeStyle:this.strokeStyleType(o),color:l,length:u,locked:c,zIndex:this.getZIndex(e),visible:!m,cover:f,name:g}))}onDimension(e,t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E){this.handleData(this.encode.encodeDimension(mt(e),{layer:t,dimensionType:i,unit:r,strokeWidth:n,accuracy:s,controlDot:a,relationIds:o,locked:l,zIndex:this.getZIndex(e),valid:!u,visible:!c,cover:h,name:m,rotation:0}))}onString(e,t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E,S,v,A,x,T,R,L){this.handleData(this.encode.encodeString(mt(e),{groupId:t?`e${t}`:"",layer:i,rotation:r,value:n,fontFamily:s,fontSize:a,fontWeight:o,italic:l,underline:u,strikeout:c,align:this.transAlignType(h),strokeColor:m,opacity:f,locked:g,zIndex:this.getZIndex(e),valid:!y,visible:!b,cover:E,transScope:this.transScopeType(v),transPrint:A,transWhite:x,matrix:T,strokes:R,path:L,name:S}))}onPoly(e,t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E,S,v,A,x){if(typeof o=="string"&&o.startsWith("data:")){let T=vf(o);this.blobData.push(this.blobEncode.buildStr(1,T,{filename:"",content:o})),o=`blob:${T}`}this.handleData(this.encode.encodePoly(mt(e),{groupId:t?`e${t}`:"",layer:i,rotation:r,strokeWidth:n,strokeStyle:this.strokeStyleType(s),strokeColor:a,fillColor:o,opacity:l,autoClose:u,ploys:c,displayFill:h,displayStroke:m,locked:f,zIndex:this.getZIndex(e),valid:!g,visible:!y,cover:b,transScope:this.transScopeType(S),transPrint:v,transWhite:A,matrix:x,name:E}))}onGroup(e,t,i,r,n){this.handleData(this.encode.encodeGroup(`e${e}`,{parentId:t?`e${t}`:"",title:i,visible:r,locked:n}))}onCanvas(e){this.handleData(this.encode.encodeCanvas(e))}};function oG(e,t,i,r=new Date().getTime(),n=String(r),s){let a=new aG,o="";a.parseFull(t);let l=cr();return a.encodeData&&(o=Fo(i,l,e,r,n,s)+ui+a.encodeData),o&&a.blobData.length&&(o=o+ui+a.blobEncode.head({doc:"BLOB",client:l,updateTime:r,version:n,user:s})+ui+a.blobData.join(ui)),o}var sT=class extends g9{constructor(e){let t=e||new vx;super(t,0,m9),this.cacheNum=null}onParseLine(e,t,i,r,n,s,a){switch(this.setOrderNum(e,a,t),this.cacheNum=a,t){case"MAX_NUM":if(i)for(let l in i)this.setMaxNum(l,i[l]);break;case"BLOB":i?this.onBlob(e,r,n,i,s):this.onDelBlob(e,r,n,s);break;case"FONT":this.parseFont(e,i,r,n,s);break;case"META":i&&this.parseDetail(i,r,n,s);break;case"ELE_PLACEHOLDER":break;case"CANVAS":i&&this.parseCanvas(i,r,n,s);break;case"LAYER":{let l=Ba(e);i?this.parseLayer(l,i,r,n,s):this.onDelLayer(l,r,n,s);break}case"LAYER_PHYS":{let l=Ba(e);i?this.parseLayerPhys(l,i,r,n,s):this.onDelLayerPhys(l,r,n,s);break}case"ACTIVE_LAYER":i&&this.parseActiveLayer(e,i,r,n,s);break;case"PARTITION":i?this.parsePartition(e,i,r,n,s):this.onDelPartition(e,r,n,s);break;case"NET":{let l=Ba(e);i?this.parseNet(l,i,r,n,s):this.onDelNet(l,r,n,s);break}case"PRIMITIVE":{let l=Ba(e);i?this.parsePrimitive(l,i,r,n,s):this.onDelPrimitive(l,r,n,s);break}case"GROUP":i?this.parseGroup(e,i,r,n,s):this.onDelGroup(e,r,n,s);break;case"SILK_OPTS":{let l=Ba(e);i?this.parseSilkOpts(l,i,r,n,s):this.onDelSilkOpts(l,r,n,s);break}case"PREFERENCE":i&&this.parsePreference(e,i,r,n,s);break;case"VIA":i?this.parseVia(e,i,r,n,s):this.onDelVia(e,r,n,s);break;case"PAD":i?this.parsePad(e,i,r,n,s):this.onDelPad(e,r,n,s);break;case"LINE":i?this.parseLine(e,i,r,n,s):this.onDelLine(e,r,n,s);break;case"ARC":i?this.parseArc(e,i,r,n,s):this.onDelArc(e,r,n,s);break;case"OBJ":i?this.parseObj(e,i,r,n,s):this.onDelObj(e,r,n,s);break;case"EQLEN_GRP":i?this.parseEQLenGrp(e,i,r,n,s):this.onDelEQLenGrp(e,r,n,s);break;case"POLY":i?this.parsePoly(e,i,r,n,s):this.onDelPoly(e,r,n,s);break;case"FILL":i?this.parseFill(e,i,r,n,s):this.onDelFill(e,r,n,s);break;case"LAYER_FILL":let o=Ba(e);i?this.parseLayerFill(o,i,r,n,s):this.onDelLayerFill(o,r,n,s);break;case"REGION":i?this.parseRegion(e,i,r,n,s):this.onDelRegion(e,r,n,s);break;case"POUR":i?this.parsePour(e,i,r,n,s):this.onDelPour(e,r,n,s);break;case"POURED":{e=Ba(e),i?this.parsePoured(e,i,r,n,s):this.onDelPoured(e,r,n,s);break}case"IMAGE":i?this.parseImage(e,i,r,n,s):this.onDelImage(e,r,n,s);break;case"TEARDROP":i?this.parseTeardrop(e,i,r,n,s):this.onDelTeardrop(e,r,n,s);break;case"FPC_FILL":i?this.parseFpcFill(e,i,r,n,s):this.onDelFpcFill(e,r,n,s);break;case"SHELL":i?this.parseShell(e,i,r,n,s):this.onDelShell(e,r,n,s);break;case"CREASE":i?this.parseCrease(e,i,r,n,s):this.onDelCrease(e,r,n,s);break;case"SHELLCUT":i?this.parseShellCut(e,i,r,n,s):this.onDelShellCut(e,r,n,s);break;case"SHELL_ENTITY":i?this.parseShellEntity(e,i,r,n,s):this.onDelShellEntity(e,r,n,s);break;case"BOSS":i?this.parseBoss(e,i,r,n,s):this.onDelBoss(e,r,n,s);break;case"STRING":i?this.parseString(e,i,r,n,s):this.onDelString(e,r,n,s);break;case"ATTR":i?this.parseAttr(e,i,r,n,s):this.onDelAttr(e,r,n,s);break;case"DIMENSION":i?this.parseDimension(e,i,r,n,s):this.onDelDimension(e,r,n,s);break;case"COMPONENT":i?this.parseComponent(e,i,r,n,s):this.onDelComponent(e,r,n,s);break;case"PAD_NET":{let l=JSON.parse(e);i?(i.componentId=l[1],i.padNum=l[2],i.padId=l[3],this.parsePadNet(i,r,n,s)):this.onDelPadNet(l[1],l[2],l[3]||"",r,n,s);break}case"RULE_TEMPLATE":i&&this.parseRuleTemplate(e,i,r,n,s);break;case"RULE":{let l=JSON.parse(e);i?(i.ruleType=l[1],i.ruleName=l[2],this.parseRule(i,r,n,s)):this.onDelRule(l[1],l[2],r,n,s);break}case"RULE_SELECTOR":{let l=JSON.parse(e);i?(i.ruleSelect=l[1],this.parseRuleSelector(i,r,n,s)):this.onDelRuleSelector(l[1],r,n,s);break}case"PANELIZE":i?this.parsePanelize(e,i,r,n,s):this.onDelPanelize(r,n,s);break;default:console.warn("can not find hanlder with",i,r,n)}this.cacheNum=null}onOrderNum(e,t,i){switch(this.setOrderNum(e,i,t),t){case"PARTITION":this.onPartitionNum&&this.onPartitionNum(e,i);break;case"VIA":this.onViaNum&&this.onViaNum(e,i);break;case"PAD":this.onPadNum&&this.onPadNum(e,i);break;case"LINE":this.onLineNum&&this.onLineNum(e,i);break;case"ARC":this.onArcNum&&this.onArcNum(e,i);break;case"OBJ":this.onObjNum&&this.onObjNum(e,i);break;case"POLY":this.onPolyNum&&this.onPolyNum(e,i);break;case"FILL":this.onFillNum&&this.onFillNum(e,i);break;case"REGION":this.onRegionNum&&this.onRegionNum(e,i);break;case"POUR":this.onPourNum&&this.onPourNum(e,i);break;case"POURED":let r=Ba(e);this.onPouredNum&&this.onPouredNum(r,i);break;case"IMAGE":this.onImageNum&&this.onImageNum(e,i);break;case"TEARDROP":this.onTeardropNum&&this.onTeardropNum(e,i);break;case"FPC_FILL":this.onFpcFillNum&&this.onFpcFillNum(e,i);break;case"SHELL":this.onShellNum&&this.onShellNum(e,i);break;case"CREASE":this.onCreaseNum&&this.onCreaseNum(e,i);break;case"SHELLCUT":this.onShellCutNum&&this.onShellCutNum(e,i);break;case"SHELL_ENTITY":this.onShellEntityNum&&this.onShellEntityNum(e,i);break;case"BOSS":this.onBossNum&&this.onBossNum(e,i);break;case"STRING":this.onStringNum&&this.onStringNum(e,i);break;case"ATTR":this.onAttrNum&&this.onAttrNum(e,i);break;case"DIMENSION":this.onDimensionNum&&this.onDimensionNum(e,i);break;case"COMPONENT":this.onComponentNum&&this.onComponentNum(e,i);break}}onParseEnd(){}parseCanvas(e,t,i,r){this.onCanvas(t,i,e,r)}parseDetail(e,t,i,r){this.onDocDetail(t,i,e,r)}parseFont(e,t,i,r,n){let s=ZY(e);t?this.onFont(i,r,Object.assign(t,s),n):this.onDelFont(s,i,r,n)}parseLayer(e,t,i,r,n){this.onLayer(e,i,r,t,n)}parseLayerPhys(e,t,i,r,n){this.onLayerPhys(e,i,r,t,n)}parseActiveLayer(e,t,i,r,n){this.onActiveLayer(i,r,t,n)}parsePartition(e,t,i,r,n){this.onPartition(e,this.cacheNum,i,r,t,n)}parseNet(e,t,i,r,n){this.onNet(e,i,r,t,n)}parsePrimitive(e,t,i,r,n){this.onPrimitive(e,i,r,t,n)}parseGroup(e,t,i,r,n){this.onGroup(e,i,r,t,n)}parseSilkOpts(e,t,i,r,n){this.onSilkOpts(e,i,r,t,n)}parsePreference(e,t,i,r,n){this.onPreference(i,r,t,n)}parseVia(e,t,i,r,n){this.onVia(e,this.cacheNum,i,r,t,n)}parsePad(e,t,i,r,n){this.onPad(e,this.cacheNum,i,r,t,n)}parseLine(e,t,i,r,n){this.onLine(e,this.cacheNum,i,r,t,n)}parseArc(e,t,i,r,n){this.onArc(e,this.cacheNum,i,r,t,n)}parseObj(e,t,i,r,n){this.onObj(e,this.cacheNum,i,r,t,n)}parseEQLenGrp(e,t,i,r,n){this.onEQLenGrp(e,i,r,t,n)}parsePoly(e,t,i,r,n){this.onPoly(e,this.cacheNum,i,r,t,n)}parseFill(e,t,i,r,n){t.fillStyle!=="PLANE"&&this.onFill(e,this.cacheNum,i,r,t,n)}parseLayerFill(e,t,i,r,n){this.onLayerFill(e,i,r,t,n)}parseRegion(e,t,i,r,n){this.onRegion(e,this.cacheNum,i,r,t,n)}parsePour(e,t,i,r,n){this.onPour(e,this.cacheNum,i,r,t,n)}parsePoured(e,t,i,r,n){let s=t;Array.isArray(t)&&(s={pourFill:t}),s.pourFill&&this.onPoured(e,this.cacheNum,i,r,s,n)}parseImage(e,t,i,r,n){this.onImage(e,this.cacheNum,i,r,t,n)}parseTeardrop(e,t,i,r,n){this.onTeardrop(e,this.cacheNum,i,r,t,n)}parseFpcFill(e,t,i,r,n){this.onFpcFill(e,this.cacheNum,i,r,t,n)}parseShell(e,t,i,r,n){this.onShell(e,this.cacheNum,i,r,t,n)}parseCrease(e,t,i,r,n){this.onCrease(e,this.cacheNum,i,r,t,n)}parseShellCut(e,t,i,r,n){this.onShellCut(e,this.cacheNum,i,r,t,n)}parseShellEntity(e,t,i,r,n){this.onShellEntity(e,this.cacheNum,i,r,t,n)}parseBoss(e,t,i,r,n){this.onBoss(e,this.cacheNum,i,r,t,n)}parseDimension(e,t,i,r,n){this.onDimension(e,this.cacheNum,i,r,t,n)}parseRuleTemplate(e,t,i,r,n){this.onRuleTemplate(i,r,t,n)}parseRule(e,t,i,r){this.onRule(t,i,e,r)}parseRuleSelector(e,t,i,r){if(e.ruleKeyValue&&(e.ruleKeyValue=Ax(e.ruleKeyValue)),e.copperValue&&e.copperValue.hasOwnProperty("7")){let n=e.copperValue[7];delete e.copperValue[7],e.copperValue.COPPER=n}if(e.innerPlaneValue&&e.innerPlaneValue.hasOwnProperty("6")){let n=e.innerPlaneValue[6];delete e.innerPlaneValue[6],e.innerPlaneValue.PLANE=n}this.onRuleSelector(t,i,e,r)}parsePanelize(e,t,i,r,n){this.onPanelize(i,r,t,n)}parseComponent(e,t,i,r,n){this.onComponent(e,this.cacheNum,i,r,t,n)}parsePadNet(e,t,i,r){this.onPadNet(t,i,e,r)}parseAttr(e,t,i,r,n){this.onAttr(e,this.cacheNum,i,r,t,n)}parseString(e,t,i,r,n){this.onString(e,this.cacheNum,i,r,t,n)}};var lG=(e=>(e.UNIVERSAL="UNIVERSAL",e))(lG||{}),uG=(e=>(e.SINGLE="SINGLE",e.MULTIPLE="MULTIPLE",e))(uG||{}),cG=(e=>(e.NONE="NONE",e.NAME="NAME",e.NUMBER="NUMBER",e))(cG||{}),dG=(e=>(e.NONE="NONE",e.ZONE="ZONE",e))(dG||{});var hG=cu(sd());function Qc(){return self.EDITOR_TOP||self}function nu(e){return self[e]=self[e]||new hG.BroadcastChannelMessageBus(e)}var Do=(e,t)=>{let i=/{([^}]*)}/gim,r=[...new Set(e.match(i))];for(let n=0;n<r.length;n++){let s=r[n],a=s.substring(1,s.length-1);t[a]&&(e=e.replace(s,t[a]))}return e};function pG(e){var t;return e instanceof Request?e.url:(t=e==null?void 0:e.startsWith)!=null&&t.call(e,location.origin)?e:`${location.origin}/${e}`}function fG(e,t,i,r){return pG(`dataStr/${e}${t&&t!=="0"?`-${t}`:""}-${i}${r&&r!=="0"?`-${r}`:""}`)}function mG(e,t="utf-8"){var i=new TextDecoder(t);return i.decode(e)}async function gG(e,t,i,r){let n=await e.match(t);if(r!=null&&r())return!0;if(n!=null&&n.body){let s=n.body.getReader(),a=i();for(a.start();;){let o=await s.read();if(r!=null&&r())return!0;if(o.value&&a.update(mG(o.value)),o.done){a.end();break}}return!0}return!1}async function yG(e,t,i,r,n,s){let a=await caches.open(e),o=[];for(let l of i)if(l.docs)for(let u=l.docs.length-1;u>=0&&!(o.length>10&&(await Promise.all(o),o.length=0,s==null?void 0:s())||n.size<1);--u){let c=l.docs[u];for(let h of t)if(c[h]!==void 0)for(let m=0;m<=c[h];++m){let f=fG(l.snapshot||l.uuid,u,h,m),g=gG(a,f,r);o.push(g),g.then(y=>{!y&&console.error("\u83B7\u53D6\u4E0D\u5230\u6570\u636E",h,m)})}}o.length&&await Promise.all(o)}var Dt={getTime:"/pro-mgr/serverTime/now",getUserL:"/pro-ui/loginUser/get",subMaxTick:"/pro-mgr/project/ticket",subBlob:"/pro-mgr/canvas/BLOB/update",subFont:"/pro-mgr/canvas/FONT/update",subRevoke:"/pro-mgr/{uuid}/revoke",pushPend:"/pro-mgr/worker/batchPendData",pushSync:"/pro-mgr/dataWorker/sync",pushRevoke:"/pro-mgr/worker/revoke",pullASync:"/pro-mgr/dataWorker/sync/{id}",personDestroy:"/mgr/libWorker/destroy",projectUpdate:"/pro-mgr/canvas/{uuid}/update",personUpdate:"/mgr/libWorker/component/{uuid}/update",personSave:"/mgr/libWorker/save",projectSave:"/mgr/projectWorker/setCanvas",canSavePend:"/mgr/projectWorker/canSavePend",hasSaveData:"/mgr/check/hasSaveData"},_G={projectUpdate:Dt.projectUpdate,personUpdate:Dt.personUpdate,projectCanSave:Dt.canSavePend,getProject:"/mgr/projectWorker/footprint/getCanvas",getPerson:"/mgr/libWorker/getFootprint",unwatch:"/mgr/projectWorker/footprint/unwatchCanvas"},bG={projectUpdate:Dt.projectUpdate,projectCanSave:Dt.canSavePend,getProject:"/mgr/projectWorker/pcb/getCanvas",unwatch:"/mgr/projectWorker/pcb/unwatchCanvas"},Jee={projectUpdate:Dt.projectUpdate,projectCanSave:Dt.canSavePend,getProject:"/mgr/projectWorker/sheet/getCanvas",unwatch:"/mgr/projectWorker/sheet/unwatchCanvas"},$ee={projectUpdate:Dt.projectUpdate,getProject:"/mgr/projectWorker/schematic/getCanvas",unwatch:"/mgr/projectWorker/schematic/unwatchCanvas"},Kee={projectUpdate:Dt.projectUpdate,projectCanSave:Dt.canSavePend,getProject:"/mgr/projectWorker/simulation/getCanvas",unwatch:"/mgr/projectWorker/simulation/unwatchCanvas"},Zee={projectUpdate:Dt.projectUpdate,personUpdate:Dt.personUpdate,projectCanSave:Dt.canSavePend,getProject:"/mgr/projectWorker/symbol/getCanvasOnCompiler",getPerson:"/mgr/libWorker/getSymbol",unwatch:"/mgr/projectWorker/symbol/unwatchCanvas"},Qee={projectUpdate:Dt.projectUpdate,personUpdate:Dt.personUpdate,projectCanSave:Dt.canSavePend,getProject:"/mgr/projectWorker/panel/getCanvas",getPerson:"/mgr/libWorker/getPanelLib",unwatch:"/mgr/projectWorker/panel/unwatchCanvas"};var Dr={send:"/pro-mgr/notify/send",sendMsg:"/document/sendMsg/cooperation",unwatch:"/document/unwatch/cooperation",watch:"/document/watch/cooperation",message:"/pro-mgr/notify/message/{path}/{uuid}/cooperation",established:"/pro-mgr/notify/message/ws/established",getWsId:"/pro-mgr/notify/getWsId",disconnect:"/pro-mgr/notify/message/ws/disconnect"},h0=class{constructor(e=!0){this._lockerTicket=0,this.isPull=!1,this.compiler={},this.order={SYMBOL:1,FOOTPRINT:2,DEVICE:3,SCH_PAGE:4,PCB:5},this._locker=e?++this._lockerTicket:0}getOrder(e){return this.order[e]||6}publish(){if(!this.isPull){this.isPull=!0,this._temporaryUnlock=this._locker;try{let e=Object.keys(this.compiler).sort((i,r)=>this.getOrder(i)-this.getOrder(r)),t=!1;for(let i of e){for(let[,r]of this.compiler[i])if(t=r.publish(),t)break;if(t)break}}finally{this._temporaryUnlock=0,this.isPull=!1}}}canPush(){return!this._locker||this._locker===this._temporaryUnlock}addCompiler(e){this.compiler[e.headType]||(this.compiler[e.headType]=new Map),this.compiler[e.headType].set(e.uniqueId,e)}removeCompiler(e){var t,i,r;(r=(i=(t=this.compiler)==null?void 0:t[e.headType])==null?void 0:i.delete)==null||r.call(i,e.uniqueId)}pull(){if(!this._locker)throw Error("\u4E0D\u5141\u8BB8\u5728\u975E pause \u72B6\u6001\u4E0B\u62C9\u53D6\u6570\u636E");this.publish()}resume(){this._locker=0,this.publish()}pause(){this._locker=++this._lockerTicket}dispose(){for(let e in this.compiler)this.compiler[e].clear();this.compiler=null}},Ma={publish:"publish",destroy:"destroy",init:"init",selected:"selected"},PG=class{constructor(e,t,i,r=(a=>(a=Qc())==null?void 0:a._TAB_ID_)(),n,s){var o;this.uuid=e,this.path=t,this.user=i,this.windowId=r,this.initIds={},this.sub=[],this.wsBus=s||nu(`/${this.windowId}/notify`),this.dataBus=n||this.wsBus,this._client=(o=Qc())==null?void 0:o._WS_ID_}get client(){return this._client}watch(){this.dataBus.publish(Dr.send,{topic:Dr.watch,uuid:this.uuid,path:this.path})}initPublish(){var e;this.dataBus.publish(Dr.send,{topic:Dr.sendMsg,uuid:this.uuid,path:this.path,msg:{type:Ma.publish,user:this.user,client:this.client,data:((e=this.getSelect)==null?void 0:e.call(this))||""}})}async init(){if(!this.isInit){if(this.sub.push(this.wsBus.subscribe(Dr.established,e=>{this._client=e,this.watch(),this.initPublish()})),!this.client){let e=await this.wsBus.rpcCall(Dr.getWsId);if(!e||this.client)return;this._client=e}this.watch(),this.sub.push(this.wsBus.subscribe(Dr.disconnect,e=>{this.initIds[e]&&this.onDestroy(this.initIds[e],e)})),this.sub.push(this.dataBus.subscribe(Do(Dr.message,{uuid:this.uuid,path:this.path}),e=>{if(e.type===1)e.connectId&&this.initIds[e.connectId]&&this.onDestroy(this.initIds[e.connectId],e.connectId);else if(e.msg){let t=e.msg;if(t.client===this.client)return;switch(t.type){case Ma.destroy:this.onDestroy(t.userId,t.client),delete this.initIds[t.client];break;case Ma.init:this.initIds[t.client]||(this.initIds[t.client]=t.user.uuid,this.onSelected(t.user,t.client,t.data||""));break;case Ma.selected:this.onSelected(t.user,t.client,t.data||"");break;case Ma.publish:this.dataBus.publish(Dr.send,{topic:Dr.sendMsg,uuid:this.uuid,path:this.path,msg:{type:Ma.init,user:this.user,client:this.client,data:this.getSelect()||""}}),this.initIds[t.client]=t.user.uuid,this.onSelected(t.user,t.client,t.data||"");break;default:break}}})),this.initPublish(),this.isInit=!0}}publishSelected(e,t){this.dataBus.publish(Dr.send,{topic:Dr.sendMsg,uuid:this.uuid,path:this.path,msg:{type:Ma.selected,user:this.user,client:this.client,data:e}}),t&&this.onSelected(this.user,this.client,e)}destroy(){if(this.isInit){this.isInit=!1,this.dataBus.publish(Dr.send,{topic:Dr.unwatch,uuid:this.uuid,path:this.path,msg:{type:Ma.destroy,userId:this.user.uuid,client:this.client}});for(let e of this.sub)e.cancel();this.sub=[],this.initIds={}}}},KC=class extends PG{constructor(e,t,i,r,n,s,a,o){super(e,t,o,i,n,s),this.channel=r,this.selectedProps=a,this.cache=new Map,this.deleteCache=new Map}rePublish(){var e,t,i,r;if(this.channel.canPush()){for(let[n,s]of this.cache)(t=(e=this.selectedProps)==null?void 0:e.onSelect)==null||t.call(e,s.user,n,s.data);for(let[n,s]of this.deleteCache)(r=(i=this.selectedProps)==null?void 0:i.onQuit)==null||r.call(i,s,n)}}getSelect(){var e,t;return((t=(e=this.selectedProps)==null?void 0:e.getSelect)==null?void 0:t.call(e))||""}onSelected(e,t,i){var r,n;this.channel.canPush()?!this.deleteCache.has(t)&&this.cache.set(t,{user:e,data:i}):(n=(r=this.selectedProps)==null?void 0:r.onSelect)==null||n.call(r,e,t,i)}onDestroy(e,t){var i,r;this.channel.canPush()?(this.deleteCache.set(t,e),this.cache.delete(t)):(r=(i=this.selectedProps)==null?void 0:i.onQuit)==null||r.call(i,e,t)}dispose(){this.destroy(),this.cache.clear(),this.deleteCache.clear()}publishSelected(e,t){super.publishSelected(e,t)}},ZC=cu(sd()),EG=class{constructor(e,t,i,r=(E=>(E=Qc())==null?void 0:E._TAB_ID_)(),n=new h0,s=null,a,o,l,u,c,h,m,f,g,y,b){this.uuid=e,this.path=t,this.isProject=i,this.windowId=r,this.channel=n,this.consistencyManager=s,this.selectedProps=l,this.setInit=u,this.onDocDetail=c,this.onUpdate=h,this.handleInit=m,this.onDelete=f,this.publishCache=g,this.onOrderNm=y,this.setMaxNum=b,this.isInit=!1,this.canSave=!0,this.sub=[],this.isInitIng=!1,this.cache={},this.deleteCache=new Map,this.pendTimer=null,this.pendCache={},this.pendCacheLength=0,this.wsBus=nu(`/${r}/notify`),s||(this._unique=cr()),this._headType=a,this.busTopic=o}get uniqueId(){return this._unique||this.consistencyManager.getUnique()}get headType(){return this._headType}setIsInitIng(e){var t;(t=this.setInit)==null||t.call(this,e),this.isInitIng=e}consoleDebug(...e){console.debug("[lc-protocol]",this._headType,this.uuid,...e)}publishLine(e,t,i,r,n,s=this.uuid,a,o,l,u,c){if(this.channel.canPush())return this.consistencyManager.remoteChange(t,n,s,e,i,r,void 0,void 0,void 0,a,void 0,o,l,c),!1;this.cache[s]||(this.cache[s]=new Map);let h=this.cache[s].get(e);return(u||!h||h.ticket<t||h.ticket===t&&(h.client<n||h.client===n&&!!h.pend!=!!a))&&this.cache[s].set(e,{client:n,ticket:t,dataType:r,data:i,pend:a,unique:o,pChange:h?void 0:l,num:c}),!0}onDocHead(){}onEnd(){}setDocType(e,t){e===this.uuid&&(this._headType=t)}setBusTopic(e){this.busTopic=e}publish(){var t,i,r;if(this.publishCache)return this.publishCache();let e=!1;for(let[n,s]of this.deleteCache){if(this.channel.canPush()){(t=this.onDelete)==null||t.call(this,s),delete this.cache[n];continue}e=!0;break}if(e)return e;for(let n in this.cache){let s=this.cache[n].keys();for(let a of s){let o=this.cache[n].get(a);if(e=this.publishLine(a,o.ticket,o.data,o.dataType,o.client,n,o.pend,o.unique,o.pChange,!1,o.num),e)break;this.cache[n].delete(a)}if(e)break}return(r=(i=this.selectManager)==null?void 0:i.rePublish)==null||r.call(i),e}publishSelected(e,t){this.selectManager.publishSelected(e,t)}clear(){var e,t;for(let i of this.sub)i.cancel();this.sub.length=0,this.cache={},this.deleteCache.clear(),this.setIsInitIng(!1),this.channel.removeCompiler(this),(t=(e=this.selectManager)==null?void 0:e.dispose)==null||t.call(e),this.selectManager=null,this.isInit=!1,this.setIsInitIng(!1)}async init(e=!0,t=!0,i=!0,r,n,s,a){try{if(this.isInit)return{success:!0};if(this.isInitIng)throw new Error("\u6B63\u5728\u521D\u59CB\u5316\u4E2D");return this.isProject?await this.initProject(e,t,i,r,s,a):await this.initLib(i,r,n,s,a)}catch(o){throw this.clear(),new Error(`${this._headType}+'Compiler' ${this.uuid} init false: ${(o==null?void 0:o.message)||o||""}`,{cause:o})}finally{this.isInitIng=!1}}async flowRead(e){let t=this.consistencyManager.flowParseFull(),i=t.update,r=this;t.update=n=>{if(r.isDestroy)return!0;i(n)},await(0,ZC.flowRead)(e,t)}pushOnLine(e,t){if(this.consistencyManager)for(let i of e)this.publishLine(i[0],i[1],i[2],i[3],i[4],t,i[5],i[6],i[7],!1,i[8])}async initProject(e,t,i,r,n,s){var l,u;if(this.setIsInitIng(!0),this.channel.addCompiler(this),this.dataBus=nu(`/${this.windowId}/project/${this.path}`),n&&this.sub.push(this.dataBus.subscribe(`/pro-mgr/${this.uuid}/number/update`,c=>{if(this.onOrderNm)for(let h of c)this.onOrderNm(h[0],h[1],h[2])})),i&&this.busTopic.projectUpdate&&this.sub.push(this.dataBus.subscribe(Do(this.busTopic.projectUpdate,{uuid:this.uuid}),c=>{this.onUpdate?this.onUpdate(c):this.pushOnLine(c,this.uuid)})),i&&this.busTopic.projectCanSave&&this.sub.push(this.dataBus.subscribe(this.busTopic.projectCanSave,c=>{this.canSave=c})),i&&this.busTopic.subDelete&&this.sub.push(this.dataBus.subscribe(this.busTopic.subDelete,c=>{var h;this.channel.canPush()?(h=this.onDelete)==null||h.call(this,c):this.deleteCache.set(c[0],c)})),i&&this.consistencyManager&&this.sub.push(this.dataBus.subscribe(Dt.subMaxTick,c=>{this.consistencyManager.setMaxTicket(c.ticket,c.force)})),i&&t&&this.sub.push(this.dataBus.subscribe(Dt.subBlob,c=>{this.pushOnLine(c,"BLOB")})),i&&e&&this.sub.push(this.dataBus.subscribe(Dt.subFont,c=>{this.pushOnLine(c,"FONT")})),i&&this.consistencyManager&&this.sub.push(this.dataBus.subscribe(Do(Dt.subRevoke,{uuid:this.uuid}),c=>this.revoke(c))),!this.busTopic.getProject)throw new Error("\u83B7\u53D6\u6570\u636E\u5931\u8D25\uFF01\uFF01\uFF01");this.isDestroy=!1;let a={doc:[this.uuid],watch:i,needNum:n,clearDelete:s};t&&a.doc.push("BLOB"),e&&a.doc.push("FONT");let o=await this.dataBus.rpcCall(this.busTopic.getProject,a);if(this.isWatch=i,!this.isDestroy){if(!o.success)throw new Error("\u83B7\u53D6\u6570\u636E\u5931\u8D25\uFF01\uFF01\uFF01",o);if(this.canSave=!(o!=null&&o.readOnly),this.consoleDebug("init",o.result),o.maxTicket&&this.consistencyManager&&this.consistencyManager.setMaxTicket(o.maxTicket),o.data&&this.onDocDetail&&this.onDocDetail(o.client||cr(),0,o.data,!1),o.history){let c=o.ids;if(c.channel){let h=m=>{if(this.isDestroy)return!0;let f=JSON.parse(m);for(let g of f)this.consistencyManager.remoteChange(g[2],g[3],g[0],g[1],g[5],g[4],void 0,void 0,void 0,g[6],void 0,void 0,void 0,g[7])};if(await(0,ZC.flowRead)(c.channel,{update:h}),this.isDestroy)return}if(await yG(o.cacheName,a.doc,o.history,()=>this.consistencyManager.flowParseFull({idsData:c}),c,()=>this.isDestroy),n&&((l=c==null?void 0:c.maxNum)==null?void 0:l[this.uuid]))for(let h in c.maxNum[this.uuid])(u=this.setMaxNum)==null||u.call(this,h,c.maxNum[this.uuid][h],"")}if(!this.isDestroy){if(this.handleInit?this.handleInit(o):o.result&&this.consistencyManager&&this.consistencyManager.parseFull(o.result,this.uuid,this._headType),r){let c=this.user=this.user||o.user||await this.wsBus.rpcCall(Dt.getUserL);this.selectManager=new KC(this.uuid,this.path,this.windowId,this.channel,this.dataBus,this.wsBus,this.selectedProps,c),await this.selectManager.init()}return this.isInit=!0,this.setIsInitIng(!1),{success:!0}}}}async initLib(e,t,i,r,n){if(this.setIsInitIng(!0),this.channel.addCompiler(this),this.dataBus=nu(`/${this.windowId}/libWorker`),!this.busTopic.getPerson)throw new Error("\u83B7\u53D6\u6570\u636E\u5931\u8D25\uFF01\uFF01\uFF01");let s=i?cr():"";this.isDestroy=!1;let a=await this.dataBus.rpcCall(this.busTopic.getPerson,{uuid:this.uuid,path:this.path,watch:e,channel:s,needNum:r,needDelete:n});if(this.isWatch=e,this.isDestroy)return;if(!a.success)throw new Error("\u83B7\u53D6\u6570\u636E\u5931\u8D25\uFF01\uFF01\uFF01",a);this.consoleDebug("init",a.dataStr);let o=a.data||a.result;if(o&&this.onDocDetail&&this.onDocDetail(a.client||cr(),0,o,!1),r&&this.sub.push(this.dataBus.subscribe(`/pro-mgr/${this.uuid}/number/update`,l=>{if(this.onOrderNm)for(let u of l)this.onOrderNm(u[0],u[1],u[2])})),e&&this.busTopic.personUpdate&&this.sub.push(this.dataBus.subscribe(Do(this.busTopic.personUpdate,{uuid:this.uuid}),l=>{this.pushOnLine(l,this.uuid)})),e&&this.sub.push(this.dataBus.subscribe(Do(Do(Dt.subRevoke,{uuid:this.uuid}),{uuid:this.uuid}),l=>this.revoke(l))),s&&await this.flowRead(s),!this.isDestroy){if(a.dataStr&&this.consistencyManager&&this.consistencyManager.parseFull(a.dataStr),t){let l=this.user=this.user||a.user||await this.wsBus.rpcCall(Dt.getUserL);this.selectManager=new KC(this.uuid,this.path,this.windowId,this.channel,this.wsBus,this.wsBus,this.selectedProps,l),await this.selectManager.init()}return this.isInit=!0,this.setIsInitIng(!1),{success:!0}}}revoke(e){for(let t of e)this.consistencyManager&&this.consistencyManager.revoke(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],(...i)=>this.publishLine(...i)),t[10]&&this.setMaxNum&&this.setMaxNum(t[6],t[10],t[1])}cachePendData(e,t,i,r,n,s){this.pendCache[e]||(this.pendCache[e]={type:s,pend:[]}),this.pendCache[e].pend.push([t,i,n,r]),this.pendCacheLength+=r.length+1,this.pendCacheLength>1e7&&this.publishPendData(),this.pendTimer||(this.pendTimer=setTimeout(()=>{this.publishPendData(),this.pendTimer=null},0))}publishPendData(){if(this.pendCacheLength){this.dataBus.publish(Dt.pushPend,[this.pendCache,this.consistencyManager.getClient(),this.uniqueId,this.uuid]);for(let e in this.pendCache)this.pendCache[e].pend.length=0;this.pendCache={},this.pendCacheLength=0}}localChange(e,t,i,r=this.uuid,n,s){if(!this.isInit||!this.canSave||!this.consistencyManager)return 0;let a=this.consistencyManager.localChange(r,e,t,i,n,s);return this.cachePendData(r,e,a,t,i,n||this.headType),a}async sync(){if(!this.isInit)throw new Error("\u6570\u636E\u672A\u521D\u59CB\u5316\uFF0C\u65E0\u6CD5\u540C\u6B65");let e=cr();this.dataBus.publish(Dt.pushSync,e),await this.dataBus.pullA(Do(Dt.pullASync,{id:e}))}async destroy(){return this.isDestroy?{success:!1}:(this.consistencyManager&&this.dataBus&&this.dataBus.publish(Dt.pushRevoke,[this.uuid,this.uniqueId,this.consistencyManager.getClient()]),this.clear(),this.isDestroy=!0,this.isWatch&&this.dataBus&&!this.isProject&&this.dataBus.publish(Dt.personDestroy,{uuid:this.uuid,path:this.path}),this.isWatch&&this.dataBus&&this.busTopic.unwatch&&this.dataBus.publish(this.busTopic.unwatch,this.uuid),this.isWatch=!1,{success:!0})}async save(e=[this.uuid,"BLOB","FONT"]){try{if(!this.isInit)throw new Error("\u6570\u636E\u672A\u521D\u59CB\u5316\uFF0C\u65E0\u6CD5\u4FDD\u5B58");if(!this.consistencyManager)throw new Error("\u65E0\u6CD5\u652F\u6301\u4FDD\u5B58");let t=this.isProject?Dt.projectSave:Dt.personSave;if(!t)throw new Error("\u65E0\u6CD5\u652F\u6301\u4FDD\u5B58");let i=await this.dataBus.rpcCall(t,{uuid:this.uuid,path:this.path,docIds:e,uniqueId:this.uniqueId,client:this.consistencyManager.getClient()});return this.consoleDebug("save",i),i}catch(t){throw new Error(`${this._headType}+'Compiler' ${this.uuid} \u4FDD\u5B58\u5931\u8D25: ${(t==null?void 0:t.message)||t||""}`,{cause:t})}}async checkSave(){return await this.dataBus.rpcCall(Dt.hasSaveData,{uuid:this.uuid,uniqueId:this.uniqueId})}};var SG=(e=>(e.DIFFERENTIAL_PAIR="DIFFERENTIAL_PAIR",e.NET_CLASS="NET_CLASS",e.EQL_NET_GRP="EQL_NET_GRP",e))(SG||{});var vG=class extends sT{constructor(e){super(e)}onComponent(){}onComponentNum(){}onDelComponent(){}onPadNet(){}onDelPadNet(){}};var ete=cu(sd());var tte=cu(sd());var IG=class extends sT{constructor(e,t,i,r,n,s,a,o=(l=>(l=Qc())==null?void 0:l._TAB_ID_)()){let u=new vx(o);super(u),this.encode=s,this.base=new EG(e,t,i,o,r,u,n,n==="PCB"?bG:_G,a,(...c)=>this.setIsInit(...c),(...c)=>this.onDocDetail(...c),void 0,void 0,void 0,void 0,(c,h,m)=>this.onOrderNum(c,h,m),(c,h,m)=>{this.setMaxNum(c,h,!!m),m&&this.deleteOrderNum(m)})}get dataBus(){return this.base.dataBus}set dataBus(e){this.base.dataBus=e}async init(e=!0,t=!0,i=!0,r,n=!0,s){return this.setNeedNum(n),this.base.init(e,t,i,r,!0,n,s)}async sync(){return this.base.sync()}async destroy(){return this.base.destroy()}async save(){return this.base.save()}checkSave(){return this.base.checkSave()}publishSelected(e,t){this.base.publishSelected(e,t)}uploadBlob(e,t){let i=vf(t),r={filename:e,content:t};return{success:!0,ticket:this.localChange({id:i,data:JSON.stringify(r),dataType:"BLOB"},"BLOB","BLOB"),hash:i}}deleteBlob(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"BLOB"},"BLOB","BLOB")}}uploadFont(e){let{text:t,fontFamily:i,fontSize:r,thickness:n,bold:s,italic:a,reverse:o,expansion:l,width:u,height:c,path:h}=e,m={width:u,height:c,path:h},f=Hb(t,i,r,n,s,a,o,l);return{success:!0,ticket:this.localChange({id:f,data:JSON.stringify(m),dataType:"FONT"},"FONT","FONT")}}deleteFont(e){let{text:t,fontFamily:i,fontSize:r,thickness:n,bold:s,italic:a,reverse:o,expansion:l}=e,u=Hb(t,i,r,n,s,a,o,l);return{success:!0,ticket:this.localChange({id:u,data:"",dataType:"FONT"},"FONT","FONT")}}localChange(e,t=this.base.uuid,i){var n,s;let r=this.getOrderNum(e.id);return(s=(n=this.needOrderType)==null?void 0:n.includes)!=null&&s.call(n,e.dataType)&&r===void 0&&(r=this.getMaxNum(e.dataType),this.setOrderNum(e.id,r,e.dataType),this.onOrderNum(e.id,e.dataType,r)),this.base.localChange(e.id,e.data,e.dataType,t,i,r)}uploadString(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeString(e,t))}}deleteString(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"STRING"})}}uploadAttr(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeAttr(e,t))}}deleteAttr(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"ATTR"})}}uploadPanelize(e){return{success:!0,ticket:this.localChange(this.encode.encodePanelize(e))}}deletePanelize(){return{success:!0,ticket:this.localChange({id:"PANELIZE",data:"",dataType:"PANELIZE"})}}uploadRuleSelector(e){return{success:!0,ticket:this.localChange(this.encode.encodeRuleSelector(e))}}deleteRuleSelector(e){return{success:!0,ticket:this.localChange({id:JSON.stringify(["RULE_SELECTOR",e]),data:"",dataType:"RULE_SELECTOR"})}}uploadRule(e){return{success:!0,ticket:this.localChange(this.encode.encodeRule(e))}}deleteRule(e,t){return{success:!0,ticket:this.localChange({id:JSON.stringify(["RULE",e,t]),data:"",dataType:"RULE"})}}uploadRuleTemplate(e){return{success:!0,ticket:this.localChange(this.encode.encodeRuleTemplate(e))}}uploadDimension(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeDimension(e,t))}}deleteDimension(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"DIMENSION"})}}uploadBoss(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeBoss(e,t))}}deleteBoss(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"BOSS"})}}uploadShellEntity(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeShellEntity(e,t))}}deleteShellEntity(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"SHELL_ENTITY"})}}uploadShellCut(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeShellCut(e,t))}}deleteShellCut(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"SHELLCUT"})}}uploadCrease(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeCrease(e,t))}}deleteCrease(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"CREASE"})}}uploadShell(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeShell(e,t))}}deleteShell(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"SHELL"})}}uploadFpcFill(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeFpcFill(e,t))}}deleteFpcFill(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"FPC_FILL"})}}uploadTeardrop(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeTeardrop(e,t))}}deleteTeardrop(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"TEARDROP"})}}uploadImage(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeImage(e,t))}}deleteImage(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"IMAGE"})}}uploadPoured(e,t){return{success:!0,ticket:this.localChange(this.encode.encodePoured(e,t))}}deletePoured(e){return{success:!0,ticket:this.localChange({id:Mr(e,"POURED"),data:"",dataType:"POURED"})}}uploadPour(e,t){return{success:!0,ticket:this.localChange(this.encode.encodePour(e,t))}}deletePour(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"POUR"})}}uploadRegion(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeRegion(e,t))}}deleteRegion(e){let t=this.localChange({id:e,data:"",dataType:"REGION"});return this.onDelRegion(e,this.consistencyManager.getClient(),t,!0),{success:!0,ticket:t}}uploadFill(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeFill(e,t))}}deleteFill(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"FILL"})}}uploadLayerFill(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeLayerFill(e,t))}}deleteLayerFill(e){return{success:!0,ticket:this.localChange({id:Mr(e,"LAYER_FILL"),data:"",dataType:"LAYER_FILL"})}}uploadPoly(e,t){return{success:!0,ticket:this.localChange(this.encode.encodePoly(e,t))}}deletePoly(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"POLY"})}}uploadEQLenGrp(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeEQLenGrp(e,t))}}deleteEQLenGrp(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"EQLEN_GRP"})}}uploadObj(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeObj(e,t))}}deleteObj(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"OBJ"})}}uploadArc(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeArc(e,t))}}deleteArc(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"ARC"})}}uploadLine(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeLine(e,t))}}deleteLine(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"LINE"})}}uploadPad(e,t){return{success:!0,ticket:this.localChange(this.encode.encodePad(e,t))}}deletePad(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"PAD"})}}uploadVia(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeVia(e,t))}}deleteVia(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"VIA"})}}uploadPreference(e){return{success:!0,ticket:this.localChange(this.encode.encodePreference(e))}}uploadSilkOpts(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeSilkOpts(e,t))}}deleteSilkOpts(e){return{success:!0,ticket:this.localChange({id:Mr(e,"SILK_OPTS"),data:"",dataType:"SILK_OPTS"})}}uploadGroup(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeGroup(e,t))}}deleteGroup(e){return{success:!0,ticket:this.localChange({id:e,data:"",dataType:"GROUP"})}}uploadPrimitive(e,t){return{success:!0,ticket:this.localChange(this.encode.encodePrimitive(e,t))}}deletePrimitive(e){return{success:!0,ticket:this.localChange({id:Mr(e,"PRIMITIVE"),data:"",dataType:"PRIMITIVE"})}}uploadNet(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeNet(e,t))}}deleteNet(e){return{success:!0,ticket:this.localChange({id:Mr(e,"NET"),data:"",dataType:"NET"})}}uploadActiveLayer(e){return{success:!0,ticket:this.localChange(this.encode.encodeActiveLayer(e))}}uploadLayerPhys(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeLayerPhys(e,t))}}deleteLayerPhys(e){return{success:!0,ticket:this.localChange({id:Mr(e,"LAYER_PHYS"),data:"",dataType:"LAYER_PHYS"})}}uploadLayer(e,t){return{success:!0,ticket:this.localChange(this.encode.encodeLayer(e,t))}}deleteLayer(e){return{success:!0,ticket:this.localChange({id:Mr(e,"LAYER"),data:"",dataType:"LAYER"})}}uploadCanvas(e){return{success:!0,ticket:this.localChange(this.encode.encodeCanvas(e))}}};var aT=class extends IG{constructor(e,t,i,r,n=(s=>(s=Qc())==null?void 0:s._TAB_ID_)()){super(e,t,i,r,"FOOTPRINT",new nT,{getSelect:()=>{var a;return(a=this.canvasSelected)==null?void 0:a.call(this)},onSelect:(...a)=>{var o;return(o=this.onSelectChange)==null?void 0:o.call(this,a[0],a[1],a[2])},onQuit:(...a)=>{var o;return(o=this.onSelectQuit)==null?void 0:o.call(this,a[0],a[1])}},n),this.uuid=e,this.path=t,this.isProject=i,this.windowId=n}onComponent(){}onComponentNum(){}onDelComponent(){}onPadNet(){}onDelPadNet(){}};var AG=class extends vG{constructor(){super(...arguments),this.data={}}onLayerFill(e,t,i,r,n){}onDelLayerFill(e,t,i,r){}onBlob(e,t,i,r,n){}onDelBlob(e,t,i,r){}onFont(e,t,i,r){}onDelFont(e,t,i,r){}onString(e,t,i,r,n,s){this.data[e]=n}onDelString(e,t,i,r){delete this.data[e]}onStringNum(e,t){}onAttr(e,t,i,r,n,s){this.data[e]=n}onDelAttr(e,t,i,r){delete this.data[e]}onAttrNum(e,t){}onPanelizeSide(e,t,i,r){}onDelPanelizeSide(e,t,i,r){}onPanelizeStamp(e,t,i,r){}onDelPanelizeStamp(e,t,i,r){}onPanelize(e,t,i,r){}onDelPanelize(e,t,i){}onRuleSelector(e,t,i,r){}onDelRuleSelector(e,t,i,r){}onRule(e,t,i,r){}onDelRule(e,t,i,r,n){}onRuleTemplate(e,t,i,r){}onDimension(e,t,i,r,n,s){this.data[e]=n}onDelDimension(e,t,i,r){delete this.data[e]}onDimensionNum(e,t){}onBoss(e,t,i,r,n,s){this.data[e]=n}onDelBoss(e,t,i,r){delete this.data[e]}onBossNum(e,t){}onShellEntity(e,t,i,r,n,s){this.data[e]=n}onDelShellEntity(e,t,i,r){}onShellEntityNum(e,t){}onShellCut(e,t,i,r,n,s){this.data[e]=n}onDelShellCut(e,t,i,r){delete this.data[e]}onShellCutNum(e,t){}onCrease(e,t,i,r,n,s){this.data[e]=n}onDelCrease(e,t,i,r){delete this.data[e]}onCreaseNum(e,t){}onShell(e,t,i,r,n,s){this.data[e]=n}onDelShell(e,t,i,r){delete this.data[e]}onShellNum(e,t){}onFpcFill(e,t,i,r,n,s){this.data[e]=n}onDelFpcFill(e,t,i,r){delete this.data[e]}onFpcFillNum(e,t){}onTeardrop(e,t,i,r,n,s){this.data[e]=n}onDelTeardrop(e,t,i,r){delete this.data[e]}onTeardropNum(e,t){}onImage(e,t,i,r,n,s){this.data[e]=n}onDelImage(e,t,i,r){delete this.data[e]}onImageNum(e,t){}onPoured(e,t,i,r,n,s){this.data[e]=n}onDelPoured(e,t,i,r){delete this.data[e]}onPouredNum(e,t){}onPour(e,t,i,r,n,s){this.data[e]=n}onDelPour(e,t,i,r){delete this.data[e]}onPourNum(e,t){}onRegion(e,t,i,r,n,s){this.data[e]=n}onDelRegion(e,t,i,r){delete this.data[e]}onRegionNum(e,t){}onFill(e,t,i,r,n,s){this.data[e]=n}onDelFill(e,t,i,r){delete this.data[e]}onFillNum(e,t){}onPoly(e,t,i,r,n,s){this.data[e]=n}onDelPoly(e,t,i,r){delete this.data[e]}onPolyNum(e,t){}onEQLenGrp(e,t,i,r,n){this.data[e]=r}onDelEQLenGrp(e,t,i,r){delete this.data[e]}onDelProp(e,t,i,r){delete this.data[e]}onObj(e,t,i,r,n,s){this.data[e]=n}onDelObj(e,t,i,r){delete this.data[e]}onObjNum(e,t){}onArc(e,t,i,r,n,s){this.data[e]=n}onDelArc(e,t,i,r){delete this.data[e]}onArcNum(e,t){}onCArc(e,t,i,r,n,s){this.data[e]=n}onDelCArc(e,t,i,r){delete this.data[e]}onCArcNum(e,t){}onLine(e,t,i,r,n,s){this.data[e]=n}onDelLine(e,t,i,r){delete this.data[e]}onLineNum(e,t){}onPad(e,t,i,r,n,s){this.data[e]=n}onDelPad(e,t,i,r){delete this.data[e]}onPadNum(e,t){}onVia(e,t,i,r,n,s){this.data[e]=n}onDelVia(e,t,i,r){delete this.data[e]}onViaNum(e,t){}onDelConnect(e,t,i,r){}onPreference(e,t,i,r){}onSilkOpts(e,t,i,r,n){this.data[e]=r}onDelSilkOpts(e,t,i,r){delete this.data[e]}onGroup(e,t,i,r,n){this.data[e]=r}onDelGroup(e,t,i,r){delete this.data[e]}onPrimitive(e,t,i,r,n){}onDelPrimitive(e,t,i,r){}onNet(e,t,i,r,n){}onDelNet(e,t,i,r){}onPartition(e,t,i,r,n,s){this.data[e]=n}onDelPartition(e,t,i,r){delete this.data[e]}onPartitionNum(e,t){}onEditorMeta(e,t,i,r){}onDocDetail(e,t,i,r){}onActiveLayer(e,t,i,r){}onLayerPhys(e,t,i,r,n){this.data[e]=r}onDelLayerPhys(e,t,i,r){delete this.data[e]}onLayer(e,t,i,r,n){this.data[e]=r}onDelLayer(e,t,i,r){}onCanvas(e,t,i,r){}},CG=class extends aT{onLayerFill(e,t,i,r,n){}onDelLayerFill(e,t,i,r){}constructor(e,t,i,r){super(e,t,i,new h0,r)}canvasSelected(){return""}onSelectChange(e,t,i){}onSelectQuit(e,t){}async getByDataType(e){let t="";if(this.isProject?(this.dataBus=this.dataBus||nu(`/${this.windowId}/project/${this.path}`),t=await this.dataBus.rpcCall("/mgr/projectWorker/getDataByType",{doc:this.uuid,dataType:e})):(this.dataBus=this.dataBus||nu(`/${this.windowId}/libWorker`),t=await this.dataBus.rpcCall("/mgr/libWorker/getDataByType",{uuid:this.uuid,path:this.path,dataType:e,docType:"FOOTPRINT"})),!t)return{};let i=new AG;return i.consistencyManager.parseFull(t,this.uuid,"FOOTPRINT"),i.data}async getPads(){return this.getByDataType("PAD")}onBlob(e,t,i,r,n){}onDelBlob(e,t,i,r){}onFont(e,t,i,r){}onDelFont(e,t,i,r){}onString(e,t,i,r,n,s){}onDelString(e,t,i,r){}onStringNum(e,t){}onAttr(e,t,i,r,n,s){}onDelAttr(e,t,i,r){}onAttrNum(e,t){}onPanelizeSide(e,t,i,r){}onDelPanelizeSide(e,t,i,r){}onPanelizeStamp(e,t,i,r){}onDelPanelizeStamp(e,t,i,r){}onPanelize(e,t,i,r){}onDelPanelize(e,t,i){}onRuleSelector(e,t,i,r){}onDelRuleSelector(e,t,i,r){}onRule(e,t,i,r){}onDelRule(e,t,i,r,n){}onRuleTemplate(e,t,i,r){}onDimension(e,t,i,r,n,s){}onDelDimension(e,t,i,r){}onDimensionNum(e,t){}onBoss(e,t,i,r,n,s){}onDelBoss(e,t,i,r){}onBossNum(e,t){}onShellEntity(e,t,i,r,n,s){}onDelShellEntity(e,t,i,r){}onShellEntityNum(e,t){}onShellCut(e,t,i,r,n,s){}onDelShellCut(e,t,i,r){}onShellCutNum(e,t){}onCrease(e,t,i,r,n,s){}onDelCrease(e,t,i,r){}onCreaseNum(e,t){}onShell(e,t,i,r,n,s){}onDelShell(e,t,i,r){}onShellNum(e,t){}onFpcFill(e,t,i,r,n,s){}onDelFpcFill(e,t,i,r){}onFpcFillNum(e,t){}onTeardrop(e,t,i,r,n,s){}onDelTeardrop(e,t,i,r){}onTeardropNum(e,t){}onImage(e,t,i,r,n,s){}onDelImage(e,t,i,r){}onImageNum(e,t){}onPoured(e,t,i,r,n,s){}onDelPoured(e,t,i,r){}onPouredNum(e,t){}onPour(e,t,i,r,n,s){}onDelPour(e,t,i,r){}onPourNum(e,t){}onRegion(e,t,i,r,n,s){}onDelRegion(e,t,i,r){}onRegionNum(e,t){}onFill(e,t,i,r,n,s){}onDelFill(e,t,i,r){}onFillNum(e,t){}onPoly(e,t,i,r,n,s){}onDelPoly(e,t,i,r){}onPolyNum(e,t){}onEQLenGrp(e,t,i,r,n){}onDelEQLenGrp(e,t,i,r){}onDelProp(e,t,i,r){}onObj(e,t,i,r,n,s){}onDelObj(e,t,i,r){}onObjNum(e,t){}onArc(e,t,i,r,n,s){}onDelArc(e,t,i,r){}onArcNum(e,t){}onCArc(e,t,i,r,n,s){}onDelCArc(e,t,i,r){}onCArcNum(e,t){}onLine(e,t,i,r,n,s){}onDelLine(e,t,i,r){}onLineNum(e,t){}onPad(e,t,i,r,n,s){}onDelPad(e,t,i,r){}onPadNum(e,t){}onVia(e,t,i,r,n,s){}onDelVia(e,t,i,r){}onViaNum(e,t){}onDelConnect(e,t,i,r){}onPreference(e,t,i,r){}onSilkOpts(e,t,i,r,n){}onDelSilkOpts(e,t,i,r){}onGroup(e,t,i,r,n){}onDelGroup(e,t,i,r){}onPrimitive(e,t,i,r,n){}onDelPrimitive(e,t,i,r){}onNet(e,t,i,r,n){}onDelNet(e,t,i,r){}onPartition(e,t,i,r,n,s){}onDelPartition(e,t,i,r){}onPartitionNum(e,t){}onEditorMeta(e,t,i,r){}onDocDetail(e,t,i,r){}onActiveLayer(e,t,i,r){}onLayerPhys(e,t,i,r,n){}onDelLayerPhys(e,t,i,r){}onLayer(e,t,i,r,n){}onDelLayer(e,t,i,r){}onCanvas(e,t,i,r){}},oT=(e=>(e.LIST="/pro-mgr/api/project/list",e.CREATE="/pro-mgr/api/project/create",e.GET="/pro-mgr/api/project/get",e.UPDATE="/pro-mgr/api/project/update",e.DELETE="/pro-mgr/api/project/delete",e.TICKET="/pro-mgr/api/project/ticket",e.TICKET1="/pro-mgr/api/project/ticket1",e.BACKUP_LIST="/pro-mgr/api/project/backupList",e.BACKUP="/pro-mgr/api/project/backup",e.GET_BACKUP="/pro-mgr/api/project/getBackup",e.DELETE_BACKUP="/pro-mgr/api/project/deleteBackup",e.ARCHIVE="/pro-mgr/api/project/archive",e.CREATE_BOARD="/pro-mgr/api/project/createBoards",e.STAR="/pro-mgr/api/project/star",e.UNSTAR="/pro-mgr/api/project/unstar",e.GET_PROFILE="/pro-mgr/api/project/getProfile",e))(oT||{}),lT=(e=>(e.LIST="/pro-mgr/api/schematic/list",e.CREATE="/pro-mgr/api/schematic/create",e.UPLOAD="/pro-mgr/api/schematic/upload",e.DELETE="/pro-mgr/api/schematic/delete",e.UPDATE="/pro-mgr/api/schematic/update",e))(lT||{}),uT=(e=>(e.LIST="/pro-mgr/api/document/list",e.SEARCH_LIST="/pro-mgr/api/document/searchList",e.CREATE="/pro-mgr/api/document/create",e.UPLOAD="/pro-mgr/api/document/upload",e.UPDATE="/pro-mgr/api/document/update",e.BATCH_UPDATE="/pro-mgr/api/document/batchUpdate",e.DELETE="/pro-mgr/api/document/delete",e.GET="/pro-mgr/api/document/get",e.GET_BY_SID="/pro-mgr/api/document/getBySid",e.MOVE="/pro-mgr/api/document/move",e.CHECK_IN="/pro-mgr/api/document/checkIn",e.CHECK_OUT="/pro-mgr/api/document/checkOut",e.GET_CHECK="/pro-mgr/api/document/getCheck",e.DELETE_PCB_RELATED="/pro-mgr/api/document/deletePcbRelated",e))(uT||{}),cT=(e=>(e.LIST="/pro-mgr/api/device/list",e.SEARCH_LIST="/pro-mgr/api/device/searchList",e.CREATE="/pro-mgr/api/device/create",e.UPLOAD="/pro-mgr/api/device/upload",e.UPDATE="/pro-mgr/api/device/update",e.BATCH_UPDATE="/pro-mgr/api/device/batchUpdate",e.GET="/pro-mgr/api/device/get",e.SEARCH_BY_USERS_AND_TITLES="/pro-mgr/api/device/searchByUsersAndTitles",e.GET_ATTR_VALUES="/pro-mgr/api/device/getAttributeValues",e.GET_ATTR_KEYS="/pro-mgr/api/device/getAttrKeys",e.DELETE="/pro-mgr/api/device/delete",e.STAR="/pro-mgr/api/device/star",e.UNSTAR="/pro-mgr/api/device/unstar",e.PLACE="/pro-mgr/api/device/place",e))(cT||{}),dT=(e=>(e.LIST="/pro-mgr/api/component/list",e.SEARCH_LIST="/pro-mgr/api/component/searchList",e.CREATE="/pro-mgr/api/component/create",e.UPLOAD="/pro-mgr/api/component/upload",e.UPDATE="/pro-mgr/api/component/update",e.BATCH_UPDATE="/pro-mgr/api/component/batchUpdate",e.DELETE="/pro-mgr/api/component/delete",e.GET="/pro-mgr/api/component/get",e.SEARCH_BY_USERS_AND_TITLES="/pro-mgr/api/component/searchByUsersAndTitles",e.STAR="/pro-mgr/api/component/star",e.UNSTAR="/pro-mgr/api/component/unstar",e.GET_HISTORY="/pro-mgr/api/component/getHistory",e.SET_HISTORY="/pro-mgr/api/component/setHistory",e.GET_HISTORY_DATA="/pro-mgr/api/component/getHistoryData",e))(dT||{}),hT=(e=>(e.LIST="/pro-mgr/api/tag/list",e.CREATE="/pro-mgr/api/tag/create",e.UPDATE="/pro-mgr/api/tag/update",e.DELETE="/pro-mgr/api/tag/delete",e))(hT||{}),pT=(e=>(e.SEARCH_LIST="/pro-mgr/api/copper/searchList",e.SET="/pro-mgr/api/copper/set",e.DELETE="/pro-mgr/api/copper/delete",e))(pT||{}),fT=(e=>(e.SEARCH_LIST="/pro-mgr/api/font/searchList",e.SET="/pro-mgr/api/font/set",e.DELETE="/pro-mgr/api/font/delete",e))(fT||{}),mT=(e=>(e.SEARCH_LIST="/pro-mgr/api/blob/searchList",e.SET="/pro-mgr/api/blob/set",e))(mT||{}),gT=(e=>(e.LIST="/pro-mgr/api/attr/list",e.SEARCH_LIST="/pro-mgr/api/attr/searchList",e.CREATE="/pro-mgr/api/attr/create",e.UPLOAD="/pro-mgr/api/attr/upload",e.DELETE="/pro-mgr/api/attr/delete",e.TICKET="/pro-mgr/api/attr/ticket",e))(gT||{}),yT=(e=>(e.GET_BACKUP="/pro-mgr/api/client/getBackup",e.GET_LIBS="/pro-mgr/api/client/getLibs",e.CREATE_LIB="/pro-mgr/api/client/createLib",e.CREATE_PROJECT="/pro-mgr/api/client/createProject",e.OPEN_PROJECT="/pro-mgr/api/client/openProject",e.CLOSE_PROJECT="/pro-mgr/api/client/closeProject",e.GET_PROJECT_PATHS="/pro-mgr/api/client/getProjectPaths",e.SELECT_PATH="/pro-mgr/api/client/selectPath",e.OPEN_DIALOG="/pro-mgr/api/client/openDialog",e.SELECT_DIR="/pro-mgr/api/client/selectDir",e.SELECT_FILE="/pro-mgr/api/client/selectFile",e.EXPORT_FILE="/pro-mgr/api/client/exportFile",e.CACHE_LIST="/pro-mgr/api/client/cacheList",e.GET_CACHE="/pro-mgr/api/client/getCache",e.SET_CACHE="/pro-mgr/api/client/setCache",e.DELETE_CACHE="/pro-mgr/api/client/deleteCache",e.PROJECT_HISTORY="/pro-mgr/api/client/projectHistory",e.DELETE_HISTORY="/pro-mgr/api/client/deletHistory",e.SET_KV_CACHE="/pro-mgr/api/client/setKVCache",e.GET_KV_CACHE="/pro-mgr/api/client/getKVCache",e.IS_EXIST_KV_CACHE="/pro-mgr/api/client/isExistKVCache",e.OPEN_URL="/pro-mgr/api/client/openURL",e))(yT||{}),_T=(e=>(e.LOG="/pro-mgr/api/other/log",e.TEAMS="/pro-mgr/api/other/teams",e.GET_EDITOR_VERSION="/pro-mgr/api/other/getEditorVersion",e.SET_EDITOR_VERSION="/pro-mgr/api/other/setEditorVersion",e))(_T||{}),ua={PROJECT:oT,SCHEMATIC:lT,DOCUMENT:uT,DEVICE:cT,COMPONENT:dT,TAG:hT,COPPER:pT,FONT:fT,BLOB:mT,ATTR:gT,CLIENT:yT,OTHER:_T},xG=(e=>(e.GET_DATA_STR="/pro-mgr/public/getDataStr",e))(xG||{}),Bp=rd(nd()),Gc={bus:void 0,get messageBus(){if(Gc.bus===void 0)if(typeof window<"u"){let e=An();e._MSG_BUS_=e._MSG_BUS_||new Bp.MessageBus,Gc.bus=e._MSG_BUS_}else self._WORKER_BUS_=self._WORKER_BUS_||new Bp.WorkerMessageBridge(new Bp.MessageBus,self),Gc.bus=self._WORKER_BUS_;return Gc.bus},get messageBus2(){return self._MSG_BUS2_=self._MSG_BUS2_||new Bp.MessageBus2},loginedUserUuid:void 0},Re=Gc,TG=["S","F","P","3D"],wG=["F","3D"],RG=(e=>(e.ZIP=".zip",e.PRJ=".epro",e.PRJ2=".epro2",e.EPRU=".epru",e.SCH=".esch",e.PCB=".epcb",e.PANEL=".epan",e.PANEL_LIB=".epanl",e.SYMBOL=".esym",e.FOOTPRINT=".efoo",e.INSTANCE=".eins",e.COPPER=".ecop",e.BLOB=".eblob",e.FONT=".efon",e.ELIBZ=".elibz",e.ELIBZ2=".elibz2",e.ELIBU=".elibu",e.IMAGE=".webp",e))(RG||{}),du="|",LG=/^[^|]+(\|[^|]+)?$/,NG=(e=>(e.Board="Board",e.Schematic="Schematic",e.Sheet="Sheet",e.Pcb="Pcb",e.Panel="Panel",e.SchCanvas="SchCanvas",e.PcbCanvas="PcbCanvas",e.PanelCanvas="PanelCanvas",e))(NG||{}),DG=(e=>(e.Device="Device",e.Symbol="Symbol",e.Footprint="Footprint",e))(DG||{}),QC=[{value:"",text:"All"},{value:2,text:"Component"},{value:20,text:{content:"symbolType",value:"Drawing",options:null}},{value:18,text:"Net Flag"},{value:19,text:"Net Port"},{value:25,text:"Off Page Connector"},{value:31,text:"Differential Pairs Flag"},{value:21,text:{content:"symbolType",value:"Non-Electronic Flag",options:null}},{value:22,text:"Short Flag"}],ex=[{value:"",text:"All"},{value:2,text:"Component Symbol"},{value:20,text:"Drawing Symbol"},{value:18,text:"Netflag Symbol"},{value:19,text:"Netport Symbol"},{value:25,text:"Off Page Connector Symbol"},{value:31,text:"Differential Pairs Flag Symbol"},{value:21,text:"Non-Electronic Symbol"},{value:22,text:"Short Flag"}],BG=["S"],OG=["S"],MG=["S"],kG=["3D"],FG={footprint:wG,device:TG,symbol:BG,model3D:kG,panelLib:OG,cbb:MG,modelSimLib:[]};async function UG(e){let t=new TextEncoder().encode(e),i=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(i)).map(r=>r.toString(16).padStart(2,"0")).join("")}var bT=[2,20,18,19,21,22,17,25,31];function uf(e){return e&&bT.indexOf(e)>=0}function PT(e){return bT.indexOf(e)>=0&&e!==17}function HG(e){return e===""?!1:!!(e&&LG.test(e))}var jG=async e=>{let{keys:t,values:i}=ET(e);return await UG([...t,...i].sort().join(""))},ET=e=>{let t=new Set,i=new Set;for(let r in e){let n=e[r];if(t.add(r),Array.isArray(n))i.add(JSON.stringify(n.sort()));else if(Object.prototype.toString.call(n)==="[object Object]"){let{keys:s,values:a}=ET(n);t=new Set([...t,...s]),i=new Set([...i,...a])}else i.add(JSON.stringify(n))}return{keys:t,values:i}};function tx(e){let{uuid:t,path:i}=e;return t?t+(i?`${du}${i}`:""):void 0}function YG(e){let{source:t,path:i}=e;return t+(i?`${du}${i}`:"")}async function Sb(e,t){if(t)return t;let{updateTime:i}=e;return i?String(i):await jG(e)}async function GG(e){let{data:t,force:i=!0,defalut:r}=e,{source:n,version:s}=t;n?(HG(n)||(t.source=tx(t)),n.includes(du)||(t.source=YG(t)),s?s==="1"&&(t.version=await Sb(t)):t.version=await Sb(t,r)):i&&(t.source=tx(t),t.version=await Sb(t,r))}function ST(){let e=navigator.userLanguage;return e&&e.includes("zh")?"zh-cn":"en"}function vb(e){let{tags:t,custom_tags:i="[]"}=e;if((!i||i==="[]")&&t){if(Array.isArray(t)&&t.length)i=JSON.stringify(t);else if(Object.prototype.toString.call(t)==="[object Object]"){let r=ST()==="en",n=[];if(t.parent_tag){let{name:s,name_cn:a}=t.parent_tag;if(r&&s?n.push(s):!r&&a?n.push(a):s&&n.push(s),t.child_tag){let{name:o,name_cn:l}=t.child_tag;r&&o?n.push(o):!r&&l?n.push(l):o&&n.push(o)}}i=JSON.stringify(n)}}return e.custom_tags=i,e.custom_tags}var vT=(e=>e)(vT||{}),IT=(e=>(e.GET="/PrjDB/project/getData",e.UPDATE="/PrjDB/project/updateData",e.COUNT_DOC="/PrjDB/project/countDoc",e.GET_HISTORY_NODE="/PrjDB/project/getHistoricalNodes",e.GET_HISTORY_PROJECT="/PrjDB/project/getHistoricalProject",e.GET_MAX_TICKET="/PrjDB/project/getMaxTicket",e.SAVE_PEND_DATA="/PrjDB/project/savePendData",e.REVOKE_PEND_DATA="/PrjDB/project/revokePendData",e.GET_CLIENT="/PrjDB/project/getClient",e.HISTORIES="/PrjDB/project/histories",e.COMPRESS="/PrjDB/project/compress",e.FLOW_WRITE="/PrjDB/project/flowWrite",e.GET_RELATED="/PrjDB/project/getRelated",e))(IT||{}),AT=(e=>(e.GET="/PrjDB/config/getData",e.UPDATE="/PrjDB/config/updateData",e))(AT||{}),CT=(e=>(e.GET="/PrjDB/board/getData",e.ADD="/PrjDB/board/addData",e.UPDATE="/PrjDB/board/updateData",e.DELETE="/PrjDB/board/deleteData",e.GET_ALL_KV="/PrjDB/board/getAllKVData",e.GET_ALL_ARR="/PrjDB/board/getAllArrData",e.TRY_RENAME="/PrjDB/board/tryRename",e.IS_RENAME="/PrjDB/board/isRename",e.BATCH_DELETE="/PrjDB/board/batchDelete",e.GET_BIND_KEYS="/PrjDB/board/getBindKeys",e))(CT||{}),xT=(e=>(e.GET="/PrjDB/schematic/getData",e.GET_BY_NAME="/PrjDB/schematic/getDataByName",e.TRY_RENAME="/PrjDB/schematic/tryRename",e.UPDATE_IN_LOCAL="/PrjDB/schematic/updateDataInLocal",e.ADD="/PrjDB/schematic/addData",e.UPDATE="/PrjDB/schematic/updateData",e.DEL="/PrjDB/schematic/delData",e.GET_ALL_KV="/PrjDB/schematic/getAllKVDatas",e.GET_UUID_BY_NAME="/PrjDB/schematic/getIdByName",e.GET_NAME_BY_UUID="/PrjDB/schematic/getNameById",e.GET_DISPLAY_NAME_BY_UUID="/PrjDB/schematic/getDisplayNameById",e.GET_ALL_ARR="/PrjDB/schematic/getAllArrDatas",e.GET_BY_SOURCE_VERSION="/PrjDB/schematic/getDataBySourceAndVersion",e.GET_LAST="/PrjDB/schematic/getLastData",e.GET_ALL_ARR_BY_SOURCE="/PrjDB/schematic/getAllArrDatasBySource",e.IS_RENAME="/PrjDB/schematic/isRename",e.BATCH_DELETE="/PrjDB/schematic/batchDelete",e))(xT||{}),TT=(e=>(e.ADD="/PrjDB/sheet/addData",e.DEL="/PrjDB/sheet/delData",e.UPDATE="/PrjDB/sheet/updateData",e.UPDATE_LOTS="/PrjDB/sheet/updateLotDatas",e.GET_ALL_KV="/PrjDB/sheet/getAllKVDatas",e.GET="/PrjDB/sheet/getData",e.GET_ALL_ARR="/PrjDB/sheet/getAllArrDatas",e.GET_LOTS_ARR="/PrjDB/sheet/getLotsArrDatas",e.GET_CANVAS="/PrjDB/sheet/getCanvas",e.SET_CANVAS="/PrjDB/sheet/setCanvas",e.COVER_CANVAS="/PrjDB/sheet/coverCanvas",e.WATCH_CANVAS_UPDATE="/PrjDB/sheet/watchCanvas",e.UNWATCH_CANVAS_UPDATE="/PrjDB/sheet/unwatchCanvas",e.GET_BY_SOURCE_VERSION="/PrjDB/sheet/getDataBySourceAndVersion",e.GET_LAST="/PrjDB/sheet/getLastData",e.GET_ALL_ARR_BY_SOURCE="/PrjDB/sheet/getAllArrDatasBySource",e.TRY_RENAME="/PrjDB/sheet/tryRename",e.IS_RENAME="/PrjDB/sheet/isRename",e.BATCH_DELETE="/PrjDB/sheet/batchDelete",e.GET_ALL_KEYS="/PrjDB/sheet/getAllPrimaryKeys",e))(TT||{}),wT=(e=>(e.ADD="/PrjDB/simulation/addData",e.DEL="/PrjDB/simulation/delData",e.UPDATE="/PrjDB/simulation/updateData",e.UPDATE_LOTS="/PrjDB/simulation/updateLotDatas",e.GET_ALL_KV="/PrjDB/simulation/getAllKVDatas",e.GET="/PrjDB/simulation/getData",e.GET_ALL_ARR="/PrjDB/simulation/getAllArrDatas",e.GET_LOTS_ARR="/PrjDB/simulation/getLotsArrDatas",e.GET_CANVAS="/PrjDB/simulation/getCanvas",e.SET_CANVAS="/PrjDB/simulation/setCanvas",e.COVER_CANVAS="/PrjDB/simulation/coverCanvas",e.WATCH_CANVAS_UPDATE="/PrjDB/simulation/watchCanvas",e.UNWATCH_CANVAS_UPDATE="/PrjDB/simulation/unwatchCanvas",e.GET_BY_SOURCE_VERSION="/PrjDB/simulation/getDataBySourceAndVersion",e.GET_LAST="/PrjDB/simulation/getLastData",e.GET_ALL_ARR_BY_SOURCE="/PrjDB/simulation/getAllArrDatasBySource",e.TRY_RENAME="/PrjDB/simulation/tryRename",e.IS_RENAME="/PrjDB/simulation/isRename",e.BATCH_DELETE="/PrjDB/simulation/batchDelete",e.GET_ALL_KEYS="/PrjDB/simulation/getAllPrimaryKeys",e))(wT||{}),RT=(e=>(e.GET="/PrjDB/pcb/getData",e.GET_BY_TITLE="/PrjDB/pcb/getDataByTitle",e.GET_UUID_BY_TITLE="/PrjDB/pcb/getIdByTitle",e.ADD="/PrjDB/pcb/addData",e.DEL="/PrjDB/pcb/delData",e.CREATE_SUB="/PrjDB/pcb/createSub",e.UPDATE_SUB="/PrjDB/pcb/updateSubInherit",e.UPDATE="/PrjDB/pcb/updateData",e.UPDATE_LOTS="/PrjDB/pcb/updateLotDatas",e.GET_ALL_KV="/PrjDB/pcb/getAllKVDatas",e.GET_ALL_ARR="/PrjDB/pcb/getAllArrDatas",e.GET_CANVAS="/PrjDB/pcb/getCanvas",e.SET_CANVAS="/PrjDB/pcb/setCanvas",e.COVER_CANVAS="/PrjDB/pcb/coverCanvas",e.WATCH_CANVAS_UPDATE="/PrjDB/pcb/watchCanvas",e.UNWATCH_CANVAS_UPDATE="/PrjDB/pcb/unwatchCanvas",e.GET_BY_SOURCE_VERSION="/PrjDB/pcb/getDataBySourceAndVersion",e.GET_LAST="/PrjDB/pcb/getLastData",e.GET_ALL_ARR_BY_SOURCE="/PrjDB/pcb/getAllArrDatasBySource",e.TRY_RENAME="/PrjDB/pcb/tryRename",e.IS_RENAME="/PrjDB/pcb/isRename",e.BATCH_DELETE="/PrjDB/pcb/batchDelete",e.GET_ALL_KEYS="/PrjDB/pcb/getAllPrimaryKeys",e))(RT||{}),LT=(e=>(e.GET="/PrjDB/panel/getData",e.ADD="/PrjDB/panel/addData",e.DEL="/PrjDB/panel/delData",e.UPDATE="/PrjDB/panel/updateData",e.UPDATE_LOTS="/PrjDB/panel/updateLotDatas",e.GET_ALL_KV="/PrjDB/panel/getAllKVDatas",e.GET_ALL_ARR="/PrjDB/panel/getAllArrDatas",e.GET_CANVAS="/PrjDB/panel/getCanvas",e.SET_CANVAS="/PrjDB/panel/setCanvas",e.COVER_CANVAS="/PrjDB/panel/coverCanvas",e.WATCH_CANVAS_UPDATE="/PrjDB/panel/watchCanvas",e.UNWATCH_CANVAS_UPDATE="/PrjDB/panel/unwatchCanvas",e.TRY_RENAME="/PrjDB/panel/tryRename",e.IS_RENAME="/PrjDB/panel/isRename",e.BATCH_DELETE="/PrjDB/panel/batchDelete",e.GET_ALL_KEYS="/PrjDB/panel/getAllPrimaryKeys",e))(LT||{}),NT=(e=>(e.GET_BY_TITLE="/PrjDB/symbol/getDataByTitle",e.GET="/PrjDB/symbol/getData",e.ADD="/PrjDB/symbol/addData",e.CLONE="/PrjDB/symbol/cloneData",e.DEL="/PrjDB/symbol/delData",e.UPDATE="/PrjDB/symbol/updateData",e.GET_UUID_BY_TITLE="/PrjDB/symbol/getIdByTitle",e.GET_DISPLAY_TITLE_BY_UUID="/PrjDB/symbol/getDisplayTitleById",e.GET_ALL_KV="/PrjDB/symbol/getAllKVDatas",e.GET_BY_SOURCE_VERSION="/PrjDB/symbol/getDataBySourceAndVersion",e.GET_COMPARE_TICKET="/PrjDB/symbol/getDataCompareTicket",e.GET_LAST="/PrjDB/symbol/getLastData",e.IS_EXIST="/PrjDB/symbol/isExist",e.GET_ALL_KEYS="/PrjDB/symbol/getAllPrimaryKeys",e.GET_ALL_ARR="/PrjDB/symbol/getAllArrDatas",e.GET_ALL_ARR_BY_SOURCE="/PrjDB/symbol/getAllArrDatasBySource",e.GET_KEYS_BY_SOURCE="/PrjDB/symbol/getKeysBySource",e.GET_ALL_ARR_BY_TYPE="/PrjDB/symbol/getTypeDatas",e.GET_STR="/PrjDB/symbol/getStr",e.GET_CANVAS="/PrjDB/symbol/getCanvas",e.SET_CANVAS="/PrjDB/symbol/setCanvas",e.COVER_CANVAS="/PrjDB/symbol/coverCanvas",e.WATCH_CANVAS_UPDATE="/PrjDB/symbol/watchCanvas",e.UNWATCH_CANVAS_UPDATE="/PrjDB/symbol/unwatchCanvas",e.TRY_RENAME="/PrjDB/symbol/tryRename",e.WITH_ORIGINS="/PrjDB/symbol/withOrigins",e.IS_RENAME="/PrjDB/symbol/isRename",e.IS_CHANGE="/PrjDB/symbol/isChange",e.BATCH_DELETE="/PrjDB/symbol/batchDelete",e.GET_LIST="/PrjDB/symbol/getList",e))(NT||{}),DT=(e=>(e.GET_BY_TITLE="/PrjDB/footprint/getDataByTitle",e.GET="/PrjDB/footprint/getData",e.IS_EXIST="/PrjDB/footprint/isExist",e.ADD="/PrjDB/footprint/addData",e.CLONE="/PrjDB/footprint/cloneData",e.DEL="/PrjDB/footprint/delData",e.GET_ALL_KV="/PrjDB/footprint/getAllKVDatas",e.UPDATE="/PrjDB/footprint/updateData",e.UPDATE_IN_LOCAL="/PrjDB/footprint/updateDataInLocal",e.GET_DISPLAY_TITLE_BY_UUID="/PrjDB/footprint/getDisplayTitleById",e.GET_BY_SOURCE_VERSION="/PrjDB/footprint/getDataBySourceAndVersion",e.GET_COMPARE_TICKET="/PrjDB/footprint/getDataCompareTicket",e.GET_LAST="/PrjDB/footprint/getLastData",e.GET_ALL_KEYS="/PrjDB/footprint/getAllPrimaryKeys",e.GET_ALL_ARR="/PrjDB/footprint/getAllArrDatas",e.GET_ALL_ARR_BY_SOURCE="/PrjDB/footprint/getAllArrDatasBySource",e.GET_KEYS_BY_SOURCE="/PrjDB/footprint/getKeysBySource",e.GET_ALL_ARR_BY_PCB_UUID="/PrjDB/footprint/getAllArrDatasByPcbId",e.GET_KEYS_BY_PCB_UUID="/PrjDB/footprint/getKeysByPcbId",e.GET_STR="/PrjDB/footprint/getStr",e.GET_CANVAS="/PrjDB/footprint/getCanvas",e.SET_CANVAS="/PrjDB/footprint/setCanvas",e.COVER_CANVAS="/PrjDB/footprint/coverCanvas",e.WATCH_CANVAS_UPDATE="/PrjDB/footprint/watchCanvas",e.UNWATCH_CANVAS_UPDATE="/PrjDB/footprint/unwatchCanvas",e.TRY_RENAME="/PrjDB/footprint/tryRename",e.WITH_ORIGINS="/PrjDB/footprint/withOrigins",e.IS_CHANGE="/PrjDB/footprint/isChange",e.IS_RENAME="/PrjDB/footprint/isRename",e.BATCH_DELETE="/PrjDB/footprint/batchDelete",e.GET_LIST="/PrjDB/footprint/getList",e))(DT||{}),BT=(e=>(e.GET="/PrjDB/device/getData",e.GET_BY_TITLE="/PrjDB/device/getDataByTitle",e.ADD="/PrjDB/device/addData",e.DEL="/PrjDB/device/delData",e.GET_ALL_KV="/PrjDB/device/getAllKVDatas",e.UPDATE="/PrjDB/device/updateData",e.GET_DISPLAY_TITLE_BY_UUID="/PrjDB/device/getDisplayTitleById",e.GET_SYMBOL_UUID="/PrjDB/device/getSymbolIdById",e.GET_BY_SOURCE_VERSION="/PrjDB/device/getDataBySourceAndVersion",e.GET_LAST="/PrjDB/device/getLastData",e.GET_ALL_ARR_BY_SOURCE="/PrjDB/device/getAllArrDatasBySource",e.GET_KEYS_BY_SOURCE="/PrjDB/device/getKeysBySource",e.GET_COMPARE_TICKET="/PrjDB/device/getDataCompareTicket",e.IS_EXIST="/PrjDB/device/isExist",e.GET_ALL_KEYS="/PrjDB/device/getAllPrimaryKeys",e.GET_ALL_ARR="/PrjDB/device/getAllArrDatas",e.GET_ALL_ARR_BY_SYMBOL_UUID="/PrjDB/device/getAllArrDatasBySymbolId",e.GET_ALL_ARR_BY_FOOTPRINT_UUID="/PrjDB/device/getAllArrDatasByfootprintId",e.TRY_RENAME="/PrjDB/device/tryRename",e.BIND_SYMBOL="/PrjDB/device/bindSymbol",e.BIND_fOOTPRINT="/PrjDB/device/bindFootprint",e.WITH_ORIGINS="/PrjDB/device/withOrigins",e.IS_CHANGE="/PrjDB/device/isChange",e.IS_RENAME="/PrjDB/device/isRename",e.PLACE="/PrjDB/device/place",e.BATCH_DELETE="/PrjDB/device/batchDelete",e.GET_LIST="/PrjDB/device/getList",e))(BT||{}),OT=(e=>(e.GET="/PrjDB/attr/getData",e.UPDATE="/PrjDB/attr/updateData",e.BATCH_UPDATE="/PrjDB/attr/batchUpdateData",e.ADD="/PrjDB/attr/addData",e.DEL="/PrjDB/attr/delData",e.GET_ALL_KV="/PrjDB/attr/getAllKVDatas",e.GET_ALL_ARR="/PrjDB/attr/getAllArrDatas",e.GET_ALL_ARR_BY_HASH="/PrjDB/attr/getAllArrDatasByHash",e.BATCH_DELETE="/PrjDB/attr/batchDelete",e))(OT||{}),MT=(e=>(e.GET="/PrjDB/blob/getData",e.ADD="/PrjDB/blob/addData",e.DEL="/PrjDB/blob/delData",e.GET_ALL_ARR="/PrjDB/blob/getAllArrDatas",e.BATCH_DELETE="/PrjDB/blob/batchDelete",e))(MT||{}),kT=(e=>(e.GET="/PrjDB/copper/getData",e.ADD="/PrjDB/copper/addData",e.DEL_LOTS="/PrjDB/copper/delLotDatas",e.DEL="/PrjDB/copper/delData",e.GET_ALL_KEYS="/PrjDB/copper/getAllPrimaryKeys",e.UPDATE="/PrjDB/copper/updateData",e.GET_ALL_ARR="/PrjDB/copper/getAllArrDatas",e.GET_ALL_ARR_BY_PCB_UUID="/PrjDB/copper/getAllArrDatasByPcbId",e.GET_ALL_KEYS_BY_PCB_UUID="/PrjDB/copper/getAllArrKeysByPcbId",e))(kT||{}),FT=(e=>(e.GET="/PrjDB/font/getData",e.ADD="/PrjDB/font/addData",e.DEL_LOTS="/PrjDB/font/delLotDatas",e.DEL="/PrjDB/font/delData",e.GET_ALL_KEYS="/PrjDB/font/getAllPrimaryKeys",e.UPDATE="/PrjDB/font/updateData",e.GET_ALL_ARR="/PrjDB/font/getAllArrDatas",e.GET_ALL_ARR_BY_PCB_UUID="/PrjDB/font/getAllArrDatasByPcbId",e.GET_ALL_KEYS_BY_PCB_UUID="/PrjDB/font/getAllArrKeysByPcbId",e))(FT||{}),UT=(e=>(e.BATCH_ADD="/PrjDB/variant/batchAddVariant",e.ADD="/PrjDB/variant/addData",e.DELETE="/PrjDB/variant/deleteData",e.BATCH_DELETE="/PrjDB/variant/batchDeleteData",e.BATCH_RESTORE="/PrjDB/variant/batchRestoreData",e.GET="/PrjDB/variant/getData",e.GET_ALL_ARR_BY_SID="/PrjDB/variant/getAllArrDatasBySid",e.UPDATE_TITLE="/PrjDB/variant/updateTitle",e.UPDATE_NOT_GROUPED="/PrjDB/variant/updateNotGrouped",e.BATCH_UPDATE_SORT="/PrjDB/variant/batchUpdateZIndex",e))(UT||{}),HT=(e=>(e.BATCH_ADD="/PrjDB/componentGroup/batchAddData",e.ADD="/PrjDB/componentGroup/addData",e.DELETE="/PrjDB/componentGroup/deleteData",e.BATCH_DELETE="/PrjDB/componentGroup/batchDeleteData",e.BATCH_RESTORE="/PrjDB/componentGroup/batchRestoreData",e.GET="/PrjDB/componentGroup/getData",e.GET_ALL_ARR_BY_SID="/PrjDB/componentGroup/getAllArrDatasBySid",e.GET_ATTR_DATA="/PrjDB/componentGroup/getComponentGroupData",e.UPDATE_TITLE="/PrjDB/componentGroup/updateTitle",e.BATCH_UPDATE_SORT="/PrjDB/componentGroup/batchUpdateZIndex",e.BATCH_UPLOAD_VARIANT_INDEX="/PrjDB/componentGroup/batchUploadGroupSortInVariant",e.BATCH_DELETE_VARIANT_INDEX="/PrjDB/componentGroup/batchDeleteGroupSortInVariant",e.UPLOAD_ATTR_DATA="/PrjDB/componentGroup/uploadComponentGroupData",e.BATCH_DELETE_ATTR_DATA="/PrjDB/componentGroup/batchDeleteComponentGroupData",e))(HT||{}),Qe={VARIANT:UT,COMPONENT_GROUP:HT,COMMON:vT,PROJECT:IT,CONFIG:AT,BOARD:CT,SCHEMATIC:xT,SHEET:TT,SIMULATION:wT,PCB:RT,PANEL:LT,SYMBOL:NT,FOOTPRINT:DT,DEVICE:BT,ATTR:OT,BLOB:MT,COPPER:kT,FONT:FT},WG=rd(nd());function hu(e){return!e.data}function zG(e){return!!(e.path&&e.uuid&&e.docType&&e.isProject!==void 0&&Object.keys(e).length===4)}async function As(e){let{origin:t,target:i}=e,r=await px.getProLibSource(t);if(r.success===!1)return{success:!1,code:r.code,message:r.message};let n=r.result;if(i.isProject)if(i.docType===4){let s=[i.uuid,n,i.version,i.path];return{success:!!(await Re.messageBus.rpcCall(Qe.FOOTPRINT.COVER_CANVAS,s)).message}}else if(uf(i.docType)){let s=[i.uuid,n,i.version,i.path];return{success:!!(await Re.messageBus.rpcCall(Qe.SYMBOL.COVER_CANVAS,s)).message}}else throw new Error("Api call error!");else{let s=await px.getProLibSource(i);if(s.success===!1)return{success:!1,code:s.code,message:s.message};let a=s.result,o=cr(),l;if(i.docType===4)l=Eb(a,n,{docType:zc.FOOTPRINT,uuid:i.uuid,client:o});else if(i.docType===29)l=Eb(a,n,{docType:zc.PANEL_LIB,uuid:i.uuid,client:o});else if(uf(i.docType))l=Eb(a,n,{docType:zc.SYMBOL,uuid:i.uuid,client:o});else throw new Error("Api call error!");let u={uuid:i.uuid,dataStr:l},{message:c}=await Re.messageBus.rpcCall(ua.COMPONENT.SET_HISTORY,u);return c.success===!1?{success:!1,code:c.code,message:c.message}:{success:!0}}}function VG(e){return self[e]=self[e]||new WG.BroadcastChannelMessageBus(e)}var qG=(e=>(e.OPEN="/pro-mgr/project/open",e.CLOSE="/pro-mgr/project/close",e.TEMP_OPEN="/pro-mgr/project/tempOpen",e.TEMP_OPEN_BY_STRING="/pro-mgr/project/tempOpenByString",e.TEMP_CLOSE="/pro-mgr/project/tempClose",e.ON_OPENED="/pro-mgr/project/onOpened",e.ON_TEMP_OPENED="/pro-mgr/project/onTempOpened",e.BEFORE_CLOSE="/pro-mgr/project/beforeClose",e.ON_CLOSED="/pro-mgr/project/onClosed",e.ON_TEMP_CLOSED="/pro-mgr/project/onTempClosed",e.ON_FAILED="/pro-mgr/project/onFailed",e.GET_RECENT_PROJECT_LIST="/pro-mgr/getRecentPrjList",e.UPDATE_PROJECT="/pro-mgr/updateProject",e.DEL_PROJECT="/pro-mgr/deleteProject",e.HAS="/pro-mgr/hasProject",e))(qG||{}),XG=(e=>(e.SYSTEM="system",e.INTERNAL="Internal",e.PERSONAL="personal",e.PROJECT="project",e.STAR="star",e.TEAMS="teams",e.USER="user",e.CLIENT="client",e.PUBLIC="public",e.OSHWHUB="oshwhub",e.STD_PUBLIC="stdPublic",e.EXTEND="extend",e))(XG||{}),JG=(e=>(e.DEVICE="device",e.SYMBOL="symbol",e.FOOTPRINT="footprint",e.CBB="cbb",e.MODEL3D="model3D",e.PANEL_LIB="panelLib",e.MODEL_SIM_LIB="modelSimLib",e))(JG||{}),p0={D3Model:{client3DModelList:"api/client/steps"}},Ke,Ge=(Ke=class{},Ke.CANVAS_UNIT_MM="mm",Ke.CANVAS_UNIT_MIL="mil",Ke.HEX_BLACK_COLOR="#000000",Ke.HEX_WHITE_COLOR="#FFFFFF",Ke.HEX_RED_COLOR="#FF0000",Ke.HEX_GREEN_COLOR="#00FF00",Ke.HEX_BLUE_COLOR="#0000FF",Ke.HEX_GRAY_COLOR1="#F1F1F1",Ke.HEX_GRAY_COLOR2="#EFEFEF",Ke.HEX_GRAY_COLOR3="#999999",Ke.HEX_GRAY_COLOR4="#666666",Ke.HEX_GRAY_COLOR5="#333333",Ke.HEX_GRAY_COLOR6="#CCCCCC",Ke.DEFAULT_PAGESIZE=50,Ke.SYMBOLTYPE_ITEM_ALL_VALUE="@all",Ke.SYMBOLTYPE_ITEM_ALL_TITLE="All",Ke.D3MVIEW_DEFAULT_TRANSFORM="0, 0, 0, 0, 0, 0, 0, 0, 0",Ke.DEVICE_INDEX_TAG="$_",Ke.DEVICE_SPLIT_TAG="@_",Ke.LIB_SPLIT_TAG="#_",Ke.CATEGORY_ITEM_ALL_VALUE="@all",Ke.CATEGORY_ITEM_ALL_TITLE="All",Ke.FAVORITELIB_UUID="star",Ke.SYSTEMLIB_UUID="0819f05c4eef4c71ace90d822a990e87",Ke.SYSTEMLIB_UUID_ALIAS="lcsc",Ke.USERLIB_ALIAS="mine",Ke.PUBLICLIB_ALIAS="user",Ke.STD_PUBLIC_LIB_ALIAS="stdPublic",Ke.INTERNAL_LIB_ALIAS="Internal",Ke.PERSIONAL_WORKSPACE="Personal",Ke.EDU_WORKSPACE="6d84b27f18f540b6a31c4d657314ab13",Ke.EDA_TEST_WORKSPACE="407ec92f2a2f4275bf08cbebf64f5e08",Ke.LIB_SYSTEM_KEY="system",Ke.LIB_PROJECT_KEY="project",Ke.LIB_PERSONAL_KEY="personal",Ke.LIB_PUBLIC_KEY="public",Ke.LIB_STD_PUBLIC_KEY="stdPublic",Ke.LIB_INTERNAL_KEY="Internal",Ke.LIB_FAVORITE_KEY="favorite",Ke.LIB_TEMAS_KEY="teams",Ke.API=p0,Ke.ERR_CODE={NORMAL:-1,DUP_NAME:-9001},Ke),ix={},$G=function(e,t,i,r,n){var s=new Worker(ix[t]||(ix[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return s.onmessage=function(a){var o=a.data,l=o.$e$;if(l){var u=new Error(l[0]);u.code=l[1],u.stack=l[2],n(u,null)}else n(null,o)},s.postMessage(i,r),s},Et=Uint8Array,Er=Uint16Array,dd=Int32Array,pu=new Et([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fu=new Et([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ed=new Et([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),jT=function(e,t){for(var i=new Er(31),r=0;r<31;++r)i[r]=t+=1<<e[r-1];for(var n=new dd(i[30]),r=1;r<30;++r)for(var s=i[r];s<i[r+1];++s)n[s]=s-i[r]<<5|r;return{b:i,r:n}},YT=jT(pu,2),f0=YT.b,cf=YT.r;f0[28]=258,cf[258]=28;var GT=jT(fu,0),WT=GT.b,jb=GT.r,td=new Er(32768);for(qt=0;qt<32768;++qt)Ks=(qt&43690)>>1|(qt&21845)<<1,Ks=(Ks&52428)>>2|(Ks&13107)<<2,Ks=(Ks&61680)>>4|(Ks&3855)<<4,td[qt]=((Ks&65280)>>8|(Ks&255)<<8)>>1;var In=function(e,t,i){for(var r=e.length,n=0,s=new Er(t);n<r;++n)e[n]&&++s[e[n]-1];var a=new Er(t);for(n=1;n<t;++n)a[n]=a[n-1]+s[n-1]<<1;var o;if(i){o=new Er(1<<t);var l=15-t;for(n=0;n<r;++n)if(e[n])for(var u=n<<4|e[n],c=t-e[n],h=a[e[n]-1]++<<c,m=h|(1<<c)-1;h<=m;++h)o[td[h]>>l]=u}else for(o=new Er(r),n=0;n<r;++n)e[n]&&(o[n]=td[a[e[n]-1]++]>>15-e[n]);return o},ca=new Et(288);for(qt=0;qt<144;++qt)ca[qt]=8;for(qt=144;qt<256;++qt)ca[qt]=9;for(qt=256;qt<280;++qt)ca[qt]=7;for(qt=280;qt<288;++qt)ca[qt]=8;var uu=new Et(32);for(qt=0;qt<32;++qt)uu[qt]=5;var zT=In(ca,9,0),VT=In(ca,9,1),qT=In(uu,5,0),XT=In(uu,5,1),zp=function(e){for(var t=e[0],i=1;i<e.length;++i)e[i]>t&&(t=e[i]);return t},En=function(e,t,i){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(t&7)&i},Vp=function(e,t){var i=t/8|0;return(e[i]|e[i+1]<<8|e[i+2]<<16)>>(t&7)},mu=function(e){return(e+7)/8|0},vs=function(e,t,i){return(t==null||t<0)&&(t=0),(i==null||i>e.length)&&(i=e.length),new Et(e.subarray(t,i))};var JT=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ot=function(e,t,i){var r=new Error(t||JT[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,ot),!i)throw r;return r},If=function(e,t,i,r){var n=e.length,s=r?r.length:0;if(!n||t.f&&!t.l)return i||new Et(0);var a=!i,o=a||t.i!=2,l=t.i;a&&(i=new Et(n*3));var u=function(je){var me=i.length;if(je>me){var Ae=new Et(Math.max(me*2,je));Ae.set(i),i=Ae}},c=t.f||0,h=t.p||0,m=t.b||0,f=t.l,g=t.d,y=t.m,b=t.n,E=n*8;do{if(!f){c=En(e,h,1);var S=En(e,h+1,3);if(h+=3,S)if(S==1)f=VT,g=XT,y=9,b=5;else if(S==2){var v=En(e,h,31)+257,A=En(e,h+10,15)+4,x=v+En(e,h+5,31)+1;h+=14;for(var T=new Et(x),R=new Et(19),L=0;L<A;++L)R[ed[L]]=En(e,h+L*3,7);h+=A*3;for(var O=zp(R),H=(1<<O)-1,k=In(R,O,1),L=0;L<x;){var ee=k[En(e,h,H)];h+=ee&15;var q=ee>>4;if(q<16)T[L++]=q;else{var Q=0,ne=0;for(q==16?(ne=3+En(e,h,3),h+=2,Q=T[L-1]):q==17?(ne=3+En(e,h,7),h+=3):q==18&&(ne=11+En(e,h,127),h+=7);ne--;)T[L++]=Q}}var G=T.subarray(0,v),X=T.subarray(v);y=zp(G),b=zp(X),f=In(G,y,1),g=In(X,b,1)}else ot(1);else{var q=mu(h)+4,D=e[q-4]|e[q-3]<<8,F=q+D;if(F>n){l&&ot(0);break}o&&u(m+D),i.set(e.subarray(q,F),m),t.b=m+=D,t.p=h=F*8,t.f=c;continue}if(h>E){l&&ot(0);break}}o&&u(m+131072);for(var W=(1<<y)-1,z=(1<<b)-1,$=h;;$=h){var Q=f[Vp(e,h)&W],te=Q>>4;if(h+=Q&15,h>E){l&&ot(0);break}if(Q||ot(2),te<256)i[m++]=te;else if(te==256){$=h,f=null;break}else{var Z=te-254;if(te>264){var L=te-257,pe=pu[L];Z=En(e,h,(1<<pe)-1)+f0[L],h+=pe}var Se=g[Vp(e,h)&z],Ce=Se>>4;Se||ot(3),h+=Se&15;var X=WT[Ce];if(Ce>3){var pe=fu[Ce];X+=Vp(e,h)&(1<<pe)-1,h+=pe}if(h>E){l&&ot(0);break}o&&u(m+131072);var we=m+Z;if(m<X){var Fe=s-X,Ue=Math.min(X,we);for(Fe+m<0&&ot(3);m<Ue;++m)i[m]=r[Fe+m]}for(;m<we;++m)i[m]=i[m-X]}}t.l=f,t.p=$,t.b=m,t.f=c,f&&(c=1,t.m=y,t.d=g,t.n=b)}while(!c);return m!=i.length&&a?vs(i,0,m):i.subarray(0,m)},gs=function(e,t,i){i<<=t&7;var r=t/8|0;e[r]|=i,e[r+1]|=i>>8},Xl=function(e,t,i){i<<=t&7;var r=t/8|0;e[r]|=i,e[r+1]|=i>>8,e[r+2]|=i>>16},qp=function(e,t){for(var i=[],r=0;r<e.length;++r)e[r]&&i.push({s:r,f:e[r]});var n=i.length,s=i.slice();if(!n)return{t:Ha,l:0};if(n==1){var a=new Et(i[0].s+1);return a[i[0].s]=1,{t:a,l:1}}i.sort(function(x,T){return x.f-T.f}),i.push({s:-1,f:25001});var o=i[0],l=i[1],u=0,c=1,h=2;for(i[0]={s:-1,f:o.f+l.f,l:o,r:l};c!=n-1;)o=i[i[u].f<i[h].f?u++:h++],l=i[u!=c&&i[u].f<i[h].f?u++:h++],i[c++]={s:-1,f:o.f+l.f,l:o,r:l};for(var m=s[0].s,r=1;r<n;++r)s[r].s>m&&(m=s[r].s);var f=new Er(m+1),g=df(i[c-1],f,0);if(g>t){var r=0,y=0,b=g-t,E=1<<b;for(s.sort(function(T,R){return f[R.s]-f[T.s]||T.f-R.f});r<n;++r){var S=s[r].s;if(f[S]>t)y+=E-(1<<g-f[S]),f[S]=t;else break}for(y>>=b;y>0;){var v=s[r].s;f[v]<t?y-=1<<t-f[v]++-1:++r}for(;r>=0&&y;--r){var A=s[r].s;f[A]==t&&(--f[A],++y)}g=t}return{t:new Et(f),l:g}},df=function(e,t,i){return e.s==-1?Math.max(df(e.l,t,i+1),df(e.r,t,i+1)):t[e.s]=i},Yb=function(e){for(var t=e.length;t&&!e[--t];);for(var i=new Er(++t),r=0,n=e[0],s=1,a=function(l){i[r++]=l},o=1;o<=t;++o)if(e[o]==n&&o!=t)++s;else{if(!n&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(n),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(n);s=1,n=e[o]}return{c:i.subarray(0,r),n:t}},Jl=function(e,t){for(var i=0,r=0;r<t.length;++r)i+=e[r]*t[r];return i},m0=function(e,t,i){var r=i.length,n=mu(t+2);e[n]=r&255,e[n+1]=r>>8,e[n+2]=e[n]^255,e[n+3]=e[n+1]^255;for(var s=0;s<r;++s)e[n+s+4]=i[s];return(n+4+r)*8},Gb=function(e,t,i,r,n,s,a,o,l,u,c){gs(t,c++,i),++n[256];for(var h=qp(n,15),m=h.t,f=h.l,g=qp(s,15),y=g.t,b=g.l,E=Yb(m),S=E.c,v=E.n,A=Yb(y),x=A.c,T=A.n,R=new Er(19),L=0;L<S.length;++L)++R[S[L]&31];for(var L=0;L<x.length;++L)++R[x[L]&31];for(var O=qp(R,7),H=O.t,k=O.l,ee=19;ee>4&&!H[ed[ee-1]];--ee);var q=u+5<<3,Q=Jl(n,ca)+Jl(s,uu)+a,ne=Jl(n,m)+Jl(s,y)+a+14+3*ee+Jl(R,H)+2*R[16]+3*R[17]+7*R[18];if(l>=0&&q<=Q&&q<=ne)return m0(t,c,e.subarray(l,l+u));var G,X,D,F;if(gs(t,c,1+(ne<Q)),c+=2,ne<Q){G=In(m,f,0),X=m,D=In(y,b,0),F=y;var W=In(H,k,0);gs(t,c,v-257),gs(t,c+5,T-1),gs(t,c+10,ee-4),c+=14;for(var L=0;L<ee;++L)gs(t,c+3*L,H[ed[L]]);c+=3*ee;for(var z=[S,x],$=0;$<2;++$)for(var te=z[$],L=0;L<te.length;++L){var Z=te[L]&31;gs(t,c,W[Z]),c+=H[Z],Z>15&&(gs(t,c,te[L]>>5&127),c+=te[L]>>12)}}else G=zT,X=ca,D=qT,F=uu;for(var L=0;L<o;++L){var pe=r[L];if(pe>255){var Z=pe>>18&31;Xl(t,c,G[Z+257]),c+=X[Z+257],Z>7&&(gs(t,c,pe>>23&31),c+=pu[Z]);var Se=pe&31;Xl(t,c,D[Se]),c+=F[Se],Se>3&&(Xl(t,c,pe>>5&8191),c+=fu[Se])}else Xl(t,c,G[pe]),c+=X[pe]}return Xl(t,c,G[256]),c+X[256]},$T=new dd([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ha=new Et(0),KT=function(e,t,i,r,n,s){var a=s.z||e.length,o=new Et(r+a+5*(1+Math.ceil(a/7e3))+n),l=o.subarray(r,o.length-n),u=s.l,c=(s.r||0)&7;if(t){c&&(l[0]=s.r>>3);for(var h=$T[t-1],m=h>>13,f=h&8191,g=(1<<i)-1,y=s.p||new Er(32768),b=s.h||new Er(g+1),E=Math.ceil(i/3),S=2*E,v=function(We){return(e[We]^e[We+1]<<E^e[We+2]<<S)&g},A=new dd(25e3),x=new Er(288),T=new Er(32),R=0,L=0,O=s.i||0,H=0,k=s.w||0,ee=0;O+2<a;++O){var q=v(O),Q=O&32767,ne=b[q];if(y[Q]=ne,b[q]=Q,k<=O){var G=a-O;if((R>7e3||H>24576)&&(G>423||!u)){c=Gb(e,l,0,A,x,T,L,H,ee,O-ee,c),H=R=L=0,ee=O;for(var X=0;X<286;++X)x[X]=0;for(var X=0;X<30;++X)T[X]=0}var D=2,F=0,W=f,z=Q-ne&32767;if(G>2&&q==v(O-z))for(var $=Math.min(m,G)-1,te=Math.min(32767,O),Z=Math.min(258,G);z<=te&&--W&&Q!=ne;){if(e[O+D]==e[O+D-z]){for(var pe=0;pe<Z&&e[O+pe]==e[O+pe-z];++pe);if(pe>D){if(D=pe,F=z,pe>$)break;for(var Se=Math.min(z,pe-2),Ce=0,X=0;X<Se;++X){var we=O-z+X&32767,Fe=y[we],Ue=we-Fe&32767;Ue>Ce&&(Ce=Ue,ne=we)}}}Q=ne,ne=y[Q],z+=Q-ne&32767}if(F){A[H++]=268435456|cf[D]<<18|jb[F];var je=cf[D]&31,me=jb[F]&31;L+=pu[je]+fu[me],++x[257+je],++T[me],k=O+D,++R}else A[H++]=e[O],++x[e[O]]}}for(O=Math.max(O,k);O<a;++O)A[H++]=e[O],++x[e[O]];c=Gb(e,l,u,A,x,T,L,H,ee,O-ee,c),u||(s.r=c&7|l[c/8|0]<<3,c-=7,s.h=b,s.p=y,s.i=O,s.w=k)}else{for(var O=s.w||0;O<a+u;O+=65535){var Ae=O+65535;Ae>=a&&(l[c/8|0]=u,Ae=a),c=m0(l,c+1,e.subarray(O,Ae))}s.i=a}return vs(o,0,r+mu(c)+n)},KG=(function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var i=t,r=9;--r;)i=(i&1&&-306674912)^i>>>1;e[t]=i}return e})(),g0=function(){var e=-1;return{p:function(t){for(var i=e,r=0;r<t.length;++r)i=KG[i&255^t[r]]^i>>>8;e=i},d:function(){return~e}}},ZT=function(){var e=1,t=0;return{p:function(i){for(var r=e,n=t,s=i.length|0,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)n+=r+=i[a];r=(r&65535)+15*(r>>16),n=(n&65535)+15*(n>>16)}e=r,t=n},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},gu=function(e,t,i,r,n){if(!n&&(n={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),a=new Et(s.length+e.length);a.set(s),a.set(e,s.length),e=a,n.w=s.length}return KT(e,t.level==null?6:t.level,t.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,i,r,n)},QT=function(e,t){var i={};for(var r in e)i[r]=e[r];for(var r in t)i[r]=t[r];return i},rx=function(e,t,i){for(var r=e(),n=e.toString(),s=n.slice(n.indexOf("[")+1,n.lastIndexOf("]")).replace(/\s+/g,"").split(","),a=0;a<r.length;++a){var o=r[a],l=s[a];if(typeof o=="function"){t+=";"+l+"=";var u=o.toString();if(o.prototype)if(u.indexOf("[native code]")!=-1){var c=u.indexOf(" ",8)+1;t+=u.slice(c,u.indexOf("(",c))}else{t+=u;for(var h in o.prototype)t+=";"+l+".prototype."+h+"="+o.prototype[h].toString()}else t+=u}else i[l]=o}return t},Op=[],ZG=function(e){var t=[];for(var i in e)e[i].buffer&&t.push((e[i]=new e[i].constructor(e[i])).buffer);return t},QG=function(e,t,i,r){if(!Op[i]){for(var n="",s={},a=e.length-1,o=0;o<a;++o)n=rx(e[o],n,s);Op[i]={c:rx(e[a],n,s),e:s}}var l=QT({},Op[i].e);return $G(Op[i].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",i,l,ZG(l),r)},y0=function(){return[Et,Er,dd,pu,fu,ed,f0,WT,VT,XT,td,JT,In,zp,En,Vp,mu,vs,ot,If,oW,ew,rW]},eW=function(){return[Et,Er,dd,pu,fu,ed,cf,jb,zT,ca,qT,uu,td,$T,Ha,In,gs,Xl,qp,df,Yb,Jl,m0,Gb,mu,vs,KT,gu,aW,ew]};var tW=function(){return[_0,iw]};var iW=function(){return[nw]},ew=function(e){return postMessage(e,[e.buffer])},rW=function(e){return e&&{out:e.size&&new Et(e.size),dictionary:e.dictionary}};var Va=function(e){return e.ondata=function(t,i){return postMessage([t,i],[t.buffer])},function(t){t.data.length?(e.push(t.data[0],t.data[1]),postMessage([t.data[0].length])):e.flush()}},Af=function(e,t,i,r,n,s,a){var o,l=QG(e,r,n,function(u,c){u?(l.terminate(),t.ondata.call(t,u)):Array.isArray(c)?c.length==1?(t.queuedSize-=c[0],t.ondrain&&t.ondrain(c[0])):(c[1]&&l.terminate(),t.ondata.call(t,u,c[0],c[1])):a(c)});l.postMessage(i),t.queuedSize=0,t.push=function(u,c){t.ondata||ot(5),o&&t.ondata(ot(4,0,1),null,!!c),t.queuedSize+=u.length,l.postMessage([u,o=c],[u.buffer])},t.terminate=function(){l.terminate()},s&&(t.flush=function(){l.postMessage([])})},Ql=function(e,t){return e[t]|e[t+1]<<8},eu=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},Ib=function(e,t){return eu(e,t)+eu(e,t+4)*4294967296},Ut=function(e,t,i){for(;i;++t)e[t]=i,i>>>=8},tw=function(e,t){var i=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:t.level==9?2:0,e[9]=3,t.mtime!=0&&Ut(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),i){e[3]=8;for(var r=0;r<=i.length;++r)e[r+10]=i.charCodeAt(r)}},_0=function(e){(e[0]!=31||e[1]!=139||e[2]!=8)&&ot(6,"invalid gzip data");var t=e[3],i=10;t&4&&(i+=(e[10]|e[11]<<8)+2);for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[i++]);return i+(t&2)},iw=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},rw=function(e){return 10+(e.filename?e.filename.length+1:0)},nW=function(e,t){var i=t.level,r=i==0?0:i<6?1:i==9?3:2;if(e[0]=120,e[1]=r<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var n=ZT();n.p(t.dictionary),Ut(e,2,n.d())}},nw=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&ot(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&ot(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function hd(e,t){return typeof e=="function"&&(t=e,e={}),this.ondata=t,e}var oa=(function(){function e(t,i){if(typeof t=="function"&&(i=t,t={}),this.ondata=i,this.o=t||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new Et(98304),this.o.dictionary){var r=this.o.dictionary.subarray(-32768);this.b.set(r,32768-r.length),this.s.i=32768-r.length}}return e.prototype.p=function(t,i){this.ondata(gu(t,this.o,0,0,this.s),i)},e.prototype.push=function(t,i){this.ondata||ot(5),this.s.l&&ot(4);var r=t.length+this.s.z;if(r>this.b.length){if(r>2*this.b.length-32768){var n=new Et(r&-32768);n.set(this.b.subarray(0,this.s.z)),this.b=n}var s=this.b.length-this.s.z;this.b.set(t.subarray(0,s),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(t.subarray(s),32768),this.s.z=t.length-s+32768,this.s.i=32766,this.s.w=32768}else this.b.set(t,this.s.z),this.s.z+=t.length;this.s.l=i&1,(this.s.z>this.s.w+8191||i)&&(this.p(this.b,i||!1),this.s.w=this.s.i,this.s.i-=2)},e.prototype.flush=function(){this.ondata||ot(5),this.s.l&&ot(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},e})(),sW=(function(){function e(t,i){Af([eW,function(){return[Va,oa]}],this,hd.call(this,t,i),function(r){var n=new oa(r.data);onmessage=Va(n)},6,1)}return e})();function aW(e,t){return gu(e,t||{},0,0)}var Zr=(function(){function e(t,i){typeof t=="function"&&(i=t,t={}),this.ondata=i;var r=t&&t.dictionary&&t.dictionary.subarray(-32768);this.s={i:0,b:r?r.length:0},this.o=new Et(32768),this.p=new Et(0),r&&this.o.set(r)}return e.prototype.e=function(t){if(this.ondata||ot(5),this.d&&ot(4),!this.p.length)this.p=t;else if(t.length){var i=new Et(this.p.length+t.length);i.set(this.p),i.set(t,this.p.length),this.p=i}},e.prototype.c=function(t){this.s.i=+(this.d=t||!1);var i=this.s.b,r=If(this.p,this.s,this.o);this.ondata(vs(r,i,this.s.b),this.d),this.o=vs(r,this.s.b-32768),this.s.b=this.o.length,this.p=vs(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(t,i){this.e(t),this.c(i)},e})(),sw=(function(){function e(t,i){Af([y0,function(){return[Va,Zr]}],this,hd.call(this,t,i),function(r){var n=new Zr(r.data);onmessage=Va(n)},7,0)}return e})();function oW(e,t){return If(e,{i:2},t&&t.out,t&&t.dictionary)}var ite=(function(){function e(t,i){this.c=g0(),this.l=0,this.v=1,oa.call(this,t,i)}return e.prototype.push=function(t,i){this.c.p(t),this.l+=t.length,oa.prototype.push.call(this,t,i)},e.prototype.p=function(t,i){var r=gu(t,this.o,this.v&&rw(this.o),i&&8,this.s);this.v&&(tw(r,this.o),this.v=0),i&&(Ut(r,r.length-8,this.c.d()),Ut(r,r.length-4,this.l)),this.ondata(r,i)},e.prototype.flush=function(){oa.prototype.flush.call(this)},e})();function lW(e,t){t||(t={});var i=g0(),r=e.length;i.p(e);var n=gu(e,t,rw(t),8),s=n.length;return tw(n,t),Ut(n,s-8,i.d()),Ut(n,s-4,r),n}var Wb=(function(){function e(t,i){this.v=1,this.r=0,Zr.call(this,t,i)}return e.prototype.push=function(t,i){if(Zr.prototype.e.call(this,t),this.r+=t.length,this.v){var r=this.p.subarray(this.v-1),n=r.length>3?_0(r):4;if(n>r.length){if(!i)return}else this.v>1&&this.onmember&&this.onmember(this.r-r.length);this.p=r.subarray(n),this.v=0}Zr.prototype.c.call(this,i),this.s.f&&!this.s.l&&!i&&(this.v=mu(this.s.p)+9,this.s={i:0},this.o=new Et(0),this.push(new Et(0),i))},e})(),uW=(function(){function e(t,i){var r=this;Af([y0,tW,function(){return[Va,Zr,Wb]}],this,hd.call(this,t,i),function(n){var s=new Wb(n.data);s.onmember=function(a){return postMessage(a)},onmessage=Va(s)},9,0,function(n){return r.onmember&&r.onmember(n)})}return e})();function cW(e,t){var i=_0(e);return i+8>e.length&&ot(6,"invalid gzip data"),If(e.subarray(i,-8),{i:2},t&&t.out||new Et(iw(e)),t&&t.dictionary)}var rte=(function(){function e(t,i){this.c=ZT(),this.v=1,oa.call(this,t,i)}return e.prototype.push=function(t,i){this.c.p(t),oa.prototype.push.call(this,t,i)},e.prototype.p=function(t,i){var r=gu(t,this.o,this.v&&(this.o.dictionary?6:2),i&&4,this.s);this.v&&(nW(r,this.o),this.v=0),i&&Ut(r,r.length-4,this.c.d()),this.ondata(r,i)},e.prototype.flush=function(){oa.prototype.flush.call(this)},e})();var zb=(function(){function e(t,i){Zr.call(this,t,i),this.v=t&&t.dictionary?2:1}return e.prototype.push=function(t,i){if(Zr.prototype.e.call(this,t),this.v){if(this.p.length<6&&!i)return;this.p=this.p.subarray(nw(this.p,this.v-1)),this.v=0}i&&(this.p.length<4&&ot(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),Zr.prototype.c.call(this,i)},e})(),dW=(function(){function e(t,i){Af([y0,iW,function(){return[Va,Zr,zb]}],this,hd.call(this,t,i),function(r){var n=new zb(r.data);onmessage=Va(n)},11,0)}return e})();var nx=(function(){function e(t,i){this.o=hd.call(this,t,i)||{},this.G=Wb,this.I=Zr,this.Z=zb}return e.prototype.i=function(){var t=this;this.s.ondata=function(i,r){t.ondata(i,r)}},e.prototype.push=function(t,i){if(this.ondata||ot(5),this.s)this.s.push(t,i);else{if(this.p&&this.p.length){var r=new Et(this.p.length+t.length);r.set(this.p),r.set(t,this.p.length)}else this.p=t;this.p.length>2&&(this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(this.o):(this.p[0]&15)!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(this.o):new this.Z(this.o),this.i(),this.s.push(this.p,i),this.p=null)}},e})(),nte=(function(){function e(t,i){nx.call(this,t,i),this.queuedSize=0,this.G=uW,this.I=sw,this.Z=dW}return e.prototype.i=function(){var t=this;this.s.ondata=function(i,r,n){t.ondata(i,r,n)},this.s.ondrain=function(i){t.queuedSize-=i,t.ondrain&&t.ondrain(i)}},e.prototype.push=function(t,i){this.queuedSize+=t.length,nx.prototype.push.call(this,t,i)},e})();var sx=typeof TextEncoder<"u"&&new TextEncoder,Vb=typeof TextDecoder<"u"&&new TextDecoder,aw=0;try{Vb.decode(Ha,{stream:!0}),aw=1}catch{}var ow=function(e){for(var t="",i=0;;){var r=e[i++],n=(r>127)+(r>223)+(r>239);if(i+n>e.length)return{s:t,r:vs(e,i-1)};n?n==3?(r=((r&15)<<18|(e[i++]&63)<<12|(e[i++]&63)<<6|e[i++]&63)-65536,t+=String.fromCharCode(55296|r>>10,56320|r&1023)):n&1?t+=String.fromCharCode((r&31)<<6|e[i++]&63):t+=String.fromCharCode((r&15)<<12|(e[i++]&63)<<6|e[i++]&63):t+=String.fromCharCode(r)}},ste=(function(){function e(t){this.ondata=t,aw?this.t=new TextDecoder:this.p=Ha}return e.prototype.push=function(t,i){if(this.ondata||ot(5),i=!!i,this.t){this.ondata(this.t.decode(t,{stream:!0}),i),i&&(this.t.decode().length&&ot(8),this.t=null);return}this.p||ot(4);var r=new Et(this.p.length+t.length);r.set(this.p),r.set(t,this.p.length);var n=ow(r),s=n.s,a=n.r;i?(a.length&&ot(8),this.p=null):this.p=a,this.ondata(s,i)},e})(),ate=(function(){function e(t){this.ondata=t}return e.prototype.push=function(t,i){this.ondata||ot(5),this.d&&ot(4),this.ondata(qb(t),this.d=i||!1)},e})();function qb(e,t){if(t){for(var i=new Et(e.length),r=0;r<e.length;++r)i[r]=e.charCodeAt(r);return i}if(sx)return sx.encode(e);for(var n=e.length,s=new Et(e.length+(e.length>>1)),a=0,o=function(h){s[a++]=h},r=0;r<n;++r){if(a+5>s.length){var l=new Et(a+8+(n-r<<1));l.set(s),s=l}var u=e.charCodeAt(r);u<128||t?o(u):u<2048?(o(192|u>>6),o(128|u&63)):u>55295&&u<57344?(u=65536+(u&1047552)|e.charCodeAt(++r)&1023,o(240|u>>18),o(128|u>>12&63),o(128|u>>6&63),o(128|u&63)):(o(224|u>>12),o(128|u>>6&63),o(128|u&63))}return vs(s,0,a)}function hW(e,t){if(t){for(var i="",r=0;r<e.length;r+=16384)i+=String.fromCharCode.apply(null,e.subarray(r,r+16384));return i}else{if(Vb)return Vb.decode(e);var n=ow(e),s=n.s,i=n.r;return i.length&&ot(8),s}}var lw=function(e){return e==1?3:e<6?2:e==9?1:0};var pW=function(e,t){for(;Ql(e,t)!=1;t+=4+Ql(e,t+2));return[Ib(e,t+12),Ib(e,t+4),Ib(e,t+20)]},Xp=function(e){var t=0;if(e)for(var i in e){var r=e[i].length;r>65535&&ot(9),t+=r+4}return t},ax=function(e,t,i,r,n,s,a,o){var l=r.length,u=i.extra,c=o&&o.length,h=Xp(u);Ut(e,t,a!=null?33639248:67324752),t+=4,a!=null&&(e[t++]=20,e[t++]=i.os),e[t]=20,t+=2,e[t++]=i.flag<<1|(s<0&&8),e[t++]=n&&8,e[t++]=i.compression&255,e[t++]=i.compression>>8;var m=new Date(i.mtime==null?Date.now():i.mtime),f=m.getFullYear()-1980;if((f<0||f>119)&&ot(10),Ut(e,t,f<<25|m.getMonth()+1<<21|m.getDate()<<16|m.getHours()<<11|m.getMinutes()<<5|m.getSeconds()>>1),t+=4,s!=-1&&(Ut(e,t,i.crc),Ut(e,t+4,s<0?-s-2:s),Ut(e,t+8,i.size)),Ut(e,t+12,l),Ut(e,t+14,h),t+=16,a!=null&&(Ut(e,t,c),Ut(e,t+6,i.attrs),Ut(e,t+10,a),t+=14),e.set(r,t),t+=l,h)for(var g in u){var y=u[g],b=y.length;Ut(e,t,+g),Ut(e,t+2,b),e.set(y,t+4),t+=4+b}return c&&(e.set(o,t),t+=c),t},fW=function(e,t,i,r,n){Ut(e,t,101010256),Ut(e,t+8,i),Ut(e,t+10,i),Ut(e,t+12,r),Ut(e,t+16,n)},hf=(function(){function e(t){this.filename=t,this.c=g0(),this.size=0,this.compression=0}return e.prototype.process=function(t,i){this.ondata(null,t,i)},e.prototype.push=function(t,i){this.ondata||ot(5),this.c.p(t),this.size+=t.length,i&&(this.crc=this.c.d()),this.process(t,i||!1)},e})(),ote=(function(){function e(t,i){var r=this;i||(i={}),hf.call(this,t),this.d=new oa(i,function(n,s){r.ondata(null,n,s)}),this.compression=8,this.flag=lw(i.level)}return e.prototype.process=function(t,i){try{this.d.push(t,i)}catch(r){this.ondata(r,null,i)}},e.prototype.push=function(t,i){hf.prototype.push.call(this,t,i)},e})(),lte=(function(){function e(t,i){var r=this;i||(i={}),hf.call(this,t),this.d=new sW(i,function(n,s,a){r.ondata(n,s,a)}),this.compression=8,this.flag=lw(i.level),this.terminate=this.d.terminate}return e.prototype.process=function(t,i){this.d.push(t,i)},e.prototype.push=function(t,i){hf.prototype.push.call(this,t,i)},e})(),ute=(function(){function e(t){this.ondata=t,this.u=[],this.d=1}return e.prototype.add=function(t){var i=this;if(this.ondata||ot(5),this.d&2)this.ondata(ot(4+(this.d&1)*8,0,1),null,!1);else{var r=qb(t.filename),n=r.length,s=t.comment,a=s&&qb(s),o=n!=t.filename.length||a&&s.length!=a.length,l=n+Xp(t.extra)+30;n>65535&&this.ondata(ot(11,0,1),null,!1);var u=new Et(l);ax(u,0,t,r,o,-1);var c=[u],h=function(){for(var b=0,E=c;b<E.length;b++){var S=E[b];i.ondata(null,S,!1)}c=[]},m=this.d;this.d=0;var f=this.u.length,g=QT(t,{f:r,u:o,o:a,t:function(){t.terminate&&t.terminate()},r:function(){if(h(),m){var b=i.u[f+1];b?b.r():i.d=1}m=1}}),y=0;t.ondata=function(b,E,S){if(b)i.ondata(b,E,S),i.terminate();else if(y+=E.length,c.push(E),S){var v=new Et(16);Ut(v,0,134695760),Ut(v,4,t.crc),Ut(v,8,y),Ut(v,12,t.size),c.push(v),g.c=y,g.b=l+y+16,g.crc=t.crc,g.size=t.size,m&&g.r(),m=1}else m&&h()},this.u.push(g)}},e.prototype.end=function(){var t=this;if(this.d&2){this.ondata(ot(4+(this.d&1)*8,0,1),null,!0);return}this.d?this.e():this.u.push({r:function(){t.d&1&&(t.u.splice(-1,1),t.e())},t:function(){}}),this.d=3},e.prototype.e=function(){for(var t=0,i=0,r=0,n=0,s=this.u;n<s.length;n++){var a=s[n];r+=46+a.f.length+Xp(a.extra)+(a.o?a.o.length:0)}for(var o=new Et(r+22),l=0,u=this.u;l<u.length;l++){var a=u[l];ax(o,t,a,a.f,a.u,-a.c-2,i,a.o),t+=46+a.f.length+Xp(a.extra)+(a.o?a.o.length:0),i+=a.b}fW(o,t,this.u.length,r,i),this.ondata(null,o,!0),this.d=2},e.prototype.terminate=function(){for(var t=0,i=this.u;t<i.length;t++){var r=i[t];r.t()}this.d=2},e})();var mW=(function(){function e(){}return e.prototype.push=function(t,i){this.ondata(null,t,i)},e.compression=0,e})(),cte=(function(){function e(){var t=this;this.i=new Zr(function(i,r){t.ondata(null,i,r)})}return e.prototype.push=function(t,i){try{this.i.push(t,i)}catch(r){this.ondata(r,null,i)}},e.compression=8,e})(),dte=(function(){function e(t,i){var r=this;i<32e4?this.i=new Zr(function(n,s){r.ondata(null,n,s)}):(this.i=new sw(function(n,s,a){r.ondata(n,s,a)}),this.terminate=this.i.terminate)}return e.prototype.push=function(t,i){this.i.terminate&&(t=vs(t,0)),this.i.push(t,i)},e.compression=8,e})(),hte=(function(){function e(t){this.onfile=t,this.k=[],this.o={0:mW},this.p=Ha}return e.prototype.push=function(t,i){var r=this;if(this.onfile||ot(5),this.p||ot(4),this.c>0){var n=Math.min(this.c,t.length),s=t.subarray(0,n);if(this.c-=n,this.d?this.d.push(s,!this.c):this.k[0].push(s),t=t.subarray(n),t.length)return this.push(t,i)}else{var a=0,o=0,l=void 0,u=void 0;this.p.length?t.length?(u=new Et(this.p.length+t.length),u.set(this.p),u.set(t,this.p.length)):u=this.p:u=t;for(var c=u.length,h=this.c,m=h&&this.d,f=function(){var E,S=eu(u,o);if(S==67324752){a=1,l=o,g.d=null,g.c=0;var v=Ql(u,o+6),A=Ql(u,o+8),x=v&2048,T=v&8,R=Ql(u,o+26),L=Ql(u,o+28);if(c>o+30+R+L){var O=[];g.k.unshift(O),a=2;var H=eu(u,o+18),k=eu(u,o+22),ee=hW(u.subarray(o+30,o+=30+R),!x);H==4294967295?(E=T?[-2]:pW(u,o),H=E[0],k=E[1]):T&&(H=-1),o+=L,g.c=H;var q,Q={name:ee,compression:A,start:function(){if(Q.ondata||ot(5),!H)Q.ondata(null,Ha,!0);else{var ne=r.o[A];ne||Q.ondata(ot(14,"unknown compression type "+A,1),null,!1),q=H<0?new ne(ee):new ne(ee,H,k),q.ondata=function(F,W,z){Q.ondata(F,W,z)};for(var G=0,X=O;G<X.length;G++){var D=X[G];q.push(D,!1)}r.k[0]==O&&r.c?r.d=q:q.push(Ha,!0)}},terminate:function(){q&&q.terminate&&q.terminate()}};H>=0&&(Q.size=H,Q.originalSize=k),g.onfile(Q)}return"break"}else if(h){if(S==134695760)return l=o+=12+(h==-2&&8),a=3,g.c=0,"break";if(S==33639248)return l=o-=4,a=3,g.c=0,"break"}},g=this;o<c-4;++o){var y=f();if(y==="break")break}if(this.p=Ha,h<0){var b=a?u.subarray(0,l-12-(h==-2&&8)-(eu(u,l-16)==134695760&&4)):u.subarray(0,o);m?m.push(b,!!a):this.k[+(a==2)].push(b)}if(a&2)return this.push(u.subarray(o),i);this.p=u.subarray(o)}i&&(this.c&&ot(13),this.p=null)},e.prototype.register=function(t){this.o[t.compression]=t},e})();var Ks,qt,gW=(e=>(e.Text="text/plain;charset=UTF-8",e.Json="application/json",e.Form="application/x-www-form-urlencoded;charset=UTF-8",e.FormData="multipart/form-data",e))(gW||{}),yW=(e=>(e.ContentType="Content-type",e))(yW||{}),_W=(e=>(e[e.Success=200]="Success",e[e.NotFound=404]="NotFound",e[e.NetError=500]="NetError",e))(_W||{}),bW=(e=>(e.Json="json",e.Blob="blob",e))(bW||{}),PW=0;function pt(e,t,i={},r={},n){return new Promise((s,a)=>{try{let l=PW++;var o;e=e||"GET",EW(e,i,r);let u=SW(t,i,r,n);o=(u==null?void 0:u.params)||i,r=(u==null?void 0:u.options)||r;let c=vW(e,t,o,r);o=c.params,t=c.url;let h=new XMLHttpRequest;if(r.withCredentials!==void 0&&(h.withCredentials=r.withCredentials),r.responseType!==void 0&&(h.responseType=r.responseType),h.open(e,t,!0),IW(h,e,i,r),o=CW(h,e,t,o,r),h.onreadystatechange=function(){if(h.readyState===4&&h.status===200)try{r.responseType==="blob"?s(h.response):s(JSON.parse(h.responseText))}catch(m){console.warn("catch ajax error...",m),s({success:!1,message:"Network Error!"})}else h.status===404?(console.warn("catch ajax error...",h.status),s({success:!1,code:h.status,message:"Network Error!"})):h.status===500&&(console.warn("catch ajax error...",h.status),s({success:!1,code:h.status,message:"Network Error!"}))},h.onerror=function(m){console.warn("catch ajax error...",m),s({success:!1,message:"Network Error!"})},o instanceof Uint8Array){let m=new Blob([o]);h.send(m)}else h.send(o)}catch(l){console.warn("catch ajax error...",l),s({success:!1,message:"Network Error!"})}})}function EW(e,t,i={}){if(e.toLowerCase()!=="get"&&!(t instanceof FormData)&&typeof t!="string"&&(i==null?void 0:i.contentType)!==!1&&(i=i||{},i.headers=Object.assign(i.headers||{},{"Content-type":"application/json"})),i.headers){let r={};for(let n in i.headers){let s=i.headers[n];r[n]=s}i.headers=r}}function SW(e,t,i={},r){var n;if(!(t.path||(n=i==null?void 0:i.headers)!=null&&n.path)){if(e.includes("component")&&r)t.path=r;else if(r){let s=i.headers||{};s=Object.assign(s,{path:r}),i.headers=s}return{params:t,options:i}}}function ox(e,t=50){return typeof e!="string"?!1:e.length*2>t*1024*1024}function vW(e,t,i,r={}){var m;let n,s,a,o=[],l=r.headers,u=!1;if(i instanceof FormData)n=i;else if(typeof i=="string")n=i;else if((m=l==null?void 0:l["Content-type"])!=null&&m.includes("application/json")){if(typeof i=="object"&&i!==null){for(let f in i)if(ox(i[f])){u=!0;break}}if(u){let f=new FormData;for(let g in i){let y=i[g];ox(y)?f.append(g,new Blob([y],{type:"text/plain"})):f.append(g,typeof y=="object"?JSON.stringify(y):y)}n=f,r.headers&&(r.headers["Content-type"]="multipart/form-data")}else n=JSON.stringify(i)}else{for(s in i)if(a=i[s],a instanceof Array)for(let f=0;f<a.length;f++){let g=a[f];o.push(encodeURIComponent(`${s}[]`)+"="+encodeURIComponent(g))}else if(Object.prototype.toString.call(a)==="[object Object]")for(let f in a){let g=a[f];o.push(encodeURIComponent(`${s}[${f}]`)+"="+(g?encodeURIComponent(g):""))}else o.push(encodeURIComponent(s)+"="+encodeURIComponent(a));n=o.join("&"),e==="GET"&&n&&typeof n=="string"&&r.searchParams===!0&&(t=t+"?"+n,n={})}let c=/{[a-zA-Z]+}/gim,h=[...new Set(t.match(c))];for(let f of h){let g=f.substring(1,f.length-1);t=t.replace(f,i[g]||"")}return{params:n,url:t}}function IW(e,t,i,r={}){let n=r.headers;if(n){for(let s in n){let a=n[s];e.setRequestHeader(encodeURI(s),encodeURI(a))}r.contentType!==!1&&!n["Content-type"]&&e.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8")}else r.contentType!==!1&&e.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8");if(self.document){let s=t.toUpperCase();if(s!=="GET"&&s!=="HEAD"){let a=/XSRF-TOKEN=(\S+);?/.exec(document.cookie);a&&e.setRequestHeader("X-XSRF-TOKEN",decodeURIComponent(a[1]))}}}var AW=1e4;function CW(e,t,i,r,n={}){return t.match(/post/i)&&i.startsWith("/")&&!i.startsWith("/servicecenter/")&&typeof r=="string"&&r.length>=AW&&(r=lW(new TextEncoder().encode(r),{level:1}),e.setRequestHeader("Content-Encoding","gzip")),r}async function uw(e,t,i,r){if(!r||!i){let a=`invalid parameters ${r}|${i}.`;return{code:Ge.ERR_CODE.NORMAL,success:!1,msg:a,message:a,result:null}}let n=await pt("POST",t?`/api/v2/devices/${r}/delete`:`/api/v2/components/${r}/delete`,{},{headers:{"Content-type":"application/json","content-type":"application/json",path:i}});if(n.code===0&&n.success)return{code:0,success:!0,msg:"",message:"",result:{componentId:r}};let s=n.message||n.msg||"Request Error.";return{...n,msg:s,message:s,result:{componentId:r}}}async function xW(e,t,i){if(e){let c="operations not currently supported.";return{code:Ge.ERR_CODE.NORMAL,success:!1,msg:c,message:c,result:null}}let r={code:0,success:!0,result:{devices:{succeed:[],failed:[]},symbols:{succeed:[],failed:[]},footprints:{succeed:[],failed:[]},d3models:{succeed:[],failed:[]},cbbs:{succeed:[],failed:[]},panels:{succeed:[],failed:[]}},msg:"",message:""},n=await Wl(e,!0,t,i.devices||[]);r.result.devices={...n.result};let s=await Wl(e,!1,t,i.symbols||[]);r.result.symbols={...s.result};let a=await Wl(e,!1,t,i.footprints||[]);r.result.footprints={...a.result};let o=await Wl(e,!1,t,i.d3models||[]);r.result.d3models={...o.result};let l=await Wl(e,!1,t,i.cbbs||[]);r.result.cbbs={...l.result};let u=await Wl(e,!1,t,i.panels||[]);return r.result.panels={...u.result},r}async function Wl(e,t,i,r){let n=[],s=[];for(let a=0;a<r.length;a++){let o=await uw(e,t,i,r[a]);if(o.code===0&&o.success){n.push(r[a]);continue}n.push(r[a])}return{code:0,success:!0,result:{succeed:n,failed:s},msg:"",message:""}}function cw(e){if(!e)return[];if(e instanceof Array)return e;let t=[];return e!=null&&e.parent_tag&&(e!=null&&e.parent_tag.uuid)&&t.push(e==null?void 0:e.parent_tag.uuid),e!=null&&e.child_tag&&(e!=null&&e.child_tag.uuid)&&t.push(e==null?void 0:e.child_tag.uuid),t}function Jo(e){if(!e)return[];if(e instanceof Array)return e;let t=[];return e!=null&&e.parent_tag&&(e!=null&&e.parent_tag.name)&&t.push(e==null?void 0:e.parent_tag.name),e!=null&&e.child_tag&&(e!=null&&e.child_tag.name)&&t.push(e==null?void 0:e.child_tag.name),t}function pd(e,t=!1){return e?t?lx(e):e.indexOf("_")>=0?wW(e):e.indexOf("@")>=0?TW(e):lx(e):{componentTitleOrId:void 0,path:void 0,isLocaleFilenameMode:!1}}function lx(e){let t={componentTitleOrId:void 0,path:void 0,isLocaleFilenameMode:!1};if(!/\|/i.test(e))return t.isLocaleFilenameMode=!1,t.componentTitleOrId=e,t;let i=e.split("|");return t.componentTitleOrId=i[0],t.path=i[1],/\./.test(i[0])?(t.isLocaleFilenameMode=!0,t):(t.isLocaleFilenameMode=!1,t)}function TW(e){let t={componentTitleOrId:void 0,path:void 0,isLocaleFilenameMode:!1};if(!/\@/i.test(e))return t.isLocaleFilenameMode=!1,t.componentTitleOrId=e,t;let i=e.split("@");return t.componentTitleOrId=i[0],t.path=i[1],/\./.test(i[0])?(t.isLocaleFilenameMode=!0,t):(t.isLocaleFilenameMode=!1,t)}function wW(e){let t={componentTitleOrId:void 0,path:void 0,isLocaleFilenameMode:!1};if(!/_/i.test(e))return t.isLocaleFilenameMode=!1,t.componentTitleOrId=e,t;let i=e.split("_");return t.componentTitleOrId=i[0],t.path=i[1],/\./.test(i[0])?(t.isLocaleFilenameMode=!0,t):(t.isLocaleFilenameMode=!1,t)}async function b0(e,t){let i=pd(e,!0),r=i.path||t,n={code:Ge.ERR_CODE.NORMAL,success:!0,result:null,msg:""};return n.result={createTime:0,created_at:"",creator:null,dataStr:JSON.stringify({model:`${i.componentTitleOrId}|${r}`,unit:"mm"}),display_title:i.componentTitleOrId||"-",uuid:`${i.componentTitleOrId}|${r}`||"",path:r,description:"",docType:16,modifier:null,owner:null,source:"",tags:{child_tag:[],parent_tag:[]},title:i.componentTitleOrId||"",updateTime:0,updated_at:"",version:"",public:void 0},n}var RW=class{constructor(){if(!crypto||!crypto.subtle)throw new Error("\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301crypto api");this.tool=crypto.subtle}},LW=class extends RW{constructor(){super(),this.keyBuffer=null,this.key=null,this.iv=null}async init(e){try{return this.keyBuffer=e.key,this.key=await this.setKey(this.keyBuffer),this.iv=await this.setIV(e.iv),this}catch{throw new Error(`invalid key or iv! ${e}`)}}setKey(e){if(e instanceof ArrayBuffer)return this.tool.importKey("raw",e,"AES-GCM",!0,["encrypt","decrypt"]);throw new Error(`invalid key! ${e}`)}setIV(e){if(e instanceof ArrayBuffer)return e;throw new Error(`invalid iv! ${e}`)}encrypt(e){return this.tool.encrypt({name:"AES-GCM",iv:this.iv},this.key,e)}decrypt(e){return this.tool.decrypt({name:"AES-GCM",iv:this.iv},this.key,e)}decrypt2(e){return this.tool.decrypt({name:"AES-GCM",iv:this.iv,tagLength:128},this.key,e)}getKey(){return this.keyBuffer}getIV(){return this.iv}};function ux(e){let t=e.match(/[\da-f]{2}/gi);return t?new Uint8Array(t.map(function(i){return parseInt(i,16)})).buffer:null}function NW(e,t="utf-8"){var i=new TextDecoder(t);return i.decode(e)}async function Xn(e){try{if(!e.dataStrId)return null;let t=new Headers;t.append("Content-Type","text/plain;charset=UTF-8");let i=await(await fetch(e.dataStrId,{method:"GET",redirect:"error",headers:t})).arrayBuffer();if(i){let r=await DW(e,i);return NW(r)}return null}catch(t){throw new Error("fetch\u5931\u8D25!!!"+t)}}async function DW(e,t){let i=new LW;try{let{key:r,iv:n}=e;if(t&&n&&r){let s=ux(r),a=ux(n);await i.init({key:s,iv:a});let o=await i.decrypt(t);return cW(new Uint8Array(o))}else throw new Error(`\u6570\u636E\u89E3\u5BC6\u5931\u8D25!!!\u6570\u636E\u4E0D\u6B63\u786E:data:${t},key:${r},iv:${n}`)}catch(r){throw new Error("\u6570\u636E\u89E3\u5BC6\u5931\u8D25!!!"+r)}}async function fd(e,t=Ge.SYSTEMLIB_UUID){if(!e)return null;let i=null,r=pd(e,!0);if(r.isLocaleFilenameMode)return i=(await b0(r.componentTitleOrId,r.path||t)).result,i;let n=await pt("GET",`/api/v2/components/${r.componentTitleOrId}`,{},{headers:{"Content-type":"application/json","content-type":"application/json",path:r.path||t||void 0}});if(n.code===0&&n.success&&typeof n.result=="object"&&(i=n.result),i)try{let s=await Xn(i);i.dataStr=s}catch(s){console.error(s)}return i}function Vo(e=new Date,t="yyyy-MM-dd HH:ii:ss"){if(Number.isNaN(e.getTime()))return"-";let i={"M+":e.getMonth()+1,"d+":e.getDate(),"H+":e.getHours(),"h+":e.getHours(),"i+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(let r in i)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,RegExp.$1.length==1?i[r]:("00"+i[r]).substr((""+i[r]).length)));return t}function BW(e,t){function i(c){return c>=10?String(c):"0"+c}e instanceof Date?e.getTime().toString().length>13&&(e=new Date(e.getTime()/1e3)):Number.isNaN(Number(e))||e.toString().length>13&&(e=new Date(Number(e)/1e3));let r=new Date(e);if(Number.isNaN(r.getTime()))return"-";let n=r.getFullYear(),s=i(r.getMonth()+1),a=i(r.getDate()),o=i(r.getHours()),l=i(r.getMinutes()),u=i(r.getSeconds());return t==="downProject"?n+"-"+s+"-"+a:t==="migrateStandardProject"?n+"-"+s+"-"+a+"_"+o+"-"+l+"-"+u:t==="y-m-d"||t==="yyyy-MM-dd"?n+"-"+s+"-"+a:t==="y-m-d_h-m-s"?`${n}-${s}-${a}_${o}-${l}-${u}`:n+"-"+s+"-"+a+" "+o+":"+l+":"+u}function dw(e,t,i){let r=new Date().getTime(),n=Vo(new Date(r)),s={avatar:"",nickname:"",username:"",uuid:""},a=e+(i?`|${i}`:"");return{createTime:r,created_at:n,creator:{...s},dataStr:JSON.stringify({model:a,unit:"mm"}),description:"",display_title:t,docType:16,modifier:{...s},owner:{...s},path:i,public:!1,source:"",std_uuid:"",tags:{child_tag:[],parent_tag:[]},ticket:0,title:t,type:0,updateTime:r,updated_at:n,uuid:e,version:""}}async function OW(e){return e?new Promise((t,i)=>{window.fetch(`https://modules.lceda.cn/3dmodel/${e}`,{method:"GET"}).then(async r=>{let n=await r.blob();t({code:0,success:!0,result:n,message:""})}).catch(async r=>{t({code:r?r.code:-9,success:!1,result:null,message:"fetch 3D model file failed."})})}):{code:-1,success:!1,result:null,message:"missing uuid or path or detail data."}}var P0=class{},MW=(e=>(e.PROJECT_DOCUMENT_LOCKED="PROJECT_DOCUMENT_LOCKED",e.PROJECT_DOCUMENT_UPDATE_REJECT="PROJECT_DOCUMENT_UPDATE_REJECT",e.NOSYMBOL_ON_TARGETPATH_BY_DEVICE_BOUND="NOSYMBOL_ON_TARGETPATH_BY_DEVICE_BOUND",e.NOFOOTPRINT_ON_TARGETPATH_BY_DEVICE_BOUND="NOFOOTPRINT_ON_TARGETPATH_BY_DEVICE_BOUND",e.DEVICE_ATTRIBUTES_ERROR="DEVICE_ATTRIBUTES_ERROR",e.DEVICE_DESCRIPTION_ERROR="DEVICE_DESCRIPTION_ERROR",e.SYMBOL_DESCRIPTION_ERROR="SYMBOL_DESCRIPTION_ERROR",e.FOOTPRINT_DESCRIPTION_ERROR="FOOTPRINT_DESCRIPTION_ERROR",e.D3MODEL_DESCRIPTION_ERROR="D3MODEL_DESCRIPTION_ERROR",e.DEVICE_NAMA_ERROR="DEVICE_NAMA_ERROR",e.SYMBOL_NAMA_ERROR="SYMBOL_NAMA_ERROR",e.FOOTPRINT_NAMA_ERROR="FOOTPRINT_NAMA_ERROR",e.PANEL_LIB_NAMA_ERROR="PANEL_LIB_NAMA_ERROR",e.D3MODEL_NAMA_ERROR="D3MODEL_NAMA_ERROR",e.SIM_MODEL_NAMA_ERROR="SIM_MODEL_NAMA_ERROR",e.DEVICE_SAME_NAMA_EXISTS="DEVICE_SAME_NAMA_EXISTS",e.SYMBOL_SAME_NAMA_EXISTS="SYMBOL_SAME_NAMA_EXISTS",e.FOOTPRINT_SAME_NAMA_EXISTS="FOOTPRINT_SAME_NAMA_EXISTS",e.D3MODEL_SAME_NAMA_EXISTS="D3MODEL_SAME_NAMA_EXISTS",e.SIM_MODEL_SAME_NAMA_EXISTS="SIM_MODEL_SAME_NAMA_EXISTS",e.PANELLIB_SAME_NAMA_EXISTS="PANELLIB_SAME_NAMA_EXISTS",e.PARAMETER_VERIFICATION="PARAMETER_VERIFICATION",e.RESULT_VERIFICATION="RESULT_VERIFICATION",e.GET_DEVICE="GET_DEVICE",e.GET_DEVICE_NOT_FOUND="GET_DEVICE_NOT_FOUND",e.GET_DEVICE_LIST="GET_DEVICE_LIST",e.GET_DEVICE_SEARCH_LIST="GET_DEVICE_SEARCH_LIST",e.GET_SYMBOL="GET_SYMBOL",e.GET_SYMBOL_NOT_FOUND="GET_SYMBOL_NOT_FOUND",e.GET_SYMBOL_LIST="GET_SYMBOL_LIST",e.GET_SYMBOL_SEARCH_LIST="GET_SYMBOL_SEARCH_LIST",e.GET_FOOTPRINT="GET_FOOTPRINT",e.GET_FOOTPRINT_NOT_FOUND="GET_FOOTPRINT_NOT_FOUND",e.GET_FOOTPRINT_LIST="GET_FOOTPRINT_LIST",e.GET_FOOTPRINT_SEARCH_LIST="GET_FOOTPRINT_SEARCH_LIST",e.GET_D3MODEL="GET_D3MODEL",e.GET_D3MODEL_NOT_FOUND="GET_D3MODEL_NOT_FOUND",e.GET_D3MODEL_LIST="GET_D3MODEL_LIST",e.GET_D3MODEL_SEARCH_LIST="GET_D3MODEL_SEARCH_LIST",e.GET_SIM_MODEL="GET_SIM_MODEL",e.GET_SIM_NOT_FOUND="GET_SIM_NOT_FOUND",e.GET_SIM_MODEL_LIST="GET_SIM_MODEL_LIST",e.GET_SIM_MODEL_SEARCH_LIST="GET_SIM_MODEL_SEARCH_LIST",e.CROSS_BIND="CROSS_BIND",e.CROSS_BIND_EXIT="CROSS_BIND_EXIT",e.IMPORT_EXIST_PROJECT="IMPORT_EXIST_PROJECT",e.CREATE_PROJECT="CREATE_PROJECT",e.CREATE_DEVICE="CREATE_DEVICE",e.CREATE_DEVICE_DUP_TITLE="CREATE_DEVICE_DUP_TITLE",e.CREATE_DEVICE_PERMISSIONS="CREATE_DEVICE_PERMISSIONS",e.CREATE_SYMBOL="CREATE_SYMBOL",e.CREATE_SYMBOL_DUP_TITLE="CREATE_SYMBOL_DUP_TITLE",e.CREATE_SYMBOL_PERMISSIONS="CREATE_SYMBOL_PERMISSIONS",e.CREATE_SYMBOL_MIGRATE_CANVAS_ERROR="CREATE_SYMBOL_MIGRATE_CANVAS_ERROR",e.CREATE_FOOTPRINT="CREATE_FOOTPRINT",e.CREATE_FOOTPRINT_DUP_TITLE="CREATE_FOOTPRINT_DUP_TITLE",e.CREATE_FOOTPRINT_PERMISSIONS="CREATE_FOOTPRINT_PERMISSIONS",e.CREATE_FOOTPRINT_MIGRATE_CANVAS_ERROR="CREATE_FOOTPRINT_MIGRATE_CANVAS_ERROR",e.CREATE_D3MODEL="CREATE_D3MODEL",e.CREATE_D3MODEL_DUP_TITLE="CREATE_D3MODEL_DUP_TITLE",e.CREATE_D3MODEL_PERMISSIONS="CREATE_D3MODEL_PERMISSIONS",e.CREATE_PANEL_LIB="CREATE_PANEL_LIB",e.CREATE_PANEL_DUP_TITLE="CREATE_PANEL_DUP_TITLE",e.CREATE_PANEL_PERMISSIONS="CREATE_PANEL_PERMISSIONS",e.CREATE_SIM_MODEL="CREATE_SIM_MODEL",e.CREATE_SIM_MODEL_DUP_TITLE="CREATE_SIM_MODEL_DUP_TITLE",e.CREATE_SIM_MODEL_PERMISSIONS="CREATE_SIM_MODEL_PERMISSIONS",e.CREATE_SIM_MODEL_MIGRATE_CANVAS_ERROR="CREATE_SIM_MODEL_MIGRATE_CANVAS_ERROR",e.UPDATE_DEVICE="UPDATE_DEVICE",e.UPDATE_DEVICE_ATTRIBUTES="UPDATE_DEVICE_ATTRIBUTES",e.UPDATE_DEVICE_PERMISSIONS="CREATE_DEVICE_PERMISSIONS",e.UPDATE_SYMBOL="UPDATE_SYMBOL",e.UPDATE_SYMBOL_MIGRATE_CANVAS_ERROR="UPDATE_SYMBOL_MIGRATE_CANVAS_ERROR",e.UPDATE_SYMBOL_PERMISSIONS="UPDATE_SYMBOL_PERMISSIONS",e.UPDATE_FOOTPRINT="UPDATE_FOOTPRINT",e.UPDATE_FOOTPRINT_MIGRATE_CANVAS_ERROR="UPDATE_FOOTPRINT_MIGRATE_CANVAS_ERROR",e.UPDATE_FOOTPRINT_PERMISSIONS="UPDATE_FOOTPRINT_PERMISSIONS",e.UPDATE_D3MODEL_PERMISSIONS="UPDATE_D3MODEL_PERMISSIONS",e.UPDATE_SIM_MODEL="UPDATE_SIM_MODEL",e.UPDATE_SIM_MODEL_MIGRATE_CANVAS_ERROR="UPDATE_SIM_MODEL_MIGRATE_CANVAS_ERROR",e.UPDATE_SIM_MODEL_PERMISSIONS="UPDATE_SIM_MODEL_PERMISSIONS",e.DELETE_DEVICE="DELETE_DEVICE",e.DELETE_SYMBOL="DELETE_SYMBOL",e.DELETE_FOOTPRINT="DELETE_FOOTPRINT",e.DELETE_SIM_MODEL="DELETE_SIM_MODEL",e.DELETE_3DMODEL="DELETE_3DMODEL",e.GET_SOURCE="GET_SOURCE",e))(MW||{}),he=class{constructor(e,t=""){this._message=t,this._action=e}get message(){return this._message}set message(e){this._message=e}get action(){return this._action}set action(e){this._action=e}toJSON(){return{message:this.message,action:this.action}}};function Gt(e){if(!e){let t="missing creator data.";throw new he("RESULT_VERIFICATION",t)}return{uuid:e.uuid,nickname:e.nickname,username:e.username}}function Wt(e){if(!e){let t="missing modifier data.";throw new he("RESULT_VERIFICATION",t)}return{uuid:e.uuid,nickname:e.nickname,username:e.username}}function zt(e){if(!e){let t="missing owner data.";throw new he("RESULT_VERIFICATION",t)}return{uuid:e.uuid,nickname:e.nickname,username:e.username}}function vr(e,t){let i=Object.keys(t);for(let r=0;r<i.length;r++)fV.indexOf(i[r])<=-1||(i[r]==="title"&&"display_title"in e&&t.title&&(e.display_title=String(t.title),e.title=String(t.title).toLocaleLowerCase()),e[i[r]]=t[i[r]])}function Cf(e,t){return e[t]}function hw(e){if(!e||e.length<=0||e.length>128){let t="The title length must be between 1~128 characters!";throw new he("DEVICE_NAMA_ERROR",t)}}function pw(e){if(!e||e.length<=0||e.length>128){let t="The title length must be between 1~128 characters!";throw new he("SYMBOL_NAMA_ERROR",t)}}function fw(e){if(!e||e.length<=0||e.length>128){let t="The title length must be between 1~128 characters!";throw new he("FOOTPRINT_NAMA_ERROR",t)}}function kW(e){if(!e||e.length<=0||e.length>128){let t="The title length must be between 1~128 characters!";throw new he("D3MODEL_NAMA_ERROR",t)}}function mw(e){if(!e||e.length<=0||e.length>128){let t="The title length must be between 1~128 characters!";throw new he("SIM_MODEL_NAMA_ERROR",t)}}async function su(e,t){let i=[],r=[],n=async o=>{let{message:l}=await Re.messageBus.rpcCall(ua.TAG.CREATE,o);return l},s=null;try{for(let o=0;o<e.length;o++){let l=await n({...e[o],path:e[o].user_uuid});if(l.code===0&&l.success){let c={...l,message:"",result:{...e[o],path:e[o].user_uuid,...l.result[0]}};i.push(c),t&&t(c,o);continue}let u={...l,result:{...e[o]}};r.push(u)}return{code:0,success:!0,result:{successList:i,failList:r},message:""}}catch(o){s=o}let a=s?s.msg||s.message:"Add Categories Batch Error";return{code:s?s.code:Ge.ERR_CODE.NORMAL,success:!1,result:null,message:a}}function ur(e=[],t,i){if(!e||!e.length||!t)return{index:-1,data:null};let r={index:-1,data:null};for(let n=0;n<e.length;n++)if(typeof e[n]=="object"&&e[n][t]===i){r.data=e[n],r.index=n;break}return r}function FW(e=[],t,i){if(!e||!e.length||!t)return{indexs:[],datas:[]};let r={indexs:[],datas:[]};for(let n=0;n<e.length;n++)typeof e[n]=="object"&&e[n][t]===i&&(r.datas.push(e[n]),r.indexs.push(n));return r}function Bc(e=0,t=Number.MAX_SAFE_INTEGER){return Math.floor(Math.random()*(t-e+1))+e}function id(e=36){let t=[],i="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t[r]=i.substr(Math.floor(Math.random()*16),1);return t[14]&&(t[14]=String(Bc(1,9))),t[19]&&(t[19]=i.substr(+t[19]&3|8,1)),t[8]&&(t[8]=String(Bc(1,9))),t[13]&&(t[13]=String(Bc(1,9))),t[18]&&(t[18]=String(Bc(1,9))),t[23]&&(t[23]=String(Bc(1,9))),t.join("")}function cx(e,t=!0){return(i,r)=>{let n=i[e],s=r[e];return typeof n<"u"&&typeof s<"u"?t?n-s:s-n:0}}var UW=0;async function md(e,t,i,r=!0,n,s){let a=null,o="requestid"+ ++UW;n&&n(o);let l={user_uuid:e,path:t,type:i};s&&s(l);try{let c=await pt("GET","/api/categories",l,{headers:{path:t},searchParams:!0});if(c.success)return{...c,result:await gw(c.result,r)}}catch(c){a=c,console.error("Fetch Category List Error",c)}let u=a?a.msg||a.message:void 0;return{code:a?a.code:Ge.ERR_CODE.NORMAL,success:!1,result:null,msg:u||"Fetch Category List Error"}}async function HW(e=!0){let t=null;try{let r=await pt("POST","/api/open/deviceCate");if(r.success)return{...r,result:await gw(r.result,e)}}catch(r){t=r,console.error("Fetch Category List Error",r)}let i=t?t.msg||t.message:void 0;return{code:t?t.code:Ge.ERR_CODE.NORMAL,success:!1,result:null,msg:i||"Fetch Category List Error"}}async function gw(e,t=!0){let i=[],r=[],n=[],s={},a={};e.forEach(h=>{h.name&&(a[h.name]=h.name_cn||h.name)});let o=e.filter(h=>!h.parent_uuid),l=e.filter(h=>!!h.parent_uuid),u=[],c={};if(o.forEach((h,m)=>{u.push(h.uuid),n.push({name:h.name,name_cn:h.name_cn,title:h.name,titleAdditional:h.name_cn||h.name,disableTranslate:h.name_cn===""?!0:h.name_cn===h.name,id:h.uuid,children:[],order_no:+h.order_no||0,parentId:void 0,created_at:h.created_at,updated_at:h.updated_at}),s[h.uuid]=m}),l.forEach(h=>{u.push(h.uuid);let m=s[h.parent_uuid];if(typeof m<"u"&&n[m]){let f=n[m];f.children.push({name:h.name,name_cn:h.name_cn,title:h.name,titleAdditional:h.name_cn||h.name,disableTranslate:h.name_cn===""?!0:h.name_cn===h.name,id:h.uuid,order_no:+h.order_no||0,children:[],parentId:f.id,created_at:h.created_at,updated_at:h.updated_at})}c[h.uuid]=h.parent_uuid}),n.sort(cx("order_no")),n.forEach(h=>{h.children.length>1&&h.children.sort(cx("order_no"))}),n.forEach(h=>{i.push({...h})}),t){let h=(await Re.messageBus.rpcCall("I18nTranslateService",{str:Ge.CATEGORY_ITEM_ALL_TITLE})).message;i.unshift({title:Ge.CATEGORY_ITEM_ALL_TITLE,titleAdditional:h||Ge.CATEGORY_ITEM_ALL_TITLE,id:Ge.CATEGORY_ITEM_ALL_VALUE,order_no:Number.MAX_SAFE_INTEGER,disableTranslate:!1,children:[],parentId:void 0}),r.push(Ge.CATEGORY_ITEM_ALL_VALUE)}return{languageHashtable:a,treeData:i,selectedIds:r,categoryIds:u,childCategory2ParentCategoryMap:c,sourceCategoryList:e}}async function Ho(e){let{categories:t,type:i,uuid:r}=e,n=await md(r,r,i),s=n.result?n.result.treeData:[],a=[],o=[],l=[],u=[];for(let g=0;g<t.length;g++){let{parentName:y,childName:b,parent_order_no:E,child_order_no:S}=t[g];if(y){let v=ur(s,"title",y);if(v.index>=0){if(a.push({name:v.data.title,type:i,user_uuid:r,order_no:v.data.order_no,parent_uuid:void 0,uuid:v.data.id}),b){let T=ur(v.data.children,"title",b);if(T.index>=0){o.push({name:T.data.title,type:i,user_uuid:r,order_no:T.data.order_no,parent_uuid:v.data.id,uuid:T.data.id});continue}u.push({name:b,type:i,user_uuid:r,order_no:g+1,parent_uuid:v.data.id,uuid:void 0});continue}continue}let A=id(),x=id();l.push({name:y,type:i,user_uuid:r,order_no:typeof E<"u"?E:g+1,parent_uuid:void 0,uuid:A}),b&&u.push({name:b,type:i,user_uuid:r,order_no:typeof S<"u"?S:g+1,parent_uuid:A,uuid:x})}}let c=[];if(l.length){let g=await su(l,(y,b)=>{l[b].__remoteId=y.result.uuid});c=g.result?g.result.successList.map(y=>y.result):[]}let h=[];if(u.length){for(let y=0;y<u.length;y++){let b=ur(l,"uuid",u[y].parent_uuid);b.index>=0&&b.data.__remoteId&&(u[y].parent_uuid=b.data.__remoteId)}let g=await su(u);h=g.result?g.result.successList.map(y=>y.result):[]}let m=c.concat(a),f=h.concat(o);return{allParentCreated:m,allChildCreated:f}}async function yw(e){let{uuid:t,path:i,types:r,names:n}=e;return new Promise(async(s,a)=>{let o=await md(t,i,r,!1);if(o.code!==0){s({...o,code:Ge.ERR_CODE.NORMAL,success:!1,result:null});return}let l={detail:[],arguments:e},{treeData:u}=o.result;for(let c=0;c<n.length;c++){let h=n[c].primary,m=n[c].secondary,f={primary:{name:h,name_cn:"",uuid:"",exist:!1,undefine:!1},secondary:{name:m,name_cn:"",uuid:"",exist:!1,undefine:!1}};if(typeof h>"u"){f.primary.exist=!1,f.primary.undefine=!0;continue}let g=ur(u,"title",h);if(g.index<=-1){f.primary.exist=!1,f.secondary.exist=!1,l.detail.push(f);continue}if(f.primary.exist=!0,f.primary.uuid=g.data.id,f.primary.name_cn=g.data.titleAdditional||h,typeof m>"u"){f.secondary.exist=!1,f.secondary.undefine=!0,l.detail.push(f);continue}let y=ur(g.data.children,"title",m);if(y.index<=-1){f.secondary.exist=!1,l.detail.push(f);continue}f.secondary.exist=!0,f.secondary.uuid=y.data.id,f.secondary.name_cn=y.data.titleAdditional||m,l.detail.push(f)}s({code:0,success:!0,result:l})})}function jW(e){let t=new Map,i=[];for(let r of e)(!t.has(r.primary)||t.get(r.primary)!==r.secondary)&&(t.set(r.primary,r.secondary),i.push(r));return i}async function YW(e,t,i,r=!1){let n=await yw(e),s=[],a=[],o=[],l=[],u=[];if(!r&&n.success&&n.result.detail.length){let h=new Map,m=new Map,f=new Map;n.result.detail.forEach((g,y)=>{(g.primary.name||g.primary.name_cn)&&!g.primary.exist&&!h.has(g.primary.name||g.primary.name_cn)&&(h.set(g.primary.name||g.primary.name_cn,!0),s.push({name:g.primary.name||g.primary.name_cn,type:t,user_uuid:i,order_no:0})),(g.primary.name||g.primary.name_cn)&&!g.primary.exist&&(g.secondary.name||g.secondary.name_cn)&&!g.secondary.exist&&m.get(g.secondary.name||g.secondary.name_cn)!==(g.primary.name||g.primary.name_cn)?(m.set(g.secondary.name||g.secondary.name_cn,g.primary.name||g.primary.name_cn),a.push({name:g.secondary.name||g.secondary.name_cn,type:t,user_uuid:i,uuid:g.secondary.uuid,order_no:0,parent_uuid:g.primary.uuid,parent_title:g.primary.name||g.primary.name_cn})):g.primary.exist&&(g.secondary.name||g.secondary.name_cn)&&!g.secondary.exist&&m.get(g.secondary.name||g.secondary.name_cn)!==(g.primary.name||g.primary.name_cn)&&(m.set(g.secondary.name||g.secondary.name_cn,g.primary.name||g.primary.name_cn),a.push({name:g.secondary.name||g.secondary.name_cn,type:t,user_uuid:i,uuid:g.secondary.uuid,order_no:0,parent_uuid:g.primary.uuid,parent_title:g.primary.name||g.primary.name_cn})),g.primary.exist&&!f.has(g.primary.uuid)&&(f.set(g.primary.uuid,g.primary.name||g.primary.name_cn),u.push({title:g.primary.name||g.primary.name_cn,uuid:g.primary.uuid,parent_uuid:""})),g.secondary.exist&&!f.has(g.secondary.uuid)&&(f.set(g.secondary.uuid,g.secondary.name||g.secondary.name_cn),u.push({title:g.secondary.name||g.secondary.name_cn,uuid:g.secondary.uuid,parent_uuid:g.primary.uuid}))})}if(!r&&s.length){let h=await su(s);if(h.success&&h.result.successList.length&&(o=h.result.successList.map(m=>m.result),a.forEach(m=>{o.forEach(f=>{!m.parent_uuid&&m.parent_title===f.name&&(m.parent_uuid=f.uuid)})})),a.length){let m=await su(a);m.success&&m.result.successList.length&&(l=m.result.successList.map(f=>f.result))}}else if(!r&&a.length){let h=await su(a);h.success&&h.result.successList.length&&(l=h.result.successList.map(m=>m.result))}let c=[];return c=o.map(h=>({uuid:h.uuid,title:h.name,name:h.name,parent_uuid:h.parent_uuid})),c=c.concat(l.map(h=>({uuid:h.uuid,parent_uuid:h.parent_uuid,title:h.name,name:h.name}))),c=c.concat(u),c}async function GW(e,t){let i=[],r=[],n=async o=>{let{message:l}=await Re.messageBus.rpcCall(ua.TAG.DELETE,o);return l},s=null;try{for(let o=0;o<e.length;o++){let l=await n({...e[o],path:e[o].user_uuid});if(l.code===0&&l.success){let c={...l,message:"",result:{...e[o],path:e[o].user_uuid,...l.result[0]}};i.push(c),t&&t(c,o);continue}let u={...l,result:{...e[o]}};r.push(u)}return{code:0,success:!0,result:{successList:i,failList:r},message:""}}catch(o){s=o}let a=s?s.msg||s.message:"Del Categories Batch Error";return{code:s?s.code:Ge.ERR_CODE.NORMAL,success:!1,result:null,message:a}}async function WW(e){let{uuid:t,path:i,types:r,ids:n}=e;return new Promise(async(s,a)=>{let o=await md(t,i,r,!1);if(o.code!==0){s({...o,code:Ge.ERR_CODE.NORMAL,success:!1,result:null});return}let l={detail:[],arguments:e},{treeData:u}=o.result;for(let c=0;c<n.length;c++){let h=n[c].primary,m=n[c].secondary,f={primary:{name:"",name_cn:"string",uuid:h,exist:!1,undefine:!1},secondary:{name:"",name_cn:"string",uuid:m,exist:!1,undefine:!1}};if(typeof h>"u"){f.primary.exist=!1,f.primary.undefine=!0;continue}let g=ur(u,"id",h);if(g.index<=-1){f.primary.exist=!1,f.secondary.exist=!1,l.detail.push(f);continue}if(f.primary.exist=!0,f.primary.name=g.data.title,f.primary.name_cn=g.data.titleAdditional||f.primary.name,typeof m>"u"){f.secondary.exist=!1,f.secondary.undefine=!0;continue}let y=ur(g.data.children,"id",m);if(y.index<=-1){f.secondary.exist=!1,l.detail.push(f);continue}f.secondary.exist=!0,f.secondary.name=y.data.title,f.secondary.name_cn=y.data.titleAdditional||f.secondary.name,l.detail.push(f)}s({code:0,success:!0,result:l})})}var zW=class{constructor(){this._actuatorMap=new Map}clearAll(){this._actuatorMap.clear()}async addActuator(e,t,i,r){let n=e.filter(h=>!!h),s=`${n[0]}_${t[0]||0}_${i}_${r}`,a=`${n[0]}_${n[1]}_${t[1]||t[0]||0}_${i}_${r}`;if(!n[1]){if(this._actuatorMap.has(s))return this._actuatorMap.get(s);let h=new Promise(async(m,f)=>{let g=await Ho({categories:[{parentName:n[0],parent_order_no:t[0]||0}],type:[r],uuid:i});m({uuids:g.allParentCreated.map(y=>y.uuid),titles:g.allParentCreated.map(y=>y.name)}),this._actuatorMap.delete(s)});return this._actuatorMap.set(s,h),h}let o=this._actuatorMap.get(s);o||(o=new Promise(async(h,m)=>{let f=await Ho({categories:[{parentName:n[0],parent_order_no:t[0]||0}],type:[r],uuid:i});h({uuids:f.allParentCreated.map(g=>g.uuid),titles:f.allParentCreated.map(g=>g.name)}),this._actuatorMap.delete(s)}),this._actuatorMap.set(s,o));let l=await o,u=this._actuatorMap.get(a);u||(u=new Promise(async(h,m)=>{let f=await Ho({categories:[{parentName:n[0],childName:n[1],parent_order_no:t[0]||0,child_order_no:t[1]||t[0]||0}],type:[r],uuid:i});h({uuids:f.allChildCreated.map(g=>g.uuid),titles:f.allChildCreated.map(g=>g.name)}),this._actuatorMap.delete(a)}),this._actuatorMap.set(a,u));let c=await u;return{uuids:[l.uuids[0],c.uuids[0]],titles:[l.titles[0],c.titles[0]]}}};async function VW(e,t){let i=[],r=[],n=async o=>{let{message:l}=await Re.messageBus.rpcCall(ua.TAG.UPDATE,o);return l},s=null;try{for(let o=0;o<e.length;o++){let l=await n({...e[o],path:e[o].user_uuid});if(l.code===0&&l.success){let c={...l,message:"",result:{...e[o],path:e[o].user_uuid,...l.result[0]}};i.push(c),t&&t(c,o);continue}let u={...l,result:{...e[o]}};r.push(u)}return{code:0,success:!0,result:{successList:i,failList:r},message:""}}catch(o){s=o}let a=s?s.msg||s.message:"Update Categories Batch Error";return{code:s?s.code:Ge.ERR_CODE.NORMAL,success:!1,result:null,message:a}}var $i,$o=($i=class{},$i.categoryAddtition=new zW,$i.fetchCategoryList=md,$i.fetchInternalCategoryList=HW,$i.addCategoriesBatch=su,$i.deleteCategoriesBatch=GW,$i.updateCategoriesBatch=VW,$i.addCategoriesBatchByNameArray=Ho,$i.queryCategoryBatchByNames=yw,$i.queryCategoryBatchByIds=WW,$i.formatRepeatCategoryArr=jW,$i.bindAndCreateCategory=YW,$i.getCategoryNamesByTags=Xa,$i);async function Xa(e,t,i){if(!e)return[];if(e instanceof Array)return e;let r=Jo(e);if(r=r.filter(u=>!!u),!r.length)return[];let n=(await Re.messageBus.rpcCall("LocaleCurrFetch",{})).message||"en",s=await md(t,t,i),a=s.result?s.result.sourceCategoryList:[],o=typeof r[1]<"u",l=[];for(let u=0;u<a.length;u++)if(a[u].name===r[0]||a[u].name_cn===r[0]){l.push(n=="en"?a[u].name:a[u].name_cn||a[u].name);break}if(o){for(let u=0;u<a.length;u++)if(a[u].name===r[1]||a[u].name_cn===r[1]){l.push(n=="en"?a[u].name:a[u].name_cn||a[u].name);break}}return l}async function qW(e,t,i){let r=null,n=null,s=[],a=[],o=!1,l,u;if(e)if("data"in e)r=e.data,r.tags&&(r.tags instanceof Array?a=r.tags:a=Jo(r.tags));else{if(!e.uuid||!e.path)throw new he("PARAMETER_VERIFICATION","missing 3d-model uuid or path data.");l=e.uuid,u=e.path,n=await Ht.getD3Model({isProject:e.isProject,uuid:e.uuid,path:e.path}),n&&(n.title=n.display_title,a=await Xa(n.tags,e.path,[5]))}if(!i){let c=await $o.categoryAddtition.addActuator(a,[0],t,5);s=c.uuids,a=c.titles}return{d3modelItemOriginUuid:l,d3modelItemOriginPath:u,d3modelItemIn:r,d3modelItemOut:n,d3modelTagIds:s,d3modelTagTitles:a}}async function XW(e){let{d3modelItemIn:t,d3modelItemOut:i,d3modelTagIds:r,d3modelTagTitles:n}=await qW(e.d3model,e.path,e.isProject),s=t||i;if(!s)throw new he("PARAMETER_VERIFICATION","missing 3d-model data.");kW(s.title),"path"in e.d3model&&e.d3model.override&&vr(s,e.d3model.override);let a=await pt("POST","/api/v2/components/add",JSON.stringify({...s,tags:r,owner:e.path}),{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(a.code===0&&a.success){let l=a.result,u=await Xn(l);return{title:l.title,description:l.description,path:l.path||e.path,docType:l.docType,uuid:l.uuid,version:l.version,ticket:l.ticket,updateTime:l.updateTime,createTime:l.createTime,display_title:l.display_title,creator:Gt(l.creator),modifier:Wt(l.modifier),owner:zt(l.owner),tags:l.tags,source:l.source,dataStrId:l.dataStrId,dataStr:u}}if(a.code===1000001)throw new he("CREATE_D3MODEL_DUP_TITLE",a.result);if(a.code===422)throw new he("CREATE_D3MODEL_PERMISSIONS",a.result);let o=a.message||a.msg||"Request Error.";throw new he("CREATE_D3MODEL",o)}async function pf(e=!1,t,i,r,n,s,a){let o=t.toLocaleLowerCase(),l=a?!!a.forceAsSymbol:!1,u=[];try{return(l||r&&[2,18,19,20,21,22,25,31,7,32,6].indexOf(r)>=0)&&(u=(await Ht.getSymbolSearchList({isProject:e,uid:i,path:i,page:1,pageSize:void 0,wd:o,exactMatch:n,docType:[r]})).lists),r===28&&(u=(await Ht.getDeviceSearchList({isProject:e,uid:i,path:i,page:1,pageSize:void 0,wd:o,exactMatch:n,query:{userId:s}})).lists),r===4&&(u=(await Ht.getFootprintSearchList({isProject:e,uid:i,path:i,page:1,pageSize:void 0,wd:o,exactMatch:n,query:{userId:s}})).lists),r===16&&(u=(await Ht.getD3ModelSearchList({isProject:e,uid:i,path:i,page:1,pageSize:void 0,wd:o,exactMatch:n})).lists),{code:0,success:!0,result:u,message:""}}catch(c){return console.error(c),{code:-1,success:!1,result:[],message:c instanceof he?`${String(c.action)}|${String(c.message)}`:c.message||"QueryComponentsByTitle call error."}}}function dx(e,t){return e.path==t}function hx(e){try{let t=JSON.parse(e);return{parentName:t[0],childName:t[1]}}catch{return{parentName:"",childName:""}}}function JW(e){let t={};return t["device-owner"]=e.userIdSelected,t["device-lib"]=e.userIdSelected,t["footprint-name"]=e.footprintItem?e.footprintItem.display_title:"",t["symbol-name"]=e.symbolItem?e.symbolItem.display_title:"",t["new-symbol"]=e.isNeedCreateSymbolAndAssocia,t}function _w(e,t){typeof e.footprintItemId<"u"&&(t.Footprint=e.footprintItemId),typeof e.symbolItemId<"u"&&(t.Symbol=e.symbolItemId)}async function bw(e,t){let i=JW(e),r=e.footprintItem,n=e.symbolItem,s={},a=async(v,A)=>{let x="",T="",R=!1,L=t==="zh-hans",O=v.parent_tag,H=v.child_tag;if(O&&O.uuid&&(R=!0,x=L&&O.name_cn||O.name),R&&H.uuid){let k=L&&H.name_cn||H.name;x+=`:${k}`}if(x){let k=x.split(":")[0],ee=x.split(":")[1],q=await Ho({categories:ee?[{parentName:k,childName:ee}]:[{parentName:k}],type:[+A],uuid:i["device-owner"]}),Q=q.allParentCreated[0]?q.allParentCreated[0].uuid:void 0,ne=q.allChildCreated[0]?q.allChildCreated[0].uuid:void 0;Q&&(T=ne?[Q,ne]:[Q])}return T},o={"file-owner":i["device-owner"],"file-name":i["footprint-name"],"file-describe":"","file-category":await a((r==null?void 0:r.tags)||{},4),"file-lib":i["device-lib"],"file-customTags":[]};if(r&&(r!=null&&r.custom_tags)&&!(o!=null&&o["file-category"])){let{parentName:v,childName:A}=hx(r.custom_tags);if(v){let x=await Ho({categories:A?[{parentName:v,childName:A}]:[{parentName:v}],type:[4],uuid:i["device-owner"]}),T=x.allParentCreated[0]?x.allParentCreated[0].uuid:void 0,R=x.allChildCreated[0]?x.allChildCreated[0].uuid:void 0;T&&(o["file-customTags"]=R?[T,R]:[T])}}let l={"file-owner":i["device-owner"],"file-name":i["symbol-name"],"file-describe":"","file-category":await a((n==null?void 0:n.tags)||{},2),"file-lib":i["device-lib"],"file-customTags":[]};if(n&&(n!=null&&n.custom_tags)&&!l["file-category"]){let{parentName:v,childName:A}=hx(n.custom_tags);if(v){let x=await Ho({categories:A?[{parentName:v,childName:A}]:[{parentName:v}],type:[4],uuid:i["device-owner"]}),T=x.allParentCreated[0]?x.allParentCreated[0].uuid:void 0,R=x.allChildCreated[0]?x.allChildCreated[0].uuid:void 0;T&&(l["file-customTags"]=R?[T,R]:[T])}}let u,c,h,m,f=!1,g=!1,y=!1;async function b(){if(i["footprint-name"])if(dx(r,i["device-owner"]||i["device-lib"]))h=r,u=null;else{let v=await pf(!1,o["file-name"],i["device-lib"],4,!0);v.result.length<=0||(g=!0,h=r,u=v.result)}else h=null,u=null}async function E(){if(!i["new-symbol"]&&i["symbol-name"]&&n)if(dx(n,i["device-owner"]||i["device-lib"]))m=n,c=null;else{let v=await pf(!1,l["file-name"],i["device-lib"],n.docType,!0);v.result.length<=0||(f=!0,c=v.result,m=n)}else m=null,c=null}await b(),await E();let S={isNeedConfirm:!1,updateCache:s,formData:i,newFootPrint:u,oldFootPrint:h,newSymbol:c,oldSymbol:m,confirmRes:e};return!f&&!g&&!y?(S.isNeedConfirm=!1,S):(S.isNeedConfirm=!0,S)}async function E0(e,t,i,r){let n=null,s=null,a=[],o=[],l=!1,u,c;if(e)if("data"in e)e.data&&(n=e.data,n.tags&&(n.tags instanceof Array?o=n.tags:o=Jo(n.tags)));else{if(!e.uuid||!e.path)throw new he("PARAMETER_VERIFICATION","missing footprint uuid or path data.");u=e.uuid,c=e.path,s=await Ht.getFootprint({isProject:e.isProject,uuid:e.uuid,path:e.path}),s&&(s.title=s.display_title,r&&Array.isArray(r)?o=r:o=await Xa(s.tags,e.path,[4]))}if(!i){let h=await $o.categoryAddtition.addActuator(o,[0],t,4);a=h.uuids,o=h.titles}return{footprintItemOriginUuid:u,footprintItemOriginPath:c,footprintItemIn:n,footprintItemOut:s,footprintTagIds:a,footprintTagTitles:o}}async function S0(e,t,i,r){let n=null,s=null,a=[],o=[],l=!1,u,c;if(e)if("data"in e)e.data&&(n=e.data,n.tags&&(n.tags instanceof Array?o=n.tags:o=Jo(n.tags)));else{if(!e.uuid||!e.path)throw new he("PARAMETER_VERIFICATION","missing symbol uuid or path data.");u=e.uuid,c=e.path,s=await Ht.getSymbol({isProject:e.isProject,uuid:e.uuid,path:e.path}),s&&(s.title=s.display_title,r&&Array.isArray(r)?o=r:o=await Xa(s.tags,e.path,[2])),l=e.isProject}if(!i){let h=await $o.categoryAddtition.addActuator(o,[0],t,2);a=h.uuids,o=h.titles}return{symbolItemOriginUuid:u,symbolItemOriginPath:c,symbolItemIn:n,symbolItemOut:s,symbolTagIds:a,symbolTagTitles:o}}async function Pw(e,t,i,r){let n=null,s=null,a=[],o=[],l=!1;if(e)if("data"in e)e.data&&(n=e.data,n.tags&&(n.tags instanceof Array?o=n.tags:o=Jo(n.tags)));else{if(!e.uuid||!e.path)throw new he("PARAMETER_VERIFICATION","missing device uuid or path data.");s=await Ht.getDevice({isProject:e.isProject,uuid:e.uuid,path:e.path}),s&&(s.title=s.display_title,r&&Array.isArray(r)?o=r:o=await Xa(s.tags,e.path,[3])),l=e.isProject}if(!i){let u=await $o.categoryAddtition.addActuator(o,[0],t,3);a=u.uuids,o=u.titles}return{deviceItemIn:n,deviceItemOut:s,deviceTagIds:a,deviceTagTitles:o,isDeviceFromProject:l}}async function Ew(e,t,i,r,n,s){let a=null,o=null,l=[],u=[],c,h;if(e){let{symbolItemIn:m,symbolItemOut:f,symbolTagIds:g,symbolTagTitles:y,symbolItemOriginUuid:b,symbolItemOriginPath:E}=await S0(e,i,r,"path"in e&&e.override&&Array.isArray(e.override.tags)?e.override.tags:void 0);a=m,o=f,l=g,u=y,c=b,h=E}else if(n)if(s){let m=await Ht.getSymbol({isProject:t,uuid:n,path:s});if(c=n,h=s,m){m.title=m.display_title,o=m,u=await Xa(m.tags,s,[2]);let f=await $o.categoryAddtition.addActuator(u,[0],i,2);l=f.uuids,u=f.titles}}else{let m=null;try{m=await Ht.getSymbol({isProject:t,uuid:n,path:i}),c=n,h=i}catch(f){m=null,c=n,h=i,console.warn(f)}m||console.warn("[NOSYMBOL_ON_TARGETPATH_BY_DEVICE_BOUND]: the symbol bound to this device does not exist in the target library.")}return{symbolItemOriginUuid:c,symbolItemOriginPath:h,symbolItemIn:a,symbolItemOut:o,symbolTagIds:l,symbolTagTitles:u}}async function Sw(e,t,i,r,n,s){let a=null,o=null,l=[],u=[],c,h;if(e){let{footprintItemIn:m,footprintItemOut:f,footprintTagIds:g,footprintTagTitles:y,footprintItemOriginUuid:b,footprintItemOriginPath:E}=await E0(e,i,r,"path"in e&&e.override&&Array.isArray(e.override.tags)?e.override.tags:void 0);a=m,o=f,l=g,u=y,c=b,h=E}else if(n)if(s){let m=await Ht.getFootprint({isProject:t,uuid:n,path:s});if(c=n,h=s,m){m.title=m.display_title,o=m,u=await Xa(m.tags,s,[4]);let f=await $o.categoryAddtition.addActuator(u,[0],i,4);l=f.uuids,u=f.titles}}else{let m=null;try{m=await Ht.getFootprint({isProject:t,uuid:n,path:i}),c=n,h=i}catch(f){m=null,c=n,h=i,console.warn(f)}m||console.warn("[NOFOOTPRINT_ON_TARGETPATH_BY_DEVICE_BOUND]: the footprint bound to this device does not exist in the target library.")}return{footprintItemOriginUuid:c,footprintItemOriginPath:h,footprintItemIn:a,footprintItemOut:o,footprintTagIds:l,footprintTagTitles:u}}async function Ko(e=!1,t,i,r,n=[]){let s={isDuplicate:!1,path:r,uuids:[]},a=i.toLocaleLowerCase(),o=await pf(e,a,r,t,!0,Re.loginedUserUuid);if(o.success&&o.result&&o.result.length){let l=[];for(let u=0;u<o.result.length;u++){if(n.indexOf(o.result[u].uuid)>=0)continue;let c=(o.result[u].title||o.result[u].display_title).toLocaleLowerCase();if(a===c&&o.result[u].path===r){if(typeof t>"u"||t===28){l.push(o.result[u]);continue}if(typeof o.result[u].docType>"u"){l.push(o.result[u]);continue}if(o.result[u].docType===t){l.push(o.result[u]);continue}}}for(let u=0;u<l.length;u++)s.uuids.push(l[u].uuid);s.isDuplicate=!!s.uuids.length}return s}async function vw(e,t,i,r,n,s){if(!r)return;let a=null;if("data"in r)n.title&&(a=await Ht.createSymbol({isProject:e,path:t,symbol:{data:{...n,tags:s},ignoreDuplicateNameCheck:r.ignoreDuplicateNameCheck}})),i.attributes&&a&&typeof a=="object"&&(i.attributes.Symbol=a.uuid);else{r.override&&vr(n,r.override);try{a=await Ht.getSymbol({isProject:e,path:t,uuid:r.uuid})}catch{a=null}if(a&&typeof a=="object")i.attributes&&(i.attributes.Symbol=a.uuid);else if(n.title&&(a=await Ht.createSymbol({isProject:e,path:t,symbol:{data:{...n,tags:s},ignoreDuplicateNameCheck:r.ignoreDuplicateNameCheck}})),i.attributes&&a&&typeof a=="object"){i.attributes.Symbol=a.uuid;let o=await As({origin:{docType:n.docType,isProject:r.isProject,uuid:r.uuid,path:r.path},target:{docType:a.docType,isProject:e,uuid:a.uuid,path:a.path}});if(!o.success)throw new he("CREATE_SYMBOL_MIGRATE_CANVAS_ERROR",o.message||"migrate canvas error.")}}}async function Iw(e,t,i,r,n,s){if(!r)return;let a=null;if("data"in r)n.title&&(a=await Ht.createFootprint({isProject:e,path:t,footprint:{data:{...n,tags:s}}})),i.attributes&&a&&typeof a=="object"&&(i.attributes.Footprint=a.uuid);else{r.override&&vr(n,r.override);try{a=await Ht.getFootprint({isProject:e,path:t,uuid:r.uuid})}catch{a=null}if(a&&typeof a=="object")i.attributes&&(i.attributes.Footprint=a.uuid);else if(n.title&&(a=await Ht.createFootprint({isProject:e,path:t,footprint:{data:{...n,tags:s}}})),i.attributes&&a&&typeof a=="object"){i.attributes.Footprint=a.uuid;let o=await As({origin:{docType:n.docType,isProject:r.isProject,uuid:r.uuid,path:r.path},target:{docType:a.docType,isProject:e,uuid:a.uuid,path:a.path}});if(!o.success)throw new he("CREATE_FOOTPRINT_MIGRATE_CANVAS_ERROR",o.message||"migrate canvas error.")}}}async function $W(e){let{deviceItemIn:t,deviceItemOut:i,deviceTagIds:r,deviceTagTitles:n,isDeviceFromProject:s}=await Pw(e.device,e.path,e.isProject,"path"in e.device&&e.device.override&&Array.isArray(e.device.override.tags)?e.device.override.tags:void 0),a=t||i;if(!a)throw new he("PARAMETER_VERIFICATION","missing device data.");if(a.title=e.symbol&&"path"in e.symbol&&e.symbol.override&&Cf(e.symbol.override,"title")||a.title,hw(a.title),(await Ko(e.isProject,28,a.title,e.path)).isDuplicate)throw new he("DEVICE_SAME_NAMA_EXISTS","{libName} duplicate name or illegal name: {componentName}");let{symbolItemIn:o,symbolItemOut:l,symbolTagIds:u,symbolTagTitles:c,symbolItemOriginUuid:h,symbolItemOriginPath:m}=await Ew(e.symbol,s,e.path,e.isProject,a.attributes?a.attributes.Symbol:void 0,"data"in e.device?void 0:e.device.path),f=o||l,g=!!(e.symbol&&"data"in e.symbol);a.attributes&&l&&typeof l=="object"&&(a.attributes.Symbol=l.uuid),e.symbol&&"path"in e.symbol&&e.symbol.override&&vr(f,e.symbol.override);let{footprintItemIn:y,footprintItemOut:b,footprintTagIds:E,footprintTagTitles:S,footprintItemOriginUuid:v,footprintItemOriginPath:A}=await Sw(e.footprint,s,e.path,e.isProject,a.attributes?a.attributes.Footprint:void 0,"data"in e.device?void 0:e.device.path),x=y||b;e.footprint&&"path"in e.footprint&&e.footprint.override&&vr(x,e.footprint.override),a.attributes&&b&&typeof b=="object"&&(a.attributes.Footprint=b.uuid);let T=!1,R=!1,L=await bw({symbolItem:f,footprintItem:x,userIdSelected:e.path,isNeedCreateSymbolAndAssocia:g},void 0);if(L.isNeedConfirm){let k=(await Re.messageBus.rpcCall("OpenSameNameSaveAsDlgService",{...L},31536e8)).message;if(!k){let ee="an exception occurred while executing the cross-bind program.";throw new he("CROSS_BIND",ee)}if(k.action==="cancel"||k.action==="close"){let ee="quit operate while executing the cross-bind program.";throw new he("CROSS_BIND_EXIT",ee)}L.updateCache=k.data,a.attributes&&Object.keys(L.updateCache).length&&(L.updateCache.symbolItemId&&(T=!0),L.updateCache.footprintItemId&&(R=!0),_w(L.updateCache,a.attributes))}T||await vw(e.isProject,e.path,a,e.symbol,f,c),!R&&x&&await Iw(e.isProject,e.path,a,e.footprint,x,S),"path"in e.device&&e.device.override&&(delete e.device.override.tags,vr(a,e.device.override));let O=await pt("POST","/api/devices",{...a,tags:r,owner:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(O.code===0&&O.success){let k=O.result;return{path:k.path||e.path,title:k.title,description:k.description,attributes:k.attributes,images:k.images,uuid:k.uuid,version:k.version,ticket:k.ticket,updateTime:k.updateTime,createTime:k.createTime,display_title:k.display_title,creator:Gt(k.creator),modifier:Wt(k.modifier),owner:zt(k.owner),tags:k.tags,source:k.source}}let H=O.message||O.msg||"Request Error.";throw O.code===1000001?new he("CREATE_DEVICE_DUP_TITLE",H):O.code===422?new he("CREATE_DEVICE_PERMISSIONS",H):new he("CREATE_DEVICE",H)}async function KW(e){let{footprintItemIn:t,footprintItemOut:i,footprintTagIds:r,footprintTagTitles:n}=await E0(e.footprint,e.path,e.isProject,"path"in e.footprint&&e.footprint.override&&Array.isArray(e.footprint.override.tags)?e.footprint.override.tags:void 0),s=t||i;if(!s)throw new he("PARAMETER_VERIFICATION","missing footprint data.");if(s.title="path"in e.footprint&&e.footprint.override&&Cf(e.footprint.override,"title")||s.title,fw(s.title),(await Ko(e.isProject,4,s.title,e.path)).isDuplicate)throw new he("FOOTPRINT_SAME_NAMA_EXISTS","{libName} duplicate name or illegal name: {componentName}");"path"in e.footprint&&e.footprint.override&&(delete e.footprint.override.tags,vr(s,e.footprint.override));let a=await pt("POST","/api/v2/components/add",{title:s.title,tags:r,docType:s.docType||4,description:s.description,owner:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(a.code===0&&a.success){let l=a.result;if(!("data"in e.footprint)&&e.footprint.uuid&&e.footprint.path){let u=await As({origin:{docType:s.docType,isProject:!!e.footprint.isProject,uuid:e.footprint.uuid,path:e.footprint.path},target:{docType:l.docType,isProject:!1,uuid:l.uuid,path:l.path}});if(!u.success)throw new he("CREATE_FOOTPRINT_MIGRATE_CANVAS_ERROR",u.message||"migrate canvas error.")}return{title:l.title,description:l.description,path:l.path||e.path,docType:l.docType,uuid:l.uuid,version:l.version,ticket:l.ticket,updateTime:l.updateTime,createTime:l.createTime,display_title:l.display_title,creator:Gt(l.creator),modifier:Wt(l.modifier),owner:zt(l.owner),tags:l.tags,source:l.source}}let o=a.message||a.msg||"Request Error.";throw a.code===1000001?new he("CREATE_FOOTPRINT_DUP_TITLE",o):a.code===422?new he("CREATE_FOOTPRINT_PERMISSIONS",o):new he("CREATE_FOOTPRINT",o)}async function Aw(e,t,i,r){let n=null,s=null,a=[],o=[],l=!1,u,c;if(e)if("data"in e)n=e.data,n.tags&&(n.tags instanceof Array?o=n.tags:o=Jo(n.tags));else{if(!e.uuid||!e.path)throw new he("PARAMETER_VERIFICATION","missing simModel uuid or path data.");u=e.uuid,c=e.path,s=await Ht.getSimModel({isProject:e.isProject,uuid:e.uuid,path:e.path}),s&&(s.title=s.display_title,r&&Array.isArray(r)?o=r:o=await Xa(s.tags,e.path,[6]))}if(!i){let h=await $o.categoryAddtition.addActuator(o,[0],t,6);a=h.uuids,o=h.titles}return{simModelItemOriginUuid:u,simModelItemOriginPath:c,simModelItemIn:n,simModelItemOut:s,simModelTagIds:a,simModelTagTitles:o}}async function ZW(e){let{simModelItemIn:t,simModelItemOut:i,simModelTagIds:r,simModelTagTitles:n}=await Aw(e.simModel,e.path,e.isProject,"path"in e.simModel&&e.simModel.override&&Array.isArray(e.simModel.override.tags)?e.simModel.override.tags:void 0),s=t||i;if(!s)throw new he("PARAMETER_VERIFICATION","missing sim-model data.");if(s.title="path"in e.simModel&&e.simModel.override&&Cf(e.simModel.override,"title")||s.title,mw(s.title),(await Ko(e.isProject,s.docType,s.title,e.path)).isDuplicate)throw new he("SIM_MODEL_SAME_NAMA_EXISTS","{libName} duplicate name or illegal name: {componentName}");"path"in e.simModel&&e.simModel.override&&(delete e.simModel.override.tags,vr(s,e.simModel.override));let a=await pt("POST","/api/v2/components/add",{...s,tags:r,owner:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(a.code===0&&a.success){let l=a.result;return{title:l.title,path:l.path||e.path,docType:l.docType,uuid:l.uuid,version:l.version,ticket:l.ticket,updateTime:l.updateTime,createTime:l.createTime,display_title:l.display_title,creator:Gt(l.creator),modifier:Wt(l.modifier),owner:zt(l.owner),tags:l.tags,source:l.source,dataStr:await Xn(l),key:l.key,iv:l.iv,dataStrId:l.dataStrId}}if(a.code===1000001)throw new he("CREATE_SIM_MODEL_DUP_TITLE",a.message);if(a.code===422)throw new he("CREATE_SIM_MODEL_PERMISSIONS",a.result);let o=a.message||a.msg||"Request Error.";throw new he("CREATE_SIM_MODEL",o)}async function QW(e){let{symbolItemIn:t,symbolItemOut:i,symbolTagIds:r,symbolTagTitles:n}=await S0(e.symbol,e.path,e.isProject,"path"in e.symbol&&e.symbol.override&&Array.isArray(e.symbol.override.tags)?e.symbol.override.tags:void 0),s=t||i;if(!s)throw new he("PARAMETER_VERIFICATION","missing symbol data.");if(s.title="path"in e.symbol&&e.symbol.override&&Cf(e.symbol.override,"title")||s.title,pw(s.title),(await Ko(e.isProject,s.docType,s.title,e.path)).isDuplicate)throw new he("SYMBOL_SAME_NAMA_EXISTS","{libName} duplicate name or illegal name: {componentName}");"path"in e.symbol&&e.symbol.override&&(delete e.symbol.override.tags,vr(s,e.symbol.override));let a=await pt("POST","/api/v2/components/add",{title:s.title,tags:r,docType:s.docType,description:s.description,owner:e.path,ignoreDuplicateNameCheck:e.symbol.ignoreDuplicateNameCheck},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(a.code===0&&a.success){let l=a.result;if(!("data"in e.symbol)&&e.symbol.uuid&&e.symbol.path){let u=await As({origin:{docType:s.docType,isProject:!!e.symbol.isProject,uuid:e.symbol.uuid,path:e.symbol.path},target:{docType:l.docType,isProject:!1,uuid:l.uuid,path:l.path}});if(!u.success)throw new he("CREATE_SYMBOL_MIGRATE_CANVAS_ERROR",u.message||"migrate canvas error.")}return{title:l.title,description:l.description,docType:l.docType,path:l.path||e.path,uuid:l.uuid,version:l.version,ticket:l.ticket,updateTime:l.updateTime,createTime:l.createTime,display_title:l.display_title,creator:Gt(l.creator),modifier:Wt(l.modifier),owner:zt(l.owner),tags:l.tags,source:l.source}}let o=a.message||a.msg||"Request Error.";throw a.code===1000001?new he("CREATE_SYMBOL_DUP_TITLE",o):a.code===422?new he("CREATE_SYMBOL_PERMISSIONS",o):new he("CREATE_SYMBOL",o)}async function ez(e){let t=await pt("GET",`/api/v2/devices/${e.uuid}`,{uuid:e.uuid,path:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(t.code===0&&t.success&&typeof t.result=="object"){let r=t.result;if(typeof r.path<"u"&&r.path!==e.path)throw new he("GET_DEVICE_NOT_FOUND","data not found");return{path:r.path,title:r.title,description:r.description,attributes:r.attributes,images:r.images,uuid:r.uuid,version:r.version,ticket:r.ticket,updateTime:r.updateTime*1e3,createTime:r.createTime*1e3,display_title:r.display_title,creator:Gt(r.creator),modifier:Wt(r.modifier),owner:zt(r.owner),tags:r.tags,source:r.source}}let i=t.message||t.msg||"Request Error.";throw new he("GET_DEVICE",i)}async function tz(e){let t=await pt("GET",`/api/v2/components/${e.uuid}`,{uuid:e.uuid,path:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(t.code===0&&t.success&&typeof t.result=="object"){let r=t.result;if(typeof r.path<"u"&&r.path!==e.path)throw new he("GET_FOOTPRINT_NOT_FOUND","data not found");return{title:r.title,description:r.description,path:r.path,docType:r.docType,uuid:r.uuid,version:r.version,ticket:r.ticket,updateTime:r.updateTime*1e3,createTime:r.createTime*1e3,display_title:r.display_title,creator:Gt(r.creator),modifier:Wt(r.modifier),owner:zt(r.owner),tags:r.tags,source:r.source,has_device:r.has_device,dataStr:await Xn(r),dataStrId:r.dataStrId}}let i=t.message||t.msg||"Request Error.";throw new he("GET_FOOTPRINT",i)}async function iz(e){let t=await pt("GET",`/api/v2/components/${e.uuid}`,{uuid:e.uuid,path:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(t.code===0&&t.success&&typeof t.result=="object"){let r=t.result;return{title:r.title,path:r.path,docType:r.docType,uuid:r.uuid,version:r.version,ticket:r.ticket,updateTime:r.updateTime*1e3,createTime:r.createTime*1e3,display_title:r.display_title,creator:Gt(r.creator),modifier:Wt(r.modifier),owner:zt(r.owner),tags:r.tags,source:r.source,key:r.key,iv:r.iv,dataStr:await Xn(r),dataStrId:r.dataStrId}}let i=t.message||t.msg||"Request Error.";throw new he("GET_SIM_MODEL",i)}function Ja(e={}){let t={},i=Object.keys(e);for(let r=0;r<i.length;r++)i[r]===""||String(i[r])==="undefined"||typeof e[i[r]]>"u"||e[i[r]]==null||(t[i[r]]=e[i[r]]);return t}async function rz(e){let t=await pt("GET","/api/v2/components",{...Ja(e.query||{}),path:e.path,uid:e.uid,page:e.page,pageSize:e.pageSize,docType:e.docType,tag:e.tags||[]},{headers:{path:e.path},searchParams:!0});if(t.code===0&&t.success&&typeof t.result=="object"){let r=t.result,n=[];for(let s of r.lists)n.push({title:s.title,path:s.path||e.path,docType:s.docType,uuid:s.uuid,version:s.version,ticket:s.ticket,updateTime:s.updateTime*1e3,createTime:s.createTime*1e3,display_title:s.display_title,creator:Gt(s.creator),modifier:Wt(s.modifier),owner:zt(s.owner),tags:s.tags,source:s.source,key:s.key,iv:s.iv,dataStr:await Xn(r),dataStrId:r.dataStrId});return{count:r.count,page:r.page,pageSize:r.pageSize,totalPage:r.totalPage,lists:n}}let i=t.message||t.msg||"Request Error.";throw new he("GET_SIM_MODEL_LIST",i)}async function nz(e){let t=await pt("GET",`/api/v2/components/${e.uuid}`,{uuid:e.uuid,path:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(t.code===0&&t.success&&typeof t.result=="object"){let r=t.result;if(typeof r.path<"u"&&r.path!==e.path)throw new he("GET_SYMBOL_NOT_FOUND","data not found");return{title:r.title,description:r.description,docType:r.docType,path:r.path,uuid:r.uuid,version:r.version,ticket:r.ticket,updateTime:r.updateTime*1e3,createTime:r.createTime*1e3,display_title:r.display_title,creator:Gt(r.creator),modifier:Wt(r.modifier),owner:zt(r.owner),tags:r.tags,source:r.source,has_device:r.has_device,dataStr:await Xn(r),dataStrId:r.dataStrId}}let i=t.message||t.msg||"Request Error.";throw new he("GET_SYMBOL",i)}async function sz(e){let{deviceItemIn:t,deviceItemOut:i,deviceTagIds:r,deviceTagTitles:n,isDeviceFromProject:s}=await Pw(e.device,e.path,e.isProject,"path"in e.device&&e.device.override&&Array.isArray(e.device.override.tags)?e.device.override.tags:void 0),a=t||i;if(!a)throw new he("PARAMETER_VERIFICATION","missing device data.");hw(a.title);let{symbolItemIn:o,symbolItemOut:l,symbolTagIds:u,symbolTagTitles:c,symbolItemOriginUuid:h,symbolItemOriginPath:m}=await Ew(e.symbol,s,e.path,e.isProject,a.attributes?a.attributes.Symbol:void 0,"data"in e.device?void 0:e.device.path),f=o||l,g=!!(e.symbol&&"data"in e.symbol);e.symbol&&"path"in e.symbol&&e.symbol.override&&vr(f,e.symbol.override),a.attributes&&l&&typeof l=="object"&&(a.attributes.Symbol=l.uuid);let{footprintItemIn:y,footprintItemOut:b,footprintTagIds:E,footprintTagTitles:S,footprintItemOriginUuid:v,footprintItemOriginPath:A}=await Sw(e.footprint,s,e.path,e.isProject,a.attributes?a.attributes.Footprint:void 0,"data"in e.device?void 0:e.device.path),x=y||b;e.footprint&&"path"in e.footprint&&e.footprint.override&&vr(x,e.footprint.override),a.attributes&&b&&typeof b=="object"&&(a.attributes.Footprint=b.uuid);let T=!1,R=!1,L=await bw({symbolItem:f,footprintItem:x,userIdSelected:e.path,isNeedCreateSymbolAndAssocia:g},void 0);if(L.isNeedConfirm){let k=(await Re.messageBus.rpcCall("OpenSameNameSaveAsDlgService",{...L},31536e8)).message;if(!k){let ee="an exception occurred while executing the cross-bind program.";throw new he("CROSS_BIND",ee)}if(k.action==="cancel"||k.action==="close"){let ee="quit operate while executing the cross-bind program.";throw new he("CROSS_BIND_EXIT",ee)}L.updateCache=k.data,a.attributes&&Object.keys(L.updateCache).length&&(L.updateCache.symbolItemId&&(T=!0),L.updateCache.footprintItemId&&(R=!0),_w(L.updateCache,a.attributes))}T||await vw(e.isProject,e.path,a,e.symbol,f,c),R||await Iw(e.isProject,e.path,a,e.footprint,x,S),"path"in e.device&&e.device.override&&(delete e.device.override.tags,vr(a,e.device.override));let O=await pt("POST",`/api/v2/devices/${e.uuid}`,JSON.stringify({...a,tags:r,owner:e.path}),{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(O.code===0&&O.success&&O.result){let k=O.result;return{path:k.path||e.path,title:k.title,description:k.description,attributes:k.attributes,images:k.images,uuid:k.uuid,version:k.version,ticket:k.ticket,updateTime:k.updateTime,createTime:k.createTime,display_title:k.display_title,creator:Gt(k.creator),modifier:Wt(k.modifier),owner:zt(k.owner),tags:k.tags,source:k.source}}if(O.code===422)throw new he("CREATE_DEVICE_PERMISSIONS",O.result);let H=O.message||O.msg||"Request Error.";throw new he("UPDATE_DEVICE",H)}async function az(e){let{footprintItemIn:t,footprintItemOut:i,footprintTagIds:r,footprintTagTitles:n}=await E0(e.footprint,e.path,e.isProject,"path"in e.footprint&&e.footprint.override&&Array.isArray(e.footprint.override.tags)?e.footprint.override.tags:void 0),s=t||i;if(!s)throw new he("PARAMETER_VERIFICATION","missing footprint data.");if(fw(s.title),(await Ko(e.isProject,4,s.title,e.path,[e.uuid])).isDuplicate)throw new he("FOOTPRINT_SAME_NAMA_EXISTS","{libName} duplicate name or illegal name: {componentName}");"path"in e.footprint&&e.footprint.override&&(delete e.footprint.override.tags,vr(s,e.footprint.override));let a=await pt("POST",`/api/v2/components/${e.uuid}/update`,JSON.stringify({title:s.title,tags:r,docType:s.docType||4,description:s.description,owner:e.path}),{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(a.code===0&&a.success&&typeof a.result=="object"){let l=a.result;if(!("data"in e.footprint)&&e.footprint.uuid&&e.footprint.path){let u=await As({origin:{docType:s.docType,isProject:!!e.footprint.isProject,uuid:e.footprint.uuid,path:e.footprint.path},target:{docType:l.docType,isProject:!1,uuid:l.uuid,path:l.path}});if(!u.success)throw new he("UPDATE_FOOTPRINT_MIGRATE_CANVAS_ERROR",u.message||"migrate canvas error.")}return{title:l.title,description:l.description,path:l.path,docType:l.docType,uuid:l.uuid,version:l.version,ticket:l.ticket,updateTime:l.updateTime,createTime:l.createTime,display_title:l.display_title,creator:Gt(l.creator),modifier:Wt(l.modifier),owner:zt(l.owner),tags:l.tags,source:l.source}}if(a.code===422)throw new he("UPDATE_FOOTPRINT_PERMISSIONS",a.result);let o=a.message||a.msg||"Request Error.";throw new he("UPDATE_FOOTPRINT",o)}async function oz(e){let{simModelItemIn:t,simModelItemOut:i,simModelTagIds:r,simModelTagTitles:n}=await Aw(e.simModel,e.path,e.isProject,"path"in e.simModel&&e.simModel.override&&Array.isArray(e.simModel.override.tags)?e.simModel.override.tags:void 0),s=t||i;if(!s)throw new he("PARAMETER_VERIFICATION","missing simModel data.");mw(s.title),"path"in e.simModel&&e.simModel.override&&(delete e.simModel.override.tags,vr(s,e.simModel.override));let a=await pt("POST",`/api/v2/components/${e.uuid}/update`,JSON.stringify({...s,tags:r,owner:e.path}),{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(!a.success){let l=a.message||a.msg||"Request Error.";throw new he("UPDATE_SIM_MODEL",l)}if(s.dataStr){let l=await pt("POST",`/api/v2/components/${e.uuid}/update_canvas`,JSON.stringify({...s,tags:r,owner:e.path}),{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(!l.success){let u=l.message||l.msg||"Request Error.";throw new he("UPDATE_SIM_MODEL",u)}}if(a.code===0&&a.success&&typeof a.result=="object"){let l=a.result;return{title:l.title,path:l.path,docType:l.docType,uuid:l.uuid,version:l.version,ticket:l.ticket,updateTime:l.updateTime,createTime:l.createTime,display_title:l.display_title,creator:Gt(l.creator),modifier:Wt(l.modifier),owner:zt(l.owner),tags:l.tags,source:l.source,dataStr:await Xn(l),key:l.key,iv:l.iv,dataStrId:l.dataStrId}}if(a.code===422)throw new he("UPDATE_SIM_MODEL_PERMISSIONS",a.result);let o=a.message||a.msg||"Request Error.";throw new he("UPDATE_SYMBOL",o)}async function lz(e){let{symbolItemIn:t,symbolItemOut:i,symbolTagIds:r,symbolTagTitles:n}=await S0(e.symbol,e.path,e.isProject,"path"in e.symbol&&e.symbol.override&&Array.isArray(e.symbol.override.tags)?e.symbol.override.tags:void 0),s=t||i;if(!s)throw new he("PARAMETER_VERIFICATION","missing symbol data.");if(pw(s.title),(await Ko(e.isProject,s.docType,s.title,e.path,[e.uuid])).isDuplicate)throw new he("SYMBOL_SAME_NAMA_EXISTS","{libName} duplicate name or illegal name: {componentName}");"path"in e.symbol&&e.symbol.override&&(delete e.symbol.override.tags,vr(s,e.symbol.override));let a=await pt("POST",`/api/v2/components/${e.uuid}/update`,JSON.stringify({title:s.title,tags:r,docType:s.docType,description:s.description,owner:e.path}),{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(a.code===0&&a.success&&typeof a.result=="object"){let l=a.result;if(!("data"in e.symbol)&&e.symbol.uuid&&e.symbol.path){let u=await As({origin:{docType:s.docType,isProject:!!e.symbol.isProject,uuid:e.symbol.uuid,path:e.symbol.path},target:{docType:l.docType,isProject:!1,uuid:l.uuid,path:l.path}});if(!u.success)throw new he("UPDATE_SYMBOL_MIGRATE_CANVAS_ERROR",u.message||"migrate canvas error.")}return{title:l.title,description:l.description,docType:l.docType,path:l.path,uuid:l.uuid,version:l.version,ticket:l.ticket,updateTime:l.updateTime,createTime:l.createTime,display_title:l.display_title,creator:Gt(l.creator),modifier:Wt(l.modifier),owner:zt(l.owner),tags:l.tags,source:l.source}}if(a.code===422)throw new he("UPDATE_SYMBOL_PERMISSIONS",a.result);let o=a.message||a.msg||"Request Error.";throw new he("UPDATE_SYMBOL",o)}async function uz(e){let t=await pt("GET","/api/v2/components",{...e.query||{},path:e.path,uid:e.uid,page:e.page,pageSize:e.pageSize,docType:[16],tag:e.tags||[]},{headers:{path:e.path},searchParams:!0});if(t.code===0&&t.success&&typeof t.result=="object"){let r=t.result,n=[];for(let s of r.lists)n.push({title:s.title,path:s.path||e.path,docType:s.docType,uuid:s.uuid,version:s.version,ticket:s.ticket,updateTime:s.updateTime*1e3,createTime:s.createTime*1e3,display_title:s.display_title,creator:Gt(s.creator),modifier:Wt(s.modifier),owner:zt(s.owner),tags:s.tags,source:s.source,description:s.description,dataStr:await Xn(r),dataStrId:r.dataStrId});return{count:r.count,page:r.page,pageSize:r.pageSize,totalPage:r.totalPage,lists:n}}let i=t.message||t.msg||"Request Error.";throw new he("GET_D3MODEL_LIST",i)}async function cz(e){let t=await pt("GET","/api/v2/components",{...Ja(e.query||{}),path:e.path,uid:e.uid,page:e.page,pageSize:e.pageSize,docType:[4],tag:e.tags||[]},{headers:{path:e.path},searchParams:!0});if(t.code===0&&t.success&&typeof t.result=="object"){let r=t.result,n=[];for(let s of r.lists)n.push({title:s.title,path:s.path||e.path,docType:s.docType,uuid:s.uuid,version:s.version,ticket:s.ticket,updateTime:s.updateTime*1e3,createTime:s.createTime*1e3,display_title:s.display_title,creator:Gt(s.creator),modifier:Wt(s.modifier),owner:zt(s.owner),tags:s.tags,source:s.source,description:s.description});return{count:r.count,page:r.page,pageSize:r.pageSize,totalPage:r.totalPage,lists:n}}let i=t.message||t.msg||"Request Error.";throw new he("GET_FOOTPRINT_LIST",i)}async function dz(e){let t=await pt("GET","/api/v2/components",{...Ja(e.query||{}),path:e.path,uid:e.uid,page:e.page,pageSize:e.pageSize,docType:e.docType,tag:e.tags||[]},{headers:{path:e.path},searchParams:!0});if(t.code===0&&t.success&&typeof t.result=="object"){let r=t.result,n=[];for(let s of r.lists)n.push({title:s.title,path:s.path||e.path,docType:s.docType,uuid:s.uuid,version:s.version,ticket:s.ticket,updateTime:s.updateTime*1e3,createTime:s.createTime*1e3,display_title:s.display_title,creator:Gt(s.creator),modifier:Wt(s.modifier),owner:zt(s.owner),tags:s.tags,source:s.source,description:s.description});return{count:r.count,page:r.page,pageSize:r.pageSize,totalPage:r.totalPage,lists:n}}let i=t.message||t.msg||"Request Error.";throw new he("GET_SYMBOL_LIST",i)}function hz(e){return Array.isArray(e)?e:e?[e]:[]}async function pz(e){var r,n;let t=await pt("GET","/api/v2/devices",{...Ja(e.query||{}),path:e.path,uid:e.uid,page:e.page,pageSize:e.pageSize,tag:e.tags||[]},{headers:{path:e.path},searchParams:!0});if(t.code===0&&t.success&&typeof t.result=="object"){let s=t.result,a=[];for(let o of s.lists){let l={title:o.title,path:o.path||e.path,uuid:o.uuid,version:o.version,ticket:o.ticket,updateTime:o.updateTime*1e3,createTime:o.createTime*1e3,display_title:o.display_title,creator:Gt(o.creator),modifier:Wt(o.modifier),owner:zt(o.owner),tags:o.tags,source:o.source,description:o.description,images:hz(o.images),attributes:o.attributes,symbol_type:o.symbol_type,symbol:void 0,footprint:void 0};(r=o.symbol)!=null&&r.uuid&&(l.symbol={display_title:o.symbol.display_title,updateTime:o.symbol.updateTime*1e3}),(n=o.footprint)!=null&&n.uuid&&(l.footprint={display_title:o.footprint.display_title,updateTime:o.footprint.updateTime*1e3}),a.push(l)}return{count:s.count,page:s.page,pageSize:s.pageSize,totalPage:s.totalPage,lists:a}}let i=t.message||t.msg||"Request Error.";throw new he("GET_DEVICE_LIST",i)}async function fz(e,t=!1,i=!1){if(e.exactMatch){let s=e.wd.toLocaleLowerCase(),a=await pt("POST","/api/v2/devices/searchByUserUuidAndTitle",{docType:28,type:"device",titles:[s],user_uuids:[e.path],path:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(a.code===0&&a.success&&a.result){let l=(Object.values(a.result)||[]).flat(),u=[];for(let c=0;c<l.length;c++){let h=l[c],m=h.title,f=h.display_title;if(m!==s&&f!==s)continue;let g=zt(h.owner),y={title:h.title,path:h.path||e.path,uuid:h.uuid,version:h.version,ticket:h.ticket,updateTime:h.updateTime*1e3,createTime:h.createTime*1e3,display_title:h.display_title,creator:t?{}:Gt(h.creator),modifier:i?{}:Wt(h.modifier),owner:g,tags:h.tags,source:h.source,description:h.description,images:h.images,attributes:h.attributes,symbol_type:h.symbol_type,symbol:void 0,footprint:void 0};u.push(y)}return{count:u.length,page:1,pageSize:void 0,totalPage:1,lists:u,facets:null}}let o=a.message||a.msg||"Request Error.";throw new he("GET_DEVICE_SEARCH_LIST",o)}let r=await pt("POST","/api/devices/search",{...Ja(e.query||{}),path:e.path,uid:e.uid,page:e.page,pageSize:e.pageSize,tag:e.tags||[],wd:e.wd},{headers:{path:e.path},searchParams:!0});if(r.code===0&&r.success&&typeof r.result=="object"){let s=r.result,a=[],o=Object.keys(s.lists);for(let l=0;l<o.length;l++){let u=s.lists[o[l]];if(Array.isArray(u)&&u.length)for(let c=0;c<u.length;c++){let h=u[c],m={title:h.title,path:h.path||e.path,uuid:h.uuid,version:h.version,ticket:h.ticket,updateTime:h.updateTime*1e3,createTime:h.createTime*1e3,display_title:h.display_title,creator:t?{}:Gt(h.creator),modifier:i?{}:Wt(h.modifier),owner:zt(h.owner),tags:h.tags,source:h.source,description:h.description,images:h.images,attributes:h.attributes,symbol_type:h.symbol_type,symbol:void 0,footprint:void 0};h.symbol&&(m.symbol={display_title:h.symbol.display_title,updateTime:h.symbol.updateTime*1e3}),h.footprint&&(m.footprint={display_title:h.footprint.display_title,updateTime:h.footprint.updateTime*1e3}),a.push(m)}}return{count:s.count,page:s.page,pageSize:s.pageSize,totalPage:s.totalPage,lists:a,facets:s.facets}}let n=r.message||r.msg||"Request Error.";throw new he("GET_DEVICE_SEARCH_LIST",n)}async function mz(e,t=!1,i=!1){if(e.exactMatch){let s=e.wd.toLocaleLowerCase(),a=await pt("POST","/api/v2/components/searchByUserUuidAndTitle",{docType:Array.isArray(e.docType)?e.docType[0]:e.docType||"",type:"symbol",titles:[s],user_uuids:[e.path],path:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(a.code===0&&a.success&&a.result){let l=(Object.values(a.result)||[]).flat(),u=[];for(let c=0;c<l.length;c++){let h=l[c],m=h.title,f=h.display_title;if(m!==s&&f!==s)continue;let g=zt(h.owner),y={title:h.title,path:h.path||e.path,docType:h.docType,uuid:h.uuid,version:h.version,ticket:h.ticket,updateTime:h.updateTime*1e3,createTime:h.createTime*1e3,display_title:h.display_title,creator:t?{}:Gt(h.creator),modifier:i?{}:Wt(h.modifier),owner:g,tags:h.tags,source:h.source,description:h.description};u.push(y)}return{count:u.length,page:1,pageSize:void 0,totalPage:1,lists:u,facets:null}}let o=a.message||a.msg||"Request Error.";throw new he("GET_SYMBOL_SEARCH_LIST",o)}let r=await pt("POST","/api/v2/components/search",{...Ja(e.query||{}),path:e.path,uid:e.uid,page:e.page,pageSize:e.pageSize,docType:e.docType,tag:e.tags||[],wd:e.wd},{headers:{path:e.path},searchParams:!0});if(r.code===0&&r.success&&typeof r.result=="object"){let s=r.result,a=[],o=Object.keys(s.lists);for(let l=0;l<o.length;l++){let u=s.lists[o[l]];if(Array.isArray(u)&&u.length)for(let c=0;c<u.length;c++){let h=u[c];a.push({title:h.title,path:h.path||e.path,docType:h.docType,uuid:h.uuid,version:h.version,ticket:h.ticket,updateTime:h.updateTime,createTime:h.createTime,display_title:h.display_title,creator:t?{}:Gt(h.creator),modifier:i?{}:Wt(h.modifier),owner:zt(h.owner),tags:h.tags,source:h.source,description:h.description})}}return{count:s.count,page:s.page,pageSize:s.pageSize,totalPage:s.totalPage,lists:a,facets:s.facets}}let n=r.message||r.msg||"Request Error.";throw new he("GET_SYMBOL_SEARCH_LIST",n)}async function gz(e,t=!1,i=!1){if(e.exactMatch){let s=e.wd.toLocaleLowerCase(),a=await pt("POST","/api/v2/components/searchByUserUuidAndTitle",{docType:4,type:"footprint",titles:[s],user_uuids:[e.path],path:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(a.code===0&&a.success&&a.result){let l=(Object.values(a.result)||[]).flat(),u=[];for(let c=0;c<l.length;c++){let h=l[c],m=h.title,f=h.display_title;if(m!==s&&f!==s)continue;let g=zt(h.owner),y={title:h.title,path:h.path||e.path,docType:h.docType,uuid:h.uuid,version:h.version,ticket:h.ticket,updateTime:h.updateTime*1e3,createTime:h.createTime*1e3,display_title:h.display_title,creator:t?{}:Gt(h.creator),modifier:i?{}:Wt(h.modifier),owner:g,tags:h.tags,source:h.source,description:h.description};u.push(y)}return{count:u.length,page:1,pageSize:void 0,totalPage:1,lists:u,facets:null}}let o=a.message||a.msg||"Request Error.";throw new he("GET_FOOTPRINT_SEARCH_LIST",o)}let r=await pt("POST","/api/v2/components/search",{...Ja(e.query||{}),path:e.path,uid:e.uid,page:e.page,pageSize:e.pageSize,docType:[4],tag:e.tags||[],wd:e.wd},{headers:{path:e.path},searchParams:!0});if(r.code===0&&r.success&&typeof r.result=="object"){let s=r.result,a=[],o=Object.keys(s.lists);for(let l=0;l<o.length;l++){let u=s.lists[o[l]];if(Array.isArray(u)&&u.length)for(let c=0;c<u.length;c++){let h=u[c];a.push({title:h.title,path:h.path||e.path,docType:h.docType,uuid:h.uuid,version:h.version,ticket:h.ticket,updateTime:h.updateTime,createTime:h.createTime,display_title:h.display_title,creator:t?{}:Gt(h.creator),modifier:i?{}:Wt(h.modifier),owner:zt(h.owner),tags:h.tags,source:h.source,description:h.description})}}return{count:s.count,page:s.page,pageSize:s.pageSize,totalPage:s.totalPage,lists:a,facets:s.facets}}let n=r.message||r.msg||"Request Error.";throw new he("GET_FOOTPRINT_SEARCH_LIST",n)}async function yz(e,t=!1,i=!1){if(e.exactMatch){let s=e.wd.toLocaleLowerCase(),a=await pt("POST","/api/v2/components/searchByUserUuidAndTitle",{docType:e.docType,type:"simModel",titles:[s],user_uuids:[e.path],path:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(a.code===0&&a.success&&a.result){let l=(Object.values(a.result)||[]).flat(),u=[];for(let c=0;c<l.length;c++){let h=l[c],m=h.title,f=h.display_title;if(m!==s&&f!==s)continue;let g=zt(h.owner),y={title:h.title,path:h.path||e.path,docType:h.docType,uuid:h.uuid,version:h.version,ticket:h.ticket,updateTime:h.updateTime*1e3,createTime:h.createTime*1e3,display_title:h.display_title,creator:t?{}:Gt(h.creator),modifier:i?{}:Wt(h.modifier),owner:g,tags:h.tags,source:h.source,key:h.key,iv:h.iv,dataStr:void 0,dataStrId:h.dataStrId};u.push(y)}return{count:u.length,page:1,pageSize:void 0,totalPage:1,lists:u,facets:null}}let o=a.message||a.msg||"Request Error.";throw new he("GET_SIM_MODEL_SEARCH_LIST",o)}let r=await pt("POST","/api/v2/components/search",{...Ja(e.query||{}),path:e.path,uid:e.uid,page:e.page,pageSize:e.pageSize,docType:e.docType,tag:e.tags||[],wd:e.wd},{headers:{path:e.path},searchParams:!0});if(r.code===0&&r.success&&typeof r.result=="object"){let s=r.result,a=[],o=Object.keys(s.lists);for(let l=0;l<o.length;l++){let u=s.lists[o[l]];if(Array.isArray(u)&&u.length)for(let c=0;c<u.length;c++){let h=u[c];a.push({title:h.title,path:h.path||e.path,docType:h.docType,uuid:h.uuid,version:h.version,ticket:h.ticket,updateTime:h.updateTime,createTime:h.createTime,display_title:h.display_title,creator:t?{}:Gt(h.creator),modifier:i?{}:Wt(h.modifier),owner:zt(h.owner),tags:h.tags,source:h.source,key:h.key,iv:h.iv,dataStr:await Xn(s),dataStrId:s.dataStrId})}}return{count:s.count,page:s.page,pageSize:s.pageSize,totalPage:s.totalPage,lists:a,facets:s.facets}}let n=r.message||r.msg||"Request Error.";throw new he("GET_SIM_MODEL_SEARCH_LIST",n)}async function _z(e){if(e.attributes.Symbol){let s=await Ht.getSymbol({isProject:e.isProject,uuid:e.attributes.Symbol,path:e.path})}if(e.attributes.Footprint){let s=await Ht.getFootprint({isProject:e.isProject,uuid:e.attributes.Footprint,path:e.path})}let t=await Ht.getDevice({isProject:e.isProject,uuid:e.uuid,path:e.path}),i=Object.keys(e.attributes||{});for(let s=0;s<i.length;s++)t.attributes[i[s]]=e.attributes[i[s]];let r=await pt("POST",`/api/v2/devices/${e.uuid}`,JSON.stringify({...t,title:t.display_title||t.title,tags:t.tags?cw(t.tags):[],owner:e.path}),{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(r.code===0&&r.success&&r.result){let s=r.result;return{path:s.path||e.path,title:s.title,description:s.description,attributes:s.attributes,images:s.images,uuid:s.uuid,version:s.version,ticket:s.ticket,updateTime:s.updateTime,createTime:s.createTime,display_title:s.display_title,creator:Gt(s.creator),modifier:Wt(s.modifier),owner:zt(s.owner),tags:s.tags,source:s.source}}if(r.code===422)throw new he("CREATE_DEVICE_PERMISSIONS",r.result);let n=r.message||r.msg||"Request Error.";throw new he("UPDATE_DEVICE_ATTRIBUTES",n)}var bz=class extends P0{async getDevice(e){return await ez(e)}async getSymbol(e){return await nz(e)}async getFootprint(e){return await tz(e)}async getD3Model(e){return await fd(e.uuid,e.path)}async getSimModel(e){return await iz(e)}async getDeviceList(e){return await pz(e)}async getSymbolList(e){return await dz(e)}async getFootprintList(e){return await cz(e)}async getD3ModelList(e){return await uz(e)}async getSimModelList(e){return rz(e)}async getDeviceSearchList(e){return await fz(e,!0,!0)}async getSymbolSearchList(e){return await mz(e,!0,!0)}async getFootprintSearchList(e){return await gz(e,!0,!0)}async getD3ModelSearchList(e){throw new Error("functions that are prohibited from being called.")}async getSimModelSearchList(e){return yz(e,!0,!0)}async createDevice(e){return await $W(e)}async createSymbol(e){return await QW(e)}async createFootprint(e){return await KW(e)}async createD3Model(e){return await XW(e)}async createSimModel(e){return await ZW(e)}async updateDevice(e){return await sz(e)}async updateDeviceAttributes(e){return await _z(e)}async updateSymbol(e){return await lz(e)}async updateFootprint(e){return await az(e)}async updatesimModel(e){return await oz(e)}async deleteDevice(e){let t=await pt("POST",`/api/v2/devices/${e.uuid}/delete`,{uuid:e.uuid,path:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(!(t.code===0&&t.success)){let i=t.message||t.msg||"Request Error.";throw new he("DELETE_DEVICE",i)}}async deleteSymbol(e){let t=await pt("POST",`/api/v2/components/${e.uuid}/delete`,{uuid:e.uuid,path:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(!(t.code===0&&t.success)){let i=t.message||t.msg||"Request Error.";throw new he("DELETE_SYMBOL",i)}}async deleteFootprint(e){let t=await pt("POST",`/api/v2/components/${e.uuid}/delete`,{uuid:e.uuid,path:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(!(t.code===0&&t.success)){let i=t.message||t.msg||"Request Error.";throw new he("DELETE_FOOTPRINT",i)}}async deleteSimModel(e){let t=await pt("POST",`/api/v2/components/${e.uuid}/delete`,{uuid:e.uuid,path:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(!(t.code===0&&t.success)){let i=t.message||t.msg||"Request Error.";throw new he("DELETE_SIM_MODEL",i)}}async delete3DModel(e){let t=await pt("POST",`/api/v2/components/${e.uuid}/delete`,{uuid:e.uuid,path:e.path},{headers:{"Content-type":"application/json","content-type":"application/json",path:e.path}});if(!(t.code===0&&t.success)){let i=t.message||t.msg||"Request Error.";throw new he("DELETE_3DMODEL",i)}}},da=class{static diffVersionDevice(e){Re.messageBus.publish("logI18nLogView",{type:"warn",msg:["Devices have not been added to the project library, project library has devices with different versions from the same source :",e.join("\u3001")]})}static diffVersionSymbol(e){Re.messageBus.publish("logI18nLogView",{type:"warn",msg:["Symbols have not been added to the project library, project library has symbols with different versions from the same source :",e.join("\u3001")]})}static diffVersionFootprint(e){Re.messageBus.publish("logI18nLogView",{type:"warn",msg:["Footprints have not been added to the project library, project library has footprints with different versions from the same source :",e.join("\u3001")]})}static sameVersionDevice(e){Re.messageBus.publish("logI18nLogView",{type:"info",msg:["Devices have not been added to the project library, project library has devices with same versions from the same source :",e.join("\u3001")]})}static sameVersionSymbol(e){Re.messageBus.publish("logI18nLogView",{type:"info",msg:["Symbols have not been added to the project library, project library has symbols with same versions from the same source :",e.join("\u3001")]})}static sameVersionFootprint(e){Re.messageBus.publish("logI18nLogView",{type:"info",msg:["Footprints have not been added to the project library, project library has footprints with same versions from the same source :",e.join("\u3001")]})}static renamedDevice(e){Re.messageBus.publish("logI18nLogView",{type:"warn",msg:["Devices are automatically renamed when they are added to the project library :",e.join("\u3001")]})}static renamedSymbol(e){Re.messageBus.publish("logI18nLogView",{type:"warn",msg:["Symbols are automatically renamed when they are added to the project library :",e.join("\u3001")]})}static renamedFootprint(e){Re.messageBus.publish("logI18nLogView",{type:"warn",msg:["Footprints are automatically renamed when they are added to the project library :",e.join("\u3001")]})}},Pz=class{constructor(e){let{renameKey:t=!0}=e;this.renameKey=t}async rename(e,...t){let{message:i}=await Re.messageBus.rpcCall("allowDuplicateNames");return this.renameKey||!i?this.renaming(e,...t):i?{success:!0}:this.isRename(e,...t)}},Ez=class extends Pz{constructor(e){let{matchKey:t=!0,byUUID:i=!1,byVersion:r=!1,bySource:n=!1}=e;super(e),this.matchKey=t,this.byUUID=i,this.byVersion=r,this.bySource=n}async match(e){if(this.matchKey)return this.matching(e)}},v0=class extends Ez{constructor(e){let{path:t,data:i}=e;super(e),this.origin={},this.path=t,this.data=i}async onAdd(e){let t=JSON.parse(JSON.stringify(e));return t.path||(t.path=this.path),await GG({data:t}),vb(t),t.project_uuid=t.path=this.path,t}async onUpdate(e){let t=JSON.parse(JSON.stringify(e));return vb(t),t}async getTemplate(e,t={}){let{uuid:i,path:r,updateTime:n}=e,s=`${i}${du}${r}`,a=n==null?void 0:n.toString(),o=Object.assign(e,{path:r,source:s,version:a},t);return vb(o),o}},Sz=class{constructor(e,t){this.extendLib=t,this.getList=e.getList,this.getSupportedPreviewTypes=e.getSupportedPreviewTypes,this.getDetail=e.getDetail,this.getClassificationTree=e.getClassificationTree}async getTransformedList(e){let t=await this.getList(e),{count:i,page:r,pageSize:n,lists:s,totalPage:a}=t;return{count:i,page:r,pageSize:n,totalPage:a,lists:s.map(o=>this.extendLib.transformer.transformCbbListItem(o))}}async getTransformedDetail(e){return await this.getDetail(e)}},vz=class{constructor(e,t){this.extendLib=t,this.getList=e.getList,this.getSupportedPreviewTypes=e.getSupportedPreviewTypes,this.getSupportedSymbolTypes=e.getSupportedSymbolTypes,this.getDetail=e.getDetail,this.getClassificationTree=e.getClassificationTree}async getTransformedList(e){let t=await this.getList(e),{count:i,page:r,pageSize:n,lists:s,totalPage:a}=t;return{count:i,page:r,pageSize:n,totalPage:a,lists:s.map(o=>this.extendLib.transformer.transformDeviceListItem(o))}}async getTransformedDetail(e){let t=await this.getDetail(e);return this.extendLib.transformer.transformDeviceListItem(t)}},Iz=class{constructor(e,t){this.extendLib=t,this.getList=e.getList,this.getSupportedPreviewTypes=e.getSupportedPreviewTypes,this.getDetail=e.getDetail,this.getClassificationTree=e.getClassificationTree}async getTransformedList(e){let t=await this.getList(e),{count:i,page:r,pageSize:n,lists:s=[],totalPage:a}=t,o=[];for(let l of s)o.push(await this.extendLib.transformer.transformFootprintListItem(l));return{count:i,page:r,pageSize:n,totalPage:a,lists:o}}async getTransformedDetail(e){let t=await this.getDetail(e);return await this.extendLib.transformer.transformFootprintListItem(t)}},Az=class{constructor(e,t){this.extendLib=t,this.getList=e.getList,this.getSupportedPreviewTypes=e.getSupportedPreviewTypes,this.getSupportedSymbolTypes=e.getSupportedSymbolTypes,this.getDetail=e.getDetail,this.getClassificationTree=e.getClassificationTree}async getTransformedList(e){let t=await this.getList(e),{count:i,page:r,pageSize:n,lists:s,totalPage:a}=t,o=[];for(let l of s)o.push(await this.extendLib.transformer.transformFootprintListItem(l));return{count:i,page:r,pageSize:n,totalPage:a,lists:o}}async getTransformedDetail(e){let t=await this.getDetail(e);return await this.extendLib.transformer.transformSymbolListItem(t)}},Cz=class{constructor(e){this.extendLib=e}transformCategory(e,t){var r,n;let i=(r=e.uuid)!=null?r:crypto.randomUUID();return{id:i,title:e.name,children:(n=e.children)==null?void 0:n.map(s=>this.transformCategory(s,i)),parentId:t}}transformDeviceListItem(e){var t,i;return{title:e.name||"",description:e.description||"",images:[],uuid:e.uuid||this.extendLib.getDefaultItemId(),path:this.extendLib.id,source:"",version:"",ticket:0,updateTime:e.updateTime||Date.now(),createTime:e.createTime||Date.now(),display_title:e.name||"",creator:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},modifier:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},owner:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},attributes:{Footprint:((t=e.footprint)==null?void 0:t.uuid)||"",Symbol:((i=e.symbol)==null?void 0:i.uuid)||"",value:e.value||"",supplierPart:e.supplierPart||"",manufacturer:e.manufacturer||"",description:e.description||""},symbol:e.symbol?{display_title:e.symbol.name||""}:void 0,footprint:e.footprint?{display_title:e.footprint.name||""}:void 0,tags:void 0}}async transformSymbolListItem(e){var t,i,r,n,s,a,o,l,u,c;return{docType:e.symbolType,uuid:e.uuid||this.extendLib.getDefaultItemId(),title:e.name||"",description:e.description||"",path:this.extendLib.id,source:"",version:(t=e.version)!=null?t:"",ticket:0,updateTime:e.updateTime||Date.now(),createTime:e.createTime||Date.now(),display_title:e.name||"",creator:e.creator?{nickname:(i=e.creator.name)!=null?i:"",username:(r=e.creator.name)!=null?r:"",uuid:(n=e.creator.uuid)!=null?n:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},modifier:e.modifier?{nickname:(s=e.modifier.name)!=null?s:"",username:(a=e.modifier.name)!=null?a:"",uuid:(o=e.modifier.uuid)!=null?o:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},owner:e.owner?{nickname:(l=e.owner.name)!=null?l:"",username:(u=e.owner.name)!=null?u:"",uuid:(c=e.owner.uuid)!=null?c:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},dataStr:e.data instanceof Blob?await e.data.text():e.data,tags:void 0}}async transformFootprintListItem(e){var t,i,r,n,s,a,o,l,u,c;return{docType:4,uuid:e.uuid||this.extendLib.getDefaultItemId(),title:e.name||"",description:e.description||"",path:this.extendLib.id,source:"",version:(t=e.version)!=null?t:"",ticket:0,updateTime:e.updateTime||Date.now(),createTime:e.createTime||Date.now(),display_title:e.name||"",creator:e.creator?{nickname:(i=e.creator.name)!=null?i:"",username:(r=e.creator.name)!=null?r:"",uuid:(n=e.creator.uuid)!=null?n:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},modifier:e.modifier?{nickname:(s=e.modifier.name)!=null?s:"",username:(a=e.modifier.name)!=null?a:"",uuid:(o=e.modifier.uuid)!=null?o:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},owner:e.owner?{nickname:(l=e.owner.name)!=null?l:"",username:(u=e.owner.name)!=null?u:"",uuid:(c=e.owner.uuid)!=null?c:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},dataStr:e.data instanceof Blob?await e.data.text():e.data,tags:void 0}}transformCbbListItem(e){var t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E,S,v,A,x,T,R,L,O,H,k,ee,q,Q,ne,G,X,D;return{cbb_project:!0,content:(t=e.description)!=null?t:"",creator:e.creator?{avatar:"",nickname:(i=e.creator.name)!=null?i:"",username:(r=e.creator.name)!=null?r:"",uuid:(n=e.creator.uuid)!=null?n:""}:{avatar:"",nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},modifier:e.modifier?{nickname:(s=e.modifier.name)!=null?s:"",username:(a=e.modifier.name)!=null?a:"",uuid:(o=e.modifier.uuid)!=null?o:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},owner:e.owner?{avatar:"",team:!1,nickname:(l=e.owner.name)!=null?l:"",username:(u=e.owner.name)!=null?u:"",uuid:(c=e.owner.uuid)!=null?c:""}:{avatar:"",team:!1,nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},name:e.name,path:this.extendLib.id,block_symbol:[],schematics:[],pcb:(m=(h=e.pcbs)==null?void 0:h.map(F=>{var W,z,$,te,Z,pe,Se,Ce,we,Fe,Ue;return{description:(W=F.description)!=null?W:"",display_title:F.name,docType:3,project_uuid:(z=e.uuid)!=null?z:"",thumb:F.thumb,title:F.name.toLocaleLowerCase(),updateTime:F.updateTime,uuid:F.uuid,creator:F.creator?{avatar:"",nickname:(te=($=F.creator)==null?void 0:$.name)!=null?te:"",username:(pe=(Z=F.creator)==null?void 0:Z.name)!=null?pe:"",uuid:(Ce=(Se=F.creator)==null?void 0:Se.uuid)!=null?Ce:""}:{avatar:"",nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},modifier:F.modifier?{nickname:(we=F==null?void 0:F.modifier.name)!=null?we:"",username:(Fe=F==null?void 0:F.modifier.name)!=null?Fe:"",uuid:(Ue=F==null?void 0:F.modifier.uuid)!=null?Ue:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id}}}))!=null?m:[],schs:(g=(f=e.sheets)==null?void 0:f.map(F=>{var W,z,$,te,Z,pe,Se,Ce;return{description:(W=F.description)!=null?W:"",display_title:F.name,docType:1,project_uuid:(z=e.uuid)!=null?z:"",schematic_uuid:F.belongSchematicUuid,thumb:F.thumb,title:F.name.toLocaleLowerCase(),updateTime:F.updateTime,uuid:F.uuid,creator:F.creator?{avatar:"",nickname:($=F==null?void 0:F.creator.name)!=null?$:"",username:(te=F==null?void 0:F.creator.name)!=null?te:"",uuid:(Z=F==null?void 0:F.creator.uuid)!=null?Z:""}:{avatar:"",nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id},modifier:F!=null&&F.modifier?{nickname:(pe=F==null?void 0:F.modifier.name)!=null?pe:"",username:(Se=F==null?void 0:F.modifier.name)!=null?Se:"",uuid:(Ce=F==null?void 0:F.modifier.uuid)!=null?Ce:""}:{nickname:this.extendLib.title,username:this.extendLib.title,uuid:this.extendLib.id}}}))!=null?g:[],tags:{parent_tag:{name:(b=(y=e.classification)==null?void 0:y.primaryClassificationName)!=null?b:"",name_cn:(S=(E=e.classification)==null?void 0:E.primaryClassificationName)!=null?S:"",title:(A=(v=e.classification)==null?void 0:v.primaryClassificationName)!=null?A:"",uuid:(T=(x=e.classification)==null?void 0:x.primaryClassificationUuid)!=null?T:""},child_tag:{name:(L=(R=e.classification)==null?void 0:R.secondaryClassificationName)!=null?L:"",name_cn:(H=(O=e.classification)==null?void 0:O.secondaryClassificationName)!=null?H:"",title:(ee=(k=e.classification)==null?void 0:k.secondaryClassificationName)!=null?ee:"",uuid:(Q=(q=e.classification)==null?void 0:q.secondaryClassificationUuid)!=null?Q:""}},updated_at:new Date((ne=e.updateTime)!=null?ne:"").toDateString(),uuid:(G=e.uuid)!=null?G:e.name,boards:(D=(X=e.boards)==null?void 0:X.map(F=>({name:F.name,pcb:F.pcbUuid,sch:F.schUuid})))!=null?D:[]}}},xz=class Cw{constructor(t){this.transformer=new Cz(this),this.id=t.id,this.title=t.title,t.device&&(this.device=new vz(t.device,this)),t.symbol&&(this.symbol=new Az(t.symbol,this)),t.footprint&&(this.footprint=new Iz(t.footprint,this)),t.cbb&&(this.cbb=new Sz(t.cbb,this))}static async set(t){var r,n,s,a,o,l,u,c;let i=new Cw(t);return i._deviceSupportedSymbolTypes=await((n=(r=t.device)==null?void 0:r.getSupportedSymbolTypes)==null?void 0:n.call(r)),i._symbolSupportedSymbolTypes=await((a=(s=t.symbol)==null?void 0:s.getSupportedSymbolTypes)==null?void 0:a.call(s)),i._deviceSupportedPreviewTypes=await((l=(o=t.device)==null?void 0:o.getSupportedPriviewTypes)==null?void 0:l.call(o)),i._footprintSupportedPreviewTypes=await((c=(u=t.footprint)==null?void 0:u.getSupportedPriviewTypes)==null?void 0:c.call(u)),i}getDefaultItemId(){return crypto.randomUUID().replace("-","")}getLibraryFunctionsClassInTab(t){switch(t){case"cbb":return this==null?void 0:this.cbb;case"device":return this==null?void 0:this.device;case"symbol":return this==null?void 0:this.symbol;case"footprint":return this==null?void 0:this.footprint;default:return null}}isInTab(t){return!!this.getLibraryFunctionsClassInTab(t)}isHasCategoryTreeInTab(t){var i;return!!((i=this.getLibraryFunctionsClassInTab(t))!=null&&i.getClassificationTree)}async getAmountByWd(t,i){var r,n,s;return(s=(n=await((r=this.getLibraryFunctionsClassInTab(t))==null?void 0:r.getList({page:1,pageSize:1,query:{wd:i}})))==null?void 0:n.count)!=null?s:0}async getCategoryTreeDataItemsInTab(t){var i,r;return this.isHasCategoryTreeInTab(t)?(r=await((i=this.getLibraryFunctionsClassInTab(t))==null?void 0:i.getClassificationTree()))==null?void 0:r.map(n=>this.transformer.transformCategory(n)):null}getSelectTypeListInTab(t){let i=[];if(t==="device"){let r=this._deviceSupportedSymbolTypes;i=r?QC.filter(n=>r.includes(Number(n.value))||!n.value):QC}else if(t==="symbol"){let r=this._symbolSupportedSymbolTypes;i=r?ex.filter(n=>r.includes(Number(n.value))||!n.value):ex}return i.length>2?i:[]}getPreviewTypesInTab(t){let i=FG[t];return t==="device"&&this._deviceSupportedPreviewTypes?i=i.filter(r=>{var n;return(n=this._deviceSupportedPreviewTypes)==null?void 0:n.includes(r)}):t==="footprint"&&this._footprintSupportedPreviewTypes&&(i=i.filter(r=>{var n;return(n=this._footprintSupportedPreviewTypes)==null?void 0:n.includes(r)})),i}async getListInTab(t,i){var r;return await((r=this.getLibraryFunctionsClassInTab(t))==null?void 0:r.getList(i))}async getTransformedListInTab(t,i){var r;return await((r=this.getLibraryFunctionsClassInTab(t))==null?void 0:r.getTransformedList(i))}async getDetailInTab(t,i){var r;return await((r=this.getLibraryFunctionsClassInTab(t))==null?void 0:r.getDetail(i))}async getTransformedDetailInTab(t,i){var r;return await((r=this.getLibraryFunctionsClassInTab(t))==null?void 0:r.getTransformedDetail(i))}},Tz=class{constructor(e=10){this._runingCount=0,this._handleCount=0,this._queue=[],this._results=[],this._windowSize=e,this._finishCallback=null,this._taskStartCallback=null,this._taskEndCallback=null}pushTask(e){this._queue.push(e)}setFinishCallback(e){this._finishCallback=e}setTaskStartCallback(e){this._taskStartCallback=e}setTaskEndCallback(e){this._taskEndCallback=e}next(){for(;this._runingCount<this._windowSize&&this._queue.length>0;){this._runingCount+=1,this._handleCount+=1;let e=this._handleCount-1,t=this._queue.shift();this._taskStartCallback&&this._taskStartCallback(e),t(e).then(i=>{this._results.push(i)}).catch(i=>{this._results.push(i)}).finally(()=>{this._runingCount-=1,this._taskEndCallback&&this._taskEndCallback(this._results[this._results.length-1]),this.next()})}this._runingCount<=0&&this._finishCallback&&this._finishCallback(this._results)}},I0=class{onString(e,t,i){}onAttr(e,t,i){}onGroup(e,t,i,r,n){}onDelGroup(e,t,i,r){}onDelString(e,t,i,r){}onDelAttr(e,t,i,r){}onPanelizeSide(e,t,i,r){}onDelPanelizeSide(e,t,i,r){}onPanelizeStamp(e,t,i,r){}onDelPanelizeStamp(e,t,i,r){}onPanelize(e,t,i,r){}onDelPanelize(e,t,i){}onRuleSelector(e,t,i,r){}onDelRuleSelector(e,t,i,r){}onRule(e,t,i,r){}onDelRule(e,t,i,r,n){}onRuleTemplate(e,t,i,r){}onDimension(e,t,i,r,n,s){}onDelDimension(e,t,i,r){}onBoss(e,t,i,r,n,s){}onDelBoss(e,t,i,r){}onShellEntity(e,t,i,r,n,s){}onDelShellEntity(e,t,i,r){}onShellCut(e,t,i,r,n,s){}onDelShellCut(e,t,i,r){}onCrease(e,t,i,r,n,s){}onDelCrease(e,t,i,r){}onShell(e,t,i,r,n,s){}onDelShell(e,t,i,r){}onFpcFill(e,t,i,r,n,s){}onDelFpcFill(e,t,i,r){}onTeardrop(e,t,i,r,n,s){}onDelTeardrop(e,t,i,r){}onImage(e,t,i,r,n,s){}onDelImage(e,t,i,r){}onPoured(e,t,i,r,n,s){}onDelPoured(e,t,i,r){}onPour(e,t,i,r,n,s){}onDelPour(e,t,i,r){}onRegion(e,t,i,r,n,s){}onDelRegion(e,t,i,r){}onFill(e,t,i,r,n,s){}onDelFill(e,t,i,r){}onPoly(e,t,i,r,n,s){}onDelPoly(e,t,i,r){}onEQLenGrp(e,t,i,r,n){}onDelEQLenGrp(e,t,i,r){}onDelProp(e,t,i,r){}onObj(e,t,i,r,n,s){}onDelObj(e,t,i,r){}onArc(e,t,i,r,n,s){}onDelArc(e,t,i,r){}onCArc(e,t,i,r,n,s){}onDelCArc(e,t,i,r){}onLine(e,t,i,r,n,s){}onDelLine(e,t,i,r){}onPad(e,t,i,r,n,s){}onDelPad(e,t,i,r){}onVia(e,t,i,r,n,s){}onDelVia(e,t,i,r){}onDelConnect(e,t,i,r){}onPreference(e,t,i,r){}onSilkOpts(e,t,i,r,n){}onDelSilkOpts(e,t,i,r){}onPrimitive(e,t,i,r,n){}onDelPrimitive(e,t,i,r){}onNet(e,t,i,r,n){}onDelNet(e,t,i,r){}onPartition(e,t,i,r,n,s){}onDelPartition(e,t,i,r){}onActiveLayer(e,t,i,r){}onLayerPhys(e,t,i,r,n){}onDelLayerPhys(e,t,i,r){}onLayer(e,t,i,r,n){}onDelLayer(e,t,i,r){}onCanvas(e,t,i,r){}onDocDetail(e,t,i,r){}onStringNum(e,t){}onAttrNum(e,t){}onDimensionNum(e,t){}onBossNum(e,t){}onShellEntityNum(e,t){}onShellCutNum(e,t){}onCreaseNum(e,t){}onShellNum(e,t){}onFpcFillNum(e,t){}onTeardropNum(e,t){}onImageNum(e,t){}onPouredNum(e,t){}onPourNum(e,t){}onRegionNum(e,t){}onFillNum(e,t){}onPolyNum(e,t){}onObjNum(e,t){}onArcNum(e,t){}onCArcNum(e,t){}onLineNum(e,t){}onPadNum(e,t){}onViaNum(e,t){}onPartitionNum(e,t){}},wz=class extends I0{constructor(e){super(),this.source={},this._action=e}get action(){return this._action}getSource(){return this.source}onString(e,t,i){this.source[e]=t}onAttr(e,t,i){i||(this.action&&this.action(e,t),this.source[e]=t)}onDimension(e,t,i,r,n,s){this.source[e]=n}onBoss(e,t,i,r,n,s){this.source[e]=n}onShellEntity(e,t,i,r,n,s){this.source[e]=n}onShellCut(e,t,i,r,n,s){this.source[e]=n}onCrease(e,t,i,r,n,s){this.source[e]=n}onShell(e,t,i,r,n,s){this.source[e]=n}onFpcFill(e,t,i,r,n,s){this.source[e]=n}onTeardrop(e,t,i,r,n,s){this.source[e]=n}onImage(e,t,i,r,n,s){this.source[e]=n}onPoured(e,t,i,r,n,s){this.source[e]=n}onPour(e,t,i,r,n,s){this.source[e]=n}onRegion(e,t,i,r,n,s){this.source[e]=n}onFill(e,t,i,r,n,s){this.source[e]=n}onPoly(e,t,i,r,n,s){this.source[e]=n}onObj(e,t,i,r,n,s){this.source[e]=n}onArc(e,t,i,r,n,s){this.source[e]=n}onCArc(e,t,i,r,n,s){this.source[e]=n}onLine(e,t,i,r,n,s){this.source[e]=n}onPad(e,t,i,r,n,s){this.source[e]=n}onVia(e,t,i,r,n,s){this.source[e]=n}},xw=class extends aT{constructor(e,t,i){super(e,t,i,new h0(!1)),this._compilerHandler=null}async init(e=!1,t=!1,i=!1,r=!1){return super.init(e,t,i,r)}onBlob(e,t,i,r,n){}onDelBlob(e,t,i,r){}onFont(e,t,i,r){}onDelFont(e,t,i,r){}canvasSelected(){return""}onSelectChange(e,t,i){}onSelectQuit(e,t){}onLayerFill(e,t,i,r,n){}onDelLayerFill(e,t,i,r){}setHandler(e){this._compilerHandler=e}onGroup(e,t,i,r,n){this._compilerHandler&&this._compilerHandler.onGroup(e,t,i,r,n)}onDelGroup(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelGroup(e,t,i,r)}onString(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onString(e,n,s)}onDelString(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelString(e,t,i,r)}onAttr(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onAttr(e,n,s)}onDelAttr(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelAttr(e,t,i,r)}onPanelizeSide(e,t,i,r){this._compilerHandler&&this._compilerHandler.onPanelizeSide(e,t,i,r)}onDelPanelizeSide(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelPanelizeSide(e,t,i,r)}onPanelizeStamp(e,t,i,r){this._compilerHandler&&this._compilerHandler.onPanelizeStamp(e,t,i,r)}onDelPanelizeStamp(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelPanelizeStamp(e,t,i,r)}onPanelize(e,t,i,r){this._compilerHandler&&this._compilerHandler.onPanelize(e,t,i,r)}onDelPanelize(e,t,i){this._compilerHandler&&this._compilerHandler.onDelPanelize(e,t,i)}onRuleSelector(e,t,i,r){this._compilerHandler&&this._compilerHandler.onRuleSelector(e,t,i,r)}onDelRuleSelector(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelRuleSelector(e,t,i,r)}onRule(e,t,i,r){this._compilerHandler&&this._compilerHandler.onRule(e,t,i,r)}onDelRule(e,t,i,r,n){this._compilerHandler&&this._compilerHandler.onDelRule(e,t,i,r,n)}onRuleTemplate(e,t,i,r){this._compilerHandler&&this._compilerHandler.onRuleTemplate(e,t,i,r)}onDimension(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onDimension(e,t,i,r,n,s)}onDelDimension(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelDimension(e,t,i,r)}onBoss(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onBoss(e,t,i,r,n,s)}onDelBoss(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelBoss(e,t,i,r)}onShellEntity(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onShellEntity(e,t,i,r,n,s)}onDelShellEntity(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelShellEntity(e,t,i,r)}onShellCut(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onShellCut(e,t,i,r,n,s)}onDelShellCut(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelShellCut(e,t,i,r)}onCrease(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onCrease(e,t,i,r,n,s)}onDelCrease(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelCrease(e,t,i,r)}onShell(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onShell(e,t,i,r,n,s)}onDelShell(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelShell(e,t,i,r)}onFpcFill(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onFpcFill(e,t,i,r,n,s)}onDelFpcFill(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelFpcFill(e,t,i,r)}onTeardrop(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onTeardrop(e,t,i,r,n,s)}onDelTeardrop(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelTeardrop(e,t,i,r)}onImage(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onImage(e,t,i,r,n,s)}onDelImage(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelImage(e,t,i,r)}onPoured(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onPoured(e,t,i,r,n,s)}onDelPoured(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelPoured(e,t,i,r)}onPour(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onPour(e,t,i,r,n,s)}onDelPour(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelPour(e,t,i,r)}onRegion(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onRegion(e,t,i,r,n,s)}onDelRegion(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelRegion(e,t,i,r)}onFill(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onFill(e,t,i,r,n,s)}onDelFill(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelFill(e,t,i,r)}onPoly(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onPoly(e,t,i,r,n,s)}onDelPoly(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelPoly(e,t,i,r)}onEQLenGrp(e,t,i,r,n){this._compilerHandler&&this._compilerHandler.onEQLenGrp(e,t,i,r,n)}onDelEQLenGrp(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelEQLenGrp(e,t,i,r)}onDelProp(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelProp(e,t,i,r)}onObj(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onObj(e,t,i,r,n,s)}onDelObj(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelObj(e,t,i,r)}onArc(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onArc(e,t,i,r,n,s)}onDelArc(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelArc(e,t,i,r)}onCArc(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onCArc(e,t,i,r,n,s)}onDelCArc(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelCArc(e,t,i,r)}onLine(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onLine(e,t,i,r,n,s)}onDelLine(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelLine(e,t,i,r)}onPad(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onPad(e,t,i,r,n,s)}onDelPad(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelPad(e,t,i,r)}onVia(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onVia(e,t,i,r,n,s)}onDelVia(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelVia(e,t,i,r)}onDelConnect(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelConnect(e,t,i,r)}onPreference(e,t,i,r){this._compilerHandler&&this._compilerHandler.onPreference(e,t,i,r)}onSilkOpts(e,t,i,r,n){this._compilerHandler&&this._compilerHandler.onSilkOpts(e,t,i,r,n)}onDelSilkOpts(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelSilkOpts(e,t,i,r)}onPrimitive(e,t,i,r,n){this._compilerHandler&&this._compilerHandler.onPrimitive(e,t,i,r,n)}onDelPrimitive(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelPrimitive(e,t,i,r)}onNet(e,t,i,r,n){this._compilerHandler&&this._compilerHandler.onNet(e,t,i,r,n)}onDelNet(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelNet(e,t,i,r)}onPartition(e,t,i,r,n,s){this._compilerHandler&&this._compilerHandler.onPartition(e,t,i,r,n,s)}onDelPartition(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelPartition(e,t,i,r)}onActiveLayer(e,t,i,r){this._compilerHandler&&this._compilerHandler.onActiveLayer(e,t,i,r)}onLayerPhys(e,t,i,r,n){this._compilerHandler&&this._compilerHandler.onLayerPhys(e,t,i,r,n)}onDelLayerPhys(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelLayerPhys(e,t,i,r)}onLayer(e,t,i,r,n){this._compilerHandler&&this._compilerHandler.onLayer(e,t,i,r,n)}onDelLayer(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDelLayer(e,t,i,r)}onCanvas(e,t,i,r){this._compilerHandler&&this._compilerHandler.onCanvas(e,t,i,r)}onDocDetail(e,t,i,r){this._compilerHandler&&this._compilerHandler.onDocDetail(e,t,i,r)}onStringNum(e,t){this._compilerHandler&&this._compilerHandler.onStringNum(e,t)}onAttrNum(e,t){this._compilerHandler&&this._compilerHandler.onAttrNum(e,t)}onDimensionNum(e,t){this._compilerHandler&&this._compilerHandler.onDimensionNum(e,t)}onBossNum(e,t){this._compilerHandler&&this._compilerHandler.onBossNum(e,t)}onShellEntityNum(e,t){this._compilerHandler&&this._compilerHandler.onShellEntityNum(e,t)}onShellCutNum(e,t){this._compilerHandler&&this._compilerHandler.onShellCutNum(e,t)}onCreaseNum(e,t){this._compilerHandler&&this._compilerHandler.onCreaseNum(e,t)}onShellNum(e,t){this._compilerHandler&&this._compilerHandler.onShellNum(e,t)}onFpcFillNum(e,t){this._compilerHandler&&this._compilerHandler.onFpcFillNum(e,t)}onTeardropNum(e,t){this._compilerHandler&&this._compilerHandler.onTeardropNum(e,t)}onImageNum(e,t){this._compilerHandler&&this._compilerHandler.onImageNum(e,t)}onPouredNum(e,t){this._compilerHandler&&this._compilerHandler.onPouredNum(e,t)}onPourNum(e,t){this._compilerHandler&&this._compilerHandler.onPourNum(e,t)}onRegionNum(e,t){this._compilerHandler&&this._compilerHandler.onRegionNum(e,t)}onFillNum(e,t){this._compilerHandler&&this._compilerHandler.onFillNum(e,t)}onPolyNum(e,t){this._compilerHandler&&this._compilerHandler.onPolyNum(e,t)}onObjNum(e,t){this._compilerHandler&&this._compilerHandler.onObjNum(e,t)}onArcNum(e,t){this._compilerHandler&&this._compilerHandler.onArcNum(e,t)}onCArcNum(e,t){this._compilerHandler&&this._compilerHandler.onCArcNum(e,t)}onLineNum(e,t){this._compilerHandler&&this._compilerHandler.onLineNum(e,t)}onPadNum(e,t){this._compilerHandler&&this._compilerHandler.onPadNum(e,t)}onViaNum(e,t){this._compilerHandler&&this._compilerHandler.onViaNum(e,t)}onPartitionNum(e,t){this._compilerHandler&&this._compilerHandler.onPartitionNum(e,t)}},Tw=(e=>(e.CREATE="/pro-mgr/library/lib/create",e.UPDATE="/pro-mgr/library/lib/update",e.CANCEL_ASSOCIATE="/pro-mgr/library/lib/cancelAssociate",e.DELETE="/pro-mgr/library/lib/delete",e.BATCH_GET="/pro-mgr/library/lib/batchGet",e.GET="/pro-mgr/library/lib/get",e.GET1="/pro-mgr/library/lib/get1",e.CREATE1="/pro-mgr/library/lib/create1",e.UPDATE1="/pro-mgr/library/lib/update1",e.UPDATE_DEVICES="/pro-mgr/library/lib/updateDevices",e.STAR="/pro-mgr/library/lib/star",e.UNSTAR="/pro-mgr/library/lib/unstar",e.FORCE="/pro-mgr/library/lib/force",e.UPLOAD="/pro-mgr/library/lib/upload",e.DEVICE_LIST="/pro-mgr/library/lib/device/list",e.DEVICE_SEARCH_LIST="/pro-mgr/library/lib/device/searchList",e.DEVICE_SEARCH_BY_USERS_AND_TITLES="/pro-mgr/library/lib/device/searchByUsersAndTitles",e.DEVICE_GET_ATTR_VALUES="/pro-mgr/library/lib/device/getAttributeValues",e.DEVICE_GET_ATTR_KEYS="/pro-mgr/library/lib/device/getAttrKeys",e.COMPONENT_LIST="/pro-mgr/library/lib/component/list",e.COMPONENT_SEARCH_LIST="/pro-mgr/library/lib/component/searchList",e.COMPONENT_SEARCH_BY_USERS_AND_TITLES="/pro-mgr/library/lib/component/searchByUsersAndTitles",e))(Tw||{}),ww=(e=>(e.GET_DEVICE="/pro-mgr/library/sheetSymbol/getDevice",e.GET_SYMBOL="/pro-mgr/library/sheetSymbol/getSymbol",e.FORCE="/pro-mgr/library/sheetSymbol/force",e.GET="/pro-mgr/library/sheetSymbol/get",e.CREATE="/pro-mgr/library/sheetSymbol/create",e.UPDATE="/pro-mgr/library/sheetSymbol/update",e.SET_CUSTOM="/pro-mgr/library/sheetSymbol/setCustom",e))(ww||{}),Rz={LIB:Tw,SHEET_SYMBOL:ww};async function Rw(e,t,i,r){let{message:n}=await Re.messageBus.rpcCall(Rz.LIB.COMPONENT_SEARCH_LIST,{titles:JSON.stringify([e]),docType:[+t],type:i,user_uuid:r,path:r});return n&&n.success?n:{...n}}async function Lz(e,t,i,r,n=!1){let s=await Rw(e,t,i,r);if(!s.success||s.result===null)return{isExist:!1,component:null};if(bx)return n===!0?{isExist:!1,component:null}:{isExist:s&&s.result?s.result.length>0:!1,component:s.result};let a=[];s&&s.success&&s.result&&(s.result instanceof Array?a=s.result:a=s.result[e]||[]);let o=a.filter(l=>l.owner.uuid==r);return{isExist:o.length>0,component:o||null}}function Nz(e,t){let i=0;return function(...r){let n=new Date().getTime();n-i>t&&(e.apply(this,r),i=n)}}function Dz(e,t,i){let r,n,s,a,o,l,u=0,c=!1,h=!1,m=!0;if(typeof e!="function")throw new TypeError("Expected a function");t=Number(t)||0,typeof i=="object"&&(c=!!i.leading,h="maxWait"in i,s=h?Math.max(Number(i.maxWait)||0,t):s,m="trailing"in i?!!i.trailing:m);function f(T){let R=r,L=n;return r=n=void 0,u=T,a=e.apply(L,R),a}function g(T){return u=T,o=window.setTimeout(E,t),c?f(T):a}function y(T){let R=T-l,L=T-u,O=t-R;return h?Math.min(O,s-L):O}function b(T){let R=T-l,L=T-u;return l===void 0||R>=t||R<0||h&&L>=s}function E(){let T=Date.now();if(b(T))return S(T);o=window.setTimeout(E,y(T))}function S(T){return o=void 0,m&&r?f(T):(r=n=void 0,a)}function v(){o!==void 0&&clearTimeout(o),u=0,r=l=n=o=void 0}function A(){return o===void 0?a:S(Date.now())}function x(){let T=Date.now(),R=b(T);if(r=arguments,n=this,l=T,R){if(o===void 0)return g(l);if(h)return o=window.setTimeout(E,t),f(l)}return o===void 0&&(o=window.setTimeout(E,t)),a}return x.cancel=v,x.flush=A,x}var ko=new Map;ko.set("<","&lt;"),ko.set(">","&gt;"),ko.set('"',"&quot;"),ko.set("'","&apos;"),ko.set("&","&amp;");function Lw(e){if(typeof e!="string")return e;if(e==null)return"";function t(i){return ko.get(i)}return e==null?"":mf(e,ko)?(e+"").replace(/[<>'"&]/g,t):e}var Bo=new Map;Bo.set("&lt;","<"),Bo.set("&gt;",">"),Bo.set("&quot;",'"'),Bo.set("&apos;","'"),Bo.set("&amp;","&"),Bo.set("&#039;","'");function Bz(e){if(typeof e!="string")return e;if(e==null)return"";let t={"&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&amp;":"&","&#039;":"'"};function i(r){return Bo.get(r)}return mf(e,t)?(e+"").replace(/&([^;]+);/g,i):e}var Wc=new Map;Wc.set("~","&#126;"),Wc.set("^","&#94;"),Wc.set("#@$","&#35;&#64;&#36;"),Wc.set("`","&#96;");function Oz(e){if(typeof e!="string")return e;if(e==null)return"";let t={"~":"&#126;","^":"&#94;","#@$":"&#35;&#64;&#36;","`":"&#96;"};function i(r){return Wc.get(r)}return mf(e,t)?e.replace(/(\~|\^|#@\$|\`)/g,i):e}function Xb(e){if(typeof e!="object"||e===null||e===void 0)return e;if(Array.isArray(e))return e.map(Xb);{let t={};for(let i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=Xb(e[i]));return t}}function Jb(e){if(typeof e!="object"||e===null||e instanceof Date)return typeof e=="string"&&e.includes("<")&&(e=Lw(e)),e;if(Array.isArray(e))return e.map(Jb);{let t={};for(let i in e)e.hasOwnProperty(i)&&(t[i]=Jb(e[i]));return t}}function Mz(e,t){let i="",r="";for(let n=0;n<e.length;n++)String(e[n])&&(r+=e[n]+"	");r=r.slice(0,-1),i+=r+`\r
`;for(let n=0;n<t.length;n++){r="";for(let s=0;s<e.length;s++)r+='"'+(typeof t[n][s]<"u"?t[n][s]:"")+'"	';r=r.slice(0,r.length-1),i+=r+`\r
`}return i}function kz(e,t={targetType:"blob"}){let{targetType:i,width:r,height:n}=t,s=new Image(r,n);return new Promise((a,o)=>{s.onload=function(){let l=document.createElement("canvas"),u=l.getContext("2d");switch(l.width=s.width,l.height=s.height,u.drawImage(s,0,0,s.width,s.height),i){case"dataURL":{a(l.toDataURL());break}case"blob":default:{l.toBlob(c=>{a(c)});break}}},s.onerror=l=>{o(l)},s.src=e})}async function Fz(e,t={}){return new Promise((i,r)=>{try{let{targetType:n="blob",imageType:s="image/png"}=t,a=document.createElement("canvas"),o=a.getContext("2d");switch(a.width=e.width,a.height=e.height,o.putImageData(e,0,0),n){case"dataURL":{i(a.toDataURL(s));break}case"blob":default:{a.toBlob(l=>{i(l)},s);break}}}catch(n){r(n)}})}var Uz=class extends I0{constructor(e){super(),this._action=e}get action(){return this._action}onAttr(e,t,i){i||this.action(t.key,t.value)}};async function Hz(e,t,i,r=!0){let n={initResponse:null,d3modelItem:null,d3modelItemName:void 0,d3modelItemTransform:void 0,d3modelItemPath:void 0,d3modelItemId:void 0,compiler:null},s=new Map;return new Promise(async a=>{let o=new xw(e,t,i);n.compiler=o,o.setHandler(new Uz(async(l,u)=>{if(typeof u<"u"&&s.set(l,u),s.has("3D Model")&&s.has("3D Model Title")&&s.has("3D Model Transform")){n.d3modelItemId=s.get("3D Model"),n.d3modelItemName=s.get("3D Model Title"),n.d3modelItemTransform=s.get("3D Model Transform");let c=pd(n.d3modelItemId,!0);n.d3modelItemPath=c.path}})),n.initResponse=await o.init(),n.d3modelItemId&&r&&(n.d3modelItem=await fd(n.d3modelItemId)),n.compiler.destroy(),s.clear(),a(n)})}async function jz(e,t){let i={padList:[]};return new Promise(async r=>{try{let n=new CG(e,t,!0),s=await n.getPads()||{},a=Object.keys(s);for(let o=0;o<a.length;o++)i.padList.push({...s[a[o]]});n.destroy(),r(i)}catch{r(i)}})}function Yz(e,t,i){if(typeof e!="number"&&(e=+e),isNaN(e))return NaN;if(t=t|0,t<=0||!e&&!i)return Math.round(e);let r=[1,10,100,1e3][t]||Math.pow(10,t)||10;if(i){let n=e<0?"-":"";for(e=e<0?-e:e,e=Math.round(e*r)+"";e.length<=t;)e="0"+e;return e=e.slice(0,-t)+"."+e.slice(-t),n+e}else return Math.round(e*r+1e-10)/r}function Gz(e,t){typeof e=="string"&&(e=parseFloat(e));let i=Math.pow(10,t);return Math.round(e*i)/i}var Wz={conversion(e,t,i){let r=e+2+t;return this[r](i)},conversion1(e,t,i){let r=e+2+t,n=this[r](i);return t=="mil"?Math.round(n*10)/10:Math.round(n*1e3)/1e3},mil2mil(e){return e},mil2mm(e){return e*.0254},mil2cm(e){return e*.00254},mil2inch(e){return e/1e3},mm2mm(e){return e},mm2mil(e){let t=Math.pow(10,5);return Math.round(e*39.37007874015748*t)/t},mm2cm(e){return e/10},mm2inch(e){let t=Math.pow(10,8);return Math.round(e*.03937007874015748*t)/t},cm2mil(e){let t=Math.pow(10,6);return Math.round(e*3.937007874015748*t)/t},cm2mm(e){return e*10},cm2inch(e){let t=Math.pow(10,7);return Math.round(e*.3937007874015748*t)/t},inch2mil(e){return e*1e3},inch2mm(e){return e*25.4},inch2cm(e){return e*2.54}};function zz(e,t,i){var r=e-t;return i||(i=1e-10),(r>0?r:-r)<i}function Vz(e){return e<0?(360+e%360)%360:e>=360?e%360:e}function Nw(e,t,i,r){var n=e-i,s=t-r;return n*n+s*s}function qz(e,t,i,r){return Math.sqrt(Nw(e,t,i,r))}function Xz(e,t,i,r){var n=i-e,s=r-t,a=Math.atan2(s,n);return a=a<0?a+Math.PI+Math.PI:a,a}function Jz(e){return Dw(e)&&Object.keys(e).length===0}function Dw(e){return Object.prototype.toString.call(e).slice(8,-1)==="Object"}function $z(e){return Bw(e)||Ow(e)}function Bw(e){return Object.prototype.toString.call(e).slice(8,-1)==="AsyncFunction"}function Ow(e){return Object.prototype.toString.call(e).slice(8,-1)==="Function"}var at,Kz=(at=class{},at.unitConversion=Wz,at.ConcurrencyTaskQueue=Tz,at.FootprintCompilerInstance=xw,at.FootprintCompilerHandlerProxy=I0,at.FootprintCompilerAttr=wz,at.createCSVString=Mz,at.svg2png=kz,at.imageData2NewImage=Fz,at.htmlEncode=Lw,at.htmlDecode=Bz,at.strEncode=Oz,at.isEmptyObj=Jz,at.isPlainObject=Dw,at.isFn=$z,at.isAsyncFunction=Bw,at.isNormalFunction=Ow,at.formatDate=Vo,at.formatDate2=BW,at.deepClone=Xb,at.deepCloneWithHtmlEncode=Jb,at.naturalSortComparator=mx,at.naturalSortSplitor=xb,at.naturalSort=JU,at.naturalStrSort=$U,at.naturalSort1=KU,at.naturalCompare=ZU,at.isObjKeyInStr=mf,at.throttle=Nz,at.debounce=Dz,at.findList=ur,at.findListAll=FW,at.randomString=t7,at.parseJSON=i7,at.splitComponentId2FolderAndFilenameMixin=pd,at.queryExistSameNameDocDetail=Rw,at.checkComponentNameDuplicate=Lz,at.getFootprintPadInfo=jz,at.getFootprint3DInfo=Hz,at),Sn,pte=(Sn=class{},Sn.toFixed=Yz,Sn.toFixed1=Gz,Sn.floatEqual=zz,Sn.fixAngle=Vz,Sn.getDistance=qz,Sn.getDistance2=Nw,Sn.getAngleByDot=Xz,Sn),Ga,Wi=(Ga=class{constructor(){this._changeCbs=new Set,this._map=new Map,this._debounceNotify=Kz.debounce(()=>{this._notify()},50)}static get context(){return An()}static getInstance(){var t;return(t=this.context.extendLibManager)!=null?t:this.context.extendLibManager=new Ga}_notify(){for(let t of this._changeCbs)t()}onChange(t){this._changeCbs.add(t)}offChange(t){this._changeCbs.delete(t)}_getLibId(t){return`${Ga.LIB_ID_PREFFIX}${t}`}async addLib(t){let i=this._getLibId(t.title);return this._map.set(i,await xz.set({...t,id:i})),this._debounceNotify(),i}deleteLib(t){return this._debounceNotify(),this._map.delete(t)}hasLib(t){return this._map.has(t)}getLib(t){return this._map.get(t)}getLibs(){return Array.from(this._map.values())}updateLibTitle(t,i){let r=this._map.get(t);r&&(r.title=i,this._debounceNotify())}},Ga.LIB_ID_PREFFIX="extend_lib_",Ga),Mw=class extends v0{async getOrigin(){var r,n;let{path:e,uuid:t,isProject:i}=this.data;if(hu(this.data)){let{override:s}=this.data;if(s&&s.attributes)return{success:!1,message:"Api call error!"};if(i){let{message:a}=await Re.messageBus.rpcCall("/pro-mgr/hasProject",[e]);if(a){let o=[t,e],l=(await Re.messageBus.rpcCall(Qe.DEVICE.GET,o)).message;if(l){let u=Object.assign(l,{uuid:t,path:e});this.origin=await this.getTemplate(u,s)}else return{success:!1,message:"Device details data does not exist"}}else return{success:!1,message:"Get project library data source Project is not open!"}}else if(Wi.getInstance().hasLib(e)){let a=await((n=(r=Wi.getInstance().getLib(e))==null?void 0:r.device)==null?void 0:n.getTransformedDetail(t));if(a){let o=Object.assign(a,{uuid:t,path:e});this.origin=await this.getTemplate(o,s)}else return{success:!1,message:"Device details data does not exist"}}else{let a={path:e,uuid:t},{message:o}=await Re.messageBus.rpcCall(ua.DEVICE.GET,a);if(o.success){let l=o.result,u=Object.assign(l,{uuid:t,path:e});this.origin=await this.getTemplate(u,s)}else return{success:!1,code:o.code,message:o.message}}}else{let s=this.data.data;this.origin=await this.onHandle(s)}return{success:!0,result:this.origin}}async renaming(e){let t=e.display_title||e.title,i=[t,this.path],r=(await Re.messageBus.rpcCall(Qe.DEVICE.TRY_RENAME,i)).message;return r&&(e.display_title=e.title=r),t!==r&&da.renamedDevice([t]),{success:!0}}},Zz=class extends Mw{onHandle(e){return this.onAdd(e)}async matching(e){if(this.byUUID){let t=[e.uuid,this.path],i=await(await Re.messageBus.rpcCall(Qe.DEVICE.GET,t)).message;if(e.ticket&&(i!=null&&i.ticket)&&(i==null?void 0:i.ticket)===e.ticket)return i}if(e.source){if(this.byVersion){let t=[e.source,e.version,this.path],i=(await Re.messageBus.rpcCall(Qe.DEVICE.GET_BY_SOURCE_VERSION,t)).message;if(i)return da.sameVersionDevice([e.display_title||e.title]),i}if(this.bySource){let t=[e.source,this.path],i=(await Re.messageBus.rpcCall(Qe.DEVICE.GET_LAST,t)).message;if(i)return da.diffVersionDevice([e.display_title||e.title]),i}}}async isRename(e){let t=[e.display_title||e.title,this.path];return(await Re.messageBus.rpcCall(Qe.DEVICE.IS_RENAME,t)).message?{success:!1,message:"Device duplicate name"}:{success:!0}}async start(){let e=await this.getOrigin();if(!e.success)return{success:!1,code:e.code,message:e.message};let t,i;if(this.origin){let r=await this.match(this.origin);if(r)t={success:!0,result:r};else{let n=await this.rename(this.origin);if(!n.success)return{success:!1,code:n.code,message:n.message};i=this.origin}}return{success:!0,result:{respond:t,addData:i}}}},kw=class extends v0{async getOrigin(){var r,n;let{path:e,uuid:t,isProject:i}=this.data;if(hu(this.data)){let{override:s}=this.data;if(i){let{message:a}=await Re.messageBus.rpcCall("/pro-mgr/hasProject",[e]);if(a){let o=[t,e],l=(await Re.messageBus.rpcCall(Qe.FOOTPRINT.GET,o)).message;if(l){let u=Object.assign(l,{uuid:t,path:e});this.origin=await this.getTemplate(u,s)}else return{success:!1,message:"Footprint details data does not exist"}}else return{success:!1,message:"Get project library data source Project is not open!"}}else if(Wi.getInstance().hasLib(e)){let a=await((n=(r=Wi.getInstance().getLib(e))==null?void 0:r.footprint)==null?void 0:n.getTransformedDetail(t));if(a){let o=Object.assign(a,{uuid:t,path:e});this.origin=await this.getTemplate(o,s)}else return{success:!1,message:"Footprint details data does not exist"}}else{let a={path:e,uuid:t},{message:o}=await Re.messageBus.rpcCall(ua.COMPONENT.GET,a);if(o.success){let l=o.result,u=Object.assign(l,{uuid:t,path:e});this.origin=await this.getTemplate(u,s)}else return{success:!1,code:o.code,message:o.message}}}else{let s=this.data.data;this.origin=await this.onHandle(s)}return{success:!0,result:this.origin}}async renaming(e){let t=e.display_title||e.title,i=[t,this.path],r=(await Re.messageBus.rpcCall(Qe.FOOTPRINT.TRY_RENAME,i)).message;return r&&(e.display_title=e.title=r),t!==r&&da.renamedFootprint([t]),{success:!0}}},A0=class extends kw{onHandle(e){return this.onAdd(e)}async matching(e){if(this.byUUID){let t=[e.uuid,this.path],i=(await Re.messageBus.rpcCall(Qe.FOOTPRINT.GET,t)).message;if(e.ticket&&(i!=null&&i.ticket)&&(i==null?void 0:i.ticket)===e.ticket)return i}if(e.source){if(this.byVersion){let t=[e.source,e.version,this.path],i=(await Re.messageBus.rpcCall(Qe.FOOTPRINT.GET_BY_SOURCE_VERSION,t)).message;if(i)return da.sameVersionFootprint([e.display_title||e.title]),i}if(this.bySource){let t=[e.source,this.path],i=(await Re.messageBus.rpcCall(Qe.FOOTPRINT.GET_LAST,t)).message;if(i)return da.diffVersionFootprint([e.display_title||e.title]),i}}}async isRename(e){let t=[e.display_title||e.title,this.path];return(await Re.messageBus.rpcCall(Qe.FOOTPRINT.IS_RENAME,t)).message?{success:!1,message:"Library duplicate name"}:{success:!0}}async start(){let e=await this.getOrigin();if(!e.success)return{success:!1,code:e.code,message:e.message};let t,i;if(this.origin){let r=await this.match(this.origin);if(r)t={success:!0,result:r};else{let n=await this.rename(this.origin);if(!n.success)return{success:!1,code:n.code,message:n.message};i=this.origin}}return{success:!0,result:{respond:t,addData:i}}}},Fw=class extends v0{async getOrigin(){var r,n;let{path:e,uuid:t,isProject:i}=this.data;if(hu(this.data)){let{override:s}=this.data;if(i){let{message:a}=await Re.messageBus.rpcCall("/pro-mgr/hasProject",[e]);if(a){let o=[t,e],l=(await Re.messageBus.rpcCall(Qe.SYMBOL.GET,o)).message;if(l){let u=Object.assign(l,{uuid:t,path:e});this.origin=await this.getTemplate(u,s)}else return{success:!1,message:"Symbol details data does not exist"}}else return{success:!1,message:"Get project library data source Project is not open!"}}else if(Wi.getInstance().hasLib(e)){let a=await((n=(r=Wi.getInstance().getLib(e))==null?void 0:r.symbol)==null?void 0:n.getTransformedDetail(t));if(a){let o=Object.assign(a,{uuid:t,path:e});this.origin=await this.getTemplate(o,s)}else return{success:!1,message:"Symbol details data does not exist"}}else{let a={path:e,uuid:t},{message:o}=await Re.messageBus.rpcCall(ua.COMPONENT.GET,a);if(o.success){let l=o.result,u=Object.assign(l,{uuid:t,path:e});this.origin=await this.getTemplate(u,s)}else return{success:!1,code:o.code,message:o.message}}}else{let s=this.data.data;this.origin=await this.onHandle(s)}return{success:!0,result:this.origin}}async renaming(e){let t=e.display_title||e.title,i=[t,this.path],r=(await Re.messageBus.rpcCall(Qe.SYMBOL.TRY_RENAME,i)).message;return r&&(e.display_title=e.title=r),t!==r&&da.renamedSymbol([t]),{success:!0}}},C0=class extends Fw{onHandle(e){return this.onAdd(e)}async matching(e){if(this.byUUID){let t=[e.uuid,this.path],i=(await Re.messageBus.rpcCall(Qe.SYMBOL.GET,t)).message;if(e.ticket&&(i!=null&&i.ticket)&&(i==null?void 0:i.ticket)===e.ticket)return i}if(e.source){if(this.byVersion){let t=[e.source,e.version,this.path],i=(await Re.messageBus.rpcCall(Qe.SYMBOL.GET_BY_SOURCE_VERSION,t)).message;if(i)return da.sameVersionSymbol([e.display_title||e.title]),i}if(this.bySource){let t=[e.source,this.path],i=(await Re.messageBus.rpcCall(Qe.SYMBOL.GET_LAST,t)).message;if(i)return da.diffVersionSymbol([e.display_title||e.title]),i}}}async isRename(e){let t=[e.display_title||e.title,this.path];return(await Re.messageBus.rpcCall(Qe.SYMBOL.IS_RENAME,t)).message?{success:!1,message:"Library duplicate name"}:{success:!0}}async start(){let e=await this.getOrigin();if(!e.success)return{success:!1,code:e.code,message:e.message};let t,i;if(this.origin){let r=await this.match(this.origin);if(r)t={success:!0,result:r};else{let n=await this.rename(this.origin);if(!n.success)return{success:!1,code:n.code,message:n.message};i=this.origin}}return{success:!0,result:{respond:t,addData:i}}}},x0=class{constructor(e){this.path=e}async check(){let{message:{hasPermission:e,errMsg:t}}=await Re.messageBus.rpcCall("canAddLib",[this.path]);return e?{success:!0}:{success:!1,message:t||"You don't have permission!"}}},Qz=(e=>(e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.LOGIN_FAIL=402]="LOGIN_FAIL",e[e.PERMISSION_DENIED=422]="PERMISSION_DENIED",e[e.PERMISSION_DENIED1=1111111]="PERMISSION_DENIED1",e[e.PERMISSION_DENIED_PARAMS=1111112]="PERMISSION_DENIED_PARAMS",e[e.DATA_NOT_FOUND=1111113]="DATA_NOT_FOUND",e[e.PARAMS_DATA_NOT_FOUND=1111114]="PARAMS_DATA_NOT_FOUND",e[e.REQUEST_PARAM_ILLEGAL=42222]="REQUEST_PARAM_ILLEGAL",e[e.REQUEST_PARAM_ILLEGAL1=1111115]="REQUEST_PARAM_ILLEGAL1",e[e.REQUEST_PARAMS_ILLEGAL2=1111116]="REQUEST_PARAMS_ILLEGAL2",e[e.REQUEST_PARAMS_NOT_NULL=1111117]="REQUEST_PARAMS_NOT_NULL",e[e.REQUEST_PARAMS_NOT_ALL_NULL=1111118]="REQUEST_PARAMS_NOT_ALL_NULL",e[e.REQUEST_PARAMS_MUST_ARRAY=1111119]="REQUEST_PARAMS_MUST_ARRAY",e[e.REQUEST_PARAMS_MUST_STRING=1111120]="REQUEST_PARAMS_MUST_STRING",e[e.REQUEST_PARAMS_MUST_NUMBER=1111121]="REQUEST_PARAMS_MUST_NUMBER",e[e.REQUEST_PARAMS_MUST_NUMBER_ARRAY=1111122]="REQUEST_PARAMS_MUST_NUMBER_ARRAY",e[e.REQUEST_PARAMS_MUST_STRING_ARRAY=1111123]="REQUEST_PARAMS_MUST_STRING_ARRAY",e[e.REQUEST_PARAMS_LENGTH_ERROR=1111124]="REQUEST_PARAMS_LENGTH_ERROR",e[e.REQUEST_PARAMS_TYPE_ERROR=1111125]="REQUEST_PARAMS_TYPE_ERROR",e[e.ILLEGAL_NAME=2001]="ILLEGAL_NAME",e[e.ILLEGAL_NAME1=1111126]="ILLEGAL_NAME1",e[e.ILLEGAL_NAME_ZH=1111128]="ILLEGAL_NAME_ZH",e[e.UUID_ERROR=1111127]="UUID_ERROR",e[e.DUPLICATE_DATA=1000001]="DUPLICATE_DATA",e[e.DUPLICATE_DATA1=11e3]="DUPLICATE_DATA1",e[e.DUPLICATE_DATA_PARAMS=1000017]="DUPLICATE_DATA_PARAMS",e[e.UPLOAD_LIMIT=10034]="UPLOAD_LIMIT",e[e.MORE_THAN_LIMIT=1000003]="MORE_THAN_LIMIT",e[e.FILE_MORE_THAN_LIMIT=1000004]="FILE_MORE_THAN_LIMIT",e[e.PARAMS_MORE_THAN_LIMIT=1000005]="PARAMS_MORE_THAN_LIMIT",e[e.IMAGE_MORE_THAN_LIMIT_PARAMS=1000006]="IMAGE_MORE_THAN_LIMIT_PARAMS",e[e.FILE_MORE_THAN_LIMIT_PARAMS=1000007]="FILE_MORE_THAN_LIMIT_PARAMS",e[e.END_MUST_AFTER_START=1000019]="END_MUST_AFTER_START",e[e.REQUEST_PARAMS_TIME_ERROR=1000009]="REQUEST_PARAMS_TIME_ERROR",e[e.FILES_PATH_NOT_FOUND=1000018]="FILES_PATH_NOT_FOUND",e[e.FILES_DATA_NOT_FOUND=1000011]="FILES_DATA_NOT_FOUND",e[e.FILES_TYPE_ERROR=1000012]="FILES_TYPE_ERROR",e[e.FILES_TYPE_MUST_BE_ONE=1000013]="FILES_TYPE_MUST_BE_ONE",e[e.SET_WATERMARK_FAIL=1000014]="SET_WATERMARK_FAIL",e[e.MYSQL_CRUD_ERROR=1000015]="MYSQL_CRUD_ERROR",e[e.PARAMS_JSON_FAILED=1000016]="PARAMS_JSON_FAILED",e[e.MYSQL_ERROR=3000001]="MYSQL_ERROR",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.PRJ_NAME_EXISTS=2002]="PRJ_NAME_EXISTS",e[e.BACKUP_NAME_EXISTS=3002]="BACKUP_NAME_EXISTS",e[e.PRJ_NOT_EXIST=2000001]="PRJ_NOT_EXIST",e[e.ERROR_PATH=4000002]="ERROR_PATH",e[e.PROJECT_NOT_FOUND=6000001]="PROJECT_NOT_FOUND",e[e.TITLE_ILLEGAL_LEN=2003]="TITLE_ILLEGAL_LEN",e[e.FILE_READ_ONLY=1000002]="FILE_READ_ONLY",e[e.FILE_READ_ONLY1=1000008]="FILE_READ_ONLY1",e[e.DATA_NOT_EXIST=1000010]="DATA_NOT_EXIST",e[e.LIB_NOT_EXIST=2000001]="LIB_NOT_EXIST",e[e.CONFIG_API_URLS_ERROR=3001001]="CONFIG_API_URLS_ERROR",e[e.ONE_CLICK_ORDER_NOT_OPEN=3001002]="ONE_CLICK_ORDER_NOT_OPEN",e[e.MATERIAL_NOT_OPEN=3001003]="MATERIAL_NOT_OPEN",e[e.SNAPSHOT_DEPTH_LIMIT=3001004]="SNAPSHOT_DEPTH_LIMIT",e[e.OCR_SYMBOL_URL_ERROR=3001005]="OCR_SYMBOL_URL_ERROR",e[e.USER_DATA_NOT_FOUND=4000001]="USER_DATA_NOT_FOUND",e[e.USER_DISABLE_ERROR=4000012]="USER_DISABLE_ERROR",e[e.USER_EXISTS_LOGIN_ERROR=4000003]="USER_EXISTS_LOGIN_ERROR",e[e.USER_UNAUTHORIZED_MODULES_ERROR=4000004]="USER_UNAUTHORIZED_MODULES_ERROR",e[e.USER_UNAUTHORIZED_ACCESS_ERROR=4000005]="USER_UNAUTHORIZED_ACCESS_ERROR",e[e.ADMIN_NOT_CHANGE_PASSWORD=4000006]="ADMIN_NOT_CHANGE_PASSWORD",e[e.SAME_PASSWORD_NEW_PASSWORD=4000007]="SAME_PASSWORD_NEW_PASSWORD",e[e.USER_ONLINE_REGISTRATION_FAILED=4000008]="USER_ONLINE_REGISTRATION_FAILED",e[e.USER_PASSWORD_CAN_NOT_DEFAULT=4000009]="USER_PASSWORD_CAN_NOT_DEFAULT",e[e.USER_BEFORE_PASSWORD_ERROR=4000010]="USER_BEFORE_PASSWORD_ERROR",e[e.USER_PASSWORD_LENGTH_ERROR=4000011]="USER_PASSWORD_LENGTH_ERROR",e[e.ORG_ROLE_NOT_CREATE=5000001]="ORG_ROLE_NOT_CREATE",e[e.ORG_ROLE_NAME_DUPLICATE=5000002]="ORG_ROLE_NAME_DUPLICATE",e[e.ORG_ROLE_ORIGIN_ERROR=5000003]="ORG_ROLE_ORIGIN_ERROR",e[e.ORG_ROLE_NOT_DEFAULT=5000004]="ORG_ROLE_NOT_DEFAULT",e[e.ADMIN_ROLE_NOT_CHANGE=5000005]="ADMIN_ROLE_NOT_CHANGE",e[e.ADMIN_NOT_CHANGE_STATUS=5000006]="ADMIN_NOT_CHANGE_STATUS",e[e.PROJECT_ARCHIVED=6000002]="PROJECT_ARCHIVED",e[e.PROJECT_UUID_NULL=6000003]="PROJECT_UUID_NULL",e[e.PROJECT_UUID_ERROR=6000004]="PROJECT_UUID_ERROR",e[e.PROJECT_OR_TEAM_UUID_ERROR=6000005]="PROJECT_OR_TEAM_UUID_ERROR",e[e.PROJECT_NOT_PERSON_ERROR=6000006]="PROJECT_NOT_PERSON_ERROR",e[e.PROJECT_DUPLICATE_NAME=6000007]="PROJECT_DUPLICATE_NAME",e[e.ANNOTATION_HAS_BE_FOUND=6000008]="ANNOTATION_HAS_BE_FOUND",e[e.ANNOTATION_NOT_FOUND=6000009]="ANNOTATION_NOT_FOUND",e[e.ANNOTATION_CREATE_ERROR=6000010]="ANNOTATION_CREATE_ERROR",e[e.ANNOTATION_UPDATE_ERROR=6000011]="ANNOTATION_UPDATE_ERROR",e[e.ANNOTATION_DELETE_ERROR=6000012]="ANNOTATION_DELETE_ERROR",e[e.PROJECT_DUPLICATE_PATH=6000013]="PROJECT_DUPLICATE_PATH",e[e.TEAM_NOT_FOUND=7000001]="TEAM_NOT_FOUND",e[e.TEAM_UUID_NULL=7000002]="TEAM_UUID_NULL",e[e.TEAM_FOLDER_ERROR=7000003]="TEAM_FOLDER_ERROR",e[e.TEAM_FOLDER_DEEP_ERROR=7000004]="TEAM_FOLDER_DEEP_ERROR",e[e.TEAM_FOLDER_UUID_ERROR=7000005]="TEAM_FOLDER_UUID_ERROR",e[e.TEAM_URL_DUPLICATE=7000006]="TEAM_URL_DUPLICATE",e[e.TEAM_CAN_NOT_DELETE=7000007]="TEAM_CAN_NOT_DELETE",e[e.COMPONENT_UUID_NULL=8000001]="COMPONENT_UUID_NULL",e[e.COMPONENT_DATA_NOT_FOUND=8000002]="COMPONENT_DATA_NOT_FOUND",e[e.COMPONENT_NAME_DUPLICATE=8000003]="COMPONENT_NAME_DUPLICATE",e[e.COMPONENT_TYPE_ERROR=8000004]="COMPONENT_TYPE_ERROR",e[e.DELETE_SON_CATEGORY=8001001]="DELETE_SON_CATEGORY",e[e.LICENSE=9000001]="LICENSE",e[e.START_TIME=9000002]="START_TIME",e[e.END_TIME=9000003]="END_TIME",e[e.PROJECT_LIMIT=9000004]="PROJECT_LIMIT",e[e.USER_LIMIT=9000005]="USER_LIMIT",e[e.ONLINE_NUMBER_LIMIT=9000006]="ONLINE_NUMBER_LIMIT",e[e.COMPANY_CODE=9000007]="COMPANY_CODE",e[e.LIMIT_PCB=9000008]="LIMIT_PCB",e[e.LIMIT_SCH=9000009]="LIMIT_SCH",e[e.LIMIT_PANEL=9000011]="LIMIT_PANEL",e[e.TIME_ERROR=9000010]="TIME_ERROR",e[e.LICENSE_ERROR=9000012]="LICENSE_ERROR",e[e.LICENSE_TYPE_ERROR=9000013]="LICENSE_TYPE_ERROR",e[e.LICENSE_ORIGIN_ERROR=9000014]="LICENSE_ORIGIN_ERROR",e[e.BRANCH_DATA_NOT_FOUND=11000001]="BRANCH_DATA_NOT_FOUND",e[e.PARENT_UUID_ERROR=11000002]="PARENT_UUID_ERROR",e[e.BRANCH_MUST_AFTER_NODE=11000003]="BRANCH_MUST_AFTER_NODE",e[e.BRANCH_NAME_ERROR=11000004]="BRANCH_NAME_ERROR",e[e.BRANCH_NAME_DUPLICATE=11000005]="BRANCH_NAME_DUPLICATE",e[e.BRANCH_UUID_ERROR=11000006]="BRANCH_UUID_ERROR",e[e.BRANCH_NODE_SET_ERROR=11000007]="BRANCH_NODE_SET_ERROR",e[e.BRANCH_DELETE_MAIN_ERROR=11000008]="BRANCH_DELETE_MAIN_ERROR",e[e.BRANCH_CHECK_OUT_ERROR=11000009]="BRANCH_CHECK_OUT_ERROR",e[e.DOCUMENT_UUID_ERROR=12000001]="DOCUMENT_UUID_ERROR",e[e.UPDATE_FAILED=12000002]="UPDATE_FAILED",e[e.INNER_API_KEY_ERROR=1000020]="INNER_API_KEY_ERROR",e[e.BRANCH_MORE_THAN_LIMIT=11000010]="BRANCH_MORE_THAN_LIMIT",e[e.WORKSPACE_API_ERROR=1000021]="WORKSPACE_API_ERROR",e))(Qz||{}),eV=(e=>(e.UNAUTHORIZED="UNAUTHORIZED",e.LOGIN_FAIL="LOGIN_FAIL",e.PERMISSION_DENIED="PERMISSION_DENIED",e.PERMISSION_DENIED1="PERMISSION_DENIED1",e.PERMISSION_DENIED_PARAMS="PERMISSION_DENIED_PARAMS",e.DATA_NOT_FOUND="DATA_NOT_FOUND",e.PARAMS_DATA_NOT_FOUND="PARAMS_DATA_NOT_FOUND",e.REQUEST_PARAM_ILLEGAL="REQUEST_PARAM_ILLEGAL",e.REQUEST_PARAM_ILLEGAL1="REQUEST_PARAM_ILLEGAL1",e.REQUEST_PARAMS_ILLEGAL2="REQUEST_PARAMS_ILLEGAL2",e.REQUEST_PARAMS_NOT_NULL="REQUEST_PARAMS_NOT_NULL",e.REQUEST_PARAMS_NOT_ALL_NULL="REQUEST_PARAMS_NOT_ALL_NULL",e.REQUEST_PARAMS_MUST_ARRAY="REQUEST_PARAMS_MUST_ARRAY",e.REQUEST_PARAMS_MUST_STRING="REQUEST_PARAMS_MUST_STRING",e.REQUEST_PARAMS_MUST_NUMBER="REQUEST_PARAMS_MUST_NUMBER",e.REQUEST_PARAMS_MUST_NUMBER_ARRAY="REQUEST_PARAMS_MUST_NUMBER_ARRAY",e.REQUEST_PARAMS_MUST_STRING_ARRAY="REQUEST_PARAMS_MUST_STRING_ARRAY",e.REQUEST_PARAMS_LENGTH_ERROR="REQUEST_PARAMS_LENGTH_ERROR",e.REQUEST_PARAMS_TYPE_ERROR="REQUEST_PARAMS_TYPE_ERROR",e.ILLEGAL_NAME="ILLEGAL_NAME",e.ILLEGAL_NAME1="ILLEGAL_NAME1",e.ILLEGAL_NAME_ZH="ILLEGAL_NAME_ZH",e.UUID_ERROR="UUID_ERROR",e.DUPLICATE_DATA="DUPLICATE_DATA",e.DUPLICATE_DATA1="DUPLICATE_DATA1",e.DUPLICATE_DATA_PARAMS="DUPLICATE_DATA_PARAMS",e.UPLOAD_LIMIT="UPLOAD_LIMIT",e.MORE_THAN_LIMIT="MORE_THAN_LIMIT",e.FILE_MORE_THAN_LIMIT="FILE_MORE_THAN_LIMIT",e.PARAMS_MORE_THAN_LIMIT="PARAMS_MORE_THAN_LIMIT",e.IMAGE_MORE_THAN_LIMIT_PARAMS="IMAGE_MORE_THAN_LIMIT_PARAMS",e.FILE_MORE_THAN_LIMIT_PARAMS="FILE_MORE_THAN_LIMIT_PARAMS",e.END_MUST_AFTER_START="END_MUST_AFTER_START",e.REQUEST_PARAMS_TIME_ERROR="REQUEST_PARAMS_TIME_ERROR",e.FILES_PATH_NOT_FOUND="FILES_PATH_NOT_FOUND",e.FILES_DATA_NOT_FOUND="FILES_DATA_NOT_FOUND",e.FILES_TYPE_ERROR="FILES_TYPE_ERROR",e.FILES_TYPE_MUST_BE_ONE="FILES_TYPE_MUST_BE_ONE",e.SET_WATERMARK_FAIL="SET_WATERMARK_FAIL",e.MYSQL_CRUD_ERROR="MYSQL_CRUD_ERROR",e.PARAMS_JSON_FAILED="PARAMS_JSON_FAILED",e.MYSQL_ERROR="MYSQL_ERROR",e.NOT_FOUND="NOT_FOUND",e.PRJ_NAME_EXISTS="PRJ_NAME_EXISTS",e.BACKUP_NAME_EXISTS="BACKUP_NAME_EXISTS",e.PRJ_NOT_EXIST="PRJ_NOT_EXIST",e.ERROR_PATH="ERROR_PATH",e.PROJECT_NOT_FOUND="PROJECT_NOT_FOUND",e.TITLE_ILLEGAL_LEN="TITLE_ILLEGAL_LEN",e.FILE_READ_ONLY="FILE_READ_ONLY",e.FILE_READ_ONLY1="FILE_READ_ONLY1",e.DATA_NOT_EXIST="DATA_NOT_EXIST",e.LIB_NOT_EXIST="LIB_NOT_EXIST",e.CONFIG_API_URLS_ERROR="CONFIG_API_URLS_ERROR",e.ONE_CLICK_ORDER_NOT_OPEN="ONE_CLICK_ORDER_NOT_OPEN",e.MATERIAL_NOT_OPEN="MATERIAL_NOT_OPEN",e.SNAPSHOT_DEPTH_LIMIT="SNAPSHOT_DEPTH_LIMIT",e.OCR_SYMBOL_URL_ERROR="OCR_SYMBOL_URL_ERROR",e.USER_DATA_NOT_FOUND="USER_DATA_NOT_FOUND",e.USER_DISABLE_ERROR="USER_DISABLE_ERROR",e.USER_EXISTS_LOGIN_ERROR="USER_EXISTS_LOGIN_ERROR",e.USER_UNAUTHORIZED_MODULES_ERROR="USER_UNAUTHORIZED_MODULES_ERROR",e.USER_UNAUTHORIZED_ACCESS_ERROR="USER_UNAUTHORIZED_ACCESS_ERROR",e.ADMIN_NOT_CHANGE_PASSWORD="ADMIN_NOT_CHANGE_PASSWORD",e.SAME_PASSWORD_NEW_PASSWORD="SAME_PASSWORD_NEW_PASSWORD",e.USER_ONLINE_REGISTRATION_FAILED="USER_ONLINE_REGISTRATION_FAILED",e.USER_PASSWORD_CAN_NOT_DEFAULT="USER_PASSWORD_CAN_NOT_DEFAULT",e.USER_BEFORE_PASSWORD_ERROR="USER_BEFORE_PASSWORD_ERROR",e.USER_PASSWORD_LENGTH_ERROR="USER_PASSWORD_LENGTH_ERROR",e.ORG_ROLE_NOT_CREATE="ORG_ROLE_NOT_CREATE",e.ORG_ROLE_NAME_DUPLICATE="ORG_ROLE_NAME_DUPLICATE",e.ORG_ROLE_ORIGIN_ERROR="ORG_ROLE_ORIGIN_ERROR",e.ORG_ROLE_NOT_DEFAULT="ORG_ROLE_NOT_DEFAULT",e.ADMIN_ROLE_NOT_CHANGE="ADMIN_ROLE_NOT_CHANGE",e.ADMIN_NOT_CHANGE_STATUS="ADMIN_NOT_CHANGE_STATUS",e.PROJECT_ARCHIVED="PROJECT_ARCHIVED",e.PROJECT_UUID_NULL="PROJECT_UUID_NULL",e.PROJECT_UUID_ERROR="PROJECT_UUID_ERROR",e.PROJECT_OR_TEAM_UUID_ERROR="PROJECT_OR_TEAM_UUID_ERROR",e.PROJECT_NOT_PERSON_ERROR="PROJECT_NOT_PERSON_ERROR",e.PROJECT_DUPLICATE_NAME="PROJECT_DUPLICATE_NAME",e.ANNOTATION_HAS_BE_FOUND="ANNOTATION_HAS_BE_FOUND",e.ANNOTATION_NOT_FOUND="ANNOTATION_NOT_FOUND",e.ANNOTATION_CREATE_ERROR="ANNOTATION_CREATE_ERROR",e.ANNOTATION_UPDATE_ERROR="ANNOTATION_UPDATE_ERROR",e.ANNOTATION_DELETE_ERROR="ANNOTATION_DELETE_ERROR",e.PROJECT_DUPLICATE_PATH="PROJECT_DUPLICATE_PATH",e.TEAM_NOT_FOUND="TEAM_NOT_FOUND",e.TEAM_UUID_NULL="TEAM_UUID_NULL",e.TEAM_FOLDER_ERROR="TEAM_FOLDER_ERROR",e.TEAM_FOLDER_DEEP_ERROR="TEAM_FOLDER_DEEP_ERROR",e.TEAM_FOLDER_UUID_ERROR="TEAM_FOLDER_UUID_ERROR",e.TEAM_URL_DUPLICATE="TEAM_URL_DUPLICATE",e.TEAM_CAN_NOT_DELETE="TEAM_CAN_NOT_DELETE",e.COMPONENT_UUID_NULL="COMPONENT_UUID_NULL",e.COMPONENT_DATA_NOT_FOUND="COMPONENT_DATA_NOT_FOUND",e.COMPONENT_NAME_DUPLICATE="COMPONENT_NAME_DUPLICATE",e.COMPONENT_TYPE_ERROR="COMPONENT_TYPE_ERROR",e.DELETE_SON_CATEGORY="DELETE_SON_CATEGORY",e.LICENSE="LICENSE",e.START_TIME="START_TIME",e.END_TIME="END_TIME",e.PROJECT_LIMIT="PROJECT_LIMIT",e.USER_LIMIT="USER_LIMIT",e.ONLINE_NUMBER_LIMIT="ONLINE_NUMBER_LIMIT",e.COMPANY_CODE="COMPANY_CODE",e.LIMIT_PCB="LIMIT_PCB",e.LIMIT_SCH="LIMIT_SCH",e.LIMIT_PANEL="LIMIT_PANEL",e.TIME_ERROR="TIME_ERROR",e.LICENSE_ERROR="LICENSE_ERROR",e.LICENSE_TYPE_ERROR="LICENSE_TYPE_ERROR",e.LICENSE_ORIGIN_ERROR="LICENSE_ORIGIN_ERROR",e.BRANCH_DATA_NOT_FOUND="BRANCH_DATA_NOT_FOUND",e.PARENT_UUID_ERROR="PARENT_UUID_ERROR",e.BRANCH_MUST_AFTER_NODE="BRANCH_MUST_AFTER_NODE",e.BRANCH_NAME_ERROR="BRANCH_NAME_ERROR",e.BRANCH_NAME_DUPLICATE="BRANCH_NAME_DUPLICATE",e.BRANCH_UUID_ERROR="BRANCH_UUID_ERROR",e.BRANCH_NODE_SET_ERROR="BRANCH_NODE_SET_ERROR",e.BRANCH_DELETE_MAIN_ERROR="BRANCH_DELETE_MAIN_ERROR",e.BRANCH_CHECK_OUT_ERROR="BRANCH_CHECK_OUT_ERROR",e.DOCUMENT_UUID_ERROR="DOCUMENT_UUID_ERROR",e.UPDATE_FAILED="UPDATE_FAILED",e.INNER_API_KEY_ERROR="INNER_API_KEY_ERROR",e.BRANCH_MORE_THAN_LIMIT="BRANCH_MORE_THAN_LIMIT",e.WORKSPACE_API_ERROR="WORKSPACE_API_ERROR",e))(eV||{}),tV=(e=>(e[e.DB_INIT_ERROR=0]="DB_INIT_ERROR",e[e.PRJ_NOT_EXIST=1]="PRJ_NOT_EXIST",e[e.NET_ERROR=2]="NET_ERROR",e[e.IS_OPENING=3]="IS_OPENING",e[e.NOT_LOGGED_IN=4]="NOT_LOGGED_IN",e[e.HAS_UNSAVED=5]="HAS_UNSAVED",e[e.DIFF_TICKET=6]="DIFF_TICKET",e))(tV||{});function Ab(e,t={}){if(!e)return"";let{code:i,message:r}=e;switch(i){case 401:return ge("UNAUTHORIZED");case 402:return ge("LOGIN_FAIL");case 422:return ge("PERMISSION_DENIED");case 1111111:return ge("PERMISSION_DENIED1");case 2000001:return ge("PRJ_NOT_EXIST");case 4000002:return ge("ERROR_PATH");case 6000001:return ge("PROJECT_NOT_FOUND");case 1111112:return ge("PERMISSION_DENIED_PARAMS",{type:r});case 1111113:return ge("DATA_NOT_FOUND");case 1111114:return ge("PARAMS_DATA_NOT_FOUND",{type:r});case 42222:return ge("REQUEST_PARAM_ILLEGAL");case 1111115:return ge("REQUEST_PARAM_ILLEGAL1");case 1111116:return ge("REQUEST_PARAMS_ILLEGAL2",{type:r});case 1111117:return ge("REQUEST_PARAMS_NOT_NULL",{type:r});case 1111118:return ge("REQUEST_PARAMS_NOT_ALL_NULL",{type:r});case 1111119:return ge("REQUEST_PARAMS_MUST_ARRAY",{type:r});case 1111120:return ge("REQUEST_PARAMS_MUST_STRING",{type:r});case 1111121:return ge("REQUEST_PARAMS_MUST_NUMBER",{type:r});case 1111122:return ge("REQUEST_PARAMS_MUST_NUMBER_ARRAY",{type:r});case 1111123:return ge("REQUEST_PARAMS_MUST_STRING_ARRAY",{type:r});case 1111124:return ge("REQUEST_PARAMS_LENGTH_ERROR",{type:r});case 1111125:return ge("REQUEST_PARAMS_TYPE_ERROR",{type:r});case 2001:return ge("ILLEGAL_NAME");case 1111126:return ge("ILLEGAL_NAME1");case 1111128:return ge("ILLEGAL_NAME_ZH");case 1111127:return ge("UUID_ERROR");case 1000001:return ge("DUPLICATE_DATA");case 11e3:return ge("DUPLICATE_DATA1");case 1000017:return ge("DUPLICATE_DATA_PARAMS",{type:r});case 10034:return ge("UPLOAD_LIMIT");case 1000003:return ge("MORE_THAN_LIMIT");case 1000004:return ge("FILE_MORE_THAN_LIMIT",{type:r});case 1000005:return ge("PARAMS_MORE_THAN_LIMIT",{type:r});case 1000006:return ge("IMAGE_MORE_THAN_LIMIT_PARAMS");case 1000007:return ge("FILE_MORE_THAN_LIMIT_PARAMS");case 1000019:return ge("END_MUST_AFTER_START");case 1000002:return ge("FILE_READ_ONLY");case 1000008:return ge("FILE_READ_ONLY1");case 1000010:return ge("DATA_NOT_EXIST",{documentName:t.documentName});case 1000009:return ge("REQUEST_PARAMS_TIME_ERROR");case 1000018:return ge("FILES_PATH_NOT_FOUND");case 1000011:return ge("FILES_DATA_NOT_FOUND");case 1000012:return ge("FILES_TYPE_ERROR");case 1000013:return ge("FILES_TYPE_MUST_BE_ONE",{type:r});case 1000014:return ge("SET_WATERMARK_FAIL");case 1000015:return ge("MYSQL_CRUD_ERROR",{type:r});case 1000016:return ge("PARAMS_JSON_FAILED",{type:r});case 3000001:return ge("MYSQL_ERROR");case 404:return ge("NOT_FOUND");case 2002:return ge("PRJ_NAME_EXISTS");case 3002:return ge("BACKUP_NAME_EXISTS");case 2003:return ge("TITLE_ILLEGAL_LEN",{documentName:t.documentName});case 2000001:return ge("LIB_NOT_EXIST");case 3001001:return ge("CONFIG_API_URLS_ERROR");case 3001002:return ge("ONE_CLICK_ORDER_NOT_OPEN");case 3001003:return ge("MATERIAL_NOT_OPEN");case 3001004:return ge("SNAPSHOT_DEPTH_LIMIT");case 3001005:return ge("OCR_SYMBOL_URL_ERROR");case 4000001:return ge("USER_DATA_NOT_FOUND");case 4000012:return ge("USER_DISABLE_ERROR");case 4000003:return ge("USER_EXISTS_LOGIN_ERROR");case 4000004:return ge("USER_UNAUTHORIZED_MODULES_ERROR");case 4000005:return ge("USER_UNAUTHORIZED_ACCESS_ERROR");case 4000006:return ge("ADMIN_NOT_CHANGE_PASSWORD");case 4000007:return ge("SAME_PASSWORD_NEW_PASSWORD");case 4000008:return ge("USER_ONLINE_REGISTRATION_FAILED");case 4000009:return ge("USER_PASSWORD_CAN_NOT_DEFAULT");case 4000010:return ge("USER_BEFORE_PASSWORD_ERROR");case 4000011:return ge("USER_PASSWORD_LENGTH_ERROR");case 5000001:return ge("ORG_ROLE_NOT_CREATE");case 5000002:return ge("ORG_ROLE_NAME_DUPLICATE");case 5000003:return ge("ORG_ROLE_ORIGIN_ERROR",{message:r});case 5000004:return ge("ORG_ROLE_NOT_DEFAULT");case 5000005:return ge("ADMIN_ROLE_NOT_CHANGE");case 5000006:return ge("ADMIN_NOT_CHANGE_STATUS");case 6000002:return ge("PROJECT_ARCHIVED");case 6000003:return ge("PROJECT_UUID_NULL");case 6000004:return ge("PROJECT_UUID_ERROR");case 6000005:return ge("PROJECT_OR_TEAM_UUID_ERROR");case 6000006:return ge("PROJECT_NOT_PERSON_ERROR");case 6000007:return ge("PROJECT_DUPLICATE_NAME");case 6000008:return ge("ANNOTATION_HAS_BE_FOUND");case 6000009:return ge("ANNOTATION_NOT_FOUND");case 6000010:return ge("ANNOTATION_CREATE_ERROR");case 6000011:return ge("ANNOTATION_UPDATE_ERROR");case 6000012:return ge("ANNOTATION_DELETE_ERROR");case 6000013:return ge("PROJECT_DUPLICATE_PATH");case 7000001:return ge("TEAM_NOT_FOUND");case 7000002:return ge("TEAM_UUID_NULL");case 7000003:return ge("TEAM_FOLDER_ERROR");case 7000004:return ge("TEAM_FOLDER_DEEP_ERROR");case 7000005:return ge("TEAM_FOLDER_UUID_ERROR");case 7000006:return ge("TEAM_URL_DUPLICATE");case 7000007:return ge("TEAM_CAN_NOT_DELETE");case 8000001:return ge("COMPONENT_UUID_NULL");case 8000002:return ge("COMPONENT_DATA_NOT_FOUND");case 8000003:return ge("COMPONENT_NAME_DUPLICATE");case 8000004:return ge("COMPONENT_TYPE_ERROR");case 8001001:return ge("DELETE_SON_CATEGORY");case 9000001:return ge("LICENSE");case 9000002:return ge("START_TIME");case 9000003:return ge("END_TIME");case 9000004:return ge("PROJECT_LIMIT");case 9000005:return ge("USER_LIMIT");case 9000006:return ge("ONLINE_NUMBER_LIMIT");case 9000007:return ge("COMPANY_CODE");case 9000008:return ge("LIMIT_PCB");case 9000009:return ge("LIMIT_SCH");case 9000011:return ge("LIMIT_PANEL");case 9000010:return ge("TIME_ERROR");case 9000012:return ge("LICENSE_ERROR");case 9000013:return ge("LICENSE_TYPE_ERROR");case 9000014:return ge("LICENSE_ORIGIN_ERROR",{type:r});case 11000001:return ge("BRANCH_DATA_NOT_FOUND");case 11000002:return ge("PARENT_UUID_ERROR");case 11000003:return ge("BRANCH_MUST_AFTER_NODE");case 11000004:return ge("BRANCH_NAME_ERROR");case 11000005:return ge("BRANCH_NAME_DUPLICATE");case 11000006:return ge("BRANCH_UUID_ERROR");case 11000007:return ge("BRANCH_NODE_SET_ERROR");case 11000008:return ge("BRANCH_DELETE_MAIN_ERROR");case 11000009:return ge("BRANCH_CHECK_OUT_ERROR");case 12000001:return ge("DOCUMENT_UUID_ERROR");case 12000002:return ge("UPDATE_FAILED");case 1000020:return ge("INNER_API_KEY_ERROR");case 11000010:return ge("BRANCH_MORE_THAN_LIMIT");case 1000021:return ge("WORKSPACE_API_ERROR");default:return""}}function ge(e,t){return ST()==="zh-cn"?Cb.match("codeCN",e,t)||"":Cb.match("codeEN",e,t)||""}var Uw=class extends x0{constructor(e){super(e)}async transform(e,t,i){let{device:r,symbol:n,footprint:s}=e,a={device:r,symbol:n,footprint:s};if(n!=null&&n.success&&(n!=null&&n.result)&&t.symbol&&i.symbol){let o=t.symbol,l=n.result,{uuid:u,docType:c,version:h}=l,m=i.symbol.isProject,f=Object.assign(o,{isProject:m}),g={uuid:u,path:this.path,isProject:!0,docType:c,version:h};if((await As({origin:f,target:g})).success===!1)throw new Error("Library canvas content upload failed!")}if(s!=null&&s.success&&(s!=null&&s.result)&&t.footprint){let o=t.footprint,l=s.result,{uuid:u,docType:c,version:h}=l,m=i.footprint.isProject,f=!!(r!=null&&r.success&&r.result),g=Object.assign(o,{isConnectDevice:f,isProject:m}),y={uuid:u,path:this.path,isProject:!0,docType:c,version:h};if((await As({origin:g,target:y})).success===!1)throw new Error("Library canvas content upload failed!")}return{success:!0,result:a}}async transformSymbol(){}async onsuccess(e){e.symbol&&!e.symbol.success&&(e.symbol.message=Ab(e.symbol)||e.symbol.message),e.footprint&&!e.footprint.success&&(e.footprint.message=Ab(e.footprint)||e.footprint.message),e.device&&!e.device.success&&(e.device.message=Ab(e.device)||e.device.message)}},iV=class extends Uw{constructor(e){let{path:t,data:i,options:r={}}=e,{matchKey:n=!0,byUUID:s=!0,byVersion:a=!0,bySource:o=!0,renameKey:l=!1}=r;super(t),this.addData={},this.result={device:null,symbol:null,footprint:null},this.data=i,this.matchKey=n,this.byUUID=s,this.byVersion=a,this.bySource=o,this.renameKey=l}async start(){var e,t,i,r,n,s,a,o,l,u,c,h;try{let m=await this.check();if(!m.success)return{success:!1,message:m.message};await this.onbefore();let f={path:this.path,matchKey:this.matchKey,byUUID:this.byUUID,byVersion:this.byVersion,bySource:this.bySource,renameKey:this.renameKey};if(this.data.device){let b={...f,data:this.data.device},E=await new Zz(b).start();if(E.success===!1)return{success:!1,code:E.code,message:E.message};let{respond:S,addData:v}=E.result;if(this.result.device=S,v&&(this.addData.device=v),this.getBind(),!this.addData.device&&((e=this.result.device)==null?void 0:e.success)&&((t=this.result.device)==null?void 0:t.result)){let{attributes:A}=this.result.device.result,{Symbol:x,Footprint:T}=A,R=x&&(await Re.messageBus.rpcCall(Qe.SYMBOL.GET,[x,this.path])).message,L=T&&(await Re.messageBus.rpcCall(Qe.FOOTPRINT.GET,[T,this.path])).message;this.result.symbol={success:!0,result:R},this.result.footprint={success:!0,result:L}}}if(this.data.symbol){let b={...f,data:this.data.symbol},E=await new C0(b).start();if(E.success===!1&&E.code===404){if(this.addData.device){this.addData.device.attributes.Symbol="";let{display_title:S,title:v}=this.addData.device,A=S||v;Re.messageBus.publish("logI18nLogView",{type:"warn",msg:["The following devices lose bound symbol data!",A]})}}else{if(E.success===!1)return{success:!1,code:E.code,message:E.message};{let{respond:S,addData:v}=E.result;if(this.result.symbol=S,v&&(this.addData.symbol=v),this.addData.device&&((i=this.result.symbol)==null?void 0:i.success)&&((r=this.result.symbol)==null?void 0:r.result))this.addData.device.attributes.Symbol=this.result.symbol.result.uuid;else if((n=this.addData.device)!=null&&n.attributes.Symbol&&((s=this.result.symbol)!=null&&s.success)&&!((a=this.result.symbol)!=null&&a.result)&&!this.addData.symbol){let A="The symbol associated with the device does not exist!";throw new he("CREATE_DEVICE",A)}}}}if(this.data.footprint){let b={...f,data:this.data.footprint},E=await new A0(b).start();if(E.success===!1&&E.code===404){if(this.addData.device){this.addData.device.attributes.Footprint="";let{display_title:S,title:v}=this.addData.device,A=S||v;Re.messageBus.publish("logI18nLogView",{type:"warn",msg:["The following devices lose bound footprint data!",A]})}}else{if(E.success===!1)return{success:!1,code:E.code,message:E.message};{let{respond:S,addData:v}=E.result;if(this.result.footprint=S,v&&(this.addData.footprint=v),this.addData.device&&((o=this.result.footprint)==null?void 0:o.success)&&((l=this.result.footprint)==null?void 0:l.result))this.addData.device.attributes.Footprint=this.result.footprint.result.uuid;else if((u=this.addData.device)!=null&&u.attributes.Footprint&&((c=this.result.footprint)!=null&&c.success)&&!((h=this.result.footprint)!=null&&h.result)&&!this.addData.footprint){let A="The footprint associated with the device does not exist!";throw new he("CREATE_DEVICE",A)}}}}let g=await this.create();if(!g.success)return{success:!1,message:g.message};let y=await this.updateBind();if(!y.success)return{success:!1,message:y.message};if(!this.result)throw new he("CREATE_DEVICE","Project library device added failed!");return await this.onsuccess(this.result),{success:!0,result:this.result}}catch(m){return{success:!1,message:m.message}}}getBind(){if(this.addData.device){let{attributes:e}=this.addData.device,{Symbol:t,Footprint:i}=e,{isProject:r}=this.data.device;if(r===void 0)!this.data.symbol&&t&&(this.data.symbol={isProject:!0,path:this.path,uuid:t}),!this.data.footprint&&i&&(this.data.footprint={isProject:!0,path:this.path,uuid:i});else{let[n,s]=this.addData.device.source.split(du);!this.data.symbol&&t&&(this.data.symbol={isProject:r,path:s,uuid:t}),!this.data.footprint&&i&&(this.data.footprint={isProject:r,path:s,uuid:i})}}}onbeforeCreate(){var e,t,i,r;return(e=this.addData.symbol)!=null&&e.docType&&!PT((t=this.addData.symbol)==null?void 0:t.docType)?{success:!1,message:"invalid symbol docType"}:(i=this.addData.footprint)!=null&&i.docType&&((r=this.addData.footprint)==null?void 0:r.docType)!==4?{success:!1,message:"invalid footprint docType"}:{success:!0}}async create(){var e;if(Object.keys(this.addData).length>0){let t=this.onbeforeCreate();if(!t.success)return{success:!1,message:t.message};let i=[[this.addData],this.path],{message:r}=await Re.messageBus.rpcCall(Qe.DEVICE.PLACE,i);if(!r.success)return{success:!1,message:r.message};let{device:n,symbol:s,footprint:a}=(e=r.result)==null?void 0:e[0];n&&(this.result.device=n),s&&(this.result.symbol=s),a&&(this.result.footprint=a);let o=await this.transform(this.result,this.addData,this.data);if(!o.success)return{success:!1,message:o.message}}return{success:!0}}async updateBind(){let{device:e,symbol:t,footprint:i}=this.result,r=e!=null&&e.success?e==null?void 0:e.result:null,n=t!=null&&t.success?t==null?void 0:t.result:null,s=i!=null&&i.success?i==null?void 0:i.result:null;if(r){let a=!1;if(n!=null&&n.uuid&&r.attributes.Symbol&&n.uuid!==r.attributes.Symbol&&(r.attributes.Symbol=n.uuid,a=!0),s!=null&&s.uuid&&r.attributes.Footprint&&s.uuid!==r.attributes.Footprint&&(r.attributes.Footprint=s.uuid,a=!0),a){let o=(await Re.messageBus.rpcCall(Qe.DEVICE.UPDATE,[r,this.path])).message;this.result.device={success:!!o,result:o}}}return{success:!0}}async onbefore(){}},rV=class extends Mw{constructor(e,t){super(t),this.uuid=e}onHandle(e){return this.onUpdate(e)}matching(e){throw new Error("Method not implemented.")}async isRename(e){return{success:!0}}async start(){let e=await this.getOrigin();if(!e.success)return{success:!1,code:e.code,message:e.message};if(!this.origin)return{success:!1,message:"Device details data does not exist"};let t=this.origin.display_title||this.origin.title,i=[{uuid:this.uuid,title:t},this.path];if((await Re.messageBus.rpcCall(Qe.DEVICE.IS_CHANGE,i)).message){let r=await this.rename(this.origin);if(!r.success)return{success:!1,code:r.code,message:r.message}}return{success:!0,result:this.origin}}},nV=class extends Uw{constructor(e){let{path:t,uuid:i,data:r,options:n={}}=e,{matchKey:s=!0,byUUID:a=!0,bySource:o=!0,byVersion:l=!1,renameKey:u=!1}=n;super(t),this.addData={},this.map={},this.result={device:null,symbol:null,footprint:null,map:{}},this.uuid=i,this.data=r,this.matchKey=s,this.byUUID=a,this.bySource=o,this.byVersion=l,this.renameKey=u}async start(){var e,t,i,r,n,s,a,o,l,u;try{let c=await this.check();if(!c.success)return{success:!1,message:c.message};await this.onbefore();let h={path:this.path,matchKey:this.matchKey,byUUID:this.byUUID,bySource:this.bySource,byVersion:this.byVersion,renameKey:this.renameKey};if(this.data.device){let g={...h,data:this.data.device},y=await new rV(this.uuid,g).start();if(y.success){let b=y.result;b&&(this.updateData=b),this.getBind()}else return{success:!1,code:y.code,message:y.message}}if(this.data.symbol){let g={...h,data:this.data.symbol,renameKey:this.renameKey},y=await new C0(g).start();if(!y.success)return{success:!1,code:y.code,message:y.message};let{respond:b,addData:E}=y.result;if(this.result.symbol=b,E&&(this.addData.symbol=E),this.updateData&&this.addData.symbol)this.updateData.attributes.Symbol=this.addData.symbol.uuid;else if(this.updateData&&((e=this.result.symbol)!=null&&e.success)&&this.result.symbol.result)this.updateData.attributes.Symbol=this.result.symbol.result.uuid;else if((t=this.updateData)!=null&&t.attributes.Symbol&&((i=this.result.symbol)!=null&&i.success)&&!((r=this.result.symbol)!=null&&r.result)&&!this.addData.symbol){let S="The symbol associated with the device does not exist!";throw new he("UPDATE_DEVICE",S)}}if(this.data.footprint){let g={...h,data:this.data.footprint,renameKey:this.renameKey},y=await new A0(g).start();if(!y.success)return{success:!1,code:y.code,message:y.message};let{respond:b,addData:E}=y.result;if(this.result.footprint=b,E&&(this.addData.footprint=E),this.updateData&&this.addData.footprint)this.updateData.attributes.Footprint=this.addData.footprint.uuid;else if(this.updateData&&((n=this.result.footprint)!=null&&n.success)&&this.result.footprint.result)this.updateData.attributes.Footprint=this.result.footprint.result.uuid;else if((s=this.updateData)!=null&&s.attributes.Footprint&&((a=this.result.footprint)!=null&&a.success)&&!((o=this.result.footprint)!=null&&o.result)&&!this.addData.footprint){let S="The footprint associated with the device does not exist!";throw new he("UPDATE_DEVICE",S)}}let m=await this.create();if(!m.success)return{success:!1,code:m.code,message:m.message};let f=await this.update();if(!f.success)return{success:!1,message:f.message};if(!this.result){let g={text:"Failed to update project library device {title}!",args:{title:((l=this.updateData)==null?void 0:l.display_title)||((u=this.updateData)==null?void 0:u.title)||""}};throw new he("UPDATE_DEVICE",g)}return await this.onsuccess(this.result),{success:!0,result:Object.assign(this.result,{map:this.map})}}catch(c){return{success:!1,message:c.message}}}getBind(){if(this.updateData){let{attributes:e}=this.updateData,{Symbol:t,Footprint:i}=e||{},{isProject:r}=this.data.device;if(r===void 0)!this.data.symbol&&t&&(this.data.symbol={isProject:!0,path:this.path,uuid:t}),!this.data.footprint&&i&&(this.data.footprint={isProject:!0,path:this.path,uuid:i});else{let[n,s]=this.updateData.source.split(du);!this.data.symbol&&t&&(this.data.symbol={isProject:r,path:s,uuid:t}),!this.data.footprint&&i&&(this.data.footprint={isProject:r,path:s,uuid:i})}}}onbeforeCreate(){var e,t,i,r;return(e=this.addData.symbol)!=null&&e.docType&&!PT((t=this.addData.symbol)==null?void 0:t.docType)?{success:!1,message:"invalid symbol docType"}:(i=this.addData.footprint)!=null&&i.docType&&((r=this.addData.footprint)==null?void 0:r.docType)!==4?{success:!1,message:"invalid footprint docType"}:{success:!0}}async create(){let{symbol:e,footprint:t}=this.addData,i=this.onbeforeCreate();if(!i.success)return{success:!1,message:i.message};if(e){let n=(await Re.messageBus.rpcCall(Qe.SYMBOL.ADD,[e,this.path])).message;if(!n)return{success:!1,message:"Project library symbol added failed!"};this.result.symbol={success:!0,result:n},this.map[e.uuid]=n.uuid}if(t){let n=(await Re.messageBus.rpcCall(Qe.FOOTPRINT.ADD,[t,this.path])).message;if(!n)return{success:!1,message:"Project library footprint added failed!"};this.result.footprint={success:!0,result:n},this.map[t.uuid]=n.uuid}let r=await this.transform(this.result,this.addData,this.data);return r.success?{success:!0}:{success:!1,message:r.message}}async update(){var t,i,r;let e=this.updateData;if(e){(t=this.result.symbol)!=null&&t.success&&this.result.symbol.result&&(e.attributes.Symbol=(i=this.result.symbol)==null?void 0:i.result.uuid),(r=this.result.footprint)!=null&&r.success&&this.result.footprint.result&&(e.attributes.Footprint=this.result.footprint.result.uuid);let n=[{...e,uuid:this.uuid,keepVersion:this.keepVersion},this.path],s=(await Re.messageBus.rpcCall(Qe.DEVICE.UPDATE,n)).message;if(!s)return{success:!1,message:{text:"Failed to update project library device {title}!",args:{title:e.display_title||e.title||""}}};this.result.device={success:!0,result:s}}return{success:!0}}async onbefore(){hu(this.data.device)?(this.onlyIdentity=!0,this.keepVersion=!0):(this.onlyIdentity=!1,this.keepVersion=!1)}},Hw=class extends x0{constructor(e){let{path:t,data:i}=e;super(t),this.data=i}async cloneCanvas(e,t){let{uuid:i,version:r,docType:n}=t,s=Object.assign(e,{isProject:this.data.isProject}),a={uuid:i,path:this.path,isProject:!0,docType:n,version:r};if((await As({origin:s,target:a})).success===!1)throw new Error("Library canvas content upload failed!");return{success:!0}}},sV=class extends Hw{constructor(e){let{path:t,data:i,options:r={}}=e,{byUUID:n=!0,byVersion:s=!0,bySource:a=!0,renameKey:o=!0,matchKey:l=!0}=r;super({path:t,data:i}),this.byUUID=n,this.byVersion=s,this.bySource=a,this.renameKey=o,this.matchKey=l}async start(){let e=await this.check();if(!e.success)return{success:!1,message:e.message};await this.onbefore();let t={path:this.path,byUUID:this.byUUID,byVersion:this.byVersion,bySource:this.bySource,renameKey:this.renameKey,matchKey:this.matchKey},i=await new C0({...t,data:this.data}).start();if(!i.success)return{success:!1,code:i.code,message:i.message};let{addData:r,respond:n}=i.result;if(n&&!n.success)return{success:!1,code:n.code,message:n.message};if(n&&n.success)this.result=n.result;else if(r){let s=(await Re.messageBus.rpcCall(Qe.SYMBOL.ADD,[r,this.path])).message;if(!s)return{success:!1,message:"Project library symbol added failed!"};let a=await this.cloneCanvas(r,s);if(!a.success)return{success:!1,code:a.code,message:a.message};this.result=s}if(!this.result)throw new he("CREATE_SYMBOL","Project library symbol added failed!");return await this.onsuccess(this.result),{success:!0,result:this.result}}async onbefore(){}async onsuccess(e){}},jw=class extends x0{constructor(e){let{path:t,data:i}=e;super(t),this.data=i}async cloneCanvas(e,t){let{uuid:i,version:r,docType:n}=t,s=Object.assign(e,{isProject:this.data.isProject}),a={uuid:i,path:this.path,isProject:!0,docType:n,version:r};if((await As({origin:s,target:a})).success===!1)throw new Error("Library canvas content upload failed!");return{success:!0}}},aV=class extends jw{constructor(e){let{path:t,data:i,options:r={}}=e,{byUUID:n=!0,byVersion:s=!0,bySource:a=!0,renameKey:o=!0,matchKey:l=!0}=r;super({path:t,data:i}),this.byUUID=n,this.byVersion=s,this.bySource=a,this.renameKey=o,this.matchKey=l}async start(){let e=await this.check();if(!e.success)return{success:!1,message:e.message};await this.onbefore();let t={path:this.path,byUUID:this.byUUID,byVersion:this.byVersion,bySource:this.bySource,renameKey:this.renameKey,matchKey:this.matchKey},i=await new A0({...t,data:this.data}).start();if(!i.success)return{success:!1,code:i.code,message:i.message};let{addData:r,respond:n}=i.result;if(n&&!n.success)return{success:!1,code:n.code,message:n.message};if(n&&n.success)this.result=n.result;else if(r){let s=(await Re.messageBus.rpcCall(Qe.FOOTPRINT.ADD,[r,this.path])).message;if(!s)return{success:!1,message:"Project library footprint added failed!"};let a=await this.cloneCanvas(r,s);if(!a.success)return{success:!1,code:a.code,message:a.message};this.result=s}if(!this.result)throw new he("CREATE_FOOTPRINT","Project library footprint added failed!");return await this.onsuccess(this.result),{success:!0,result:this.result}}async onbefore(){}async onsuccess(e){}},oV=class extends Fw{constructor(e,t){super(t),this.uuid=e}onHandle(e){return this.onUpdate(e)}matching(e){throw new Error("Method not implemented.")}async isRename(e){return{success:!0}}async start(){let e=await this.getOrigin();if(!e.success)return{success:!1,code:e.code,message:e.message};if(!this.origin)return{success:!1,message:"Symbol details data does not exist"};let t=this.origin.display_title||this.origin.title,i=[{uuid:this.uuid,title:t},this.path];if((await Re.messageBus.rpcCall(Qe.SYMBOL.IS_CHANGE,i)).message){let r=await this.rename(this.origin);if(!r.success)return{success:!1,code:r.code,message:r.message}}return{success:!0,result:this.origin}}},lV=class extends Hw{constructor(e){let{path:t,uuid:i,data:r,options:n={}}=e,{matchKey:s=!0,byUUID:a=!0,bySource:o=!0,byVersion:l=!1,renameKey:u=!1}=n;super({path:t,data:r}),this.uuid=i,this.matchKey=s,this.byUUID=a,this.bySource=o,this.byVersion=l,this.renameKey=u}async start(){var n,s;let e=await this.check();if(!e.success)return{success:!1,message:e.message};await this.onbefore();let t={path:this.path,matchKey:this.matchKey,byUUID:this.byUUID,bySource:this.bySource,byVersion:this.byVersion,renameKey:this.renameKey,data:this.data},i=await new oV(this.uuid,t).start();if(!i.success)return{success:!1,code:i.code,message:i.message};this.updateData=i.result;let r=[{...this.updateData,uuid:this.uuid,keepVersion:this.keepVersion},this.path];if(this.result=(await Re.messageBus.rpcCall(Qe.SYMBOL.UPDATE,r)).message,this.result&&this.onlyIdentity){let a=await this.cloneCanvas(this.updateData,this.result);if(!a.success)return{success:!1,code:a.code,message:a.message}}if(!this.result){let a=((n=this.updateData)==null?void 0:n.display_title)||((s=this.updateData)==null?void 0:s.title)||"",o="Failed to update project library symbol {title}!";throw new he("UPDATE_SYMBOL",{text:o,args:{title:a}})}return await this.onsuccess(this.result),{success:!0,result:this.result}}async onbefore(){hu(this.data)?(this.onlyIdentity=!0,this.keepVersion=!0):(this.onlyIdentity=!1,this.keepVersion=!1)}async onsuccess(e){}},uV=class extends kw{constructor(e,t){super(t),this.uuid=e}onHandle(e){return this.onUpdate(e)}matching(e){throw new Error("Method not implemented.")}async isRename(e){return{success:!0}}async start(){let e=await this.getOrigin();if(!e.success)return{success:!1,code:e.code,message:e.message};if(!this.origin)return{success:!1,message:"Footprint details data does not exist"};let t=this.origin.display_title||this.origin.title,i=[{uuid:this.uuid,title:t},this.path];if((await Re.messageBus.rpcCall(Qe.FOOTPRINT.IS_CHANGE,i)).message){let r=await this.rename(this.origin);if(!r.success)return{success:!1,code:r.code,message:r.message}}return{success:!0,result:this.origin}}},cV=class extends jw{constructor(e){let{path:t,uuid:i,data:r,options:n={}}=e,{matchKey:s=!0,byUUID:a=!0,bySource:o=!0,byVersion:l=!1,renameKey:u=!1}=n;super({path:t,data:r}),this.uuid=i,this.matchKey=s,this.byUUID=a,this.bySource=o,this.byVersion=l,this.renameKey=u}async start(){var n,s;let e=await this.check();if(!e.success)return{success:!1,message:e.message};await this.onbefore();let t={path:this.path,matchKey:this.matchKey,byUUID:this.byUUID,bySource:this.bySource,byVersion:this.byVersion,renameKey:this.renameKey,data:this.data},i=await new uV(this.uuid,t).start();if(!i.success)return{success:!1,code:i.code,message:i.message};this.updateData=i.result;let r=[{...this.updateData,uuid:this.uuid,keepVersion:this.keepVersion},this.path];if(this.result=(await Re.messageBus.rpcCall(Qe.FOOTPRINT.UPDATE,r)).message,this.result&&this.onlyIdentity){let a=await this.cloneCanvas(this.updateData,this.result);if(!a.success)return{success:!1,code:a.code,message:a.message}}if(!this.result){let a={text:"Failed to update project library footprint {title}!",args:{title:((n=this.updateData)==null?void 0:n.display_title)||((s=this.updateData)==null?void 0:s.title)||""}};throw new he("UPDATE_FOOTPRINT",a)}return await this.onsuccess(this.result),{success:!0,result:this.result}}async onbefore(){hu(this.data)?(this.onlyIdentity=!0,this.keepVersion=!0):(this.onlyIdentity=!1,this.keepVersion=!1)}async onsuccess(e){}},dV=class extends P0{async getDevice(e){let t=[e.uuid,e.path],{message:i}=await Re.messageBus.rpcCall(Qe.DEVICE.GET,t);if(!i)throw new he("GET_DEVICE","Device details data does not exist");return this.getDeviceOut(Object.assign(i,{path:e.path}))}async getSymbol(e){let t=[e.uuid,e.path],{message:i}=await Re.messageBus.rpcCall(Qe.SYMBOL.GET,t);if(!i)throw new he("GET_SYMBOL","Symbol details data does not exist");return this.getSymbolOut(Object.assign(i,{path:e.path}))}async getFootprint(e){let t=[e.uuid,e.path],{message:i}=await Re.messageBus.rpcCall(Qe.FOOTPRINT.GET,t);if(!i)throw new he("GET_FOOTPRINT","Footprint details data does not exist");return this.getFootprintOut(Object.assign(i,{path:e.path}))}async createDevice(e){let{path:t,device:i,symbol:r,footprint:n}=e,s={path:t,data:{device:i,symbol:r,footprint:n}},a=await new iV(s).start();if(!a.success)throw new he("CREATE_DEVICE",a.message);let o=a.result.device;if(!(o!=null&&o.success))throw new he("CREATE_DEVICE",o==null?void 0:o.message);let l=o.result;return this.getDeviceOut(Object.assign(l,{path:e.path}))}async createSymbol(e){let{path:t,symbol:i}=e,r={path:t,data:i},n=await new sV(r).start();if(!n.success)throw new he("CREATE_SYMBOL",n.message);let s=n.result;return this.getSymbolOut(Object.assign(s,{path:e.path}))}async createFootprint(e){let{path:t,footprint:i}=e,r={path:t,data:i},n=await new aV(r).start();if(!n.success)throw new he("CREATE_FOOTPRINT",n.message);let s=n.result;return this.getFootprintOut(Object.assign(s,{path:e.path}))}async updateDevice(e){let{uuid:t,path:i,device:r,symbol:n,footprint:s}=e,a={path:i,uuid:t,data:{device:r,symbol:n,footprint:s}},o=await new nV(a).start();if(!o.success)throw new he("UPDATE_DEVICE",o.message);let l=o.result.device;if(!(l!=null&&l.success))throw new he("CREATE_DEVICE",l==null?void 0:l.message);let u=l.result;return this.getDeviceOut(Object.assign(u,{path:e.path}))}async updateDeviceAttributes(e){let t=(await Re.messageBus.rpcCall(Qe.DEVICE.UPDATE,[e,e.path])).message;if(!t)throw new he("UPDATE_DEVICE_ATTRIBUTES",t.message);return this.getDeviceOut(Object.assign(t,{path:e.path}))}async updateSymbol(e){let{uuid:t,path:i,symbol:r}=e,n={path:i,uuid:t,data:r},s=await new lV(n).start();if(!s.success)throw new he("UPDATE_SYMBOL",s.message);let a=s.result;return this.getSymbolOut(Object.assign(a,{path:e.path}))}async updateFootprint(e){let{uuid:t,path:i,footprint:r}=e,n={path:i,uuid:t,data:r},s=await new cV(n).start();if(!s.success)throw new he("UPDATE_FOOTPRINT",s.message);let a=s.result;return this.getFootprintOut(Object.assign(a,{path:e.path}))}async deleteDevice(e){if(!(await Re.messageBus.rpcCall(Qe.DEVICE.DEL,e)).message)throw new he("DELETE_DEVICE","delete failed!")}async deleteSymbol(e){if(!(await Re.messageBus.rpcCall(Qe.SYMBOL.DEL,e)).message)throw new he("DELETE_SYMBOL","delete failed!")}async deleteFootprint(e){if(!(await Re.messageBus.rpcCall(Qe.FOOTPRINT.DEL,e)).message)throw new he("DELETE_FOOTPRINT","delete failed!")}async getDeviceList(e){let t=(await Re.messageBus.rpcCall(Qe.DEVICE.GET_LIST,e)).message;if(!t.success)throw new he("GET_DEVICE_LIST",t.message);let{count:i,totalPage:r,lists:n}=t.result,s=n.map(this.getDeviceOut);return{count:i,lists:s,page:e.page,pageSize:e.pageSize,totalPage:r}}async getSymbolList(e){let t=(await Re.messageBus.rpcCall(Qe.SYMBOL.GET_LIST,e)).message;if(!t.success)throw new he("GET_SYMBOL_LIST",t.message);let{count:i,totalPage:r,lists:n}=t.result,s=n.map(this.getSymbolOut);return{count:i,lists:s,page:e.page,pageSize:e.pageSize,totalPage:r}}async getFootprintList(e){let t=(await Re.messageBus.rpcCall(Qe.FOOTPRINT.GET_LIST,e)).message;if(!t.success)throw new he("GET_FOOTPRINT_LIST",t.message);let{count:i,totalPage:r,lists:n}=t.result,s=n.map(this.getFootprintOut);return{count:i,lists:s,page:e.page,pageSize:e.pageSize,totalPage:r}}getDeviceOut(e){return{uuid:e.uuid,path:e.path,title:e.title,display_title:e.display_title,attributes:e.attributes,description:e.description,images:e.images,source:e.source,version:e.version,ticket:e.ticket,creator:e.creator,modifier:e.modifier,createTime:e.createTime,updateTime:e.updateTime,owner:e.owner,custom_tags:e.custom_tags}}getSymbolOut(e){return{title:e.title,display_title:e.display_title,description:e.description,docType:e.docType,uuid:e.uuid,path:e.path,source:e.source,version:e.version,ticket:e.ticket,creator:e.creator,modifier:e.modifier,updateTime:e.updateTime,createTime:e.createTime,owner:e.owner,custom_tags:e.custom_tags}}getFootprintOut(e){return{title:e.title,display_title:e.display_title,description:e.description,docType:e.docType,uuid:e.uuid,path:e.path,source:e.source,version:e.version,ticket:e.ticket,creator:e.creator,modifier:e.modifier,updateTime:e.updateTime,createTime:e.createTime,owner:e.owner,custom_tags:e.custom_tags}}},hV=class extends P0{constructor(){super(...arguments),this._normalErrorMsg="Request Error.",this._extendLibManager=Wi.getInstance()}async getDevice(e){var i;let t=await((i=this._extendLibManager.getLib(e.path))==null?void 0:i.getTransformedDetailInTab("device",e.uuid));if(t)return t;throw new he("GET_DEVICE",this._normalErrorMsg)}async getSymbol(e){var i;let t=await((i=this._extendLibManager.getLib(e.path))==null?void 0:i.getTransformedDetailInTab("symbol",e.uuid));if(t)return t;throw new he("GET_SYMBOL",this._normalErrorMsg)}async getFootprint(e){var i;let t=await((i=this._extendLibManager.getLib(e.path))==null?void 0:i.getTransformedDetailInTab("footprint",e.uuid));if(t)return t;throw new he("GET_FOOTPRINT",this._normalErrorMsg)}async getDeviceList(e){var i,r,n,s,a,o,l,u;let t=await((u=this._extendLibManager.getLib(e.path))==null?void 0:u.getTransformedListInTab("device",{query:{attributes:(r=(i=e.query)==null?void 0:i.attributes)!=null?r:{},symbolType:(n=e.query)==null?void 0:n.symbol_type,classification:{primaryClassificationUuid:(a=(s=e.tags)==null?void 0:s[0])!=null?a:"",secondaryClassificationUuid:(l=(o=e.tags)==null?void 0:o[1])!=null?l:""}},page:e.page,pageSize:e.pageSize}));if(t)return t;throw new he("GET_DEVICE_LIST",this._normalErrorMsg)}async getSymbolList(e){var i,r,n,s,a,o,l;let t=await((l=this._extendLibManager.getLib(e.path))==null?void 0:l.getTransformedListInTab("symbol",{query:{symbolType:(r=(i=e.query)==null?void 0:i.docType)==null?void 0:r[0],classification:{primaryClassificationUuid:(s=(n=e.tags)==null?void 0:n[0])!=null?s:"",secondaryClassificationUuid:(o=(a=e.tags)==null?void 0:a[1])!=null?o:""}},page:e.page,pageSize:e.pageSize}));if(t)return t;throw new he("GET_SYMBOL_LIST",this._normalErrorMsg)}async getFootprintList(e){var i,r,n,s,a;let t=await((a=this._extendLibManager.getLib(e.path))==null?void 0:a.getTransformedListInTab("footprint",{query:{classification:{primaryClassificationUuid:(r=(i=e.tags)==null?void 0:i[0])!=null?r:"",secondaryClassificationUuid:(s=(n=e.tags)==null?void 0:n[1])!=null?s:""}},page:e.page,pageSize:e.pageSize}));if(t)return t;throw new he("GET_FOOTPRINT_LIST",this._normalErrorMsg)}async getDeviceSearchList(e){var i,r,n,s,a,o,l,u;let t=await((u=this._extendLibManager.getLib(e.path))==null?void 0:u.getTransformedListInTab("device",{query:{wd:e.wd,attributes:(r=(i=e.query)==null?void 0:i.attributes)!=null?r:{},symbolType:(n=e.query)==null?void 0:n.symbol_type,classification:{primaryClassificationUuid:(a=(s=e.tags)==null?void 0:s[0])!=null?a:"",secondaryClassificationUuid:(l=(o=e.tags)==null?void 0:o[1])!=null?l:""}},page:e.page,pageSize:e.pageSize}));if(t)return t;throw new he("GET_DEVICE_LIST",this._normalErrorMsg)}async getSymbolSearchList(e){var i,r,n,s,a,o,l;let t=await((l=this._extendLibManager.getLib(e.path))==null?void 0:l.getTransformedListInTab("symbol",{query:{wd:e.wd,symbolType:(r=(i=e.query)==null?void 0:i.docType)==null?void 0:r[0],classification:{primaryClassificationUuid:(s=(n=e.tags)==null?void 0:n[0])!=null?s:"",secondaryClassificationUuid:(o=(a=e.tags)==null?void 0:a[1])!=null?o:""}},page:e.page,pageSize:e.pageSize}));if(t)return t;throw new he("GET_SYMBOL_LIST",this._normalErrorMsg)}async getFootprintSearchList(e){var i,r,n,s,a;let t=await((a=this._extendLibManager.getLib(e.path))==null?void 0:a.getTransformedListInTab("footprint",{query:{wd:e.wd,classification:{primaryClassificationUuid:(r=(i=e.tags)==null?void 0:i[0])!=null?r:"",secondaryClassificationUuid:(s=(n=e.tags)==null?void 0:n[1])!=null?s:""}},page:e.page,pageSize:e.pageSize}));if(t)return t;throw new he("GET_FOOTPRINT_LIST",this._normalErrorMsg)}createDevice(e){throw new he("CREATE_DEVICE","Not Supported.")}createSymbol(e){throw new he("GET_SYMBOL","Not Supported.")}createFootprint(e){throw new he("CREATE_FOOTPRINT","Not Supported.")}updateDevice(e){throw new he("UPDATE_DEVICE","Not Supported.")}updateSymbol(e){throw new he("GET_SYMBOL","Not Supported.")}updateFootprint(e){throw new he("GET_SYMBOL","Not Supported.")}deleteDevice(e){throw new he("GET_SYMBOL","Not Supported.")}deleteSymbol(e){throw new he("GET_SYMBOL","Not Supported.")}deleteFootprint(e){throw new he("GET_SYMBOL","Not Supported.")}},pV=(e=>(e[e.BLANK=0]="BLANK",e[e.CBB=1]="CBB",e[e.SYMBOL=2]="SYMBOL",e[e.DEVICE=3]="DEVICE",e[e.FOOTPRINT=4]="FOOTPRINT",e[e.MODEL3D=5]="MODEL3D",e[e.MODELSIM=6]="MODELSIM",e[e.MODEL3DS=16]="MODEL3DS",e[e.PANEL=26]="PANEL",e[e.PANEL3D=27]="PANEL3D",e[e.PANEL_LIB=29]="PANEL_LIB",e))(pV||{}),fV=["title","description","tags","images"],kt=new bz,Bi=new dV,Zs=new hV,Ht=class{static getDevice(e){return Wi.getInstance().hasLib(e.path)?Zs.getDevice(e):e.isProject?Bi.getDevice(e):kt.getDevice(e)}static getSymbol(e){return Wi.getInstance().hasLib(e.path)?Zs.getSymbol(e):e.isProject?Bi.getSymbol(e):kt.getSymbol(e)}static getFootprint(e){return Wi.getInstance().hasLib(e.path)?Zs.getFootprint(e):e.isProject?Bi.getFootprint(e):kt.getFootprint(e)}static getD3Model(e){return e.isProject?null:kt.getD3Model(e)}static getSimModel(e){if(e.isProject)throw new he("GET_SIM_MODEL","Api call error!");return kt.getSimModel(e)}static getDeviceList(e){return Wi.getInstance().hasLib(e.path)?Zs.getDeviceList(e):e.isProject?Bi.getDeviceList(e):kt.getDeviceList(e)}static getSymbolList(e){return Wi.getInstance().hasLib(e.path)?Zs.getSymbolList(e):e.isProject?Bi.getSymbolList(e):kt.getSymbolList(e)}static getFootprintList(e){return Wi.getInstance().hasLib(e.path)?Zs.getFootprintList(e):e.isProject?Bi.getFootprintList(e):kt.getFootprintList(e)}static getD3ModelList(e){if(e.isProject)throw new he("GET_D3MODEL_LIST","Api call error!");return kt.getD3ModelList(e)}static getSimModelList(e){if(e.isProject)throw new he("GET_SIM_MODEL_LIST","Api call error!");return kt.getSimModelList(e)}static getDeviceSearchList(e){return Wi.getInstance().hasLib(e.path)?Zs.getDeviceSearchList(e):e.isProject?Bi.getDeviceList(e):kt.getDeviceSearchList(e)}static getSymbolSearchList(e){return Wi.getInstance().hasLib(e.path)?Zs.getSymbolSearchList(e):e.isProject?Bi.getSymbolList(e):kt.getSymbolSearchList(e)}static getFootprintSearchList(e){return Wi.getInstance().hasLib(e.path)?Zs.getFootprintSearchList(e):e.isProject?Bi.getFootprintList(e):kt.getFootprintSearchList(e)}static getD3ModelSearchList(e){if(e.isProject)throw new he("GET_D3MODEL_SEARCH_LIST","Api call error!");return kt.getD3ModelSearchList(e)}static getSimModelSearchList(e){if(e.isProject)throw new he("GET_SIM_MODEL_SEARCH_LIST","Api call error!");return kt.getSimModelSearchList(e)}static createDevice(e){return e.isProject?Bi.createDevice(e):kt.createDevice(e)}static createSymbol(e){return e.isProject?Bi.createSymbol(e):kt.createSymbol(e)}static createFootprint(e){return e.isProject?Bi.createFootprint(e):kt.createFootprint(e)}static createD3Model(e){return e.isProject?null:kt.createD3Model(e)}static createSimModel(e){if(e.isProject)throw new he("CREATE_SIM_MODEL","Api call error!");return kt.createSimModel(e)}static updateDevice(e){return e.isProject?Bi.updateDevice(e):kt.updateDevice(e)}static updateDeviceAttributes(e){return e.isProject?Bi.updateDeviceAttributes(e):kt.updateDeviceAttributes(e)}static updateSymbol(e){return e.isProject?Bi.updateSymbol(e):kt.updateSymbol(e)}static updateFootprint(e){return e.isProject?Bi.updateFootprint(e):kt.updateFootprint(e)}static updateSimModel(e){if(e.isProject)throw new he("UPDATE_SIM_MODEL","Api call error!");return kt.updatesimModel(e)}static deleteDevice(e){return e.isProject?Bi.deleteDevice(e):kt.deleteDevice(e)}static deleteSymbol(e){return e.isProject?Bi.deleteSymbol(e):kt.deleteSymbol(e)}static deleteFootprint(e){return e.isProject?Bi.deleteFootprint(e):kt.deleteFootprint(e)}static deleteSimModel(e){if(e.isProject)throw new he("DELETE_SIM_MODEL","Api call error!");return kt.deleteSimModel(e)}};async function Yw(e,t,i,r={}){r.eachProcessHook&&r.eachProcessHook(.01);let n=i||Ge.SYSTEMLIB_UUID,s=null;if(t)try{s=await Ht.getDevice({isProject:e,path:i,uuid:t})}catch(c){console.warn(c)}r.eachProcessHook&&r.eachProcessHook(.25);let a=null,o={Footprint:!1,symbol:!1,d3DModel:!1};if(s){let c=(s.attributes||{}).Symbol;if(c){try{a=await Ht.getSymbol({isProject:e,path:i,uuid:c})}catch(h){console.warn(h)}a||(o.symbol=!0)}}r.eachProcessHook&&r.eachProcessHook(.5);let l=null;if(s){let c=(s.attributes||{}).Footprint;if(c){try{l=await Ht.getFootprint({isProject:e,path:i,uuid:c})}catch(h){console.warn(h)}l||(o.Footprint=!0)}}r.eachProcessHook&&r.eachProcessHook(.75);let u=null;if(s){let c=s.attributes||{},h=c["3D Model"],m=c["3D Model Title"],f=pd(h,!0),g=f.path||Ge.SYSTEMLIB_UUID||n;if(f.componentTitleOrId&&(f.isLocaleFilenameMode?u=(await b0(f.componentTitleOrId,g)).result:u=await fd(f.componentTitleOrId,g)),!u&&h&&m){if(r.isCheckD3ModelFileExist){let y=await OW(h);y.success&&y.result instanceof Blob?o.d3DModel=!1:o.d3DModel=!0}else o.d3DModel=!0;u=dw(h,m,f.path)}}return r.eachProcessHook&&r.eachProcessHook(1),{setPath:n,deviceItem:s,symbolItem:a,footprintItem:l,d3modelItem:u,hasIdButNotFound:o}}async function mV(e=!1,t,i,r,n){let s=n?!!n.forceAsSymbol:!1,a=n?!!n.ignoreDoctypeCheck:!1,o=n?!!n.isDevice:!1,l=n?!!n.isCheckD3ModelFileExist:!1;if(!a){if(r===28){let h=n?!!n.attachedDeviceBindingExtra:!1,m=n?n.eachProcessHook:null;try{let f=null;return h?f=await Yw(e,t,i,{eachProcessHook:m,isCheckD3ModelFileExist:l}):f=await Ht.getDevice({isProject:e,path:i,uuid:t}),{code:0,success:!0,result:f,message:""}}catch(f){return{code:-1,success:!1,result:null,message:f.message.toString()}}}if(r===4)try{return{code:0,success:!0,result:await Ht.getFootprint({isProject:e,path:i,uuid:t}),message:""}}catch(h){return{code:-1,success:!1,result:null,message:h.message.toString()}}if(s||r&&[2,18,19,20,21,22,25,31,7,32,6].indexOf(r)>=0)try{return{code:0,success:!0,result:await Ht.getSymbol({isProject:e,path:i,uuid:t}),message:""}}catch(h){return{code:-1,success:!1,result:null,message:h.message.toString()}}if(r===16)try{return{code:0,success:!0,result:await fd(t,i),message:""}}catch(h){return{code:-1,success:!1,result:null,message:h.message.toString()}}}let u=await pt("GET",o?`/api/v2/devices/${t}`:`/api/v2/components/${t}`,{uuid:t,path:i},{headers:{"Content-type":"application/json","content-type":"application/json",path:i}});if(u.code===0&&u.success&&typeof u.result=="object")return{code:0,success:!0,result:u.result,message:""};let c=u.message||u.msg||"Request Error.";return{code:u.code||-1,success:!1,result:null,message:c}}function $b(e,t){let i=e.owner||{},r=typeof e.updated_at=="string"?e.updated_at:typeof e.updated_at=="number"?Vo(new Date(e.updated_at)):"",n=typeof e.updateTime=="string"?e.updateTime:typeof e.updateTime=="number"?Vo(new Date(+e.updateTime*1e3)):"";return{...e,$id:String(t),numberIndex:t+1,ownerBelong:i.username,updateTimeString:r||n}}function gV(e,t,i){let r=[];for(let n=0;n<e.length;n++){let s=e[n][t]?e[n][t].toLocaleLowerCase():"",a=i?i.toLocaleLowerCase():"";s.indexOf(a)>=0&&r.push(e[n])}return r}async function yV(e,t,i,r){let n=await new Promise(a=>{fetch(p0.D3Model.client3DModelList,{method:"GET",body:JSON.stringify({step_path:e})}).then(o=>{o.json().then(l=>{if(l){a(l);return}a(null)})})}),s={code:0,success:!0,result:{count:0,page:1,pageSize:r,totalPage:1,lists:[]},msg:""};return n&&n.success?(s.result.lists=(n.result||[]).map((a,o)=>{let l=Vo(new Date(a.mtime*1e3)),u={uuid:`${a.fileName}|${t}`,rowFileTag:`${a.fileName}|${t}`,path:t,display_title:a.fileName,description:"",docType:16,isFavorite:!1,modifier:null,owner:null,tags:{child_tag:[],parent_tag:[]},title:a.fileName,updateTime:a.mtime/1e3,updated_at:l,createTime:a.mtime/1e3,created_at:l,creator:null,dataStr:"",public:void 0,type:16};return{...$b(u,o)}}),s.result.count=n.result.length):(s.code=Ge.ERR_CODE.NORMAL,s.success=!1,s.msg=n.message||"Fetch local 3D model list error."),s}async function _V(e,t,i,r,n){let s={};for(let u=0;u<t.length;u++){let c=t[u].id,h=await new Promise(m=>{fetch(p0.D3Model.client3DModelList,{method:"GET",body:JSON.stringify({step_path:e})}).then(f=>{f.json().then(g=>{if(g){m(g);return}m(null)})})});if(h&&h.success){s[c]={list:h.result.map((m,f)=>$b(m,f))};continue}s[c]=null}let a={},o={},l={count:0};for(let u=0;u<t.length;u++){let c=t[u].id;if(s[c]){let h=gV(s[c].list,"fileName",r);if(!h.length){a[c]=0,o[c]=[];continue}a[c]=h.length,o[c]=h.map((m,f)=>{let g=Vo(new Date(m.mtime*1e3)),y={uuid:`${m.fileName}|${m.path}`,path:m.path,rowFileTag:`${m.fileName}|${m.path}`,display_title:m.fileName,description:"",docType:16,isFavorite:!1,modifier:null,owner:null,tags:{child_tag:[],parent_tag:[]},title:m.fileName,updateTime:m.mtime/1e3,updated_at:g,createTime:m.mtime/1e3,created_at:g,creator:null,dataStr:"",public:void 0,source:void 0,std_uuid:void 0,ticket:0,type:16};return{...$b(y,f)}}),l.count++;continue}a[c]=0,o[c]=[]}return{code:0,success:!0,result:{count:l.count,facets:a,lists:o,uid:e,wd:r,page:1,pageSize:n,totalPage:1},msg:""}}var bV=(e=>(e.ERROR_DATA="Document data abnormality",e.COMPONENT_TITLE_OVER_SIZE="The title length must be between 1~128 characters!",e.COMPONENT_DESC_OVER_SIZE="Description should be no more than 255 letters",e))(bV||{});function Gw(e){let t=null;return t=Ww(e.title),!t.success||(t=zw(e.description),!t.success)?t:{code:0,success:!0,message:"",key:"",result:null}}function Ww(e){let t={code:0,success:!0,message:"",key:"",result:null};return(!e||e.length<=0||e.length>128)&&(t.code=Ge.ERR_CODE.NORMAL,t.success=!1,t.message="The title length must be between 1~128 characters!"),t}function zw(e){let t={code:0,success:!0,message:"",key:"",result:null};return e&&e.length>255&&(t.code=Ge.ERR_CODE.NORMAL,t.success=!1,t.message="Description should be no more than 255 letters"),t}async function PV(e,t,i,r){if(!t||!i||!r)return{code:-1,success:!1,result:null,message:"missing uuid or path or detail data."};let n=Gw({title:r.title,description:r.description});if(!n.success)return{code:n.code,success:!1,result:null,message:n.message};let s=await pt("POST",`/api/v2/components/${t}/update`,JSON.stringify({...r,owner:i}),{headers:{"Content-type":"application/json","content-type":"application/json",path:i}});if(s.code===0&&s.success&&typeof s.result=="object")return{code:0,success:!0,result:s.result,message:""};let a=s.message||s.msg||"Request Error.";return{code:s.code||-1,success:!1,result:null,message:a}}var Br,EV=(Br=class{},Br.createDefaultD3modelItem=dw,Br.fetchD3ModelItemHandle=fd,Br.updateD3ModelItem=PV,Br.d3modelInfoVerify=Gw,Br.d3modelInfoTitleVerify=Ww,Br.d3modelInfoDescriptionVerify=zw,Br.fetchD3ModelListOnLocaleFolder=yV,Br.fetchD3ModelListBySearchOnLocaleFolder=_V,Br.fetchD3ModelItemOnLocaleFolder=b0,Br),SV=(e=>(e.ERROR_DATA="Document data abnormality",e.COMPONENT_TITLE_OVER_SIZE="The title length must be between 1~128 characters!",e.COMPONENT_DESC_OVER_SIZE="Description should be no more than 255 letters",e.COMPONENT_ATTRIBUTES_OVER_SIZE="{0} should be no more than 255 letters",e))(SV||{});function vV(e,t=void 0){let i=null;if(i=Vw(e.title),!i.success||(i=qw(e.description),!i.success)||(i=Xw(e.attributes),!i.success))return i;let r={code:0,success:!0,message:"",key:"",result:null};return typeof t<"u"&&(t.length<=0||t.length>128)&&(r.code=Ge.ERR_CODE.NORMAL,r.success=!1,r.message="The title length must be between 1~128 characters!"),r}function Vw(e){let t={code:0,success:!0,message:"",key:"",result:null};return(!e||e.length<=0||e.length>128)&&(t.code=Ge.ERR_CODE.NORMAL,t.success=!1,t.message="The title length must be between 1~128 characters!"),t}function qw(e){let t={code:0,success:!0,message:"",key:"",result:null};return e&&e.length>255&&(t.code=Ge.ERR_CODE.NORMAL,t.success=!1,t.message="Description should be no more than 255 letters"),t}function Xw(e){let t={code:0,success:!0,message:"",key:"",result:null},i=Object.keys(e);for(let r=0;r<i.length;r++){let n=i[r],s=e[n];if(typeof s=="string"&&s.trim().length>255)return t.code=Ge.ERR_CODE.NORMAL,t.message="{0} should be no more than 255 letters",t.key=n,t}return t}var Ps,IV=(Ps=class{},Ps.deviceInfoVerify=vV,Ps.deviceInfoTitleVerify=Vw,Ps.deviceInfoDescriptionVerify=qw,Ps.deviceInfoAttributesVerify=Xw,Ps.fetchDeviceItem=Yw,Ps);function AV(){return[["DOCTYPE","FOOTPRINT",""],["HEAD",{editorVersion:"dev",importFlag:0}],["CANVAS",0,0,"mm",5,5,5,5,5,5,2,2,5]].map(e=>JSON.stringify(e)).join(`
`)}function CV(e="",t="",i=""){let r=t||"[Empty Footprint Component Item]",n=new Date().getTime(),s=Vo(new Date(n)),a={avatar:"",nickname:"",username:"",uuid:""};return{$emptyItem:!0,createTime:n,created_at:s,creator:{...a},dataStr:e,description:"",display_title:r,docType:4,modifier:{...a},owner:{...a},path:Ge.SYSTEMLIB_UUID,public:!1,source:"",std_uuid:"",tags:{child_tag:null,parent_tag:null},ticket:0,title:r,type:0,updateTime:n,updated_at:s,uuid:i||"",version:""}}var xV=(e=>(e.ERROR_DATA="Document data abnormality",e.COMPONENT_TITLE_OVER_SIZE="The title length must be between 1~128 characters!",e.COMPONENT_DESC_OVER_SIZE="Description should be no more than 255 letters",e))(xV||{});function TV(e){let t=null;return t=wV(e.title),t.success?{code:0,success:!0,message:"",key:void 0,result:null}:t}function wV(e){let t={code:0,success:!0,message:"",key:void 0,result:null};return(!e||e.length<=0||e.length>128)&&(t.code=Ge.ERR_CODE.NORMAL,t.success=!1,t.message="The title length must be between 1~128 characters!"),t}var Wa,RV=(Wa=class{},Wa.footprintInfoVerify=TV,Wa.createEmptyFootprintItem=CV,Wa.createEmptyFootprintDataStr=AV,Wa),LV=(e=>(e.ERROR_DATA="Document data abnormality",e.COMPONENT_TITLE_OVER_SIZE="The title length must be between 1~128 characters!",e.COMPONENT_DESC_OVER_SIZE="Description should be no more than 255 letters",e))(LV||{});function NV(e){let t=null;return t=DV(e.title),!t.success||(t=BV(e.docType),!t.success)?t:{code:0,success:!0,message:"",key:void 0,result:null}}function DV(e){let t={code:0,success:!0,message:"",key:void 0,result:null};return(!e||e.length<=0||e.length>128)&&(t.code=Ge.ERR_CODE.NORMAL,t.success=!1,t.message="The title length must be between 1~128 characters!"),t}function BV(e){let t={code:0,success:!0,message:"",key:void 0,result:null};return(typeof e>"u"||!e)&&(t.code=Ge.ERR_CODE.NORMAL,t.success=!1,t.message="Document data abnormality"),t}var au,OV=(au=class{},au.symbolInfoVerify=NV,au),MV=(e=>(e.UNZIP="/pro-mgr/unzip",e.EXTRACT="/pro-mgr/unzip/extract",e.FLOW="/pro-mgr/unzip/flow",e.GET_PROJECT_IN_CLOUD="/pro-mgr/getProjectInCloud",e.GET_PROJECT_IN_LOCAL="/pro-mgr/getProjectInLocal",e.GET_PROJECT_BY_IN_LOCAL="/pro-mgr/getProjectByInLocal",e.EXPORT_ZIP="/pro-mgr/export/zip",e.EXPORT_DEVICE="/pro-mgr/export/lib/device",e.EXPORT_SYMBOL="/pro-mgr/export/lib/symbol",e.EXPORT_FOOTPRIN="/pro-mgr/export/lib/footprint",e.EXPORT_PANEL_LIB="/pro-mgr/export/lib/panelLib",e.DOWNLOAD_PROJECT="/pro-mgr/export/download/project",e.DOWNLOAD_CBB="/pro-mgr/export/download/cbb",e.DOWNLOAD_DOCUMENT="/pro-mgr/export/download/document",e.BACKUP="/pro-mgr/backup",e.ARCHIVE="/pro-mgr/archive",e.LOAD_FILE="/pro-mgr/loadFile",e.CONVERT_PROJECT="/pro-mgr/convertProject/start",e.CONVERT_PROJECT_FLOWWIRTE="/pro-mgr/convertProject/flowWrite",e.CONVERT_PROJECT_FLOWREAD="/pro-mgr/convertProject/flowRead",e.IMPORT_NEW_PROJECT="/pro-mgr/importNewProject",e.PROJECT_AS_CLOUD="/pro-mgr/projectAsCloud",e.CBB_AS_CLOUD="/pro-mgr/cbbAsCloud",e.DOCUMENT_AS_CLOUD="/pro-mgr/documentAsCloud",e.COMPONENT_AS_CLOUD="/pro-mgr/componentAsCloud",e.IMPORT_TARGET_PROJECT="/pro-mgr/importTargetProject",e.UPDATE_BLOCK_SYMBOL_CONNECT="/pro-mgr/updateBlockSymbolConnect",e.IMPORT_SYMBOLS="/pro-mgr/importSymbols",e.IMPORT_FOOTPRINTS="/pro-mgr/importFootprints",e.IMPORT_DEVICES="/pro-mgr/importDevices",e.COPY_BOARD="/pro-mgr/copyBoards",e.COPY_SCHEMATIC="/pro-mgr/copySchematics",e.COPY_PAGE="/pro-mgr/copyPages",e.COPY_SCH_CANVAS="/pro-mgr/copySchCanvas",e.COPY_PCB_CANVAS="/pro-mgr/copyPcbCanvas",e.COPY_PANEL_CANVAS="/pro-mgr/copyPanelCanvas",e.PASTE_BOARD="/pro-mgr/pasteBoards",e.PASTE_SCHEMATIC="/pro-mgr/pasteSchematics",e.PASTE_PAGE="/pro-mgr/pastePages",e.PASTE_SCH_TOP="/pro-mgr/pasteSchTop",e.PASTE_PCB="/pro-mgr/pastePcb",e.PASTE_PANEL="/pro-mgr/pastePanel",e.PASTE_SCH_BOTTOM="/pro-mgr/pasteSchBottom",e.BUILD_EXPORT="/pro-mgr/buildExport",e.BUILD_TARGET="/pro-mgr/buildTarget",e.PARSE_PROJECT="/pro-mgr/parseProject",e.COMPARE_LOCAL="/pro-mgr/compare/local",e.COMPARE_CLOUD="/pro-mgr/compare/cloud",e.COMPARE_DESTORY="/pro-mgr/compare/destory",e.UPDATE_REUSE_BLOCK="/pro-mgr/updateReuseBlock",e))(MV||{});var fte=rd(nd());var mte=rd(nd());var kV=(e=>(e[e.Free=1]="Free",e[e.Strict=3]="Strict",e))(kV||{});var FV=(e=>(e.name="name",e.default_sheet="default_sheet",e.cbb_project="cbb_project",e))(FV||{}),UV=(e=>(e.Export2_0="export2.0",e.Export3_0="export3.0",e.Target3_0="exist3.0",e))(UV||{});var gte=rd(nd()),HV=(e=>(e[e.NONE=1]="NONE",e[e.CLIENT_BUT_UUID=2]="CLIENT_BUT_UUID",e[e.ONLINE_BUT_PATH=3]="ONLINE_BUT_PATH",e))(HV||{});var Ki,jV=(Ki=class{},Ki.D3Model=EV,Ki.Device=IV,Ki.Footprint=RV,Ki.Symbol=OV,Ki.deleteComponentItem=uw,Ki.deleteComponents=xW,Ki.fetchComponentItem=mV,Ki.queryComponentsByTitle=pf,Ki.pickUpComponentTags2Ids=cw,Ki.pickUpComponentTags2Names=Jo,Ki.getDataStrById=Xn,Ki.duplicateNameDetection=Ko,Ki),px=class Oo{static async getOldLibByNet(t){try{let{dataStrId:i,dataStr:r}=t;return i||r?{success:!0,result:(await Re.messageBus.rpcCall("/pro-mgr/public/getDataStr",t)).message||""}:{success:!1,message:"Failed to obtain the source code of the existing component library!"}}catch(i){return{success:!1,message:i.message}}}static transform(t,i){let{uuid:r,docType:n}=i,s="";if(n===4){let a=i.isConnectDevice;s=tG(r,t,a)}else n===29?s=oG(r,t,zc.PANEL_LIB):uf(n)&&(s=nG(r,t).dataStr);return s}static async getOtherLibByNet(t){try{let{isProject:i,uuid:r,path:n,docType:s}=t;if(zG(t)){let u={ignoreDoctypeCheck:!0},c=(await jV.fetchComponentItem(i,r,n,s,u)).result;t=Object.assign(t,c)}let{history_uuid:a,dataStrId:o,dataStr:l}=t;if(a){let u={uuid:r,historyUuid:a},c=(await Re.messageBus.rpcCall(ua.COMPONENT.GET_HISTORY,u)).message;if(!c.success){let h=["Conversion component format failed!",c.message];return{success:!1,code:c.code,message:h}}return{success:!0,result:(await Re.messageBus.rpcCall(ua.COMPONENT.GET_HISTORY_DATA,[c.result])).message}}else if(o||l){let u=await Oo.getOldLibByNet(t);if(!u.success){let m=["Conversion component format failed!",u.message];return{success:!1,code:u.code,message:m}}let c=u.result,h=Oo.transform(c,t);return h?{success:!0,result:h}:{success:!1,message:["Conversion component format failed!","Illegal docType!"]}}else return{success:!0,result:""}}catch(i){return{success:!1,message:i.message}}}static async getOtherLibByWorker(t){try{let i=An();return{success:!0,result:await VG(`/${i._TAB_ID_}/libWorker`).rpcCall("/mgr/libWorker/getDataByType",t)}}catch(i){return{success:!1,message:i.message}}}static async getProjectLibByWorker(t){try{let{path:i,uuid:r,docType:n}=t,{message:s}=await Re.messageBus.rpcCall("/pro-mgr/hasProject",[i]);return s?n===4?{success:!0,result:(await Re.messageBus.rpcCall(Qe.FOOTPRINT.GET_STR,[r,i])).message||""}:uf(n)?{success:!0,result:(await Re.messageBus.rpcCall(Qe.SYMBOL.GET_STR,[r,i])).message||""}:{success:!1,message:"Api call error! The api does not exist!"}:{success:!1,message:"Get project library data source Project is not open!"}}catch(i){return{success:!1,message:i.message}}}static async getExtendLib(t){var a,o;let{path:i,uuid:r}=t,n=await((o=(a=Wi.getInstance().getLib(i))==null?void 0:a.footprint)==null?void 0:o.getTransformedDetail(r));if(!(n!=null&&n.dataStr))return{success:!1,message:["Conversion component format failed!","Failed to obtain the source code of the existing component library!"]};let s;return n.dataStr.trim().startsWith("[")?s=Oo.transform(n.dataStr,t):s=n.dataStr,s?{success:!0,result:s}:{success:!1,message:["Conversion component format failed!","Illegal docType!"]}}static async getProLibSource(t){try{let{isProject:i,path:r}=t;return Wi.getInstance().hasLib(r)?Oo.getExtendLib(t):i?Oo.getProjectLibByWorker(t):Oo.getOtherLibByWorker(t)}catch(i){return{success:!1,message:i.message}}}},YV=(e=>(e.INIT_DB="/CommonDB/initDB",e))(YV||{}),GV=(e=>(e.GET="/CommonDB/project/getData",e.GET_ALL="/CommonDB/project/getAllArrData",e))(GV||{}),WV=(e=>(e.GET="/CommonDB/copyAndPaste/getData",e.SET="/CommonDB/copyAndPaste/setData",e.IS_EXIST="/CommonDB/copyAndPaste/isExist",e.GET_DATA_FROM_PCB_CANVAS="/CommonDB/copyAndPaste/getDataFromPcbCanvas",e))(WV||{}),zV=(e=>(e.GET="/CommonDB/copyAndPasteTableCell/getData",e.SET="/CommonDB/copyAndPasteTableCell/setData",e.IS_EXIST="/CommonDB/copyAndPasteTableCell/isExist",e))(zV||{}),VV=(e=>(e.SET="/CommonDB/log/setData",e.DEL="/CommonDB/log/delData",e.DEL_LOTS="/CommonDB/log/delLotsData",e.GET_ALL="/CommonDB/log/getAllArrData",e))(VV||{}),qV=(e=>(e.SET="/CommonDB/basicLibraryList/addData",e.GET="/CommonDB/basicLibraryList/getData",e.IS_EXIST="/CommonDB/basicLibraryList/isExist",e))(qV||{}),XV=(e=>(e.SET="/CommonDB/clipBoard/addData",e.GET="/CommonDB/clipBoard/getData",e.IS_EXIST="/CommonDB/clipBoard/isExist",e))(XV||{}),JV=(e=>(e.GET="/CommonDB/lockPrj/getData",e.READ_WRITE="/CommonDB/lockPrj/readwriteData",e))(JV||{}),$V=(e=>(e.GET="/CommonDB/prjCache/getData",e.SET="/CommonDB/prjCache/addData",e.DEL="/CommonDB/prjCache/delData",e.DEL_LOTS="/CommonDB/prjCache/delLotsData",e.GET_INDEXS="/CommonDB/prjCache/getAllIndexs",e.GET_COUNT="/CommonDB/prjCache/getCount",e.GET_EARLIEST="/CommonDB/prjCache/getEarliest",e))($V||{});var KV=(e=>(e.CREATE="/pro-mgr/library/cbb/create",e.GET_EXPORT="/pro-mgr/library/cbb/getExport",e.GET_TARGET="/pro-mgr/library/cbb/getTarget",e.LIST="/pro-mgr/library/cbb/list",e.PLACE="/pro-mgr/library/cbb/place",e))(KV||{}),ZV=(e=>(e.CREATE="/pro-mgr/new/cloud/create",e.PROJECT="/pro-mgr/new/cloud/project",e.BOARD="/pro-mgr/new/cloud/board",e.SCHEMATIC="/pro-mgr/new/cloud/schematic",e.SHEET="/pro-mgr/new/cloud/sheet",e.SIMULATION="/pro-mgr/new/cloud/simulation",e.PCB="/pro-mgr/new/cloud/pcb",e.PANEL="/pro-mgr/new/cloud/panel",e))(ZV||{}),QV=(e=>(e.BOARD="/pro-mgr/new/local/board",e.SCHEMATIC="/pro-mgr/new/local/schematic",e.SHEET="/pro-mgr/new/local/sheet",e.SIMULATION="/pro-mgr/new/local/simulation",e.PCB="/pro-mgr/new/local/pcb",e.PANEL="/pro-mgr/new/local/panel",e))(QV||{});var eq=(e=>(e.FORCE="/pro-mgr/project/updateData/force",e.SUSPEND="/pro-mgr/project/updateData/suspend",e.RESUME="/pro-mgr/project/updateData/resume",e.GET="/pro-mgr/project/updateData/getLastest",e.IS_PUBLIC="/pro-mgr/project/updateData/isPublic",e.UPDATE_TEAM="/pro-mgr/project/updateData/updateTeam",e))(eq||{}),tq=(e=>(e.UPDATE="/pro-mgr/project/updateData/schematic/update",e.GET="/pro-mgr/project/updateData/schematic/getData",e.MAP="/pro-mgr/project/updateData/schematic/map",e.NOTIFY="/pro-mgr/project/updateData/schematic/notify",e))(tq||{}),iq=(e=>(e.UPDATE="/pro-mgr/project/updateData/sheet/update",e.GET="/pro-mgr/project/updateData/sheet/getData",e.MAP="/pro-mgr/project/updateData/sheet/map",e.NOTIFY="/pro-mgr/project/updateData/sheet/notify",e))(iq||{}),rq=(e=>(e.UPDATE="/pro-mgr/project/updateData/pcb/update",e.GET="/pro-mgr/project/updateData/pcb/getData",e.MAP="/pro-mgr/project/updateData/pcb/map",e.NOTIFY="/pro-mgr/project/updateData/pcb/notify",e))(rq||{}),nq=(e=>(e.UPDATE="/pro-mgr/project/updateData/symbol/update",e.GET="/pro-mgr/project/updateData/symbol/getData",e.MAP="/pro-mgr/project/updateData/symbol/map",e.NOTIFY="/pro-mgr/project/updateData/symbol/notify",e))(nq||{}),sq=(e=>(e.UPDATE="/pro-mgr/project/updateData/footprint/update",e.GET="/pro-mgr/project/updateData/footprint/getData",e.MAP="/pro-mgr/project/updateData/footprint/map",e.NOTIFY="/pro-mgr/project/updateData/footprint/notify",e))(sq||{}),aq=(e=>(e.UPDATE="/pro-mgr/project/updateData/device/update",e.GET="/pro-mgr/project/updateData/device/getData",e.MAP="/pro-mgr/project/updateData/device/map",e.NOTIFY="/pro-mgr/project/updateData/device/notify",e))(aq||{});var oq=(e=>(e.PROGRESS="/pro-ui/progressUpdate",e.OPENED_PROJECT="/pro-ui/project/openedProject",e.HAS_UNSAVED="/pro-ui/project/hasUnsaved",e.OPEN="/pro-ui/project/open",e.CLOSE="/pro-ui/project/close",e.ON_OPENED="/pro-ui/project/onOpened",e.ON_FAILED="/pro-mgr/project/onFailed",e.ON_CLOSED="/pro-ui/project/onClosed",e.ADD_HASH="/pro-ui/hash/add/id",e.REMOVE_HASH="/pro-ui/hash/remove/id",e))(oq||{}),lq=(e=>(e.ON_UPDATE="/pro-mgr/project/project/onUpdate",e.UPLOAD_FAILED="/pro-mgr/project/upload/onfailed",e))(lq||{}),uq=(e=>(e.ON_UPDATE="/pro-mgr/project/config/onUpdate",e))(uq||{}),cq=(e=>(e.ON_ADD="/pro-mgr/project/board/onAdd",e.ON_DELETE="/pro-mgr/project/board/onDelete",e.ON_UPDATE="/pro-mgr/project/board/onUpdate",e))(cq||{}),dq=(e=>(e.ON_ADD="/pro-mgr/project/schematic/onAdd",e.ON_DELETE="/pro-mgr/project/schematic/onDelete",e.ON_UPDATE="/pro-mgr/project/schematic/onUpdate",e.ON_UPDATETIME="/pro-mgr/project/schematic/onUpdateTime",e))(dq||{}),hq=(e=>(e.ON_ADD="/pro-mgr/project/sheet/onAdd",e.ON_DELETE="/pro-mgr/project/sheet/onDelete",e.ON_UPDATE="/pro-mgr/project/sheet/onUpdate",e.ON_UPDATETIME="/pro-mgr/project/sheet/onUpdateTime",e))(hq||{}),pq=(e=>(e.ON_ADD="/pro-mgr/project/pcb/onAdd",e.ON_DELETE="/pro-mgr/project/pcb/onDelete",e.ON_UPDATE="/pro-mgr/project/pcb/onUpdate",e.ON_UPDATETIME="/pro-mgr/project/pcb/onUpdateTime",e))(pq||{}),fq=(e=>(e.ON_ADD="/pro-mgr/project/panel/onAdd",e.ON_DELETE="/pro-mgr/project/panel/onDelete",e.ON_UPDATE="/pro-mgr/project/panel/onUpdate",e.ON_UPDATETIME="/pro-mgr/project/panel/onUpdateTime",e))(fq||{}),mq=(e=>(e.ON_ADD="/pro-mgr/project/simulation/onAdd",e.ON_DELETE="/pro-mgr/project/simulation/onDelete",e.ON_UPDATE="/pro-mgr/project/simulation/onUpdate",e.ON_UPDATETIME="/pro-mgr/project/simulation/onUpdateTime",e))(mq||{}),gq=(e=>(e.ON_ADD="/pro-mgr/project/device/onAdd",e.ON_DELETE="/pro-mgr/project/device/onDelete",e.ON_UPDATE="/pro-mgr/project/device/onUpdate",e.ON_UPDATETIME="/pro-mgr/project/device/onUpdateTime",e))(gq||{}),yq=(e=>(e.ON_ADD="/pro-mgr/project/symbol/onAdd",e.ON_DELETE="/pro-mgr/project/symbol/onDelete",e.ON_UPDATE="/pro-mgr/project/symbol/onUpdate",e.ON_UPDATETIME="/pro-mgr/project/symbol/onUpdateTime",e))(yq||{}),_q=(e=>(e.ON_ADD="/pro-mgr/project/footprint/onAdd",e.ON_DELETE="/pro-mgr/project/footprint/onDelete",e.ON_UPDATE="/pro-mgr/project/footprint/onUpdate",e.ON_UPDATETIME="/pro-mgr/project/footprint/onUpdateTime",e))(_q||{}),bq=(e=>(e.ON_ADD="/pro-mgr/project/attr/onAdd",e.ON_DELETE="/pro-mgr/project/attr/onDelete",e.ON_UPDATE="/pro-mgr/project/attr/onUpdate",e))(bq||{}),Pq=(e=>(e.ON_ADD="/pro-mgr/project/blob/onAdd",e.ON_DELETE="/pro-mgr/project/blob/onDelete",e.ON_UPDATE="/pro-mgr/project/blob/onUpdate",e))(Pq||{}),Eq=(e=>(e.ON_ADD="/pro-mgr/project/variant/onAdd",e.ON_DELETE="/pro-mgr/project/variant/onDelete",e.ON_UPDATE_TITLE="/pro-mgr/project/variant/onUpdatetitle",e.ON_UPDATE_NOT_GROUPED="/pro-mgr/project/variant/onUpdateNotGrouped",e.ON_UPDATE_ZINDEX="/pro-mgr/project/variant/onUpdateZIndex",e.ON_ADD_COMPONENT_GROUP="/pro-mgr/project/variant/onAddComponentGroup",e.ON_DELETE_COMPONENT_GROUP="/pro-mgr/project/variant/onDeleteComponentGroup",e.ON_UPDATE_COMPONENT_GROUP_TITLE="/pro-mgr/project/variant/onUpdateComponentGroupTitle",e.ON_UPDATE_COMPONENT_GROUP_ZINDEX="/pro-mgr/project/variant/onUpdateComponentGroupZIndex",e.ON_UPLOAD_COMPONENT_GROUP_INDEX_IN_VARIANT="/pro-mgr/project/variant/onUploadComponentGroupZIndexInVariant",e.ON_DELETE_COMPONENT_GROUP_INDEX_IN_VARIANT="/pro-mgr/project/variant/onDeleteComponentGroupZIndexInVariant",e.ON_UPLOAD_COMPONENT_GROUP_DATA="/pro-mgr/project/variant/onUploadComponentGroupData",e.ON_DELETE_COMPONENT_GROUP_DATA="/pro-mgr/project/variant/onDeleteComponentGroupData",e))(Eq||{});var yte=new Error("list is empty");var Sq=(e=>(e.ALL_VALUE="@all",e.ALL_TITLE="All",e.ComponentSymbol="2",e.NetflagSymbol="18",e.NetportSymbol="19",e.DrawingSymbol="20",e.NonElectronicSymbol="21",e.OffPageConnectorSymbol="25",e.DiffPairsFlagSymbol="31",e))(Sq||{});async function Jw(){let e=await new Promise(t=>{fetch("/api/client/config",{method:"GET"}).then(i=>{i.json().then(r=>{t(r)})})});if(e&&e.success&&e.result){let t=e.result,i=t.projectDir instanceof Array?t.projectDir:[t.projectDir];return{basePath:t.appBaseDir,cbbPath:t.reuseBlock,libPath:t.systemLib,projectPath:i,onlinePrjBackupPath:t.appOnlineBackupDir,appBaseDir:t.appBaseDir,autoCheckVersionUpdate:!!t.checkUpdate,activation:t.activation,appTmpBackupDir:t.appTmpBackupDir,cacheDir:t.cacheDir,proxy:t.proxy,log:t.log}}else return null}function xf(e,t){let i=[],r=[];gf?r=e:t&&t.length?r=t:r=e;let n=null;return r.forEach(s=>{s.uuid===Ge.SYSTEMLIB_UUID?n={title:s.nickname,id:s.uuid,key:Ge.LIB_SYSTEM_KEY}:i.push({title:s.nickname,id:s.uuid,key:Ge.LIB_PERSONAL_KEY})}),n&&i.unshift(n),i}async function Tf(e,t){let i=xf(e,t)||[],r=[],n=null;return i.forEach((s,a)=>{s.id===Ge.SYSTEMLIB_UUID?n=a:r.push({title:s.title,id:s.id,key:s.key})}),(n||n===0)&&r.splice(0,0,{title:i[n].title,id:i[n].id,key:i[n].key}),r.splice(1,0,{title:"Project",id:"",key:Ge.LIB_PROJECT_KEY}),[...r]}async function vq(e,t){let i=await Jw();if(!i)return await Tf(e,t);let r=xf(e,t),n=ur(r,"id",Ge.SYSTEMLIB_UUID),s=[];n.index>=0&&s.splice(0,0,{...n.data});let{projectPath:a,cbbPath:o,libPath:l=[],onlinePrjBackupPath:u,autoCheckVersionUpdate:c}=i;return l.forEach(h=>{s.push({title:fx(h),id:h,key:h})}),s.splice(1,0,{title:"Project",id:"",key:Ge.LIB_PROJECT_KEY}),[...s]}function Iq(e,t,i,r){let n=[],s=[],a={},o=[];return e.forEach(l=>{switch(l.titleAdditional=l.title,l.title){case"Project":{if(!r||!i||!i.uuid)return;l.id=i.uuid,o.push(i.uuid);break}default:}l.id||(l.id="@"+id(new Date().getTime())),typeof a[l.id]<"u"?(a[l.id]+=1,l.id=l.id+Ge.LIB_SPLIT_TAG+a[l.id]):a[l.id]=0,t&&t.indexOf(l.id)>=0&&s.push(l.id),n.push(l)}),{treeData:n,projectsIds:o,selectedIds:s}}async function $w(e,t){let i=xf(e,t)||[],r=[],n=null;return i.forEach((s,a)=>{s.id===Ge.SYSTEMLIB_UUID?n=a:r.push({title:s.title,id:s.id,key:s.key})}),(n||n===0)&&r.splice(0,0,{title:i[n].title,id:i[n].id,key:i[n].key}),r.splice(1,0,{title:"Project",id:"",key:Ge.LIB_PROJECT_KEY}),[...r]}async function Aq(e,t){let i=await Jw();if(!i)return await Tf(e,t);let r=[],{projectPath:n,cbbPath:s,libPath:a=[],onlinePrjBackupPath:o,autoCheckVersionUpdate:l}=i;return a.forEach(u=>{r.push({title:fx(u),id:u,key:u})}),r.splice(1,0,{title:"Project",id:"",key:Ge.LIB_PROJECT_KEY}),[...r]}function Cq(e,t,i,r){let n=[],s=[],a={},o=[];return e.forEach(l=>{switch(l.titleAdditional=l.title,l.title){case"Project":{if(!r||!i||!i.uuid)return;l.id=i.uuid,o.push(i.uuid);break}default:}l.id||(l.id="@"+id(new Date().getTime())),typeof a[l.id]<"u"?(a[l.id]+=1,l.id=l.id+Ge.LIB_SPLIT_TAG+a[l.id]):a[l.id]=0,t&&t.indexOf(l.id)>=0&&s.push(l.id),n.push(l)}),{treeData:n,projectsIds:o,selectedIds:s}}function Kw(e,t){let i=[],r=[];return gf?r=e:t&&t.length?r=t:r=e,r.forEach(n=>{i.push({title:n.nickname,id:n.uuid,key:Ge.LIB_TEMAS_KEY})}),i}async function ff(e,t){let i=Kw(e,t);return[{title:"System",id:Ge.SYSTEMLIB_UUID,key:Ge.LIB_SYSTEM_KEY},{title:"Project",id:"",key:Ge.LIB_PROJECT_KEY},{title:"Personal",id:"",key:Ge.LIB_PERSONAL_KEY},{title:"Favorite",id:Ge.FAVORITELIB_UUID,key:Ge.LIB_FAVORITE_KEY},...i]}function Zw(e,t,i,r,n){let s=[],a=[],o={},l=[];return e.forEach(u=>{switch(u.title){case"Project":{if(!n||!r||!r.uuid)return;u.id=r.uuid,l.push(r.uuid);break}case"Personal":{if(!i||!i.uuid)return;u.id=i.uuid;break}case"Public":{u.id=Ge.PUBLICLIB_ALIAS;break}default:}u.id||(u.id="@"+id(new Date().getTime())),typeof o[u.id]<"u"?(o[u.id]+=1,u.id=u.id+Ge.LIB_SPLIT_TAG+o[u.id]):o[u.id]=0,t&&t.indexOf(u.id)>=0&&a.push(u.id),s.push(u)}),{treeData:s,projectsIds:l,selectedIds:a}}async function Kb(e,t){return await ff(e,t)}function xq(e,t,i,r,n){return Zw(e,t,i,r,n)}async function Qw(e,t,i,r,n,s){let a=[];return e==="Normal"?zn?$p?(a=await Kb(t,i),s&&Mp(a),a):Jp?(a=await Tf(t,i),s&&Mp(a),a):(a=await $w(t,i),s&&Mp(a),a):(a=await ff(t,i),s&&Mp(a),a):e==="D3Model"?zn?$p?(a=await Kb(t,i),a):Jp?(a=await vq(t,i),a):(a=await Aq(t,i),a):(a=await ff(t,i),a):[]}function Mp(e){let t=ur(e,"key",Ge.LIB_PROJECT_KEY);t.index>=0&&e.splice(t.index,1)}function e2(e,t,i,r,n,s,a){if(!zn){let l=Zw(e,i,r,n,typeof s<"u"?!!s:a);return kp(l,t),Fp(l)}if($p){let l=xq(e,i,r,n,typeof s<"u"?!!s:a);return kp(l,t),Fp(l)}if(Jp){let l=Iq(e,i,n,typeof s<"u"?!!s:a);return kp(l,t),Fp(l)}let o=Cq(e,i,n,typeof s<"u"?!!s:a);return kp(o,t),Fp(o)}function kp(e,t){let i=ur(e.treeData,"key",Ge.LIB_SYSTEM_KEY);i.index>=0&&e.treeData.splice(i.index,1);let r=ur(e.treeData,"key",Ge.LIB_PERSONAL_KEY);r.index>=0&&e.treeData.splice(r.index,1);let n=ur(e.treeData,"key","project");n.index>=0&&e.treeData.splice(n.index,1);let s=ur(e.treeData,"key",Ge.LIB_FAVORITE_KEY);s.index>=0&&e.treeData.splice(s.index,1);let a=ur(e.treeData,"key","selected");a.index>=0&&e.treeData.splice(a.index,1);let o=ur(e.treeData,"key","oshwhub");o.index>=0&&e.treeData.splice(o.index,1),e.treeData.sort((l,u)=>(l.title||"").localeCompare(u.title||"")),s.index>=0&&e.treeData.unshift(s.data),n.index>=0&&e.treeData.unshift(n.data),t==="Personal"?gf||r.index>=0&&e.treeData.unshift(r.data):e.selectedIds=e.selectedIds.filter(l=>{var u;return l!==((u=r==null?void 0:r.data)==null?void 0:u.id)}),o.index>=0&&e.treeData.unshift(o.data),i.index>=0&&e.treeData.unshift(i.data),a.index>=0&&e.treeData.push(a.data)}function Fp(e){return e.selectedIds.length?e.selectedIds:e.selectedIds.push(e.treeData[0].id),e}async function Tq(e,t,i,r,n,s,a,o,l=!0,u=!0,c=!0){let h={username:s.username,uuid:s.uuid},{projectId:m,title:f,isCBB:g}=n,y={uuid:m,title:f,isCBB:g},b=await Qw(t,a,o,e,i,l),E=e2(b,r,[],h,y,!l),S=[];for(let v=0;v<E.treeData.length;v++){let A=E.treeData[v];A.id===Ge.SYSTEMLIB_UUID&&u||A.id===Ge.FAVORITELIB_UUID&&c||(_f||bf||A.key===Ge.LIB_PERSONAL_KEY&&(A.title=A.titleAdditional=h.username),A.title&&S.push(A))}return S}var wq=(e=>(e.Normal="Normal",e.D3Model="D3Model",e.AssociateDeviceDialog="associateDeviceDialog",e.Cbb="Cbb",e))(wq||{}),Or,_te=(Or=class{},Or.createInitLibList=Qw,Or.createFixLibList=Tq,Or.filterInitLibList=e2,Or.fetchTeamsLibsFromGVars=Kw,Or.fetchClientTeamsLibsFromGVars=xf,Or.createSourceLibListByWebMode=ff,Or.createSourceLibListByOnlineClientMode=Kb,Or.createSourceLibListByOfflineClientMode=$w,Or.createSourceLibListByHalfofflineClientMode=Tf,Or),ou,bte=(ou=class{},ou.syncLoginedUserInfo=t=>{Re.loginedUserUuid=t.uuid},ou);VU();var{IS_CLIENT:Cn,IS_EASYEDA:wf,IS_LCEDA:t2,IS_PRIVATE:$a,IS_ONLINE:T0,IS_HALF_OFFLINE:i2,IS_OFFLINE:w0}=Qb;var r2=Cn&&!T0,Rf=Cn&&w0;var R0=(i=>(i[i.STRICT=3]="STRICT",i[i.FREE=1]="FREE",i))(R0||{}),Lf=class{async openProject(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Project.openProject",t)}async createProject(t,i,r,n,s,a=1){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Project.createProject",{projectFriendlyName:t,projectName:i,teamUuid:r,folderUuid:n,description:s,collaborationMode:a})}modifyProjectFriendlyName(t,i){return!1}modifyProjectDescription(t,i){return!1}modifyProjectCollaborationMode(t,i){return!1}moveProject(t,i,r){return!1}async moveProjectToFolder(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Project.moveProjectToFolder",{projectUuid:t,folderUuid:i})}copyProject(t,i,r,n,s){}async getAllProjectsUuid(t,i,r){return $a&&(r=void 0),i||t?await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Project.getAllProjectsUuid",{workspaceUuid:r,teamUuid:t,folderUuid:i}):[]}async getProjectInfo(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Project.getProjectInfo",t)}async getCurrentProjectInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Project.getCurrentProjectInfo")}deleteProject(t){return!1}};var Nf=class{async createSchematic(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.createSchematic",t)}async createSchematicPage(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.createSchematicPage",t)}async modifySchematicName(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.modifySchematicName",{uuid:t,value:i})}async modifySchematicPageName(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.modifySchematicPageName",{uuid:t,value:i})}async modifySchematicPageTitleBlock(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.modifySchematicPageTitleBlock",{showTitleBlock:t,titleBlockData:i})}async copySchematic(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.copySchematic",{schematicUuid:t,boardName:i})}async copySchematicPage(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.copySchematicPage",{schematicUuid:i,schematicPageUuid:t})}async getSchematicInfo(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.getSchematicInfo",t)}async getSchematicPageInfo(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.getSchematicPageInfo",t)}async getAllSchematicsInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.getAllSchematicsInfo")}async getAllSchematicPagesInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.getAllSchematicPagesInfo")}async getCurrentSchematicAllSchematicPagesInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.getCurrentSchematicAllSchematicPagesInfo")}async getCurrentSchematicInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.getCurrentSchematicInfo")}async getCurrentSchematicPageInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.getCurrentSchematicPageInfo")}async reorderSchematicPages(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.reorderSchematicPages",{schematicUuid:t,schematicPageItemsArray:i})}async deleteSchematic(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.deleteSchematic",t)}async deleteSchematicPage(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Schematic.deleteSchematicPage",t)}};var L0=(m=>(m.WORKSPACE="Workspace",m.TEAM="Team",m.FOLDER="Folder",m.PROJECT="Project",m.CBB_PROJECT="CBB Project",m.BOARD="Board",m.SCHEMATIC="Schematic",m.CBB_SCHEMATIC="CBB Schematic",m.SCHEMATIC_PAGE="Schematic Page",m.PCB="PCB",m.CBB_PCB="CBB PCB",m.PANEL="Panel",m))(L0||{}),gd=(E=>(E[E.HOME=-1]="HOME",E[E.BLANK=0]="BLANK",E[E.SCHEMATIC_PAGE=1]="SCHEMATIC_PAGE",E[E.PCB=3]="PCB",E[E.PCB_2D_PREVIEW=12]="PCB_2D_PREVIEW",E[E.PCB_3D_PREVIEW=15]="PCB_3D_PREVIEW",E[E.PANEL=26]="PANEL",E[E.PANEL_3D_PREVIEW=27]="PANEL_3D_PREVIEW",E[E.SYMBOL_COMPONENT=2]="SYMBOL_COMPONENT",E[E.SYMBOL_NET_FLAG=18]="SYMBOL_NET_FLAG",E[E.SYMBOL_NET_PORT=19]="SYMBOL_NET_PORT",E[E.SYMBOL_DRAWING=20]="SYMBOL_DRAWING",E[E.SYMBOL_NON_ELECTRICAL=21]="SYMBOL_NON_ELECTRICAL",E[E.SYMBOL_SHORT_CIRCUIT_FLAG=22]="SYMBOL_SHORT_CIRCUIT_FLAG",E[E.SYMBOL_CBB=17]="SYMBOL_CBB",E[E.FOOTPRINT=4]="FOOTPRINT",E[E.PANEL_LIBRARY=29]="PANEL_LIBRARY",E))(gd||{}),Df=class{async getCurrentDocumentInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_SelectControl.getCurrentDocumentInfo")}};var Bf=class{async getAllTeamsInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Team.getAllTeamsInfo")}async getAllInvolvedTeamInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Team.getAllInvolvedTeamInfo")}async getCurrentTeamInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Team.getCurrentTeamInfo")}};var Of=class{async getAllWorkspacesInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Workspace.getAllWorkspacesInfo")}async toggleToWorkspace(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Workspace.toggleToWorkspace",t)}async getCurrentWorkspaceInfo(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Workspace.getCurrentWorkspaceInfo")}};var yu=(o=>(o.MILLIMETER="mm",o.CENTIMETER="cm",o.DECIMETER="dm",o.METER="m",o.INCH="inch",o.IN="in",o.MIL="mil",o))(yu||{}),Mf=class{getSystemDataUnit(){return"mil"}milToMm(t,i=4){return Js(t*.0254,i,!1)}milToInch(t,i=4){return Js(t/1e3,i,!1)}mmToMil(t,i=4){return Js(t/.0254,i,!1)}mmToInch(t,i=4){return Js(t/25.4,i,!1)}inchToMil(t,i=4){return Js(t*1e3,i,!1)}inchToMm(t,i=4){return Js(t*25.4,i,!1)}};var Cs=(a=>(a.DEVICE="3",a.SYMBOL="2",a.FOOTPRINT="4",a.CBB="1",a.MODEL="5",a.PANEL_LIBRARY="29",a))(Cs||{}),kf=class{async createPrimary(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Classification.createPrimary",{libraryUuid:t,libraryType:i,primaryClassificationName:r})}async createSecondary(t,i,r,n){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Classification.createSecondary",{libraryUuid:t,libraryType:i,primaryClassificationUuid:r,secondaryClassificationName:n})}async getIndexByName(t,i,r,n){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Classification.getIndexByName",{libraryUuid:t,libraryType:i,primaryClassificationName:r,secondaryClassificationName:n})}async getNameByUuid(t,i,r,n){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Classification.getNameByUuid",{libraryUuid:t,libraryType:i,primaryClassificationUuid:r,secondaryClassificationUuid:n})}async getNameByIndex(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Classification.getNameByUuid",t)}async getAllClassificationTree(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Classification.getAllClassificationTree",{libraryUuid:t,libraryType:i})}async deleteByUuid(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Classification.deleteByUuid",{libraryUuid:t,classificationUuid:i})}async deleteByIndex(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Classification.deleteByIndex",t)}};var Ff=class{async create(t,i,r,n="mm"){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_3DModel.create",{libraryUuid:t,modelFile:i,classification:r,unit:n})}async delete(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_3DModel.delete",{modelUuid:t,libraryUuid:i})}async modify(t,i,r,n,s){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_3DModel.modify",{modelUuid:t,libraryUuid:i,modelName:r,classification:n,description:s})}async get(t,i){let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_3DModel.get",{modelUuid:t,libraryUuid:i});if(r!=null&&r.uuid)return{libraryType:"5",uuid:t,name:r.display_title,libraryUuid:r.owner.uuid,classification:{libraryUuid:r.owner.uuid,libraryType:"5",primaryClassificationUuid:r.tags.parent_tag.uuid,secondaryClassificationUuid:r.tags.child_tag.uuid},description:r.description}}async copy(t,i,r,n,s){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_3DModel.copy",{modelUuid:t,libraryUuid:i,targetLibraryUuid:r,targetClassification:n,newModelName:s})}async search(t,i,r,n=10,s=1){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_3DModel.search",{key:t,libraryUuid:i,classification:r,itemsOfPage:n,page:s})}};var Uf=class{async create(t,i,r,n){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Cbb.create",{libraryUuid:t,cbbName:i,classification:r,description:n})}async delete(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Cbb.delete",{cbbUuid:t,libraryUuid:i})}async modify(t,i,r,n,s){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Cbb.modify",{cbbUuid:t,libraryUuid:i,cbbName:r,classification:n,description:s})}async get(t,i){var n,s;let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Cbb.get",{cbbUuid:t,libraryUuid:i});if(r)return{libraryType:"1",uuid:t,libraryUuid:r.owner.uuid,name:r.name,description:r.content,classification:{libraryType:"1",libraryUuid:r.owner.uuid,primaryClassificationUuid:(n=r.tags.parent_tag)==null?void 0:n.uuid,secondaryClassificationUuid:(s=r.tags.child_tag)==null?void 0:s.uuid},boards:r.boards}}async copy(t,i,r,n,s){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Cbb.copy",{cbbUuid:t,libraryUuid:i,targetLibraryUuid:r,targetClassification:n,newCbbName:s})}async search(t,i,r,n=10,s=1){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Cbb.search",{key:t,libraryUuid:i,classification:r,itemsOfPage:n,page:s})}async openProjectInEditor(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Cbb.openProjectInEditor",{cbbUuid:t,libraryUuid:i})}async openSymbolInEditor(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Cbb.openSymbolInEditor",{cbbUuid:t,libraryUuid:i,splitScreenId:r})}};var jf=(u=>(u[u.COMPONENT=2]="COMPONENT",u[u.NET_FLAG=18]="NET_FLAG",u[u.NET_PORT=19]="NET_PORT",u[u.DRAWING=20]="DRAWING",u[u.NON_ELECTRICAL=21]="NON_ELECTRICAL",u[u.SHORT_CIRCUIT_FLAG=22]="SHORT_CIRCUIT_FLAG",u[u.OFF_PAGE_CONNECTOR=25]="OFF_PAGE_CONNECTOR",u[u.DIFFERENTIAL_PAIRS_FLAG=31]="DIFFERENTIAL_PAIRS_FLAG",u[u.CBB_SYMBOL=17]="CBB_SYMBOL",u))(jf||{}),Hf=class{async create(t,i,r,n,s){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Symbol.create",{libraryUuid:t,symbolName:i,classification:r,symbolType:n,description:s})}async delete(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Symbol.delete",{symbolUuid:t,libraryUuid:i})}async modify(t,i,r,n,s){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Symbol.modify",{symbolUuid:t,libraryUuid:i,symbolName:r,classification:n,description:s})}async updateDocumentSource(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Symbol.updateDocumentSource",{libraryUuid:i,symbolUuid:t,documentSource:r})}async get(t,i){let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Symbol.get",{symbolUuid:t,libraryUuid:i});if(r)return{name:r.title||r.display_title,libraryType:"2",uuid:t,libraryUuid:r.owner.uuid,classification:{libraryUuid:r.owner.uuid,libraryType:"2",primaryClassificationUuid:r.tags.parent_tag.uuid,secondaryClassificationUuid:r.tags.child_tag.uuid},type:r.docType,description:r.description}}async copy(t,i,r,n,s){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Symbol.copy",{symbolUuid:t,libraryUuid:i,targetLibraryUuid:r,targetClassification:n,newSymbolName:s})}async search(t,i,r,n,s=10,a=1){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Symbol.search",{key:t,libraryUuid:i,classification:r,symbolType:n,itemsOfPage:s,page:a})}async openInEditor(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Symbol.openInEditor",{symbolUuid:t,libraryUuid:i,splitScreenId:r})}};var N0=(i=>(i.STANDARD="standard",i.EXTEND="extend",i))(N0||{}),Yf=class{async create(t,i,r,n={symbolType:2},s,a={designator:"U?",addIntoBom:!0,addIntoPcb:!0}){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Device.create",{libraryUuid:t,deviceName:i,classification:r,association:n,description:s,property:a})}async delete(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Device.delete",{deviceUuid:t,libraryUuid:i})}async modify(t,i,r,n,s,a,o){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Device.modify",{deviceUuid:t,libraryUuid:i,deviceName:r,classification:n,association:s,description:a,property:o})}async get(t,i){var n,s,a,o,l,u;let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Device.get",{deviceUuid:t,libraryUuid:i});if(r)return{libraryType:"3",uuid:r.uuid,libraryUuid:r.owner.uuid,name:r.display_title,classification:{libraryUuid:r.owner.uuid,libraryType:"3",primaryClassificationUuid:r.tags.parent_tag.uuid,secondaryClassificationUuid:r.tags.child_tag.uuid},association:{symbolType:((n=r.symbol)==null?void 0:n.docType)||r.symbol_type,symbolUuid:((s=r.symbol)==null?void 0:s.uuid)||r.attributes.Symbol,symbol:{type:((a=r.symbol)==null?void 0:a.docType)||r.symbol_type,uuid:((o=r.symbol)==null?void 0:o.uuid)||r.attributes.Symbol,libraryUuid:r.owner.uuid},footprintUuid:((l=r.footprint)==null?void 0:l.uuid)||r.attributes.Footprint,footprint:{uuid:((u=r.footprint)==null?void 0:u.uuid)||r.attributes.Footprint,libraryUuid:r.owner.uuid},images:r.images},description:r.description,property:{name:r.display_title,designator:r.attributes.Designator,addIntoBom:r.attributes["Add into BOM"],addIntoPcb:r.attributes["Convert to PCB"],net:r.attributes["Global Net Name"],manufacturer:r.attributes.Manufacturer,manufacturerId:r.attributes["Manufacturer Part"],supplier:r.attributes.Supplier,supplierId:r.attributes["Supplier Part"],otherProperty:r.attributes}}}async copy(t,i,r,n,s){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Device.copy",{deviceUuid:t,libraryUuid:i,targetLibraryUuid:r,targetClassification:n,newDeviceName:s})}async search(t,i,r,n,s=10,a=1){if(s<=300)return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Device.search",{key:t,libraryUuid:i,classification:r,symbolType:n,itemsOfPage:s,page:a});let o=s*(a-1)+1,l=s*a,u=(o-1)%300,c=l%300===0?300:l%300,h=Math.floor(o/300)+1,m=c===300?Math.floor(l/300):Math.floor(l/300)+1,f=[];for(let g=h;g<=m;g++){let y=await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Device.search",{key:t,libraryUuid:i,classification:r,symbolType:n,itemsOfPage:300,page:g});if(y.length<300)return g<m?f.push(...y):y.length<=c?f.push(...y):f.push(...y.slice(0,c+1)),f;g===h?f.push(...y.slice(u,300)):g===m?f.push(...y.slice(0,c+1)):f.push(...y)}return f}searchByProperties(t,i,r,n,s=10,a=1){if(!Rf)throw new Error("\u9519\u8BEF\uFF1A\u975E\u5BA2\u6237\u7AEF\u73AF\u5883\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");return[]}async getByLcscIds(t,i,r=!1){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Device.getByLcscIds",{lcscIds:t,libraryUuid:i,allowMultiMatch:r})}};var Gf=class{async create(t,i,r,n){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Footprint.create",{libraryUuid:t,footprintName:i,classification:r,description:n})}async delete(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Footprint.delete",{footprintUuid:t,libraryUuid:i})}async modify(t,i,r,n,s){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Footprint.modify",{footprintUuid:t,libraryUuid:i,footprintName:r,classification:n,description:s})}async updateDocumentSource(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Footprint.updateDocumentSource",{footprintUuid:t,libraryUuid:i,documentSource:r})}async get(t,i){var n,s,a,o;let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Footprint.get",{footprintUuid:t,libraryUuid:i});if(r)return{libraryType:"4",uuid:t,libraryUuid:r.owner.uuid,name:r.display_title,classification:{libraryUuid:r.owner.uuid,libraryType:"4",primaryClassificationUuid:(s=(n=r.tags)==null?void 0:n.parent_tag)==null?void 0:s.uuid,secondaryClassificationUuid:(o=(a=r.tags)==null?void 0:a.child_tag)==null?void 0:o.uuid},description:r.description}}async copy(t,i,r,n,s){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Footprint.copy",{footprintUuid:t,libraryUuid:i,targetLibraryUuid:r,targetClassification:n,newFootprintName:s})}async search(t,i,r,n=10,s=1){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Footprint.search",{key:t,libraryUuid:i,classification:r,itemsOfPage:n,page:s})}async openInEditor(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_Footprint.openInEditor",{footprintUuid:t,libraryUuid:i,splitScreenId:r})}};var Wf=class{constructor(t){this.extensionUuid=t}async getSystemLibraryUuid(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_LibrariesList.getSystemLibraryUuid")}async getPersonalLibraryUuid(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_LibrariesList.getPersonalLibraryUuid")}async getProjectLibraryUuid(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_LibrariesList.getProjectLibraryUuid")}async getFavoriteLibraryUuid(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_LibrariesList.getFavoriteLibraryUuid")}async getAllLibrariesList(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_LibrariesList.getAllLibrariesList")}async registerExtendLibrary(t,i){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_LibrariesList.registerExtendLibrary",{title:t,libraryFunctions:i});if(r)return _.extensionLIB_RegisteredExtendLibraries[this.extensionUuid]=[],_.extensionLIB_RegisteredExtendLibraries[this.extensionUuid].push({libraryUuid:r}),r}};var zf=class{async create(t,i,r,n){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_PanelLibrary.create",{libraryUuid:t,panelLibraryName:i,classification:r,description:n})}async delete(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_PanelLibrary.delete",{panelLibraryUuid:t,libraryUuid:i})}async modify(t,i,r,n,s){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_PanelLibrary.modify",{panelLibraryUuid:t,libraryUuid:i,panelLibraryName:r,classification:n,description:s})}async get(t,i){let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_PanelLibrary.get",{panelLibraryUuid:t,libraryUuid:i});if(r)return{libraryType:"29",uuid:r.uuid,name:r.display_title,libraryUuid:r.owner.uuid,classification:{libraryUuid:r.owner.uuid,libraryType:"29",primaryClassificationUuid:r.tags.parent_tag.uuid,secondaryClassificationUuid:r.tags.child_tag.uuid},description:r.description}}async copy(t,i,r,n,s){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_PanelLibrary.copy",{panelLibraryUuid:t,libraryUuid:i,targetLibraryUuid:r,targetClassification:n,newPanelLibraryName:s})}async search(t,i,r,n=10,s=1){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_PanelLibrary.search",{key:t,libraryUuid:i,classification:r,itemsOfPage:n,page:s})}async openInEditor(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_PanelLibrary.openInEditor",{panelLibraryUuid:t,libraryUuid:i,splitScreenId:r})}};var Vf=class{async getSelectedLibraryRowInfo(){let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.LIB_SelectControl.getBottomComponentLibraryCurrentRowInfo");if(t&&t.libraryType)switch(t.libraryType){case"device":t.libraryType="3";break;case"symbol":t.libraryType="2";break;case"footprint":t.libraryType="4";break;case"cbb":t.libraryType="1";break;case"model3D":t.libraryType="5";break;case"panelLib":t.libraryType="29";break}return t}};function n2(e){let t=a2(e),i=1/0,r=-1/0,n=1/0,s=-1/0;return t.forEach(a=>{i=Math.min(i,a.x),r=Math.max(r,a.x),n=Math.min(n,a.y),s=Math.max(s,a.y)}),{width:r-(i===1/0?0:i),height:s-(n===1/0?0:n)}}function a2(e){let t=[];if(Array.isArray(e[0])&&(typeof e[0][0]=="number"||typeof e[0][0]=="string"))e.forEach(i=>t.push(...a2(i)));else{let i=e[0];i==="R"?t.push(...Rq(e)):i==="CIRCLE"?t.push(...Lq(e)):Bq(e).forEach(n=>t.push(...Oq(n)))}return t}function Rq(e){let[t,i,r,n,s,a,o]=e;return Nq(i,r,n,s,a)}function Lq(e){let[t,i,r,n]=e;return Dq(i,r,n)}function Nq(e,t,i,r,n){let s=n*Math.PI/180,a=Math.cos(s),o=Math.sin(s),l=e+i/2,u=t+r/2;return[{x:e,y:t},{x:e+i,y:t},{x:e+i,y:t+r},{x:e,y:t+r}].map(c=>{let h=c.x-l,m=c.y-u;return{x:h*a-m*o+l,y:h*o+m*a+u}})}function Dq(e,t,i,r=100){return Array.from({length:r}).map((n,s)=>{let a=s*2*Math.PI/r;return{x:e+i*Math.cos(a),y:t+i*Math.sin(a)}})}function Bq(e){let t=[],i=0,r=null,n=null;for(;i<e.length;){let s,a;r!==null&&n!==null?(s=r,a=n):(s=e[i],a=e[i+1],i+=2);let o=e[i];if(i+=1,o==="L"){let u=[];for(;i<e.length&&typeof e[i]=="number";)u.push(e[i]),i++;let c=s,h=a;for(let m=0;m<u.length;m+=2){let f=u[m],g=u[m+1];t.push({startX:c,startY:h,type:"L",params:[f,g]}),c=f,h=g}r=c,n=h;continue}let l;switch(o){case"ARC":case"CARC":{let u=e[i],c=e[i+1],h=e[i+2];l=[u,c,h],r=c,n=h,i+=3;break}case"C":{let u=e[i],c=e[i+1],h=e[i+2],m=e[i+3],f=e[i+4],g=e[i+5];l=[u,c,h,m,f,g],r=f,n=g,i+=6;break}default:throw new Error(`Unknown type: ${o}`)}t.push({startX:s,startY:a,type:o,params:l})}return t}function Oq(e){switch(e.type){case"L":return[{x:e.startX,y:e.startY},{x:e.params[0],y:e.params[1]}];case"ARC":case"CARC":return Mq(e.startX,e.startY,e.params[0],e.params[1],e.params[2]);case"C":return kq(e.startX,e.startY,e.params[0],e.params[1],e.params[2],e.params[3],e.params[4],e.params[5]);default:return[]}}function Mq(e,t,i,r,n,s=100){let a=[],o=r-e,l=n-t,u=Math.hypot(o,l);if(u===0)return a;let c=i*Math.PI/180,h=u/(2*Math.sin(c/2)),m=(e+r)/2,f=(t+n)/2,g=-l,y=o,b=Math.hypot(g,y),E=g/b,S=y/b,v=i>=0?1:-1,A=m+E*h*Math.cos(c/2)*v,x=f+S*h*Math.cos(c/2)*v,T=Math.atan2(t-x,e-A),L=(T+c-T)/(s-1);for(let O=0;O<s;O++){let H=T+L*O,k=A+h*Math.cos(H),ee=x+h*Math.sin(H);a.push({x:k,y:ee})}return a.push({x:r,y:n}),a}function kq(e,t,i,r,n,s,a,o,l=100){let u=[];for(let c=0;c<=l;c++){let h=c/l,m=s2(e,i,n,a,h),f=s2(t,r,s,o,h);u.push({x:m,y:f})}return u}function s2(e,t,i,r,n){let s=1-n;return s**3*e+3*s**2*n*t+3*s*n**2*i+n**3*r}function D0(e){function t(n){if(n.length!==4||n[0]!=="CIRCLE")return!1;for(let s=1;s<4;s++)if(typeof n[s]!="number")return!1;return n.filter(s=>typeof s=="string").length===1}function i(n){if(n.length!==7||n[0]!=="R")return!1;for(let s=1;s<7;s++)if(typeof n[s]!="number")return!1;return n.filter(s=>typeof s=="string").length===1}function r(n){let s=["C","L","ARC","CARC"],a=[];for(let o=0;o<n.length;o++){let l=n[o];if(typeof l=="string"){if(!s.includes(l))return!1;a.push({index:o,type:l})}}for(let o of a){let{index:l,type:u}=o;if(l<2||typeof n[l-1]!="number"||typeof n[l-2]!="number")return!1;let c=0,h=l+1;for(;h<n.length&&typeof n[h]=="number";)c++,h++;switch(u){case"C":if(c!==6)return!1;break;case"L":if(c<2||c%2!==0)return!1;break;case"ARC":case"CARC":if(c!==3)return!1;break;default:return!1}}return!0}return!!(t(e)||i(e)||r(e))}var qf=class{createPolygon(t){try{return new ft(t)}catch{return}}createComplexPolygon(t){try{return new Ka(t)}catch{return}}splitPolygon(...t){let i=[];return t.forEach(r=>{r.getSourceStrictComplex().forEach(n=>{i.push(new ft(n))})}),i}calculateWidth(t){if(Array.isArray(t))return this.calculateBBoxWidth(t);{let i=t.getSource();return this.calculateBBoxWidth(i)}}calculateBBoxWidth(t){return n2(t).width}calculateHeight(t){if(Array.isArray(t))return this.calculateBBoxHeight(t);{let i=t.getSource();return this.calculateBBoxHeight(i)}}calculateBBoxHeight(t){return n2(t).height}async convertImageToComplexPolygon(t,i,r,n=0,s=0,a=0,o=0,l=!0,u=!1){let c=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_MathPolygon.convertImageToComplexPolygon",{imageBlob:t,imageWidth:i,imageHeight:r,tolerance:n,simplification:s,smoothing:a,despeckling:o,whiteAsBackgroundColor:l,inversion:u});return new Ka(c)}},ft=class{constructor(t){this.polygon=this.validateSource(t)}getSource(){return this.polygon}async getCenter(){let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_MathPolygon.getCenter",this.polygon);return{x:t.x,y:t.y}}validateSource(t){if(D0(t))return t;throw new Error("\u5355\u591A\u8FB9\u5F62\u9A8C\u8BC1\u4E0D\u901A\u8FC7")}},Ka=class{constructor(t){this.complexPolygon=this.validateSource(t)}addSource(t){return this.complexPolygon.push(...this.validateSource(t)),this}getSource(){return this.complexPolygon.length===1?this.complexPolygon[0]:this.complexPolygon}getSourceStrictComplex(){return this.complexPolygon}getCenter(){return{x:0,y:0}}validateSource(t){if(Array.isArray(t)){let i=t[0];if(typeof i=="string"||typeof i=="number"){if(D0(t))return[t];throw new Error("\u590D\u6742\u591A\u8FB9\u5F62\u9A8C\u8BC1\u4E0D\u901A\u8FC7")}if(Array.isArray(t[0])){if(t.every(n=>D0(n)))return t;throw new Error("\u590D\u6742\u591A\u8FB9\u5F62\u9A8C\u8BC1\u4E0D\u901A\u8FC7")}else{let r=[];if(t.every(s=>s!==void 0))return t.forEach(s=>{let a=s.getSource();r.push(a)}),r;throw new Error("\u590D\u6742\u591A\u8FB9\u5F62\u9A8C\u8BC1\u4E0D\u901A\u8FC7")}}else{if(t)return[t.getSource()];throw new Error("\u590D\u6742\u591A\u8FB9\u5F62\u9A8C\u8BC1\u4E0D\u901A\u8FC7")}}};var qi=(b=>(b.ARC="Arc",b.COMPONENT="Component",b.PAD="Pad",b.COMPONENT_PAD="ComponentPad",b.POLYLINE="Polyline",b.POUR="Pour",b.FILL="Fill",b.REGION="Region",b.LINE="Line",b.VIA="Via",b.DIMENSION="Dimension",b.IMAGE="Image",b.OBJECT="Object",b.POURED="Poured",b.STRING="String",b.ATTRIBUTE="Attribute",b))(qi||{}),Xf=class{async getPrimitiveTypeByPrimitiveId(t){}async getPrimitiveByPrimitiveId(t){}async getPrimitivesByPrimitiveId(t){let i=[];for(let r of t){let n=await this.getPrimitiveByPrimitiveId(r);n&&i.push(n)}return i}async getPrimitivesBBox(t){if(!t)return;let i=[];for(let n of t)typeof n=="string"?i.push(n):i.push(n.getState_PrimitiveId());let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Primitive.getPrimitivesBBox",i);if(r.length>0){let n=r.map(s=>({minX:s.minX*10,minY:s.minY*10,maxX:s.maxX*10,maxY:s.maxY*10}));if(n.length===1)return n[0];{let s={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(let a of n)a.minX<s.minX&&(s.minX=a.minX),a.minY<s.minY&&(s.minY=a.minY),a.maxX>s.maxX&&(s.maxX=a.maxX),a.maxY>s.maxY&&(s.maxY=a.maxY);return s}}else return}};var B0=(r=>(r[r.VIA=0]="VIA",r[r.BLIND=1]="BLIND",r[r.SUTURE=2]="SUTURE",r))(B0||{}),Jf=class{async create(t,i,r,n,s,a,o,l,u){try{return await new bi(t,i,r,n,s,a,o,l,u).create()}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u8FC7\u5B54\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}}async delete(t){let i=[];typeof t=="string"?i.push(t):t instanceof bi?i.push(t.getState_PrimitiveId()):t[0]instanceof bi?i=t.map(n=>n.getState_PrimitiveId()):i=[...t];let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveVia.delete",{primitiveIds:i});return!0}async modify(t,i){typeof t=="string"&&(t=await this.get(t));let{net:r,x:n,y:s,holeDiameter:a,diameter:o,viaType:l,designRuleBlindViaName:u,solderMaskExpansion:c,primitiveLock:h}=i;return t.isAsync()||t.toAsync(),r!==void 0&&t.setState_Net(r),n!==void 0&&t.setState_X(n),s!==void 0&&t.setState_Y(s),a!==void 0&&t.setState_HoleDiameter(a),o!==void 0&&t.setState_Diameter(o),l!==void 0&&t.setState_ViaType(l),u!==void 0&&t.setState_DesignRuleBlindViaName(u),c!==void 0&&t.setState_SolderMaskExpansion(c),h!==void 0&&t.setState_PrimitiveLock(h),t.isAsync()?t.done():t.toSync(),t}async get(t){let i=[],r=!1;typeof t=="string"?(i.push(t),r=!0):i=[...t];let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveVia.getByIds",{primitiveIds:i});if(!n.length)return[];if(r){let s=n[0];return new bi(s.net,s.center.x*10,s.center.y*10,s.holeRadius*2*10,s.radius*2*10,s.type,s.name,{topSolderMask:s.topExpansion,bottomSolderMask:s.bottomExpansion},s.locked,s.globalIndex)}return n.map(s=>new bi(s.net,s.center.x*10,s.center.y*10,s.holeRadius*2*10,s.radius*2*10,s.type,s.name,{topSolderMask:s.topExpansion,bottomSolderMask:s.bottomExpansion},s.locked,s.globalIndex))}async getAllPrimitiveId(t,i){return(await this.getAll(t,i)).map(n=>n.getState_PrimitiveId())}async getAll(t,i){let r={};return typeof t<"u"&&(r.net=t),typeof i<"u"&&(r.primitiveLock=i),(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveVia.getAll",r)).map(s=>new bi(s.net,s.center.x*10,s.center.y*10,s.holeRadius*2*10,s.radius*2*10,s.type,s.name,s.expansion,s.locked,s.globalIndex))}},bi=class{constructor(t,i,r,n,s,a=0,o=null,l=null,u=!1,c){this.async=!0;this.primitiveType="Via";this.net=t,this.x=i,this.y=r,this.holeDiameter=n,this.diameter=s,this.viaType=a,this.designRuleBlindViaName=o,this.solderMaskExpansion=l,this.primitiveLock=u,c&&(this.primitiveId=c)}async create(){this.setState_Net(this.net),this.setState_X(this.x),this.setState_Y(this.y),this.setState_HoleDiameter(this.holeDiameter),this.setState_Diameter(this.diameter),this.setState_ViaType(this.viaType),this.setState_DesignRuleBlindViaName(this.designRuleBlindViaName),this.setState_SolderMaskExpansion(this.solderMaskExpansion),this.setState_PrimitiveLock(this.primitiveLock);try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveVia.create",{net:this.net,x:this.x,y:this.y,holeDiameter:this.holeDiameter,diameter:this.diameter,viaType:this.viaType,designRuleBlindViaName:this.designRuleBlindViaName,solderMaskExpansion:this.solderMaskExpansion,primitiveLock:this.primitiveLock});this.primitiveId=t.primitiveId}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PCB_PrimitiveVia.create() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PCB_PrimitiveVia \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_Net(){return this.net}getState_X(){return this.x}getState_Y(){return this.y}getState_HoleDiameter(){return this.holeDiameter}getState_Diameter(){return this.diameter}getState_ViaType(){return this.viaType}getState_DesignRuleBlindViaName(){return this.designRuleBlindViaName}getState_SolderMaskExpansion(){return this.solderMaskExpansion}getState_PrimitiveLock(){return this.primitiveLock}setState_Net(t){return this.net=t,this.async||this.done(),this}setState_X(t){return this.x=t,this.async||this.done(),this}setState_Y(t){return this.y=t,this.async||this.done(),this}setState_HoleDiameter(t){return this.holeDiameter=t,this.async||this.done(),this}setState_Diameter(t){return this.diameter=t,this.async||this.done(),this}setState_ViaType(t){return this.viaType=t,this.async||this.done(),this}setState_DesignRuleBlindViaName(t){return this.designRuleBlindViaName=t,this.async||this.done(),this}setState_SolderMaskExpansion(t){return this.solderMaskExpansion=t,this.async||this.done(),this}setState_PrimitiveLock(t){return this.primitiveLock=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveVia.getByIds",{primitiveIds:[t]}))[0];return this.setState_Net(r.net),this.setState_X(r.center.x),this.setState_Y(r.center.y),this.setState_HoleDiameter(r.holeRadius*2),this.setState_Diameter(r.radius*2),this.setState_ViaType(r.type),this.setState_DesignRuleBlindViaName(r.name),this.setState_SolderMaskExpansion(r.expansion),this.setState_PrimitiveLock(r.locked),this}async done(){let{primitiveId:t,net:i,x:r,y:n,holeDiameter:s,diameter:a,viaType:o,designRuleBlindViaName:l,solderMaskExpansion:u,primitiveLock:c}=this,h={net:i,x:r,y:n,holeDiameter:s,diameter:a,viaType:o,designRuleBlindViaName:l,solderMaskExpansion:u,primitiveLock:c};if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveVia.modify",{primitiveId:t,data:h}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002");return this}async getAdjacentPrimitives(){let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveVia.getAdjacentPrimitives",this.primitiveId),i=[];for(let r of t)switch(r.pcbItemPrimitiveType){case"Track":i.push(new Ci(r.net,r.layerId,r.startX,r.startY,r.endX,r.endY,r.width,r.locked,r.globalIndex));break;case"ArcTrack":i.push(new xi(r.net,r.layerId,r.startX,r.startY,r.endX,r.endY,r.arcAngle,r.width,r.arcType,r.locked,r.globalIndex));break;default:break}return i}};var $f=class{async create(t,i,r,n,s,a,o,l){try{return await new Ci(t,i,r,n,s,a,o,l).create()}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u76F4\u7EBF\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}}async delete(t){let i=[];typeof t=="string"?i.push(t):t instanceof Ci?i.push(t.getState_PrimitiveId()):t[0]instanceof Ci?i=t.map(n=>n.getState_PrimitiveId()):i=[...t];let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveLine.delete",{primitiveIds:i});return!0}async modify(t,i){typeof t=="string"&&(t=await this.get(t));let{net:r,layer:n,startX:s,startY:a,endX:o,endY:l,lineWidth:u,primitiveLock:c}=i;return t.isAsync()||t.toAsync(),r!==void 0&&t.setState_Net(r),n!==void 0&&t.setState_Layer(n),s!==void 0&&t.setState_StartX(s),a!==void 0&&t.setState_StartY(a),o!==void 0&&t.setState_EndX(o),l!==void 0&&t.setState_EndY(l),u!==void 0&&t.setState_LineWidth(u),c!==void 0&&t.setState_PrimitiveLock(c),t.isAsync()?t.done():t.toSync(),t}async get(t){let i=[],r=!1;typeof t=="string"?(i.push(t),r=!0):i=[...t];let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveLine.getByIds",{primitiveIds:i});if(!n.length)return[];if(r){let s=n[0];return new Ci(s.net,s.layerId,s.startX,s.startY,s.endX,s.endY,s.width,s.locked,s.globalIndex)}return n.map(s=>new Ci(s.net,s.layerId,s.startX,s.startY,s.endX,s.endY,s.width,s.locked,s.globalIndex))}async getAllPrimitiveId(t,i,r){return(await this.getAll(t,i,r)).map(s=>s.getState_PrimitiveId())}async getAll(t,i,r){let n={};return typeof t<"u"&&(n.net=t),typeof i<"u"&&(n.layerId=i),typeof r<"u"&&(n.primitiveLock=r),(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveLine.getAll",n)).map(a=>new Ci(a.net,a.layerId,a.startX,a.startY,a.endX,a.endY,a.width,a.locked,a.globalIndex))}},Ci=class e{constructor(t,i,r,n,s,a,o=10,l=!1,u){this.async=!0;this.primitiveType="Line";this.net=t,this.layer=i,this.startX=r,this.startY=n,this.endX=s,this.endY=a,this.lineWidth=o,this.primitiveLock=l,u&&(this.primitiveId=u)}async create(){this.setState_Net(this.net),this.setState_Layer(this.layer),this.setState_StartX(this.startX),this.setState_StartY(this.startY),this.setState_EndX(this.endX),this.setState_EndY(this.endY),this.setState_LineWidth(this.lineWidth),this.setState_PrimitiveLock(this.primitiveLock);try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveLine.create",{net:this.net,layerId:this.layer,startX:this.startX,startY:this.startY,endX:this.endX,endY:this.endY,lineWidth:this.lineWidth,primitiveLock:this.primitiveLock});this.primitiveId=t.primitiveId}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PCB_PrimitiveLine.create() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PCB_PrimitiveLine \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_Net(){return this.net}getState_Layer(){return this.layer}getState_StartX(){return this.startX}getState_StartY(){return this.startY}getState_EndX(){return this.endX}getState_EndY(){return this.endY}getState_LineWidth(){return this.lineWidth}getState_PrimitiveLock(){return this.primitiveLock}setState_Net(t){return this.net=t,this.async||this.done(),this}setState_Layer(t){return this.layer=t,this.async||this.done(),this}setState_StartX(t){return this.startX=t,this.async||this.done(),this}setState_StartY(t){return this.startY=t,this.async||this.done(),this}setState_EndX(t){return this.endX=t,this.async||this.done(),this}setState_EndY(t){return this.endY=t,this.async||this.done(),this}setState_LineWidth(t){return this.lineWidth=t,this.async||this.done(),this}setState_PrimitiveLock(t){return this.primitiveLock=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveLine.getByIds",{primitiveIds:[t]}))[0];return this.setState_Net(r.net),this.setState_Layer(r.layerId),this.setState_StartX(r.start.x),this.setState_StartY(r.start.x),this.setState_EndX(r.end.x),this.setState_EndY(r.end.x),this.setState_LineWidth(r.width),this.setState_PrimitiveLock(r.locked),this}async done(){let{primitiveId:t,net:i,layer:r,startX:n,startY:s,endX:a,endY:o,lineWidth:l,primitiveLock:u}=this,c={net:i,layerId:r,startX:n,startY:s,endX:a,endY:o,lineWidth:l,primitiveLock:u};if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveLine.modify",{primitiveId:t,data:c}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002");return this}async getAdjacentPrimitives(){let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveLine.getAdjacentPrimitives",this.primitiveId),i=[];for(let r of t)switch(r.pcbItemPrimitiveType){case"Via":i.push(new bi(r.net,r.center.x,r.center.y,r.holeRadius*2,r.radius*2,r.type,r.name,{topSolderMask:r.topExpansion,bottomSolderMask:r.bottomExpansion},r.locked,r.globalIndex));break;case"Track":i.push(new e(r.net,r.layerId,r.startX,r.startY,r.endX,r.endY,r.width,r.locked,r.globalIndex));break;case"ArcTrack":i.push(new xi(r.net,r.layerId,r.startX,r.startY,r.endX,r.endY,r.arcAngle,r.width,r.arcType,r.locked,r.globalIndex));break;default:break}return i}async getEntireTrack(t=!1){let i=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveLine.getEntireTrack",this.primitiveId),r=[];for(let n of i)switch(n.pcbItemPrimitiveType){case"Track":r.push(new e(n.net,n.layerId,n.startX,n.startY,n.endX,n.endY,n.width,n.locked,n.globalIndex));break;case"ArcTrack":r.push(new xi(n.net,n.layerId,n.startX,n.startY,n.endX,n.endY,n.arcAngle,n.width,n.arcType,n.locked,n.globalIndex));break;case"Via":t&&r.push(new bi(n.net,n.center.x,n.center.y,n.holeRadius*2,n.radius*2,n.type,n.name,{topSolderMask:n.topExpansion,bottomSolderMask:n.bottomExpansion},n.locked,n.globalIndex));break;default:break}return r}};var O0=(i=>(i[i.TWO_POINT_ARC=1]="TWO_POINT_ARC",i[i.CENTER_ARC=2]="CENTER_ARC",i))(O0||{}),Kf=class{async create(t,i,r,n,s,a,o,l,u,c){try{return await new xi(t,i,r,n,s,a,o,l,u,c).create()}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u5706\u5F27/\u5706\u5F27\u7EBF\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}}async delete(t){let i=[];typeof t=="string"?i.push(t):t instanceof xi?i.push(t.getState_PrimitiveId()):t[0]instanceof xi?i=t.map(n=>n.getState_PrimitiveId()):i=[...t];let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveArc.delete",{primitiveIds:i});return!0}async modify(t,i){typeof t=="string"&&(t=await this.get(t));let{net:r,layer:n,startX:s,startY:a,endX:o,endY:l,arcAngle:u,lineWidth:c,interactiveMode:h,primitiveLock:m}=i;return t.isAsync()||t.toAsync(),r!==void 0&&t.setState_Net(r),n!==void 0&&t.setState_Layer(n),s!==void 0&&t.setState_StartX(s),a!==void 0&&t.setState_StartY(a),o!==void 0&&t.setState_EndX(o),l!==void 0&&t.setState_EndY(l),u!==void 0&&t.setState_ArcAngle(u),c!==void 0&&t.setState_LineWidth(c),h!==void 0&&t.setState_InteractiveMode(h),m!==void 0&&t.setState_PrimitiveLock(m),t.isAsync()?t.done():t.toSync(),t}async get(t){let i=[],r=!1;typeof t=="string"?(i.push(t),r=!0):i=[...t];let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveArc.getByIds",{primitiveIds:i});if(!n.length)return[];if(r){let s=n[0];return new xi(s.net,s.layerId,s.startX,s.startY,s.endX,s.endY,s.arcAngle,s.lineWidth,s.interactiveMode,s.locked,s.globalIndex)}return n.map(s=>new xi(s.net,s.layerId,s.startX,s.startY,s.endX,s.endY,s.arcAngle,s.lineWidth,s.interactiveMode,s.locked,s.globalIndex))}async getAllPrimitiveId(t,i,r){return(await this.getAll(t,i,r)).map(s=>s.getState_PrimitiveId())}async getAll(t,i,r){let n={};return typeof t<"u"&&(n.net=t),typeof i<"u"&&(n.layerId=i),typeof r<"u"&&(n.primitiveLock=r),(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveArc.getAll",n)).map(a=>new xi(a.net,a.layerId,a.startX,a.startY,a.endX,a.endY,a.arcAngle,a.lineWidth,a.interactiveMode,a.locked,a.globalIndex))}},xi=class e{constructor(t,i,r,n,s,a,o,l=10,u=1,c=!1,h){this.async=!0;this.primitiveType="Arc";this.net=t,this.layer=i,this.startX=r,this.startY=n,this.endX=s,this.endY=a,this.arcAngle=o,this.lineWidth=l,this.interactiveMode=u,this.primitiveLock=c,h&&(this.primitiveId=h)}async create(){this.setState_Net(this.net),this.setState_Layer(this.layer),this.setState_StartX(this.startX),this.setState_StartY(this.startY),this.setState_EndX(this.endX),this.setState_EndY(this.endY),this.setState_ArcAngle(this.arcAngle),this.setState_LineWidth(this.lineWidth),this.setState_InteractiveMode(this.interactiveMode),this.setState_PrimitiveLock(this.primitiveLock);try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveArc.create",{net:this.net,layerId:this.layer,startX:this.startX,startY:this.startY,endX:this.endX,endY:this.endY,arcAngle:this.arcAngle,lineWidth:this.lineWidth,interactiveMode:this.interactiveMode,primitiveLock:this.primitiveLock});this.primitiveId=t.primitiveId}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PCB_PrimitiveArc.create() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PCB_PrimitiveArc \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_Net(){return this.net}getState_Layer(){return this.layer}getState_StartX(){return this.startX}getState_StartY(){return this.startY}getState_EndX(){return this.endX}getState_EndY(){return this.endY}getState_ArcAngle(){return this.arcAngle}getState_LineWidth(){return this.lineWidth}getState_InteractiveMode(){return this.interactiveMode}getState_PrimitiveLock(){return this.primitiveLock}setState_Net(t){return this.net=t,this.async||this.done(),this}setState_Layer(t){return this.layer=t,this.async||this.done(),this}setState_StartX(t){return this.startX=t,this.async||this.done(),this}setState_StartY(t){return this.startY=t,this.async||this.done(),this}setState_EndX(t){return this.endX=t,this.async||this.done(),this}setState_EndY(t){return this.endY=t,this.async||this.done(),this}setState_ArcAngle(t){return this.arcAngle=t,this.async||this.done(),this}setState_LineWidth(t){return this.lineWidth=t,this.async||this.done(),this}setState_InteractiveMode(t){return this.interactiveMode=t,this.async||this.done(),this}setState_PrimitiveLock(t){return this.primitiveLock=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveArc.getByIds",{primitiveIds:[t]}))[0];return this.setState_Net(r.net),this.setState_Layer(r.layerId),this.setState_StartX(r.startX),this.setState_StartY(r.startY),this.setState_EndX(r.endX),this.setState_EndY(r.endY),this.setState_ArcAngle(r.startAngle),this.setState_LineWidth(r.width),this.setState_PrimitiveLock(r.locked),this}async done(){let{primitiveId:t,net:i,layer:r,startX:n,startY:s,endX:a,endY:o,arcAngle:l,lineWidth:u,interactiveMode:c,primitiveLock:h}=this,m={net:i,layerId:r,startX:n,startY:s,endX:a,endY:o,arcAngle:l,lineWidth:u,interactiveMode:c,primitiveLock:h};if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveArc.modify",{primitiveId:t,data:m}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002");return this}async getAdjacentPrimitives(){let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveArc.getAdjacentPrimitives",this.primitiveId),i=[];for(let r of t)switch(r.pcbItemPrimitiveType){case"Via":i.push(new bi(r.net,r.center.x,r.center.y,r.holeRadius*2,r.radius*2,r.type,r.name,{topSolderMask:r.topExpansion,bottomSolderMask:r.bottomExpansion},r.locked,r.globalIndex));break;case"Track":i.push(new Ci(r.net,r.layerId,r.startX,r.startY,r.endX,r.endY,r.width,r.locked,r.globalIndex));break;case"ArcTrack":i.push(new e(r.net,r.layerId,r.startX,r.startY,r.endX,r.endY,r.arcAngle,r.width,r.arcType,r.locked,r.globalIndex));break;default:break}return i}async getEntireTrack(t=!1){let i=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveArc.getEntireTrack",this.primitiveId),r=[];for(let n of i)switch(n.pcbItemPrimitiveType){case"Track":r.push(new Ci(n.net,n.layerId,n.startX,n.startY,n.endX,n.endY,n.width,n.locked,n.globalIndex));break;case"ArcTrack":r.push(new e(n.net,n.layerId,n.startX,n.startY,n.endX,n.endY,n.arcAngle,n.width,n.arcType,n.locked,n.globalIndex));break;case"Via":t&&r.push(new bi(n.net,n.center.x,n.center.y,n.holeRadius*2,n.radius*2,n.type,n.name,{topSolderMask:n.topExpansion,bottomSolderMask:n.bottomExpansion},n.locked,n.globalIndex));break;default:break}return r}};var yd=(se=>(se[se.TOP=1]="TOP",se[se.TOP_SILKSCREEN=3]="TOP_SILKSCREEN",se[se.TOP_SOLDER_MASK=5]="TOP_SOLDER_MASK",se[se.TOP_PASTE_MASK=7]="TOP_PASTE_MASK",se[se.TOP_ASSEMBLY=9]="TOP_ASSEMBLY",se[se.TOP_STIFFENER=58]="TOP_STIFFENER",se[se.BOTTOM=2]="BOTTOM",se[se.BOTTOM_SILKSCREEN=4]="BOTTOM_SILKSCREEN",se[se.BOTTOM_SOLDER_MASK=6]="BOTTOM_SOLDER_MASK",se[se.BOTTOM_PASTE_MASK=8]="BOTTOM_PASTE_MASK",se[se.BOTTOM_ASSEMBLY=10]="BOTTOM_ASSEMBLY",se[se.BOTTOM_STIFFENER=59]="BOTTOM_STIFFENER",se[se.BOARD_OUTLINE=11]="BOARD_OUTLINE",se[se.MULTI=12]="MULTI",se[se.DOCUMENT=13]="DOCUMENT",se[se.MECHANICAL=14]="MECHANICAL",se[se.RATLINE=57]="RATLINE",se[se.INNER_1=15]="INNER_1",se[se.INNER_2=16]="INNER_2",se[se.INNER_3=17]="INNER_3",se[se.INNER_4=18]="INNER_4",se[se.INNER_5=19]="INNER_5",se[se.INNER_6=20]="INNER_6",se[se.INNER_7=21]="INNER_7",se[se.INNER_8=22]="INNER_8",se[se.INNER_9=23]="INNER_9",se[se.INNER_10=24]="INNER_10",se[se.INNER_11=25]="INNER_11",se[se.INNER_12=26]="INNER_12",se[se.INNER_13=27]="INNER_13",se[se.INNER_14=28]="INNER_14",se[se.INNER_15=29]="INNER_15",se[se.INNER_16=30]="INNER_16",se[se.INNER_17=31]="INNER_17",se[se.INNER_18=32]="INNER_18",se[se.INNER_19=33]="INNER_19",se[se.INNER_20=34]="INNER_20",se[se.INNER_21=35]="INNER_21",se[se.INNER_22=36]="INNER_22",se[se.INNER_23=37]="INNER_23",se[se.INNER_24=38]="INNER_24",se[se.INNER_25=39]="INNER_25",se[se.INNER_26=40]="INNER_26",se[se.INNER_27=41]="INNER_27",se[se.INNER_28=42]="INNER_28",se[se.INNER_29=43]="INNER_29",se[se.INNER_30=44]="INNER_30",se[se.INNER_31=45]="INNER_31",se[se.INNER_32=46]="INNER_32",se[se.CUSTOM_1=71]="CUSTOM_1",se[se.CUSTOM_2=72]="CUSTOM_2",se[se.CUSTOM_3=73]="CUSTOM_3",se[se.CUSTOM_4=74]="CUSTOM_4",se[se.CUSTOM_5=75]="CUSTOM_5",se[se.CUSTOM_6=76]="CUSTOM_6",se[se.CUSTOM_7=77]="CUSTOM_7",se[se.CUSTOM_8=78]="CUSTOM_8",se[se.CUSTOM_9=79]="CUSTOM_9",se[se.CUSTOM_10=80]="CUSTOM_10",se[se.CUSTOM_11=81]="CUSTOM_11",se[se.CUSTOM_12=82]="CUSTOM_12",se[se.CUSTOM_13=83]="CUSTOM_13",se[se.CUSTOM_14=84]="CUSTOM_14",se[se.CUSTOM_15=85]="CUSTOM_15",se[se.CUSTOM_16=86]="CUSTOM_16",se[se.CUSTOM_17=87]="CUSTOM_17",se[se.CUSTOM_18=88]="CUSTOM_18",se[se.CUSTOM_19=89]="CUSTOM_19",se[se.CUSTOM_20=90]="CUSTOM_20",se[se.CUSTOM_21=91]="CUSTOM_21",se[se.CUSTOM_22=92]="CUSTOM_22",se[se.CUSTOM_23=93]="CUSTOM_23",se[se.CUSTOM_24=94]="CUSTOM_24",se[se.CUSTOM_25=95]="CUSTOM_25",se[se.CUSTOM_26=96]="CUSTOM_26",se[se.CUSTOM_27=97]="CUSTOM_27",se[se.CUSTOM_28=98]="CUSTOM_28",se[se.CUSTOM_29=99]="CUSTOM_29",se[se.CUSTOM_30=100]="CUSTOM_30",se[se.SUBSTRATE_1=101]="SUBSTRATE_1",se[se.HOLE=47]="HOLE",se[se.COMPONENT_SHAPE=48]="COMPONENT_SHAPE",se[se.COMPONENT_MARKING=49]="COMPONENT_MARKING",se[se.PIN_SOLDERING=50]="PIN_SOLDERING",se[se.PIN_FLOATING=51]="PIN_FLOATING",se[se.COMPONENT_MODEL=52]="COMPONENT_MODEL",se[se.SHELL_3D_OUTLINE=53]="SHELL_3D_OUTLINE",se[se.SHELL_3D_TOP=54]="SHELL_3D_TOP",se[se.SHELL_3D_BOTTOM=55]="SHELL_3D_BOTTOM",se[se.DRILL_DRAWING=56]="DRILL_DRAWING",se))(yd||{});var M0=(s=>(s[s.JLCEDA=1]="JLCEDA",s[s.EASYEDA=1]="EASYEDA",s[s.ALTIUM_DESIGNER=2]="ALTIUM_DESIGNER",s[s.PADS=3]="PADS",s[s.KICAD=4]="KICAD",s))(M0||{}),k0=(i=>(i[i.NORMAL=1]="NORMAL",i[i.FPC=2]="FPC",i))(k0||{}),F0=(l=>(l.SIGNAL="SIGNAL",l.INTERNAL_ELECTRICAL="PLANE",l.SILKSCREEN="SILKSCREEN",l.SOLDER_MASK="SOLDER_MASK",l.PASTE_MASK="PASTE_MASK",l.ASSEMBLY="ASSEMBLY",l.OTHER="OTHER",l.CUSTOM="CUSTOM",l))(F0||{}),U0=(r=>(r[r.NORMAL_BRIGHTNESS=0]="NORMAL_BRIGHTNESS",r[r.TURN_GRAY=1]="TURN_GRAY",r[r.HIDE=2]="HIDE",r))(U0||{}),Zf=class{async selectLayer(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.selectLayerById",{layerId:t})}async setLayerVisible(t,i=!1){let r=!0;return typeof t>"u"?(r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.setLayerStatus",{layerIds:[],visible:!0}),r):(r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.setLayerStatus",{layerIds:t instanceof Array?t:[t],visible:!0,setOtherLayerInvisible:i}),r)}async setLayerInvisible(t,i=!1){let r=!0;return typeof t>"u"?(r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.setLayerStatus",{layerIds:[],visible:!1}),r):(r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.setLayerStatus",{layerIds:t instanceof Array?t:[t],visible:!1,setOtherLayerVisible:i}),r)}async lockLayer(t){let i=!0;return typeof t>"u"?(i=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.setLayerStatus",{layerIds:[],locked:!0}),i):(i=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.setLayerStatus",{layerIds:t instanceof Array?t:[t],locked:!0}),i)}async unlockLayer(t){let i=!0;return typeof t>"u"?(i=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.setLayerStatus",{layerIds:[],locked:!1}),i):(i=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.setLayerStatus",{layerIds:t instanceof Array?t:[t],locked:!1}),i)}async setTheNumberOfCopperLayers(t){return t<2||t>32||t%2!==0?!1:await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.setTheNumberOfCopperLayers",{numberOfLayers:t})}async getTheNumberOfCopperLayers(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.getTheNumberOfCopperLayers")}async setLayerColorConfiguration(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.setLayerColorConfiguration",{colorConfiguration:t})}async setInactiveLayerTransparency(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.setInactiveLayerTransparency",{transparency:t/100})}async setPcbType(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.setPcbType",{pcbType:t})}async addCustomLayer(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.addCustomLayer")}async removeLayer(t){return t?await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.removeLayer",{layerId:t}):!1}async modifyLayer(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.modifyLayer",{layerId:t,data:{...i}})}async getAllLayers(){return(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.getAllLayers")).map(i=>({id:i.layerId,name:i.name,type:i.type,color:i.activeColor,transparency:o2((1-i.activeColorAlpha)*100),inactiveColor:i.deactiveColor,inactiveTransparency:o2((1-i.deactiveColorAlpha)*100),layerStatus:i.layerStatus,locked:i.locked}))}async setInactiveLayerDisplayMode(t=0){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Layer.setInactiveLayerDisplayMode",{displayMode:t})}};function o2(e){let t=Math.round(e*100)/100,i=parseFloat(t.toFixed(2));return i%1===0,i}var Qf=class{create(){}async delete(t){let i=[];return typeof t=="string"?i.push(t):t instanceof Zo?i.push(t.getState_PrimitiveId()):t[0]instanceof Zo?i=t.map(n=>n.getState_PrimitiveId()):i=[...t],(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePoured.delete",{primitiveIds:i})).length>0}modify(){}async get(t){var r;let i=await this.getAll();if(!i.length)return[];if(typeof t=="string"){let n=t;return(r=i.filter(s=>s.getState_PourPrimitiveId()===n))==null?void 0:r[0]}else{let n=new Set(t);return i.filter(s=>n.has(s.getState_PourPrimitiveId()))}}async getAllPrimitiveId(){return(await this.getAll()).map(i=>i.getState_PrimitiveId())}async getAll(){let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePoured.getAll");if(t.length>0){let i=t.reduce((r,n)=>{let{pourPrimitiveId:s,globalIndex:a,copperPath:o,style:l,gridLineWidth:u}=n,c={path:new Ka(o),lineWidth:l==="90grid"?u:0,fill:l!=="90grid",id:a};return r.has(s)?r.get(s).pourFills.push(c):r.set(s,new Zo(s,[c],s)),r},new Map);return Array.from(i.values())}else return[]}},Zo=class{constructor(t,i,r){this.async=!0;this.primitiveType="Poured";this.pourPrimitiveId=t,this.pourFills=i,this.primitiveId=r}create(){return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){return this.primitiveId}getState_PourPrimitiveId(){return this.pourPrimitiveId}getState_PourFills(){return this.pourFills}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this}isAsync(){return this.async}async reset(){return this}done(){return this}async convertToFill(t){let i=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePoured.convertToFill",{pourFillId:t});if(i){let n=this.getState_PourFills().filter(s=>s.id===t)[0].path.getSource();return new Mi(i.layerId,new ft(n),i.net,void 0,i.strokeWidth*10,i.locked,i.globalIndex)}else return}async addSolderMaskFill(t){let i=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePoured.addSolderMaskFill",{pourFillId:t});if(i){let n=this.getState_PourFills().filter(s=>s.id===t)[0].path.getSource();return new Mi(i.layerId,new ft(n),i.net,void 0,i.strokeWidth*10,i.locked,i.globalIndex)}else return}async deletePourFills(t){return Array.isArray(t)||(t=[t]),(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePoured.deletePourFills",{primitiveIds:t})).length>0}};var H0=(o=>(o[o.NO_COMPONENTS=2]="NO_COMPONENTS",o[o.NO_VIAS=3]="NO_VIAS",o[o.NO_WIRES=5]="NO_WIRES",o[o.NO_FILLS=6]="NO_FILLS",o[o.NO_POURS=7]="NO_POURS",o[o.NO_INNER_ELECTRICAL_LAYERS=8]="NO_INNER_ELECTRICAL_LAYERS",o[o.FOLLOW_REGION_RULE=9]="FOLLOW_REGION_RULE",o))(H0||{}),tm=class{async create(t,i,r,n,s,a){try{return await new jt(t,i,r,n,s,a).create()}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u533A\u57DF\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}}async delete(t){let i=[];typeof t=="string"?i.push(t):t instanceof jt?i.push(t.getState_PrimitiveId()):t[0]instanceof jt?i=t.map(n=>n.getState_PrimitiveId()):i=[...t];let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveRegion.delete",{primitiveIds:i});return!0}async modify(t,i){typeof t=="string"&&(t=await this.get(t));let{layer:r,complexPolygon:n,ruleType:s,regionName:a,lineWidth:o,primitiveLock:l}=i;return t.isAsync()||t.toAsync(),r!==void 0&&t.setState_Layer(r),n!==void 0&&t.setState_ComplexPolygon(n),s!==void 0&&t.setState_RuleType(s),a!==void 0&&t.setState_RegionName(a),o!==void 0&&t.setState_LineWidth(o),l!==void 0&&t.setState_PrimitiveLock(l),t.isAsync()?t.done():t.toSync(),t}async get(t){let i=[],r=!1;typeof t=="string"?(i.push(t),r=!0):i=[...t];let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveRegion.getByIds",{primitiveIds:i});if(!n.length)return[];if(r){let s=n[0],a=new ft(s.path[0]);if(s.type==="Constraint Region")return new jt(s.layerId,a,[9],s.name,s.strokeWidth,s.locked,s.globalIndex);{let o=[];return["device","fill","track","copper","planzone"].forEach(u=>{s[u]&&(u==="device"?o.push(2):u==="fill"?o.push(6):u==="track"?o.push(5):u==="copper"?o.push(7):u==="planzone"&&o.push(8))}),new jt(s.layerId,a,o,void 0,s.strokeWidth,s.locked,s.globalIndex)}}return n.map(s=>{let a=new ft(s.path[0]);if(s.type==="Constraint Region")return new jt(s.layerId,a,[9],s.name,s.strokeWidth,s.locked,s.globalIndex);{let o=[];return["device","fill","track","copper","planzone"].forEach(u=>{s[u]&&(u==="device"?o.push(2):u==="fill"?o.push(6):u==="track"?o.push(5):u==="copper"?o.push(7):u==="planzone"&&o.push(8))}),new jt(s.layerId,a,o,void 0,s.strokeWidth,s.locked,s.globalIndex)}})}async getAllPrimitiveId(t,i,r){return(await this.getAll(t,i,r)).map(s=>s.getState_PrimitiveId())}async getAll(t,i,r){let n={};return typeof t<"u"&&(n.layer=t),typeof i<"u"&&(n.ruleType=i),typeof r<"u"&&(n.primitiveLock=r),(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveRegion.getAll",n)).map(a=>{let o=new ft(a.path[0]);if(a.type==="Constraint Region")return new jt(a.layerId,o,[9],a.name,a.strokeWidth,a.locked,a.globalIndex);{let l=[];return["device","fill","track","copper","planzone"].forEach(c=>{a[c]&&(c==="device"?l.push(2):c==="fill"?l.push(6):c==="track"?l.push(5):c==="copper"?l.push(7):c==="planzone"&&l.push(8))}),new jt(a.layerId,o,l,void 0,a.strokeWidth,a.locked,a.globalIndex)}})}},jt=class{constructor(t,i,r=[2],n,s,a=!1,o){this.async=!0;this.primitiveType="Region";this.layer=t,this.complexPolygon=i,this.ruleType=r,this.regionName=n,this.lineWidth=s,this.primitiveLock=a,o&&(this.primitiveId=o)}async create(){this.setState_Layer(this.layer),this.setState_ComplexPolygon(this.complexPolygon),this.setState_RuleType(this.ruleType),this.setState_RegionName(this.regionName),this.lineWidth&&this.setState_LineWidth(this.lineWidth);try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveRegion.create",{layer:this.layer,complexPolygon:this.complexPolygon.getSource(),ruleType:this.ruleType,regionName:this.regionName,lineWidth:this.lineWidth,primitiveLock:this.primitiveLock});this.primitiveId=t.primitiveId,this.lineWidth||(this.lineWidth=t.lineWidth)}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitiveRegion.create() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PrimitiveRegion \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_Layer(){return this.layer}getState_ComplexPolygon(){return this.complexPolygon}getState_RuleType(){return this.ruleType}getState_RegionName(){return this.regionName}getState_LineWidth(){if(this.lineWidth)return this.lineWidth;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 lineWidth\u3002")}getState_PrimitiveLock(){return this.primitiveLock}setState_Layer(t){return this.layer=t,this.async||this.done(),this}setState_ComplexPolygon(t){return this.complexPolygon=t,this.async||this.done(),this}setState_RuleType(t){if(t){for(let i of t)if(i===9){t=[9];break}this.ruleType=t}return this.async||this.done(),this}setState_RegionName(t){return this.regionName=t,this.async||this.done(),this}setState_LineWidth(t){return this.lineWidth=t,this.async||this.done(),this}setState_PrimitiveLock(t){return this.primitiveLock=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveRegion.getByIds",{primitiveIds:[t]}))[0];return this.setState_Layer(r.layerId),this.setState_RuleType(r.ruleType),this.setState_RegionName(r.regionName),this.setState_LineWidth(r.strokeWidth),this.setState_PrimitiveLock(r.locked),this}async done(){let{primitiveId:t,layer:i,complexPolygon:r,ruleType:n,regionName:s,lineWidth:a,primitiveLock:o}=this,l={layerId:i,complexPolygon:r,ruleType:n,regionName:s,lineWidth:a,primitiveLock:o},u=(r==null?void 0:r.getSource())||[];if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveRegion.modify",{primitiveId:t,data:{...l,polygonSource:u}}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002");return this}async convertToFill(){let{primitiveId:t,complexPolygon:i}=this,r={primitiveId:t,type:"fill"},n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveRegion.convertToType",r);return new Mi(n.layerId,i,n.net,void 0,n.strokeWidth,n.locked,n.globalIndex)}async convertToPolyline(){let{primitiveId:t,complexPolygon:i}=this,r={primitiveId:t,type:"line"},n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveRegion.convertToType",r);return new ki(n.net,n.layerId,i,n.strokeWidth,n.locked,n.globalIndex)}async convertToPour(){let{primitiveId:t,complexPolygon:i}=this,r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveRegion.convertToType",{primitiveId:t,type:"copper"});return new Fr(r.net,r.layerId,i,r.copperInfo.style,r.copperInfo.keepIsland,r.copperInfo.name,r.pourPriority,r.strokeWidth,r.locked,r.globalIndex)}};function l2(e){if(e.length>0){let t=e.reduce((r,n)=>{let{pourPrimitiveId:s,globalIndex:a,copperPath:o,style:l,gridLineWidth:u}=n,c={path:new Ka(o),lineWidth:l==="90grid"?u:0,fill:l!=="90grid",id:a};return r.has(s)?r.get(s).pourFills.push(c):r.set(s,new Zo(s,[c],s)),r},new Map);return Array.from(t.values())[0]}else return}var em=(r=>(r.GRID45="45grid",r.GRID="90grid",r.SOLID="solid",r))(em||{}),im=class{async create(t,i,r,n,s,a,o,l,u){try{return await new Fr(t,i,r,n,s,a,o,l,u).create()}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u8986\u94DC\u8FB9\u6846\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}}async delete(t){let i=[];typeof t=="string"?i.push(t):t instanceof Fr?i.push(t.getState_PrimitiveId()):t[0]instanceof Fr?i=t.map(n=>n.getState_PrimitiveId()):i=[...t];let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePour.delete",{primitiveIds:i});return!0}async modify(t,i){typeof t=="string"&&(t=await this.get(t));let{net:r,layer:n,complexPolygon:s,pourFillMethod:a,preserveSilos:o,pourName:l,pourPriority:u,lineWidth:c,primitiveLock:h}=i;return t.isAsync()||t.toAsync(),r!==void 0&&t.setState_Net(r),n!==void 0&&t.setState_Layer(n),s!==void 0&&t.setState_ComplexPolygon(s),a!==void 0&&t.setState_PourFillMethod(a),o!==void 0&&t.setState_PreserveSilos(o),l!==void 0&&t.setState_PourName(l),u!==void 0&&t.setState_PourPriority(u),c!==void 0&&t.setState_LineWidth(c),h!==void 0&&t.setState_PrimitiveLock(h),t.isAsync()?t.done():t.toSync(),t}async get(t){let i=[],r=!1;typeof t=="string"?(i.push(t),r=!0):i=[...t];let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePour.getByIds",{primitiveIds:i});if(!n.length)return[];if(r){let s=n[0],a=new ft(s.path[0]);return new Fr(s.net,s.layerId,a,s.copperInfo.style,s.copperInfo.keepIsland,s.copperInfo.name,s.pourPriority,s.strokeWidth,s.locked,s.globalIndex)}return n.map(s=>{let a=new ft(s.path[0]);return new Fr(s.net,s.layerId,a,s.copperInfo.style,s.copperInfo.keepIsland,s.copperInfo.name,s.pourPriority,s.strokeWidth,s.locked,s.globalIndex)})}async getAllPrimitiveId(t,i,r){return(await this.getAll(t,i,r)).map(s=>s.getState_PrimitiveId())}async getAll(t,i,r){let n={};return typeof t<"u"&&(n.net=t),typeof i<"u"&&(n.layer=i),typeof r<"u"&&(n.primitiveLock=r),(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePour.getAll",n)).map(a=>{let o=new ft(a.path[0]);return new Fr(a.net,a.layerId,o,a.copperInfo.style,a.copperInfo.keepIsland,a.copperInfo.name,a.pourPriority,a.strokeWidth,a.locked,a.globalIndex)})}},Fr=class{constructor(t,i,r,n="solid",s=!1,a,o,l,u=!1,c){this.async=!0;this.primitiveType="Pour";this.net=t,this.layer=i,this.complexPolygon=r,this.pourFillMethod=n,this.preserveSilos=s,this.pourName=a,this.pourPriority=o,this.lineWidth=l,this.primitiveLock=u,c&&(this.primitiveId=c)}async create(){this.setState_Net(this.net),this.setState_Layer(this.layer),this.setState_ComplexPolygon(this.complexPolygon),this.setState_PourFillMethod(this.pourFillMethod),this.setState_PreserveSilos(this.preserveSilos),this.setState_PrimitiveLock(this.primitiveLock),this.pourName&&this.setState_PourName(this.pourName),this.pourPriority!==void 0&&this.setState_PourPriority(this.pourPriority),this.lineWidth&&this.setState_LineWidth(this.lineWidth);try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePour.create",{net:this.net,layer:this.layer,complexPolygon:this.complexPolygon.getSource(),pourFillMethod:this.pourFillMethod,preserveSilos:this.preserveSilos,pourName:this.pourName,pourPriority:this.pourPriority,lineWidth:this.lineWidth,primitiveLock:this.primitiveLock});this.primitiveId=t.primitiveId,this.pourName||(this.pourName=t.pourName),this.pourPriority||(this.pourPriority=t.pourPriority),this.lineWidth||(this.lineWidth=t.lineWidth)}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitivePour.create() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PrimitivePour \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_Net(){return this.net}getState_Layer(){return this.layer}getState_ComplexPolygon(){return this.complexPolygon}getState_PourFillMethod(){return this.pourFillMethod}getState_PreserveSilos(){return this.preserveSilos}getState_PourName(){if(this.pourName)return this.pourName;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 pourName\u3002")}getState_PourPriority(){if(this.pourPriority)return this.pourPriority;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 pourPriority\u3002")}getState_LineWidth(){if(this.lineWidth)return this.lineWidth;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 lineWidth\u3002")}getState_PrimitiveLock(){return this.primitiveLock}setState_Net(t){return this.net=t,this.async||this.done(),this}setState_Layer(t){return this.layer=t,this.async||this.done(),this}setState_ComplexPolygon(t){return this.complexPolygon=t,this.async||this.done(),this}setState_PourFillMethod(t){return this.pourFillMethod=t,this.async||this.done(),this}setState_PreserveSilos(t){return this.preserveSilos=t,this.async||this.done(),this}setState_PourName(t){return this.pourName=t,this.async||this.done(),this}setState_PourPriority(t){return this.pourPriority=t,this.async||this.done(),this}setState_LineWidth(t){return this.lineWidth=t,this.async||this.done(),this}setState_PrimitiveLock(t){return this.primitiveLock=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePour.getByIds",{primitiveIds:[t]}))[0];return this.setState_Net(r.net),this.setState_Layer(r.layerId),this.setState_PourFillMethod(r.copperInfo.style),this.setState_PreserveSilos(r.copperInfo.keepIsland),this.setState_PourName(r.copperInfo.name),this.setState_PourPriority(r.pourPriority),this.setState_LineWidth(r.strokeWidth),this.setState_PrimitiveLock(r.locked),this}async done(){let{primitiveId:t,net:i,layer:r,complexPolygon:n,pourFillMethod:s,preserveSilos:a,pourName:o,pourPriority:l,lineWidth:u,primitiveLock:c}=this,h={net:i,layerId:r,complexPolygon:n,pourFillMethod:s,preserveSilos:a,pourName:o,pourPriority:l,lineWidth:u,primitiveLock:c},m=(n==null?void 0:n.getSource())||[];if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePour.modify",{primitiveId:t,data:{...h,polygonSource:m}}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002");return this}async getCopperRegion(){let{primitiveId:t}=this,i=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePour.getCopperRegion",{primitiveId:t});return l2(i)}async rebuildCopperRegion(){let{primitiveId:t}=this,i=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePour.rebuildCopperRegion",{ids:[t],isLast:!1});return l2(i)}async convertToFill(){let{primitiveId:t,complexPolygon:i}=this,r={primitiveId:t,type:"fill"},n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePour.convertToType",r);return new Mi(n.layerId,i,n.net,void 0,n.strokeWidth,n.locked,n.globalIndex)}async convertToPolyline(){let{primitiveId:t,complexPolygon:i}=this,r={primitiveId:t,type:"line"},n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePour.convertToType",r);return new ki(n.net,n.layerId,i,n.strokeWidth,n.locked,n.globalIndex)}async convertToRegion(){let{primitiveId:t,complexPolygon:i}=this,r={primitiveId:t,type:"region"},n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePour.convertToType",r);return new jt(n.layerId,i,void 0,void 0,n.strokeWidth,n.locked,n.globalIndex)}};var rm=class{async create(t,i,r,n,s){try{return await new ki(t,i,r,n,s).create()}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u591A\u8FB9\u5F62\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}}async delete(t){let i=[];typeof t=="string"?i.push(t):t instanceof ki?i.push(t.getState_PrimitiveId()):t[0]instanceof ki?i=t.map(n=>n.getState_PrimitiveId()):i=[...t];let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePolyline.delete",{primitiveIds:i});return!0}async modify(t,i){typeof t=="string"&&(t=await this.get(t));let{net:r,layer:n,polygon:s,lineWidth:a,primitiveLock:o}=i;return t.isAsync()||t.toAsync(),r!==void 0&&t.setState_Net(r),n!==void 0&&t.setState_Layer(n),s!==void 0&&t.setState_Polygon(s),a!==void 0&&t.setState_LineWidth(a),o!==void 0&&t.setState_PrimitiveLock(o),t.isAsync()?t.done():t.toSync(),t}async get(t){let i=[],r=!1;typeof t=="string"?(i.push(t),r=!0):i=[...t];let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePolyline.getByIds",{primitiveIds:i});if(!n.length)return[];if(r){let s=n[0],a=new ft(s.path[0]);return new ki(s.net,s.layerId,a,s.strokeWidth,s.locked,s.globalIndex)}return n.map(s=>{let a=new ft(s.path[0]);return new ki(s.net,s.layerId,a,s.strokeWidth,s.locked,s.globalIndex)})}async getAllPrimitiveId(t,i,r){return(await this.getAll(t,i,r)).map(s=>s.getState_PrimitiveId())}async getAll(t,i,r){let n={};return typeof t<"u"&&(n.net=t),typeof i<"u"&&(n.layerId=i),typeof r<"u"&&(n.primitiveLock=r),(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePolyline.getAll",n)).map(a=>{let o=new ft(a.path[0]);return new ki(a.net,a.layerId,o,a.strokeWidth,a.locked,a.globalIndex)})}},ki=class{constructor(t,i,r,n=10,s=!1,a){this.async=!0;this.primitiveType="Polyline";this.net=t,this.layer=i,this.polygon=r,this.lineWidth=n,this.primitiveLock=s,a&&(this.primitiveId=a)}async create(){this.setState_Net(this.net),this.setState_Layer(this.layer),this.setState_Polygon(this.polygon),this.setState_LineWidth(this.lineWidth),this.setState_PrimitiveLock(this.primitiveLock);try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePolyline.create",{net:this.net,layerId:this.layer,polygonSource:this.polygon.getSource(),lineWidth:this.lineWidth,primitiveLock:this.primitiveLock});this.primitiveId=t.primitiveId}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PCB_PrimitivePolyline.create() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PCB_PrimitivePolyline \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_Net(){return this.net}getState_Layer(){return this.layer}getState_Polygon(){return this.polygon}getState_LineWidth(){return this.lineWidth}getState_PrimitiveLock(){return this.primitiveLock}setState_Net(t){return this.net=t,this.async||this.done(),this}setState_Layer(t){return this.layer=t,this.async||this.done(),this}setState_Polygon(t){return this.polygon=t,this.async||this.done(),this}setState_LineWidth(t){return this.lineWidth=t,this.async||this.done(),this}setState_PrimitiveLock(t){return this.primitiveLock=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePolyline.getByIds",{primitiveIds:[t]}))[0];return this.setState_Net(r.net),this.setState_Layer(r.layerId),this.setState_LineWidth(r.strokeWidth),this.setState_PrimitiveLock(r.locked),this}async done(){let{primitiveId:t,net:i,layer:r,polygon:n,lineWidth:s,primitiveLock:a}=this,o={net:i,layerId:r,polygon:n,lineWidth:s,primitiveLock:a},l=(n==null?void 0:n.getSource())||[];if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePolyline.modify",{primitiveId:t,data:{...o,polygonSource:l}}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002");return this}async convertToFill(){let{primitiveId:t,polygon:i}=this,r={primitiveId:t,type:"fill"},n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePolyline.convertToType",r);return new Mi(n.layerId,i,n.net,void 0,n.strokeWidth,n.locked,n.globalIndex)}async convertToPour(){let{primitiveId:t,polygon:i}=this,r={primitiveId:t,type:"copper"},n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePolyline.convertToType",r);return new Fr(n.net,n.layerId,i,n.copperInfo.style,n.copperInfo.keepIsland,n.copperInfo.name,n.pourPriority,n.strokeWidth,n.locked,n.globalIndex)}async convertToRegion(){let{primitiveId:t,polygon:i}=this,r={primitiveId:t,type:"region"},n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePolyline.convertToType",r);return new jt(n.layerId,i,void 0,void 0,n.strokeWidth,n.locked,n.globalIndex)}};var j0=(r=>(r[r.SOLID=0]="SOLID",r[r.MESH=1]="MESH",r[r.INNER_ELECTRICAL_LAYER=2]="INNER_ELECTRICAL_LAYER",r))(j0||{}),nm=class{async create(t,i,r,n,s,a){try{return await new Mi(t,i,r,n,s,a).create()}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u586B\u5145\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}}async delete(t){let i=[];typeof t=="string"?i.push(t):t instanceof Mi?i.push(t.getState_PrimitiveId()):t[0]instanceof Mi?i=t.map(n=>n.getState_PrimitiveId()):i=[...t];let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveFill.delete",{primitiveIds:i});return!0}async modify(t,i){typeof t=="string"&&(t=await this.get(t));let{layer:r,complexPolygon:n,net:s,lineWidth:a,primitiveLock:o}=i;return t.isAsync()||t.toAsync(),r!==void 0&&t.setState_Layer(r),n!==void 0&&t.setState_ComplexPolygon(n),s!==void 0&&t.setState_Net(s),a!==void 0&&t.setState_LineWidth(a),o!==void 0&&t.setState_PrimitiveLock(o),t.isAsync()?t.done():t.toSync(),t}async get(t){let i=[],r=!1;typeof t=="string"?(i.push(t),r=!0):i=[...t];let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveFill.getByIds",{primitiveIds:i});if(!n.length)return[];if(r){let s=n[0],a=new ft(s.path[0]);return new Mi(s.layerId,a,s.type==="Fill Region"?s.net:null,0,s.strokeWidth,s.locked,s.globalIndex)}return n.map(s=>{let a=new ft(s.path[0]);return new Mi(s.layerId,a,s.type==="Fill Region"?s.net:null,0,s.strokeWidth,s.locked,s.globalIndex)})}async getAllPrimitiveId(t,i,r){return(await this.getAll(t,i,r)).map(s=>s.getState_PrimitiveId())}async getAll(t,i,r){let n={};return typeof i<"u"&&(n.net=i),typeof t<"u"&&(n.layer=t),typeof r<"u"&&(n.primitiveLock=r),(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveFill.getAll",n)).map(a=>{let o=new ft(a.path[0]);return new Mi(a.layerId,o,a.type==="Fill Region"?a.net:null,0,a.strokeWidth,a.locked,a.globalIndex)})}},Mi=class{constructor(t,i,r,n=0,s,a=!1,o){this.async=!0;this.primitiveType="Fill";this.layer=t,this.complexPolygon=i,this.net=r,this.fillMode=n,this.lineWidth=s,this.primitiveLock=a,o&&(this.primitiveId=o)}async create(){this.setState_Layer(this.layer),this.setState_ComplexPolygon(this.complexPolygon),this.lineWidth&&this.setState_LineWidth(this.lineWidth),this.net&&this.setState_Net(this.net),this.fillMode!==void 0&&this.setState_FillMode(this.fillMode);try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveFill.create",{layer:this.layer,complexPolygon:this.complexPolygon.getSource(),net:this.net,lineWidth:this.lineWidth,primitiveLock:this.primitiveLock});this.primitiveId=t.primitiveId,this.lineWidth||(this.lineWidth=t.lineWidth)}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitiveFill.create() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PrimitiveFill \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_Net(){return this.net}getState_Layer(){return this.layer}getState_ComplexPolygon(){return this.complexPolygon}getState_FillMode(){return this.fillMode}getState_LineWidth(){if(this.lineWidth)return this.lineWidth;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 lineWidth\u3002")}getState_PrimitiveLock(){return this.primitiveLock}setState_Layer(t){return this.layer=t,this.async||this.done(),this}setState_ComplexPolygon(t){return this.complexPolygon=t,this.async||this.done(),this}setState_Net(t){return this.net=t,this.async||this.done(),this}setState_FillMode(t){return this.fillMode=t,this.async||this.done(),this}setState_LineWidth(t){return this.lineWidth=t,this.async||this.done(),this}setState_PrimitiveLock(t){return this.primitiveLock=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveFill.getByIds",{primitiveIds:[t]}))[0];return this.setState_Layer(r.layerId),this.setState_Net(r.net),this.setState_LineWidth(r.strokeWidth),this.setState_PrimitiveLock(r.locked),this}async done(){let{primitiveId:t,layer:i,complexPolygon:r,net:n,lineWidth:s,primitiveLock:a}=this,o={layerId:i,complexPolygon:r,net:n,lineWidth:s,primitiveLock:a},l=(r==null?void 0:r.getSource())||[];if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveFill.modify",{primitiveId:t,data:{...o,polygonSource:l}}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002");return this}async convertToPolyline(){let{primitiveId:t,complexPolygon:i}=this,r={primitiveId:t,type:"line"},n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveFill.convertToType",r);return new ki(n.net,n.layerId,i,n.strokeWidth,n.locked,n.globalIndex)}async convertToPour(){let{primitiveId:t,complexPolygon:i}=this,r={primitiveId:t,type:"copper"},n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveFill.convertToType",r);return new Fr(n.net,n.layerId,i,n.copperInfo.style,n.copperInfo.keepIsland,n.copperInfo.name,n.pourPriority,n.strokeWidth,n.locked,n.globalIndex)}async convertToRegion(){let{primitiveId:t,complexPolygon:i}=this,r={primitiveId:t,type:"region"},n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveFill.convertToType",r);return new jt(n.layerId,i,void 0,void 0,n.strokeWidth,n.locked,n.globalIndex)}};var Y0=(s=>(s.ELLIPSE="ELLIPSE",s.OBLONG="OVAL",s.RECTANGLE="RECT",s.REGULAR_POLYGON="NGON",s.POLYLINE_COMPLEX_POLYGON="POLYGON",s))(Y0||{}),G0=(i=>(i.ROUND="ROUND",i.RECTANGLE="RECT",i))(G0||{}),W0=(r=>(r.DIVERGENT="Divergent",r.DIRECT_CONNECTED="Direct-connected",r.NON_CONNECTED="Non-connected",r))(W0||{}),z0=(r=>(r[r.NORMAL=0]="NORMAL",r[r.TEST=1]="TEST",r[r.MARK_POINT=2]="MARK_POINT",r))(z0||{}),sm=class{async create(t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E){try{return await new Ur(t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E).create()}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u710A\u76D8\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}}async delete(t){let i=[];typeof t=="string"?i.push(t):t instanceof Ur?i.push(t.getState_PrimitiveId()):t[0]instanceof Ur?i=t.map(n=>n.getState_PrimitiveId()):i=[...t];let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePad.delete",{primitiveIds:i});return!0}async modify(t,i){typeof t=="string"&&(t=await this.get(t));let{layer:r,padNumber:n,x:s,y:a,rotation:o,pad:l,net:u,hole:c,holeOffsetX:h,holeOffsetY:m,holeRotation:f,metallization:g,specialPad:y,solderMaskAndPasteMaskExpansion:b,heatWelding:E,primitiveLock:S}=i;return t.isAsync()||t.toAsync(),r!==void 0&&t.setState_Layer(r),n!==void 0&&t.setState_PadNumber(n),s!==void 0&&t.setState_X(s),a!==void 0&&t.setState_Y(a),o!==void 0&&t.setState_Rotation(o),l!==void 0&&t.setState_Pad(l),u!==void 0&&t.setState_Net(u),c!==void 0&&t.setState_Hole(c),h!==void 0&&t.setState_HoleOffsetX(h),m!==void 0&&t.setState_HoleOffsetY(m),f!==void 0&&t.setState_HoleRotation(f),g!==void 0&&t.setState_Metallization(g),y!==void 0&&t.setState_SpecialPad(y),b!==void 0&&t.setState_SolderMaskAndPasteMaskExpansion(b),E!==void 0&&t.setState_HeatWelding(E),S!==void 0&&t.setState_PrimitiveLock(S),t.isAsync()?t.done():t.toSync(),t}async get(t){let i=[],r=!1;typeof t=="string"?(i.push(t),r=!0):i=[...t];let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePad.getByIds",{primitiveIds:i});if(!n.length)return[];if(r){let s=n[0];return new Ur(s.layerId,s.num,s.center.x*10,s.center.y*10,s.rotation,s.defaultPadShapeAspect,s.net,s.holeAspect,s.holeOffset.x,s.holeOffset.y,s.holeRotation,s.plated,s.padTypeAspect,s.specialPadShapeAspect,{topSolderMask:s.topSolderExpansion,bottomSolderMask:s.bottomSolderExpansion,topPasteMask:s.pasteExpansion,bottomPasteMask:s.pasteExpansion},s.padRule?{connectionMethod:s.connectMode,divergenceSpacing:s.lineClearance,divergenceLineWidth:s.lineWidth,divergenceAngle:s.lineAngle}:null,s.locked,s.globalIndex)}return n.map(s=>new Ur(s.layerId,s.num,s.center.x*10,s.center.y*10,s.rotation,s.defaultPadShapeAspect,s.net,s.holeAspect,s.holeOffset.x,s.holeOffset.y,s.holeRotation,s.plated,s.padTypeAspect,s.specialPadShapeAspect,{topSolderMask:s.topSolderExpansion,bottomSolderMask:s.bottomSolderExpansion,topPasteMask:s.pasteExpansion,bottomPasteMask:s.pasteExpansion},s.padRule?{connectionMethod:s.connectMode,divergenceSpacing:s.lineClearance,divergenceLineWidth:s.lineWidth,divergenceAngle:s.lineAngle}:null,s.locked,s.globalIndex))}async getAllPrimitiveId(t,i,r,n){return(await this.getAll(t,i,r,n)).map(a=>a.getState_PrimitiveId())}async getAll(t,i,r,n){let s={};return(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePad.getAll",s)).map(u=>new Ur(u.layerId,u.num,u.center.x*10,u.center.y*10,u.rotation,u.defaultPadShapeAspect,u.net,u.holeAspect,u.holeOffset.x,u.holeOffset.y,u.holeRotation,u.plated,u.padTypeAspect,u.specialPadShapeAspect,{topSolderMask:u.topSolderExpansion,bottomSolderMask:u.bottomSolderExpansion,topPasteMask:u.pasteExpansion,bottomPasteMask:u.pasteExpansion},u.padRule?{connectionMethod:u.connectMode,divergenceSpacing:u.lineClearance,divergenceLineWidth:u.lineWidth,divergenceAngle:u.lineAngle}:null,u.locked,u.globalIndex)).filter(u=>{let c=t===void 0||u.getState_Layer()===t,h=i===void 0||u.getState_Net()===i,m=r===void 0||u.getState_PrimitiveLock()===r,f=n===void 0||u.getState_PadType()===n;return c&&h&&m&&f})}},Ur=class{constructor(t,i,r,n,s=0,a,o,l=null,u=0,c=0,h=0,m=!0,f=0,g,y=null,b=null,E=!1,S){this.async=!0;this.primitiveType="Pad";this.layer=t,this.padNumber=i,this.x=r,this.y=n,this.rotation=s,this.pad=a,this.net=o,this.hole=l,this.holeOffsetX=u,this.holeOffsetY=c,this.holeRotation=h,this.metallization=m,this.padType=f,this.specialPad=g,this.solderMaskAndPasteMaskExpansion=y,this.heatWelding=b,this.primitiveLock=E,S&&(this.primitiveId=S)}async create(){if(this.setState_Layer(this.layer),this.setState_PadNumber(this.padNumber),this.setState_X(this.x),this.setState_Y(this.y),this.setState_Rotation(this.rotation),this.setState_Net(this.net),this.setState_HoleOffsetX(this.holeOffsetX),this.setState_HoleOffsetY(this.holeOffsetY),this.setState_HoleRotation(this.holeRotation),this.setState_Metallization(this.metallization),this.setState_PadType(this.padType),this.setState_SolderMaskAndPasteMaskExpansion(this.solderMaskAndPasteMaskExpansion),this.setState_HeatWelding(this.heatWelding),this.setState_PrimitiveLock(this.primitiveLock),this.pad)this.setState_Pad(this.pad);else if(this.specialPad)this.setState_SpecialPad(this.specialPad);else throw new Error("\u9519\u8BEF\uFF1Apad \u548C specialPad \u53C2\u6570\u5747\u672A\u8BBE\u7F6E\u3002");if(this.layer===12)if(this.hole)this.setState_Hole(this.hole);else throw new Error("\u9519\u8BEF\uFF1A\u5F53 layer \u4E3A EPCB_LayerId.MULTI \u65F6\uFF0Chole \u5FC5\u987B\u4E0D\u4E3A\u7A7A\u3002");try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePad.create",{layer:this.layer,padNumber:this.padNumber,x:this.x,y:this.y,rotation:this.rotation,pad:this.pad,net:this.net,hole:this.hole,holeOffsetX:this.holeOffsetX,holeOffsetY:this.holeOffsetY,holeRotation:this.holeRotation,metallization:this.metallization,padType:this.padType,specialPad:this.specialPad,solderMaskAndPasteMaskExpansion:this.solderMaskAndPasteMaskExpansion,heatWelding:this.heatWelding,primitiveLock:this.primitiveLock});this.primitiveId=t.primitiveId}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PCB_PrimitivePad.create() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PCB_PrimitivePad \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_Layer(){return this.layer}getState_PadNumber(){return this.padNumber}getState_X(){return this.x}getState_Y(){return this.y}getState_Rotation(){return this.rotation}getState_Pad(){return this.pad}getState_Net(){return this.net}getState_Hole(){return this.hole}getState_HoleOffsetX(){return this.holeOffsetX}getState_HoleOffsetY(){return this.holeOffsetY}getState_HoleRotation(){return this.holeRotation}getState_Metallization(){return this.metallization}getState_PadType(){return this.padType}getState_SpecialPad(){return this.specialPad}getState_SolderMaskAndPasteMaskExpansion(){return this.solderMaskAndPasteMaskExpansion}getState_HeatWelding(){return this.heatWelding}getState_PrimitiveLock(){return this.primitiveLock}setState_Layer(t){var i,r,n,s,a,o,l,u,c,h,m;if(this.layer===1&&t===2)this.solderMaskAndPasteMaskExpansion=typeof this.solderMaskAndPasteMaskExpansion=="object"&&typeof((i=this.solderMaskAndPasteMaskExpansion)==null?void 0:i.topSolderMask)=="number"&&typeof((r=this.solderMaskAndPasteMaskExpansion)==null?void 0:r.topPasteMask)=="number"?{bottomSolderMask:this.solderMaskAndPasteMaskExpansion.topSolderMask,bottomPasteMask:this.solderMaskAndPasteMaskExpansion.topPasteMask}:null;else if(this.layer===2&&t===1)this.solderMaskAndPasteMaskExpansion=typeof this.solderMaskAndPasteMaskExpansion=="object"&&typeof((n=this.solderMaskAndPasteMaskExpansion)==null?void 0:n.bottomSolderMask)=="number"&&typeof((s=this.solderMaskAndPasteMaskExpansion)==null?void 0:s.bottomPasteMask)=="number"?{topSolderMask:this.solderMaskAndPasteMaskExpansion.bottomSolderMask,topPasteMask:this.solderMaskAndPasteMaskExpansion.bottomPasteMask}:null;else if(this.layer===12&&(t===1||t===2)){if(this.solderMaskAndPasteMaskExpansion=typeof this.solderMaskAndPasteMaskExpansion=="object"&&typeof((a=this.solderMaskAndPasteMaskExpansion)==null?void 0:a.topSolderMask)=="number"&&typeof this.solderMaskAndPasteMaskExpansion.bottomSolderMask=="number"?t===1?{topSolderMask:this.solderMaskAndPasteMaskExpansion.topSolderMask,topPasteMask:0}:{bottomSolderMask:this.solderMaskAndPasteMaskExpansion.bottomSolderMask,bottomPasteMask:0}:null,this.specialPad){if(t===1)for(let f of this.specialPad)f[0]===1&&(this.pad=f[2]);else for(let f of this.specialPad)f[1]===2&&(this.pad=f[2]);this.specialPad=void 0}this.hole=null,this.holeOffsetX=0,this.holeOffsetY=0,this.holeRotation=0,this.metallization=!0}else if((this.layer===1||this.layer===2)&&t===12){this.solderMaskAndPasteMaskExpansion=typeof this.solderMaskAndPasteMaskExpansion=="object"&&(this.layer===1?typeof((o=this.solderMaskAndPasteMaskExpansion)==null?void 0:o.topSolderMask)=="number"&&typeof this.solderMaskAndPasteMaskExpansion.topPasteMask=="number":typeof((l=this.solderMaskAndPasteMaskExpansion)==null?void 0:l.bottomSolderMask)=="number"&&typeof this.solderMaskAndPasteMaskExpansion.bottomPasteMask=="number")?this.layer===1?{topSolderMask:(u=this.solderMaskAndPasteMaskExpansion)==null?void 0:u.topSolderMask,bottomSolderMask:(c=this.solderMaskAndPasteMaskExpansion)==null?void 0:c.topSolderMask}:{topSolderMask:(h=this.solderMaskAndPasteMaskExpansion)==null?void 0:h.bottomSolderMask,bottomSolderMask:(m=this.solderMaskAndPasteMaskExpansion)==null?void 0:m.bottomSolderMask}:null;let f=typeof this.pad[1]=="number"?this.pad[1]:0;this.hole=["ROUND",f,f]}return this.layer=t,this.async||this.done(),this}setState_PadNumber(t){return this.padNumber=t,this.async||this.done(),this}setState_X(t){return this.x=t,this.async||this.done(),this}setState_Y(t){return this.y=t,this.async||this.done(),this}setState_Rotation(t){return this.rotation=t,this.async||this.done(),this}setState_Pad(t){return this.pad=t,t&&(this.specialPad=void 0),this.async||this.done(),this}setState_Net(t){return this.net=t,this.async||this.done(),this}setState_Hole(t){if(this.hole=t,this.layer!==12){let i=this.async;i||(this.async=!0),this.setState_Layer(12),this.async=i}return this.async||this.done(),this}setState_HoleOffsetX(t){return this.hole!==null&&(this.holeOffsetX=t,this.async||this.done()),this}setState_HoleOffsetY(t){return this.hole!==null&&(this.holeOffsetY=t,this.async||this.done()),this}setState_HoleRotation(t){return this.hole!==null&&(this.holeRotation=t,this.async||this.done()),this}setState_Metallization(t){return this.hole!==null&&(this.metallization=t,this.async||this.done()),this}setState_SpecialPad(t){return this.specialPad=t,t&&(this.pad=void 0),this.async||this.done(),this}setState_SolderMaskAndPasteMaskExpansion(t){return this.solderMaskAndPasteMaskExpansion=t,this.async||this.done(),this}setState_HeatWelding(t){return this.heatWelding=t,this.async||this.done(),this}setState_PrimitiveLock(t){return this.primitiveLock=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePad.getByIds",{primitiveIds:[t]}))[0];return this.setState_Layer(r.layerId),this.setState_PadNumber(r.num),this.setState_X(r.center.x),this.setState_Y(r.center.y),this.setState_Rotation(r.rotation),this.setState_Pad(r.defaultPadShapeAspect),this.setState_Net(r.net),this.setState_Hole(r.holeAspect),this.setState_HoleOffsetX(r.holeOffset.center.x),this.setState_HoleOffsetY(r.holeOffset.center.y),this.setState_HoleRotation(r.holeRotation),this.setState_Metallization(r.plated),this.setState_PadType(r.padTypeAspect),this.setState_SpecialPad(r.specialPadShapeAspect),this.setState_SolderMaskAndPasteMaskExpansion({topSolderMask:r.topSolderExpansion,bottomSolderMask:r.bottomSolderExpansion,topPasteMask:r.pasteExpansion,bottomPasteMask:r.pasteExpansion}),this.setState_HeatWelding(r.padRule?{connectionMethod:r.connectMode,divergenceSpacing:r.lineClearance,divergenceLineWidth:r.lineWidth,divergenceAngle:r.lineAngle}:null),this.setState_PrimitiveLock(r.locked),this}async done(){let{primitiveId:t,layer:i,padNumber:r,x:n,y:s,rotation:a,pad:o,net:l,hole:u,holeOffsetX:c,holeOffsetY:h,holeRotation:m,metallization:f,padType:g,specialPad:y,solderMaskAndPasteMaskExpansion:b,heatWelding:E,primitiveLock:S}=this,v={layerId:i,padNumber:r,x:n,y:s,rotation:a,pad:o,net:l,hole:u,holeOffsetX:c,holeOffsetY:h,holeRotation:m,metallization:f,padFunction:g,specialPad:y,solderMaskAndPasteMaskExpansion:b,heatWelding:E,primitiveLock:S};if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePad.modify",{primitiveId:t,data:v}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002");return this}setState_PadType(t){return this.padType=t,this.async||this.done(),this}},_d=class extends Ur{constructor(i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E,S,v,A){super(n,s,a,o,l,v,S,u,c,h,m,f,g,A,y,b,E,i);this.primitiveType="ComponentPad";this.parentComponentPrimitiveId=r}getState_ParentComponentPrimitiveId(){return this.parentComponentPrimitiveId}async create(){return this}setState_Layer(){return this}setState_PadNumber(){return this}async reset(){return this}async done(){let{primitiveId:i,layer:r,padNumber:n,x:s,y:a,rotation:o,pad:l,net:u,hole:c,holeOffsetX:h,holeOffsetY:m,holeRotation:f,metallization:g,padType:y,specialPad:b,solderMaskAndPasteMaskExpansion:E,heatWelding:S,primitiveLock:v}=this,A={layerId:r,padNumber:n,x:s,y:a,rotation:o,pad:l,net:u,hole:c,holeOffsetX:h,holeOffsetY:m,holeRotation:f,metallization:g,padFunction:y,specialPad:b,solderMaskAndPasteMaskExpansion:E,heatWelding:S,primitiveLock:v};if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePad.modify",{primitiveId:i,data:A}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002");return this}async getConnectedPrimitives(i=!0){let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitivePad.getConnectedPrimitives",this.primitiveId),n=[];for(let s of r)switch(s.pcbItemPrimitiveType){case"Track":n.push(new Ci(s.net,s.layerId,s.startX,s.startY,s.endX,s.endY,s.width,s.locked,s.globalIndex));break;case"ArcTrack":n.push(new xi(s.net,s.layerId,s.startX,s.startY,s.endX,s.endY,s.arcAngle,s.width,s.arcType,s.locked,s.globalIndex));break;case"Via":n.push(new bi(s.net,s.center.x,s.center.y,s.holeRadius*2,s.radius*2,s.type,s.name,{topSolderMask:s.topExpansion,bottomSolderMask:s.bottomExpansion},s.locked,s.globalIndex));break;case"Rect":case"Circle":case"Polygon":if(!i&&s.type==="Fill Region"){let a=s.pathString?[s.pathString]:[];n.push(new Mi(s.layerId,new ft(a),s.net,void 0,s.strokeWidth*10,s.locked,s.globalIndex))}break;default:break}return n}setState_ParentComponentPrimitiveId(){return this}};function Fq(e,t){let{addIntoBom:i,designator:r,name:n,uniqueId:s,manufacturer:a,manufacturerId:o,supplier:l,supplierId:u}=t;i!==void 0&&e.setState_AddIntoBom(i),r!==void 0&&e.setState_Designator(r===null?void 0:r),n!==void 0&&e.setState_Name(n===null?void 0:n),s!==void 0&&e.setState_UniqueId(s===null?void 0:s),a!==void 0&&e.setState_Manufacturer(a===null?void 0:a),o!==void 0&&e.setState_ManufacturerId(o===null?void 0:o),l!==void 0&&e.setState_Supplier(l===null?void 0:l),u!==void 0&&e.setState_SupplierId(u===null?void 0:u)}function V0(e,t){return Object.entries(e).reduce((i,[r,n])=>(t.includes(r)||(i[r]=n),i))}var am=class{async create(t,i,r,n,s,a){let o=new Qr(t,i,r,n,s,a);return await o.create(),o}async delete(t){let i=[];typeof t=="string"?i.push(t):t instanceof Qr?i.push(t.getState_PrimitiveId()):t[0]instanceof Qr?i=t.map(n=>n.getState_PrimitiveId()):i=[...t];let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveComponent.delete",{primitiveIds:i});return!0}async modify(t,i){typeof t=="string"&&(t=await this.get(t));let{layer:r,x:n,y:s,rotation:a,primitiveLock:o,otherProperty:l}=i;return t.isAsync()||t.toAsync(),r!==void 0&&t.setState_Layer(r),n!==void 0&&t.setState_X(n),s!==void 0&&t.setState_Y(s),a!==void 0&&t.setState_Rotation(a),o!==void 0&&t.setState_PrimitiveLock(o),Fq(t,i),l!==void 0&&t.setState_OtherProperty(l),t.isAsync()?t.done():t.toSync(),t}async get(t){var s,a,o;let i=[],r=!1;typeof t=="string"?(i.push(t),r=!0):i=[...t];let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveComponent.getByIds",{primitiveIds:i});if(!n.length)return[];if(r){let l=n[0],u=l.attrsMap,c=V0(l.attrsMap,["Add into BOM","Designator","Name","Unique ID","Manufacturer","Manufacturer Part","Supplier","Supplier Part"]),h=l._apiExtenceData||{};return new Qr({libraryUuid:(h==null?void 0:h.devicePath)||"",uuid:l.deviceUUID},l.layerId,l.position.x,l.position.y,l.rotation,l.locked,u["Add into BOM"]==="yes",l.globalIndex,{libraryUuid:((s=h==null?void 0:h.footprint)==null?void 0:s.path)||"",uuid:((a=h==null?void 0:h.footprint)==null?void 0:a.uuid)||""},{libraryUuid:((o=h["3dmodel"])==null?void 0:o.path)||"",uuid:u["3D Model"]},u.Designator,(l.pads||[]).map(m=>({primitiveId:m.id,net:m.net,padNumber:m.num})),u.Name,u["Unique ID"],u.Manufacturer,u["Manufacturer Part"],u.Supplier,u["Supplier Part"],JSON.parse(JSON.stringify(c)))}return n.map(l=>{var m,f,g;let u=l.attrsMap,c=V0(l.attrsMap,["Add into BOM","Designator","Name","Unique ID","Manufacturer","Manufacturer Part","Supplier","Supplier Part"]),h=l._apiExtenceData||{};return new Qr({libraryUuid:(h==null?void 0:h.devicePath)||"",uuid:l.deviceUUID},l.layerId,l.position.x,l.position.y,l.rotation,l.locked,u["Add into BOM"]==="yes",l.globalIndex,{libraryUuid:((m=h==null?void 0:h.footprint)==null?void 0:m.path)||"",uuid:((f=h==null?void 0:h.footprint)==null?void 0:f.uuid)||""},{libraryUuid:((g=h["3dmodel"])==null?void 0:g.path)||"",uuid:u["3D Model"]},u.Designator,(l.pads||[]).map(y=>({primitiveId:y.id,net:y.net,padNumber:y.num})),u.Name,u["Unique ID"],u.Manufacturer,u["Manufacturer Part"],u.Supplier,u["Supplier Part"],JSON.parse(JSON.stringify(c)))})}async getAllPrimitiveId(t,i){return(await this.getAll(t,i)).map(n=>n.getState_PrimitiveId())}async getAll(t,i){let r={};return typeof t<"u"&&(r.layer=t),typeof i<"u"&&(r.primitiveLock=i),(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveComponent.getAll",r)).map(s=>{var u,c,h;let a=s.attrsMap,o=V0(s.attrsMap,["Add into BOM","Designator","Name","Unique ID","Manufacturer","Manufacturer Part","Supplier","Supplier Part"]),l=s._apiExtenceData||{};return new Qr({libraryUuid:(l==null?void 0:l.devicePath)||"",uuid:s.deviceUUID},s.layerId,s.position.x,s.position.y,s.rotation,s.locked,a["Add into BOM"]==="yes",s.globalIndex,{libraryUuid:((u=l==null?void 0:l.footprint)==null?void 0:u.path)||"",uuid:((c=l==null?void 0:l.footprint)==null?void 0:c.uuid)||""},{libraryUuid:((h=l["3dmodel"])==null?void 0:h.path)||"",uuid:a["3D Model"]},a.Designator,void 0,a.Name,a["Unique ID"],a.Manufacturer,a["Manufacturer Part"],a.Supplier,a["Supplier Part"],JSON.parse(JSON.stringify(o)))})}async getAllPinsByPrimitiveId(t){return(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveComponent.getAllPinsByPrimitiveId",t)).map(r=>new _d(r.globalIndex,t,r.layerId,r.num,r.center.x,r.center.y,r.rotation,r.holeAspect,r.holeOffset.x,r.holeOffset.y,r.holeRotation,r.plated,r.padTypeAspect,{topSolderMask:r.topSolderExpansion,bottomSolderMask:r.bottomSolderExpansion,topPasteMask:r.pasteExpansion,bottomPasteMask:r.pasteExpansion},r.padRule?{connectionMethod:r.connectMode,divergenceSpacing:r.lineClearance,divergenceLineWidth:r.lineWidth,divergenceAngle:r.lineAngle}:null,r.locked,r.net,r.defaultPadShapeAspect,r.specialPadShapeAspect))}async placeComponentWithMouse(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveComponent.placeComponentWithMouse",{uuid:t.uuid,libraryUuid:t.libraryUuid})}async getAllPropertyNames(){let i=(await this.getAll()).map(n=>n.getState_OtherProperty());return Array.from(i.reduce((n,s)=>(Object.keys(s).forEach(a=>n.add(a)),n),new Set))}},Qr=class{constructor(t,i,r,n,s=0,a=!1,o=!0,l,u,c,h,m,f,g,y,b,E,S,v){this.async=!0;this.primitiveType="Component";this.component=t,this.layer=i,this.x=r,this.y=n,this.rotation=s,this.primitiveLock=a,this.addIntoBom=o,l&&u&&(this.primitiveId=l,this.footprint=u,this.model3D=c,this.designator=h,this.pads=m,this.name=f,this.uniqueId=g,this.manufacturer=y,this.manufacturerId=b,this.supplier=E,this.supplierId=S,this.otherProperty=v)}async create(){this.setState_Component(this.component),this.setState_Layer(this.layer),this.setState_X(this.x),this.setState_Y(this.y),this.setState_Rotation(this.rotation),this.setState_PrimitiveLock(this.primitiveLock),this.setState_AddIntoBom(this.addIntoBom);let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveComponent.create",{componentData:this.component,layerId:this.layer,x:this.x,y:this.y,rotation:this.rotation,primitiveLock:this.primitiveLock,addIntoBom:this.addIntoBom});return this.primitiveId=t.primitiveId,this.footprint={libraryUuid:this.component.libraryUuid,uuid:this.component.uuid},this.model3D=void 0,this.designator=void 0,this.pads=void 0,this.name=void 0,this.uniqueId=void 0,this.manufacturer=void 0,this.manufacturerId=void 0,this.supplier=void 0,this.supplierId=void 0,this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_Component(){return this.component}getState_Footprint(){return this.footprint}getState_Layer(){return this.layer}getState_X(){return this.x}getState_Y(){return this.y}getState_Rotation(){return this.rotation}getState_PrimitiveLock(){return this.primitiveLock}getState_AddIntoBom(){return this.addIntoBom}getState_Model3D(){return this.model3D}getState_Designator(){return this.designator}getState_Pads(){if(this.primitiveId)return this.pads;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 Pads\u3002")}getState_Name(){return this.name}getState_UniqueId(){return this.uniqueId}getState_Manufacturer(){return this.manufacturer}getState_ManufacturerId(){return this.manufacturerId}getState_Supplier(){return this.supplier}getState_SupplierId(){return this.supplierId}getState_OtherProperty(){return this.otherProperty}setState_Layer(t){return this.layer=t,this.async||this.done(),this}setState_X(t){return this.x=t,this.async||this.done(),this}setState_Y(t){return this.y=t,this.async||this.done(),this}setState_Rotation(t){return this.rotation=ps(t),this.async||this.done(),this}setState_PrimitiveLock(t){return this.primitiveLock=t,this.async||this.done(),this}setState_AddIntoBom(t){return this.addIntoBom=t,this.async||this.done(),this}setState_Designator(t){return this.designator=t,this.async||this.done(),this}setState_Name(t){return this.name=t,this.async||this.done(),this}setState_UniqueId(t){return this.uniqueId=t,this.async||this.done(),this}setState_Manufacturer(t){return this.manufacturer=t,this.async||this.done(),this}setState_ManufacturerId(t){return this.manufacturerId=t,this.async||this.done(),this}setState_Supplier(t){return this.supplier=t,this.async||this.done(),this}setState_SupplierId(t){return this.supplierId=t,this.async||this.done(),this}setState_OtherProperty(t){return this.otherProperty=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveComponent.getByIds",{primitiveIds:[t]}))[0],n=r.attrsMap;return this.setState_Component(r.componentData),this.setState_Layer(r.layerId),this.setState_X(r.position.x),this.setState_Y(r.position.y),this.setState_Rotation(r.rotation),this.setState_PrimitiveLock(r.locked),this.setState_AddIntoBom(!!n["Add into BOM"]),this.setState_Component({libraryUuid:"",uuid:r.deviceUUID}),this.setState_Manufacturer(n.Manufacturer),this.setState_ManufacturerId(n["Manufacturer Part"]),this.setState_Designator(n.Designator),this.setState_Name(n.Name),this.setState_Supplier(n.Supplier),this.setState_SupplierId(n["Supplier Part"]),this.setState_UniqueId(n["Unique ID"]),this.setState_OtherProperty(n),this}async done(){let{primitiveId:t,layer:i,x:r,y:n,rotation:s,primitiveLock:a,addIntoBom:o,designator:l,name:u,uniqueId:c,manufacturer:h,manufacturerId:m,supplier:f,supplierId:g,otherProperty:y}=this,b;o!==void 0&&(o?b="yes":b="no");let E={layerId:i,x:r,y:n,rotation:s,primitiveLock:a,newAddIntoBom:b,designator:l,name:u,uniqueId:c,manufacturer:h,manufacturerId:m,supplier:f,supplierId:g,otherProperty:y};if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveComponent.modify",{primitiveId:t,data:E}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002");return this}async getAllPins(){let{primitiveId:t}=this;return(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveComponent.getAllPinsByPrimitiveId",t)).map(r=>new _d(r.globalIndex,t,r.layerId,r.num,r.center.x,r.center.y,r.rotation,r.holeAspect,r.holeOffset.x,r.holeOffset.y,r.holeRotation,r.plated,r.padTypeAspect,{topSolderMask:r.topSolderExpansion,bottomSolderMask:r.bottomSolderExpansion,topPasteMask:r.pasteExpansion,bottomPasteMask:r.pasteExpansion},r.padRule?{connectionMethod:r.connectMode,divergenceSpacing:r.lineClearance,divergenceLineWidth:r.lineWidth,divergenceAngle:r.lineAngle}:null,r.locked,r.net,r.defaultPadShapeAspect,r.specialPadShapeAspect))}async setAttribute(t,i,r,n){let s=!1;switch(t){case"Designator":typeof i=="string"&&(this.setState_Designator(i),s=!0);break;case"Name":typeof i=="string"&&(this.setState_Name(i),s=!0);break;case"Unique ID":typeof i=="string"&&(this.setState_UniqueId(i),s=!0);break;case"Add into BOM":typeof i=="boolean"&&(this.setState_AddIntoBom(i),s=!0);break;case"Manufacturer":typeof i=="string"&&(this.setState_Manufacturer(i),s=!0);break;case"Manufacturer Part":typeof i=="string"&&(this.setState_ManufacturerId(i),s=!0);break;case"Supplier":typeof i=="string"&&(this.setState_Supplier(i),s=!0);break;case"Supplier Part":typeof i=="string"&&(this.setState_SupplierId(i),s=!0);break;default:this.otherProperty||(this.otherProperty={}),this.otherProperty[t]||(this.otherProperty[t]=i||"",s=!0),i&&this.otherProperty[t]&&(this.otherProperty[t]=i,s=!0);break}if(this.async&&s&&this.done(),typeof r=="boolean"||typeof n=="boolean"){switch(this._attributeVisible=this._attributeVisible||{},this._attributeVisible[t]={},t){case"Designator":this._attributeVisible[t].value=this.getState_Designator();break;case"Name":this._attributeVisible[t].value=this.getState_Name();break;case"Unique ID":this._attributeVisible[t].value=this.getState_UniqueId();break;case"Add into BOM":this._attributeVisible[t].value=this.getState_AddIntoBom();break;case"Manufacturer":this._attributeVisible[t].value=this.getState_Manufacturer();break;case"Manufacturer Part":this._attributeVisible[t].value=this.getState_ManufacturerId();break;case"Supplier":this._attributeVisible[t].value=this.getState_Supplier();break;case"Supplier Part":this._attributeVisible[t].value=this.getState_SupplierId();break;default:this._attributeVisible[t].value=i||"";break}typeof r=="boolean"&&(this._attributeVisible[t].keyVisible=r),typeof n=="boolean"&&(this._attributeVisible[t].valueVisible=n);let{primitiveId:a}=this,o=this._attributeVisible;if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveComponent.setAttribute",{primitiveId:a,visible:o}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002")}}setState_Component(t){this.component=t}};var q0=(r=>(r.RADIUS="Radius Dimension",r.LENGTH="Length Dimension",r.ANGLE="Protractor Dimension",r))(q0||{}),om=class{async create(t,i,r,n,s,a,o){try{return await new en(t,i,r,n,s,a,o).create()}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u5C3A\u5BF8\u6807\u6CE8\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}}async delete(t){let i=[];typeof t=="string"?i.push(t):t instanceof en?i.push(t.getState_PrimitiveId()):t[0]instanceof en?i=t.map(n=>n.getState_PrimitiveId()):i=[...t];let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveDimension.delete",{primitiveIds:i});return!0}async modify(t,i){typeof t=="string"&&(t=await this.get(t));let{dimensionType:r,coordinateSet:n,layer:s,unit:a,lineWidth:o,precision:l,primitiveLock:u}=i;return t.isAsync()||t.toAsync(),r!==void 0&&t.setState_DimensionType(r),n!==void 0&&t.setState_CoordinateSet(n),s!==void 0&&t.setState_Layer(s),a!==void 0&&t.setState_Unit(a),o!==void 0&&t.setState_LineWidth(o),l!==void 0&&t.setState_Precision(l),u!==void 0&&t.setState_PrimitiveLock(u),t.isAsync()?t.done():t.toSync(),t}async get(t){let i=[],r=!1;typeof t=="string"?(i.push(t),r=!0):i=[...t];let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveDimension.getByIds",{primitiveIds:i});if(!n.length)return[];if(r){let s=n[0];return new en(s.dimensionType,s.coordinateSet,s.layerId,s.unit,s.lineWidth,s.precision,s.primitiveLock,s.globalIndex)}return n.map(s=>new en(s.dimensionType,s.coordinateSet,s.layerId,s.unit,s.lineWidth,s.precision,s.primitiveLock,s.globalIndex))}async getAllPrimitiveId(t,i){return(await this.getAll(t,i)).map(n=>n.getState_PrimitiveId())}async getAll(t,i){let r={};return typeof t<"u"&&(r.net=t),typeof i<"u"&&(r.primitiveLock=i),(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveDimension.getAll",r)).map(s=>new en(s.dimensionType,s.coordinateSet,s.layerId,s.unit,s.lineWidth,s.precision,s.primitiveLock,s.globalIndex))}},en=class{constructor(t,i,r=13,n="mm",s=6,a=1,o=!1,l){this.async=!0;this.primitiveType="Dimension";this.dimensionType=t,this.coordinateSet=i,this.layer=r,this.unit=n,this.lineWidth=s,this.precision=a,this.primitiveLock=o,l&&(this.primitiveId=l),this.textFollow=1}async create(){this.setState_DimensionType(this.dimensionType),this.setState_CoordinateSet(this.coordinateSet),this.setState_Layer(this.layer),this.setState_Unit(this.unit),this.setState_LineWidth(this.lineWidth),this.setState_Precision(this.precision),this.setState_PrimitiveLock(this.primitiveLock);try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveDimension.create",{dimensionType:this.dimensionType,coordinateSet:this.coordinateSet,layer:this.layer,unit:this.unit,lineWidth:this.lineWidth,precision:this.precision,primitiveLock:this.primitiveLock});this.primitiveId=t.primitiveId}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PCB_PrimitiveDimension.create() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PCB_PrimitiveDimension \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_DimensionType(){return this.dimensionType}getState_CoordinateSet(){return this.coordinateSet}getState_Layer(){return this.layer}getState_Unit(){return this.unit}getState_LineWidth(){return this.lineWidth}getState_Precision(){return this.precision}getState_TextFollow(){return this.textFollow}getState_PrimitiveLock(){return this.primitiveLock}setState_DimensionType(t){return this.dimensionType=t,this.async||this.done(),this}setState_CoordinateSet(t){return this.coordinateSet=t,this.async||this.done(),this}setState_Layer(t){return this.layer=t,this.async||this.done(),this}setState_Unit(t){return this.unit=t,this.async||this.done(),this}setState_LineWidth(t){return this.lineWidth=t,this.async||this.done(),this}setState_Precision(t){return t=t<0?0:t>4?4:t,this.precision=t,this.async||this.done(),this}setState_PrimitiveLock(t){return this.primitiveLock=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveDimension.getByIds",{primitiveIds:[t]}))[0];return this.setState_DimensionType(r.dimensionType),this.setState_Layer(r.layerId),this.setState_Unit(r.unit),this.setState_LineWidth(r.width),this.setState_Precision(r.precision),this.setState_PrimitiveLock(r.locked),this}async done(){let{primitiveId:t,dimensionType:i,coordinateSet:r,layer:n,unit:s,lineWidth:a,precision:o,primitiveLock:l}=this,u={dimensionType:i,coordinateSet:r,layerId:n,unit:s,lineWidth:a,precision:o,primitiveLock:l};if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveDimension.modify",{primitiveId:t,data:u}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002");return this}};var lm=class{async create(t,i,r,n,s,a,o,l,u){Array.isArray(r)||(r=r.getSource());try{return await new tn(t,i,r,n,s,a,o,l,u).create()}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u56FE\u50CF\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}}async delete(t){let i=[];return typeof t=="string"?i.push(t):t instanceof tn?i.push(t.getState_PrimitiveId()):t[0]instanceof tn?i=t.map(n=>n.getState_PrimitiveId()):i=[...t],(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveImage.delete",{primitiveIds:i})).length>0}async modify(t,i){typeof t=="string"&&(t=await this.get(t));let{x:r,y:n,layer:s,width:a,height:o,rotation:l,horizonMirror:u,primitiveLock:c}=i;return t.isAsync()||t.toAsync(),r!==void 0&&t.setState_X(r),n!==void 0&&t.setState_Y(n),s!==void 0&&t.setState_Layer(s),a!==void 0&&t.setState_Width(a),o!==void 0&&t.setState_Height(o),l!==void 0&&t.setState_Rotation(l),u!==void 0&&t.setState_HorizonMirror(u),c!==void 0&&t.setState_PrimitiveLock(c),t.isAsync()?t.done():t.toSync(),t}async get(t){let i=[],r=!1;typeof t=="string"?(i.push(t),r=!0):i=[...t];let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveImage.getByIds",{primitiveIds:i});if(!n.length)return[];if(r){let s=n[0];return new tn(s.start.x,s.start.y,s.pathString?[s.pathString]:[],s.layerId,s.width,s.height,s.rotation,s.horizonMirror,s.primitiveLock,s.globalIndex)}return n.map(s=>new tn(s.start.x,s.start.y,s.pathString?[s.pathString]:[],s.layerId,s.width,s.height,s.rotation,s.horizonMirror,s.primitiveLock,s.globalIndex))}async getAllPrimitiveId(t,i){return(await this.getAll(t,i)).map(n=>n.getState_PrimitiveId())}async getAll(t,i){let r={};return typeof t<"u"&&(r.layer=t),typeof i<"u"&&(r.primitiveLock=i),(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveImage.getAll",r)).map(s=>new tn(s.start.x,s.start.y,s.pathString?[s.pathString]:[],s.layerId,s.width,s.height,s.rotation,s.horizonMirror,s.primitiveLock,s.globalIndex))}},tn=class{constructor(t,i,r,n,s,a,o=0,l=!1,u=!1,c){this.async=!0;this.primitiveType="Image";this.x=t,this.y=i,this.complexPolygon=r,this.layer=n,this.rotation=o,this.horizonMirror=l,this.primitiveLock=u,s&&a?(this.width=s,this.height=a):(this.width=be.pcb_MathPolygon.calculateWidth(r),this.height=be.pcb_MathPolygon.calculateHeight(r)),c&&(this.primitiveId=c)}async create(){this.setState_X(this.x),this.setState_Y(this.y),this.setState_ComplexPolygon(this.complexPolygon),this.setState_Layer(this.layer),this.setState_Width(this.width),this.setState_Height(this.height),this.setState_HorizonMirror(this.horizonMirror),this.setState_PrimitiveLock(this.primitiveLock);try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveImage.create",{x:this.x,y:this.y,complexPolygon:Array.isArray(this.complexPolygon[0])?this.complexPolygon:[this.complexPolygon],layer:this.layer,width:this.width,height:this.height,rotation:this.rotation,horizonMirror:this.horizonMirror,primitiveLock:this.primitiveLock});this.primitiveId=t.primitiveId}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PCB_PrimitiveImage.create() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PCB_PrimitiveImage \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_X(){return this.x}getState_Y(){return this.y}getState_ComplexPolygon(){return this.complexPolygon}getState_Layer(){return this.layer}getState_Width(){return this.width}getState_Height(){return this.height}getState_Rotation(){return this.rotation}getState_HorizonMirror(){return this.horizonMirror}getState_PrimitiveLock(){return this.primitiveLock}setState_X(t){return this.x=t,this.async||this.done(),this}setState_Y(t){return this.y=t,this.async||this.done(),this}setState_Layer(t){return this.layer=t,this.async||this.done(),this}setState_Width(t){return this.width=t,this.async||this.done(),this}setState_Height(t){return this.height=t,this.async||this.done(),this}setState_Rotation(t){return this.rotation=t,this.async||this.done(),this}setState_HorizonMirror(t){return this.horizonMirror=t,this.async||this.done(),this}setState_PrimitiveLock(t){return this.primitiveLock=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveImage.getByIds",{primitiveIds:[t]}))[0];return this.setState_X(r.start.x),this.setState_Y(r.start.y),this.setState_ComplexPolygon(r.template),this.setState_Layer(r.layerId),this.setState_HorizonMirror(r.mirror),this.setState_PrimitiveLock(r.locked),this}async done(){let{primitiveId:t,x:i,y:r,layer:n,width:s,height:a,rotation:o,horizonMirror:l,primitiveLock:u}=this,c={x:i,y:r,layerId:n,width:s,height:a,rotation:o,horizonMirror:l,primitiveLock:u};if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveImage.modify",{primitiveId:t,data:c}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002");return this}setState_ComplexPolygon(t){this.complexPolygon=t}};var X0=(i=>(i.ACTIVE="active",i.INACTIVE="inactive",i))(X0||{}),um=class{async importChanges(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.importChanges",{uuid:t})}async importAutoRouteJsonFile(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.importAutoRouteJsonFile",t)}async importAutoLayoutJsonFile(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.importAutoLayoutJsonFile",t)}async save(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.save",{uuid:t})}async getCalculatingRatlineStatus(){return(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.getRatlineStatus",{})).status}async startCalculatingRatline(){return(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.setRatlineStatus",{status:"active"})).status==="active"}async stopCalculatingRatline(){return(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.setRatlineStatus",{status:"inactive"})).status==="inactive"}async convertCanvasOriginToDataOrigin(t,i){let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.convertCanvasOriginToDataOrigin",{x:t,y:i});return{x:r.x,y:r.y}}async convertDataOriginToCanvasOrigin(t,i){let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.convertDataOriginToCanvasOrigin",{x:t,y:i});return{x:r.x,y:r.y}}async getCanvasOrigin(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.getCanvasOrigin",{})}async setCanvasOrigin(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.setCanvasOrigin",{offsetX:t,offsetY:i})}async navigateToCoordinates(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.navigateToCoordinates",{x:t,y:i})}async navigateToRegion(t,i,r,n){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.navigateToRegion",{left:t,right:i,top:r,bottom:n})}async getPrimitiveAtPoint(t,i){let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.getPrimitiveAtPoint",{x:t,y:i}),n=[];for(let s of r)switch(s.pcbItemPrimitiveType){case"Via":n.push(new bi(s.net,s.center.x,s.center.y,s.holeRadius*2,s.radius*2,s.type,s.name,{topSolderMask:s.topExpansion,bottomSolderMask:s.bottomExpansion},s.locked,s.globalIndex));break;case"Pad":{n.push(new Ur(s.layerId,s.num,s.center.x,s.center.y,s.rotation,s.defaultPadShapeAspect,s.net,s.holeAspect,s.holeOffset.x,s.holeOffset.y,s.holeRotation,s.plated,s.type,s.specialPadShapeAspect,{topSolderMask:s.topSolderExpansion,bottomSolderMask:s.bottomSolderExpansion},null,s.locked,s.globalIndex));break}case"Component":{n.push(new Qr({libraryUuid:s.device.name,uuid:s.device.uuid},s.layerId,s.position.x,s.position.y,s.rotation,s.locked,s.attrsMap["Add into BOM"],s.globalIndex,{libraryUuid:s.footprint.id,uuid:s.footprint.uuid},{libraryUuid:s.attrsMap["3D Model Title"],uuid:s.attrsMap["3D Model"]},s.attrsMap.Designator,s.pads,s.attrsMap.Name,s.attrsMap["Unique ID"],s.attrsMap.Manufacturer,s.attrsMap["Manufacturer Part"],s.attrsMap.Supplier,s.attrsMap["Supplier Part"]));break}case"Rect":{n.push(new jt(s.layerId,new ft(["R",s.start.x,s.start.y,s.width,s.height,s.rotation,s.cornerRadius]),s.regionRuleSelector,s.type,s.strokeWidth,s.locked,s.globalIndex));break}case"Circle":{n.push(new jt(s.layerId,new ft(["CIRCLE",s.center.x,s.center.y,s.radius]),s.regionRuleSelector,s.type,s.strokeWidth,s.locked,s.globalIndex));break}case"Polygon":{let a=s.pathString?[s.pathString]:[];s.type!=="Line"?n.push(new jt(s.layerId,new ft(a),s.regionRuleSelector,s.type,s.strokeWidth,s.locked,s.globalIndex)):n.push(new ki(s.net,s.layerId,new ft(a),s.strokeWidth,s.locked,s.globalIndex));break}case"Image":{n.push(new tn(s.start.x,s.start.y,s.pathString?[s.pathString]:[],s.layerId,s.width,s.height,s.rotation,s.mirror,s.locked,s.globalIndex));break}case"Length Dimension":case"Protractor Dimension":case"Radius Dimension":{n.push(new en(s.dimensionType,s.coordinateSet,s.layerId,s.unit,s.width,s.precision,s.locked,s.globalIndex));break}case"Track":n.push(new Ci(s.net,s.layerId,s.startX,s.startY,s.endX,s.endY,s.width,s.locked,s.globalIndex));break;case"ArcTrack":n.push(new xi(s.net,s.layerId,s.startX,s.startY,s.endX,s.endY,s.arcAngle,s.width,s.arcType,s.locked,s.globalIndex));break;case"Text":break;default:break}return n[0]}async getPrimitivesInRegion(t,i,r,n,s=!0){let a=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.getPrimitivesInRegion",{left:t,right:i,top:r,bottom:n,leftToRight:s}),o=[];for(let l of a)switch(l.pcbItemPrimitiveType){case"Via":o.push(new bi(l.net,l.center.x,l.center.y,l.holeRadius*2,l.radius*2,l.type,l.name,{topSolderMask:l.topExpansion,bottomSolderMask:l.bottomExpansion},l.locked,l.globalIndex));break;case"Pad":{o.push(new Ur(l.layerId,l.num,l.center.x,l.center.y,l.rotation,l.defaultPadShapeAspect,l.net,l.holeAspect,l.holeOffset.x,l.holeOffset.y,l.holeRotation,l.plated,l.type,l.specialPadShapeAspect,{topSolderMask:l.topSolderExpansion,bottomSolderMask:l.bottomSolderExpansion},null,l.locked,l.globalIndex));break}case"Component":{o.push(new Qr({libraryUuid:l.device.name,uuid:l.device.uuid},l.layerId,l.position.x,l.position.y,l.rotation,l.locked,l.attrsMap["Add into BOM"],l.globalIndex,{libraryUuid:l.footprint.id,uuid:l.footprint.uuid},{libraryUuid:l.attrsMap["3D Model Title"],uuid:l.attrsMap["3D Model"]},l.attrsMap.Designator,l.pads,l.attrsMap.Name,l.attrsMap["Unique ID"],l.attrsMap.Manufacturer,l.attrsMap["Manufacturer Part"],l.attrsMap.Supplier,l.attrsMap["Supplier Part"]));break}case"Rect":{o.push(new jt(l.layerId,new ft(["R",l.start.x,l.start.y,l.width,l.height,l.rotation,l.cornerRadius]),l.regionRuleSelector,l.type,l.strokeWidth,l.locked,l.globalIndex));break}case"Circle":{o.push(new jt(l.layerId,new ft(["CIRCLE",l.center.x,l.center.y,l.radius]),l.regionRuleSelector,l.type,l.strokeWidth,l.locked,l.globalIndex));break}case"Polygon":{let u=l.pathString?[l.pathString]:[];l.type!=="Line"?o.push(new jt(l.layerId,new ft(u),l.regionRuleSelector,l.type,l.strokeWidth,l.locked,l.globalIndex)):o.push(new ki(l.net,l.layerId,new ft(u),l.strokeWidth,l.locked,l.globalIndex));break}case"Image":{o.push(new tn(l.start.x,l.start.y,l.pathString?[l.pathString]:[],l.layerId,l.width,l.height,l.rotation,l.mirror,l.locked,l.globalIndex));break}case"Length Dimension":case"Protractor Dimension":case"Radius Dimension":{o.push(new en(l.dimensionType,l.coordinateSet,l.layerId,l.unit,l.width,l.precision,l.locked,l.globalIndex));break}case"Track":o.push(new Ci(l.net,l.layerId,l.startX,l.startY,l.endX,l.endY,l.width,l.locked,l.globalIndex));break;case"ArcTrack":o.push(new xi(l.net,l.layerId,l.startX,l.startY,l.endX,l.endY,l.arcAngle,l.width,l.arcType,l.locked,l.globalIndex));break;case"Text":break;default:break}return o}async zoomToBoardOutline(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.zoomToBoardOutline")}async getCurrentFilterConfiguration(){let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.getCurrentFilterConfiguration");if(t)return t}};var cm=class{async check(t=!0,i=!1,r=!1){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.check",{strict:t,userInterface:i,includeVerboseError:r})}async getCurrentRuleConfigurationName(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.getCurrentRuleConfigurationName")}async getCurrentRuleConfiguration(){let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.getCurrentRuleConfiguration");return{config:t.Rule,name:t.ruleTemplateName}}async getRuleConfiguration(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.getRuleConfiguration",{configurationName:t})}async getAllRuleConfigurations(t=!0){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.getAllRuleConfigurations",{includeSystem:t})}async saveRuleConfiguration(t,i,r=!1){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.saveRuleConfiguration",{ruleConfiguration:t,configurationName:i,allowOverwrite:r})}async renameRuleConfiguration(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.renameRuleConfiguration",{originalConfigurationName:t,configurationName:i})}async deleteRuleConfiguration(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.deleteRuleConfiguration",{configurationName:t})}async getDefaultRuleConfigurationName(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.getDefaultRuleConfigurationName")}async setAsDefaultRuleConfiguration(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.setAsDefaultRuleConfiguration",{configurationName:t})}async getNetRules(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.getNetRules",{})}async overwriteNetRules(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.overwriteNetRules",{netRules:t})}async getNetByNetRules(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.getNetByNetRules",{})}async overwriteNetByNetRules(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.overwriteNetByNetRules",{netByNetRules:t})}async getRegionRules(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.getRegionRules",{})}async overwriteRegionRules(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.overwriteRegionRules",{regionRules:t})}async createNetClass(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.createNetClass",{netClassName:t,nets:i,color:r})}async deleteNetClass(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.deleteNetClass",{netClassName:t})}async modifyNetClassName(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.modifyNetClassName",{originalNetClassName:t,netClassName:i})}async addNetToNetClass(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.addNetToNetClass",{net:i,netClassName:t})}async removeNetFromNetClass(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.removeNetFromNetClass",{net:i,netClassName:t})}async getAllNetClasses(){return(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.getAllNetClasses")).map(i=>({name:i.name,nets:i.nets,color:i.color}))}async createDifferentialPair(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.createDifferentialPair",{differentialPairName:t,positiveNet:i,negativeNet:r})}async deleteDifferentialPair(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.deleteDifferentialPair",{differentialPairName:t})}async modifyDifferentialPairName(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.modifyDifferentialPairName",{originalDifferentialPairName:t,differentialPairName:i})}async modifyDifferentialPairPositiveNet(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.modifyDifferentialPairPositiveNet",{differentialPairName:t,positiveNet:i})}async modifyDifferentialPairNegativeNet(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.modifyDifferentialPairNegativeNet",{differentialPairName:t,negativeNet:i})}async getAllDifferentialPairs(){return(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.getAllDifferentialPairs")).map(i=>{let r=i.sub;return{name:i.name,positiveNet:r[0]?r[0].name:"",negativeNet:r[1]?r[1].name:""}})}async createEqualLengthNetGroup(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.createEqualLengthNetGroup",{equalLengthNetGroupName:t,nets:i,color:r})}async deleteEqualLengthNetGroup(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.deleteEqualLengthNetGroup",{equalLengthNetGroupName:t})}async modifyEqualLengthNetGroupName(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.modifyEqualLengthNetGroupName",{originalEqualLengthNetGroupName:t,equalLengthNetGroupName:i})}async addNetToEqualLengthNetGroup(t,i){return!t||!i?!1:await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.addNetToEqualLengthNetGroup",{net:i,equalLengthNetGroupName:t})}async removeNetFromEqualLengthNetGroup(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.removeNetFromEqualLengthNetGroup",{net:i,equalLengthNetGroupName:t})}async getAllEqualLengthNetGroups(){return(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.getAllEqualLengthNetGroups")).map(i=>({name:i.name,nets:i.nets,color:i.color}))}async createPadPairGroup(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.createPadPairGroup",{padPairGroupName:t,padPairs:i})}async deletePadPairGroup(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.deletePadPairGroup",{padPairGroupName:t})}async modifyPadPairGroupName(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.modifyPadPairGroupName",{originalPadPairGroupName:t,padPairGroupName:i})}async addPadPairToPadPairGroup(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.addPadPairToPadPairGroup",{padPairGroupName:t,padPair:i})}async removePadPairFromPadPairGroup(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.removePadPairFromPadPairGroup",{padPairGroupName:t,padPair:i})}async getAllPadPairGroups(){return(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.getAllPadPairGroups")).map(i=>{let r=i.details,n=[];for(let s of r){let a=s.pad1,o=s.pad2;n.push([a.designator&&a.number?`${a.designator}:${a.number}`:`${a.id}`,o.designator&&o.number?`${o.designator}:${o.number}`:`${o.id}`])}return{name:i.groupName,padPairs:n}})}async getPadPairGroupMinWireLength(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Drc.getPadPairGroupMinWireLength",{padPairGroupName:t})}};var dm=class{addMouseEventListener(t,i,r,n=!1){for(let s of _.extensionPCB_Events)if(t===s.id)return;typeof r=="function"&&_.extensionPCB_Events.push({id:t,event:"mouse",eventType:i,callFn:r,onlyOnce:n})}addPrimitiveEventListener(t,i,r,n=!1){for(let s of _.extensionPCB_Events)if(t===s.id)return;typeof r=="function"&&_.extensionPCB_Events.push({id:t,event:"primitive",eventType:i,callFn:r,onlyOnce:n})}addNetEventListener(t,i,r,n=!1){for(let s of _.extensionPCB_Events)if(t===s.id)return;typeof r=="function"&&_.extensionPCB_Events.push({id:t,event:"net",eventType:i,callFn:r,onlyOnce:n})}addCrossProbeSelectEventListener(t,i){for(let r of _.extensionPCB_Events)if(t===r.id)return;typeof i=="function"&&_.extensionPCB_Events.push({id:t,event:"crossProbeSelect",callFn:i})}removeEventListener(t){for(let[i,r]of _.extensionPCB_Events.entries())if(t===r.id)return _.extensionPCB_Events.splice(i,1),!0;return!1}isEventListenerAlreadyExist(t){for(let i of _.extensionPCB_Events)if(t===i.id)return!0;return!1}};var PD=Hn(FE());var pl=(o=>(o.ALLEGRO="Allegro",o.PADS="PADS",o.PROTEL2="Protel2",o.JLCEDA_PRO="JLCEDA",o.EASYEDA_PRO="EasyEDA",o.ALTIUM_DESIGNER="Protel2",o.DISA="DISA",o))(pl||{}),UE=(r=>(r.IMPORT_DOCUMENT="ImportDocument",r.EXTRACT_LIBRARIES="ExtractLibraries",r.IMPORT_DOCUMENT_EXTRACT_LIBRARIES="ImportDocumentExtractLibraries",r))(UE||{}),HE=(i=>(i.USE_SYSTEM_THEME="system",i.USE_SOURCE_FILE_STYLE="custom",i))(HE||{}),jE=(i=>(i.ALL_COVER_OIL="cover",i.FOLLOW_ORIGINAL_SETTING="custom",i))(jE||{}),YE=(i=>(i.FROM_KEEPOUT_LAYER="keepout",i.FROM_MECHANICAL_LAYER_1="mechanical",i))(YE||{}),rg=class{async getProjectFile(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileManager.getProjectFile",{fileName:t,password:i,fileType:r})}async getDocumentFile(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileManager.getDocumentFile",{fileName:t,password:i,fileType:r})}async getDocumentSource(){let{message:t}=await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileManager.getDocumentSource");return t}async getDocumentFootprintSources(){var s;let t=await this.getDocumentFile();if(!t)return[];let i=new PD.default;await i.loadAsync(t);let r=[];i.forEach((a,o)=>{o.name.endsWith(".efoo")&&r.push(o.name)});let n=[];for(let a of r){let o=await((s=i.file(a))==null?void 0:s.async("string"));o&&n.push({footprintUuid:a.split("/").at(-1).split(".")[0],documentSource:o})}return n}async setDocumentSource(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileManager.setDocumentSource",{source:t})}async getProjectFileByProjectUuid(t,i,r,n){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileManager.getProjectFile",{projectUuid:t,fileName:i,password:r,origin:"cloud",fileType:n})}async getDeviceFileByDeviceUuid(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileManager.getDeviceFileByDeviceUuid",{deviceUuid:t,libraryUuid:i,fileType:r})}async getSymbolFileBySymbolUuid(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileManager.getSymbolFileBySymbolUuid",{symbolUuid:t,libraryUuid:i,fileType:r})}async getFootprintFileByFootprintUuid(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileManager.getFootprintFileByFootprintUuid",{footprintUuid:t,libraryUuid:i,fileType:r})}async getCbbFileByCbbUuid(t,i,r){return typeof r=="string"&&(r={fileName:r}),await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileManager.getCbbFileByCbbUuid",{cbbUuid:t,libraryUuid:i,props:r})}async getPanelLibraryFileByPanelLibraryUuid(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileManager.getPanelLibraryFileByPanelLibraryUuid",{panelLibraryUuid:t,libraryUuid:i,fileType:r})}async importProjectByProjectFile(t,i="JLCEDA Pro",r={importOption:"ImportDocument",viaSolderMaskExpansion:"cover",boardOutlineSource:"keepout",schematicObjectStyle:"system",associateFootprint:!0,associate3DModel:!0,importFootprintNotesLayer:!0},n,s){let a=await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileManager.importProjectByProjectFile",{projectFile:t,fileType:i,props:r,saveTo:n,librariesImportSetting:s});if(a)return await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Project.getProjectInfo",a)}async extractProjectInfo(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileManager.extractProjectInfo",t)}async extractLibInfo(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileManager.extractLibInfo",t)}};var ng=class{async getAllNets(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Net.getAllNets")}async getNet(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Net.getNet",{net:t})}async getAllNetsName(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Net.getAllNetName")}async getAllNetName(){return this.getAllNetsName()}async getNetLength(t){let i=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Net.getNetLength",{netName:t});if(typeof i=="number")return Js(i*10,6,!1)}async getNetColor(t){let i=await this.getNet(t);if(i)return i.color}async setNetColor(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Net.setNetColor",{net:t,color:i})}async getAllPrimitivesByNet(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Net.getAllPrimitivesByNet",{netName:t,primitiveTypes:i})}async selectNet(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Net.selectNet",{netName:t})}async unselectNet(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Net.unselectNet",{netName:t})}async unselectAllNets(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Net.unselectAllNets")}async highlightNet(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Net.highlightNet",{netName:t})}async unhighlightNet(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Net.unhighlightNet",{netName:t})}async unhighlightAllNets(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Net.unhighlightAllNets")}async getNetlist(t="JLCEDA"){let i="enet";switch(t){case"JLCEDA":case"EasyEDA":i="enet";break;case"PADS":i="asc";break;case"Protel2":case"Protel2":i="net";break;case"Allegro":i="tel";break;case"DISA":i=".dnet";break;default:break}let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Document.getAllPCBTabData",{});if(!r||!r.length)return"";let n={netListType:t,fileName:`Netlist_${aC()}`,extension:i,pcbMap:r,options:{additionalValue:"{Value}",tolerance:"",device:"{Device}",footprint:"{Footprint}",customProperty:!1,deviceName:!1}};return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Net.getNetlist",{...n})}async setNetlist(t="JLCEDA",i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_Net.setNetlist",{type:t,netlist:i})}};function _Z(e,t){e==="No."?t.value="Number":e==="Pin Count"?t.key=2:(e==="Layer"||e==="Mounting Style")&&(t.key=1)}function bZ(e,t){for(let i of t)if(i.value===e.property){let r=e.title?e.title:i.title,n=e.sort?ED(e.sort):i.order,s=e.group?ED(e.group):i.key;return n===void 0||s===void 0?void 0:(i.title=r,i.order=n,i.key=s,!0)}}function PZ(e,t,i){let r=!0;for(let n of e)if(n.property==="Add into BOM"||n.property==="Convert to PCB"){for(let s of i.filterRules)if(s.attr===n.property){let a=EZ(n.includeValue);if(a===void 0){r=!1;return}s.rule=a,s.checked=!0,s.isForbidDel=!0,s.selected=!1}}else t.includes(n.property)?(typeof n.includeValue!="string"&&(r=!1),i.filterRules.push({attr:n.property,rule:n.includeValue,checked:!0,isForbidDel:!1,selected:!1})):r=!1;return r}function ED(e){return e=e.toLowerCase(),e==="asc"||e==="yes"?1:e==="desc"||e==="no"?2:void 0}function EZ(e){return typeof e=="string"?(e=e.toLowerCase(),e==="yes"?"yes":e==="no"?"no":void 0):typeof e=="boolean"?e?"yes":"no":void 0}var GE=(r=>(r.MULTI_PAGE_PDF="A Multi Page PDF",r.MULTIPLE_SINGLE_PAGE_PDF="Multiple Single Page PDF",r.SINGLE_PAGE_PDF="A Single Page PDF",r))(GE||{}),sg=class{async getGerberFile(t,i=!1,r="mm",n={integerNumber:2,decimalNumber:6},s={metallicDrillingInformation:!0,nonMetallicDrillingInformation:!0,drillTable:!1,flyingProbeTestingFile:!0},a,o){let l;typeof n=="object"&&n.integerNumber&&n.decimalNumber&&(l={Integer:n.integerNumber,Decimals:n.decimalNumber});let u={fileName:t,fileType:"zip",silk:i,unit:r,format:l,drilledHole:s,layerConfigs:a,objectConfigs:o,drillTable:s.drillTable||!1,flyingProbe:s.flyingProbeTestingFile||!1,useOldBool:!1};(typeof u.layerConfigs>"u"||u.layerConfigs.length===0)&&(u.layerConfigs=[{layerId:1,isMirror:!1},{layerId:2,isMirror:!1},{layerId:3,isMirror:!1},{layerId:4,isMirror:!1},{layerId:5,isMirror:!1},{layerId:6,isMirror:!1},{layerId:7,isMirror:!1},{layerId:8,isMirror:!1},{layerId:9,isMirror:!1},{layerId:10,isMirror:!1},{layerId:11,isMirror:!1},{layerId:13,isMirror:!1},{layerId:14,isMirror:!1},{layerId:56,isMirror:!1}]),(typeof u.objectConfigs>"u"||u.objectConfigs.length===0)&&(u.objectConfigs=["Pad","Via","Track","Text","Image","Dimension","BoardOutline","BoardCutout","CopperFilled","SolidRegion","FPCStiffener","Line","PlaneZone","ComponentProperty","ComponentSilkscreen","TearDrop"]);let c=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getGerberFile",{...u});if(typeof c=="object"&&c!==null&&c.arrayBufferData)return new File([c.arrayBufferData],t||c.fileName,{type:c.matchMimeType})}async get3DFile(t,i="step",r=["Component Model"],n="Outfit",s=!0){let a=t||"3D_File",o={name:a,type:i,obj:"",isAutoGenerate3dModel:!!s,assembly:!0,modelMode:n},l=[...r],u=["pcb"];l.includes("Component Model")&&u.push("componentModel"),l.includes("Via")&&u.push("via"),l.includes("Silkscreen")&&u.push("silk"),l.includes("Track")&&u.push("track"),l.includes("Wire In Signal Layer")&&u.push("track"),o.obj=String(Array.from(new Set(u)));let c=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.get3DFile",{...o});if(typeof c=="object"&&c!==null&&c.blobData)return new File([c.blobData],a,{type:c.blobData.type})}async get3DShellFile(t,i="stl"){let r=t||"3D_SHELL_File",n={name:r,type:i},s=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.get3DShellFile",{...n});if(typeof s=="object"&&s!==null&&s.blobData)return new File([s.blobData],r,{type:s.blobData.type})}async getPickAndPlaceFile(t,i="xlsx",r="mm"){let n=t||"Pick_Place",s={fileName:n,fileType:i,unit:r};s.isContainPanelized=!0,s.isContainPanelMarkCoord=!0,s.attrHeads=[{key:"Designator",title:"Designator"},{key:"Device",title:"Device"},{key:"Footprint",title:"Footprint"},{key:"Mid X",title:"Mid X"},{key:"Mid Y",title:"Mid Y"},{key:"Ref X",title:"Ref X"},{key:"Ref Y",title:"Ref Y"},{key:"Pad X",title:"Pad X"},{key:"Pad Y",title:"Pad Y"},{key:"Pins",title:"Pins"},{key:"Layer",title:"Layer"},{key:"Rotation",title:"Rotation"},{key:"SMD",title:"SMD"},{key:"Name",title:"Comment"},{key:"Value",title:"Value"},{key:"Type",title:"Type"},{key:"Supplier",title:"Supplier"},{key:"Datasheet",title:"Datasheet"}];let a=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getPickAndPlaceFile",{...s});if(typeof a=="object"&&a!==null&&a.blobData)return new File([a.blobData],n,{type:a.blobData.type})}async getFlyingProbeTestFile(t){let i=t,r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getFlyingProbeTestFile",{});if(typeof r=="object"&&r!==null&&r.blobData)return t=i||r.fileName,new File([r.blobData],t,{type:r.blobData.type})}async getBomTemplates(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getBomTemplates")}async uploadBomTemplateFile(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.uploadBomTemplateFile",{templateFile:t,template:i})}async getBomTemplateFile(t){let i=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getBomTemplateFile",t);if(typeof i=="object"&&i!==null)return new File([i],t.includes(".xlsx")?t:t+".xlsx",{type:i.type})}async deleteBomTemplate(t){let i=t.includes(".xlsx")?t:t+".xlsx";return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.deleteBomTemplate",i)}async getBomFile(t,i="xlsx",r,n,s,a,o){let{statisticsArr:l,filterOptionArr:u,propertyArr:c,tableAttrKeysDefault:h}=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getBomDefaultParams"),m=t||"Export_BOM",f={fileName:m+i,fileType:i};if(f.boardName="",f.ev="pcb",f.filterRules=[{attr:"Add into BOM",rule:"no",checked:!0,isForbidDel:!0,selected:!1},{attr:"Convert to PCB",rule:"no",checked:!1,isForbidDel:!0,selected:!1}],f.selectedId="",f.tableAttrKeys=[],n&&!PZ(n,u,f))return;if(s)for(let y of s)if(l.includes(y)){let b={title:y,value:y,order:0,key:0};_Z(y,b),f.tableAttrKeys.push(b)}else return;if(a)for(let y of a)if(c.includes(y)){let b={title:y,value:y,order:0,key:0};f.tableAttrKeys.push(b)}else return;if(f.tableAttrKeys.length<1?f.tableAttrKeys=h:f.tableAttrKeys=f.tableAttrKeys.map((y,b)=>({...y,orderWeight:f.tableAttrKeys.length-b})),o){let y=f.tableAttrKeys.map(b=>b.value);for(let b of o)if(b.property==="No."&&(b.property="Number"),y.includes(b.property)){if(!bZ(b,f.tableAttrKeys))return}else return}let g=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getBomFile",{...f,template:r});if(typeof g=="object"&&g!==null&&g.arrayBufferData)return new File([g.arrayBufferData],m+"."+i,{type:g.matchMimeType})}async getTestPointFile(t,i="xlsx"){let r=t||"TestPoint_Report",n={fileName:r,fileType:i},s=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getTestPointFile",{...n});if(typeof s=="object"&&s!==null&&s.blobData)return new File([s.blobData],r,{type:s.blobData.type})}async getNetlistFile(t,i="JLCEDA"){let r=t||"Net_List",n="enet";i==="Allegro"?n="tel":i==="PADS"?n="asc":i==="Protel2"?n="net":i==="DISA"?n=".dnet":n="enet";let s={fileName:r,netlistType:i,extension:n},a=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getNetlistFile",{...s});if(typeof a=="object"&&a!==null&&a.blobData)return new File([a.blobData],r+"."+n,{type:a.blobData.type})}async getDxfFile(t,i,r){let n=t||"Net_List",s={fileName:n};Array.isArray(r)&&r.length?s.objectConfigs=[...r]:s.objectConfigs=["TopPad","BottomPad","MultiPad","Via","PadDrill","ViaDrill","Track","Text","Image","Dimension","BoardOutline","BoardCutout","CopperOutline","CopperFilled","TearDrop","SolidRegion","ProhibitedRegion","FPCStiffener","Line,PlaneZone","ComponentProperty","ComponentSilkscreen","Shell_Outline","Shell_ScrewPillar","Shell_SideDatumLine","Shell_SideSlotRegion","Shell_TopBottomSlotRegion","Shell_SideEntity","Shell_TopBottomEntity"],Array.isArray(i)&&i.length?s.layerConfigs=i.map(o=>({layerId:Number(o.layerId),isMirror:o.mirror,check:!0})):s.layerConfigs=[];let a=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getDxfFile",{...s});if(typeof a=="object"&&a!==null&&a.blobData)return new File([a.blobData],n,{type:a.blobData.type})}async getPdfFile(t,i="A Multi Page PDF",r={displayAttributesAsMenu:!0,showOutlineOnly:!1},n={show:!1,content:"{Project Name}{Document Name}",styleConfig:{color:"#CCCCCC",transparency:"50%",font:"Arial",fontSize:"300mil",style:{blood:!1,italic:!1,underline:!1},slope:45,denseness:"Single"}}){let s=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getPDFFile"),a=t||s.fileName;if(s){if(typeof s=="object"&&s!==null&&s.data)return new File([s.data],a+".pdf",{type:s.extension})}else return}async getIpcD356AFile(t){let{ipcFileName:i,source:r}=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getIPCFile"),n=t?t+".356a":i;if(r)return new File([JSON.stringify(r)],n)}async getOpenDatabaseDoublePlusFile(t,i="inch",r={metallizedDrilledHoles:!0,nonMetallizedDrilledHoles:!0,drillTable:!1,flyingProbeTestFile:!0},n,s){let a=t||"ODB++",l={...r,...{metallizedDrilledHoles:!0,nonMetallizedDrilledHoles:!0,drillTable:!1,flyingProbeTestFile:!0}},u={fileName:a,fileType:"zip",silk:!1,unit:i,language:"",format:{Decimals:"5",Integer:"3"},mainVersion:"",layerConfigs:(n==null?void 0:n.map(h=>({layerId:h.layerId,isMirror:h.mirror})))||[],objectConfigs:s,drillTable:!0,drillMap:[],flyingProbe:!0,useOldBool:!1,title:"",userUuid:""};u.flyingProbe=!!l.flyingProbeTestFile,u.drillTable=!!l.drillTable,l.metallizedDrilledHoles&&u.drillMap.push("PTH"),l.nonMetallizedDrilledHoles&&u.drillMap.push("NPTH"),(typeof u.layerConfigs>"u"||u.layerConfigs.length===0)&&(u.layerConfigs=[{layerId:1,isMirror:!1},{layerId:2,isMirror:!1},{layerId:3,isMirror:!1},{layerId:4,isMirror:!1},{layerId:5,isMirror:!1},{layerId:6,isMirror:!1},{layerId:7,isMirror:!1},{layerId:8,isMirror:!1},{layerId:9,isMirror:!1},{layerId:10,isMirror:!1},{layerId:11,isMirror:!1},{layerId:13,isMirror:!1},{layerId:14,isMirror:!1},{layerId:56,isMirror:!1}]),(typeof u.objectConfigs>"u"||u.objectConfigs.length===0)&&(u.objectConfigs=["Pad","Via","Track","Text","Image","Dimension","BoardOutline","BoardCutout","CopperFilled","SolidRegion","FPCStiffener","Line","PlaneZone","ComponentProperty","ComponentSilkscreen","TearDrop"]);let c=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getOpenDatabaseDoublePlusFile",{...u});if(typeof c=="object"&&c!==null&&c.arrayBufferData)return new File([c.arrayBufferData],t||c.fileName,{type:c.matchMimeType})}async getInteractiveBomFile(t){let i=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getInteractiveBomFile");if(i!==null&&i.fileData){let r=t?t+".html":i.fileName;return new File([i.fileData],r)}}async getDsnFile(t){let r={fileName:t||"DSN"},n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getDsnFile",{...r});if(typeof n=="object"&&n!==null&&n.blobData)return new File([n.blobData],t||n.fileName,{type:n.blobData.type})}async getAutoRouteJsonFile(t){let{jsonObject:i,pcbName:r}=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getAutoRouteJson",_.extensionPCB_ManufactureDataAutoRouteRule);if(i)return new File([JSON.stringify(i,null,"	")],t||"AutoRoute2_"+r+"_"+$_()+".json")}async getAutoLayoutJsonFile(t){let{jsonObject:i,pcbName:r}=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getAutoLayoutJson");if(i)return new File([JSON.stringify(i,null,"	")],t||"AutoLayout2_"+r+"_"+$_()+".json")}async getAltiumDesignerFile(t){let i=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getADFile");if(i!==null&&i.fileData)return typeof i.fileData=="object"?new File([i.fileData],t||i.fileData.fileName):new File([JSON.stringify(i.fileData)],t||i.fileData.fileName)}async getPadsFile(t){let i=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getPADSFile");if(i!==null&&i.fileData)return typeof i.fileData=="object"?new File([i.fileData],t||i.fileData.fileName):new File([JSON.stringify(i.fileData)],t||i.fileData.fileName)}async getPcbInfoFile(t){let r={fileName:t||"PCB_INFO"},n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getPcbInfoFile",{...r});if(typeof n=="object"&&n!==null&&n.blobData)return new File([n.blobData],t||n.fileName,{type:n.blobData.type})}async placeComponentsOrder(t=!0,i=!1){let r={interactive:t,ignoreWarning:i};return!!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getOrderComponents",r)}async placeSmtComponentsOrder(t=!0,i=!1){let r={interactive:t,ignoreWarning:i};return!!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getOrderSMT",r)}async placePcbOrder(t=!0,i=!1){let r={interactive:t,ignoreWarning:i};return!!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getOrderPCB",r)}async place3DShellOrder(t=!0,i=!1){let r={interactive:t,ignoreWarning:i};return!!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getOrder3DShellFile",r)}async getManufactureData(){if(!$a)throw new Error("\u9519\u8BEF\uFF1A\u672C\u63A5\u53E3\u4EC5\u79C1\u6709\u5316\u90E8\u7F72\u7248\u672C\u6709\u6548\uFF01");return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_ManufactureData.getManufactureData")}};var ag=class{create(){}async delete(t){let i=[];return typeof t=="string"?i.push(t):t instanceof fl?i.push(t.getState_PrimitiveId()):t[0]instanceof fl?i=t.map(n=>n.getState_PrimitiveId()):i=[...t],(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveAttribute.delete",{primitiveIds:i})).length>0}async modify(t,i){typeof t=="string"&&(t=await this.get(t));let{layer:r,x:n,y:s,key:a,value:o,keyVisible:l,valueVisible:u,fontFamily:c,fontSize:h,lineWidth:m,alignMode:f,rotation:g,reverse:y,expansion:b,mirror:E,primitiveLock:S}=i;return t.isAsync()||t.toAsync(),r!==void 0&&t.setState_Layer(r),n!==void 0&&t.setState_X(n),s!==void 0&&t.setState_Y(s),a!==void 0&&t.setState_Key(a),o!==void 0&&t.setState_Value(o),l!==void 0&&t.setState_KeyVisible(l),u!==void 0&&t.setState_ValueVisible(u),c!==void 0&&t.setState_FontFamily(c),h!==void 0&&t.setState_FontSize(h),m!==void 0&&t.setState_LineWidth(m),f!==void 0&&t.setState_AlignMode(f),g!==void 0&&t.setState_Rotation(g),y!==void 0&&t.setState_Reverse(y),b!==void 0&&t.setState_Expansion(b),E!==void 0&&t.setState_Mirror(E),S!==void 0&&t.setState_PrimitiveLock(S),t.isAsync()?t.done():t.toSync(),t}async get(t){let i=[],r=!1;typeof t=="string"?(i.push(t),r=!0):i=[...t];let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveAttribute.getByIds",{primitiveIds:i});if(!n.length)return[];if(r){let s=n[0];return new fl(s.layerId,s.position.x*10,s.position.y*10,s.key,s.value,s.showKey,s.showValue,s.fontFamily,s.fontSize*10,s.strokeWidth*10,s.origin,s.rotation*180/Math.PI,s.reverse,s.reverseExpansion*10,s.mirror,s.locked,s.globalIndex,s.parentPrimitiveId)}return n.map(s=>new fl(s.layerId,s.position.x*10,s.position.y*10,s.key,s.value,s.showKey,s.showValue,s.fontFamily,s.fontSize*10,s.strokeWidth*10,s.origin,s.rotation*180/Math.PI,s.reverse,s.reverseExpansion*10,s.mirror,s.locked,s.globalIndex,s.parentPrimitiveId))}async getAllPrimitiveId(t,i,r){return(await this.getAll(t,i,r)).map(s=>s.getState_PrimitiveId())}async getAll(t,i,r){return(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveAttribute.getAll")).map(o=>{let l=o.attrs,u=o.parentPrimitiveId;return l.map(c=>new fl(c.layerId,c.position.x*10,c.position.y*10,c.key,c.value,c.showKey,c.showValue,c.fontFamily,c.fontSize*10,c.strokeWidth*10,c.origin,c.rotation*180/Math.PI,c.reverse,c.reverseExpansion*10,c.mirror,c.locked,c.globalIndex,u))}).flat().filter(o=>{let l=t===void 0||o.getState_ParentPrimitiveId()===t,u=i===void 0||o.getState_Layer()===i,c=r===void 0||o.getState_PrimitiveLock()===r;return l&&u&&c})}},fl=class{constructor(t,i,r,n,s,a,o,l,u,c,h,m,f,g,y,b,E,S){this.async=!0;this.primitiveType="Attribute";this.layer=t,this.x=i,this.y=r,this.key=n,this.value=s,this.keyVisible=a,this.valueVisible=o,this.fontFamily=l,this.fontSize=u,this.lineWidth=c,this.alignMode=h,this.rotation=m,this.reverse=f,this.expansion=g,this.mirror=y,this.primitiveLock=b,this.primitiveId=E,this.parentPrimitiveId=S}create(){return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){return this.primitiveId}getState_ParentPrimitiveId(){return this.parentPrimitiveId}getState_Layer(){return this.layer}getState_X(){return this.x}getState_Y(){return this.y}getState_Key(){return this.key}getState_Value(){return this.value}getState_KeyVisible(){return this.keyVisible}getState_ValueVisible(){return this.valueVisible}getState_FontFamily(){return this.fontFamily}getState_FontSize(){return this.fontSize}getState_LineWidth(){return this.lineWidth}getState_AlignMode(){return this.alignMode}getState_Rotation(){return this.rotation}getState_Reverse(){return this.reverse}getState_Expansion(){return this.expansion}getState_Mirror(){return this.mirror}getState_PrimitiveLock(){return this.primitiveLock}setState_Layer(t){return this.layer=t,this.async||this.done(),this}setState_X(t){return this.x=t,this.async||this.done(),this}setState_Y(t){return this.y=t,this.async||this.done(),this}setState_Key(t){return this.key=t,this.async||this.done(),this}setState_Value(t){return this.value=t,this.async||this.done(),this}setState_KeyVisible(t){return this.keyVisible=t,this.async||this.done(),this}setState_ValueVisible(t){return this.valueVisible=t,this.async||this.done(),this}setState_FontFamily(t){return this.fontFamily=t,this.async||this.done(),this}setState_FontSize(t){return this.fontSize=t,this.async||this.done(),this}setState_LineWidth(t){return this.lineWidth=t,this.async||this.done(),this}setState_AlignMode(t){return this.alignMode=t,this.async||this.done(),this}setState_Rotation(t){return this.rotation=t,this.async||this.done(),this}setState_Reverse(t){return this.reverse=t,this.async||this.done(),this}setState_Expansion(t){return this.expansion=t,this.async||this.done(),this}setState_Mirror(t){return this.mirror=t,this.async||this.done(),this}setState_PrimitiveLock(t){return this.primitiveLock=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveAttribute.getByIds",{primitiveIds:[t]}))[0];return this.setState_Layer(r.layerId),this.setState_X(r.position.x*10),this.setState_Y(r.position.y*10),this.setState_Key(r.key),this.setState_Value(r.value),this.setState_KeyVisible(r.showKey),this.setState_ValueVisible(r.showValue),this.setState_FontFamily(r.fontFamily),this.setState_FontSize(r.fontSize*10),this.setState_LineWidth(r.strokeWidth*10),this.setState_AlignMode(r.origin),this.setState_Rotation(r.rotation*180/Math.PI),this.setState_Reverse(r.reverse),this.setState_Expansion(r.reverseExpansion*10),this.setState_Mirror(r.mirror),this.setState_PrimitiveLock(r.locked),this}async done(){let{primitiveId:t,layer:i,x:r,y:n,key:s,value:a,keyVisible:o,valueVisible:l,fontFamily:u,fontSize:c,lineWidth:h,alignMode:m,rotation:f,reverse:g,expansion:y,mirror:b,primitiveLock:E}=this,S={layer:i,x:r,y:n,key:s,value:a,keyVisible:o,valueVisible:l,fontFamily:u,fontSize:c,lineWidth:h,alignMode:m,rotation:f,reverse:g,expansion:y,mirror:b,primitiveLock:E};if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveAttribute.modify",{primitiveId:t,data:S}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002");return this}};var og=class{async create(t,i,r,n,s,a,o,l,u,c){try{return await new uo(t,i,r,n,s,a,o,l,u,c).create()}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u4E8C\u8FDB\u5236\u5185\u5D4C\u5BF9\u8C61\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}}async delete(t){let i=[];typeof t=="string"?i.push(t):t instanceof uo?i.push(t.getState_PrimitiveId()):t[0]instanceof uo?i=t.map(n=>n.getState_PrimitiveId()):i=[...t];let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveObject.delete",{primitiveIds:i});return!0}async modify(t,i){typeof t=="string"&&(t=await this.get(t));let{topLeftX:r,topLeftY:n,layer:s,width:a,height:o,rotation:l,mirror:u,primitiveLock:c}=i;return t.isAsync()||t.toAsync(),r!==void 0&&t.setState_TopLeftX(r),n!==void 0&&t.setState_TopLeftY(n),s!==void 0&&t.setState_Layer(s),a!==void 0&&t.setState_Width(a),o!==void 0&&t.setState_Height(o),l!==void 0&&t.setState_Rotation(l),u!==void 0&&t.setState_Mirror(u),c!==void 0&&t.setState_PrimitiveLock(c),t.isAsync()?t.done():t.toSync(),t}async get(t){let i=[],r=!1;typeof t=="string"?(i.push(t),r=!0):i=[...t];let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveObject.getByIds",{primitiveIds:i});if(!n.length)return[];if(r){let s=n[0];return new uo(s.layerId,s.start.x,s.start.y,s.hashId,s.width,s.height,s.rotation,s.mirror,s.fileName,s.locked,s.globalIndex)}return n.map(s=>new uo(s.layerId,s.start.x,s.start.y,s.hashId,s.width,s.height,s.rotation,s.mirror,s.fileName,s.locked,s.globalIndex))}async getAllPrimitiveId(t,i){return(await this.getAll(t,i)).map(n=>n.getState_PrimitiveId())}async getAll(t,i){let r={};return typeof t<"u"&&(r.net=t),typeof i<"u"&&(r.primitiveLock=i),(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveObject.getAll",r)).map(s=>new uo(s.layerId,s.start.x,s.start.y,s.hashId,s.width,s.height,s.rotation,s.mirror,s.fileName,s.locked,s.globalIndex))}},uo=class{constructor(t,i,r,n,s,a,o=0,l=!1,u="",c=!1,h){this.async=!0;this.primitiveType="Object";this.layer=t,this.topLeftX=i,this.topLeftY=r,this.binaryData=n,this.width=s,this.height=a,this.rotation=o,this.mirror=l,this.fileName=u,this.primitiveLock=c,h&&(this.primitiveId=h)}async create(){this.setState_Layer(this.layer),this.setState_TopLeftX(this.topLeftX),this.setState_TopLeftY(this.topLeftY),this.setState_BinaryData(this.binaryData),this.setState_Width(this.width),this.setState_Height(this.height),this.setState_Rotation(this.rotation),this.setState_Mirror(this.mirror),this.setState_FileName(this.fileName);try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveObject.create",{layer:this.layer,topLeftX:this.topLeftX,topLeftY:this.topLeftY,binaryData:this.binaryData,width:this.width,height:this.height,rotation:this.rotation,mirror:this.mirror,fileName:this.fileName,primitiveLock:this.primitiveLock});this.primitiveId=t.primitiveId}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitiveObject.create() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PrimitiveObject \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_Layer(){return this.layer}getState_TopLeftX(){return this.topLeftX}getState_TopLeftY(){return this.topLeftY}getState_BinaryData(){return this.binaryData}getState_Width(){return this.width}getState_Height(){return this.height}getState_Rotation(){return this.rotation}getState_Mirror(){return this.mirror}getState_FileName(){return this.fileName}getState_PrimitiveLock(){return this.primitiveLock}setState_Layer(t){return this.layer=t,this.async||this.done(),this}setState_TopLeftX(t){return this.topLeftX=t,this.async||this.done(),this}setState_TopLeftY(t){return this.topLeftY=t,this.async||this.done(),this}setState_BinaryData(t){return this.binaryData=t,this.async||this.done(),this}setState_Width(t){return this.width=t,this.async||this.done(),this}setState_Height(t){return this.height=t,this.async||this.done(),this}setState_Rotation(t){return this.rotation=t,this.async||this.done(),this}setState_Mirror(t){return this.mirror=t,this.async||this.done(),this}setState_FileName(t){return this.fileName=t,this.async||this.done(),this}setState_PrimitiveLock(t){return this.primitiveLock=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveObject.getByIds",{primitiveIds:[t]}))[0];return this.setState_TopLeftX(r.topLeftX),this.setState_TopLeftY(r.topLeftY),this.setState_BinaryData(r.binaryData),this.setState_Width(r.width),this.setState_Height(r.height),this.setState_Layer(r.layer),this.setState_Mirror(r.mirror),this.setState_PrimitiveLock(r.locked),this}async done(){let{primitiveId:t,topLeftX:i,topLeftY:r,layer:n,width:s,height:a,rotation:o,mirror:l,primitiveLock:u}=this,c={topLeftX:i,topLeftY:r,layerId:n,width:s,height:a,rotation:o,mirror:l,primitiveLock:u};if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveObject.modify",{primitiveId:t,data:c}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002");return this}};var zu=class{async getFontsList(){try{return(await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FontManager.getFontsList")).map(i=>i.title)}catch{return[]}}async addFont(t){try{return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FontManager.addFont",t)}catch{return!1}}async deleteFont(t){try{return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FontManager.deleteFont",t)}catch{return!1}}};async function SD(e){return!!(await new zu().getFontsList()).includes(e)}var WE=(u=>(u[u.LEFT_TOP=1]="LEFT_TOP",u[u.LEFT_MIDDLE=2]="LEFT_MIDDLE",u[u.LEFT_BOTTOM=3]="LEFT_BOTTOM",u[u.CENTER_TOP=4]="CENTER_TOP",u[u.CENTER=5]="CENTER",u[u.CENTER_BOTTOM=6]="CENTER_BOTTOM",u[u.RIGHT_TOP=7]="RIGHT_TOP",u[u.RIGHT_MIDDLE=8]="RIGHT_MIDDLE",u[u.RIGHT_BOTTOM=9]="RIGHT_BOTTOM",u))(WE||{}),lg=class{async create(t,i,r,n,s,a,o,l,u,c,h,m,f){try{if(!SD(s))throw new Error("\u9519\u8BEF\uFF1A\u5B57\u4F53\u5217\u8868\u91CC\u6CA1\u6709\u8FD9\u79CD\u5B57\u4F53\u3002");return await new co(t,i,r,n,s,a,o,l,u,c,h,m,f).create()}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u6587\u672C\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}}async delete(t){let i=[];return typeof t=="string"?i.push(t):t instanceof co?i.push(t.getState_PrimitiveId()):t[0]instanceof co?i=t.map(n=>n.getState_PrimitiveId()):i=[...t],(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveString.delete",{primitiveIds:i})).length>0}async modify(t,i){typeof t=="string"&&(t=await this.get(t));let{layer:r,x:n,y:s,text:a,fontFamily:o,fontSize:l,lineWidth:u,alignMode:c,rotation:h,reverse:m,expansion:f,mirror:g,primitiveLock:y}=i;if(t.isAsync()||t.toAsync(),o!==void 0)if(await SD(o))t.setState_FontFamily(o);else throw new Error("\u9519\u8BEF\uFF1A\u5B57\u4F53\u5217\u8868\u91CC\u6CA1\u6709\u8FD9\u79CD\u5B57\u4F53\u3002");return r!==void 0&&t.setState_Layer(r),n!==void 0&&t.setState_X(n),s!==void 0&&t.setState_Y(s),a!==void 0&&t.setState_Text(a),l!==void 0&&t.setState_FontSize(l),u!==void 0&&t.setState_LineWidth(u),c!==void 0&&t.setState_AlignMode(c),h!==void 0&&t.setState_Rotation(h),m!==void 0&&t.setState_Reverse(m),f!==void 0&&t.setState_Expansion(f),g!==void 0&&t.setState_Mirror(g),y!==void 0&&t.setState_PrimitiveLock(y),t.isAsync()?t.done():t.toSync(),t}async get(t){let i=[],r=!1;typeof t=="string"?(i.push(t),r=!0):i=[...t];let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveString.getByIds",{primitiveIds:i});if(!n.length)return[];if(r){let s=n[0];return new co(s.layerId,s.position.x*10,s.position.y*10,s.value,s.fontFamily,s.fontSize*10,s.strokeWidth*10,s.origin,s.rotation*180/Math.PI,s.reverse,s.reverseExpansion*10,s.mirror,s.locked,s.globalIndex)}return n.map(s=>new co(s.layerId,s.position.x*10,s.position.y*10,s.value,s.fontFamily,s.fontSize*10,s.strokeWidth*10,s.origin,s.rotation*180/Math.PI,s.reverse,s.reverseExpansion*10,s.mirror,s.locked,s.globalIndex))}async getAllPrimitiveId(t,i){return(await this.getAll(t,i)).map(n=>n.getState_PrimitiveId())}async getAll(t,i){let r={};return typeof t<"u"&&(r.layer=t),typeof i<"u"&&(r.primitiveLock=i),(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveString.getAll",r)).map(s=>new co(s.layerId,s.position.x*10,s.position.y*10,s.value,s.fontFamily,s.fontSize*10,s.strokeWidth*10,s.origin,s.rotation*180/Math.PI,s.reverse,s.reverseExpansion*10,s.mirror,s.locked,s.globalIndex))}},co=class{constructor(t,i,r,n,s="default",a=120,o=8,l=3,u=0,c=!1,h=0,m=!1,f=!1,g){this.async=!0;this.primitiveType="String";this.layer=t,this.x=i,this.y=r,this.text=n,this.fontFamily=s,this.fontSize=a,this.lineWidth=o,this.alignMode=l,this.rotation=u,this.reverse=c,this.expansion=h,this.mirror=m,this.primitiveLock=f,g&&(this.primitiveId=g)}async create(){this.setState_Layer(this.layer),this.setState_X(this.x),this.setState_Y(this.y),this.setState_Text(this.text),this.setState_FontFamily(this.fontFamily),this.setState_FontSize(this.fontSize),this.setState_LineWidth(this.lineWidth),this.setState_AlignMode(this.alignMode),this.setState_Rotation(this.rotation),this.setState_Reverse(this.reverse),this.setState_Expansion(this.expansion),this.setState_Mirror(this.mirror),this.setState_PrimitiveLock(this.primitiveLock);try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveString.create",{layer:this.layer,x:this.x,y:this.y,text:this.text,fontFamily:this.fontFamily,fontSize:this.fontSize,lineWidth:this.lineWidth,alignMode:this.alignMode,rotation:this.rotation,reverse:this.reverse,expansion:this.expansion,mirror:this.mirror,primitiveLock:this.primitiveLock});this.primitiveId=t.primitiveId}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PCB_PrimitiveString.create() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PCB_PrimitiveString \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_Layer(){return this.layer}getState_X(){return this.x}getState_Y(){return this.y}getState_Text(){return this.text}getState_FontFamily(){return this.fontFamily}getState_FontSize(){return this.fontSize}getState_LineWidth(){return this.lineWidth}getState_AlignMode(){return this.alignMode}getState_Rotation(){return this.rotation}getState_Reverse(){return this.reverse}getState_Expansion(){return this.expansion}getState_Mirror(){return this.mirror}getState_PrimitiveLock(){return this.primitiveLock}setState_Layer(t){return this.layer=t,this.async||this.done(),this}setState_X(t){return this.x=t,this.async||this.done(),this}setState_Y(t){return this.y=t,this.async||this.done(),this}setState_Text(t){return this.text=t,this.async||this.done(),this}setState_FontFamily(t){return this.fontFamily=t,this.async||this.done(),this}setState_FontSize(t){return this.fontSize=t,this.async||this.done(),this}setState_LineWidth(t){return this.lineWidth=t,this.async||this.done(),this}setState_AlignMode(t){return this.alignMode=t,this.async||this.done(),this}setState_Rotation(t){return this.rotation=t,this.async||this.done(),this}setState_Reverse(t){return this.reverse=t,this.async||this.done(),this}setState_Expansion(t){return this.expansion=t,this.async||this.done(),this}setState_Mirror(t){return this.mirror=t,this.async||this.done(),this}setState_PrimitiveLock(t){return this.primitiveLock=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveString.getByIds",{primitiveIds:[t]}))[0];return this.setState_Layer(r.layerId),this.setState_X(r.position.x*10),this.setState_Y(r.position.y*10),this.setState_Text(r.value),this.setState_FontFamily(r.fontFamily),this.setState_FontSize(r.fontSize*10),this.setState_LineWidth(r.strokeWidth*10),this.setState_AlignMode(r.origin),this.setState_Rotation(r.rotation*180/Math.PI),this.setState_Reverse(r.reverse),this.setState_Expansion(r.reverseExpansion*10),this.setState_Mirror(r.mirror),this.setState_PrimitiveLock(r.locked),this}async done(){let{primitiveId:t,layer:i,x:r,y:n,text:s,fontFamily:a,fontSize:o,lineWidth:l,alignMode:u,rotation:c,reverse:h,expansion:m,mirror:f,primitiveLock:g}=this,y={layer:i,x:r,y:n,text:s,fontFamily:a,fontSize:o,lineWidth:l,alignMode:u,rotation:c,reverse:h,expansion:m,mirror:f,primitiveLock:g};if(!await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_PrimitiveString.modify",{primitiveId:t,data:y}))throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u53C2\u6570\u4E0D\u6B63\u786E\uFF0C\u65E0\u6CD5\u5E94\u7528\u5230\u753B\u5E03\u3002");return this}};var ug=class{async getAllSelectedPrimitives_PrimitiveId(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_SelectControl.getAllSelectedPrimitiveIds",{})}async getAllSelectedPrimitives(){let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_SelectControl.getAllSelectedPrimitives",{}),i=[];for(let r of t)switch(r.pcbItemPrimitiveType){case"Via":i.push(new bi(r.net,r.center.x*10,r.center.y*10,r.holeRadius*2*10,r.radius*2*10,r.type,r.name,{topSolderMask:r.topExpansion,bottomSolderMask:r.bottomExpansion},r.locked,r.globalIndex));break;case"Pad":{i.push(new Ur(r.layerId,r.num,r.center.x*10,r.center.y*10,r.rotation*180/Math.PI,r.defaultPadShapeAspect,r.net,r.holeAspect,r.holeOffset.x,r.holeOffset.y,r.holeRotation,r.plated,r.type,r.specialPadShapeAspect,{topSolderMask:r.topSolderExpansion,bottomSolderMask:r.bottomSolderExpansion},null,r.locked,r.globalIndex));break}case"Component":{i.push(new Qr({libraryUuid:r.device.name,uuid:r.device.uuid},r.layerId,r.position.x*10,r.position.y*10,r.rotation*180/Math.PI,r.locked,r.attrsMap["Add into BOM"],r.globalIndex,{libraryUuid:r.footprint.id,uuid:r.footprint.uuid},{libraryUuid:r.attrsMap["3D Model Title"],uuid:r.attrsMap["3D Model"]},r.attrsMap.Designator,r.pads,r.attrsMap.Name,r.attrsMap["Unique ID"],r.attrsMap.Manufacturer,r.attrsMap["Manufacturer Part"],r.attrsMap.Supplier,r.attrsMap["Supplier Part"]));break}case"Rect":{i.push(new jt(r.layerId,new ft(["R",r.start.x*10,r.start.y*10,r.width*10,r.height*10,r.rotation*180/Math.PI,r.cornerRadius*10]),r.regionRuleSelector,r.type,r.strokeWidth,r.locked,r.globalIndex));break}case"Circle":{i.push(new jt(r.layerId,new ft(["CIRCLE",r.center.x*10,r.center.y*10,r.radius*10]),r.regionRuleSelector,r.type,r.strokeWidth,r.locked,r.globalIndex));break}case"Polygon":{let n=r.pathString?r.pathString:[];r.type!=="Line"?i.push(new jt(r.layerId,new ft(n[0]),r.regionRuleSelector,r.type,r.strokeWidth,r.locked,r.globalIndex)):i.push(new ki(r.net,r.layerId,new ft(n[0]),r.strokeWidth,r.locked,r.globalIndex));break}case"Image":{i.push(new tn(r.start.x*10,r.start.y*10,r.pathString?[r.pathString]:[],r.layerId,r.width*10,r.height*10,r.rotation*180/Math.PI,r.mirror,r.locked,r.globalIndex));break}case"Length Dimension":case"Protractor Dimension":case"Radius Dimension":{i.push(new en(r.dimensionType,r.coordinateSet,r.layerId,r.unit,r.width*10,r.precision,r.locked,r.globalIndex));break}case"Track":i.push(new Ci(r.net,r.layerId,r.startX*10,r.startY*10,r.endX*10,r.endY*10,r.width*10,r.locked,r.globalIndex));break;case"ArcTrack":i.push(new xi(r.net,r.layerId,r.startX*10,r.startY*10,r.endX*10,r.endY*10,r.arcAngle*180/Math.PI,r.width*10,r.arcType,r.locked,r.globalIndex));break;case"Text":break;default:break}return i}async getSelectedPrimitives(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_SelectControl.getAllSelectedPrimitives",{})}async doSelectPrimitives(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_SelectControl.doSelectPrimitives",{primitiveIds:t})}async doCrossProbeSelect(t,i,r,n=!0,s=!0){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_SelectControl.doCrossProbeSelect",{components:t,pins:i,nets:r,highlight:n,select:s})}async doCrossProbeSelectByObject(t,i,r){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_SelectControl.doCrossProbeSelectByObject",{components:t,pins:i,nets:r})}async clearSelected(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_SelectControl.clearSelected",{})}async getCurrentMousePosition(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PCB_SelectControl.getCurrentMousePosition")}};var cg=class{async save(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.PNL_Document.save")}};var dg=class{async importChanges(){try{return(await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_Document.importChanges")).success}catch{return!1}}async save(){try{return(await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_Document.save")).success}catch{return!1}}async navigateToCoordinates(t,i){return!1}async navigateToRegion(t,i,r,n){return!1}getPrimitiveAtPoint(t,i){}getPrimitivesInRegion(t,i,r,n){return[]}async getCurrentFilterConfiguration(){}};var hg=class{async check(t=!0,i=!1){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_Drc.check",{userInterface:i,strict:t})}};var zE=(i=>(i.SELECTED="selected",i.CLEAR_SELECTED="clearSelected",i))(zE||{}),VE=(n=>(n.DELETE="delete",n.CREATE="create",n.MOVE="move",n.CHANGE="change",n))(VE||{}),pg=class{addMouseEventListener(t,i,r,n=!1){for(let s of _.extensionSCH_Events)if(t===s.id)return;typeof r=="function"&&_.extensionSCH_Events.push({id:t,event:"mouse",eventType:i,callFn:r,onlyOnce:n})}addPrimitiveEventListener(t,i,r,n=!1){for(let s of _.extensionSCH_Events)if(t===s.id)return;typeof r=="function"&&_.extensionSCH_Events.push({id:t,event:"primitive",eventType:i,callFn:r,onlyOnce:n})}removeEventListener(t){for(let[i,r]of _.extensionSCH_Events.entries())if(t===r.id)return _.extensionSCH_Events.splice(i,1),!0;return!1}isEventListenerAlreadyExist(t){for(let i of _.extensionSCH_Events)if(t===i.id)return!0;return!1}};var fg=class{async getAssemblyVariantsConfigs(){return[]}async getBomFile(t,i="xlsx",r,n,s,a,o,l){let u=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_ManufactureData.getBomFile",{fileName:t,fileType:i,template:r,filterOptions:n,statistics:s,property:a,columns:o});if(typeof u=="object"&&u!==null&&u.file)return u.file}async getNetlistFile(t,i="JLCEDA"){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_ManufactureData.getNetlistFile",{netlistType:i,fileName:t})}async placeComponentsOrder(t=!1,i=!1){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_ManufactureData.placeComponentsOrder",{interactive:t,ignoreWarning:i})}async placeSmtComponentsOrder(t=!1,i=!1){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_ManufactureData.placeSmtComponentsOrder",{interactive:t,ignoreWarning:i})}};var th=Hn(yg());function Ln(e=!1,t){if(_.messageBus)return _.messageBus;if(window._MSG_BUS_)return _.messageBus=window._MSG_BUS_,_.messageBus;if(e)return window._MSG_BUS_=new th.MessageBus(typeof t>"u"?!window.frameElement:t),_.messageBus=window._MSG_BUS_,_.messageBus;throw new Error("\u9519\u8BEF\uFF1A\u6307\u5B9A\u6D88\u606F\u603B\u7EBF\uFF08MessageBus\uFF09\u672A\u521D\u59CB\u5316\uFF01")}function Sa(e=!1,t){if(_.windowMessageBridge)return _.windowMessageBridge;if(window._MSG_BUS_WIN_)return _.windowMessageBridge=window._MSG_BUS_WIN_,_.windowMessageBridge;{let i=Ln(e,t);if(i)return window._MSG_BUS_WIN_=new th.WindowMessageBridge(i),_.windowMessageBridge=window._MSG_BUS_WIN_,_.windowMessageBridge;throw new Error("\u9519\u8BEF\uFF1A\u6307\u5B9A\u6D88\u606F\u603B\u7EBF\uFF08MessageBus->WindowMessageBridge\uFF09\u672A\u521D\u59CB\u5316\uFF01")}}var _g=class{async getNetlist(t="JLCEDA"){let i=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_Netlist.getNetlist",t),r;if(t==="JLCEDA"||t==="EasyEDA"){let n=[];for(let s of i){let a=JSON.parse(s);for(let o of Object.keys(a.version?a.components:a)){let l=(await Sa().rpcCall("/PrjDB/footprint/getDisplayTitleById",a.version?[a.components[o].props.Footprint]:[a[o].props.Footprint],An())).message;a.version?a.components[o].props["Footprint Name"]=l:a[o].props["Footprint Name"]=l}n.push(JSON.stringify(a))}r=n.join(`
`)}else Array.isArray(i)?r=i.join(""):r=i;return r}async setNetlist(t="JLCEDA",i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_Netlist.setNetlist",{type:t,netlist:i})}};var an=(f=>(f.ARC="Arc",f.BUS="Bus",f.CIRCLE="Circle",f.COMPONENT="Component",f.COMPONENT_PIN="ComponentPin",f.PIN="Pin",f.POLYGON="Polygon",f.RECTANGLE="Rectangle",f.TEXT="Text",f.WIRE="Wire",f.OBJECT="Object",f.BEZIER="Bezier",f.ELLIPSE="Ellipse",f))(an||{}),tS=(n=>(n[n.SOLID=0]="SOLID",n[n.DASHED=1]="DASHED",n[n.DOTTED=2]="DOTTED",n[n.DOT_DASHED=3]="DOT_DASHED",n))(tS||{}),iS=(l=>(l.NONE="None",l.SOLID="Solid",l.GRID="Grid",l.HORIZONTAL_LINE="Horizontal Line",l.VERTICAL_LINE="Vertical Line",l.RHOMBIC_GRID="Rhombic Grid",l.LEFT_SLASH_LINE="Left Slash Line",l.RIGHT_SLASH_LINE="Right Slash Line",l))(iS||{}),bg=class{async getPrimitiveTypeByPrimitiveId(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_Primitive.getPrimitiveTypeByPrimitiveId",t)}async getPrimitiveByPrimitiveId(t){let i=await this.getPrimitiveTypeByPrimitiveId(t),r;switch(i){case"Arc":r=await be.sch_PrimitiveArc.get(t);break;case"Bus":r=await be.sch_PrimitiveBus.get(t);break;case"Circle":r=await be.sch_PrimitiveCircle.get(t);break;case"Component":r=await be.sch_PrimitiveComponent.get(t);break;case"Pin":r=await be.sch_PrimitivePin.get(t);break;case"Polygon":r=await be.sch_PrimitivePolygon.get(t);break;case"Rectangle":r=await be.sch_PrimitiveRectangle.get(t);break;case"Text":r=await be.sch_PrimitiveText.get(t);break;case"Wire":r=await be.sch_PrimitiveWire.get(t);break}return r}async getPrimitivesByPrimitiveId(t){let i=[];for(let r of t){let n=await this.getPrimitiveByPrimitiveId(r);n&&i.push(n)}return i}async getPrimitivesBBox(t){if(!t)return;let i=[];for(let r of t)typeof r=="string"?i.push(r):i.push(r.getState_PrimitiveId());return await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_Primitive.getPrimitivesBBox",i)}};var Pg=class{async create(t,i,r,n,s,a,o,l,u,c){return await new Bs(t,i,r,n,s,a,o,l,u,c).create()}async delete(t){if(!t)return!1;let i=[];return Array.isArray(t)?i=t.map(r=>typeof r=="string"?r:r.getState_PrimitiveId()):t instanceof Bs?i.push(t.getState_PrimitiveId()):i.push(t),await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveArc.delete",i)}async modify(t,i){return typeof t=="string"&&(t=await this.get(t)),t.isAsync()||t.toAsync(),i.startX!==void 0&&t.setState_StartX(i.startX),i.startY!==void 0&&t.setState_StartY(i.startY),i.referenceX!==void 0&&t.setState_ReferenceX(i.referenceX),i.referenceY!==void 0&&t.setState_ReferenceY(i.referenceY),i.endX!==void 0&&t.setState_EndX(i.endX),i.endY!==void 0&&t.setState_EndY(i.endY),i.color!==void 0&&t.setState_Color(i.color),i.fillColor!==void 0&&t.setState_FillColor(i.fillColor),i.lineWidth!==void 0&&t.setState_LineWidth(i.lineWidth),i.lineType!==void 0&&t.setState_LineType(i.lineType),t.isAsync()?t.done():t.toSync(),t}async get(t){let i=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveArc.get",t);if(i){if(Array.isArray(i))return i.map(r=>new Bs(r.x1,r.y1,r.x3,r.y3,r.x2,r.y2,r.strokeColor,r.fillColor,r.strokeWidth,r.strokeStyle,r.gId));{let r=i;return new Bs(r.x1,r.y1,r.x3,r.y3,r.x2,r.y2,r.strokeColor,r.fillColor,r.strokeWidth,r.strokeStyle,r.gId)}}}async getAllPrimitiveId(){return(await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveArc.getAll","arc")).map(i=>i.gId)}async getAll(){return(await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveArc.getAll","arc")).map(i=>new Bs(i.x1,i.y1,i.x3,i.y3,i.x2,i.y2,i.strokeColor,i.fillColor,i.strokeWidth,i.strokeStyle,i.gId))}},Bs=class{constructor(t,i,r,n,s,a,o=null,l=null,u=null,c=null,h){this.async=!0;this.primitiveType="Arc";this.startX=t,this.startY=i,this.referenceX=r,this.referenceY=n,this.endX=s,this.endY=a,this.color=o,this.fillColor=l,this.lineWidth=u,this.lineType=c,h&&(this.primitiveId=h)}async create(){this.setState_StartX(this.startX),this.setState_StartY(this.startY),this.setState_ReferenceX(this.referenceX),this.setState_ReferenceY(this.referenceY),this.setState_EndX(this.endX),this.setState_EndY(this.endY),this.setState_Color(this.color),this.setState_FillColor(this.fillColor),this.setState_LineWidth(this.lineWidth),this.setState_LineType(this.lineType);let{startX:t,startY:i,referenceX:r,referenceY:n,endX:s,endY:a,color:o,fillColor:l,lineWidth:u,lineType:c}=this,h=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveArc.create",{x1:t,x2:r,x3:s,y1:i,y2:n,y3:a});return this.primitiveId=h,(o||l||u||c)&&this.done(),this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728\u539F\u7406\u56FE\u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_StartX(){return this.startX}getState_StartY(){return this.startY}getState_ReferenceX(){return this.referenceX}getState_ReferenceY(){return this.referenceY}getState_EndX(){return this.endX}getState_EndY(){return this.endY}getState_Color(){return this.color}getState_FillColor(){return this.fillColor}getState_LineWidth(){return this.lineWidth}getState_LineType(){return this.lineType}setState_StartX(t){if(Number.isNaN(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.startX=t,this.async||this.done(),this}setState_StartY(t){if(Number.isNaN(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.startY=t,this.async||this.done(),this}setState_ReferenceX(t){if(Number.isNaN(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.referenceX=t,this.async||this.done(),this}setState_ReferenceY(t){if(Number.isNaN(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.referenceY=t,this.async||this.done(),this}setState_EndX(t){if(Number.isNaN(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.endX=t,this.async||this.done(),this}setState_EndY(t){if(Number.isNaN(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.endY=t,this.async||this.done(),this}setState_Color(t){if(!xe.checkString(t)&&!xe.checkNull(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.color=t,this.async||this.done(),this}setState_FillColor(t){if(!xe.checkString(t)&&!xe.checkNull(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.fillColor=t,this.async||this.done(),this}setState_LineWidth(t){if(!xe.checkIntegerNum(t)&&!xe.checkNull(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.lineWidth=t,this.async||this.done(),this}setState_LineType(t){if(!xe.checkIntegerNum(t)&&!xe.checkNull(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.lineType=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,i=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveArc.get",t);return this.setState_StartX(i.x1),this.setState_StartY(i.y1),this.setState_ReferenceX(i.x2),this.setState_ReferenceY(i.y2),this.setState_EndX(i.x3),this.setState_EndY(i.y3),this.setState_Color(i.strokeColor),this.setState_FillColor(i.fillColor),this.setState_LineWidth(i.strokeWidth),this.setState_LineType(i.strokeStyle),this}async done(){let{primitiveId:t,startX:i,startY:r,endX:n,endY:s,referenceX:a,referenceY:o,color:l,fillColor:u,lineWidth:c,lineType:h}=this,m={id:t,modify:{x1:{value:i},x2:{value:a},x3:{value:n},y1:{value:r},y2:{value:o},y3:{value:s},strokeColor:{value:l},fillColor:{value:u},strokeWidth:{value:c},strokeStyle:{value:h}}};for(let f in m.modify)m.modify[f].value===void 0&&delete m.modify[f];return _.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitiveArc.modify",m),this}};var Eg=class{async create(t,i,r,n,s){return await new es(t,i,r,n,s).create()}async delete(t){let i=!1,r=(Array.isArray(t)?t:[t]).map(n=>n instanceof es?n.getState_PrimitiveId():n);try{_.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitiveBus.delete",{data:r,getter:n=>{i=n}})}catch{return!1}return i}async modify(t,i){try{let r;return t instanceof es?(r=t,i.color!==void 0&&t.setState_Color(i.color),i.line!==void 0&&t.setState_Line(i.line),i.lineType!==void 0&&t.setState_LineType(i.lineType),i.lineWidth!==void 0&&t.setState_LineWidth(i.lineWidth),i.busName!==void 0&&t.setState_BusName(i.busName)):r=new es(i.busName,i.line,i.color,i.lineWidth,i.lineType,t),r.isAsync()&&r.done(),r}catch{return}}async get(t){let i;try{_.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitiveBus.get",{data:t,getter:n=>{i=n}})}catch{}if(typeof i>"u"&&(i=[]),!i.length)return;let r=i.map(n=>{if(n)return new es(n.net,n.line,n.color,n.lineWidth,n.lineType,n.id)});return Array.isArray(t)?r:r[0]}async getAllPrimitiveId(){let t=[];try{_.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitiveBus.getAllPrimitiveId",{getter:i=>{t=i}})}catch{}return t}async getAll(){let t=[];try{_.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitiveBus.getAll",{getter:i=>{t=i}})}catch{}return t.map(({line:i,lineType:r,lineWidth:n,color:s,net:a,id:o})=>new es(a,i,s,n,r,o))}},es=class{constructor(t,i,r=null,n=null,s=null,a){this.async=!0;this.primitiveType="Bus";this.busName=t,this.line=i,this.color=r,this.lineWidth=n,this.lineType=s,a&&(this.primitiveId=a)}async create(){this.setState_BusName(this.busName),this.setState_Line(this.line),this.setState_Color(this.color),this.setState_LineWidth(this.lineWidth),this.setState_LineType(this.lineType);let t;try{if(_.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitiveBus.create",{data:{line:this.line,net:this.busName,color:this.color,lineWidth:this.lineWidth,lineType:this.lineType},getter:i=>{t=i}}),t)this.primitiveId=t.id,this.line=t.line,this.color=t.color,this.lineType=t.lineType,this.lineWidth=t.lineWidth;else throw new Error("create failed!")}catch{throw new Error("create failed!")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728\u539F\u7406\u56FE\u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_BusName(){return this.busName}getState_Line(){return this.line}getState_Color(){return this.color}getState_LineWidth(){return this.lineWidth}getState_LineType(){return this.lineType}setState_BusName(t){return this.busName=t.toUpperCase(),this.async||this.done(),this}setState_Line(t){return this.line=t,this.async||this.done(),this}setState_Color(t){return this.color=t,this.async||this.done(),this}setState_LineWidth(t){return(t===null||t>=1&&t<=10)&&(this.lineWidth=t,this.async||this.done()),this}setState_LineType(t){return(t===null||t>=0&&t<=3)&&(this.lineType=t,this.async||this.done()),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){return this}async done(){let t;if(_.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitiveBus.modify",{data:{primitiveId:this.primitiveId,line:this.line,net:this.busName,color:this.color,lineWidth:this.lineWidth,lineType:this.lineType},getter:i=>{t=i}}),!t)throw new Error("modify failed!");return this.primitiveId=t.id,this.line=t.line,this.lineWidth=t.lineWidth,this.lineType=t.lineType,this.color=t.color,this.busName=t.net,this}};var Sg=class{async create(t,i,r,n,s,a,o,l){return await new Os(t,i,r,n,s,a,o,l).create()}async delete(t){let i=[];return Array.isArray(t)?i=t.map(r=>typeof r=="string"?r:r.getState_PrimitiveId()):t instanceof Os?i.push(t.getState_PrimitiveId()):i.push(t),await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveCircle.delete",i)}async modify(t,i){return typeof t=="string"&&(t=await this.get(t)),t.isAsync()||t.toAsync(),i.centerX!==void 0&&t.setState_CenterX(i.centerX),i.centerY!==void 0&&t.setState_CenterY(i.centerY),i.radius!==void 0&&t.setState_Radius(i.radius),i.color!==void 0&&t.setState_Color(i.color),i.fillColor!==void 0&&t.setState_FillColor(i.fillColor),i.lineWidth!==void 0&&t.setState_LineWidth(i.lineWidth),i.lineType!==void 0&&t.setState_LineType(i.lineType),i.fillStyle!==void 0&&t.setState_FillStyle(i.fillStyle),t.isAsync()?t.done():t.toSync(),t}async get(t){let i=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveCircle.get",t);if(i){if(Array.isArray(i))return i.map(r=>new Os(r.cx,r.cy,r.r,r.strokeColor,r.fillColor,r.strokeWidth,r.strokeStyle,void 0,r.gId));{let r=i;return new Os(r.cx,r.cy,r.r,r.strokeColor,r.fillColor,r.strokeWidth,r.strokeStyle,void 0,r.gId)}}}async getAllPrimitiveId(){return(await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveCircle.getAll","circle")).map(i=>i.gId)}async getAll(){return(await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveCircle.getAll","circle")).map(i=>new Os(i.cx,i.cy,i.r,i.strokeColor,i.fillColor,i.strokeWidth,i.strokeStyle,void 0,i.gId))}},Os=class{constructor(t,i,r,n=null,s=null,a=null,o=null,l=null,u){this.async=!0;this.primitiveType="Circle";this.centerX=t,this.centerY=i,this.radius=r,this.color=n,this.fillColor=s,this.lineWidth=a,this.lineType=o,this.fillStyle=l,u&&(this.primitiveId=u)}async create(){this.setState_CenterX(this.centerX),this.setState_CenterY(this.centerY),this.setState_Radius(this.radius),this.setState_Color(this.color),this.setState_FillColor(this.fillColor),this.setState_LineWidth(this.lineWidth),this.setState_LineType(this.lineType),this.setState_FillStyle(this.fillStyle);let{centerX:t,centerY:i,radius:r,color:n,fillColor:s,lineWidth:a,lineType:o,fillStyle:l}=this,u=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveCircle.create",{cx:t,cy:i,r});return this.primitiveId=u,(n||s||a||o||l)&&this.done(),this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728\u539F\u7406\u56FE\u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_CenterX(){return this.centerX}getState_CenterY(){return this.centerY}getState_Radius(){return this.radius}getState_Color(){return this.color}getState_FillColor(){return this.fillColor}getState_LineWidth(){return this.lineWidth}getState_LineType(){return this.lineType}getState_FillStyle(){return this.fillStyle}setState_CenterX(t){if(!xe.checkIntegerNum(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.centerX=t,this.async||this.done(),this}setState_CenterY(t){if(!xe.checkIntegerNum(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.centerY=t,this.async||this.done(),this}setState_Radius(t){if(!xe.checkIntegerNum(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.radius=t,this.async||this.done(),this}setState_Color(t){if(!xe.checkString(t)&&!xe.checkNull(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.color=t,this.async||this.done(),this}setState_FillColor(t){if(!xe.checkString(t)&&!xe.checkNull(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.fillColor=t,this.async||this.done(),this}setState_LineWidth(t){if(!xe.checkIntegerNum(t)&&!xe.checkNull(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.lineWidth=t,this.async||this.done(),this}setState_LineType(t){if(!xe.checkIntegerNum(t)&&!xe.checkNull(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.lineType=t,this.async||this.done(),this}setState_FillStyle(t){return this.fillStyle=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){let{primitiveId:t}=this,i=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveCircle.get",t);return this.centerX=i.cx,this.centerY=i.cy,this.radius=i.r,this.color=i.strokeColor,this.lineWidth=i.strokeWidth,this.fillColor=i.fillColor,this.lineType=i.strokeStyle,this}done(){let{primitiveId:t,centerX:i,centerY:r,radius:n,color:s,fillColor:a,lineWidth:o,lineType:l,fillStyle:u}=this,c={id:t,modify:{x:{value:i},y:{value:r},r:{value:n},strokeColor:{value:s},fillColor:{value:a},fillStyle:{value:u},strokeWidth:{value:o},strokeStyle:{value:l}}};for(let h in c.modify)c.modify[h].value===void 0&&delete c.modify[h];return _.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitiveCircle.modify",c),this}};var rS=(n=>(n.NONE="None",n.INVERTED="Inverted",n.CLOCK="Clock",n.INVERTED_CLOCK="Inverted Clock",n))(rS||{}),nS=(h=>(h.IN="IN",h.OUT="OUT",h.BI="BI",h.PASSIVE="Passive",h.OPEN_COLLECTOR="Open Collector",h.OPEN_EMITTER="Open Emitter",h.POWER="Power",h.GROUND="Ground",h.HIZ="HIZ",h.TERMINATOR="Terminator",h.UNDEFINED="Undefined",h))(nS||{}),vg=class{async create(t,i,r,n,s,a,o,l,u){try{return await new on(t,i,r,n,s,a,o,l,u).create()}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u5F15\u811A\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}}async delete(t){try{let i=new Set;return Array.isArray(t)?t.forEach(r=>{r instanceof on&&i.add(r.getState_PrimitiveId()),typeof r=="string"&&i.add(r)}):(typeof t=="string"&&i.add(t),t instanceof on&&i.add(t.getState_PrimitiveId())),i.size>0?await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitivePin.delete",[...i]):!1}catch{throw new Error("\u9519\u8BEF\uFF1A\u5220\u9664\u64CD\u4F5C\u65E0\u6CD5\u6B63\u786E\u6267\u884C\uFF0C\u53EF\u80FD\u662F\u56FE\u5143\u7684 ID \u4E0D\u6B63\u786E\u6216\u6570\u636E\u683C\u5F0F\u9519\u8BEF\u3002")}}async modify(t,i){try{if(typeof t=="string"){let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitivePin.getPinJson",[t])||{};if(r){let{head:n={},attrPara:s={}}=r,a=Nn("Pin Type",s,"value"),{pinColor:o,x:l,y:u,rotation:c,length:h,pinShape:m}=n;t=new on(l,u,Nn("Pin Number",s,"value"),Nn("Pin Name",s,"value"),c,h,o,m,a,t)}}if(t instanceof on){let r=t.isAsync();return r||t.toAsync(),i.x!==void 0&&t.setState_X(i.x),i.y!==void 0&&t.setState_Y(i.y),i.pinNumber!==void 0&&t.setState_PinNumber(i.pinNumber),i.pinName!==void 0&&t.setState_PinName(i.pinName),i.rotation!==void 0&&t.setState_Rotation(i.rotation),i.pinLength!==void 0&&t.setState_PinLength(i.pinLength),i.pinColor!==void 0&&t.setState_PinColor(i.pinColor),i.pinShape!==void 0&&t.setState_PinShape(i.pinShape),i.pinType!==void 0&&t.setState_PinType(i.pinType),r?t.done():t.toSync(),t}}catch(r){throw new Error(r)}}async get(t){try{let i=new Set(Array.isArray(t)?t:[t]);if(i.size>0){let r=[];for(let n of i.keys()){let s=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitivePin.getPinJson",[n])||{};if(s){let{head:a={},attrPara:o={}}=s,l=Nn("Pin Type",o,"value"),{pinColor:u,x:c,y:h,rotation:m,length:f,pinShape:g}=a,y=new on(c,-h,Nn("Pin Number",o,"value"),Nn("Pin Name",o,"value"),m,f,u,g,l,n);r.push(y)}}return r.length>0?Array.isArray(t)?r:r[0]:[]}}catch(i){throw new Error(i)}}async getAllPrimitiveId(){try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitivePin.getAllPrimitiveId"),i=[];return t?(t.forEach(r=>{var n;i.push(...Object.keys(((n=r.shapes)==null?void 0:n.pin)||{}))}),i):[]}catch(t){throw new Error(t)}}async getAll(){try{let t=[],i=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitivePin.getAllPrimitiveId");return i?(i.forEach(r=>{let n=r.shapes.pin;Object.keys(n).forEach(s=>{let a=n[s];if(a){let{head:o={},attrPara:l={}}=a,u=Nn("Pin Type",l,"value"),{pinColor:c,x:h,y:m,rotation:f,length:g,pinShape:y}=o,b=new on(h,-m,Nn("Pin Number",l,"value"),Nn("Pin Name",l,"value"),f,g,c,y,u,s);t.push(b)}})}),t):[]}catch{return[]}}};function Nn(e,t,i){return Object.values(t).find(n=>n.key===e)[i]}var on=class{constructor(t,i,r,n="",s=0,a=20,o=null,l="None",u="Undefined",c,h){this.async=!0;this.primitiveType="Pin";this.x=t,this.y=i,this.pinNumber=r,this.pinName=n,this.rotation=s,this.pinLength=a,this.pinColor=o,this.pinShape=l,this.pinType=u,c&&(this.primitiveId=c,this.otherProperty=h)}async create(){this.setState_X(this.x),this.setState_Y(this.y),this.setState_PinNumber(this.pinNumber),this.setState_PinName(this.pinName),this.setState_Rotation(this.rotation),this.setState_PinLength(this.pinLength),this.setState_PinColor(this.pinColor),this.setState_PinShape(this.pinShape),this.setState_PinType(this.pinType);try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitivePin.create",{x:this.x,y:this.y,pinNumber:this.pinNumber,pinName:this.pinName,rotation:this.rotation,pinLength:this.pinLength,pinColor:this.pinColor,pinShape:this.pinShape,pinType:this.pinType});this.primitiveId=t}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u5F15\u811A\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(!this.primitiveId)throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728\u539F\u7406\u56FE\u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002");return this.primitiveId}getState_X(){return this.x}getState_Y(){return this.y}getState_PinNumber(){return this.pinNumber}getState_PinName(){return this.pinName}getState_Rotation(){return this.rotation}getState_PinLength(){return this.pinLength}getState_PinColor(){return this.pinColor}getState_PinShape(){return this.pinShape}getState_pinType(){return this.pinType}getState_OtherProperty(){return this.otherProperty}setState_X(t){if(!xe.checkNum(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitivePin.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.x=t,this.async||this.done(),this}setState_Y(t){if(!xe.checkNum(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitivePin.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.y=t,this.async||this.done(),this}setState_PinNumber(t){if(!xe.checkString(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitivePin.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.pinNumber=t,this.async||this.done(),this}setState_PinName(t){if(!xe.checkString(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitivePin.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.pinName=t,this.async||this.done(),this}setState_Rotation(t){if(!xe.checkNum(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitivePin.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.rotation=t,this.async||this.done(),this}setState_PinLength(t){if(!xe.checkNum(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitivePin.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.pinLength=t,this.async||this.done(),this}setState_PinColor(t){if(!xe.checkString(t)&&!xe.checkNull(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitivePin.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.pinColor=t,this.async||this.done(),this}setState_PinShape(t){if(!xe.checkString(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitivePin.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.pinShape=t,this.async||this.done(),this}setState_PinType(t){return this.pinType=t,this.async||this.done(),this}setState_OtherProperty(t){return this.otherProperty=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){if(!this.primitiveId)throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitivePin.reset() \u65F6\u9047\u5230\u4E86\u672A\u5728\u539F\u7406\u56FE\u753B\u5E03\u521D\u59CB\u5316\u7684\u5BF9\u8C61\u3002");try{if(this.async){let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitivePin.getPinJson",[this.primitiveId]);if(t){let{head:i={},attrPara:r={}}=t,{pinColor:n,x:s,y:a,rotation:o,length:l,pinShape:u}=i,c=Nn("Pin Number",r,"value"),h=Nn("Pin Name",r,"value"),m=Nn("Pin Type",r,"value");this.x=s,this.y=a,this.pinNumber=c,this.pinName=h,this.rotation=o,this.pinLength=l,this.pinColor=n,this.pinShape=u,this.pinType=m}}return this}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitivePin.reset() \u65F6\u9047\u5230\u4E86\u9884\u671F\u4E4B\u5916\u7684\u9519\u8BEF\u3002")}}async done(){if(!this.primitiveId)throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitivePin.done() \u65F6\u9047\u5230\u4E86\u672A\u5728\u539F\u7406\u56FE\u753B\u5E03\u521D\u59CB\u5316\u7684\u5BF9\u8C61\u3002");try{return _.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitivePin.modify",{primitiveId:this.primitiveId,x:this.x,y:this.y,pinNumber:this.pinNumber,pinName:this.pinName,rotation:this.rotation,pinLength:this.pinLength,pinColor:this.pinColor,pinShape:this.pinShape,pinType:this.pinType}),this}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitivePin.done() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PrimitivePin \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}}},Xu=class extends on{constructor(i,r,n,s,a,o,l,u,c,h){super(r,n,s,a,o,l,u,c,h,i);this.primitiveType="ComponentPin"}async create(){return this}setState_X(){return this}setState_Y(){return this}setState_PinName(){return this}setState_Rotation(){return this}setState_PinLength(){return this}setState_PinColor(){return this}setState_PinShape(){return this}setState_PinType(){return this}async reset(){return this}async done(){return this}};var po={NetFlag_Power:"c19033e4f560428090e4fc097513e5e3",NetFlag_Ground:"9a64ac5790a940f7ae40fc736dc6faff",NetFlag_AnalogGround:"020e090fae1746909dc2ba708097eb8f",NetFlag_ProtectGround:"24f4625729ce4e0caeb63cb2f93d2349",NetPort_IN:"d1791174cc834e86a381cf4678cd8f5f",NetPort_OUT:"675cb8e8f90e4d969086d29fccac9571",NetPort_BI:"7510ef180cb1451081617a89698799b3",ShortCircuitFlag:"969e264ca0d545929f65fa01b3959f6d"},Cg=(o=>(o.COMPONENT="part",o.DRAWING="sheet",o.NET_FLAG="netflag",o.NET_PORT="netport",o.NON_ELECTRICAL_FLAG="nonElectrical_symbol",o.SHORT_CIRCUIT_FLAG="short_symbol",o.NET_LABEL="netlabel",o))(Cg||{});async function ND(e){var b,E;let t,i={libraryUuid:void 0,uuid:void 0},r,n,s,a,o,l,u,c,h,m,f={};for(let S of Object.keys(e))switch(e[S].key){case"Symbol":{n?n.uuid=e[S].value:n={uuid:e[S].value,libraryUuid:void 0};break}case"Footprint":{s?s.uuid=e[S].value:s={uuid:e[S].value,libraryUuid:void 0};break}case"Device":{i.uuid=e[S].value;break}case"Add into BOM":{t=e[S].value==="yes";break}case"Convert to PCB":{r=e[S].value==="yes";break}case"Designator":{a=e[S].value;break}case"Name":{o=e[S].value;break}case"Unique ID":{l=e[S].value;break}case"Manufacturer":{u=e[S].value;break}case"Manufacturer Part":{c=e[S].value;break}case"Supplier":{h=e[S].value;break}case"Supplier Part":{m=e[S].value;break}default:{["3D Model","3D Model Title","3D Model Transform","Channel ID","Group ID","Reuse Block","supplier","supplierId"].includes(e[S].key)||(f[e[S].key]=e[S].value);break}}let{message:g}=await _.messageBus.rpcCall("/PrjDB/symbol/getData",[n==null?void 0:n.uuid]),{message:y}=await _.messageBus.rpcCall("/PrjDB/footprint/getData",[s==null?void 0:s.uuid]);return g&&n&&(n.libraryUuid=((b=g.source)==null?void 0:b.split("|")[1])||""),y&&s&&(s.libraryUuid=((E=y.source)==null?void 0:E.split("|")[1])||""),{component:i,addIntoBom:t,addIntoPcb:r,symbol:n,footprint:s,designator:a,name:o,uniqueId:l,manufacturer:u,manufacturerId:c,supplier:h,supplierId:m,otherProperty:f}}function ih(e){let t=e.match(new RegExp(/\d+$/,"g"));if(!t)throw new Error("\u5F53\u524D\u56FE\u5143 ID \u672A\u627E\u5230\u5BF9\u5E94\u7684 DOM ID");return`e${t[0]}`}function Ju(e){let t=[];if(typeof e=="string"?t.push(ih(e)):e instanceof Cr?t.push(ih(e.getState_PrimitiveId())):e instanceof Array&&(e[0]instanceof Cr?t=e.map(i=>ih(i.getState_PrimitiveId())):typeof e[0]=="string"&&(t=e.map(i=>ih(i)))),!t.length)throw new Error("\u672A\u627E\u5230 primitiveIds \u5BF9\u5E94\u7684\u5668\u4EF6");return t}async function Ig(e){let t=[];for(let i of e){let r=i.head,n=i.attrPara,s=r.cmdKey,{component:a,addIntoBom:o,addIntoPcb:l,symbol:u,footprint:c,designator:h,name:m,uniqueId:f,manufacturer:g,manufacturerId:y,supplier:b,supplierId:E,otherProperty:S}=await ND(n);t.push(new Cr(s,a,r.x,-r.y,r.multiPart.partId,r.rotation,r.isMirror,o,l,s==="netflag"||s==="netport"?m:"",i.primitiveId,u,c,h,m,f,g,y,b,E,S))}return t}function sS(e,t){for(let i in t)if(t.hasOwnProperty(i)){let r=t[i];if(r.key===e)return r.value}}function DD(e){let t=[],i=e.shapes.pin;for(let r in i)if(i.hasOwnProperty(r)){let n=i[r].attrPara,s=sS("Pin Number",n),a=sS("Pin Name",n),o=sS("Pin Type",n),l=i[r].head;t.push(new Xu(r,l.x,l.y,s,a,l.rotation,l.length,l.pinColor,l.pinShape,o))}return t}var Ag=class{constructor(){this.defaultLibraryUuid="0819f05c4eef4c71ace90d822a990e87";this.netFlagComponentUuid_Power={uuid:po.NetFlag_Power,libraryUuid:this.defaultLibraryUuid},this.netFlagComponentUuid_Ground={uuid:po.NetFlag_Ground,libraryUuid:this.defaultLibraryUuid},this.netFlagComponentUuid_AnalogGround={uuid:po.NetFlag_AnalogGround,libraryUuid:this.defaultLibraryUuid},this.netFlagComponentUuid_ProtectGround={uuid:po.NetFlag_ProtectGround,libraryUuid:this.defaultLibraryUuid},this.netPortComponentUuid_IN={uuid:po.NetPort_IN,libraryUuid:this.defaultLibraryUuid},this.netPortComponentUuid_OUT={uuid:po.NetPort_OUT,libraryUuid:this.defaultLibraryUuid},this.netPortComponentUuid_BI={uuid:po.NetPort_BI,libraryUuid:this.defaultLibraryUuid},this.shortCircuitFlagComponentUuid={uuid:po.ShortCircuitFlag,libraryUuid:this.defaultLibraryUuid}}async setNetFlagComponentUuid_Power(t){if(!await this.checkComponentType("netflag",t.uuid,t.libraryUuid))throw new Error("\u4F20\u5165\u7684\u5668\u4EF6\u975E\u6B63\u786E\u7684\u7F51\u7EDC\u6807\u8BC6");return this.netFlagComponentUuid_Power={uuid:t.uuid,libraryUuid:t.libraryUuid},!0}async setNetFlagComponentUuid_Ground(t){if(!await this.checkComponentType("netflag",t.uuid,t.libraryUuid))throw new Error("\u4F20\u5165\u7684\u5668\u4EF6\u975E\u6B63\u786E\u7684\u7F51\u7EDC\u6807\u8BC6");return this.netFlagComponentUuid_Ground={uuid:t.uuid,libraryUuid:t.libraryUuid},!0}async setNetFlagComponentUuid_AnalogGround(t){if(!await this.checkComponentType("netflag",t.uuid,t.libraryUuid))throw new Error("\u4F20\u5165\u7684\u5668\u4EF6\u975E\u6B63\u786E\u7684\u7F51\u7EDC\u6807\u8BC6");return this.netFlagComponentUuid_AnalogGround={uuid:t.uuid,libraryUuid:t.libraryUuid},!0}async setNetFlagComponentUuid_ProtectGround(t){if(!await this.checkComponentType("netflag",t.uuid,t.libraryUuid))throw new Error("\u4F20\u5165\u7684\u5668\u4EF6\u975E\u6B63\u786E\u7684\u7F51\u7EDC\u6807\u8BC6");return this.netFlagComponentUuid_ProtectGround={uuid:t.uuid,libraryUuid:t.libraryUuid},!0}async setNetPortComponentUuid_IN(t){if(!await this.checkComponentType("netport",t.uuid,t.libraryUuid))throw new Error("\u4F20\u5165\u7684\u5668\u4EF6\u975E\u6B63\u786E\u7684\u7F51\u7EDC\u7AEF\u53E3");return this.netPortComponentUuid_IN={uuid:t.uuid,libraryUuid:t.libraryUuid},!0}async setNetPortComponentUuid_OUT(t){if(!await this.checkComponentType("netport",t.uuid,t.libraryUuid))throw new Error("\u4F20\u5165\u7684\u5668\u4EF6\u975E\u6B63\u786E\u7684\u7F51\u7EDC\u7AEF\u53E3");return this.netPortComponentUuid_OUT={uuid:t.uuid,libraryUuid:t.libraryUuid},!0}async setNetPortComponentUuid_BI(t){if(!await this.checkComponentType("netport",t.uuid,t.libraryUuid))throw new Error("\u4F20\u5165\u7684\u5668\u4EF6\u975E\u6B63\u786E\u7684\u7F51\u7EDC\u7AEF\u53E3");return this.netPortComponentUuid_BI={uuid:t.uuid,libraryUuid:t.libraryUuid},!0}async create(t,i,r,n,s,a,o,l){return await new Cr("part",t,i,r,n,s,a,o,l).create()}async createNetFlag(t,i,r,n,s,a){let o="netflag",l=Object.create({});switch(t){case"Power":l=this.netFlagComponentUuid_Power;break;case"Ground":l=this.netFlagComponentUuid_Ground;break;case"AnalogGround":l=this.netFlagComponentUuid_AnalogGround;break;case"ProtectGround":l=this.netFlagComponentUuid_ProtectGround;break}return await new Cr(o,l,r,n,"",s,a,void 0,void 0,i).create()}async createNetPort(t,i,r,n,s,a){let o="netport",l=Object.create({});switch(t){case"IN":l=this.netPortComponentUuid_IN;break;case"OUT":l=this.netPortComponentUuid_OUT;break;case"BI":l=this.netPortComponentUuid_BI;break}return await new Cr(o,l,r,n,"",s,a,void 0,void 0,i).create()}async createShortCircuitFlag(t,i,r,n){let s="short_symbol",a=this.shortCircuitFlagComponentUuid;return await new Cr(s,a,t,i,"",r,n).create()}async delete(t){let i=!1,r=Ju(t);return i=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent.delete",r),i}async modify(t,i){let{x:r,y:n,rotation:s,mirror:a,addIntoBom:o,addIntoPcb:l,designator:u,name:c,uniqueId:h,manufacturer:m,manufacturerId:f,supplier:g,supplierId:y,otherProperty:b={}}=i,E;if(typeof t=="string"){let R=await this.get(t);if(R!=null&&R.length)E=R[0];else return}else if(t instanceof Cr)E=t;else throw new Error("\u5668\u4EF6\u56FE\u5143\u6570\u636E\u9519\u8BEF");if(E.getState_ComponentType()!=="part")throw new Error("\u4EC5\u5F53\u5668\u4EF6\u7C7B\u578B\u4E3A\u5143\u4EF6\u65F6\u5141\u8BB8\u4F7F\u7528\u8BE5\u51FD\u6570\u8FDB\u884C\u4FEE\u6539");r===void 0&&(r=E.getState_X()),n===void 0&&(n=E.getState_Y()),n=-n,s===void 0&&(s=E.getState_Rotation()),a===void 0&&(a=E.getState_Mirror()),o===void 0&&(o=E.getState_AddIntoBom()),l===void 0&&(l=E.getState_AddIntoPcb()),!u&&u!==null&&(u=E.getState_Designator()),!c&&c!==null&&(c=E.getState_Name()),!h&&h!==null&&(h=E.getState_UniqueId()),!m&&m!==null&&(m=E.getState_Manufacturer()),!f&&f!==null&&(f=E.getState_ManufacturerId()),!g&&g!==null&&(g=E.getState_Supplier()),!y&&y!==null&&(y=E.getState_SubPartName());let S={x:r,y:n,rotation:s,mirror:a},v={"Add into BOM":o?"yes":"no","Convert to PCB":l?"yes":"no",Designator:u,Name:c,"Unique ID":h,Manufacturer:m,"Manufacturer Part":f,Supplier:g,"Supplier Part":y},A=Object.keys(v);v=Object.assign(v,E.getState_OtherProperty());for(let R in v)A.includes(R)||(b[R]&&(v[R]=b[R]),!b[R]&&(v[R]=""));let x=Ju([E.getState_PrimitiveId()])[0],T=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent.modify",{id:x,position:S,attr:v});return(await Ig([T]))[0]}async get(t){try{let i=t,r=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent.get",i);if(!r||!r.length)return Array.isArray(i)?[]:void 0;let n=await Ig(r);return Array.isArray(i)?n:n[0]}catch{throw new Error("\u83B7\u53D6\u5668\u4EF6\u4FE1\u606F\u5931\u8D25")}}async getAllPrimitiveId(t,i=!1){try{return await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent.getAllPrimitiveId",{cmdKey:t,allSchematicPages:i})}catch{throw new Error("\u83B7\u53D6\u6240\u6709\u5668\u4EF6\u7684\u56FE\u5143ID\u5931\u8D25")}}async getAll(t,i=!1){try{let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent.getAll",{cmdKey:t,allSchematicPages:i});if(!r)throw new Error("\u83B7\u53D6\u6240\u6709\u5668\u4EF6\u5931\u8D25");let n=[];for(let s of Object.keys(r))n.push(r[s]);return await Ig(n)}catch{throw new Error("\u83B7\u53D6\u6240\u6709\u5668\u4EF6\u5931\u8D25")}}async getAllPinsByPrimitiveId(t){try{let i=Ju(t),r=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent.get",i);if(!r||!r.length)throw new Error("\u83B7\u53D6\u5668\u4EF6\u5173\u8054\u7684\u6240\u6709\u5F15\u811A\u4FE1\u606F\u5931\u8D25");return DD(r[0])}catch{throw new Error("\u83B7\u53D6\u5668\u4EF6\u5173\u8054\u7684\u6240\u6709\u5F15\u811A\u5931\u8D25")}}async placeComponentWithMouse(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent.placeComponentWithMouse",{uuid:t.uuid,libraryUuid:t.libraryUuid,subLibraryId:i})}async getAllPropertyNames(){let r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent.getAll",{undefined:void 0,allSchematicPages:!1})).map(s=>s.attrPara),n=new Set;return r.forEach(s=>{Object.values(s).forEach(a=>{n.add(a.key)})}),Array.from(n)}async getComponentDetail(t,i){try{let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent.getDeviceData",{uuid:t,path:i});if(!r)throw new Error("\u8BE5\u5668\u4EF6\u4E0D\u5B58\u5728");return r}catch{throw new Error("\u83B7\u53D6\u5668\u4EF6\u8BE6\u60C5\u5931\u8D25")}}async checkComponentType(t,i,r){let n=!0;if(n=xe.checkString(i),!n)return n;let s=await this.getComponentDetail(i,r);switch(t){case"netflag":n=s.symbol_type===18;break;case"netport":n=s.symbol_type===19;break;case"short_symbol":n=s.symbol_type===22;break;case"part":n=s.symbol_type===2;break}return n}},Cr=class{constructor(t,i,r,n,s,a=0,o=!1,l=!0,u=!0,c,h,m,f,g,y,b,E,S,v,A,x){this.async=!0;this.primitiveType="Component";this.componentType=t,this.component=i,this.x=r,this.y=n,this.subPartName=s,this.rotation=a,this.mirror=o,this.addIntoBom=l,this.addIntoPcb=u,this.net=c,h&&m&&g&&(this.primitiveId=h,this.symbol=m,this.footprint=f,this.designator=g,this.name=y,this.uniqueId=b,this.manufacturer=E,this.manufacturerId=S,this.supplier=v,this.supplierId=A,this.otherProperty=x)}async create(){switch(this.setState_Component(this.component),this.setState_SubPartName(this.subPartName),this.setState_X(this.x),this.setState_Y(this.y),this.setState_Rotation(this.rotation),this.setState_Mirror(this.mirror),this.componentType){case"part":this.setState_AddIntoBom(this.addIntoBom),this.setState_AddIntoPcb(this.addIntoPcb);break;case"netflag":case"netport":this.setState_Net(this.net);break;case"short_symbol":break;default:break}let{data:t,subPartName:i}=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent.create",{componentUuid:this.component.uuid,libraryPath:this.component.libraryUuid,x:this.x,y:-this.y,subLibraryId:this.subPartName,rotation:-this.rotation,mirror:this.mirror,addIntoBom:this.addIntoBom,addIntoPcb:this.addIntoPcb,name:this.net}),r=t.attrPara,{symbol:n,footprint:s,designator:a,name:o,uniqueId:l,manufacturer:u,manufacturerId:c,supplier:h,supplierId:m,otherProperty:f}=await ND(r);return this.primitiveId=ih(t.primitiveId),this.symbol=n,this.footprint=s,this.designator=a,this.name=o,this.uniqueId=l,this.manufacturer=u,this.manufacturerId=c,this.supplier=h,this.supplierId=m,this.otherProperty=f,!this.subPartName&&(this.subPartName=i),this}getState_PrimitiveType(){return this.primitiveType}getState_ComponentType(){return this.componentType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_Component(){return this.component}getState_X(){return this.x}getState_Y(){return this.y}getState_SubPartName(){return this.subPartName}getState_Rotation(){return this.rotation}getState_Mirror(){return this.mirror}getState_AddIntoBom(){return this.addIntoBom}getState_AddIntoPcb(){return this.addIntoPcb}getState_Net(){return this.net}getState_Symbol(){return this.symbol}getState_Footprint(){return this.footprint}getState_Designator(){return this.designator}getState_Name(){return this.name}getState_UniqueId(){return this.uniqueId}getState_Manufacturer(){return this.manufacturer}getState_ManufacturerId(){return this.manufacturerId}getState_Supplier(){return this.supplier}getState_SupplierId(){return this.supplierId}getState_OtherProperty(){return this.otherProperty}setState_X(t){if(!xe.checkNum(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.x=t,this.async||this.done(),this}setState_Y(t){if(!xe.checkNum(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.y=t,this.async||this.done(),this}setState_Rotation(t){if(!xe.checkNum(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.rotation=ps(t),this.async||this.done(),this}setState_Mirror(t){if(!xe.checkBoolean(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.mirror=t,this.async||this.done(),this}setState_AddIntoBom(t){if(!xe.checkBoolean(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.addIntoBom=t,this.async||this.done(),this}setState_AddIntoPcb(t){if(!xe.checkBoolean(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.addIntoPcb=t,this.async||this.done(),this}setState_Net(t){if(typeof t>"u")throw new Error;return this.net=t,this.async||this.done(),this}setState_Designator(t){return this.designator=t,this.async||this.done(),this}setState_Name(t){return this.name=t,this.async||this.done(),this}setState_UniqueId(t){return this.uniqueId=t,this.async||this.done(),this}setState_Manufacturer(t){return this.manufacturer=t,this.async||this.done(),this}setState_ManufacturerId(t){return this.manufacturerId=t,this.async||this.done(),this}setState_Supplier(t){return this.supplier=t,this.async||this.done(),this}setState_SupplierId(t){return this.supplierId=t,this.async||this.done(),this}setState_OtherProperty(t){return this.otherProperty=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){if(this.primitiveId){let t=Ju(this.primitiveId),i=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent.get",t);if(!i||!i.length)throw new Error("\u83B7\u53D6\u5668\u4EF6\u4FE1\u606F\u5931\u8D25");let r=(await Ig(i))[0];this.setState_AddIntoBom(r.addIntoBom),this.setState_AddIntoPcb(r.addIntoPcb),this.setState_Component(r.component),this.setState_Designator(r.designator),this.setState_Manufacturer(r.manufacturer),this.setState_ManufacturerId(r.manufacturerId),this.setState_Mirror(r.mirror),this.setState_Name(r.name),this.setState_Net(r.net),this.setState_Rotation(r.rotation),this.setState_SubPartName(r.subPartName),this.setState_Supplier(r.supplier),this.setState_SupplierId(r.supplierId),this.setState_UniqueId(r.uniqueId),this.setState_X(r.x),this.setState_Y(r.y)}return this}async done(){let{primitiveId:t,x:i,y:r,rotation:n,mirror:s,addIntoBom:a,addIntoPcb:o,designator:l,name:u,uniqueId:c,manufacturer:h,manufacturerId:m,supplier:f,supplierId:g,otherProperty:y={}}=this,b={x:i,y:-r,rotation:n,mirror:s},E={"Add into BOM":a?"yes":"no","Convert to PCB":o?"yes":"no",Designator:l,Name:u,"Unique ID":c,Manufacturer:h,"Manufacturer Part":m,supplier:f,supplierId:g},S=Object.keys(E);E=Object.assign(E,this.getState_OtherProperty());for(let v in E)S.includes(v)||(y[v]&&(E[v]=y[v]),!y[v]&&(E[v]=""));if(t){let v=Ju([t])[0];await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent.modify",{id:v,position:b,attr:E})}return this}async getAllPins(){let{primitiveId:t}=this,i=Ju(t),r=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent.get",i);if(!r||!r.length)throw new Error("\u83B7\u53D6\u5668\u4EF6\u5173\u8054\u7684\u6240\u6709\u5F15\u811A\u4FE1\u606F\u5931\u8D25");return DD(r[0])}setState_Component(t){if(xe.checkNull(t.libraryUuid)||!xe.checkString(t.libraryUuid)||xe.checkNull(t.uuid)||!xe.checkString(t.uuid))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.component=t,this.async||this.done(),this}setState_SubPartName(t){if(t&&(xe.checkNull(t)||!xe.checkString(t)))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.subPartName=t,this.async||this.done(),this}};var fo={NetFlag_Power:"c19033e4f560428090e4fc097513e5e3",NetFlag_Ground:"9a64ac5790a940f7ae40fc736dc6faff",NetFlag_AnalogGround:"020e090fae1746909dc2ba708097eb8f",NetFlag_ProtectGround:"24f4625729ce4e0caeb63cb2f93d2349",NetPort_IN:"d489f8e8b77949d09c5b36a539b10274",NetPort_OUT:"6d22856fe3cf4e80a4a70f7d03b2ddcb",NetPort_BI:"7510ef180cb1451081617a89698799b3",ShortCircuitFlag:"969e264ca0d545929f65fa01b3959f6d"};async function BD(e){var E,S;let t=e.getAttr(),i,r={libraryUuid:void 0,uuid:void 0},n,s,a,o,l,u,c,h,m,f,g={};t.forEach(v=>{switch(v.key){case"Symbol":{s?s.uuid=v.value:s={uuid:v.value,libraryUuid:void 0};break}case"Footprint":{a?a.uuid=v.value:a={uuid:v.value,libraryUuid:void 0};break}case"Device":{r.uuid=v.value;break}case"Add into BOM":{i=v.value==="yes";break}case"Convert to PCB":{n=v.value==="yes";break}case"Designator":{o=v.value;break}case"Name":{l=v.value;break}case"Unique ID":{u=v.value;break}case"Manufacturer":{c=v.value;break}case"Manufacturer Part":{h=v.value;break}case"Supplier":{m=v.value;break}case"Supplier Part":{f=v.value;break}default:{["3D Model","3D Model Title","3D Model Transform","Channel ID","Group ID","Reuse Block","supplier","supplierId"].includes(v.key)||(g[v.key]=v.value);break}}});let{message:y}=await _.messageBus.rpcCall("/PrjDB/symbol/getData",[s==null?void 0:s.uuid]),{message:b}=await _.messageBus.rpcCall("/PrjDB/footprint/getData",[a==null?void 0:a.uuid]);return y&&s&&(s.libraryUuid=((E=y.source)==null?void 0:E.split("|")[1])||""),b&&a&&(a.libraryUuid=((S=b.source)==null?void 0:S.split("|")[1])||""),{component:r,addIntoBom:i,addIntoPcb:n,symbol:s,footprint:a,designator:o,name:l,uniqueId:u,manufacturer:c,manufacturerId:h,supplier:m,supplierId:f,otherProperty:g}}async function rh(e){let t=[];for(let i of e){let{cmdKey:r,origin:n,partId:s,rotation:a,isMirror:o}=i,{component:l,addIntoBom:u,addIntoPcb:c,symbol:h,footprint:m,designator:f,name:g,uniqueId:y,manufacturer:b,manufacturerId:E,supplier:S,supplierId:v,otherProperty:A}=await BD(i);if(r==="block_symbol"){let T=i.shapeManager.docManager.projectMgr.componentCache.symbol[i.symbolUuid].source,[R="",L=""]=(T||"").split("|");t.push(new Tg({libraryUuid:void 0,cbbUuid:L||"",uuid:R||(h==null?void 0:h.uuid)||""},n.x,-n.y,a,o,i.id,f,g))}else t.push(new ts(r,l,n.x,-n.y,s,a,o,u,c,r==="netflag"||r==="netport"?g:"",i.id,h,m,f,g,y,b,E,S,v,A))}return t}function OD(e){let t=[],i=e.pins;for(let r of i){let n=r.getAttr("Pin Number").value,s=r.getAttr("Pin Name").value,a=r.getAttr("Pin Type").value,{id:o,origin:l,rotation:u,length:c,color:h,pinShape:m}=r;t.push(new Xu(o,l.x,l.y,n,s,u,c,h,m,a))}return t}var xg=class{constructor(){this.defaultLibraryUuid="0819f05c4eef4c71ace90d822a990e87";this.netFlagComponentUuid_Power={uuid:fo.NetFlag_Power,libraryUuid:this.defaultLibraryUuid},this.netFlagComponentUuid_Ground={uuid:fo.NetFlag_Ground,libraryUuid:this.defaultLibraryUuid},this.netFlagComponentUuid_AnalogGround={uuid:fo.NetFlag_AnalogGround,libraryUuid:this.defaultLibraryUuid},this.netFlagComponentUuid_ProtectGround={uuid:fo.NetFlag_ProtectGround,libraryUuid:this.defaultLibraryUuid},this.netPortComponentUuid_IN={uuid:fo.NetPort_IN,libraryUuid:this.defaultLibraryUuid},this.netPortComponentUuid_OUT={uuid:fo.NetPort_OUT,libraryUuid:this.defaultLibraryUuid},this.netPortComponentUuid_BI={uuid:fo.NetPort_BI,libraryUuid:this.defaultLibraryUuid},this.shortCircuitFlagComponentUuid={uuid:fo.ShortCircuitFlag,libraryUuid:this.defaultLibraryUuid}}async setNetFlagComponentUuid_Power(t){if(!await this.checkComponentType("netflag",t.uuid,t.libraryUuid))throw new Error("\u4F20\u5165\u7684\u5668\u4EF6\u975E\u6B63\u786E\u7684\u7F51\u7EDC\u6807\u8BC6");return this.netFlagComponentUuid_Power={uuid:t.uuid,libraryUuid:t.libraryUuid},!0}async setNetFlagComponentUuid_Ground(t){if(!await this.checkComponentType("netflag",t.uuid,t.libraryUuid))throw new Error("\u4F20\u5165\u7684\u5668\u4EF6\u975E\u6B63\u786E\u7684\u7F51\u7EDC\u6807\u8BC6");return this.netFlagComponentUuid_Ground={uuid:t.uuid,libraryUuid:t.libraryUuid},!0}async setNetFlagComponentUuid_AnalogGround(t){if(!await this.checkComponentType("netflag",t.uuid,t.libraryUuid))throw new Error("\u4F20\u5165\u7684\u5668\u4EF6\u975E\u6B63\u786E\u7684\u7F51\u7EDC\u6807\u8BC6");return this.netFlagComponentUuid_AnalogGround={uuid:t.uuid,libraryUuid:t.libraryUuid},!0}async setNetFlagComponentUuid_ProtectGround(t){if(!await this.checkComponentType("netflag",t.uuid,t.libraryUuid))throw new Error("\u4F20\u5165\u7684\u5668\u4EF6\u975E\u6B63\u786E\u7684\u7F51\u7EDC\u6807\u8BC6");return this.netFlagComponentUuid_ProtectGround={uuid:t.uuid,libraryUuid:t.libraryUuid},!0}async setNetPortComponentUuid_IN(t){if(!await this.checkComponentType("netport",t.uuid,t.libraryUuid))throw new Error("\u4F20\u5165\u7684\u5668\u4EF6\u975E\u6B63\u786E\u7684\u7F51\u7EDC\u7AEF\u53E3");return this.netPortComponentUuid_IN={uuid:t.uuid,libraryUuid:t.libraryUuid},!0}async setNetPortComponentUuid_OUT(t){if(!await this.checkComponentType("netport",t.uuid,t.libraryUuid))throw new Error("\u4F20\u5165\u7684\u5668\u4EF6\u975E\u6B63\u786E\u7684\u7F51\u7EDC\u7AEF\u53E3");return this.netPortComponentUuid_OUT={uuid:t.uuid,libraryUuid:t.libraryUuid},!0}async setNetPortComponentUuid_BI(t){if(!await this.checkComponentType("netport",t.uuid,t.libraryUuid))throw new Error("\u4F20\u5165\u7684\u5668\u4EF6\u975E\u6B63\u786E\u7684\u7F51\u7EDC\u7AEF\u53E3");return this.netPortComponentUuid_BI={uuid:t.uuid,libraryUuid:t.libraryUuid},!0}async create(t,i,r,n,s,a,o,l){return await new ts("part",t,i,r,n,s,a,o,l).create()}async createNetFlag(t,i,r,n,s,a){let o="netflag",l=Object.create({});switch(t){case"Power":l=this.netFlagComponentUuid_Power;break;case"Ground":l=this.netFlagComponentUuid_Ground;break;case"AnalogGround":l=this.netFlagComponentUuid_AnalogGround;break;case"ProtectGround":l=this.netFlagComponentUuid_ProtectGround;break}return await new ts(o,l,r,n,"",s,a,void 0,void 0,i).create()}async createNetPort(t,i,r,n,s,a){let o="netport",l=Object.create({});switch(t){case"IN":l=this.netPortComponentUuid_IN;break;case"OUT":l=this.netPortComponentUuid_OUT;break;case"BI":l=this.netPortComponentUuid_BI;break}return await new ts(o,l,r,n,"",s,a,void 0,void 0,i).create()}async createShortCircuitFlag(t,i,r,n){let s="short_symbol",a=this.shortCircuitFlagComponentUuid;return await new ts(s,a,t,i,"",r,n).create()}async createCbbSymbol(t,i,r,n,s){return await new Tg(t,i,r,n,s).create()}async placeCbbSchematicPage(t,i,r){let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.placeCbbSchematicPage",{cbbSchematicPage:t,x:i,y:r});return!0}async delete(t){let i=!1;return Array.isArray(t)?t=t.map(r=>r instanceof ts?r.getState_PrimitiveId():r):t instanceof ts&&(t=t.getState_PrimitiveId()),i=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.delete",t),i}async modify(t,i){let{x:r,y:n,rotation:s,mirror:a,addIntoBom:o,addIntoPcb:l,designator:u,name:c,uniqueId:h,manufacturer:m,manufacturerId:f,supplier:g,supplierId:y,otherProperty:b={}}=i,E;if(typeof t=="string"){let T=await this.get(t);if(T!=null&&T.length)E=T[0];else return}else if(t instanceof ts)E=t,t=E.getState_PrimitiveId();else throw new Error("\u5668\u4EF6\u56FE\u5143\u6570\u636E\u9519\u8BEF");if(E.getState_ComponentType()!=="part")throw new Error("\u4EC5\u5F53\u5668\u4EF6\u7C7B\u578B\u4E3A\u5143\u4EF6\u65F6\u5141\u8BB8\u4F7F\u7528\u8BE5\u51FD\u6570\u8FDB\u884C\u4FEE\u6539");r===void 0&&(r=E.getState_X()),n===void 0&&(n=E.getState_Y()),n=-n,s===void 0&&(s=E.getState_Rotation()),a===void 0&&(a=E.getState_Mirror()),o===void 0&&(o=E.getState_AddIntoBom()),l===void 0&&(l=E.getState_AddIntoPcb()),!u&&u!==null&&(u=E.getState_Designator()),!c&&c!==null&&(c=E.getState_Name()),!h&&h!==null&&(h=E.getState_UniqueId()),!m&&m!==null&&(m=E.getState_Manufacturer()),!f&&f!==null&&(f=E.getState_ManufacturerId()),!g&&g!==null&&(g=E.getState_Supplier()),!y&&y!==null&&(y=E.getState_SubPartName());let S={x:r,y:n,rotation:s,mirror:a},v={"Add into BOM":o?"yes":"no","Convert to PCB":l?"yes":"no",Designator:u,Name:c,"Unique ID":h,Manufacturer:m,"Manufacturer Part":f,Supplier:g,"Supplier Part":y},A=Object.keys(v);v=Object.assign(v,E.getState_OtherProperty(),b);for(let T in v)A.includes(T)||(b[T]&&(v[T]=b[T]),!b[T]&&(v[T]=""));let x=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.modify",{id:t,position:S,attr:v});return(await rh([x]))[0]}async get(t){try{let i=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.get",t);if(!i||!i.length)throw new Error("\u83B7\u53D6\u5668\u4EF6\u4FE1\u606F\u5931\u8D25");return rh(i)}catch{throw new Error("\u83B7\u53D6\u5668\u4EF6\u4FE1\u606F\u5931\u8D25")}}async getAllPrimitiveId(t,i=!1){try{return await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.getAllPrimitiveId",{componentType:t,allSchematicPages:i})}catch{throw new Error("\u83B7\u53D6\u6240\u6709\u5668\u4EF6\u7684\u56FE\u5143ID\u5931\u8D25")}}async getAll(t,i=!1){try{let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.getAll",{componentType:t,allSchematicPages:i});if(!r)throw new Error("\u83B7\u53D6\u6240\u6709\u5668\u4EF6\u5931\u8D25");return await rh(r)}catch{throw new Error("\u83B7\u53D6\u6240\u6709\u5668\u4EF6\u5931\u8D25")}}async getAllPinsByPrimitiveId(t){try{let i=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.get",t);if(!i||!i.length)throw new Error("\u83B7\u53D6\u5668\u4EF6\u5173\u8054\u7684\u6240\u6709\u5F15\u811A\u4FE1\u606F\u5931\u8D25");return OD(i[0])}catch{throw new Error("\u83B7\u53D6\u5668\u4EF6\u5173\u8054\u7684\u6240\u6709\u5F15\u811A\u5931\u8D25")}}async placeComponentWithMouse(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.placeComponentWithMouse",{uuid:t.uuid,libraryUuid:t.libraryUuid,subLibraryId:i})}async getAllPropertyNames(){let r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.getAll",{undefined:void 0,allSchematicPages:!1})).map(s=>s.attrPara),n=new Set;return r.forEach(s=>{Object.values(s).forEach(a=>{n.add(a.key)})}),Array.from(n)}async getComponentDetail(t,i){try{let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.getDeviceData",{uuid:t,path:i});if(!r)throw new Error("\u8BE5\u5668\u4EF6\u4E0D\u5B58\u5728");return r}catch{throw new Error("\u83B7\u53D6\u5668\u4EF6\u8BE6\u60C5\u5931\u8D25")}}async checkComponentType(t,i,r){let n=!0;if(n=xe.checkString(i),!n)return n;let s=await this.getComponentDetail(i,r);switch(t){case"netflag":n=s.symbol_type===18;break;case"netport":n=s.symbol_type===19;break;case"short_symbol":n=s.symbol_type===22;break;case"part":n=s.symbol_type===2;break}return n}},ts=class e{constructor(t,i,r,n,s,a=0,o=!1,l=!0,u=!0,c,h,m,f,g,y,b,E,S,v,A,x){this.async=!0;this.primitiveType="Component";this.primitiveId=h,this.componentType=t,this.component=i,this.x=r,this.y=n,this.partId=s,this.rotation=a,this.mirror=o,this.addIntoBom=l,this.addIntoPcb=u,this.net=c,h&&m&&g&&(this.symbol=m,this.footprint=f,this.designator=g,this.name=y,this.uniqueId=b,this.manufacturer=E,this.manufacturerId=S,this.supplier=v,this.supplierId=A,this.otherProperty=x)}async create(){switch(this.setState_Component(this.component),this.setState_SubPartName(this.partId),this.setState_X(this.x),this.setState_Y(this.y),this.setState_Rotation(this.rotation),this.setState_Mirror(this.mirror),this.componentType){case"part":this.setState_AddIntoBom(this.addIntoBom),this.setState_AddIntoPcb(this.addIntoPcb);break;case"netflag":case"netport":this.setState_Net(this.net);break;case"short_symbol":break;default:break}let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.create",{componentUuid:this.component.uuid,libraryPath:this.component.libraryUuid,x:this.x,y:-this.y,subLibraryId:this.partId,rotation:-this.rotation,mirror:this.mirror,addIntoBom:this.addIntoBom,addIntoPcb:this.addIntoPcb,name:this.net}),{symbol:i,footprint:r,designator:n,name:s,uniqueId:a,manufacturer:o,manufacturerId:l,supplier:u,supplierId:c,otherProperty:h}=await BD(t);return this.primitiveId=t.id,this.symbol=i,this.footprint=r,this.designator=n,this.name=s,this.uniqueId=a,this.manufacturer=o,this.manufacturerId=l,this.supplier=u,this.supplierId=c,this.otherProperty=h,!this.partId&&(this.partId=t.partId),this}getState_PrimitiveType(){return this.primitiveType}getState_ComponentType(){return this.componentType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728 PCB \u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_Component(){return this.component}getState_X(){return this.x}getState_Y(){return this.y}getState_SubPartName(){return this.partId}getState_Rotation(){return this.rotation}getState_Mirror(){return this.mirror}getState_AddIntoBom(){return this.addIntoBom}getState_AddIntoPcb(){return this.addIntoPcb}getState_Net(){return this.net}getState_Symbol(){return this.symbol}getState_Footprint(){return this.footprint}getState_Designator(){return this.designator}getState_Name(){return this.name}getState_UniqueId(){return this.uniqueId}getState_Manufacturer(){return this.manufacturer}getState_ManufacturerId(){return this.manufacturerId}getState_Supplier(){return this.supplier}getState_SupplierId(){return this.supplierId}getState_OtherProperty(){return this.otherProperty}setState_X(t){if(!xe.checkNum(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.x=t,this.async||this.done(),this}setState_Y(t){if(!xe.checkNum(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.y=t,this.async||this.done(),this}setState_Rotation(t){if(!xe.checkNum(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.rotation=ps(t),this.async||this.done(),this}setState_Mirror(t){if(!xe.checkBoolean(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.mirror=t,this.async||this.done(),this}setState_AddIntoBom(t){if(!xe.checkBoolean(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.addIntoBom=t,this.async||this.done(),this}setState_AddIntoPcb(t){if(!xe.checkBoolean(t))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.addIntoPcb=t,this.async||this.done(),this}setState_Net(t){if(typeof t>"u")throw new Error;return this.net=t,this.async||this.done(),this}setState_Designator(t){return this.designator=t,this.async||this.done(),this}setState_Name(t){return this.name=t,this.async||this.done(),this}setState_UniqueId(t){return this.uniqueId=t,this.async||this.done(),this}setState_Manufacturer(t){return this.manufacturer=t,this.async||this.done(),this}setState_ManufacturerId(t){return this.manufacturerId=t,this.async||this.done(),this}setState_Supplier(t){return this.supplier=t,this.async||this.done(),this}setState_SupplierId(t){return this.supplierId=t,this.async||this.done(),this}setState_OtherProperty(t){return this.otherProperty=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){if(this.primitiveId){let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.get",this.primitiveId);if(!t||!t.length)throw new Error("\u83B7\u53D6\u5668\u4EF6\u4FE1\u606F\u5931\u8D25");let i=(await rh(t))[0];if(i instanceof e){let r=i;this.setState_AddIntoBom(r.addIntoBom),this.setState_AddIntoPcb(r.addIntoPcb),this.setState_Component(r.component),this.setState_Designator(r.designator),this.setState_Manufacturer(r.manufacturer),this.setState_ManufacturerId(r.manufacturerId),this.setState_Mirror(r.mirror),this.setState_Name(r.name),this.setState_Net(r.net),this.setState_Rotation(r.rotation),this.setState_SubPartName(r.partId),this.setState_Supplier(r.supplier),this.setState_SupplierId(r.supplierId),this.setState_UniqueId(r.uniqueId),this.setState_X(r.x),this.setState_Y(r.y)}else{let r=i;this.setState_Designator(r.designator),this.setState_Mirror(r.mirror),this.setState_Name(r.name),this.setState_Rotation(r.rotation),this.setState_X(r.x),this.setState_Y(r.y)}}return this}async done(){let{primitiveId:t,x:i,y:r,rotation:n,mirror:s,addIntoBom:a,addIntoPcb:o,designator:l,name:u,uniqueId:c,manufacturer:h,manufacturerId:m,supplier:f,supplierId:g,otherProperty:y={}}=this,b={x:i,y:-r,rotation:n,mirror:s},E={"Add into BOM":a?"yes":"no","Convert to PCB":o?"yes":"no",Designator:l,Name:u,"Unique ID":c,Manufacturer:h,"Manufacturer Part":m,supplier:f,supplierId:g},S=Object.keys(E);E=Object.assign(E,this.getState_OtherProperty(),y);for(let v in E)S.includes(v)||(y[v]&&(E[v]=y[v]),!y[v]&&(E[v]=""));return t&&await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.modify",{id:t,position:b,attr:E}),this}async getAllPins(){let{primitiveId:t}=this,i=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.get",t);if(!i||!i.length)throw new Error("\u83B7\u53D6\u5668\u4EF6\u5173\u8054\u7684\u6240\u6709\u5F15\u811A\u4FE1\u606F\u5931\u8D25");return OD(i[0])}setState_Component(t){if(xe.checkNull(t.libraryUuid)||!xe.checkString(t.libraryUuid)||xe.checkNull(t.uuid)||!xe.checkString(t.uuid))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.component=t,this.async||this.done(),this}setState_SubPartName(t){if(t&&(xe.checkNull(t)||!xe.checkString(t)))throw new Error("\u6570\u636E\u4E0D\u7B26\u5408\u89C4\u8303");return this.partId=t,this.async||this.done(),this}},Tg=class extends ts{constructor(t,i,r,n,s,a,o,l){super("block_symbol",{libraryUuid:"",uuid:""},i,r,void 0,n,s,void 0,void 0,void 0,a,void 0,void 0,o,l),this.cbb={libraryUuid:t.libraryUuid,uuid:t.cbbUuid},this.cbbSymbol=t}async create(){this.setState_CbbSymbol(this.cbbSymbol),this.setState_X(this.x),this.setState_Y(this.y),this.setState_Rotation(this.rotation),this.setState_Mirror(this.mirror);let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.createCbbSymbol",{cbbSymbol:this.cbbSymbol,x:this.x,y:this.y,rotation:this.rotation,mirror:this.mirror});return this.primitiveId=t.id,this.designator=t.getAttr("Designator").value,this.name=t.getAttr("Name").value,this}getState_Cbb(){return this.cbb}getState_CbbSymbol(){return this.cbbSymbol}async reset(){if(this.primitiveId){let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.get",this.primitiveId);if(!t||!t.length)throw new Error("\u83B7\u53D6\u5668\u4EF6\u4FE1\u606F\u5931\u8D25");let i=(await rh(t))[0];this.setState_Designator(i.designator),this.setState_Mirror(i.mirror),this.setState_Name(i.name),this.setState_Rotation(i.rotation),this.setState_X(i.x),this.setState_Y(i.y)}return this}async done(){let{primitiveId:t,x:i,y:r,rotation:n,mirror:s,designator:a,name:o,otherProperty:l={}}=this,u={x:i,y:-r,rotation:n,mirror:s},c={Designator:a,Name:o},h=Object.keys(c);c=Object.assign(c,this.getState_OtherProperty(),l);for(let m in c)h.includes(m)||(l[m]&&(c[m]=l[m]),!l[m]&&(c[m]=""));return t&&await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveComponent3.modify",{id:t,position:u,attr:c}),this}setState_CbbSymbol(t){return this.cbbSymbol=t,this.async||this.done(),this}};var wg=class{async create(t,i,r,n,s){try{return await new Dn(t,i,r,n,s).create()}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u77E9\u5F62\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}}async delete(t){try{let i=new Set;Array.isArray(t)?t.forEach(n=>{n instanceof Dn&&i.add(n.getState_PrimitiveId()),typeof n=="string"&&i.add(n)}):(typeof t=="string"&&i.add(t),t instanceof Dn&&i.add(t.getState_PrimitiveId()));let r=await this.getAllPrimitiveId();if(r&&r.length>0){let n=r.filter(s=>i.has(s));return n.length>0?await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitivePolygon.delete",n):!1}else return!1}catch{throw new Error("\u9519\u8BEF\uFF1A\u5220\u9664\u64CD\u4F5C\u65E0\u6CD5\u6B63\u786E\u6267\u884C\uFF0C\u53EF\u80FD\u662F\u56FE\u5143\u7684 ID \u4E0D\u6B63\u786E\u6216\u6570\u636E\u683C\u5F0F\u9519\u8BEF\u3002")}}async modify(t,i){var r;try{if(typeof t=="string"){let s=(r=(await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitivePolygon.getAllPrimitiveId")).polyline)==null?void 0:r[t];s&&(t=new Dn(i.line===void 0?s.pointArr:i.line,i.color===void 0?s.strokeColor:i.color,i.fillColor===void 0?s.fillColor:i.fillColor,i.lineWidth===void 0?s.strokeWidth:i.lineWidth,i.lineType===void 0?s.strokeStyle:i.lineType,t))}if(t instanceof Dn){let n=t.isAsync();return n||t.toAsync(),i.line!==void 0&&t.setState_Line(i.line),i.color!==void 0&&t.setState_Color(i.color),i.fillColor!==void 0&&t.setState_FillColor(i.fillColor),i.lineWidth!==void 0&&t.setState_LineWidth(i.lineWidth),i.lineType!==void 0&&t.setState_LineType(i.lineType),n?t.done():t.toSync(),t}}catch(n){throw new Error(n)}}async get(t){try{let i=new Set(Array.isArray(t)?t:[t]),r=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitivePolygon.getAllPrimitiveId");if(r.polyline&&i.size>0){let n=r.polyline,s=[];return i.forEach(a=>{let o=n[a];if(o){let l=new Dn(o.pointArr,o.strokeColor,o.fillColor,o.strokeWidth,o.strokeStyle,a);s.push(l)}}),s.length>0?Array.isArray(t)?s:s[0]:[]}}catch(i){throw new Error(i)}}async getAllPrimitiveId(){try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitivePolygon.getAllPrimitiveId");return t?Object.keys(t.polyline):[]}catch(t){throw new Error(t)}}async getAll(){try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitivePolygon.getAllPrimitiveId");if(t&&Object.keys(t.polyline||{}).length>0){let i=t.polyline,r=Object.keys(i),n=[];return r.forEach(s=>{let a=i[s],o=new Dn(a.pointArr,a.strokeColor,a.fillColor,a.strokeWidth,a.strokeStyle,s);n.push(o)}),n}else return[]}catch(t){throw new Error(t)}}},Dn=class{constructor(t,i=null,r=null,n=null,s=null,a){this.async=!0;this.primitiveType="Polygon";this.line=t,this.color=i,this.fillColor=r,this.lineWidth=n,this.lineType=s,a&&(this.primitiveId=a)}async create(){this.setState_Line(this.line),this.setState_Color(this.color),this.setState_FillColor(this.fillColor),this.setState_LineWidth(this.lineWidth),this.setState_LineType(this.lineType);try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitivePolygon.create",{pointArr:this.line,color:this.color,fillColor:this.fillColor,lineWidth:this.lineWidth,lineType:this.lineType,primitiveLock:!1});xe.checkString(t)&&(this.primitiveId=t)}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitivePolygon.create() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PrimitivePolygon \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(!this.primitiveId)throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728\u539F\u7406\u56FE\u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002");return this.primitiveId}getState_Line(){return this.line}getState_Color(){return this.color}getState_FillColor(){return this.fillColor}getState_LineWidth(){return this.lineWidth}getState_LineType(){return this.lineType}setState_Line(t){if(!xe.checkArray(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitivePolygon.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.line=t,this.async||this.done(),this}setState_Color(t){if(!xe.checkString(t)&&!xe.checkNull(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitivePolygon.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.color=t,this.async||this.done(),this}setState_FillColor(t){if(!xe.checkString(t)&&!xe.checkNull(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitivePolygon.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.fillColor=t,this.async||this.done(),this}setState_LineWidth(t){if(!xe.checkNum(t)&&!xe.checkNull(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitivePolygon.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.lineWidth=t,this.async||this.done(),this}setState_LineType(t){if(!xe.checkNum(t)&&!xe.checkNull(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitivePolygon.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.lineType=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){if(!this.primitiveId)throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitivePolygon.reset() \u65F6\u9047\u5230\u4E86\u672A\u5728\u539F\u7406\u56FE\u753B\u5E03\u521D\u59CB\u5316\u7684\u5BF9\u8C61\u3002");try{if(this.async){let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitivePolygon.getAllPrimitiveId"),i=t==null?void 0:t[this.primitiveId];i&&(this.line=i.pointArr,this.color=i.strokeColor,this.fillColor=i.fillColor,this.lineWidth=i.strokeWidth,this.lineType=i.strokeStyle)}return this}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitivePolygon.reset() \u65F6\u9047\u5230\u4E86\u9884\u671F\u4E4B\u5916\u7684\u9519\u8BEF\u3002")}}done(){if(!this.primitiveId)throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitivePolygon.done() \u65F6\u9047\u5230\u4E86\u672A\u5728\u539F\u7406\u56FE\u753B\u5E03\u521D\u59CB\u5316\u7684\u5BF9\u8C61\u3002");try{return _.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitivePolygon.modify",{primitiveId:this.primitiveId,pointArr:this.line,color:this.color,fillColor:this.fillColor,lineWidth:this.lineWidth,lineType:this.lineType}),this}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitivePolygon.done() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PrimitivePolygon \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}}};var Rg=class{async create(t,i,r,n,s,a,o,l,u,c,h){try{return await new is(t,i,r,n,s,a,o,l,u,c,h).create()}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u521B\u5EFA\u77E9\u5F62\u56FE\u5143\uFF0C\u53EF\u80FD\u662F\u4F20\u5165\u7684\u53C2\u6570\u4E0D\u6B63\u786E\u3002")}}async delete(t){try{let i=new Set;if(Array.isArray(t))t.forEach(n=>{if(typeof n=="string")i.has(n)||i.add(n);else if(n instanceof is){let s=n.getState_PrimitiveId();s&&!i.has(s)&&i.add(s)}});else if(typeof t=="string")i.add(t);else if(t instanceof is){let n=t.getState_PrimitiveId();n&&i.add(n)}let r=await this.getAllPrimitiveId();if(r&&r.length>0){let n=[];return i.forEach(s=>{r.includes(s)&&n.push(s)}),n.length>0?await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveRectangle.delete",n):!1}else return!1}catch{throw new Error("\u9519\u8BEF\uFF1A\u5220\u9664\u64CD\u4F5C\u65E0\u6CD5\u6B63\u786E\u6267\u884C\uFF0C\u53EF\u80FD\u662F\u56FE\u5143\u7684 ID \u4E0D\u6B63\u786E\u6216\u6570\u636E\u683C\u5F0F\u9519\u8BEF\u3002")}}async modify(t,i){try{if(typeof t=="string"){let r=await this.get(t);if(r)t=r;else return}if(t instanceof is){let r=t.isAsync();return r||t.toAsync(),i.topLeftX!==void 0&&t.setState_TopLeftX(i.topLeftX),i.topLeftY!==void 0&&t.setState_TopLeftY(i.topLeftY),i.width!==void 0&&t.setState_Width(i.width),i.height!==void 0&&t.setState_Height(i.height),i.cornerRadius!==void 0&&t.setState_CornerRadius(i.cornerRadius),i.rotation!==void 0&&t.setState_Rotation(i.rotation),i.color!==void 0&&t.setState_Color(i.color),i.fillColor!==void 0&&t.setState_FillColor(i.fillColor),i.lineWidth!==void 0&&t.setState_LineWidth(i.lineWidth),i.lineType!==void 0&&t.setState_LineType(i.lineType),i.fillStyle!==void 0&&t.setState_FillStyle(i.fillStyle),r?t.done():t.toSync(),t}else return}catch{throw new Error("\u9519\u8BEF\uFF1A\u5220\u9664\u64CD\u4F5C\u65E0\u6CD5\u6B63\u786E\u6267\u884C\uFF0C\u53EF\u80FD\u662F\u56FE\u5143\u7684 ID \u4E0D\u6B63\u786E\u6216\u6570\u636E\u683C\u5F0F\u9519\u8BEF\u3002")}}async get(t){try{let i=new Set;Array.isArray(t)?t.forEach(n=>{i.has(n)||i.add(n)}):typeof t=="string"&&i.add(t);let r=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveRectangle.getAllPrimitivesJsonCache");if(r&&i.size>0){let n=[];if(i.forEach(s=>{let a=r[s];if(a){let o=new is(a.x,a.y,Math.abs(a.endX-a.x),Math.abs(a.endY-a.y),a.rx,a.rotation,a.strokeColor,a.fillColor,a.strokeWidth,a.strokeStyle,void 0,s);n.push(o)}}),n.length>0){if(typeof t=="string")return n[0];if(Array.isArray(t))return n}else return}else return}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u83B7\u53D6\u6570\u636E\uFF0C\u53EF\u80FD\u662F\u8F93\u5165\u53C2\u6570\u4E0D\u6B63\u786E\u6216\u539F\u7406\u56FE\u753B\u5E03\u6570\u636E\u51FA\u73B0\u9519\u8BEF\uFF0C\u53EF\u4EE5\u5237\u65B0\u9875\u9762\u540E\u91CD\u8BD5\u3002")}}async getAllPrimitiveId(){try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveRectangle.getAllPrimitivesJsonCache");return t?Object.keys(t):[]}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u83B7\u53D6\u6570\u636E\uFF0C\u53EF\u80FD\u662F\u539F\u7406\u56FE\u753B\u5E03\u6570\u636E\u51FA\u73B0\u9519\u8BEF\uFF0C\u53EF\u4EE5\u5237\u65B0\u9875\u9762\u540E\u91CD\u8BD5\u3002")}}async getAll(){try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveRectangle.getAllPrimitivesJsonCache");if(t&&Object.keys(t).length>0){let i=Object.keys(t),r=[];return i.forEach(n=>{let s=t[n],a=new is(s.x,s.y,Math.abs(s.endX-s.x),Math.abs(s.endY-s.y),s.rx,s.rotation,s.strokeColor,s.fillColor,s.strokeWidth,s.strokeStyle,void 0,n);r.push(a)}),r}else return[]}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u83B7\u53D6\u6570\u636E\uFF0C\u53EF\u80FD\u662F\u539F\u7406\u56FE\u753B\u5E03\u6570\u636E\u51FA\u73B0\u9519\u8BEF\uFF0C\u53EF\u4EE5\u5237\u65B0\u9875\u9762\u540E\u91CD\u8BD5\u3002")}}},is=class{constructor(t,i,r,n,s=0,a=0,o=null,l=null,u=null,c=null,h=null,m){this.async=!0;this.primitiveType="Rectangle";this.topLeftX=t,this.topLeftY=i,this.width=r,this.height=n,this.cornerRadius=s,this.rotation=a,this.color=o,this.fillColor=l,this.lineWidth=u,this.lineType=c,this.fillStyle=h,m&&(this.primitiveId=m)}async create(){this.setState_TopLeftX(this.topLeftX),this.setState_TopLeftY(this.topLeftY),this.setState_Width(this.width),this.setState_Height(this.height),this.setState_CornerRadius(this.cornerRadius),this.setState_Rotation(this.rotation),this.setState_Color(this.color),this.setState_FillColor(this.fillColor),this.setState_LineWidth(this.lineWidth),this.setState_LineType(this.lineType),this.setState_FillStyle(this.fillStyle);try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveRectangle.create",{topLeftX:this.topLeftX,topLeftY:this.topLeftY,width:this.width,height:this.height,cornerRadius:this.cornerRadius,rotation:this.rotation,color:this.color,fillColor:this.fillColor,fillStyle:this.fillStyle,lineWidth:this.lineWidth,lineType:this.lineType,primitiveLock:!1});xe.checkString(t)&&(this.primitiveId=t)}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitiveRectangle.create() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PrimitiveRectangle \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728\u539F\u7406\u56FE\u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_TopLeftX(){return this.topLeftX}getState_TopLeftY(){return this.topLeftY}getState_Width(){return this.width}getState_Height(){return this.height}getState_CornerRadius(){return this.cornerRadius}getState_Rotation(){return this.rotation}getState_Color(){return this.color}getState_FillColor(){return this.fillColor}getState_LineWidth(){return this.lineWidth}getState_LineType(){return this.lineType}getState_FillStyle(){return this.fillStyle}setState_TopLeftX(t){if(!xe.checkNum(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitiveRectangle.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.topLeftX=t,this.async||this.done(),this}setState_TopLeftY(t){if(!xe.checkNum(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitiveRectangle.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.topLeftY=t,this.async||this.done(),this}setState_Width(t){if(!xe.checkNum(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitiveRectangle.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.width=t,this.async||this.done(),this}setState_Height(t){if(!xe.checkNum(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitiveRectangle.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.height=t,this.async||this.done(),this}setState_CornerRadius(t){if(!xe.checkNum(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitiveRectangle.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.cornerRadius=t,this.async||this.done(),this}setState_Rotation(t){if(!xe.checkNum(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitiveRectangle.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.rotation=ps(t),this.async||this.done(),this}setState_Color(t){if(!xe.checkString(t)&&!xe.checkNull(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitiveRectangle.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.color=t,this.async||this.done(),this}setState_FillColor(t){if(!xe.checkString(t)&&!xe.checkNull(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitiveRectangle.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.fillColor=t,this.async||this.done(),this}setState_LineWidth(t){if(!xe.checkNum(t)&&!xe.checkNull(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitiveRectangle.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.lineWidth=t,this.async||this.done(),this}setState_LineType(t){if(!xe.checkNum(t)&&!xe.checkNull(t))throw new Error("\u9519\u8BEF\uFF1A\u5728\u8C03\u7528 PrimitiveRectangle.setState_*() \u65F6\u4F20\u5165\u4E86\u9519\u8BEF\u7684\u6570\u636E\u3002");return this.lineType=t,this.async||this.done(),this}setState_FillStyle(t){return this.fillStyle=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){if(!this.primitiveId)throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitiveRectangle.reset() \u65F6\u9047\u5230\u4E86\u672A\u5728\u539F\u7406\u56FE\u753B\u5E03\u521D\u59CB\u5316\u7684\u5BF9\u8C61\u3002");try{if(this.async){let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_PrimitiveRectangle.getAllPrimitivesJsonCache"),i=t==null?void 0:t[this.primitiveId];i&&(this.topLeftX=i.x,this.topLeftY=i.y,this.width=Math.abs(i.endX-i.x),this.height=Math.abs(i.endY-i.y),this.cornerRadius=i.rx,this.rotation=i.rotation,this.color=i.strokeColor,this.fillColor=i.fillColor,this.lineWidth=i.strokeWidth,this.lineType=i.strokeStyle)}return this}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitiveRectangle.reset() \u65F6\u9047\u5230\u4E86\u9884\u671F\u4E4B\u5916\u7684\u9519\u8BEF\u3002")}}done(){if(!this.primitiveId)throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitiveRectangle.done() \u65F6\u9047\u5230\u4E86\u672A\u5728\u539F\u7406\u56FE\u753B\u5E03\u521D\u59CB\u5316\u7684\u5BF9\u8C61\u3002");try{return _.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitiveRectangle.modify",{primitiveId:this.primitiveId,topLeftX:this.topLeftX,topLeftY:this.topLeftY,width:this.width,height:this.height,cornerRadius:this.cornerRadius,rotation:this.rotation,color:this.color,fillColor:this.fillColor,fillStyle:this.fillStyle,lineWidth:this.lineWidth,lineType:this.lineType}),this}catch{throw new Error("\u9519\u8BEF\uFF1A\u6267\u884C PrimitiveRectangle.done() \u65F6\u9047\u5230\u4E86\u9519\u8BEF\uFF0C\u53EF\u80FD\u662F PrimitiveRectangle \u5185\u7684\u5C5E\u6027\u4E0D\u6B63\u786E\u3002")}}};var Lg=class{async create(t,i,r,n,s,a,o,l,u,c,h){let m;return fs()||(i=-i),Ln().publish("api/createText",{data:{x:t,y:i,content:r,rotation:n,textColor:s,fontName:a,fontSize:o,bold:l,italic:u,underLine:c,alignMode:h},cb:function(f){let{x:g,y,content:b,rotation:E,textColor:S,fontName:v,fontSize:A,bold:x,italic:T,underLine:R,alignMode:L,primitiveId:O}=f;m=new rs(g,y,b,E,S,v,A,x,T,R,L,O)}}),m}async delete(t){if(Array.isArray(t))return t.every(r=>i(r));return i(t);function i(r){var a;let n;r instanceof rs?n=r.getState_PrimitiveId():typeof r=="string"&&(n=r);let s=!1;return(a=Ln())==null||a.publish("api/deleteText",{id:n,cb:function(o){s=o}}),s}}async modify(t,i){var n;let r;return(n=Ln())==null||n.publish("api/modifyText",{data:{primitiveId:t,x:i.x,y:i.y,content:i.content,rotation:i.rotation,textColor:i.textColor,fontName:i.fontName,fontSize:i.fontSize,bold:i.bold,italic:i.italic,underLine:i.underLine,alignMode:i.alignMode},cb:function(s){let{x:a,y:o,content:l,rotation:u,textColor:c,fontName:h,fontSize:m,bold:f,italic:g,underLine:y,alignMode:b,primitiveId:E}=s;r=new rs(a,o,l,u,c,h,m,f,g,y,b,E)}}),r}async get(t){if(Array.isArray(t))return t.map(r=>i(r));return i(t);function i(r){var a;let n;r instanceof rs?n=r.getState_PrimitiveId():typeof r=="string"&&(n=r);let s;return(a=Ln())==null||a.publish("api/getText",{id:n,cb:function(o){let{x:l,y:u,content:c,rotation:h,textColor:m,fontName:f,fontSize:g,bold:y,italic:b,underLine:E,alignMode:S,primitiveId:v}=o;s=new rs(l,u,c,h,m,f,g,y,b,E,S,v)}}),s}}async getAllPrimitiveId(){var i;let t=[];return(i=Ln())==null||i.publish("api/getAllTextID",{cb:function(r){t=r}}),t}async getAll(){var i;let t=[];return(i=Ln())==null||i.publish("api/getAllText",{cb:function(r=[]){for(let n of r){let{x:s,y:a,content:o,rotation:l,textColor:u,fontName:c,fontSize:h,bold:m,italic:f,underLine:g,alignMode:y,primitiveId:b}=n;t.push(new rs(s,a,o,l,u,c,h,m,f,g,y,b))}}}),t}},rs=class{constructor(t,i,r,n,s,a,o,l,u,c,h,m){this.async=!0;this.primitiveType="Text";this.x=t,this.y=i,this.content=r,this.rotation=n,this.textColor=s,this.fontName=a,this.fontSize=o,this.bold=l,this.italic=u,this.underLine=c,this.alignMode=h,m&&(this.primitiveId=m)}async create(){return this.setState_X(this.x),this.setState_Y(this.y),this.setState_Rotation(this.rotation),this.setState_TextColor(this.textColor),this.setState_FontName(this.fontName),this.setState_FontSize(this.fontSize),this.setState_Bold(this.bold),this.setState_Italic(this.italic),this.setState_UnderLine(this.underLine),this.setState_AlignMode(this.alignMode),this.primitiveId="",this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728\u539F\u7406\u56FE\u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_X(){return this.x}getState_Y(){return this.y}getState_Content(){return this.content}getState_Rotation(){return this.rotation}getState_TextColor(){return this.textColor}getState_FontName(){return this.fontName}getState_FontSize(){return this.fontSize}getState_Bold(){return this.bold}getState_Italic(){return this.italic}getState_UnderLine(){return this.underLine}getState_AlignMode(){return this.alignMode}setState_X(t){return this.x=t,this.async||this.done(),this}setState_Y(t){return this.y=t,this.async||this.done(),this}setState_Content(t){return this.content=t,this.async||this.done(),this}setState_Rotation(t){return this.rotation=ps(t),this.async||this.done(),this}setState_TextColor(t){return this.textColor=t,this.async||this.done(),this}setState_FontName(t){return this.fontName=t,this.async||this.done(),this}setState_FontSize(t){return this.fontSize=t,this.async||this.done(),this}setState_Bold(t){return this.bold=t,this.async||this.done(),this}setState_Italic(t){return this.italic=t,this.async||this.done(),this}setState_UnderLine(t){return this.underLine=t,this.async||this.done(),this}setState_AlignMode(t){return this.alignMode=t,this.async||this.done(),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){var t;return(t=Ln())==null||t.publish("api/getText",{id:this.primitiveId,cb:function(i){let{x:r,y:n,content:s,rotation:a,textColor:o,fontName:l,fontSize:u,bold:c,italic:h,underLine:m,alignMode:f,primitiveId:g}=i;this.setState_X(r),this.setState_Y(n),this.setState_Content(s),this.setState_Rotation(a),this.setState_TextColor(o),this.setState_FontName(l),this.setState_FontSize(u),this.setState_Bold(c),this.setState_Italic(h),this.setState_UnderLine(m),this.setState_AlignMode(f)}}),this}async done(){var t;return(t=Ln())==null||t.publish("api/modifyText",{data:{primitiveId:this.getState_PrimitiveId(),x:this.getState_X(),y:this.getState_Y(),content:this.getState_Content(),rotation:this.getState_Rotation(),textColor:this.getState_TextColor(),fontName:this.getState_FontName(),fontSize:this.getState_FontSize(),bold:this.getState_Bold(),italic:this.getState_Italic(),underLine:this.getState_UnderLine(),alignMode:this.getState_AlignMode()},cb:function(i){}}),this}};var Ng=class{async create(t,i,r,n,s){return await new ns(t,i,r,n,s).create()}async delete(t){let i=!1,r=(Array.isArray(t)?t:[t]).map(n=>n instanceof ns?n.getState_PrimitiveId():n);try{_.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitiveWire.delete",{data:r,getter:n=>{i=n}})}catch{return!1}return i}async modify(t,i){try{let r;return t instanceof ns?(r=t,i.color!==void 0&&t.setState_Color(i.color),i.line!==void 0&&t.setState_Line(i.line),i.lineType!==void 0&&t.setState_LineType(i.lineType),i.lineWidth!==void 0&&t.setState_LineWidth(i.lineWidth),i.net!==void 0&&t.setState_Net(i.net)):r=new ns(i.line,i.net,i.color,i.lineWidth,i.lineType,t),r.isAsync()&&r.done(),r}catch{return}}async get(t){let i;try{_.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitiveWire.get",{data:t,getter:n=>{i=n}})}catch{}if(typeof i>"u"&&(i=[]),!i.length)return;let r=i.map(n=>{if(n)return new ns(n.line,n.net,n.color,n.lineWidth,n.lineType,n.id)});return Array.isArray(t)?r:r[0]}async getAllPrimitiveId(t){let i=[];try{_.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitiveWire.getAllPrimitiveId",{data:t,getter:r=>{i=r}})}catch{}return i}async getAll(t){let i=[];try{_.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitiveWire.getAll",{data:t,getter:r=>{i=r}})}catch{}return i.map(({line:r,lineType:n,lineWidth:s,color:a,net:o,id:l})=>new ns(r,o,a,s,n,l))}},ns=class{constructor(t,i="",r=null,n=null,s=null,a){this.async=!0;this.primitiveType="Wire";this.line=t,this.net=i,this.color=r,this.lineWidth=n,this.lineType=s,a&&(this.primitiveId=a)}async create(){this.setState_Line(this.line),this.setState_Net(this.net),this.setState_Color(this.color),this.setState_LineWidth(this.lineWidth),this.setState_LineType(this.lineType);let t;try{if(_.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitiveWire.create",{data:{line:this.line,net:this.net,color:this.color,lineWidth:this.lineWidth,lineType:this.lineType},getter:i=>{t=i}}),t)this.primitiveId=t.id,this.line=t.line,this.color=t.color,this.lineType=t.lineType,this.lineWidth=t.lineWidth;else throw new Error("create failed!")}catch{throw new Error("create failed!")}return this}getState_PrimitiveType(){return this.primitiveType}getState_PrimitiveId(){if(this.primitiveId)return this.primitiveId;throw new Error("\u9519\u8BEF\uFF1A\u5BF9\u8C61\u672A\u5728\u539F\u7406\u56FE\u753B\u5E03\u521D\u59CB\u5316\uFF0C\u4E0D\u5B58\u5728 PrimitiveId\u3002")}getState_Line(){return this.line}getState_Net(){return this.net}getState_Color(){return this.color}getState_LineWidth(){return this.lineWidth}getState_LineType(){return this.lineType}setState_Line(t){return this.line=t,this.async||this.done(),this}setState_Net(t){return this.net=(t==null?void 0:t.toUpperCase())||"",this.async||this.done(),this}setState_Color(t){return this.color=t,this.async||this.done(),this}setState_LineWidth(t){return(t===null||t>=1&&t<=10)&&(this.lineWidth=t,this.async||this.done()),this}setState_LineType(t){return(t===null||t>=0&&t<=3)&&(this.lineType=t,this.async||this.done()),this}toAsync(){return this.async=!0,this}toSync(){return this.async=!1,this.done(),this}isAsync(){return this.async}async reset(){return this}async done(){let t;if(_.extensionApiMessageBus2.publish("extensionApi.SCH_PrimitiveWire.modify",{data:{primitiveId:this.primitiveId,line:this.line,net:this.net,color:this.color,lineWidth:this.lineWidth,lineType:this.lineType},getter:i=>{t=i}}),!t)throw new Error("modify failed!");return this.primitiveId=t.id,this.line=t.line,this.lineWidth=t.lineWidth,this.lineType=t.lineType,this.color=t.color,this.net=t.net,this}};var Dg=class{async getAllSelectedPrimitives_PrimitiveId(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_SelectControl.getAllSelectedPrimitives_PrimitiveId")}async getAllSelectedPrimitives(){var o,l,u,c,h,m,f,g,y,b,E,S,v,A,x,T,R,L,O,H,k,ee,q,Q,ne,G,X,D,F,W,z,$,te,Z,pe,Se,Ce,we,Fe,Ue;if(fs())return await this.refactorGetAllSelectedPrimitives();let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_SelectControl.getAllSelectedPrimitives"),i=await _.extensionApiMessageBus2.rpcCall("extensionApi.DMT_Project.getCurrentProjectUuid");if(t.length===0)return[];let r=["Add into BOM","Convert to PCB","Symbol","Footprint","Designator","Name","Unique ID","Manufacturer","Manufacturer Part","Supplier","Supplier Part"],n=[];for(let je of t){let me=(await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_SelectControl.getSpecifiedPrimitive",je.id)).message,Ae=(await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_SelectControl.getObjParams",je.id)).message;switch(je.cmdKey){case"circle":n.push(new Os(me["attr-x"],me["attr-y"],me["attr-r"],Ae.strokeColor||s(me["attr-stroke-color"],!1),Ae.fillColor||s(me["attr-fill-color"],!1),Ae.strokeWidth||s(me["attr-stroke-width"],!0),Ae.strokeStyle||s(me["attr-stroke-style"],!1),me["attr-id"]));break;case"rect":{let We=new is(Ae.x,Ae.y,me["attr-width"],me["attr-height"],me["attr-radius"],Ae.rotation,Ae.strokeColor||s(me["attr-stroke-color"],!1),Ae.fillColor||s(me["attr-fill-color"],!1),Ae.strokeWidth||s(me["attr-stroke-width"],!0),Ae.strokeStyle||s(me["attr-stroke-style"],!1),je.id);n.push(We);break}case"pin":{let We=new on(me["attr-x"],me["attr-y"],me["attr-number"],me["attr-pin-name"],me["attr-rotation"],me.pinLength,s(me.pinColor,!1),Ae.head.pinShape,me["attr-pin-type"],je.id);n.push(We);break}case"text":{let We=new rs(Ae.x,Ae.y,me["attr-text"],Ae.rotation,s(me["attr-font-color"],!1),s(me["attr-font-family"],!1),Ae.fontSize,Ae.fontWeight,Ae.italic,Ae.underline,me["attr-origin"],je.id);n.push(We);break}case"bus":{let We=s(me["attr-stroke-style"],!1),tt=new es(me["attr-name"],Ae,s(me["attr-stroke-color"],!1),s(me["attr-stroke-width"],!0),a(We),je.id);n.push(tt);break}case"arc":{let We=s(me["attr-stroke-style"],!1),tt=new Bs(Ae.x1,Ae.y1,Ae.x2,Ae.y2,Ae.x3,Ae.y3,Ae.strokeColor||s(me["attr-stroke-color"],!1),Ae.fillColor||s(me["attr-fill-color"],!1),Ae.strokeWidth||s(me["attr-stroke-width"],!0),a(We),je.id);n.push(tt);break}case"wire":{let We=s(me["attr-stroke-style"],!1),tt=new ns(Ae,me["attr-global-net"],s(me["attr-stroke-color"],!1),s(me["attr-stroke-width"],!0),a(We),je.id);n.push(tt);break}case"polyline":{let We=[];Ae.pointArr.forEach(it=>{We.push(it.x),We.push(it.y)});let tt=s(me["attr-stroke-style"],!1),Ct=new Dn(We,Ae.strokeColor||s(me["attr-stroke-color"],!1),Ae.fillColor||s(me["attr-fill-color"],!1),Ae.strokeWidth||s(me["attr-stroke-width"],!0),a(tt),je.id);n.push(Ct);break}case"nonElectrical_symbol":case"short_symbol":case"part":{let We={};Object.keys(me.c_para||{}).forEach(Ct=>{r.includes(Ct)||(We[Ct]=me.c_para[Ct].value)});let tt=new Cr(je.cmdKey,{uuid:(l=(o=me.c_para)==null?void 0:o.Device)==null?void 0:l.value,libraryUuid:i},Ae.head.x,Ae.head.y,me["attr-part-id"],Ae.head.rotation,Ae.head.isMirror,((c=(u=me.c_para)==null?void 0:u["Add into BOM"])==null?void 0:c.value)==="yes"||!1,((m=(h=me.c_para)==null?void 0:h["Convert to PCB"])==null?void 0:m.value)==="yes"||!1,"",je.id,{uuid:(g=(f=me.c_para)==null?void 0:f.Symbol)==null?void 0:g.value,libraryUuid:i},{uuid:(b=(y=me.c_para)==null?void 0:y.Footprint)==null?void 0:b.value,libraryUuid:i},(S=(E=me.c_para)==null?void 0:E.Designator)==null?void 0:S.value,(A=(v=me.c_para)==null?void 0:v.Name)==null?void 0:A.value,(T=(x=me.c_para)==null?void 0:x["Unique ID"])==null?void 0:T.value,(L=(R=me.c_para)==null?void 0:R.Manufacturer)==null?void 0:L.value,(H=(O=me.c_para)==null?void 0:O["Manufacturer Part"])==null?void 0:H.value,(ee=(k=me.c_para)==null?void 0:k.Supplier)==null?void 0:ee.value,(Q=(q=me.c_para)==null?void 0:q["Supplier Part"])==null?void 0:Q.value,We);n.push(tt);break}case"netflag":case"netport":{let We={};Object.keys(me.c_para||{}).forEach(Ct=>{r.includes(Ct)||(We[Ct]=me.c_para[Ct].value)});let tt=new Cr(je.cmdKey,{uuid:(G=(ne=me.c_para)==null?void 0:ne.Device)==null?void 0:G.value,libraryUuid:i},Ae.head.x,Ae.head.y,"",Ae.head.rotation,Ae.head.isMirror,((X=me.c_para["Add into BOM"])==null?void 0:X.value)==="yes",((D=me.c_para["Convert to PCB"])==null?void 0:D.value)==="yes",(F=me.c_para.Name)==null?void 0:F.value,je.id,{uuid:(z=(W=me.c_para)==null?void 0:W.Symbol)==null?void 0:z.value,libraryUuid:i},{uuid:(te=($=me.c_para)==null?void 0:$.Footprint)==null?void 0:te.value,libraryUuid:i},(Z=me.c_para.Designator)==null?void 0:Z.value,(pe=me.c_para.Name)==null?void 0:pe.value,(Se=me.c_para["Unique ID"])==null?void 0:Se.value,(Ce=me.c_para.Manufacturer)==null?void 0:Ce.value,(we=me.c_para["Manufacturer Part"])==null?void 0:we.value,(Fe=me.c_para.Supplier)==null?void 0:Fe.value,(Ue=me.c_para["Supplier Part"])==null?void 0:Ue.value,We);n.push(tt);break}case"netlabel":{let We=new Cr(je.cmdKey,{uuid:"",libraryUuid:""},Ae.x,Ae.y,"",Ae.rotation,Ae.isMirror,void 0,void 0,void 0,je.id,{uuid:"",libraryUuid:""},{uuid:"",libraryUuid:""},void 0,me["attr-name"],void 0,void 0,void 0,void 0,void 0,{});n.push(We);break}case"sheet":break;default:break}}function s(je,me){return me?Number(je.split("Default")[0]):je.split("Default")[0]}function a(je){return{solid:0,"6,6":1,"3,10":2,"4,2,1,2":3}[je]}return n}async refactorGetAllSelectedPrimitives(){try{let t=[],i=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_SelectControl.getAllSelectedPrimitives");return i&&(i==null?void 0:i.length)>0&&i.forEach(r=>{let{cmdKey:n}=r;if(n)switch(n){case"circle":t.push(new Os(r.centerX,r.centerY,r.radius,r.color,r.fillColor,r.lineWidth,r.lineType,r.fillStyle,r.primitiveId));break;case"rect":t.push(new is(r.topLeftX,r.topLeftY,r.width,r.height,r.cornerRadius,r.rotation,r.color,r.fillColor,r.lineWidth,r.lineType,r.fillStyle,r.primitiveId));break;case"pin":t.push(new on(r.x,r.y,r.pinNumber,r.pinName,r.rotation,r.pinLength,r.pinColor,r.pinShape,r.pinType,r.primitiveId,r.otherProperty));break;case"text":t.push(new rs(r.x,r.y,r.content,r.rotation,r.textColor,r.fontName,r.fontSize,r.bold,r.italic,r.underLine,r.alignMode,r.primitiveId));break;case"bus":t.push(new es(r.busName,r.line,r.color,r.lineWidth,r.lineType,r.primitiveId));break;case"wire":t.push(new ns(r.line,r.net,r.color,r.lineWidth,r.lineType,r.primitiveId));break;case"arc":t.push(new Bs(r.startX,r.startY,r.referenceX,r.referenceY,r.endX,r.endY,r.color,r.fillColor,r.lineWidth,r.lineType,r.primitiveId));break;case"polyline":t.push(new Dn(r.line,r.color,r.fillColor,r.lineWidth,r.lineType,r.primitiveId));break;case"nonElectrical_symbol":case"short_symbol":case"part":case"netflag":case"netport":case"netlabel":t.push(new Cr(r.componentType,r.component,r.x,r.y,r.subPartName,r.rotation,r.mirror,r.addIntoBom,r.addIntoPcb,r.net,r.primitiveId,r.symbol,r.footprint,r.designator,r.name,r.uniqueId,r.manufacturer,r.manufacturerId,r.supplier,r.supplierId,r.otherProperty));break;default:break}}),t}catch(t){return console.error(t),[]}}async getSelectedPrimitives_PrimitiveId(){try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_SelectControl.getSelectedPrimitives_PrimitiveId");return t?t.map(i=>i.id):[]}catch(t){throw new Error(t)}}async getSelectedPrimitives(){try{let t=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_SelectControl.getSelectedPrimitives_PrimitiveId"),i=[];if((t==null?void 0:t.length)===0)return[];for(let r of t)if(console.log(r),!(r.cmdKey!=="part"&&r.cmdKey!=="pin"&&r.cmdKey!=="wire"&&r.cmdKey!=="netflag"&&r.cmdKey!=="netlabel"&&r.cmdKey!=="netport"&&r.cmdKey!=="text"))try{let n=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_SelectControl.getSpecifiedPrimitive",r.id);console.log(n);let s=i.push({primitiveType:n.message["attr-topic"],id:r.id,param:void 0})-1;if(n.message["attr-topic"]==="Component")i[s].param={uniqueId:n.message.c_para["Unique ID"].value,designator:n.message.c_para.Designator.value};else if(n.message["attr-topic"]==="Pin"){if(r.parentCmdKey==="part"){let a=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_SelectControl.getSpecifiedPrimitive",r.parentId);i[s].param={parentComponentDesignator:a.message.c_para.Designator.value,pinName:n.message.c_para["Pin Name"].value,pinNumber:n.message.c_para["Pin Number"].value}}else if(r.parentCmdKey==="netflag"){let a=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_SelectControl.getSpecifiedPrimitive",r.parentId);i[s].primitiveType=a.message["attr-topic"],i[s].id=r.parentId,i[s].param={net:a.message.c_para["Global Net Name"].value}}}else if(n.message["attr-topic"]==="Wire"){let a=await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_SelectControl.getSpecifiedPrimitive",r.parentId);i[s].param={net:a.message["attr-global-net"]}}else n.message["attr-topic"]==="Net Flag"?i[s].param={net:n.message["attr-name"]}:n.message["attr-topic"]==="Property"&&n.message["attr-text-key"]==="Global Net Name"?i[s].param={net:n.message["attr-text"]}:n.message["attr-topic"]==="Net Port"?i[s].param={net:n.message["attr-name"]}:n.message["attr-topic"]==="Name"&&r.parentCmdKey==="netport"?i[s].param={net:n.message["attr-text"]}:n.message["attr-topic"]==="Name"&&r.cmdKey==="netlabel"&&(i[s].param={net:n.message["attr-name"]})}catch{}return i}catch{return[]}}async doSelectPrimitives(t){try{return await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_SelectControl.doSelectPrimitives",t),!0}catch{return!1}}doCrossProbeSelect(t,i,r,n=!0,s=!0){let a={highlight:n,select:s,data:{components:t||[],pins:i||[],nets:r||[]}};try{return Sa().rpcCall("getCrossProbeApi",a,An()),!0}catch{return!1}}clearSelected(){try{return Sa().publish("unSelect",void 0,An()),!0}catch{return!1}}async getCurrentMousePosition(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SCH_SelectControl.getCurrentMousePosition")}};var Bg=class{splitLines(t){if(t.every(u=>typeof u=="number")){let u=r(t),c=n(u),{lines:h,breakPoints:m}=a(c),f=m.map(y=>String(y[0])+y[1]),g=[];return h.forEach((y,b)=>{b===0?g[0]=y[0].concat(y[1]):f.includes(String(y[1][0])+y[1][1])?(g[g.length-1].push(...y[1]),g[g.length]=y[1]):g[g.length-1].push(...y[1])}),g}else{let u=[];t.forEach(y=>{let b=r(y),E=n(b);u.push(...E)});let c=a(u),{lines:h,breakPoints:m}=c,f=m.map(y=>l(y)),g=[];return t.map((y,b)=>{let E=l(y);g.push([]),h.forEach(S=>{let v=S[0].concat(S[1]),A=l(v),x=l(S[0]),T=l(S[1]);if(E.indexOf(A)!==-1)g[b].length===0?g[b]=S[0].concat(S[1]):g[g.length-1].push(...S[1]);else{if(E.indexOf(x)!==-1&&f.includes(T)){let{length:R}=g;g[R-1].length===0?g[R-1]=S[0].concat(S[1]):g[R-1].push(...S[1])}E.indexOf(T)!==-1&&f.includes(x)&&g.push(S[0].concat(S[1]))}})}),g}function r(u){let c=[];return u.forEach((h,m)=>{(u[2*m]||u[2*m]===0)&&c.push([u[2*m],u[2*m+1]])}),c}function n(u){let c=[];return u.forEach((h,m)=>{c.length===0?c.push([u[0],u[1]]):u[m]&&u[m+1]&&c.push([u[m],u[m+1]])}),c}function s(u,c){let h=u[0][0],m=u[0][1],f=u[1][0],g=u[1][1],y=c[0][0],b=c[0][1],E=c[1][0],S=c[1][1],v=[E-y,S-b],A=[f-h,g-m],x=v[0]*(m-b)-v[1]*(h-y),T=v[0]*(g-b)-v[1]*(f-y),R=A[0]*(b-m)-A[1]*(y-h),L=A[0]*(S-m)-A[1]*(E-h);return x*T<0&&R*L<0}function a(u){let c=[];for(let m=0;m<u.length;m++)for(let f=m+1;f<u.length;f++){let g=u[m],y=u[f];s(g,y)&&c.push([g,y])}let h=[];for(let m of c){let f=m[0],g=m[1],y=o(f,g);if(y){h.push(y);let b=[g[0],y],E=[y,g[1]],S=u.indexOf(g);u.splice(S,1,b,E)}}return{lines:u,breakPoints:h}}function o(u,c){let h=u[0][0],m=u[0][1],f=u[1][0],g=u[1][1],y=c[0][0],b=c[0][1],E=c[1][0],S=c[1][1],v=(h-f)*(b-S)-(m-g)*(y-E);if(v===0)return null;let A=((h*g-m*f)*(y-E)-(h-f)*(y*S-b*E))/v,x=((h*g-m*f)*(b-S)-(m-g)*(y*S-b*E))/v;return A>=Math.min(h,f)&&A<=Math.max(h,f)&&A>=Math.min(y,E)&&A<=Math.max(y,E)&&x>=Math.min(m,g)&&x<=Math.max(m,g)&&x>=Math.min(b,S)&&x<=Math.max(b,S)?[A,x]:null}function l(u){let c="";return u.forEach((h,m)=>{m%2===0?c=c+"x="+h:c=c+"y="+h+","}),c}}};var Og=class{constructor(t){this.extensionUuid=t}async request(t,i="GET",r,n,s){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");(i.toUpperCase()==="GET"||i.toUpperCase()==="HEAD")&&(r=void 0);let a={method:i.toUpperCase(),body:r,mode:"cors",credentials:"same-origin",cache:"no-cache",redirect:"follow",priority:"high"},o=a;n&&(o=X_(n,a));try{let l=fetch(t,o);if(s){let u=await l;u.ok&&s(u)}return l}catch{throw new Error("\u9519\u8BEF\uFF1A\u5230 "+t+" \u7684\u8BF7\u6C42\u65E0\u6CD5\u88AB\u6B63\u786E\u5904\u7406")}}};var Mg=class{showInformationMessage(t,i=be.sys_I18n.text("Tips"),r){_.extensionApiMessageBus2.publish("extensionApi.SYS_MessageBox.showInformationMessage",{content:t,title:i,buttonTitle:r})}showConfirmationMessage(t,i=be.sys_I18n.text("Tips"),r=be.sys_I18n.text("Confirm"),n=be.sys_I18n.text("Cancel"),s){_.extensionApiMessageBus2.publish("extensionApi.SYS_MessageBox.showConfirmationMessage",{content:t,title:i,mainButtonTitle:r,buttonTitle:n,callbackFn:s})}showInputDialog(t,i,r=be.sys_I18n.text("Input"),n="text",s,a,o){typeof s=="number"&&(s=s.toString()),_.extensionApiMessageBus2.publish("extensionApi.SYS_MessageBox.showInputDialog",{beforeContent:t,title:r,afterContent:i,value:s,type:n,otherProperty:a,callbackFn:o})}showSelectDialog(t,i,r,n=be.sys_I18n.text("Select"),s,a=!1,o){_.extensionApiMessageBus2.publish("extensionApi.SYS_MessageBox.showSelectDialog",{beforeContent:i,title:n,afterContent:r,options:t,defaultOption:s,multiple:a,callbackFn:o})}insertScriptToDialog(t,i,...r){_.extensionApiMessageBus2.publish("extensionApi.SYS_MessageBox.insertScriptToDialog",{dialogId:t,scriptFunction:i,args:r})}};var kg=class{isWeb(){return!Cn}isClient(){return Cn}isEasyEDAProEdition(){return wf}isJLCEDAProEdition(){return t2}isProPrivateEdition(){return $a}isOnlineMode(){return T0}isHalfOfflineMode(){return i2}isOfflineMode(){return w0}getEditorCurrentVersion(){return xc()}getEditorCompliedDate(){return oC()}getUserInfo(){return _.globalVariableUserInfo}async setKeepProjectHasOnlyOneBoard(t=!0){await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_Environment.setKeepProjectHasOnlyOneBoard",{status:t})}};var Fg=class{constructor(t){this.extensionUuid=t}async getExtensionFile(t){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u5185\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");let i=await _.extensionIndexedDBUtils.get("extensionsObjectStorage",this.extensionUuid+"|"+Ro(t));if(i)return new File([i.source],t.split("/").at(-1))}async openReadFileDialog(t,i=!1){return typeof t=="string"&&(t=[t]),await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileSystem.openReadFileDialog",t)}async openReadFolderDialog(){return[]}async saveFile(t,i){if("name"in t||(t=new File([t],i||"eda.dat"),i=void 0),"name"in t)return i&&(t=new File([t],i,{type:t.type})),await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileSystem.saveFile",t)}async readFileFromFileSystem(t){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");if(!Cn)throw new Error("\u9519\u8BEF\uFF1A\u975E\u5BA2\u6237\u7AEF\u73AF\u5883\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileSystem.readFileFromFileSystem",t)}async saveFileToFileSystem(t,i,r,n=!1){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");if(!Cn)throw new Error("\u9519\u8BEF\uFF1A\u975E\u5BA2\u6237\u7AEF\u73AF\u5883\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileSystem.saveFileToFileSystem",{uri:t,fileData:i,fileName:r})}async listFilesOfFileSystem(t,i=!1){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");if(!Cn)throw new Error("\u9519\u8BEF\uFF1A\u975E\u5BA2\u6237\u7AEF\u73AF\u5883\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileSystem.listFilesOfFileSystem",{folderPath:t,recursive:i})}async deleteFileInFileSystem(t,i=!1){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");if(!Cn)throw new Error("\u9519\u8BEF\uFF1A\u975E\u5BA2\u6237\u7AEF\u73AF\u5883\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileSystem.deleteFileInFileSystem",{uri:t,force:i})}async getEdaPath(){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");if(!Cn)throw new Error("\u9519\u8BEF\uFF1A\u975E\u5BA2\u6237\u7AEF\u73AF\u5883\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileSystem.getEdaPath")}async getDocumentsPath(){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");if(!Cn)throw new Error("\u9519\u8BEF\uFF1A\u975E\u5BA2\u6237\u7AEF\u73AF\u5883\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileSystem.getDocumentsPath")}async getLibrariesPaths(){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");if(!Rf)throw new Error("\u9519\u8BEF\uFF1A\u975E\u5BA2\u6237\u7AEF\u5168\u79BB\u7EBF\u73AF\u5883\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileSystem.getLibrariesPaths")}async getProjectsPaths(){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");if(!r2)throw new Error("\u9519\u8BEF\uFF1A\u975E\u5BA2\u6237\u7AEF\u79BB\u7EBF\u73AF\u5883\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_FileSystem.getProjectsPaths")}};var gi=class e{static flushUI(){_.extensionApiMessageBus2.publish("/pro-ui/topMenu/advanced/extensionListMenu",_.extensionRegisteredHeaderMenus)}static reloadAllHeaderMenuLanguage(){for(let t of _.loadedExtensions)new e(t).reloadHeaderMenuLanguage();return{flushUI:e.flushUI}}constructor(t,i=!1,r=!1){this.uuid=t,this.isShowAtHeaderMenu=i,this.system=r}insertHeaderMenus(t){t.home&&(_.extensionRegisteredHeaderMenus.home=this.resolveHeaderMenus(t.home,_.extensionRegisteredHeaderMenus.home)),t.blank&&(_.extensionRegisteredHeaderMenus.blank=this.resolveHeaderMenus(t.blank,_.extensionRegisteredHeaderMenus.blank)),t.schematic&&(_.extensionRegisteredHeaderMenus.sch=this.resolveHeaderMenus(t.schematic,_.extensionRegisteredHeaderMenus.sch)),t.sch&&(_.extensionRegisteredHeaderMenus.sch=this.resolveHeaderMenus(t.sch,_.extensionRegisteredHeaderMenus.sch)),t.symbol&&(_.extensionRegisteredHeaderMenus.symbol=this.resolveHeaderMenus(t.symbol,_.extensionRegisteredHeaderMenus.symbol)),t.pcb&&(_.extensionRegisteredHeaderMenus.pcb=this.resolveHeaderMenus(t.pcb,_.extensionRegisteredHeaderMenus.pcb)),t.footprint&&(_.extensionRegisteredHeaderMenus.footprint=this.resolveHeaderMenus(t.footprint,_.extensionRegisteredHeaderMenus.footprint)),t.pcbView&&(_.extensionRegisteredHeaderMenus.pcbView=this.resolveHeaderMenus(t.pcbView,_.extensionRegisteredHeaderMenus.panelView)),t.panel&&(_.extensionRegisteredHeaderMenus.panel=this.resolveHeaderMenus(t.panel,_.extensionRegisteredHeaderMenus.panel)),t.panelView&&(_.extensionRegisteredHeaderMenus.panelView=this.resolveHeaderMenus(t.panelView,_.extensionRegisteredHeaderMenus.panelView))}removeHeaderMenus(){function t(i,r){let n=[];for(let s of r){if(s===null){n.push(s);continue}s.id.split("|")[0]!==i&&(n.push({...s}),Array.isArray(s.menuItems)&&(n[n.length-1].menuItems=t(i,s.menuItems)))}return n}for(let i in _.extensionRegisteredHeaderMenus)_.extensionRegisteredHeaderMenus[i]=_.extensionRegisteredHeaderMenus[i]&&t(this.uuid,_.extensionRegisteredHeaderMenus[i])}reloadIsShowAtHeaderMenuStatus(t){typeof t=="boolean"&&(this.isShowAtHeaderMenu=t);for(let i in _.extensionRegisteredHeaderMenus)for(let[r,n]of _.extensionRegisteredHeaderMenus[i].entries())n.id.split("|")[0]===this.uuid&&(_.extensionRegisteredHeaderMenus[i][r].isShowAtHeaderMenu=this.isShowAtHeaderMenu)}reloadHeaderMenuLanguage(){var t,i;if((i=(t=_.multilingualNamespaces)==null?void 0:t[this.uuid+".extensionJson"])!=null&&i[_.currentLanguage])for(let r in _.extensionRegisteredHeaderMenus)_.extensionRegisteredHeaderMenus[r]=this.recursivelyQueryAllTitle(_.extensionRegisteredHeaderMenus[r])}resolveHeaderMenuIdStr(t){if(t){if(this.system)return"eda|"+t;let i=t.toString().split("|").length;if(i===1)return this.uuid+"|"+t;if(i===2)return t}return this.uuid+"|"+Ol()}resolveHeaderMenuRegisterFnStr(t){if(t){let i=t.toString().split(".").length;if(i===1)return this.uuid+"."+t;if(i===2)return t}}isObjectHasValidIdValue(t,i){return t===i.id}getSameIdObjectIndexInObjectArray(t,i){if(!i)return null;let r;for(let[n,s]of i.entries())if(s!==null&&this.isObjectHasValidIdValue(t.id,s)){r=n;break}return r!==void 0?r:null}recursivelyQueryAllId(t){for(let i in t)i==="id"&&(t[i]=this.resolveHeaderMenuIdStr(t[i])),t[i]instanceof Object&&this.recursivelyQueryAllId(t[i]);return t}recursivelyQueryAllRegisterFn(t){for(let i in t)i==="registerFn"&&(t[i]=this.resolveHeaderMenuRegisterFnStr(t[i])),t[i]instanceof Object&&this.recursivelyQueryAllRegisterFn(t[i]);return t}recursivelyQueryAllTitle(t){for(let i in t)i==="title"&&typeof t.title=="string"&&(t.sourceTitle||(t.sourceTitle=t.title),t.id&&t.id.split("|")[0]===this.uuid&&(t.title=be.sys_I18n.text(t.sourceTitle,this.uuid+".extensionJson",_.currentLanguage))),t[i]instanceof Object&&this.recursivelyQueryAllTitle(t[i]);return t}resolveHeaderMenus(t,i){var r,n;return t=this.recursivelyQueryAllId(t),t=this.recursivelyQueryAllRegisterFn(t),(n=(r=_.multilingualNamespaces)==null?void 0:r[this.uuid+".extensionJson"])!=null&&n[_.currentLanguage]&&(t=this.recursivelyQueryAllTitle(t)),t.forEach(s=>{let a=this.getSameIdObjectIndexInObjectArray(s,i);a===null?i.push({...s,isShowAtHeaderMenu:this.isShowAtHeaderMenu}):s.menuItems&&(i[a].menuItems?s.menuItems.forEach(o=>{var u,c;if(o===null)return;let l=this.getSameIdObjectIndexInObjectArray(o,i[a].menuItems);l===null?(u=i[a].menuItems)==null||u.push(o):o.menuItems&&((c=i[a].menuItems[l])!=null&&c.menuItems?o.menuItems.forEach(h=>{var m;h!==null&&this.getSameIdObjectIndexInObjectArray(h,i[a].menuItems[l].menuItems)===null&&((m=i[a].menuItems[l].menuItems)==null||m.push(h))}):i[a].menuItems[l].menuItems=o.menuItems)}):i[a].menuItems=s.menuItems)}),i}};var aS=(u=>(u.HOME="home",u.BLANK="blank",u.SCHEMATIC="sch",u.SYMBOL="symbol",u.PCB="pcb",u.FOOTPRINT="footprint",u.PCB_VIEW="pcbView",u.PANEL="panel",u.PANEL_VIEW="panelView",u))(aS||{}),Ug=class{constructor(t){this.extensionUuid=t}async insertHeaderMenus(t){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");let i=await _.extensionIndexedDBUtils.get("extensionsIndex",this.extensionUuid);new gi(this.extensionUuid,i.isShowAtHeaderMenu).insertHeaderMenus(t),gi.flushUI()}removeHeaderMenus(){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");new gi(this.extensionUuid).removeHeaderMenus(),gi.flushUI()}async replaceHeaderMenus(t){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");new gi(this.extensionUuid).removeHeaderMenus();let i=await _.extensionIndexedDBUtils.get("extensionsIndex",this.extensionUuid);new gi(this.extensionUuid,i.isShowAtHeaderMenu).insertHeaderMenus(t),gi.flushUI()}async removeSystemHeaderMenuItem(t,i={removeTheBeforeDivider:!1,removeTheAfterDivider:!1}){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");return t.length<2||t[0]==="Advanced"?!1:await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_HeaderMenu.removeSystemHeaderMenuItem",{id:t,props:i})}async insertSystemHeaderMenuItem(t,i,r){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");if(i.length<2||i[0]==="Advanced"||typeof i[i.length-1]!="string"||i[i.length-1]==="")return;let n=Ac(i[i.length-1],this.extensionUuid,!0,!0);i[i.length-1]=n.extensionUuid+"|"+n.id;function s(c,h){if(c){let m=c.toString().split("|").length;if(m===1)return h+"|"+c;if(m===2)return c}}function a(c,h){if(c){let m=c.toString().split(".").length;if(m===1)return h+"."+c;if(m===2)return c}}function o(c,h){for(let m in c)m==="id"&&(c[m]=s(c[m],h)),c[m]instanceof Object&&o(c[m],h);return c}function l(c,h){for(let m in c)m==="registerFn"&&(c[m]=a(c[m],h)),c[m]instanceof Object&&l(c[m],h);return c}return r=o(r,this.extensionUuid),r=l(r,this.extensionUuid),await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_HeaderMenu.insertSystemHeaderMenuItem",{env:t,id:i,props:r,extensionUuid:this.extensionUuid})}insertSystemHeaderMenus(t){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");new gi(this.extensionUuid,!0,!0).insertHeaderMenus(t),gi.flushUI()}};var MD={"Please log in first":"Please log in first","No extensions selected that need to be imported!":"No extensions selected that need to be imported!","Extension install successful!":"Extension ${1} install successful!","Extension import successful!":"Extension ${1} import successful!","Extension upgrade successful!":"Extension ${1} upgrade successful!","Script code cannot be empty!":"Script code cannot be empty!","The script was updated successfully!":"The script was updated successfully!","The script was saved successfully!":"The script was saved successfully!","The script name cannot be empty!":"The script name cannot be empty!","Unable to get script name and script content!":"Unable to get script name and script content!","No scripts selected!":"No scripts selected!","The script has been removed!":"The script has been removed!","Unable to get script name!":"Unable to get script name!","Extension enabled!":"Extension enabled!","Extension disabled!":"Extension disabled!","Extension external interactions is enabled!":"Extension external interactions is enabled!","Extension external interactions is disabled!":"Extension external interactions is disabled!","Extension auto-update is enabled!":"Extension auto-update is enabled!","Extension auto-update is disabled!":"Extension auto-update is disabled!","Extension cloud-sync is enabled!":"Extension cloud-sync is enabled!","Extension cloud-sync is disabled!":"Extension cloud-sync is disabled!","Extension uninstalled!":"Extension ${1} v${2} uninstalled!",Tips:"Tips",Input:"Input",Select:"Select","The UUID of the extension is not up to specification!":"The UUID of the extension is not up to specification!","The extension menu will now be displayed at the top.":"The extension menu will now be displayed at the top.","The extension menu will now appear within the Advanced menu.":"The extension menu will now appear within the Advanced menu.","Standalone script was updated successfully!":"Standalone script ${1} was updated successfully!","Standalone script was saved successfully!":"Standalone script ${1} was saved successfully!","An unexpected error occurred while saving a standalone script.":"An unexpected error occurred while saving a standalone script named ${1}.","Start importing the standalone script(s).":"Start importing ${1} standalone script(s).","Standalone script import completed!":"Import completed! (${1} imported, ${2} updated, ${3} failed)","Standalone script has been removed!":"Standalone script ${1} has been removed!","Standalone script rename failed! The origin script not exist.":"Standalone script ${1} rename failed! The origin script not exist.","Standalone script rename failed! Please report this unexpected bug.":"Standalone script rename failed! Please report this unexpected bug.","Standalone script has been renamed.":"Standalone script ${1} has been renamed to ${2}.",Confirm:"Confirm",Cancel:"Cancel",'The extension must have the "name, version, entry" field and be in the correct format.':'The extension must have the "name, version, entry" field and be in the correct format.',"The incoming file doesn't seem to be the EasyEDA Pro extension.":"The incoming file doesn't seem to be the EasyEDA Pro extension."};var kD={"Please log in first":"\u8BF7\u5148\u767B\u5F55","No extensions selected that need to be imported!":"\u672A\u9009\u62E9\u4EFB\u4F55\u9700\u8981\u5BFC\u5165\u7684\u6269\u5C55\uFF01","Extension install successful!":"\u6269\u5C55 ${1} \u5B89\u88C5\u6210\u529F\uFF01","Extension import successful!":"\u6269\u5C55 ${1} \u5BFC\u5165\u6210\u529F\uFF01","Extension upgrade successful!":"\u6269\u5C55 ${1} \u66F4\u65B0\u6210\u529F\uFF01","Script code cannot be empty!":"\u811A\u672C\u4EE3\u7801\u4E0D\u80FD\u4E3A\u7A7A\uFF01","The script was updated successfully!":"\u811A\u672C\u66F4\u65B0\u6210\u529F\uFF01","The script was saved successfully!":"\u811A\u672C\u4FDD\u5B58\u6210\u529F\uFF01","The script name cannot be empty!":"\u811A\u672C\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A\uFF01","Unable to get script name and script content!":"\u65E0\u6CD5\u83B7\u53D6\u811A\u672C\u540D\u79F0\u4E0E\u811A\u672C\u5185\u5BB9\uFF01","No scripts selected!":"\u6CA1\u6709\u9009\u4E2D\u4EFB\u4F55\u811A\u672C\uFF01","The script has been removed!":"\u811A\u672C\u5DF2\u5220\u9664\uFF01","Unable to get script name!":"\u65E0\u6CD5\u83B7\u53D6\u811A\u672C\u540D\u79F0\uFF01","Extension enabled!":"\u6269\u5C55\u5DF2\u542F\u7528\uFF01","Extension disabled!":"\u6269\u5C55\u5DF2\u7981\u7528\uFF01","Extension external interactions is enabled!":"\u6269\u5C55\u5916\u90E8\u4EA4\u4E92\u529F\u80FD\u5DF2\u542F\u7528\uFF01","Extension external interactions is disabled!":"\u6269\u5C55\u5916\u90E8\u4EA4\u4E92\u529F\u80FD\u5DF2\u7981\u7528\uFF01","Extension auto-update is enabled!":"\u6269\u5C55\u81EA\u52A8\u66F4\u65B0\u5DF2\u542F\u7528\uFF01","Extension auto-update is disabled!":"\u6269\u5C55\u81EA\u52A8\u66F4\u65B0\u5DF2\u7981\u7528\uFF01","Extension cloud-sync is enabled!":"\u6269\u5C55\u4E91\u7AEF\u540C\u6B65\u5DF2\u542F\u7528\uFF01","Extension cloud-sync is disabled!":"\u6269\u5C55\u4E91\u7AEF\u540C\u6B65\u5DF2\u7981\u7528\uFF01","Extension uninstalled!":"\u6269\u5C55 ${1} v${2} \u5DF2\u5378\u8F7D\uFF01",Tips:"\u63D0\u793A",Input:"\u8F93\u5165",Select:"\u9009\u62E9","The UUID of the extension is not up to specification!":"\u6269\u5C55\u7684 UUID \u4E0D\u7B26\u5408\u89C4\u8303\uFF01","The extension menu will now be displayed at the top.":"\u6269\u5C55\u7684\u83DC\u5355\u5F53\u524D\u5C06\u663E\u793A\u5728\u9876\u90E8\u3002","The extension menu will now appear within the Advanced menu.":"\u6269\u5C55\u7684\u83DC\u5355\u5F53\u524D\u5C06\u663E\u793A\u5728\u201C\u9AD8\u7EA7\u201D\u83DC\u5355\u5185\u3002","Standalone script was updated successfully!":"\u72EC\u7ACB\u811A\u672C ${1} \u5DF2\u66F4\u65B0\uFF01","Standalone script was saved successfully!":"\u72EC\u7ACB\u811A\u672C ${1} \u5DF2\u4FDD\u5B58\uFF01","An unexpected error occurred while saving a standalone script.":"\u4FDD\u5B58\u72EC\u7ACB\u811A\u672C ${1} \u65F6\u9047\u5230\u4E86\u610F\u6599\u4E4B\u5916\u7684\u9519\u8BEF\u3002","Start importing the standalone script(s).":"\u5F00\u59CB\u5BFC\u5165 ${1} \u4E2A\u72EC\u7ACB\u811A\u672C\u3002","Standalone script import completed!":"\u5BFC\u5165\u5B8C\u6210\uFF01\uFF08${1} \u5BFC\u5165\u3001${2} \u66F4\u65B0\u3001${3} \u5931\u8D25\uFF09","Standalone script has been removed!":"\u72EC\u7ACB\u811A\u672C ${1} \u5DF2\u5220\u9664\uFF01","Standalone script rename failed! The origin script not exist.":"\u72EC\u7ACB\u811A\u672C ${1} \u91CD\u547D\u540D\u5931\u8D25\uFF01\u6E90\u811A\u672C\u4E0D\u5B58\u5728\u3002","Standalone script rename failed! Please report this unexpected bug.":"\u72EC\u7ACB\u811A\u672C\u91CD\u547D\u540D\u5931\u8D25\uFF01\u8FD9\u662F\u4E2A\u610F\u6599\u4E4B\u5916\u7684\u9519\u8BEF\uFF0C\u5E0C\u671B\u5F97\u5230\u53CD\u9988\u3002","Standalone script has been renamed.":"\u72EC\u7ACB\u811A\u672C ${1} \u5DF2\u88AB\u91CD\u547D\u540D\u4E3A ${2}\u3002",Confirm:"\u786E\u8BA4",Cancel:"\u53D6\u6D88",'The extension must have the "name, version, entry" field and be in the correct format.':"\u6269\u5C55\u5FC5\u987B\u62E5\u6709 name\u3001version \u548C entry \u5B57\u6BB5\u5E76\u7B26\u5408\u5176\u7EA6\u5B9A\u683C\u5F0F\u3002","The incoming file doesn't seem to be the EasyEDA Pro extension.":"\u4F20\u5165\u7684\u6587\u4EF6\u4F3C\u4E4E\u4E0D\u662F\u5609\u7ACB\u521B EDA \u4E13\u4E1A\u7248\u6269\u5C55\u7A0B\u5E8F\u3002"};var Ms="eda",gl=wf?"en":"zh-Hans",oS=["ar","bn","cs","de","en","es","fr","hi","ja","mr","ms","pa","pl","pt","ru","sv","ta","te","uk","ur","vi","zh","zh-Hans","zh-Hans-CN","zh-Hans-HK","zh-Hans-MO","zh-Hans-SG","zh-Hans-TW","zh-Hant","zh-Hant-CN","zh-Hant-HK","zh-Hant-MO","zh-Hant-SG","zh-Hant-TW","en-boont","en-scouse","gan","cdo","cjy","cmn","cnp","cpx","csp","czh","czo","hak","hsn","lzh","mnp","nan","wuu","yue"];_.multilingualNamespaces[Ms]={en:MD,"zh-Hans":kD};function $u(e,t,i){_.multilingualNamespaces[e]||(_.multilingualNamespaces[e]={}),_.multilingualNamespaces[e][t]||(_.multilingualNamespaces[e][t]={}),_.multilingualNamespaces[e][t]=Object.assign(_.multilingualNamespaces[e][t],i)}function FD(e,t){_.multilingualNamespaces[e]||(_.multilingualNamespaces[e]={}),_.multilingualNamespaces[e]=J_(_.multilingualNamespaces[e],t)}function mo(e){return hs(e,[...oS])}async function lS(){var t;switch((t=await Ln().rpcCall("getLanguage"))==null?void 0:t.message){case"zh-hans":return"zh-Hans";case"zh-hant":return"zh-Hant";case"en":return"en";case"pl":return"pl";case"ja":return"ja";case"fr":return"fr";case"es":return"es";case"de":return"de";case"sv":return"sv";case"ru":return"ru";case"uk":return"uk";case"vn":case"vi":return"vi";case"cs":return"cs";case"pt":return"pt";default:return gl}}async function uS(){_.currentLanguage=await lS()}var Hg=class{constructor(t){this.extensionUuid=t}text(t,i,r,...n){let s=i||this.extensionUuid||Ms,a=r||_.currentLanguage||gl;function o(l){for(let[u,c]of n.entries())l=l.replace(new RegExp(`\\$\\{${String(u+1)}\\}`,"g"),String(c));return l}if(i&&r){if(typeof _.multilingualNamespaces[i][r][t]=="string")return o(_.multilingualNamespaces[i][r][t])}else if(!i&&!r){if(typeof _.multilingualNamespaces[s][a][t]=="string")return o(_.multilingualNamespaces[s][a][t]);if(typeof _.multilingualNamespaces[s][gl][t]=="string")return o(_.multilingualNamespaces[s][gl][t]);if(this.extensionUuid){for(let l in _.multilingualNamespaces[this.extensionUuid])if(typeof _.multilingualNamespaces[this.extensionUuid][l][t]=="string")return o(_.multilingualNamespaces[this.extensionUuid][l][t])}else for(let l in _.multilingualNamespaces[Ms])if(typeof _.multilingualNamespaces[Ms][l][t]=="string")return o(_.multilingualNamespaces[Ms][l][t])}else if(i&&!r){if(typeof _.multilingualNamespaces[i][a][t]=="string")return o(_.multilingualNamespaces[i][a][t]);if(typeof _.multilingualNamespaces[i][gl][t]=="string")return o(_.multilingualNamespaces[i][gl][t]);for(let l in _.multilingualNamespaces[i])if(typeof _.multilingualNamespaces[i][l][t]=="string")return o(_.multilingualNamespaces[i][l][t])}else if(!i&&r){if(typeof _.multilingualNamespaces[s][r][t]=="string")return o(_.multilingualNamespaces[s][r][t]);if(this.extensionUuid&&typeof _.multilingualNamespaces[Ms][r][t]=="string")return o(_.multilingualNamespaces[Ms][r][t])}return t}async getCurrentLanguage(){return lS()}getAllSupportedLanguages(){return[...oS]}isLanguageSupported(t){return mo(t)}importMultilingual(t,i){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");return!this.extensionUuid||!mo(t)?!1:($u(this.extensionUuid,t,i),!0)}importMultilingualLanguage(t,i,r){return t===Ms||!mo(i)?!1:($u(t,i,r),!0)}importMultilingualNamespace(t,i){if(t===Ms)return!1;for(let r in i)if(!mo(r))return!1;return FD(t,i),!0}addLanguageChangedEventListener(t,i,r){for(let n of _.extension_SYS_I18nEvents)if(t===n.id)return;typeof i=="function"&&_.extension_SYS_I18nEvents.push({id:t,event:"languageChanged",callFn:i,onlyOnce:r})}removeEventListener(t){for(let[i,r]of _.extension_SYS_I18nEvents.entries())if(t===r.id)return _.extension_SYS_I18nEvents.splice(i,1),!0;return!1}isEventListenerAlreadyExist(t){for(let i of _.extension_SYS_I18nEvents)if(t===i.id)return!0;return!1}};var jg=class{constructor(t){this.extensionUuid=t}async openIFrame(t,i=500,r=500,n,s={maximizeButton:!1,minimizeButton:!1,grayscaleMask:!1}){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");if(n!=null&&n.includes(".")||n!=null&&n.includes(" ")||n!=null&&n.includes("|")||n!=null&&n.includes("/")||n!=null&&n.includes("\\")||n!=null&&n.includes("#")||n!=null&&n.includes("@"))throw new Error("\u9519\u8BEF\uFF1A\u5185\u8054\u6846\u67B6\u7A97\u53E3 ID \u4E0D\u80FD\u5305\u542B `.`\u3001` `\u3001`|`\u3001`/`\u3001`\\`\u3001`#`\u3001`@` \u7B26\u53F7\uFF01");let a=Ac(n,this.extensionUuid,!0,!0);return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_IFrame.openIFrame",{id:a.extensionUuid+"."+a.id,htmlFileName:t,width:i,height:r,extensionUuid:a.extensionUuid,extensionIndexedDBUtils:_.extensionIndexedDBUtils,props:s})}async closeIFrame(t){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");let i=Cc({fullIdStr:t,extensionUuid:this.extensionUuid});return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_IFrame.closeIFrame",{id:i})}async hideIFrame(t){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");let i=Cc({fullIdStr:t,extensionUuid:this.extensionUuid});return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_IFrame.hideIFrame",{id:i})}async showIFrame(t){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");let i=Cc({fullIdStr:t,extensionUuid:this.extensionUuid});return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_IFrame.showIFrame",{id:i})}async isIFrameAlreadyExist(t){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");let i=Cc({fullIdStr:t,extensionUuid:this.extensionUuid});return!1}};var Yg=class{showProgressBar(t=0,i="Progress Bar"){t=sC(t,0,100),t/=100,_.extensionApiMessageBus2.publish("extensionApi.SYS_LoadingAndProgressBar.showProgressBar",{progress:t,title:i})}destroyProgressBar(){_.extensionApiMessageBus2.publish("extensionApi.SYS_LoadingAndProgressBar.destroyProgressBar")}showLoading(){_.extensionApiMessageBus2.publish("extensionApi.SYS_LoadingAndProgressBar.showLoading")}destroyLoading(){_.extensionApiMessageBus2.publish("extensionApi.SYS_LoadingAndProgressBar.destroyLoading")}};var cS=(o=>(o.INFO="info",o.WARNING="warn",o.ERROR="error",o.FATAL_ERROR="fatalError",o.FIND="find",o.REPLACE="replace",o.OPEN_PROJECT="openProject",o))(cS||{}),Gg=class{add(t,i="info"){_.extensionApiMessageBus2.publish("extensionApi.SYS_Log.add",{message:t,type:i})}clear(){_.extensionApiMessageBus2.publish("extensionApi.SYS_Log.clear")}export(t){typeof t=="string"&&(t=[t]),_.extensionApiMessageBus2.publish("extensionApi.SYS_Log.export",t)}async sort(t){return typeof t=="string"&&(t=[t]),await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_Log.sort",t)}async find(t,i){return typeof i=="string"&&(i=[i]),await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_Log.find",{message:t,types:i})}};var nh=(s=>(s.ERROR="error",s.WARNING="warn",s.INFO="info",s.SUCCESS="success",s.ASK="question",s))(nh||{}),Wg=class{showToastMessage(t,i="info",r=3,n,s,a){switch(i){case 0:i="error";break;case 1:i="warn";break;case 2:i="info";break;case 3:i="success";break;case 4:i="question";break}Sa().publish("ui/toastMsg",{type:i,msg:typeof s=="string"&&typeof a=="string"?[t,{text:s,call:{name:"extensionApi.userScript",args:a,useMessageBus:!0}}]:t,timer:r,bottomBarMsg:n},An())}async showFollowMouseTip(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_Message.showFollowMouseTip",{tip:t,msTimeout:i})}async removeFollowMouseTip(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_Message.removeFollowMouseTip",{tip:t})}};var zg=class{showInformationMessage(t,i=be.sys_I18n.text("Tips"),r){_.extensionApiMessageBus2.publish("extensionApi.SYS_MessageBox.showInformationMessage",{content:t,title:i,buttonTitle:r})}showConfirmationMessage(t,i=be.sys_I18n.text("Tips"),r,n,s){_.extensionApiMessageBus2.publish("extensionApi.SYS_MessageBox.showConfirmationMessage",{content:t,title:i,mainButtonTitle:r,buttonTitle:n,callbackFn:s})}};var UD=Hn(yg());var Vg=class{constructor(t){this.extensionUuid=t}createPrivateMessageBus(){var t;if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u5185\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");(t=_.extensionSYS_MessageBus[this.extensionUuid])!=null&&t.messageBus||(_.extensionSYS_MessageBus[this.extensionUuid]=_.extensionSYS_MessageBus[this.extensionUuid]||{},_.extensionSYS_MessageBus[this.extensionUuid].messageBus=new UD.MessageBus2(!1))}removePrivateMessageBus(){var t;if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u5185\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");(t=_.extensionSYS_MessageBus[this.extensionUuid])!=null&&t.messageBus&&delete _.extensionSYS_MessageBus[this.extensionUuid].messageBus}push(t,i){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u5185\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");this.createPrivateMessageBus(),_.extensionSYS_MessageBus[this.extensionUuid].messageBus.push(t,i)}pushPublic(t,i){_.extensionSYS_MessageBus.public.messageBus.push(t,i)}pull(t,i){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u5185\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");this.createPrivateMessageBus();let r=_.extensionSYS_MessageBus[this.extensionUuid].messageBus.pull(t,i);return{cancel:r.cancel,running:r.running,execute:r.execute}}pullPublic(t,i){let r=_.extensionSYS_MessageBus.public.messageBus.pull(t,i);return{cancel:r.cancel,running:r.running,execute:r.execute}}pullAsync(t){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u5185\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");return this.createPrivateMessageBus(),_.extensionSYS_MessageBus[this.extensionUuid].messageBus.pullA(t)}pullAsyncPublic(t){return _.extensionSYS_MessageBus.public.messageBus.pullA(t)}publish(t,i){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u5185\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");this.createPrivateMessageBus(),_.extensionSYS_MessageBus[this.extensionUuid].messageBus.publish(t,i)}publishPublic(t,i){_.extensionSYS_MessageBus.public.messageBus.publish(t,i)}subscribe(t,i){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u5185\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");this.createPrivateMessageBus();let r=_.extensionSYS_MessageBus[this.extensionUuid].messageBus.subscribe(t,i);return{cancel:r.cancel,running:r.running,execute:r.execute}}subscribePublic(t,i){let r=_.extensionSYS_MessageBus.public.messageBus.subscribe(t,i);return{cancel:r.cancel,running:r.running,execute:r.execute}}subscribeOnce(t,i){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u5185\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");this.createPrivateMessageBus();let r=_.extensionSYS_MessageBus[this.extensionUuid].messageBus.subscribeOnce(t,i);return{cancel:r.cancel,running:r.running,execute:r.execute}}subscribeOncePublic(t,i){let r=_.extensionSYS_MessageBus.public.messageBus.subscribeOnce(t,i);return{cancel:r.cancel,running:r.running,execute:r.execute}}async rpcCall(t,i,r){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u5185\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");return this.createPrivateMessageBus(),_.extensionSYS_MessageBus[this.extensionUuid].messageBus.rpcCall(t,i,r)}async rpcCallPublic(t,i,r){return _.extensionSYS_MessageBus.public.messageBus.rpcCall(t,i,r)}rpcService(t,i){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u5185\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");this.createPrivateMessageBus(),_.extensionSYS_MessageBus[this.extensionUuid].messageBus.rpcService(t,i)}rpcServicePublic(t,i){_.extensionSYS_MessageBus.public.messageBus.rpcService(t,i)}};var dS=(s=>(s.PROJECT_LIST="project_list",s.PROJECT_DESIGN="projectDesign",s.LIB_DESIGN="libDesign",s.BASIC_LIBRARY="basicLibrary",s.DEVICE_STANDARDIZATION="device-standardization",s))(dS||{}),hS=(b=>(b.SCH_ATTR="sch-attr",b.SCH_FILTER="sch-filter",b.PROJECT_ATTR="project-attr",b.PANEL_LAYER="panel-layer",b.PANEL_ATTR="panel-attr",b.PANEL_FILTER="panel-filter",b.PCB_LAYER="pcb-layer",b.PCB_ATTR="pcb-attr",b.PCB_SKETCHER_ATTR="pcb-sketcher-attr",b.PCB_FILTER="pcb-filter",b.PCB_2D_PREVIEW_ATTR="pcb2d-attr",b.PCB_3D_PREVIEW_LAYER="pcb3d-layer",b.PCB_3D_PREVIEW_ATTR="pcb3d-attr",b.PANEL_3D_PREVIEW_LAYER="panel3d-layer",b.PANEL_3D_PREVIEW_ATTR="panel3d-attr",b.ANNOTATION="annotation",b))(hS||{}),pS=(s=>(s.LIBRARY="library",s.LOG="log",s.PCB_DRC="drcResult",s.SCHEMATIC_DRC="schDrcResult",s.FIND="findResult",s))(pS||{}),qg=class{openLeftPanel(t){_.extensionApiMessageBus2.publish("extensionApi.SYS_PanelControl.openLeftPanel",t)}closeLeftPanel(){_.extensionApiMessageBus2.publish("extensionApi.SYS_PanelControl.closeLeftPanel")}toggleLeftPanelLockState(t){_.extensionApiMessageBus2.publish("extensionApi.SYS_PanelControl.toggleLeftPanelLockState",t)}async isLeftPanelLocked(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_PanelControl.isLeftPanelLocked")}openRightPanel(t){_.extensionApiMessageBus2.publish("extensionApi.SYS_PanelControl.openRightPanel",t)}closeRightPanel(){_.extensionApiMessageBus2.publish("extensionApi.SYS_PanelControl.closeRightPanel")}toggleRightPanelLockState(t){_.extensionApiMessageBus2.publish("extensionApi.SYS_PanelControl.toggleRightPanelLockState",t)}async isRightPanelLocked(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_PanelControl.isRightPanelLocked")}openBottomPanel(t){_.extensionApiMessageBus2.publish("extensionApi.SYS_PanelControl.openBottomPanel",t)}closeBottomPanel(){_.extensionApiMessageBus2.publish("extensionApi.SYS_PanelControl.closeBottomPanel")}toggleBottomPanelLockState(t){_.extensionApiMessageBus2.publish("extensionApi.SYS_PanelControl.toggleBottomPanelLockState",t)}async isBottomPanelLocked(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_PanelControl.isBottomPanelLocked")}};var Xg=class{constructor(t){this.extensionUuid=t}async changeMenu(t,i){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");function r(l,u){if(l){let c=l.toString().split("|").length;if(c===1)return u+"|"+l;if(c===2)return l}}function n(l,u){if(l){let c=l.toString().split(".").length;if(c===1)return u+"."+l;if(c===2)return l}}function s(l,u){for(let c in l)c==="id"&&(l.registerFn||l.menuItems)&&(l[c]=r(l[c],u)),l[c]instanceof Object&&s(l[c],u);return l}function a(l,u){for(let c in l)c==="registerFn"&&(l[c]=n(l[c],u)),l[c]instanceof Object&&a(l[c],u);return l}return i=s(i,this.extensionUuid),i=a(i,this.extensionUuid),await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_RightClickMenu.changeMenu",{menuId:t,menuItems:i,extensionUuid:this.extensionUuid})}};var Jg=class{async restoreDefault(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_Setting.restoreDefault")}};var fS=(h=>(h[h.BLANK=0]="BLANK",h[h.HOME=1]="HOME",h[h.SCHEMATIC_PAGE=2]="SCHEMATIC_PAGE",h[h.SYMBOL=3]="SYMBOL",h[h.PCB=4]="PCB",h[h.FOOTPRINT=5]="FOOTPRINT",h[h.PANEL=6]="PANEL",h[h.PCB_3D_PREVIEW=7]="PCB_3D_PREVIEW",h[h.PCB_2D_PREVIEW=8]="PCB_2D_PREVIEW",h[h.PANEL_3D_PREVIEW=9]="PANEL_3D_PREVIEW",h[h.PANEL_LIBRARY=10]="PANEL_LIBRARY",h))(fS||{}),mS=(a=>(a[a.EDITOR=1]="EDITOR",a[a.SELECT_CANVAS=2]="SELECT_CANVAS",a[a.NOT_SELECT_CANVAS=3]="NOT_SELECT_CANVAS",a[a.DRAW=4]="DRAW",a[a.PLACE=5]="PLACE",a[a.LOCAL=6]="LOCAL",a))(mS||{}),$g=class{async registerShortcutKey(t,i,r,n=[0,1,2,3,4,5,6,7,8,9,10],s=[1,2,3,4,5]){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_ShortcutKey.registerShortcutKey",{shortcutKey:t,title:i,callbackFn:r,documentType:n,scene:s})}async unregisterShortcutKey(t){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_ShortcutKey.unregisterShortcutKey",t)}async getShortcutKeys(t=!1){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_ShortcutKey.getShortcutKeys",t)}};var Kg=class{constructor(t){this.extensionUuid=t}getExtensionAllUserConfigs(){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");return _.extensionUserConfigs[this.extensionUuid]}async setExtensionAllUserConfigs(t){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");let i=await _.extensionIndexedDBUtils.set("extensionsUserConfig",{uuid:this.extensionUuid,configs:t});return i&&(_.extensionUserConfigs[this.extensionUuid]={...t}),i}async clearExtensionAllUserConfigs(){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");let t=await _.extensionIndexedDBUtils.set("extensionsUserConfig",{uuid:this.extensionUuid,configs:{}});return t&&(_.extensionUserConfigs[this.extensionUuid]={}),t}getExtensionUserConfig(t){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");return _.extensionUserConfigs[this.extensionUuid][t]}async setExtensionUserConfig(t,i){var s;if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");let r=(s=_.extensionUserConfigs[this.extensionUuid])==null?void 0:s[t];_.extensionUserConfigs[this.extensionUuid][t]=i;let n=await _.extensionIndexedDBUtils.set("extensionsUserConfig",{uuid:this.extensionUuid,configs:_.extensionUserConfigs[this.extensionUuid]});return n||(r===void 0?delete _.extensionUserConfigs[this.extensionUuid][t]:_.extensionUserConfigs[this.extensionUuid][t]=r),n}async deleteExtensionUserConfig(t){if(!this.extensionUuid)throw new Error("\u9519\u8BEF\uFF1A\u975E\u6269\u5C55\u65E0\u6CD5\u8C03\u7528\u672C\u63A5\u53E3\uFF01");let i=await _.extensionIndexedDBUtils.get("extensionsUserConfig",this.extensionUuid);delete i.configs[t];let r=await _.extensionIndexedDBUtils.set("extensionsUserConfig",i);return r&&delete _.extensionUserConfigs[this.extensionUuid][t],r}};var Zg=class{constructor(t){this.extensionUuid=t}setIntervalTimer(t,i,r,...n){if(typeof t=="string"&&typeof i=="number"&&typeof r=="function"){this.clearIntervalTimer(t);let s=setInterval(r,i,...n);return _.extensionSYS_Timers.push({extensionUuid:this.extensionUuid,id:t,timerId:s}),!0}else return!1}clearIntervalTimer(t){for(let[i,r]of _.extensionSYS_Timers.entries())if(r.extensionUuid===this.extensionUuid&&r.id===t)return clearInterval(r.timerId),_.extensionSYS_Timers.splice(i,1),!0;return!1}setTimeoutTimer(t,i,r,...n){if(typeof t=="string"&&typeof i=="number"&&typeof r=="function"){this.clearTimeoutTimer(t);let a=setTimeout((o,l,...u)=>{for(let[c,h]of _.extensionSYS_Timers.entries())if(h.extensionUuid===o&&h.id===l){_.extensionSYS_Timers.splice(c,1);break}r(...u)},i,this.extensionUuid,t,...n);return _.extensionSYS_Timers.push({extensionUuid:this.extensionUuid,id:t,timerId:a}),!0}else return!1}clearTimeoutTimer(t){for(let[i,r]of _.extensionSYS_Timers.entries())if(r.extensionUuid===this.extensionUuid&&r.id===t)return clearTimeout(r.timerId),_.extensionSYS_Timers.splice(i,1),!0;return!1}};var Qg=class{showMessage(t,i="info",r=3,n,s,a){switch(i){case 0:i="error";break;case 1:i="warn";break;case 2:i="info";break;case 3:i="success";break;case 4:i="question";break}Sa().publish("ui/toastMsg",{type:i,msg:typeof s=="string"&&typeof a=="string"?[t,{text:s,call:{name:"extensionApi.userScript",args:a,useMessageBus:!0}}]:t,timer:r,bottomBarMsg:n},An())}};var ey=class{async netlistComparison(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_Tool.netlistComparison",{netlist1:t,netlist2:i})}};var ty=class{constructor(t){this.extensionUuid=t}register(t,i,r,n,s){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");let a,o=!1;for(let[l,u]of _.extensionSYS_WebSocketConnections.entries())if(u.extensionUuid===this.extensionUuid&&u.id===t){if(a=u.connection,(a==null?void 0:a.readyState)===WebSocket.CONNECTING||(a==null?void 0:a.readyState)===WebSocket.OPEN){if(n){n();return}o=!0}else u.receiveMessageCallFn&&a.removeEventListener("message",u.receiveMessageCallFn),u.connectedCallFn&&a.removeEventListener("open",u.connectedCallFn),_.extensionSYS_WebSocketConnections.splice(l,1);break}if(!o){try{a=new WebSocket(i,s)}catch{throw new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u5EFA\u7ACB WebSocket \u8FDE\u63A5\uFF01")}_.extensionSYS_WebSocketConnections.push({extensionUuid:this.extensionUuid,id:t,connection:a,receiveMessageCallFn:r,connectedCallFn:n}),r&&a&&a.addEventListener("message",r),n&&a&&a.addEventListener("open",n)}}send(t,i,r){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");r=r||this.extensionUuid;let n;for(let s of _.extensionSYS_WebSocketConnections)if(s.extensionUuid===r&&s.id===t){n=s.connection;break}if(!n)throw new Error("\u9519\u8BEF\uFF1A\u4E0D\u5B58\u5728\u5DF2\u6CE8\u518C\u7684 WebSocket \u8FDE\u63A5\uFF01");try{n.send(i)}catch{throw new Error("\u9519\u8BEF\uFF1AWebSocket \u6570\u636E\u53D1\u9001\u5931\u8D25\uFF01")}}close(t,i,r,n){if(!this.extensionUuid||!_.loadedExtensionsIsAllowExternalInteractions[this.extensionUuid])throw new Error("\u9519\u8BEF\uFF1A\u672A\u542F\u7528\u6269\u5C55\u548C\u72EC\u7ACB\u811A\u672C\u7684\u5916\u90E8\u4EA4\u4E92\u6743\u9650\uFF01");n=n||this.extensionUuid;for(let[s,a]of _.extensionSYS_WebSocketConnections.entries())if(a.extensionUuid===n&&a.id===t){a.receiveMessageCallFn&&a.connection.removeEventListener("message",a.receiveMessageCallFn),a.connectedCallFn&&a.connection.removeEventListener("open",a.connectedCallFn),a.connection.close(i,r),_.extensionSYS_WebSocketConnections.splice(s,1);break}}};var gS=(i=>(i.BLANK="_blank",i.SELF="_self",i))(gS||{}),yS=(i=>(i.BLUR="blur",i.FOCUS="focus",i))(yS||{}),_S=(i=>(i.LIGHT="light",i.DARK="dark",i))(_S||{}),iy=class{open(t,i="_blank"){i!=="_self"&&i!=="_blank"||window.open(t,i)}addEventListener(t,i,r){if(t!=="blur"&&t!=="focus")return;let n=s=>{let a=Object.entries(s).filter(([o])=>o!=="target"&&o!=="relatedTarget");return i(Object.fromEntries(a))};return window.addEventListener(t,n,r),{type:t,listener:n,options:r}}removeEventListener(t){window.removeEventListener(t.type,t.listener,t.options)}async openUI(t,i){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_Window.openUI",{uiName:t,args:i})}async getCurrentTheme(){return await _.extensionApiMessageBus2.rpcCall("extensionApi.SYS_Window.getCurrentTheme")}getUrlParam(t){return dp(t)}getUrlAnchor(){return window.location.hash}urlPushState(t){history.pushState({},"",t)}urlReplaceState(t){history.replaceState({},"",t)}};var sh=class{constructor(t){this.extensionUuid=t,this.dmt_Board=new hp,this.dmt_EditorControl=new pp,this.dmt_Folder=new fp,this.dmt_Panel=new mp,this.dmt_Pcb=new gp,this.dmt_Project=new Lf,this.dmt_Schematic=new Nf,this.dmt_SelectControl=new Df,this.dmt_Team=new Bf,this.dmt_Workspace=new Of,this.lib_3DModel=new Ff,this.lib_Cbb=new Uf,this.lib_Classification=new kf,this.lib_Device=new Yf,this.lib_Footprint=new Gf,this.lib_LibrariesList=new Wf(this.extensionUuid),this.lib_PanelLibrary=new zf,this.lib_SelectControl=new Vf,this.lib_Symbol=new Hf,this.pcb_Document=new um,this.pcb_Drc=new cm,this.pcb_Event=new dm,this.pcb_Layer=new Zf,this.pcb_ManufactureData=new sg,this.pcb_MathPolygon=new qf,this.pcb_Net=new ng,this.pcb_Primitive=new Xf,this.pcb_PrimitiveArc=new Kf,this.pcb_PrimitiveAttribute=new ag,this.pcb_PrimitiveComponent=new am,this.pcb_PrimitiveFill=new nm,this.pcb_PrimitiveDimension=new om,this.pcb_PrimitiveImage=new lm,this.pcb_PrimitiveLine=new $f,this.pcb_PrimitiveObject=new og,this.pcb_PrimitivePad=new sm,this.pcb_PrimitivePolyline=new rm,this.pcb_PrimitivePour=new im,this.pcb_PrimitivePoured=new Qf,this.pcb_PrimitiveRegion=new tm,this.pcb_PrimitiveString=new lg,this.pcb_PrimitiveVia=new Jf,this.pcb_SelectControl=new ug,this.pnl_Document=new cg,this.sch_Document=new dg,this.sch_Drc=new hg,this.sch_Event=new pg,this.sch_Netlist=new _g,this.sch_Primitive=new bg,this.sch_ManufactureData=new fg,this.sch_PrimitiveArc=new Pg,this.sch_PrimitiveBus=new Eg,this.sch_PrimitiveCircle=new Sg,fs()?this.sch_PrimitiveComponent=new xg:this.sch_PrimitiveComponent=new Ag,this.sch_PrimitivePin=new vg,this.sch_PrimitivePolygon=new wg,this.sch_PrimitiveRectangle=new Rg,this.sch_PrimitiveText=new Lg,this.sch_PrimitiveWire=new Ng,this.sch_SelectControl=new Dg,this.sch_Utils=new Bg,this.sys_ClientUrl=new Og(this.extensionUuid),this.sys_Dialog=new Mg,this.sys_Environment=new kg,this.sys_FileManager=new rg,this.sys_FileSystem=new Fg(this.extensionUuid),this.sys_FontManager=new zu,this.sys_HeaderMenu=new Ug(this.extensionUuid),this.sys_I18n=new Hg(this.extensionUuid),this.sys_IFrame=new jg(this.extensionUuid),this.sys_LoadingAndProgressBar=new Yg,this.sys_Log=new Gg,this.sys_Message=new Wg,this.sys_MessageBox=new zg,this.sys_MessageBus=new Vg(this.extensionUuid),this.sys_PanelControl=new qg,this.sys_RightClickMenu=new Xg(this.extensionUuid),this.sys_Setting=new Jg,this.sys_ShortcutKey=new $g,this.sys_Storage=new Kg(this.extensionUuid),this.sys_Timer=new Zg(this.extensionUuid),this.sys_ToastMessage=new Qg,this.sys_Tool=new ey,this.sys_Unit=new Mf,this.sys_WebSocket=new ty(this.extensionUuid),this.sys_Window=new iy}},be=new sh("eda");async function HD(){window._EXTAPI_ROOT_=be,_.extensionApiMessageBus2.subscribe("extensionApi.SCH_Event.mouseEvent",e=>{_.extensionSCH_Events.forEach(async(t,i)=>{t.event==="mouse"&&(t.eventType==="all"||t.eventType===e)&&(await t.callFn(e),t.onlyOnce&&_.extensionSCH_Events.splice(i,1))})}),_.extensionApiMessageBus2.subscribe("extensionApi.SCH_Event.primitiveEvent",e=>{_.extensionSCH_Events.forEach(async(t,i)=>{t.event==="primitive"&&(t.eventType==="all"||t.eventType===e.eventType)&&(await t.callFn(e.eventType,e.props),t.onlyOnce&&_.extensionSCH_Events.splice(i,1))})}),_.extensionApiMessageBus2.subscribe("extensionApi.PCB_Event.mouseEvent",e=>{typeof e=="string"&&(e={eventType:e,props:[]}),_.extensionPCB_Events.forEach(async(t,i)=>{t.event==="mouse"&&(t.eventType==="all"||t.eventType===e.eventType)&&(await t.callFn(e.eventType,e.props),t.onlyOnce&&_.extensionPCB_Events.splice(i,1))})}),_.extensionApiMessageBus2.subscribe("extensionApi.PCB_Event.primitiveEvent",e=>{_.extensionPCB_Events.forEach(async(t,i)=>{t.event==="primitive"&&(t.eventType==="all"||t.eventType===e.eventType)&&(await t.callFn(e.eventType,e.props),t.onlyOnce&&_.extensionPCB_Events.splice(i,1))})}),_.extensionApiMessageBus2.subscribe("extensionApi.PCB_Event.netEvent",e=>{_.extensionPCB_Events.forEach(async(t,i)=>{t.event==="net"&&(t.eventType==="all"||t.eventType===e.eventType)&&(await t.callFn(e.eventType,e.props),t.onlyOnce&&_.extensionPCB_Events.splice(i,1))})}),_.extensionApiMessageBus2.subscribe("extensionApi.PCB_Event.crossProbeSelectEvent",e=>{_.extensionPCB_Events.forEach(async t=>{t.event==="crossProbeSelect"&&await t.callFn(e.props)})}),_.extensionApiMessageBus2.rpcService("extensionApi.PCB_ManufactureData.updateAutoRouteRule",e=>{_.extensionPCB_ManufactureDataAutoRouteRule=e})}var uB=Hn(JD()),cB=Hn(FE()),NS=Hn(A_());var $D={"application/prs.cww":["cww"],"application/prs.xsf+xml":["xsf"],"application/vnd.1000minds.decision-model+xml":["1km"],"application/vnd.3gpp.pic-bw-large":["plb"],"application/vnd.3gpp.pic-bw-small":["psb"],"application/vnd.3gpp.pic-bw-var":["pvb"],"application/vnd.3gpp2.tcap":["tcap"],"application/vnd.3m.post-it-notes":["pwn"],"application/vnd.accpac.simply.aso":["aso"],"application/vnd.accpac.simply.imp":["imp"],"application/vnd.acucobol":["acu"],"application/vnd.acucorp":["atc","acutc"],"application/vnd.adobe.air-application-installer-package+zip":["air"],"application/vnd.adobe.formscentral.fcdt":["fcdt"],"application/vnd.adobe.fxp":["fxp","fxpl"],"application/vnd.adobe.xdp+xml":["xdp"],"application/vnd.adobe.xfdf":["*xfdf"],"application/vnd.age":["age"],"application/vnd.ahead.space":["ahead"],"application/vnd.airzip.filesecure.azf":["azf"],"application/vnd.airzip.filesecure.azs":["azs"],"application/vnd.amazon.ebook":["azw"],"application/vnd.americandynamics.acc":["acc"],"application/vnd.amiga.ami":["ami"],"application/vnd.android.package-archive":["apk"],"application/vnd.anser-web-certificate-issue-initiation":["cii"],"application/vnd.anser-web-funds-transfer-initiation":["fti"],"application/vnd.antix.game-component":["atx"],"application/vnd.apple.installer+xml":["mpkg"],"application/vnd.apple.keynote":["key"],"application/vnd.apple.mpegurl":["m3u8"],"application/vnd.apple.numbers":["numbers"],"application/vnd.apple.pages":["pages"],"application/vnd.apple.pkpass":["pkpass"],"application/vnd.aristanetworks.swi":["swi"],"application/vnd.astraea-software.iota":["iota"],"application/vnd.audiograph":["aep"],"application/vnd.autodesk.fbx":["fbx"],"application/vnd.balsamiq.bmml+xml":["bmml"],"application/vnd.blueice.multipass":["mpm"],"application/vnd.bmi":["bmi"],"application/vnd.businessobjects":["rep"],"application/vnd.chemdraw+xml":["cdxml"],"application/vnd.chipnuts.karaoke-mmd":["mmd"],"application/vnd.cinderella":["cdy"],"application/vnd.citationstyles.style+xml":["csl"],"application/vnd.claymore":["cla"],"application/vnd.cloanto.rp9":["rp9"],"application/vnd.clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"application/vnd.cluetrust.cartomobile-config":["c11amc"],"application/vnd.cluetrust.cartomobile-config-pkg":["c11amz"],"application/vnd.commonspace":["csp"],"application/vnd.contact.cmsg":["cdbcmsg"],"application/vnd.cosmocaller":["cmc"],"application/vnd.crick.clicker":["clkx"],"application/vnd.crick.clicker.keyboard":["clkk"],"application/vnd.crick.clicker.palette":["clkp"],"application/vnd.crick.clicker.template":["clkt"],"application/vnd.crick.clicker.wordbank":["clkw"],"application/vnd.criticaltools.wbs+xml":["wbs"],"application/vnd.ctc-posml":["pml"],"application/vnd.cups-ppd":["ppd"],"application/vnd.curl.car":["car"],"application/vnd.curl.pcurl":["pcurl"],"application/vnd.dart":["dart"],"application/vnd.data-vision.rdz":["rdz"],"application/vnd.dbf":["dbf"],"application/vnd.dcmp+xml":["dcmp"],"application/vnd.dece.data":["uvf","uvvf","uvd","uvvd"],"application/vnd.dece.ttml+xml":["uvt","uvvt"],"application/vnd.dece.unspecified":["uvx","uvvx"],"application/vnd.dece.zip":["uvz","uvvz"],"application/vnd.denovo.fcselayout-link":["fe_launch"],"application/vnd.dna":["dna"],"application/vnd.dolby.mlp":["mlp"],"application/vnd.dpgraph":["dpg"],"application/vnd.dreamfactory":["dfac"],"application/vnd.ds-keypoint":["kpxx"],"application/vnd.dvb.ait":["ait"],"application/vnd.dvb.service":["svc"],"application/vnd.dynageo":["geo"],"application/vnd.ecowin.chart":["mag"],"application/vnd.enliven":["nml"],"application/vnd.epson.esf":["esf"],"application/vnd.epson.msf":["msf"],"application/vnd.epson.quickanime":["qam"],"application/vnd.epson.salt":["slt"],"application/vnd.epson.ssf":["ssf"],"application/vnd.eszigno3+xml":["es3","et3"],"application/vnd.ezpix-album":["ez2"],"application/vnd.ezpix-package":["ez3"],"application/vnd.fdf":["*fdf"],"application/vnd.fdsn.mseed":["mseed"],"application/vnd.fdsn.seed":["seed","dataless"],"application/vnd.flographit":["gph"],"application/vnd.fluxtime.clip":["ftc"],"application/vnd.framemaker":["fm","frame","maker","book"],"application/vnd.frogans.fnc":["fnc"],"application/vnd.frogans.ltf":["ltf"],"application/vnd.fsc.weblaunch":["fsc"],"application/vnd.fujitsu.oasys":["oas"],"application/vnd.fujitsu.oasys2":["oa2"],"application/vnd.fujitsu.oasys3":["oa3"],"application/vnd.fujitsu.oasysgp":["fg5"],"application/vnd.fujitsu.oasysprs":["bh2"],"application/vnd.fujixerox.ddd":["ddd"],"application/vnd.fujixerox.docuworks":["xdw"],"application/vnd.fujixerox.docuworks.binder":["xbd"],"application/vnd.fuzzysheet":["fzs"],"application/vnd.genomatix.tuxedo":["txd"],"application/vnd.geogebra.file":["ggb"],"application/vnd.geogebra.slides":["ggs"],"application/vnd.geogebra.tool":["ggt"],"application/vnd.geometry-explorer":["gex","gre"],"application/vnd.geonext":["gxt"],"application/vnd.geoplan":["g2w"],"application/vnd.geospace":["g3w"],"application/vnd.gmx":["gmx"],"application/vnd.google-apps.document":["gdoc"],"application/vnd.google-apps.drawing":["gdraw"],"application/vnd.google-apps.form":["gform"],"application/vnd.google-apps.jam":["gjam"],"application/vnd.google-apps.map":["gmap"],"application/vnd.google-apps.presentation":["gslides"],"application/vnd.google-apps.script":["gscript"],"application/vnd.google-apps.site":["gsite"],"application/vnd.google-apps.spreadsheet":["gsheet"],"application/vnd.google-earth.kml+xml":["kml"],"application/vnd.google-earth.kmz":["kmz"],"application/vnd.gov.sk.xmldatacontainer+xml":["xdcf"],"application/vnd.grafeq":["gqf","gqs"],"application/vnd.groove-account":["gac"],"application/vnd.groove-help":["ghf"],"application/vnd.groove-identity-message":["gim"],"application/vnd.groove-injector":["grv"],"application/vnd.groove-tool-message":["gtm"],"application/vnd.groove-tool-template":["tpl"],"application/vnd.groove-vcard":["vcg"],"application/vnd.hal+xml":["hal"],"application/vnd.handheld-entertainment+xml":["zmm"],"application/vnd.hbci":["hbci"],"application/vnd.hhe.lesson-player":["les"],"application/vnd.hp-hpgl":["hpgl"],"application/vnd.hp-hpid":["hpid"],"application/vnd.hp-hps":["hps"],"application/vnd.hp-jlyt":["jlt"],"application/vnd.hp-pcl":["pcl"],"application/vnd.hp-pclxl":["pclxl"],"application/vnd.hydrostatix.sof-data":["sfd-hdstx"],"application/vnd.ibm.minipay":["mpy"],"application/vnd.ibm.modcap":["afp","listafp","list3820"],"application/vnd.ibm.rights-management":["irm"],"application/vnd.ibm.secure-container":["sc"],"application/vnd.iccprofile":["icc","icm"],"application/vnd.igloader":["igl"],"application/vnd.immervision-ivp":["ivp"],"application/vnd.immervision-ivu":["ivu"],"application/vnd.insors.igm":["igm"],"application/vnd.intercon.formnet":["xpw","xpx"],"application/vnd.intergeo":["i2g"],"application/vnd.intu.qbo":["qbo"],"application/vnd.intu.qfx":["qfx"],"application/vnd.ipunplugged.rcprofile":["rcprofile"],"application/vnd.irepository.package+xml":["irp"],"application/vnd.is-xpr":["xpr"],"application/vnd.isac.fcs":["fcs"],"application/vnd.jam":["jam"],"application/vnd.jcp.javame.midlet-rms":["rms"],"application/vnd.jisp":["jisp"],"application/vnd.joost.joda-archive":["joda"],"application/vnd.kahootz":["ktz","ktr"],"application/vnd.kde.karbon":["karbon"],"application/vnd.kde.kchart":["chrt"],"application/vnd.kde.kformula":["kfo"],"application/vnd.kde.kivio":["flw"],"application/vnd.kde.kontour":["kon"],"application/vnd.kde.kpresenter":["kpr","kpt"],"application/vnd.kde.kspread":["ksp"],"application/vnd.kde.kword":["kwd","kwt"],"application/vnd.kenameaapp":["htke"],"application/vnd.kidspiration":["kia"],"application/vnd.kinar":["kne","knp"],"application/vnd.koan":["skp","skd","skt","skm"],"application/vnd.kodak-descriptor":["sse"],"application/vnd.las.las+xml":["lasxml"],"application/vnd.llamagraphics.life-balance.desktop":["lbd"],"application/vnd.llamagraphics.life-balance.exchange+xml":["lbe"],"application/vnd.lotus-1-2-3":["123"],"application/vnd.lotus-approach":["apr"],"application/vnd.lotus-freelance":["pre"],"application/vnd.lotus-notes":["nsf"],"application/vnd.lotus-organizer":["org"],"application/vnd.lotus-screencam":["scm"],"application/vnd.lotus-wordpro":["lwp"],"application/vnd.macports.portpkg":["portpkg"],"application/vnd.mapbox-vector-tile":["mvt"],"application/vnd.mcd":["mcd"],"application/vnd.medcalcdata":["mc1"],"application/vnd.mediastation.cdkey":["cdkey"],"application/vnd.mfer":["mwf"],"application/vnd.mfmp":["mfm"],"application/vnd.micrografx.flo":["flo"],"application/vnd.micrografx.igx":["igx"],"application/vnd.mif":["mif"],"application/vnd.mobius.daf":["daf"],"application/vnd.mobius.dis":["dis"],"application/vnd.mobius.mbk":["mbk"],"application/vnd.mobius.mqy":["mqy"],"application/vnd.mobius.msl":["msl"],"application/vnd.mobius.plc":["plc"],"application/vnd.mobius.txf":["txf"],"application/vnd.mophun.application":["mpn"],"application/vnd.mophun.certificate":["mpc"],"application/vnd.mozilla.xul+xml":["xul"],"application/vnd.ms-artgalry":["cil"],"application/vnd.ms-cab-compressed":["cab"],"application/vnd.ms-excel":["xls","xlm","xla","xlc","xlt","xlw"],"application/vnd.ms-excel.addin.macroenabled.12":["xlam"],"application/vnd.ms-excel.sheet.binary.macroenabled.12":["xlsb"],"application/vnd.ms-excel.sheet.macroenabled.12":["xlsm"],"application/vnd.ms-excel.template.macroenabled.12":["xltm"],"application/vnd.ms-fontobject":["eot"],"application/vnd.ms-htmlhelp":["chm"],"application/vnd.ms-ims":["ims"],"application/vnd.ms-lrm":["lrm"],"application/vnd.ms-officetheme":["thmx"],"application/vnd.ms-outlook":["msg"],"application/vnd.ms-pki.seccat":["cat"],"application/vnd.ms-pki.stl":["*stl"],"application/vnd.ms-powerpoint":["ppt","pps","pot"],"application/vnd.ms-powerpoint.addin.macroenabled.12":["ppam"],"application/vnd.ms-powerpoint.presentation.macroenabled.12":["pptm"],"application/vnd.ms-powerpoint.slide.macroenabled.12":["sldm"],"application/vnd.ms-powerpoint.slideshow.macroenabled.12":["ppsm"],"application/vnd.ms-powerpoint.template.macroenabled.12":["potm"],"application/vnd.ms-project":["*mpp","mpt"],"application/vnd.ms-visio.viewer":["vdx"],"application/vnd.ms-word.document.macroenabled.12":["docm"],"application/vnd.ms-word.template.macroenabled.12":["dotm"],"application/vnd.ms-works":["wps","wks","wcm","wdb"],"application/vnd.ms-wpl":["wpl"],"application/vnd.ms-xpsdocument":["xps"],"application/vnd.mseq":["mseq"],"application/vnd.musician":["mus"],"application/vnd.muvee.style":["msty"],"application/vnd.mynfc":["taglet"],"application/vnd.nato.bindingdataobject+xml":["bdo"],"application/vnd.neurolanguage.nlu":["nlu"],"application/vnd.nitf":["ntf","nitf"],"application/vnd.noblenet-directory":["nnd"],"application/vnd.noblenet-sealer":["nns"],"application/vnd.noblenet-web":["nnw"],"application/vnd.nokia.n-gage.ac+xml":["*ac"],"application/vnd.nokia.n-gage.data":["ngdat"],"application/vnd.nokia.n-gage.symbian.install":["n-gage"],"application/vnd.nokia.radio-preset":["rpst"],"application/vnd.nokia.radio-presets":["rpss"],"application/vnd.novadigm.edm":["edm"],"application/vnd.novadigm.edx":["edx"],"application/vnd.novadigm.ext":["ext"],"application/vnd.oasis.opendocument.chart":["odc"],"application/vnd.oasis.opendocument.chart-template":["otc"],"application/vnd.oasis.opendocument.database":["odb"],"application/vnd.oasis.opendocument.formula":["odf"],"application/vnd.oasis.opendocument.formula-template":["odft"],"application/vnd.oasis.opendocument.graphics":["odg"],"application/vnd.oasis.opendocument.graphics-template":["otg"],"application/vnd.oasis.opendocument.image":["odi"],"application/vnd.oasis.opendocument.image-template":["oti"],"application/vnd.oasis.opendocument.presentation":["odp"],"application/vnd.oasis.opendocument.presentation-template":["otp"],"application/vnd.oasis.opendocument.spreadsheet":["ods"],"application/vnd.oasis.opendocument.spreadsheet-template":["ots"],"application/vnd.oasis.opendocument.text":["odt"],"application/vnd.oasis.opendocument.text-master":["odm"],"application/vnd.oasis.opendocument.text-template":["ott"],"application/vnd.oasis.opendocument.text-web":["oth"],"application/vnd.olpc-sugar":["xo"],"application/vnd.oma.dd2+xml":["dd2"],"application/vnd.openblox.game+xml":["obgx"],"application/vnd.openofficeorg.extension":["oxt"],"application/vnd.openstreetmap.data+xml":["osm"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/vnd.openxmlformats-officedocument.presentationml.slide":["sldx"],"application/vnd.openxmlformats-officedocument.presentationml.slideshow":["ppsx"],"application/vnd.openxmlformats-officedocument.presentationml.template":["potx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.template":["xltx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.template":["dotx"],"application/vnd.osgeo.mapguide.package":["mgp"],"application/vnd.osgi.dp":["dp"],"application/vnd.osgi.subsystem":["esa"],"application/vnd.palm":["pdb","pqa","oprc"],"application/vnd.pawaafile":["paw"],"application/vnd.pg.format":["str"],"application/vnd.pg.osasli":["ei6"],"application/vnd.picsel":["efif"],"application/vnd.pmi.widget":["wg"],"application/vnd.pocketlearn":["plf"],"application/vnd.powerbuilder6":["pbd"],"application/vnd.previewsystems.box":["box"],"application/vnd.procrate.brushset":["brushset"],"application/vnd.procreate.brush":["brush"],"application/vnd.procreate.dream":["drm"],"application/vnd.proteus.magazine":["mgz"],"application/vnd.publishare-delta-tree":["qps"],"application/vnd.pvi.ptid1":["ptid"],"application/vnd.pwg-xhtml-print+xml":["xhtm"],"application/vnd.quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"application/vnd.rar":["rar"],"application/vnd.realvnc.bed":["bed"],"application/vnd.recordare.musicxml":["mxl"],"application/vnd.recordare.musicxml+xml":["musicxml"],"application/vnd.rig.cryptonote":["cryptonote"],"application/vnd.rim.cod":["cod"],"application/vnd.rn-realmedia":["rm"],"application/vnd.rn-realmedia-vbr":["rmvb"],"application/vnd.route66.link66+xml":["link66"],"application/vnd.sailingtracker.track":["st"],"application/vnd.seemail":["see"],"application/vnd.sema":["sema"],"application/vnd.semd":["semd"],"application/vnd.semf":["semf"],"application/vnd.shana.informed.formdata":["ifm"],"application/vnd.shana.informed.formtemplate":["itp"],"application/vnd.shana.informed.interchange":["iif"],"application/vnd.shana.informed.package":["ipk"],"application/vnd.simtech-mindmapper":["twd","twds"],"application/vnd.smaf":["mmf"],"application/vnd.smart.teacher":["teacher"],"application/vnd.software602.filler.form+xml":["fo"],"application/vnd.solent.sdkm+xml":["sdkm","sdkd"],"application/vnd.spotfire.dxp":["dxp"],"application/vnd.spotfire.sfs":["sfs"],"application/vnd.stardivision.calc":["sdc"],"application/vnd.stardivision.draw":["sda"],"application/vnd.stardivision.impress":["sdd"],"application/vnd.stardivision.math":["smf"],"application/vnd.stardivision.writer":["sdw","vor"],"application/vnd.stardivision.writer-global":["sgl"],"application/vnd.stepmania.package":["smzip"],"application/vnd.stepmania.stepchart":["sm"],"application/vnd.sun.wadl+xml":["wadl"],"application/vnd.sun.xml.calc":["sxc"],"application/vnd.sun.xml.calc.template":["stc"],"application/vnd.sun.xml.draw":["sxd"],"application/vnd.sun.xml.draw.template":["std"],"application/vnd.sun.xml.impress":["sxi"],"application/vnd.sun.xml.impress.template":["sti"],"application/vnd.sun.xml.math":["sxm"],"application/vnd.sun.xml.writer":["sxw"],"application/vnd.sun.xml.writer.global":["sxg"],"application/vnd.sun.xml.writer.template":["stw"],"application/vnd.sus-calendar":["sus","susp"],"application/vnd.svd":["svd"],"application/vnd.symbian.install":["sis","sisx"],"application/vnd.syncml+xml":["xsm"],"application/vnd.syncml.dm+wbxml":["bdm"],"application/vnd.syncml.dm+xml":["xdm"],"application/vnd.syncml.dmddf+xml":["ddf"],"application/vnd.tao.intent-module-archive":["tao"],"application/vnd.tcpdump.pcap":["pcap","cap","dmp"],"application/vnd.tmobile-livetv":["tmo"],"application/vnd.trid.tpt":["tpt"],"application/vnd.triscape.mxs":["mxs"],"application/vnd.trueapp":["tra"],"application/vnd.ufdl":["ufd","ufdl"],"application/vnd.uiq.theme":["utz"],"application/vnd.umajin":["umj"],"application/vnd.unity":["unityweb"],"application/vnd.uoml+xml":["uoml","uo"],"application/vnd.vcx":["vcx"],"application/vnd.visio":["vsd","vst","vss","vsw","vsdx","vtx"],"application/vnd.visionary":["vis"],"application/vnd.vsf":["vsf"],"application/vnd.wap.wbxml":["wbxml"],"application/vnd.wap.wmlc":["wmlc"],"application/vnd.wap.wmlscriptc":["wmlsc"],"application/vnd.webturbo":["wtb"],"application/vnd.wolfram.player":["nbp"],"application/vnd.wordperfect":["wpd"],"application/vnd.wqd":["wqd"],"application/vnd.wt.stf":["stf"],"application/vnd.xara":["xar"],"application/vnd.xfdl":["xfdl"],"application/vnd.yamaha.hv-dic":["hvd"],"application/vnd.yamaha.hv-script":["hvs"],"application/vnd.yamaha.hv-voice":["hvp"],"application/vnd.yamaha.openscoreformat":["osf"],"application/vnd.yamaha.openscoreformat.osfpvg+xml":["osfpvg"],"application/vnd.yamaha.smaf-audio":["saf"],"application/vnd.yamaha.smaf-phrase":["spf"],"application/vnd.yellowriver-custom-menu":["cmp"],"application/vnd.zul":["zir","zirz"],"application/vnd.zzazz.deck+xml":["zaz"],"application/x-7z-compressed":["7z"],"application/x-abiword":["abw"],"application/x-ace-compressed":["ace"],"application/x-apple-diskimage":["*dmg"],"application/x-arj":["arj"],"application/x-authorware-bin":["aab","x32","u32","vox"],"application/x-authorware-map":["aam"],"application/x-authorware-seg":["aas"],"application/x-bcpio":["bcpio"],"application/x-bdoc":["*bdoc"],"application/x-bittorrent":["torrent"],"application/x-blender":["blend"],"application/x-blorb":["blb","blorb"],"application/x-bzip":["bz"],"application/x-bzip2":["bz2","boz"],"application/x-cbr":["cbr","cba","cbt","cbz","cb7"],"application/x-cdlink":["vcd"],"application/x-cfs-compressed":["cfs"],"application/x-chat":["chat"],"application/x-chess-pgn":["pgn"],"application/x-chrome-extension":["crx"],"application/x-cocoa":["cco"],"application/x-compressed":["*rar"],"application/x-conference":["nsc"],"application/x-cpio":["cpio"],"application/x-csh":["csh"],"application/x-debian-package":["*deb","udeb"],"application/x-dgc-compressed":["dgc"],"application/x-director":["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"],"application/x-doom":["wad"],"application/x-dtbncx+xml":["ncx"],"application/x-dtbook+xml":["dtb"],"application/x-dtbresource+xml":["res"],"application/x-dvi":["dvi"],"application/x-envoy":["evy"],"application/x-eva":["eva"],"application/x-font-bdf":["bdf"],"application/x-font-ghostscript":["gsf"],"application/x-font-linux-psf":["psf"],"application/x-font-pcf":["pcf"],"application/x-font-snf":["snf"],"application/x-font-type1":["pfa","pfb","pfm","afm"],"application/x-freearc":["arc"],"application/x-futuresplash":["spl"],"application/x-gca-compressed":["gca"],"application/x-glulx":["ulx"],"application/x-gnumeric":["gnumeric"],"application/x-gramps-xml":["gramps"],"application/x-gtar":["gtar"],"application/x-hdf":["hdf"],"application/x-httpd-php":["php"],"application/x-install-instructions":["install"],"application/x-ipynb+json":["ipynb"],"application/x-iso9660-image":["*iso"],"application/x-iwork-keynote-sffkey":["*key"],"application/x-iwork-numbers-sffnumbers":["*numbers"],"application/x-iwork-pages-sffpages":["*pages"],"application/x-java-archive-diff":["jardiff"],"application/x-java-jnlp-file":["jnlp"],"application/x-keepass2":["kdbx"],"application/x-latex":["latex"],"application/x-lua-bytecode":["luac"],"application/x-lzh-compressed":["lzh","lha"],"application/x-makeself":["run"],"application/x-mie":["mie"],"application/x-mobipocket-ebook":["*prc","mobi"],"application/x-ms-application":["application"],"application/x-ms-shortcut":["lnk"],"application/x-ms-wmd":["wmd"],"application/x-ms-wmz":["wmz"],"application/x-ms-xbap":["xbap"],"application/x-msaccess":["mdb"],"application/x-msbinder":["obd"],"application/x-mscardfile":["crd"],"application/x-msclip":["clp"],"application/x-msdos-program":["*exe"],"application/x-msdownload":["*exe","*dll","com","bat","*msi"],"application/x-msmediaview":["mvb","m13","m14"],"application/x-msmetafile":["*wmf","*wmz","*emf","emz"],"application/x-msmoney":["mny"],"application/x-mspublisher":["pub"],"application/x-msschedule":["scd"],"application/x-msterminal":["trm"],"application/x-mswrite":["wri"],"application/x-netcdf":["nc","cdf"],"application/x-ns-proxy-autoconfig":["pac"],"application/x-nzb":["nzb"],"application/x-perl":["pl","pm"],"application/x-pilot":["*prc","*pdb"],"application/x-pkcs12":["p12","pfx"],"application/x-pkcs7-certificates":["p7b","spc"],"application/x-pkcs7-certreqresp":["p7r"],"application/x-rar-compressed":["*rar"],"application/x-redhat-package-manager":["rpm"],"application/x-research-info-systems":["ris"],"application/x-sea":["sea"],"application/x-sh":["sh"],"application/x-shar":["shar"],"application/x-shockwave-flash":["swf"],"application/x-silverlight-app":["xap"],"application/x-sql":["*sql"],"application/x-stuffit":["sit"],"application/x-stuffitx":["sitx"],"application/x-subrip":["srt"],"application/x-sv4cpio":["sv4cpio"],"application/x-sv4crc":["sv4crc"],"application/x-t3vm-image":["t3"],"application/x-tads":["gam"],"application/x-tar":["tar"],"application/x-tcl":["tcl","tk"],"application/x-tex":["tex"],"application/x-tex-tfm":["tfm"],"application/x-texinfo":["texinfo","texi"],"application/x-tgif":["*obj"],"application/x-ustar":["ustar"],"application/x-virtualbox-hdd":["hdd"],"application/x-virtualbox-ova":["ova"],"application/x-virtualbox-ovf":["ovf"],"application/x-virtualbox-vbox":["vbox"],"application/x-virtualbox-vbox-extpack":["vbox-extpack"],"application/x-virtualbox-vdi":["vdi"],"application/x-virtualbox-vhd":["vhd"],"application/x-virtualbox-vmdk":["vmdk"],"application/x-wais-source":["src"],"application/x-web-app-manifest+json":["webapp"],"application/x-x509-ca-cert":["der","crt","pem"],"application/x-xfig":["fig"],"application/x-xliff+xml":["*xlf"],"application/x-xpinstall":["xpi"],"application/x-xz":["xz"],"application/x-zip-compressed":["*zip"],"application/x-zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"audio/vnd.dece.audio":["uva","uvva"],"audio/vnd.digital-winds":["eol"],"audio/vnd.dra":["dra"],"audio/vnd.dts":["dts"],"audio/vnd.dts.hd":["dtshd"],"audio/vnd.lucent.voice":["lvp"],"audio/vnd.ms-playready.media.pya":["pya"],"audio/vnd.nuera.ecelp4800":["ecelp4800"],"audio/vnd.nuera.ecelp7470":["ecelp7470"],"audio/vnd.nuera.ecelp9600":["ecelp9600"],"audio/vnd.rip":["rip"],"audio/x-aac":["*aac"],"audio/x-aiff":["aif","aiff","aifc"],"audio/x-caf":["caf"],"audio/x-flac":["flac"],"audio/x-m4a":["*m4a"],"audio/x-matroska":["mka"],"audio/x-mpegurl":["m3u"],"audio/x-ms-wax":["wax"],"audio/x-ms-wma":["wma"],"audio/x-pn-realaudio":["ram","ra"],"audio/x-pn-realaudio-plugin":["rmp"],"audio/x-realaudio":["*ra"],"audio/x-wav":["*wav"],"chemical/x-cdx":["cdx"],"chemical/x-cif":["cif"],"chemical/x-cmdf":["cmdf"],"chemical/x-cml":["cml"],"chemical/x-csml":["csml"],"chemical/x-xyz":["xyz"],"image/prs.btif":["btif","btf"],"image/prs.pti":["pti"],"image/vnd.adobe.photoshop":["psd"],"image/vnd.airzip.accelerator.azv":["azv"],"image/vnd.blockfact.facti":["facti"],"image/vnd.dece.graphic":["uvi","uvvi","uvg","uvvg"],"image/vnd.djvu":["djvu","djv"],"image/vnd.dvb.subtitle":["*sub"],"image/vnd.dwg":["dwg"],"image/vnd.dxf":["dxf"],"image/vnd.fastbidsheet":["fbs"],"image/vnd.fpx":["fpx"],"image/vnd.fst":["fst"],"image/vnd.fujixerox.edmics-mmr":["mmr"],"image/vnd.fujixerox.edmics-rlc":["rlc"],"image/vnd.microsoft.icon":["ico"],"image/vnd.ms-dds":["dds"],"image/vnd.ms-modi":["mdi"],"image/vnd.ms-photo":["wdp"],"image/vnd.net-fpx":["npx"],"image/vnd.pco.b16":["b16"],"image/vnd.tencent.tap":["tap"],"image/vnd.valve.source.texture":["vtf"],"image/vnd.wap.wbmp":["wbmp"],"image/vnd.xiff":["xif"],"image/vnd.zbrush.pcx":["pcx"],"image/x-3ds":["3ds"],"image/x-adobe-dng":["dng"],"image/x-cmu-raster":["ras"],"image/x-cmx":["cmx"],"image/x-freehand":["fh","fhc","fh4","fh5","fh7"],"image/x-icon":["*ico"],"image/x-jng":["jng"],"image/x-mrsid-image":["sid"],"image/x-ms-bmp":["*bmp"],"image/x-pcx":["*pcx"],"image/x-pict":["pic","pct"],"image/x-portable-anymap":["pnm"],"image/x-portable-bitmap":["pbm"],"image/x-portable-graymap":["pgm"],"image/x-portable-pixmap":["ppm"],"image/x-rgb":["rgb"],"image/x-tga":["tga"],"image/x-xbitmap":["xbm"],"image/x-xpixmap":["xpm"],"image/x-xwindowdump":["xwd"],"message/vnd.wfa.wsc":["wsc"],"model/vnd.bary":["bary"],"model/vnd.cld":["cld"],"model/vnd.collada+xml":["dae"],"model/vnd.dwf":["dwf"],"model/vnd.gdl":["gdl"],"model/vnd.gtw":["gtw"],"model/vnd.mts":["*mts"],"model/vnd.opengex":["ogex"],"model/vnd.parasolid.transmit.binary":["x_b"],"model/vnd.parasolid.transmit.text":["x_t"],"model/vnd.pytha.pyox":["pyo","pyox"],"model/vnd.sap.vds":["vds"],"model/vnd.usda":["usda"],"model/vnd.usdz+zip":["usdz"],"model/vnd.valve.source.compiled-map":["bsp"],"model/vnd.vtu":["vtu"],"text/prs.lines.tag":["dsc"],"text/vnd.curl":["curl"],"text/vnd.curl.dcurl":["dcurl"],"text/vnd.curl.mcurl":["mcurl"],"text/vnd.curl.scurl":["scurl"],"text/vnd.dvb.subtitle":["sub"],"text/vnd.familysearch.gedcom":["ged"],"text/vnd.fly":["fly"],"text/vnd.fmi.flexstor":["flx"],"text/vnd.graphviz":["gv"],"text/vnd.in3d.3dml":["3dml"],"text/vnd.in3d.spot":["spot"],"text/vnd.sun.j2me.app-descriptor":["jad"],"text/vnd.wap.wml":["wml"],"text/vnd.wap.wmlscript":["wmls"],"text/x-asm":["s","asm"],"text/x-c":["c","cc","cxx","cpp","h","hh","dic"],"text/x-component":["htc"],"text/x-fortran":["f","for","f77","f90"],"text/x-handlebars-template":["hbs"],"text/x-java-source":["java"],"text/x-lua":["lua"],"text/x-markdown":["mkd"],"text/x-nfo":["nfo"],"text/x-opml":["opml"],"text/x-org":["*org"],"text/x-pascal":["p","pas"],"text/x-processing":["pde"],"text/x-sass":["sass"],"text/x-scss":["scss"],"text/x-setext":["etx"],"text/x-sfv":["sfv"],"text/x-suse-ymp":["ymp"],"text/x-uuencode":["uu"],"text/x-vcalendar":["vcs"],"text/x-vcard":["vcf"],"video/vnd.dece.hd":["uvh","uvvh"],"video/vnd.dece.mobile":["uvm","uvvm"],"video/vnd.dece.pd":["uvp","uvvp"],"video/vnd.dece.sd":["uvs","uvvs"],"video/vnd.dece.video":["uvv","uvvv"],"video/vnd.dvb.file":["dvb"],"video/vnd.fvt":["fvt"],"video/vnd.mpegurl":["mxu","m4u"],"video/vnd.ms-playready.media.pyv":["pyv"],"video/vnd.uvvu.mp4":["uvu","uvvu"],"video/vnd.vivo":["viv"],"video/x-f4v":["f4v"],"video/x-fli":["fli"],"video/x-flv":["flv"],"video/x-m4v":["m4v"],"video/x-matroska":["mkv","mk3d","mks"],"video/x-mng":["mng"],"video/x-ms-asf":["asf","asx"],"video/x-ms-vob":["vob"],"video/x-ms-wm":["wm"],"video/x-ms-wmv":["wmv"],"video/x-ms-wmx":["wmx"],"video/x-ms-wvx":["wvx"],"video/x-msvideo":["avi"],"video/x-sgi-movie":["movie"],"video/x-smv":["smv"],"x-conference/x-cooltalk":["ice"]};Object.freeze($D);var KD=$D;var ZD={"application/andrew-inset":["ez"],"application/appinstaller":["appinstaller"],"application/applixware":["aw"],"application/appx":["appx"],"application/appxbundle":["appxbundle"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/automationml-aml+xml":["aml"],"application/automationml-amlx+zip":["amlx"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cpl+xml":["cpl"],"application/cu-seeme":["cu"],"application/cwl":["cwl"],"application/dash+xml":["mpd"],"application/dash-patch+xml":["mpp"],"application/davmount+xml":["davmount"],"application/dicom":["dcm"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdf":["fdf"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["*js"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/media-policy-dataset+xml":["mpf"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["*mp4","*mpg4","mp4s","m4p"],"application/msix":["msix"],"application/msixbundle":["msixbundle"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg","one","onea"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-keys":["asc"],"application/pgp-signature":["sig","*asc"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/sql":["sql"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/watcherinfo+xml":["wif"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xfdf":["xfdf"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"application/zip+dotlottie":["lottie"],"audio/3gpp":["*3gpp"],"audio/aac":["adts","aac"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a","m4b"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avci":["avci"],"image/avcs":["avcs"],"image/avif":["avif"],"image/bmp":["bmp","dib"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/dpx":["dpx"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/ief":["ief"],"image/jaii":["jaii"],"image/jais":["jais"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpg","jpeg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm","jpgm"],"image/jpx":["jpx","jpf"],"image/jxl":["jxl"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/pjpeg":["jfif"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime","mht","mhtml"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/jt":["jt"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/prc":["prc"],"model/step":["step","stp","stpnc","p21","210"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/u3d":["u3d"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/javascript":["js","mjs"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["md","markdown"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/wgsl":["wgsl"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","*jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts","m2t","m2ts","mts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]};Object.freeze(ZD);var QD=ZD;var Bn=function(e,t,i,r){if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?r:i==="a"?r.call(e):r?r.value:t.get(e)},Qu,oh,yl,AS=class{constructor(...t){Qu.set(this,new Map),oh.set(this,new Map),yl.set(this,new Map);for(let i of t)this.define(i)}define(t,i=!1){for(let[r,n]of Object.entries(t)){r=r.toLowerCase(),n=n.map(o=>o.toLowerCase()),Bn(this,yl,"f").has(r)||Bn(this,yl,"f").set(r,new Set);let s=Bn(this,yl,"f").get(r),a=!0;for(let o of n){let l=o.startsWith("*");if(o=l?o.slice(1):o,s==null||s.add(o),a&&Bn(this,oh,"f").set(r,o),a=!1,l)continue;let u=Bn(this,Qu,"f").get(o);if(u&&u!=r&&!i)throw new Error(`"${r} -> ${o}" conflicts with "${u} -> ${o}". Pass \`force=true\` to override this definition.`);Bn(this,Qu,"f").set(o,r)}}return this}getType(t){var a;if(typeof t!="string")return null;let i=t.replace(/^.*[/\\]/s,"").toLowerCase(),r=i.replace(/^.*\./s,"").toLowerCase(),n=i.length<t.length;return!(r.length<i.length-1)&&n?null:(a=Bn(this,Qu,"f").get(r))!=null?a:null}getExtension(t){var i,r;return typeof t!="string"?null:(t=(i=t==null?void 0:t.split)==null?void 0:i.call(t,";")[0],(r=t&&Bn(this,oh,"f").get(t.trim().toLowerCase()))!=null?r:null)}getAllExtensions(t){var i;return typeof t!="string"?null:(i=Bn(this,yl,"f").get(t.toLowerCase()))!=null?i:null}_freeze(){this.define=()=>{throw new Error("define() not allowed for built-in Mime objects. See https://github.com/broofa/mime/blob/main/README.md#custom-mime-instances")},Object.freeze(this);for(let t of Bn(this,yl,"f").values())Object.freeze(t);return this}_getTestState(){return{types:Bn(this,Qu,"f"),extensions:Bn(this,oh,"f")}}};Qu=new WeakMap,oh=new WeakMap,yl=new WeakMap;var CS=AS;var eB=new CS(QD,KD)._freeze();var go=Hn(tB());var ay=class{constructor(t){var i,r,n,s,a,o,l,u;if(typeof t!="object")throw new Error;if(typeof(t==null?void 0:t.name)=="string")tC(t.name)?this.name=t.name.trim():new Error;else throw new Error;if(typeof(t==null?void 0:t.uuid)=="string"&&(Ic(t.uuid,void 0,!1)?this.uuid=t.uuid.trim():this.uuid=void 0),typeof(t==null?void 0:t.displayName)=="string"&&(this.displayName=(0,go.escape)(t.displayName.trim())),typeof(t==null?void 0:t.description)=="string"&&(this.description=(0,go.escape)(t.description.trim())),typeof(t==null?void 0:t.version)=="string")iC(t.version)?this.version=t.version.trim():new Error;else throw new Error;if(typeof(t==null?void 0:t.publisher)=="string"&&(this.publisher=(0,go.escape)(t.publisher.trim())),typeof((i=t==null?void 0:t.engines)==null?void 0:i.eda)=="string"&&(rC(t.engines.eda)?this.engines={eda:t.engines.eda.trim()}:this.engines=void 0),typeof(t==null?void 0:t.license)=="string"&&(this.license=(0,go.escape)(t.license.trim())),typeof((r=t==null?void 0:t.repository)==null?void 0:r.type)=="string"&&(t.repository.type==="extension-store"?this.repository={type:"extension-store"}:this.repository={type:t.repository.type.trim(),url:(n=t.repository.url)==null?void 0:n.trim()}),typeof(t==null?void 0:t.categories)=="string"&&(this.categories=iB.indexOf(t.categories)>=0?t.categories:void 0),Array.isArray(t==null?void 0:t.categories)){this.categories=[];for(let c of t.categories)iB.indexOf(c)>=0&&this.categories.push(c)}Array.isArray(t==null?void 0:t.keywords)&&(this.keywords=t.keywords.map(c=>(0,go.escape)(c))),(t==null?void 0:t.images)instanceof Object&&(this.images={},typeof((s=t.images)==null?void 0:s.banner)=="string"&&(this.images.banner=t.images.banner.trim()),typeof((a=t.images)==null?void 0:a.logo)=="string"&&(this.images.logo=t.images.logo.trim())),typeof(t==null?void 0:t.homepage)=="string"&&(this.homepage=(0,go.escape)((o=t.homepage)==null?void 0:o.trim())),typeof(t==null?void 0:t.bugs)=="string"&&(this.bugs=(0,go.escape)((l=t.bugs)==null?void 0:l.trim())),(t==null?void 0:t.activationEvents)instanceof Object&&(this.activationEvents=t.activationEvents),typeof(t==null?void 0:t.entry)=="string"&&(this.entry=(u=t.entry)==null?void 0:u.trim()),(t==null?void 0:t.dependentExtensions)instanceof Object&&(this.dependentExtensions=t.dependentExtensions),(t==null?void 0:t.headerMenus)instanceof Object&&(this.headerMenus=t.headerMenus)}},iB=["Schematic","Symbol","PCB","Footprint","Panel","Library","Project","Other"];async function xS(e){if(!wo())return;async function t(i){let r=!1;hs(i,_.extensionActivationEventListOnStartupFinished)&&(await yo(i,{onStartupFinished:!0}),r=!0),hs(i,_.extensionActivationEventListOnLogged)&&(await yo(i,{onLogged:!0}),r=!0),r||await yo(i)}if(e)await t(e);else for(let i of _.loadedExtensions)await t(i)}function uh(e){e=`with (sandbox) {/**/
        ${e}
    /**/}`;let t=Object.getPrototypeOf(async()=>{}).constructor,i=t("sandbox",e);return async r=>{let n=new Proxy(r,{has(s,a){return a in s},get(s,a,o){if(a===Symbol.unscopables||a.toString().startsWith("_"))return;let l=Reflect.get(s,a,o);return typeof l=="function"?l.bind(s):l},set(s,a,o){return a.toString().startsWith("_")?!1:(s[a]=o,!0)},deleteProperty(s,a){return a.toString().startsWith("_")?!1:(delete s[a],!0)},ownKeys(s){return Object.keys(s).filter(a=>!a.startsWith("_"))}});return i(n)}}async function ch(e,t){var r;let i={console:window.PRO_LOG_LEVEL==="debug"?console:{assert:(...n)=>{},clear:()=>{},count:n=>{},countReset:n=>"",debug:(...n)=>{},dir:n=>{},error:(...n)=>{},group:n=>{},groupCollapsed:n=>{},groupEnd:()=>{},info:(...n)=>{},log:(...n)=>{},table:(...n)=>{},time:n=>{},timeLog:n=>"",trace:(...n)=>{},warn:(...n)=>{}},document:void 0,fetch:void 0,getDirectory:void 0,indexedDB:void 0,localStorage:void 0,location:void 0,navigator:void 0,postMessage:void 0,self:void 0,sessionStorage:void 0,showOpenFilePicker:void 0,showSaveFilePicker:void 0,showDirectoryPicker:void 0,window:void 0,$:void 0,CookieStore:void 0,CookieStoreManager:void 0,CookieChangeEvent:void 0,Credential:void 0,CredentialsContainer:void 0,ExtendableCookieChangeEvent:void 0,FederatedCredential:void 0,FileSystem:void 0,FileSystemDirectoryEntry:void 0,FileSystemDirectoryHandle:void 0,FileSystemDirectoryReader:void 0,FileSystemEntry:void 0,FileSystemFileEntry:void 0,FileSystemFileHandle:void 0,FileSystemHandle:void 0,FileSystemWritableFileStream:void 0,Headers:void 0,IDBCursor:void 0,IDBCursorWithValue:void 0,IDBDatabase:void 0,IDBFactory:void 0,IDBIndex:void 0,IDBKeyRange:void 0,IDBObjectStore:void 0,IDBOpenDBRequest:void 0,IDBRequest:void 0,IDBTransaction:void 0,IDBVersionChangeEvent:void 0,MessageChannel:void 0,MessageEvent:void 0,MessagePort:void 0,Navigator:void 0,NetworkInformation:void 0,PaymentAddress:void 0,PaymentManager:void 0,PaymentMethodChangeEvent:void 0,PaymentRequest:void 0,PaymentRequestUpdateEvent:void 0,PaymentResponse:void 0,PasswordCredential:void 0,PublicKeyCredential:void 0,PushManager:void 0,PushSubscription:void 0,PushSubscriptionOptions:void 0,Request:void 0,RequestInit:void 0,Response:void 0,ServiceWorkerGlobalScope:void 0,ServiceWorkerRegistration:void 0,Storage:void 0,StorageBucket:void 0,StorageBucketManager:void 0,StorageEvent:void 0,StorageManager:void 0,WebSocket:void 0,WebSocketError:void 0,WebSocketStream:void 0,WebTransport:void 0,WebTransportBidirectionalStream:void 0,WebTransportDatagramDuplexStream:void 0,WebTransportReceiveStream:void 0,WebTransportSendStream:void 0,WebTransportError:void 0,Window:void 0,WorkerGlobalScope:void 0,WorkerNavigator:void 0,XMLDocument:void 0,XMLHttpRequest:void 0,XMLHttpRequestEventTarget:void 0,XMLHttpRequestUpload:void 0,eda:new sh(t),EDMT_EditorSplitScreenDirection:Z_,EDMT_IndicatorMarkerType:Q_,EDMT_ProjectCollaborationMode:R0,EDMT_ItemType:L0,EDMT_EditorDocumentType:gd,ELIB_LibraryType:Cs,ELIB_DeviceJlcLibraryCategory:N0,ELIB_SymbolType:jf,EPCB_DocumentRatlineCalculatingActiveStatus:X0,EPCB_LayerId:yd,EPCB_LayerColorConfiguration:M0,EPCB_LayerType:F0,EPCB_InactiveLayerDisplayMode:U0,EPCB_PdfOutputMethod:GE,EPCB_PcbPlateType:k0,EPCB_PrimitiveType:qi,EPCB_PrimitiveArcInteractiveMode:O0,EPCB_PrimitivePadHeatWeldingConnectionMethod:W0,EPCB_PrimitivePadHoleType:G0,EPCB_PrimitivePadShapeType:Y0,EPCB_PrimitivePadType:z0,EPCB_PrimitiveDimensionType:q0,EPCB_PrimitiveFillMode:j0,EPCB_PrimitivePourFillMethod:em,EPCB_PrimitiveRegionRuleType:H0,EPCB_PrimitiveStringAlignMode:WE,EPCB_PrimitiveViaType:B0,ESCH_MouseEventType:zE,ESCH_PrimitiveEventType:VE,ESCH_PrimitiveType:an,ESCH_PrimitiveLineType:tS,ESCH_PrimitiveFillStyle:iS,ESCH_PrimitiveComponentType:Cg,ESCH_PrimitivePinShape:rS,ESCH_PrimitivePinType:nS,ESYS_NetlistType:pl,ESYS_ImportProjectBoardOutlineSource:YE,ESYS_ImportProjectImportOption:UE,ESYS_ImportProjectSchematicObjectStyle:HE,ESYS_ImportProjectViaSolderMaskExpansion:jE,ESYS_HeaderMenuEnvironment:aS,ESYS_LogType:cS,ESYS_BottomPanelTab:pS,ESYS_LeftPanelTab:dS,ESYS_RightPanelTab:hS,ESYS_ShortcutKeyEffectiveEditorDocumentType:fS,ESYS_ShortcutKeyEffectiveEditorScene:mS,ESYS_ToastMessageType:nh,ESYS_Unit:yu,ESYS_WindowEventType:yS,ESYS_WindowOpenTarget:gS,ESYS_Theme:_S};t?((r=window._EXTAPI_SCRIPT_SPACES_)!=null&&r[t]||(window._EXTAPI_SCRIPT_SPACES_[t]=i),await e(window._EXTAPI_SCRIPT_SPACES_[t])):await e(i)}async function TS(e,t){try{let i;return i=await _.extensionIndexedDBUtils.get("extensionsObjectStorage",e+"|"+t),await i.source.text()}catch{return}}async function wS(e){if(_.isDisableAllExtensionsGlobal)return;let t=await _.extensionIndexedDBUtils.get("extensionsIndex",e);await rB(t),await xS(e),_.extensionApiMessageBus2.publish("extensionApi.SYS_HeaderMenu.registerHeaderMenus",_.extensionRegisteredHeaderMenus)}var rB=async(e,t=!1)=>{if(!e.isEnable)return;e.config.entry=Ml(e.config.entry);let i=e.uuid;async function r(){for(let s of e.fileIndex){let a=s.match(/^locales\/([a-zA-Z\-]+)\.json$/);if(a!==null){let l=a[1],u=await TS(i,s);if(mo(l)&&u)try{let c=JSON.parse(u);$u(i,l,c)}catch{}}let o=s.match(/^locales\/extensionJson\/([a-zA-Z\-]+)\.json$/);if(o!==null){let l=o[1],u=await TS(i,s);if(mo(l)&&u)try{let c=JSON.parse(u);$u(i+".extensionJson",l,c)}catch{}}}}await r(),e.config.headerMenus&&(new gi(i,e.isShowAtHeaderMenu).insertHeaderMenus(e.config.headerMenus),t||gi.flushUI()),e.config.activationEvents&&(e.config.activationEvents.onCommands&&(typeof e.config.activationEvents.onCommands=="string"&&(e.config.activationEvents.onCommands=[e.config.activationEvents.onCommands]),e.config.activationEvents.onCommands.forEach(s=>{_.extensionActivationEventListOnCommands[s]||(_.extensionActivationEventListOnCommands[s]=[]),_.extensionActivationEventListOnCommands[s].push(i)})),e.config.activationEvents.onLanguages&&(typeof e.config.activationEvents.onLanguages=="string"&&(e.config.activationEvents.onLanguages=[e.config.activationEvents.onLanguages]),e.config.activationEvents.onLanguages.forEach(s=>{_.extensionActivationEventListOnLanguages[s]||(_.extensionActivationEventListOnLanguages[s]=[]),_.extensionActivationEventListOnLanguages[s].push(i)})),e.config.activationEvents.onProjectOpened&&_.extensionActivationEventListOnProjectOpened.push(i),e.config.activationEvents.onEditorSchematic&&_.extensionActivationEventListOnEditorSchematic.push(i),e.config.activationEvents.onEditorSymbol&&_.extensionActivationEventListOnEditorSymbol.push(i),e.config.activationEvents.onEditorPcb&&_.extensionActivationEventListOnEditorPcb.push(i),e.config.activationEvents.onEditorFootprint&&_.extensionActivationEventListOnEditorFootprint.push(i),e.config.activationEvents.onEditorPanel&&_.extensionActivationEventListOnEditorPanel.push(i),e.config.activationEvents.onLibraryManagerOpened&&_.extensionActivationEventListOnLibraryManagerOpened.push(i),e.config.activationEvents.onStartupFinished&&_.extensionActivationEventListOnStartupFinished.push(i),e.config.activationEvents.onLogged&&_.extensionActivationEventListOnLogged.push(i),typeof e.config.activationEvents.onChangeAllowExternalInteractions<"u"&&(typeof e.config.activationEvents.onChangeAllowExternalInteractions=="string"&&(e.config.activationEvents.onChangeAllowExternalInteractions=[e.config.activationEvents.onChangeAllowExternalInteractions]),e.config.activationEvents.onChangeAllowExternalInteractions.forEach(s=>{_.extensionActivationEventListOnChangeAllowExternalInteractions[s].push(i)})));let n;try{n=await _.extensionIndexedDBUtils.get("extensionsUserConfig",i)}catch{}if(!n){let s={uuid:i,configs:{}};await _.extensionIndexedDBUtils.insert("extensionsUserConfig",s),n=s}_.extensionUserConfigs[i]=n.configs,_.loadedExtensionsIsAllowExternalInteractions[i]=e.isAllowExternalInteractions,_.loadedExtensions.push(i)};async function nB(){if(_.isDisableAllExtensionsGlobal)return;let e=await gQ();for(let t of e)await rB(t,!0);_.extensionApiMessageBus2.publish("extensionApi.SYS_HeaderMenu.registerHeaderMenus",_.extensionRegisteredHeaderMenus),gi.flushUI(),_.isExtensionsInitialized=!0,await xS()}async function oy(e){let t={registeredExtendLibrary:_.extensionLIB_RegisteredExtendLibraries[e]};_.extensionApiMessageBus2.publish("extensionApi.unloadExtension",{extensionUuid:e,needRemove:t}),delete _.extensionLIB_RegisteredExtendLibraries[e],new gi(e).removeHeaderMenus(),gi.flushUI()}async function sB(){for(let e of _.loadedExtensions)oy(e);_.extensionUserConfigs={},_.extensionRegisteredHeaderMenus={home:[],blank:[],sch:[],symbol:[],pcb:[],footprint:[],pcbView:[],panel:[],panelView:[]},_.extensionActivationEventListOnCommands={},_.extensionActivationEventListOnLanguages={},_.extensionActivationEventListOnProjectOpened=[],_.extensionActivationEventListOnEditorSchematic=[],_.extensionActivationEventListOnEditorSymbol=[],_.extensionActivationEventListOnEditorPcb=[],_.extensionActivationEventListOnEditorFootprint=[],_.extensionActivationEventListOnEditorPanel=[],_.extensionActivationEventListOnLibraryManagerOpened=[],_.extensionActivationEventListOnStartupFinished=[],_.extensionActivationEventListOnLogged=[],_.extensionActivationEventListOnChangeAllowExternalInteractions={on:[],off:[]},_.loadedExtensions=[],_.isExtensionsInitialized=!1}async function RS(e,t=!1){await oy(e),await _.extensionIndexedDBUtils.delete("extensionsIndex",e);let i=await _.extensionIndexedDBUtils.getAllByIndex("extensionsObjectStorage","uuid",e);for(let r of i)await _.extensionIndexedDBUtils.delete("extensionsObjectStorage",r.key);t||await _.extensionIndexedDBUtils.delete("extensionsUserConfig",e),delete _.extensionCheckUpdateStatus[e]}async function yo(e,t,i){if(!hs(e,_.loadedExtensions))return;let r=await _.extensionIndexedDBUtils.get("extensionsIndex",e),n=await TS(e,Ml(r.config.entry));if(!n)return;let s="argument_"+Ol();i!==void 0&&(window._EXTAPI_SCRIPT_SPACES_[e][s]=i),t?typeof t=="string"?n+=`
/**/
if (typeof ${t} === 'function') {${t}(${i?s:void 0});} else if (edaEsbuildExportName && typeof edaEsbuildExportName.${t} === 'function') {edaEsbuildExportName.${t}(${i?s:void 0});}`:typeof t.onCommands=="string"?n+=`
/**/
if (typeof activate === 'function') {activate('onCommands', '${t.onCommands}');} else if (edaEsbuildExportName && typeof edaEsbuildExportName.activate === 'function') {edaEsbuildExportName.activate('onCommands', '${t.onCommands}');}`:typeof t.onLanguages=="string"?n+=`
/**/
if (typeof activate === 'function') {activate('onLanguages', '${t.onLanguages}');} else if (edaEsbuildExportName && typeof edaEsbuildExportName.activate === 'function') {edaEsbuildExportName.activate('onLanguages', '${t.onLanguages}');}`:t.onProjectOpened?n+=`
/**/
if (typeof activate === 'function') {activate('onProjectOpened');} else if (edaEsbuildExportName && typeof edaEsbuildExportName.activate === 'function') {edaEsbuildExportName.activate('onProjectOpened');}`:t.onEditorSchematic?n+=`
/**/
if (typeof activate === 'function') {activate('onEditorSchematic');} else if (edaEsbuildExportName && typeof edaEsbuildExportName.activate === 'function') {edaEsbuildExportName.activate('onEditorSchematic');}`:t.onEditorSymbol?n+=`
/**/
if (typeof activate === 'function') {activate('onEditorSymbol');} else if (edaEsbuildExportName && typeof edaEsbuildExportName.activate === 'function') {edaEsbuildExportName.activate('onEditorSymbol');}`:t.onEditorPcb?n+=`
/**/
if (typeof activate === 'function') {activate('onEditorPcb');} else if (edaEsbuildExportName && typeof edaEsbuildExportName.activate === 'function') {edaEsbuildExportName.activate('onEditorPcb');}`:t.onEditorFootprint?n+=`
/**/
if (typeof activate === 'function') {activate('onEditorFootprint');} else if (edaEsbuildExportName && typeof edaEsbuildExportName.activate === 'function') {edaEsbuildExportName.activate('onEditorFootprint');}`:t.onEditorPanel?n+=`
/**/
if (typeof activate === 'function') {activate('onEditorPanel');} else if (edaEsbuildExportName && typeof edaEsbuildExportName.activate === 'function') {edaEsbuildExportName.activate('onEditorPanel');}`:t.onStartupFinished?n+=`
/**/
if (typeof activate === 'function') {activate('onStartupFinished');} else if (edaEsbuildExportName && typeof edaEsbuildExportName.activate === 'function') {edaEsbuildExportName.activate('onStartupFinished');}`:t.onLogged?n+=`
/**/
if (typeof activate === 'function') {activate('onLogged');} else if (edaEsbuildExportName && typeof edaEsbuildExportName.activate === 'function') {edaEsbuildExportName.activate('onLogged');}`:typeof t.onChangeAllowExternalInteractions=="string"&&(n+=`
/**/
if (typeof activate === 'function') {activate('onChangeAllowExternalInteractions', '${t.onChangeAllowExternalInteractions}');} else if (edaEsbuildExportName && typeof edaEsbuildExportName.activate === 'function') {edaEsbuildExportName.activate('onChangeAllowExternalInteractions', '${t.onChangeAllowExternalInteractions}');}`):n+=`
`;let a=uh(n);await ch(a,e)}async function gQ(){return _.extensionIndexedDBUtils.list("extensionsIndex")||[]}var ly=Hn(W_());async function yQ(e){let t;if($a?t=await K_("/api/extensions/"+e,{order:"desc"}):t=await K_("/api/extensions/editor/his_version_list",{uuid:e}),!t)return!1;let i=JSON.parse(t);if(!i.result||i.result.length===0)return!1;let r="",n="",s;for(let a=0;a<i.result.length;a++)if(i.result[a].status===1&&ly.valid(i.result[a].version)){r=i.result[a].version,n=i.result[a].file_path,s=i.result[a].engines;break}return{version:r,filePath:n,engines:s}}async function uy(e,t){var s,a,o;if(!fs())return!1;t||(t=(await _.extensionIndexedDBUtils.get("extensionsIndex",e)).config.version);let i=await yQ(e);if(!i||(s=i.engines)!=null&&s.eda&&!ly.satisfies(xc(),(a=i.engines)==null?void 0:a.eda))return!1;let{version:r,filePath:n}=i;return lC(t,r)?(_.extensionCheckUpdateStatus[e]||(_.extensionCheckUpdateStatus[e]={}),_.extensionCheckUpdateStatus[e].latestVersion=r,_.extensionCheckUpdateStatus[e].isNeedUpdate=!0,_.extensionCheckUpdateStatus[e].downloadFilePath=n,{version:r,filePath:n}):(_.extensionCheckUpdateStatus[e]={latestVersion:void 0,isNeedUpdate:!1,isAutoUpdate:((o=_.extensionCheckUpdateStatus[e])==null?void 0:o.isAutoUpdate)||!1,downloadFilePath:void 0},!1)}async function _Q(e){let{latestVersion:t,downloadFilePath:i}=_.extensionCheckUpdateStatus[e],r=await fetch(i,{method:"GET"}),n=r.headers.get("Content-Type");if(!n||n.includes("application/json")||!r.body)return be.sys_Message.showToastMessage("\u6269\u5C55 "+e+" v"+t+" \u66F4\u65B0\u5931\u8D25\uFF01"),!1;{let s=r.body.getReader(),a=[];for(;;){let{done:l,value:u}=await s.read();if(l)break;a.push(u)}let o=new File([new Blob(a)],"auto-update-"+e+"_v"+t+"_.eext");return await LS({files:[o],action:"upgrade"})}}async function aB(){if(!fs())return;console.log("[INFO] \u5F00\u59CB\u68C0\u67E5\u6269\u5C55\u66F4\u65B0");let e=await _.extensionIndexedDBUtils.list("extensionsIndex");for(let t of e){let i=await uy(t.uuid,t.config.version);_.extensionCheckUpdateStatus[t.uuid]={latestVersion:i?i.version:void 0,isNeedUpdate:typeof i=="object",isAutoUpdate:t.isAutoUpdate,downloadFilePath:i?i.filePath:void 0}}console.log("[INFO] \u6269\u5C55\u66F4\u65B0\u68C0\u67E5\u5B8C\u6210\uFF1A",_.extensionCheckUpdateStatus)}async function oB(){if(fs())for(let e of Object.keys(_.extensionCheckUpdateStatus))_.extensionCheckUpdateStatus[e].isNeedUpdate&&_.extensionCheckUpdateStatus[e].latestVersion&&_.extensionCheckUpdateStatus[e].isAutoUpdate&&_.extensionCheckUpdateStatus[e].downloadFilePath&&await _Q(e)}var cy=class{constructor(t){this.version=t}async open(t,i){return new Promise((r,n)=>{window.indexedDB||n(new Error("\u81F4\u547D\u9519\u8BEF\uFF1A\u8BE5\u73AF\u5883\u4E0D\u652F\u6301 IndexedDB\uFF0C\u65E0\u6CD5\u5B58\u50A8\u6269\u5C55\uFF01"));let s=indexedDB.open(t,this.version);s.onsuccess=()=>{this.db=s.result,r(this.db)},s.onerror=()=>{n(new Error(`\u9519\u8BEF\uFF1A\u5F00\u542F IndexedDB \u65F6\u9047\u5230\u95EE\u9898\uFF0C\u2764\u8BF7\u5B9A\u4F4D\u62A5\u9519\u2764\uFF1A
`+s.error))},s.onupgradeneeded=a=>{i(s.result,a)}})}async insert(t,i){return new Promise((r,n)=>{if(this.db){let s=this.db.transaction(t,"readwrite").objectStore(t).add(i);s.onsuccess=()=>{r(!0)},s.onerror=()=>{n(new Error("\u9519\u8BEF\uFF1A\u5411 IndexedDB \u5185\u63D2\u5165\u6570\u636E\u884C\u65F6\u9047\u5230\u95EE\u9898\u3002"))}}else n(new Error("\u9519\u8BEF\uFF1AIndexedDB \u672A\u521D\u59CB\u5316\u3002"))})}async delete(t,i){return new Promise((r,n)=>{if(this.db){let s=this.db.transaction(t,"readwrite").objectStore(t).delete(i);s.onsuccess=()=>{r(!0)},s.onerror=()=>{n(new Error("\u9519\u8BEF\uFF1A\u5220\u9664 IndexedDB \u5185\u7684\u6570\u636E\u884C\u65F6\u9047\u5230\u95EE\u9898\u3002"))}}else n(new Error("\u9519\u8BEF\uFF1AIndexedDB \u672A\u521D\u59CB\u5316\u3002"))})}async get(t,i){return new Promise((r,n)=>{if(this.db){let s=this.db.transaction(t,"readonly").objectStore(t).get(i);s.onsuccess=()=>{r(s.result)},s.onerror=()=>{n(new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u83B7\u53D6 IndexedDB \u5185\u7684\u6570\u636E\u884C\u3002"))}}else n(new Error("\u9519\u8BEF\uFF1AIndexedDB \u672A\u521D\u59CB\u5316\u3002"))})}async getAllByIndex(t,i,r){return new Promise((n,s)=>{if(this.db){let o=this.db.transaction(t,"readonly").objectStore(t).index(i).openCursor(IDBKeyRange.only(r)),l=[];o.onsuccess=()=>{o.result?(l.push(o.result.value),o.result.continue()):n(l)},o.onerror=()=>{s(new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u4F7F\u7528\u7D22\u5F15\u83B7\u53D6 IndexedDB \u5185\u7684\u6570\u636E\u884C\u3002"))}}else s(new Error("\u9519\u8BEF\uFF1AIndexedDB \u672A\u521D\u59CB\u5316\u3002"))})}async set(t,i){return new Promise((r,n)=>{if(this.db){let s=this.db.transaction(t,"readwrite").objectStore(t).put(i);s.onsuccess=()=>{r(!0)},s.onerror=()=>{n(new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u4FEE\u6539 IndexedDB \u5185\u7684\u6570\u636E\u884C\u3002"))}}else n(new Error("\u9519\u8BEF\uFF1AIndexedDB \u672A\u521D\u59CB\u5316\u3002"))})}async list(t){return new Promise((i,r)=>{if(this.db){let n=[],s=this.db.transaction(t,"readonly").objectStore(t).openCursor();s.onsuccess=()=>{s.result?(n.push(s.result.value),s.result.continue()):i(n)},s.onerror=()=>{r(new Error("\u9519\u8BEF\uFF1A\u65E0\u6CD5\u83B7\u53D6 IndexedDB \u5185\u7684\u6570\u636E\u7684\u5217\u8868\u3002"))}}else r(new Error("\u9519\u8BEF\uFF1AIndexedDB \u672A\u521D\u59CB\u5316\u3002"))})}};async function lB(){let e=(i,r)=>{let n=i.createObjectStore("extensionsIndex",{keyPath:"uuid"});n.createIndex("installationTime","installationTime",{unique:!1}),n.createIndex("fileSize","fileSize",{unique:!1});let s=i.createObjectStore("extensionsObjectStorage",{keyPath:"key"});s.createIndex("uuid","uuid",{unique:!1}),s.createIndex("path","path",{unique:!1}),i.createObjectStore("extensionsUserConfig",{keyPath:"uuid"}),i.createObjectStore("standaloneScript",{keyPath:"name"})};async function t(){_.extensionIndexedDBUtils=new cy(_.indexedDBVersion),await _.extensionIndexedDBUtils.open("User_"+_.globalVariableUserInfo.uuid+"_v"+String(_.indexedDBVersion),e)}await t()}async function dB(){_.extensionApiMessageBus2.subscribe("extensionApi.userScript",r=>{if(r.operation==="run")if(typeof r.userScript=="string"){let n=uh(r.userScript);ch(n)}else be.sys_Message.showToastMessage(be.sys_I18n.text("Script code cannot be empty!"),"error");else if(r.operation==="save")if(typeof r.userScriptName=="string"&&typeof r.userScript=="string")if(r.userScriptName!==""){let n=V_("extensionApi.userScriptList")||"[]",s=JSON.parse(n)||[],a=(0,NS.default)(r.userScriptName),o=!1;for(let l of s)if(l.userScriptKey===a){l.userScript=r.userScript,o=!0,be.sys_Message.showToastMessage(be.sys_I18n.text("The script was updated successfully!"),"success");break}o||(s.unshift({userScriptKey:a,userScriptName:r.userScriptName,userScript:r.userScript}),be.sys_Message.showToastMessage(be.sys_I18n.text("The script was saved successfully!"),"success")),q_("extensionApi.userScriptList",JSON.stringify(s))}else be.sys_Message.showToastMessage(be.sys_I18n.text("The script name cannot be empty!"),"error");else be.sys_Message.showToastMessage(be.sys_I18n.text("Unable to get script name and script content!"),"error");else if(r.operation==="delete")if(typeof r.userScriptName=="string"&&(r.userScriptKey=(0,NS.default)(r.userScriptName)),typeof r.userScriptKey=="string"){let n=V_("extensionApi.userScriptList")||"[]",s=JSON.parse(n)||[],a=[];s.forEach(o=>{o.userScriptKey!==r.userScriptKey&&a.push(o)}),s.length===a.length?be.sys_Message.showToastMessage(be.sys_I18n.text("No scripts selected!"),"warn"):(q_("extensionApi.userScriptList",JSON.stringify(a)),be.sys_Message.showToastMessage(be.sys_I18n.text("The script has been removed!"),"success"))}else be.sys_Message.showToastMessage(be.sys_I18n.text("Unable to get script name!"),"success")}),_.extensionApiMessageBus2.rpcService("extensionApi.runStandaloneScript",async r=>{if(r.scriptName&&!r.scriptCode&&(r.scriptCode=(await _.extensionIndexedDBUtils.get("standaloneScript",r.scriptName)).script),!r.scriptCode||r.scriptCode===""){be.sys_Message.showToastMessage(be.sys_I18n.text("Script code cannot be empty!"),"error");return}let n=uh(r.scriptCode);ch(n)});let e=async()=>{_.extensionApiMessageBus2.publish("/pro-ui/topMenu/advanced/scriptListMenu",(await _.extensionIndexedDBUtils.list("standaloneScript")).map(r=>({name:r.name,config:r.config})))},t=async r=>{r.replace===void 0&&(r.replace=!0),!r.scriptName||r.scriptName===""?be.sys_Message.showToastMessage(be.sys_I18n.text("The script name cannot be empty!"),"error"):(!r.scriptCode||r.scriptCode==="")&&be.sys_Message.showToastMessage(be.sys_I18n.text("Script code cannot be empty!"),"error");async function n(a,o,l){let u={name:a,script:o,config:{documentTypes:[],publisher:void 0,license:void 0,homepage:void 0,description:void 0,version:void 0,peaceAndLove:!1}};return await _.extensionIndexedDBUtils.get("standaloneScript",a)?l&&await _.extensionIndexedDBUtils.set("standaloneScript",u)?"replaced":!1:await _.extensionIndexedDBUtils.insert("standaloneScript",u)?"saved":!1}let s=await n(r.scriptName,r.scriptCode,r.replace);switch(s){case"replaced":{be.sys_Message.showToastMessage(be.sys_I18n.text("Standalone script was updated successfully!",void 0,void 0,r.scriptName),"success");break}case"saved":{be.sys_Message.showToastMessage(be.sys_I18n.text("Standalone script was saved successfully!",void 0,void 0,r.scriptName),"success");break}case!1:{be.sys_Message.showToastMessage(be.sys_I18n.text("An unexpected error occurred while saving a standalone script.",void 0,void 0,r.scriptName),"success");break}}return s};_.extensionApiMessageBus2.rpcService("extensionApi.saveStandaloneScript",async r=>{let n=await t(r);return e(),n}),_.extensionApiMessageBus2.rpcService("extensionApi.importStandaloneScriptFiles",async r=>{be.sys_Message.showToastMessage(be.sys_I18n.text("Start importing the standalone script(s).",void 0,void 0,r.length.toString()),"info");let n={saved:0,replaced:0,failed:0},s=[];for(let a of r){a.name.endsWith(".js")||(s.push({name:a.name,status:!1}),n.failed++);let o=a.name.slice(0,a.name.length-3),l=await t({scriptName:o,scriptCode:await a.text(),replace:!0});l==="replaced"?n.replaced++:l==="saved"?n.saved++:n.failed++,s.push({name:o,status:l})}return be.sys_Message.showToastMessage(be.sys_I18n.text("Standalone script import completed!",void 0,void 0,n.saved.toString(),n.replaced.toString(),n.failed.toString()),"info"),e(),s}),_.extensionApiMessageBus2.rpcService("extensionApi.deleteStandaloneScripts",async r=>{let n=[];for(let s of r)n.push({name:s,status:await _.extensionIndexedDBUtils.delete("standaloneScript",s)}),be.sys_Message.showToastMessage(be.sys_I18n.text("Standalone script has been removed!",void 0,void 0,s),"success");return e(),n}),_.extensionApiMessageBus2.rpcService("extensionApi.getAllStandaloneScripts",async()=>await _.extensionIndexedDBUtils.list("standaloneScript")),_.extensionApiMessageBus2.rpcService("extensionApi.getStandaloneScript",async r=>await _.extensionIndexedDBUtils.get("standaloneScript",r)),_.extensionApiMessageBus2.rpcService("extensionApi.exportStandaloneScript",async r=>{var n;return!r.scriptName&&!r.scriptCode?!1:(r.scriptName=r.scriptName||"NewScript",r.scriptCode=r.scriptCode||((n=await _.extensionIndexedDBUtils.get("standaloneScript",r.scriptName))==null?void 0:n.script),r.scriptName&&r.scriptCode?(await be.sys_FileSystem.saveFile(new File([r.scriptCode],r.scriptName+".js")),!0):!1)}),_.extensionApiMessageBus2.rpcService("extensionApi.exportStandaloneScripts",async r=>{var s;let n=[];for(let a of r){let o=(s=await _.extensionIndexedDBUtils.get("standaloneScript",a))==null?void 0:s.script;o?(await be.sys_FileSystem.saveFile(new File([o],a+".js")),n.push({name:a,status:!0})):n.push({name:a,status:!1})}return n}),_.extensionApiMessageBus2.rpcService("extensionApi.modifyStandaloneScriptName",async r=>{let n=await _.extensionIndexedDBUtils.get("standaloneScript",r.originScriptName);return n?(n.name=r.scriptName,await _.extensionIndexedDBUtils.set("standaloneScript",n)?(await _.extensionIndexedDBUtils.delete("standaloneScript",r.originScriptName),e(),be.sys_Message.showToastMessage(be.sys_I18n.text("Standalone script has been renamed.",void 0,void 0,r.originScriptName,r.scriptName),"success"),!0):(be.sys_Message.showToastMessage(be.sys_I18n.text("Standalone script rename failed! Please report this unexpected bug."),"error"),!1)):(be.sys_Message.showToastMessage(be.sys_I18n.text("Standalone script rename failed! The origin script not exist.",void 0,void 0,r.originScriptName),"error"),!1)}),_.extensionApiMessageBus2.rpcService("user.setUserInfo",async r=>(_.globalVariableUserInfo=r,await lB(),e(),_.isExtensionsInitialized||await nB(),uS(),aB().then(()=>{oB()}),!0)),_.extensionApiMessageBus2.rpcService("user.clearUserInfo",()=>(_.globalVariableUserInfo={},_.extensionApiMessageBus2.publish("/pro-ui/topMenu/advanced/scriptListMenu",[]),sB(),!0)),_.extensionApiMessageBus2.rpcService("user.changeLanguage",async()=>{let r=_.currentLanguage;await uS();let n=_.currentLanguage;return gi.reloadAllHeaderMenuLanguage().flushUI(),_.extension_SYS_I18nEvents.forEach(async(s,a)=>{s.event==="languageChanged"&&(await s.callFn(n,r),s.onlyOnce&&_.extension_SYS_I18nEvents.splice(a,1))}),!0}),_.extensionApiMessageBus2.rpcService("extensionApi.getExtensionsIndex",async()=>wo()?await _.extensionIndexedDBUtils.list("extensionsIndex"):[]),_.extensionApiMessageBus2.rpcService("extensionApi.setExtensionStatus",async r=>{let n=await _.extensionIndexedDBUtils.get("extensionsIndex",r.uuid);if(!n)return!1;switch(r.statusName){case"isEnable":n.isEnable=r.status;break;case"isAllowExternalInteractions":n.isAllowExternalInteractions=r.status;break;case"isAutoUpdate":n.isAutoUpdate=r.status;break;case"isOnlineSync":n.isOnlineSync=r.status;break;case"isShowAtHeaderMenu":n.isShowAtHeaderMenu=r.status;break;default:return!1}switch(await _.extensionIndexedDBUtils.set("extensionsIndex",n),r.statusName){case"isEnable":r.status?(await wS(r.uuid),be.sys_Message.showToastMessage(be.sys_I18n.text("Extension enabled!"),"success")):(await oy(r.uuid),be.sys_Message.showToastMessage(be.sys_I18n.text("Extension disabled!"),"success"));break;case"isAllowExternalInteractions":_.loadedExtensionsIsAllowExternalInteractions[r.uuid]=r.status,r.status?(hs(r.uuid,_.extensionActivationEventListOnChangeAllowExternalInteractions.on)&&yo(r.uuid,{onChangeAllowExternalInteractions:"on"}),be.sys_Message.showToastMessage(be.sys_I18n.text("Extension external interactions is enabled!"),"success")):(hs(r.uuid,_.extensionActivationEventListOnChangeAllowExternalInteractions.off)&&yo(r.uuid,{onChangeAllowExternalInteractions:"off"}),be.sys_Message.showToastMessage(be.sys_I18n.text("Extension external interactions is disabled!"),"success"));break;case"isAutoUpdate":r.status?(await uy(r.uuid),be.sys_Message.showToastMessage(be.sys_I18n.text("Extension auto-update is enabled!"),"success")):be.sys_Message.showToastMessage(be.sys_I18n.text("Extension auto-update is disabled!"),"success");break;case"isOnlineSync":r.status?be.sys_Message.showToastMessage(be.sys_I18n.text("Extension cloud-sync is enabled!"),"success"):be.sys_Message.showToastMessage(be.sys_I18n.text("Extension cloud-sync is disabled!"),"success");break;case"isShowAtHeaderMenu":new gi(r.uuid).reloadIsShowAtHeaderMenuStatus(r.status),gi.flushUI(),r.status?be.sys_Message.showToastMessage(be.sys_I18n.text("The extension menu will now be displayed at the top."),"success"):be.sys_Message.showToastMessage(be.sys_I18n.text("The extension menu will now appear within the Advanced menu."),"success");break;default:return!1}return!0}),_.extensionApiMessageBus2.subscribe("extensionApi.callFunctionInExtension",r=>{let n=r.split(".");n.length===2&&yo(n[0],n[1])}),_.extensionApiMessageBus2.rpcService("extensionApi.deleteExtension",async r=>{let n=await _.extensionIndexedDBUtils.get("extensionsIndex",r);return await RS(r),be.sys_Message.showToastMessage(be.sys_I18n.text("Extension uninstalled!",void 0,void 0,n.config.displayName||n.config.name,n.config.version),"success"),!0}),_.extensionApiMessageBus2.rpcService("extensionApi.getExtensionPackage",async r=>await _.extensionIndexedDBUtils.get("extensionsObjectStorage",r));async function i(r){var u,c,h,m;function n(){for(let f of["readme.md","readme.txt","readme"])for(let g of r.fileIndex)if(g.toLowerCase()===f)return g}function s(){for(let f of["changelog.md","changelog.txt","changelog"])for(let g of r.fileIndex)if(g.toLowerCase()===f)return g}let a={readme:n(),changelog:s(),logo:((u=r.config.images)==null?void 0:u.logo)&&Ro((c=r.config.images)==null?void 0:c.logo),banner:((h=r.config.images)==null?void 0:h.banner)&&Ro((m=r.config.images)==null?void 0:m.banner)},o={readme:void 0,changelog:void 0,logo:void 0,banner:void 0};r&&(o.readme=a.readme?await _.extensionIndexedDBUtils.get("extensionsObjectStorage",r.uuid+"|"+a.readme):void 0,o.changelog=a.changelog?await _.extensionIndexedDBUtils.get("extensionsObjectStorage",r.uuid+"|"+a.changelog):void 0,o.logo=a.logo?await _.extensionIndexedDBUtils.get("extensionsObjectStorage",r.uuid+"|"+a.logo):void 0,o.banner=a.banner?await _.extensionIndexedDBUtils.get("extensionsObjectStorage",r.uuid+"|"+a.banner):void 0);async function l(f,g){let y=await f.source.text(),b=[],E=y.matchAll(/\!\[(.*)\]\((.+)\)/gm);for(let v of E){let A={fileUri:v[2],uriName:v[1],isNeedRemove:!1};if(A.fileUri===""||/^[a-zA-Z0-9]*(\:|\/\/).+/.test(A.fileUri))A.isNeedRemove=!0;else try{let x=await _.extensionIndexedDBUtils.get("extensionsObjectStorage",r.uuid+"|"+Ro(A.fileUri));A.dataUrl=await uC(x.source)}catch{console.warn("[WARNING] \u6269\u5C55 "+r.config.displayName+" \u7684 "+g+" \u6587\u4EF6\u5185\u5F15\u7528\u7684\u672C\u5730\u56FE\u50CF\u4E0D\u5B58\u5728\uFF1A",v[0])}b.push(A)}let S=y.replaceAll(/\!\[.*\]\(.*\)/gm,v=>{let A=v.match(/^\!\[(.*)\]\((.*)\)$/);if(A){for(let x of b)if(x.uriName===A[1]&&x.fileUri===A[2])return x.isNeedRemove||!x.dataUrl?"":"!["+x.uriName+"]("+x.dataUrl+")"}return""});return f.source=new Blob([S]),f}return o.readme&&(o.readme=await l(o.readme,"README")),o.changelog&&(o.changelog=await l(o.changelog,"CHANGELOG")),{...r,files:o,extensionStoreStatus:_.extensionCheckUpdateStatus[r.uuid]||{isNeedUpdate:!1}}}_.extensionApiMessageBus2.rpcService("extensionApi.getExtensionDetail",async r=>{if(!wo())return;let n=await _.extensionIndexedDBUtils.get("extensionsIndex",r);if(n)return await i(n)}),_.extensionApiMessageBus2.rpcService("extensionApi.getExtensionsDetail",async()=>{if(!wo())return[];let r=await _.extensionIndexedDBUtils.list("extensionsIndex"),n=[];for(let s of r){let a=await i(s);n.push(a)}return n}),_.extensionApiMessageBus2.rpcService("extensionApi.importExtensionPackages",LS)}async function LS(e){if(!wo())return be.sys_Message.showToastMessage(be.sys_I18n.text("Please log in first"),"info"),!1;if(e.files.length<=0)return be.sys_Message.showToastMessage(be.sys_I18n.text("No extensions selected that need to be imported!"),"error"),!1;for(let t of e.files)await new cB.default().loadAsync(t).then(async r=>{var y,b,E;let n=await((y=r.file("extension.json"))==null?void 0:y.async("string"))||void 0;if(!n)return be.sys_Message.showToastMessage(be.sys_I18n.text("The incoming file doesn't seem to be the EasyEDA Pro extension."),"error"),!1;let s=new ay(JSON.parse(n)),a=s.uuid;if(!a||a==="00000000000000000000000000000000"||!Ic(a))return be.sys_Message.showToastMessage(be.sys_I18n.text("The UUID of the extension is not up to specification!"),"error"),!1;if(!s.name||!s.version||!s.entry)return be.sys_Message.showToastMessage(be.sys_I18n.text('The extension must have the "name, version, entry" field and be in the correct format.'),"error"),!1;let o=!1,l;try{l=await _.extensionIndexedDBUtils.get("extensionsIndex",a)}catch{}l&&(await RS(a,!0),o=!0);let u=await((b=r.file(".edaignore"))==null?void 0:b.async("string"))||"",c=nC(u),h=(0,uB.default)().add(c),m=[];r.forEach((S,v)=>{h.ignores(v.name)||m.push(v.name)});let f={uuid:a,config:s,fileIndex:m,fileSize:t.size,installationTime:new Date,isEnable:(l==null?void 0:l.isEnable)===void 0?!0:l.isEnable,isAllowExternalInteractions:(l==null?void 0:l.isAllowExternalInteractions)===void 0?!1:l.isAllowExternalInteractions,isAutoUpdate:(l==null?void 0:l.isAutoUpdate)===void 0?!1:l.isAutoUpdate,isOnlineSync:(l==null?void 0:l.isOnlineSync)===void 0?!1:l.isOnlineSync,isShowAtHeaderMenu:(l==null?void 0:l.isShowAtHeaderMenu)||!1,isInExtensionStore:!1};await _.extensionIndexedDBUtils.insert("extensionsIndex",f);let g={key:a,uuid:a,path:"",source:t};await _.extensionIndexedDBUtils.insert("extensionsObjectStorage",g);for(let S of m){let v=await((E=r.file(S))==null?void 0:E.async("blob"))||new Blob,A={key:a+"|"+S,uuid:a,path:S,source:new File([v],S.split("/").at(-1)||"",{type:eB.getType(S)||void 0})};await _.extensionIndexedDBUtils.insert("extensionsObjectStorage",A),Ml(S)===Ml(s.entry)&&(await v.text()).match(/(eda\.sys_ClientUrl\.|eda\.sys_FileSystem\.readFileFromFileSystem|eda\.sys_FileSystem\.saveFileToFileSystem|eda\.sys_FileSystem\.listFilesOfFileSystem|eda\.sys_FileSystem\.deleteFileInFileSystem|eda\.sys_FileSystem\.getEdaPath|eda\.sys_FileSystem\.getDocumentsPath|eda\.sys_FileSystem\.getLibrariesPaths|eda\.sys_FileSystem\.getProjectsPaths|eda\.sys_WebSocket)/)&&be.sys_Dialog.showInformationMessage("The currently installed extension has called external interaction interfaces such as networking and local file access, and the external interaction permission of the extension has been disabled by default. Make sure you trust the publisher of your extension before enabling this permission, or your assets may be compromised.","Safety Tips","Confirm")}if(!await _.extensionIndexedDBUtils.get("extensionsUserConfig",a)){let S={uuid:a,configs:{}};await _.extensionIndexedDBUtils.insert("extensionsUserConfig",S)}if(await wS(a),await uy(a),e.action)switch(e.action){case"install":be.sys_Message.showToastMessage(be.sys_I18n.text("Extension install successful!",void 0,void 0,(s.displayName||s.name)+(s.version?" v"+s.version:"")),"success");break;case"upgrade":be.sys_Message.showToastMessage(be.sys_I18n.text("Extension upgrade successful!",void 0,void 0,(s.displayName||s.name)+(s.version?" v"+s.version:"")),"success");break;case"import":o?be.sys_Message.showToastMessage(be.sys_I18n.text("Extension upgrade successful!",void 0,void 0,(s.displayName||s.name)+(s.version?" v"+s.version:"")),"success"):be.sys_Message.showToastMessage(be.sys_I18n.text("Extension import successful!",void 0,void 0,(s.displayName||s.name)+(s.version?" v"+s.version:"")),"success");break;default:o?be.sys_Message.showToastMessage(be.sys_I18n.text("Extension upgrade successful!",void 0,void 0,(s.displayName||s.name)+(s.version?" v"+s.version:"")),"success"):be.sys_Message.showToastMessage(be.sys_I18n.text("Extension install successful!",void 0,void 0,(s.displayName||s.name)+(s.version?" v"+s.version:"")),"success");break}else o?be.sys_Message.showToastMessage(be.sys_I18n.text("Extension upgrade successful!",void 0,void 0,(s.displayName||s.name)+(s.version?" v"+s.version:"")),"success"):be.sys_Message.showToastMessage(be.sys_I18n.text("Extension install successful!",void 0,void 0,(s.displayName||s.name)+(s.version?" v"+s.version:"")),"success")});return!0}var tc=Hn(yg());function hB(){window._MSG_BUS2_EXTAPI_=window._MSG_BUS2_EXTAPI_||new tc.MessageBus2(!window.frameElement),_.extensionApiMessageBus2=window._MSG_BUS2_EXTAPI_,_.extensionApiBroadcastChannelMessageBus=new tc.BroadcastChannelMessageBus("extensionApi"),_.extensionSYS_MessageBus.public.messageBus=new tc.MessageBus2(!1),_.extensionSYS_MessageBus.public.broadcastChannelMessageBus=new tc.BroadcastChannelMessageBus("extensionApiExtensionsPublic")}async function bQ(){dp("safetyMode")==="true"&&(_.isDisableAllExtensionsGlobal=!0),window._EXTAPI_SCRIPT_SPACES_||(window._EXTAPI_SCRIPT_SPACES_={}),hB(),dB(),HD()}bQ();})();
/*! Bundled license information:

is-buffer/index.js:
  (*!
   * Determine if an object is a Buffer
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)

lc-editor-common/dist/index.js:
  (*! Bundled license information:
  
  lc-protocol/dist/index.js:
    (*! Bundled license information:
    
    crypto-js/ripemd160.js:
      (** @preserve
      	(c) 2012 by Cdric Mesnil. All rights reserved.
      
      	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
      
      	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
      	    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
      
      	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
      	*)
    
    crypto-js/mode-ctr-gladman.js:
      (** @preserve
       * Counter block mode compatible with  Dr Brian Gladman fileenc.c
       * derived from CryptoJS.mode.CTR
       * Jan Hruby jhruby.web@gmail.com
       *)
    *)
  *)
*/
//# sourceMappingURL=https://modules.lceda.cn/pro-api/0.1.190.3ffe0ba3/api.js.map
